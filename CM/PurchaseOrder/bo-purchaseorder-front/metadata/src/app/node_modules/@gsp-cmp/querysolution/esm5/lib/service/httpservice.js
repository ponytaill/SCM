/**
 * @fileoverview added by tsickle
 * Generated from: lib/service/httpservice.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { QuerySolutionVoConvertor } from '@farris/component-querycondition';
var HttpService = /** @class */ (function () {
    function HttpService(http) {
        this.http = http;
        this.histroyUrl = "/api/runtime/sys/v1.0/querysolution/previousQuery";
        this.url = '/api/runtime/sys/v1.0/querysolution';
    }
    /**
     * 新增查询方案
     * @param querySolution 查询方案实体
     */
    /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.create = /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.post(this.url, body, options);
    };
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param formId 表单ID
     */
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.query = /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    function (formId, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
        };
        /** @type {?} */
        var belongId = formId;
        // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/bybelongid/${belongId}`;
        /** @type {?} */
        var url = this.url + "/belongId/" + belongId;
        return this.http.get(url, options);
    };
    /**
     * 更新
     * @param querySolution 查询方案实体
     */
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.update = /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.put(this.url, body, options);
    };
    /**
     * 删除
     * @unused
     * @param idArray 删除的解决方案ID列表
     */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param object : '{defaultId, belongId, deletedIds}'
     */
    /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.batchUpdate = /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    function (body, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        var url = this.url + "/batch";
        return this.http.put(url, body, options);
    };
    /**
     * 获取默认查询方案ID
     * @unused
     * @param formId
     */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
        * 是否支持
        */
    /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    HttpService.prototype.supportLS = /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    function () {
        if (window.hasOwnProperty("localStorage")) {
            return true;
        }
        return false;
    };
    /**
     * 设置保存时候，属性从小写变成大写
     * @param key
     * @param value
     */
    /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    HttpService.prototype.setLS = /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    function (key, value) {
        /** @type {?} */
        var conditionsStr = '[]';
        if (value) {
            if (typeof value == 'string') {
                conditionsStr = value;
            }
            else {
                /** @type {?} */
                var convertor = new QuerySolutionVoConvertor();
                conditionsStr = JSON.stringify(convertor.formatConvertJObject(value));
            }
        }
        if (key && this.supportLS) {
            localStorage.setItem(key, conditionsStr);
        }
    };
    /**
     * 获取时，属性从大写变成小写
     * @param key
     */
    /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    HttpService.prototype.getLS = /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    function (key) {
        /** @type {?} */
        var result = new Array();
        if (key && this.supportLS) {
            /** @type {?} */
            var v = localStorage.getItem(key);
            if (v != undefined || v !== null) {
                result = JSON.parse(v);
            }
        }
        if (result.length > 0) {
            /** @type {?} */
            var convertor = new QuerySolutionVoConvertor();
            return convertor.formatFromJobject(result);
        }
        return result;
    };
    /**
     * 更新
     * @param querySolution 查询方案实体
     */
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    HttpService.prototype.saveHistroy = /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    function (querySolution, sessionId) {
        /** @type {?} */
        var headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        var options = {
            headers: headers
        };
        /** @type {?} */
        var convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        var body = convertor.convertJObject(querySolution);
        return this.http.put(this.histroyUrl, body, options);
    };
    HttpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    HttpService.ctorParameters = function () { return [
        { type: HttpClient }
    ]; };
    return HttpService;
}());
export { HttpService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.histroyUrl;
    /** @type {?} */
    HttpService.prototype.url;
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cHNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLWNtcC9xdWVyeXNvbHV0aW9uLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvaHR0cHNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFL0QsT0FBTyxFQUFtQix3QkFBd0IsRUFBa0IsTUFBTSxrQ0FBa0MsQ0FBQztBQUU3RztJQUdJLHFCQUFvQixJQUFnQjtRQUFoQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQzVCLGVBQVUsR0FBVyxtREFBbUQsQ0FBQztRQUNqRixRQUFHLEdBQVcscUNBQXFDLENBQUM7SUFGWixDQUFDO0lBR3pDOzs7T0FHRzs7Ozs7OztJQUNILDRCQUFNOzs7Ozs7SUFBTixVQUFPLGFBQThCLEVBQUUsU0FBaUI7O1lBQ2hELE9BQU8sR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMxQixjQUFjLEVBQUUsa0JBQWtCO1lBQ2xDLFdBQVcsRUFBRSxTQUFTO1NBQ3pCLENBQUM7O1lBQ0ksT0FBTyxHQUFHO1lBQ1osT0FBTyxFQUFFLE9BQU87WUFDaEIsU0FBUyxFQUFFLFNBQVM7U0FDdkI7O1lBQ0csU0FBUyxHQUFHLElBQUksd0JBQXdCLEVBQUU7O1lBQzFDLElBQUksR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztRQUNsRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFFRDs7O09BR0c7Ozs7Ozs7SUFDSCwyQkFBSzs7Ozs7O0lBQUwsVUFBTSxNQUFjLEVBQUUsU0FBaUI7O1lBQy9CLE9BQU8sR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMxQixjQUFjLEVB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LElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6RCxDQUFDOztnQkFuTEosVUFBVTs7OztnQkFKRixVQUFVOztJQXdMbkIsa0JBQUM7Q0FBQSxBQXBMRCxJQW9MQztTQW5MWSxXQUFXOzs7Ozs7SUFHcEIsaUNBQWlGOztJQUNqRiwwQkFBb0Q7Ozs7O0lBRnhDLDJCQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cEhlYWRlcnMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvblZvLCBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IsIFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24nO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgSHR0cFNlcnZpY2Uge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCkgeyB9XHJcbiAgICBwcml2YXRlIGhpc3Ryb3lVcmw6IHN0cmluZyA9IFwiL2FwaS9ydW50aW1lL3N5cy92MS4wL3F1ZXJ5c29sdXRpb24vcHJldmlvdXNRdWVyeVwiO1xyXG4gICAgdXJsOiBzdHJpbmcgPSAnL2FwaS9ydW50aW1lL3N5cy92MS4wL3F1ZXJ5c29sdXRpb24nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmlrDlop7mn6Xor6LmlrnmoYhcclxuICAgICAqIEBwYXJhbSBxdWVyeVNvbHV0aW9uIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICBjcmVhdGUocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgbGV0IGJvZHkgPSBjb252ZXJ0b3IuY29udmVydEpPYmplY3QocXVlcnlTb2x1dGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHRoaXMudXJsLCBib2R5LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruihqOWNlUlE5p+l6K+i5b2T5YmN6KGo5Y2V5b2T5YmN55m75b2V55So5oi355qE5p+l6K+i5pa55qGI5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0gZm9ybUlkIOihqOWNlUlEXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5KGZvcm1JZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBiZWxvbmdJZCA9IGZvcm1JZDtcclxuICAgICAgICAvLyBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6NTEwMC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2J5YmVsb25naWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnVybH0vYmVsb25nSWQvJHtiZWxvbmdJZH1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrBcclxuICAgICAqIEBwYXJhbSBxdWVyeVNvbHV0aW9uIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICB1cGRhdGUocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgbGV0IGJvZHkgPSBjb252ZXJ0b3IuY29udmVydEpPYmplY3QocXVlcnlTb2x1dGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodGhpcy51cmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yig6ZmkXHJcbiAgICAgKiBAdW51c2VkXHJcbiAgICAgKiBAcGFyYW0gaWRBcnJheSDliKDpmaTnmoTop6PlhrPmlrnmoYhJROWIl+ihqFxyXG4gICAgICovXHJcbiAgICAvLyBkZWxldGUoaWRBcnJheTogQXJyYXk8c3RyaW5nPiwgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgIC8vICAgICBpZiAoIWlkQXJyYXkgfHwgaWRBcnJheS5sZW5ndGggPD0gMCkge1xyXG4gICAgLy8gICAgICAgICByZXR1cm47XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgIC8vICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgIC8vICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAvLyAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXHJcbiAgICAvLyAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAvLyAgICAgfTtcclxuICAgIC8vICAgICBsZXQgaWRzID0gJyc7XHJcbiAgICAvLyAgICAgaWRBcnJheS5mb3JFYWNoKGlkID0+IHtcclxuICAgIC8vICAgICAgICAgaWRzID0gaWRzICsgXCIjXCIgKyBpZDtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBsZXQgdXJsID0gYC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGlkcyl9YDtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmRlbGV0ZSh1cmwsIG9wdGlvbnMpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5om56YeP5pu05pawXHJcbiAgICAgKiBAcGFyYW0gb2JqZWN0IDogJ3tkZWZhdWx0SWQsIGJlbG9uZ0lkLCBkZWxldGVkSWRzfSdcclxuICAgICAqL1xyXG4gICAgYmF0Y2hVcGRhdGUoYm9keTogYW55LCBzZXNzaW9uSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAnc2Vzc2lvbmlkJzogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLnVybH0vYmF0Y2hgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucHV0KHVybCwgYm9keSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bpu5jorqTmn6Xor6LmlrnmoYhJRFxyXG4gICAgICogQHVudXNlZFxyXG4gICAgICogQHBhcmFtIGZvcm1JZFxyXG4gICAgICovXHJcbiAgICAvLyBnZXREZWZhdWx0UXVlcnlTb2x1dGlvbihmb3JtSWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgLy8gICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgIC8vICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyxcclxuICAgIC8vICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGxldCBiZWxvbmdJZCA9IGZvcm1JZDtcclxuICAgIC8vICAgICAvLyBsZXQgdXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6NTEwMC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2RlZmF1bHRTb2x1dGlvbi9ieWJlbG9uZ2lkLyR7YmVsb25nSWR9YDtcclxuICAgIC8vICAgICBsZXQgdXJsID0gYC9hcGkvZGV2L21haW4vdjEuMC9xdWVyeXNvbHV0aW9uL2RlZmF1bHRTb2x1dGlvbi9ieWJlbG9uZ2lkLyR7YmVsb25nSWR9YDtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIHsgaGVhZGVyczogaGVhZGVycywgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSk7XHJcbiAgICAvLyB9XHJcbiAgICAvKipcclxuICAgICAgICAqIOaYr+WQpuaUr+aMgVxyXG4gICAgICAgICovXHJcbiAgICBzdXBwb3J0TFMoKSB7XHJcbiAgICAgICAgaWYgKHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcImxvY2FsU3RvcmFnZVwiKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7kv53lrZjml7blgJnvvIzlsZ7mgKfku47lsI/lhpnlj5jmiJDlpKflhplcclxuICAgICAqIEBwYXJhbSBrZXkgXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgXHJcbiAgICAgKi9cclxuICAgIHNldExTKGtleSwgdmFsdWU6IGFueSkge1xyXG4gICAgICAgIGxldCBjb25kaXRpb25zU3RyPSdbXSc7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmKCB0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpe1xyXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uc1N0cj12YWx1ZTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgICAgICAgICBjb25kaXRpb25zU3RyPUpTT04uc3RyaW5naWZ5KGNvbnZlcnRvci5mb3JtYXRDb252ZXJ0Sk9iamVjdCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChrZXkmJnRoaXMuc3VwcG9ydExTKSB7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGNvbmRpdGlvbnNTdHIpO1xyXG4gICAgICAgIH0gXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaXtu+8jOWxnuaAp+S7juWkp+WGmeWPmOaIkOWwj+WGmVxyXG4gICAgICogQHBhcmFtIGtleSBcclxuICAgICAqL1xyXG4gICAgZ2V0TFMoa2V5KTogQXJyYXk8UXVlcnlDb25kaXRpb24+IHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gbmV3IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPigpO1xyXG4gICAgICAgIGlmIChrZXkmJnRoaXMuc3VwcG9ydExTKSB7XHJcbiAgICAgICAgICAgIHZhciB2ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgaWYgKHYgIT0gdW5kZWZpbmVkIHx8IHYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2Uodik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVzdWx0Lmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgY29uc3QgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29udmVydG9yLmZvcm1hdEZyb21Kb2JqZWN0KHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrBcclxuICAgICAqIEBwYXJhbSBxdWVyeVNvbHV0aW9uIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICBzYXZlSGlzdHJveShxdWVyeVNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm8sIHNlc3Npb25JZDogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBzZXNzaW9uSWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgIGxldCBib2R5ID0gY29udmVydG9yLmNvbnZlcnRKT2JqZWN0KHF1ZXJ5U29sdXRpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucHV0KHRoaXMuaGlzdHJveVVybCwgYm9keSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuIl19