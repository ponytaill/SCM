/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Injector, ComponentFactoryResolver, HostBinding, Output, EventEmitter } from '@angular/core';
import { ProcessTime } from './model/process-time';
import { DomSanitizer } from '@angular/platform-browser';
import { ProcessDesignerUIState } from './app/process-designer.uistate';
import { ResourceKeys } from './model/resourceKeys';
import { ProcessDesignerViewModel } from './app/process-designer.viewmodel';
import { ExecuteFormModel, TerminalType } from './views/execute-forms/entities/execute-form.entity';
import { BsModalService } from '@farris/ui-modal';
import { ProcessDesignerDataService } from './domain/process-designer.dataservice';
import { LoadingService } from '@farris/ui-loading';
import { NotifyService } from '@farris/ui-notify';
import { MessagerService } from '@farris/ui-messager';
import { WFFlowElementsViewModel } from './app/wf-flowElements.viewModel';
import { PropertyPanelComponent } from '@farris/ui-property-panel';
import { SignRuleComponent } from './views/sign-rule/sign-rule.component';
import { ProcessInfo } from './model/process-info';
import { RTProcessInfo } from './model/rt-process-info';
import { of } from 'rxjs';
import { AuditEvent } from './domain/entities/audit-processDef-info';
import { NoteComponent } from './views/note/note.component';
import { ProcessDeUtil } from './domain/process-de-util';
var WfProcessEditorComponent = /** @class */ (function () {
    function WfProcessEditorComponent(sanitizer, uiState, viewModel, service, loadService, notify, message, activity, injector, modalService, resolver) {
        var _this = this;
        this.sanitizer = sanitizer;
        this.uiState = uiState;
        this.viewModel = viewModel;
        this.service = service;
        this.loadService = loadService;
        this.notify = notify;
        this.message = message;
        this.activity = activity;
        this.injector = injector;
        this.modalService = modalService;
        this.resolver = resolver;
        this.flag = true;
        this.cls = 'farris-main-area flex-column';
        this.action = 'edit';
        this.mode = 'general';
        this.close = new EventEmitter();
        /**
         * 监听事件处理
         */
        this.eventHandler = (/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            /** @type {?} */
            var postData = (/** @type {?} */ (event.data));
            if (_this.uiState.POST_MESSAGE_TARGET.search(event.origin) > -1) {
                switch (postData.action) {
                    case ResourceKeys.wf_initProperty:
                        if (_this.flag) {
                            _this.flag = false;
                            _this.closeLoading();
                        }
                        _this.viewModel.initProcessProperty(postData.data);
                        break;
                    case ResourceKeys.wf_save:
                        _this.uiState.content = postData.data;
                        _this.showLoading();
                        _this.save();
                        break;
                    case ResourceKeys.wf_deploy:
                        _this.uiState.content = postData.data;
                        _this.showLoading();
                        _this.viewModel.deployProcess(_this.uiState.content).subscribe((/**
                         * @param {?} data
                         * @return {?}
                         */
                        function (data) {
                            _this.closeLoading();
                            _this.viewModel.saveProcess(_this.uiState.content, _this.processInfo, 0).subscribe((/**
                             * @param {?} r
                             * @return {?}
                             */
                            function (r) { }));
                            _this.notify.success((/** @type {?} */ ({
                                title: '系统提示', msg: '发布成功', timeout: 3000
                            })));
                            /** @type {?} */
                            var process = JSON.parse(_this.uiState.content);
                            _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, true, process.DefaultProcess.Key);
                        }), (/**
                         * @param {?} error
                         * @return {?}
                         */
                        function (error) {
                            _this.closeLoading();
                            _this.notify.error((/** @type {?} */ ({
                                title: '系统提示', msg: '发布失败，请检查流程是否正确！', timeout: 3000
                            })));
                            /** @type {?} */
                            var process = JSON.parse(_this.uiState.content);
                            _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_Deploy, false, process.DefaultProcess.Key);
                        }));
                        break;
                    case ResourceKeys.wf_saveAs:
                        /** @type {?} */
                        var prcoess = postData.data;
                        _this.viewModel.saveAsProcess(prcoess, _this.processInfo);
                        break;
                    case ResourceKeys.wf_sync:
                        /** @type {?} */
                        var content = postData.data;
                        _this.viewModel.syncDtProcess(content, _this.rtProcessInfo);
                        break;
                    case ResourceKeys.wf_note:
                        _this.note(postData.data);
                        break;
                    case ResourceKeys.wf_closeDesigner:
                        _this.close.emit();
                        break;
                    case ResourceKeys.getActivities: // 获取活动节点信息
                        _this.uiState.getUserActList(postData.data);
                        break;
                    case ResourceKeys.getEndEvents: // 获取所有结束节点信息
                        _this.uiState.getEndEventList(postData.data);
                        break;
                    case 'loaded':
                        _this.openProcContent();
                        break;
                    case ResourceKeys.wf_showTip:
                        _this.showTip(postData.data);
                        break;
                    default:
                        _this.viewModel.setProperty(postData.data);
                        break;
                }
            }
        });
        // 如果存在消息监听，先删掉
        if (WfProcessEditorComponent.func) {
            window.removeEventListener('message', WfProcessEditorComponent.func, false);
        }
        this.addMessageListener();
        this.uiState.getAdministratorInfo();
    }
    Object.defineProperty(WfProcessEditorComponent.prototype, "time", {
        get: /**
         * @return {?}
         */
        function () {
            return this._time;
        },
        set: /**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            this._time = t;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.getSrc();
        this.uiState.initUIState();
        this.showLoading();
        this.updateProperty();
        // 获取消息列表
        this.uiState.getMessageChannels();
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.getSrc = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var processCategoryId;
        if (this._time === ProcessTime.rt) {
            processCategoryId = this.rtProcessInfo.flowFormId;
        }
        else {
            processCategoryId = this.processInfo.flowFormId;
        }
        this.viewModel.getProcessCategory(processCategoryId).subscribe((/**
         * @param {?} procCategory
         * @return {?}
         */
        function (procCategory) {
            _this.src = '/platform/runtime/wf/web/designer/index.html';
            if (_this._time === ProcessTime.rt) {
                _this.src = _this.src + '?time=rt';
            }
            else {
                _this.src = _this.src + "?time=dt";
                if (procCategory) {
                    _this.src = _this.src + ("&bizCategoryId=" + procCategory.businessObjectId);
                }
            }
            if (_this.action === 'view') {
                _this.src = _this.src + '&action=view';
            }
            else {
                _this.src = _this.src + '&action=edit';
            }
            if (_this.mode === 'general') {
                _this.src = _this.src + '&mode=general';
            }
            else {
                _this.src = _this.src + '&mode=simplify';
            }
            _this.src = _this.sanitizer.bypassSecurityTrustResourceUrl(_this.src);
        }));
    };
    /**
     * 添加事件监听
     */
    /**
     * 添加事件监听
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.addMessageListener = /**
     * 添加事件监听
     * @private
     * @return {?}
     */
    function () {
        window.addEventListener('message', this.eventHandler, false);
        WfProcessEditorComponent.func = this.eventHandler;
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.updateProperty = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.propertyPanel.propertyChanged.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.updateChangeProperty(data);
        }));
        this.propertyPanel.submitModal.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.updateChangeProperty(data.changeObject);
        }));
        return false; // 防止冒泡
    };
    /**
     * 更新属性
     */
    /**
     * 更新属性
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.updateChangeProperty = /**
     * 更新属性
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        data.Id = this.uiState.propertyData.Id;
        switch (data.propertyID) {
            case ResourceKeys.EntryForm:
                this.bindEntryFormInfo(data);
                break;
            case ResourceKeys.ApprovalItems:
                this.sendMessage(ResourceKeys.updateProperty, JSON.stringify(data));
                this.activity.buildCounterSignVariables(data.propertyValue);
                break;
            case ResourceKeys.CompleteStrategy:
                this.beforeCompleteStrategyChange(data).subscribe((/**
                 * @param {?} b
                 * @return {?}
                 */
                function (b) {
                    if (b) {
                        _this.sendMessage(ResourceKeys.updateProperty, JSON.stringify(data));
                        _this.completeStrategyChanged(data.propertyValue);
                    }
                    else { // 刷新属性框
                        _this.sendMessage(ResourceKeys.refresh, JSON.stringify(data));
                    }
                }));
                break;
            case ResourceKeys.SignRule:
                this.sendMessage(ResourceKeys.updateProperty, JSON.stringify(data));
                break;
            default:
                this.sendMessage(ResourceKeys.updateProperty, JSON.stringify(data));
                break;
        }
    };
    /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @param data
     */
    /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.bindEntryFormInfo = /**
     * 绑定流程分类的参数列表，流程构件，表单赋值
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var flowformId = data.propertyValue.id;
        if (flowformId) {
            this.viewModel.getFlowFormInfoById(flowformId).subscribe((/**
             * @param {?} info
             * @return {?}
             */
            function (info) {
                data.flowForm = info.flowForm;
                data.formalParameters = info.formalParameters;
                data.processBizComponnets = info.bizComponents;
                data.executeForms = [];
                info.excuteForms.forEach((/**
                 * @param {?} form
                 * @return {?}
                 */
                function (form) {
                    if (form.isDefault) {
                        /** @type {?} */
                        var executeForms = _this.ConvertExecuteForm(form);
                        data.executeForms = data.executeForms.concat(executeForms); // 流程绑定默认单据
                    }
                }));
                data.customizeActions = info.customizeActions.filter((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.isAll === true; })).map((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return ({
                    id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                    actualParameters: a.actualParameters.map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return ({
                        Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                    }); }))
                }); }));
                _this.sendMessage(ResourceKeys.loadBizActivity, info.bizActivities || []);
                _this.sendMessage(ResourceKeys.updateProperty, JSON.stringify(data));
            }));
        }
    };
    /**
     * @private
     * @param {?} record
     * @return {?}
     */
    WfProcessEditorComponent.prototype.note = /**
     * @private
     * @param {?} record
     * @return {?}
     */
    function (record) {
        var _this = this;
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(NoteComponent);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.record = record;
        /** @type {?} */
        var modalConfig = {
            title: '流程变更记录',
            width: 800,
            height: 520,
            showButtons: true,
            buttons: compRef.instance.footer
        };
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.cancel.subscribe((/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) { return dialog.close(); }));
        compRef.instance.submit.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.sendMessage(ResourceKeys.wf_note, data);
            dialog.close();
        }));
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.openProcContent = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.time === ProcessTime.dt) {
            if (this.processInfo) {
                if (this.processInfo.processKey === ResourceKeys.new && this.processInfo.flowFormId) {
                    this.openNewProcess(this.processInfo.flowFormId);
                }
                else {
                    // TODO：首先获取流程分类信息，确保流程分类和流程构件获取到（会稍微影响设计器打开速度）
                    this.viewModel.getFlowFormInfoById(this.processInfo.flowFormId).subscribe((/**
                     * @param {?} info
                     * @return {?}
                     */
                    function (info) {
                        _this.sendMessage(ResourceKeys.loadBizActivity, info.bizActivities || []);
                        _this.getProcContent(_this.processInfo.processKey).subscribe((/**
                         * @param {?} re
                         * @return {?}
                         */
                        function (re) {
                            _this.uiState.content = _this.checkModelContent(JSON.stringify(re));
                            _this.sendMessage(ResourceKeys.open, {
                                content: _this.uiState.content
                            });
                        }));
                    }));
                }
            }
            else {
                throw new Error('不存在设计时流程信息！请先赋值！');
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (this.rtProcessInfo) {
                this.viewModel.getFlowFormInfoById(this.rtProcessInfo.flowFormId).subscribe((/**
                 * @param {?} info
                 * @return {?}
                 */
                function (info) {
                    _this.sendMessage(ResourceKeys.loadBizActivity, info.bizActivities || []);
                    _this.getProcContent(_this.rtProcessInfo.rtProcDefId).subscribe((/**
                     * @param {?} re
                     * @return {?}
                     */
                    function (re) {
                        _this.uiState.content = _this.checkModelContent(JSON.stringify(re));
                        _this.sendMessage(ResourceKeys.open, {
                            content: _this.uiState.content
                        });
                    }));
                }));
            }
            else {
                throw new Error('不存在运行时流程信息！请先赋值！');
            }
        }
    };
    /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @param ffId 流程分类ID
     */
    /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @private
     * @param {?} ffId 流程分类ID
     * @return {?}
     */
    WfProcessEditorComponent.prototype.openNewProcess = /**
     * 新增流程，基于流程分类获取参数列表，构件和表单
     * @private
     * @param {?} ffId 流程分类ID
     * @return {?}
     */
    function (ffId) {
        var _this = this;
        this.viewModel.getFlowFormInfoById(ffId)
            .subscribe((/**
         * @param {?} info
         * @return {?}
         */
        function (info) {
            /** @type {?} */
            var processBizComponnets = info.bizComponents;
            /** @type {?} */
            var customizeActions = info.customizeActions.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.isAll === true; })).map((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return ({
                id: a.id, code: a.code, name: a.name, terminalType: a.terminal,
                actualParameters: a.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code, Value: p.value, ValueText: p.name, Tag: 'expression'
                }); }))
            }); }));
            /** @type {?} */
            var executeForms = [];
            info.excuteForms.forEach((/**
             * @param {?} form
             * @return {?}
             */
            function (form) {
                if (form.isDefault) {
                    /** @type {?} */
                    var forms = _this.ConvertExecuteForm(form);
                    executeForms = executeForms.concat(forms); // 流程绑定默认单据
                }
            }));
            // 如果不存在表单定义，需要去表单格式列表取一下
            if (executeForms.length === 0
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === TerminalType.PC; })) === -1
                || executeForms.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.TerminalType === TerminalType.MOBILE; })) === -1) {
                _this.viewModel.getFormFormatsByBizCategory().subscribe((/**
                 * @param {?} formFormats
                 * @return {?}
                 */
                function (formFormats) {
                    if (formFormats && formFormats.length > 0) {
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) { return e.TerminalType === TerminalType.PC; })) === -1) {
                            /** @type {?} */
                            var formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            function (f) { return f.terminal === 'PC' && f.status === 0; }))[0];
                            if (formFormat) {
                                executeForms.push(_this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                        if (executeForms.findIndex((/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) { return e.TerminalType === TerminalType.MOBILE; })) === -1) {
                            /** @type {?} */
                            var formFormat = formFormats.filter((/**
                             * @param {?} f
                             * @return {?}
                             */
                            function (f) { return f.terminal === 'Mobile' && f.status === 0; }))[0];
                            if (formFormat) {
                                executeForms.push(_this.formFormat2ExecuteForm(formFormat));
                            }
                        }
                    }
                    _this.sendMessage(ResourceKeys.loadBizActivity, info.bizActivities || []);
                    _this.sendMessage(ResourceKeys.new, {
                        name: _this.processInfo.processName,
                        bizObjId: _this.processInfo.bizObjId,
                        ffId: ffId,
                        ffName: _this.processInfo.flowFormName,
                        startMode: _this.processInfo.startMode,
                        formalParameters: info.formalParameters,
                        processBizComponnets: processBizComponnets,
                        executeForms: executeForms,
                        customizeActions: customizeActions,
                        processDescription: info.flowForm.processDescription
                    });
                }));
            }
            else {
                _this.sendMessage(ResourceKeys.loadBizActivity, info.bizActivities || []);
                _this.sendMessage(ResourceKeys.new, {
                    name: _this.processInfo.processName,
                    bizObjId: _this.processInfo.bizObjId,
                    ffId: ffId,
                    ffName: _this.processInfo.flowFormName,
                    startMode: _this.processInfo.startMode,
                    formalParameters: info.formalParameters,
                    processBizComponnets: processBizComponnets,
                    executeForms: executeForms,
                    customizeActions: customizeActions,
                    processDescription: info.flowForm.processDescription
                });
            }
        }));
    };
    // 向子页面发送消息
    // 向子页面发送消息
    /**
     * @private
     * @param {?} action
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.sendMessage = 
    // 向子页面发送消息
    /**
     * @private
     * @param {?} action
     * @param {?} data
     * @return {?}
     */
    function (action, data) {
        /** @type {?} */
        var iframeWindow = this.iframe.nativeElement.contentWindow;
        /** @type {?} */
        var message = this.wrapMessage(action, data);
        iframeWindow.postMessage(message, this.uiState.POST_MESSAGE_TARGET);
    };
    // 包装消息内容
    // 包装消息内容
    /**
     * @private
     * @param {?} action
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.wrapMessage = 
    // 包装消息内容
    /**
     * @private
     * @param {?} action
     * @param {?} data
     * @return {?}
     */
    function (action, data) {
        return {
            action: action,
            data: data
        };
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showTip = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.type === 'message') {
            switch (data.level) {
                case 'warning':
                    this.message.warning(data.message);
                    break;
                case 'error':
                    this.message.error(data.message);
                    break;
                default:
                    this.message.info(data.message);
                    break;
            }
        }
        else if (data.type === 'notify') {
            switch (data.level) {
                case 'warning':
                    this.notify.warning(data.message);
                    break;
                case 'error':
                    this.notify.error(data.message);
                    break;
                default:
                    this.notify.info(data.message);
                    break;
            }
        }
    };
    /**
     * 获取流程上下文
     * @param id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     */
    /**
     * 获取流程上下文
     * @param {?} id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     * @return {?}
     */
    WfProcessEditorComponent.prototype.getProcContent = /**
     * 获取流程上下文
     * @param {?} id 流程定义ID（设计时使用流程定义Key，运行时使用流程定义ID）
     * @return {?}
     */
    function (id) {
        if (id) {
            if (this.time === ProcessTime.dt) {
                return this.service.getProcContentbyKey(id);
            }
            else if (this.time === ProcessTime.rt) {
                return this.service.getRTProcContentbyId(id);
            }
            else {
                throw new Error('设计器运行时机错误！');
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.save = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var process = JSON.parse(this.uiState.content);
        // this.uiState.content = this.checkModelContent(this.uiState.content);
        this.saveHttp().subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.closeLoading();
            _this.notify.success((/** @type {?} */ ({
                title: '系统提示', msg: '保存成功', timeout: 3000
            })));
            if (_this.time === ProcessTime.dt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, true, process.DefaultProcess.Key);
            }
            else if (_this.time === ProcessTime.rt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, true, process.DefaultProcess.Key);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.closeLoading();
            _this.notify.error((/** @type {?} */ ({
                title: '系统提示', msg: '保存失败，请检查流程是否正确！', timeout: 3000
            })));
            if (_this.time === ProcessTime.dt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveDT, false, process.DefaultProcess.Key);
            }
            else if (_this.time === ProcessTime.rt) {
                _this.viewModel.auditProcessDef(AuditEvent.WF_ProcessDef_SaveRT, false, process.DefaultProcess.Key);
            }
        }));
    };
    /**
     * 保存流程定义（设计时+运行时）
     */
    /**
     * 保存流程定义（设计时+运行时）
     * @private
     * @return {?}
     */
    WfProcessEditorComponent.prototype.saveHttp = /**
     * 保存流程定义（设计时+运行时）
     * @private
     * @return {?}
     */
    function () {
        if (this.uiState.content) {
            if (this.time === ProcessTime.dt) {
                return this.viewModel.saveProcess(this.uiState.content, this.processInfo, 1);
            }
            else if (this.time === ProcessTime.rt) {
                return this.viewModel.saveRTProcess(this.uiState.content, this.rtProcessInfo.rtProcDefId);
            }
            else {
                throw new Error('设计器运行时机错误！');
            }
        }
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.showLoading = /**
     * @return {?}
     */
    function () {
        this.loadService.show({ container: 'body', message: '', type: 1 });
    };
    /**
     * @return {?}
     */
    WfProcessEditorComponent.prototype.closeLoading = /**
     * @return {?}
     */
    function () {
        this.loadService.close();
    };
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    WfProcessEditorComponent.prototype.ConvertExecuteForm = /**
     * @private
     * @param {?} form
     * @return {?}
     */
    function (form) {
        /** @type {?} */
        var executeForms = new Array();
        if (form.terminal === 'web,app') {
            /** @type {?} */
            var webForm = new ExecuteFormModel();
            webForm.ComponentId = form.appId;
            webForm.formFormatId = form.formFormatId;
            webForm.FormType = form.formType;
            webForm.Name = form.name;
            webForm.TerminalType = TerminalType.PC;
            if (form.actualParameters && form.actualParameters.length > 0) {
                webForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Value: p.value
                }); }));
            }
            executeForms.push(webForm);
            /** @type {?} */
            var appForm = new ExecuteFormModel();
            appForm.ComponentId = form.appId;
            appForm.formFormatId = form.formFormatId;
            appForm.FormType = form.formType;
            appForm.Name = form.name;
            appForm.TerminalType = TerminalType.MOBILE;
            if (form.actualParameters && form.actualParameters.length > 0) {
                appForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Value: p.value
                }); }));
            }
            executeForms.push(appForm);
        }
        else {
            /** @type {?} */
            var executeForm = new ExecuteFormModel();
            executeForm.ComponentId = form.appId;
            executeForm.formFormatId = form.formFormatId;
            executeForm.FormType = form.formType;
            executeForm.Name = form.name;
            switch (form.terminal) {
                case 'web':
                    executeForm.TerminalType = TerminalType.PC;
                    break;
                case 'app':
                    executeForm.TerminalType = TerminalType.MOBILE;
                    break;
            }
            if (form.actualParameters && form.actualParameters.length > 0) {
                executeForm.ActualParameters = form.actualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return ({
                    Name: p.code,
                    Value: p.value
                }); }));
            }
            executeForms.push(executeForm);
        }
        return executeForms;
    };
    /**
     * @private
     * @param {?} formformat
     * @return {?}
     */
    WfProcessEditorComponent.prototype.formFormat2ExecuteForm = /**
     * @private
     * @param {?} formformat
     * @return {?}
     */
    function (formformat) {
        /** @type {?} */
        var form = new ExecuteFormModel();
        form.Id = ProcessDeUtil.GenerateElementId();
        form.ComponentId = null;
        form.formFormatId = formformat.id;
        form.FormType = '0';
        form.Name = formformat.name;
        switch (formformat.terminal) {
            case 'PC':
                form.TerminalType = TerminalType.PC;
                break;
            case 'Mobile':
                form.TerminalType = TerminalType.MOBILE;
                break;
        }
        if (formformat.urlParameters && formformat.urlParameters.length > 0) {
            form.ActualParameters = formformat.urlParameters.map((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return ({
                Name: p.code,
                Value: p.value
            }); }));
        }
        return form;
    };
    /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    WfProcessEditorComponent.prototype.completeStrategyChanged = /**
     * @private
     * @param {?} strategy
     * @return {?}
     */
    function (strategy) {
        var _this = this;
        if (strategy !== this.uiState.completeIterator[0].key) {
            // 参与者存在自动审批的情况下，不允许修改完成策略为会签规则
            // if (this.uiState.propertyData.ParticipantSchemes
            //   && this.uiState.propertyData.ParticipantSchemes.options
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers
            //   && this.uiState.propertyData.ParticipantSchemes.options.automaticPerformers.length > 0) {
            //   return;
            // } else {
            // 会签规则不存在，即由抢占模式，变为会签时
            if (!this.uiState.propertyData.SignRule) {
                // 会签是自动弹出会签规则编辑
                /** @type {?} */
                var compFactory = this.resolver.resolveComponentFactory(SignRuleComponent);
                /** @type {?} */
                var compRef = compFactory.create(this.injector);
                compRef.instance.value = [];
                // compRef.instance.counterSignVariables = this.uiState.counterSignVariables || [];
                // compRef.instance.approvalItems = this.uiState.approvalItems || [];
                /** @type {?} */
                var modalConfig = Object.assign(compRef.instance.modalConfig, { buttons: compRef.instance.modalFooter });
                /** @type {?} */
                var dialog_1 = this.modalService.show(compRef, modalConfig);
                compRef.instance.closeModal.subscribe((/**
                 * @param {?} $event
                 * @return {?}
                 */
                function ($event) { return dialog_1.close(); }));
                compRef.instance.submitModal.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    _this.updateChangeProperty({
                        categoryId: 'performerProperty',
                        propertyID: ResourceKeys.SignRule,
                        propertyValue: data.value
                    });
                    dialog_1.close();
                }));
            }
            // 会签规则下，驳回规则约束
            if (((/** @type {?} */ (this.uiState.propertyData.BackWardRule))).SelectTargetAble === true) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.message.warning('会签策略下,“驳回规则”不允许“动态选择驳回级次”，请修改！');
                }), 500);
            }
            // }
        }
    };
    /**
     * 完成策略调整校验
     */
    /**
     * 完成策略调整校验
     * @private
     * @param {?} data
     * @return {?}
     */
    WfProcessEditorComponent.prototype.beforeCompleteStrategyChange = /**
     * 完成策略调整校验
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (this.time === ProcessTime.rt) {
            return this.viewModel.beforeCompleteStrategyChange(data, this.rtProcessInfo);
        }
        else {
            return of(true);
        }
    };
    /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     */
    /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     * @private
     * @param {?} content
     * @return {?}
     */
    WfProcessEditorComponent.prototype.checkModelContent = /**
     * 保存，发布，另存，同步操作时
     * 校验模型的流程分类ID与列表存储是否一致，不一致时，以列表为准
     * @private
     * @param {?} content
     * @return {?}
     */
    function (content) {
        /** @type {?} */
        var process = JSON.parse(content);
        /** @type {?} */
        var modelBizDefKey = process.DefaultProcess.extensionElements.find((/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey;
        if (this.time === ProcessTime.dt) {
            if (modelBizDefKey === this.processInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey = this.processInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
        else if (this.time === ProcessTime.rt) {
            if (modelBizDefKey === this.rtProcessInfo.flowFormId) {
                return content;
            }
            else {
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefKey = this.rtProcessInfo.flowFormId;
                process.DefaultProcess.extensionElements.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.ClrTypeID === 'wf.ProcessHeader'; })).BizDefName = this.uiState.flowFormInfo.flowForm.name;
                return JSON.stringify(process);
            }
        }
    };
    /**
     * 消息监听处理方法
     */
    WfProcessEditorComponent.func = null;
    WfProcessEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'wf-process-editor',
                    template: "\n  <div class=\"f-utils-flex-column h-100 m-2\">\n    <div class=\"flex-auto d-flex flex-fill flex-row\" style=\"position:relative; overflow: hidden\">\n      <div class=\"flex-grow-1\">\n        <div *ngIf=\"src\" class=\"h-100\">\n          <iframe #iframe class=\"bpmn-designer\" [src]=\"src\" frameborder=\"0\">\n          </iframe>\n        </div>\n      </div>\n      <div>\n        <app-property-panel #propertyPanel [(propertyConfig)]=\"uiState.propertyConfig\" [(propertyData)]=\"uiState.propertyData\"\n          width=\"235\" showCloseBtn=\"false\"></app-property-panel>\n      </div>\n    </div>\n  </div>",
                    styles: ["\n    .bpmn-designer {\n      height: 100%;\n      min-height: 400px;\n      width: 100%;\n    }"]
                }] }
    ];
    /** @nocollapse */
    WfProcessEditorComponent.ctorParameters = function () { return [
        { type: DomSanitizer },
        { type: ProcessDesignerUIState },
        { type: ProcessDesignerViewModel },
        { type: ProcessDesignerDataService },
        { type: LoadingService },
        { type: NotifyService },
        { type: MessagerService },
        { type: WFFlowElementsViewModel },
        { type: Injector },
        { type: BsModalService },
        { type: ComponentFactoryResolver }
    ]; };
    WfProcessEditorComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        time: [{ type: Input }],
        processInfo: [{ type: Input }],
        rtProcessInfo: [{ type: Input }],
        action: [{ type: Input }],
        mode: [{ type: Input }],
        close: [{ type: Output }],
        propertyPanel: [{ type: ViewChild, args: ['propertyPanel',] }],
        iframe: [{ type: ViewChild, args: ['iframe',] }]
    };
    return WfProcessEditorComponent;
}());
export { WfProcessEditorComponent };
if (false) {
    /**
     * 消息监听处理方法
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.func;
    /** @type {?} */
    WfProcessEditorComponent.prototype.src;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.flag;
    /** @type {?} */
    WfProcessEditorComponent.prototype.cls;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype._time;
    /** @type {?} */
    WfProcessEditorComponent.prototype.processInfo;
    /** @type {?} */
    WfProcessEditorComponent.prototype.rtProcessInfo;
    /** @type {?} */
    WfProcessEditorComponent.prototype.action;
    /** @type {?} */
    WfProcessEditorComponent.prototype.mode;
    /** @type {?} */
    WfProcessEditorComponent.prototype.close;
    /** @type {?} */
    WfProcessEditorComponent.prototype.propertyPanel;
    /** @type {?} */
    WfProcessEditorComponent.prototype.iframe;
    /**
     * 监听事件处理
     * @type {?}
     */
    WfProcessEditorComponent.prototype.eventHandler;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.sanitizer;
    /** @type {?} */
    WfProcessEditorComponent.prototype.uiState;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.viewModel;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.loadService;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.activity;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    WfProcessEditorComponent.prototype.resolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2YtcHJvY2Vzcy1lZGl0b3IuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi93Zi1wcm9jZXNzLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLHdCQUF3QixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZKLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDekQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDeEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRXBELE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBRTVFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLEVBQUUsTUFBTSxvREFBb0QsQ0FBQztBQUVwRyxPQUFPLEVBQWdCLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRWhFLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQ25GLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsYUFBYSxFQUFpQixNQUFNLG1CQUFtQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUcxRSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNuRSxPQUFPLEVBQUUsaUJB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Z0JBcERRLFlBQVk7Z0JBQ1osc0JBQXNCO2dCQUd0Qix3QkFBd0I7Z0JBTXhCLDBCQUEwQjtnQkFDMUIsY0FBYztnQkFDZCxhQUFhO2dCQUNiLGVBQWU7Z0JBQ2YsdUJBQXVCO2dCQWhCMEIsUUFBUTtnQkFVM0MsY0FBYztnQkFWK0Isd0JBQXdCOzs7c0JBbUV6RixXQUFXLFNBQUMsT0FBTzt1QkFJbkIsS0FBSzs4QkFRTCxLQUFLO2dDQUdMLEtBQUs7eUJBR0wsS0FBSzt1QkFHTCxLQUFLO3dCQUdMLE1BQU07Z0NBRU4sU0FBUyxTQUFDLGVBQWU7eUJBR3pCLFNBQVMsU0FBQyxRQUFROztJQXNtQnJCLCtCQUFDO0NBQUEsQUF4cUJELElBd3FCQztTQTlvQlksd0JBQXdCOzs7Ozs7O0lBS25DLDhCQUEyQjs7SUFFM0IsdUNBQVM7Ozs7O0lBRVQsd0NBQW9COztJQUVwQix1Q0FDcUM7Ozs7O0lBRXJDLHlDQUEyQjs7SUFTM0IsK0NBQ3lCOztJQUV6QixpREFDNkI7O0lBRTdCLDBDQUNpQzs7SUFFakMsd0NBQ3lDOztJQUV6Qyx5Q0FBMEM7O0lBRTFDLGlEQUNzQzs7SUFFdEMsMENBQ21COzs7OztJQTBFbkIsZ0RBb0VDOzs7OztJQTNJQyw2Q0FBK0I7O0lBQy9CLDJDQUFzQzs7Ozs7SUFDdEMsNkNBQTJDOzs7OztJQUMzQywyQ0FBMkM7Ozs7O0lBQzNDLCtDQUFtQzs7Ozs7SUFDbkMsMENBQTZCOzs7OztJQUM3QiwyQ0FBZ0M7Ozs7O0lBQ2hDLDRDQUF5Qzs7Ozs7SUFDekMsNENBQTBCOzs7OztJQUMxQixnREFBb0M7Ozs7O0lBQ3BDLDRDQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBJbmplY3RvciwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBIb3N0QmluZGluZywgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUHJvY2Vzc1RpbWUgfSBmcm9tICcuL21vZGVsL3Byb2Nlc3MtdGltZSc7XHJcbmltcG9ydCB7IERvbVNhbml0aXplciB9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuaW1wb3J0IHsgUmVzb3VyY2VLZXlzIH0gZnJvbSAnLi9tb2RlbC9yZXNvdXJjZUtleXMnO1xyXG5pbXBvcnQgeyBGbG93Rm9ybUluZm8gfSBmcm9tICcuL2RvbWFpbi9lbnRpdGllcy9mbG93Zm9ybS1pbmZvJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVmlld01vZGVsIH0gZnJvbSAnLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci52aWV3bW9kZWwnO1xyXG5pbXBvcnQgeyBCaXpDb21wb25lbnRFbnRpdHkgfSBmcm9tICcuL2RvbWFpbi9lbnRpdGllcy9iaXotY29tcG9uZW50LmVudGl0eSc7XHJcbmltcG9ydCB7IEV4ZWN1dGVGb3JtTW9kZWwsIFRlcm1pbmFsVHlwZSB9IGZyb20gJy4vdmlld3MvZXhlY3V0ZS1mb3Jtcy9lbnRpdGllcy9leGVjdXRlLWZvcm0uZW50aXR5JztcclxuaW1wb3J0IHsgRXhjdXRlRm9ybUVudGl0eSB9IGZyb20gJy4vZG9tYWluL2VudGl0aWVzL2V4Y3V0ZS1mb3JtLmVudGl0eSc7XHJcbmltcG9ydCB7IE1vZGFsT3B0aW9ucywgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgQmFja1dhcmRSdWxlIH0gZnJvbSAnLi92aWV3cy9iYWNrd2FyZC1ydWxlL2JhY2t3YXJkLXJ1bGUuZW50aXR5JztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyRGF0YVNlcnZpY2UgfSBmcm9tICcuL2RvbWFpbi9wcm9jZXNzLWRlc2lnbmVyLmRhdGFzZXJ2aWNlJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlLCBOb3RpZnlPcHRpb25zIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgV0ZGbG93RWxlbWVudHNWaWV3TW9kZWwgfSBmcm9tICcuL2FwcC93Zi1mbG93RWxlbWVudHMudmlld01vZGVsJztcclxuaW1wb3J0IHsgUG9zdE1lc3NhZ2VEYXRhIH0gZnJvbSAnLi9tb2RlbC9wb3N0TWVzc2FnZURhdGEnO1xyXG5pbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgUHJvcGVydHlQYW5lbENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBTaWduUnVsZUNvbXBvbmVudCB9IGZyb20gJy4vdmlld3Mvc2lnbi1ydWxlL3NpZ24tcnVsZS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQcm9jZXNzSW5mbyB9IGZyb20gJy4vbW9kZWwvcHJvY2Vzcy1pbmZvJztcclxuaW1wb3J0IHsgUlRQcm9jZXNzSW5mbyB9IGZyb20gJy4vbW9kZWwvcnQtcHJvY2Vzcy1pbmZvJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YsIGZvcmtKb2luIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEF1ZGl0RXZlbnQgfSBmcm9tICcuL2RvbWFpbi9lbnRpdGllcy9hdWRpdC1wcm9jZXNzRGVmLWluZm8nO1xyXG5pbXBvcnQgeyBOb3RlQ29tcG9uZW50IH0gZnJvbSAnLi92aWV3cy9ub3RlL25vdGUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUHJvY2Vzc0RlVXRpbCB9IGZyb20gJy4vZG9tYWluL3Byb2Nlc3MtZGUtdXRpbCc7XHJcbmltcG9ydCB7IEZsb3dGb3JtRW50aXR5IH0gZnJvbSAnLi9kb21haW4vZW50aXRpZXMvZmxvd2Zvcm0uZW50aXR5JztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dmLXByb2Nlc3MtZWRpdG9yJyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gIDxkaXYgY2xhc3M9XCJmLXV0aWxzLWZsZXgtY29sdW1uIGgtMTAwIG0tMlwiPlxyXG4gICAgPGRpdiBjbGFzcz1cImZsZXgtYXV0byBkLWZsZXggZmxleC1maWxsIGZsZXgtcm93XCIgc3R5bGU9XCJwb3NpdGlvbjpyZWxhdGl2ZTsgb3ZlcmZsb3c6IGhpZGRlblwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiZmxleC1ncm93LTFcIj5cclxuICAgICAgICA8ZGl2ICpuZ0lmPVwic3JjXCIgY2xhc3M9XCJoLTEwMFwiPlxyXG4gICAgICAgICAgPGlmcmFtZSAjaWZyYW1lIGNsYXNzPVwiYnBtbi1kZXNpZ25lclwiIFtzcmNdPVwic3JjXCIgZnJhbWVib3JkZXI9XCIwXCI+XHJcbiAgICAgICAgICA8L2lmcmFtZT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXY+XHJcbiAgICAgICAgPGFwcC1wcm9wZXJ0eS1wYW5lbCAjcHJvcGVydHlQYW5lbCBbKHByb3BlcnR5Q29uZmlnKV09XCJ1aVN0YXRlLnByb3BlcnR5Q29uZmlnXCIgWyhwcm9wZXJ0eURhdGEpXT1cInVpU3RhdGUucHJvcGVydHlEYXRhXCJcclxuICAgICAgICAgIHdpZHRoPVwiMjM1XCIgc2hvd0Nsb3NlQnRuPVwiZmFsc2VcIj48L2FwcC1wcm9wZXJ0eS1wYW5lbD5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5gLFxyXG4gIHN0eWxlczogW2BcclxuICAgIC5icG1uLWRlc2lnbmVyIHtcclxuICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICBtaW4taGVpZ2h0OiA0MDBweDtcclxuICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICB9YFxyXG4gIF1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBXZlByb2Nlc3NFZGl0b3JDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAvKipcclxuICAgKiDmtojmga/nm5HlkKzlpITnkIbmlrnms5VcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBmdW5jID0gbnVsbDtcclxuXHJcbiAgc3JjOiBhbnk7XHJcblxyXG4gIHByaXZhdGUgZmxhZyA9IHRydWU7XHJcblxyXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKVxyXG4gIGNscyA9ICdmYXJyaXMtbWFpbi1hcmVhIGZsZXgtY29sdW1uJztcclxuXHJcbiAgcHJpdmF0ZSBfdGltZTogUHJvY2Vzc1RpbWU7XHJcbiAgQElucHV0KClcclxuICBzZXQgdGltZSh0OiBQcm9jZXNzVGltZSkge1xyXG4gICAgdGhpcy5fdGltZSA9IHQ7XHJcbiAgfVxyXG4gIGdldCB0aW1lKCk6IFByb2Nlc3NUaW1lIHtcclxuICAgIHJldHVybiB0aGlzLl90aW1lO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KClcclxuICBwcm9jZXNzSW5mbzogUHJvY2Vzc0luZm87XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgcnRQcm9jZXNzSW5mbzogUlRQcm9jZXNzSW5mbztcclxuXHJcbiAgQElucHV0KClcclxuICBhY3Rpb246ICd2aWV3JyB8ICdlZGl0JyA9ICdlZGl0JztcclxuXHJcbiAgQElucHV0KClcclxuICBtb2RlOiAnZ2VuZXJhbCcgfCAnc2ltcGxpZnknID0gJ2dlbmVyYWwnO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQFZpZXdDaGlsZCgncHJvcGVydHlQYW5lbCcpXHJcbiAgcHJvcGVydHlQYW5lbDogUHJvcGVydHlQYW5lbENvbXBvbmVudDtcclxuXHJcbiAgQFZpZXdDaGlsZCgnaWZyYW1lJylcclxuICBpZnJhbWU6IEVsZW1lbnRSZWY7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBzYW5pdGl6ZXI6IERvbVNhbml0aXplcixcclxuICAgIHB1YmxpYyB1aVN0YXRlOiBQcm9jZXNzRGVzaWduZXJVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSB2aWV3TW9kZWw6IFByb2Nlc3NEZXNpZ25lclZpZXdNb2RlbCxcclxuICAgIHByaXZhdGUgc2VydmljZTogUHJvY2Vzc0Rlc2lnbmVyRGF0YVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGxvYWRTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGFjdGl2aXR5OiBXRkZsb3dFbGVtZW50c1ZpZXdNb2RlbCxcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICkge1xyXG4gICAgLy8g5aaC5p6c5a2Y5Zyo5raI5oGv55uR5ZCs77yM5YWI5Yig5o6JXHJcbiAgICBpZiAoV2ZQcm9jZXNzRWRpdG9yQ29tcG9uZW50LmZ1bmMpIHtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBXZlByb2Nlc3NFZGl0b3JDb21wb25lbnQuZnVuYywgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hZGRNZXNzYWdlTGlzdGVuZXIoKTtcclxuICAgIHRoaXMudWlTdGF0ZS5nZXRBZG1pbmlzdHJhdG9ySW5mbygpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmdldFNyYygpO1xyXG4gICAgdGhpcy51aVN0YXRlLmluaXRVSVN0YXRlKCk7XHJcbiAgICB0aGlzLnNob3dMb2FkaW5nKCk7XHJcbiAgICB0aGlzLnVwZGF0ZVByb3BlcnR5KCk7XHJcbiAgICAvLyDojrflj5bmtojmga/liJfooahcclxuICAgIHRoaXMudWlTdGF0ZS5nZXRNZXNzYWdlQ2hhbm5lbHMoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0U3JjKCkge1xyXG4gICAgbGV0IHByb2Nlc3NDYXRlZ29yeUlkOiBzdHJpbmc7XHJcbiAgICBpZiAodGhpcy5fdGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgcHJvY2Vzc0NhdGVnb3J5SWQgPSB0aGlzLnJ0UHJvY2Vzc0luZm8uZmxvd0Zvcm1JZDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHByb2Nlc3NDYXRlZ29yeUlkID0gdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybUlkO1xyXG4gICAgfVxyXG4gICAgdGhpcy52aWV3TW9kZWwuZ2V0UHJvY2Vzc0NhdGVnb3J5KHByb2Nlc3NDYXRlZ29yeUlkKS5zdWJzY3JpYmUoKHByb2NDYXRlZ29yeTogRmxvd0Zvcm1FbnRpdHkpID0+IHtcclxuICAgICAgdGhpcy5zcmMgPSAnL3BsYXRmb3JtL3J1bnRpbWUvd2Yvd2ViL2Rlc2lnbmVyL2luZGV4Lmh0bWwnO1xyXG4gICAgICBpZiAodGhpcy5fdGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgICB0aGlzLnNyYyA9IHRoaXMuc3JjICsgJz90aW1lPXJ0JztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnNyYyA9IHRoaXMuc3JjICsgYD90aW1lPWR0YDtcclxuICAgICAgICBpZihwcm9jQ2F0ZWdvcnkpe1xyXG4gICAgICAgICAgdGhpcy5zcmMgPSB0aGlzLnNyYyArIGAmYml6Q2F0ZWdvcnlJZD0ke3Byb2NDYXRlZ29yeS5idXNpbmVzc09iamVjdElkfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gJ3ZpZXcnKSB7XHJcbiAgICAgICAgdGhpcy5zcmMgPSB0aGlzLnNyYyArICcmYWN0aW9uPXZpZXcnO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuc3JjID0gdGhpcy5zcmMgKyAnJmFjdGlvbj1lZGl0JztcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tb2RlID09PSAnZ2VuZXJhbCcpIHtcclxuICAgICAgICB0aGlzLnNyYyA9IHRoaXMuc3JjICsgJyZtb2RlPWdlbmVyYWwnO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuc3JjID0gdGhpcy5zcmMgKyAnJm1vZGU9c2ltcGxpZnknO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3JjID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdFJlc291cmNlVXJsKHRoaXMuc3JjKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5re75Yqg5LqL5Lu255uR5ZCsXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhZGRNZXNzYWdlTGlzdGVuZXIoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuZXZlbnRIYW5kbGVyLCBmYWxzZSk7XHJcbiAgICBXZlByb2Nlc3NFZGl0b3JDb21wb25lbnQuZnVuYyA9IHRoaXMuZXZlbnRIYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog55uR5ZCs5LqL5Lu25aSE55CGXHJcbiAgICovXHJcbiAgZXZlbnRIYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICBjb25zdCBwb3N0RGF0YSA9IGV2ZW50LmRhdGEgYXMgUG9zdE1lc3NhZ2VEYXRhO1xyXG4gICAgaWYgKHRoaXMudWlTdGF0ZS5QT1NUX01FU1NBR0VfVEFSR0VULnNlYXJjaChldmVudC5vcmlnaW4pID4gLTEpIHtcclxuICAgICAgc3dpdGNoIChwb3N0RGF0YS5hY3Rpb24pIHtcclxuICAgICAgICBjYXNlIFJlc291cmNlS2V5cy53Zl9pbml0UHJvcGVydHk6XHJcbiAgICAgICAgICBpZiAodGhpcy5mbGFnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmxhZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuaW5pdFByb2Nlc3NQcm9wZXJ0eShwb3N0RGF0YS5kYXRhKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLndmX3NhdmU6XHJcbiAgICAgICAgICB0aGlzLnVpU3RhdGUuY29udGVudCA9IHBvc3REYXRhLmRhdGE7XHJcbiAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICB0aGlzLnNhdmUoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLndmX2RlcGxveTpcclxuICAgICAgICAgIHRoaXMudWlTdGF0ZS5jb250ZW50ID0gcG9zdERhdGEuZGF0YTtcclxuICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAgIHRoaXMudmlld01vZGVsLmRlcGxveVByb2Nlc3ModGhpcy51aVN0YXRlLmNvbnRlbnQpLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5zYXZlUHJvY2Vzcyh0aGlzLnVpU3RhdGUuY29udGVudCwgdGhpcy5wcm9jZXNzSW5mbywgMCkuc3Vic2NyaWJlKChyKSA9PiB7IH0pO1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeS5zdWNjZXNzKHtcclxuICAgICAgICAgICAgICB0aXRsZTogJ+ezu+e7n+aPkOekuicsIG1zZzogJ+WPkeW4g+aIkOWKnycsIHRpbWVvdXQ6IDMwMDBcclxuICAgICAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgICAgICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UodGhpcy51aVN0YXRlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5hdWRpdFByb2Nlc3NEZWYoQXVkaXRFdmVudC5XRl9Qcm9jZXNzRGVmX0RlcGxveSwgdHJ1ZSwgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5LZXkpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgICAgKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3Ioe1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICfns7vnu5/mj5DnpLonLCBtc2c6ICflj5HluIPlpLHotKXvvIzor7fmo4Dmn6XmtYHnqIvmmK/lkKbmraPnoa7vvIEnLCB0aW1lb3V0OiAzMDAwXHJcbiAgICAgICAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzID0gSlNPTi5wYXJzZSh0aGlzLnVpU3RhdGUuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwuYXVkaXRQcm9jZXNzRGVmKEF1ZGl0RXZlbnQuV0ZfUHJvY2Vzc0RlZl9EZXBsb3ksIGZhbHNlLCBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLktleSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBSZXNvdXJjZUtleXMud2Zfc2F2ZUFzOlxyXG4gICAgICAgICAgY29uc3QgcHJjb2VzcyA9IHBvc3REYXRhLmRhdGE7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5zYXZlQXNQcm9jZXNzKHByY29lc3MsIHRoaXMucHJvY2Vzc0luZm8pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBSZXNvdXJjZUtleXMud2Zfc3luYzpcclxuICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBwb3N0RGF0YS5kYXRhO1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuc3luY0R0UHJvY2Vzcyhjb250ZW50LCB0aGlzLnJ0UHJvY2Vzc0luZm8pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBSZXNvdXJjZUtleXMud2Zfbm90ZTpcclxuICAgICAgICAgIHRoaXMubm90ZShwb3N0RGF0YS5kYXRhKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLndmX2Nsb3NlRGVzaWduZXI6XHJcbiAgICAgICAgICB0aGlzLmNsb3NlLmVtaXQoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLmdldEFjdGl2aXRpZXM6IC8vIOiOt+WPlua0u+WKqOiKgueCueS/oeaBr1xyXG4gICAgICAgICAgdGhpcy51aVN0YXRlLmdldFVzZXJBY3RMaXN0KHBvc3REYXRhLmRhdGEpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBSZXNvdXJjZUtleXMuZ2V0RW5kRXZlbnRzOiAvLyDojrflj5bmiYDmnInnu5PmnZ/oioLngrnkv6Hmga9cclxuICAgICAgICAgIHRoaXMudWlTdGF0ZS5nZXRFbmRFdmVudExpc3QocG9zdERhdGEuZGF0YSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdsb2FkZWQnOlxyXG4gICAgICAgICAgdGhpcy5vcGVuUHJvY0NvbnRlbnQoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLndmX3Nob3dUaXA6XHJcbiAgICAgICAgICB0aGlzLnNob3dUaXAocG9zdERhdGEuZGF0YSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuc2V0UHJvcGVydHkocG9zdERhdGEuZGF0YSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVQcm9wZXJ0eSgpOiBib29sZWFuIHtcclxuICAgIHRoaXMucHJvcGVydHlQYW5lbC5wcm9wZXJ0eUNoYW5nZWQuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVDaGFuZ2VQcm9wZXJ0eShkYXRhKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5wcm9wZXJ0eVBhbmVsLnN1Ym1pdE1vZGFsLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgIHRoaXMudXBkYXRlQ2hhbmdlUHJvcGVydHkoZGF0YS5jaGFuZ2VPYmplY3QpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlOyAvLyDpmLLmraLlhpLms6FcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOabtOaWsOWxnuaAp1xyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQ2hhbmdlUHJvcGVydHkoZGF0YSk6IGFueSB7XHJcbiAgICBkYXRhLklkID0gdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5JZDtcclxuICAgIHN3aXRjaCAoZGF0YS5wcm9wZXJ0eUlEKSB7XHJcbiAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLkVudHJ5Rm9ybTpcclxuICAgICAgICB0aGlzLmJpbmRFbnRyeUZvcm1JbmZvKGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFJlc291cmNlS2V5cy5BcHByb3ZhbEl0ZW1zOlxyXG4gICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLnVwZGF0ZVByb3BlcnR5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgdGhpcy5hY3Rpdml0eS5idWlsZENvdW50ZXJTaWduVmFyaWFibGVzKGRhdGEucHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLkNvbXBsZXRlU3RyYXRlZ3k6XHJcbiAgICAgICAgdGhpcy5iZWZvcmVDb21wbGV0ZVN0cmF0ZWd5Q2hhbmdlKGRhdGEpLnN1YnNjcmliZShiID0+IHtcclxuICAgICAgICAgIGlmIChiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLnVwZGF0ZVByb3BlcnR5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVTdHJhdGVneUNoYW5nZWQoZGF0YS5wcm9wZXJ0eVZhbHVlKTtcclxuICAgICAgICAgIH0gZWxzZSB7IC8vIOWIt+aWsOWxnuaAp+ahhlxyXG4gICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKFJlc291cmNlS2V5cy5yZWZyZXNoLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgUmVzb3VyY2VLZXlzLlNpZ25SdWxlOlxyXG4gICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLnVwZGF0ZVByb3BlcnR5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhpcy5zZW5kTWVzc2FnZShSZXNvdXJjZUtleXMudXBkYXRlUHJvcGVydHksIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOe7keWumua1geeoi+WIhuexu+eahOWPguaVsOWIl+ihqO+8jOa1geeoi+aehOS7tu+8jOihqOWNlei1i+WAvFxyXG4gICAqIEBwYXJhbSBkYXRhXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBiaW5kRW50cnlGb3JtSW5mbyhkYXRhKSB7XHJcbiAgICBjb25zdCBmbG93Zm9ybUlkOiBzdHJpbmcgPSBkYXRhLnByb3BlcnR5VmFsdWUuaWQ7XHJcbiAgICBpZiAoZmxvd2Zvcm1JZCkge1xyXG4gICAgICB0aGlzLnZpZXdNb2RlbC5nZXRGbG93Rm9ybUluZm9CeUlkKGZsb3dmb3JtSWQpLnN1YnNjcmliZSgoaW5mbzogRmxvd0Zvcm1JbmZvKSA9PiB7XHJcbiAgICAgICAgZGF0YS5mbG93Rm9ybSA9IGluZm8uZmxvd0Zvcm07XHJcbiAgICAgICAgZGF0YS5mb3JtYWxQYXJhbWV0ZXJzID0gaW5mby5mb3JtYWxQYXJhbWV0ZXJzO1xyXG4gICAgICAgIGRhdGEucHJvY2Vzc0JpekNvbXBvbm5ldHMgPSBpbmZvLmJpekNvbXBvbmVudHM7XHJcbiAgICAgICAgZGF0YS5leGVjdXRlRm9ybXMgPSBbXTtcclxuICAgICAgICBpbmZvLmV4Y3V0ZUZvcm1zLmZvckVhY2goZm9ybSA9PiB7XHJcbiAgICAgICAgICBpZiAoZm9ybS5pc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZXhlY3V0ZUZvcm1zID0gdGhpcy5Db252ZXJ0RXhlY3V0ZUZvcm0oZm9ybSk7XHJcbiAgICAgICAgICAgIGRhdGEuZXhlY3V0ZUZvcm1zID0gZGF0YS5leGVjdXRlRm9ybXMuY29uY2F0KGV4ZWN1dGVGb3Jtcyk7IC8vIOa1geeoi+e7keWumum7mOiupOWNleaNrlxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRhdGEuY3VzdG9taXplQWN0aW9ucyA9IGluZm8uY3VzdG9taXplQWN0aW9ucy5maWx0ZXIoYSA9PiBhLmlzQWxsID09PSB0cnVlKS5tYXAoYSA9PiAoe1xyXG4gICAgICAgICAgaWQ6IGEuaWQsIGNvZGU6IGEuY29kZSwgbmFtZTogYS5uYW1lLCB0ZXJtaW5hbFR5cGU6IGEudGVybWluYWwsXHJcbiAgICAgICAgICBhY3R1YWxQYXJhbWV0ZXJzOiBhLmFjdHVhbFBhcmFtZXRlcnMubWFwKHAgPT4gKHtcclxuICAgICAgICAgICAgTmFtZTogcC5jb2RlLCBWYWx1ZTogcC52YWx1ZSwgVmFsdWVUZXh0OiBwLm5hbWUsIFRhZzogJ2V4cHJlc3Npb24nXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdGhpcy5zZW5kTWVzc2FnZShSZXNvdXJjZUtleXMubG9hZEJpekFjdGl2aXR5LCBpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10pO1xyXG4gICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLnVwZGF0ZVByb3BlcnR5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBub3RlKHJlY29yZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoTm90ZUNvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG5cclxuICAgIGNvbXBSZWYuaW5zdGFuY2UucmVjb3JkID0gcmVjb3JkO1xyXG5cclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnOiBNb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgIHRpdGxlOiAn5rWB56iL5Y+Y5pu06K6w5b2VJyxcclxuICAgICAgd2lkdGg6IDgwMCxcclxuICAgICAgaGVpZ2h0OiA1MjAsXHJcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICBidXR0b25zOiBjb21wUmVmLmluc3RhbmNlLmZvb3RlclxyXG4gICAgfTtcclxuICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jYW5jZWwuc3Vic2NyaWJlKCRldmVudCA9PiBkaWFsb2cuY2xvc2UoKSk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdC5zdWJzY3JpYmUoKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICB0aGlzLnNlbmRNZXNzYWdlKFJlc291cmNlS2V5cy53Zl9ub3RlLCBkYXRhKTtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3BlblByb2NDb250ZW50KCkge1xyXG4gICAgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUuZHQpIHtcclxuICAgICAgaWYgKHRoaXMucHJvY2Vzc0luZm8pIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzSW5mby5wcm9jZXNzS2V5ID09PSBSZXNvdXJjZUtleXMubmV3ICYmIHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1JZCkge1xyXG4gICAgICAgICAgdGhpcy5vcGVuTmV3UHJvY2Vzcyh0aGlzLnByb2Nlc3NJbmZvLmZsb3dGb3JtSWQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBUT0RP77ya6aaW5YWI6I635Y+W5rWB56iL5YiG57G75L+h5oGv77yM56Gu5L+d5rWB56iL5YiG57G75ZKM5rWB56iL5p6E5Lu26I635Y+W5Yiw77yI5Lya56iN5b6u5b2x5ZON6K6+6K6h5Zmo5omT5byA6YCf5bqm77yJXHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5nZXRGbG93Rm9ybUluZm9CeUlkKHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1JZCkuc3Vic2NyaWJlKChpbmZvOiBGbG93Rm9ybUluZm8pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZShSZXNvdXJjZUtleXMubG9hZEJpekFjdGl2aXR5LCBpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10pO1xyXG4gICAgICAgICAgICB0aGlzLmdldFByb2NDb250ZW50KHRoaXMucHJvY2Vzc0luZm8ucHJvY2Vzc0tleSkuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnVpU3RhdGUuY29udGVudCA9IHRoaXMuY2hlY2tNb2RlbENvbnRlbnQoSlNPTi5zdHJpbmdpZnkocmUpKTtcclxuICAgICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKFJlc291cmNlS2V5cy5vcGVuLCB7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLnVpU3RhdGUuY29udGVudFxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeWtmOWcqOiuvuiuoeaXtua1geeoi+S/oeaBr++8geivt+WFiOi1i+WAvO+8gScpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgaWYgKHRoaXMucnRQcm9jZXNzSW5mbykge1xyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmdldEZsb3dGb3JtSW5mb0J5SWQodGhpcy5ydFByb2Nlc3NJbmZvLmZsb3dGb3JtSWQpLnN1YnNjcmliZSgoaW5mbzogRmxvd0Zvcm1JbmZvKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKFJlc291cmNlS2V5cy5sb2FkQml6QWN0aXZpdHksIGluZm8uYml6QWN0aXZpdGllcyB8fCBbXSk7XHJcbiAgICAgICAgICB0aGlzLmdldFByb2NDb250ZW50KHRoaXMucnRQcm9jZXNzSW5mby5ydFByb2NEZWZJZCkuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgICAgICAgdGhpcy51aVN0YXRlLmNvbnRlbnQgPSB0aGlzLmNoZWNrTW9kZWxDb250ZW50KEpTT04uc3RyaW5naWZ5KHJlKSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLm9wZW4sIHtcclxuICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLnVpU3RhdGUuY29udGVudFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5a2Y5Zyo6L+Q6KGM5pe25rWB56iL5L+h5oGv77yB6K+35YWI6LWL5YC877yBJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaWsOWinua1geeoi++8jOWfuuS6jua1geeoi+WIhuexu+iOt+WPluWPguaVsOWIl+ihqO+8jOaehOS7tuWSjOihqOWNlVxyXG4gICAqIEBwYXJhbSBmZklkIOa1geeoi+WIhuexu0lEXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvcGVuTmV3UHJvY2VzcyhmZklkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMudmlld01vZGVsLmdldEZsb3dGb3JtSW5mb0J5SWQoZmZJZClcclxuICAgICAgLnN1YnNjcmliZSgoaW5mbzogRmxvd0Zvcm1JbmZvKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcHJvY2Vzc0JpekNvbXBvbm5ldHM6IEJpekNvbXBvbmVudEVudGl0eVtdID0gaW5mby5iaXpDb21wb25lbnRzO1xyXG4gICAgICAgIGNvbnN0IGN1c3RvbWl6ZUFjdGlvbnMgPSBpbmZvLmN1c3RvbWl6ZUFjdGlvbnMuZmlsdGVyKGEgPT4gYS5pc0FsbCA9PT0gdHJ1ZSkubWFwKGEgPT4gKHtcclxuICAgICAgICAgIGlkOiBhLmlkLCBjb2RlOiBhLmNvZGUsIG5hbWU6IGEubmFtZSwgdGVybWluYWxUeXBlOiBhLnRlcm1pbmFsLFxyXG4gICAgICAgICAgYWN0dWFsUGFyYW1ldGVyczogYS5hY3R1YWxQYXJhbWV0ZXJzLm1hcChwID0+ICh7XHJcbiAgICAgICAgICAgIE5hbWU6IHAuY29kZSwgVmFsdWU6IHAudmFsdWUsIFZhbHVlVGV4dDogcC5uYW1lLCBUYWc6ICdleHByZXNzaW9uJ1xyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIGxldCBleGVjdXRlRm9ybXM6IEV4ZWN1dGVGb3JtTW9kZWxbXSA9IFtdO1xyXG4gICAgICAgIGluZm8uZXhjdXRlRm9ybXMuZm9yRWFjaChmb3JtID0+IHtcclxuICAgICAgICAgIGlmIChmb3JtLmlzRGVmYXVsdCkge1xyXG4gICAgICAgICAgICBjb25zdCBmb3JtcyA9IHRoaXMuQ29udmVydEV4ZWN1dGVGb3JtKGZvcm0pO1xyXG4gICAgICAgICAgICBleGVjdXRlRm9ybXMgPSBleGVjdXRlRm9ybXMuY29uY2F0KGZvcm1zKTsgLy8g5rWB56iL57uR5a6a6buY6K6k5Y2V5o2uXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g5aaC5p6c5LiN5a2Y5Zyo6KGo5Y2V5a6a5LmJ77yM6ZyA6KaB5Y676KGo5Y2V5qC85byP5YiX6KGo5Y+W5LiA5LiLXHJcbiAgICAgICAgaWYgKGV4ZWN1dGVGb3Jtcy5sZW5ndGggPT09IDBcclxuICAgICAgICAgIHx8IGV4ZWN1dGVGb3Jtcy5maW5kSW5kZXgoZSA9PiBlLlRlcm1pbmFsVHlwZSA9PT0gVGVybWluYWxUeXBlLlBDKSA9PT0gLTFcclxuICAgICAgICAgIHx8IGV4ZWN1dGVGb3Jtcy5maW5kSW5kZXgoZSA9PiBlLlRlcm1pbmFsVHlwZSA9PT0gVGVybWluYWxUeXBlLk1PQklMRSkgPT09IC0xKSB7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5nZXRGb3JtRm9ybWF0c0J5Qml6Q2F0ZWdvcnkoKS5zdWJzY3JpYmUoKGZvcm1Gb3JtYXRzOiBhbnlbXSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZm9ybUZvcm1hdHMgJiYgZm9ybUZvcm1hdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIGlmIChleGVjdXRlRm9ybXMuZmluZEluZGV4KGUgPT4gZS5UZXJtaW5hbFR5cGUgPT09IFRlcm1pbmFsVHlwZS5QQykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtRm9ybWF0ID0gZm9ybUZvcm1hdHMuZmlsdGVyKGYgPT4gZi50ZXJtaW5hbCA9PT0gJ1BDJyAmJiBmLnN0YXR1cyA9PT0gMClbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybUZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgICBleGVjdXRlRm9ybXMucHVzaCh0aGlzLmZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybUZvcm1hdCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAoZXhlY3V0ZUZvcm1zLmZpbmRJbmRleChlID0+IGUuVGVybWluYWxUeXBlID09PSBUZXJtaW5hbFR5cGUuTU9CSUxFKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1Gb3JtYXQgPSBmb3JtRm9ybWF0cy5maWx0ZXIoZiA9PiBmLnRlcm1pbmFsID09PSAnTW9iaWxlJyAmJiBmLnN0YXR1cyA9PT0gMClbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybUZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgICBleGVjdXRlRm9ybXMucHVzaCh0aGlzLmZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybUZvcm1hdCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKFJlc291cmNlS2V5cy5sb2FkQml6QWN0aXZpdHksIGluZm8uYml6QWN0aXZpdGllcyB8fCBbXSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoUmVzb3VyY2VLZXlzLm5ldywge1xyXG4gICAgICAgICAgICAgIG5hbWU6IHRoaXMucHJvY2Vzc0luZm8ucHJvY2Vzc05hbWUsXHJcbiAgICAgICAgICAgICAgYml6T2JqSWQ6IHRoaXMucHJvY2Vzc0luZm8uYml6T2JqSWQsXHJcbiAgICAgICAgICAgICAgZmZJZCxcclxuICAgICAgICAgICAgICBmZk5hbWU6IHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1OYW1lLFxyXG4gICAgICAgICAgICAgIHN0YXJ0TW9kZTogdGhpcy5wcm9jZXNzSW5mby5zdGFydE1vZGUsXHJcbiAgICAgICAgICAgICAgZm9ybWFsUGFyYW1ldGVyczogaW5mby5mb3JtYWxQYXJhbWV0ZXJzLFxyXG4gICAgICAgICAgICAgIHByb2Nlc3NCaXpDb21wb25uZXRzLFxyXG4gICAgICAgICAgICAgIGV4ZWN1dGVGb3JtcyxcclxuICAgICAgICAgICAgICBjdXN0b21pemVBY3Rpb25zLFxyXG4gICAgICAgICAgICAgIHByb2Nlc3NEZXNjcmlwdGlvbjogaW5mby5mbG93Rm9ybS5wcm9jZXNzRGVzY3JpcHRpb25cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZShSZXNvdXJjZUtleXMubG9hZEJpekFjdGl2aXR5LCBpbmZvLmJpekFjdGl2aXRpZXMgfHwgW10pO1xyXG4gICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZShSZXNvdXJjZUtleXMubmV3LCB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMucHJvY2Vzc0luZm8ucHJvY2Vzc05hbWUsXHJcbiAgICAgICAgICAgIGJpek9iaklkOiB0aGlzLnByb2Nlc3NJbmZvLmJpek9iaklkLFxyXG4gICAgICAgICAgICBmZklkLFxyXG4gICAgICAgICAgICBmZk5hbWU6IHRoaXMucHJvY2Vzc0luZm8uZmxvd0Zvcm1OYW1lLFxyXG4gICAgICAgICAgICBzdGFydE1vZGU6IHRoaXMucHJvY2Vzc0luZm8uc3RhcnRNb2RlLFxyXG4gICAgICAgICAgICBmb3JtYWxQYXJhbWV0ZXJzOiBpbmZvLmZvcm1hbFBhcmFtZXRlcnMsXHJcbiAgICAgICAgICAgIHByb2Nlc3NCaXpDb21wb25uZXRzLFxyXG4gICAgICAgICAgICBleGVjdXRlRm9ybXMsXHJcbiAgICAgICAgICAgIGN1c3RvbWl6ZUFjdGlvbnMsXHJcbiAgICAgICAgICAgIHByb2Nlc3NEZXNjcmlwdGlvbjogaW5mby5mbG93Rm9ybS5wcm9jZXNzRGVzY3JpcHRpb25cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyDlkJHlrZDpobXpnaLlj5HpgIHmtojmga9cclxuICBwcml2YXRlIHNlbmRNZXNzYWdlKGFjdGlvbjogc3RyaW5nLCBkYXRhOiBhbnkpOiB2b2lkIHtcclxuICAgIGNvbnN0IGlmcmFtZVdpbmRvdyA9IHRoaXMuaWZyYW1lLm5hdGl2ZUVsZW1lbnQuY29udGVudFdpbmRvdztcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLndyYXBNZXNzYWdlKGFjdGlvbiwgZGF0YSk7XHJcbiAgICBpZnJhbWVXaW5kb3cucG9zdE1lc3NhZ2UobWVzc2FnZSwgdGhpcy51aVN0YXRlLlBPU1RfTUVTU0FHRV9UQVJHRVQpO1xyXG4gIH1cclxuXHJcbiAgLy8g5YyF6KOF5raI5oGv5YaF5a65XHJcbiAgcHJpdmF0ZSB3cmFwTWVzc2FnZShhY3Rpb246IHN0cmluZywgZGF0YTogYW55KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhY3Rpb24sXHJcbiAgICAgIGRhdGFcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNob3dUaXAoZGF0YTogYW55KSB7XHJcbiAgICBpZiAoZGF0YS50eXBlID09PSAnbWVzc2FnZScpIHtcclxuICAgICAgc3dpdGNoIChkYXRhLmxldmVsKSB7XHJcbiAgICAgICAgY2FzZSAnd2FybmluZyc6XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZyhkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnZXJyb3InOlxyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmluZm8oZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gJ25vdGlmeScpIHtcclxuICAgICAgc3dpdGNoIChkYXRhLmxldmVsKSB7XHJcbiAgICAgICAgY2FzZSAnd2FybmluZyc6XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRoaXMubm90aWZ5LmluZm8oZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmtYHnqIvkuIrkuIvmlodcclxuICAgKiBAcGFyYW0gaWQg5rWB56iL5a6a5LmJSUTvvIjorr7orqHml7bkvb/nlKjmtYHnqIvlrprkuYlLZXnvvIzov5DooYzml7bkvb/nlKjmtYHnqIvlrprkuYlJRO+8iVxyXG4gICAqL1xyXG4gIGdldFByb2NDb250ZW50KGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKGlkKSB7XHJcbiAgICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLmR0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5nZXRQcm9jQ29udGVudGJ5S2V5KGlkKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5nZXRSVFByb2NDb250ZW50YnlJZChpZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCforr7orqHlmajov5DooYzml7bmnLrplJnor6/vvIEnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzYXZlKCkge1xyXG4gICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UodGhpcy51aVN0YXRlLmNvbnRlbnQpO1xyXG4gICAgLy8gdGhpcy51aVN0YXRlLmNvbnRlbnQgPSB0aGlzLmNoZWNrTW9kZWxDb250ZW50KHRoaXMudWlTdGF0ZS5jb250ZW50KTtcclxuICAgIHRoaXMuc2F2ZUh0dHAoKS5zdWJzY3JpYmUoKGRhdGEpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgdGhpcy5ub3RpZnkuc3VjY2Vzcyh7XHJcbiAgICAgICAgdGl0bGU6ICfns7vnu5/mj5DnpLonLCBtc2c6ICfkv53lrZjmiJDlip8nLCB0aW1lb3V0OiAzMDAwXHJcbiAgICAgIH0gYXMgTm90aWZ5T3B0aW9ucyk7XHJcbiAgICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLmR0KSB7XHJcbiAgICAgICAgdGhpcy52aWV3TW9kZWwuYXVkaXRQcm9jZXNzRGVmKEF1ZGl0RXZlbnQuV0ZfUHJvY2Vzc0RlZl9TYXZlRFQsIHRydWUsIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuS2V5KTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgICAgdGhpcy52aWV3TW9kZWwuYXVkaXRQcm9jZXNzRGVmKEF1ZGl0RXZlbnQuV0ZfUHJvY2Vzc0RlZl9TYXZlUlQsIHRydWUsIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuS2V5KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgICAgKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3Ioe1xyXG4gICAgICAgICAgdGl0bGU6ICfns7vnu5/mj5DnpLonLCBtc2c6ICfkv53lrZjlpLHotKXvvIzor7fmo4Dmn6XmtYHnqIvmmK/lkKbmraPnoa7vvIEnLCB0aW1lb3V0OiAzMDAwXHJcbiAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgICBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5kdCkge1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWwuYXVkaXRQcm9jZXNzRGVmKEF1ZGl0RXZlbnQuV0ZfUHJvY2Vzc0RlZl9TYXZlRFQsIGZhbHNlLCBwcm9jZXNzLkRlZmF1bHRQcm9jZXNzLktleSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLnJ0KSB7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbC5hdWRpdFByb2Nlc3NEZWYoQXVkaXRFdmVudC5XRl9Qcm9jZXNzRGVmX1NhdmVSVCwgZmFsc2UsIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5L+d5a2Y5rWB56iL5a6a5LmJ77yI6K6+6K6h5pe2K+i/kOihjOaXtu+8iVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2F2ZUh0dHAoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmICh0aGlzLnVpU3RhdGUuY29udGVudCkge1xyXG4gICAgICBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5kdCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdNb2RlbC5zYXZlUHJvY2Vzcyh0aGlzLnVpU3RhdGUuY29udGVudCwgdGhpcy5wcm9jZXNzSW5mbywgMSk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5ydCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdNb2RlbC5zYXZlUlRQcm9jZXNzKHRoaXMudWlTdGF0ZS5jb250ZW50LCB0aGlzLnJ0UHJvY2Vzc0luZm8ucnRQcm9jRGVmSWQpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcign6K6+6K6h5Zmo6L+Q6KGM5pe25py66ZSZ6K+v77yBJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5sb2FkU2VydmljZS5zaG93KHsgY29udGFpbmVyOiAnYm9keScsIG1lc3NhZ2U6ICcnLCB0eXBlOiAxIH0pO1xyXG4gIH1cclxuICBjbG9zZUxvYWRpbmcoKSB7XHJcbiAgICB0aGlzLmxvYWRTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIENvbnZlcnRFeGVjdXRlRm9ybShmb3JtOiBFeGN1dGVGb3JtRW50aXR5KTogRXhlY3V0ZUZvcm1Nb2RlbFtdIHtcclxuICAgIGNvbnN0IGV4ZWN1dGVGb3JtcyA9IG5ldyBBcnJheSgpO1xyXG4gICAgaWYgKGZvcm0udGVybWluYWwgPT09ICd3ZWIsYXBwJykge1xyXG4gICAgICBjb25zdCB3ZWJGb3JtID0gbmV3IEV4ZWN1dGVGb3JtTW9kZWwoKTtcclxuICAgICAgd2ViRm9ybS5Db21wb25lbnRJZCA9IGZvcm0uYXBwSWQ7XHJcbiAgICAgIHdlYkZvcm0uZm9ybUZvcm1hdElkID0gZm9ybS5mb3JtRm9ybWF0SWQ7XHJcbiAgICAgIHdlYkZvcm0uRm9ybVR5cGUgPSBmb3JtLmZvcm1UeXBlO1xyXG4gICAgICB3ZWJGb3JtLk5hbWUgPSBmb3JtLm5hbWU7XHJcbiAgICAgIHdlYkZvcm0uVGVybWluYWxUeXBlID0gVGVybWluYWxUeXBlLlBDO1xyXG4gICAgICBpZiAoZm9ybS5hY3R1YWxQYXJhbWV0ZXJzICYmIGZvcm0uYWN0dWFsUGFyYW1ldGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgd2ViRm9ybS5BY3R1YWxQYXJhbWV0ZXJzID0gZm9ybS5hY3R1YWxQYXJhbWV0ZXJzLm1hcChwID0+ICh7XHJcbiAgICAgICAgICBOYW1lOiBwLmNvZGUsXHJcbiAgICAgICAgICBWYWx1ZTogcC52YWx1ZVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgfVxyXG4gICAgICBleGVjdXRlRm9ybXMucHVzaCh3ZWJGb3JtKTtcclxuICAgICAgY29uc3QgYXBwRm9ybSA9IG5ldyBFeGVjdXRlRm9ybU1vZGVsKCk7XHJcbiAgICAgIGFwcEZvcm0uQ29tcG9uZW50SWQgPSBmb3JtLmFwcElkO1xyXG4gICAgICBhcHBGb3JtLmZvcm1Gb3JtYXRJZCA9IGZvcm0uZm9ybUZvcm1hdElkO1xyXG4gICAgICBhcHBGb3JtLkZvcm1UeXBlID0gZm9ybS5mb3JtVHlwZTtcclxuICAgICAgYXBwRm9ybS5OYW1lID0gZm9ybS5uYW1lO1xyXG4gICAgICBhcHBGb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5NT0JJTEU7XHJcbiAgICAgIGlmIChmb3JtLmFjdHVhbFBhcmFtZXRlcnMgJiYgZm9ybS5hY3R1YWxQYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBhcHBGb3JtLkFjdHVhbFBhcmFtZXRlcnMgPSBmb3JtLmFjdHVhbFBhcmFtZXRlcnMubWFwKHAgPT4gKHtcclxuICAgICAgICAgIE5hbWU6IHAuY29kZSxcclxuICAgICAgICAgIFZhbHVlOiBwLnZhbHVlXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICB9XHJcbiAgICAgIGV4ZWN1dGVGb3Jtcy5wdXNoKGFwcEZvcm0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZXhlY3V0ZUZvcm0gPSBuZXcgRXhlY3V0ZUZvcm1Nb2RlbCgpO1xyXG4gICAgICBleGVjdXRlRm9ybS5Db21wb25lbnRJZCA9IGZvcm0uYXBwSWQ7XHJcbiAgICAgIGV4ZWN1dGVGb3JtLmZvcm1Gb3JtYXRJZCA9IGZvcm0uZm9ybUZvcm1hdElkO1xyXG4gICAgICBleGVjdXRlRm9ybS5Gb3JtVHlwZSA9IGZvcm0uZm9ybVR5cGU7XHJcbiAgICAgIGV4ZWN1dGVGb3JtLk5hbWUgPSBmb3JtLm5hbWU7XHJcbiAgICAgIHN3aXRjaCAoZm9ybS50ZXJtaW5hbCkge1xyXG4gICAgICAgIGNhc2UgJ3dlYic6XHJcbiAgICAgICAgICBleGVjdXRlRm9ybS5UZXJtaW5hbFR5cGUgPSBUZXJtaW5hbFR5cGUuUEM7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdhcHAnOlxyXG4gICAgICAgICAgZXhlY3V0ZUZvcm0uVGVybWluYWxUeXBlID0gVGVybWluYWxUeXBlLk1PQklMRTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChmb3JtLmFjdHVhbFBhcmFtZXRlcnMgJiYgZm9ybS5hY3R1YWxQYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBleGVjdXRlRm9ybS5BY3R1YWxQYXJhbWV0ZXJzID0gZm9ybS5hY3R1YWxQYXJhbWV0ZXJzLm1hcChwID0+ICh7XHJcbiAgICAgICAgICBOYW1lOiBwLmNvZGUsXHJcbiAgICAgICAgICBWYWx1ZTogcC52YWx1ZVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgfVxyXG4gICAgICBleGVjdXRlRm9ybXMucHVzaChleGVjdXRlRm9ybSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXhlY3V0ZUZvcm1zO1xyXG4gIH1cclxuICBwcml2YXRlIGZvcm1Gb3JtYXQyRXhlY3V0ZUZvcm0oZm9ybWZvcm1hdCk6IEV4ZWN1dGVGb3JtTW9kZWwge1xyXG4gICAgY29uc3QgZm9ybSA9IG5ldyBFeGVjdXRlRm9ybU1vZGVsKCk7XHJcbiAgICBmb3JtLklkID0gUHJvY2Vzc0RlVXRpbC5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgZm9ybS5Db21wb25lbnRJZCA9IG51bGw7XHJcbiAgICBmb3JtLmZvcm1Gb3JtYXRJZCA9IGZvcm1mb3JtYXQuaWQ7XHJcbiAgICBmb3JtLkZvcm1UeXBlID0gJzAnO1xyXG4gICAgZm9ybS5OYW1lID0gZm9ybWZvcm1hdC5uYW1lO1xyXG4gICAgc3dpdGNoIChmb3JtZm9ybWF0LnRlcm1pbmFsKSB7XHJcbiAgICAgIGNhc2UgJ1BDJzpcclxuICAgICAgICBmb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5QQztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnTW9iaWxlJzpcclxuICAgICAgICBmb3JtLlRlcm1pbmFsVHlwZSA9IFRlcm1pbmFsVHlwZS5NT0JJTEU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBpZiAoZm9ybWZvcm1hdC51cmxQYXJhbWV0ZXJzICYmIGZvcm1mb3JtYXQudXJsUGFyYW1ldGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvcm0uQWN0dWFsUGFyYW1ldGVycyA9IGZvcm1mb3JtYXQudXJsUGFyYW1ldGVycy5tYXAocCA9PiAoe1xyXG4gICAgICAgIE5hbWU6IHAuY29kZSxcclxuICAgICAgICBWYWx1ZTogcC52YWx1ZVxyXG4gICAgICB9KSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZm9ybTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29tcGxldGVTdHJhdGVneUNoYW5nZWQoc3RyYXRlZ3k6IHN0cmluZykge1xyXG5cclxuICAgIGlmIChzdHJhdGVneSAhPT0gdGhpcy51aVN0YXRlLmNvbXBsZXRlSXRlcmF0b3JbMF0ua2V5KSB7XHJcblxyXG4gICAgICAvLyDlj4LkuI7ogIXlrZjlnKjoh6rliqjlrqHmibnnmoTmg4XlhrXkuIvvvIzkuI3lhYHorrjkv67mlLnlrozmiJDnrZbnlaXkuLrkvJrnrb7op4TliJlcclxuICAgICAgLy8gaWYgKHRoaXMudWlTdGF0ZS5wcm9wZXJ0eURhdGEuUGFydGljaXBhbnRTY2hlbWVzXHJcbiAgICAgIC8vICAgJiYgdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5QYXJ0aWNpcGFudFNjaGVtZXMub3B0aW9uc1xyXG4gICAgICAvLyAgICYmIHRoaXMudWlTdGF0ZS5wcm9wZXJ0eURhdGEuUGFydGljaXBhbnRTY2hlbWVzLm9wdGlvbnMuYXV0b21hdGljUGVyZm9ybWVyc1xyXG4gICAgICAvLyAgICYmIHRoaXMudWlTdGF0ZS5wcm9wZXJ0eURhdGEuUGFydGljaXBhbnRTY2hlbWVzLm9wdGlvbnMuYXV0b21hdGljUGVyZm9ybWVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIC8vICAgcmV0dXJuO1xyXG4gICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOS8muetvuinhOWImeS4jeWtmOWcqO+8jOWNs+eUseaKouWNoOaooeW8j++8jOWPmOS4uuS8muetvuaXtlxyXG4gICAgICAgIGlmICghdGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5TaWduUnVsZSkge1xyXG4gICAgICAgICAgLy8g5Lya562+5piv6Ieq5Yqo5by55Ye65Lya562+6KeE5YiZ57yW6L6RXHJcbiAgICAgICAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoU2lnblJ1bGVDb21wb25lbnQpO1xyXG4gICAgICAgICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuXHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLnZhbHVlID0gW107XHJcbiAgICAgICAgICAvLyBjb21wUmVmLmluc3RhbmNlLmNvdW50ZXJTaWduVmFyaWFibGVzID0gdGhpcy51aVN0YXRlLmNvdW50ZXJTaWduVmFyaWFibGVzIHx8IFtdO1xyXG4gICAgICAgICAgLy8gY29tcFJlZi5pbnN0YW5jZS5hcHByb3ZhbEl0ZW1zID0gdGhpcy51aVN0YXRlLmFwcHJvdmFsSXRlbXMgfHwgW107XHJcblxyXG4gICAgICAgICAgY29uc3QgbW9kYWxDb25maWc6IE1vZGFsT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oY29tcFJlZi5pbnN0YW5jZS5tb2RhbENvbmZpZyxcclxuICAgICAgICAgICAgeyBidXR0b25zOiBjb21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyIH0pO1xyXG4gICAgICAgICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLmNsb3NlTW9kYWwuc3Vic2NyaWJlKCRldmVudCA9PiBkaWFsb2cuY2xvc2UoKSk7XHJcbiAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdE1vZGFsLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hhbmdlUHJvcGVydHkoe1xyXG4gICAgICAgICAgICAgIGNhdGVnb3J5SWQ6ICdwZXJmb3JtZXJQcm9wZXJ0eScsXHJcbiAgICAgICAgICAgICAgcHJvcGVydHlJRDogUmVzb3VyY2VLZXlzLlNpZ25SdWxlLFxyXG4gICAgICAgICAgICAgIHByb3BlcnR5VmFsdWU6IGRhdGEudmFsdWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOS8muetvuinhOWImeS4i++8jOmps+WbnuinhOWImee6puadn1xyXG4gICAgICAgIGlmICgodGhpcy51aVN0YXRlLnByb3BlcnR5RGF0YS5CYWNrV2FyZFJ1bGUgYXMgQmFja1dhcmRSdWxlKS5TZWxlY3RUYXJnZXRBYmxlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlLndhcm5pbmcoJ+S8muetvuetlueVpeS4iyzigJzpqbPlm57op4TliJnigJ3kuI3lhYHorrjigJzliqjmgIHpgInmi6npqbPlm57nuqfmrKHigJ3vvIzor7fkv67mlLnvvIEnKTtcclxuICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAvLyB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlrozmiJDnrZbnlaXosIPmlbTmoKHpqoxcclxuICAgKi9cclxuICBwcml2YXRlIGJlZm9yZUNvbXBsZXRlU3RyYXRlZ3lDaGFuZ2UoZGF0YTogYW55KTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICBpZiAodGhpcy50aW1lID09PSBQcm9jZXNzVGltZS5ydCkge1xyXG4gICAgICByZXR1cm4gdGhpcy52aWV3TW9kZWwuYmVmb3JlQ29tcGxldGVTdHJhdGVneUNoYW5nZShkYXRhLCB0aGlzLnJ0UHJvY2Vzc0luZm8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOS/neWtmO+8jOWPkeW4g++8jOWPpuWtmO+8jOWQjOatpeaTjeS9nOaXtlxyXG4gICAqIOagoemqjOaooeWei+eahOa1geeoi+WIhuexu0lE5LiO5YiX6KGo5a2Y5YKo5piv5ZCm5LiA6Ie077yM5LiN5LiA6Ie05pe277yM5Lul5YiX6KGo5Li65YeGXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjaGVja01vZGVsQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgcHJvY2VzcyA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICBjb25zdCBtb2RlbEJpekRlZktleSA9IHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuZXh0ZW5zaW9uRWxlbWVudHMuZmluZChlID0+IGUuQ2xyVHlwZUlEID09PSAnd2YuUHJvY2Vzc0hlYWRlcicpLkJpekRlZktleTtcclxuICAgIGlmICh0aGlzLnRpbWUgPT09IFByb2Nlc3NUaW1lLmR0KSB7XHJcbiAgICAgIGlmIChtb2RlbEJpekRlZktleSA9PT0gdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybUlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcHJvY2Vzcy5EZWZhdWx0UHJvY2Vzcy5leHRlbnNpb25FbGVtZW50cy5maW5kKGUgPT4gZS5DbHJUeXBlSUQgPT09ICd3Zi5Qcm9jZXNzSGVhZGVyJykuQml6RGVmS2V5ID0gdGhpcy5wcm9jZXNzSW5mby5mbG93Rm9ybUlkO1xyXG4gICAgICAgIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuZXh0ZW5zaW9uRWxlbWVudHMuZmluZChlID0+IGUuQ2xyVHlwZUlEID09PSAnd2YuUHJvY2Vzc0hlYWRlcicpLkJpekRlZk5hbWUgPSB0aGlzLnVpU3RhdGUuZmxvd0Zvcm1JbmZvLmZsb3dGb3JtLm5hbWU7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHByb2Nlc3MpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMudGltZSA9PT0gUHJvY2Vzc1RpbWUucnQpIHtcclxuICAgICAgaWYgKG1vZGVsQml6RGVmS2V5ID09PSB0aGlzLnJ0UHJvY2Vzc0luZm8uZmxvd0Zvcm1JZCkge1xyXG4gICAgICAgIHJldHVybiBjb250ZW50O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuZXh0ZW5zaW9uRWxlbWVudHMuZmluZChlID0+IGUuQ2xyVHlwZUlEID09PSAnd2YuUHJvY2Vzc0hlYWRlcicpLkJpekRlZktleSA9IHRoaXMucnRQcm9jZXNzSW5mby5mbG93Rm9ybUlkO1xyXG4gICAgICAgIHByb2Nlc3MuRGVmYXVsdFByb2Nlc3MuZXh0ZW5zaW9uRWxlbWVudHMuZmluZChlID0+IGUuQ2xyVHlwZUlEID09PSAnd2YuUHJvY2Vzc0hlYWRlcicpLkJpekRlZk5hbWUgPSB0aGlzLnVpU3RhdGUuZmxvd0Zvcm1JbmZvLmZsb3dGb3JtLm5hbWU7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHByb2Nlc3MpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==