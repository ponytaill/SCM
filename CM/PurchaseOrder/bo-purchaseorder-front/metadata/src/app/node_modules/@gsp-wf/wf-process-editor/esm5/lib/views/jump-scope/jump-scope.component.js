/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef } from '@angular/core';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { DialogComponent } from '@farris/ui-dialog';
import { MessagerService } from '@farris/ui-messager';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
var JumpScopeComponent = /** @class */ (function () {
    function JumpScopeComponent(uistate, message) {
        var _this = this;
        this.uistate = uistate;
        this.message = message;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: '目标节点选项',
            width: 520,
            height: 460,
            showButtons: true
        };
        this.cols = [
            { title: '名称', field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.defaultacty = '';
        this.categoryListItems = [
            { value: 'OutConnectNode', name: '流程图连线节点' },
            { value: 'Global', name: '流程内所有节点' },
            { value: 'AfterNodes', name: '所有后继节点' },
            { value: 'SpecifiedSet', name: '流程图连线节点+附加节点' }
        ];
        this.category = '';
        this.defaultType = '';
        this.defaultTypeListItems = [
            { value: 'FirstNode', name: '条件为true的连线节点，当有多条时默认选中首条' },
            { value: 'NullNode', name: '默认为空，每次都手动选择' },
            { value: 'SpecifyNode', name: '指定默认节点' }
        ];
        this.defaultActivity = '';
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            // 附加节点的帮助后事件，把选中的数据赋给fullActis（此处处理的目的是为了显示Name同时取Id值）
            // console.log(rowData);
            _this.fullActis = rowData;
            return of({
                closeDialog: true
            });
        });
        this.defaultActivitySelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        function (rowData) {
            // 默认节点的帮助后事件，把选中的id赋给defaultActivity（此处处理的目的是为了显示Name同时取Id值）
            _this.defaultActivity = rowData.Id;
            return of({
                closeDialog: true
            });
        });
    }
    Object.defineProperty(JumpScopeComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_1, _a, e_2, _b;
            if (data) {
                this.category = data.Category;
                this.defaultType = data.DefaultType;
                // 取到DefaultActivity的节点Id，遍历出Name绑定到radiogroup上去（defaultacty）
                /** @type {?} */
                var acty = data.DefaultActivity;
                if (acty != null) {
                    try {
                        for (var _c = tslib_1.__values(this.uistate.allActList), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var act = _d.value;
                            if (act.Id === acty) {
                                this.defaultacty = act.Name;
                            }
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                // 取到DestinationActivities的节点Id，遍历出Id和Name绑定到radiogroup上去（actis）
                /** @type {?} */
                var strs = data.DestinationActivities;
                if (strs && strs.length > 0) {
                    var _loop_1 = function (str) {
                        /** @type {?} */
                        var name_1 = this_1.uistate.userActList.filter((/**
                         * @param {?} act
                         * @return {?}
                         */
                        function (act) { return act.Id === str; }))[0].Name;
                        // const acti = { Id: str, Name: name };
                        this_1.actis.push(name_1);
                    };
                    var this_1 = this;
                    try {
                        for (var strs_1 = tslib_1.__values(strs), strs_1_1 = strs_1.next(); !strs_1_1.done; strs_1_1 = strs_1.next()) {
                            var str = strs_1_1.value;
                            _loop_1(str);
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (strs_1_1 && !strs_1_1.done && (_b = strs_1.return)) _b.call(strs_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                }
            }
            else {
                this.category = 'OutConnectNode';
                this.defaultType = 'FirstNode';
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        var e_3, _a, e_4, _b, e_5, _c;
        if (this.validator()) {
            /** @type {?} */
            var value = void 0;
            /** @type {?} */
            var list_1 = [];
            // 重新打开设置界面，没有进行节点配置的情况（DefaultActivity）
            if (this.defaultActivity === '' && this.defaultacty !== '') {
                try {
                    for (var _d = tslib_1.__values(this.uistate.allActList), _e = _d.next(); !_e.done; _e = _d.next()) {
                        var defAct = _e.value;
                        if (defAct.Name === this.defaultacty) {
                            this.defaultActivity = defAct.Id;
                        }
                    }
                }
                catch (e_3_1) { e_3 = { error: e_3_1 }; }
                finally {
                    try {
                        if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                    }
                    finally { if (e_3) throw e_3.error; }
                }
            }
            // 重新打开设置界面，没有进行节点配置的情况（DestinationActivities）
            if (this.fullActis.length === 0 && this.actis.length > 0) {
                try {
                    for (var _f = tslib_1.__values(this.actis), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var act = _g.value;
                        try {
                            for (var _h = tslib_1.__values(this.uistate.userActList), _j = _h.next(); !_j.done; _j = _h.next()) {
                                var allAct = _j.value;
                                if (act === allAct.Name) {
                                    list_1.push(allAct.Id);
                                }
                            }
                        }
                        catch (e_5_1) { e_5 = { error: e_5_1 }; }
                        finally {
                            try {
                                if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                            }
                            finally { if (e_5) throw e_5.error; }
                        }
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
            }
            else if (this.category === 'SpecifiedSet' && this.fullActis && this.fullActis.length > 0) {
                // 附加节点的id传给模型上的DestinationActivities
                this.fullActis.forEach((/**
                 * @param {?} act
                 * @return {?}
                 */
                function (act) { return list_1.push(act.Id); }));
            }
            value = {
                Category: this.category,
                DefaultType: this.defaultType,
                DefaultActivity: this.defaultActivity,
                DestinationActivities: list_1,
            };
            /** @type {?} */
            var object = { value: value, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    JumpScopeComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.category) {
            this.message.warning('尚未设置目标节点选项，请了解！');
            return false;
        }
        // if (this.category === 'SpecifiedSet' && Object.prototype.isPrototypeOf(this.actis)) {
        //   this.message.info('尚未选择附加节点，请了解！');
        //   return false;
        // }
        if (this.defaultType === 'SpecifyNode' && this.defaultacty === '') {
            this.message.warning('尚未指定默认节点，请了解！');
            return false;
        }
        return true;
    };
    /**
     * @return {?}
     */
    JumpScopeComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.actTable.selectedRow && this.actTable.selectedRow.data) {
            /** @type {?} */
            var i = this.actis.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.id === _this.actTable.selectedRow.data.id; }));
            this.actis.splice(i, 1);
            this.actTable.loadData(this.actis);
        }
        else {
            this.message.info('请首先选中一条选项！');
        }
    };
    JumpScopeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-jump-scope',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9\u5355\u9009\u9879 -->\r\n            <!-- <div class=\"mx-4 mt-3 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"submitterAutoPass\" type=\"checkbox\"\r\n                        id=\"submitterAutoPass\" [(ngModel)]=\"outConnectNode\" />\r\n                      <label class=\"custom-control-label\" for=\"submitterAutoPass\">\u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div> -->\r\n            <!-- \u53EF\u9009\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u53EF\u9009\u8282\u70B9</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684category\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"category\" [data]=\"categoryListItems\" name=\"category\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog\r\n                  [items]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id \" [columns]=\"cols\"\r\n                  [disabled]=\"!(category === 'SpecifiedSet')\" [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\"\r\n                  [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\" [pagination]=\"true\"\r\n                  [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\" [pageSize]=\"pageInfo.pageSize\"\r\n                  [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\" [title]=\"'\u9644\u52A0\u8282\u70B9\u5217\u8868'\"\r\n                  [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\" [placeholder]=\"'\u8BF7\u9009\u62E9\u9644\u52A0\u8282\u70B9'\" [dictPicked]=\"actisSelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u9ED8\u8BA4\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u9ED8\u8BA4\u8282\u70B9</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684DefaultType\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"defaultType\" [data]=\"defaultTypeListItems\" name=\"defaultType\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9ED8\u8BA4\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #allActisTable [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \"\r\n                  [columns]=\"cols\" [disabled]=\"!(defaultType === 'SpecifyNode')\" [resizable]=\"true\"\r\n                  [singleSelect]=\"true\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"defaultacty\"\r\n                  [valueField]=\"'Id'\" [pagination]=\"true\" [placeholder]=\"'\u8BF7\u9009\u62E9\u9ED8\u8BA4\u8282\u70B9'\" [pageIndex]=\"pageInfo.pageIndex\"\r\n                  name=\"defaultActivity\" [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\"\r\n                  [enableClear]=\"false\" [title]=\"'\u9ED8\u8BA4\u8282\u70B9\u5217\u8868'\" [displayType]=\"'List'\" [remoteSearch]='false' [dictPicked]=\"defaultActivitySelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<!-- <ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary mx-2\" (click)=\"actisSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"allActisDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template> -->\r\n<!-- <farris-dialog #allActisDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" [title]=\"'\u6D3B\u52A8\u5217\u8868'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #allActisTable [columns]=\"cols\"\r\n      [data]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id\" [idField]=\"'Id'\" [fit]=\"true\"\r\n      [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"true\"\r\n      [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog> -->\r\n",
                    styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
                }] }
    ];
    /** @nocollapse */
    JumpScopeComponent.ctorParameters = function () { return [
        { type: ProcessDesignerUIState },
        { type: MessagerService }
    ]; };
    JumpScopeComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
        allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
        actTable: [{ type: ViewChild, args: ['actTable',] }],
        lookup: [{ type: ViewChild, args: ['lookup',] }]
    };
    return JumpScopeComponent;
}());
export { JumpScopeComponent };
if (false) {
    /** @type {?} */
    JumpScopeComponent.prototype.cls;
    /** @type {?} */
    JumpScopeComponent.prototype.closeModal;
    /** @type {?} */
    JumpScopeComponent.prototype.submitModal;
    /** @type {?} */
    JumpScopeComponent.prototype.modalFooter;
    /** @type {?} */
    JumpScopeComponent.prototype.modalConfig;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisTable;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisDialog;
    /** @type {?} */
    JumpScopeComponent.prototype.actTable;
    /** @type {?} */
    JumpScopeComponent.prototype.lookup;
    /** @type {?} */
    JumpScopeComponent.prototype.cols;
    /** @type {?} */
    JumpScopeComponent.prototype.actis;
    /** @type {?} */
    JumpScopeComponent.prototype.fullActis;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultacty;
    /** @type {?} */
    JumpScopeComponent.prototype.categoryListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.category;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultType;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultTypeListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivity;
    /** @type {?} */
    JumpScopeComponent.prototype.pageInfo;
    /** @type {?} */
    JumpScopeComponent.prototype.outConnectNode;
    /** @type {?} */
    JumpScopeComponent.prototype.total;
    /** @type {?} */
    JumpScopeComponent.prototype.actisSelect;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivitySelect;
    /** @type {?} */
    JumpScopeComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.message;
}
var JumpScopeConverter = /** @class */ (function () {
    function JumpScopeConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    JumpScopeConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data) {
            return '（已设置）';
        }
        return '（未设置）';
    };
    return JumpScopeConverter;
}());
export { JumpScopeConverter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianVtcC1zY29wZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL2p1bXAtc2NvcGUvanVtcC1zY29wZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBILE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUFFLG1CQUFtQixFQUFnQixNQUFNLG1CQUFtQixDQUFDO0FBQ3RFLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFdEM7SUFnRkUsNEJBQ1MsT0FBK0IsRUFDOUIsT0FBd0I7UUFGbEMsaUJBRXVDO1FBRDlCLFlBQU8sR0FBUCxPQUFPLENBQXdCO1FBQzlCLFlBQU8sR0FBUCxPQUFPLENBQWlCO1FBM0VsQyxRQUFHLEdBQUcsOEJBQThCLENBQUM7UUFFM0IsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDckMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBZ0NoRCxnQkFBVyxHQUFHO1lBQ1osS0FBSyxFQUFFLFFBQVE7WUFDZixLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsV0FBVyxFQUFFLElBQUk7U0FDbEIsQ0FBQztRQU9GLFNBQUksR0FBRztZQUNMLEVBQUUsS0FBSyxFQUFFLElBQUksRUFB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LFdBQVcsU0FBQyxPQUFPOzZCQUduQixNQUFNOzhCQUNOLE1BQU07d0JBRU4sS0FBSzs4QkE2QkwsU0FBUyxTQUFDLGtCQUFrQjtnQ0FRNUIsU0FBUyxTQUFDLGVBQWU7aUNBQ3pCLFNBQVMsU0FBQyxnQkFBZ0I7MkJBQzFCLFNBQVMsU0FBQyxVQUFVO3lCQUNwQixTQUFTLFNBQUMsUUFBUTs7SUFxSHJCLHlCQUFDO0NBQUEsQUF6S0QsSUF5S0M7U0FwS1ksa0JBQWtCOzs7SUFDN0IsaUNBQ3FDOztJQUVyQyx3Q0FBK0M7O0lBQy9DLHlDQUFnRDs7SUErQmhELHlDQUE2RDs7SUFDN0QseUNBS0U7O0lBRUYsMkNBQTZEOztJQUM3RCw0Q0FBNkQ7O0lBQzdELHNDQUFtRDs7SUFDbkQsb0NBQWlEOztJQUVqRCxrQ0FFOEQ7O0lBRTlELG1DQUFXOztJQUNYLHVDQUFlOztJQUNmLHlDQUFpQjs7SUFDakIsK0NBSW1EOztJQUNuRCxzQ0FBYzs7SUFDZCx5Q0FBaUI7O0lBQ2pCLGtEQUc0Qzs7SUFDNUMsNkNBQXFCOztJQUNyQixzQ0FJRTs7SUFDRiw0Q0FBcUI7O0lBQ3JCLG1DQUFjOztJQWdFZCx5Q0FPQzs7SUFFRCxtREFNQzs7SUE3RUMscUNBQXNDOzs7OztJQUN0QyxxQ0FBZ0M7O0FBd0ZwQztJQUNFO0lBQWdCLENBQUM7Ozs7O0lBRWpCLHNDQUFTOzs7O0lBQVQsVUFBVSxJQUFTO1FBQ2pCLElBQUksSUFBSSxFQUFFO1lBQ1IsT0FBTyxPQUFPLENBQUM7U0FDaEI7UUFDRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0lBQ0gseUJBQUM7QUFBRCxDQUFDLEFBVEQsSUFTQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBIb3N0QmluZGluZywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIElucHV0LCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFR5cGVDb252ZXJ0ZXIgfSBmcm9tICdAZmFycmlzL3VpLXByb3BlcnR5LXBhbmVsJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4uLy4uL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRpYWxvZyc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBMb29rdXBHcmlkQ29tcG9uZW50LCBQaWNrZWRSZXN1bHQgfSBmcm9tICdAZmFycmlzL3VpLWxvb2t1cCc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1qdW1wLXNjb3BlJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vanVtcC1zY29wZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vanVtcC1zY29wZS5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEp1bXBTY29wZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShkYXRhOiBhbnkpIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHRoaXMuY2F0ZWdvcnkgPSBkYXRhLkNhdGVnb3J5O1xyXG4gICAgICB0aGlzLmRlZmF1bHRUeXBlID0gZGF0YS5EZWZhdWx0VHlwZTtcclxuICAgICAgLy8g5Y+W5YiwRGVmYXVsdEFjdGl2aXR555qE6IqC54K5SWTvvIzpgY3ljoblh7pOYW1l57uR5a6a5YiwcmFkaW9ncm91cOS4iuWOu++8iGRlZmF1bHRhY3R577yJXHJcbiAgICAgIGNvbnN0IGFjdHk6IHN0cmluZyA9IGRhdGEuRGVmYXVsdEFjdGl2aXR5O1xyXG4gICAgICBpZiAoYWN0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBhY3Qgb2YgdGhpcy51aXN0YXRlLmFsbEFjdExpc3QpIHtcclxuICAgICAgICAgIGlmIChhY3QuSWQgPT09IGFjdHkpIHtcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0YWN0eSA9IGFjdC5OYW1lO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyDlj5bliLBEZXN0aW5hdGlvbkFjdGl2aXRpZXPnmoToioLngrlJZO+8jOmBjeWOhuWHuklk5ZKMTmFtZee7keWumuWIsHJhZGlvZ3JvdXDkuIrljrvvvIhhY3Rpc++8iVxyXG4gICAgICBjb25zdCBzdHJzOiBzdHJpbmdbXSA9IGRhdGEuRGVzdGluYXRpb25BY3Rpdml0aWVzO1xyXG4gICAgICBpZiAoc3RycyAmJiBzdHJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHN0ciBvZiBzdHJzKSB7XHJcbiAgICAgICAgICBjb25zdCBuYW1lID0gdGhpcy51aXN0YXRlLnVzZXJBY3RMaXN0LmZpbHRlcihhY3QgPT4gYWN0LklkID09PSBzdHIpWzBdLk5hbWU7XHJcbiAgICAgICAgICAvLyBjb25zdCBhY3RpID0geyBJZDogc3RyLCBOYW1lOiBuYW1lIH07XHJcbiAgICAgICAgICB0aGlzLmFjdGlzLnB1c2gobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNhdGVnb3J5ID0gJ091dENvbm5lY3ROb2RlJztcclxuICAgICAgdGhpcy5kZWZhdWx0VHlwZSA9ICdGaXJzdE5vZGUnO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6ICfnm67moIfoioLngrnpgInpobknLFxyXG4gICAgd2lkdGg6IDUyMCxcclxuICAgIGhlaWdodDogNDYwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG4gIC8vIOa0u+WKqOiKgueCueihqOS/oeaBrz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgQFZpZXdDaGlsZCgnYWxsQWN0aXNUYWJsZScpIGFsbEFjdGlzVGFibGU6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2FsbEFjdGlzRGlhbG9nJykgYWxsQWN0aXNEaWFsb2c6IERpYWxvZ0NvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdhY3RUYWJsZScpIGFjdFRhYmxlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdsb29rdXAnKSBsb29rdXA6IExvb2t1cEdyaWRDb21wb25lbnQ7XHJcblxyXG4gIGNvbHMgPSBbXHJcbiAgICB7IHRpdGxlOiAn5ZCN56ewJywgZmllbGQ6ICdOYW1lJywgd2lkdGg6IDYwLCBzZWFyY2hGaWVsZDogJ05hbWUnIH0sXHJcbiAgICB7IHRpdGxlOiAnSUQnLCBmaWVsZDogJ0lkJywgd2lkdGg6IDkwLCBzZWFyY2hGaWVsZDogJ0lkJyB9XTtcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgYWN0aXMgPSBbXTtcclxuICBmdWxsQWN0aXMgPSBbXTtcclxuICBkZWZhdWx0YWN0eSA9ICcnO1xyXG4gIGNhdGVnb3J5TGlzdEl0ZW1zID0gW1xyXG4gICAgeyB2YWx1ZTogJ091dENvbm5lY3ROb2RlJywgbmFtZTogJ+a1geeoi+Wbvui/nue6v+iKgueCuSd9LFxyXG4gICAgeyB2YWx1ZTogJ0dsb2JhbCcsIG5hbWU6ICfmtYHnqIvlhoXmiYDmnInoioLngrknfSxcclxuICAgIHsgdmFsdWU6ICdBZnRlck5vZGVzJywgbmFtZTogJ+aJgOacieWQjue7p+iKgueCuSd9LFxyXG4gICAgeyB2YWx1ZTogJ1NwZWNpZmllZFNldCcsIG5hbWU6ICfmtYHnqIvlm77ov57nur/oioLngrkr6ZmE5Yqg6IqC54K5JyB9XTtcclxuICBjYXRlZ29yeSA9ICcnO1xyXG4gIGRlZmF1bHRUeXBlID0gJyc7XHJcbiAgZGVmYXVsdFR5cGVMaXN0SXRlbXMgPSBbXHJcbiAgICB7IHZhbHVlOiAnRmlyc3ROb2RlJywgbmFtZTogJ+adoeS7tuS4unRydWXnmoTov57nur/oioLngrnvvIzlvZPmnInlpJrmnaHml7bpu5jorqTpgInkuK3pppbmnaEnfSxcclxuICAgIHsgdmFsdWU6ICdOdWxsTm9kZScsIG5hbWU6ICfpu5jorqTkuLrnqbrvvIzmr4/mrKHpg73miYvliqjpgInmi6knfSxcclxuICAgIHsgdmFsdWU6ICdTcGVjaWZ5Tm9kZScsIG5hbWU6ICfmjIflrprpu5jorqToioLngrknIH1dO1xyXG4gIGRlZmF1bHRBY3Rpdml0eSA9ICcnO1xyXG4gIHBhZ2VJbmZvID0ge1xyXG4gICAgcGFnZUluZGV4OiAxLFxyXG4gICAgcGFnZUxpc3Q6IFsxMCwgMjAsIDMwLCA1MF0sXHJcbiAgICBwYWdlU2l6ZTogMjBcclxuICB9O1xyXG4gIG91dENvbm5lY3ROb2RlOiB0cnVlO1xyXG4gIHRvdGFsOiBudW1iZXI7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgdWlzdGF0ZTogUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgfVxyXG5cclxuICBjbGlja09LKCkge1xyXG4gICAgaWYgKHRoaXMudmFsaWRhdG9yKCkpIHtcclxuICAgICAgbGV0IHZhbHVlO1xyXG4gICAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICAgIC8vIOmHjeaWsOaJk+W8gOiuvue9rueVjOmdou+8jOayoeaciei/m+ihjOiKgueCuemFjee9rueahOaDheWGte+8iERlZmF1bHRBY3Rpdml0ee+8iVxyXG4gICAgICBpZiAoIHRoaXMuZGVmYXVsdEFjdGl2aXR5ID09PSAnJyAmJiB0aGlzLmRlZmF1bHRhY3R5ICE9PSAnJykge1xyXG4gICAgICAgIGZvciAoY29uc3QgZGVmQWN0IG9mIHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0KSB7XHJcbiAgICAgICAgICBpZiAoZGVmQWN0Lk5hbWUgPT09IHRoaXMuZGVmYXVsdGFjdHkpIHtcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0QWN0aXZpdHkgPSBkZWZBY3QuSWQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIOmHjeaWsOaJk+W8gOiuvue9rueVjOmdou+8jOayoeaciei/m+ihjOiKgueCuemFjee9rueahOaDheWGte+8iERlc3RpbmF0aW9uQWN0aXZpdGllc++8iVxyXG4gICAgICBpZiAodGhpcy5mdWxsQWN0aXMubGVuZ3RoID09PSAwICYmIHRoaXMuYWN0aXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgYWN0IG9mIHRoaXMuYWN0aXMpIHtcclxuICAgICAgICAgIGZvciAoY29uc3QgYWxsQWN0IG9mIHRoaXMudWlzdGF0ZS51c2VyQWN0TGlzdCkge1xyXG4gICAgICAgICAgICBpZiAoYWN0ID09PSBhbGxBY3QuTmFtZSkge1xyXG4gICAgICAgICAgICAgIGxpc3QucHVzaChhbGxBY3QuSWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2F0ZWdvcnkgPT09ICdTcGVjaWZpZWRTZXQnICYmIHRoaXMuZnVsbEFjdGlzICYmIHRoaXMuZnVsbEFjdGlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyDpmYTliqDoioLngrnnmoRpZOS8oOe7meaooeWei+S4iueahERlc3RpbmF0aW9uQWN0aXZpdGllc1xyXG4gICAgICAgIHRoaXMuZnVsbEFjdGlzLmZvckVhY2goYWN0ID0+IGxpc3QucHVzaChhY3QuSWQpKTtcclxuICAgICAgfVxyXG4gICAgICB2YWx1ZSA9IHtcclxuICAgICAgICBDYXRlZ29yeTogdGhpcy5jYXRlZ29yeSxcclxuICAgICAgICBEZWZhdWx0VHlwZTogdGhpcy5kZWZhdWx0VHlwZSxcclxuICAgICAgICBEZWZhdWx0QWN0aXZpdHk6IHRoaXMuZGVmYXVsdEFjdGl2aXR5LFxyXG4gICAgICAgIERlc3RpbmF0aW9uQWN0aXZpdGllczogbGlzdCxcclxuICAgICAgfTtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdG9yKCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCF0aGlzLmNhdGVnb3J5KSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKCflsJrmnKrorr7nva7nm67moIfoioLngrnpgInpobnvvIzor7fkuobop6PvvIEnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gaWYgKHRoaXMuY2F0ZWdvcnkgPT09ICdTcGVjaWZpZWRTZXQnICYmIE9iamVjdC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih0aGlzLmFjdGlzKSkge1xyXG4gICAgLy8gICB0aGlzLm1lc3NhZ2UuaW5mbygn5bCa5pyq6YCJ5oup6ZmE5Yqg6IqC54K577yM6K+35LqG6Kej77yBJyk7XHJcbiAgICAvLyAgIHJldHVybiBmYWxzZTtcclxuICAgIC8vIH1cclxuICAgIGlmICh0aGlzLmRlZmF1bHRUeXBlID09PSAnU3BlY2lmeU5vZGUnICYmIHRoaXMuZGVmYXVsdGFjdHkgPT09ICcnKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKCflsJrmnKrmjIflrprpu5jorqToioLngrnvvIzor7fkuobop6PvvIEnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBhY3Rpc1NlbGVjdCA9IChyb3dEYXRhKTogT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+ID0+IHtcclxuICAgIC8vIOmZhOWKoOiKgueCueeahOW4ruWKqeWQjuS6i+S7tu+8jOaKiumAieS4reeahOaVsOaNrui1i+e7mWZ1bGxBY3Rpc++8iOatpOWkhOWkhOeQhueahOebrueahOaYr+S4uuS6huaYvuekuk5hbWXlkIzml7blj5ZJZOWAvO+8iVxyXG4gICAgLy8gY29uc29sZS5sb2cocm93RGF0YSk7XHJcbiAgICB0aGlzLmZ1bGxBY3RpcyA9IHJvd0RhdGE7XHJcbiAgICByZXR1cm4gb2Yoe1xyXG4gICAgICBjbG9zZURpYWxvZzogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWZhdWx0QWN0aXZpdHlTZWxlY3QgPSAocm93RGF0YSk6IE9ic2VydmFibGU8UGlja2VkUmVzdWx0PiA9PiB7XHJcbiAgICAvLyDpu5jorqToioLngrnnmoTluK7liqnlkI7kuovku7bvvIzmiorpgInkuK3nmoRpZOi1i+e7mWRlZmF1bHRBY3Rpdml0ee+8iOatpOWkhOWkhOeQhueahOebrueahOaYr+S4uuS6huaYvuekuk5hbWXlkIzml7blj5ZJZOWAvO+8iVxyXG4gICAgdGhpcy5kZWZhdWx0QWN0aXZpdHkgPSByb3dEYXRhLklkO1xyXG4gICAgcmV0dXJuIG9mKHtcclxuICAgICAgY2xvc2VEaWFsb2c6IHRydWVcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlUm93KCkge1xyXG4gICAgaWYgKHRoaXMuYWN0VGFibGUuc2VsZWN0ZWRSb3cgJiYgdGhpcy5hY3RUYWJsZS5zZWxlY3RlZFJvdy5kYXRhKSB7XHJcbiAgICAgIGNvbnN0IGkgPSB0aGlzLmFjdGlzLmZpbmRJbmRleChkID0+IGQuaWQgPT09IHRoaXMuYWN0VGFibGUuc2VsZWN0ZWRSb3cuZGF0YS5pZCk7XHJcbiAgICAgIHRoaXMuYWN0aXMuc3BsaWNlKGksIDEpO1xyXG4gICAgICB0aGlzLmFjdFRhYmxlLmxvYWREYXRhKHRoaXMuYWN0aXMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+ivt+mmluWFiOmAieS4reS4gOadoemAiemhue+8gScpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5leHBvcnQgY2xhc3MgSnVtcFNjb3BlQ29udmVydGVyIGltcGxlbWVudHMgVHlwZUNvbnZlcnRlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgY29udmVydFRvKGRhdGE6IGFueSk6IHN0cmluZyB7XHJcbiAgICBpZiAoZGF0YSkge1xyXG4gICAgICByZXR1cm4gJ++8iOW3suiuvue9ru+8iSc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJ++8iOacquiuvue9ru+8iSc7XHJcbiAgfVxyXG59XHJcblxyXG4iXX0=