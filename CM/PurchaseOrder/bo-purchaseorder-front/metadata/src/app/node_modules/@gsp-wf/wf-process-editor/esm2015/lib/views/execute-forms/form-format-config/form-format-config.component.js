/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, TemplateRef, ViewChild, Input } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { of, forkJoin } from 'rxjs';
import { FormFormat } from '../entities/form-format';
import { FormFormatConfig, FormButtonConfig, FormFieldConfig } from '../entities/form-format-config';
import { DatagridComponent } from '@farris/ui-datagrid';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { switchMap, catchError } from 'rxjs/operators';
import { FormOperationConfigComponent } from '../form-operation-config/form-operation-config.component';
import { TreeTableComponent } from '@farris/ui-treetable';
export class FormFormatConfigComponent {
    /**
     * @param {?} http
     * @param {?} message
     * @param {?} notify
     */
    constructor(http, message, notify) {
        this.http = http;
        this.message = message;
        this.notify = notify;
        this.config = new FormFormatConfig();
        this.formFormat = new FormFormat();
        this.state = 'edit';
        this.showMethodTab = true;
        this.buttonCols = [];
        this.buttonConfigs = new Array();
        this.fieldCols = [];
        this.fieldConfigs = new Array();
        this.formatFieldList = new Array();
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set formFormatId(v) {
        this._formFormatId = v;
        this.config.formFormatId = v;
    }
    /**
     * @return {?}
     */
    get formFormatId() {
        return this._formFormatId;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set formatConfigId(v) {
        this._formatConfigId = v;
        if (!v) {
            this.state = 'new';
        }
    }
    /**
     * @return {?}
     */
    get formatConfigId() {
        return this._formatConfigId;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.buttonCols = [
            { field: 'buttonName', width: 100, title: '按钮名称' },
            // { field: 'buttonId', width: 100, title: '按钮标识' },
            {
                title: '是否可用',
                field: 'enable',
                width: 80,
                template: this.btnEnable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: '是否禁用',
                field: 'disabled',
                width: 80,
                template: this.btnDisabled,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: '是否隐藏',
                field: 'hidden',
                width: 80,
                template: this.btnHidden,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.fieldCols = [
            { field: 'fieldName', width: 100, title: '字段名称' },
            // { field: 'fieldId', width: 100, title: '字段标识' },
            {
                title: '是否可写',
                field: 'editable',
                width: 80,
                template: this.fieldEditable,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: '是否只读',
                field: 'readonly',
                width: 80,
                template: this.fieldReadonly,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: '是否隐藏',
                field: 'hidden',
                width: 80,
                template: this.fieldHidden,
                align: 'center',
                hAlign: 'center'
            },
            {
                title: '是否必填',
                field: 'required',
                width: 80,
                template: this.fieldRequired,
                align: 'center',
                hAlign: 'center'
            }
        ];
        this.getConfig();
    }
    /**
     * @return {?}
     */
    submit() {
        if (this.validator()) {
            this.setBtnAndFieldConfigs();
            if (this.state === 'new' &&
                this.config.formButtonConfigs.length === 0 &&
                this.config.formFieldConfigs.length === 0 &&
                this.operationConfig.operations.length === 0) {
                return of({ result: true, configId: null });
            }
            else {
                return this.saveConfig(this.config).pipe(switchMap((/**
                 * @param {?} re
                 * @return {?}
                 */
                re => {
                    return of({ result: true, configId: this.config.id });
                })), catchError((/**
                 * @param {?} re
                 * @return {?}
                 */
                re => {
                    this.message.error('保存配置失败，请联系管理员查看原因！');
                    return of({ result: false, configId: this.config.id });
                })));
            }
        }
        else {
            return of({ result: false, configId: null });
        }
    }
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    btnConfigChange(bool, field, id) {
        if (bool) {
            for (const b of this.buttonConfigs) {
                if (b.id === id) {
                    switch (field) {
                        case 'enable':
                            b.enable = bool;
                            b.disabled = false;
                            b.hidden = false;
                            break;
                        case 'disabled':
                            b.disabled = bool;
                            b.enable = false;
                            b.hidden = false;
                            break;
                        case 'hidden':
                            b.hidden = bool;
                            b.disabled = false;
                            b.enable = false;
                            break;
                    }
                }
            }
        }
    }
    /**
     * @param {?} operation
     * @return {?}
     */
    btnBatchOperate(operation) {
        /** @type {?} */
        const checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                this.btnConfigChange(true, operation, c.id);
            }
        }
    }
    /**
     * @return {?}
     */
    btnBatchReset() {
        /** @type {?} */
        const checkeds = this.btnGrid.checkedRows;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                /** @type {?} */
                const button = this.formFormat.formButtons.find((/**
                 * @param {?} b
                 * @return {?}
                 */
                b => b.id === c.id));
                for (const b of this.buttonConfigs) {
                    if (b.id === c.id) {
                        b.enable = button.buttonState === 'Enable' ? true : false;
                        b.disabled = button.buttonState === 'Disabled' ? true : false;
                        b.hidden = button.buttonState === 'Hidden' ? true : false;
                    }
                }
            }
        }
    }
    /**
     * @param {?} bool
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    fieldConfigChange(bool, field, id) {
        if (bool) {
            this.fieldSwitchChange(this.fieldConfigs, field, id);
        }
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} field
     * @param {?} id
     * @return {?}
     */
    fieldSwitchChange(fieldConfigs, field, id) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.data.id === id) {
                    switch (field) {
                        case 'editable':
                            f.data.editable = true;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'readonly':
                            f.data.editable = false;
                            f.data.readonly = true;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'hidden':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = true;
                            f.data.required = false;
                            break;
                        case 'required':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = true;
                            break;
                    }
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.fieldSwitchChange(f.children, field, id);
                    }
                }
            }
        }
    }
    /**
     * @param {?} operation
     * @return {?}
     */
    fieldBatchOperate(operation) {
        /** @type {?} */
        const checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                this.fieldConfigChange(true, operation, c.data.id);
            }
        }
    }
    /**
     * @return {?}
     */
    fieldBatchReset() {
        /** @type {?} */
        const checkeds = this.fieldTree.checkeds;
        if (checkeds && checkeds.length > 0) {
            for (const c of checkeds) {
                /** @type {?} */
                const field = this.formatFieldList.find((/**
                 * @param {?} f
                 * @return {?}
                 */
                f => f.id === c.data.id));
                this.resetFieldConfig(this.fieldConfigs, c.data.id, field);
            }
        }
    }
    /**
     * @param {?} fieldConfigs
     * @param {?} id
     * @param {?} field
     * @return {?}
     */
    resetFieldConfig(fieldConfigs, id, field) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.leaf === true && f.data.id === id) {
                    f.data.editable = field.fieldState === 'Editable' ? true : false;
                    f.data.readonly = field.fieldState === 'Readonly' ? true : false;
                    f.data.hidden = field.fieldState === 'Hidden' ? true : false;
                    f.data.required = field.fieldState === 'Required' ? true : false;
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.resetFieldConfig(f.children, id, field);
                    }
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    validator() {
        return this.operationConfig.validator();
    }
    /**
     * @private
     * @return {?}
     */
    setBtnAndFieldConfigs() {
        this.config.formButtonConfigs = new Array();
        for (const btn of this.buttonConfigs) {
            /** @type {?} */
            const button = this.formFormat.formButtons.find((/**
             * @param {?} b
             * @return {?}
             */
            b => b.buttonId === btn.buttonId));
            /** @type {?} */
            const btnConfig = new FormButtonConfig();
            btnConfig.buttonId = btn.buttonId;
            if (btn.enable) {
                btnConfig.buttonState = 'Enable';
            }
            else if (btn.disabled) {
                btnConfig.buttonState = 'Disabled';
            }
            else if (btn.hidden) {
                btnConfig.buttonState = 'Hidden';
            }
            else {
                continue;
            }
            if (!button.buttonState && btnConfig.buttonState) {
                this.config.formButtonConfigs.push(btnConfig);
            }
            if (button.buttonState && button.buttonState !== btnConfig.buttonState) {
                this.config.formButtonConfigs.push(btnConfig);
            }
        }
        this.config.formFieldConfigs = new Array();
        this.getFieldConfigs(this.fieldConfigs);
        this.config.formMethodConfigs = this.operationConfig.operations || new Array();
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @return {?}
     */
    getFieldConfigs(fieldConfigs) {
        if (fieldConfigs && fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.children && f.children.length > 0) {
                    this.getFieldConfigs(f.children);
                }
                if (f.leaf === false) {
                    continue;
                }
                /** @type {?} */
                const field = this.formatFieldList.find((/**
                 * @param {?} fd
                 * @return {?}
                 */
                fd => fd.fieldId === f.data.fieldId));
                /** @type {?} */
                const fieldConfig = new FormFieldConfig();
                fieldConfig.fieldId = f.data.fieldId;
                if (f.data.editable) {
                    fieldConfig.fieldState = 'Editable';
                }
                else if (f.data.readonly) {
                    fieldConfig.fieldState = 'Readonly';
                }
                else if (f.data.hidden) {
                    fieldConfig.fieldState = 'Hidden';
                }
                else if (f.data.required) {
                    fieldConfig.fieldState = 'Required';
                }
                else {
                    continue;
                }
                if (!field.fieldState && fieldConfig.fieldState) {
                    this.config.formFieldConfigs.push(fieldConfig);
                }
                if (field.fieldState && field.fieldState !== fieldConfig.fieldState) {
                    this.config.formFieldConfigs.push(fieldConfig);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getConfig() {
        if (this.formFormatId) {
            forkJoin(this.getFormFormat(), this.getFormFormatConfig()).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            (re) => {
                /** @type {?} */
                const formFormat = (/** @type {?} */ (re[0]));
                if (formFormat) {
                    this.formFormat = this.convertFormFormat(formFormat);
                }
                /** @type {?} */
                const config = (/** @type {?} */ (re[1]));
                if (config) {
                    this.config = config;
                }
                if (this.formFormat.formButtons) {
                    this.buttonConfigs = this.formFormat.formButtons.map((/**
                     * @param {?} b
                     * @return {?}
                     */
                    b => Object.assign({}, b, {
                        enable: b.buttonState === 'Enable' ? true : false,
                        disabled: b.buttonState === 'Disabled' ? true : false,
                        hidden: b.buttonState === 'Hidden' ? true : false
                    })));
                    /** @type {?} */
                    let btnConfigs = new Array();
                    if (config && config.formButtonConfigs) {
                        btnConfigs = config.formButtonConfigs;
                    }
                    for (const b of btnConfigs) {
                        for (const btn of this.buttonConfigs) {
                            if (btn.buttonId === b.buttonId) {
                                switch (b.buttonState) {
                                    case 'Enable':
                                        btn.enable = true;
                                        btn.disabled = false;
                                        btn.hidden = false;
                                        break;
                                    case 'Disabled':
                                        btn.enable = false;
                                        btn.disabled = true;
                                        btn.hidden = false;
                                        break;
                                    case 'Hidden':
                                        btn.enable = false;
                                        btn.disabled = false;
                                        btn.hidden = true;
                                        break;
                                }
                                break;
                            }
                        }
                    }
                }
                if (this.formFormat.formFields) {
                    this.fieldConfigs = [...this.formFormat.formFields];
                    this.orgFieldConfigs(this.fieldConfigs);
                    /** @type {?} */
                    let configs = new Array();
                    if (config && config.formFieldConfigs) {
                        configs = config.formFieldConfigs;
                    }
                    for (const f of configs) {
                        this.setFieldConfig(this.fieldConfigs, f);
                    }
                }
            }));
        }
    }
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    orgFieldConfigs(formFields) {
        if (formFields.length > 0) {
            for (const d of formFields) {
                d.data = Object.assign({}, d.data, {
                    editable: d.data.fieldState === 'Editable' ? true : false,
                    readonly: d.data.fieldState === 'Readonly' ? true : false,
                    hidden: d.data.fieldState === 'Hidden' ? true : false,
                    required: d.data.fieldState === 'Required' ? true : false
                });
                if (d.children && d.children) {
                    this.orgFieldConfigs(d.children);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} fieldConfigs
     * @param {?} config
     * @return {?}
     */
    setFieldConfig(fieldConfigs, config) {
        if (fieldConfigs.length > 0) {
            for (const f of fieldConfigs) {
                if (f.data.fieldId === config.fieldId) {
                    switch (config.fieldState) {
                        case 'Editable':
                            f.data.editable = true;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'Readonly':
                            f.data.editable = false;
                            f.data.readonly = true;
                            f.data.hidden = false;
                            f.data.required = false;
                            break;
                        case 'Hidden':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = true;
                            f.data.required = false;
                            break;
                        case 'Required':
                            f.data.editable = false;
                            f.data.readonly = false;
                            f.data.hidden = false;
                            f.data.required = true;
                            break;
                    }
                    return;
                }
                else {
                    if (f.children && f.children.length > 0) {
                        this.setFieldConfig(f.children, config);
                    }
                }
            }
        }
    }
    /**
     * @private
     * @param {?} config
     * @return {?}
     */
    saveConfig(config) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/formFormatConfig';
        return this.http.post(url, config);
    }
    /**
     * @private
     * @return {?}
     */
    getFormFormat() {
        if (this.formFormatId) {
            /** @type {?} */
            let url = `/api/runtime/wf/v1.0/formFormat/${this.formFormatId}`;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of(null);
        }
    }
    /**
     * @private
     * @return {?}
     */
    getFormFormatConfig() {
        if (this.formatConfigId) {
            /** @type {?} */
            let url = `/api/runtime/wf/v1.0/formFormatConfig/${this.formatConfigId}`;
            url = encodeURI(url);
            return this.http.get(url);
        }
        else {
            return of(null);
        }
    }
    /**
     * @private
     * @param {?} formFormat
     * @return {?}
     */
    convertFormFormat(formFormat) {
        if (!formFormat.status) {
            formFormat.status = 0;
        }
        this.convertformFields(formFormat.formFields);
        this.getFormatFieldList(formFormat.formFields, this.formatFieldList);
        return formFormat;
    }
    /**
     * @private
     * @param {?} formFields
     * @return {?}
     */
    convertformFields(formFields) {
        if (formFields.length > 0) {
            for (const d of formFields) {
                if (typeof (d.leaf) !== 'boolean' && (d.leaf == null || d.leaf === undefined)) {
                    d.leaf = true;
                }
                if (d.children && d.children) {
                    this.orgFieldConfigs(d.children);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} formFields
     * @param {?} array
     * @return {?}
     */
    getFormatFieldList(formFields, array) {
        if (formFields.length > 0) {
            for (const d of formFields) {
                array.push(d.data);
                if (d.children && d.children) {
                    this.getFormatFieldList(d.children, array);
                }
            }
        }
    }
    /**
     * @private
     * @param {?} formFields
     * @param {?} fieldId
     * @return {?}
     */
    getFormatField(formFields, fieldId) {
        for (const f of formFields) {
            if (f.data.fieldId === fieldId) {
                return f;
            }
            if (f.children && f.children.length > 0) {
                return this.getFormatField(f.children, fieldId);
            }
        }
    }
}
FormFormatConfigComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-form-format-config',
                template: "\r\n<!--\u9700\u8981\u5D4C\u5957\u7684\u5C42-----------\u6807\u7B7E\u9875---------------->\r\n<farris-tabs class=\"h-100 f-component-tabs f-tabs-has-grid\" [value]=\"'buttonConfig'\" [contentFill]=\"true\">\r\n  <farris-tab [title]=\"'\u8868\u5355\u6309\u94AE'\" [id]=\"'buttonConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('enable')\">\r\n        \u53EF\u7528\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('disabled')\">\r\n        \u7981\u7528\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchOperate('hidden')\">\r\n        \u9690\u85CF\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"btnBatchReset()\">\r\n        \u91CD\u7F6E\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <farris-datagrid class=\"f-component-grid f-utils-fill\" [columns]=\"buttonCols\" [data]=\"buttonConfigs\" #btnGrid\r\n          [idField]=\"'id'\" [showLineNumber]=\"false\" [fitColumns]=\"true\" [striped]=\"true\"\r\n          [virtualized]=\"true\" [pagination]=\"false\" [useThemes]=\"false\" [fit]=\"true\" [showAllCheckbox]=\"true\" \r\n          [showCheckbox]=\"true\" [multiSelect]=\"true\">\r\n        </farris-datagrid>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab [title]=\"'\u8868\u5355\u5B57\u6BB5'\" [id]=\"'fieldConfig'\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('editable')\">\r\n        \u53EF\u5199\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('readonly')\">\r\n        \u53EA\u8BFB\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('hidden')\">\r\n        \u9690\u85CF\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchOperate('required')\">\r\n        \u5FC5\u586B\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"fieldBatchReset()\">\r\n        \u91CD\u7F6E\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <div class=\"f-utils-fill-flex-column\" style=\"background: #FFF;\">\r\n        <!-- <farris-datagrid class=\"f-component-grid f-utils-fill\" [columns]=\"fieldCols\" [data]=\"fieldConfigs\" #fieldGrid\r\n          [idField]=\"'id'\" [showLineNumber]=\"false\" [fitColumns]=\"true\" [striped]=\"true\"\r\n          [virtualized]=\"true\" [pagination]=\"false\" [useThemes]=\"false\" [fit]=\"true\" [showAllCheckbox]=\"true\" \r\n          [showCheckbox]=\"true\" [multiSelect]=\"true\">\r\n        </farris-datagrid> -->\r\n        <farris-treetable #fieldTree [columns]=\"fieldCols\" \r\n          [showBorder]=\"false\" [showHeader]=\"true\" [data]=\"fieldConfigs\" [fit]=\"true\" [fitColumns]=\"true\"\r\n          [idField]=\"'id'\" [singleSelect]=\"false\" [showCheckbox]=\"true\" \r\n          [showCheckAll]=\"true\" [striped]=\"true\" [fixedHeader]=\"true\">\r\n        </farris-treetable>\r\n      </div>\r\n    </ng-template>\r\n  </farris-tab>\r\n  <farris-tab [title]=\"'\u8868\u5355\u4E8B\u4EF6'\" [id]=\"'operationConfig'\" [show]=\"showMethodTab\">\r\n    <ng-template farrisTabsExtend>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.add()\">\r\n        \u65B0\u589E\r\n      </farris-button>\r\n      <farris-button [type]=\"'link'\" (click)=\"operationConfig.delete()\">\r\n        \u5220\u9664\r\n      </farris-button>\r\n    </ng-template>\r\n    <ng-template #content>\r\n      <lib-form-operation-config \r\n        [formFormatId]=\"formFormatId\" \r\n        [formFormatConfigId]=\"config.id\" \r\n        [operations]=\"config.formMethodConfigs\"\r\n        class=\"h-100\"></lib-form-operation-config>\r\n    </ng-template>\r\n  </farris-tab>\r\n</farris-tabs>\r\n<!--Tab\u533A\u57DF-->  \r\n      \r\n  <!-- </section>\r\n</div> -->\r\n\r\n<ng-template #btnEnable let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.enable\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnDisabled let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.disabled\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #btnHidden let-ctx>\r\n  <farris-switch [(ngModel)]=\"ctx.rowData.hidden\" (valueChange)=\"btnConfigChange($event, ctx.field, ctx.rowData.id)\"></farris-switch>\r\n</ng-template>\r\n<ng-template #fieldEditable let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.editable\"\r\n  (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldReadonly let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.readonly\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldHidden let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.hidden\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n<ng-template #fieldRequired let-ctx>\r\n  <farris-switch *ngIf=\"ctx.node.leaf\" size=\"small\" [(ngModel)]=\"ctx.node.data.required\"\r\n    (valueChange)=\"fieldConfigChange($event, ctx.column.field, ctx.node.data.id)\">\r\n  </farris-switch>\r\n</ng-template>\r\n\r\n\r\n",
                styles: [""]
            }] }
];
/** @nocollapse */
FormFormatConfigComponent.ctorParameters = () => [
    { type: HttpService },
    { type: MessagerService },
    { type: NotifyService }
];
FormFormatConfigComponent.propDecorators = {
    btnEnable: [{ type: ViewChild, args: ['btnEnable',] }],
    btnDisabled: [{ type: ViewChild, args: ['btnDisabled',] }],
    btnHidden: [{ type: ViewChild, args: ['btnHidden',] }],
    fieldEditable: [{ type: ViewChild, args: ['fieldEditable',] }],
    fieldReadonly: [{ type: ViewChild, args: ['fieldReadonly',] }],
    fieldHidden: [{ type: ViewChild, args: ['fieldHidden',] }],
    fieldRequired: [{ type: ViewChild, args: ['fieldRequired',] }],
    btnGrid: [{ type: ViewChild, args: ['btnGrid',] }],
    fieldTree: [{ type: ViewChild, args: ['fieldTree',] }],
    operationConfig: [{ type: ViewChild, args: [FormOperationConfigComponent,] }],
    showMethodTab: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnEnable;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnDisabled;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnHidden;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldEditable;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldReadonly;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldHidden;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldRequired;
    /** @type {?} */
    FormFormatConfigComponent.prototype.btnGrid;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldTree;
    /** @type {?} */
    FormFormatConfigComponent.prototype.operationConfig;
    /** @type {?} */
    FormFormatConfigComponent.prototype.config;
    /** @type {?} */
    FormFormatConfigComponent.prototype.formFormat;
    /** @type {?} */
    FormFormatConfigComponent.prototype.state;
    /** @type {?} */
    FormFormatConfigComponent.prototype.showMethodTab;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype._formFormatId;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype._formatConfigId;
    /** @type {?} */
    FormFormatConfigComponent.prototype.buttonCols;
    /** @type {?} */
    FormFormatConfigComponent.prototype.buttonConfigs;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldCols;
    /** @type {?} */
    FormFormatConfigComponent.prototype.fieldConfigs;
    /** @type {?} */
    FormFormatConfigComponent.prototype.formatFieldList;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    FormFormatConfigComponent.prototype.notify;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3MvZXhlY3V0ZS1mb3Jtcy9mb3JtLWZvcm1hdC1jb25maWcvZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxXQUFXLEVBQUUsU0FBUyxFQUFlLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM5RixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFbEQsT0FBTyxFQUFjLEVBQUUsRUFBRSxRQUFRLEVBQVcsTUFBTSxNQUFNLENBQUM7QUFDekQsT0FBTyxFQUFFLFVBQVUsRUFBNEIsTUFBTSx5QkFBeUIsQ0FBQztBQUMvRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDckcsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFeEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBQ3hHLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBTzFELE1BQU0sT0FBTyx5QkFBeUI7Ozs7OztJQWtEcEMsWUFDVSxJQUFpQixFQUNqQixPQUF3QixFQUN4QixNQUFxQjtRQUZyQixTQUFJLEdBQUosSUFBSSxDQUFhO1FBQ2pCLFlBQU8sR0FBUCxPQUFPLENBQWlCO1FBQ3hCLFdBQU0s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QixvREFBZ0Q7Ozs7O0lBRzlDLHlDQUF5Qjs7Ozs7SUFDekIsNENBQWdDOzs7OztJQUNoQywyQ0FBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZCwgSG9zdEJpbmRpbmcsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IElGb3JtRm9ybWF0Q29uZmlnQ29tcG9uZW50IH0gZnJvbSBcIkBnc3Atd2YvYml6LXByb2Nlc3MtYXBpXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mLCBmb3JrSm9pbiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBGb3JtRm9ybWF0LCBGb3JtRmllbGREYXRhLCBGb3JtRmllbGQgfSBmcm9tICcuLi9lbnRpdGllcy9mb3JtLWZvcm1hdCc7XHJcbmltcG9ydCB7IEZvcm1Gb3JtYXRDb25maWcsIEZvcm1CdXR0b25Db25maWcsIEZvcm1GaWVsZENvbmZpZyB9IGZyb20gJy4uL2VudGl0aWVzL2Zvcm0tZm9ybWF0LWNvbmZpZyc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IFBpY2tlZFJlc3VsdCwgU2VydmVyU2lkZVRva2VuLCBMb29rdXBHcmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIGNhdGNoRXJyb3IgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IEZvcm1PcGVyYXRpb25Db25maWdDb21wb25lbnQgfSBmcm9tICcuLi9mb3JtLW9wZXJhdGlvbi1jb25maWcvZm9ybS1vcGVyYXRpb24tY29uZmlnLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFRyZWVUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktdHJlZXRhYmxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLWZvcm0tZm9ybWF0LWNvbmZpZycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2Zvcm0tZm9ybWF0LWNvbmZpZy5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vZm9ybS1mb3JtYXQtY29uZmlnLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEZvcm1Gb3JtYXRDb25maWdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIElGb3JtRm9ybWF0Q29uZmlnQ29tcG9uZW50IHtcclxuXHJcbiAgQFZpZXdDaGlsZCgnYnRuRW5hYmxlJykgYnRuRW5hYmxlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2J0bkRpc2FibGVkJykgYnRuRGlzYWJsZWQ6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnYnRuSGlkZGVuJykgYnRuSGlkZGVuOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpZWxkRWRpdGFibGUnKSBmaWVsZEVkaXRhYmxlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpZWxkUmVhZG9ubHknKSBmaWVsZFJlYWRvbmx5OiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpZWxkSGlkZGVuJykgZmllbGRIaWRkZW46IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZmllbGRSZXF1aXJlZCcpIGZpZWxkUmVxdWlyZWQ6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2J0bkdyaWQnKSBidG5HcmlkOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdmaWVsZFRyZWUnKSBmaWVsZFRyZWU6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKEZvcm1PcGVyYXRpb25Db25maWdDb21wb25lbnQpIG9wZXJhdGlvbkNvbmZpZzogRm9ybU9wZXJhdGlvbkNvbmZpZ0NvbXBvbmVudDtcclxuXHJcbiAgY29uZmlnOiBGb3JtRm9ybWF0Q29uZmlnID0gbmV3IEZvcm1Gb3JtYXRDb25maWcoKTtcclxuICBmb3JtRm9ybWF0OiBGb3JtRm9ybWF0ID0gbmV3IEZvcm1Gb3JtYXQoKTtcclxuXHJcbiAgc3RhdGU6ICduZXcnIHwgJ2VkaXQnID0gJ2VkaXQnO1xyXG5cclxuICBASW5wdXQoKSBzaG93TWV0aG9kVGFiID0gdHJ1ZTtcclxuXHJcbiAgcHJpdmF0ZSBfZm9ybUZvcm1hdElkOiBzdHJpbmc7XHJcbiAgc2V0IGZvcm1Gb3JtYXRJZCh2OiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Zvcm1Gb3JtYXRJZCA9IHY7XHJcbiAgICB0aGlzLmNvbmZpZy5mb3JtRm9ybWF0SWQgPSB2O1xyXG4gIH1cclxuXHJcbiAgZ2V0IGZvcm1Gb3JtYXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRm9ybWF0SWQ7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9mb3JtYXRDb25maWdJZDogc3RyaW5nO1xyXG4gIHNldCBmb3JtYXRDb25maWdJZCh2OiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Zvcm1hdENvbmZpZ0lkID0gdjtcclxuICAgIGlmICghdikge1xyXG4gICAgICB0aGlzLnN0YXRlID0gJ25ldyc7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGdldCBmb3JtYXRDb25maWdJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtYXRDb25maWdJZDtcclxuICB9XHJcblxyXG4gIGJ1dHRvbkNvbHMgPSBbXTtcclxuICBidXR0b25Db25maWdzID0gbmV3IEFycmF5KCk7XHJcblxyXG4gIGZpZWxkQ29scyA9IFtdO1xyXG4gIGZpZWxkQ29uZmlncyA9IG5ldyBBcnJheSgpO1xyXG5cclxuICBmb3JtYXRGaWVsZExpc3Q6IEFycmF5PEZvcm1GaWVsZD4gPSBuZXcgQXJyYXkoKTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZVxyXG4gICkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5idXR0b25Db2xzID0gW1xyXG4gICAgICB7IGZpZWxkOiAnYnV0dG9uTmFtZScsIHdpZHRoOiAxMDAsIHRpdGxlOiAn5oyJ6ZKu5ZCN56ewJyB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiAnYnV0dG9uSWQnLCB3aWR0aDogMTAwLCB0aXRsZTogJ+aMiemSruagh+ivhicgfSxcclxuICAgICAge1xyXG4gICAgICAgIHRpdGxlOiAn5piv5ZCm5Y+v55SoJyxcclxuICAgICAgICBmaWVsZDogJ2VuYWJsZScsXHJcbiAgICAgICAgd2lkdGg6IDgwLFxyXG4gICAgICAgIHRlbXBsYXRlOiB0aGlzLmJ0bkVuYWJsZSxcclxuICAgICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgaEFsaWduOiAnY2VudGVyJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfmmK/lkKbnpoHnlKgnLFxyXG4gICAgICAgIGZpZWxkOiAnZGlzYWJsZWQnLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5idG5EaXNhYmxlZCxcclxuICAgICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgaEFsaWduOiAnY2VudGVyJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfmmK/lkKbpmpDol48nLFxyXG4gICAgICAgIGZpZWxkOiAnaGlkZGVuJyxcclxuICAgICAgICB3aWR0aDogODAsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMuYnRuSGlkZGVuLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH1dO1xyXG4gICAgdGhpcy5maWVsZENvbHMgPSBbXHJcbiAgICAgIHsgZmllbGQ6ICdmaWVsZE5hbWUnLCB3aWR0aDogMTAwLCB0aXRsZTogJ+Wtl+auteWQjeensCcgfSxcclxuICAgICAgLy8geyBmaWVsZDogJ2ZpZWxkSWQnLCB3aWR0aDogMTAwLCB0aXRsZTogJ+Wtl+auteagh+ivhicgfSxcclxuICAgICAge1xyXG4gICAgICAgIHRpdGxlOiAn5piv5ZCm5Y+v5YaZJyxcclxuICAgICAgICBmaWVsZDogJ2VkaXRhYmxlJyxcclxuICAgICAgICB3aWR0aDogODAsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMuZmllbGRFZGl0YWJsZSxcclxuICAgICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgaEFsaWduOiAnY2VudGVyJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfmmK/lkKblj6ror7snLFxyXG4gICAgICAgIGZpZWxkOiAncmVhZG9ubHknLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZFJlYWRvbmx5LFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB0aXRsZTogJ+aYr+WQpumakOiXjycsXHJcbiAgICAgICAgZmllbGQ6ICdoaWRkZW4nLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZEhpZGRlbixcclxuICAgICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgICAgaEFsaWduOiAnY2VudGVyJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfmmK/lkKblv4XloasnLFxyXG4gICAgICAgIGZpZWxkOiAncmVxdWlyZWQnLFxyXG4gICAgICAgIHdpZHRoOiA4MCxcclxuICAgICAgICB0ZW1wbGF0ZTogdGhpcy5maWVsZFJlcXVpcmVkLFxyXG4gICAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICBoQWxpZ246ICdjZW50ZXInXHJcbiAgICAgIH1dO1xyXG4gICAgdGhpcy5nZXRDb25maWcoKTtcclxuICB9XHJcblxyXG4gIHN1Ym1pdCgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKHRoaXMudmFsaWRhdG9yKCkpIHtcclxuICAgICAgdGhpcy5zZXRCdG5BbmRGaWVsZENvbmZpZ3MoKTtcclxuICAgICAgaWYgKHRoaXMuc3RhdGUgPT09ICduZXcnICYmXHJcbiAgICAgICAgdGhpcy5jb25maWcuZm9ybUJ1dHRvbkNvbmZpZ3MubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgdGhpcy5jb25maWcuZm9ybUZpZWxkQ29uZmlncy5sZW5ndGggPT09IDAgJiZcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbkNvbmZpZy5vcGVyYXRpb25zLmxlbmd0aCA9PT0gMFxyXG4gICAgICApIHtcclxuICAgICAgICByZXR1cm4gb2YoeyByZXN1bHQ6IHRydWUsIGNvbmZpZ0lkOiBudWxsIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmVDb25maWcodGhpcy5jb25maWcpLnBpcGUoXHJcbiAgICAgICAgICBzd2l0Y2hNYXAocmUgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YoeyByZXN1bHQ6IHRydWUsIGNvbmZpZ0lkOiB0aGlzLmNvbmZpZy5pZCB9KTtcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgY2F0Y2hFcnJvcihyZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZS5lcnJvcign5L+d5a2Y6YWN572u5aSx6LSl77yM6K+36IGU57O7566h55CG5ZGY5p+l55yL5Y6f5Zug77yBJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7IHJlc3VsdDogZmFsc2UsIGNvbmZpZ0lkOiB0aGlzLmNvbmZpZy5pZCB9KTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIG9mKHsgcmVzdWx0OiBmYWxzZSwgY29uZmlnSWQ6IG51bGwgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBidG5Db25maWdDaGFuZ2UoYm9vbDogYm9vbGVhbiwgZmllbGQ6IHN0cmluZywgaWQ6IHN0cmluZykge1xyXG4gICAgaWYgKGJvb2wpIHtcclxuICAgICAgZm9yIChjb25zdCBiIG9mIHRoaXMuYnV0dG9uQ29uZmlncykge1xyXG4gICAgICAgIGlmIChiLmlkID09PSBpZCkge1xyXG4gICAgICAgICAgc3dpdGNoIChmaWVsZCkge1xyXG4gICAgICAgICAgICBjYXNlICdlbmFibGUnOlxyXG4gICAgICAgICAgICAgIGIuZW5hYmxlID0gYm9vbDtcclxuICAgICAgICAgICAgICBiLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYi5oaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGlzYWJsZWQnOlxyXG4gICAgICAgICAgICAgIGIuZGlzYWJsZWQgPSBib29sO1xyXG4gICAgICAgICAgICAgIGIuZW5hYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYi5oaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnaGlkZGVuJzpcclxuICAgICAgICAgICAgICBiLmhpZGRlbiA9IGJvb2w7XHJcbiAgICAgICAgICAgICAgYi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGIuZW5hYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBidG5CYXRjaE9wZXJhdGUob3BlcmF0aW9uOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGNoZWNrZWRzID0gdGhpcy5idG5HcmlkLmNoZWNrZWRSb3dzO1xyXG4gICAgaWYgKGNoZWNrZWRzICYmIGNoZWNrZWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBjIG9mIGNoZWNrZWRzKSB7XHJcbiAgICAgICAgdGhpcy5idG5Db25maWdDaGFuZ2UodHJ1ZSwgb3BlcmF0aW9uLCBjLmlkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYnRuQmF0Y2hSZXNldCgpIHtcclxuICAgIGNvbnN0IGNoZWNrZWRzID0gdGhpcy5idG5HcmlkLmNoZWNrZWRSb3dzO1xyXG4gICAgaWYgKGNoZWNrZWRzICYmIGNoZWNrZWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBjIG9mIGNoZWNrZWRzKSB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy5mb3JtRm9ybWF0LmZvcm1CdXR0b25zLmZpbmQoYiA9PiBiLmlkID09PSBjLmlkKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGIgb2YgdGhpcy5idXR0b25Db25maWdzKSB7XHJcbiAgICAgICAgICBpZiAoYi5pZCA9PT0gYy5pZCkge1xyXG4gICAgICAgICAgICBiLmVuYWJsZSA9IGJ1dHRvbi5idXR0b25TdGF0ZSA9PT0gJ0VuYWJsZScgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGIuZGlzYWJsZWQgPSBidXR0b24uYnV0dG9uU3RhdGUgPT09ICdEaXNhYmxlZCcgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGIuaGlkZGVuID0gYnV0dG9uLmJ1dHRvblN0YXRlID09PSAnSGlkZGVuJyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZpZWxkQ29uZmlnQ2hhbmdlKGJvb2w6IGJvb2xlYW4sIGZpZWxkOiBzdHJpbmcsIGlkOiBzdHJpbmcpIHtcclxuICAgIGlmIChib29sKSB7XHJcbiAgICAgIHRoaXMuZmllbGRTd2l0Y2hDaGFuZ2UodGhpcy5maWVsZENvbmZpZ3MsIGZpZWxkLCBpZCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgZmllbGRTd2l0Y2hDaGFuZ2UoZmllbGRDb25maWdzOiBBcnJheTxhbnk+LCBmaWVsZDogc3RyaW5nLCBpZDogc3RyaW5nKSB7XHJcbiAgICBpZiAoZmllbGRDb25maWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBmIG9mIGZpZWxkQ29uZmlncykge1xyXG4gICAgICAgIGlmIChmLmRhdGEuaWQgPT09IGlkKSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGZpZWxkKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VkaXRhYmxlJzpcclxuICAgICAgICAgICAgICBmLmRhdGEuZWRpdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5oaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEucmVxdWlyZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmVhZG9ubHknOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdoaWRkZW4nOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5oaWRkZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyZXF1aXJlZCc6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChmLmNoaWxkcmVuICYmIGYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkU3dpdGNoQ2hhbmdlKGYuY2hpbGRyZW4sIGZpZWxkLCBpZCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmaWVsZEJhdGNoT3BlcmF0ZShvcGVyYXRpb246IHN0cmluZykge1xyXG4gICAgY29uc3QgY2hlY2tlZHMgPSB0aGlzLmZpZWxkVHJlZS5jaGVja2VkcztcclxuICAgIGlmIChjaGVja2VkcyAmJiBjaGVja2Vkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgYyBvZiBjaGVja2Vkcykge1xyXG4gICAgICAgIHRoaXMuZmllbGRDb25maWdDaGFuZ2UodHJ1ZSwgb3BlcmF0aW9uLCBjLmRhdGEuaWQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmaWVsZEJhdGNoUmVzZXQoKSB7XHJcbiAgICBjb25zdCBjaGVja2VkcyA9IHRoaXMuZmllbGRUcmVlLmNoZWNrZWRzO1xyXG4gICAgaWYgKGNoZWNrZWRzICYmIGNoZWNrZWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBjIG9mIGNoZWNrZWRzKSB7XHJcbiAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLmZvcm1hdEZpZWxkTGlzdC5maW5kKGYgPT4gZi5pZCA9PT0gYy5kYXRhLmlkKTtcclxuICAgICAgICB0aGlzLnJlc2V0RmllbGRDb25maWcodGhpcy5maWVsZENvbmZpZ3MsIGMuZGF0YS5pZCwgZmllbGQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJlc2V0RmllbGRDb25maWcoZmllbGRDb25maWdzOiBBcnJheTxhbnk+LCBpZDogc3RyaW5nLCBmaWVsZDogRm9ybUZpZWxkKSB7XHJcbiAgICBpZiAoZmllbGRDb25maWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBmIG9mIGZpZWxkQ29uZmlncykge1xyXG4gICAgICAgIGlmIChmLmxlYWYgPT09IHRydWUgJiYgZi5kYXRhLmlkID09PSBpZCkge1xyXG4gICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmllbGQuZmllbGRTdGF0ZSA9PT0gJ0VkaXRhYmxlJyA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgIGYuZGF0YS5yZWFkb25seSA9IGZpZWxkLmZpZWxkU3RhdGUgPT09ICdSZWFkb25seScgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICBmLmRhdGEuaGlkZGVuID0gZmllbGQuZmllbGRTdGF0ZSA9PT0gJ0hpZGRlbicgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICBmLmRhdGEucmVxdWlyZWQgPSBmaWVsZC5maWVsZFN0YXRlID09PSAnUmVxdWlyZWQnID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZi5jaGlsZHJlbiAmJiBmLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldEZpZWxkQ29uZmlnKGYuY2hpbGRyZW4sIGlkLCBmaWVsZCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRvcigpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLm9wZXJhdGlvbkNvbmZpZy52YWxpZGF0b3IoKTtcclxuICB9XHJcblxyXG5cclxuICBwcml2YXRlIHNldEJ0bkFuZEZpZWxkQ29uZmlncygpIHtcclxuICAgIHRoaXMuY29uZmlnLmZvcm1CdXR0b25Db25maWdzID0gbmV3IEFycmF5PEZvcm1CdXR0b25Db25maWc+KCk7XHJcbiAgICBmb3IgKGNvbnN0IGJ0biBvZiB0aGlzLmJ1dHRvbkNvbmZpZ3MpIHtcclxuICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy5mb3JtRm9ybWF0LmZvcm1CdXR0b25zLmZpbmQoYiA9PiBiLmJ1dHRvbklkID09PSBidG4uYnV0dG9uSWQpO1xyXG4gICAgICBjb25zdCBidG5Db25maWcgPSBuZXcgRm9ybUJ1dHRvbkNvbmZpZygpO1xyXG4gICAgICBidG5Db25maWcuYnV0dG9uSWQgPSBidG4uYnV0dG9uSWQ7XHJcbiAgICAgIGlmIChidG4uZW5hYmxlKSB7XHJcbiAgICAgICAgYnRuQ29uZmlnLmJ1dHRvblN0YXRlID0gJ0VuYWJsZSc7XHJcbiAgICAgIH0gZWxzZSBpZiAoYnRuLmRpc2FibGVkKSB7XHJcbiAgICAgICAgYnRuQ29uZmlnLmJ1dHRvblN0YXRlID0gJ0Rpc2FibGVkJztcclxuICAgICAgfSBlbHNlIGlmIChidG4uaGlkZGVuKSB7XHJcbiAgICAgICAgYnRuQ29uZmlnLmJ1dHRvblN0YXRlID0gJ0hpZGRlbic7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFidXR0b24uYnV0dG9uU3RhdGUgJiYgYnRuQ29uZmlnLmJ1dHRvblN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcuZm9ybUJ1dHRvbkNvbmZpZ3MucHVzaChidG5Db25maWcpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChidXR0b24uYnV0dG9uU3RhdGUgJiYgYnV0dG9uLmJ1dHRvblN0YXRlICE9PSBidG5Db25maWcuYnV0dG9uU3RhdGUpIHtcclxuICAgICAgICB0aGlzLmNvbmZpZy5mb3JtQnV0dG9uQ29uZmlncy5wdXNoKGJ0bkNvbmZpZyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuY29uZmlnLmZvcm1GaWVsZENvbmZpZ3MgPSBuZXcgQXJyYXk8Rm9ybUZpZWxkQ29uZmlnPigpO1xyXG4gICAgdGhpcy5nZXRGaWVsZENvbmZpZ3ModGhpcy5maWVsZENvbmZpZ3MpO1xyXG5cclxuICAgIHRoaXMuY29uZmlnLmZvcm1NZXRob2RDb25maWdzID0gdGhpcy5vcGVyYXRpb25Db25maWcub3BlcmF0aW9ucyB8fCBuZXcgQXJyYXkoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0RmllbGRDb25maWdzKGZpZWxkQ29uZmlnczogQXJyYXk8YW55Pikge1xyXG4gICAgaWYgKGZpZWxkQ29uZmlncyAmJiBmaWVsZENvbmZpZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGYgb2YgZmllbGRDb25maWdzKSB7XHJcbiAgICAgICAgaWYgKGYuY2hpbGRyZW4gJiYgZi5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICB0aGlzLmdldEZpZWxkQ29uZmlncyhmLmNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGYubGVhZiA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBmaWVsZCA9IHRoaXMuZm9ybWF0RmllbGRMaXN0LmZpbmQoZmQgPT4gZmQuZmllbGRJZCA9PT0gZi5kYXRhLmZpZWxkSWQpO1xyXG4gICAgICAgIGNvbnN0IGZpZWxkQ29uZmlnID0gbmV3IEZvcm1GaWVsZENvbmZpZygpO1xyXG4gICAgICAgIGZpZWxkQ29uZmlnLmZpZWxkSWQgPSBmLmRhdGEuZmllbGRJZDtcclxuICAgICAgICBpZiAoZi5kYXRhLmVkaXRhYmxlKSB7XHJcbiAgICAgICAgICBmaWVsZENvbmZpZy5maWVsZFN0YXRlID0gJ0VkaXRhYmxlJztcclxuICAgICAgICB9IGVsc2UgaWYgKGYuZGF0YS5yZWFkb25seSkge1xyXG4gICAgICAgICAgZmllbGRDb25maWcuZmllbGRTdGF0ZSA9ICdSZWFkb25seSc7XHJcbiAgICAgICAgfSBlbHNlIGlmIChmLmRhdGEuaGlkZGVuKSB7XHJcbiAgICAgICAgICBmaWVsZENvbmZpZy5maWVsZFN0YXRlID0gJ0hpZGRlbic7XHJcbiAgICAgICAgfSBlbHNlIGlmIChmLmRhdGEucmVxdWlyZWQpIHtcclxuICAgICAgICAgIGZpZWxkQ29uZmlnLmZpZWxkU3RhdGUgPSAnUmVxdWlyZWQnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZmllbGQuZmllbGRTdGF0ZSAmJiBmaWVsZENvbmZpZy5maWVsZFN0YXRlKSB7XHJcbiAgICAgICAgICB0aGlzLmNvbmZpZy5mb3JtRmllbGRDb25maWdzLnB1c2goZmllbGRDb25maWcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZpZWxkLmZpZWxkU3RhdGUgJiYgZmllbGQuZmllbGRTdGF0ZSAhPT0gZmllbGRDb25maWcuZmllbGRTdGF0ZSkge1xyXG4gICAgICAgICAgdGhpcy5jb25maWcuZm9ybUZpZWxkQ29uZmlncy5wdXNoKGZpZWxkQ29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Q29uZmlnKCkge1xyXG4gICAgaWYgKHRoaXMuZm9ybUZvcm1hdElkKSB7XHJcbiAgICAgIGZvcmtKb2luKHRoaXMuZ2V0Rm9ybUZvcm1hdCgpLCB0aGlzLmdldEZvcm1Gb3JtYXRDb25maWcoKSkuc3Vic2NyaWJlKChyZTogYW55W10pID0+IHtcclxuICAgICAgICBjb25zdCBmb3JtRm9ybWF0ID0gcmVbMF0gYXMgRm9ybUZvcm1hdDtcclxuICAgICAgICBpZiAoZm9ybUZvcm1hdCkge1xyXG4gICAgICAgICAgdGhpcy5mb3JtRm9ybWF0ID0gdGhpcy5jb252ZXJ0Rm9ybUZvcm1hdChmb3JtRm9ybWF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29uZmlnID0gcmVbMV0gYXMgRm9ybUZvcm1hdENvbmZpZztcclxuICAgICAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybUZvcm1hdC5mb3JtQnV0dG9ucykge1xyXG4gICAgICAgICAgdGhpcy5idXR0b25Db25maWdzID0gdGhpcy5mb3JtRm9ybWF0LmZvcm1CdXR0b25zLm1hcChiID0+IE9iamVjdC5hc3NpZ24oe30sIGIsIHtcclxuICAgICAgICAgICAgZW5hYmxlOiBiLmJ1dHRvblN0YXRlID09PSAnRW5hYmxlJyA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgZGlzYWJsZWQ6IGIuYnV0dG9uU3RhdGUgPT09ICdEaXNhYmxlZCcgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICAgIGhpZGRlbjogYi5idXR0b25TdGF0ZSA9PT0gJ0hpZGRlbicgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICAgIH0pKTtcclxuICAgICAgICAgIGxldCBidG5Db25maWdzID0gbmV3IEFycmF5PEZvcm1CdXR0b25Db25maWc+KCk7XHJcbiAgICAgICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5mb3JtQnV0dG9uQ29uZmlncykge1xyXG4gICAgICAgICAgICBidG5Db25maWdzID0gY29uZmlnLmZvcm1CdXR0b25Db25maWdzO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZm9yIChjb25zdCBiIG9mIGJ0bkNvbmZpZ3MpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBidG4gb2YgdGhpcy5idXR0b25Db25maWdzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGJ0bi5idXR0b25JZCA9PT0gYi5idXR0b25JZCkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChiLmJ1dHRvblN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgJ0VuYWJsZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBjYXNlICdEaXNhYmxlZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmVuYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICBjYXNlICdIaWRkZW4nOlxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5lbmFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBidG4uaGlkZGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5mb3JtRm9ybWF0LmZvcm1GaWVsZHMpIHtcclxuICAgICAgICAgIHRoaXMuZmllbGRDb25maWdzID0gWy4uLnRoaXMuZm9ybUZvcm1hdC5mb3JtRmllbGRzXTtcclxuICAgICAgICAgIHRoaXMub3JnRmllbGRDb25maWdzKHRoaXMuZmllbGRDb25maWdzKTtcclxuICAgICAgICAgIGxldCBjb25maWdzID0gbmV3IEFycmF5PEZvcm1GaWVsZENvbmZpZz4oKTtcclxuICAgICAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmZvcm1GaWVsZENvbmZpZ3MpIHtcclxuICAgICAgICAgICAgY29uZmlncyA9IGNvbmZpZy5mb3JtRmllbGRDb25maWdzO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZm9yIChjb25zdCBmIG9mIGNvbmZpZ3MpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRGaWVsZENvbmZpZyh0aGlzLmZpZWxkQ29uZmlncywgZik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3JnRmllbGRDb25maWdzKGZvcm1GaWVsZHM6IEFycmF5PEZvcm1GaWVsZERhdGE+KSB7XHJcbiAgICBpZiAoZm9ybUZpZWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZCBvZiBmb3JtRmllbGRzKSB7XHJcbiAgICAgICAgZC5kYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZC5kYXRhLCB7XHJcbiAgICAgICAgICBlZGl0YWJsZTogZC5kYXRhLmZpZWxkU3RhdGUgPT09ICdFZGl0YWJsZScgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICByZWFkb25seTogZC5kYXRhLmZpZWxkU3RhdGUgPT09ICdSZWFkb25seScgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICBoaWRkZW46IGQuZGF0YS5maWVsZFN0YXRlID09PSAnSGlkZGVuJyA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgIHJlcXVpcmVkOiBkLmRhdGEuZmllbGRTdGF0ZSA9PT0gJ1JlcXVpcmVkJyA/IHRydWUgOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChkLmNoaWxkcmVuICYmIGQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgIHRoaXMub3JnRmllbGRDb25maWdzKGQuY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXRGaWVsZENvbmZpZyhmaWVsZENvbmZpZ3M6IEFycmF5PGFueT4sIGNvbmZpZzogRm9ybUZpZWxkQ29uZmlnKSB7XHJcbiAgICBpZiAoZmllbGRDb25maWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBmIG9mIGZpZWxkQ29uZmlncykge1xyXG4gICAgICAgIGlmIChmLmRhdGEuZmllbGRJZCA9PT0gY29uZmlnLmZpZWxkSWQpIHtcclxuICAgICAgICAgIHN3aXRjaCAoY29uZmlnLmZpZWxkU3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSAnRWRpdGFibGUnOlxyXG4gICAgICAgICAgICAgIGYuZGF0YS5lZGl0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGYuZGF0YS5yZXF1aXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdSZWFkb25seSc6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBmLmRhdGEuaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ0hpZGRlbic6XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmVkaXRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLmhpZGRlbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ1JlcXVpcmVkJzpcclxuICAgICAgICAgICAgICBmLmRhdGEuZWRpdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEucmVhZG9ubHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBmLmRhdGEuaGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgZi5kYXRhLnJlcXVpcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGYuY2hpbGRyZW4gJiYgZi5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RmllbGRDb25maWcoZi5jaGlsZHJlbiwgY29uZmlnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2F2ZUNvbmZpZyhjb25maWc6IEZvcm1Gb3JtYXRDb25maWcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gJy9hcGkvcnVudGltZS93Zi92MS4wL2Zvcm1Gb3JtYXRDb25maWcnO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHVybCwgY29uZmlnKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Rm9ybUZvcm1hdCgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKHRoaXMuZm9ybUZvcm1hdElkKSB7XHJcbiAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvZm9ybUZvcm1hdC8ke3RoaXMuZm9ybUZvcm1hdElkfWA7XHJcbiAgICAgIHVybCA9IGVuY29kZVVSSSh1cmwpO1xyXG4gICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIG9mKG51bGwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRGb3JtRm9ybWF0Q29uZmlnKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAodGhpcy5mb3JtYXRDb25maWdJZCkge1xyXG4gICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL2Zvcm1Gb3JtYXRDb25maWcvJHt0aGlzLmZvcm1hdENvbmZpZ0lkfWA7XHJcbiAgICAgIHVybCA9IGVuY29kZVVSSSh1cmwpO1xyXG4gICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIG9mKG51bGwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjb252ZXJ0Rm9ybUZvcm1hdChmb3JtRm9ybWF0OiBGb3JtRm9ybWF0KTogRm9ybUZvcm1hdCB7XHJcbiAgICBpZiAoIWZvcm1Gb3JtYXQuc3RhdHVzKSB7XHJcbiAgICAgIGZvcm1Gb3JtYXQuc3RhdHVzID0gMDtcclxuICAgIH1cclxuICAgIHRoaXMuY29udmVydGZvcm1GaWVsZHMoZm9ybUZvcm1hdC5mb3JtRmllbGRzKTtcclxuICAgIHRoaXMuZ2V0Rm9ybWF0RmllbGRMaXN0KGZvcm1Gb3JtYXQuZm9ybUZpZWxkcywgdGhpcy5mb3JtYXRGaWVsZExpc3QpO1xyXG4gICAgcmV0dXJuIGZvcm1Gb3JtYXQ7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbnZlcnRmb3JtRmllbGRzKGZvcm1GaWVsZHM6IEFycmF5PEZvcm1GaWVsZERhdGE+KSB7XHJcbiAgICBpZiAoZm9ybUZpZWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgZCBvZiBmb3JtRmllbGRzKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZihkLmxlYWYpICE9PSAnYm9vbGVhbicgJiYgKGQubGVhZiA9PSBudWxsIHx8IGQubGVhZiA9PT0gdW5kZWZpbmVkKSkge1xyXG4gICAgICAgICAgZC5sZWFmID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGQuY2hpbGRyZW4gJiYgZC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgdGhpcy5vcmdGaWVsZENvbmZpZ3MoZC5jaGlsZHJlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEZvcm1hdEZpZWxkTGlzdChmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGREYXRhPiwgYXJyYXk6IEFycmF5PEZvcm1GaWVsZD4pIHtcclxuICAgIGlmIChmb3JtRmllbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBkIG9mIGZvcm1GaWVsZHMpIHtcclxuICAgICAgICBhcnJheS5wdXNoKGQuZGF0YSk7XHJcbiAgICAgICAgaWYgKGQuY2hpbGRyZW4gJiYgZC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgdGhpcy5nZXRGb3JtYXRGaWVsZExpc3QoZC5jaGlsZHJlbiwgYXJyYXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRGb3JtYXRGaWVsZChmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGREYXRhPiwgZmllbGRJZDogc3RyaW5nKTogRm9ybUZpZWxkRGF0YSB7XHJcbiAgICBmb3IgKGNvbnN0IGYgb2YgZm9ybUZpZWxkcykge1xyXG4gICAgICBpZiAoZi5kYXRhLmZpZWxkSWQgPT09IGZpZWxkSWQpIHtcclxuICAgICAgICByZXR1cm4gZjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZi5jaGlsZHJlbiAmJiBmLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRGb3JtYXRGaWVsZChmLmNoaWxkcmVuLCBmaWVsZElkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcbiJdfQ==