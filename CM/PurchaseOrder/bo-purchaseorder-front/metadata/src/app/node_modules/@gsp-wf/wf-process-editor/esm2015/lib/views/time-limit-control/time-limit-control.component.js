/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, Injector, ComponentFactoryResolver } from '@angular/core';
import { BsModalService } from '@farris/ui-modal';
import { SendMessageOperationComponent } from './send-message-operation/send-message-operation.component';
import { AutoHandleOperationComponent } from "./auto-handle-operation/auto-handle-operation.component";
import { TimeLimitInfo, ExpireOperation } from './time-limit-control.entity';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { DatagridComponent } from '@farris/ui-datagrid';
import { MessagerService } from '@farris/ui-messager';
export class TimeLimitControlComponent {
    /**
     * @param {?} resolver
     * @param {?} injector
     * @param {?} modalService
     * @param {?} message
     */
    constructor(resolver, injector, modalService, message) {
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: '超时操作',
            width: 580,
            height: 460,
            showButtons: true
        };
        this.timeLimitInfo = new TimeLimitInfo();
        this.tagCollection = [
            { value: 'constant', text: '固定值' },
            { value: 'scope', text: '时间范围' }
        ];
        this.timeUnitCollection = [
            { value: 'day', text: '天' },
            { value: 'hour', text: '时' },
            { value: 'minute', text: '分' }
        ];
        this.durationTypeCollection = [
            { value: 'BeforeDuration', text: '到期之前' },
            { value: 'OnDuration', text: '到期时' },
            { value: 'AfterDuration', text: '到期之后' }
        ];
        this.activityOperationTypeName = [
            { value: 'SendMessageExpireOperation', text: '超时预警' },
            { value: 'AutoHandleExpireOperation', text: '自动办理' }
        ];
        this.processOperationTypeName = [
            { value: 'SendMessageExpireOperation', text: '超时预警' }
        ];
        this.operationTypeName = [];
        this.timeScopeCollection = [
            { value: 'curDay', name: '当天' }
        ];
        this.timeScopeValue = this.timeScopeCollection[0].value;
        this.cols = [];
        this.location = 'activity';
        this.parser = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => {
            // console.log(val);
            return Number(val);
        });
        this.durationTypeChange = (/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (data && data.value && data.value.value === this.durationTypeCollection[1].value) {
                /** @type {?} */
                const operation = this.timeLimitInfo.expireOperations.find((/**
                 * @param {?} e
                 * @return {?}
                 */
                e => e.id === data.rowData.id));
                operation.timeDuration = 0;
            }
        });
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set value(v) {
        if (v) {
            this.timeLimitInfo = v;
        }
        else {
            this.timeLimitInfo = new TimeLimitInfo();
        }
        // 兼容历史数据中的操作类型
        for (const operation of this.timeLimitInfo.expireOperations) {
            if (operation.operationTypeName === undefined) {
                operation.operationTypeName = 'SendMessageExpireOperation';
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.location = this.editorParams.location;
        if (this.location === 'activity') {
            this.operationTypeName = this.activityOperationTypeName;
        }
        else {
            this.operationTypeName = this.processOperationTypeName;
        }
        this.cols = [
            {
                field: 'durationType', width: 80, title: '期限类型',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.durationTypeCollection }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: {
                        valueField: 'value', textField: 'text', data: this.durationTypeCollection, idField: 'value', panelHeight: 'auto',
                        valueChange: this.durationTypeChange, showClear: false
                    }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'timeDuration', width: 60, title: '时长',
                editor: {
                    type: EditorTypes.NUMBERBOX, options: { min: 0 },
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'timeUnit', width: 60, title: '单位',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.timeUnitCollection }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.timeUnitCollection, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'operationTypeName', width: 100, title: '操作类型名称',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.operationTypeName }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.operationTypeName, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'sendType', width: 80, title: '操作', template: this.cell,
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }
        ];
    }
    // beforeEdit = (param: RowEditParam) => {
    //   const rowData = param.rowData as any;
    //   if(rowData.durationType === 'OnDuration'){
    //     if(param.column.field === 'timeUnit'){
    //       rowData.timeUnit = 'day'
    //       param.column.editor = {};
    //     } else if(param.column.field === 'timeDuration'){
    //       rowData.timeDuration = 0;
    //       param.column.editor = {};
    //     } else {
    //       const fieldValue = this.cols.find(col => col.field === param.column.field);
    //       param.column.editor = fieldValue.editor;
    //     }
    //   }
    //   return of(true);
    // }
    /**
     * @return {?}
     */
    clickOK() {
        this.grid.endCellEdit();
        this.timeLimitInfo.dueTime += '';
        if (this.validator()) {
            /** @type {?} */
            const object = { value: this.timeLimitInfo, parameters: null };
            this.submitModal.emit(object);
        }
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @private
     * @return {?}
     */
    validator() {
        if (this.timeLimitInfo.expireOperations
            && this.timeLimitInfo.expireOperations.length > 0) {
            for (const e of this.timeLimitInfo.expireOperations) {
                if (e.operationTypeName === 'SendMessageExpireOperation') {
                    /** @type {?} */
                    const a = (/** @type {?} */ (e));
                    if (!a.sendType) {
                        this.message.info('请设置超时操作！');
                        return false;
                    }
                }
                if (e.operationTypeName === 'AutoHandleExpireOperation') {
                    /** @type {?} */
                    const a = (/** @type {?} */ (e));
                    if (!a.autoHandleType) {
                        this.message.info('请设置自动办理类型！');
                        return false;
                    }
                    if (!a.message) {
                        this.message.info('请设置自动办理意见！');
                        return false;
                    }
                }
            }
        }
        return true;
    }
    /**
     * @return {?}
     */
    add() {
        /** @type {?} */
        let operation = new ExpireOperation();
        this.timeLimitInfo.expireOperations.push(operation);
        this.grid.loadData(this.timeLimitInfo.expireOperations);
        this.grid.selectRow(operation.id);
    }
    /**
     * @return {?}
     */
    remove() {
        this.grid.endCellEdit();
        /** @type {?} */
        const curItem = this.grid.selectedRow;
        if (!curItem) {
            this.message.info('尚未选中预警操作！');
            return;
        }
        /** @type {?} */
        const i = this.timeLimitInfo.expireOperations.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        a => a.id === curItem.data.id));
        if (i > -1) {
            this.timeLimitInfo.expireOperations.splice(i, 1);
            this.grid.loadData(this.timeLimitInfo.expireOperations);
        }
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    editOperation(ctx) {
        this.grid.endCellEdit();
        if (ctx.rowData.operationTypeName === 'SendMessageExpireOperation') {
            this.sendMassageOperation(ctx);
        }
        if (ctx.rowData.operationTypeName === 'AutoHandleExpireOperation') {
            this.message.confirm("下一节点是由当前办理人指派的话，当前节点不支持任务自动办理").subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => re === true ? this.autoHandleOperation(ctx) : null));
        }
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    sendMassageOperation(ctx) {
        /** @type {?} */
        let dialog;
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(SendMessageOperationComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        compRef.instance.location = this.location;
        compRef.instance.value = Object.assign({}, ctx.rowData);
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            /** @type {?} */
            let operation = this.timeLimitInfo.expireOperations.find((/**
             * @param {?} o
             * @return {?}
             */
            o => o.id === re.id));
            operation = Object.assign(operation, re);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            dialog.close();
        }));
        /** @type {?} */
        const modalConfig = {
            title: '预警消息',
            width: 500,
            height: this.location === 'activity' ? 390 : 460,
            buttons: compRef.instance.footer,
            showButtons: true
        };
        dialog = this.modalService.show(compRef, modalConfig);
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    autoHandleOperation(ctx) {
        /** @type {?} */
        let dialog;
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(AutoHandleOperationComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        compRef.instance.value = Object.assign({}, ctx.rowData);
        compRef.instance.submitEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            /** @type {?} */
            let operation = this.timeLimitInfo.expireOperations.find((/**
             * @param {?} o
             * @return {?}
             */
            o => o.id === re.id));
            operation = Object.assign(operation, re);
            dialog.close();
        }));
        compRef.instance.closeEmitter.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            dialog.close();
        }));
        /** @type {?} */
        const modalConfig = {
            title: '自动办理',
            width: 500,
            height: this.location === 'activity' ? 390 : 460,
            buttons: compRef.instance.footer,
            showButtons: true
        };
        dialog = this.modalService.show(compRef, modalConfig);
    }
    /**
     * @param {?} data
     * @return {?}
     */
    tagSelectChange(data) {
        if (data.data.value === 'constant') {
            this.timeLimitInfo.timeUnit = "day";
        }
        else if (data.data.value === 'scope') {
            this.timeLimitInfo.timeUnit = '';
            this.timeLimitInfo.dueTime = this.timeScopeValue;
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    changeTimeScope(data) {
        this.timeScopeValue = data;
        this.timeLimitInfo.dueTime = this.timeScopeValue;
    }
}
TimeLimitControlComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-time-limit-control',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">\u4EFB\u52A1\u5904\u7406\u65F6\u6548\u63A7\u5236</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <div class=\"farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"col-form-label pl-1 mr-3\">\r\n                    <span class=\"farris-label-text\">\u662F\u5426\u542F\u7528</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap mr-5\">\r\n                    <farris-switch [(ngModel)]=\"timeLimitInfo.enable\" name=\"enable\"></farris-switch>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\" style=\"width: 100%;\">\r\n                  <label class=\"col-form-label pl-1 mr-3\">\r\n                    <span class=\"farris-label-text\">\u4EFB\u52A1\u671F\u9650</span>\r\n                  </label>\r\n                  <div class=\"farris-input-wrap mr-1\" style=\"width: 35%;\"><!--name=\"tag\"-->\r\n                    <farris-combo-list [(ngModel)]=\"timeLimitInfo.tag\" [idField]=\"'value'\" [textField]=\"'text'\" name=\"tag\"\r\n                                       [valueField]=\"'value'\" [data]=\"tagCollection\" [panelHeight]=\"'auto'\"\r\n                                       [editable]=\"false\" [enableClear]=\"false\" (selectChange)=\"tagSelectChange($event)\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'constant'\" class=\"farris-input-wrap mr-1\" style=\"width: 35%;\">\r\n                    <farris-number-spinner [(ngModel)]=\"timeLimitInfo.dueTime\" name=\"dueTime\"\r\n                      [editable]=\"true\" [precision]=\"0\" [parser]=\"parser\"\r\n                      [min]=\"0\"></farris-number-spinner>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'constant'\" class=\"farris-input-wrap mr-5\" style=\"width: 30%;\">\r\n                    <farris-combo-list [(ngModel)]=\"timeLimitInfo.timeUnit\" name=\"timeUnit\" [idField]=\"'value'\" [textField]=\"'text'\"\r\n                    [valueField]=\"'value'\" [data]=\"timeUnitCollection\" [panelHeight]=\"'auto'\"\r\n                    [editable]=\"false\" [enableClear]=\"false\">\r\n                    </farris-combo-list>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                  <div *ngIf=\"timeLimitInfo.tag === 'scope'\" class=\"farris-input-wrap mr-1\" style=\"width: 65%;\">\r\n                    <farris-radiogroup [(ngModel)]=\"timeLimitInfo.dueTime\" name=\"scope\"\r\n                                       [data]=\"timeScopeCollection\"\r\n                                       (changeValue)=\"changeTimeScope($event)\">\r\n                    </farris-radiogroup>\r\n                    <div class=\"farris-feedback valid-feedback\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"mx-2 mt-3\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u65F6\u6548\u9884\u8B66\u64CD\u4F5C</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mx-2 h-100\">\r\n              <farris-tabs class=\"f-utils-fill h-100\" [value]=\"'operation'\" [contentFill]=\"true\" [autoTitleWidth]=\"true\">\r\n                <farris-tab [title]=\"'\u64CD\u4F5C\u5217\u8868'\" [id]=\"'operation'\">\r\n                  <ng-template farrisTabsExtend>\r\n                    <div class=\"mx-2\">\r\n                      <button type=\"button\" (click)=\"add()\"\r\n                        class=\"btn btn-primary mr-2\">\u65B0\u589E</button>\r\n                      <button type=\"button\" (click)=\"remove()\"\r\n                        class=\"btn btn-secondary\">\u5220\u9664</button>\r\n                    </div>\r\n                  </ng-template>\r\n                  <ng-template #content>\r\n                    <div class=\"f-utils-fill-flex-column h-100\" style=\"background: #FFF;\">\r\n                      <farris-datagrid #grid [data]=\"timeLimitInfo.expireOperations\" [idField]=\"'id'\" [columns]=\"cols\"\r\n                        [fit]=\"true\" [editMode]=\"'cell'\" [editable]=\"true\"\r\n                        [fitColumns]=\"true\" [pagination]=\"false\" [showCheckbox]=\"false\" [multiSelect]=\"false\"><!--[beforeEdit]=\"beforeEdit\" [afterEdit]=\"afterEdit\"-->\r\n                      </farris-datagrid>\r\n                    </div>\r\n                  </ng-template>\r\n                </farris-tab>\r\n              </farris-tabs>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<ng-template #cell let-ctx>\r\n  <span (click)=\"editOperation(ctx)\" *ngIf=\"ctx.rowData.operationTypeName === 'SendMessageExpireOperation'\" class=\"link\">\r\n    {{ ctx.rowData.sendType?'\uFF08\u5DF2\u8BBE\u7F6E\uFF09': '\uFF08\u672A\u8BBE\u7F6E\uFF09' }}\r\n  </span>\r\n  <span (click)=\"editOperation(ctx)\" *ngIf=\"ctx.rowData.operationTypeName === 'AutoHandleExpireOperation'\" class=\"link\">\r\n    {{ (ctx.rowData.autoHandleType && ctx.rowData.message)?'\uFF08\u5DF2\u8BBE\u7F6E\uFF09': '\uFF08\u672A\u8BBE\u7F6E\uFF09' }}\r\n  </span>\r\n</ng-template>\r\n",
                styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}.link{color:#1206bb;font-size:14px}.link:hover{color:#5d478b;font-size:14px}"]
            }] }
];
/** @nocollapse */
TimeLimitControlComponent.ctorParameters = () => [
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: BsModalService },
    { type: MessagerService }
];
TimeLimitControlComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    editorParams: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    cell: [{ type: ViewChild, args: ['cell',] }],
    grid: [{ type: ViewChild, args: ['grid',] }]
};
if (false) {
    /** @type {?} */
    TimeLimitControlComponent.prototype.cls;
    /** @type {?} */
    TimeLimitControlComponent.prototype.closeModal;
    /** @type {?} */
    TimeLimitControlComponent.prototype.submitModal;
    /** @type {?} */
    TimeLimitControlComponent.prototype.editorParams;
    /** @type {?} */
    TimeLimitControlComponent.prototype.modalFooter;
    /** @type {?} */
    TimeLimitControlComponent.prototype.cell;
    /** @type {?} */
    TimeLimitControlComponent.prototype.grid;
    /** @type {?} */
    TimeLimitControlComponent.prototype.modalConfig;
    /** @type {?} */
    TimeLimitControlComponent.prototype.timeLimitInfo;
    /** @type {?} */
    TimeLimitControlComponent.prototype.tagCollection;
    /** @type {?} */
    TimeLimitControlComponent.prototype.timeUnitCollection;
    /** @type {?} */
    TimeLimitControlComponent.prototype.durationTypeCollection;
    /** @type {?} */
    TimeLimitControlComponent.prototype.activityOperationTypeName;
    /** @type {?} */
    TimeLimitControlComponent.prototype.processOperationTypeName;
    /** @type {?} */
    TimeLimitControlComponent.prototype.operationTypeName;
    /** @type {?} */
    TimeLimitControlComponent.prototype.timeScopeCollection;
    /** @type {?} */
    TimeLimitControlComponent.prototype.timeScopeValue;
    /** @type {?} */
    TimeLimitControlComponent.prototype.cols;
    /** @type {?} */
    TimeLimitControlComponent.prototype.location;
    /** @type {?} */
    TimeLimitControlComponent.prototype.parser;
    /** @type {?} */
    TimeLimitControlComponent.prototype.durationTypeChange;
    /**
     * @type {?}
     * @private
     */
    TimeLimitControlComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    TimeLimitControlComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    TimeLimitControlComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    TimeLimitControlComponent.prototype.message;
}
export class TimeLimitControlConverter {
    constructor() { }
    /**
     * @param {?} data
     * @return {?}
     */
    convertTo(data) {
        if (data && data.enable) {
            return '（已设置）';
        }
        else {
            return '（未设置）';
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZS1saW1pdC1jb250cm9sLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3MvdGltZS1saW1pdC1jb250cm9sL3RpbWUtbGltaXQtY29udHJvbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLHdCQUF3QixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXhKLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSwyREFBMkQsQ0FBQztBQUMxRyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSx5REFBeUQsQ0FBQztBQUN2RyxPQUFPLEVBQUMsYUFBYSxFQUFFLGVBQWUsRUFBMEIsTUFBTSw2QkFBNkIsQ0FBQztBQUNwRyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBT3RELE1BQU0sT0FBTyx5QkFBeUI7Ozs7Ozs7SUFrRnBDLFlBQ1UsUUFBa0MsRUFDbEMsUUFBa0IsRUFDbEIsWUFBNEIsRUFDNUIsT0FBd0I7UUFIeEIsYUFBUSxHQUFSLFFBQVEsQ0FBMEI7UUFDbEMsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixpQkFBWSxHQUFaLFlBQVksQ0FBZ0I7UUFDNUIsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7UUFwRmxDLFFBQUcsR0FBRyw4QkFBOEIsQ0FBQztRQUUzQixlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztR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Q0FDcUM7O0lBRXJDLCtDQUErQzs7SUFDL0MsZ0RBQWdEOztJQWdCaEQsaURBQWdDOztJQUNoQyxnREFBNkQ7O0lBQzdELHlDQUEwQzs7SUFDMUMseUNBQTJDOztJQUUzQyxnREFLRTs7SUFFRixrREFBbUQ7O0lBRW5ELGtEQUdFOztJQUVGLHVEQUlFOztJQUVGLDJEQUlFOztJQUVGLDhEQUdFOztJQUVGLDZEQUVFOztJQUVGLHNEQUF1Qjs7SUFFdkIsd0RBRUM7O0lBQ0QsbURBQWtEOztJQUNsRCx5Q0FBVTs7SUFFViw2Q0FBOEM7O0lBRTlDLDJDQUdDOztJQUVELHVEQUtDOzs7OztJQUVDLDZDQUEwQzs7Ozs7SUFDMUMsNkNBQTBCOzs7OztJQUMxQixpREFBb0M7Ozs7O0lBQ3BDLDRDQUFnQzs7QUE4TnBDLE1BQU0sT0FBTyx5QkFBeUI7SUFDcEMsZ0JBQWdCLENBQUM7Ozs7O0lBRWpCLFNBQVMsQ0FBQyxJQUFTO1FBQ2pCLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDdkIsT0FBTyxPQUFPLENBQUM7U0FDaEI7YUFBTTtZQUNMLE9BQU8sT0FBTyxDQUFDO1NBQ2hCO0lBQ0gsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIEluamVjdG9yLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZUNvbnZlcnRlciB9IGZyb20gJ0BmYXJyaXMvdWktcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBTZW5kTWVzc2FnZU9wZXJhdGlvbkNvbXBvbmVudCB9IGZyb20gJy4vc2VuZC1tZXNzYWdlLW9wZXJhdGlvbi9zZW5kLW1lc3NhZ2Utb3BlcmF0aW9uLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEF1dG9IYW5kbGVPcGVyYXRpb25Db21wb25lbnQgfSBmcm9tIFwiLi9hdXRvLWhhbmRsZS1vcGVyYXRpb24vYXV0by1oYW5kbGUtb3BlcmF0aW9uLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQge1RpbWVMaW1pdEluZm8sIEV4cGlyZU9wZXJhdGlvbiwgU2VuZE1lc3NhZ2UsIEF1dG9IYW5kbGV9IGZyb20gJy4vdGltZS1saW1pdC1jb250cm9sLmVudGl0eSc7XHJcbmltcG9ydCB7IEVkaXRvclR5cGVzIH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZC1lZGl0b3JzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi10aW1lLWxpbWl0LWNvbnRyb2wnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi90aW1lLWxpbWl0LWNvbnRyb2wuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3RpbWUtbGltaXQtY29udHJvbC5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUaW1lTGltaXRDb250cm9sQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJylcclxuICBjbHMgPSAnZmFycmlzLW1haW4tYXJlYSBmbGV4LWNvbHVtbic7XHJcblxyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG5cclxuICBASW5wdXQoKSBzZXQgdmFsdWUodjogVGltZUxpbWl0SW5mbykge1xyXG4gICAgaWYgKHYpIHtcclxuICAgICAgdGhpcy50aW1lTGltaXRJbmZvID0gdjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudGltZUxpbWl0SW5mbyA9IG5ldyBUaW1lTGltaXRJbmZvKCk7XHJcbiAgICB9XHJcbiAgICAvLyDlhbzlrrnljoblj7LmlbDmja7kuK3nmoTmk43kvZznsbvlnotcclxuICAgIGZvciAoY29uc3Qgb3BlcmF0aW9uIG9mIHRoaXMudGltZUxpbWl0SW5mby5leHBpcmVPcGVyYXRpb25zKSB7XHJcbiAgICAgIGlmIChvcGVyYXRpb24ub3BlcmF0aW9uVHlwZU5hbWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIG9wZXJhdGlvbi5vcGVyYXRpb25UeXBlTmFtZSA9ICdTZW5kTWVzc2FnZUV4cGlyZU9wZXJhdGlvbic7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgQElucHV0KCkgZWRpdG9yUGFyYW1zOiBhbnkgPSB7fTtcclxuICBAVmlld0NoaWxkKCdpY29uU2VsZWN0Rm9vdGVyJykgbW9kYWxGb290ZXI6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnY2VsbCcpIGNlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZ3JpZCcpIGdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG5cclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn6LaF5pe25pON5L2cJyxcclxuICAgIHdpZHRoOiA1ODAsXHJcbiAgICBoZWlnaHQ6IDQ2MCxcclxuICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgdGltZUxpbWl0SW5mbzogVGltZUxpbWl0SW5mbyA9IG5ldyBUaW1lTGltaXRJbmZvKCk7XHJcblxyXG4gIHRhZ0NvbGxlY3Rpb24gPSBbXHJcbiAgICB7IHZhbHVlOiAnY29uc3RhbnQnLCB0ZXh0OiAn5Zu65a6a5YC8JyB9LFxyXG4gICAgeyB2YWx1ZTogJ3Njb3BlJywgdGV4dDogJ+aXtumXtOiMg+WbtCcgfVxyXG4gIF07XHJcblxyXG4gIHRpbWVVbml0Q29sbGVjdGlvbiA9IFtcclxuICAgIHsgdmFsdWU6ICdkYXknLCB0ZXh0OiAn5aSpJyB9LFxyXG4gICAgeyB2YWx1ZTogJ2hvdXInLCB0ZXh0OiAn5pe2JyB9LFxyXG4gICAgeyB2YWx1ZTogJ21pbnV0ZScsIHRleHQ6ICfliIYnIH1cclxuICBdO1xyXG5cclxuICBkdXJhdGlvblR5cGVDb2xsZWN0aW9uID0gW1xyXG4gICAgeyB2YWx1ZTogJ0JlZm9yZUR1cmF0aW9uJywgdGV4dDogJ+WIsOacn+S5i+WJjScgfSxcclxuICAgIHsgdmFsdWU6ICdPbkR1cmF0aW9uJywgdGV4dDogJ+WIsOacn+aXticgfSxcclxuICAgIHsgdmFsdWU6ICdBZnRlckR1cmF0aW9uJywgdGV4dDogJ+WIsOacn+S5i+WQjicgfVxyXG4gIF07XHJcblxyXG4gIGFjdGl2aXR5T3BlcmF0aW9uVHlwZU5hbWUgPSBbXHJcbiAgICB7IHZhbHVlIDogJ1NlbmRNZXNzYWdlRXhwaXJlT3BlcmF0aW9uJywgdGV4dDogJ+i2heaXtumihOitpid9LFxyXG4gICAgeyB2YWx1ZSA6ICdBdXRvSGFuZGxlRXhwaXJlT3BlcmF0aW9uJywgdGV4dCA6ICfoh6rliqjlip7nkIYnIH1cclxuICBdO1xyXG5cclxuICBwcm9jZXNzT3BlcmF0aW9uVHlwZU5hbWUgPSBbXHJcbiAgICB7IHZhbHVlIDogJ1NlbmRNZXNzYWdlRXhwaXJlT3BlcmF0aW9uJywgdGV4dDogJ+i2heaXtumihOitpid9XHJcbiAgXTtcclxuXHJcbiAgb3BlcmF0aW9uVHlwZU5hbWUgPSBbXTtcclxuXHJcbiAgdGltZVNjb3BlQ29sbGVjdGlvbiA9IFtcclxuICAgIHt2YWx1ZTonY3VyRGF5JyxuYW1lOiflvZPlpKknfVxyXG4gIF1cclxuICB0aW1lU2NvcGVWYWx1ZSA9IHRoaXMudGltZVNjb3BlQ29sbGVjdGlvblswXS52YWx1ZVxyXG4gIGNvbHMgPSBbXTtcclxuXHJcbiAgbG9jYXRpb246ICdhY3Rpdml0eScgfCAncHJvY2VzcycgPSAnYWN0aXZpdHknO1xyXG5cclxuICBwYXJzZXIgPSAodmFsOiBzdHJpbmcgfCBudW1iZXIpID0+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKHZhbCk7XHJcbiAgICByZXR1cm4gTnVtYmVyKHZhbCk7XHJcbiAgfVxyXG5cclxuICBkdXJhdGlvblR5cGVDaGFuZ2UgPSAoZGF0YSkgPT4ge1xyXG4gICAgaWYgKGRhdGEgJiYgZGF0YS52YWx1ZSAmJiBkYXRhLnZhbHVlLnZhbHVlID09PSB0aGlzLmR1cmF0aW9uVHlwZUNvbGxlY3Rpb25bMV0udmFsdWUpIHtcclxuICAgICAgY29uc3Qgb3BlcmF0aW9uID0gdGhpcy50aW1lTGltaXRJbmZvLmV4cGlyZU9wZXJhdGlvbnMuZmluZChlID0+IGUuaWQgPT09IGRhdGEucm93RGF0YS5pZCk7XHJcbiAgICAgIG9wZXJhdGlvbi50aW1lRHVyYXRpb24gPSAwO1xyXG4gICAgfVxyXG4gIH1cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBNZXNzYWdlclNlcnZpY2VcclxuICApIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMubG9jYXRpb24gPSB0aGlzLmVkaXRvclBhcmFtcy5sb2NhdGlvbjtcclxuICAgIGlmICh0aGlzLmxvY2F0aW9uID09PSAnYWN0aXZpdHknKSB7XHJcbiAgICAgIHRoaXMub3BlcmF0aW9uVHlwZU5hbWUgPSB0aGlzLmFjdGl2aXR5T3BlcmF0aW9uVHlwZU5hbWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm9wZXJhdGlvblR5cGVOYW1lID0gdGhpcy5wcm9jZXNzT3BlcmF0aW9uVHlwZU5hbWU7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNvbHMgPSBbXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogJ2R1cmF0aW9uVHlwZScsIHdpZHRoOiA4MCwgdGl0bGU6ICfmnJ/pmZDnsbvlnosnLFxyXG4gICAgICAgIGZvcm1hdHRlcjoge1xyXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgICAgb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICd0ZXh0JywgZGF0YTogdGhpcy5kdXJhdGlvblR5cGVDb2xsZWN0aW9uIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgICAgdHlwZTogRWRpdG9yVHlwZXMuQ09NQk9MSVNULFxyXG4gICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICd0ZXh0JywgZGF0YTogdGhpcy5kdXJhdGlvblR5cGVDb2xsZWN0aW9uLCBpZEZpZWxkOiAndmFsdWUnLCBwYW5lbEhlaWdodDogJ2F1dG8nLFxyXG4gICAgICAgICAgICB2YWx1ZUNoYW5nZTogdGhpcy5kdXJhdGlvblR5cGVDaGFuZ2UsIHNob3dDbGVhcjogZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICAgIHsgdHlwZTogJ3JlcXVpcmVkJywgbWVzc2FnZXI6ICflv4XloasnIH1cclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogJ3RpbWVEdXJhdGlvbicsIHdpZHRoOiA2MCwgdGl0bGU6ICfml7bplb8nLFxyXG4gICAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgICAgdHlwZTogRWRpdG9yVHlwZXMuTlVNQkVSQk9YLCBvcHRpb25zOiB7IG1pbjogMH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICB2YWxpZGF0b3JzOiBbXHJcbiAgICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICd0aW1lVW5pdCcsIHdpZHRoOiA2MCwgdGl0bGU6ICfljZXkvY0nLFxyXG4gICAgICAgIGZvcm1hdHRlcjoge1xyXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgICAgb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICd0ZXh0JywgZGF0YTogdGhpcy50aW1lVW5pdENvbGxlY3Rpb24gfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5DT01CT0xJU1QsXHJcbiAgICAgICAgICBvcHRpb25zOiB7IHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ3RleHQnLCBkYXRhOiB0aGlzLnRpbWVVbml0Q29sbGVjdGlvbiwgaWRGaWVsZDogJ3ZhbHVlJywgcGFuZWxIZWlnaHQ6ICdhdXRvJyB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2YWxpZGF0b3JzOiBbXHJcbiAgICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICdvcGVyYXRpb25UeXBlTmFtZScsIHdpZHRoOiAxMDAsIHRpdGxlOiAn5pON5L2c57G75Z6L5ZCN56ewJyxcclxuICAgICAgICBmb3JtYXR0ZXI6IHtcclxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcclxuICAgICAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGRhdGE6IHRoaXMub3BlcmF0aW9uVHlwZU5hbWUgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5DT01CT0xJU1QsXHJcbiAgICAgICAgICBvcHRpb25zOiB7IHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ3RleHQnLCBkYXRhOiB0aGlzLm9wZXJhdGlvblR5cGVOYW1lLCBpZEZpZWxkOiAndmFsdWUnLCBwYW5lbEhlaWdodDogJ2F1dG8nIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICAgIHsgdHlwZTogJ3JlcXVpcmVkJywgbWVzc2FnZXI6ICflv4XloasnIH1cclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogJ3NlbmRUeXBlJywgd2lkdGg6IDgwLCB0aXRsZTogJ+aTjeS9nCcsIHRlbXBsYXRlOiB0aGlzLmNlbGwsXHJcbiAgICAgICAgdmFsaWRhdG9yczogW1xyXG4gICAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnLCBtZXNzYWdlcjogJ+W/heWhqycgfVxyXG4gICAgICAgIF1cclxuICAgICAgfVxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIC8vIGJlZm9yZUVkaXQgPSAocGFyYW06IFJvd0VkaXRQYXJhbSkgPT4ge1xyXG4gIC8vICAgY29uc3Qgcm93RGF0YSA9IHBhcmFtLnJvd0RhdGEgYXMgYW55O1xyXG4gIC8vICAgaWYocm93RGF0YS5kdXJhdGlvblR5cGUgPT09ICdPbkR1cmF0aW9uJyl7XHJcbiAgLy8gICAgIGlmKHBhcmFtLmNvbHVtbi5maWVsZCA9PT0gJ3RpbWVVbml0Jyl7XHJcbiAgLy8gICAgICAgcm93RGF0YS50aW1lVW5pdCA9ICdkYXknXHJcbiAgLy8gICAgICAgcGFyYW0uY29sdW1uLmVkaXRvciA9IHt9O1xyXG4gIC8vICAgICB9IGVsc2UgaWYocGFyYW0uY29sdW1uLmZpZWxkID09PSAndGltZUR1cmF0aW9uJyl7XHJcbiAgLy8gICAgICAgcm93RGF0YS50aW1lRHVyYXRpb24gPSAwO1xyXG4gIC8vICAgICAgIHBhcmFtLmNvbHVtbi5lZGl0b3IgPSB7fTtcclxuICAvLyAgICAgfSBlbHNlIHtcclxuICAvLyAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gdGhpcy5jb2xzLmZpbmQoY29sID0+IGNvbC5maWVsZCA9PT0gcGFyYW0uY29sdW1uLmZpZWxkKTtcclxuICAvLyAgICAgICBwYXJhbS5jb2x1bW4uZWRpdG9yID0gZmllbGRWYWx1ZS5lZGl0b3I7XHJcbiAgLy8gICAgIH1cclxuICAvLyAgIH1cclxuICAvLyAgIHJldHVybiBvZih0cnVlKTtcclxuICAvLyB9XHJcblxyXG4gIGNsaWNrT0soKSB7XHJcbiAgICB0aGlzLmdyaWQuZW5kQ2VsbEVkaXQoKTtcclxuICAgIHRoaXMudGltZUxpbWl0SW5mby5kdWVUaW1lICs9ICcnO1xyXG4gICAgaWYgKHRoaXMudmFsaWRhdG9yKCkpIHtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogdGhpcy50aW1lTGltaXRJbmZvLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB2YWxpZGF0b3IoKTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy50aW1lTGltaXRJbmZvLmV4cGlyZU9wZXJhdGlvbnNcclxuICAgICAgJiYgdGhpcy50aW1lTGltaXRJbmZvLmV4cGlyZU9wZXJhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy50aW1lTGltaXRJbmZvLmV4cGlyZU9wZXJhdGlvbnMpIHtcclxuICAgICAgICBpZiAoZS5vcGVyYXRpb25UeXBlTmFtZSA9PT0gJ1NlbmRNZXNzYWdlRXhwaXJlT3BlcmF0aW9uJykge1xyXG4gICAgICAgICAgY29uc3QgYSA9IDxTZW5kTWVzc2FnZT5lO1xyXG4gICAgICAgICAgaWYgKCFhLnNlbmRUeXBlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfor7forr7nva7otoXml7bmk43kvZzvvIEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZS5vcGVyYXRpb25UeXBlTmFtZSA9PT0gJ0F1dG9IYW5kbGVFeHBpcmVPcGVyYXRpb24nKSB7XHJcbiAgICAgICAgICBjb25zdCBhID0gPEF1dG9IYW5kbGU+ZTtcclxuICAgICAgICAgIGlmICghYS5hdXRvSGFuZGxlVHlwZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbygn6K+36K6+572u6Ieq5Yqo5Yqe55CG57G75Z6L77yBJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghYS5tZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfor7forr7nva7oh6rliqjlip7nkIbmhI/op4HvvIEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBhZGQoKSB7XHJcbiAgICBsZXQgb3BlcmF0aW9uID0gbmV3IEV4cGlyZU9wZXJhdGlvbigpO1xyXG4gICAgdGhpcy50aW1lTGltaXRJbmZvLmV4cGlyZU9wZXJhdGlvbnMucHVzaChvcGVyYXRpb24pO1xyXG4gICAgdGhpcy5ncmlkLmxvYWREYXRhKHRoaXMudGltZUxpbWl0SW5mby5leHBpcmVPcGVyYXRpb25zKTtcclxuICAgIHRoaXMuZ3JpZC5zZWxlY3RSb3cob3BlcmF0aW9uLmlkKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZSgpIHtcclxuICAgIHRoaXMuZ3JpZC5lbmRDZWxsRWRpdCgpO1xyXG4gICAgY29uc3QgY3VySXRlbSA9IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdztcclxuICAgIGlmICghY3VySXRlbSkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbygn5bCa5pyq6YCJ5Lit6aKE6K2m5pON5L2c77yBJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGkgPSB0aGlzLnRpbWVMaW1pdEluZm8uZXhwaXJlT3BlcmF0aW9ucy5maW5kSW5kZXgoYSA9PiBhLmlkID09PSBjdXJJdGVtLmRhdGEuaWQpO1xyXG4gICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICB0aGlzLnRpbWVMaW1pdEluZm8uZXhwaXJlT3BlcmF0aW9ucy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgIHRoaXMuZ3JpZC5sb2FkRGF0YSh0aGlzLnRpbWVMaW1pdEluZm8uZXhwaXJlT3BlcmF0aW9ucyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBlZGl0T3BlcmF0aW9uKGN0eDogYW55KXtcclxuICAgIHRoaXMuZ3JpZC5lbmRDZWxsRWRpdCgpO1xyXG4gICAgaWYgKGN0eC5yb3dEYXRhLm9wZXJhdGlvblR5cGVOYW1lID09PSAnU2VuZE1lc3NhZ2VFeHBpcmVPcGVyYXRpb24nKXtcclxuICAgICAgdGhpcy5zZW5kTWFzc2FnZU9wZXJhdGlvbihjdHgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGN0eC5yb3dEYXRhLm9wZXJhdGlvblR5cGVOYW1lID09PSAnQXV0b0hhbmRsZUV4cGlyZU9wZXJhdGlvbicpe1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuY29uZmlybShcIuS4i+S4gOiKgueCueaYr+eUseW9k+WJjeWKnueQhuS6uuaMh+a0vueahOivne+8jOW9k+WJjeiKgueCueS4jeaUr+aMgeS7u+WKoeiHquWKqOWKnueQhlwiKS5zdWJzY3JpYmUocmUgPT4gcmUgPT09IHRydWUgPyB0aGlzLmF1dG9IYW5kbGVPcGVyYXRpb24oY3R4KSA6IG51bGwpO1xyXG4gICAgfVxyXG4gIH1cclxuICBzZW5kTWFzc2FnZU9wZXJhdGlvbihjdHg6IGFueSkge1xyXG4gICAgbGV0IGRpYWxvZzogYW55O1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KFNlbmRNZXNzYWdlT3BlcmF0aW9uQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLmxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudmFsdWUgPSBPYmplY3QuYXNzaWduKHt9LCBjdHgucm93RGF0YSk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdEVtaXR0ZXIuc3Vic2NyaWJlKChyZTogRXhwaXJlT3BlcmF0aW9uKSA9PiB7XHJcbiAgICAgIGxldCBvcGVyYXRpb24gPSB0aGlzLnRpbWVMaW1pdEluZm8uZXhwaXJlT3BlcmF0aW9ucy5maW5kKG8gPT4gby5pZCA9PT0gcmUuaWQpO1xyXG4gICAgICBvcGVyYXRpb24gPSBPYmplY3QuYXNzaWduKG9wZXJhdGlvbiwgcmUpO1xyXG4gICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZUVtaXR0ZXIuc3Vic2NyaWJlKChyZTogYW55KSA9PiB7XHJcbiAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBtb2RhbENvbmZpZyA9IHtcclxuICAgICAgdGl0bGU6ICfpooTorabmtojmga8nLFxyXG4gICAgICB3aWR0aDogNTAwLFxyXG4gICAgICBoZWlnaHQ6IHRoaXMubG9jYXRpb24gPT09ICdhY3Rpdml0eScgPyAzOTAgOiA0NjAsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gICAgfTtcclxuICAgIGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gIH1cclxuXHJcbiAgYXV0b0hhbmRsZU9wZXJhdGlvbihjdHg6IGFueSkge1xyXG4gICAgbGV0IGRpYWxvZzogYW55O1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEF1dG9IYW5kbGVPcGVyYXRpb25Db21wb25lbnQpO1xyXG4gICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudmFsdWUgPSBPYmplY3QuYXNzaWduKHt9LCBjdHgucm93RGF0YSk7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdEVtaXR0ZXIuc3Vic2NyaWJlKChyZTogRXhwaXJlT3BlcmF0aW9uKSA9PiB7XHJcbiAgICAgIGxldCBvcGVyYXRpb24gPSB0aGlzLnRpbWVMaW1pdEluZm8uZXhwaXJlT3BlcmF0aW9ucy5maW5kKG8gPT4gby5pZCA9PT0gcmUuaWQpO1xyXG4gICAgICBvcGVyYXRpb24gPSBPYmplY3QuYXNzaWduKG9wZXJhdGlvbiwgcmUpO1xyXG4gICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZUVtaXR0ZXIuc3Vic2NyaWJlKChyZTogYW55KSA9PiB7XHJcbiAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBtb2RhbENvbmZpZyA9IHtcclxuICAgICAgdGl0bGU6ICfoh6rliqjlip7nkIYnLFxyXG4gICAgICB3aWR0aDogNTAwLFxyXG4gICAgICBoZWlnaHQ6IHRoaXMubG9jYXRpb24gPT09ICdhY3Rpdml0eScgPyAzOTAgOiA0NjAsXHJcbiAgICAgIGJ1dHRvbnM6IGNvbXBSZWYuaW5zdGFuY2UuZm9vdGVyLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gICAgfTtcclxuICAgIGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gIH1cclxuXHJcbiAgdGFnU2VsZWN0Q2hhbmdlKGRhdGEpe1xyXG4gICAgaWYoZGF0YS5kYXRhLnZhbHVlID09PSAnY29uc3RhbnQnKXtcclxuICAgICAgdGhpcy50aW1lTGltaXRJbmZvLnRpbWVVbml0ID0gXCJkYXlcIjtcclxuICAgIH1lbHNlIGlmKGRhdGEuZGF0YS52YWx1ZSA9PT0gJ3Njb3BlJyl7XHJcbiAgICAgIHRoaXMudGltZUxpbWl0SW5mby50aW1lVW5pdCA9ICcnO1xyXG4gICAgICB0aGlzLnRpbWVMaW1pdEluZm8uZHVlVGltZSA9IHRoaXMudGltZVNjb3BlVmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNoYW5nZVRpbWVTY29wZShkYXRhKXtcclxuICAgIHRoaXMudGltZVNjb3BlVmFsdWUgPSBkYXRhO1xyXG4gICAgdGhpcy50aW1lTGltaXRJbmZvLmR1ZVRpbWUgPSB0aGlzLnRpbWVTY29wZVZhbHVlO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRpbWVMaW1pdENvbnRyb2xDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBjb252ZXJ0VG8oZGF0YTogYW55KTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEuZW5hYmxlKSB7XHJcbiAgICAgIHJldHVybiAn77yI5bey6K6+572u77yJJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiAn77yI5pyq6K6+572u77yJJztcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19