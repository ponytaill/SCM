/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ViewChild, TemplateRef, EventEmitter, Inject, LOCALE_ID, Output, Input } from '@angular/core';
import { ProcessListHelpService } from '../../services/process-list-help.service';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { FrameworkService } from '@gsp-sys/rtf-common';
import { Router, ActivatedRoute } from '@angular/router';
import { LoadingService } from '@farris/ui-loading';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { BifMetadataType } from '../../entity/BifMetadataType';
import { ProcessFilterConditionArgs } from '../../entity/ProcessFilterConditionArgs';
import { TextValue } from '@edp-bif/common-api';
import { OrderByDirection } from '../../entity/OrderByDirection';
import { DatagridComponent } from '@farris/ui-datagrid';
import { AifLocalePipe } from '../../../aif-ui-common/pipe/aif-ui-common-locale.pipe';
var ProcessListHelpComponent = /** @class */ (function () {
    function ProcessListHelpComponent(procHelpService, messager, notify, modalService, frameworkService, router, activatedRoute, loading, localeId, localePipe) {
        var _this = this;
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.modalService = modalService;
        this.frameworkService = frameworkService;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: '生单流程选择',
            width: 1250,
            height: 500,
            showButtons: true
        };
        this.procEmitter = new EventEmitter();
        this.ttIdField = "id";
        this.ttData = [];
        this.ttColumns = [];
        this.cascadeCheck = false;
        this.cascadeDown = false;
        this.cascadeUp = false;
        this.defaultPageSize = 30;
        this.pageList = [this.defaultPageSize, 50, 100, 200, 500];
        /**
         * 列排序前事件
         */
        this.beforeSortColumn = (/**
         * @param {?} field
         * @param {?} order
         * @return {?}
         */
        function (field, order) {
            /** @type {?} */
            var cols = field.split(",");
            /** @type {?} */
            var orders = order.split(",");
            //重置排序条件
            _this.queryParam.filterArgs.orderByCode = null;
            _this.queryParam.filterArgs.orderByName = null;
            _this.queryParam.filterArgs.OrderByLastModifiedTime = null;
            //依次添加排序条件
            for (var i = 0; i < cols.length; i++) {
                /** @type {?} */
                var orderBy = null;
                if (orders[i] == "asc") {
                    orderBy = new TextValue();
                    orderBy.hasValue = true;
                    orderBy.value = OrderByDirection.Asc;
                }
                else if (orders[i] == "desc") {
                    orderBy = new TextValue();
                    orderBy.hasValue = true;
                    orderBy.value = OrderByDirection.Desc;
                }
                if (cols[i] == "code") {
                    _this.queryParam.filterArgs.orderByCode = orderBy;
                }
                else if (cols[i] == "name") {
                    _this.queryParam.filterArgs.orderByName = orderBy;
                }
                else if (cols[i] == "lastModifiedTime") {
                    _this.queryParam.filterArgs.OrderByLastModifiedTime = orderBy;
                }
            }
            return _this.loadItems(_this.queryParam.filterArgs);
        });
        this.queryParam = this.createDefaultQueryParam();
    }
    Object.defineProperty(ProcessListHelpComponent.prototype, "value", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                this.processCode = data;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ProcessListHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.configTtColumns();
        if (this.editorParams && this.editorParams.bizTypeId) {
            this.queryParam.filterArgs.bizType = new TextValue();
            this.queryParam.filterArgs.bizType.value = this.editorParams.bizTypeId;
            this.queryParam.filterArgs.bizType.hasValue = true;
        }
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (_this.ttData && _this.ttData.length > 0) {
                    /** @type {?} */
                    var proc = _this.processCode != null ? _this.ttData.find((/**
                     * @param {?} it
                     * @return {?}
                     */
                    function (it) { return it.code == _this.processCode; })) : _this.ttData[0];
                    proc && _this.tt.selectRow(proc.id);
                }
            }), 300);
        }));
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickOk = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        if (this.tt.selectedRow == null) {
            this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly"));
            return;
        }
        this.procEmitter.emit(this.tt.selectedRow.data);
        /** @type {?} */
        var object = { value: this.tt.selectedRow.data.code, parameters: null };
        this.submitModal.emit(object);
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?=} evt
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickCancel = /**
     * @param {?=} evt
     * @return {?}
     */
    function (evt) {
        this.procEmitter.complete();
        this.closeModal.emit();
        this.modalRef && this.modalRef.close();
    };
    /**
     * @param {?} param
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onSearch = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        var _this = this;
        this.queryParam = param;
        console.log(this.queryParam);
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            _this.tt.clearCheckeds();
            _this.tt.clearSelections();
        }));
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    ProcessListHelpComponent.prototype.clickNameCell = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        this.procHelpService.openBifManagerApp(ctx.rowData);
    };
    /**
     * 列排序后事件
     */
    /**
     * 列排序后事件
     * @param {?} val
     * @return {?}
     */
    ProcessListHelpComponent.prototype.columnSorted = /**
     * 列排序后事件
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageSizeChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        console.log('PageSize Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds);
            }), 0);
        }));
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.onPageChanged = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        console.log('PageNumber Changed:', $event);
        /** @type {?} */
        var checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.data.id; }));
        this.queryParam.filterArgs.pageIndex = $event.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tt.checkRows(checkedIds);
            }), 0);
        }));
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageChangeHandler = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        console.log($event);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ProcessListHelpComponent.prototype.pageSizeChangeHandler = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        console.log($event);
    };
    /**
     * @private
     * @param {?} args
     * @return {?}
     */
    ProcessListHelpComponent.prototype.loadItems = /**
     * @private
     * @param {?} args
     * @return {?}
     */
    function (args) {
        var _this = this;
        /** @type {?} */
        var loadingComp = this.loading.show({ message: this.localePipe.transform("loading") });
        return this.procHelpService.getDatagridData(args).pipe(switchMap((/**
         * @param {?} listRes
         * @return {?}
         */
        function (listRes) {
            _this.ttData = tslib_1.__spread(listRes.entities);
            //更新分页信息
            _this.tt.setPageIndex(listRes.pageIndex + 1);
            _this.tt.total = listRes.totalCount;
            _this.tt.pageSize = listRes.pageSize;
            // this.page.setCurrentPage(this.paginationId, listRes.pageIndex + 1);
            // this.page.setItemsPerPage(this.paginationId, listRes.pageSize);
            // this.page.setTotalItems(this.paginationId, listRes.totalCount);
            loadingComp.close();
            return of(listRes);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            loadingComp.close();
            setTimeout((/**
             * @return {?}
             */
            function () {
                //todo 确定异常结构, 目前采用兼容取值方式
                _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }), 300);
            throw err;
        })));
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.configTtColumns = /**
     * @private
     * @return {?}
     */
    function () {
        this.ttColumns = [
            // {
            //   field: "isEnabled", title: this.localePipe.transform("enabledState"), width: 100, sortable: false,
            //   formatter: (value: boolean, rowData, rowIndex) => {
            //     if (value == true) {
            //       return this.localePipe.transform("enabled");
            //     } else if (value == false) {
            //       return this.localePipe.transform("disabled");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            { field: "code", title: this.localePipe.transform("code"), width: 120, sortable: true },
            {
                field: "name", title: this.localePipe.transform("name"), width: 250, sortable: true,
                template: this.nameCellTemp,
            },
            { field: "upBillVoName", title: this.localePipe.transform("upBill"), width: 120, sortable: true },
            { field: "downBillVoName", title: this.localePipe.transform("downBill"), width: 120, sortable: true },
        ];
    };
    /**
     * @private
     * @return {?}
     */
    ProcessListHelpComponent.prototype.createDefaultQueryParam = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var queryParam = {
            filterArgs: new ProcessFilterConditionArgs(),
            filterArgsExt: {}
        };
        queryParam.filterArgs.pageSize = this.defaultPageSize;
        queryParam.filterArgs.pageIndex = 0;
        queryParam.filterArgs.OrderByLastModifiedTime = new TextValue();
        queryParam.filterArgs.OrderByLastModifiedTime.value = OrderByDirection.Desc;
        queryParam.filterArgs.OrderByLastModifiedTime.hasValue = true;
        queryParam.filterArgs.billProcessType = new TextValue();
        queryParam.filterArgs.billProcessType.value = BifMetadataType.BifCreationProcess;
        queryParam.filterArgs.billProcessType.hasValue = true;
        queryParam.filterArgs.isEnabled = new TextValue();
        queryParam.filterArgs.isEnabled.value = "true";
        queryParam.filterArgs.isEnabled.hasValue = true;
        return queryParam;
    };
    ProcessListHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-process-list-help',
                    template: "<div class=\"f-page f-page-is-managelist\" id=\"bif-manager-list\">\r\n  <!-- <app-proc-help-query-solution id=\"query-solution\" #querySolution [(queryParam)]=\"queryParam\"\r\n    (onSearch)=\"onSearch($event)\">\r\n  </app-proc-help-query-solution> -->\r\n\r\n  <div class=\"f-page-main\" id=\"page-main\">\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <farris-datagrid id=\"tt\" #tt [data]=\"ttData\" [columns]=\"ttColumns\" [idField]=\"ttIdField\" [multiSelect]=\"true\"\r\n        [showCheckbox]=\"false\" [showAllCheckbox]=\"false\" [onlySelectSelf]=\"true\" [keepSelect]=\"true\"\r\n        [selectOnCheck]=\"true\" [checkOnSelect]=\"false\" [showHeader]=\"true\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [pagination]=\"true\" [showPageList]=\"true\" [pageSize]=\"defaultPageSize\" [pageList]=\"pageList\"\r\n        (pageChanged)=\"onPageChanged($event)\" (pageSizeChanged)=\"onPageSizeChanged($event)\" [remoteSort]=\"true\"\r\n        [multiSort]=\"false\" [beforeSortColumn]=\"beforeSortColumn\" (columnSorted)=\"columnSorted($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href=\"javascript: void(0);\" (click)=\"clickNameCell(ctx)\">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ProcessListHelpComponent.ctorParameters = function () { return [
        { type: ProcessListHelpService },
        { type: MessagerService },
        { type: NotifyService },
        { type: BsModalService },
        { type: FrameworkService },
        { type: Router },
        { type: ActivatedRoute },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: AifLocalePipe }
    ]; };
    ProcessListHelpComponent.propDecorators = {
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        tt: [{ type: ViewChild, args: ["tt",] }],
        nameCellTemp: [{ type: ViewChild, args: ['nameCellTemp',] }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
    };
    return ProcessListHelpComponent;
}());
export { ProcessListHelpComponent };
if (false) {
    /** @type {?} */
    ProcessListHelpComponent.prototype.closeModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.submitModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.editorParams;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.processCode;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalConfig;
    /** @type {?} */
    ProcessListHelpComponent.prototype.procEmitter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.queryParam;
    /** @type {?} */
    ProcessListHelpComponent.prototype.tt;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttIdField;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttData;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttColumns;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeCheck;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeDown;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeUp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.nameCellTemp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalFooter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalRef;
    /** @type {?} */
    ProcessListHelpComponent.prototype.defaultPageSize;
    /** @type {?} */
    ProcessListHelpComponent.prototype.pageList;
    /**
     * 列排序前事件
     * @type {?}
     */
    ProcessListHelpComponent.prototype.beforeSortColumn;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.procHelpService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.frameworkService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi9haWYtcHJvY2Vzcy1saXN0LWhlbHAvY29tcG9uZW50cy9wcm9jZXNzLWxpc3QtaGVscC9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUxSCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUNsRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQWMsTUFBTSxrQkFBa0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQy9ELE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ3JGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsZ0JBQWdC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b3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgRXZlbnRFbWl0dGVyLCBJbmplY3QsIExPQ0FMRV9JRCwgT3V0cHV0LCBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGYXJyaXNTZWN0aW9uQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1zZWN0aW9uJztcclxuaW1wb3J0IHsgUHJvY2Vzc0xpc3RIZWxwU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3Byb2Nlc3MtbGlzdC1oZWxwLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UsIEJzTW9kYWxSZWYgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgRnJhbWV3b3JrU2VydmljZSB9IGZyb20gJ0Bnc3Atc3lzL3J0Zi1jb21tb24nO1xyXG5pbXBvcnQgeyBSb3V0ZXIsIEFjdGl2YXRlZFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIGNhdGNoRXJyb3IgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IElSdFByb2NRdWVyeVBhcmFtIH0gZnJvbSAnLi4vLi4vZW50aXR5L0lQcm9jUXVlcnlQYXJhbSc7XHJcbmltcG9ydCB7IEJpZk1ldGFkYXRhVHlwZSB9IGZyb20gJy4uLy4uL2VudGl0eS9CaWZNZXRhZGF0YVR5cGUnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS9Qcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncyc7XHJcbmltcG9ydCB7IFRleHRWYWx1ZSB9IGZyb20gJ0BlZHAtYmlmL2NvbW1vbi1hcGknO1xyXG5pbXBvcnQgeyBPcmRlckJ5RGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L09yZGVyQnlEaXJlY3Rpb24nO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBSdEJpbGxQcm9jZXNzTGlzdFJlc3VsdCB9IGZyb20gJy4uLy4uL2VudGl0eS9SdEJpbGxQcm9jZXNzTGlzdFJlc3VsdCc7XHJcbmltcG9ydCB7IEFpZkxvY2FsZVBpcGUgfSBmcm9tICcuLi8uLi8uLi9haWYtdWktY29tbW9uL3BpcGUvYWlmLXVpLWNvbW1vbi1sb2NhbGUucGlwZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1wcm9jZXNzLWxpc3QtaGVscCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3Byb2Nlc3MtbGlzdC1oZWxwLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFByb2Nlc3NMaXN0SGVscENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUoZGF0YTogYW55KSB7XHJcbiAgICBpZiAoZGF0YSkge1xyXG4gICAgICB0aGlzLnByb2Nlc3NDb2RlID0gZGF0YTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgpIGVkaXRvclBhcmFtczoge1xyXG4gICAgYml6VHlwZUlkPzogc3RyaW5nXHJcbiAgfSA9IHt9O1xyXG5cclxuICBwcml2YXRlIHByb2Nlc3NDb2RlOiBzdHJpbmc7XHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogJ+eUn+WNlea1geeoi+mAieaLqScsXHJcbiAgICB3aWR0aDogMTI1MCxcclxuICAgIGhlaWdodDogNTAwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG5cclxuICBwcm9jRW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIHF1ZXJ5UGFyYW06IElSdFByb2NRdWVyeVBhcmFtO1xyXG5cclxuICBAVmlld0NoaWxkKFwidHRcIilcclxuICB0dDogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgdHRJZEZpZWxkOiBzdHJpbmcgPSBcImlkXCI7XHJcbiAgdHREYXRhOiBhbnlbXSA9IFtdO1xyXG4gIHR0Q29sdW1uczogYW55W10gPSBbXTtcclxuICBjYXNjYWRlQ2hlY2sgPSBmYWxzZTtcclxuICBjYXNjYWRlRG93biA9IGZhbHNlO1xyXG4gIGNhc2NhZGVVcCA9IGZhbHNlO1xyXG5cclxuICBAVmlld0NoaWxkKCduYW1lQ2VsbFRlbXAnKVxyXG4gIG5hbWVDZWxsVGVtcDogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpXHJcbiAgbW9kYWxGb290ZXI6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gIG1vZGFsUmVmOiBCc01vZGFsUmVmO1xyXG5cclxuICByZWFkb25seSBkZWZhdWx0UGFnZVNpemU6IG51bWJlciA9IDMwO1xyXG4gIHBhZ2VMaXN0ID0gW3RoaXMuZGVmYXVsdFBhZ2VTaXplLCA1MCwgMTAwLCAyMDAsIDUwMF07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBwcm9jSGVscFNlcnZpY2U6IFByb2Nlc3NMaXN0SGVscFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2VyOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSxcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgZnJhbWV3b3JrU2VydmljZTogRnJhbWV3b3JrU2VydmljZSxcclxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcbiAgICBwcml2YXRlIGFjdGl2YXRlZFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcclxuICAgIHByaXZhdGUgbG9hZGluZzogTG9hZGluZ1NlcnZpY2UsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIHByaXZhdGUgbG9jYWxlUGlwZTogQWlmTG9jYWxlUGlwZSxcclxuICApIHtcclxuICAgIHRoaXMucXVlcnlQYXJhbSA9IHRoaXMuY3JlYXRlRGVmYXVsdFF1ZXJ5UGFyYW0oKTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jb25maWdUdENvbHVtbnMoKTtcclxuICAgIGlmICh0aGlzLmVkaXRvclBhcmFtcyAmJiB0aGlzLmVkaXRvclBhcmFtcy5iaXpUeXBlSWQpIHtcclxuICAgICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MuYml6VHlwZSA9IG5ldyBUZXh0VmFsdWUoKTtcclxuICAgICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MuYml6VHlwZS52YWx1ZSA9IHRoaXMuZWRpdG9yUGFyYW1zLmJpelR5cGVJZDtcclxuICAgICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MuYml6VHlwZS5oYXNWYWx1ZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMudHREYXRhICYmIHRoaXMudHREYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGNvbnN0IHByb2MgPSB0aGlzLnByb2Nlc3NDb2RlICE9IG51bGwgPyB0aGlzLnR0RGF0YS5maW5kKChpdCkgPT4gaXQuY29kZSA9PSB0aGlzLnByb2Nlc3NDb2RlKSA6IHRoaXMudHREYXRhWzBdO1xyXG4gICAgICAgICAgcHJvYyAmJiB0aGlzLnR0LnNlbGVjdFJvdyhwcm9jLmlkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDMwMCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsaWNrT2soZXZ0Pykge1xyXG4gICAgaWYgKHRoaXMudHQuc2VsZWN0ZWRSb3cgPT0gbnVsbCkge1xyXG4gICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwbGVhc2VTZWxlY3RPbmVJdGVtT25seVwiKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMucHJvY0VtaXR0ZXIuZW1pdCh0aGlzLnR0LnNlbGVjdGVkUm93LmRhdGEpO1xyXG4gICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogdGhpcy50dC5zZWxlY3RlZFJvdy5kYXRhLmNvZGUsIHBhcmFtZXRlcnM6IG51bGwgfTtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgdGhpcy5tb2RhbFJlZiAmJiB0aGlzLm1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBjbGlja0NhbmNlbChldnQ/KSB7XHJcbiAgICB0aGlzLnByb2NFbWl0dGVyLmNvbXBsZXRlKCk7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gICAgdGhpcy5tb2RhbFJlZiAmJiB0aGlzLm1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBvblNlYXJjaChwYXJhbTogYW55KSB7XHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0gPSBwYXJhbTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMucXVlcnlQYXJhbSk7XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy50dC5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgdGhpcy50dC5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNsaWNrTmFtZUNlbGwoY3R4KSB7XHJcbiAgICB0aGlzLnByb2NIZWxwU2VydmljZS5vcGVuQmlmTWFuYWdlckFwcChjdHgucm93RGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICog5YiX5o6S5bqP5YmN5LqL5Lu2XHJcbiAqL1xyXG4gIGJlZm9yZVNvcnRDb2x1bW4gPSAoZmllbGQ6IHN0cmluZywgb3JkZXI6IHN0cmluZykgPT4ge1xyXG4gICAgbGV0IGNvbHM6IHN0cmluZ1tdID0gZmllbGQuc3BsaXQoXCIsXCIpO1xyXG4gICAgbGV0IG9yZGVyczogc3RyaW5nW10gPSBvcmRlci5zcGxpdChcIixcIik7XHJcblxyXG4gICAgLy/ph43nva7mjpLluo/mnaHku7ZcclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLm9yZGVyQnlDb2RlID0gbnVsbDtcclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLm9yZGVyQnlOYW1lID0gbnVsbDtcclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lID0gbnVsbDtcclxuICAgIC8v5L6d5qyh5re75Yqg5o6S5bqP5p2h5Lu2XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgbGV0IG9yZGVyQnkgPSBudWxsO1xyXG4gICAgICBpZiAob3JkZXJzW2ldID09IFwiYXNjXCIpIHtcclxuICAgICAgICBvcmRlckJ5ID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgICAgIG9yZGVyQnkuaGFzVmFsdWUgPSB0cnVlO1xyXG4gICAgICAgIG9yZGVyQnkudmFsdWUgPSBPcmRlckJ5RGlyZWN0aW9uLkFzYztcclxuICAgICAgfSBlbHNlIGlmIChvcmRlcnNbaV0gPT0gXCJkZXNjXCIpIHtcclxuICAgICAgICBvcmRlckJ5ID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgICAgIG9yZGVyQnkuaGFzVmFsdWUgPSB0cnVlO1xyXG4gICAgICAgIG9yZGVyQnkudmFsdWUgPSBPcmRlckJ5RGlyZWN0aW9uLkRlc2M7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjb2xzW2ldID09IFwiY29kZVwiKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3Mub3JkZXJCeUNvZGUgPSBvcmRlckJ5O1xyXG4gICAgICB9IGVsc2UgaWYgKGNvbHNbaV0gPT0gXCJuYW1lXCIpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5vcmRlckJ5TmFtZSA9IG9yZGVyQnk7XHJcbiAgICAgIH0gZWxzZSBpZiAoY29sc1tpXSA9PSBcImxhc3RNb2RpZmllZFRpbWVcIikge1xyXG4gICAgICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lID0gb3JkZXJCeTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncyk7XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICog5YiX5o6S5bqP5ZCO5LqL5Lu2XHJcbiAgICovXHJcbiAgY29sdW1uU29ydGVkKHZhbCkge1xyXG4gICAgY29uc29sZS5sb2codmFsKTtcclxuICB9XHJcblxyXG4gIG9uUGFnZVNpemVDaGFuZ2VkKCRldmVudDogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICBjb25zb2xlLmxvZygnUGFnZVNpemUgQ2hhbmdlZDonLCAkZXZlbnQpO1xyXG4gICAgbGV0IGNoZWNrZWRJZHMgPSB0aGlzLnR0LmNoZWNrZWRzLm1hcChyID0+IHIuZGF0YS5pZCk7XHJcblxyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSAkZXZlbnQucGFnZVNpemU7XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnR0LmNoZWNrUm93cyhjaGVja2VkSWRzKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9uUGFnZUNoYW5nZWQoJGV2ZW50OiB7IHBhZ2VJbmRleDogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyIH0pIHtcclxuICAgIGNvbnNvbGUubG9nKCdQYWdlTnVtYmVyIENoYW5nZWQ6JywgJGV2ZW50KTtcclxuICAgIGxldCBjaGVja2VkSWRzID0gdGhpcy50dC5jaGVja2Vkcy5tYXAociA9PiByLmRhdGEuaWQpO1xyXG5cclxuICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VJbmRleCA9ICRldmVudC5wYWdlSW5kZXggLSAxO1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSAkZXZlbnQucGFnZVNpemU7XHJcbiAgICB0aGlzLmxvYWRJdGVtcyh0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnR0LmNoZWNrUm93cyhjaGVja2VkSWRzKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHBhZ2VDaGFuZ2VIYW5kbGVyKCRldmVudCkge1xyXG4gICAgY29uc29sZS5sb2coJGV2ZW50KTtcclxuICB9XHJcblxyXG4gIHBhZ2VTaXplQ2hhbmdlSGFuZGxlcigkZXZlbnQpIHtcclxuICAgIGNvbnNvbGUubG9nKCRldmVudCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGxvYWRJdGVtcyhhcmdzOiBQcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBsb2FkaW5nQ29tcCA9IHRoaXMubG9hZGluZy5zaG93KHsgbWVzc2FnZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImxvYWRpbmdcIikgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9jSGVscFNlcnZpY2UuZ2V0RGF0YWdyaWREYXRhKGFyZ3MpLnBpcGUoXHJcbiAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAobGlzdFJlczogUnRCaWxsUHJvY2Vzc0xpc3RSZXN1bHQpID0+IHtcclxuICAgICAgICAgIHRoaXMudHREYXRhID0gWy4uLmxpc3RSZXMuZW50aXRpZXNdO1xyXG4gICAgICAgICAgLy/mm7TmlrDliIbpobXkv6Hmga9cclxuICAgICAgICAgIHRoaXMudHQuc2V0UGFnZUluZGV4KGxpc3RSZXMucGFnZUluZGV4ICsgMSk7XHJcbiAgICAgICAgICB0aGlzLnR0LnRvdGFsID0gbGlzdFJlcy50b3RhbENvdW50O1xyXG4gICAgICAgICAgdGhpcy50dC5wYWdlU2l6ZSA9IGxpc3RSZXMucGFnZVNpemU7XHJcbiAgICAgICAgICAvLyB0aGlzLnBhZ2Uuc2V0Q3VycmVudFBhZ2UodGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMucGFnZUluZGV4ICsgMSk7XHJcbiAgICAgICAgICAvLyB0aGlzLnBhZ2Uuc2V0SXRlbXNQZXJQYWdlKHRoaXMucGFnaW5hdGlvbklkLCBsaXN0UmVzLnBhZ2VTaXplKTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRUb3RhbEl0ZW1zKHRoaXMucGFnaW5hdGlvbklkLCBsaXN0UmVzLnRvdGFsQ291bnQpO1xyXG5cclxuICAgICAgICAgIGxvYWRpbmdDb21wLmNsb3NlKCk7XHJcbiAgICAgICAgICByZXR1cm4gb2YobGlzdFJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICApLFxyXG4gICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgIGxvYWRpbmdDb21wLmNsb3NlKCk7XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgLy90b2RvIOehruWumuW8guW4uOe7k+aehCwg55uu5YmN6YeH55So5YW85a655Y+W5YC85pa55byPXHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXIuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbmZpZ1R0Q29sdW1ucygpIHtcclxuICAgIHRoaXMudHRDb2x1bW5zID0gW1xyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwiaXNFbmFibGVkXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW5hYmxlZFN0YXRlXCIpLCB3aWR0aDogMTAwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IGJvb2xlYW4sIHJvd0RhdGEsIHJvd0luZGV4KSA9PiB7XHJcbiAgICAgIC8vICAgICBpZiAodmFsdWUgPT0gdHJ1ZSkge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImVuYWJsZWRcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2UgaWYgKHZhbHVlID09IGZhbHNlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgIC8vICAgICB9XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICB7IGZpZWxkOiBcImNvZGVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjb2RlXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogdHJ1ZSB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6IFwibmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5hbWVcIiksIHdpZHRoOiAyNTAsIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgICAgIHRlbXBsYXRlOiB0aGlzLm5hbWVDZWxsVGVtcCxcclxuICAgICAgfSxcclxuICAgICAgeyBmaWVsZDogXCJ1cEJpbGxWb05hbWVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ1cEJpbGxcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgZmllbGQ6IFwiZG93bkJpbGxWb05hbWVcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJkb3duQmlsbFwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUgfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGZpZWxkOiBcImJpZk1ldGFkYXRhVHlwZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInByb2Nlc3NUeXBlXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IEJpZk1ldGFkYXRhVHlwZSwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmICh2YWx1ZSA9PSBCaWZNZXRhZGF0YVR5cGUuQmlmQ3JlYXRpb25Qcm9jZXNzKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25cIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2UgaWYgKHZhbHVlID09IEJpZk1ldGFkYXRhVHlwZS5CaWZXcml0ZWJhY2tQcm9jZXNzKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwid3JpdGViYWNrXCIpO1xyXG4gICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIFwiLVwiO1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGZpZWxkOiBcInN5c0luaXRcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJzeXNJbml0XCIpLCB3aWR0aDogODAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmICh2YWx1ZSA9PSB0cnVlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwieWVzXCIpO1xyXG4gICAgICAvLyAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBmYWxzZSkge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5vXCIpO1xyXG4gICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIFwiLVwiO1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGZpZWxkOiBudWxsLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImlzRXh0ZW5kUHJvY2Vzc1wiKSwgd2lkdGg6IDgwLCBzb3J0YWJsZTogZmFsc2UsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiAodmFsdWU6IGJvb2xlYW4sIHJvd0RhdGEsIHJvd0luZGV4KSA9PiB7XHJcbiAgICAgIC8vICAgICBpZiAocm93RGF0YS5wYXJlbnRJZCA9PSBudWxsKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibm9cIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInllc1wiKTtcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiYnVzaW5lc3NUeXBlXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImJ1c2luZXNzVHlwZVwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiBcImNyZWF0b3JcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiY3JlYXRvclwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7IGZpZWxkOiBcImNyZWF0ZWRUaW1lXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImNyZWF0ZWRUaW1lXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwibGFzdE1vZGlmaWVyXCIsIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuaW5zdGFudChcImxhc3RNb2RpZmllclwiKSwgd2lkdGg6IDEyMCB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwibGFzdE1vZGlmaWVkVGltZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImxhc3RNb2RpZmllZFRpbWVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlLFxyXG4gICAgICAvLyAgIGZvcm1hdHRlcjoge1xyXG4gICAgICAvLyAgICAgdHlwZTogJ2RhdGV0aW1lJyxcclxuICAgICAgLy8gICAgIG9wdGlvbnM6IHtcclxuICAgICAgLy8gICAgICAgZm9ybWF0OiAnWVlZWS1NTS1ERCBISDptbTpzcydcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9LFxyXG4gICAgICAvLyB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRGVmYXVsdFF1ZXJ5UGFyYW0oKSB7XHJcbiAgICBjb25zdCBxdWVyeVBhcmFtID0ge1xyXG4gICAgICBmaWx0ZXJBcmdzOiBuZXcgUHJvY2Vzc0ZpbHRlckNvbmRpdGlvbkFyZ3MoKSxcclxuICAgICAgZmlsdGVyQXJnc0V4dDoge31cclxuICAgIH07XHJcblxyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLnBhZ2VTaXplID0gdGhpcy5kZWZhdWx0UGFnZVNpemU7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZUluZGV4ID0gMDtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZSA9IG5ldyBUZXh0VmFsdWUoKTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZS52YWx1ZSA9IE9yZGVyQnlEaXJlY3Rpb24uRGVzYztcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5PcmRlckJ5TGFzdE1vZGlmaWVkVGltZS5oYXNWYWx1ZSA9IHRydWU7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLmJpbGxQcm9jZXNzVHlwZS52YWx1ZSA9IEJpZk1ldGFkYXRhVHlwZS5CaWZDcmVhdGlvblByb2Nlc3M7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuaXNFbmFibGVkLnZhbHVlID0gXCJ0cnVlXCI7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuaXNFbmFibGVkLmhhc1ZhbHVlID0gdHJ1ZTtcclxuXHJcblxyXG4gICAgcmV0dXJuIHF1ZXJ5UGFyYW07XHJcbiAgfVxyXG59XHJcbiJdfQ==