/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Input, Output, EventEmitter, ViewChild, TemplateRef, ComponentFactoryResolver, Injector } from '@angular/core';
import { CallActivitySubProcess } from '../call-activity-sub-process/call-activity-sub-process.entity';
import { MessagerService } from '@farris/ui-messager';
import { ProcessDeUtil } from '../../domain/process-de-util';
import { HttpService } from '@ecp-caf/caf-common';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { ExpressionService, InjectedType } from '@gsp-svc/expression';
import { FarrisRadioGroupComponent } from '@farris/ui-forms';
import { ProcessListHelpComponent } from '../../aif-process-list-help/components/process-list-help/process-list-help.component';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { SubProcessType } from '../call-activity-sub-process/SubProcessType';
import { BillSourceType } from '../call-activity-sub-process/BillSourceType';
var CallActivitySubProcess2Component = /** @class */ (function () {
    function CallActivitySubProcess2Component(notify, modalService, message, util, http, designerState, expr, cfr, inj) {
        this.notify = notify;
        this.modalService = modalService;
        this.message = message;
        this.util = util;
        this.http = http;
        this.designerState = designerState;
        this.expr = expr;
        this.cfr = cfr;
        this.inj = inj;
        this.cls = 'farris-main-area flex-column';
        this.editorParams = {};
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: '子流程设置',
            width: 480,
            height: 400,
            showButtons: true
        };
        this.callActivitySubProcess = new CallActivitySubProcess();
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.subProcessType = SubProcessType;
        this.billSourceType = BillSourceType;
        this.radioGroupProcessTypeData = [
            { value: "Specified", name: "指定子流程" },
            { value: "Dynamic", name: "动态子流程" },
        ];
        this.radioGroupBillSourceData = [
            { value: BillSourceType.InheritParent, name: '与父流程相同' },
            { value: BillSourceType.AutoCreation, name: '自动生成下游单据' },
            { value: BillSourceType.VariablesExpression, name: '变量表达式' },
        ];
    }
    Object.defineProperty(CallActivitySubProcess2Component.prototype, "value", {
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v) {
                this.callActivitySubProcess = v;
                // 为子流程类型赋值
                if (this.callActivitySubProcess.calledElement == null || this.callActivitySubProcess.calledElement == "") {
                    if (this.callActivitySubProcess.calledBizDefKey == null || this.callActivitySubProcess.calledBizDefKey == "") {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                    }
                    else {
                        this.callActivitySubProcess.subProcessType = SubProcessType.Dynamic;
                    }
                }
                else {
                    this.callActivitySubProcess.subProcessType = SubProcessType.Specified;
                }
                // 为单据来源类型赋值
                if (this.callActivitySubProcess.inheritBizDataId === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.InheritParent;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === false) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.VariablesExpression;
                }
                else if (this.callActivitySubProcess.inheritBizDataId === false && this.callActivitySubProcess.useAutoCreationData === true) {
                    this.callActivitySubProcess.billSourceType = BillSourceType.AutoCreation;
                }
                this.getProcessDefKey(this.callActivitySubProcess.calledElement);
                this.getFlowForm(this.callActivitySubProcess.calledBizDefKey);
                this.getAifProcessName(this.callActivitySubProcess.aifProcessCode);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.callActivitySubProcess, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledElement = args.id;
            this.callActivitySubProcess.calledElementName = args.name;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.processTypeChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == SubProcessType.Specified) {
            this.callActivitySubProcess.calledBizDefKey = null;
            this.callActivitySubProcess.calledBizDefName = null;
        }
        else if (val == SubProcessType.Dynamic) {
            this.callActivitySubProcess.calledElement = null;
            this.callActivitySubProcess.calledElementName = null;
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.billSourceChange = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        console.log(val);
        if (val == BillSourceType.InheritParent) {
            this.callActivitySubProcess.inheritBizDataId = true;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
        else if (val == BillSourceType.AutoCreation) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = true;
        }
        else if (val == BillSourceType.VariablesExpression) {
            this.callActivitySubProcess.inheritBizDataId = false;
            this.callActivitySubProcess.useAutoCreationData = false;
        }
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.selectProcess = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.openProcHelp().subscribe((/**
         * @param {?} rte
         * @return {?}
         */
        function (rte) {
            if (rte == null) {
                _this.notify.warning("请选中一条生单流程");
                return;
            }
            _this.callActivitySubProcess.aifProcessCode = rte.code;
            _this.callActivitySubProcess.aifProcessName = rte.name;
        }));
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcess = /**
     * @return {?}
     */
    function () {
        this.callActivitySubProcess.aifProcessCode = null;
        this.callActivitySubProcess.aifProcessName = null;
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.openProcHelp = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var cmpF = this.cfr.resolveComponentFactory(ProcessListHelpComponent);
        /** @type {?} */
        var cmpR = cmpF.create(this.inj, []);
        cmpR.instance.editorParams = this.editorParams;
        /** @type {?} */
        var modalRef = this.modalService.show(cmpR, {
            title: "生单流程",
            width: 1250,
            height: 500,
            resizable: true,
            buttons: [
                {
                    text: "确定",
                    cls: "btn btn-primary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickOk(evt);
                        modalRef.close();
                    })
                },
                {
                    text: "取消",
                    cls: "btn btn-secondary",
                    handle: (/**
                     * @param {?} evt
                     * @return {?}
                     */
                    function (evt) {
                        cmpR.instance.clickCancel(evt);
                        modalRef.close();
                    })
                }
            ],
            closed: (/**
             * @return {?}
             */
            function () {
                modalRef.dialog.destroy();
            })
        });
        cmpR.instance.modalRef = modalRef;
        return cmpR.instance.procEmitter.asObservable();
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearProcessDef = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledElement = '';
        this.callActivitySubProcess.calledElementName = '';
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.flowFormConfirm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        if (args) {
            this.callActivitySubProcess.calledBizDefKey = args.id;
            this.callActivitySubProcess.calledBizDefName = args.name;
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.clearFlowForm = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        this.callActivitySubProcess.calledBizDefKey = '';
        this.callActivitySubProcess.calledBizDefName = '';
    };
    /**
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.setBizDataId = /**
     * @return {?}
     */
    function () {
        this.showExprHelp();
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.showExprHelp = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e, e_6, _f;
        if (this.designerState.schemas.length > 0) {
            try {
                for (var _g = tslib_1.__values(this.designerState.schemas), _h = _g.next(); !_h.done; _h = _g.next()) {
                    var schema = _h.value;
                    this.expr.addSchema('Schema', schema);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_h && !_h.done && (_a = _g.return)) _a.call(_g);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (this.designerState.schemas[0].entityTypes && this.designerState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                var entityType = this.designerState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        var context = new Array();
        if (this.designerState.procInstContext.length > 0) {
            try {
                for (var _j = tslib_1.__values(this.designerState.procInstContext), _k = _j.next(); !_k.done; _k = _j.next()) {
                    var variable = _k.value;
                    context.push(variable);
                    // this.expr.addContext(variable);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_k && !_k.done && (_b = _j.return)) _b.call(_j);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this.designerState.formalParameterContext.length > 0) {
            var _loop_1 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _l = tslib_1.__values(this.designerState.formalParameterContext), _m = _l.next(); !_m.done; _m = _l.next()) {
                    var variable = _m.value;
                    _loop_1(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_m && !_m.done && (_c = _l.return)) _c.call(_l);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        if (this.designerState.participantContext.length > 0) {
            var _loop_2 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _o = tslib_1.__values(this.designerState.participantContext), _p = _o.next(); !_p.done; _p = _o.next()) {
                    var variable = _p.value;
                    _loop_2(variable);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_p && !_p.done && (_d = _o.return)) _d.call(_o);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        if (this.designerState.processVariableContext.length > 0) {
            var _loop_3 = function (variable) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.key === variable.key; }))) {
                    context.push(variable);
                }
            };
            try {
                for (var _q = tslib_1.__values(this.designerState.processVariableContext), _r = _q.next(); !_r.done; _r = _q.next()) {
                    var variable = _r.value;
                    _loop_3(variable);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_r && !_r.done && (_e = _q.return)) _e.call(_q);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        if (context.length > 0) {
            try {
                for (var context_1 = tslib_1.__values(context), context_1_1 = context_1.next(); !context_1_1.done; context_1_1 = context_1.next()) {
                    var v = context_1_1.value;
                    this.expr.addContext(v);
                }
            }
            catch (e_6_1) { e_6 = { error: e_6_1 }; }
            finally {
                try {
                    if (context_1_1 && !context_1_1.done && (_f = context_1.return)) _f.call(context_1);
                }
                finally { if (e_6) throw e_6.error; }
            }
        }
        this.expr.addExpressionText(this.callActivitySubProcess.bizDataId);
        this.expr.buildExpression().then((/**
         * @param {?} expressioninfo
         * @return {?}
         */
        function (expressioninfo) {
            _this.callActivitySubProcess.bizDataId = expressioninfo;
        }));
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.valueChange = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        if (bool) {
            this.callActivitySubProcess.bizDataId = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.callActivitySubProcess.inheritBizDataId && !this.callActivitySubProcess.useAutoCreationData && !this.callActivitySubProcess.bizDataId) {
            this.message.warning('当子流程与父流程单据不一致时，请设置子流程单据内码！');
            return false;
        }
        return true;
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getProcessDefKey = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getProcDefKeyWebApi();
        if (key) {
            url += "/" + key;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledElementName = re.name;
            }));
        }
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getFlowForm = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        /** @type {?} */
        var url = this.util.getFlowFormWebApi();
        if (id) {
            url += "/" + id;
            this.http.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                _this.callActivitySubProcess.calledBizDefName = re.name;
            }));
        }
    };
    /**
     * @param {?} code
     * @return {?}
     */
    CallActivitySubProcess2Component.prototype.getAifProcessName = /**
     * @param {?} code
     * @return {?}
     */
    function (code) {
        var _this = this;
        if (code != null && code != "") {
            this.http.request("GET", "/api/runtime/aif/v1.0/rtbillcreationprocess/getname/" + code, { responseType: 'text' }).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.callActivitySubProcess.aifProcessName = res;
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    //todo 确定异常结构, 目前采用兼容取值方式
                    _this.message.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }), 300);
                throw err;
            }));
        }
    };
    CallActivitySubProcess2Component.decorators = [
        { type: Component, args: [{
                    selector: 'lib-call-activity-sub-process2',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section>\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">\u9009\u62E9\u5B50\u6D41\u7A0B</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u5B50\u6D41\u7A0B\u7C7B\u578B</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <!-- <farris-combo-list #comboProcessType\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.subProcessType\"\r\n                    [idField]=\"comboProcessTypeIdField\" [valueField]=\"comboProcessTypeValueField\"\r\n                    [textField]=\"comboProcessTypeTextField\" [data]=\"comboProcessTypeData\"\r\n                    (valueChange)=\"processTypeChange($event)\" [enableClear]=\"false\" [editable]=\"false\">\r\n                  </farris-combo-list> -->\r\n                  <farris-radiogroup #radioGroupProcessType\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.subProcessType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupProcessTypeData\" (changeValue)=\"processTypeChange($event)\">\r\n                  </farris-radiogroup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Dynamic\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u6D41\u7A0B\u5206\u7C7B</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup [title]=\"'\u6D41\u7A0B\u5206\u7C7B'\" [sourceType]=\"'flowform'\"\r\n                    [displayTxt]=\"callActivitySubProcess.calledBizDefName\" (afterConfirm)=\"flowFormConfirm($event)\"\r\n                    (clear)=\"clearFlowForm($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\" *ngIf=\"callActivitySubProcess.subProcessType==subProcessType.Specified\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u6D41\u7A0B\u5B9A\u4E49</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <wf-bizprocess-lookup [title]=\"'\u6D41\u7A0B\u5B9A\u4E49'\" [displayTxt]=\"callActivitySubProcess.calledElementName\"\r\n                    (afterConfirm)=\"processConfirm($event)\" (clear)=\"clearProcessDef($event)\">\r\n                  </wf-bizprocess-lookup>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class=\"\">\r\n      <div class=\"f-section-header pt-2 mx-2\">\r\n        <div class=\"f-title\">\r\n          <h4 class=\"f-title-text\">\u5355\u636E\u6765\u6E90</h4>\r\n        </div>\r\n      </div>\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <div class=\"h-100\">\r\n          <div class=\"farris-form form-inline farris-form-inline\">\r\n\r\n            <div class=\"farris-group-wrap mt-1\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u5355\u636E\u6765\u6E90</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <farris-radiogroup #radioGroupBillSource\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.billSourceType\" [horizontal]=\"false\"\r\n                    [data]=\"radioGroupBillSourceData\" (changeValue)=\"billSourceChange($event)\">\r\n                  </farris-radiogroup>\r\n                  <!-- <farris-combo-list #comboBillSource\r\n                    [(ngModel)]=\"callActivitySubProcess&&callActivitySubProcess.billSourceType\"\r\n                    [idField]=\"comboBillSourceIdField\" [valueField]=\"comboBillSourceValueField\"\r\n                    [textField]=\"comboBillSourceTextField\" [data]=\"comboBillSourceData\"\r\n                    (valueChange)=\"billSourceChange($event)\" [enableClear]=\"false\" [editable]=\"false\">\r\n                  </farris-combo-list> -->\r\n                </div>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.AutoCreation\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u751F\u5355\u6D41\u7A0B</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess&&callActivitySubProcess.aifProcessName\"\r\n                    [editable]=\"false\" (clickHandle)=\"selectProcess()\" [groupText]=\"groupIcon\" (clear)=\"clearProcess()\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"farris-group-wrap mt-1\"\r\n              *ngIf=\"callActivitySubProcess.billSourceType==billSourceType.VariablesExpression\">\r\n              <div class=\"form-group farris-form-group\">\r\n                <label class=\"col-form-label\">\r\n                  <span class=\"farris-label-text\">\u5355\u636E\u5185\u7801</span>\r\n                </label>\r\n                <div class=\"farris-input-wrap ml-1\">\r\n                  <input-group [ngModel]=\"callActivitySubProcess.bizDataId\" [enableClear]=\"false\"\r\n                    [ngModel]=\"callActivitySubProcess.bizDataId\" name=\"bizDataId\" [editable]=\"false\"\r\n                    (clickHandle)=\"setBizDataId()\" [groupText]=\"groupIcon\">\r\n                  </input-group>\r\n                  <div class=\"farris-feedback valid-feedback\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>"
                }] }
    ];
    /** @nocollapse */
    CallActivitySubProcess2Component.ctorParameters = function () { return [
        { type: NotifyService },
        { type: BsModalService },
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState },
        { type: ExpressionService },
        { type: ComponentFactoryResolver },
        { type: Injector }
    ]; };
    CallActivitySubProcess2Component.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        editorParams: [{ type: Input }],
        value: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        radioGroupProcessType: [{ type: ViewChild, args: ["radioGroupProcessType",] }],
        radioGroupBillSource: [{ type: ViewChild, args: ["radioGroupBillSource",] }]
    };
    return CallActivitySubProcess2Component;
}());
export { CallActivitySubProcess2Component };
if (false) {
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.cls;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.editorParams;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.closeModal;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.submitModal;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.modalFooter;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.modalConfig;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.callActivitySubProcess;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.groupIcon;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.subProcessType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.billSourceType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupProcessType;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupProcessTypeData;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupBillSource;
    /** @type {?} */
    CallActivitySubProcess2Component.prototype.radioGroupBillSourceData;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.message;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.util;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.http;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.designerState;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    CallActivitySubProcess2Component.prototype.inj;
}
var CallActivitySubProcess2Converter = /** @class */ (function () {
    function CallActivitySubProcess2Converter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    CallActivitySubProcess2Converter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && (data.calledBizDefKey || data.calledElement)) {
            return '（已设置）';
        }
        return '（未设置）';
    };
    return CallActivitySubProcess2Converter;
}());
export { CallActivitySubProcess2Converter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsbC1hY3Rpdml0eS1zdWItcHJvY2VzczIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzMi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzMi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV4SixPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwrREFBK0QsQ0FBQztBQUN2RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQzdELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFdEUsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFN0QsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sc0ZBQXNGLENBQUM7QUFDaEksT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFDN0UsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDZDQUE2QyxDQUFDO0FBRTdFO0lBMkZFLDBD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Qyx1Q0FBQztDQUFBLEFBclVELElBcVVDO1NBalVZLGdDQUFnQzs7O0lBQzNDLCtDQUNxQzs7SUFFckMsd0RBRU87O0lBNEJQLHNEQUErQzs7SUFDL0MsdURBQWdEOztJQUVoRCx1REFBNkQ7O0lBQzdELHVEQUtFOztJQUVGLGtFQUE4RTs7SUFFOUUscURBQW1EOztJQUVuRCwwREFBeUM7O0lBQ3pDLDBEQUF5Qzs7SUFzQnpDLGlFQUNpRDs7SUFDakQscUVBR0U7O0lBRUYsZ0VBQ2dEOztJQUNoRCxvRUFJRTs7Ozs7SUFHQSxrREFBNkI7Ozs7O0lBQzdCLHdEQUFvQzs7Ozs7SUFDcEMsbURBQWdDOzs7OztJQUNoQyxnREFBMkI7Ozs7O0lBQzNCLGdEQUF5Qjs7Ozs7SUFDekIseURBQTZDOzs7OztJQUM3QyxnREFBK0I7Ozs7O0lBQy9CLCtDQUFxQzs7Ozs7SUFDckMsK0NBQXFCOztBQW9PekI7SUFDRTtJQUFnQixDQUFDOzs7OztJQUVqQixvREFBUzs7OztJQUFULFVBQVUsSUFBUztRQUNqQixJQUFJLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQ3hELE9BQU8sT0FBTyxDQUFDO1NBQ2hCO1FBQ0QsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztJQUNILHVDQUFDO0FBQUQsQ0FBQyxBQVRELElBU0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBJbmplY3RvciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy91aS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MgfSBmcm9tICcuLi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzL2NhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MuZW50aXR5JztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgSHR0cFNlcnZpY2UgfSBmcm9tICdAZWNwLWNhZi9jYWYtY29tbW9uJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IEV4cHJlc3Npb25TZXJ2aWNlLCBJbmplY3RlZFR5cGUgfSBmcm9tICdAZ3NwLXN2Yy9leHByZXNzaW9uJztcclxuaW1wb3J0IHsgQ29tYm9MaXN0Q29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1jb21iby1saXN0JztcclxuaW1wb3J0IHsgRmFycmlzUmFkaW9Hcm91cENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZm9ybXMnO1xyXG5pbXBvcnQgeyBJUnRTaG93RW50aXR5IH0gZnJvbSAnLi4vLi4vYWlmLXByb2Nlc3MtbGlzdC1oZWxwL2VudGl0eS9JUnRTaG93RW50aXR5JztcclxuaW1wb3J0IHsgUHJvY2Vzc0xpc3RIZWxwQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vYWlmLXByb2Nlc3MtbGlzdC1oZWxwL2NvbXBvbmVudHMvcHJvY2Vzcy1saXN0LWhlbHAvcHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50JztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgU3ViUHJvY2Vzc1R5cGUgfSBmcm9tICcuLi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzL1N1YlByb2Nlc3NUeXBlJztcclxuaW1wb3J0IHsgQmlsbFNvdXJjZVR5cGUgfSBmcm9tICcuLi9jYWxsLWFjdGl2aXR5LXN1Yi1wcm9jZXNzL0JpbGxTb3VyY2VUeXBlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLWNhbGwtYWN0aXZpdHktc3ViLXByb2Nlc3MyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY2FsbC1hY3Rpdml0eS1zdWItcHJvY2VzczIuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ2FsbEFjdGl2aXR5U3ViUHJvY2VzczJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKVxyXG4gIGNscyA9ICdmYXJyaXMtbWFpbi1hcmVhIGZsZXgtY29sdW1uJztcclxuXHJcbiAgQElucHV0KCkgZWRpdG9yUGFyYW1zOiB7XHJcbiAgICBiaXpUeXBlSWQ/OiBzdHJpbmdcclxuICB9ID0ge307XHJcblxyXG4gIEBJbnB1dCgpIHNldCB2YWx1ZSh2OiBDYWxsQWN0aXZpdHlTdWJQcm9jZXNzKSB7XHJcbiAgICBpZiAodikge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MgPSB2O1xyXG4gICAgICAvLyDkuLrlrZDmtYHnqIvnsbvlnovotYvlgLxcclxuICAgICAgaWYgKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50ID09IG51bGwgfHwgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnQgPT0gXCJcIikge1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmS2V5ID09IG51bGwgfHwgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEJpekRlZktleSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3Muc3ViUHJvY2Vzc1R5cGUgPSBTdWJQcm9jZXNzVHlwZS5TcGVjaWZpZWQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5zdWJQcm9jZXNzVHlwZSA9IFN1YlByb2Nlc3NUeXBlLkR5bmFtaWM7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5zdWJQcm9jZXNzVHlwZSA9IFN1YlByb2Nlc3NUeXBlLlNwZWNpZmllZDtcclxuICAgICAgfVxyXG4gICAgICAvLyDkuLrljZXmja7mnaXmupDnsbvlnovotYvlgLxcclxuICAgICAgaWYgKHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID09PSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpbGxTb3VyY2VUeXBlID0gQmlsbFNvdXJjZVR5cGUuSW5oZXJpdFBhcmVudDtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdEJpekRhdGFJZCA9PT0gZmFsc2UgJiYgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpbGxTb3VyY2VUeXBlID0gQmlsbFNvdXJjZVR5cGUuVmFyaWFibGVzRXhwcmVzc2lvbjtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdEJpekRhdGFJZCA9PT0gZmFsc2UgJiYgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPT09IHRydWUpIHtcclxuICAgICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYmlsbFNvdXJjZVR5cGUgPSBCaWxsU291cmNlVHlwZS5BdXRvQ3JlYXRpb247XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5nZXRQcm9jZXNzRGVmS2V5KHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50KTtcclxuICAgICAgdGhpcy5nZXRGbG93Rm9ybSh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmS2V5KTtcclxuICAgICAgdGhpcy5nZXRBaWZQcm9jZXNzTmFtZSh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYWlmUHJvY2Vzc0NvZGUpO1xyXG4gICAgfVxyXG4gIH1cclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBAVmlld0NoaWxkKCdpY29uU2VsZWN0Rm9vdGVyJykgbW9kYWxGb290ZXI6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogJ+WtkOa1geeoi+iuvue9ricsXHJcbiAgICB3aWR0aDogNDgwLFxyXG4gICAgaGVpZ2h0OiA0MDAsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIGNhbGxBY3Rpdml0eVN1YlByb2Nlc3M6IENhbGxBY3Rpdml0eVN1YlByb2Nlc3MgPSBuZXcgQ2FsbEFjdGl2aXR5U3ViUHJvY2VzcygpO1xyXG5cclxuICBncm91cEljb24gPSAnPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT4nO1xyXG5cclxuICByZWFkb25seSBzdWJQcm9jZXNzVHlwZSA9IFN1YlByb2Nlc3NUeXBlO1xyXG4gIHJlYWRvbmx5IGJpbGxTb3VyY2VUeXBlID0gQmlsbFNvdXJjZVR5cGU7XHJcbiAgLy8gQFZpZXdDaGlsZChcImNvbWJvUHJvY2Vzc1R5cGVcIilcclxuICAvLyBjb21ib1Byb2Nlc3NUeXBlOiBDb21ib0xpc3RDb21wb25lbnQ7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZUlkRmllbGQgPSBcInZhbHVlXCI7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZVZhbHVlRmllbGQgPSBcInZhbHVlXCI7XHJcbiAgLy8gY29tYm9Qcm9jZXNzVHlwZVRleHRGaWVsZCA9IFwidGV4dFwiO1xyXG4gIC8vIGNvbWJvUHJvY2Vzc1R5cGVEYXRhID0gW1xyXG4gIC8vICAgeyB2YWx1ZTogXCJTcGVjaWZpZWRcIiwgdGV4dDogXCLmjIflrprlrZDmtYHnqItcIiB9LFxyXG4gIC8vICAgeyB2YWx1ZTogXCJEeW5hbWljXCIsIHRleHQ6IFwi5Yqo5oCB5a2Q5rWB56iLXCIgfSxcclxuICAvLyBdO1xyXG5cclxuICAvLyBAVmlld0NoaWxkKFwiY29tYm9CaWxsU291cmNlXCIpXHJcbiAgLy8gY29tYm9CaWxsU291cmNlOiBDb21ib0xpc3RDb21wb25lbnQ7XHJcbiAgLy8gY29tYm9CaWxsU291cmNlSWRGaWVsZCA9IFwidmFsdWVcIjtcclxuICAvLyBjb21ib0JpbGxTb3VyY2VWYWx1ZUZpZWxkID0gXCJ2YWx1ZVwiO1xyXG4gIC8vIGNvbWJvQmlsbFNvdXJjZVRleHRGaWVsZCA9IFwidGV4dFwiO1xyXG4gIC8vIGNvbWJvQmlsbFNvdXJjZURhdGEgPSBbXHJcbiAgLy8gICB7IHZhbHVlOiBCaWxsU291cmNlVHlwZS5Jbmhlcml0UGFyZW50LCB0ZXh0OiAn5LiO54i25rWB56iL55u45ZCMJyB9LFxyXG4gIC8vICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuQXV0b0NyZWF0aW9uLCB0ZXh0OiAn6Ieq5Yqo55Sf5oiQ5LiL5ri45Y2V5o2uJyB9LFxyXG4gIC8vICAgeyB2YWx1ZTogQmlsbFNvdXJjZVR5cGUuVmFyaWFibGVzRXhwcmVzc2lvbiwgdGV4dDogJ+WPmOmHj+ihqOi+vuW8jycgfSxcclxuICAvLyBdO1xyXG5cclxuICBAVmlld0NoaWxkKFwicmFkaW9Hcm91cFByb2Nlc3NUeXBlXCIpXHJcbiAgcmFkaW9Hcm91cFByb2Nlc3NUeXBlOiBGYXJyaXNSYWRpb0dyb3VwQ29tcG9uZW50O1xyXG4gIHJhZGlvR3JvdXBQcm9jZXNzVHlwZURhdGEgPSBbXHJcbiAgICB7IHZhbHVlOiBcIlNwZWNpZmllZFwiLCBuYW1lOiBcIuaMh+WumuWtkOa1geeoi1wiIH0sXHJcbiAgICB7IHZhbHVlOiBcIkR5bmFtaWNcIiwgbmFtZTogXCLliqjmgIHlrZDmtYHnqItcIiB9LFxyXG4gIF07XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJyYWRpb0dyb3VwQmlsbFNvdXJjZVwiKVxyXG4gIHJhZGlvR3JvdXBCaWxsU291cmNlOiBGYXJyaXNSYWRpb0dyb3VwQ29tcG9uZW50O1xyXG4gIHJhZGlvR3JvdXBCaWxsU291cmNlRGF0YSA9IFtcclxuICAgIHsgdmFsdWU6IEJpbGxTb3VyY2VUeXBlLkluaGVyaXRQYXJlbnQsIG5hbWU6ICfkuI7niLbmtYHnqIvnm7jlkIwnIH0sXHJcbiAgICB7IHZhbHVlOiBCaWxsU291cmNlVHlwZS5BdXRvQ3JlYXRpb24sIG5hbWU6ICfoh6rliqjnlJ/miJDkuIvmuLjljZXmja4nIH0sXHJcbiAgICB7IHZhbHVlOiBCaWxsU291cmNlVHlwZS5WYXJpYWJsZXNFeHByZXNzaW9uLCBuYW1lOiAn5Y+Y6YeP6KGo6L6+5byPJyB9LFxyXG4gIF07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgdXRpbDogUHJvY2Vzc0RlVXRpbCxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGRlc2lnbmVyU3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIGV4cHI6IEV4cHJlc3Npb25TZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBjZnI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgaW5qOiBJbmplY3RvcixcclxuICApIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICB9XHJcblxyXG5cclxuICBjbGlja09LKCkge1xyXG4gICAgaWYgKHRoaXMudmFsaWRhdG9yKCkpIHtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgcHJvY2Vzc0NvbmZpcm0oYXJnczogYW55KSB7XHJcbiAgICBpZiAoYXJncykge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkRWxlbWVudCA9IGFyZ3MuaWQ7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50TmFtZSA9IGFyZ3MubmFtZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb2Nlc3NUeXBlQ2hhbmdlKHZhbCkge1xyXG4gICAgY29uc29sZS5sb2codmFsKTtcclxuICAgIGlmICh2YWwgPT0gU3ViUHJvY2Vzc1R5cGUuU3BlY2lmaWVkKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZLZXkgPSBudWxsO1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmTmFtZSA9IG51bGw7XHJcbiAgICB9IGVsc2UgaWYgKHZhbCA9PSBTdWJQcm9jZXNzVHlwZS5EeW5hbWljKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRFbGVtZW50ID0gbnVsbDtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnROYW1lID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGJpbGxTb3VyY2VDaGFuZ2UodmFsKSB7XHJcbiAgICBjb25zb2xlLmxvZyh2YWwpO1xyXG4gICAgaWYgKHZhbCA9PSBCaWxsU291cmNlVHlwZS5Jbmhlcml0UGFyZW50KSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID0gdHJ1ZTtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLnVzZUF1dG9DcmVhdGlvbkRhdGEgPSBmYWxzZTtcclxuICAgIH0gZWxzZSBpZiAodmFsID09IEJpbGxTb3VyY2VUeXBlLkF1dG9DcmVhdGlvbikge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuaW5oZXJpdEJpekRhdGFJZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MudXNlQXV0b0NyZWF0aW9uRGF0YSA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKHZhbCA9PSBCaWxsU291cmNlVHlwZS5WYXJpYWJsZXNFeHByZXNzaW9uKSB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5pbmhlcml0Qml6RGF0YUlkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy51c2VBdXRvQ3JlYXRpb25EYXRhID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZWxlY3RQcm9jZXNzKCkge1xyXG4gICAgdGhpcy5vcGVuUHJvY0hlbHAoKS5zdWJzY3JpYmUoXHJcbiAgICAgIChydGU6IElSdFNob3dFbnRpdHkpID0+IHtcclxuICAgICAgICBpZiAocnRlID09IG51bGwpIHtcclxuICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoXCLor7fpgInkuK3kuIDmnaHnlJ/ljZXmtYHnqItcIik7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzQ29kZSA9IHJ0ZS5jb2RlO1xyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzTmFtZSA9IHJ0ZS5uYW1lO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJQcm9jZXNzKCkge1xyXG4gICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmFpZlByb2Nlc3NDb2RlID0gbnVsbDtcclxuICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5haWZQcm9jZXNzTmFtZSA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBvcGVuUHJvY0hlbHAoKSB7XHJcbiAgICBjb25zdCBjbXBGID0gdGhpcy5jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoUHJvY2Vzc0xpc3RIZWxwQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNtcFIgPSBjbXBGLmNyZWF0ZSh0aGlzLmluaiwgW10pO1xyXG4gICAgY21wUi5pbnN0YW5jZS5lZGl0b3JQYXJhbXMgPSB0aGlzLmVkaXRvclBhcmFtcztcclxuICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjbXBSLCB7XHJcbiAgICAgIHRpdGxlOiBcIueUn+WNlea1geeoi1wiLFxyXG4gICAgICB3aWR0aDogMTI1MCxcclxuICAgICAgaGVpZ2h0OiA1MDAsXHJcbiAgICAgIHJlc2l6YWJsZTogdHJ1ZSxcclxuICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRleHQ6IFwi56Gu5a6aXCIsXHJcbiAgICAgICAgICBjbHM6IFwiYnRuIGJ0bi1wcmltYXJ5XCIsXHJcbiAgICAgICAgICBoYW5kbGU6IChldnQpID0+IHtcclxuICAgICAgICAgICAgY21wUi5pbnN0YW5jZS5jbGlja09rKGV2dCk7XHJcbiAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0ZXh0OiBcIuWPlua2iFwiLFxyXG4gICAgICAgICAgY2xzOiBcImJ0biBidG4tc2Vjb25kYXJ5XCIsXHJcbiAgICAgICAgICBoYW5kbGU6IChldnQpID0+IHtcclxuICAgICAgICAgICAgY21wUi5pbnN0YW5jZS5jbGlja0NhbmNlbChldnQpO1xyXG4gICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgY2xvc2VkOiAoKSA9PiB7XHJcbiAgICAgICAgbW9kYWxSZWYuZGlhbG9nLmRlc3Ryb3koKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBjbXBSLmluc3RhbmNlLm1vZGFsUmVmID0gbW9kYWxSZWY7XHJcblxyXG4gICAgcmV0dXJuIGNtcFIuaW5zdGFuY2UucHJvY0VtaXR0ZXIuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICBjbGVhclByb2Nlc3NEZWYoYXJnczogYW55KSB7XHJcbiAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkRWxlbWVudCA9ICcnO1xyXG4gICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnROYW1lID0gJyc7XHJcbiAgfVxyXG5cclxuICBmbG93Rm9ybUNvbmZpcm0oYXJnczogYW55KSB7XHJcbiAgICBpZiAoYXJncykge1xyXG4gICAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmS2V5ID0gYXJncy5pZDtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEJpekRlZk5hbWUgPSBhcmdzLm5hbWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNsZWFyRmxvd0Zvcm0oYXJnczogYW55KSB7XHJcbiAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmS2V5ID0gJyc7XHJcbiAgICB0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuY2FsbGVkQml6RGVmTmFtZSA9ICcnO1xyXG4gIH1cclxuXHJcbiAgc2V0Qml6RGF0YUlkKCkge1xyXG4gICAgdGhpcy5zaG93RXhwckhlbHAoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2hvd0V4cHJIZWxwKCkge1xyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBzY2hlbWEgb2YgdGhpcy5kZXNpZ25lclN0YXRlLnNjaGVtYXMpIHtcclxuICAgICAgICB0aGlzLmV4cHIuYWRkU2NoZW1hKCdTY2hlbWEnLCBzY2hlbWEpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmRlc2lnbmVyU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlcyAmJiB0aGlzLmRlc2lnbmVyU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZGVzaWduZXJTdGF0ZS5zY2hlbWFzWzBdLmVudGl0eVR5cGVzWzBdO1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRJbmplY3RlZEVudGl0eShlbnRpdHlUeXBlLm5hbWUsICdTY2hlbWEnLFxyXG4gICAgICAgICAgZW50aXR5VHlwZS5uYW1lLCBJbmplY3RlZFR5cGUuRW50aXR5VHlwZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGNvbnRleHQgPSBuZXcgQXJyYXkoKTtcclxuICAgIGlmICh0aGlzLmRlc2lnbmVyU3RhdGUucHJvY0luc3RDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyU3RhdGUucHJvY0luc3RDb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICAvLyB0aGlzLmV4cHIuYWRkQ29udGV4dCh2YXJpYWJsZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyU3RhdGUuZm9ybWFsUGFyYW1ldGVyQ29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclN0YXRlLmZvcm1hbFBhcmFtZXRlckNvbnRleHQpIHtcclxuICAgICAgICBpZiAoIWNvbnRleHQuc29tZShjID0+IGMua2V5ID09PSB2YXJpYWJsZS5rZXkpKSB7XHJcbiAgICAgICAgICBjb250ZXh0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmV4cHIuYWRkQ29udGV4dCh2YXJpYWJsZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyU3RhdGUucGFydGljaXBhbnRDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyU3RhdGUucGFydGljaXBhbnRDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdGhpcy5leHByLmFkZENvbnRleHQodmFyaWFibGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5kZXNpZ25lclN0YXRlLnByb2Nlc3NWYXJpYWJsZUNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJTdGF0ZS5wcm9jZXNzVmFyaWFibGVDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdGhpcy5leHByLmFkZENvbnRleHQodmFyaWFibGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dCh0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYml6RGF0YUlkKTtcclxuICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oKS50aGVuKChleHByZXNzaW9uaW5mbzogc3RyaW5nKSA9PiB7XHJcbiAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5iaXpEYXRhSWQgPSBleHByZXNzaW9uaW5mbztcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdmFsdWVDaGFuZ2UoYm9vbDogYm9vbGVhbikge1xyXG4gICAgaWYgKGJvb2wpIHtcclxuICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmJpekRhdGFJZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRvcigpOiBib29sZWFuIHtcclxuICAgIGlmICghdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmluaGVyaXRCaXpEYXRhSWQgJiYgIXRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy51c2VBdXRvQ3JlYXRpb25EYXRhICYmICF0aGlzLmNhbGxBY3Rpdml0eVN1YlByb2Nlc3MuYml6RGF0YUlkKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS53YXJuaW5nKCflvZPlrZDmtYHnqIvkuI7niLbmtYHnqIvljZXmja7kuI3kuIDoh7Tml7bvvIzor7forr7nva7lrZDmtYHnqIvljZXmja7lhoXnoIHvvIEnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFByb2Nlc3NEZWZLZXkoa2V5OiBzdHJpbmcpIHtcclxuICAgIGxldCB1cmwgPSB0aGlzLnV0aWwuZ2V0UHJvY0RlZktleVdlYkFwaSgpO1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICB1cmwgKz0gYC8ke2tleX1gO1xyXG4gICAgICB0aGlzLmh0dHAuZ2V0KHVybCkuc3Vic2NyaWJlKChyZTogYW55KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmNhbGxlZEVsZW1lbnROYW1lID0gcmUubmFtZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgZ2V0Rmxvd0Zvcm0oaWQ6IHN0cmluZykge1xyXG4gICAgbGV0IHVybCA9IHRoaXMudXRpbC5nZXRGbG93Rm9ybVdlYkFwaSgpO1xyXG4gICAgaWYgKGlkKSB7XHJcbiAgICAgIHVybCArPSBgLyR7aWR9YDtcclxuICAgICAgdGhpcy5odHRwLmdldCh1cmwpLnN1YnNjcmliZSgocmU6IGFueSkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2FsbEFjdGl2aXR5U3ViUHJvY2Vzcy5jYWxsZWRCaXpEZWZOYW1lID0gcmUubmFtZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRBaWZQcm9jZXNzTmFtZShjb2RlOiBzdHJpbmcpIHtcclxuICAgIGlmIChjb2RlICE9IG51bGwgJiYgY29kZSAhPSBcIlwiKSB7XHJcbiAgICAgIHRoaXMuaHR0cC5yZXF1ZXN0KFwiR0VUXCIsIGAvYXBpL3J1bnRpbWUvYWlmL3YxLjAvcnRiaWxsY3JlYXRpb25wcm9jZXNzL2dldG5hbWUvJHtjb2RlfWAsIHsgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSkuc3Vic2NyaWJlKFxyXG4gICAgICAgIChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jYWxsQWN0aXZpdHlTdWJQcm9jZXNzLmFpZlByb2Nlc3NOYW1lID0gcmVzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vdG9kbyDnoa7lrprlvILluLjnu5PmnoQsIOebruWJjemHh+eUqOWFvOWuueWPluWAvOaWueW8j1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQ2FsbEFjdGl2aXR5U3ViUHJvY2VzczJDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBjb252ZXJ0VG8oZGF0YTogYW55KTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIChkYXRhLmNhbGxlZEJpekRlZktleSB8fCBkYXRhLmNhbGxlZEVsZW1lbnQpKSB7XHJcbiAgICAgIHJldHVybiAn77yI5bey6K6+572u77yJJztcclxuICAgIH1cclxuICAgIHJldHVybiAn77yI5pyq6K6+572u77yJJztcclxuICB9XHJcbn1cclxuIl19