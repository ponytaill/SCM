/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef } from '@angular/core';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { DialogComponent } from '@farris/ui-dialog';
import { MessagerService } from '@farris/ui-messager';
import { DatagridComponent } from '@farris/ui-datagrid';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
export class JumpScopeComponent {
    /**
     * @param {?} uistate
     * @param {?} message
     */
    constructor(uistate, message) {
        this.uistate = uistate;
        this.message = message;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: '目标节点选项',
            width: 520,
            height: 460,
            showButtons: true
        };
        this.cols = [
            { title: '名称', field: 'Name', width: 60, searchField: 'Name' },
            { title: 'ID', field: 'Id', width: 90, searchField: 'Id' }
        ];
        // ==========================================================
        this.actis = [];
        this.fullActis = [];
        this.defaultacty = '';
        this.categoryListItems = [
            { value: 'OutConnectNode', name: '流程图连线节点' },
            { value: 'Global', name: '流程内所有节点' },
            { value: 'AfterNodes', name: '所有后继节点' },
            { value: 'SpecifiedSet', name: '流程图连线节点+附加节点' }
        ];
        this.category = '';
        this.defaultType = '';
        this.defaultTypeListItems = [
            { value: 'FirstNode', name: '条件为true的连线节点，当有多条时默认选中首条' },
            { value: 'NullNode', name: '默认为空，每次都手动选择' },
            { value: 'SpecifyNode', name: '指定默认节点' }
        ];
        this.defaultActivity = '';
        this.pageInfo = {
            pageIndex: 1,
            pageList: [10, 20, 30, 50],
            pageSize: 20
        };
        this.actisSelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        (rowData) => {
            // 附加节点的帮助后事件，把选中的数据赋给fullActis（此处处理的目的是为了显示Name同时取Id值）
            // console.log(rowData);
            this.fullActis = rowData;
            return of({
                closeDialog: true
            });
        });
        this.defaultActivitySelect = (/**
         * @param {?} rowData
         * @return {?}
         */
        (rowData) => {
            // 默认节点的帮助后事件，把选中的id赋给defaultActivity（此处处理的目的是为了显示Name同时取Id值）
            this.defaultActivity = rowData.Id;
            return of({
                closeDialog: true
            });
        });
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set value(data) {
        if (data) {
            this.category = data.Category;
            this.defaultType = data.DefaultType;
            // 取到DefaultActivity的节点Id，遍历出Name绑定到radiogroup上去（defaultacty）
            /** @type {?} */
            const acty = data.DefaultActivity;
            if (acty != null) {
                for (const act of this.uistate.allActList) {
                    if (act.Id === acty) {
                        this.defaultacty = act.Name;
                    }
                }
            }
            // 取到DestinationActivities的节点Id，遍历出Id和Name绑定到radiogroup上去（actis）
            /** @type {?} */
            const strs = data.DestinationActivities;
            if (strs && strs.length > 0) {
                for (const str of strs) {
                    /** @type {?} */
                    const name = this.uistate.userActList.filter((/**
                     * @param {?} act
                     * @return {?}
                     */
                    act => act.Id === str))[0].Name;
                    // const acti = { Id: str, Name: name };
                    this.actis.push(name);
                }
            }
        }
        else {
            this.category = 'OutConnectNode';
            this.defaultType = 'FirstNode';
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    clickOK() {
        if (this.validator()) {
            /** @type {?} */
            let value;
            /** @type {?} */
            const list = [];
            // 重新打开设置界面，没有进行节点配置的情况（DefaultActivity）
            if (this.defaultActivity === '' && this.defaultacty !== '') {
                for (const defAct of this.uistate.allActList) {
                    if (defAct.Name === this.defaultacty) {
                        this.defaultActivity = defAct.Id;
                    }
                }
            }
            // 重新打开设置界面，没有进行节点配置的情况（DestinationActivities）
            if (this.fullActis.length === 0 && this.actis.length > 0) {
                for (const act of this.actis) {
                    for (const allAct of this.uistate.userActList) {
                        if (act === allAct.Name) {
                            list.push(allAct.Id);
                        }
                    }
                }
            }
            else if (this.category === 'SpecifiedSet' && this.fullActis && this.fullActis.length > 0) {
                // 附加节点的id传给模型上的DestinationActivities
                this.fullActis.forEach((/**
                 * @param {?} act
                 * @return {?}
                 */
                act => list.push(act.Id)));
            }
            value = {
                Category: this.category,
                DefaultType: this.defaultType,
                DefaultActivity: this.defaultActivity,
                DestinationActivities: list,
            };
            /** @type {?} */
            const object = { value, parameters: null };
            this.submitModal.emit(object);
        }
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @private
     * @return {?}
     */
    validator() {
        if (!this.category) {
            this.message.warning('尚未设置目标节点选项，请了解！');
            return false;
        }
        // if (this.category === 'SpecifiedSet' && Object.prototype.isPrototypeOf(this.actis)) {
        //   this.message.info('尚未选择附加节点，请了解！');
        //   return false;
        // }
        if (this.defaultType === 'SpecifyNode' && this.defaultacty === '') {
            this.message.warning('尚未指定默认节点，请了解！');
            return false;
        }
        return true;
    }
    /**
     * @return {?}
     */
    deleteRow() {
        if (this.actTable.selectedRow && this.actTable.selectedRow.data) {
            /** @type {?} */
            const i = this.actis.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            d => d.id === this.actTable.selectedRow.data.id));
            this.actis.splice(i, 1);
            this.actTable.loadData(this.actis);
        }
        else {
            this.message.info('请首先选中一条选项！');
        }
    }
}
JumpScopeComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-jump-scope',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-utils-fill-flex-column farris-split-section m-2 h-100\">\r\n    <section class=\"f-utils-fill-flex-column h-100\">\r\n      <div class=\"f-utils-fill-flex-column h-100\">\r\n        <form class=\"h-100\">\r\n          <div class=\"f-utils-fill-flex-column h-100\">\r\n            <!-- \u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9\u5355\u9009\u9879 -->\r\n            <!-- <div class=\"mx-4 mt-3 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group farris-form-group\">\r\n                  <div class=\"farris-input-wrap\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                      <input class=\"custom-control-input\" name=\"submitterAutoPass\" type=\"checkbox\"\r\n                        id=\"submitterAutoPass\" [(ngModel)]=\"outConnectNode\" />\r\n                      <label class=\"custom-control-label\" for=\"submitterAutoPass\">\u5141\u8BB8\u9009\u62E9\u76EE\u6807\u8282\u70B9</label>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div> -->\r\n            <!-- \u53EF\u9009\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u53EF\u9009\u8282\u70B9</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684category\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"category\" [data]=\"categoryListItems\" name=\"category\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9644\u52A0\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #userActisDialog\r\n                  [items]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id \" [columns]=\"cols\"\r\n                  [disabled]=\"!(category === 'SpecifiedSet')\" [resizable]=\"true\" [singleSelect]=\"false\" [idField]=\"'Id'\"\r\n                  [textField]=\"'Name'\" [(ngModel)]=\"actis\" [valueField]=\"'Id'\" [pagination]=\"true\"\r\n                  [pageIndex]=\"pageInfo.pageIndex\" name=\"defaultActivities\" [pageSize]=\"pageInfo.pageSize\"\r\n                  [pageList]=\"pageInfo.pageList\" [total]=\"total\" [enableClear]=\"false\" [title]=\"'\u9644\u52A0\u8282\u70B9\u5217\u8868'\"\r\n                  [displayType]=\"'List'\" [remoteSearch]='false' [enableToSelect]=\"false\" [placeholder]=\"'\u8BF7\u9009\u62E9\u9644\u52A0\u8282\u70B9'\" [dictPicked]=\"actisSelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n            <!-- \u9ED8\u8BA4\u8282\u70B9\u5C0F\u6807\u9898 -->\r\n            <div class=\"mx-2 mt-1\">\r\n              <div class=\"title-content\">\r\n                <h4 class=\"title-text\">\u9ED8\u8BA4\u8282\u70B9</h4><span class=\"title-line\"></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-2 mx-4 farris-form-controls-inline\">\r\n              <div class=\"farris-group-wrap\">\r\n                <div class=\"form-group\">\r\n                  <!-- \u7AD6\u5217\u679A\u4E3E\u7684DefaultType\u9009\u9879 -->\r\n                  <farris-radiogroup [(ngModel)]=\"defaultType\" [data]=\"defaultTypeListItems\" name=\"defaultType\"\r\n                    [horizontal]=false>\r\n                  </farris-radiogroup>\r\n                </div>\r\n                <!-- \u9ED8\u8BA4\u8282\u70B9\u5E2E\u52A9 -->\r\n                <farris-lookup-grid #allActisTable [items]=\"uistate.allActList | jumpScopePipe:uistate.propertyData.Id \"\r\n                  [columns]=\"cols\" [disabled]=\"!(defaultType === 'SpecifyNode')\" [resizable]=\"true\"\r\n                  [singleSelect]=\"true\" [idField]=\"'Id'\" [textField]=\"'Name'\" [(ngModel)]=\"defaultacty\"\r\n                  [valueField]=\"'Id'\" [pagination]=\"true\" [placeholder]=\"'\u8BF7\u9009\u62E9\u9ED8\u8BA4\u8282\u70B9'\" [pageIndex]=\"pageInfo.pageIndex\"\r\n                  name=\"defaultActivity\" [pageSize]=\"pageInfo.pageSize\" [pageList]=\"pageInfo.pageList\" [total]=\"total\"\r\n                  [enableClear]=\"false\" [title]=\"'\u9ED8\u8BA4\u8282\u70B9\u5217\u8868'\" [displayType]=\"'List'\" [remoteSearch]='false' [dictPicked]=\"defaultActivitySelect\">\r\n                </farris-lookup-grid>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<!-- <ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary mx-2\" (click)=\"actisSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"allActisDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template> -->\r\n<!-- <farris-dialog #allActisDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" [title]=\"'\u6D3B\u52A8\u5217\u8868'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #allActisTable [columns]=\"cols\"\r\n      [data]=\"uistate.userActList | jumpScopePipe:uistate.propertyData.Id\" [idField]=\"'Id'\" [fit]=\"true\"\r\n      [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\" [showCheckbox]=\"true\" [multiSelect]=\"true\"\r\n      [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog> -->\r\n",
                styles: [".title-content{color:#000;display:inline-flex;align-items:center;line-height:1.375rem;position:relative;overflow:hidden;padding:0 0 0 1rem;min-width:760px}.title-content ::before{content:'';width:.25rem;height:1.125rem;background:#59a1ff;border-radius:1px;position:absolute;top:50%;left:0;margin-top:-.5625rem}.title-text{font-size:1rem;line-height:1.375rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-bottom:0;margin-right:10px}.title-line{flex-grow:1;border-bottom:1px dashed rgba(0,0,0,.1)}"]
            }] }
];
/** @nocollapse */
JumpScopeComponent.ctorParameters = () => [
    { type: ProcessDesignerUIState },
    { type: MessagerService }
];
JumpScopeComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    allActisTable: [{ type: ViewChild, args: ['allActisTable',] }],
    allActisDialog: [{ type: ViewChild, args: ['allActisDialog',] }],
    actTable: [{ type: ViewChild, args: ['actTable',] }],
    lookup: [{ type: ViewChild, args: ['lookup',] }]
};
if (false) {
    /** @type {?} */
    JumpScopeComponent.prototype.cls;
    /** @type {?} */
    JumpScopeComponent.prototype.closeModal;
    /** @type {?} */
    JumpScopeComponent.prototype.submitModal;
    /** @type {?} */
    JumpScopeComponent.prototype.modalFooter;
    /** @type {?} */
    JumpScopeComponent.prototype.modalConfig;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisTable;
    /** @type {?} */
    JumpScopeComponent.prototype.allActisDialog;
    /** @type {?} */
    JumpScopeComponent.prototype.actTable;
    /** @type {?} */
    JumpScopeComponent.prototype.lookup;
    /** @type {?} */
    JumpScopeComponent.prototype.cols;
    /** @type {?} */
    JumpScopeComponent.prototype.actis;
    /** @type {?} */
    JumpScopeComponent.prototype.fullActis;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultacty;
    /** @type {?} */
    JumpScopeComponent.prototype.categoryListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.category;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultType;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultTypeListItems;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivity;
    /** @type {?} */
    JumpScopeComponent.prototype.pageInfo;
    /** @type {?} */
    JumpScopeComponent.prototype.outConnectNode;
    /** @type {?} */
    JumpScopeComponent.prototype.total;
    /** @type {?} */
    JumpScopeComponent.prototype.actisSelect;
    /** @type {?} */
    JumpScopeComponent.prototype.defaultActivitySelect;
    /** @type {?} */
    JumpScopeComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    JumpScopeComponent.prototype.message;
}
export class JumpScopeConverter {
    constructor() { }
    /**
     * @param {?} data
     * @return {?}
     */
    convertTo(data) {
        if (data) {
            return '（已设置）';
        }
        return '（未设置）';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianVtcC1zY29wZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL2p1bXAtc2NvcGUvanVtcC1zY29wZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFcEgsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsbUJBQW1CLEVBQWdCLE1BQU0sbUJBQW1CLENBQUM7QUFDdEUsT0FBTyxFQUFjLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQU90QyxNQUFNLE9BQU8sa0JBQWtCOzs7OztJQTJFN0IsWUFDUyxPQUErQixFQUM5QixPQUF3QjtRQUR6QixZQUFPLEdBQVAsT0FBTyxDQUF3QjtRQUM5QixZQUFPLEdBQVAsT0FBTyxDQUFpQjtRQTNFbEMsUUFBRyxHQUFHLDhCQUE4QixDQUFDO1FBRTNCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3JDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQWdDaEQsZ0JBQVcsR0FBRztZQUNaLEtBQUssRUFBRSxRQUFRO1lBQ2YsS0FBSyxFQUFFLEdBQUc7WUFDVixNQUFNLEVBQUUsR0FBRztZQUNYLFdBQVcsRUFBRSxJQUFJO1NBQ2xCLENBQUM7UUFPRixTQUFJLEdBQUc7WUFDTCxFQUFFLEtBQUssRUFBRSxJ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dUNBQWU7O0lBQ2YseUNBQWlCOztJQUNqQiwrQ0FJbUQ7O0lBQ25ELHNDQUFjOztJQUNkLHlDQUFpQjs7SUFDakIsa0RBRzRDOztJQUM1Qyw2Q0FBcUI7O0lBQ3JCLHNDQUlFOztJQUNGLDRDQUFxQjs7SUFDckIsbUNBQWM7O0lBZ0VkLHlDQU9DOztJQUVELG1EQU1DOztJQTdFQyxxQ0FBc0M7Ozs7O0lBQ3RDLHFDQUFnQzs7QUF3RnBDLE1BQU0sT0FBTyxrQkFBa0I7SUFDN0IsZ0JBQWdCLENBQUM7Ozs7O0lBRWpCLFNBQVMsQ0FBQyxJQUFTO1FBQ2pCLElBQUksSUFBSSxFQUFFO1lBQ1IsT0FBTyxPQUFPLENBQUM7U0FDaEI7UUFDRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy91aS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUgfSBmcm9tICcuLi8uLi9hcHAvcHJvY2Vzcy1kZXNpZ25lci51aXN0YXRlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgTG9va3VwR3JpZENvbXBvbmVudCwgUGlja2VkUmVzdWx0IH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtanVtcC1zY29wZScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2p1bXAtc2NvcGUuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2p1bXAtc2NvcGUuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBKdW1wU2NvcGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKVxyXG4gIGNscyA9ICdmYXJyaXMtbWFpbi1hcmVhIGZsZXgtY29sdW1uJztcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsdWUoZGF0YTogYW55KSB7XHJcbiAgICBpZiAoZGF0YSkge1xyXG4gICAgICB0aGlzLmNhdGVnb3J5ID0gZGF0YS5DYXRlZ29yeTtcclxuICAgICAgdGhpcy5kZWZhdWx0VHlwZSA9IGRhdGEuRGVmYXVsdFR5cGU7XHJcbiAgICAgIC8vIOWPluWIsERlZmF1bHRBY3Rpdml0eeeahOiKgueCuUlk77yM6YGN5Y6G5Ye6TmFtZee7keWumuWIsHJhZGlvZ3JvdXDkuIrljrvvvIhkZWZhdWx0YWN0ee+8iVxyXG4gICAgICBjb25zdCBhY3R5OiBzdHJpbmcgPSBkYXRhLkRlZmF1bHRBY3Rpdml0eTtcclxuICAgICAgaWYgKGFjdHkgIT0gbnVsbCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgYWN0IG9mIHRoaXMudWlzdGF0ZS5hbGxBY3RMaXN0KSB7XHJcbiAgICAgICAgICBpZiAoYWN0LklkID09PSBhY3R5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdGFjdHkgPSBhY3QuTmFtZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8g5Y+W5YiwRGVzdGluYXRpb25BY3Rpdml0aWVz55qE6IqC54K5SWTvvIzpgY3ljoblh7pJZOWSjE5hbWXnu5HlrprliLByYWRpb2dyb3Vw5LiK5Y6777yIYWN0aXPvvIlcclxuICAgICAgY29uc3Qgc3Ryczogc3RyaW5nW10gPSBkYXRhLkRlc3RpbmF0aW9uQWN0aXZpdGllcztcclxuICAgICAgaWYgKHN0cnMgJiYgc3Rycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBzdHIgb2Ygc3Rycykge1xyXG4gICAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMudWlzdGF0ZS51c2VyQWN0TGlzdC5maWx0ZXIoYWN0ID0+IGFjdC5JZCA9PT0gc3RyKVswXS5OYW1lO1xyXG4gICAgICAgICAgLy8gY29uc3QgYWN0aSA9IHsgSWQ6IHN0ciwgTmFtZTogbmFtZSB9O1xyXG4gICAgICAgICAgdGhpcy5hY3Rpcy5wdXNoKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jYXRlZ29yeSA9ICdPdXRDb25uZWN0Tm9kZSc7XHJcbiAgICAgIHRoaXMuZGVmYXVsdFR5cGUgPSAnRmlyc3ROb2RlJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn55uu5qCH6IqC54K56YCJ6aG5JyxcclxuICAgIHdpZHRoOiA1MjAsXHJcbiAgICBoZWlnaHQ6IDQ2MCxcclxuICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgfTtcclxuICAvLyDmtLvliqjoioLngrnooajkv6Hmga89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIEBWaWV3Q2hpbGQoJ2FsbEFjdGlzVGFibGUnKSBhbGxBY3Rpc1RhYmxlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdhbGxBY3Rpc0RpYWxvZycpIGFsbEFjdGlzRGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYWN0VGFibGUnKSBhY3RUYWJsZTogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnbG9va3VwJykgbG9va3VwOiBMb29rdXBHcmlkQ29tcG9uZW50O1xyXG5cclxuICBjb2xzID0gW1xyXG4gICAgeyB0aXRsZTogJ+WQjeensCcsIGZpZWxkOiAnTmFtZScsIHdpZHRoOiA2MCwgc2VhcmNoRmllbGQ6ICdOYW1lJyB9LFxyXG4gICAgeyB0aXRsZTogJ0lEJywgZmllbGQ6ICdJZCcsIHdpZHRoOiA5MCwgc2VhcmNoRmllbGQ6ICdJZCcgfV07XHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIGFjdGlzID0gW107XHJcbiAgZnVsbEFjdGlzID0gW107XHJcbiAgZGVmYXVsdGFjdHkgPSAnJztcclxuICBjYXRlZ29yeUxpc3RJdGVtcyA9IFtcclxuICAgIHsgdmFsdWU6ICdPdXRDb25uZWN0Tm9kZScsIG5hbWU6ICfmtYHnqIvlm77ov57nur/oioLngrknfSxcclxuICAgIHsgdmFsdWU6ICdHbG9iYWwnLCBuYW1lOiAn5rWB56iL5YaF5omA5pyJ6IqC54K5J30sXHJcbiAgICB7IHZhbHVlOiAnQWZ0ZXJOb2RlcycsIG5hbWU6ICfmiYDmnInlkI7nu6foioLngrknfSxcclxuICAgIHsgdmFsdWU6ICdTcGVjaWZpZWRTZXQnLCBuYW1lOiAn5rWB56iL5Zu+6L+e57q/6IqC54K5K+mZhOWKoOiKgueCuScgfV07XHJcbiAgY2F0ZWdvcnkgPSAnJztcclxuICBkZWZhdWx0VHlwZSA9ICcnO1xyXG4gIGRlZmF1bHRUeXBlTGlzdEl0ZW1zID0gW1xyXG4gICAgeyB2YWx1ZTogJ0ZpcnN0Tm9kZScsIG5hbWU6ICfmnaHku7bkuLp0cnVl55qE6L+e57q/6IqC54K577yM5b2T5pyJ5aSa5p2h5pe26buY6K6k6YCJ5Lit6aaW5p2hJ30sXHJcbiAgICB7IHZhbHVlOiAnTnVsbE5vZGUnLCBuYW1lOiAn6buY6K6k5Li656m677yM5q+P5qyh6YO95omL5Yqo6YCJ5oupJ30sXHJcbiAgICB7IHZhbHVlOiAnU3BlY2lmeU5vZGUnLCBuYW1lOiAn5oyH5a6a6buY6K6k6IqC54K5JyB9XTtcclxuICBkZWZhdWx0QWN0aXZpdHkgPSAnJztcclxuICBwYWdlSW5mbyA9IHtcclxuICAgIHBhZ2VJbmRleDogMSxcclxuICAgIHBhZ2VMaXN0OiBbMTAsIDIwLCAzMCwgNTBdLFxyXG4gICAgcGFnZVNpemU6IDIwXHJcbiAgfTtcclxuICBvdXRDb25uZWN0Tm9kZTogdHJ1ZTtcclxuICB0b3RhbDogbnVtYmVyO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHVpc3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGlmICh0aGlzLnZhbGlkYXRvcigpKSB7XHJcbiAgICAgIGxldCB2YWx1ZTtcclxuICAgICAgY29uc3QgbGlzdCA9IFtdO1xyXG4gICAgICAvLyDph43mlrDmiZPlvIDorr7nva7nlYzpnaLvvIzmsqHmnInov5vooYzoioLngrnphY3nva7nmoTmg4XlhrXvvIhEZWZhdWx0QWN0aXZpdHnvvIlcclxuICAgICAgaWYgKCB0aGlzLmRlZmF1bHRBY3Rpdml0eSA9PT0gJycgJiYgdGhpcy5kZWZhdWx0YWN0eSAhPT0gJycpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGRlZkFjdCBvZiB0aGlzLnVpc3RhdGUuYWxsQWN0TGlzdCkge1xyXG4gICAgICAgICAgaWYgKGRlZkFjdC5OYW1lID09PSB0aGlzLmRlZmF1bHRhY3R5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdEFjdGl2aXR5ID0gZGVmQWN0LklkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyDph43mlrDmiZPlvIDorr7nva7nlYzpnaLvvIzmsqHmnInov5vooYzoioLngrnphY3nva7nmoTmg4XlhrXvvIhEZXN0aW5hdGlvbkFjdGl2aXRpZXPvvIlcclxuICAgICAgaWYgKHRoaXMuZnVsbEFjdGlzLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmFjdGlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGFjdCBvZiB0aGlzLmFjdGlzKSB7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGFsbEFjdCBvZiB0aGlzLnVpc3RhdGUudXNlckFjdExpc3QpIHtcclxuICAgICAgICAgICAgaWYgKGFjdCA9PT0gYWxsQWN0Lk5hbWUpIHtcclxuICAgICAgICAgICAgICBsaXN0LnB1c2goYWxsQWN0LklkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNhdGVnb3J5ID09PSAnU3BlY2lmaWVkU2V0JyAmJiB0aGlzLmZ1bGxBY3RpcyAmJiB0aGlzLmZ1bGxBY3Rpcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8g6ZmE5Yqg6IqC54K555qEaWTkvKDnu5nmqKHlnovkuIrnmoREZXN0aW5hdGlvbkFjdGl2aXRpZXNcclxuICAgICAgICB0aGlzLmZ1bGxBY3Rpcy5mb3JFYWNoKGFjdCA9PiBsaXN0LnB1c2goYWN0LklkKSk7XHJcbiAgICAgIH1cclxuICAgICAgdmFsdWUgPSB7XHJcbiAgICAgICAgQ2F0ZWdvcnk6IHRoaXMuY2F0ZWdvcnksXHJcbiAgICAgICAgRGVmYXVsdFR5cGU6IHRoaXMuZGVmYXVsdFR5cGUsXHJcbiAgICAgICAgRGVmYXVsdEFjdGl2aXR5OiB0aGlzLmRlZmF1bHRBY3Rpdml0eSxcclxuICAgICAgICBEZXN0aW5hdGlvbkFjdGl2aXRpZXM6IGxpc3QsXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWUsIHBhcmFtZXRlcnM6IG51bGwgfTtcclxuICAgICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KG9iamVjdCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjbGlja0NhbmNlbCgpIHtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRvcigpOiBib29sZWFuIHtcclxuICAgIGlmICghdGhpcy5jYXRlZ29yeSkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZygn5bCa5pyq6K6+572u55uu5qCH6IqC54K56YCJ6aG577yM6K+35LqG6Kej77yBJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIGlmICh0aGlzLmNhdGVnb3J5ID09PSAnU3BlY2lmaWVkU2V0JyAmJiBPYmplY3QucHJvdG90eXBlLmlzUHJvdG90eXBlT2YodGhpcy5hY3RpcykpIHtcclxuICAgIC8vICAgdGhpcy5tZXNzYWdlLmluZm8oJ+WwmuacqumAieaLqemZhOWKoOiKgueCue+8jOivt+S6huino++8gScpO1xyXG4gICAgLy8gICByZXR1cm4gZmFsc2U7XHJcbiAgICAvLyB9XHJcbiAgICBpZiAodGhpcy5kZWZhdWx0VHlwZSA9PT0gJ1NwZWNpZnlOb2RlJyAmJiB0aGlzLmRlZmF1bHRhY3R5ID09PSAnJykge1xyXG4gICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZygn5bCa5pyq5oyH5a6a6buY6K6k6IqC54K577yM6K+35LqG6Kej77yBJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgYWN0aXNTZWxlY3QgPSAocm93RGF0YSk6IE9ic2VydmFibGU8UGlja2VkUmVzdWx0PiA9PiB7XHJcbiAgICAvLyDpmYTliqDoioLngrnnmoTluK7liqnlkI7kuovku7bvvIzmiorpgInkuK3nmoTmlbDmja7otYvnu5lmdWxsQWN0aXPvvIjmraTlpITlpITnkIbnmoTnm67nmoTmmK/kuLrkuobmmL7npLpOYW1l5ZCM5pe25Y+WSWTlgLzvvIlcclxuICAgIC8vIGNvbnNvbGUubG9nKHJvd0RhdGEpO1xyXG4gICAgdGhpcy5mdWxsQWN0aXMgPSByb3dEYXRhO1xyXG4gICAgcmV0dXJuIG9mKHtcclxuICAgICAgY2xvc2VEaWFsb2c6IHRydWVcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVmYXVsdEFjdGl2aXR5U2VsZWN0ID0gKHJvd0RhdGEpOiBPYnNlcnZhYmxlPFBpY2tlZFJlc3VsdD4gPT4ge1xyXG4gICAgLy8g6buY6K6k6IqC54K555qE5biu5Yqp5ZCO5LqL5Lu277yM5oqK6YCJ5Lit55qEaWTotYvnu5lkZWZhdWx0QWN0aXZpdHnvvIjmraTlpITlpITnkIbnmoTnm67nmoTmmK/kuLrkuobmmL7npLpOYW1l5ZCM5pe25Y+WSWTlgLzvvIlcclxuICAgIHRoaXMuZGVmYXVsdEFjdGl2aXR5ID0gcm93RGF0YS5JZDtcclxuICAgIHJldHVybiBvZih7XHJcbiAgICAgIGNsb3NlRGlhbG9nOiB0cnVlXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZVJvdygpIHtcclxuICAgIGlmICh0aGlzLmFjdFRhYmxlLnNlbGVjdGVkUm93ICYmIHRoaXMuYWN0VGFibGUuc2VsZWN0ZWRSb3cuZGF0YSkge1xyXG4gICAgICBjb25zdCBpID0gdGhpcy5hY3Rpcy5maW5kSW5kZXgoZCA9PiBkLmlkID09PSB0aGlzLmFjdFRhYmxlLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICB0aGlzLmFjdGlzLnNwbGljZShpLCAxKTtcclxuICAgICAgdGhpcy5hY3RUYWJsZS5sb2FkRGF0YSh0aGlzLmFjdGlzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfor7fpppblhYjpgInkuK3kuIDmnaHpgInpobnvvIEnKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuZXhwb3J0IGNsYXNzIEp1bXBTY29wZUNvbnZlcnRlciBpbXBsZW1lbnRzIFR5cGVDb252ZXJ0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gIGNvbnZlcnRUbyhkYXRhOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKGRhdGEpIHtcclxuICAgICAgcmV0dXJuICfvvIjlt7Lorr7nva7vvIknO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICfvvIjmnKrorr7nva7vvIknO1xyXG4gIH1cclxufVxyXG5cclxuIl19