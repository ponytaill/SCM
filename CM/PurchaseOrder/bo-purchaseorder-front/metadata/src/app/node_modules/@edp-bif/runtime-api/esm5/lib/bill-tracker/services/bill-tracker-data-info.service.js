/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/services/bill-tracker-data-info.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from "@angular/core";
import { BpmnModelJsonHelper, DataType } from "@edp-aif/common-api";
import { BillTrackingDataShownMode, BillTrackingSettings, fullPathPrefix } from "@edp-bif/common-api";
var BillTrackerDataInfoService = /** @class */ (function () {
    function BillTrackerDataInfoService() {
    }
    /**
     * 判断BillTrackingSettings是旧版还是新版
     * @param bts
     * @returns
     */
    /**
     * 判断BillTrackingSettings是旧版还是新版
     * @param {?} bts
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.isNewBTS = /**
     * 判断BillTrackingSettings是旧版还是新版
     * @param {?} bts
     * @return {?}
     */
    function (bts) {
        if (typeof bts == "string") {
            /** @type {?} */
            var temp = new BillTrackingSettings();
            temp.LoadFromJson(bts);
            bts = temp;
        }
        return bts != null && bts.version === "1.0";
    };
    /**
     * @param {?} rows
     * @param {?} shownFields
     * @param {?} wholeFields
     * @param {?} idField
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.extractDataRows = /**
     * @param {?} rows
     * @param {?} shownFields
     * @param {?} wholeFields
     * @param {?} idField
     * @return {?}
     */
    function (rows, shownFields, wholeFields, idField) {
        var _this = this;
        var e_1, _a;
        /** @type {?} */
        var frows = [];
        var _loop_1 = function (row) {
            /** @type {?} */
            var obj = {};
            obj[idField] = row.dataId;
            // 先解析其他类型字段
            /** @type {?} */
            var decimalFFs = [];
            shownFields.forEach((/**
             * @param {?} f
             * @return {?}
             */
            function (f) {
                if (f.dataType == DataType.Decimal) {
                    decimalFFs.push(f);
                }
                else {
                    obj[f.fieldPath] = _this.getFieldValue(f, row.GetFieldMap(), wholeFields);
                }
            }));
            // 再解析浮点型字段
            decimalFFs.forEach((/**
             * @param {?} f
             * @return {?}
             */
            function (f) {
                obj[f.fieldPath] = _this.getFieldValue(f, row.GetFieldMap(), wholeFields);
            }));
            frows.push(obj);
        };
        try {
            for (var rows_1 = tslib_1.__values(rows), rows_1_1 = rows_1.next(); !rows_1_1.done; rows_1_1 = rows_1.next()) {
                var row = rows_1_1.value;
                _loop_1(row);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (rows_1_1 && !rows_1_1.done && (_a = rows_1.return)) _a.call(rows_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return frows;
    };
    /**
     * @param {?} field
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.extractCaptionPath = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        /** @type {?} */
        var s = field.caption;
        /** @type {?} */
        var tmp = (/** @type {?} */ (field));
        while (tmp.attachedField != null) {
            s = tmp.attachedField.caption + "." + s;
            tmp = (/** @type {?} */ (tmp.attachedField));
        }
        return s;
    };
    /**
     * @param {?} field
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.extractFieldPath = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        /** @type {?} */
        var s = field.fieldName;
        /** @type {?} */
        var tmp = (/** @type {?} */ (field));
        while (tmp.attachedField != null) {
            s = tmp.attachedField.fieldName + "." + s;
            tmp = (/** @type {?} */ (tmp.attachedField));
        }
        return s;
    };
    /**
     *
     * @param fields 子字段列表
     * @param selectedFields 用户自定义展示字段列表
     * @param showCustomFields 是否按用户自定义字段显示
     * @returns
     */
    /**
     *
     * @param {?} fields 子字段列表
     * @param {?} selectedFields 用户自定义展示字段列表
     * @param {?} showCustomFields 是否按用户自定义字段显示
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.extractFFields = /**
     *
     * @param {?} fields 子字段列表
     * @param {?} selectedFields 用户自定义展示字段列表
     * @param {?} showCustomFields 是否按用户自定义字段显示
     * @return {?}
     */
    function (fields, selectedFields, showCustomFields) {
        var _this = this;
        /** @type {?} */
        var ffields = [];
        fields.forEach((/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            f.show = true;
            //枚举或者枚举型单值UDT时默认取Name
            if (f.fieldType == "Enum" || f.fieldType == "EnumSingleUdt") {
                /** @type {?} */
                var tempFPath_1 = _this.extractFieldPath(f);
                /** @type {?} */
                var sf = null;
                if (showCustomFields) {
                    // 如果字段不在已配置字段列表中则跳过
                    sf = selectedFields.find((/**
                     * @param {?} sfield
                     * @return {?}
                     */
                    function (sfield) { return sfield.fieldPath == tempFPath_1; }));
                    if (sf == null) {
                        f.show = false;
                    }
                }
                f = (/** @type {?} */ (_this.setExtendProps(f, sf, tempFPath_1 + ".Name")));
                ffields.push(f);
            }
            else if (f.GetSubFieldList() != null && f.GetSubFieldList().length > 0) {
                ffields.push.apply(ffields, tslib_1.__spread(_this.extractFFields(f.GetSubFieldList(), selectedFields, showCustomFields)));
            }
            else {
                /** @type {?} */
                var tempFPath_2 = _this.extractFieldPath(f);
                /** @type {?} */
                var sf = null;
                if (showCustomFields) {
                    // 如果字段不在已配置字段列表中则跳过
                    sf = selectedFields.find((/**
                     * @param {?} sfield
                     * @return {?}
                     */
                    function (sfield) { return sfield.fieldPath == tempFPath_2; }));
                    if (sf == null) {
                        f.show = false;
                    }
                }
                f = (/** @type {?} */ (_this.setExtendProps(f, sf, tempFPath_2)));
                ffields.push(f);
            }
        }));
        return ffields;
    };
    /**
     * 判定有子数据的条件为：子表可显示，且子表有数据
     */
    /**
     * 判定有子数据的条件为：子表可显示，且子表有数据
     * @param {?} row
     * @param {?} billInfo
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.hasChildData = /**
     * 判定有子数据的条件为：子表可显示，且子表有数据
     * @param {?} row
     * @param {?} billInfo
     * @return {?}
     */
    function (row, billInfo) {
        var e_2, _a;
        /** @type {?} */
        var hasChildData = false;
        /** @type {?} */
        var schema = this.getBillTrackerSchema(billInfo);
        /** @type {?} */
        var children = row.GetChildTableList();
        try {
            for (var children_1 = tslib_1.__values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {
                var c = children_1_1.value;
                /** @type {?} */
                var tableShow = false;
                /** @type {?} */
                var hasRows = false;
                /** @type {?} */
                var table = schema && schema[c.tableName];
                if (table != null && table.show != null) {
                    tableShow = table.show;
                }
                else {
                    // 兼容无show属性情形
                    tableShow = true;
                }
                if (c.GetRowList() && c.GetRowList().length > 0) {
                    hasRows = true;
                }
                hasChildData = tableShow && hasRows;
                if (hasChildData == true) {
                    break;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return hasChildData;
    };
    /**
     * @param {?} f
     * @param {?} rdfm
     * @param {?=} wholeFields
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getFieldValue = /**
     * @param {?} f
     * @param {?} rdfm
     * @param {?=} wholeFields
     * @return {?}
     */
    function (f, rdfm, wholeFields) {
        /** @type {?} */
        var fields = f.fieldPath ? f.fieldPath.split(".") : [f.fieldName];
        /** @type {?} */
        var bdf = fields && rdfm[fields[0]];
        for (var i = 1; bdf != null && i < fields.length; i++) {
            /** @type {?} */
            var temp = bdf.GetSubFieldMap();
            if (temp == null) {
                break;
            }
            bdf = temp[fields[i]];
        }
        /** @type {?} */
        var textValue = bdf ? bdf.GetTextValue() : "";
        if (textValue == null) {
            return null;
        }
        if (f.dataType == DataType.String) {
            if (f.formatInfo != null) {
                /** @type {?} */
                var stringMapFormatter = f.formatInfo.stringMapFormatter;
                if (stringMapFormatter != null) {
                    /** @type {?} */
                    var v = stringMapFormatter[textValue] || textValue;
                    f.fieldValue = v;
                    return v;
                }
                else {
                    f.fieldValue = textValue;
                    return textValue || "";
                }
            }
            else {
                f.fieldValue = textValue;
                return textValue || "";
            }
        }
        else if (f.dataType == DataType.Decimal) {
            /** @type {?} */
            var scale = f.scale;
            if (f.formatInfo != null) {
                if (f.formatInfo.scale != null) {
                    scale = f.formatInfo.scale;
                }
                if (f.formatInfo.enableScaleExpression) {
                    if (f.formatInfo.scaleExpression != null) {
                        /** @type {?} */
                        var scaleField = this.getFieldInFields(wholeFields, f.formatInfo.scaleExpression);
                        /** @type {?} */
                        var tmp = scaleField && parseInt(String(this.getFieldValue(scaleField, rdfm)));
                        // const tmp = parseInt(this.getFieldValueInFieldsWithValue(extactedFields, f.formatInfo.scaleExpression));
                        if (tmp != null && !isNaN(tmp)) {
                            scale = tmp;
                        }
                    }
                }
            }
            f.fieldValue = parseFloat(String(textValue));
            /** @type {?} */
            var dec = parseFloat(String(textValue)).toFixed(scale).toString();
            return dec || "";
        }
        else if (f.dataType == DataType.Boolean) {
            if (textValue == "") {
                f.fieldValue = null;
                return textValue;
            }
            f.fieldValue = (/** @type {?} */ (JSON.parse(textValue)));
            return (/** @type {?} */ (JSON.parse(textValue)));
        }
        else if (f.dataType == DataType.DateTime) {
            /** @type {?} */
            var date = BpmnModelJsonHelper.DateTimeFromString(textValue);
            /** @type {?} */
            var formatter = "yyyy-MM-dd";
            if (f.fieldType == "DateTime") {
                formatter = f.formatInfo && f.formatInfo.dateFormatter || "yyyy-MM-dd HH:mm:ss.SSS";
            }
            else if (f.fieldType == "Date") {
                formatter = f.formatInfo && f.formatInfo.dateFormatter || "yyyy-MM-dd";
            }
            else {
                formatter = f.formatInfo && f.formatInfo.dateFormatter || "yyyy-MM-dd";
            }
            f.fieldValue = date;
            return this.dateFormat(date, formatter);
        }
        else {
            f.fieldValue = textValue;
            return textValue || "";
        }
    };
    /**
     * @param {?} fields
     * @param {?} fullPath
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getFieldInFields = /**
     * @param {?} fields
     * @param {?} fullPath
     * @return {?}
     */
    function (fields, fullPath) {
        var e_3, _a;
        /** @type {?} */
        var v = null;
        try {
            for (var fields_1 = tslib_1.__values(fields), fields_1_1 = fields_1.next(); !fields_1_1.done; fields_1_1 = fields_1.next()) {
                var fv = fields_1_1.value;
                while (fv.attachedField) {
                    fv = fv.attachedField;
                }
                /** @type {?} */
                var rootFv = (/** @type {?} */ (fv));
                rootFv.fullPath = fullPathPrefix + rootFv.attachedTable.tableName + "." + rootFv.fieldPath;
                if (fullPath == rootFv.fullPath) {
                    v = rootFv;
                    break;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (fields_1_1 && !fields_1_1.done && (_a = fields_1.return)) _a.call(fields_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return v;
    };
    /**
     * @param {?} fieldsWithValue
     * @param {?} fullPath
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getFieldValueInFieldsWithValue = /**
     * @param {?} fieldsWithValue
     * @param {?} fullPath
     * @return {?}
     */
    function (fieldsWithValue, fullPath) {
        var e_4, _a;
        /** @type {?} */
        var v = null;
        try {
            for (var fieldsWithValue_1 = tslib_1.__values(fieldsWithValue), fieldsWithValue_1_1 = fieldsWithValue_1.next(); !fieldsWithValue_1_1.done; fieldsWithValue_1_1 = fieldsWithValue_1.next()) {
                var fv = fieldsWithValue_1_1.value;
                while (fv.attachedField) {
                    fv = fv.attachedField;
                }
                /** @type {?} */
                var rootFv = (/** @type {?} */ (fv));
                rootFv.fullPath = fullPathPrefix + rootFv.attachedTable.tableName + "." + rootFv.fieldPath;
                if (fullPath == rootFv.fullPath) {
                    v = rootFv.fieldValue;
                    break;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (fieldsWithValue_1_1 && !fieldsWithValue_1_1.done && (_a = fieldsWithValue_1.return)) _a.call(fieldsWithValue_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return v;
    };
    /**
     * @param {?} billInfo
     * @param {?} schemaTable
     * @param {?} dataTable
     * @param {?=} filterFields
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getBasicInfoFieldsWithValue = /**
     * @param {?} billInfo
     * @param {?} schemaTable
     * @param {?} dataTable
     * @param {?=} filterFields
     * @return {?}
     */
    function (billInfo, schemaTable, dataTable, filterFields) {
        var _this = this;
        if (filterFields === void 0) { filterFields = true; }
        /** @type {?} */
        var fieldsWithValue = [];
        // 单据追踪配置
        /** @type {?} */
        var bts = new BillTrackingSettings();
        if (billInfo && billInfo.billTrackingSettings) {
            bts.LoadFromJson(billInfo.billTrackingSettings);
        }
        /** @type {?} */
        var schema = this.getBillTrackerSchema(billInfo);
        /** @type {?} */
        var selectedFields = schema && schema[schemaTable.tableName] && schema[schemaTable.tableName].fields;
        selectedFields = selectedFields ? selectedFields : [];
        /** @type {?} */
        var showCustomFields = bts.billTrackingDataShownMode === BillTrackingDataShownMode.CUSTOMFIELD;
        // 所有字段
        /** @type {?} */
        var fs = schemaTable.getFieldList();
        /** @type {?} */
        var r = dataTable.GetRowList()[0];
        // 主表字段
        /** @type {?} */
        var rdfm = r.GetFieldMap();
        // 提取展示字段
        /** @type {?} */
        var ffs = this.extractFFields(fs, selectedFields, showCustomFields);
        // 获取字段值
        // 先解析其他类型字段
        /** @type {?} */
        var decimalFfs = [];
        ffs.forEach((/**
         * @param {?} ff
         * @return {?}
         */
        function (ff) {
            if (ff.dataType == DataType.Decimal) {
                decimalFfs.push(ff);
            }
            else {
                ff.fieldValue = _this.getFieldValue(ff, rdfm);
            }
        }));
        // 再解析浮点数字段
        decimalFfs.forEach((/**
         * @param {?} ff
         * @return {?}
         */
        function (ff) {
            ff.fieldValue = _this.getFieldValue(ff, rdfm, fs);
        }));
        fieldsWithValue.push.apply(fieldsWithValue, tslib_1.__spread(ffs));
        return fieldsWithValue;
    };
    /**
     * @param {?} f
     * @param {?} sf
     * @param {?} fieldPath
     * @param {?=} rdfm
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.setExtendProps = /**
     * @param {?} f
     * @param {?} sf
     * @param {?} fieldPath
     * @param {?=} rdfm
     * @return {?}
     */
    function (f, sf, fieldPath, rdfm) {
        f.captionPath = this.extractCaptionPath(f);
        f.fieldPath = fieldPath;
        if (sf) {
            f.displayName = sf.displayName;
            f.i18nCols = sf.i18nCols;
            f.formatInfo = sf.formatInfo;
            f.order = sf.order;
        }
        if (rdfm) {
            f.fieldValue = this.getFieldValue(f, rdfm);
        }
        return f;
    };
    /**
     * 字段列表按order属性排序
     * @param fieldsWithValue
     * @returns
     */
    /**
     * 字段列表按order属性排序
     * @param {?} fieldsWithValue
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.sortFieldsByOrder = /**
     * 字段列表按order属性排序
     * @param {?} fieldsWithValue
     * @return {?}
     */
    function (fieldsWithValue) {
        return fieldsWithValue.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            if (a.order != null && b.order != null) {
                return a.order - b.order;
            }
            else if (a.order != null && b.order == null) {
                return -1;
            }
            else if (a.order == null && b.order != null) {
                return 1;
            }
            else {
                return 0;
            }
        }));
    };
    /**
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.dateFormat = /**
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    function (date, fmt) {
        /** @type {?} */
        var ret;
        /** @type {?} */
        var opt = {
            "y+": date.getUTCFullYear().toString(),
            // 年
            "M+": (date.getUTCMonth() + 1).toString(),
            // 月
            "d+": date.getUTCDate().toString(),
            // 日
            "H+": date.getUTCHours().toString(),
            // 时
            "m+": date.getUTCMinutes().toString(),
            // 分
            "s+": date.getUTCSeconds().toString(),
            // 秒
            "S+": date.getUTCMilliseconds().toString(),
        };
        for (var k in opt) {
            ret = new RegExp("(" + k + ")").exec(fmt);
            if (ret) {
                if (!String.prototype.padStart) {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (this.myPadStart(opt[k], ret[1].length, "0")));
                }
                else {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, "0")));
                }
            }
        }
        return fmt;
    };
    /**
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.myPadStart = /**
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    function (src, targetLength, padString) {
        targetLength = targetLength >> 0; //floor if number or convert non-number to 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (src.length > targetLength) {
            return String(src);
        }
        else {
            targetLength = targetLength - src.length;
            if (targetLength > padString.length) {
                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
            }
            return padString.slice(0, targetLength) + String(src);
        }
    };
    /**
     * 解析字段名称
     * @param f
     * @param langCode
     * @returns
     */
    /**
     * 解析字段名称
     * @param {?} f
     * @param {?=} langCode
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getFieldLabel = /**
     * 解析字段名称
     * @param {?} f
     * @param {?=} langCode
     * @return {?}
     */
    function (f, langCode) {
        return (langCode && f.i18nCols && f.i18nCols.colI18nValues.displayName &&
            f.i18nCols.colI18nValues.displayName[langCode]) || f.displayName || f.captionPath || f.caption;
    };
    /**
     * 解析表名称
     */
    /**
     * 解析表名称
     * @param {?} billInfo
     * @param {?} schemaTable
     * @param {?=} langCode
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getTableLabel = /**
     * 解析表名称
     * @param {?} billInfo
     * @param {?} schemaTable
     * @param {?=} langCode
     * @return {?}
     */
    function (billInfo, schemaTable, langCode) {
        /** @type {?} */
        var schema = this.getBillTrackerSchema(billInfo);
        /** @type {?} */
        var table = schema && schema[schemaTable.tableName];
        if (table != null) {
            /** @type {?} */
            var i18nCols = table.i18nCols;
            /** @type {?} */
            var tmp = (langCode && i18nCols && i18nCols.colI18nValues.displayName && i18nCols.colI18nValues.displayName[langCode]) || table.displayName || table.caption || table.code;
            return tmp;
        }
        else {
            return schemaTable.caption;
        }
    };
    /**
     * 获取解析可展示子表
     */
    /**
     * 获取解析可展示子表
     * @param {?} billInfo
     * @param {?} schemaTable
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getChildTables = /**
     * 获取解析可展示子表
     * @param {?} billInfo
     * @param {?} schemaTable
     * @return {?}
     */
    function (billInfo, schemaTable) {
        /** @type {?} */
        var result = [];
        /** @type {?} */
        var schema = this.getBillTrackerSchema(billInfo);
        /** @type {?} */
        var children = schemaTable.GetChildTableList();
        children && children.forEach((/**
         * @param {?} child
         * @return {?}
         */
        function (child) {
            /** @type {?} */
            var trackerTable = schema && schema[child.tableName];
            if (trackerTable != null && trackerTable.show != null) {
                if (trackerTable.show == true) {
                    child.order = trackerTable.order;
                    result.push(child);
                }
            }
            else {
                // 兼容无show属性情形
                result.push(child);
            }
        }));
        result = this.sortTablesByOrder(result);
        return result;
    };
    /**
     * 表按sort字段排序
     * @param schemaTables
     * @returns
     */
    /**
     * 表按sort字段排序
     * @param {?} schemaTables
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.sortTablesByOrder = /**
     * 表按sort字段排序
     * @param {?} schemaTables
     * @return {?}
     */
    function (schemaTables) {
        return schemaTables.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) {
            if (a.order != null && b.order != null) {
                return a.order - b.order;
            }
            else if (a.order != null && b.order == null) {
                return -1;
            }
            else if (a.order == null && b.order != null) {
                return 1;
            }
            else {
                return 0;
            }
        }));
    };
    /**
     * 解析billTrackerSchema
     * @param billInfo
     */
    /**
     * 解析billTrackerSchema
     * @param {?} billInfo
     * @return {?}
     */
    BillTrackerDataInfoService.prototype.getBillTrackerSchema = /**
     * 解析billTrackerSchema
     * @param {?} billInfo
     * @return {?}
     */
    function (billInfo) {
        /** @type {?} */
        var bts = new BillTrackingSettings();
        if (billInfo && billInfo.billTrackingSettings) {
            bts.LoadFromJson(billInfo.billTrackingSettings);
        }
        /** @type {?} */
        var fieldContent = bts.customFieldContent;
        /** @type {?} */
        var fieldConfig = fieldContent && (typeof fieldContent == "object" ? fieldContent : JSON.parse(fieldContent));
        /** @type {?} */
        var schema = fieldConfig && fieldConfig.schema;
        return schema;
    };
    BillTrackerDataInfoService.decorators = [
        { type: Injectable }
    ];
    return BillTrackerDataInfoService;
}());
export { BillTrackerDataInfoService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC10cmFja2VyLWRhdGEtaW5mby5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVkcC1iaWYvcnVudGltZS1hcGkvIiwic291cmNlcyI6WyJsaWIvYmlsbC10cmFja2VyL3NlcnZpY2VzL2JpbGwtdHJhY2tlci1kYXRhLWluZm8uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBMEksbUJBQW1CLEVBQUUsUUFBUSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDNU0sT0FBTyxFQUFvRCx5QkFBeUIsRUFBRSxvQkFBb0IsRUFBRSxjQUFjLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUd4SjtJQUFBO0lBaWNBLENBQUM7SUEvYkc7Ozs7T0FJRzs7Ozs7O0lBQ0ksNkNBQVE7Ozs7O0lBQWYsVUFBZ0IsR0FBa0M7UUFDOUMsSUFBSSxPQUFPLEdBQUcsSUFBSSxRQUFRLEVBQUU7O2dCQUNsQixJQUFJLEdBQUcsSUFBSSxvQkFBb0IsRUFBRTtZQUN2QyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3ZCLEdBQUcsR0FBRyxJQUFJLENBQUM7U0FDZDtRQUVELE9BQU8sR0FBRyxJQUFJLElBQUksSUFBSSxHQUFHLENBQUMsT0FBTyxLQUFLLEtBQUssQ0FBQztJQUNoRCxDQUFDOzs7Ozs7OztJQUVNLG9EQUFlOzs7Ozs7O0lBQXRCLFVBQXVCLElBQW1CLEVBQUUsV0FBa0MsRUFBRSxXQUFrQyxFQUFFLE9BQWU7UUFBbkksaUJBdUJDOzs7WUF0Qk8sS0FBSyxHQUFHLEVBQUU7Z0NBQ0wsR0FBRzs7Z0JBQ0osR0FBRyxHQUFHLEVBQUU7WUFDWixHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQzs7O2dCQUVwQixVQUFVLEdBQUcsRUFBRTtZQUNyQixXQUFXLENBQUMsT0FBTzs7OztZQUFDLFVB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LFlBQVksQ0FBQyxDQUFDOztZQUN4SSxNQUFNLEdBQUcsV0FBVyxJQUFJLFdBQVcsQ0FBQyxNQUFNO1FBRTlDLE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7O2dCQWhjSixVQUFVOztJQWljWCxpQ0FBQztDQUFBLEFBamNELElBaWNDO1NBaGNZLDBCQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBCaWxsRGF0YUZpZWxkLCBCaWxsRGF0YVJvdywgQmlsbERhdGFTdWJGaWVsZCwgQmlsbERhdGFUYWJsZSwgQmlsbFNjaGVtYUZpZWxkLCBCaWxsU2NoZW1hRmllbGRCYXNlLCBCaWxsU2NoZW1hU3ViRmllbGQsIEJpbGxTY2hlbWFUYWJsZSwgQnBtbk1vZGVsSnNvbkhlbHBlciwgRGF0YVR5cGUgfSBmcm9tIFwiQGVkcC1haWYvY29tbW9uLWFwaVwiO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlclNjaGVtYSwgQmlsbFRyYWNrZXJTY2hlbWFGaWVsZENvbnRlbnQsIEJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUsIEJpbGxUcmFja2luZ1NldHRpbmdzLCBmdWxsUGF0aFByZWZpeCB9IGZyb20gXCJAZWRwLWJpZi9jb21tb24tYXBpXCI7XHJcbmltcG9ydCB7IEJpbGxJbmZvIH0gZnJvbSBcIi4uLy4uL2VudGl0eS90cmFja2luZy9CaWxsSW5mb1wiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQmlsbFRyYWNrZXJEYXRhSW5mb1NlcnZpY2Uge1xyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq1CaWxsVHJhY2tpbmdTZXR0aW5nc+aYr+aXp+eJiOi/mOaYr+aWsOeJiFxyXG4gICAgICogQHBhcmFtIGJ0cyBcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaXNOZXdCVFMoYnRzOiBzdHJpbmcgfCBCaWxsVHJhY2tpbmdTZXR0aW5ncyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYnRzID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgdGVtcCA9IG5ldyBCaWxsVHJhY2tpbmdTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB0ZW1wLkxvYWRGcm9tSnNvbihidHMpO1xyXG4gICAgICAgICAgICBidHMgPSB0ZW1wO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJ0cyAhPSBudWxsICYmIGJ0cy52ZXJzaW9uID09PSBcIjEuMFwiO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBleHRyYWN0RGF0YVJvd3Mocm93czogQmlsbERhdGFSb3dbXSwgc2hvd25GaWVsZHM6IEJpbGxTY2hlbWFGaWVsZEJhc2VbXSwgd2hvbGVGaWVsZHM6IEJpbGxTY2hlbWFGaWVsZEJhc2VbXSwgaWRGaWVsZDogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGZyb3dzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgcm93IG9mIHJvd3MpIHtcclxuICAgICAgICAgICAgbGV0IG9iaiA9IHt9O1xyXG4gICAgICAgICAgICBvYmpbaWRGaWVsZF0gPSByb3cuZGF0YUlkO1xyXG4gICAgICAgICAgICAvLyDlhYjop6PmnpDlhbbku5bnsbvlnovlrZfmrrVcclxuICAgICAgICAgICAgY29uc3QgZGVjaW1hbEZGcyA9IFtdO1xyXG4gICAgICAgICAgICBzaG93bkZpZWxkcy5mb3JFYWNoKGYgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGYuZGF0YVR5cGUgPT0gRGF0YVR5cGUuRGVjaW1hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlY2ltYWxGRnMucHVzaChmKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqW2YuZmllbGRQYXRoXSA9IHRoaXMuZ2V0RmllbGRWYWx1ZShmLCByb3cuR2V0RmllbGRNYXAoKSwgd2hvbGVGaWVsZHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8g5YaN6Kej5p6Q5rWu54K55Z6L5a2X5q61XHJcbiAgICAgICAgICAgIGRlY2ltYWxGRnMuZm9yRWFjaChmID0+IHtcclxuICAgICAgICAgICAgICAgIG9ialtmLmZpZWxkUGF0aF0gPSB0aGlzLmdldEZpZWxkVmFsdWUoZiwgcm93LkdldEZpZWxkTWFwKCksIHdob2xlRmllbGRzKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmcm93cy5wdXNoKG9iaik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZnJvd3M7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGV4dHJhY3RDYXB0aW9uUGF0aChmaWVsZDogQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKSB7XHJcbiAgICAgICAgbGV0IHMgPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgIGxldCB0bXAgPSBmaWVsZCBhcyBCaWxsU2NoZW1hU3ViRmllbGQ7XHJcbiAgICAgICAgd2hpbGUgKHRtcC5hdHRhY2hlZEZpZWxkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcyA9IHRtcC5hdHRhY2hlZEZpZWxkLmNhcHRpb24gKyBcIi5cIiArIHM7XHJcbiAgICAgICAgICAgIHRtcCA9IHRtcC5hdHRhY2hlZEZpZWxkIGFzIEJpbGxTY2hlbWFTdWJGaWVsZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGV4dHJhY3RGaWVsZFBhdGgoZmllbGQ6IEJpbGxTY2hlbWFGaWVsZCB8IEJpbGxTY2hlbWFTdWJGaWVsZCkge1xyXG4gICAgICAgIGxldCBzID0gZmllbGQuZmllbGROYW1lO1xyXG4gICAgICAgIGxldCB0bXAgPSBmaWVsZCBhcyBCaWxsU2NoZW1hU3ViRmllbGQ7XHJcbiAgICAgICAgd2hpbGUgKHRtcC5hdHRhY2hlZEZpZWxkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcyA9IHRtcC5hdHRhY2hlZEZpZWxkLmZpZWxkTmFtZSArIFwiLlwiICsgcztcclxuICAgICAgICAgICAgdG1wID0gdG1wLmF0dGFjaGVkRmllbGQgYXMgQmlsbFNjaGVtYVN1YkZpZWxkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIGZpZWxkcyDlrZDlrZfmrrXliJfooahcclxuICAgICAqIEBwYXJhbSBzZWxlY3RlZEZpZWxkcyDnlKjmiLfoh6rlrprkuYnlsZXnpLrlrZfmrrXliJfooahcclxuICAgICAqIEBwYXJhbSBzaG93Q3VzdG9tRmllbGRzIOaYr+WQpuaMieeUqOaIt+iHquWumuS5ieWtl+auteaYvuekulxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleHRyYWN0RkZpZWxkcyhmaWVsZHM6IChCaWxsU2NoZW1hRmllbGQgfCBCaWxsU2NoZW1hU3ViRmllbGQpW10sIHNlbGVjdGVkRmllbGRzOiBCaWxsU2NoZW1hRmllbGRCYXNlW10sIHNob3dDdXN0b21GaWVsZHM6IGJvb2xlYW4pOiAoQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKVtdIHtcclxuICAgICAgICBsZXQgZmZpZWxkczogKEJpbGxTY2hlbWFGaWVsZCB8IEJpbGxTY2hlbWFTdWJGaWVsZClbXSA9IFtdO1xyXG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGYgPT4ge1xyXG4gICAgICAgICAgICBmLnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL+aemuS4vuaIluiAheaemuS4vuWei+WNleWAvFVEVOaXtum7mOiupOWPlk5hbWVcclxuICAgICAgICAgICAgaWYgKGYuZmllbGRUeXBlID09IFwiRW51bVwiIHx8IGYuZmllbGRUeXBlID09IFwiRW51bVNpbmdsZVVkdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wRlBhdGggPSB0aGlzLmV4dHJhY3RGaWVsZFBhdGgoZik7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHNmID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChzaG93Q3VzdG9tRmllbGRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5a2X5q615LiN5Zyo5bey6YWN572u5a2X5q615YiX6KGo5Lit5YiZ6Lez6L+HXHJcbiAgICAgICAgICAgICAgICAgICAgc2YgPSBzZWxlY3RlZEZpZWxkcy5maW5kKChzZmllbGQpID0+IHNmaWVsZC5maWVsZFBhdGggPT0gdGVtcEZQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2YgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZiA9IHRoaXMuc2V0RXh0ZW5kUHJvcHMoZiwgc2YsIHRlbXBGUGF0aCArIFwiLk5hbWVcIikgYXMgQmlsbFNjaGVtYVN1YkZpZWxkO1xyXG5cclxuICAgICAgICAgICAgICAgIGZmaWVsZHMucHVzaChmKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmLkdldFN1YkZpZWxkTGlzdCgpICE9IG51bGwgJiYgZi5HZXRTdWJGaWVsZExpc3QoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goLi4udGhpcy5leHRyYWN0RkZpZWxkcyhmLkdldFN1YkZpZWxkTGlzdCgpLCBzZWxlY3RlZEZpZWxkcywgc2hvd0N1c3RvbUZpZWxkcykpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGVtcEZQYXRoID0gdGhpcy5leHRyYWN0RmllbGRQYXRoKGYpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBzZiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hvd0N1c3RvbUZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOWtl+auteS4jeWcqOW3sumFjee9ruWtl+auteWIl+ihqOS4reWImei3s+i/h1xyXG4gICAgICAgICAgICAgICAgICAgIHNmID0gc2VsZWN0ZWRGaWVsZHMuZmluZCgoc2ZpZWxkKSA9PiBzZmllbGQuZmllbGRQYXRoID09IHRlbXBGUGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNmID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZi5zaG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGYgPSB0aGlzLnNldEV4dGVuZFByb3BzKGYsIHNmLCB0ZW1wRlBhdGgpIGFzIEJpbGxTY2hlbWFTdWJGaWVsZDtcclxuXHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goZik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZmaWVsZHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKTlrprmnInlrZDmlbDmja7nmoTmnaHku7bkuLrvvJrlrZDooajlj6/mmL7npLrvvIzkuJTlrZDooajmnInmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhc0NoaWxkRGF0YShyb3c6IEJpbGxEYXRhUm93LCBiaWxsSW5mbzogQmlsbEluZm8pIHtcclxuICAgICAgICBsZXQgaGFzQ2hpbGREYXRhID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuZ2V0QmlsbFRyYWNrZXJTY2hlbWEoYmlsbEluZm8pO1xyXG4gICAgICAgIGxldCBjaGlsZHJlbiA9IHJvdy5HZXRDaGlsZFRhYmxlTGlzdCgpO1xyXG4gICAgICAgIGZvciAobGV0IGMgb2YgY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgbGV0IHRhYmxlU2hvdyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgaGFzUm93cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgdGFibGUgPSBzY2hlbWEgJiYgc2NoZW1hW2MudGFibGVOYW1lXTtcclxuICAgICAgICAgICAgaWYgKHRhYmxlICE9IG51bGwgJiYgdGFibGUuc2hvdyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0YWJsZVNob3cgPSB0YWJsZS5zaG93O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5YW85a655pegc2hvd+WxnuaAp+aDheW9olxyXG4gICAgICAgICAgICAgICAgdGFibGVTaG93ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYy5HZXRSb3dMaXN0KCkgJiYgYy5HZXRSb3dMaXN0KCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgaGFzUm93cyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaGFzQ2hpbGREYXRhID0gdGFibGVTaG93ICYmIGhhc1Jvd3M7XHJcbiAgICAgICAgICAgIGlmIChoYXNDaGlsZERhdGEgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhc0NoaWxkRGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0RmllbGRWYWx1ZShmOiBCaWxsU2NoZW1hRmllbGRCYXNlLCByZGZtOiB7IFtrZXk6IHN0cmluZ106IEJpbGxEYXRhRmllbGQ7IH0sIHdob2xlRmllbGRzPzogQmlsbFNjaGVtYUZpZWxkQmFzZVtdKSB7XHJcbiAgICAgICAgbGV0IGZpZWxkcyA9IGYuZmllbGRQYXRoID8gZi5maWVsZFBhdGguc3BsaXQoXCIuXCIpIDogW2YuZmllbGROYW1lXTtcclxuXHJcbiAgICAgICAgbGV0IGJkZjogQmlsbERhdGFGaWVsZCB8IEJpbGxEYXRhU3ViRmllbGQgPSBmaWVsZHMgJiYgcmRmbVtmaWVsZHNbMF1dO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBiZGYgIT0gbnVsbCAmJiBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBiZGYuR2V0U3ViRmllbGRNYXAoKTtcclxuICAgICAgICAgICAgaWYgKHRlbXAgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYmRmID0gdGVtcFtmaWVsZHNbaV1dO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdGV4dFZhbHVlID0gYmRmID8gYmRmLkdldFRleHRWYWx1ZSgpIDogXCJcIjtcclxuICAgICAgICBpZiAodGV4dFZhbHVlID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmLmRhdGFUeXBlID09IERhdGFUeXBlLlN0cmluZykge1xyXG4gICAgICAgICAgICBpZiAoZi5mb3JtYXRJbmZvICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmluZ01hcEZvcm1hdHRlciA9IGYuZm9ybWF0SW5mby5zdHJpbmdNYXBGb3JtYXR0ZXI7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RyaW5nTWFwRm9ybWF0dGVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2ID0gc3RyaW5nTWFwRm9ybWF0dGVyW3RleHRWYWx1ZV0gfHwgdGV4dFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGYuZmllbGRWYWx1ZSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHY7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYuZmllbGRWYWx1ZSA9IHRleHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dFZhbHVlIHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmLmZpZWxkVmFsdWUgPSB0ZXh0VmFsdWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dFZhbHVlIHx8IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGYuZGF0YVR5cGUgPT0gRGF0YVR5cGUuRGVjaW1hbCkge1xyXG4gICAgICAgICAgICBsZXQgc2NhbGUgPSBmLnNjYWxlO1xyXG4gICAgICAgICAgICBpZiAoZi5mb3JtYXRJbmZvICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmLmZvcm1hdEluZm8uc2NhbGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlID0gZi5mb3JtYXRJbmZvLnNjYWxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGYuZm9ybWF0SW5mby5lbmFibGVTY2FsZUV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5mb3JtYXRJbmZvLnNjYWxlRXhwcmVzc2lvbiAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjYWxlRmllbGQgPSB0aGlzLmdldEZpZWxkSW5GaWVsZHMod2hvbGVGaWVsZHMsIGYuZm9ybWF0SW5mby5zY2FsZUV4cHJlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0bXAgPSBzY2FsZUZpZWxkICYmIHBhcnNlSW50KFN0cmluZyh0aGlzLmdldEZpZWxkVmFsdWUoc2NhbGVGaWVsZCwgcmRmbSkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgdG1wID0gcGFyc2VJbnQodGhpcy5nZXRGaWVsZFZhbHVlSW5GaWVsZHNXaXRoVmFsdWUoZXh0YWN0ZWRGaWVsZHMsIGYuZm9ybWF0SW5mby5zY2FsZUV4cHJlc3Npb24pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcCAhPSBudWxsICYmICFpc05hTih0bXApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IHRtcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmLmZpZWxkVmFsdWUgPSBwYXJzZUZsb2F0KFN0cmluZyh0ZXh0VmFsdWUpKTtcclxuICAgICAgICAgICAgbGV0IGRlYyA9IHBhcnNlRmxvYXQoU3RyaW5nKHRleHRWYWx1ZSkpLnRvRml4ZWQoc2NhbGUpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWMgfHwgXCJcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGYuZGF0YVR5cGUgPT0gRGF0YVR5cGUuQm9vbGVhbikge1xyXG4gICAgICAgICAgICBpZiAodGV4dFZhbHVlID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGYuZmllbGRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dFZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGYuZmllbGRWYWx1ZSA9IEpTT04ucGFyc2UodGV4dFZhbHVlKSBhcyBib29sZWFuO1xyXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh0ZXh0VmFsdWUpIGFzIGJvb2xlYW47XHJcbiAgICAgICAgfSBlbHNlIGlmIChmLmRhdGFUeXBlID09IERhdGFUeXBlLkRhdGVUaW1lKSB7XHJcbiAgICAgICAgICAgIGxldCBkYXRlID0gQnBtbk1vZGVsSnNvbkhlbHBlci5EYXRlVGltZUZyb21TdHJpbmcodGV4dFZhbHVlKTtcclxuICAgICAgICAgICAgbGV0IGZvcm1hdHRlciA9IFwieXl5eS1NTS1kZFwiO1xyXG4gICAgICAgICAgICBpZiAoZi5maWVsZFR5cGUgPT0gXCJEYXRlVGltZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXIgPSBmLmZvcm1hdEluZm8gJiYgZi5mb3JtYXRJbmZvLmRhdGVGb3JtYXR0ZXIgfHwgXCJ5eXl5LU1NLWRkIEhIOm1tOnNzLlNTU1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGYuZmllbGRUeXBlID09IFwiRGF0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXIgPSBmLmZvcm1hdEluZm8gJiYgZi5mb3JtYXRJbmZvLmRhdGVGb3JtYXR0ZXIgfHwgXCJ5eXl5LU1NLWRkXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZXIgPSBmLmZvcm1hdEluZm8gJiYgZi5mb3JtYXRJbmZvLmRhdGVGb3JtYXR0ZXIgfHwgXCJ5eXl5LU1NLWRkXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZi5maWVsZFZhbHVlID0gZGF0ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZUZvcm1hdChkYXRlLCBmb3JtYXR0ZXIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGYuZmllbGRWYWx1ZSA9IHRleHRWYWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRleHRWYWx1ZSB8fCBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0RmllbGRJbkZpZWxkcyhmaWVsZHM6IEJpbGxTY2hlbWFGaWVsZEJhc2VbXSwgZnVsbFBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIGxldCB2ID0gbnVsbDtcclxuICAgICAgICBmb3IgKGxldCBmdiBvZiBmaWVsZHMpIHtcclxuICAgICAgICAgICAgd2hpbGUgKGZ2LmF0dGFjaGVkRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIGZ2ID0gZnYuYXR0YWNoZWRGaWVsZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByb290RnYgPSBmdiBhcyBCaWxsU2NoZW1hRmllbGQ7XHJcbiAgICAgICAgICAgIHJvb3RGdi5mdWxsUGF0aCA9IGZ1bGxQYXRoUHJlZml4ICsgcm9vdEZ2LmF0dGFjaGVkVGFibGUudGFibGVOYW1lICsgXCIuXCIgKyByb290RnYuZmllbGRQYXRoO1xyXG4gICAgICAgICAgICBpZiAoZnVsbFBhdGggPT0gcm9vdEZ2LmZ1bGxQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICB2ID0gcm9vdEZ2O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHY7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEZpZWxkVmFsdWVJbkZpZWxkc1dpdGhWYWx1ZShmaWVsZHNXaXRoVmFsdWU6IEJpbGxTY2hlbWFGaWVsZEJhc2VbXSwgZnVsbFBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIGxldCB2ID0gbnVsbDtcclxuICAgICAgICBmb3IgKGxldCBmdiBvZiBmaWVsZHNXaXRoVmFsdWUpIHtcclxuICAgICAgICAgICAgd2hpbGUgKGZ2LmF0dGFjaGVkRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIGZ2ID0gZnYuYXR0YWNoZWRGaWVsZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByb290RnYgPSBmdiBhcyBCaWxsU2NoZW1hRmllbGQ7XHJcbiAgICAgICAgICAgIHJvb3RGdi5mdWxsUGF0aCA9IGZ1bGxQYXRoUHJlZml4ICsgcm9vdEZ2LmF0dGFjaGVkVGFibGUudGFibGVOYW1lICsgXCIuXCIgKyByb290RnYuZmllbGRQYXRoO1xyXG4gICAgICAgICAgICBpZiAoZnVsbFBhdGggPT0gcm9vdEZ2LmZ1bGxQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICB2ID0gcm9vdEZ2LmZpZWxkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0QmFzaWNJbmZvRmllbGRzV2l0aFZhbHVlKGJpbGxJbmZvOiBCaWxsSW5mbywgc2NoZW1hVGFibGU6IEJpbGxTY2hlbWFUYWJsZSwgZGF0YVRhYmxlOiBCaWxsRGF0YVRhYmxlLCBmaWx0ZXJGaWVsZHM6IGJvb2xlYW4gPSB0cnVlKTogKEJpbGxTY2hlbWFGaWVsZCB8IEJpbGxTY2hlbWFTdWJGaWVsZClbXSB7XHJcbiAgICAgICAgY29uc3QgZmllbGRzV2l0aFZhbHVlOiAoQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKVtdID0gW107XHJcbiAgICAgICAgLy8g5Y2V5o2u6L+96Liq6YWN572uXHJcbiAgICAgICAgbGV0IGJ0czogQmlsbFRyYWNraW5nU2V0dGluZ3MgPSBuZXcgQmlsbFRyYWNraW5nU2V0dGluZ3MoKTtcclxuICAgICAgICBpZiAoYmlsbEluZm8gJiYgYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgYnRzLkxvYWRGcm9tSnNvbihiaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzY2hlbWEgPSB0aGlzLmdldEJpbGxUcmFja2VyU2NoZW1hKGJpbGxJbmZvKTtcclxuICAgICAgICBsZXQgc2VsZWN0ZWRGaWVsZHMgPSBzY2hlbWEgJiYgc2NoZW1hW3NjaGVtYVRhYmxlLnRhYmxlTmFtZV0gJiYgc2NoZW1hW3NjaGVtYVRhYmxlLnRhYmxlTmFtZV0uZmllbGRzO1xyXG4gICAgICAgIHNlbGVjdGVkRmllbGRzID0gc2VsZWN0ZWRGaWVsZHMgPyBzZWxlY3RlZEZpZWxkcyA6IFtdO1xyXG4gICAgICAgIGxldCBzaG93Q3VzdG9tRmllbGRzID0gYnRzLmJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUgPT09IEJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUuQ1VTVE9NRklFTEQ7XHJcblxyXG4gICAgICAgIC8vIOaJgOacieWtl+autVxyXG4gICAgICAgIGNvbnN0IGZzID0gc2NoZW1hVGFibGUuZ2V0RmllbGRMaXN0KCk7XHJcbiAgICAgICAgY29uc3QgciA9IGRhdGFUYWJsZS5HZXRSb3dMaXN0KClbMF07XHJcbiAgICAgICAgLy8g5Li76KGo5a2X5q61XHJcbiAgICAgICAgY29uc3QgcmRmbSA9IHIuR2V0RmllbGRNYXAoKTtcclxuXHJcbiAgICAgICAgLy8g5o+Q5Y+W5bGV56S65a2X5q61XHJcbiAgICAgICAgY29uc3QgZmZzID0gdGhpcy5leHRyYWN0RkZpZWxkcyhmcywgc2VsZWN0ZWRGaWVsZHMsIHNob3dDdXN0b21GaWVsZHMpO1xyXG4gICAgICAgIC8vIOiOt+WPluWtl+auteWAvFxyXG4gICAgICAgIC8vIOWFiOino+aekOWFtuS7luexu+Wei+Wtl+autVxyXG4gICAgICAgIGNvbnN0IGRlY2ltYWxGZnMgPSBbXTtcclxuICAgICAgICBmZnMuZm9yRWFjaChmZiA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmZi5kYXRhVHlwZSA9PSBEYXRhVHlwZS5EZWNpbWFsKSB7XHJcbiAgICAgICAgICAgICAgICBkZWNpbWFsRmZzLnB1c2goZmYpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRWYWx1ZSA9IHRoaXMuZ2V0RmllbGRWYWx1ZShmZiwgcmRmbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDlho3op6PmnpDmta7ngrnmlbDlrZfmrrVcclxuICAgICAgICBkZWNpbWFsRmZzLmZvckVhY2goZmYgPT4ge1xyXG4gICAgICAgICAgICBmZi5maWVsZFZhbHVlID0gdGhpcy5nZXRGaWVsZFZhbHVlKGZmLCByZGZtLCBmcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZmllbGRzV2l0aFZhbHVlLnB1c2goLi4uZmZzKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZpZWxkc1dpdGhWYWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0RXh0ZW5kUHJvcHMoZjogQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkLCBzZjogQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkLCBmaWVsZFBhdGg6IHN0cmluZywgcmRmbT86IHsgW2tleTogc3RyaW5nXTogQmlsbERhdGFGaWVsZDsgfSkge1xyXG4gICAgICAgIGYuY2FwdGlvblBhdGggPSB0aGlzLmV4dHJhY3RDYXB0aW9uUGF0aChmKTtcclxuICAgICAgICBmLmZpZWxkUGF0aCA9IGZpZWxkUGF0aDtcclxuICAgICAgICBpZiAoc2YpIHtcclxuICAgICAgICAgICAgZi5kaXNwbGF5TmFtZSA9IHNmLmRpc3BsYXlOYW1lO1xyXG4gICAgICAgICAgICBmLmkxOG5Db2xzID0gc2YuaTE4bkNvbHM7XHJcbiAgICAgICAgICAgIGYuZm9ybWF0SW5mbyA9IHNmLmZvcm1hdEluZm87XHJcbiAgICAgICAgICAgIGYub3JkZXIgPSBzZi5vcmRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJkZm0pIHtcclxuICAgICAgICAgICAgZi5maWVsZFZhbHVlID0gdGhpcy5nZXRGaWVsZFZhbHVlKGYsIHJkZm0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGY7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlrZfmrrXliJfooajmjIlvcmRlcuWxnuaAp+aOkuW6j1xyXG4gICAgICogQHBhcmFtIGZpZWxkc1dpdGhWYWx1ZSBcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc29ydEZpZWxkc0J5T3JkZXIoZmllbGRzV2l0aFZhbHVlOiAoQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKVtdKTogKEJpbGxTY2hlbWFGaWVsZCB8IEJpbGxTY2hlbWFTdWJGaWVsZClbXSB7XHJcbiAgICAgICAgcmV0dXJuIGZpZWxkc1dpdGhWYWx1ZS5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhLm9yZGVyICE9IG51bGwgJiYgYi5vcmRlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5vcmRlciAtIGIub3JkZXI7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5vcmRlciAhPSBudWxsICYmIGIub3JkZXIgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEub3JkZXIgPT0gbnVsbCAmJiBiLm9yZGVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBkYXRlRm9ybWF0KGRhdGU6IERhdGUsIGZtdDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgcmV0O1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHtcclxuICAgICAgICAgICAgXCJ5K1wiOiBkYXRlLmdldFVUQ0Z1bGxZZWFyKCkudG9TdHJpbmcoKSwgICAgICAgIC8vIOW5tFxyXG4gICAgICAgICAgICBcIk0rXCI6IChkYXRlLmdldFVUQ01vbnRoKCkgKyAxKS50b1N0cmluZygpLCAgICAgLy8g5pyIXHJcbiAgICAgICAgICAgIFwiZCtcIjogZGF0ZS5nZXRVVENEYXRlKCkudG9TdHJpbmcoKSwgICAgICAgICAgICAvLyDml6VcclxuICAgICAgICAgICAgXCJIK1wiOiBkYXRlLmdldFVUQ0hvdXJzKCkudG9TdHJpbmcoKSwgICAgICAgICAgIC8vIOaXtlxyXG4gICAgICAgICAgICBcIm0rXCI6IGRhdGUuZ2V0VVRDTWludXRlcygpLnRvU3RyaW5nKCksICAgICAgICAgLy8g5YiGXHJcbiAgICAgICAgICAgIFwicytcIjogZGF0ZS5nZXRVVENTZWNvbmRzKCkudG9TdHJpbmcoKSwgICAgICAgICAvLyDnp5JcclxuICAgICAgICAgICAgXCJTK1wiOiBkYXRlLmdldFVUQ01pbGxpc2Vjb25kcygpLnRvU3RyaW5nKCksICAgIC8vIOenklxyXG4gICAgICAgICAgICAvLyDmnInlhbbku5bmoLzlvI/ljJblrZfnrKbpnIDmsYLlj6/ku6Xnu6fnu63mt7vliqDvvIzlv4XpobvovazljJbmiJDlrZfnrKbkuLJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAobGV0IGsgaW4gb3B0KSB7XHJcbiAgICAgICAgICAgIHJldCA9IG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLmV4ZWMoZm10KTtcclxuICAgICAgICAgICAgaWYgKHJldCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLnBhZFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm10ID0gZm10LnJlcGxhY2UocmV0WzFdLCAocmV0WzFdLmxlbmd0aCA9PSAxKSA/IChvcHRba10pIDogKHRoaXMubXlQYWRTdGFydChvcHRba10sIHJldFsxXS5sZW5ndGgsIFwiMFwiKSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmbXQgPSBmbXQucmVwbGFjZShyZXRbMV0sIChyZXRbMV0ubGVuZ3RoID09IDEpID8gKG9wdFtrXSkgOiAob3B0W2tdLnBhZFN0YXJ0KHJldFsxXS5sZW5ndGgsIFwiMFwiKSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmbXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG15UGFkU3RhcnQoc3JjOiBzdHJpbmcsIHRhcmdldExlbmd0aDogbnVtYmVyLCBwYWRTdHJpbmc6IHN0cmluZykge1xyXG4gICAgICAgIHRhcmdldExlbmd0aCA9IHRhcmdldExlbmd0aCA+PiAwOyAvL2Zsb29yIGlmIG51bWJlciBvciBjb252ZXJ0IG5vbi1udW1iZXIgdG8gMDtcclxuICAgICAgICBwYWRTdHJpbmcgPSBTdHJpbmcodHlwZW9mIHBhZFN0cmluZyAhPT0gJ3VuZGVmaW5lZCcgPyBwYWRTdHJpbmcgOiAnICcpO1xyXG4gICAgICAgIGlmIChzcmMubGVuZ3RoID4gdGFyZ2V0TGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcoc3JjKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0YXJnZXRMZW5ndGggPSB0YXJnZXRMZW5ndGggLSBzcmMubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0TGVuZ3RoID4gcGFkU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGFkU3RyaW5nICs9IHBhZFN0cmluZy5yZXBlYXQodGFyZ2V0TGVuZ3RoIC8gcGFkU3RyaW5nLmxlbmd0aCk7IC8vYXBwZW5kIHRvIG9yaWdpbmFsIHRvIGVuc3VyZSB3ZSBhcmUgbG9uZ2VyIHRoYW4gbmVlZGVkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHBhZFN0cmluZy5zbGljZSgwLCB0YXJnZXRMZW5ndGgpICsgU3RyaW5nKHNyYyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6Kej5p6Q5a2X5q615ZCN56ewXHJcbiAgICAgKiBAcGFyYW0gZiBcclxuICAgICAqIEBwYXJhbSBsYW5nQ29kZSBcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0RmllbGRMYWJlbChmOiBCaWxsU2NoZW1hRmllbGQgfCBCaWxsU2NoZW1hU3ViRmllbGQsIGxhbmdDb2RlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIChsYW5nQ29kZSAmJiBmLmkxOG5Db2xzICYmIGYuaTE4bkNvbHMuY29sSTE4blZhbHVlcy5kaXNwbGF5TmFtZSAmJlxyXG4gICAgICAgICAgICBmLmkxOG5Db2xzLmNvbEkxOG5WYWx1ZXMuZGlzcGxheU5hbWVbbGFuZ0NvZGVdKSB8fCBmLmRpc3BsYXlOYW1lIHx8IGYuY2FwdGlvblBhdGggfHwgZi5jYXB0aW9uXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDop6PmnpDooajlkI3np7BcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldFRhYmxlTGFiZWwoYmlsbEluZm86IEJpbGxJbmZvLCBzY2hlbWFUYWJsZTogQmlsbFNjaGVtYVRhYmxlLCBsYW5nQ29kZT86IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuZ2V0QmlsbFRyYWNrZXJTY2hlbWEoYmlsbEluZm8pO1xyXG4gICAgICAgIGxldCB0YWJsZSA9IHNjaGVtYSAmJiBzY2hlbWFbc2NoZW1hVGFibGUudGFibGVOYW1lXTtcclxuICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBpMThuQ29scyA9IHRhYmxlLmkxOG5Db2xzO1xyXG4gICAgICAgICAgICBjb25zdCB0bXAgPSAobGFuZ0NvZGUgJiYgaTE4bkNvbHMgJiYgaTE4bkNvbHMuY29sSTE4blZhbHVlcy5kaXNwbGF5TmFtZSAmJiBpMThuQ29scy5jb2xJMThuVmFsdWVzLmRpc3BsYXlOYW1lW2xhbmdDb2RlXSkgfHwgdGFibGUuZGlzcGxheU5hbWUgfHwgdGFibGUuY2FwdGlvbiB8fCB0YWJsZS5jb2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gdG1wO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzY2hlbWFUYWJsZS5jYXB0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluino+aekOWPr+WxleekuuWtkOihqFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0Q2hpbGRUYWJsZXMoYmlsbEluZm86IEJpbGxJbmZvLCBzY2hlbWFUYWJsZTogQmlsbFNjaGVtYVRhYmxlKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdDogQmlsbFNjaGVtYVRhYmxlW10gPSBbXTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy5nZXRCaWxsVHJhY2tlclNjaGVtYShiaWxsSW5mbyk7XHJcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBzY2hlbWFUYWJsZS5HZXRDaGlsZFRhYmxlTGlzdCgpO1xyXG4gICAgICAgIGNoaWxkcmVuICYmIGNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0cmFja2VyVGFibGUgPSBzY2hlbWEgJiYgc2NoZW1hW2NoaWxkLnRhYmxlTmFtZV07XHJcbiAgICAgICAgICAgIGlmICh0cmFja2VyVGFibGUgIT0gbnVsbCAmJiB0cmFja2VyVGFibGUuc2hvdyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHJhY2tlclRhYmxlLnNob3cgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLm9yZGVyID0gdHJhY2tlclRhYmxlLm9yZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWFvOWuueaXoHNob3flsZ7mgKfmg4XlvaJcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXN1bHQgPSB0aGlzLnNvcnRUYWJsZXNCeU9yZGVyKHJlc3VsdCk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDooajmjIlzb3J05a2X5q615o6S5bqPXHJcbiAgICAgKiBAcGFyYW0gc2NoZW1hVGFibGVzIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzb3J0VGFibGVzQnlPcmRlcihzY2hlbWFUYWJsZXM6IEJpbGxTY2hlbWFUYWJsZVtdKTogQmlsbFNjaGVtYVRhYmxlW10ge1xyXG4gICAgICAgIHJldHVybiBzY2hlbWFUYWJsZXMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYS5vcmRlciAhPSBudWxsICYmIGIub3JkZXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEub3JkZXIgLSBiLm9yZGVyO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEub3JkZXIgIT0gbnVsbCAmJiBiLm9yZGVyID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhLm9yZGVyID09IG51bGwgJiYgYi5vcmRlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6Kej5p6QYmlsbFRyYWNrZXJTY2hlbWFcclxuICAgICAqIEBwYXJhbSBiaWxsSW5mbyBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEJpbGxUcmFja2VyU2NoZW1hKGJpbGxJbmZvOiBCaWxsSW5mbyk6IEJpbGxUcmFja2VyU2NoZW1hIHtcclxuICAgICAgICBsZXQgYnRzOiBCaWxsVHJhY2tpbmdTZXR0aW5ncyA9IG5ldyBCaWxsVHJhY2tpbmdTZXR0aW5ncygpO1xyXG4gICAgICAgIGlmIChiaWxsSW5mbyAmJiBiaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncykge1xyXG4gICAgICAgICAgICBidHMuTG9hZEZyb21Kc29uKGJpbGxJbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBmaWVsZENvbnRlbnQgPSBidHMuY3VzdG9tRmllbGRDb250ZW50O1xyXG4gICAgICAgIGxldCBmaWVsZENvbmZpZzogQmlsbFRyYWNrZXJTY2hlbWFGaWVsZENvbnRlbnQgPSBmaWVsZENvbnRlbnQgJiYgKHR5cGVvZiBmaWVsZENvbnRlbnQgPT0gXCJvYmplY3RcIiA/IGZpZWxkQ29udGVudCA6IEpTT04ucGFyc2UoZmllbGRDb250ZW50KSk7XHJcbiAgICAgICAgbGV0IHNjaGVtYSA9IGZpZWxkQ29uZmlnICYmIGZpZWxkQ29uZmlnLnNjaGVtYTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNjaGVtYTtcclxuICAgIH1cclxufSJdfQ==