/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/datepicker/datepicker.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Injector, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { ControlType } from '../../entity/controltype';
import { ShowType } from '@farris/ui-datepicker';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { QueryConditionComponent } from '../../querycondition.component';
export class DatePickerComponent {
    /**
     * @param {?} injector
     */
    constructor(injector) {
        this.injector = injector;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        // true显示时间 false不显示
        this.showType = ShowType.all; // 显示类型，默认显示全部1；不显示日期，用于选择年月模式2；不显示日期及月份，用于选择年模式3；用于周选择4。
        // 显示类型，默认显示全部1；不显示日期，用于选择年月模式2；不显示日期及月份，用于选择年模式3；用于周选择4。
        this.maxDate = '';
        this.minDate = '';
        this.editable = false;
        this.dateRangeDatesDelimiter = '~';
        this.solutionService = this.injector.get(SolutionService);
        /** @type {?} */
        const queryconditionComponent = this.injector.get(QueryConditionComponent, null);
        if (queryconditionComponent) {
            this.destroy$ = queryconditionComponent.destroy$;
        }
        else {
            this.destroy$ = new Subject();
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            const isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            field => field == this.item.fieldCode));
            if (isChange) {
                if (this.dateRange) {
                    this.beginValue = this.item.value && this.item.value.startTime ? this.item.value.startTime.toString().trim() : '';
                    this.endValue = this.item.value && this.item.value.endTime ? this.item.value.endTime.toString().trim() : '';
                    this.bindValue = this.item.value.getOriginalValue();
                }
                else {
                    this.bindValue = this.item.value.getOriginalValue();
                }
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.testId = this.solutionService.getGuid();
        // const controlType = this.item.control.getControlType();
        switch (this.controlType) {
            case ControlType.DateRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                this.dateRange = true;
                break;
            case ControlType.SingleDate:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                this.dateRange = false;
                break;
            case ControlType.SingleYear:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy';
                this.showType = ShowType.noDateAndMonth;
                this.dateRange = false;
                break;
            case ControlType.DateTimeRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd HH:mm:ss';
                if (this.item.control.enableCustomFormat) {
                    // 使用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd HH:mm:ss';
                }
                else {
                    // 未启用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                    this.dateFormat = this.dateFormat + ' HH:mm:ss';
                }
                this.showTime = true;
                this.dateRange = true;
                break;
            case ControlType.SingleMonth:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM';
                this.showType = ShowType.noDate;
                this.dateRange = false;
                break;
            case ControlType.MonthRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM';
                this.showType = ShowType.noDate;
                this.dateRange = true;
                break;
            case ControlType.SingleDateTime:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd HH:mm:ss';
                if (this.item.control.enableCustomFormat) {
                    // 使用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd HH:mm:ss';
                }
                else {
                    // 未启用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                    this.dateFormat = this.dateFormat + ' HH:mm:ss';
                }
                this.showTime = true;
                this.dateRange = false;
                break;
        }
        // 更新条件
        this.updateParamsByCondition();
        this.placeholder = this.item.placeHolder ? this.item.placeHolder : this.item.control.placeholder;
        if (this.dateRange) {
            this.beginValue = this.item.value && this.item.value.startTime ? this.item.value.startTime.toString().trim() : '';
            this.endValue = this.item.value && this.item.value.endTime ? this.item.value.endTime.toString().trim() : '';
            this.beginPlaceHolder = this.item.beginPlaceHolder ? this.item.beginPlaceHolder : this.placeholder;
            this.endPlaceHolder = this.item.endPlaceHolder ? this.item.endPlaceHolder : this.placeholder;
            this.bindValue = this.item.value.getOriginalValue();
        }
        else {
            this.bindValue = this.item.value.getOriginalValue();
        }
        if (this.item.control.weekSelect && this.controlType == ControlType.DateRange) {
            this.showType = ShowType.selectWeek;
        }
        // 
        this.solutionService.getControlConfigState().pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} simpleConditions
         * @return {?}
         */
        (simpleConditions) => {
            //简单条件
            /** @type {?} */
            let findSimpleCondition = simpleConditions.find((/**
             * @param {?} item
             * @return {?}
             */
            item => item['fieldCode'] == this.item['fieldCode']));
            if (findSimpleCondition) {
                this.updateParamsByCondition(findSimpleCondition);
            }
        }));
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
    }
    /**
     * @private
     * @param {?=} condition
     * @return {?}
     */
    updateParamsByCondition(condition = null) {
        /** @type {?} */
        let conditionControl = null;
        conditionControl = condition ? condition.control : this.item.control;
        switch (this.controlType) {
            case ControlType.SingleYear:
                this.maxDate = conditionControl.hasOwnProperty('maxDate') ? conditionControl['maxDate'] : this.maxDate;
                this.minDate = conditionControl.hasOwnProperty('minDate') ? conditionControl['minDate'] : this.minDate;
                break;
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onDateChange(event) {
        this.item.value.setOriginalValue({
            formatted: event.returnFormatted,
            delimiter: this.dateRangeDatesDelimiter
        });
        this.conditionChange.emit();
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    beginValueChange($event) {
        // this.beginValue = $event;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    endValueChange($event) {
        // this.endValue = $event;
    }
}
DatePickerComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-datepicker',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly,'datepicker-range-group':dateRange}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-datepicker *ngIf=\"!dateRange\"\r\n                [(ngModel)]=\"bindValue\"\r\n                [dateRange]=\"dateRange\"\r\n                [placeholder]=\"placeholder\"\r\n                [returnFormat]=\"returnFormat\"\r\n                [dateFormat]=\"dateFormat\"\r\n                [editable]=\"editable\"\r\n                [showType]=\"showType\"\r\n                [showTime]=\"showTime\"\r\n                [readonly]=\"item.readonly\"\r\n                (valueChange)=\"onDateChange($event)\"\r\n                [maxDate]=\"maxDate\"\r\n                [minDate]=\"minDate\"\r\n                id=\"{{testId}}\"\r\n            >\r\n            </farris-datepicker>\r\n            <farris-datepicker *ngIf=\"dateRange\"\r\n                [dateRange]=\"dateRange\"\r\n                [placeholder]=\"placeholder\"      \r\n                [beginPlaceholder]=\"beginPlaceHolder\"\r\n                [endPlaceholder]=\"endPlaceHolder\"\r\n                [returnFormat]=\"returnFormat\"\r\n                [dateFormat]=\"dateFormat\"\r\n                [editable]=\"editable\"\r\n                [showType]=\"showType\"\r\n                [showTime]=\"showTime\"\r\n                [readonly]=\"item.readonly\"\r\n                [(ngModel)]=\"bindValue\"\r\n                (valueChange)=\"onDateChange($event)\"\r\n                id=\"{{testId}}\"\r\n            >\r\n            </farris-datepicker>\r\n        </div>\r\n    </div>\r\n</div>\r\n"
            }] }
];
/** @nocollapse */
DatePickerComponent.ctorParameters = () => [
    { type: Injector }
];
DatePickerComponent.propDecorators = {
    item: [{ type: Input }],
    controlType: [{ type: Input }],
    changeFields: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }]
};
if (false) {
    /** @type {?} */
    DatePickerComponent.prototype.item;
    /** @type {?} */
    DatePickerComponent.prototype.controlType;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    DatePickerComponent.prototype.changeFields;
    /** @type {?} */
    DatePickerComponent.prototype.conditionChange;
    /** @type {?} */
    DatePickerComponent.prototype.solutionService;
    /** @type {?} */
    DatePickerComponent.prototype.dateRange;
    /** @type {?} */
    DatePickerComponent.prototype.showTime;
    /** @type {?} */
    DatePickerComponent.prototype.showType;
    /** @type {?} */
    DatePickerComponent.prototype.maxDate;
    /** @type {?} */
    DatePickerComponent.prototype.minDate;
    /** @type {?} */
    DatePickerComponent.prototype.disableDates;
    /** @type {?} */
    DatePickerComponent.prototype.placeholder;
    /** @type {?} */
    DatePickerComponent.prototype.dateFormat;
    /** @type {?} */
    DatePickerComponent.prototype.returnFormat;
    /** @type {?} */
    DatePickerComponent.prototype.returnType;
    /** @type {?} */
    DatePickerComponent.prototype.disabled;
    /** @type {?} */
    DatePickerComponent.prototype.readonly;
    /** @type {?} */
    DatePickerComponent.prototype.editable;
    /** @type {?} */
    DatePickerComponent.prototype.dateRangeDatesDelimiter;
    /** @type {?} */
    DatePickerComponent.prototype.bindValue;
    /** @type {?} */
    DatePickerComponent.prototype.beginValue;
    /** @type {?} */
    DatePickerComponent.prototype.endValue;
    /** @type {?} */
    DatePickerComponent.prototype.testId;
    /** @type {?} */
    DatePickerComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    DatePickerComponent.prototype.endPlaceHolder;
    /** @type {?} */
    DatePickerComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatePickerComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sY29tcG9uZW50L2RhdGVwaWNrZXIvZGF0ZXBpY2tlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsUUFBUSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBRTlILE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUVqRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2pELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNDLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBTXpFLE1BQU0sT0FBTyxtQkFBbUI7Ozs7SUFvQzlCLFlBQW9CLFFBQWtCO1FBQWxCLGFBQVEsR0FBUixRQUFRLENBQVU7Ozs7UUEzQjdCLGlCQUFZLEdBQWtCLEVBQUUsQ0FBQztRQUVmLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7UUFLaEUsYUFBUSxHQUFXLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyx5REFBeUQ7O1FBQzFGLFlBQU8sR0FBeUIsRUFBRSxDQUFDO1FBQ25DLFlBQU8sR0FBeUIsRUFBRSxDQUFDO1FBUW5DLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFDMUIsNEJBQXVCLEdBQVcsR0FBRyxDQUFDO1FBVXBDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFD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Q0FBbUM7O0lBQ25DLHNDQUFtQzs7SUFDbkMsMkNBQTZEOztJQUM3RCwwQ0FBb0I7O0lBQ3BCLHlDQUFtQjs7SUFDbkIsMkNBQXFCOztJQUNyQix5Q0FBbUI7O0lBQ25CLHVDQUFrQjs7SUFDbEIsdUNBQWtCOztJQUNsQix1Q0FBMEI7O0lBQzFCLHNEQUFzQzs7SUFDdEMsd0NBQWtCOztJQUNsQix5Q0FBZ0I7O0lBQ2hCLHVDQUFjOztJQUNkLHFDQUFlOztJQUNmLCtDQUF3Qjs7SUFDeEIsNkNBQXNCOztJQUN0Qix1Q0FBdUI7Ozs7O0lBRVgsdUNBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBPbkNoYW5nZXMsIEluamVjdG9yLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgU2ltcGxlQ2hhbmdlcywgT25EZXN0cm95IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3F1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuXHJcbmltcG9ydCB7IENvbnRyb2xUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlJztcclxuaW1wb3J0IHsgU2hvd1R5cGUgfSBmcm9tICdAZmFycmlzL3VpLWRhdGVwaWNrZXInO1xyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHRha2VVbnRpbCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb25Db21wb25lbnQgfSBmcm9tICcuLi8uLi9xdWVyeWNvbmRpdGlvbi5jb21wb25lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtc29sdXRpb24tZGF0ZXBpY2tlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2RhdGVwaWNrZXIuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0ZVBpY2tlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xyXG4gIC8vIOi/h+a7pOadoeS7tlxyXG4gIEBJbnB1dCgpIGl0ZW06IGFueTtcclxuICAvLyBcclxuICBASW5wdXQoKSBjb250cm9sVHlwZTogbnVtYmVyO1xyXG5cclxuICAvKipcclxuICAgKiDmn5DkuKrlrZfmrrXlj5HnlJ/lgLzlj5jljJbkuovku7bml7bvvIzpnIDopoHlkIzmraXmuIXnqbrnmoTlrZfmrrXvvIzlj6/og73kuI3mmK/lvZPliY3lrZfmrrVcclxuICAgKi9cclxuICBASW5wdXQoKSBjaGFuZ2VGaWVsZHM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuXHJcbiAgQE91dHB1dCgnY29uZGl0aW9uQ2hhbmdlJykgY29uZGl0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBzb2x1dGlvblNlcnZpY2U6IFNvbHV0aW9uU2VydmljZTtcclxuICBkYXRlUmFuZ2U6IGJvb2xlYW47IC8vIHRydWXljLrpl7QgZmFsc2XljZVcclxuICBzaG93VGltZTogYm9vbGVhbjsgLy8gdHJ1ZeaYvuekuuaXtumXtCBmYWxzZeS4jeaYvuekulxyXG4gIHNob3dUeXBlOiBudW1iZXIgPSBTaG93VHlwZS5hbGw7IC8vIOaYvuekuuexu+Wei++8jOm7mOiupOaYvuekuuWFqOmDqDHvvJvkuI3mmL7npLrml6XmnJ/vvIznlKjkuo7pgInmi6nlubTmnIjmqKHlvI8y77yb5LiN5pi+56S65pel5pyf5Y+K5pyI5Lu977yM55So5LqO6YCJ5oup5bm05qih5byPM++8m+eUqOS6juWRqOmAieaLqTTjgIJcclxuICBtYXhEYXRlOiBzdHJpbmcgfCBEYXRlIHwgbnVsbCA9ICcnO1xyXG4gIG1pbkRhdGU6IHN0cmluZyB8IERhdGUgfCBudWxsID0gJyc7XHJcbiAgZGlzYWJsZURhdGVzOiB7IHllYXI6IG51bWJlciwgbW9udGg6IG51bWJlciwgZGF5OiBudW1iZXIgfVtdO1xyXG4gIHBsYWNlaG9sZGVyOiBzdHJpbmc7XHJcbiAgZGF0ZUZvcm1hdDogc3RyaW5nOyAvLyDmmL7npLrlgLzml6XmnJ/moLzlvI/ljJZcclxuICByZXR1cm5Gb3JtYXQ6IHN0cmluZzsgLy8g6L+U5Zue5YC85pel5pyf5qC85byP5YyWXHJcbiAgcmV0dXJuVHlwZTogc3RyaW5nOyAvLyDov5Tlm57lgLznsbvlnovvvIzov5Tlm57lgLznsbvlnovpu5jorqTmg4XlhrXkuIvmmK/lkozovpPlhaXlgLznsbvlnovnm7jlkIzvvIzkvYbmmK/lpoLmnpzovpPlhaXlgLzkuLpudWxs562J6Z2e5rOV5YC877yM6buY6K6k5Li6U3RyaW5n77yM5aaC5p6c5oOz5pS55Li6RGF0Ze+8jOWumuS5ieivpeWtl+auteOAglxyXG4gIGRpc2FibGVkOiBib29sZWFuO1xyXG4gIHJlYWRvbmx5OiBib29sZWFuO1xyXG4gIGVkaXRhYmxlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgZGF0ZVJhbmdlRGF0ZXNEZWxpbWl0ZXI6IHN0cmluZyA9ICd+JztcclxuICBiaW5kVmFsdWU6IHN0cmluZztcclxuICBiZWdpblZhbHVlOiBhbnk7XHJcbiAgZW5kVmFsdWU6IGFueTtcclxuICB0ZXN0SWQ6IHN0cmluZztcclxuICBiZWdpblBsYWNlSG9sZGVyOnN0cmluZztcclxuICBlbmRQbGFjZUhvbGRlcjpzdHJpbmc7XHJcbiAgZGVzdHJveSQ6IFN1YmplY3Q8YW55PjtcclxuICBcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3Rvcikge1xyXG4gICAgdGhpcy5zb2x1dGlvblNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChTb2x1dGlvblNlcnZpY2UpO1xyXG4gICAgY29uc3QgcXVlcnljb25kaXRpb25Db21wb25lbnQgPSB0aGlzLmluamVjdG9yLmdldChRdWVyeUNvbmRpdGlvbkNvbXBvbmVudCwgbnVsbCk7XHJcbiAgICBpZihxdWVyeWNvbmRpdGlvbkNvbXBvbmVudCkge1xyXG4gICAgICB0aGlzLmRlc3Ryb3kkID0gcXVlcnljb25kaXRpb25Db21wb25lbnQuZGVzdHJveSQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmRlc3Ryb3kkID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGlmIChjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXSAmJiBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUgJiYgIWNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmZpcnN0Q2hhbmdlKSB7XHJcbiAgICAgIGNvbnN0IGlzQ2hhbmdlID0gY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlLnNvbWUoZmllbGQgPT4gZmllbGQgPT0gdGhpcy5pdGVtLmZpZWxkQ29kZSk7XHJcbiAgICAgIGlmIChpc0NoYW5nZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgdGhpcy5iZWdpblZhbHVlID0gdGhpcy5pdGVtLnZhbHVlICYmIHRoaXMuaXRlbS52YWx1ZS5zdGFydFRpbWUgPyB0aGlzLml0ZW0udmFsdWUuc3RhcnRUaW1lLnRvU3RyaW5nKCkudHJpbSgpIDogJyc7XHJcbiAgICAgICAgICB0aGlzLmVuZFZhbHVlID0gdGhpcy5pdGVtLnZhbHVlICYmIHRoaXMuaXRlbS52YWx1ZS5lbmRUaW1lID8gdGhpcy5pdGVtLnZhbHVlLmVuZFRpbWUudG9TdHJpbmcoKS50cmltKCkgOiAnJztcclxuICAgICAgICAgIHRoaXMuYmluZFZhbHVlID0gdGhpcy5pdGVtLnZhbHVlLmdldE9yaWdpbmFsVmFsdWUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5iaW5kVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgIC8vIGNvbnN0IGNvbnRyb2xUeXBlID0gdGhpcy5pdGVtLmNvbnRyb2wuZ2V0Q29udHJvbFR5cGUoKTtcclxuICAgIHN3aXRjaCAodGhpcy5jb250cm9sVHlwZSkge1xyXG4gICAgICBjYXNlIENvbnRyb2xUeXBlLkRhdGVSYW5nZTpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0tZGQnO1xyXG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkJztcclxuICAgICAgICB0aGlzLmRhdGVSYW5nZSA9IHRydWU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuU2luZ2xlRGF0ZTpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0tZGQnO1xyXG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkJztcclxuICAgICAgICB0aGlzLmRhdGVSYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIENvbnRyb2xUeXBlLlNpbmdsZVllYXI6XHJcbiAgICAgICAgdGhpcy5yZXR1cm5Gb3JtYXQgPSB0aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ/dGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0Oid5eXl5JztcclxuICAgICAgICB0aGlzLmRhdGVGb3JtYXQgPSB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgPyB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgOiAneXl5eSc7XHJcbiAgICAgICAgdGhpcy5zaG93VHlwZSA9IFNob3dUeXBlLm5vRGF0ZUFuZE1vbnRoO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuRGF0ZVRpbWVSYW5nZTpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0tZGQgSEg6bW06c3MnO1xyXG4gICAgICAgIGlmKHRoaXMuaXRlbS5jb250cm9sLmVuYWJsZUN1c3RvbUZvcm1hdCl7XHJcbiAgICAgICAgICAvLyDkvb/nlKjoh6rlrprkuYnmoLzlvI9cclxuICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkIEhIOm1tOnNzJztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAvLyDmnKrlkK/nlKjoh6rlrprkuYnmoLzlvI9cclxuICAgICAgICAgICB0aGlzLmRhdGVGb3JtYXQgPSB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgPyB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgOiAneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5kYXRlRm9ybWF0ICsgJyBISDptbTpzcyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd1RpbWUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5TaW5nbGVNb250aDpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0nO1xyXG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NJztcclxuICAgICAgICB0aGlzLnNob3dUeXBlID0gU2hvd1R5cGUubm9EYXRlO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuTW9udGhSYW5nZTpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0nO1xyXG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NJztcclxuICAgICAgICB0aGlzLnNob3dUeXBlID0gU2hvd1R5cGUubm9EYXRlO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5TaW5nbGVEYXRlVGltZTpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXktTU0tZGQgSEg6bW06c3MnO1xyXG4gICAgICAgIGlmKHRoaXMuaXRlbS5jb250cm9sLmVuYWJsZUN1c3RvbUZvcm1hdCl7XHJcbiAgICAgICAgICAvLyDkvb/nlKjoh6rlrprkuYnmoLzlvI9cclxuICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkIEhIOm1tOnNzJztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAvLyDmnKrlkK/nlKjoh6rlrprkuYnmoLzlvI9cclxuICAgICAgICAgICB0aGlzLmRhdGVGb3JtYXQgPSB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgPyB0aGlzLml0ZW0uY29udHJvbC5mb3JtYXQgOiAneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5kYXRlRm9ybWF0ICsgJyBISDptbTpzcyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd1RpbWUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICAvLyDmm7TmlrDmnaHku7ZcclxuICAgIHRoaXMudXBkYXRlUGFyYW1zQnlDb25kaXRpb24oKTtcclxuICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLml0ZW0ucGxhY2VIb2xkZXIgPyB0aGlzLml0ZW0ucGxhY2VIb2xkZXIgOiB0aGlzLml0ZW0uY29udHJvbC5wbGFjZWhvbGRlcjtcclxuICAgIGlmICh0aGlzLmRhdGVSYW5nZSkge1xyXG4gICAgICB0aGlzLmJlZ2luVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUgJiYgdGhpcy5pdGVtLnZhbHVlLnN0YXJ0VGltZSA/IHRoaXMuaXRlbS52YWx1ZS5zdGFydFRpbWUudG9TdHJpbmcoKS50cmltKCkgOiAnJztcclxuICAgICAgdGhpcy5lbmRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZSAmJiB0aGlzLml0ZW0udmFsdWUuZW5kVGltZSA/IHRoaXMuaXRlbS52YWx1ZS5lbmRUaW1lLnRvU3RyaW5nKCkudHJpbSgpIDogJyc7XHJcbiAgICAgIHRoaXMuYmVnaW5QbGFjZUhvbGRlciA9IHRoaXMuaXRlbS5iZWdpblBsYWNlSG9sZGVyID8gdGhpcy5pdGVtLmJlZ2luUGxhY2VIb2xkZXIgOiB0aGlzLnBsYWNlaG9sZGVyO1xyXG4gICAgICB0aGlzLmVuZFBsYWNlSG9sZGVyID0gdGhpcy5pdGVtLmVuZFBsYWNlSG9sZGVyID8gdGhpcy5pdGVtLmVuZFBsYWNlSG9sZGVyIDogdGhpcy5wbGFjZWhvbGRlcjtcclxuICAgICAgdGhpcy5iaW5kVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5iaW5kVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAodGhpcy5pdGVtLmNvbnRyb2wud2Vla1NlbGVjdCAmJiB0aGlzLmNvbnRyb2xUeXBlID09IENvbnRyb2xUeXBlLkRhdGVSYW5nZSkge1xyXG4gICAgICB0aGlzLnNob3dUeXBlID0gU2hvd1R5cGUuc2VsZWN0V2VlaztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gXHJcbiAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb250cm9sQ29uZmlnU3RhdGUoKS5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSkuc3Vic2NyaWJlKChzaW1wbGVDb25kaXRpb25zKSA9PiB7XHJcbiAgICAgIC8v566A5Y2V5p2h5Lu2XHJcbiAgICAgIGxldCBmaW5kU2ltcGxlQ29uZGl0aW9uID0gc2ltcGxlQ29uZGl0aW9ucy5maW5kKGl0ZW0gPT4gaXRlbVsnZmllbGRDb2RlJ10gPT0gdGhpcy5pdGVtWydmaWVsZENvZGUnXSk7XHJcbiAgICAgIGlmIChmaW5kU2ltcGxlQ29uZGl0aW9uKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVQYXJhbXNCeUNvbmRpdGlvbihmaW5kU2ltcGxlQ29uZGl0aW9uKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZVBhcmFtc0J5Q29uZGl0aW9uKGNvbmRpdGlvbiA9IG51bGwpIHtcclxuICAgIGxldCBjb25kaXRpb25Db250cm9sID0gbnVsbDtcclxuICAgIGNvbmRpdGlvbkNvbnRyb2wgPSBjb25kaXRpb24gPyBjb25kaXRpb24uY29udHJvbCA6IHRoaXMuaXRlbS5jb250cm9sO1xyXG4gICAgc3dpdGNoICh0aGlzLmNvbnRyb2xUeXBlKSB7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuU2luZ2xlWWVhcjpcclxuICAgICAgICB0aGlzLm1heERhdGUgPSBjb25kaXRpb25Db250cm9sLmhhc093blByb3BlcnR5KCdtYXhEYXRlJykgPyBjb25kaXRpb25Db250cm9sWydtYXhEYXRlJ10gOiB0aGlzLm1heERhdGU7XHJcbiAgICAgICAgdGhpcy5taW5EYXRlID0gY29uZGl0aW9uQ29udHJvbC5oYXNPd25Qcm9wZXJ0eSgnbWluRGF0ZScpID8gY29uZGl0aW9uQ29udHJvbFsnbWluRGF0ZSddIDogdGhpcy5taW5EYXRlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBvbkRhdGVDaGFuZ2UoZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5pdGVtLnZhbHVlLnNldE9yaWdpbmFsVmFsdWUoe1xyXG4gICAgICBmb3JtYXR0ZWQ6IGV2ZW50LnJldHVybkZvcm1hdHRlZCxcclxuICAgICAgZGVsaW1pdGVyOiB0aGlzLmRhdGVSYW5nZURhdGVzRGVsaW1pdGVyXHJcbiAgICB9KTtcclxuICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDogUXVlcnlDb25kaXRpb24pIHtcclxuICAgIHJldHVybiB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQpO1xyXG4gIH1cclxuXHJcbiAgYmVnaW5WYWx1ZUNoYW5nZSgkZXZlbnQpIHtcclxuICAgLy8gdGhpcy5iZWdpblZhbHVlID0gJGV2ZW50O1xyXG4gIH1cclxuXHJcbiAgZW5kVmFsdWVDaGFuZ2UoJGV2ZW50KSB7XHJcbiAgIC8vIHRoaXMuZW5kVmFsdWUgPSAkZXZlbnQ7XHJcbiAgfVxyXG59XHJcbiJdfQ==