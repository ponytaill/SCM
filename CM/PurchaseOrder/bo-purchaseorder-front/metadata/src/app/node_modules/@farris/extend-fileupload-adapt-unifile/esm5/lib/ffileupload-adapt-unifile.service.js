/**
 * @fileoverview added by tsickle
 * Generated from: lib/ffileupload-adapt-unifile.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { UploadServerService, UploadStatus } from '@farris/extend-file-upload';
import { Observable, forkJoin, of, EMPTY, concat, Subject } from 'rxjs';
import { UploadService, GspFormUploadListEntity, GspFormRemoveListEntity, GspFormDocInfo, GspFormUploadEntity, OperatingModes } from '@gsp-svc/formdoc-upload';
import { FFileUploadAdaptUnifileConfigService } from './ffileupload-adapt-unifile.config';
import { catchError, delay, expand, last, map, switchMap } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@gsp-svc/formdoc-upload";
import * as i2 from "./ffileupload-adapt-unifile.config";
var FfileuploadAdaptUnifileService = /** @class */ (function (_super) {
    tslib_1.__extends(FfileuploadAdaptUnifileService, _super);
    function FfileuploadAdaptUnifileService(uploadSer, configSer) {
        var _this = _super.call(this) || this;
        _this.uploadSer = uploadSer;
        _this.configSer = configSer;
        // 暂时用于简单合并
        _this.bufferSize = 1024 * 1024;
        _this.uploadedChunk = {};
        _this.fileTotalChunk = {};
        _this.extendData = _this.configSer.getConfig();
        return _this;
    }
    /**
     * @private
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.uuid = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var S4 = (/**
         * @return {?}
         */
        function () {
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        });
        /** @type {?} */
        var nGuid = S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4();
        return nGuid;
    };
    /**
     * 删除文件
     * @param file
     * @param event
     */
    /**
     * 删除文件
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.remove = /**
     * 删除文件
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (files, event, extendService) {
        return this.innerRemoveList(files, event, extendService);
    };
    /**
     * @private
     * @param {?} files
     * @param {?} event
     * @param {?=} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.innerRemoveList = /**
     * @private
     * @param {?} files
     * @param {?} event
     * @param {?=} extendService
     * @return {?}
     */
    function (files, event, extendService) {
        var _this = this;
        if (extendService === void 0) { extendService = null; }
        return new Observable((/**
         * @param {?} observer
         * @return {?}
         */
        function (observer) {
            /** @type {?} */
            var removeFileInfo = new GspFormRemoveListEntity;
            /** @type {?} */
            var metadataIdList = [];
            files.forEach((/**
             * @param {?} fileItem
             * @return {?}
             */
            function (fileItem) {
                if (fileItem['response']) {
                    metadataIdList.push(fileItem['response']['metadataId']);
                }
            }));
            removeFileInfo.mode = _this.getFinallyConfig('mode', extendService);
            /** @type {?} */
            var rootId = _this.getFinallyConfig('rootId', extendService);
            removeFileInfo.metadataIdList = [].concat(metadataIdList);
            _this.uploadSer.removeList(metadataIdList, rootId).subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                // 没有需要整合的服务器端返回数据
                observer.next({ type: 'removed', files: files });
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                observer.error(error);
                observer.complete();
            }), (/**
             * @return {?}
             */
            function () {
                observer.complete();
            }));
        }));
    };
    /**
     * 上传文件
     * @param file
     * @param event
     */
    /**
     * 上传文件
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.upload = /**
     * 上传文件
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (files, event, extendService) {
        if (event.type == 'sliceUpload') {
            return this.uploadBigFile(files, event, extendService);
        }
        return this.innerUploadList(files, event, extendService);
    };
    /**
     * 内部上传方式
     * @param files
     * @param event
     * @param extendService
     */
    /**
     * 内部上传方式
     * @private
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.innerUploadList = /**
     * 内部上传方式
     * @private
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (files, event, extendService) {
        var _this = this;
        return new Observable((/**
         * @param {?} observer
         * @return {?}
         */
        function (observer) {
            /** @type {?} */
            var uploadInfo = new GspFormUploadListEntity;
            uploadInfo.formId = _this.getFinallyConfig('formId', extendService);
            uploadInfo.mode = _this.getFinallyConfig('mode', extendService);
            /** @type {?} */
            var rootId = _this.getFinallyConfig('rootId', extendService);
            uploadInfo.docInfoList = [];
            /** @type {?} */
            var readerObserable = [];
            files.forEach((/**
             * @param {?} fileItem
             * @return {?}
             */
            function (fileItem) {
                /** @type {?} */
                var sub = new Observable((/**
                 * @param {?} obser
                 * @return {?}
                 */
                function (obser) {
                    /** @type {?} */
                    var reader = new FileReader();
                    // 暂不处理异常
                    reader.readAsBinaryString(fileItem.nativeFile);
                    reader.onload = (/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) {
                        /** @type {?} */
                        var info = (/** @type {?} */ ({ 'fileName': '', 'fileContent': '' }));
                        info['fileName'] = fileItem.name;
                        info['fileContent'] = btoa(reader.result.toString());
                        // 如果data里有数据，并且属性是配置的扩展属性
                        if (event.hasOwnProperty('data') && event['data'] && event['data'].hasOwnProperty('extProperty')) {
                            // 
                            info['extProperty'] = event['data']['extProperty'];
                        }
                        uploadInfo.docInfoList.push(info);
                        obser.next();
                        obser.complete();
                    });
                }));
                readerObserable.push(sub);
            }));
            forkJoin(readerObserable).subscribe((/**
             * @param {?} datas
             * @return {?}
             */
            function (datas) {
                //     metadataId: string;
                //  fileName: string;
                _this.uploadSer.uploadList(uploadInfo, rootId).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    if (result.error) {
                        // 此接口一旦出现问题，所有附件都上传不通过
                        observer.error(_this.errorInfoFormat(result.error, files));
                        observer.complete();
                        return;
                    }
                    // 合并返回结果到此处
                    result.forEach((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) {
                        /** @type {?} */
                        var findIndex = _this.findFileIndexByFileName(files, item.fileName);
                        if (findIndex > -1) {
                            files[findIndex]['response'] = item;
                            files[findIndex]['progress']['status'] = UploadStatus.Done;
                        }
                    }));
                    observer.next({ type: 'done', files: files });
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    observer.error(_this.errorInfoFormat(error, files));
                    observer.complete();
                }), (/**
                 * @return {?}
                 */
                function () {
                    observer.complete();
                }));
            }));
        }));
    };
    ;
    /**
     * 分片加载
     * @param file
     * @param event
     * @param extendService
     */
    /**
     * 分片加载
     * @param {?} file
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.multipartUpload = /**
     * 分片加载
     * @param {?} file
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (file, event, extendService) {
        var _this = this;
        return new Observable((/**
         * @param {?} observer
         * @return {?}
         */
        function (observer) {
            // let fileInfo: FileInfo;
            /** @type {?} */
            var uuid = _this.uuid();
            // let uuid = UUID.UUID();
            //reader.readAsBinaryString(selectedFile);
            //reader.onload = (e) => {
            /** @type {?} */
            var fileName = file.name;
            // fileInfo = {
            //   id: uuid,
            //   name: fileName,
            //   type: file.type,
            //   source: "",
            //   size: this.formatFileSize(file.size),
            //   fileSize: file.size,
            //   picListDisplayName: this.getMultipartDisplayName(fileName),
            //   queueListDisplayName: fileName,
            //   //content: reader.result.toString(),
            //   hasUploaded: false,
            //   mouseOn: false,
            //   selectd: false,
            //   isUploading: true,
            //   uploadResult: false,
            //   uploadProcess: 0,
            //   errorMessage: "",
            //   extensionDropListId: 0,
            //   extensionName: ""
            // }
            /** @type {?} */
            var chunkTotal = Math.ceil(file.size / _this.bufferSize);
            // 标记当前附件总的分片数
            _this.fileTotalChunk[uuid] = chunkTotal;
            /** @type {?} */
            var chunkIndex = 0;
            // 标记当前附件成功的分片数
            _this.uploadedChunk[uuid] = 0;
            var _loop_1 = function () {
                /** @type {?} */
                var uploadInfo = new GspFormUploadEntity;
                uploadInfo.mode = OperatingModes.Temp;
                uploadInfo.formId = _this.getFinallyConfig('formId', extendService);
                uploadInfo.rootId = _this.getFinallyConfig('rootId', extendService);
                /** @type {?} */
                var docInfo = new GspFormDocInfo;
                docInfo.fileName = fileName;
                docInfo.metadataId = uuid;
                docInfo.total = chunkTotal;
                // 如果data里有数据，并且属性是配置的扩展属性
                if (event.hasOwnProperty('data') && event['data'] && event['data'].hasOwnProperty('extProperty')) {
                    docInfo['extProperty'] = (/** @type {?} */ (event['data']['extProperty']));
                }
                // 下一个文件大小
                /** @type {?} */
                var nextSize = Math.min((chunkIndex + 1) * _this.bufferSize, file.size);
                // File类型
                /** @type {?} */
                var fileData = file['nativeFile'].slice(chunkIndex * _this.bufferSize, nextSize);
                // 读取文件
                /** @type {?} */
                var reader = new FileReader();
                reader.readAsBinaryString(fileData);
                /** @type {?} */
                var innerIndex = chunkIndex;
                reader.onload = (/**
                 * @return {?}
                 */
                function () {
                    // 附件上传
                    docInfo.fileContent = btoa(reader.result.toString());
                    docInfo.index = innerIndex;
                    uploadInfo.docInfo = docInfo;
                    /** @type {?} */
                    var info = uploadInfo;
                    _this.uploadSer.uploadFile(info).subscribe((/**
                     * @param {?} result
                     * @return {?}
                     */
                    function (result) {
                        if (result && result.error) {
                            // 分片上传有返回结果就是报错了
                            observer.error(_this.errorInfoFormat(result.error, [file]));
                            observer.complete();
                            return;
                        }
                        else {
                            _this.uploadedChunk[uuid]++;
                            if (_this.uploadedChunk[docInfo.metadataId] == _this.fileTotalChunk[docInfo.metadataId]) {
                                // 判断是所有分片都上传完成
                                file.progress = {
                                    status: UploadStatus.Done,
                                    data: {
                                        percentage: 100
                                    }
                                };
                                file.response = docInfo;
                                delete _this.uploadedChunk[uuid];
                                delete _this.fileTotalChunk[uuid];
                                observer.next({ type: 'done', files: [file] });
                                observer.complete();
                            }
                            else {
                                // 分片上传正常
                                /** @type {?} */
                                var percentage = Number.parseInt((_this.uploadedChunk[uuid] / _this.fileTotalChunk[uuid] * 100).toFixed(0));
                                // 判断未上传完成
                                file.progress = {
                                    status: UploadStatus.Uploading,
                                    data: {
                                        percentage: percentage
                                    }
                                };
                                observer.next({ type: 'uploading', files: [file] });
                            }
                        }
                    }), (/**
                     * @param {?} error
                     * @return {?}
                     */
                    function (error) {
                        delete _this.uploadedChunk[uuid];
                        delete _this.fileTotalChunk[uuid];
                        observer.error(_this.errorInfoFormat(error, [file]));
                        observer.complete();
                    }));
                });
                chunkIndex = chunkIndex + 1;
            };
            while (chunkIndex < chunkTotal) {
                _loop_1();
            }
        }));
    };
    /**
     * 获取分片的附件大小
     * @param size
     */
    /**
     * 获取分片的附件大小
     * @private
     * @param {?} size
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.formatFileSize = /**
     * 获取分片的附件大小
     * @private
     * @param {?} size
     * @return {?}
     */
    function (size) {
        if (size < 102400)
            return (size / 1024).toFixed(1) + "K";
        else if (size < 1024 * 1024)
            return (size / 1024).toFixed(0) + "K";
        else if (size < 100 * 1024 * 1024)
            return (size / 1024 / 1024).toFixed(1) + "M";
        else if (size < 1024 * 1024 * 1024)
            return (size / 1024 / 1024).toFixed(0) + "M";
        else
            return (size / 1024 / 1024 / 1024).toFixed(1) + "G";
    };
    /**
     * 获取分片的 附件名称
     * @param fileName
     */
    /**
     * 获取分片的 附件名称
     * @private
     * @param {?} fileName
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.getMultipartDisplayName = /**
     * 获取分片的 附件名称
     * @private
     * @param {?} fileName
     * @return {?}
     */
    function (fileName) {
        if (fileName.length <= 10)
            return fileName;
        else {
            /** @type {?} */
            var headContent = fileName.substring(0, 2);
            /** @type {?} */
            var tailContent = fileName.substring(fileName.lastIndexOf('.') - 2);
            return headContent + "…" + tailContent;
        }
    };
    /**
     * @private
     * @param {?} error
     * @param {?} files
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.errorInfoFormat = /**
     * @private
     * @param {?} error
     * @param {?} files
     * @return {?}
     */
    function (error, files) {
        // 
        /** @type {?} */
        var errorFiles = files.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return { id: item.id, name: item.name };
        }));
        if (error) {
            return Object.assign(error, { files: errorFiles }, { message: error['Message'] || error['extensionMessage'] || '上传失败', type: 'error' });
        }
        else {
            return Object.assign({ files: errorFiles }, { message: '上传失败', type: 'error' });
        }
    };
    /**
     * 返回最终属性值
     * @param key
     * @param configValue
     * @param extendValue
     */
    /**
     * 返回最终属性值
     * @private
     * @param {?} key
     * @param {?} extendValue
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.getFinallyConfig = /**
     * 返回最终属性值
     * @private
     * @param {?} key
     * @param {?} extendValue
     * @return {?}
     */
    function (key, extendValue) {
        if (extendValue && extendValue.hasOwnProperty(key)) {
            return extendValue[key];
        }
        return this.extendData[key];
    };
    /**
     * @private
     * @param {?} files
     * @param {?} fileName
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.findFileIndexByFileName = /**
     * @private
     * @param {?} files
     * @param {?} fileName
     * @return {?}
     */
    function (files, fileName) {
        // 按照肯定能找到文件来处理
        /** @type {?} */
        var findIndex = files.findIndex((/**
         * @param {?} file
         * @return {?}
         */
        function (file) { return file.name == fileName; }));
        return findIndex;
    };
    //#region 大文件分片上传
    //#region 大文件分片上传
    /**
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.uploadBigFile = 
    //#region 大文件分片上传
    /**
     * @param {?} files
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (files, event, extendService) {
        var _this = this;
        /** @type {?} */
        var uploadChunks$ = new Subject();
        /** @type {?} */
        var _files = files.map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            /** @type {?} */
            var chunks = _this._getBigFileChunks(n, event, extendService);
            return tslib_1.__assign({}, n, chunks);
        }));
        /** @type {?} */
        var uploadchunks$ = _files.map((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return _this.uploadChunks(f, uploadChunks$); }));
        concat.apply(void 0, tslib_1.__spread(uploadchunks$)).subscribe((/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            // console.log(`file: ${f.name} - upload complete`);
            f.progress = {
                status: UploadStatus.Done,
                data: {
                    percentage: 100
                }
            };
            f.response = JSON.parse(f.chunks[0].get('docInfo'));
            uploadChunks$.next({ type: 'done', files: [f] });
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            uploadChunks$.error(_this.errorInfoFormat(error, files));
            uploadChunks$.complete();
        }), (/**
         * @return {?}
         */
        function () {
            uploadChunks$.complete();
            // console.log("all files uploaded")
        }));
        return uploadChunks$.asObservable();
    };
    /**
     * @private
     * @param {?} file
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.uploadFileChunk = /**
     * @private
     * @param {?} file
     * @return {?}
     */
    function (file) {
        /** @type {?} */
        var url = "/api/runtime/dfs/v1.0/formdoc/slice";
        return this.uploadSer['http']['http'].post(url, file.chunks[file.total]).pipe(switchMap((/**
         * @return {?}
         */
        function () {
            return of(file);
        })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            return of(error);
        })));
    };
    /**
     * @private
     * @param {?} file
     * @param {?} upChunk$
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype.uploadChunks = /**
     * @private
     * @param {?} file
     * @param {?} upChunk$
     * @return {?}
     */
    function (file, upChunk$) {
        var _this = this;
        /** @type {?} */
        var doChunksRemain = (/**
         * @param {?} i
         * @return {?}
         */
        function (i) { return i > -1; });
        /** @type {?} */
        var completeUpload = (/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return of(f); });
        /** @type {?} */
        var uploadChunk = (/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            return _this.uploadFileChunk(f).pipe(delay(100), map((/**
             * @param {?} f
             * @return {?}
             */
            function (f) {
                // 块数为0 时，即为此文件的所有块均上传成功
                f.progress = {
                    status: UploadStatus.Uploading,
                    data: {
                        percentage: (f.total / f.chunks.length * 100).toFixed(0)
                    }
                };
                upChunk$.next({ type: 'uploading', files: [f] });
                return f;
            })));
        });
        /** @type {?} */
        var createMultipartUpload = (/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return of(f); });
        return createMultipartUpload(file).pipe(
        // tap((f) => console.log("upload file", f.name)),
        expand((/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            if (doChunksRemain(--file.total)) {
                return uploadChunk(file);
            }
            return EMPTY;
        })), 
        // tap((f: any) => {
        //     console.log(`file: ${f.name} - remaining chunks: ${f.total}`);
        // }),
        last(), switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            return completeUpload(file);
        })));
    };
    /**
     * @private
     * @param {?} file
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    FfileuploadAdaptUnifileService.prototype._getBigFileChunks = /**
     * @private
     * @param {?} file
     * @param {?} event
     * @param {?} extendService
     * @return {?}
     */
    function (file, event, extendService) {
        /** @type {?} */
        var uuid = this.uuid();
        /** @type {?} */
        var chunkTotal = Math.ceil(file.size / this.bufferSize * (event.chunkSize || 1));
        /** @type {?} */
        var chunkIndex = 0;
        /** @type {?} */
        var fileChunks = { chunks: [], total: chunkTotal };
        while (chunkIndex < chunkTotal) {
            /** @type {?} */
            var uploadInfo = new GspFormUploadEntity;
            uploadInfo.mode = OperatingModes.Temp;
            uploadInfo.formId = this.getFinallyConfig('formId', extendService);
            uploadInfo.rootId = this.getFinallyConfig('rootId', extendService);
            /** @type {?} */
            var docInfo = new GspFormDocInfo;
            docInfo.fileName = file.name;
            docInfo.metadataId = uuid;
            docInfo.total = chunkTotal;
            /** @type {?} */
            var nextSize = Math.min((chunkIndex + 1) * this.bufferSize, file.size);
            // File类型
            /** @type {?} */
            var fileData = file['nativeFile'].slice(chunkIndex * this.bufferSize, nextSize);
            docInfo.size = file.size;
            docInfo.index = chunkIndex;
            docInfo.fileContent = "";
            // 如果data里有数据，并且属性是配置的扩展属性
            if (event.hasOwnProperty('data') && event['data'] && event['data'].hasOwnProperty('extProperty')) {
                docInfo['extProperty'] = (/** @type {?} */ (event['data']['extProperty']));
            }
            uploadInfo.docInfo = docInfo;
            //封装请求formdata
            /** @type {?} */
            var formData = new FormData();
            formData.append('uploadInfo', JSON.stringify(uploadInfo));
            formData.append('docInfo', JSON.stringify(docInfo));
            formData.append('file', fileData);
            fileChunks.chunks.push(formData);
            chunkIndex = chunkIndex + 1;
        }
        return fileChunks;
    };
    FfileuploadAdaptUnifileService.previous = 0;
    FfileuploadAdaptUnifileService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    FfileuploadAdaptUnifileService.ctorParameters = function () { return [
        { type: UploadService },
        { type: FFileUploadAdaptUnifileConfigService }
    ]; };
    /** @nocollapse */ FfileuploadAdaptUnifileService.ngInjectableDef = i0.defineInjectable({ factory: function FfileuploadAdaptUnifileService_Factory() { return new FfileuploadAdaptUnifileService(i0.inject(i1.UploadService), i0.inject(i2.FFileUploadAdaptUnifileConfigService)); }, token: FfileuploadAdaptUnifileService, providedIn: "root" });
    return FfileuploadAdaptUnifileService;
}(UploadServerService));
export { FfileuploadAdaptUnifileService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    FfileuploadAdaptUnifileService.previous;
    /** @type {?} */
    FfileuploadAdaptUnifileService.prototype.extendData;
    /** @type {?} */
    FfileuploadAdaptUnifileService.prototype.bufferSize;
    /**
     * @type {?}
     * @private
     */
    FfileuploadAdaptUnifileService.prototype.uploadedChunk;
    /**
     * @type {?}
     * @private
     */
    FfileuploadAdaptUnifileService.prototype.fileTotalChunk;
    /**
     * @type {?}
     * @private
     */
    FfileuploadAdaptUnifileService.prototype.uploadSer;
    /**
     * @type {?}
     * @private
     */
    FfileuploadAdaptUnifileService.prototype.configSer;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmZpbGV1cGxvYWQtYWRhcHQtdW5pZmlsZS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlbmQtZmlsZXVwbG9hZC1hZGFwdC11bmlmaWxlLyIsInNvdXJjZXMiOlsibGliL2ZmaWxldXBsb2FkLWFkYXB0LXVuaWZpbGUuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxtQkFBbUIsRUFBMkIsWUFBWSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDeEcsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3hFLE9BQU8sRUFBRSxhQUFhLEVBQUUsdUJBQXVCLEVBQUUsdUJBQXVCLEVBQUUsY0FBYyxFQUFFLG1CQUFtQixFQUFZLGNBQWMsRUFBc0IsTUFBTSx5QkFBeUIsQ0FBQztBQUM3TCxPQUFPLEVBQUUsb0NBQW9DLEVBQWlDLE1BQU0sb0NBQW9DLENBQUM7QUFDekgsT0FBTyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFPLE1BQU0sZ0JBQWdCLENBQUM7Ozs7QUFHdEY7SUFHb0QsMERBQW1CO0lBVW5FLHdDQUFvQixTQUF3QixFQUFVLFNBQStDO1FBQXJHLFlBQ0ksaUJBQU8sU0FFVjtRQUhtQixlQUFTLEdBQVQsU0FBUyxDQUFlO1FBQVUsZUFBUyxHQUFULFNBQVMsQ0FBc0M7O1FBUnJHLGdCQUFVLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztRQUVqQixtQkFBYSxHQUFHLEVBQUUsQ0FBQztRQUNuQixvQkFBYyxHQUFHLEVBQUUsQ0FBQztRQU94QixLQUFJLENBQUMsVUFBVSxHQUFHLEtBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLENBQUM7O0lBQ2pELENBQUM7Ozs7O0lBRU8sNkNBQUk7Ozs7SUFBWjs7WUFDUSxFQUFFOzs7UUFBRztZQUNMLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0UsQ0FBQyxDQUFBOztZQUNHLEtBQUssR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDakUsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUNEOzs7O09BSUc7Ozs7Ozs7O0lBQ0gsK0NBQU07Ozs7Ozs7SUFBTixVQUFPLEtBQW1CLEVBQUUsS0FBa0IsRUFBRSxhQUE0QztRQUN4RixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsQ0FBQztJQUM3RCxDQUFDOzs7Ozs7OztJQUVPLHdEQUFlOzs7Ozs7O0lBQXZCLFVBQXdCLEtBQW1CLEVBQUUsS0FBa0IsRUFBRSxhQUFvQjtRQUFyRixpQkF3QkM7UUF4QmdFLDhCQUFBLEVBQUEsb0JBQW9CO1FBQ2pGLE9BQU8sSUFBSSxVQUFVOzs7O1FBQUMsVUFBQSxRQUFROztnQkFDdEIsY0FBYyxHQUFHLElBQUksdUJBQXVCOztnQkFDNUMsY0FBYyxHQUFHLEVBQUU7WUFDdkIsS0FBSyxDQUFDLE9BQU87Ozs7WUFBQyxVQUFBLFFBQVE7Z0JBQ2xCLElBQUksUUFBUSxDQUFDLFVBQVUsQ0FBQyxFQUFFO29CQUN0QixjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2lCQUMzRDtZQUNMLENBQUMsRUFBQyxDQUFDO1lBRUgsY0FBYyxDQUFDLElBQUksR0FBRyxLQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDOztnQkFDL0QsTUFBTSxHQUFHLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsYUFBYSxDQUFDO1lBQzNELGNBQWMsQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUUxRCxLQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUUsTUFBTSxDQUFDLENBQUMsU0FBUzs7OztZQUFDLFVBQUEsTUFBTTtnQkFDOUQsa0JBQWtCO2dCQUNsQixRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUNyRCxDQUFDOzs7O1lBQUUsVUFBQSxLQUFLO2dCQUNKLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ3RCLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN4QixDQUFDOzs7WUFBRTtnQkFDQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDeEIsQ0FBQyxFQUFDLENBQUM7UUFDUCxDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7SUFDRDs7OztPQUlHOzs7Ozs7OztJQUNILCtDQUFNOzs7Ozs7O0lBQU4sVUFBTyxLQUFtQixFQUFFLEtBQWtCLEVBQUUsYUFBNEM7UUFDeEYsSUFBSSxLQUFLLENBQUMsSUFBSSxJQUFJLGFBQWEsRUFBRTtZQUM3QixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsQ0FBQztTQUMxRDtRQUNELE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFDRDs7Ozs7T0FLRzs7Ozs7Ozs7O0lBQ0ssd0RBQWU7Ozs7Ozs7O0lBQXZCLFVBQXdCLEtBQW1CLEVBQUUsS0FBa0IsRUFBRSxhQUE0QztRQUE3RyxpQkE2REM7UUE1REcsT0FBTyxJQUFJLFVBQVU7Ozs7UUFBQyxVQUFBLFFBQVE7O2dCQUV0QixVQUFVLEdBQUcsSUFBSSx1QkFBdUI7WUFDNUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxLQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1lBQ25FLFVBQVUsQ0FBQyxJQUFJLEdBQUcsS0FBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxhQUFhLENBQUMsQ0FBQzs7Z0JBRTNELE1BQU0sR0FBRyxLQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLGFBQWEsQ0FBQztZQUMzRCxVQUFVLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQzs7Z0JBQ3hCLGVBQWUsR0FBc0IsRUFBRTtZQUMzQyxLQUFLLENBQUMsT0FBTzs7OztZQUFDLFVBQUMsUUFBb0I7O29CQUMzQixHQUFHLEdBQUcsSUFBSSxVQUFVOzs7O2dCQUFDLFVBQUEsS0FBSzs7d0JBQ3RCLE1BQU0sR0FBRyxJQUFJLFVBQVUsRUFBRTtvQkFDN0IsU0FBUztvQkFDVCxNQUFNLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO29CQUMvQyxNQUFNLENBQUMsTUFBTTs7OztvQkFBRyxVQUFDLENBQUM7OzRCQUNWLElBQUksR0FBRyxtQkFBQSxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUUsYUFBYSxFQUFFLEVBQUUsRUFBRSxFQUFPO3dCQUN2RCxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQzt3QkFDakMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7d0JBQ3JELDBCQUEwQjt3QkFDMUIsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFOzRCQUM5RixHQUFHOzRCQUNILElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUM7eUJBQ3REO3dCQUNELFVBQVUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNsQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBQ2IsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO29CQUNyQixDQUFDLENBQUEsQ0FBQTtnQkFDTCxDQUFDLEVBQUM7Z0JBQ0YsZUFBZSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM5QixDQUFDLEVBQUMsQ0FBQztZQUVILFFBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxTQUFTOzs7O1lBQUMsVUFBQSxLQUFLO2dCQUNyQywwQkFBMEI7Z0JBQzFCLHFCQUFxQjtnQkFDckIsS0FBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDLFNBQVM7Ozs7Z0JBQUMsVUFBQSxNQUFNO29CQUMxRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7d0JBQ2QsdUJBQXVCO3dCQUN2QixRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO3dCQUMxRCxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7d0JBQ3BCLE9BQU87cUJBQ1Y7b0JBQ0QsWUFBWTtvQkFDWixNQUFNLENBQUMsT0FBTzs7OztvQkFBQyxVQUFBLElBQUk7OzRCQUNYLFNBQVMsR0FBRyxLQUFJLENBQUMsdUJBQXVCLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUM7d0JBQ2xFLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQyxFQUFFOzRCQUNoQixLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsVUFBVSxDQUFDLEdBQUcsSUFBSSxDQUFDOzRCQUNwQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQzt5QkFDOUQ7b0JBQ0wsQ0FBQyxFQUFDLENBQUM7b0JBRUgsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7Z0JBRWxELENBQUM7Ozs7Z0JBQUUsVUFBQSxLQUFLO29CQUNKLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztvQkFDbkQsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUN4QixDQUFDOzs7Z0JBQUU7b0JBQ0MsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUN4QixDQUFDLEVBQUMsQ0FBQztZQUNQLENBQUMsRUFBQyxDQUFDO1FBQ1AsQ0FBQyxFQUFDLENBQUM7SUFDUCxDQUFDO0lBQUEsQ0FBQztJQUNGOzs7OztPQUtHOzs7Ozs7OztJQUNILHdEQUFlOzs7Ozs7O0lBQWYsVUFBZ0IsSUFBZ0IsRUFBRSxLQUFrQixFQUFFLGFBQTRDO1FBQWxHLGlCQWdIQztRQTlHRyxPQUFPLElBQUksVUFBVTs7OztRQUFDLFVBQUEsUUFBUTs7O2dCQUd0QixJQUFJLEdBQUcsS0FBSSxDQUFDLElBQUksRUFBRTs7Ozs7Z0JBSWxCLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztnQkFzQnBCLFVBQVUsR0FBVyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSSxDQUFDLFVBQVUsQ0FBQztZQUMvRCxjQUFjO1lBQ2QsS0FBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUM7O2dCQUNuQyxVQUFVLEdBQVcsQ0FBQztZQUMxQixlQUFlO1lBQ2YsS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7OztvQkFFckIsVUFBVSxHQUFHLElBQUksbUJBQW1CO2dCQUN4QyxVQUFVLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUM7Z0JBQ3RDLFVBQVUsQ0FBQyxNQUFNLEdBQUcsS0FBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxhQUFhLENBQUMsQ0FBQztnQkFDbkUsVUFBVSxDQUFDLE1BQU0sR0FBRyxLQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLGFBQWEsQ0FBQyxDQUFDOztvQkFFL0QsT0FBTyxHQUFtQixJQUFJLGNBQWM7Z0JBQ2hELE9BQU8sQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO2dCQUM1QixPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztnQkFDMUIsT0FBTyxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7Z0JBQzNCLDBCQUEwQjtnQkFDMUIsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFO29CQUM5RixPQUFPLENBQUMsYUFBYSxDQUFDLEdBQUcsbUJBQUEsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLGFBQWEsQ0FBQyxFQUFzQixDQUFDO2lCQUMvRTs7O29CQUVHLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQzs7O29CQUVsRSxRQUFRLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsS0FBSSxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUM7OztvQkFFM0UsTUFBTSxHQUFHLElBQUksVUFBVSxFQUFFO2dCQUM3QixNQUFNLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLENBQUM7O29CQUNoQyxVQUFVLEdBQUcsVUFBVTtnQkFDM0IsTUFBTSxDQUFDLE1BQU07OztnQkFBRztvQkFDWixPQUFPO29CQUNQLE9BQU8sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztvQkFDckQsT0FBTyxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7b0JBRTNCLFVBQVUsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDOzt3QkFDekIsSUFBSSxHQUFHLFVBQVU7b0JBRXJCLEtBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVM7Ozs7b0JBQUMsVUFBQSxNQUFNO3dCQUM1QyxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFOzRCQUN4QixpQkFBaUI7NEJBQ2pCLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUMzRCxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7NEJBQ3BCLE9BQU87eUJBQ1Y7NkJBQU07NEJBQ0gsS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDOzRCQUMzQixJQUFJLEtBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEtBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dDQUNuRixlQUFlO2dDQUNmLElBQUksQ0FBQyxRQUFRLEdBQUc7b0NBQ1osTUFBTSxFQUFFLFlBQVksQ0FBQyxJQUFJO29DQUN6QixJQUFJLEVBQUU7d0NBQ0YsVUFBVSxFQUFFLEdBQUc7cUNBQ2xCO2lDQUNKLENBQUM7Z0NBQ0YsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7Z0NBQ3hCLE9BQU8sS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQ0FDaEMsT0FBTyxLQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO2dDQUNqQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7Z0NBQy9DLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQzs2QkFFdkI7aUNBQU07OztvQ0FFRyxVQUFVLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0NBQzNHLFVBQVU7Z0NBQ1YsSUFBSSxDQUFDLFFBQVEsR0FBRztvQ0FDWixNQUFNLEVBQUUsWUFBWSxDQUFDLFNBQVM7b0NBQzlCLElBQUksRUFBRTt3Q0FDRixVQUFVLEVBQUUsVUFBVTtxQ0FDekI7aUNBQ0osQ0FBQztnQ0FDRixRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7NkJBQ3ZEO3lCQUNKO29CQUNMLENBQUM7Ozs7b0JBQUUsVUFBQSxLQUFLO3dCQUNKLE9BQU8sS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQzt3QkFDaEMsT0FBTyxLQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNqQyxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNwRCxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7b0JBQ3hCLENBQUMsRUFBQyxDQUFDO2dCQUNQLENBQUMsQ0FBQSxDQUFBO2dCQUNELFVBQVUsR0FBRyxVQUFVLEdBQUcsQ0FBQyxDQUFDOztZQXhFaEMsT0FBTyxVQUFVLEdBQUcsVUFBVTs7YUF5RTdCO1FBQ0wsQ0FBQyxFQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0Q7OztPQUdHOzs7Ozs7O0lBQ0ssdURBQWM7Ozs7OztJQUF0QixVQUF1QixJQUFZO1FBQy9CLElBQUksSUFBSSxHQUFHLE1BQU07WUFDYixPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7YUFDckMsSUFBSSxJQUFJLEdBQUcsSUFBSSxHQUFHLElBQUk7WUFDdkIsT0FBTyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO2FBQ3JDLElBQUksSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLEdBQUcsSUFBSTtZQUM3QixPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO2FBQzVDLElBQUksSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSTtZQUM5QixPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDOztZQUU3QyxPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztJQUM1RCxDQUFDO0lBQ0Q7OztPQUdHOzs7Ozs7O0lBQ0ssZ0VBQXVCOzs7Ozs7SUFBL0IsVUFBZ0MsUUFBZ0I7UUFDNUMsSUFBSSxRQUFRLENBQUMsTUFBTSxJQUFJLEVBQUU7WUFDckIsT0FBTyxRQUFRLENBQUM7YUFDZjs7Z0JBQ0csV0FBVyxHQUFHLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQzs7Z0JBQ3RDLFdBQVcsR0FBRyxRQUFRLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25FLE9BQU8sV0FBVyxHQUFHLEdBQUcsR0FBRyxXQUFXLENBQUM7U0FDMUM7SUFDTCxDQUFDOzs7Ozs7O0lBQ08sd0RBQWU7Ozs7OztJQUF2QixVQUF3QixLQUFLLEVBQUUsS0FBSzs7O1lBRTVCLFVBQVUsR0FBRyxLQUFLLENBQUMsR0FBRzs7OztRQUFDLFVBQUEsSUFBSTtZQUMzQixPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM1QyxDQUFDLEVBQUM7UUFDRixJQUFJLEtBQUssRUFBRTtZQUNQLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztTQUMzSTthQUFNO1lBQ0gsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztTQUNuRjtJQUNMLENBQUM7SUFDRDs7Ozs7T0FLRzs7Ozs7Ozs7SUFDSyx5REFBZ0I7Ozs7Ozs7SUFBeEIsVUFBeUIsR0FBRyxFQUFFLFdBQVc7UUFDckMsSUFBSSxXQUFXLElBQUksV0FBVyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNoRCxPQUFPLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMzQjtRQUNELE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNoQyxDQUFDOzs7Ozs7O0lBRU8sZ0VBQXVCOzs7Ozs7SUFBL0IsVUFBZ0MsS0FBbUIsRUFBRSxRQUFROzs7WUFFckQsU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxJQUFJLENBQUMsSUFBSSxJQUFJLFFBQVEsRUFBckIsQ0FBcUIsRUFBQztRQUM5RCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDO0lBR0QsaUJBQWlCOzs7Ozs7OztJQUVqQixzREFBYTs7Ozs7Ozs7SUFBYixVQUFjLEtBQW1CLEVBQUUsS0FBa0IsRUFBRSxhQUE0QztRQUFuRyxpQkFrQ0M7O1lBaENTLGFBQWEsR0FBRyxJQUFJLE9BQU8sRUFBRTs7WUFFN0IsTUFBTSxHQUFHLEtBQUssQ0FBQyxHQUFHOzs7O1FBQUMsVUFBQSxDQUFDOztnQkFDaEIsTUFBTSxHQUFHLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLGFBQWEsQ0FBQztZQUM5RCw0QkFBWSxDQUFDLEVBQUssTUFBTSxFQUFFO1FBQzlCLENBQUMsRUFBQzs7WUFHSSxhQUFhLEdBQXVCLE1BQU0sQ0FBQyxHQUFHOzs7O1FBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxLQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxhQUFhLENBQUMsRUFBbkMsQ0FBbUMsRUFBQztRQUNoRyxNQUFNLGdDQUFJLGFBQWEsR0FBRSxTQUFTOzs7O1FBQzlCLFVBQUMsQ0FBTTtZQUNILG9EQUFvRDtZQUNwRCxDQUFDLENBQUMsUUFBUSxHQUFHO2dCQUNULE1BQU0sRUFBRSxZQUFZLENBQUMsSUFBSTtnQkFDekIsSUFBSSxFQUFHO29CQUNILFVBQVUsRUFBRSxHQUFHO2lCQUNsQjthQUNKLENBQUM7WUFDRixDQUFDLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNwRCxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQzs7OztRQUNELFVBQUEsS0FBSztZQUNELGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUN4RCxhQUFhLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDN0IsQ0FBQzs7O1FBQ0Q7WUFDSSxhQUFhLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDekIsb0NBQW9DO1FBQ3hDLENBQUMsRUFDSixDQUFDO1FBRUYsT0FBTyxhQUFhLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDeEMsQ0FBQzs7Ozs7O0lBRU8sd0RBQWU7Ozs7O0lBQXZCLFVBQXdCLElBQVM7O1lBQ3ZCLEdBQUcsR0FBRyxxQ0FBcUM7UUFFakQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQ3pFLFNBQVM7OztRQUFDO1lBQ04sT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEIsQ0FBQyxFQUFDLEVBQ0YsVUFBVTs7OztRQUFDLFVBQUMsS0FBd0I7WUFDaEMsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckIsQ0FBQyxFQUNKLENBQUMsQ0FBQztJQUNQLENBQUM7Ozs7Ozs7SUFHTyxxREFBWTs7Ozs7O0lBQXBCLFVBQXFCLElBQUksRUFBRSxRQUFzQjtRQUFqRCxpQkF3Q0M7O1lBdENTLGNBQWM7Ozs7UUFBRyxVQUFDLENBQUMsSUFBSyxPQUFBLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBTixDQUFNLENBQUE7O1lBQzlCLGNBQWM7Ozs7UUFBRyxVQUFDLENBQUMsSUFBSyxPQUFBLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBTCxDQUFLLENBQUE7O1lBQzdCLFdBQVc7Ozs7UUFBRyxVQUFDLENBQUM7WUFDbEIsT0FBTyxLQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FDL0IsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUNWLEdBQUc7Ozs7WUFBQyxVQUFDLENBQU07Z0JBQ1Asd0JBQXdCO2dCQUN4QixDQUFDLENBQUMsUUFBUSxHQUFHO29CQUNULE1BQU0sRUFBRSxZQUFZLENBQUMsU0FBUztvQkFDOUIsSUFBSSxFQUFHO3dCQUNILFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztxQkFDM0Q7aUJBQ0osQ0FBQztnQkFDRixRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBRWpELE9BQU8sQ0FBQyxDQUFDO1lBQ2IsQ0FBQyxFQUFDLENBQ0wsQ0FBQTtRQUNMLENBQUMsQ0FBQTs7WUFDSyxxQkFBcUI7Ozs7UUFBRyxVQUFDLENBQUMsSUFBSyxPQUFBLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBTCxDQUFLLENBQUE7UUFHMUMsT0FBTyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJO1FBQ25DLGtEQUFrRDtRQUNsRCxNQUFNOzs7O1FBQUMsVUFBQyxDQUFDO1lBQ0wsSUFBSSxjQUFjLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQzlCLE9BQU8sV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQzVCO1lBQ0QsT0FBTyxLQUFLLENBQUM7UUFDakIsQ0FBQyxFQUFDO1FBQ0Ysb0JBQW9CO1FBQ3BCLHFFQUFxRTtRQUNyRSxNQUFNO1FBQ04sSUFBSSxFQUFFLEVBQ04sU0FBUzs7OztRQUFDLFVBQUMsR0FBUTtZQUNmLE9BQU8sY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hDLENBQUMsRUFBQyxDQUNMLENBQUM7SUFDTixDQUFDOzs7Ozs7OztJQUdPLDBEQUFpQjs7Ozs7OztJQUF6QixVQUEwQixJQUFnQixFQUFFLEtBQWtCLEVBQUUsYUFBNEM7O1lBQ3BHLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFOztZQUVsQixVQUFVLEdBQVcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDOztZQUNwRixVQUFVLEdBQVcsQ0FBQzs7WUFDcEIsVUFBVSxHQUFHLEVBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFDO1FBRWxELE9BQU8sVUFBVSxHQUFHLFVBQVUsRUFBRTs7Z0JBQ3hCLFVBQVUsR0FBRyxJQUFJLG1CQUFtQjtZQUN4QyxVQUFVLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUM7WUFDdEMsVUFBVSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1lBQ25FLFVBQVUsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxhQUFhLENBQUMsQ0FBQzs7Z0JBRS9ELE9BQU8sR0FBbUIsSUFBSSxjQUFjO1lBRWhELE9BQU8sQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUM3QixPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztZQUMxQixPQUFPLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQzs7Z0JBRXZCLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQzs7O2dCQUVsRSxRQUFRLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUM7WUFFL0UsT0FBTyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ3pCLE9BQU8sQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1lBQzNCLE9BQU8sQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFBO1lBRXhCLDBCQUEwQjtZQUMxQixJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLEVBQUU7Z0JBQzlGLE9BQU8sQ0FBQyxhQUFhLENBQUMsR0FBRyxtQkFBQSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQXNCLENBQUM7YUFDL0U7WUFHRCxVQUFVLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQzs7O2dCQUd6QixRQUFRLEdBQUcsSUFBSSxRQUFRLEVBQUU7WUFDN0IsUUFBUSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBQzFELFFBQVEsQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztZQUNwRCxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztZQUVsQyxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNqQyxVQUFVLEdBQUcsVUFBVSxHQUFHLENBQUMsQ0FBQztTQUMvQjtRQUVELE9BQU8sVUFBVSxDQUFDO0lBRXRCLENBQUM7SUFyY2MsdUNBQVEsR0FBRyxDQUFDLENBQUM7O2dCQU4vQixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7O2dCQVBRLGFBQWE7Z0JBQ2Isb0NBQW9DOzs7eUNBSjdDO0NBMGVDLEFBbGVELENBR29ELG1CQUFtQixHQStkdEU7U0EvZFksOEJBQThCOzs7Ozs7SUFHdkMsd0NBQTRCOztJQUY1QixvREFBVzs7SUFDWCxvREFBeUI7Ozs7O0lBRXpCLHVEQUEyQjs7Ozs7SUFDM0Isd0RBQTRCOzs7OztJQUtoQixtREFBZ0M7Ozs7O0lBQUUsbURBQXVEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBVcGxvYWRTZXJ2ZXJTZXJ2aWNlLCBVcGxvYWRGaWxlLCBVcGxvYWRJbnB1dCwgVXBsb2FkU3RhdHVzIH0gZnJvbSAnQGZhcnJpcy9leHRlbmQtZmlsZS11cGxvYWQnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBmb3JrSm9pbiwgb2YsIEVNUFRZLCBjb25jYXQsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgVXBsb2FkU2VydmljZSwgR3NwRm9ybVVwbG9hZExpc3RFbnRpdHksIEdzcEZvcm1SZW1vdmVMaXN0RW50aXR5LCBHc3BGb3JtRG9jSW5mbywgR3NwRm9ybVVwbG9hZEVudGl0eSwgRmlsZUluZm8sIE9wZXJhdGluZ01vZGVzLCBHc3BEb2NNZXRhUHJvcGVydHkgfSBmcm9tICdAZ3NwLXN2Yy9mb3JtZG9jLXVwbG9hZCc7XHJcbmltcG9ydCB7IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnU2VydmljZSwgRkZpbGVVcGxvYWRBZGFwdFVuaWZpbGVDb25maWcgfSBmcm9tICcuL2ZmaWxldXBsb2FkLWFkYXB0LXVuaWZpbGUuY29uZmlnJztcclxuaW1wb3J0IHsgY2F0Y2hFcnJvciwgZGVsYXksIGV4cGFuZCwgbGFzdCwgbWFwLCBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSHR0cEVycm9yUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIEZmaWxldXBsb2FkQWRhcHRVbmlmaWxlU2VydmljZSBleHRlbmRzIFVwbG9hZFNlcnZlclNlcnZpY2Uge1xyXG4gICAgZXh0ZW5kRGF0YTsvLyDmmoLml7bnlKjkuo7nroDljZXlkIjlubZcclxuICAgIGJ1ZmZlclNpemUgPSAxMDI0ICogMTAyNDtcclxuICAgIHByaXZhdGUgc3RhdGljIHByZXZpb3VzID0gMDtcclxuICAgIHByaXZhdGUgdXBsb2FkZWRDaHVuayA9IHt9O1xyXG4gICAgcHJpdmF0ZSBmaWxlVG90YWxDaHVuayA9IHt9O1xyXG5cclxuXHJcbiAgICBcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHVwbG9hZFNlcjogVXBsb2FkU2VydmljZSwgcHJpdmF0ZSBjb25maWdTZXI6IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnU2VydmljZSkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5leHRlbmREYXRhID0gdGhpcy5jb25maWdTZXIuZ2V0Q29uZmlnKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1dWlkKCkge1xyXG4gICAgICAgIGxldCBTNCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBuR3VpZCA9IFM0KCkgKyBTNCgpICsgUzQoKSArIFM0KCkgKyBTNCgpICsgUzQoKSArIFM0KCkgKyBTNCgpO1xyXG4gICAgICAgIHJldHVybiBuR3VpZDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yig6Zmk5paH5Lu2XHJcbiAgICAgKiBAcGFyYW0gZmlsZSBcclxuICAgICAqIEBwYXJhbSBldmVudCBcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlKGZpbGVzOiBVcGxvYWRGaWxlW10sIGV2ZW50OiBVcGxvYWRJbnB1dCwgZXh0ZW5kU2VydmljZTogRkZpbGVVcGxvYWRBZGFwdFVuaWZpbGVDb25maWcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlubmVyUmVtb3ZlTGlzdChmaWxlcywgZXZlbnQsIGV4dGVuZFNlcnZpY2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5uZXJSZW1vdmVMaXN0KGZpbGVzOiBVcGxvYWRGaWxlW10sIGV2ZW50OiBVcGxvYWRJbnB1dCwgZXh0ZW5kU2VydmljZSA9IG51bGwpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShvYnNlcnZlciA9PiB7XHJcbiAgICAgICAgICAgIGxldCByZW1vdmVGaWxlSW5mbyA9IG5ldyBHc3BGb3JtUmVtb3ZlTGlzdEVudGl0eTtcclxuICAgICAgICAgICAgbGV0IG1ldGFkYXRhSWRMaXN0ID0gW107XHJcbiAgICAgICAgICAgIGZpbGVzLmZvckVhY2goZmlsZUl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVJdGVtWydyZXNwb25zZSddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFJZExpc3QucHVzaChmaWxlSXRlbVsncmVzcG9uc2UnXVsnbWV0YWRhdGFJZCddKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZW1vdmVGaWxlSW5mby5tb2RlID0gdGhpcy5nZXRGaW5hbGx5Q29uZmlnKCdtb2RlJywgZXh0ZW5kU2VydmljZSk7XHJcbiAgICAgICAgICAgIGxldCByb290SWQgPSB0aGlzLmdldEZpbmFsbHlDb25maWcoJ3Jvb3RJZCcsIGV4dGVuZFNlcnZpY2UpO1xyXG4gICAgICAgICAgICByZW1vdmVGaWxlSW5mby5tZXRhZGF0YUlkTGlzdCA9IFtdLmNvbmNhdChtZXRhZGF0YUlkTGlzdCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnVwbG9hZFNlci5yZW1vdmVMaXN0KG1ldGFkYXRhSWRMaXN0LCByb290SWQpLnN1YnNjcmliZShyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g5rKh5pyJ6ZyA6KaB5pW05ZCI55qE5pyN5Yqh5Zmo56uv6L+U5Zue5pWw5o2uXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHsgdHlwZTogJ3JlbW92ZWQnLCBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgIH0sICgpID0+IHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDkuIrkvKDmlofku7ZcclxuICAgICAqIEBwYXJhbSBmaWxlIFxyXG4gICAgICogQHBhcmFtIGV2ZW50IFxyXG4gICAgICovXHJcbiAgICB1cGxvYWQoZmlsZXM6IFVwbG9hZEZpbGVbXSwgZXZlbnQ6IFVwbG9hZElucHV0LCBleHRlbmRTZXJ2aWNlOiBGRmlsZVVwbG9hZEFkYXB0VW5pZmlsZUNvbmZpZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT0gJ3NsaWNlVXBsb2FkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51cGxvYWRCaWdGaWxlKGZpbGVzLCBldmVudCwgZXh0ZW5kU2VydmljZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmlubmVyVXBsb2FkTGlzdChmaWxlcywgZXZlbnQsIGV4dGVuZFNlcnZpY2UpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlhoXpg6jkuIrkvKDmlrnlvI9cclxuICAgICAqIEBwYXJhbSBmaWxlcyBcclxuICAgICAqIEBwYXJhbSBldmVudCBcclxuICAgICAqIEBwYXJhbSBleHRlbmRTZXJ2aWNlIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlubmVyVXBsb2FkTGlzdChmaWxlczogVXBsb2FkRmlsZVtdLCBldmVudDogVXBsb2FkSW5wdXQsIGV4dGVuZFNlcnZpY2U6IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUob2JzZXJ2ZXIgPT4ge1xyXG5cclxuICAgICAgICAgICAgbGV0IHVwbG9hZEluZm8gPSBuZXcgR3NwRm9ybVVwbG9hZExpc3RFbnRpdHk7XHJcbiAgICAgICAgICAgIHVwbG9hZEluZm8uZm9ybUlkID0gdGhpcy5nZXRGaW5hbGx5Q29uZmlnKCdmb3JtSWQnLCBleHRlbmRTZXJ2aWNlKTtcclxuICAgICAgICAgICAgdXBsb2FkSW5mby5tb2RlID0gdGhpcy5nZXRGaW5hbGx5Q29uZmlnKCdtb2RlJywgZXh0ZW5kU2VydmljZSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcm9vdElkID0gdGhpcy5nZXRGaW5hbGx5Q29uZmlnKCdyb290SWQnLCBleHRlbmRTZXJ2aWNlKTtcclxuICAgICAgICAgICAgdXBsb2FkSW5mby5kb2NJbmZvTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgcmVhZGVyT2JzZXJhYmxlOiBPYnNlcnZhYmxlPGFueT5bXSA9IFtdO1xyXG4gICAgICAgICAgICBmaWxlcy5mb3JFYWNoKChmaWxlSXRlbTogVXBsb2FkRmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHN1YiA9IG5ldyBPYnNlcnZhYmxlKG9ic2VyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmmoLkuI3lpITnkIblvILluLhcclxuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQmluYXJ5U3RyaW5nKGZpbGVJdGVtLm5hdGl2ZUZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5mbyA9IHsgJ2ZpbGVOYW1lJzogJycsICdmaWxlQ29udGVudCc6ICcnIH0gYXMgYW55O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvWydmaWxlTmFtZSddID0gZmlsZUl0ZW0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1snZmlsZUNvbnRlbnQnXSA9IGJ0b2EocmVhZGVyLnJlc3VsdC50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6cZGF0YemHjOacieaVsOaNru+8jOW5tuS4lOWxnuaAp+aYr+mFjee9rueahOaJqeWxleWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSAmJiBldmVudFsnZGF0YSddICYmIGV2ZW50WydkYXRhJ10uaGFzT3duUHJvcGVydHkoJ2V4dFByb3BlcnR5JykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb1snZXh0UHJvcGVydHknXSA9IGV2ZW50WydkYXRhJ11bJ2V4dFByb3BlcnR5J107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkSW5mby5kb2NJbmZvTGlzdC5wdXNoKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlci5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZWFkZXJPYnNlcmFibGUucHVzaChzdWIpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZvcmtKb2luKHJlYWRlck9ic2VyYWJsZSkuc3Vic2NyaWJlKGRhdGFzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBtZXRhZGF0YUlkOiBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICAvLyAgZmlsZU5hbWU6IHN0cmluZztcclxuICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkU2VyLnVwbG9hZExpc3QodXBsb2FkSW5mbywgcm9vdElkKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOatpOaOpeWPo+S4gOaXpuWHuueOsOmXrumimO+8jOaJgOaciemZhOS7tumDveS4iuS8oOS4jemAmui/h1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcih0aGlzLmVycm9ySW5mb0Zvcm1hdChyZXN1bHQuZXJyb3IsIGZpbGVzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5ZCI5bm26L+U5Zue57uT5p6c5Yiw5q2k5aSEXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5kSW5kZXggPSB0aGlzLmZpbmRGaWxlSW5kZXhCeUZpbGVOYW1lKGZpbGVzLCBpdGVtLmZpbGVOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbmRJbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlc1tmaW5kSW5kZXhdWydyZXNwb25zZSddID0gaXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzW2ZpbmRJbmRleF1bJ3Byb2dyZXNzJ11bJ3N0YXR1cyddID0gVXBsb2FkU3RhdHVzLkRvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh7IHR5cGU6ICdkb25lJywgZmlsZXM6IGZpbGVzIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcih0aGlzLmVycm9ySW5mb0Zvcm1hdChlcnJvciwgZmlsZXMpKTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIbniYfliqDovb1cclxuICAgICAqIEBwYXJhbSBmaWxlIFxyXG4gICAgICogQHBhcmFtIGV2ZW50IFxyXG4gICAgICogQHBhcmFtIGV4dGVuZFNlcnZpY2UgXHJcbiAgICAgKi9cclxuICAgIG11bHRpcGFydFVwbG9hZChmaWxlOiBVcGxvYWRGaWxlLCBldmVudDogVXBsb2FkSW5wdXQsIGV4dGVuZFNlcnZpY2U6IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKG9ic2VydmVyID0+IHtcclxuXHJcbiAgICAgICAgICAgIC8vIGxldCBmaWxlSW5mbzogRmlsZUluZm87XHJcbiAgICAgICAgICAgIGxldCB1dWlkID0gdGhpcy51dWlkKCk7XHJcbiAgICAgICAgICAgIC8vIGxldCB1dWlkID0gVVVJRC5VVUlEKCk7XHJcbiAgICAgICAgICAgIC8vcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyhzZWxlY3RlZEZpbGUpO1xyXG4gICAgICAgICAgICAvL3JlYWRlci5vbmxvYWQgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZmlsZU5hbWUgPSBmaWxlLm5hbWU7XHJcbiAgICAgICAgICAgIC8vIGZpbGVJbmZvID0ge1xyXG4gICAgICAgICAgICAvLyAgIGlkOiB1dWlkLFxyXG4gICAgICAgICAgICAvLyAgIG5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICAgICAgICAvLyAgIHR5cGU6IGZpbGUudHlwZSxcclxuICAgICAgICAgICAgLy8gICBzb3VyY2U6IFwiXCIsXHJcbiAgICAgICAgICAgIC8vICAgc2l6ZTogdGhpcy5mb3JtYXRGaWxlU2l6ZShmaWxlLnNpemUpLFxyXG4gICAgICAgICAgICAvLyAgIGZpbGVTaXplOiBmaWxlLnNpemUsXHJcbiAgICAgICAgICAgIC8vICAgcGljTGlzdERpc3BsYXlOYW1lOiB0aGlzLmdldE11bHRpcGFydERpc3BsYXlOYW1lKGZpbGVOYW1lKSxcclxuICAgICAgICAgICAgLy8gICBxdWV1ZUxpc3REaXNwbGF5TmFtZTogZmlsZU5hbWUsXHJcbiAgICAgICAgICAgIC8vICAgLy9jb250ZW50OiByZWFkZXIucmVzdWx0LnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgIC8vICAgaGFzVXBsb2FkZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAvLyAgIG1vdXNlT246IGZhbHNlLFxyXG4gICAgICAgICAgICAvLyAgIHNlbGVjdGQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAvLyAgIGlzVXBsb2FkaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAvLyAgIHVwbG9hZFJlc3VsdDogZmFsc2UsXHJcbiAgICAgICAgICAgIC8vICAgdXBsb2FkUHJvY2VzczogMCxcclxuICAgICAgICAgICAgLy8gICBlcnJvck1lc3NhZ2U6IFwiXCIsXHJcbiAgICAgICAgICAgIC8vICAgZXh0ZW5zaW9uRHJvcExpc3RJZDogMCxcclxuICAgICAgICAgICAgLy8gICBleHRlbnNpb25OYW1lOiBcIlwiXHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBjaHVua1RvdGFsOiBudW1iZXIgPSBNYXRoLmNlaWwoZmlsZS5zaXplIC8gdGhpcy5idWZmZXJTaXplKTtcclxuICAgICAgICAgICAgLy8g5qCH6K6w5b2T5YmN6ZmE5Lu25oC755qE5YiG54mH5pWwXHJcbiAgICAgICAgICAgIHRoaXMuZmlsZVRvdGFsQ2h1bmtbdXVpZF0gPSBjaHVua1RvdGFsO1xyXG4gICAgICAgICAgICBsZXQgY2h1bmtJbmRleDogbnVtYmVyID0gMDtcclxuICAgICAgICAgICAgLy8g5qCH6K6w5b2T5YmN6ZmE5Lu25oiQ5Yqf55qE5YiG54mH5pWwXHJcbiAgICAgICAgICAgIHRoaXMudXBsb2FkZWRDaHVua1t1dWlkXSA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlIChjaHVua0luZGV4IDwgY2h1bmtUb3RhbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHVwbG9hZEluZm8gPSBuZXcgR3NwRm9ybVVwbG9hZEVudGl0eTtcclxuICAgICAgICAgICAgICAgIHVwbG9hZEluZm8ubW9kZSA9IE9wZXJhdGluZ01vZGVzLlRlbXA7XHJcbiAgICAgICAgICAgICAgICB1cGxvYWRJbmZvLmZvcm1JZCA9IHRoaXMuZ2V0RmluYWxseUNvbmZpZygnZm9ybUlkJywgZXh0ZW5kU2VydmljZSk7XHJcbiAgICAgICAgICAgICAgICB1cGxvYWRJbmZvLnJvb3RJZCA9IHRoaXMuZ2V0RmluYWxseUNvbmZpZygncm9vdElkJywgZXh0ZW5kU2VydmljZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGRvY0luZm86IEdzcEZvcm1Eb2NJbmZvID0gbmV3IEdzcEZvcm1Eb2NJbmZvO1xyXG4gICAgICAgICAgICAgICAgZG9jSW5mby5maWxlTmFtZSA9IGZpbGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgZG9jSW5mby5tZXRhZGF0YUlkID0gdXVpZDtcclxuICAgICAgICAgICAgICAgIGRvY0luZm8udG90YWwgPSBjaHVua1RvdGFsO1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6cZGF0YemHjOacieaVsOaNru+8jOW5tuS4lOWxnuaAp+aYr+mFjee9rueahOaJqeWxleWxnuaAp1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50Lmhhc093blByb3BlcnR5KCdkYXRhJykgJiYgZXZlbnRbJ2RhdGEnXSAmJiBldmVudFsnZGF0YSddLmhhc093blByb3BlcnR5KCdleHRQcm9wZXJ0eScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jSW5mb1snZXh0UHJvcGVydHknXSA9IGV2ZW50WydkYXRhJ11bJ2V4dFByb3BlcnR5J10gYXMgR3NwRG9jTWV0YVByb3BlcnR5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5LiL5LiA5Liq5paH5Lu25aSn5bCPXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dFNpemUgPSBNYXRoLm1pbigoY2h1bmtJbmRleCArIDEpICogdGhpcy5idWZmZXJTaXplLCBmaWxlLnNpemUpO1xyXG4gICAgICAgICAgICAgICAgLy8gRmlsZeexu+Wei1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpbGVEYXRhID0gZmlsZVsnbmF0aXZlRmlsZSddLnNsaWNlKGNodW5rSW5kZXggKiB0aGlzLmJ1ZmZlclNpemUsIG5leHRTaXplKTtcclxuICAgICAgICAgICAgICAgIC8vIOivu+WPluaWh+S7tlxyXG4gICAgICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQmluYXJ5U3RyaW5nKGZpbGVEYXRhKTtcclxuICAgICAgICAgICAgICAgIGxldCBpbm5lckluZGV4ID0gY2h1bmtJbmRleDtcclxuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6ZmE5Lu25LiK5LygXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jSW5mby5maWxlQ29udGVudCA9IGJ0b2EocmVhZGVyLnJlc3VsdC50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgICAgICBkb2NJbmZvLmluZGV4ID0gaW5uZXJJbmRleDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkSW5mby5kb2NJbmZvID0gZG9jSW5mbztcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5mbyA9IHVwbG9hZEluZm87XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkU2VyLnVwbG9hZEZpbGUoaW5mbykuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliIbniYfkuIrkvKDmnInov5Tlm57nu5PmnpzlsLHmmK/miqXplJnkuoZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKHRoaXMuZXJyb3JJbmZvRm9ybWF0KHJlc3VsdC5lcnJvciwgW2ZpbGVdKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGxvYWRlZENodW5rW3V1aWRdKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cGxvYWRlZENodW5rW2RvY0luZm8ubWV0YWRhdGFJZF0gPT0gdGhpcy5maWxlVG90YWxDaHVua1tkb2NJbmZvLm1ldGFkYXRhSWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yik5pat5piv5omA5pyJ5YiG54mH6YO95LiK5Lyg5a6M5oiQXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5wcm9ncmVzcyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBVcGxvYWRTdGF0dXMuRG9uZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMTAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUucmVzcG9uc2UgPSBkb2NJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnVwbG9hZGVkQ2h1bmtbdXVpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmlsZVRvdGFsQ2h1bmtbdXVpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh7IHR5cGU6ICdkb25lJywgZmlsZXM6IFtmaWxlXSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YiG54mH5LiK5Lyg5q2j5bi4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudGFnZSA9IE51bWJlci5wYXJzZUludCgodGhpcy51cGxvYWRlZENodW5rW3V1aWRdIC8gdGhpcy5maWxlVG90YWxDaHVua1t1dWlkXSAqIDEwMCkudG9GaXhlZCgwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yik5pat5pyq5LiK5Lyg5a6M5oiQXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5wcm9ncmVzcyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBVcGxvYWRTdGF0dXMuVXBsb2FkaW5nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50YWdlOiBwZXJjZW50YWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoeyB0eXBlOiAndXBsb2FkaW5nJywgZmlsZXM6IFtmaWxlXSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMudXBsb2FkZWRDaHVua1t1dWlkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmlsZVRvdGFsQ2h1bmtbdXVpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKHRoaXMuZXJyb3JJbmZvRm9ybWF0KGVycm9yLCBbZmlsZV0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNodW5rSW5kZXggPSBjaHVua0luZGV4ICsgMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bliIbniYfnmoTpmYTku7blpKflsI9cclxuICAgICAqIEBwYXJhbSBzaXplIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGZvcm1hdEZpbGVTaXplKHNpemU6IG51bWJlcikge1xyXG4gICAgICAgIGlmIChzaXplIDwgMTAyNDAwKVxyXG4gICAgICAgICAgICByZXR1cm4gKHNpemUgLyAxMDI0KS50b0ZpeGVkKDEpICsgXCJLXCI7XHJcbiAgICAgICAgZWxzZSBpZiAoc2l6ZSA8IDEwMjQgKiAxMDI0KVxyXG4gICAgICAgICAgICByZXR1cm4gKHNpemUgLyAxMDI0KS50b0ZpeGVkKDApICsgXCJLXCI7XHJcbiAgICAgICAgZWxzZSBpZiAoc2l6ZSA8IDEwMCAqIDEwMjQgKiAxMDI0KVxyXG4gICAgICAgICAgICByZXR1cm4gKHNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgxKSArIFwiTVwiO1xyXG4gICAgICAgIGVsc2UgaWYgKHNpemUgPCAxMDI0ICogMTAyNCAqIDEwMjQpXHJcbiAgICAgICAgICAgIHJldHVybiAoc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDApICsgXCJNXCI7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gKHNpemUgLyAxMDI0IC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMSkgKyBcIkdcIjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5YiG54mH55qEIOmZhOS7tuWQjeensFxyXG4gICAgICogQHBhcmFtIGZpbGVOYW1lIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldE11bHRpcGFydERpc3BsYXlOYW1lKGZpbGVOYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoZmlsZU5hbWUubGVuZ3RoIDw9IDEwKVxyXG4gICAgICAgICAgICByZXR1cm4gZmlsZU5hbWU7XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBoZWFkQ29udGVudCA9IGZpbGVOYW1lLnN1YnN0cmluZygwLCAyKTtcclxuICAgICAgICAgICAgbGV0IHRhaWxDb250ZW50ID0gZmlsZU5hbWUuc3Vic3RyaW5nKGZpbGVOYW1lLmxhc3RJbmRleE9mKCcuJykgLSAyKTtcclxuICAgICAgICAgICAgcmV0dXJuIGhlYWRDb250ZW50ICsgXCLigKZcIiArIHRhaWxDb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgZXJyb3JJbmZvRm9ybWF0KGVycm9yLCBmaWxlcykge1xyXG4gICAgICAgIC8vIFxyXG4gICAgICAgIGxldCBlcnJvckZpbGVzID0gZmlsZXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4geyBpZDogaXRlbS5pZCwgbmFtZTogaXRlbS5uYW1lIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGVycm9yLCB7IGZpbGVzOiBlcnJvckZpbGVzIH0sIHsgbWVzc2FnZTogZXJyb3JbJ01lc3NhZ2UnXSB8fCBlcnJvclsnZXh0ZW5zaW9uTWVzc2FnZSddIHx8ICfkuIrkvKDlpLHotKUnLCB0eXBlOiAnZXJyb3InIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgZmlsZXM6IGVycm9yRmlsZXMgfSwgeyBtZXNzYWdlOiAn5LiK5Lyg5aSx6LSlJywgdHlwZTogJ2Vycm9yJyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOi/lOWbnuacgOe7iOWxnuaAp+WAvFxyXG4gICAgICogQHBhcmFtIGtleSBcclxuICAgICAqIEBwYXJhbSBjb25maWdWYWx1ZSBcclxuICAgICAqIEBwYXJhbSBleHRlbmRWYWx1ZSBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRGaW5hbGx5Q29uZmlnKGtleSwgZXh0ZW5kVmFsdWUpIHtcclxuICAgICAgICBpZiAoZXh0ZW5kVmFsdWUgJiYgZXh0ZW5kVmFsdWUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZXh0ZW5kVmFsdWVba2V5XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0ZW5kRGF0YVtrZXldO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZmluZEZpbGVJbmRleEJ5RmlsZU5hbWUoZmlsZXM6IFVwbG9hZEZpbGVbXSwgZmlsZU5hbWUpIHtcclxuICAgICAgICAvLyDmjInnhafogq/lrprog73mib7liLDmlofku7bmnaXlpITnkIZcclxuICAgICAgICBsZXQgZmluZEluZGV4ID0gZmlsZXMuZmluZEluZGV4KGZpbGUgPT4gZmlsZS5uYW1lID09IGZpbGVOYW1lKTtcclxuICAgICAgICByZXR1cm4gZmluZEluZGV4O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyNyZWdpb24g5aSn5paH5Lu25YiG54mH5LiK5LygXHJcblxyXG4gICAgdXBsb2FkQmlnRmlsZShmaWxlczogVXBsb2FkRmlsZVtdLCBldmVudDogVXBsb2FkSW5wdXQsIGV4dGVuZFNlcnZpY2U6IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IHVwbG9hZENodW5rcyQgPSBuZXcgU3ViamVjdCgpO1xyXG5cclxuICAgICAgICBjb25zdCBfZmlsZXMgPSBmaWxlcy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNodW5rcyA9IHRoaXMuX2dldEJpZ0ZpbGVDaHVua3MobiwgZXZlbnQsIGV4dGVuZFNlcnZpY2UpXHJcbiAgICAgICAgICAgIHJldHVybiB7IC4uLm4sIC4uLmNodW5rc307XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHVwbG9hZGNodW5rcyQ6IE9ic2VydmFibGU8YW55PltdID0gIF9maWxlcy5tYXAoKGYpID0+IHRoaXMudXBsb2FkQ2h1bmtzKGYsIHVwbG9hZENodW5rcyQpKTtcclxuICAgICAgICBjb25jYXQoLi4udXBsb2FkY2h1bmtzJCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAoZjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgZmlsZTogJHtmLm5hbWV9IC0gdXBsb2FkIGNvbXBsZXRlYCk7XHJcbiAgICAgICAgICAgICAgICBmLnByb2dyZXNzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogVXBsb2FkU3RhdHVzLkRvbmUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMTAwXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGYucmVzcG9uc2UgPSBKU09OLnBhcnNlKGYuY2h1bmtzWzBdLmdldCgnZG9jSW5mbycpKTtcclxuICAgICAgICAgICAgICAgIHVwbG9hZENodW5rcyQubmV4dCh7dHlwZTogJ2RvbmUnLCBmaWxlczpbZl19KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXBsb2FkQ2h1bmtzJC5lcnJvcih0aGlzLmVycm9ySW5mb0Zvcm1hdChlcnJvciwgZmlsZXMpKTtcclxuICAgICAgICAgICAgICAgIHVwbG9hZENodW5rcyQuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXBsb2FkQ2h1bmtzJC5jb21wbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJhbGwgZmlsZXMgdXBsb2FkZWRcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB1cGxvYWRDaHVua3MkLmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBsb2FkRmlsZUNodW5rKGZpbGU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2Mvc2xpY2VcIjtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudXBsb2FkU2VyWydodHRwJ11bJ2h0dHAnXS5wb3N0KHVybCwgZmlsZS5jaHVua3NbZmlsZS50b3RhbF0pLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YoZmlsZSk7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApKTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIHByaXZhdGUgdXBsb2FkQ2h1bmtzKGZpbGUsIHVwQ2h1bmskOiBTdWJqZWN0PGFueT4pIHtcclxuXHJcbiAgICAgICAgY29uc3QgZG9DaHVua3NSZW1haW4gPSAoaSkgPT4gaSA+IC0xO1xyXG4gICAgICAgIGNvbnN0IGNvbXBsZXRlVXBsb2FkID0gKGYpID0+IG9mKGYpO1xyXG4gICAgICAgIGNvbnN0IHVwbG9hZENodW5rID0gKGYpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBsb2FkRmlsZUNodW5rKGYpLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBkZWxheSgxMDApLFxyXG4gICAgICAgICAgICAgICAgbWFwKChmOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlnZfmlbDkuLowIOaXtu+8jOWNs+S4uuatpOaWh+S7tueahOaJgOacieWdl+Wdh+S4iuS8oOaIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgIGYucHJvZ3Jlc3MgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogVXBsb2FkU3RhdHVzLlVwbG9hZGluZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2U6IChmLnRvdGFsIC8gZi5jaHVua3MubGVuZ3RoICogMTAwKS50b0ZpeGVkKDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHVwQ2h1bmskLm5leHQoeyB0eXBlOiAndXBsb2FkaW5nJywgZmlsZXM6IFtmXSB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBjcmVhdGVNdWx0aXBhcnRVcGxvYWQgPSAoZikgPT4gb2YoZik7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gY3JlYXRlTXVsdGlwYXJ0VXBsb2FkKGZpbGUpLnBpcGUoXHJcbiAgICAgICAgICAgIC8vIHRhcCgoZikgPT4gY29uc29sZS5sb2coXCJ1cGxvYWQgZmlsZVwiLCBmLm5hbWUpKSxcclxuICAgICAgICAgICAgZXhwYW5kKChmKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9DaHVua3NSZW1haW4oLS1maWxlLnRvdGFsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGxvYWRDaHVuayhmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWTtcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIC8vIHRhcCgoZjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhgZmlsZTogJHtmLm5hbWV9IC0gcmVtYWluaW5nIGNodW5rczogJHtmLnRvdGFsfWApO1xyXG4gICAgICAgICAgICAvLyB9KSxcclxuICAgICAgICAgICAgbGFzdCgpLFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGxldGVVcGxvYWQoZmlsZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0QmlnRmlsZUNodW5rcyhmaWxlOiBVcGxvYWRGaWxlLCBldmVudDogVXBsb2FkSW5wdXQsIGV4dGVuZFNlcnZpY2U6IEZGaWxlVXBsb2FkQWRhcHRVbmlmaWxlQ29uZmlnKSB7XHJcbiAgICAgICAgbGV0IHV1aWQgPSB0aGlzLnV1aWQoKTtcclxuXHJcbiAgICAgICAgbGV0IGNodW5rVG90YWw6IG51bWJlciA9IE1hdGguY2VpbChmaWxlLnNpemUgLyB0aGlzLmJ1ZmZlclNpemUgKiAoZXZlbnQuY2h1bmtTaXplIHx8IDEpKTtcclxuICAgICAgICBsZXQgY2h1bmtJbmRleDogbnVtYmVyID0gMDtcclxuICAgICAgICBjb25zdCBmaWxlQ2h1bmtzID0ge2NodW5rczogW10sIHRvdGFsOiBjaHVua1RvdGFsfTtcclxuXHJcbiAgICAgICAgd2hpbGUgKGNodW5rSW5kZXggPCBjaHVua1RvdGFsKSB7XHJcbiAgICAgICAgICAgIGxldCB1cGxvYWRJbmZvID0gbmV3IEdzcEZvcm1VcGxvYWRFbnRpdHk7XHJcbiAgICAgICAgICAgIHVwbG9hZEluZm8ubW9kZSA9IE9wZXJhdGluZ01vZGVzLlRlbXA7XHJcbiAgICAgICAgICAgIHVwbG9hZEluZm8uZm9ybUlkID0gdGhpcy5nZXRGaW5hbGx5Q29uZmlnKCdmb3JtSWQnLCBleHRlbmRTZXJ2aWNlKTtcclxuICAgICAgICAgICAgdXBsb2FkSW5mby5yb290SWQgPSB0aGlzLmdldEZpbmFsbHlDb25maWcoJ3Jvb3RJZCcsIGV4dGVuZFNlcnZpY2UpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGRvY0luZm86IEdzcEZvcm1Eb2NJbmZvID0gbmV3IEdzcEZvcm1Eb2NJbmZvO1xyXG5cclxuICAgICAgICAgICAgZG9jSW5mby5maWxlTmFtZSA9IGZpbGUubmFtZTtcclxuICAgICAgICAgICAgZG9jSW5mby5tZXRhZGF0YUlkID0gdXVpZDtcclxuICAgICAgICAgICAgZG9jSW5mby50b3RhbCA9IGNodW5rVG90YWw7XHJcblxyXG4gICAgICAgICAgICBsZXQgbmV4dFNpemUgPSBNYXRoLm1pbigoY2h1bmtJbmRleCArIDEpICogdGhpcy5idWZmZXJTaXplLCBmaWxlLnNpemUpO1xyXG4gICAgICAgICAgICAvLyBGaWxl57G75Z6LXHJcbiAgICAgICAgICAgIGxldCBmaWxlRGF0YSA9IGZpbGVbJ25hdGl2ZUZpbGUnXS5zbGljZShjaHVua0luZGV4ICogdGhpcy5idWZmZXJTaXplLCBuZXh0U2l6ZSk7XHJcblxyXG4gICAgICAgICAgICBkb2NJbmZvLnNpemUgPSBmaWxlLnNpemU7XHJcbiAgICAgICAgICAgIGRvY0luZm8uaW5kZXggPSBjaHVua0luZGV4O1xyXG4gICAgICAgICAgICBkb2NJbmZvLmZpbGVDb250ZW50ID0gXCJcIlxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g5aaC5p6cZGF0YemHjOacieaVsOaNru+8jOW5tuS4lOWxnuaAp+aYr+mFjee9rueahOaJqeWxleWxnuaAp1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSAmJiBldmVudFsnZGF0YSddICYmIGV2ZW50WydkYXRhJ10uaGFzT3duUHJvcGVydHkoJ2V4dFByb3BlcnR5JykpIHtcclxuICAgICAgICAgICAgICAgIGRvY0luZm9bJ2V4dFByb3BlcnR5J10gPSBldmVudFsnZGF0YSddWydleHRQcm9wZXJ0eSddIGFzIEdzcERvY01ldGFQcm9wZXJ0eTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIHVwbG9hZEluZm8uZG9jSW5mbyA9IGRvY0luZm87XHJcbiAgICAgIFxyXG4gICAgICAgICAgICAvL+Wwgeijheivt+axgmZvcm1kYXRhXHJcbiAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VwbG9hZEluZm8nLCBKU09OLnN0cmluZ2lmeSh1cGxvYWRJbmZvKSk7XHJcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZG9jSW5mbycsIEpTT04uc3RyaW5naWZ5KGRvY0luZm8pKTtcclxuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZURhdGEpO1xyXG5cclxuICAgICAgICAgICAgZmlsZUNodW5rcy5jaHVua3MucHVzaChmb3JtRGF0YSk7XHJcbiAgICAgICAgICAgIGNodW5rSW5kZXggPSBjaHVua0luZGV4ICsgMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmaWxlQ2h1bmtzO1xyXG4gICAgXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIHByaXZhdGUgc2hvd1Byb2dyZXNzQmFyKCkge1xyXG4gICAgLy8gICAgIC8vIG92ZXJsYXkgRGl2XHJcbiAgICAvLyAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAvLyAgICAgZGl2LnN0eWxlLmNzc1RleHQgPSAncG9zaXRpb246IGFic29sdXRlO3RvcDogMDtsZWZ0OiAwO3dpZHRoOiAxMDB2dztoZWlnaHQ6IDEwMHZoO3otaW5kZXg6IDk5OTk5OTtiYWNrZ3JvdW5kOiAjZmRmZGZkNTQ7JztcclxuXHJcbiAgICAvLyAgICAgLy8gcGFuZWwgRGl2XHJcbiAgICAvLyAgICAgY29uc3QgcHJvZ3Jlc3NQYW5lbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgLy8gICAgIGRpdi5zdHlsZS5jc3NUZXh0ID1gYmFja2dyb3VuZDogd2hpdGU7d2lkdGg6IDUwMHB4O2hlaWdodDogMTMwcHg7bGVmdDogNTAlO3RvcDogNTAlO3Bvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgIC8vICAgICBtYXJnaW4tdG9wOiAtNTBweDttYXJnaW4tbGVmdDogLTI1MHB4O2FsaWduLWl0ZW1zOiBjZW50ZXI7anVzdGlmeS1jb250ZW50OiBjZW50ZXI7ZGlzcGxheTogZmxleDtmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgLy8gICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7Ym94LXNoYWRvdzogMXB4IDFweCA3cHggI2NlZDRkYTtgO1xyXG5cclxuICAgIC8vICAgICBkaXYuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NQYW5lbERpdik7XHJcblxyXG4gICAgLy8gICAgIGNvbnN0IHByb2dyZXNzTnVtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICAgIFxyXG4gICAgLy8gfVxyXG5cclxuXHJcbiAgICAvLyNlbmRyZWdpb25cclxuXHJcbn1cclxuXHJcbiJdfQ==