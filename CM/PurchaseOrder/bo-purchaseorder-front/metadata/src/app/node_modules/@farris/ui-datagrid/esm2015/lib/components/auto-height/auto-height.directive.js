/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DatagridComponent } from '../../datagrid.component';
import { Directive, Injector, Input, ElementRef } from '@angular/core';
export class AutoHeightDirective {
    /**
     * @param {?} dg
     * @param {?} inject
     * @param {?} el
     */
    constructor(dg, inject, el) {
        this.dg = dg;
        this.inject = inject;
        this.el = el;
        this.autoHeight = false;
        this._timer = null;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // this.updateDatagridHeight(this.wheelHeight);
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.updateDatagridHeight(this.wheelHeight);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.wheelHeight) {
            this.updateDatagridHeight(this.wheelHeight);
        }
    }
    /**
     * @return {?}
     */
    ngDoCheck() {
        // this.checkScrollbarPosition();
    }
    /**
     * @private
     * @param {?} wheelHeight
     * @return {?}
     */
    updateDatagridHeight(wheelHeight) {
        if (this.el && this.el.nativeElement && this.el.nativeElement.parentElement) {
            if (this.autoHeight) {
                if (!wheelHeight) {
                    wheelHeight = 240;
                    if (!this.dg.ds || !this.dg.ds.rows || !this.dg.ds.rows.length) {
                        wheelHeight = (!this.dg.emptyDataHeight || this.dg.emptyDataHeight < 0) ? 240 : this.dg.emptyDataHeight;
                    }
                }
                /** @type {?} */
                let h = parseInt(wheelHeight, 10);
                if (this.dg.showHeader) {
                    if (!this.dg.realHeaderHeight) {
                        h += this.dg.setHeaderHeight();
                    }
                    else {
                        h += this.dg.realHeaderHeight;
                    }
                }
                if (this.dg.showFooter) {
                    h += this.dg.footerHeight;
                }
                if (this.dg.pagination) {
                    /** @type {?} */
                    const ph = this.dg.pagerHeight || 40;
                    h += ph;
                }
                if (this.dg.showFilterBar) {
                    h += this.dg.filterBarHeight;
                }
                /** @type {?} */
                const wh = `${wheelHeight}px`;
                this.el.nativeElement.parentElement.style.height = wh;
                this.el.nativeElement.parentElement.parentElement.style.height = wh;
                if (this.dg.dgContainer) {
                    /** @type {?} */
                    const dgHeight = `${h}px`;
                    // 更新grid 最外层的高度
                    this.dg.dgContainer.nativeElement.style.height = dgHeight;
                    // farris-datagrid 增加高度
                    this.dg.el.nativeElement.style.height = dgHeight;
                    this.dg.height = h;
                }
                else {
                    this.dg.el.nativeElement.querySelector('.f-datagrid').style.height = `${h}px`;
                }
            }
        }
    }
}
AutoHeightDirective.decorators = [
    { type: Directive, args: [{
                selector: '[auto-height]',
            },] }
];
/** @nocollapse */
AutoHeightDirective.ctorParameters = () => [
    { type: DatagridComponent },
    { type: Injector },
    { type: ElementRef }
];
AutoHeightDirective.propDecorators = {
    autoHeight: [{ type: Input, args: ['auto-height',] }],
    wheelHeight: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    AutoHeightDirective.prototype.autoHeight;
    /**
     * 数据列表总高度
     * @type {?}
     */
    AutoHeightDirective.prototype.wheelHeight;
    /**
     * @type {?}
     * @private
     */
    AutoHeightDirective.prototype._timer;
    /** @type {?} */
    AutoHeightDirective.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    AutoHeightDirective.prototype.inject;
    /**
     * @type {?}
     * @private
     */
    AutoHeightDirective.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0by1oZWlnaHQuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhZ3JpZC8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2F1dG8taGVpZ2h0L2F1dG8taGVpZ2h0LmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDN0QsT0FBTyxFQUFhLFNBQVMsRUFBVSxRQUFRLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBb0QsTUFBTSxlQUFlLENBQUM7QUFLNUksTUFBTSxPQUFPLG1CQUFtQjs7Ozs7O0lBUTVCLFlBQW1CLEVBQXFCLEVBQVUsTUFBZ0IsRUFBVSxFQUFjO1FBQXZFLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVTtRQUFVLE9BQUUsR0FBRixFQUFFLENBQVk7UUFOcEUsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUlqQyxXQUFNLEdBQUcsSUFBSSxDQUFDO0lBRXdFLENBQUM7Ozs7SUFFL0YsUUFBUTtRQUNKLCtDQUErQztJQUNuRCxDQUFDOzs7O0lBRUQsZUFBZTtRQUNYLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDaEQsQ0FBQzs7Ozs7SUFFRCxXQUFXLENBQUMsT0FBc0I7UUFDOUIsSUFBSSxPQUFPLENBQUMsV0FBVyxFQUFFO1lBQ3JCLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDL0M7SUFDTCxDQUFDOzs7O0lBRUQsU0FBUztRQUNMLGlDQUFpQztJQUNyQyxDQUFDOzs7Ozs7SUFFTyxvQkFBb0IsQ0FBQyxXQUFXO1FBQ3BDLElBQUksSUFBSSxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxhQUFh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cUNBQXNCOztJQUVWLGlDQUE0Qjs7Ozs7SUFBRSxxQ0FBd0I7Ozs7O0lBQUUsaUNBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICcuLi8uLi9kYXRhZ3JpZC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIERpcmVjdGl2ZSwgT25Jbml0LCBJbmplY3RvciwgSW5wdXQsIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgRG9DaGVjayB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1thdXRvLWhlaWdodF0nLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQXV0b0hlaWdodERpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBEb0NoZWNrIHtcclxuXHJcbiAgICBASW5wdXQoJ2F1dG8taGVpZ2h0JykgYXV0b0hlaWdodCA9IGZhbHNlO1xyXG4gICAgLyoqIOaVsOaNruWIl+ihqOaAu+mrmOW6piAqL1xyXG4gICAgQElucHV0KCkgd2hlZWxIZWlnaHQ6IG51bWJlcjtcclxuXHJcbiAgICBwcml2YXRlIF90aW1lciA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIGRnOiBEYXRhZ3JpZENvbXBvbmVudCwgcHJpdmF0ZSBpbmplY3Q6IEluamVjdG9yLCBwcml2YXRlIGVsOiBFbGVtZW50UmVmKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyB0aGlzLnVwZGF0ZURhdGFncmlkSGVpZ2h0KHRoaXMud2hlZWxIZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZURhdGFncmlkSGVpZ2h0KHRoaXMud2hlZWxIZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy53aGVlbEhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFncmlkSGVpZ2h0KHRoaXMud2hlZWxIZWlnaHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0RvQ2hlY2soKSB7XHJcbiAgICAgICAgLy8gdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVEYXRhZ3JpZEhlaWdodCh3aGVlbEhlaWdodCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVsICYmIHRoaXMuZWwubmF0aXZlRWxlbWVudCAmJiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXdoZWVsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlZWxIZWlnaHQgPSAyNDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kZy5kcyB8fCAhdGhpcy5kZy5kcy5yb3dzIHx8ICF0aGlzLmRnLmRzLnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZWVsSGVpZ2h0ID0gKCF0aGlzLmRnLmVtcHR5RGF0YUhlaWdodCB8fCB0aGlzLmRnLmVtcHR5RGF0YUhlaWdodCA8IDAgKSA/IDI0MCA6IHRoaXMuZGcuZW1wdHlEYXRhSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBoID0gIHBhcnNlSW50KHdoZWVsSGVpZ2h0LCAxMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0hlYWRlcikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcucmVhbEhlYWRlckhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoICs9IHRoaXMuZGcuc2V0SGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaCArPSB0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBoICs9IHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnBhZ2luYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwaCA9IHRoaXMuZGcucGFnZXJIZWlnaHQgfHwgNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgaCArPSBwaDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5zaG93RmlsdGVyQmFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaCArPSB0aGlzLmRnLmZpbHRlckJhckhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB3aCA9ICBgJHt3aGVlbEhlaWdodH1weGA7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gd2g7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHdoO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5kZ0NvbnRhaW5lcikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZ0hlaWdodCA9IGAke2h9cHhgO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOabtOaWsGdyaWQg5pyA5aSW5bGC55qE6auY5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCA9IGRnSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZhcnJpcy1kYXRhZ3JpZCDlop7liqDpq5jluqZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmVsLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gZGdIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuaGVpZ2h0ID0gaDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mLWRhdGFncmlkJykuc3R5bGUuaGVpZ2h0ID0gYCR7aH1weGA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==