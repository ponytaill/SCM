{"version":3,"sources":["ng://@farris/ui-text/lib/text.component.service.ts","ng://@farris/ui-text/lib/text.component.ts","ng://@farris/ui-text/lib/text.module.ts"],"names":["StaticTextControlService","Injectable","args","providedIn","TextComponent","Object","defineProperty","prototype","this","_tshowType","value","dateRange","text","formatValue","textChange","emit","changeTitle","ev","isTextArea","isPassword","mouseEnterChangeTitle","_option","ngOnInit","ngOnDestroy","ngAfterViewInit","clsName","textInnerEl","nativeElement","parentElement","className","scrollHeight","clientHeight","staticTitle","length","control","formatLang","currentLanguage","getFormatNumberValue","format","toString","type","formatter","useThousands","precision","undefined","result","firstLetter","currencyToUpperCase","substring","Number","config","test","thousand","assign","decimal","expression","prefix","currencySymbol","numberHelper","formatMoney","toDecimal","toPercent","debugSer","warn","indexOf","Array","join","filledSymbol","slice","toFixed","replace","word","toUpperCase","dateToUpperCase","newFormat","getFormatEnumValue","_this","data","curVals_1","split","enumDelimiter","nameResult","k","findObj","this_1","find","item","valueField","push","textField","getFormatCheckBoxValue","localeService","getValue","timeFormatTo","fmt","hourSystem","makeFormater","dateformat","returnFormat","getDateFromFormatedString","dtHelper","formatTo","dateString","year","month","day","hour","minite","second","m","a","b","c","d","parseInt","Date","str","dateValues","dateRangeDelimiter","dataStr_1","forEach","date","val","setText2Star","star","writeValue","beforeWriteValue","options","localizationType","showTime","ref","controlChange","registerOnChange","fn","registerOnTouched","controlTouch","Component","selector","template","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","DateTimeHelperService","NumberHelperService","Injector","NgZone","HostBinding","ViewChild","read","ElementRef","Output","Input","HostListener","injector","ngzone","cls","EventEmitter","autoSize","height","showTitle","get","LocaleService","DebugService","TextModule","NgModule","declarations","imports","CommonModule","LocaleModule","NumberHelperModule","DateHelperModule","exports"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class StaticTextControlService {\r\n\r\n  constructor() { }\r\n}\r\n","import {\r\n    Component, OnInit, forwardRef, Input, HostBinding, Output, EventEmitter, Injector,\r\n    SimpleChanges, ElementRef, ViewChild, NgZone, HostListener\r\n} from '@angular/core';\r\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nimport { NumberHelperService } from '@farris/ui-common/number';\r\nimport { DebugService } from '@farris/ui-common';\r\nimport { LocaleService } from '@farris/ui-locale';\r\n\r\n@Component({\r\n    selector: 'farris-text',\r\n    template: `\r\n        <span #textInner\r\n            [ngClass]=\"{'f-form-control-text':!isTextArea,'f-form-control-textarea':isTextArea,'f-component-text-auto-size': this.autoSize}\"\r\n            [title]=\"staticTitle\" [style.text-align]=\"textAlign\"\r\n            [style.height]=\"!autoSize&&height>0?height+'px':null\" [style.minHeight]=\"autoSize&&height>0?height+'px':null\"\r\n            [style.maxHeight]=\"autoSize&&maxHeight>0?maxHeight+'px':null\">{{text && text.length > 0 ?  text : control}}</span>\r\n    `,\r\n    styles: [],\r\n    providers: [{\r\n        provide: NG_VALUE_ACCESSOR,\r\n        useExisting: forwardRef(() => TextComponent),\r\n        multi: true,\r\n    }]\r\n})\r\nexport class TextComponent implements OnInit, ControlValueAccessor {\r\n    @HostBinding('class.f-component-text') cls = true;\r\n    @ViewChild('textInner', { read: ElementRef }) textInnerEl: ElementRef;\r\n    @Output() textChange = new EventEmitter<any>();\r\n    /** æ¯å¦ä¸ºå¯ç è¾å¥ */\r\n    @Input() isPassword = false;\r\n    // æ¯å¦å¤è¡ææ¬\r\n    @Input() isTextArea = false;\r\n    // æ¯å¦å¯ç¨èªå¨å°ºå¯¸\r\n    @Input() autoSize = false;\r\n    // è®¾ç½®æå¤§é«åº¦\r\n    @Input() maxHeight: number;\r\n    // è®¾ç½®é«åº¦\r\n    @Input() height = 0;\r\n    // æ§ä»¶ç±»å\r\n    @Input() type: string;\r\n    // æ¯å¦æ¯æ¥æèå´\r\n    @Input() dateRange = false;\r\n    // éè¦è½¬åç±»åæ ¼å¼çè¡¨è¾¾å¼\r\n    @Input() format: any;\r\n    // å¤è¯­è¨\r\n    @Input() lang: string;\r\n    // è½¬æ¢ç±»åç¨å°çæ°æ®\r\n    @Input() data: any;\r\n    // ååä½ç¬¦å·\r\n    @Input() thousand = ',';\r\n    // å°æ°ç¹å¤ç¬¦å·\r\n    @Input() decimal = '.';\r\n    // è´§å¸ç¬¦å·åå¼å±ç°å½¢å¼\r\n    @Input() expression = '%s%v';\r\n    @Input() currentLanguage: string;\r\n    // formControlæ¾ç¤ºçææ¬\r\n    @Input() showTime: boolean;\r\n    @Input() textField = 'name';\r\n    @Input() valueField = 'value';\r\n    @Input() returnFormat = ''; // ä»æå¡å¨ç«¯åå¼æ¯æ ¼å¼ååç\r\n\r\n    // ææ¬æ¹å\r\n    @Input() textAlign;\r\n    // æ¥æèå´æ¨¡å¼ä¸inputçæ¾ç¤ºåå²ç¬¦å\r\n    @Input() dateRangeDelimiter = '~';\r\n    @Input() enumDelimiter = ',';\r\n    private _tshowType = 0;\r\n    @Input()\r\n    set showType(value: number) {\r\n        this._tshowType = value;\r\n        // å¦ææ¯å¨\r\n        if (value == 4) {\r\n            this.dateRange = true;\r\n        }\r\n    }\r\n    get showType(): number {\r\n        return this._tshowType;\r\n    }\r\n    /**\r\n     * å½éåç±»å\r\n     */\r\n    @Input() localizationType: string;\r\n    control: any;\r\n    // æ®éææ¬\r\n    text: any;\r\n    // è´§å¸ç¬¦å·ï¼é»è®¤æ¯RMB\r\n    currencySymbol = 'ï¿¥';\r\n    // åè¿å¶åé¢å¡«åçç¬¦å·\r\n    @Input() filledSymbol = '0';\r\n    // æ®éææ¬è¾å¥å¼\r\n    @Input()\r\n    set value(value: any) {\r\n        this.text = this.formatValue(value);\r\n        this.textChange.emit(this.text);\r\n    }\r\n    get value() {\r\n        return this.text;\r\n    }\r\n    @HostListener('mouseenter', ['$event']) changeTitle(ev) {\r\n        if (!this.isTextArea && !this.isPassword) {\r\n            this.mouseEnterChangeTitle();\r\n        }\r\n    }\r\n    // æ ç­¾\r\n    staticTitle = \"\";\r\n    // å¤çä¸­è±ææåµï¼ å ä¸ºå¤è¯­è¨ææ¶ä¸éè¿è¿ä¸ªå±æ§æ§å¶\r\n    @Input() showTitle = false;\r\n    //æ°å¼æ ¼å¼åæ°\r\n    _option;\r\n    @Input()\r\n    set option(value) {\r\n        this._option = value;\r\n    }\r\n    get option() {\r\n        return this._option;\r\n    }\r\n\r\n    private localeService: any;\r\n\r\n    beforeWriteValue: (val: any, options: any) => string = null;\r\n\r\n    private controlChange = (val) => { };\r\n    private controlTouch = (val) => { };\r\n    private debugSer: DebugService = null;\r\n    constructor(\r\n        private dtHelper: DateTimeHelperService,\r\n        private numberHelper: NumberHelperService,\r\n        private injector: Injector,\r\n        public ngzone: NgZone\r\n    ) {\r\n        this.localeService = this.injector.get(LocaleService);\r\n        this.debugSer = this.injector.get(DebugService, null);\r\n    }\r\n\r\n    ngOnInit() {\r\n    }\r\n    ngOnDestroy(): void {\r\n    }\r\n    ngAfterViewInit(): void {\r\n        if (this.isTextArea) {\r\n            const clsName = this.textInnerEl.nativeElement.parentElement.className;\r\n            this.textInnerEl.nativeElement.parentElement.className = clsName + ' f-cmp-text-is-textarea';\r\n        }\r\n    }\r\n    private mouseEnterChangeTitle() {\r\n        if (this.textInnerEl.nativeElement.scrollHeight > this.textInnerEl.nativeElement.clientHeight) {\r\n            this.staticTitle = this.text && this.text.length > 0 ? this.text : this.control;\r\n        } else {\r\n            this.staticTitle = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¤çå¤è¯­è¨ï¼å¾å®\r\n     */\r\n    formatLang(value: any) {\r\n        return value && value[this.currentLanguage] ? value[this.currentLanguage] : '';\r\n    }\r\n    /**\r\n     * Cè´§å¸\r\n     * Dåè¿å¶\r\n     * Fæµ®ç¹æ°\r\n     * Næ°å­ï¼å¸¦ååä½\r\n     * Pç¾åæ¯\r\n     */\r\n    getFormatNumberValue(value: any) {\r\n        if (!this.format && !this._option) {\r\n            return value.toString();\r\n        }\r\n        if (this._option && this._option.type && this._option.type == 'number') {\r\n            if (this._option.formatter) {\r\n                return this._option.formatter(value);\r\n            } else {\r\n                if (this._option.useThousands) {\r\n                    if (this._option.precision != undefined) {\r\n                        this.format = 'n' + this._option.precision;\r\n                    } else {\r\n                        this.format = 'n2';\r\n                    }\r\n                } else {\r\n                    if (this._option.precision != undefined) {\r\n                        this.format = 'f' + this._option.precision;\r\n                    } else {\r\n                        this.format = 'f2';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        const firstLetter = this.currencyToUpperCase(this.format.substring(0, 1));\r\n        const precision = Number(this.format.substring(1));\r\n        let config = {};\r\n        let result: any;\r\n        if (!/C|D|F|N|P/g.test(firstLetter)) {\r\n            if (this.debugSer) {\r\n                this.debugSer.warn(`ä¸æ¯æformatä¸º ${this.format} ç±»åçæ°å­æ ¼å¼å`);\r\n            }\r\n            return;\r\n        }\r\n        if (this.thousand) {\r\n            Object.assign(config, { thousand: this.thousand });\r\n        }\r\n        if (this.decimal) {\r\n            Object.assign(config, { decimal: this.decimal });\r\n        }\r\n        if (this.expression) {\r\n            Object.assign(config, { format: this.expression });\r\n        }\r\n        switch (firstLetter) {\r\n            case 'C':\r\n                Object.assign(config, { prefix: this.currencySymbol, precision });\r\n                result = this.numberHelper.formatMoney(value, config);\r\n                break;\r\n            case 'D':\r\n                result = this.toDecimal(value, precision);\r\n                break;\r\n            case 'F':\r\n                Object.assign(config, { prefix: '', thousand: '', precision });\r\n                result = this.numberHelper.formatMoney(value, config);\r\n                break;\r\n            case 'N':\r\n                Object.assign(config, { prefix: '', precision });\r\n                result = this.numberHelper.formatMoney(value, config);\r\n                break;\r\n            case 'P':\r\n                result = this.toPercent(value, precision);\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param value è½¬æ¢æåè¿å¶çæ°å­\r\n     * @param precision åè¿å¶æ°å­çé¿åº¦\r\n     */\r\n    toDecimal(value: any, precision: any) {\r\n        if (value.toString().indexOf('.') > -1) {\r\n            if(this.debugSer) {\r\n                this.debugSer.warn('åè¿å¶è½¬æ¢ä»éæ´åç±»å');\r\n            }\r\n            return;\r\n        }\r\n        return (Array(precision).join(this.filledSymbol) + value).slice(-precision);\r\n    }\r\n    /**\r\n     * @param value è½¬æ¢æç¾åæ°çæ°å­\r\n     * @param decimal å°æ°ç¹ä¿çå ä½\r\n     */\r\n    toPercent(value: any, precision: any) {\r\n        return Number(value * 100).toFixed(Number(precision)) + '%';\r\n    }\r\n\r\n    /**\r\n     * å°è´§å¸ç¬¦å·é¦å­æ¯è½¬æ¢æå¤§å\r\n     */\r\n    currencyToUpperCase(value: any) {\r\n        return value.replace(/[a-z]+/g, (word: any) => {\r\n            return word.toUpperCase();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * å¤çå¹´ï¼Y=>y, D=>d\r\n     */\r\n    dateToUpperCase(value: any) {\r\n        let newFormat: any;\r\n        if (/Y/g.test(value) === true) {\r\n            newFormat = value.replace(/Y/g, 'y');\r\n        } else {\r\n            newFormat = value;\r\n        }\r\n        if (/D/g.test(newFormat) === true) {\r\n            newFormat = newFormat.replace(/D/g, 'd');\r\n        }\r\n\r\n        return newFormat;\r\n    }\r\n    /**\r\n     * æä¸¾ç±»åå¤ç\r\n     */\r\n    getFormatEnumValue(value: any) {\r\n        if (value == undefined || value === null || value === '') {\r\n            return '';\r\n        }\r\n        if (this.data && this.data.length) {\r\n            // å¯è½å­å¨å¤éæä¸¾ï¼ä½ä¸ºåéç¬¦  \r\n            // let curVals = ('' + value).split(',');\r\n            let curVals = ('' + value).split(this.enumDelimiter);\r\n            let nameResult = [];\r\n            for (let k = 0; k < curVals.length; k++) {\r\n                let findObj = this.data.find(item => {\r\n                    return item[this.valueField] == curVals[k];\r\n                });\r\n                if (findObj) {\r\n                    nameResult.push(findObj[this.textField]);\r\n                }\r\n                else {\r\n                    nameResult.push(curVals[k]);\r\n                }\r\n            }\r\n            if (nameResult.length > 0) {\r\n                // return nameResult.join(',');\r\n                return nameResult.join(this.enumDelimiter);\r\n            }\r\n            return '';\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n    /**\r\n     * booleanå¼å¤ç\r\n     */\r\n    getFormatCheckBoxValue(value: boolean) {\r\n        if (value === true) {\r\n            return this.localeService.getValue('text.yes');\r\n        } else if (value === false || value == null || typeof value === 'undefined') {\r\n            return this.localeService.getValue('text.no');\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n\r\n    private timeFormatTo(value: any, fmt: string, hourSystem = 12) {\r\n\r\n    }\r\n\r\n    private makeFormater(fmt: string): string {\r\n        return fmt;\r\n    }\r\n    /*\r\n    * æ¥ææ ¼å¼å\r\n    */\r\n    dateformat(value) {\r\n        let str;\r\n        if (!this.format) {\r\n            this.format = 'YYYY-MM-DD';\r\n        }\r\n        // å½åå¼æ¯å·²ç»æ ¼å¼ååçæ¥æå­ç¬¦ä¸²\r\n        if (this.returnFormat && this.returnFormat != 'yyyy-MM-dd' && typeof value == 'string') {\r\n            value = this.getDateFromFormatedString(value, this.returnFormat);\r\n        }\r\n        //\r\n        if (this.format === 'hh:mm:ss' || this.format === 'HH:mm:ss') {\r\n            // æ ¼å¼åæ¶é´  ä¸´æ¶å¤ç\r\n            str = value;\r\n        } else {\r\n            // if (this.showTime && value instanceof String) {\r\n            //     str = value;\r\n            // } else {\r\n            //     const formArr = this.format.split(' ');\r\n            //     if (this.showTime && formArr.length < 2) {\r\n            //         formArr.push('HH:mm:ss');\r\n            //         this.format = formArr.join(' ');\r\n            //     }\r\n            //     // æ ¼å¼åæ¥æ\r\n            //     str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));\r\n            // }\r\n\r\n            str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));\r\n        }\r\n        return str;\r\n    }\r\n    private getDateFromFormatedString(dateString, format) {\r\n        var result = { year: 0, month: 0, day: 0, hour: 0, minite: 0, second: 0 }; // å½ç¶è¿éå¯ä»¥é»è®¤1970-1-1æ¥\r\n        if (dateString) {\r\n            format.replace(/y+|Y+|M+|d+|D+|h+|H+|m+|s+/g, function (m, a, b, c) {// è¿éåªåäºå¹´ææ¥  å æ¶åç§ä¹æ¯å¯ä»¥ç\r\n                dateString.substring(a).replace(/\\d+/, function (d) { c = parseInt(d, 10) });\r\n                if (/y+/i.test(m) && !result.year) result.year = c;\r\n                if (/M+/.test(m) && !result.month) result.month = c;\r\n                if (/d+/i.test(m) && !result.day) result.day = c;\r\n                if (/h+/i.test(m) && !result.hour) result.hour = c;\r\n                if (/m+/.test(m) && !result.minite) result.minite = c;\r\n                if (/s+/.test(m) && !result.second) result.second = c;\r\n            });\r\n        }\r\n        var resultDate = new Date(result.year + '/' + result.month + '/' + result.day + ' ' + result.hour + ':' + result.minite + ':' + result.second);\r\n        return resultDate;\r\n    }\r\n    /**\r\n     * æ ¼å¼åå¤ç\r\n     */\r\n    formatValue(value: any) {\r\n        let str: any;\r\n        if (this.currentLanguage) {\r\n            return this.formatLang(value);\r\n        }\r\n        // if (!value) {\r\n        //     return '';\r\n        // }\r\n        if (this.type !== 'boolean' && (value == null || typeof value === 'undefined')) {\r\n            return '';\r\n        }\r\n        switch (this.type) {\r\n            case 'string':\r\n                str = value;\r\n                break;\r\n            case 'date':\r\n            case 'datetime':\r\n                if (!this.dateRange) {\r\n                    // if (!this.format) {\r\n                    //     this.format = 'YYYY-MM-DD';\r\n                    // }\r\n                    // if (this.format === 'hh:mm:ss') {\r\n                    //     // æ ¼å¼åæ¶é´  ä¸´æ¶å¤ç\r\n                    //     str = value;\r\n                    // } else {\r\n                    //     if (this.showTime) {\r\n                    //         str = value;\r\n                    //     } else {\r\n                    //         // æ ¼å¼åæ¥æ\r\n                    //         str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));\r\n                    //     }\r\n                    // }\r\n\r\n                    str = this.dateformat(value);\r\n                } else {\r\n                    const dateValues = value.split(this.dateRangeDelimiter);\r\n\r\n                    let dataStr = [];\r\n                    if (dateValues && dateValues.length) {\r\n                        dateValues.forEach(date => {\r\n                            let val = this.dateformat(date);\r\n                            dataStr.push(val);\r\n                        });\r\n                    }\r\n                    str = dataStr.join(this.dateRangeDelimiter);\r\n                }\r\n\r\n                break;\r\n            // case 'dateTime':\r\n            //     str = this.timeFormatTo(value, this.makeFormater(this.format));\r\n            //     break;\r\n            case 'number':\r\n                str = this.getFormatNumberValue(value);\r\n                break;\r\n            case 'enum':\r\n                str = this.getFormatEnumValue(value);\r\n                break;\r\n            case 'boolean':\r\n                str = this.getFormatCheckBoxValue(value);\r\n                break;\r\n            default:\r\n                break; // throw new Error(`æä¸æ¯æ ${this.type} ç±»å`);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    private setText2Star(value) {\r\n        if (this.isPassword) {\r\n            const star = value ? '******' : '';\r\n            this.text = star;\r\n            this.control = star;\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    writeValue(value: any): void {\r\n        // lucas 2021-08-27\r\n        if (this.setText2Star(value)) {\r\n            return;\r\n        }\r\n\r\n        // xia 2021-03-13\r\n        if (this.beforeWriteValue) {\r\n            const options = {\r\n                localizationType: this.localizationType,\r\n                showTime: this.showTime,\r\n                ref: this\r\n            };\r\n            const text = this.beforeWriteValue(value, options);\r\n            if (text !== undefined) {\r\n                this.text = text;\r\n                return;\r\n            }\r\n        }\r\n        this.control = this.formatValue(value);\r\n        this.controlChange(value);\r\n    }\r\n\r\n    registerOnChange(fn: () => {}): void {\r\n        this.controlChange = fn;\r\n    }\r\n\r\n    registerOnTouched(fn): void {\r\n        this.controlTouch = fn;\r\n    }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { LocaleModule } from '@farris/ui-locale';\r\nimport { TextComponent } from './text.component';\r\nimport { NumberHelperModule } from '@farris/ui-common/number';\r\nimport { DateHelperModule } from '@farris/ui-common/date';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    TextComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    LocaleModule,\r\n    NumberHelperModule,\r\n    DateHelperModule\r\n  ],\r\n  exports: [\r\n    TextComponent\r\n  ]\r\n})\r\nexport class TextModule { }\r\n"]}