/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
export class PanelfilterCheckboxComponent {
    constructor() {
        this.checkedAll = false;
        this.boolcheck = false;
        this.searchHandle = new EventEmitter();
        this.submitChange = new EventEmitter();
        this.indeterminate = true;
        this.boolCheckState = 'indeterminate';
        this.checkboxDataSource = new Array();
    }
    /**
     * @return {?}
     */
    get item() {
        return this._item;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set item(data) {
        this._item = data;
        this.getDataSource();
        //this.checkValue = this._item.value.getOriginalValue();
        if (!this._item.hasOwnProperty('value'))
            this._item.value = { value: [] };
        if (this._item.hasOwnProperty('value')) {
            this.checkValue = this._item.value.value;
        }
        else {
            this._item.value.value = [];
        }
        if (this.boolcheck) {
            if (this.checkValue.length) {
                this.boolchecked = this.checkValue[0];
                if (this.boolchecked)
                    this.boolCheckState = 'checked';
                else
                    this.boolCheckState = 'unchecked';
            }
            else
                this.boolCheckState = 'indeterminate';
        }
        if (this._item.value.value.length == 0)
            this.checkedAll = false;
        else if (this._item.control['enumValues'] && this._item.value.value.length == this._item.control['enumValues'].length)
            this.checkedAll = true;
        this.setSubmitChange();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    getDataSource() {
        if (this.item && this._item.control) {
            /** @type {?} */
            let checkboxList = (this._item.control);
            this.checkboxDataSource = Array();
            if (checkboxList.enumValues && checkboxList.enumValues.length > 0) {
                checkboxList.enumValues.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    this.checkboxDataSource.push(Object.assign({}, element));
                }));
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onSearch(event) {
        /** @type {?} */
        let checkboxValue = [];
        if (event) {
            // let checkboxList = event.split(',');
            /** @type {?} */
            let checkboxList = event;
            if (checkboxList && checkboxList.length) {
                checkboxValue = checkboxList;
            }
            this._item.value.value = checkboxValue;
        }
        else {
            this._item.value.value = '';
        }
        if (checkboxValue.length < this._item.control['enumValues'].length)
            this.checkedAll = false;
        else if (checkboxValue.length == this._item.control['enumValues'].length)
            this.checkedAll = true;
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    }
    /**
     * @return {?}
     */
    getValueText() {
        /** @type {?} */
        const enumValue = (this._item.control).enumValues;
        /** @type {?} */
        const value = (this._item.value).value;
        if (enumValue && enumValue.length && value && value.length) {
            /** @type {?} */
            let texts = [];
            for (let i = 0; i <= value.length; i++) {
                /** @type {?} */
                const enums = enumValue.find((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    return val['value'] == value[i];
                }));
                if (enums) {
                    texts.push(enums['name']);
                }
            }
            this._item.valueText = texts.join(',');
        }
    }
    /**
     * @return {?}
     */
    setSubmitChange() {
        /** @type {?} */
        const val = this._item.value;
        if (Object.keys(val).length < 0 || Object.keys(val.value).length === 0) {
            this.submitChange.emit(false);
        }
        else {
            this.submitChange.emit(true);
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleClick(event) {
        this.checkedAll = !this.checkedAll;
        if (this.checkedAll) {
            this.setCheckedAll();
        }
        else {
            this._item.value.value = [];
            this._item.valueText = '';
            this.checkValue = [];
        }
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    }
    /**
     * @return {?}
     */
    setCheckedAll() {
        /** @type {?} */
        const enumValue = (this._item.control).enumValues;
        if (enumValue && enumValue.length) {
            /** @type {?} */
            let checkboxValue = [];
            //checkboxTexts = [];
            for (let i = 0; i < enumValue.length; i++) {
                checkboxValue.push(enumValue[i]['value']);
                //checkboxTexts.push(enumValue[i]['name'])
            }
            this._item.value.value = checkboxValue;
            this.checkValue = this._item.value.value;
            //this._item.valueText = checkboxTexts.join(',');
        }
    }
    /**
     * @return {?}
     */
    handleCheckClick() {
        if (this.boolCheckState == 'indeterminate') {
            this.boolCheckState = 'checked';
            this.boolchecked = true;
            this._item.value.value = [true];
        }
        else if (this.boolCheckState == 'checked') {
            this.boolCheckState = 'unchecked';
            this.boolchecked = false;
            this._item.value.value = [false];
        }
        else if (this.boolCheckState == 'unchecked') {
            this.boolCheckState = 'indeterminate';
            this.boolchecked = null;
            this._item.value.value = [];
        }
        this.setSubmitChange();
        this.searchHandle.emit();
    }
}
PanelfilterCheckboxComponent.decorators = [
    { type: Component, args: [{
                selector: 'panel-filter-checkbox',
                template: "<div class=\"custom-control custom-checkbox custom-control-inline filter-panel-checkbox\" *ngIf=\"!boolcheck\">\r\n    <input type=\"checkbox\" class=\"custom-control-input\"  [checked]=\"checkedAll\">\r\n    <label class=\"custom-control-label\" (click)=\"handleClick($event)\">{{'filterPanel.checkall'| locale}}</label>\r\n</div>\r\n<ng-container *ngIf=\"!boolcheck; else elseTemplate\">\r\n    <farris-checkboxgroup [value]=\"checkValue\" [horizontal]=\"false\"\r\n        [data]=\"checkboxDataSource\" [isStringValue]=\"false\" (changeValue)=\"onSearch($event)\">\r\n    </farris-checkboxgroup>\r\n</ng-container>\r\n<ng-template #elseTemplate>\r\n    <div class=\"custom-control custom-checkbox custom-control-inline filter-bool-checkbox\">\r\n        <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"boolchecked\" [indeterminate]=\"boolCheckState == 'indeterminate'\">\r\n        <label class=\"custom-control-label\" (click)=\"handleCheckClick()\">{{item.fieldName || item.name}}</label>\r\n    </div>\r\n</ng-template>\r\n\r\n"
            }] }
];
/** @nocollapse */
PanelfilterCheckboxComponent.ctorParameters = () => [];
PanelfilterCheckboxComponent.propDecorators = {
    boolcheck: [{ type: Input }],
    item: [{ type: Input }],
    searchHandle: [{ type: Output, args: ['searchHandle',] }],
    submitChange: [{ type: Output, args: ['submitChange',] }]
};
if (false) {
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkedAll;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolcheck;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype._item;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.searchHandle;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.submitChange;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkValue;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.indeterminate;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolchecked;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolCheckState;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkboxDataSource;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tib3guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1maWx0ZXItcGFuZWwvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jaGVja2JveGNvbXBvbmVudC9jaGVja2JveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFlBQVksRUFBRSxNQUFNLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFPOUUsTUFBTSxPQUFPLDRCQUE0QjtJQTRDckM7UUExQ0EsZUFBVSxHQUFXLEtBQUssQ0FBQztRQUNsQixjQUFTLEdBQVcsS0FBSyxDQUFDO1FBK0JYLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFMUQsa0JBQWEsR0FBVyxJQUFJLENBQUM7UUFFN0IsbUJBQWMsR0FBVSxlQUFlLENBQUM7UUFFeEMsdUJBQWtCLEdBQVksSUFBSSxLQUFLLEVBQU8sQ0FBQztJQUdqQyxDQUFDOzs7O0lBdkNmLElBQ0ksSUFBSTtRQUNKLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztJQUN0QixDQUFDOzs7OztJQUNELElBQUksSUFBSSxDQUFDLElBQUk7UUFDVCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNsQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsd0RBQXdEO1FBQ3hELElBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUM7WUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUN6RSxJQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFDO1lBQ2xDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUss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REFBd0M7O0lBRXhDLDBEQUErQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgRXZlbnRFbWl0dGVyLCBPdXRwdXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3BhbmVsLWZpbHRlci1jaGVja2JveCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vY2hlY2tib3guY29tcG9uZW50Lmh0bWwnXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgUGFuZWxmaWx0ZXJDaGVja2JveENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdHtcclxuXHJcbiAgICBjaGVja2VkQWxsOmJvb2xlYW4gPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGJvb2xjaGVjazpib29sZWFuID0gZmFsc2U7XHJcbiAgICBfaXRlbTphbnk7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IGl0ZW0oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW07XHJcbiAgICB9XHJcbiAgICBzZXQgaXRlbShkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5nZXREYXRhU291cmNlKCk7XHJcbiAgICAgICAgLy90aGlzLmNoZWNrVmFsdWUgPSB0aGlzLl9pdGVtLnZhbHVlLmdldE9yaWdpbmFsVmFsdWUoKTtcclxuICAgICAgICBpZighdGhpcy5faXRlbS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSkgdGhpcy5faXRlbS52YWx1ZSA9IHsgdmFsdWU6IFtdIH07XHJcbiAgICAgICAgaWYodGhpcy5faXRlbS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSl7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZSA9IHRoaXMuX2l0ZW0udmFsdWUudmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5ib29sY2hlY2spe1xyXG4gICAgICAgICAgICBpZih0aGlzLmNoZWNrVmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvb2xjaGVja2VkID0gdGhpcy5jaGVja1ZhbHVlWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5ib29sY2hlY2tlZCkgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICdjaGVja2VkJztcclxuICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICd1bmNoZWNrZWQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICdpbmRldGVybWluYXRlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5faXRlbS52YWx1ZS52YWx1ZS5sZW5ndGggPT0gMCkgdGhpcy5jaGVja2VkQWxsID0gZmFsc2U7XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9pdGVtLmNvbnRyb2xbJ2VudW1WYWx1ZXMnXSAmJiB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlLmxlbmd0aCA9PSB0aGlzLl9pdGVtLmNvbnRyb2xbJ2VudW1WYWx1ZXMnXS5sZW5ndGgpIHRoaXMuY2hlY2tlZEFsbCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZXRTdWJtaXRDaGFuZ2UoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgQE91dHB1dCgnc2VhcmNoSGFuZGxlJykgc2VhcmNoSGFuZGxlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgnc3VibWl0Q2hhbmdlJykgc3VibWl0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgY2hlY2tWYWx1ZTogYW55W107XHJcbiAgICBpbmRldGVybWluYXRlOmJvb2xlYW4gPSB0cnVlO1xyXG4gICAgYm9vbGNoZWNrZWQ6Ym9vbGVhbjtcclxuICAgIGJvb2xDaGVja1N0YXRlOnN0cmluZyA9ICdpbmRldGVybWluYXRlJztcclxuXHJcbiAgICBjaGVja2JveERhdGFTb3VyY2U6QXJyYXk8YW55Pj1uZXcgQXJyYXk8YW55PigpO1xyXG4gICAgXHJcblxyXG4gICAgY29uc3RydWN0b3IoKXt9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YVNvdXJjZSgpe1xyXG4gICAgICAgIGlmKHRoaXMuaXRlbSAmJiB0aGlzLl9pdGVtLmNvbnRyb2wpe1xyXG4gICAgICAgICAgICBsZXQgY2hlY2tib3hMaXN0PSh0aGlzLl9pdGVtLmNvbnRyb2wpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrYm94RGF0YVNvdXJjZSA9IEFycmF5PGFueT4oKTtcclxuICAgICAgICAgICAgaWYoY2hlY2tib3hMaXN0LmVudW1WYWx1ZXMgJiYgY2hlY2tib3hMaXN0LmVudW1WYWx1ZXMubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICAgICAgY2hlY2tib3hMaXN0LmVudW1WYWx1ZXMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrYm94RGF0YVNvdXJjZS5wdXNoKE9iamVjdC5hc3NpZ24oe30sZWxlbWVudCkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWFyY2goZXZlbnQpe1xyXG4gICAgICAgIGxldCBjaGVja2JveFZhbHVlID0gW107XHJcbiAgICAgICAgaWYoZXZlbnQpe1xyXG4gICAgICAgICAgICAvLyBsZXQgY2hlY2tib3hMaXN0ID0gZXZlbnQuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgbGV0IGNoZWNrYm94TGlzdCA9IGV2ZW50O1xyXG4gICAgICAgICAgICBpZihjaGVja2JveExpc3QgJiYgY2hlY2tib3hMaXN0Lmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICBjaGVja2JveFZhbHVlID0gY2hlY2tib3hMaXN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSBjaGVja2JveFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNoZWNrYm94VmFsdWUubGVuZ3RoIDwgdGhpcy5faXRlbS5jb250cm9sWydlbnVtVmFsdWVzJ10ubGVuZ3RoKSB0aGlzLmNoZWNrZWRBbGwgPSBmYWxzZTtcclxuICAgICAgICBlbHNlIGlmKGNoZWNrYm94VmFsdWUubGVuZ3RoID09IHRoaXMuX2l0ZW0uY29udHJvbFsnZW51bVZhbHVlcyddLmxlbmd0aCkgdGhpcy5jaGVja2VkQWxsID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmdldFZhbHVlVGV4dCgpO1xyXG4gICAgICAgIHRoaXMuc2V0U3VibWl0Q2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hIYW5kbGUuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFZhbHVlVGV4dCgpe1xyXG4gICAgICAgIGNvbnN0IGVudW1WYWx1ZSA9ICh0aGlzLl9pdGVtLmNvbnRyb2wpLmVudW1WYWx1ZXM7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSAodGhpcy5faXRlbS52YWx1ZSkudmFsdWU7XHJcbiAgICAgICAgaWYoZW51bVZhbHVlICYmIGVudW1WYWx1ZS5sZW5ndGggJiYgdmFsdWUgJiYgdmFsdWUubGVuZ3RoKXtcclxuICAgICAgICAgICAgbGV0IHRleHRzID0gW107XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGk8PXZhbHVlLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgY29uc3QgZW51bXMgPSBlbnVtVmFsdWUuZmluZCh2YWw9PntcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWxbJ3ZhbHVlJ10gPT0gdmFsdWVbaV07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZihlbnVtcyl7XHJcbiAgICAgICAgICAgICAgICB0ZXh0cy5wdXNoKGVudW1zWyduYW1lJ10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZVRleHQgPSB0ZXh0cy5qb2luKCcsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFN1Ym1pdENoYW5nZSgpe1xyXG4gICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuX2l0ZW0udmFsdWU7XHJcbiAgICAgICAgaWYoT2JqZWN0LmtleXModmFsKS5sZW5ndGggPCAwIHx8IE9iamVjdC5rZXlzKHZhbC52YWx1ZSkubGVuZ3RoID09PSAwKXtcclxuICAgICAgICAgICAgdGhpcy5zdWJtaXRDaGFuZ2UuZW1pdChmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc3VibWl0Q2hhbmdlLmVtaXQodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUNsaWNrKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jaGVja2VkQWxsID0gIXRoaXMuY2hlY2tlZEFsbDtcclxuICAgICAgICBpZih0aGlzLmNoZWNrZWRBbGwpe1xyXG4gICAgICAgICAgICB0aGlzLnNldENoZWNrZWRBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrVmFsdWUgPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0VmFsdWVUZXh0KCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdWJtaXRDaGFuZ2UoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q2hlY2tlZEFsbCgpe1xyXG4gICAgICAgIGNvbnN0IGVudW1WYWx1ZSA9ICh0aGlzLl9pdGVtLmNvbnRyb2wpLmVudW1WYWx1ZXM7XHJcbiAgICAgICAgaWYoZW51bVZhbHVlICYmIGVudW1WYWx1ZS5sZW5ndGgpe1xyXG4gICAgICAgICAgICBsZXQgY2hlY2tib3hWYWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy9jaGVja2JveFRleHRzID0gW107XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGk8ZW51bVZhbHVlLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgIGNoZWNrYm94VmFsdWUucHVzaChlbnVtVmFsdWVbaV1bJ3ZhbHVlJ10pO1xyXG4gICAgICAgICAgICAgICAgLy9jaGVja2JveFRleHRzLnB1c2goZW51bVZhbHVlW2ldWyduYW1lJ10pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IGNoZWNrYm94VmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZSA9IHRoaXMuX2l0ZW0udmFsdWUudmFsdWU7XHJcbiAgICAgICAgICAgIC8vdGhpcy5faXRlbS52YWx1ZVRleHQgPSBjaGVja2JveFRleHRzLmpvaW4oJywnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlQ2hlY2tDbGljaygpIHtcclxuICAgICAgICBpZih0aGlzLmJvb2xDaGVja1N0YXRlID09ICdpbmRldGVybWluYXRlJyl7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbENoZWNrU3RhdGUgPSAnY2hlY2tlZCc7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbGNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gW3RydWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuYm9vbENoZWNrU3RhdGUgPT0gJ2NoZWNrZWQnKXtcclxuICAgICAgICAgICAgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICd1bmNoZWNrZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xjaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSBbZmFsc2VdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuYm9vbENoZWNrU3RhdGUgPT0gJ3VuY2hlY2tlZCcpe1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2luZGV0ZXJtaW5hdGUnO1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xjaGVja2VkID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFN1Ym1pdENoYW5nZSgpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoKTtcclxuICAgIH1cclxufVxyXG4iXX0=