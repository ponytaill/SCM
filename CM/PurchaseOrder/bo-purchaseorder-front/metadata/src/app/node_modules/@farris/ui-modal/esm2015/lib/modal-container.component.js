/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, HostListener, Renderer2, ViewChild, Output, EventEmitter, TemplateRef, Input, ViewChildren, QueryList, HostBinding } from '@angular/core';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { DomSanitizer } from "@angular/platform-browser";
import { CLASS_NAME, DISMISS_REASONS, ModalOptions, TRANSITION_DURATIONS } from './modal-options.class';
import { isBs3 } from '@farris/ui-modal/utils';
import { ModalButtonDirective } from './modal-button.directive';
import { fromEvent } from 'rxjs';
import { delay } from 'rxjs/operators';
export class ModalContainerComponent {
    /**
     * @param {?} options
     * @param {?} el
     * @param {?} _renderer
     * @param {?} sanitizer
     */
    constructor(options, el, _renderer, sanitizer) {
        this.el = el;
        this._renderer = _renderer;
        this.sanitizer = sanitizer;
        this.isShown = false;
        this.isModalHiding = false;
        // 记录上次的高度
        this.isMax = false;
        this.closed = new EventEmitter();
        this.opened = new EventEmitter();
        this.resized = new EventEmitter();
        this.modalID = `MODALID_${Date.now().toPrecision()}`;
        this.windowResize$ = null;
        this.config = Object.assign({}, options);
        if (!this.config.buttons) {
            this.config.buttons = [
                {
                    text: '取消',
                    cls: 'btn btn-light',
                    iconCls: 'k-icon k-i-close',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        this.close();
                    })
                },
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    iconCls: 'k-icon k-i-check',
                    handle: (/**
                     * @return {?}
                     */
                    () => { alert('好(｡･∀･)ﾉﾞ嗨哟!!'); })
                }
            ];
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set iframe(value) {
        if (this.sanitizer) {
            this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.boundsElement = this.el.nativeElement;
        if (this.config.fitContent) {
            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');
        }
        if (this.isAnimated) {
            this._renderer.addClass(this.el.nativeElement, CLASS_NAME.FADE);
        }
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.isShown = true;
            this._renderer.addClass(this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
            if (this.config.fitContent && this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {
                this.el.nativeElement.scrollTop = 0;
            }
            if (document && document.body) {
                /** @type {?} */
                const modalLen = this.bsModalService.getModalsCount();
                if (modalLen === 1) {
                    this.bsModalService.checkScrollbar();
                    this.bsModalService.setScrollbar();
                }
                if (!document.body.classList.contains(CLASS_NAME.OPEN)) {
                    this._renderer.addClass(document.body, CLASS_NAME.OPEN);
                }
            }
            this.opened.emit({ modal: this });
        }), this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);
        // });
        if (this.el.nativeElement) {
            this.el.nativeElement.focus();
        }
        this.dlgHeaderLineHeight = this.getDialogHeaderLineHeight() + 'px';
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // Called after ngAfterContentInit when the component's view has been initialized. Applies to components only.
        // Add 'implements AfterViewInit' to the class.
        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
        // 如果内容适应宽度
        if (this.config.fitContent) {
            /** @type {?} */
            let initElRect = this.el.nativeElement.getBoundingClientRect();
            /** @type {?} */
            let initBodySize = this.getContainerSize();
            if (initElRect.height < initBodySize.height + 30) {
                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');
            }
        }
        this.originalHeight = this.config.height;
        this.originalWidth = this.config.width;
        this.windowResize$ = fromEvent(window, 'resize').pipe(delay(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            /** @type {?} */
            const winWidth = window.innerWidth - 20;
            /** @type {?} */
            const winHeight = window.innerHeight - 20;
            if (this.isMax) {
                this.maxDialog();
            }
            else {
                if (this.config.width > winWidth || this.config.height > winHeight) {
                    this.maxDialog();
                }
            }
            this.isMax = this.isMax && this.config.width == winWidth;
            // const dlgEl = this.getDlgElement();
            // this._renderer.setStyle(dlgEl, 'transform', `translate3d(0px, 0px, 0px)`);
            this.toCenter();
            this.moveTo(0, 0);
        }));
    }
    /**
     * @private
     * @return {?}
     */
    getDlgElement() {
        return this.el.nativeElement.querySelector('.modal-dialog');
    }
    /**
     * @private
     * @return {?}
     */
    getDialogHeaderLineHeight() {
        if (this.config.showHeader) {
            /** @type {?} */
            const modalHeaderStyles = window.getComputedStyle(this.modalHeader.nativeElement);
            /** @type {?} */
            const paddingTop = parseInt(modalHeaderStyles.paddingTop.replace('px', ''), 10);
            /** @type {?} */
            const paddingBottom = parseInt(modalHeaderStyles.paddingBottom.replace('px', ''), 10);
            return this.config.dialogHeaderHeight - paddingTop - paddingBottom;
        }
        else {
            return 0;
        }
    }
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    getContainerSize() {
        /** @type {?} */
        const bodyTarget = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        const height = bodyTarget.offsetHeight;
        /** @type {?} */
        const width = bodyTarget.offsetWidth;
        return { width, height };
    }
    /**
     * @return {?}
     */
    buildFooterStyles() {
        /** @type {?} */
        let styles = {};
        if (this.config.dialogFooterStyles) {
            styles = Object.assign({}, styles, this.config.dialogFooterStyles);
        }
        return styles;
    }
    /**
     * @return {?}
     */
    useButtonsTemplate() {
        return this.config.buttons instanceof TemplateRef;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        /** @type {?} */
        const tag = (/** @type {?} */ (event.target));
        // if (tag.localName === 'label') {
        //     if (tag.className) {
        //         const clsList = tag.className.split(' ');
        //         if (
        //             clsList.indexOf('k-radio-label') > -1 ||
        //             clsList.indexOf('k-checkbox-label') > -1 ||
        //             clsList.indexOf('custom-control-label') > -1
        //         ) {
        //             return;
        //         }
        //     }
        // }
        // if (tag.localName === 'input' && (tag.type === 'checkbox' || tag.type === 'radio' || tag.type === 'file')) {
        //     return;
        // }
        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement) {
            event.stopPropagation();
            return;
        }
        this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);
        this.close();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onEsc(event) {
        if (!this.isShown) {
            return;
        }
        if (event.keyCode === 27) {
            event.preventDefault();
        }
        if (this.config.keyboard &&
            this.level === this.bsModalService.getModalsCount()) {
            this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);
            this.close(event);
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.isShown) {
            this.close();
        }
        if (this.windowResize$) {
            this.windowResize$.unsubscribe();
            this.windowResize$ = null;
        }
    }
    /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    close(e, isCloseButton = false) {
        if (e && e.stopPropagation) {
            e.stopPropagation();
        }
        if (this.isModalHiding || !this.isShown) {
            return;
        }
        this.config.beforeClose(this, { event: e }).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        r => {
            if (!r) {
                return false;
            }
            this.isModalHiding = true;
            this._renderer.removeClass(this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.isShown = false;
                if (document &&
                    document.body) {
                    if (this.bsModalService.getModalsCount() === 1) {
                        this._renderer.removeClass(document.body, CLASS_NAME.OPEN);
                    }
                }
                this.bsModalService.hide(this.level);
                this.isModalHiding = false;
                if (this.config.closed) {
                    this.config.closed(isCloseButton, { modalRef: this, event: e });
                }
                this.closed.emit(this.level);
            }), this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);
            // });
        }));
    }
    /**
     * @return {?}
     */
    toCenter() {
        /** @type {?} */
        const marginLeft = Number.parseInt('' + -this.config.width / 2) + 'px';
        /** @type {?} */
        const marginTop = Number.parseInt('' + -this.config.height / 2) + 'px';
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        /** @type {?} */
        const contentEl = this.el.nativeElement.querySelector('.modal-body');
        this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);
        this._renderer.setStyle(dialogEl, 'margin-top', marginTop);
        /** @type {?} */
        let contentHeight = this.config.height - 38;
        if (this.config.showButtons) {
            contentHeight = contentHeight - 50;
        }
        if (!this.config.fitContent) {
            this._renderer.setStyle(contentEl, 'height', contentHeight + 'px');
        }
        this._renderer.setStyle(contentEl, 'overflow', 'hidden');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(0px, 0px, 0px)`);
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const container = this.getContainerSize();
            const { width: containerWidth, height: containerHeight } = container;
            this.resized.emit({ width: this.config.width, height: this.config.height, containerWidth, containerHeight });
        }));
    }
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    moveTo(x, y) {
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(${x}px, ${y}px, 0px)`);
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.draggbar.position = { x, y };
        this.draggbar.resetPosition();
    }
    /**
     * @return {?}
     */
    maxDialog() {
        this.prevWidth = this.config.width;
        this.prevHeight = this.config.height;
        // this.config.width = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientWidth'] - 20;
        // this.config.height = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientHeight'] - 20;
        this.config.width = window.innerWidth - 20;
        this.config.height = window.innerHeight - 20;
        this.config.draggable = false;
        this.config.resizable = false;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.addClass(dialogEl, 'model-dialog-maximize');
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.isMax = true;
        this.toCenter();
    }
    /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    resize(width, height) {
        if (width) {
            this.config.width = width;
        }
        if (height) {
            this.config.height = height;
        }
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    }
    /**
     * @param {?} el
     * @return {?}
     */
    dropdown(el) {
        // const rect = el.getBoundingClientRect();
        // this._renderer.removeStyle(el, 'margin-top');
        // this._renderer.removeStyle(el, 'margin-left');
        // this._renderer.setStyle(el, 'top', `${rect.top}px`);
        // this._renderer.setStyle(el, 'left', `${rect.left}px`);
        // this._renderer.removeStyle(el, 'transform');
        // this._renderer.removeStyle(el, '-webkit-transform');
        // this._renderer.removeStyle(el, '-ms-transform');
        // this._renderer.removeStyle(el, '-moz-transform');
        // this._renderer.removeStyle(el, '-o-transform');
    }
    /**
     * @return {?}
     */
    revertDialog() {
        this.isMax = false;
        /** @type {?} */
        const ww = window.innerWidth - 20;
        /** @type {?} */
        const wh = window.innerHeight - 20;
        this.config.width = this.prevWidth == ww ? this.originalWidth : this.prevWidth;
        this.config.height = this.prevHeight == wh ? this.originalHeight : this.prevHeight;
        if (this.config.width > ww) {
            this.config.width = ww;
        }
        if (this.config.height > wh) {
            this.config.height = wh;
        }
        this.config.draggable = true;
        this.config.resizable = true;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    }
    /**
     * @return {?}
     */
    changeDialogSize() {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
    }
    /**
     * @param {?} opts
     * @return {?}
     */
    resizeStop(opts) {
        // console.log('resizeStop');
        this.config.width = opts.size.width;
        this.config.height = opts.size.height;
        /** @type {?} */
        const container = this.getContainerSize();
        const { width: containerWidth, height: containerHeight } = container;
        this.resized.emit(Object.assign({}, opts.size, { containerWidth, containerHeight }));
    }
}
ModalContainerComponent.decorators = [
    { type: Component, args: [{
                selector: 'modal-container',
                template: `
    <div [attr.id]="modalID"

        [ngDraggable]="config.draggable"
        [ngResizable]="config.resizable"
        [rzMinWidth]="config.minWidth"
        [rzMaxWidth]="config.maxWidth"
        [rzMinHeight]="config.minHeight"
        [rzMaxHeight]="config.maxHeight"
        rzHandles="all" [handle]="config.showHeader ? header:dragEl"
        (stopped)="dropdown($event)"
        (rzStop)="resizeStop($event)"
        [inBounds]="true" [bounds]="boundsElement"
        [class]="'modal-dialog' + (config.class ? ' ' + config.class : '')" role="document"
        [style.width]="config.width + 'px'" [style.height]="config.fitContent?'auto':(config.height + 'px')"
        style="position: absolute;top: 50%;left: 50%;">
        <div class="modal-content" [ngClass]="{'modal-content--has-header':config.showHeader}">
            <div #header class="modal-header" [style.display]="config.showHeader ? '': 'none'">
                <div class="modal-title">
                    <span *ngIf="config.iconCls" [class]="config.iconCls" style="margin-right: 8px"></span>
                    <span class="modal-title-label">{{ config.title }}</span>
                </div>
                <div class="actions">
                    <ul>
                        <li *ngIf="config.showMinButton" class="f-btn-icon f-bare">
                            <span class="f-icon modal_minimize"></span></li>
                        <li *ngIf="config.showMaxButton" (click)="changeDialogSize()" class="f-btn-icon f-bare">
                            <span class="f-icon modal_maximize" [class.modalrevert]="isMax"></span>
                        </li>
                        <li *ngIf="config.showCloseButton" (click)="close($event, true)" class="f-btn-icon f-bare">
                             <span class="f-icon modal_close"></span>
                        </li>
                    </ul>
                </div>
            </div>
        <div #dragEl class="f-utils-absolute-all" style="height:10px;z-index: 1;" [style.display]="config.showHeader ? 'none': ''"></div>
            <div class="modal-body" [class.f-utils-flex-column]="dialogType === 'iframe'"   [f-area-response]="config.areaResponse">
                <perfect-scrollbar [config]="{}" [disabled]="!config.enableScroll||config.fitContent"  *ngIf="!dialogType || dialogType === 'default'">
                    <ng-content ></ng-content>
                </perfect-scrollbar>
                <iframe *ngIf="dialogType === 'iframe'" class="f-utils-fill" width="100%" frameborder="0" [src]="iframeSrc"></iframe>
            </div>

            <div [style.textAlign]="config.buttonAlign" class="modal-footer" [ngStyle]="buildFooterStyles()" *ngIf="config.showButtons && config.buttons">
                <ng-container [ngTemplateOutlet]="useButtonsTemplate() ? config.buttons : defaultButtonRef"></ng-container>
            </div>
        </div>
    </div>

    <ng-template #defaultButtonRef>
        <button type="button" modal-button
            *ngFor="let btn of config.buttons; last as isLast" [class]="btn.cls"
            (click)="btn.handle && btn.handle($event) " 
            [style.display]="(btn.display === true || btn.display === undefined) ? '' : 'none'"
            [farrisTooltip]="btn?.tipsEnable" [placement]="'top'" [delay]="500" [content]="btn?.tipsText">
            <span [class]="btn.iconCls" *ngIf="btn.iconCls"></span> {{ btn.text }}
        </button>
    </ng-template>
  `,
                host: {
                    class: 'modal farris-modal',
                    role: 'dialog',
                    tabindex: '-1',
                    '[attr.aria-modal]': 'true'
                }
            }] }
];
/** @nocollapse */
ModalContainerComponent.ctorParameters = () => [
    { type: ModalOptions },
    { type: ElementRef },
    { type: Renderer2 },
    { type: DomSanitizer }
];
ModalContainerComponent.propDecorators = {
    iframe: [{ type: Input }],
    draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
    modalHeader: [{ type: ViewChild, args: ['header',] }],
    closed: [{ type: Output }],
    opened: [{ type: Output }],
    resized: [{ type: Output }],
    modalID: [{ type: HostBinding, args: ['id',] }],
    buttons: [{ type: ViewChildren, args: [ModalButtonDirective,] }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onEsc: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    ModalContainerComponent.prototype.config;
    /** @type {?} */
    ModalContainerComponent.prototype.isShown;
    /** @type {?} */
    ModalContainerComponent.prototype.level;
    /** @type {?} */
    ModalContainerComponent.prototype.isAnimated;
    /** @type {?} */
    ModalContainerComponent.prototype.bsModalService;
    /** @type {?} */
    ModalContainerComponent.prototype.dialogType;
    /** @type {?} */
    ModalContainerComponent.prototype.iframeSrc;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.isModalHiding;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevHeight;
    /** @type {?} */
    ModalContainerComponent.prototype.isMax;
    /** @type {?} */
    ModalContainerComponent.prototype.draggbar;
    /** @type {?} */
    ModalContainerComponent.prototype.modalHeader;
    /** @type {?} */
    ModalContainerComponent.prototype.boundsElement;
    /** @type {?} */
    ModalContainerComponent.prototype.closed;
    /** @type {?} */
    ModalContainerComponent.prototype.opened;
    /** @type {?} */
    ModalContainerComponent.prototype.resized;
    /** @type {?} */
    ModalContainerComponent.prototype.modalID;
    /** @type {?} */
    ModalContainerComponent.prototype.buttons;
    /** @type {?} */
    ModalContainerComponent.prototype.dlgHeaderLineHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.windowResize$;
    /**
     * @type {?}
     * @protected
     */
    ModalContainerComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.sanitizer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbW9kYWwvIiwic291cmNlcyI6WyJsaWIvbW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNILFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUMzQixTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFDcEMsWUFBWSxFQUFFLFdBQVcsRUFBaUIsS0FBSyxFQUUvQyxZQUFZLEVBQ1osU0FBUyxFQUNULFdBQVcsRUFDZCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFtQixNQUFNLDJCQUEyQixDQUFDO0FBQzFFLE9BQU8sRUFDSCxVQUFVLEVBQUUsZUFBZSxFQUMzQixZQUFZLEVBQUUsb0JBQW9CLEVBQ3JDLE1BQU0sdUJBQXVCLENBQUM7QUFFL0IsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9DLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxTQUFTLEVBQWdCLE1BQU0sTUFBTSxDQUFDO0FBQy9DLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQXNFdkMsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7OztJQW9DaEMsWUFDSSxPQUFxQixFQUNYLEVBQWMsRUFDaEIsU0FBb0IsRUFDcEIsU0FBdUI7UUFGckIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNoQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3BCLGNBQVMsR0FBVCxTQUFTLENBQWM7UUF0Q25DLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFZUixrQkFBYSxHQUFHLEtBQUssQ0FBQzs7UUFNOUIsVUFBSyxHQUFHLEtBQUssQ0FBQztRQU1K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LFlBQVksU0FBQyxPQUFPLEVBQUUsQ0FBQyxRQUFRLENBQUM7b0JBOEJoQyxZQUFZLFNBQUMsb0JBQW9CLEVBQUUsQ0FBQyxRQUFRLENBQUM7Ozs7SUFqTjlDLHlDQUFxQjs7SUFDckIsMENBQWdCOztJQUNoQix3Q0FBYzs7SUFDZCw2Q0FBb0I7O0lBQ3BCLGlEQUErQjs7SUFDL0IsNkNBQW1COztJQUNuQiw0Q0FBMkI7Ozs7O0lBTzNCLGdEQUE4Qjs7Ozs7SUFDOUIsZ0RBQThCOzs7OztJQUM5QixpREFBK0I7Ozs7O0lBRS9CLDRDQUEwQjs7Ozs7SUFDMUIsNkNBQTJCOztJQUMzQix3Q0FBYzs7SUFFZCwyQ0FBMEU7O0lBQzFFLDhDQUE2Qzs7SUFDN0MsZ0RBQTJCOztJQUUzQix5Q0FBc0M7O0lBQ3RDLHlDQUFzQzs7SUFDdEMsMENBQXVDOztJQUV2QywwQ0FBbUU7O0lBRW5FLDBDQUE2RTs7SUFFN0Usc0RBQXlCOzs7OztJQUN6QixnREFBMkM7Ozs7O0lBR3ZDLHFDQUF3Qjs7Ozs7SUFDeEIsNENBQTRCOzs7OztJQUM1Qiw0Q0FBK0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBIb3N0TGlzdGVuZXIsIE9uRGVzdHJveSxcclxuICAgIE9uSW5pdCwgUmVuZGVyZXIyLCBWaWV3Q2hpbGQsIE91dHB1dCxcclxuICAgIEV2ZW50RW1pdHRlciwgVGVtcGxhdGVSZWYsIEFmdGVyVmlld0luaXQsIElucHV0LFxyXG4gICAgTmdab25lLFxyXG4gICAgVmlld0NoaWxkcmVuLFxyXG4gICAgUXVlcnlMaXN0LFxyXG4gICAgSG9zdEJpbmRpbmdcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZSB9IGZyb20gJ0BmYXJyaXMvdWktZHJhZ2dhYmxlJztcclxuaW1wb3J0IHsgRG9tU2FuaXRpemVyLCBTYWZlUmVzb3VyY2VVcmwgfSBmcm9tIFwiQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3NlclwiO1xyXG5pbXBvcnQge1xyXG4gICAgQ0xBU1NfTkFNRSwgRElTTUlTU19SRUFTT05TLFxyXG4gICAgTW9kYWxPcHRpb25zLCBUUkFOU0lUSU9OX0RVUkFUSU9OU1xyXG59IGZyb20gJy4vbW9kYWwtb3B0aW9ucy5jbGFzcyc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnLi9icy1tb2RhbC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgaXNCczMgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsL3V0aWxzJztcclxuaW1wb3J0IHsgTW9kYWxCdXR0b25EaXJlY3RpdmUgfSBmcm9tICcuL21vZGFsLWJ1dHRvbi5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBmcm9tRXZlbnQsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBkZWxheSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdtb2RhbC1jb250YWluZXInLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgW2F0dHIuaWRdPVwibW9kYWxJRFwiXHJcblxyXG4gICAgICAgIFtuZ0RyYWdnYWJsZV09XCJjb25maWcuZHJhZ2dhYmxlXCJcclxuICAgICAgICBbbmdSZXNpemFibGVdPVwiY29uZmlnLnJlc2l6YWJsZVwiXHJcbiAgICAgICAgW3J6TWluV2lkdGhdPVwiY29uZmlnLm1pbldpZHRoXCJcclxuICAgICAgICBbcnpNYXhXaWR0aF09XCJjb25maWcubWF4V2lkdGhcIlxyXG4gICAgICAgIFtyek1pbkhlaWdodF09XCJjb25maWcubWluSGVpZ2h0XCJcclxuICAgICAgICBbcnpNYXhIZWlnaHRdPVwiY29uZmlnLm1heEhlaWdodFwiXHJcbiAgICAgICAgcnpIYW5kbGVzPVwiYWxsXCIgW2hhbmRsZV09XCJjb25maWcuc2hvd0hlYWRlciA/IGhlYWRlcjpkcmFnRWxcIlxyXG4gICAgICAgIChzdG9wcGVkKT1cImRyb3Bkb3duKCRldmVudClcIlxyXG4gICAgICAgIChyelN0b3ApPVwicmVzaXplU3RvcCgkZXZlbnQpXCJcclxuICAgICAgICBbaW5Cb3VuZHNdPVwidHJ1ZVwiIFtib3VuZHNdPVwiYm91bmRzRWxlbWVudFwiXHJcbiAgICAgICAgW2NsYXNzXT1cIidtb2RhbC1kaWFsb2cnICsgKGNvbmZpZy5jbGFzcyA/ICcgJyArIGNvbmZpZy5jbGFzcyA6ICcnKVwiIHJvbGU9XCJkb2N1bWVudFwiXHJcbiAgICAgICAgW3N0eWxlLndpZHRoXT1cImNvbmZpZy53aWR0aCArICdweCdcIiBbc3R5bGUuaGVpZ2h0XT1cImNvbmZpZy5maXRDb250ZW50PydhdXRvJzooY29uZmlnLmhlaWdodCArICdweCcpXCJcclxuICAgICAgICBzdHlsZT1cInBvc2l0aW9uOiBhYnNvbHV0ZTt0b3A6IDUwJTtsZWZ0OiA1MCU7XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIiBbbmdDbGFzc109XCJ7J21vZGFsLWNvbnRlbnQtLWhhcy1oZWFkZXInOmNvbmZpZy5zaG93SGVhZGVyfVwiPlxyXG4gICAgICAgICAgICA8ZGl2ICNoZWFkZXIgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIiBbc3R5bGUuZGlzcGxheV09XCJjb25maWcuc2hvd0hlYWRlciA/ICcnOiAnbm9uZSdcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC10aXRsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiY29uZmlnLmljb25DbHNcIiBbY2xhc3NdPVwiY29uZmlnLmljb25DbHNcIiBzdHlsZT1cIm1hcmdpbi1yaWdodDogOHB4XCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kYWwtdGl0bGUtbGFiZWxcIj57eyBjb25maWcudGl0bGUgfX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd01pbkJ1dHRvblwiIGNsYXNzPVwiZi1idG4taWNvbiBmLWJhcmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIG1vZGFsX21pbmltaXplXCI+PC9zcGFuPjwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSAqbmdJZj1cImNvbmZpZy5zaG93TWF4QnV0dG9uXCIgKGNsaWNrKT1cImNoYW5nZURpYWxvZ1NpemUoKVwiIGNsYXNzPVwiZi1idG4taWNvbiBmLWJhcmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIG1vZGFsX21heGltaXplXCIgW2NsYXNzLm1vZGFscmV2ZXJ0XT1cImlzTWF4XCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd0Nsb3NlQnV0dG9uXCIgKGNsaWNrKT1cImNsb3NlKCRldmVudCwgdHJ1ZSlcIiBjbGFzcz1cImYtYnRuLWljb24gZi1iYXJlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmLWljb24gbW9kYWxfY2xvc2VcIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2ICNkcmFnRWwgY2xhc3M9XCJmLXV0aWxzLWFic29sdXRlLWFsbFwiIHN0eWxlPVwiaGVpZ2h0OjEwcHg7ei1pbmRleDogMTtcIiBbc3R5bGUuZGlzcGxheV09XCJjb25maWcuc2hvd0hlYWRlciA/ICdub25lJzogJydcIj48L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIiBbY2xhc3MuZi11dGlscy1mbGV4LWNvbHVtbl09XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiICAgW2YtYXJlYS1yZXNwb25zZV09XCJjb25maWcuYXJlYVJlc3BvbnNlXCI+XHJcbiAgICAgICAgICAgICAgICA8cGVyZmVjdC1zY3JvbGxiYXIgW2NvbmZpZ109XCJ7fVwiIFtkaXNhYmxlZF09XCIhY29uZmlnLmVuYWJsZVNjcm9sbHx8Y29uZmlnLmZpdENvbnRlbnRcIiAgKm5nSWY9XCIhZGlhbG9nVHlwZSB8fCBkaWFsb2dUeXBlID09PSAnZGVmYXVsdCdcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGVudCA+PC9uZy1jb250ZW50PlxyXG4gICAgICAgICAgICAgICAgPC9wZXJmZWN0LXNjcm9sbGJhcj5cclxuICAgICAgICAgICAgICAgIDxpZnJhbWUgKm5nSWY9XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiIGNsYXNzPVwiZi11dGlscy1maWxsXCIgd2lkdGg9XCIxMDAlXCIgZnJhbWVib3JkZXI9XCIwXCIgW3NyY109XCJpZnJhbWVTcmNcIj48L2lmcmFtZT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IFtzdHlsZS50ZXh0QWxpZ25dPVwiY29uZmlnLmJ1dHRvbkFsaWduXCIgY2xhc3M9XCJtb2RhbC1mb290ZXJcIiBbbmdTdHlsZV09XCJidWlsZEZvb3RlclN0eWxlcygpXCIgKm5nSWY9XCJjb25maWcuc2hvd0J1dHRvbnMgJiYgY29uZmlnLmJ1dHRvbnNcIj5cclxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwidXNlQnV0dG9uc1RlbXBsYXRlKCkgPyBjb25maWcuYnV0dG9ucyA6IGRlZmF1bHRCdXR0b25SZWZcIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRCdXR0b25SZWY+XHJcbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgbW9kYWwtYnV0dG9uXHJcbiAgICAgICAgICAgICpuZ0Zvcj1cImxldCBidG4gb2YgY29uZmlnLmJ1dHRvbnM7IGxhc3QgYXMgaXNMYXN0XCIgW2NsYXNzXT1cImJ0bi5jbHNcIlxyXG4gICAgICAgICAgICAoY2xpY2spPVwiYnRuLmhhbmRsZSAmJiBidG4uaGFuZGxlKCRldmVudCkgXCIgXHJcbiAgICAgICAgICAgIFtzdHlsZS5kaXNwbGF5XT1cIihidG4uZGlzcGxheSA9PT0gdHJ1ZSB8fCBidG4uZGlzcGxheSA9PT0gdW5kZWZpbmVkKSA/ICcnIDogJ25vbmUnXCJcclxuICAgICAgICAgICAgW2ZhcnJpc1Rvb2x0aXBdPVwiYnRuPy50aXBzRW5hYmxlXCIgW3BsYWNlbWVudF09XCIndG9wJ1wiIFtkZWxheV09XCI1MDBcIiBbY29udGVudF09XCJidG4/LnRpcHNUZXh0XCI+XHJcbiAgICAgICAgICAgIDxzcGFuIFtjbGFzc109XCJidG4uaWNvbkNsc1wiICpuZ0lmPVwiYnRuLmljb25DbHNcIj48L3NwYW4+IHt7IGJ0bi50ZXh0IH19XHJcbiAgICAgICAgPC9idXR0b24+XHJcbiAgICA8L25nLXRlbXBsYXRlPlxyXG4gIGAsXHJcbiAgICBob3N0OiB7XHJcbiAgICAgICAgY2xhc3M6ICdtb2RhbCBmYXJyaXMtbW9kYWwnLFxyXG4gICAgICAgIHJvbGU6ICdkaWFsb2cnLFxyXG4gICAgICAgIHRhYmluZGV4OiAnLTEnLFxyXG4gICAgICAgICdbYXR0ci5hcmlhLW1vZGFsXSc6ICd0cnVlJ1xyXG4gICAgfVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTW9kYWxDb250YWluZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBjb25maWc6IE1vZGFsT3B0aW9ucztcclxuICAgIGlzU2hvd24gPSBmYWxzZTtcclxuICAgIGxldmVsOiBudW1iZXI7XHJcbiAgICBpc0FuaW1hdGVkOiBib29sZWFuO1xyXG4gICAgYnNNb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlO1xyXG4gICAgZGlhbG9nVHlwZTogc3RyaW5nO1xyXG4gICAgaWZyYW1lU3JjOiBTYWZlUmVzb3VyY2VVcmw7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgcHVibGljIHNldCBpZnJhbWUodmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIGlmICh0aGlzLnNhbml0aXplcikge1xyXG4gICAgICAgICAgICB0aGlzLmlmcmFtZVNyYyA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RSZXNvdXJjZVVybCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBpc01vZGFsSGlkaW5nID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIG9yaWdpbmFsV2lkdGg6IG51bWJlcjsgIC8vIOiusOW9leWOn+Wni+eahOWuveW6plxyXG4gICAgcHJpdmF0ZSBvcmlnaW5hbEhlaWdodDogbnVtYmVyOyAvLyDorrDlvZXljp/lp4vnmoTpq5jluqZcclxuXHJcbiAgICBwcml2YXRlIHByZXZXaWR0aDogbnVtYmVyOyAvLyDorrDlvZXkuIrmrKHnmoTlrr3luqZcclxuICAgIHByaXZhdGUgcHJldkhlaWdodDogbnVtYmVyOyAvLyDorrDlvZXkuIrmrKHnmoTpq5jluqZcclxuICAgIGlzTWF4ID0gZmFsc2U7XHJcblxyXG4gICAgQFZpZXdDaGlsZChBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlKSBkcmFnZ2JhcjogQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ2hlYWRlcicpIG1vZGFsSGVhZGVyOiBFbGVtZW50UmVmO1xyXG4gICAgYm91bmRzRWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcblxyXG4gICAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBvcGVuZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgcmVzaXplZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2lkJykgbW9kYWxJRCA9IGBNT0RBTElEXyR7RGF0ZS5ub3coKS50b1ByZWNpc2lvbigpfWA7XHJcblxyXG4gICAgQFZpZXdDaGlsZHJlbihNb2RhbEJ1dHRvbkRpcmVjdGl2ZSkgYnV0dG9uczogUXVlcnlMaXN0PE1vZGFsQnV0dG9uRGlyZWN0aXZlPjtcclxuXHJcbiAgICBkbGdIZWFkZXJMaW5lSGVpZ2h0OiBhbnk7XHJcbiAgICBwcml2YXRlIHdpbmRvd1Jlc2l6ZSQ6IFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBvcHRpb25zOiBNb2RhbE9wdGlvbnMsXHJcbiAgICAgICAgcHJvdGVjdGVkIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgcHJpdmF0ZSBzYW5pdGl6ZXI6IERvbVNhbml0aXplclxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29uZmlnLmJ1dHRvbnMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcuYnV0dG9ucyA9IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn5Y+W5raIJyxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLWxpZ2h0JyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xzOiAnay1pY29uIGstaS1jbG9zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfnoa7lrponLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNsczogJ2staWNvbiBrLWktY2hlY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4geyBhbGVydCgn5aW9KO+9oe+9peKIgO+9pSnvvonvvp7ll6jlk58hIScpOyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuYm91bmRzRWxlbWVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWZpdENvbnRlbnQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzQW5pbWF0ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCBDTEFTU19OQU1FLkZBREUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTaG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgaXNCczMoKSA/IENMQVNTX05BTUUuSU4gOiBDTEFTU19OQU1FLlNIT1dcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCAmJiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YoJ2YtbW9kYWwtZml0Q29udGVudC1zY3JvbGwnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50ICYmIGRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsTGVuID0gdGhpcy5ic01vZGFsU2VydmljZS5nZXRNb2RhbHNDb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZGFsTGVuID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5jaGVja1Njcm9sbGJhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0U2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX05BTUUuT1BFTikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhkb2N1bWVudC5ib2R5LCBDTEFTU19OQU1FLk9QRU4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3BlbmVkLmVtaXQoeyBtb2RhbDogdGhpcyB9KTtcclxuICAgICAgICB9LCB0aGlzLmlzQW5pbWF0ZWQgPyBUUkFOU0lUSU9OX0RVUkFUSU9OUy5CQUNLRFJPUCA6IDApO1xyXG4gICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5lbC5uYXRpdmVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kbGdIZWFkZXJMaW5lSGVpZ2h0ID0gdGhpcy5nZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCkgKyAncHgnO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyBDYWxsZWQgYWZ0ZXIgbmdBZnRlckNvbnRlbnRJbml0IHdoZW4gdGhlIGNvbXBvbmVudCdzIHZpZXcgaGFzIGJlZW4gaW5pdGlhbGl6ZWQuIEFwcGxpZXMgdG8gY29tcG9uZW50cyBvbmx5LlxyXG4gICAgICAgIC8vIEFkZCAnaW1wbGVtZW50cyBBZnRlclZpZXdJbml0JyB0byB0aGUgY2xhc3MuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICAgIC8vIOWmguaenOWGheWuuemAguW6lOWuveW6plxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIGxldCBpbml0RWxSZWN0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICBsZXQgaW5pdEJvZHlTaXplID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgICAgIGlmIChpbml0RWxSZWN0LmhlaWdodCA8IGluaXRCb2R5U2l6ZS5oZWlnaHQgKyAzMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZi1tb2RhbC1maXRDb250ZW50LXNjcm9sbCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm9yaWdpbmFsSGVpZ2h0ID0gdGhpcy5jb25maWcuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG5cclxuICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZSQgPSBmcm9tRXZlbnQod2luZG93LCAncmVzaXplJykucGlwZShcclxuICAgICAgICAgICAgZGVsYXkoNTApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB3aW5XaWR0aCA9ICB3aW5kb3cuaW5uZXJXaWR0aCAtMjA7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpbkhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIDIwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc01heCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy53aWR0aCA+IHdpbldpZHRoIHx8IHRoaXMuY29uZmlnLmhlaWdodCA+ICB3aW5IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heERpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaXNNYXggPSB0aGlzLmlzTWF4ICYmICB0aGlzLmNvbmZpZy53aWR0aCA9PSB3aW5XaWR0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIGNvbnN0IGRsZ0VsID0gdGhpcy5nZXREbGdFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRsZ0VsLCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpYCk7XHJcbiAgICAgICAgICAgIHRoaXMudG9DZW50ZXIoKTtcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oMCwgMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGxnRWxlbWVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldERpYWxvZ0hlYWRlckxpbmVIZWlnaHQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLnNob3dIZWFkZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgbW9kYWxIZWFkZXJTdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm1vZGFsSGVhZGVyLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICBjb25zdCBwYWRkaW5nVG9wID0gcGFyc2VJbnQobW9kYWxIZWFkZXJTdHlsZXMucGFkZGluZ1RvcC5yZXBsYWNlKCdweCcsICcnKSwgMTApO1xyXG4gICAgICAgICAgICBjb25zdCBwYWRkaW5nQm90dG9tID0gcGFyc2VJbnQobW9kYWxIZWFkZXJTdHlsZXMucGFkZGluZ0JvdHRvbS5yZXBsYWNlKCdweCcsICcnKSwgMTApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuZGlhbG9nSGVhZGVySGVpZ2h0IC0gcGFkZGluZ1RvcCAtIHBhZGRpbmdCb3R0b207XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPluWGheWuueWMuuWfn+eahOWwuuWvuFxyXG4gICAgZ2V0Q29udGFpbmVyU2l6ZSgpIHtcclxuICAgICAgICBjb25zdCBib2R5VGFyZ2V0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1ib2R5Jyk7XHJcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gYm9keVRhcmdldC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgY29uc3Qgd2lkdGggPSBib2R5VGFyZ2V0Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHJldHVybiB7IHdpZHRoLCBoZWlnaHQgfTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZEZvb3RlclN0eWxlcygpIHtcclxuICAgICAgICBsZXQgc3R5bGVzID0ge307XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5kaWFsb2dGb290ZXJTdHlsZXMpIHtcclxuICAgICAgICAgICAgc3R5bGVzID0gT2JqZWN0LmFzc2lnbih7fSwgc3R5bGVzLCB0aGlzLmNvbmZpZy5kaWFsb2dGb290ZXJTdHlsZXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0eWxlcztcclxuICAgIH1cclxuXHJcbiAgICB1c2VCdXR0b25zVGVtcGxhdGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLmJ1dHRvbnMgaW5zdGFuY2VvZiBUZW1wbGF0ZVJlZjtcclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pXHJcbiAgICBvbkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgdGFnID0gZXZlbnQudGFyZ2V0IGFzIGFueTtcclxuXHJcbiAgICAgICAgLy8gaWYgKHRhZy5sb2NhbE5hbWUgPT09ICdsYWJlbCcpIHtcclxuICAgICAgICAvLyAgICAgaWYgKHRhZy5jbGFzc05hbWUpIHtcclxuICAgICAgICAvLyAgICAgICAgIGNvbnN0IGNsc0xpc3QgPSB0YWcuY2xhc3NOYW1lLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAoXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgY2xzTGlzdC5pbmRleE9mKCdrLXJhZGlvLWxhYmVsJykgPiAtMSB8fFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGNsc0xpc3QuaW5kZXhPZignay1jaGVja2JveC1sYWJlbCcpID4gLTEgfHxcclxuICAgICAgICAvLyAgICAgICAgICAgICBjbHNMaXN0LmluZGV4T2YoJ2N1c3RvbS1jb250cm9sLWxhYmVsJykgPiAtMVxyXG4gICAgICAgIC8vICAgICAgICAgKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAvLyBpZiAodGFnLmxvY2FsTmFtZSA9PT0gJ2lucHV0JyAmJiAodGFnLnR5cGUgPT09ICdjaGVja2JveCcgfHwgdGFnLnR5cGUgPT09ICdyYWRpbycgfHwgdGFnLnR5cGUgPT09ICdmaWxlJykpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmlnbm9yZUJhY2tkcm9wQ2xpY2sgfHwgdGhpcy5jb25maWcuYmFja2Ryb3AgPT09ICdzdGF0aWMnIHx8IGV2ZW50LnRhcmdldCAhPT0gdGhpcy5lbC5uYXRpdmVFbGVtZW50ICkge1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5zZXREaXNtaXNzUmVhc29uKERJU01JU1NfUkVBU09OUy5CQUNLUkRPUCk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlkb3duLmVzYycsIFsnJGV2ZW50J10pXHJcbiAgICBvbkVzYyhldmVudDogYW55KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzU2hvd24pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmtleWJvYXJkICYmXHJcbiAgICAgICAgICAgIHRoaXMubGV2ZWwgPT09IHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLnNldERpc21pc3NSZWFzb24oRElTTUlTU19SRUFTT05TLkVTQyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pc1Nob3duKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLndpbmRvd1Jlc2l6ZSQpIHtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dSZXNpemUkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93UmVzaXplJCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKGU/OiBNb3VzZUV2ZW50LCBpc0Nsb3NlQnV0dG9uID0gZmFsc2UpOiB2b2lkIHtcclxuICAgICAgICBpZiAoZSAmJiBlLnN0b3BQcm9wYWdhdGlvbikge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNNb2RhbEhpZGluZyB8fCAhdGhpcy5pc1Nob3duKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLmJlZm9yZUNsb3NlKHRoaXMsIHsgZXZlbnQ6IGUgfSkuc3Vic2NyaWJlKHIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pc01vZGFsSGlkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3MoXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBpc0JzMygpID8gQ0xBU1NfTkFNRS5JTiA6IENMQVNTX05BTUUuU0hPV1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTaG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LCBDTEFTU19OQU1FLk9QRU4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2UuaGlkZSh0aGlzLmxldmVsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNNb2RhbEhpZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmNsb3NlZChpc0Nsb3NlQnV0dG9uLCB7IG1vZGFsUmVmOiB0aGlzLCBldmVudDogZSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VkLmVtaXQodGhpcy5sZXZlbCk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMuaXNBbmltYXRlZCA/IFRSQU5TSVRJT05fRFVSQVRJT05TLk1PREFMIDogMCk7XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRvQ2VudGVyKCkge1xyXG4gICAgICAgIGNvbnN0IG1hcmdpbkxlZnQgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcud2lkdGggLyAyKSArICdweCc7XHJcbiAgICAgICAgY29uc3QgbWFyZ2luVG9wID0gTnVtYmVyLnBhcnNlSW50KCcnICsgLXRoaXMuY29uZmlnLmhlaWdodCAvIDIpICsgJ3B4JztcclxuXHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG5cclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ21hcmdpbi1sZWZ0JywgbWFyZ2luTGVmdCk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdtYXJnaW4tdG9wJywgbWFyZ2luVG9wKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQgLSAzODtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuc2hvd0J1dHRvbnMpIHtcclxuICAgICAgICAgICAgY29udGVudEhlaWdodCA9IGNvbnRlbnRIZWlnaHQgLSA1MDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgY29udGVudEVsLFxyXG4gICAgICAgICAgICAgICAgJ2hlaWdodCcsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50SGVpZ2h0ICsgJ3B4J1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjb250ZW50RWwsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweClgKTtcclxuXHJcblxyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdCh7IHdpZHRoOiB0aGlzLmNvbmZpZy53aWR0aCwgaGVpZ2h0OiB0aGlzLmNvbmZpZy5oZWlnaHQsICBjb250YWluZXJXaWR0aCwgIGNvbnRhaW5lckhlaWdodCB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlM2QoJHt4fXB4LCAke3l9cHgsIDBweClgKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RvcCcsICc1MCUnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ2xlZnQnLCAnNTAlJyk7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2Jhci5wb3NpdGlvbiA9IHsgeCwgeSB9O1xyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIG1heERpYWxvZygpIHtcclxuICAgICAgICB0aGlzLnByZXZXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG4gICAgICAgIHRoaXMucHJldkhlaWdodCA9IHRoaXMuY29uZmlnLmhlaWdodDtcclxuICAgICAgICAvLyB0aGlzLmNvbmZpZy53aWR0aCA9IChkb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50P2RvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KVsnY2xpZW50V2lkdGgnXSAtIDIwO1xyXG4gICAgICAgIC8vIHRoaXMuY29uZmlnLmhlaWdodCA9IChkb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50P2RvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KVsnY2xpZW50SGVpZ2h0J10gLSAyMDtcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWcud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCAtIDIwO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIDIwO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy5kcmFnZ2FibGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbmZpZy5yZXNpemFibGUgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3MoZGlhbG9nRWwsICdtb2RlbC1kaWFsb2ctbWF4aW1pemUnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RvcCcsICc1MCUnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ2xlZnQnLCAnNTAlJyk7XHJcbiAgICAgICAgdGhpcy5pc01heCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy50b0NlbnRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgICAgIGlmICh3aWR0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3MoZGlhbG9nRWwsICdtb2RlbC1kaWFsb2ctbWF4aW1pemUnKTtcclxuICAgICAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2Jhci5yZXNldFBvc2l0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZHJvcGRvd24oZWw6IGFueSkge1xyXG4gICAgICAgIC8vIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJ21hcmdpbi10b3AnKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJ21hcmdpbi1sZWZ0Jyk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZWwsICd0b3AnLCBgJHtyZWN0LnRvcH1weGApO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGVsLCAnbGVmdCcsIGAke3JlY3QubGVmdH1weGApO1xyXG5cclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJ3RyYW5zZm9ybScpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnLXdlYmtpdC10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJy1tcy10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJy1tb3otdHJhbnNmb3JtJyk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIucmVtb3ZlU3R5bGUoZWwsICctby10cmFuc2Zvcm0nKTtcclxuICAgIH1cclxuXHJcbiAgICByZXZlcnREaWFsb2coKSB7XHJcbiAgICAgICAgdGhpcy5pc01heCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBjb25zdCB3dyA9IHdpbmRvdy5pbm5lcldpZHRoIC0gMjA7XHJcbiAgICAgICAgY29uc3Qgd2ggPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMFxyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IHRoaXMucHJldldpZHRoID09IHd3ID8gdGhpcy5vcmlnaW5hbFdpZHRoIDogdGhpcy5wcmV2V2lkdGg7XHJcbiAgICAgICAgdGhpcy5jb25maWcuaGVpZ2h0ID0gdGhpcy5wcmV2SGVpZ2h0ID09IHdoID8gdGhpcy5vcmlnaW5hbEhlaWdodCA6IHRoaXMucHJldkhlaWdodDtcclxuICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy53aWR0aCA+IHd3KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gd3c7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jb25maWcuaGVpZ2h0ID4gd2gpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcuaGVpZ2h0ID0gd2g7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5jb25maWcuZHJhZ2dhYmxlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmNvbmZpZy5yZXNpemFibGUgPSB0cnVlO1xyXG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgICAgIHRoaXMudG9DZW50ZXIoKTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2VEaWFsb2dTaXplKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzTWF4KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmV2ZXJ0RGlhbG9nKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzaXplU3RvcChvcHRzOiBhbnkpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygncmVzaXplU3RvcCcpO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gb3B0cy5zaXplLndpZHRoO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IG9wdHMuc2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgY29uc3QgeyB3aWR0aDogY29udGFpbmVyV2lkdGgsIGhlaWdodDogY29udGFpbmVySGVpZ2h0IH0gPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5yZXNpemVkLmVtaXQoeyAuLi5vcHRzLnNpemUsIC4uLnsgY29udGFpbmVyV2lkdGgsIGNvbnRhaW5lckhlaWdodCB9IH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==