import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { Repository } from '../repository/index';
import { ExpressionUtil } from '../utils/expression_util';
import { ENTITY_TEMPLATE } from './types';
var EntityDependencyResolver = /** @class */ (function () {
    function EntityDependencyResolver(repository) {
        this.repository = repository;
        this.entityTypeInfo = this.repository && this.repository.entityTypeInfo || null;
    }
    /**
     * 解析用户表达式中的实体依赖
     * @param expr 用户配置的完整表达式
     * @returns
     */
    EntityDependencyResolver.prototype.resolve = function (expr) {
        var groupFunctionDependencies = ExpressionUtil.getGroupFunctionDependency(expr, this.repository.entityTypeInfo);
        var entityDependencies = this.getEntityDependency(expr);
        // 去除错误的到子表的依赖
        if (groupFunctionDependencies && groupFunctionDependencies.length > 0 && entityDependencies && entityDependencies.length > 0) {
            groupFunctionDependencies.forEach(function (dep) {
                var index = entityDependencies.findIndex(function (item) { return dep.startsWith(item); });
                if (index !== -1) {
                    entityDependencies.splice(index, 1);
                }
            });
        }
        // 去重
        var merged = tslib_1.__spread(groupFunctionDependencies, entityDependencies);
        var deps = tslib_1.__spread(new Set(merged));
        return deps;
    };
    /**
     * 获取合法的实体属性表达式
     * @param entityPropertyExpression 实体属性表达式
     * @returns
     */
    EntityDependencyResolver.prototype.getValidEntityPropertyExpression = function (entityPropertyExpression) {
        var propPaths = entityPropertyExpression.split('.');
        var propInfo = null;
        try {
            propInfo = this.entityTypeInfo.getPropInfoByPath(propPaths);
        }
        catch (e) { }
        if (!propInfo) {
            if (propPaths.length > 1) {
                propPaths.pop();
                return this.getValidEntityPropertyExpression(propPaths.join('.'));
            }
            else {
                return null;
            }
        }
        else {
            return entityPropertyExpression.split('.');
        }
    };
    /**
     * 获取所有实体依赖
     * @param expr 表达式字符串
     * @returns
     */
    EntityDependencyResolver.prototype.getEntityDependency = function (expr) {
        var _this = this;
        var deps = [];
        if (this.entityTypeInfo) {
            // 使用正则匹配出所有实体
            var regex = new RegExp("[\\'\\\"]?\\s*(" + this.entityTypeInfo.entityInfo.nodeCode + "|" + this.entityTypeInfo.entityInfo.originalCode + ")[\\.\\[\\]a-zA-Z0-9_]+\\s*[\\'\\\"]?", 'g');
            var entityPropertyExpressions = expr.match(regex);
            if (Array.isArray(entityPropertyExpressions) && entityPropertyExpressions.length > 0) {
                // 解析出所有实体相关的字符串，以主实体名字开头，包含主实体属性或子表
                entityPropertyExpressions.forEach(function (item) {
                    if (item.indexOf('.') === -1) {
                        return;
                    }
                    // 去空格
                    item = item.trim().replace(/\"/g, '');
                    var paths = ExpressionUtil.convertToNodeCode(item, _this.repository.entityTypeInfo);
                    item = paths.join('.');
                    // 截去主实体及点
                    item = item.substr(item.indexOf('.') + 1);
                    var dep = _this.getValidEntityPropertyExpression(item);
                    if (dep && Array.isArray(dep) && dep.length > 0) {
                        // 此处必须加上主实体的名字来区分依赖的是实体还是其他类型的数据
                        dep.splice(0, 0, ENTITY_TEMPLATE);
                        deps.push(dep.join('/'));
                    }
                });
            }
        }
        else {
        }
        return deps;
    };
    EntityDependencyResolver.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    EntityDependencyResolver.ctorParameters = function () { return [
        { type: Repository }
    ]; };
    return EntityDependencyResolver;
}());
export { EntityDependencyResolver };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW50aXR5X2RlcGVuZGVuY3lfcmVzb2x2ZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2RldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9yZXNvbHZlci9lbnRpdHlfZGVwZW5kZW5jeV9yZXNvbHZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUzQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzFELE9BQU8sRUFBRSxlQUFlLEVBQThCLE1BQU0sU0FBUyxDQUFDO0FBRXRFO0lBR0Usa0NBQW9CLFVBQTJCO1FBQTNCLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQzdDLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUM7SUFDbEYsQ0FBQztJQUNEOzs7O09BSUc7SUFDSSwwQ0FBTyxHQUFkLFVBQWUsSUFBWTtRQUN6QixJQUFNLHlCQUF5QixHQUFHLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNsSCxJQUFNLGtCQUFrQixHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxRCxjQUFjO1FBQ2QsSUFBSSx5QkFBeUIsSUFBSSx5QkFBeUIsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLGtCQUFrQixJQUFJLGtCQUFrQixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDNUgseUJBQXlCLENBQUMsT0FBTyxDQUFDLFVBQUMsR0FBVztnQkFDNUMsSUFBTSxLQUFLLEdBQUcsa0JBQWtCLENBQUMsU0FBUyxDQUFDLFVBQUEsSUFBSSxJQUFJLE9BQUEsR0FBRyxDQUFDLFVBQVUs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QUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO3dCQUMvQyxpQ0FBaUM7d0JBQ2pDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQzt3QkFDbEMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7cUJBQzFCO2dCQUNILENBQUMsQ0FBQyxDQUFDO2FBQ0o7U0FDRjthQUFNO1NBQ047UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7O2dCQXBGRixVQUFVOzs7O2dCQUpGLFVBQVU7O0lBMEZuQiwrQkFBQztDQUFBLEFBdEZELElBc0ZDO1NBckZZLHdCQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRGF0YVR5cGVJbmZvIH0gZnJvbSAnLi4vY29yZS9pbmRleCc7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3J5L2luZGV4JztcclxuaW1wb3J0IHsgRXhwcmVzc2lvblV0aWwgfSBmcm9tICcuLi91dGlscy9leHByZXNzaW9uX3V0aWwnO1xyXG5pbXBvcnQgeyBFTlRJVFlfVEVNUExBVEUsIEdST1VQX0ZVTkNUSU9OUywgSVJlc29sdmVyIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBFbnRpdHlEZXBlbmRlbmN5UmVzb2x2ZXIgaW1wbGVtZW50cyBJUmVzb2x2ZXIge1xyXG4gIHByaXZhdGUgZW50aXR5VHlwZUluZm86IERhdGFUeXBlSW5mbztcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8YW55Pikge1xyXG4gICAgdGhpcy5lbnRpdHlUeXBlSW5mbyA9IHRoaXMucmVwb3NpdG9yeSAmJiB0aGlzLnJlcG9zaXRvcnkuZW50aXR5VHlwZUluZm8gfHwgbnVsbDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6Kej5p6Q55So5oi36KGo6L6+5byP5Lit55qE5a6e5L2T5L6d6LWWXHJcbiAgICogQHBhcmFtIGV4cHIg55So5oi36YWN572u55qE5a6M5pW06KGo6L6+5byPXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIHJlc29sdmUoZXhwcjogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgZ3JvdXBGdW5jdGlvbkRlcGVuZGVuY2llcyA9IEV4cHJlc3Npb25VdGlsLmdldEdyb3VwRnVuY3Rpb25EZXBlbmRlbmN5KGV4cHIsIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlUeXBlSW5mbyk7XHJcbiAgICBjb25zdCBlbnRpdHlEZXBlbmRlbmNpZXMgPSB0aGlzLmdldEVudGl0eURlcGVuZGVuY3koZXhwcik7XHJcbiAgICAvLyDljrvpmaTplJnor6/nmoTliLDlrZDooajnmoTkvp3otZZcclxuICAgIGlmIChncm91cEZ1bmN0aW9uRGVwZW5kZW5jaWVzICYmIGdyb3VwRnVuY3Rpb25EZXBlbmRlbmNpZXMubGVuZ3RoID4gMCAmJiBlbnRpdHlEZXBlbmRlbmNpZXMgJiYgZW50aXR5RGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZ3JvdXBGdW5jdGlvbkRlcGVuZGVuY2llcy5mb3JFYWNoKChkZXA6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZW50aXR5RGVwZW5kZW5jaWVzLmZpbmRJbmRleChpdGVtID0+IGRlcC5zdGFydHNXaXRoKGl0ZW0pKTtcclxuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICBlbnRpdHlEZXBlbmRlbmNpZXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy8g5Y676YeNXHJcbiAgICBjb25zdCBtZXJnZWQgPSBbLi4uZ3JvdXBGdW5jdGlvbkRlcGVuZGVuY2llcywgLi4uZW50aXR5RGVwZW5kZW5jaWVzXTtcclxuICAgIGNvbnN0IGRlcHMgPSBbLi4ubmV3IFNldChtZXJnZWQpXTtcclxuICAgIHJldHVybiBkZXBzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5blkIjms5XnmoTlrp7kvZPlsZ7mgKfooajovr7lvI9cclxuICAgKiBAcGFyYW0gZW50aXR5UHJvcGVydHlFeHByZXNzaW9uIOWunuS9k+WxnuaAp+ihqOi+vuW8j1xyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0VmFsaWRFbnRpdHlQcm9wZXJ0eUV4cHJlc3Npb24oZW50aXR5UHJvcGVydHlFeHByZXNzaW9uOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBwcm9wUGF0aHMgPSBlbnRpdHlQcm9wZXJ0eUV4cHJlc3Npb24uc3BsaXQoJy4nKTtcclxuICAgIGxldCBwcm9wSW5mbyA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICBwcm9wSW5mbyA9IHRoaXMuZW50aXR5VHlwZUluZm8uZ2V0UHJvcEluZm9CeVBhdGgocHJvcFBhdGhzKTtcclxuICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgaWYgKCFwcm9wSW5mbykge1xyXG4gICAgICBpZiAocHJvcFBhdGhzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICBwcm9wUGF0aHMucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmFsaWRFbnRpdHlQcm9wZXJ0eUV4cHJlc3Npb24ocHJvcFBhdGhzLmpvaW4oJy4nKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBlbnRpdHlQcm9wZXJ0eUV4cHJlc3Npb24uc3BsaXQoJy4nKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5omA5pyJ5a6e5L2T5L6d6LWWXHJcbiAgICogQHBhcmFtIGV4cHIg6KGo6L6+5byP5a2X56ym5LiyXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRFbnRpdHlEZXBlbmRlbmN5KGV4cHI6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IGRlcHMgPSBbXTtcclxuICAgIGlmICh0aGlzLmVudGl0eVR5cGVJbmZvKSB7XHJcbiAgICAgIC8vIOS9v+eUqOato+WImeWMuemFjeWHuuaJgOacieWunuS9k1xyXG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFtcXFxcJ1xcXFxcIl0/XFxcXHMqKCR7dGhpcy5lbnRpdHlUeXBlSW5mby5lbnRpdHlJbmZvLm5vZGVDb2RlfXwke3RoaXMuZW50aXR5VHlwZUluZm8uZW50aXR5SW5mby5vcmlnaW5hbENvZGV9KVtcXFxcLlxcXFxbXFxcXF1hLXpBLVowLTlfXStcXFxccypbXFxcXCdcXFxcXCJdP2AsICdnJyk7XHJcbiAgICAgIGNvbnN0IGVudGl0eVByb3BlcnR5RXhwcmVzc2lvbnM6IFJlZ0V4cE1hdGNoQXJyYXkgPSBleHByLm1hdGNoKHJlZ2V4KTtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW50aXR5UHJvcGVydHlFeHByZXNzaW9ucykgJiYgZW50aXR5UHJvcGVydHlFeHByZXNzaW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8g6Kej5p6Q5Ye65omA5pyJ5a6e5L2T55u45YWz55qE5a2X56ym5Liy77yM5Lul5Li75a6e5L2T5ZCN5a2X5byA5aS077yM5YyF5ZCr5Li75a6e5L2T5bGe5oCn5oiW5a2Q6KGoXHJcbiAgICAgICAgZW50aXR5UHJvcGVydHlFeHByZXNzaW9ucy5mb3JFYWNoKChpdGVtOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgIGlmIChpdGVtLmluZGV4T2YoJy4nKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8g5Y6756m65qC8XHJcbiAgICAgICAgICBpdGVtID0gaXRlbS50cmltKCkucmVwbGFjZSgvXFxcIi9nLCAnJyk7XHJcbiAgICAgICAgICBjb25zdCBwYXRocyA9IEV4cHJlc3Npb25VdGlsLmNvbnZlcnRUb05vZGVDb2RlKGl0ZW0sIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlUeXBlSW5mbyk7XHJcbiAgICAgICAgICBpdGVtID0gcGF0aHMuam9pbignLicpO1xyXG4gICAgICAgICAgLy8g5oiq5Y675Li75a6e5L2T5Y+K54K5XHJcbiAgICAgICAgICBpdGVtID0gaXRlbS5zdWJzdHIoaXRlbS5pbmRleE9mKCcuJykgKyAxKTtcclxuICAgICAgICAgIGNvbnN0IGRlcCA9IHRoaXMuZ2V0VmFsaWRFbnRpdHlQcm9wZXJ0eUV4cHJlc3Npb24oaXRlbSk7XHJcbiAgICAgICAgICBpZiAoZGVwICYmIEFycmF5LmlzQXJyYXkoZGVwKSAmJiBkZXAubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyDmraTlpITlv4XpobvliqDkuIrkuLvlrp7kvZPnmoTlkI3lrZfmnaXljLrliIbkvp3otZbnmoTmmK/lrp7kvZPov5jmmK/lhbbku5bnsbvlnovnmoTmlbDmja5cclxuICAgICAgICAgICAgZGVwLnNwbGljZSgwLCAwLCBFTlRJVFlfVEVNUExBVEUpO1xyXG4gICAgICAgICAgICBkZXBzLnB1c2goZGVwLmpvaW4oJy8nKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVwcztcclxuICB9XHJcblxyXG59Il19