// tslint:disable: max-line-length member-ordering
/**
 * 绑定数据相关定义
 * @author Witt<jiwt@inspur.com>
 * @todo
 * 1、全局的BindingData和局部的BindingData应该拆成两个类，两个类之间是装饰关系；；
 * 2、为了保持兼容，减少改动量，暂时放在一起，待进一步重构。
 */
import { ChangeType } from './changes';
import { BindingList } from './binding_list';
import { BindingListFactory } from './binding_list_factory';
import { PropertyUtil } from './property_util';
import { EntityUtil } from './entity_util';
/**
 * BindingData
 */
class BindingData {
    constructor() {
        this.paginationInfo = null;
    }
    /**
     * 绑定该路径
     */
    get bindingPath() {
        if (this.viewModelContext && this.viewModelContext.viewModel.bindingPath) {
            return this.viewModelContext.viewModel.bindingPath;
        }
        return '/';
    }
    set pagingInfo(pagingInfo) {
        this.paginationInfo = pagingInfo;
        this.firePagingChangeEvent();
    }
    get pagingInfo() {
        return this.paginationInfo;
    }
    /**
     * 设置分页信息
     * @param skip 跳过
     * @param take 获取
     * @param bindingPath 路径
     */
    setPagingInfo(skip, take, bindingPath) {
        if (bindingPath.length < 1 || bindingPath === '/') {
            this.paginationInfo = Object.assign(this.paginationInfo, { pageSize: take, pageIndex: skip / take + 1 });
        }
        else {
            let pagingInfo = this.paginationInfo || {};
            const bindingPaths = bindingPath.substr(1).split('/').filter(item => !!item && item.length > 0).map(item => item.substring(0, item.length - 1));
            bindingPaths.forEach(path => {
                if (!pagingInfo.hasOwnProperty(path)) {
                    pagingInfo[path] = {};
                }
                pagingInfo = pagingInfo[path];
            });
            pagingInfo.pageIndex = ((skip / take) || 0) + 1;
            pagingInfo.pageSize = take || 0;
        }
        this.firePagingChangeEvent();
    }
    firePagingChangeEvent() {
        this.list.changes.next({
            type: ChangeType.PaginationInfoChange,
            path: [],
            value: this.paginationInfo
        });
    }
    /**
     * 变更集
     */
    get changes() {
        return this.list.changes;
    }
    /**
     * 设置值变化执行器工厂
     * @param value 值变化执行器工厂
     */
    setValueChangeInvokerFactory(value) {
        this.valueChangeInvokerFactory = value;
    }
    /**
     * 初始化（已废弃）
     */
    init(repository, bindingPath) {
        this.initByRepository(repository, null);
    }
    /**
     * 根据Repository对BindingData进行初始化
     */
    initByRepository(repository, viewModelContext) {
        this.viewModelContext = viewModelContext;
        this.properties = PropertyUtil.getProperties(repository.entityType);
        this.list = BindingListFactory.create(this.properties);
        // 从repository初始化bindingData
        this.pagingInfo = repository.entityCollection.paginationInfo;
        // @todo
        // BindingData不应该知道Repository，加载数据、建立关联关系的过程应该转移到外边
        EntityUtil.loadRepository(repository, this.list);
        this.dataTypeInfo = repository.entityTypeInfo;
        this.extendProperties(this.properties);
    }
    /**
     * 初始化
     */
    initByBindingList(bindingList, viewModelContext) {
        this.list = bindingList;
        this.viewModelContext = viewModelContext;
        this.extendProperties(this.list.properties);
    }
    /**
     * 获取paths对应的属性值
     * @param  paths 属性路径数组
     * @returns 属性值
     */
    getValue(paths) {
        let target = this.list;
        paths.forEach((path) => {
            if (target) {
                target = target[path];
            }
        });
        return target;
    }
    /**
     * 根据paths设置属性值
     * @param paths 属性路径数组
     * @param value 属性值
     * @param emitEventToView 如果设置为true，则发送事件通知订阅它的组件、指令去更新界面，默认为false。
     * @param emitEventToEntity 如果设置为true，则同步去更新Entity上对应的字段，默认为true。
     */
    setValue(paths, value, emitEventToView = false, emitEventToEntity = true) {
        if (!paths || paths.length === 0) {
            throw Error('路径不能为空');
        }
        const parentPaths = paths.slice(0, paths.length - 1);
        const propName = paths[paths.length - 1];
        let parent = this.getValue(parentPaths);
        if (!parent) {
            throw Error('找不到要设置的对象');
        }
        if (parent instanceof BindingData) {
            parent = parent.list.currentItem;
        }
        else if (parent instanceof BindingList) {
            parent = parent.currentItem;
        }
        if (!!this.valueChangeInvokerFactory) {
            parent.setValue(propName, value, emitEventToView, emitEventToEntity, null, this.valueChangeInvokerFactory(paths));
        }
        else {
            parent.setValue(propName, value, emitEventToView, emitEventToEntity);
        }
    }
    /**
     * 根据paths清空属性值
     */
    clearValue(paths, emitEventToView = false, emitEventToEntity = true) {
        let initValue;
        const propInfo = this.dataTypeInfo.getPropInfoByPath(paths);
        if (propInfo && propInfo.metadataInfo && propInfo.metadataInfo.initValue !== undefined) {
            initValue = propInfo.metadataInfo.initValue;
        }
        else {
            // 原来的帮助映射中，强行纠正了数值的情况，保持一致
            const oldValue = this.getValue(paths);
            if (typeof oldValue === 'number') {
                initValue = 0;
            }
            else {
                initValue = '';
            }
        }
        this.setValue(paths, initValue, emitEventToView, emitEventToEntity);
    }
    /**
     * 获取当前列表
     */
    getList() {
        if (!this.bindingPath || this.bindingPath === '/') {
            return this.list;
        }
        const bindingPath = this.bindingPath.substr(1);
        const bindingPathArray = bindingPath.split('/').filter((part) => {
            return part !== '';
        });
        return this.getValue(bindingPathArray);
    }
    /**
     * 获取当前对象
     */
    getObject() {
        const bindingList = this.getList();
        return bindingList.currentItem;
    }
    /**
     * 扩展BindingData属性，映射BindingData所持有的绑定列表当前行的属性，减少绑定层级。
     * @param properties 关联实体的属性集合
     */
    extendProperties(properties) {
        properties.forEach((property) => {
            const propName = property.name;
            Object.defineProperty(this, propName, {
                get: () => {
                    return this.list.currentItem[propName];
                },
                set: (value) => {
                    this.list.currentItem[propName] = value;
                }
            });
        });
    }
}
export { BindingData };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZ19kYXRhLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2JpbmRpbmctZGF0YS9iaW5kaW5nX2RhdGEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsa0RBQWtEO0FBQ2xEOzs7Ozs7R0FNRztBQU9ILE9BQU8sRUFBVSxVQUFVLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFL0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSTNDOztHQUVHO0FBRUgsTUFBTSxXQUFXO0lBQWpCO1FBNEJVLG1CQUFjLEdBQUcsSUFBSSxDQUFDO0lBMk1oQyxDQUFDO0lBOU5DOztPQUVHO0lBQ0gsSUFBVyxXQUFXO1FBQ3BCLElBQUksSUFBSSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFO1lBQ3hFLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUM7U0FDcEQ7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7SUFhRCxJQUFXLFVBQVUsQ0FBQyxVQUFlO1FBQ25DLElBQUksQ0FBQyxjQUFjLEdBQUcsVUFBVSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRCxJQUFXLFVBQVU7UUFDbkIsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzdCLENBQUM7SUFDRDs7Ozs7T0FLRztJQUNJLGFBQWEsQ0FBQyxJQUFZLEVBQUUsSUFBWSxFQUFFLFdBQW1CO1FBQ2xFLElBQUksV0FBVyxDQUFDLE1BQU0sR0FB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QyxRQUFRLENBQUMsR0FBRyxLQUFLLENBQUM7Z0JBQzFDLENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQUVELE9BQU8sRUFBRSxXQUFXLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRzbGludDpkaXNhYmxlOiBtYXgtbGluZS1sZW5ndGggbWVtYmVyLW9yZGVyaW5nXHJcbi8qKlxyXG4gKiDnu5HlrprmlbDmja7nm7jlhbPlrprkuYlcclxuICogQGF1dGhvciBXaXR0PGppd3RAaW5zcHVyLmNvbT5cclxuICogQHRvZG9cclxuICogMeOAgeWFqOWxgOeahEJpbmRpbmdEYXRh5ZKM5bGA6YOo55qEQmluZGluZ0RhdGHlupTor6Xmi4bmiJDkuKTkuKrnsbvvvIzkuKTkuKrnsbvkuYvpl7TmmK/oo4XppbDlhbPns7vvvJvvvJtcclxuICogMuOAgeS4uuS6huS/neaMgeWFvOWuue+8jOWHj+WwkeaUueWKqOmHj++8jOaaguaXtuaUvuWcqOS4gOi1t++8jOW+hei/m+S4gOatpemHjeaehOOAglxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7IERhdGFUeXBlSW5mbyB9IGZyb20gJy4uL2VudGl0eS9lbnRpdHktdHlwZS1pbmZvL2luZGV4JztcclxuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcnkvaW5kZXgnO1xyXG5pbXBvcnQgeyBWaWV3TW9kZWxDb250ZXh0IH0gZnJvbSAnLi4vdmlldy1tb2RlbC9pbmRleCc7XHJcbmltcG9ydCB7IENoYW5nZSwgQ2hhbmdlVHlwZSB9IGZyb20gJy4vY2hhbmdlcyc7XHJcbmltcG9ydCB7IEJpbmRpbmdQcm9wZXJ0eSB9IGZyb20gJy4vYmluZGluZ19wcm9wZXJ0eSc7XHJcbmltcG9ydCB7IEJpbmRpbmdMaXN0IH0gZnJvbSAnLi9iaW5kaW5nX2xpc3QnO1xyXG5pbXBvcnQgeyBCaW5kaW5nTGlzdEZhY3RvcnkgfSBmcm9tICcuL2JpbmRpbmdfbGlzdF9mYWN0b3J5JztcclxuaW1wb3J0IHsgUHJvcGVydHlVdGlsIH0gZnJvbSAnLi9wcm9wZXJ0eV91dGlsJztcclxuaW1wb3J0IHsgRW50aXR5VXRpbCB9IGZyb20gJy4vZW50aXR5X3V0aWwnO1xyXG5pbXBvcnQgeyBJbnZva2VPblZhbHVlQ2hhbmdlIH0gZnJvbSAnLi9iaW5kaW5nX29iamVjdCc7XHJcbmltcG9ydCB7IG51bGxTYWZlSXNFcXVpdmFsZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tcGlsZXIvc3JjL291dHB1dC9vdXRwdXRfYXN0JztcclxuXHJcbi8qKlxyXG4gKiBCaW5kaW5nRGF0YVxyXG4gKi9cclxuXHJcbmNsYXNzIEJpbmRpbmdEYXRhIHtcclxuXHJcbiAgcHJpdmF0ZSB2aWV3TW9kZWxDb250ZXh0OiBWaWV3TW9kZWxDb250ZXh0O1xyXG5cclxuICAvKipcclxuICAgKiDmlbDmja7nsbvlnovmj4/ov7BcclxuICAgKi9cclxuICBwcml2YXRlIGRhdGFUeXBlSW5mbzogRGF0YVR5cGVJbmZvO1xyXG5cclxuICAvKipcclxuICAgKiDnu5Hlrpror6Xot6/lvoRcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IGJpbmRpbmdQYXRoKCk6IHN0cmluZyB7XHJcbiAgICBpZiAodGhpcy52aWV3TW9kZWxDb250ZXh0ICYmIHRoaXMudmlld01vZGVsQ29udGV4dC52aWV3TW9kZWwuYmluZGluZ1BhdGgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMudmlld01vZGVsQ29udGV4dC52aWV3TW9kZWwuYmluZGluZ1BhdGg7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJy8nO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Y+v57uR5a6a55qE5bGe5oCn5o+P6L+wXHJcbiAgICovXHJcbiAgcHVibGljIHByb3BlcnRpZXM6IEJpbmRpbmdQcm9wZXJ0eVtdO1xyXG5cclxuICAvKipcclxuICAgKiDmlbDmja7liJfooahcclxuICAgKi9cclxuICBwdWJsaWMgbGlzdDogQmluZGluZ0xpc3Q7XHJcbiAgcHJpdmF0ZSBwYWdpbmF0aW9uSW5mbyA9IG51bGw7XHJcblxyXG4gIHB1YmxpYyBzZXQgcGFnaW5nSW5mbyhwYWdpbmdJbmZvOiBhbnkpIHtcclxuICAgIHRoaXMucGFnaW5hdGlvbkluZm8gPSBwYWdpbmdJbmZvO1xyXG4gICAgdGhpcy5maXJlUGFnaW5nQ2hhbmdlRXZlbnQoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgcGFnaW5nSW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLnBhZ2luYXRpb25JbmZvO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDorr7nva7liIbpobXkv6Hmga9cclxuICAgKiBAcGFyYW0gc2tpcCDot7Pov4dcclxuICAgKiBAcGFyYW0gdGFrZSDojrflj5ZcclxuICAgKiBAcGFyYW0gYmluZGluZ1BhdGgg6Lev5b6EXHJcbiAgICovXHJcbiAgcHVibGljIHNldFBhZ2luZ0luZm8oc2tpcDogbnVtYmVyLCB0YWtlOiBudW1iZXIsIGJpbmRpbmdQYXRoOiBzdHJpbmcpIHtcclxuICAgIGlmIChiaW5kaW5nUGF0aC5sZW5ndGggPCAxIHx8IGJpbmRpbmdQYXRoID09PSAnLycpIHtcclxuICAgICAgdGhpcy5wYWdpbmF0aW9uSW5mbyA9IE9iamVjdC5hc3NpZ24odGhpcy5wYWdpbmF0aW9uSW5mbywgeyBwYWdlU2l6ZTogdGFrZSwgcGFnZUluZGV4OiBza2lwIC8gdGFrZSArIDEgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgcGFnaW5nSW5mbyA9IHRoaXMucGFnaW5hdGlvbkluZm8gfHwge307XHJcbiAgICAgIGNvbnN0IGJpbmRpbmdQYXRocyA9IGJpbmRpbmdQYXRoLnN1YnN0cigxKS5zcGxpdCgnLycpLmZpbHRlcihpdGVtID0+ICEhaXRlbSAmJiBpdGVtLmxlbmd0aCA+IDApLm1hcChpdGVtID0+IGl0ZW0uc3Vic3RyaW5nKDAsIGl0ZW0ubGVuZ3RoIC0gMSkpO1xyXG4gICAgICBiaW5kaW5nUGF0aHMuZm9yRWFjaChwYXRoID0+IHtcclxuICAgICAgICBpZiAoIXBhZ2luZ0luZm8uaGFzT3duUHJvcGVydHkocGF0aCkpIHtcclxuICAgICAgICAgIHBhZ2luZ0luZm9bcGF0aF0gPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFnaW5nSW5mbyA9IHBhZ2luZ0luZm9bcGF0aF07XHJcbiAgICAgIH0pO1xyXG4gICAgICBwYWdpbmdJbmZvLnBhZ2VJbmRleCA9ICgoc2tpcCAvIHRha2UpIHx8IDApICsgMTtcclxuICAgICAgcGFnaW5nSW5mby5wYWdlU2l6ZSA9IHRha2UgfHwgMDtcclxuICAgIH1cclxuICAgIHRoaXMuZmlyZVBhZ2luZ0NoYW5nZUV2ZW50KCk7XHJcbiAgfVxyXG4gIHByaXZhdGUgZmlyZVBhZ2luZ0NoYW5nZUV2ZW50KCkge1xyXG4gICAgdGhpcy5saXN0LmNoYW5nZXMubmV4dCh7XHJcbiAgICAgIHR5cGU6IENoYW5nZVR5cGUuUGFnaW5hdGlvbkluZm9DaGFuZ2UsXHJcbiAgICAgIHBhdGg6IFtdLFxyXG4gICAgICB2YWx1ZTogdGhpcy5wYWdpbmF0aW9uSW5mb1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOWPmOabtOmbhlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgY2hhbmdlcygpOiBTdWJqZWN0PENoYW5nZT4ge1xyXG4gICAgcmV0dXJuIHRoaXMubGlzdC5jaGFuZ2VzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5YC85Y+Y5YyW5omn6KGM5Zmo5bel5Y6C77yM5qC55o2u6Lev5b6E5Lqn55Sf5omn6KGM5ZmoXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB2YWx1ZUNoYW5nZUludm9rZXJGYWN0b3J5OiAocGF0aHM6IHN0cmluZ1tdKSA9PiBJbnZva2VPblZhbHVlQ2hhbmdlO1xyXG5cclxuICAvKipcclxuICAgKiDorr7nva7lgLzlj5jljJbmiafooYzlmajlt6XljoJcclxuICAgKiBAcGFyYW0gdmFsdWUg5YC85Y+Y5YyW5omn6KGM5Zmo5bel5Y6CXHJcbiAgICovXHJcbiAgcHVibGljIHNldFZhbHVlQ2hhbmdlSW52b2tlckZhY3RvcnkodmFsdWU6IChwYXRoczogc3RyaW5nW10pID0+IEludm9rZU9uVmFsdWVDaGFuZ2UpIHtcclxuICAgIHRoaXMudmFsdWVDaGFuZ2VJbnZva2VyRmFjdG9yeSA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yid5aeL5YyW77yI5bey5bqf5byD77yJXHJcbiAgICovXHJcbiAgcHVibGljIGluaXQocmVwb3NpdG9yeTogUmVwb3NpdG9yeTxhbnk+LCBiaW5kaW5nUGF0aDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmluaXRCeVJlcG9zaXRvcnkocmVwb3NpdG9yeSwgbnVsbCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja5SZXBvc2l0b3J55a+5QmluZGluZ0RhdGHov5vooYzliJ3lp4vljJZcclxuICAgKi9cclxuICBwdWJsaWMgaW5pdEJ5UmVwb3NpdG9yeShyZXBvc2l0b3J5OiBSZXBvc2l0b3J5PGFueT4sIHZpZXdNb2RlbENvbnRleHQ6IFZpZXdNb2RlbENvbnRleHQpIHtcclxuICAgIHRoaXMudmlld01vZGVsQ29udGV4dCA9IHZpZXdNb2RlbENvbnRleHQ7XHJcblxyXG4gICAgdGhpcy5wcm9wZXJ0aWVzID0gUHJvcGVydHlVdGlsLmdldFByb3BlcnRpZXMocmVwb3NpdG9yeS5lbnRpdHlUeXBlKTtcclxuICAgIHRoaXMubGlzdCA9IEJpbmRpbmdMaXN0RmFjdG9yeS5jcmVhdGUodGhpcy5wcm9wZXJ0aWVzKTtcclxuICAgIC8vIOS7jnJlcG9zaXRvcnnliJ3lp4vljJZiaW5kaW5nRGF0YVxyXG4gICAgdGhpcy5wYWdpbmdJbmZvID0gcmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLnBhZ2luYXRpb25JbmZvO1xyXG5cclxuICAgIC8vIEB0b2RvXHJcbiAgICAvLyBCaW5kaW5nRGF0YeS4jeW6lOivpeefpemBk1JlcG9zaXRvcnnvvIzliqDovb3mlbDmja7jgIHlu7rnq4vlhbPogZTlhbPns7vnmoTov4fnqIvlupTor6Xovaznp7vliLDlpJbovrlcclxuICAgIEVudGl0eVV0aWwubG9hZFJlcG9zaXRvcnkocmVwb3NpdG9yeSwgdGhpcy5saXN0KTtcclxuICAgIHRoaXMuZGF0YVR5cGVJbmZvID0gcmVwb3NpdG9yeS5lbnRpdHlUeXBlSW5mbztcclxuXHJcbiAgICB0aGlzLmV4dGVuZFByb3BlcnRpZXModGhpcy5wcm9wZXJ0aWVzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIneWni+WMllxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbml0QnlCaW5kaW5nTGlzdChiaW5kaW5nTGlzdDogQmluZGluZ0xpc3QsICB2aWV3TW9kZWxDb250ZXh0OiBWaWV3TW9kZWxDb250ZXh0KSB7XHJcbiAgICB0aGlzLmxpc3QgPSBiaW5kaW5nTGlzdDtcclxuICAgIHRoaXMudmlld01vZGVsQ29udGV4dCA9IHZpZXdNb2RlbENvbnRleHQ7XHJcbiAgICB0aGlzLmV4dGVuZFByb3BlcnRpZXModGhpcy5saXN0LnByb3BlcnRpZXMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+WcGF0aHPlr7nlupTnmoTlsZ7mgKflgLxcclxuICAgKiBAcGFyYW0gIHBhdGhzIOWxnuaAp+i3r+W+hOaVsOe7hFxyXG4gICAqIEByZXR1cm5zIOWxnuaAp+WAvFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRWYWx1ZShwYXRoczogc3RyaW5nW10pIHtcclxuICAgIGxldCB0YXJnZXQ6IGFueSA9IHRoaXMubGlzdDtcclxuICAgIHBhdGhzLmZvckVhY2goKHBhdGg6IHN0cmluZykgPT4ge1xyXG4gICAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0W3BhdGhdO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja5wYXRoc+iuvue9ruWxnuaAp+WAvFxyXG4gICAqIEBwYXJhbSBwYXRocyDlsZ7mgKfot6/lvoTmlbDnu4RcclxuICAgKiBAcGFyYW0gdmFsdWUg5bGe5oCn5YC8XHJcbiAgICogQHBhcmFtIGVtaXRFdmVudFRvVmlldyDlpoLmnpzorr7nva7kuLp0cnVl77yM5YiZ5Y+R6YCB5LqL5Lu26YCa55+l6K6i6ZiF5a6D55qE57uE5Lu244CB5oyH5Luk5Y675pu05paw55WM6Z2i77yM6buY6K6k5Li6ZmFsc2XjgIJcclxuICAgKiBAcGFyYW0gZW1pdEV2ZW50VG9FbnRpdHkg5aaC5p6c6K6+572u5Li6dHJ1Ze+8jOWImeWQjOatpeWOu+abtOaWsEVudGl0eeS4iuWvueW6lOeahOWtl+aute+8jOm7mOiupOS4unRydWXjgIJcclxuICAgKi9cclxuICBwdWJsaWMgc2V0VmFsdWUocGF0aHM6IHN0cmluZ1tdLCB2YWx1ZTogYW55LCBlbWl0RXZlbnRUb1ZpZXc6IGJvb2xlYW4gPSBmYWxzZSwgZW1pdEV2ZW50VG9FbnRpdHk6IGJvb2xlYW4gPSB0cnVlKSB7XHJcblxyXG4gICAgaWYgKCFwYXRocyB8fCBwYXRocy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhyb3cgRXJyb3IoJ+i3r+W+hOS4jeiDveS4uuepuicpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcGFyZW50UGF0aHMgPSBwYXRocy5zbGljZSgwLCBwYXRocy5sZW5ndGggLSAxKTtcclxuICAgIGNvbnN0IHByb3BOYW1lID0gcGF0aHNbcGF0aHMubGVuZ3RoIC0gMV07XHJcblxyXG4gICAgbGV0IHBhcmVudCA9IHRoaXMuZ2V0VmFsdWUocGFyZW50UGF0aHMpO1xyXG4gICAgaWYgKCFwYXJlbnQpIHtcclxuICAgICAgdGhyb3cgRXJyb3IoJ+aJvuS4jeWIsOimgeiuvue9rueahOWvueixoScpO1xyXG4gICAgfVxyXG4gICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIEJpbmRpbmdEYXRhKSB7XHJcbiAgICAgIHBhcmVudCA9IHBhcmVudC5saXN0LmN1cnJlbnRJdGVtO1xyXG4gICAgfSBlbHNlIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBCaW5kaW5nTGlzdCkge1xyXG4gICAgICBwYXJlbnQgPSBwYXJlbnQuY3VycmVudEl0ZW07XHJcbiAgICB9XHJcbiAgICBpZiAoISF0aGlzLnZhbHVlQ2hhbmdlSW52b2tlckZhY3RvcnkpIHtcclxuICAgICAgcGFyZW50LnNldFZhbHVlKHByb3BOYW1lLCB2YWx1ZSwgZW1pdEV2ZW50VG9WaWV3LCBlbWl0RXZlbnRUb0VudGl0eSwgbnVsbCwgdGhpcy52YWx1ZUNoYW5nZUludm9rZXJGYWN0b3J5KHBhdGhzKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwYXJlbnQuc2V0VmFsdWUocHJvcE5hbWUsIHZhbHVlLCBlbWl0RXZlbnRUb1ZpZXcsIGVtaXRFdmVudFRvRW50aXR5KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOagueaNrnBhdGhz5riF56m65bGe5oCn5YC8XHJcbiAgICovXHJcbiAgcHVibGljIGNsZWFyVmFsdWUocGF0aHM6IHN0cmluZ1tdLCBlbWl0RXZlbnRUb1ZpZXc6IGJvb2xlYW4gPSBmYWxzZSwgZW1pdEV2ZW50VG9FbnRpdHk6IGJvb2xlYW4gPSB0cnVlKSB7XHJcbiAgICBsZXQgaW5pdFZhbHVlOiBhbnk7XHJcbiAgICBjb25zdCBwcm9wSW5mbyA9IHRoaXMuZGF0YVR5cGVJbmZvLmdldFByb3BJbmZvQnlQYXRoKHBhdGhzKTtcclxuICAgIGlmIChwcm9wSW5mbyAmJiBwcm9wSW5mby5tZXRhZGF0YUluZm8gJiYgcHJvcEluZm8ubWV0YWRhdGFJbmZvLmluaXRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGluaXRWYWx1ZSA9IHByb3BJbmZvLm1ldGFkYXRhSW5mby5pbml0VmFsdWU7XHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgLy8g5Y6f5p2l55qE5biu5Yqp5pig5bCE5Lit77yM5by66KGM57qg5q2j5LqG5pWw5YC855qE5oOF5Ya177yM5L+d5oyB5LiA6Ie0XHJcbiAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5nZXRWYWx1ZShwYXRocyk7XHJcbiAgICAgIGlmICh0eXBlb2Ygb2xkVmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaW5pdFZhbHVlID0gMDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpbml0VmFsdWUgPSAnJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRWYWx1ZShwYXRocywgaW5pdFZhbHVlLCBlbWl0RXZlbnRUb1ZpZXcsIGVtaXRFdmVudFRvRW50aXR5KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluW9k+WJjeWIl+ihqFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRMaXN0KCkge1xyXG5cclxuICAgIGlmICghdGhpcy5iaW5kaW5nUGF0aCB8fCB0aGlzLmJpbmRpbmdQYXRoID09PSAnLycpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBiaW5kaW5nUGF0aCA9IHRoaXMuYmluZGluZ1BhdGguc3Vic3RyKDEpO1xyXG4gICAgY29uc3QgYmluZGluZ1BhdGhBcnJheSA9IGJpbmRpbmdQYXRoLnNwbGl0KCcvJykuZmlsdGVyKChwYXJ0OiBzdHJpbmcpID0+IHtcclxuICAgICAgcmV0dXJuIHBhcnQgIT09ICcnO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRWYWx1ZShiaW5kaW5nUGF0aEFycmF5KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluW9k+WJjeWvueixoVxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRPYmplY3QoKSB7XHJcbiAgICBjb25zdCBiaW5kaW5nTGlzdCA9IHRoaXMuZ2V0TGlzdCgpO1xyXG4gICAgcmV0dXJuIGJpbmRpbmdMaXN0LmN1cnJlbnRJdGVtO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omp5bGVQmluZGluZ0RhdGHlsZ7mgKfvvIzmmKDlsIRCaW5kaW5nRGF0YeaJgOaMgeacieeahOe7keWumuWIl+ihqOW9k+WJjeihjOeahOWxnuaAp++8jOWHj+Wwkee7keWumuWxgue6p+OAglxyXG4gICAqIEBwYXJhbSBwcm9wZXJ0aWVzIOWFs+iBlOWunuS9k+eahOWxnuaAp+mbhuWQiFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZXh0ZW5kUHJvcGVydGllcyhwcm9wZXJ0aWVzOiBCaW5kaW5nUHJvcGVydHlbXSkge1xyXG4gICAgcHJvcGVydGllcy5mb3JFYWNoKChwcm9wZXJ0eTogQmluZGluZ1Byb3BlcnR5KSA9PiB7XHJcbiAgICAgIGNvbnN0IHByb3BOYW1lID0gcHJvcGVydHkubmFtZTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHByb3BOYW1lLCB7XHJcbiAgICAgICAgZ2V0OiAoKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5saXN0LmN1cnJlbnRJdGVtW3Byb3BOYW1lXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogKHZhbHVlOiBhbnkpID0+IHtcclxuICAgICAgICAgIHRoaXMubGlzdC5jdXJyZW50SXRlbVtwcm9wTmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBCaW5kaW5nRGF0YSB9O1xyXG4iXX0=