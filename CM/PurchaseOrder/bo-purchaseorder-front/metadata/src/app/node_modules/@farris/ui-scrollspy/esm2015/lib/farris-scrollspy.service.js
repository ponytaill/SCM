/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, NgZone } from '@angular/core';
import { fromEvent, Subject } from 'rxjs';
import { throttleTime, debounceTime } from 'rxjs/operators';
import { animationFrame } from 'rxjs/internal/scheduler/animationFrame';
import * as i0 from "@angular/core";
/**
 * @record
 */
function ScrollElement() { }
if (false) {
    /** @type {?} */
    ScrollElement.prototype.element;
    /** @type {?} */
    ScrollElement.prototype.id;
}
/**
 * @record
 */
function ScrollSpy() { }
if (false) {
    /** @type {?} */
    ScrollSpy.prototype.elements;
    /** @type {?} */
    ScrollSpy.prototype.currentSectionId;
    /** @type {?} */
    ScrollSpy.prototype.subject;
    /** @type {?|undefined} */
    ScrollSpy.prototype.clickChange;
}
/**
 * @record
 */
function ScrollSpies() { }
/**
 * @record
 */
function ScrollFollow() { }
if (false) {
    /** @type {?} */
    ScrollFollow.prototype.element;
    /** @type {?} */
    ScrollFollow.prototype.id;
}
/**
 * @record
 */
function ScrollFollowSpipes() { }
/**
 * @record
 */
function ScrollContents() { }
/**
 * @record
 */
function Offsets() { }
/**
 * @record
 */
function ScrollChange() { }
/**
 * @record
 */
function CurrentId() { }
if (false) {
    /** @type {?} */
    CurrentId.prototype.subject;
    /** @type {?} */
    CurrentId.prototype.idValue;
}
/**
 * @record
 */
function CurrentIdObj() { }
export class FarrisScrollSpyService {
    /**
     * @param {?} ngzone
     */
    constructor(ngzone) {
        this.ngzone = ngzone;
        // 监听区块当前时候的样式
        this.scrollSpyPartActiveClsName = 'f-scrollspy-part-active';
        this.fixedTabContainerClsName = 'f-scrollspy-container-fixed';
        this.parentFixedTabContainerClsName = 'f-scrollspy-container-fixed-parent';
        /**
         * 被监听滚动的contents
         */
        this.scrollContents = {};
        /**
         * 被监听滚动的sections
         */
        this.scrollSpies = {};
        /**
         * 监听滚动的锚点部分
         */
        this.scrollFollowSpipes = {};
        this.scrollSpyListFollowTypeChanges = {};
        /**
         * 滚动监听偏移距离
         */
        this.offsets = {};
        /**
         * 默认监听分组名称
         */
        this.defaultId = 'default';
        // currentSectionId: Subject<any> = new Subject();
        this.currentSectionIdObj = {};
        this.scrollChange = {};
    }
    //获取currentid
    /**
     * @param {?} groupId
     * @return {?}
     */
    getCurrentSectionId(groupId) {
        if (!groupId) {
            groupId = this.defaultId;
        }
        return this.currentSectionIdObj[groupId].subject;
        // return this.currentSectionId;
    }
    //滚动变化时改变currentid
    /**
     * @param {?} groupId
     * @param {?} value
     * @return {?}
     */
    setCurrentSectionId(groupId, value) {
        if (!groupId) {
            groupId = this.defaultId;
        }
        this.currentSectionIdObj[groupId].subject.next(value);
        //console.log(this.currentSectionIdObj);
        // this.currentSectionId.next(value);
    }
    //设置不同group组的currentid
    /**
     * @param {?} groupId
     * @param {?} value
     * @return {?}
     */
    setCurrentSectionIdObj(groupId, value) {
        if (!groupId) {
            groupId = this.defaultId;
        }
        if (!this.currentSectionIdObj[groupId]) {
            this.currentSectionIdObj[groupId] = (/** @type {?} */ ({
                subject: new Subject(),
                idValue: value
            }));
        }
        else {
            this.currentSectionIdObj[groupId].idValue = value;
        }
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.scrollFollowSpipes[groupId] && this.scrollFollowSpipes[groupId].length) {
                /** @type {?} */
                let item = this.scrollFollowSpipes[groupId].find((/**
                 * @param {?} scrollFollowItem
                 * @return {?}
                 */
                scrollFollowItem => {
                    return scrollFollowItem['id'] == this.currentSectionIdObj[groupId].idValue;
                }));
                if (item) {
                    this.fScrollFollowClick(groupId, item);
                }
            }
        }), 0);
        // this.fScrollFollowClick(key,follow);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.scrollSubscription.unsubscribe();
    }
    /**
     * Observer部分 供指令初始化调用
     * @param {?=} scrollSpyId
     * @return {?}
     */
    // public getCurrentSection$(scrollSpyId: string = this.defaultId): Observable<string> {
    //   if(scrollSpyId !== ''){
    //     return this.scrollChange[scrollSpyId];
    //   }
    //   else{
    //     return this.scrollChange[this.defaultId];
    //   }
    // }
    updateScrollGroup(scrollSpyId = this.defaultId) {
        /** @type {?} */
        const groupId = scrollSpyId !== '' ? scrollSpyId : this.defaultId;
        if (!this.scrollChange[groupId]) {
            this.scrollChange[groupId] = new Subject();
        }
        return this.scrollChange[groupId];
    }
    /**
     * content部分滚动事件监听
     * @private
     * @param {?} key
     * @return {?}
     */
    subscribeScroll(key) {
        this.ngzone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.scrollSubscription = fromEvent(this.scrollContents[key], 'scroll')
                .pipe(debounceTime(20, animationFrame))
                .subscribe((/**
             * @return {?}
             */
            () => {
                if (this.scrollSpies[key]) {
                    const { currentSectionId, elements, subject } = this.scrollSpies[key];
                    /** @type {?} */
                    const scrollTop = this.scrollContents[key].scrollTop;
                    /** @type {?} */
                    const topElementInView = elements.filter((/**
                     * @param {?} el
                     * @return {?}
                     */
                    (el) => {
                        return el.element.offsetTop <= scrollTop + this.offsets[key];
                    }));
                    if (!topElementInView || !topElementInView.length) {
                        return;
                    }
                    //排序按照设置Spy的顺序，假定顺序是一致的 {id}
                    /** @type {?} */
                    let qlSpyItem = this.scrollFollowSpipes[key].find((/**
                     * @param {?} spyItem
                     * @return {?}
                     */
                    spyItem => {
                        /** @type {?} */
                        let eqElItem = topElementInView.find((/**
                         * @param {?} elItem
                         * @return {?}
                         */
                        elItem => {
                            return elItem.id == spyItem.id;
                        }));
                        return eqElItem ? true : false;
                    }));
                    //console.log(topElementInView);
                    /** @type {?} */
                    const topElementId = qlSpyItem ? qlSpyItem.id : topElementInView[0].id;
                    //判断 点击是否是点击引起的滚动
                    if (this.scrollSpies[key].clickChange) {
                        this.scrollSpies[key].clickChange = false;
                        return;
                    }
                    else {
                        this.scrollSpies[key].clickChange = false;
                        if (topElementId !== currentSectionId) {
                            this.scrollSpies[key].currentSectionId = topElementId;
                            this.ngzone.run((/**
                             * @return {?}
                             */
                            () => {
                                subject.next(topElementId);
                            }));
                        }
                    }
                }
            }));
        }));
    }
    /**
     * tab部分点击事件监听
     * @private
     * @param {?} key
     * @return {?}
     */
    subscribeClick(key) {
        //Object.keys(this.scrollFollowSpipes).forEach((key:string):void=>{
        if (this.scrollFollowSpipes[key] && this.scrollFollowSpipes[key].length) {
            this.scrollFollowSpipes[key].forEach((/**
             * @param {?} follow
             * @return {?}
             */
            (follow) => {
                fromEvent(follow.element, 'click')
                    .pipe(throttleTime(100))
                    .subscribe((/**
                 * @param {?} event
                 * @return {?}
                 */
                (event) => {
                    event.stopPropagation();
                    this.fScrollFollowClick(key, follow);
                    // if(this.scrollSpies[key]){
                    //   const { currentSectionId, elements, subject } = this.scrollSpies[key];
                    //   this.scrollSpies[key].clickChange = true;
                    //   if(follow.id !== currentSectionId){
                    //     const topElementInView = elements.find(el => el.id === follow.id);
                    //     if(!topElementInView) { return; }
                    //     this.scrollSpies[key].currentSectionId = follow.id;
                    //     //this.scrollContents[key].offsetTop
                    //     this.scrollContents[key].scrollTop = Math.round(topElementInView.element.offsetTop - this.offsets[key]);
                    //     subject.next(follow.id);
                    //   }
                    // }
                }));
            }));
        }
        //});
    }
    /**
     * @param {?} key
     * @param {?} follow
     * @return {?}
     */
    fScrollFollowClick(key, follow) {
        if (this.scrollSpies[key]) {
            const { currentSectionId, elements, subject } = this.scrollSpies[key];
            this.scrollSpies[key].clickChange = true;
            if (follow.id !== currentSectionId) {
                /** @type {?} */
                const topElementInView = elements.find((/**
                 * @param {?} el
                 * @return {?}
                 */
                el => el.id === follow.id));
                if (!topElementInView) {
                    return;
                }
                this.scrollSpies[key].currentSectionId = follow.id;
                //this.scrollContents[key].offsetTop
                if (this.scrollContents[key]) {
                    // 内容去有滚动
                    this.scrollContents[key].scrollTop = Math.round(topElementInView.element.offsetTop - this.offsets[key] - parseInt(getComputedStyle(this.scrollContents[key]).paddingTop, 10));
                }
                subject.next(follow.id);
            }
        }
    }
    /**
     * 添加需要被滚动监听部分
     * @param {?} element
     * @param {?=} contentId
     * @return {?}
     */
    addContentElement(element, contentId = this.defaultId) {
        if (contentId !== '') {
            this.scrollContents[contentId] = element;
            this.subscribeScroll(contentId);
        }
        else {
            this.scrollContents[this.defaultId] = element;
            this.subscribeScroll(this.defaultId);
        }
        // 判断是有待改变的状态
        this.updateContainerClsName(contentId);
    }
    /**
     * 移除需要被滚动监听部分元素
     * @param {?=} contentId
     * @return {?}
     */
    removeContentElement(contentId = this.defaultId) {
        /** @type {?} */
        const removeId = contentId !== '' ? contentId : this.defaultId;
        delete this.scrollSpies[removeId];
    }
    /**
     * 添加滚动监听tab部分元素
     * @param {?} element
     * @param {?} followId
     * @param {?=} followContentId
     * @return {?}
     */
    addFollowElement(element, followId, followContentId = this.defaultId) {
        /** @type {?} */
        const groupId = followContentId !== '' ? followContentId : this.defaultId;
        /** @type {?} */
        const follow = {
            element: element,
            id: followId
        };
        if (!this.scrollFollowSpipes[groupId]) {
            this.scrollFollowSpipes[groupId] = [];
        }
        //-------------------------此处没有处理重复ID
        /** @type {?} */
        const follows = this.scrollFollowSpipes[groupId];
        follows.push(follow);
        this.scrollFollowSpipes[groupId] = follows;
        this.subscribeClick(groupId);
    }
    /**
     * 移除滚动监听tab部分元素
     * @param {?} followId
     * @param {?=} followContentId
     * @return {?}
     */
    removeFollowElement(followId, followContentId = this.defaultId) {
        /** @type {?} */
        const elements = this.scrollFollowSpipes[followContentId].filter((/**
         * @param {?} el
         * @return {?}
         */
        el => {
            return el.id !== followId;
        }));
        if (!elements.length) {
            delete this.scrollFollowSpipes[followContentId];
            return;
        }
        this.scrollFollowSpipes[followContentId] = elements;
    }
    /**
     * 添加滚动监听锚点部分元素
     * @param {?} element
     * @param {?} scrollId
     * @param {?=} scrollGroupId
     * @return {?}
     */
    addElement(element, scrollId, scrollGroupId = this.defaultId) {
        if (!this.scrollSpies[scrollGroupId]) {
            this.scrollSpies[scrollGroupId] = (/** @type {?} */ ({
                elements: [],
                currentSectionId: '',
                subject: new Subject(),
            }));
            this.scrollSpies[scrollGroupId].subject
                .subscribe((/**
             * @param {?} currentSection
             * @return {?}
             */
            (currentSection) => {
                if (this.scrollChange[scrollGroupId]) {
                    this.scrollChange[scrollGroupId].next(currentSection);
                }
            }));
        }
        if (this.hasElement(scrollId, scrollGroupId)) {
            return;
        }
        /** @type {?} */
        const el = {
            element: element,
            id: scrollId
        }
        // 加入时，判断是否是当前
        ;
        // 加入时，判断是否是当前
        this.updateScrollSpyActiveClsName(scrollGroupId, el);
        /** @type {?} */
        const elements = this.scrollSpies[scrollGroupId].elements;
        elements.push(el);
        elements.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => b.element.getBoundingClientRect().top - a.element.getBoundingClientRect().top));
        this.scrollSpies[scrollGroupId].elements = elements;
    }
    /**
     * 移除滚动监听锚点部分元素
     * @param {?} scrollId
     * @param {?=} scrollGroupId
     * @return {?}
     */
    removeElement(scrollId, scrollGroupId = this.defaultId) {
        /** @type {?} */
        const elements = this.scrollSpies[scrollGroupId].elements.filter((/**
         * @param {?} el
         * @return {?}
         */
        (el) => {
            return el.id !== scrollId;
        }));
        if (!elements.length) {
            delete this.scrollSpies[scrollGroupId];
            return;
        }
        this.scrollSpies[scrollGroupId].elements = elements;
    }
    /**
     * 判断scrollGroupId 是否有id名为elementId 的元素
     * @private
     * @param {?} elementId
     * @param {?} scrollGroupId
     * @return {?}
     */
    hasElement(elementId, scrollGroupId) {
        return this.scrollSpies[scrollGroupId].elements.some((/**
         * @param {?} element
         * @return {?}
         */
        (element) => element.id === elementId));
    }
    /**
     * 设置offset
     * @param {?=} offset
     * @param {?=} contentId
     * @return {?}
     */
    setOffset(offset = 0, contentId = this.defaultId) {
        if (contentId !== '') {
            this.offsets[contentId] = offset;
        }
        else {
            this.offsets[this.defaultId] = offset;
        }
    }
    /*ScrollSpy组件(锚点列表区域）初始化预设defaultId */
    /**
     * @param {?} groupid
     * @return {?}
     */
    setGroupId(groupid) {
        if (groupid) {
            this.defaultId = groupid;
        }
    }
    /**
     * @return {?}
     */
    getGroupId() {
        return this.defaultId;
    }
    /*改变 ScrollSpy组件（锚点列表区域）的显示状态时 */
    /**
     * @param {?} groupid
     * @param {?} followTypeData
     * @return {?}
     */
    changeGroupIdFollowType(groupid, followTypeData) {
        this.scrollSpyListFollowTypeChanges[groupid] = followTypeData;
        this.updateContainerClsName(groupid);
    }
    /**
     * @private
     * @param {?} groupid
     * @return {?}
     */
    updateContainerClsName(groupid) {
        // 没有待更新变化
        if (!this.scrollSpyListFollowTypeChanges.hasOwnProperty(groupid)) {
            return;
        }
        // container并不存在的时候
        if (!this.scrollContents.hasOwnProperty(groupid)) {
            return;
        }
        /** @type {?} */
        let followTypeData = this.scrollSpyListFollowTypeChanges[groupid];
        /** @type {?} */
        let containerEl = this.scrollContents[groupid];
        // Container的Element 
        if (followTypeData['prev'] == 'fixedTab') {
            //移除class
            containerEl.className = containerEl.className.replace(this.fixedTabContainerClsName, '');
            containerEl.parentElement.classList.remove(this.parentFixedTabContainerClsName);
        }
        else if (followTypeData['next'] == 'fixedTab') {
            // 增加class
            containerEl.className += ' ' + this.fixedTabContainerClsName;
            // 给父元素增加高度
            containerEl.parentElement.classList.add(this.parentFixedTabContainerClsName);
        }
        this.scrollSpyListFollowTypeChanges[groupid] = null;
    }
    /**
     * @param {?} groupId
     * @param {?} currentId
     * @return {?}
     */
    updateScrollSpiesActiveClsName(groupId, currentId) {
        // 追加、移除class
        this.scrollSpies[groupId].elements.map((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            if (item.id == currentId) {
                // 找到当前
                if (item.element.className.indexOf(this.scrollSpyPartActiveClsName) < 0) {
                    item.element.className += ' ' + this.scrollSpyPartActiveClsName;
                }
            }
            else {
                // 其他
                item.element.className = item.element.className.replace(this.scrollSpyPartActiveClsName, '');
            }
        }));
    }
    /**
     * 当追加ScrollSpy块的时候，判断是否是已经设置的当前
     * @private
     * @param {?} groupId
     * @param {?} scrollEl
     * @return {?}
     */
    updateScrollSpyActiveClsName(groupId, scrollEl) {
        // 如果已设置
        if (this.currentSectionIdObj[groupId]) {
            if (this.currentSectionIdObj[groupId]['idValue'] == scrollEl.id) {
                scrollEl.element.className += ' ' + this.scrollSpyPartActiveClsName;
            }
        }
    }
}
FarrisScrollSpyService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
FarrisScrollSpyService.ctorParameters = () => [
    { type: NgZone }
];
/** @nocollapse */ FarrisScrollSpyService.ngInjectableDef = i0.defineInjectable({ factory: function FarrisScrollSpyService_Factory() { return new FarrisScrollSpyService(i0.inject(i0.NgZone)); }, token: FarrisScrollSpyService, providedIn: "root" });
if (false) {
    /**
     * @type {?}
     * @private
     */
    FarrisScrollSpyService.prototype.scrollSpyPartActiveClsName;
    /**
     * @type {?}
     * @private
     */
    FarrisScrollSpyService.prototype.fixedTabContainerClsName;
    /**
     * @type {?}
     * @private
     */
    FarrisScrollSpyService.prototype.parentFixedTabContainerClsName;
    /**
     * @type {?}
     * @private
     */
    FarrisScrollSpyService.prototype.scrollSubscription;
    /**
     * 被监听滚动的contents
     * @type {?}
     */
    FarrisScrollSpyService.prototype.scrollContents;
    /**
     * 被监听滚动的sections
     * @type {?}
     */
    FarrisScrollSpyService.prototype.scrollSpies;
    /**
     * 监听滚动的锚点部分
     * @type {?}
     */
    FarrisScrollSpyService.prototype.scrollFollowSpipes;
    /**
     * @type {?}
     * @private
     */
    FarrisScrollSpyService.prototype.scrollSpyListFollowTypeChanges;
    /**
     * 滚动监听偏移距离
     * @type {?}
     */
    FarrisScrollSpyService.prototype.offsets;
    /**
     * 默认监听分组名称
     * @type {?}
     */
    FarrisScrollSpyService.prototype.defaultId;
    /** @type {?} */
    FarrisScrollSpyService.prototype.currentSectionIdObj;
    /** @type {?} */
    FarrisScrollSpyService.prototype.scrollChange;
    /** @type {?} */
    FarrisScrollSpyService.prototype.ngzone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLXNjcm9sbHNweS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1zY3JvbGxzcHkvIiwic291cmNlcyI6WyJsaWIvZmFycmlzLXNjcm9sbHNweS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFhLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM5RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBNEIsTUFBTSxNQUFNLENBQUM7QUFDcEUsT0FBTyxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM1RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sd0NBQXdDLENBQUM7Ozs7O0FBRXhFLDRCQUdDOzs7SUFGQyxnQ0FBcUI7O0lBQ3JCLDJCQUFVOzs7OztBQUdaLHdCQUtDOzs7SUFKQyw2QkFBMEI7O0lBQzFCLHFDQUF5Qjs7SUFDekIsNEJBQXlCOztJQUN6QixnQ0FBcUI7Ozs7O0FBR3ZCLDBCQUVDOzs7O0FBRUQsMkJBR0M7OztJQUZDLCtCQUFxQjs7SUFDckIsMEJBQVU7Ozs7O0FBRVosaUNBRUM7Ozs7QUFFRCw2QkFFQzs7OztBQUNELHNCQUVDOzs7O0FBRUQsMkJBRUM7Ozs7QUFFRCx3QkFHQzs7O0lBRkMsNEJBQXlCOztJQUN6Qiw0QkFBZTs7Ozs7QUFFakIsMkJBRUM7QUFLRCxNQUFNLE9BQU8sc0JBQXNCOzs7O0lBdUVqQyxZQUFtQixNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTs7UUFyRXpCLCtCQUEwQixHQUFHLHlCQUF5QixDQUFDO1FBQ3ZELDZCQUF3QixHQUFHLDZCQUE2QixDQUFDO1FBQ3pELG1DQUE4QixHQUFDLG9DQUFvQyxDQUFDOzs7O1FBRzVFLG1CQUFjLEdBQW1CLEVBQUUsQ0FBQzs7OztRQUVwQyxnQkFBVyxHQUFnQixFQUFFLENBQUM7Ozs7UUFFOUIsdUJBQWtCLEdBQXVCLEVBQUUsQ0FB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R0FBRyxHQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQzthQUNqRTtTQUNGO0lBQ0gsQ0FBQzs7O1lBMVdGLFVBQVUsU0FBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQjs7OztZQWxEK0IsTUFBTTs7Ozs7Ozs7SUFxRHBDLDREQUErRDs7Ozs7SUFDL0QsMERBQWlFOzs7OztJQUNqRSxnRUFBNEU7Ozs7O0lBQzVFLG9EQUF5Qzs7Ozs7SUFFekMsZ0RBQW9DOzs7OztJQUVwQyw2Q0FBOEI7Ozs7O0lBRTlCLG9EQUE0Qzs7Ozs7SUFDNUMsZ0VBQTRDOzs7OztJQUk1Qyx5Q0FBc0I7Ozs7O0lBRXRCLDJDQUE4Qjs7SUFJOUIscURBQXVDOztJQThDdkMsOENBQWdDOztJQUdwQix3Q0FBcUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBPbkRlc3Ryb3ksIE5nWm9uZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBmcm9tRXZlbnQsIFN1YmplY3QsIE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyB0aHJvdHRsZVRpbWUsIGRlYm91bmNlVGltZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgYW5pbWF0aW9uRnJhbWUgfSBmcm9tICdyeGpzL2ludGVybmFsL3NjaGVkdWxlci9hbmltYXRpb25GcmFtZSc7XHJcblxyXG5pbnRlcmZhY2UgU2Nyb2xsRWxlbWVudCB7XHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQsXHJcbiAgaWQ6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU2Nyb2xsU3B5IHtcclxuICBlbGVtZW50czogU2Nyb2xsRWxlbWVudFtdO1xyXG4gIGN1cnJlbnRTZWN0aW9uSWQ6IHN0cmluZztcclxuICBzdWJqZWN0OiBTdWJqZWN0PHN0cmluZz47XHJcbiAgY2xpY2tDaGFuZ2U/OiBib29sZWFuIC8v5Yik5pat5piv5ZCm5piv54K55Ye75a+86Ie055qE6aG16Z2i5rua5YqoXHJcbn1cclxuXHJcbmludGVyZmFjZSBTY3JvbGxTcGllcyB7XHJcbiAgW3Njcm9sbFNweUlkOiBzdHJpbmddOiBTY3JvbGxTcHlcclxufVxyXG5cclxuaW50ZXJmYWNlIFNjcm9sbEZvbGxvdyB7XHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQsXHJcbiAgaWQ6IHN0cmluZ1xyXG59XHJcbmludGVyZmFjZSBTY3JvbGxGb2xsb3dTcGlwZXMge1xyXG4gIFtzY3JvbGxGb2xsb3dJZDogc3RyaW5nXTogU2Nyb2xsRm9sbG93W11cclxufVxyXG5cclxuaW50ZXJmYWNlIFNjcm9sbENvbnRlbnRzIHtcclxuICBbc2Nyb2xsRm9sbG93SWQ6IHN0cmluZ106IEhUTUxFbGVtZW50XHJcbn1cclxuaW50ZXJmYWNlIE9mZnNldHMge1xyXG4gIFtzY3JvbGxGb2xsb3dJZDogc3RyaW5nXTogbnVtYmVyXHJcbn1cclxuXHJcbmludGVyZmFjZSBTY3JvbGxDaGFuZ2Uge1xyXG4gIFtzY3JvbGxGb2xsb3dJZDogc3RyaW5nXTogU3ViamVjdDxhbnk+XHJcbn1cclxuXHJcbmludGVyZmFjZSBDdXJyZW50SWQge1xyXG4gIHN1YmplY3Q6IFN1YmplY3Q8c3RyaW5nPjtcclxuICBpZFZhbHVlOiBzdHJpbmdcclxufVxyXG5pbnRlcmZhY2UgQ3VycmVudElkT2JqIHtcclxuICBbZ3JvdXBJZDogc3RyaW5nXTogQ3VycmVudElkXHJcbn1cclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc1Njcm9sbFNweVNlcnZpY2UgaW1wbGVtZW50cyBPbkRlc3Ryb3kge1xyXG4gIC8vIOebkeWQrOWMuuWdl+W9k+WJjeaXtuWAmeeahOagt+W8j1xyXG4gIHByaXZhdGUgc2Nyb2xsU3B5UGFydEFjdGl2ZUNsc05hbWUgPSAnZi1zY3JvbGxzcHktcGFydC1hY3RpdmUnO1xyXG4gIHByaXZhdGUgZml4ZWRUYWJDb250YWluZXJDbHNOYW1lID0gJ2Ytc2Nyb2xsc3B5LWNvbnRhaW5lci1maXhlZCc7XHJcbiAgcHJpdmF0ZSBwYXJlbnRGaXhlZFRhYkNvbnRhaW5lckNsc05hbWU9J2Ytc2Nyb2xsc3B5LWNvbnRhaW5lci1maXhlZC1wYXJlbnQnO1xyXG4gIHByaXZhdGUgc2Nyb2xsU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcbiAgLyoq6KKr55uR5ZCs5rua5Yqo55qEY29udGVudHMgKi9cclxuICBzY3JvbGxDb250ZW50czogU2Nyb2xsQ29udGVudHMgPSB7fTtcclxuICAvKirooqvnm5HlkKzmu5rliqjnmoRzZWN0aW9ucyovXHJcbiAgc2Nyb2xsU3BpZXM6IFNjcm9sbFNwaWVzID0ge307XHJcbiAgLyoq55uR5ZCs5rua5Yqo55qE6ZSa54K56YOo5YiGICovXHJcbiAgc2Nyb2xsRm9sbG93U3BpcGVzOiBTY3JvbGxGb2xsb3dTcGlwZXMgPSB7fTtcclxuICBwcml2YXRlIHNjcm9sbFNweUxpc3RGb2xsb3dUeXBlQ2hhbmdlcyA9IHt9O1xyXG5cclxuXHJcbiAgLyoq5rua5Yqo55uR5ZCs5YGP56e76Led56a7ICovXHJcbiAgb2Zmc2V0czogT2Zmc2V0cyA9IHt9O1xyXG4gIC8qKum7mOiupOebkeWQrOWIhue7hOWQjeensCAqL1xyXG4gIGRlZmF1bHRJZDogc3RyaW5nID0gJ2RlZmF1bHQnO1xyXG5cclxuICAvLyBjdXJyZW50U2VjdGlvbklkOiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdCgpO1xyXG5cclxuICBjdXJyZW50U2VjdGlvbklkT2JqOiBDdXJyZW50SWRPYmogPSB7fTtcclxuICAvL+iOt+WPlmN1cnJlbnRpZFxyXG4gIGdldEN1cnJlbnRTZWN0aW9uSWQoZ3JvdXBJZDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIWdyb3VwSWQpIHtcclxuICAgICAgZ3JvdXBJZCA9IHRoaXMuZGVmYXVsdElkO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFNlY3Rpb25JZE9ialtncm91cElkXS5zdWJqZWN0O1xyXG4gICAgLy8gcmV0dXJuIHRoaXMuY3VycmVudFNlY3Rpb25JZDtcclxuICB9XHJcbiAgLy/mu5rliqjlj5jljJbml7bmlLnlj5hjdXJyZW50aWRcclxuICBzZXRDdXJyZW50U2VjdGlvbklkKGdyb3VwSWQ6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKCFncm91cElkKSB7XHJcbiAgICAgIGdyb3VwSWQgPSB0aGlzLmRlZmF1bHRJZDtcclxuICAgIH1cclxuICAgIHRoaXMuY3VycmVudFNlY3Rpb25JZE9ialtncm91cElkXS5zdWJqZWN0Lm5leHQodmFsdWUpO1xyXG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLmN1cnJlbnRTZWN0aW9uSWRPYmopO1xyXG4gICAgLy8gdGhpcy5jdXJyZW50U2VjdGlvbklkLm5leHQodmFsdWUpO1xyXG4gIH1cclxuICAvL+iuvue9ruS4jeWQjGdyb3Vw57uE55qEY3VycmVudGlkXHJcbiAgc2V0Q3VycmVudFNlY3Rpb25JZE9iaihncm91cElkOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIGlmICghZ3JvdXBJZCkge1xyXG4gICAgICBncm91cElkID0gdGhpcy5kZWZhdWx0SWQ7XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuY3VycmVudFNlY3Rpb25JZE9ialtncm91cElkXSkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSWRPYmpbZ3JvdXBJZF0gPSB7XHJcbiAgICAgICAgc3ViamVjdDogbmV3IFN1YmplY3QoKSxcclxuICAgICAgICBpZFZhbHVlOiB2YWx1ZVxyXG4gICAgICB9IGFzIEN1cnJlbnRJZDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSWRPYmpbZ3JvdXBJZF0uaWRWYWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGlmKHRoaXMuc2Nyb2xsRm9sbG93U3BpcGVzW2dyb3VwSWRdICYmIHRoaXMuc2Nyb2xsRm9sbG93U3BpcGVzW2dyb3VwSWRdLmxlbmd0aCl7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tncm91cElkXS5maW5kKHNjcm9sbEZvbGxvd0l0ZW09PntcclxuICAgICAgICAgIHJldHVybiBzY3JvbGxGb2xsb3dJdGVtWydpZCddID09IHRoaXMuY3VycmVudFNlY3Rpb25JZE9ialtncm91cElkXS5pZFZhbHVlO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgaWYoaXRlbSl7XHJcbiAgICAgICAgICB0aGlzLmZTY3JvbGxGb2xsb3dDbGljayhncm91cElkLGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgMCk7XHJcbiAgICAvLyB0aGlzLmZTY3JvbGxGb2xsb3dDbGljayhrZXksZm9sbG93KTtcclxuICB9XHJcblxyXG5cclxuICBzY3JvbGxDaGFuZ2U6IFNjcm9sbENoYW5nZSA9IHt9O1xyXG5cclxuXHJcbiAgY29uc3RydWN0b3IocHVibGljIG5nem9uZTogTmdab25lKSB7IH1cclxuXHJcbiAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5zY3JvbGxTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICB9XHJcblxyXG4gIC8qKk9ic2VydmVy6YOo5YiGIOS+m+aMh+S7pOWIneWni+WMluiwg+eUqCAqL1xyXG4gIC8vIHB1YmxpYyBnZXRDdXJyZW50U2VjdGlvbiQoc2Nyb2xsU3B5SWQ6IHN0cmluZyA9IHRoaXMuZGVmYXVsdElkKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcclxuICAvLyAgIGlmKHNjcm9sbFNweUlkICE9PSAnJyl7XHJcbiAgLy8gICAgIHJldHVybiB0aGlzLnNjcm9sbENoYW5nZVtzY3JvbGxTcHlJZF07XHJcbiAgLy8gICB9XHJcbiAgLy8gICBlbHNle1xyXG4gIC8vICAgICByZXR1cm4gdGhpcy5zY3JvbGxDaGFuZ2VbdGhpcy5kZWZhdWx0SWRdO1xyXG4gIC8vICAgfVxyXG4gIC8vIH1cclxuXHJcbiAgcHVibGljIHVwZGF0ZVNjcm9sbEdyb3VwKHNjcm9sbFNweUlkOiBzdHJpbmcgPSB0aGlzLmRlZmF1bHRJZCkge1xyXG4gICAgY29uc3QgZ3JvdXBJZCA9IHNjcm9sbFNweUlkICE9PSAnJyA/IHNjcm9sbFNweUlkIDogdGhpcy5kZWZhdWx0SWQ7XHJcbiAgICBpZiAoIXRoaXMuc2Nyb2xsQ2hhbmdlW2dyb3VwSWRdKSB7XHJcbiAgICAgIHRoaXMuc2Nyb2xsQ2hhbmdlW2dyb3VwSWRdID0gbmV3IFN1YmplY3QoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLnNjcm9sbENoYW5nZVtncm91cElkXTtcclxuICB9XHJcbiAgLyoqY29udGVudOmDqOWIhua7muWKqOS6i+S7tuebkeWQrCAqL1xyXG4gIHByaXZhdGUgc3Vic2NyaWJlU2Nyb2xsKGtleTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLm5nem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgIHRoaXMuc2Nyb2xsU3Vic2NyaXB0aW9uID0gZnJvbUV2ZW50KHRoaXMuc2Nyb2xsQ29udGVudHNba2V5XSwgJ3Njcm9sbCcpXHJcbiAgICAgICAgLnBpcGUoZGVib3VuY2VUaW1lKDIwLCBhbmltYXRpb25GcmFtZSkpXHJcbiAgICAgICAgLnN1YnNjcmliZSgoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zY3JvbGxTcGllc1trZXldKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgY3VycmVudFNlY3Rpb25JZCwgZWxlbWVudHMsIHN1YmplY3QgfSA9IHRoaXMuc2Nyb2xsU3BpZXNba2V5XTtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxDb250ZW50c1trZXldLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgY29uc3QgdG9wRWxlbWVudEluVmlldyA9IGVsZW1lbnRzLmZpbHRlcigoZWwpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gZWwuZWxlbWVudC5vZmZzZXRUb3AgPD0gc2Nyb2xsVG9wICsgdGhpcy5vZmZzZXRzW2tleV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoIXRvcEVsZW1lbnRJblZpZXcgfHwgIXRvcEVsZW1lbnRJblZpZXcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5o6S5bqP5oyJ54Wn6K6+572uU3B555qE6aG65bqP77yM5YGH5a6a6aG65bqP5piv5LiA6Ie055qEIHtpZH1cclxuICAgICAgICAgICAgbGV0IHFsU3B5SXRlbT10aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1trZXldLmZpbmQoc3B5SXRlbT0+e1xyXG4gICAgICAgICAgICAgIGxldCBlcUVsSXRlbT10b3BFbGVtZW50SW5WaWV3LmZpbmQoZWxJdGVtPT57XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxJdGVtLmlkPT1zcHlJdGVtLmlkO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVxRWxJdGVtP3RydWU6ZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRvcEVsZW1lbnRJblZpZXcpO1xyXG4gICAgICAgICAgICBjb25zdCB0b3BFbGVtZW50SWQ6IHN0cmluZyA9IHFsU3B5SXRlbT9xbFNweUl0ZW0uaWQ6dG9wRWxlbWVudEluVmlld1swXS5pZDtcclxuICAgICAgICAgICAgLy/liKTmlq0g54K55Ye75piv5ZCm5piv54K55Ye75byV6LW355qE5rua5YqoXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbFNwaWVzW2tleV0uY2xpY2tDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICB0aGlzLnNjcm9sbFNwaWVzW2tleV0uY2xpY2tDaGFuZ2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5zY3JvbGxTcGllc1trZXldLmNsaWNrQ2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgaWYgKHRvcEVsZW1lbnRJZCAhPT0gY3VycmVudFNlY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxTcGllc1trZXldLmN1cnJlbnRTZWN0aW9uSWQgPSB0b3BFbGVtZW50SWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5nem9uZS5ydW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQodG9wRWxlbWVudElkKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqdGFi6YOo5YiG54K55Ye75LqL5Lu255uR5ZCsICovXHJcbiAgcHJpdmF0ZSBzdWJzY3JpYmVDbGljayhrZXkpOiB2b2lkIHtcclxuICAgIC8vT2JqZWN0LmtleXModGhpcy5zY3JvbGxGb2xsb3dTcGlwZXMpLmZvckVhY2goKGtleTpzdHJpbmcpOnZvaWQ9PntcclxuICAgIGlmICh0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1trZXldICYmIHRoaXMuc2Nyb2xsRm9sbG93U3BpcGVzW2tleV0ubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuc2Nyb2xsRm9sbG93U3BpcGVzW2tleV0uZm9yRWFjaCgoZm9sbG93KSA9PiB7XHJcbiAgICAgICAgZnJvbUV2ZW50KGZvbGxvdy5lbGVtZW50LCAnY2xpY2snKVxyXG4gICAgICAgICAgLnBpcGUodGhyb3R0bGVUaW1lKDEwMCkpXHJcbiAgICAgICAgICAuc3Vic2NyaWJlKChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5mU2Nyb2xsRm9sbG93Q2xpY2soa2V5LCBmb2xsb3cpO1xyXG4gICAgICAgICAgICAvLyBpZih0aGlzLnNjcm9sbFNwaWVzW2tleV0pe1xyXG5cclxuICAgICAgICAgICAgLy8gICBjb25zdCB7IGN1cnJlbnRTZWN0aW9uSWQsIGVsZW1lbnRzLCBzdWJqZWN0IH0gPSB0aGlzLnNjcm9sbFNwaWVzW2tleV07XHJcbiAgICAgICAgICAgIC8vICAgdGhpcy5zY3JvbGxTcGllc1trZXldLmNsaWNrQ2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gICBpZihmb2xsb3cuaWQgIT09IGN1cnJlbnRTZWN0aW9uSWQpe1xyXG4gICAgICAgICAgICAvLyAgICAgY29uc3QgdG9wRWxlbWVudEluVmlldyA9IGVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuaWQgPT09IGZvbGxvdy5pZCk7XHJcbiAgICAgICAgICAgIC8vICAgICBpZighdG9wRWxlbWVudEluVmlldykgeyByZXR1cm47IH1cclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuc2Nyb2xsU3BpZXNba2V5XS5jdXJyZW50U2VjdGlvbklkID0gZm9sbG93LmlkO1xyXG4gICAgICAgICAgICAvLyAgICAgLy90aGlzLnNjcm9sbENvbnRlbnRzW2tleV0ub2Zmc2V0VG9wXHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnNjcm9sbENvbnRlbnRzW2tleV0uc2Nyb2xsVG9wID0gTWF0aC5yb3VuZCh0b3BFbGVtZW50SW5WaWV3LmVsZW1lbnQub2Zmc2V0VG9wIC0gdGhpcy5vZmZzZXRzW2tleV0pO1xyXG4gICAgICAgICAgICAvLyAgICAgc3ViamVjdC5uZXh0KGZvbGxvdy5pZCk7XHJcbiAgICAgICAgICAgIC8vICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICAvL30pO1xyXG4gIH1cclxuXHJcbiAgZlNjcm9sbEZvbGxvd0NsaWNrKGtleSwgZm9sbG93KXtcclxuICAgIGlmKHRoaXMuc2Nyb2xsU3BpZXNba2V5XSl7XHJcbiAgICAgIGNvbnN0IHsgY3VycmVudFNlY3Rpb25JZCwgZWxlbWVudHMsIHN1YmplY3QgfSA9IHRoaXMuc2Nyb2xsU3BpZXNba2V5XTtcclxuICAgICAgdGhpcy5zY3JvbGxTcGllc1trZXldLmNsaWNrQ2hhbmdlID0gdHJ1ZTtcclxuICAgICAgaWYgKGZvbGxvdy5pZCAhPT0gY3VycmVudFNlY3Rpb25JZCkge1xyXG4gICAgICAgIGNvbnN0IHRvcEVsZW1lbnRJblZpZXcgPSBlbGVtZW50cy5maW5kKGVsID0+IGVsLmlkID09PSBmb2xsb3cuaWQpO1xyXG4gICAgICAgIGlmICghdG9wRWxlbWVudEluVmlldykgeyByZXR1cm47IH1cclxuICAgICAgICB0aGlzLnNjcm9sbFNwaWVzW2tleV0uY3VycmVudFNlY3Rpb25JZCA9IGZvbGxvdy5pZDtcclxuICAgICAgICAvL3RoaXMuc2Nyb2xsQ29udGVudHNba2V5XS5vZmZzZXRUb3BcclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxDb250ZW50c1trZXldKSB7XHJcbiAgICAgICAgICAvLyDlhoXlrrnljrvmnInmu5rliqhcclxuICAgICAgICAgIHRoaXMuc2Nyb2xsQ29udGVudHNba2V5XS5zY3JvbGxUb3AgPSBNYXRoLnJvdW5kKHRvcEVsZW1lbnRJblZpZXcuZWxlbWVudC5vZmZzZXRUb3AgLSB0aGlzLm9mZnNldHNba2V5XS0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnNjcm9sbENvbnRlbnRzW2tleV0pLnBhZGRpbmdUb3AsMTApKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3ViamVjdC5uZXh0KGZvbGxvdy5pZCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKirmt7vliqDpnIDopoHooqvmu5rliqjnm5HlkKzpg6jliIYgKi9cclxuICBwdWJsaWMgYWRkQ29udGVudEVsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQsIGNvbnRlbnRJZCA9IHRoaXMuZGVmYXVsdElkKTogdm9pZCB7XHJcbiAgICBpZiAoY29udGVudElkICE9PSAnJykge1xyXG4gICAgICB0aGlzLnNjcm9sbENvbnRlbnRzW2NvbnRlbnRJZF0gPSBlbGVtZW50O1xyXG4gICAgICB0aGlzLnN1YnNjcmliZVNjcm9sbChjb250ZW50SWQpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMuc2Nyb2xsQ29udGVudHNbdGhpcy5kZWZhdWx0SWRdID0gZWxlbWVudDtcclxuICAgICAgdGhpcy5zdWJzY3JpYmVTY3JvbGwodGhpcy5kZWZhdWx0SWQpO1xyXG4gICAgfVxyXG4gICAgLy8g5Yik5pat5piv5pyJ5b6F5pS55Y+Y55qE54q25oCBXHJcbiAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lckNsc05hbWUoY29udGVudElkKTtcclxuICB9XHJcbiAgLyoq56e76Zmk6ZyA6KaB6KKr5rua5Yqo55uR5ZCs6YOo5YiG5YWD57SgICovXHJcbiAgcHVibGljIHJlbW92ZUNvbnRlbnRFbGVtZW50KGNvbnRlbnRJZCA9IHRoaXMuZGVmYXVsdElkKTogdm9pZCB7XHJcbiAgICBjb25zdCByZW1vdmVJZCA9IGNvbnRlbnRJZCAhPT0gJycgPyBjb250ZW50SWQgOiB0aGlzLmRlZmF1bHRJZDtcclxuICAgIGRlbGV0ZSB0aGlzLnNjcm9sbFNwaWVzW3JlbW92ZUlkXTtcclxuICB9XHJcbiAgLyoq5re75Yqg5rua5Yqo55uR5ZCsdGFi6YOo5YiG5YWD57SgKi9cclxuICBwdWJsaWMgYWRkRm9sbG93RWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCwgZm9sbG93SWQsIGZvbGxvd0NvbnRlbnRJZCA9IHRoaXMuZGVmYXVsdElkKTogdm9pZCB7XHJcbiAgICBjb25zdCBncm91cElkID0gZm9sbG93Q29udGVudElkICE9PSAnJyA/IGZvbGxvd0NvbnRlbnRJZCA6IHRoaXMuZGVmYXVsdElkO1xyXG5cclxuICAgIGNvbnN0IGZvbGxvdyA9IHtcclxuICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgaWQ6IGZvbGxvd0lkXHJcbiAgICB9O1xyXG4gICAgaWYgKCF0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tncm91cElkXSkge1xyXG4gICAgICB0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tncm91cElkXSA9IFtdXHJcbiAgICB9XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS3mraTlpITmsqHmnInlpITnkIbph43lpI1JRFxyXG4gICAgY29uc3QgZm9sbG93cyA9IHRoaXMuc2Nyb2xsRm9sbG93U3BpcGVzW2dyb3VwSWRdO1xyXG4gICAgZm9sbG93cy5wdXNoKGZvbGxvdyk7XHJcbiAgICB0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tncm91cElkXSA9IGZvbGxvd3M7XHJcbiAgICB0aGlzLnN1YnNjcmliZUNsaWNrKGdyb3VwSWQpO1xyXG4gIH1cclxuICAvKirnp7vpmaTmu5rliqjnm5HlkKx0YWLpg6jliIblhYPntKAgKi9cclxuICBwdWJsaWMgcmVtb3ZlRm9sbG93RWxlbWVudChmb2xsb3dJZCwgZm9sbG93Q29udGVudElkID0gdGhpcy5kZWZhdWx0SWQpOiB2b2lkIHtcclxuICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5zY3JvbGxGb2xsb3dTcGlwZXNbZm9sbG93Q29udGVudElkXS5maWx0ZXIoZWwgPT4ge1xyXG4gICAgICByZXR1cm4gZWwuaWQgIT09IGZvbGxvd0lkO1xyXG4gICAgfSlcclxuICAgIGlmICghZWxlbWVudHMubGVuZ3RoKSB7XHJcbiAgICAgIGRlbGV0ZSB0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tmb2xsb3dDb250ZW50SWRdO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNjcm9sbEZvbGxvd1NwaXBlc1tmb2xsb3dDb250ZW50SWRdID0gZWxlbWVudHM7XHJcbiAgfVxyXG4gIC8qKua3u+WKoOa7muWKqOebkeWQrOmUmueCuemDqOWIhuWFg+e0oCAqL1xyXG4gIHB1YmxpYyBhZGRFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBzY3JvbGxJZDogc3RyaW5nLCBzY3JvbGxHcm91cElkOiBzdHJpbmcgPSB0aGlzLmRlZmF1bHRJZCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLnNjcm9sbFNwaWVzW3Njcm9sbEdyb3VwSWRdKSB7XHJcbiAgICAgIHRoaXMuc2Nyb2xsU3BpZXNbc2Nyb2xsR3JvdXBJZF0gPSB7XHJcbiAgICAgICAgZWxlbWVudHM6IFtdLFxyXG4gICAgICAgIGN1cnJlbnRTZWN0aW9uSWQ6ICcnLFxyXG4gICAgICAgIHN1YmplY3Q6IG5ldyBTdWJqZWN0KCksXHJcbiAgICAgIH0gYXMgU2Nyb2xsU3B5O1xyXG5cclxuICAgICAgdGhpcy5zY3JvbGxTcGllc1tzY3JvbGxHcm91cElkXS5zdWJqZWN0XHJcbiAgICAgICAgLnN1YnNjcmliZSgoY3VycmVudFNlY3Rpb246IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsQ2hhbmdlW3Njcm9sbEdyb3VwSWRdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsQ2hhbmdlW3Njcm9sbEdyb3VwSWRdLm5leHQoY3VycmVudFNlY3Rpb24pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5oYXNFbGVtZW50KHNjcm9sbElkLCBzY3JvbGxHcm91cElkKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZWw6IFNjcm9sbEVsZW1lbnQgPSB7XHJcbiAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXHJcbiAgICAgIGlkOiBzY3JvbGxJZFxyXG4gICAgfVxyXG4gICAgLy8g5Yqg5YWl5pe277yM5Yik5pat5piv5ZCm5piv5b2T5YmNXHJcbiAgICB0aGlzLnVwZGF0ZVNjcm9sbFNweUFjdGl2ZUNsc05hbWUoc2Nyb2xsR3JvdXBJZCxlbCk7XHJcbiAgICBjb25zdCBlbGVtZW50czogYW55W10gPSB0aGlzLnNjcm9sbFNwaWVzW3Njcm9sbEdyb3VwSWRdLmVsZW1lbnRzO1xyXG4gICAgZWxlbWVudHMucHVzaChlbCk7XHJcbiAgICBlbGVtZW50cy5zb3J0KChhLCBiKTogbnVtYmVyID0+IGIuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSBhLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKTtcclxuXHJcbiAgICB0aGlzLnNjcm9sbFNwaWVzW3Njcm9sbEdyb3VwSWRdLmVsZW1lbnRzID0gZWxlbWVudHM7XHJcbiAgfVxyXG4gIC8qKuenu+mZpOa7muWKqOebkeWQrOmUmueCuemDqOWIhuWFg+e0oCAqL1xyXG4gIHB1YmxpYyByZW1vdmVFbGVtZW50KHNjcm9sbElkOiBzdHJpbmcsIHNjcm9sbEdyb3VwSWQ6IHN0cmluZyA9IHRoaXMuZGVmYXVsdElkKTogdm9pZCB7XHJcbiAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMuc2Nyb2xsU3BpZXNbc2Nyb2xsR3JvdXBJZF0uZWxlbWVudHMuZmlsdGVyKChlbCk6IGJvb2xlYW4gPT4ge1xyXG4gICAgICByZXR1cm4gZWwuaWQgIT09IHNjcm9sbElkXHJcbiAgICB9XHJcbiAgICApO1xyXG4gICAgaWYgKCFlbGVtZW50cy5sZW5ndGgpIHtcclxuICAgICAgZGVsZXRlIHRoaXMuc2Nyb2xsU3BpZXNbc2Nyb2xsR3JvdXBJZF07XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuc2Nyb2xsU3BpZXNbc2Nyb2xsR3JvdXBJZF0uZWxlbWVudHMgPSBlbGVtZW50cztcclxuICB9XHJcbiAgLyoq5Yik5patc2Nyb2xsR3JvdXBJZCDmmK/lkKbmnIlpZOWQjeS4umVsZW1lbnRJZCDnmoTlhYPntKAgKi9cclxuICBwcml2YXRlIGhhc0VsZW1lbnQoZWxlbWVudElkOiBzdHJpbmcsIHNjcm9sbEdyb3VwSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuc2Nyb2xsU3BpZXNbc2Nyb2xsR3JvdXBJZF0uZWxlbWVudHMuc29tZSgoZWxlbWVudCk6IGJvb2xlYW4gPT4gZWxlbWVudC5pZCA9PT0gZWxlbWVudElkKTtcclxuICB9XHJcbiAgLyoq6K6+572ub2Zmc2V0ICovXHJcbiAgcHVibGljIHNldE9mZnNldChvZmZzZXQ6IG51bWJlciA9IDAsIGNvbnRlbnRJZDogc3RyaW5nID0gdGhpcy5kZWZhdWx0SWQpOiB2b2lkIHtcclxuICAgIGlmIChjb250ZW50SWQgIT09ICcnKSB7XHJcbiAgICAgIHRoaXMub2Zmc2V0c1tjb250ZW50SWRdID0gb2Zmc2V0O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMub2Zmc2V0c1t0aGlzLmRlZmF1bHRJZF0gPSBvZmZzZXQ7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qU2Nyb2xsU3B557uE5Lu2KOmUmueCueWIl+ihqOWMuuWfn++8ieWIneWni+WMlumihOiuvmRlZmF1bHRJZCAqL1xyXG4gIHNldEdyb3VwSWQoZ3JvdXBpZCkge1xyXG4gICAgaWYgKGdyb3VwaWQpIHtcclxuICAgICAgdGhpcy5kZWZhdWx0SWQgPSBncm91cGlkO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0R3JvdXBJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmRlZmF1bHRJZDtcclxuICB9XHJcbiAgLyrmlLnlj5ggU2Nyb2xsU3B557uE5Lu277yI6ZSa54K55YiX6KGo5Yy65Z+f77yJ55qE5pi+56S654q25oCB5pe2ICovXHJcbiAgY2hhbmdlR3JvdXBJZEZvbGxvd1R5cGUoZ3JvdXBpZCwgZm9sbG93VHlwZURhdGEpIHtcclxuICAgIHRoaXMuc2Nyb2xsU3B5TGlzdEZvbGxvd1R5cGVDaGFuZ2VzW2dyb3VwaWRdID0gZm9sbG93VHlwZURhdGE7XHJcbiAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lckNsc05hbWUoZ3JvdXBpZCk7XHJcbiAgfVxyXG4gIHByaXZhdGUgdXBkYXRlQ29udGFpbmVyQ2xzTmFtZShncm91cGlkKSB7XHJcbiAgICAvLyDmsqHmnInlvoXmm7TmlrDlj5jljJZcclxuICAgIGlmICghdGhpcy5zY3JvbGxTcHlMaXN0Rm9sbG93VHlwZUNoYW5nZXMuaGFzT3duUHJvcGVydHkoZ3JvdXBpZCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy8gY29udGFpbmVy5bm25LiN5a2Y5Zyo55qE5pe25YCZXHJcbiAgICBpZiAoIXRoaXMuc2Nyb2xsQ29udGVudHMuaGFzT3duUHJvcGVydHkoZ3JvdXBpZCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGZvbGxvd1R5cGVEYXRhID0gdGhpcy5zY3JvbGxTcHlMaXN0Rm9sbG93VHlwZUNoYW5nZXNbZ3JvdXBpZF07XHJcbiAgICBsZXQgY29udGFpbmVyRWwgPSB0aGlzLnNjcm9sbENvbnRlbnRzW2dyb3VwaWRdO1xyXG4gICAgLy8gQ29udGFpbmVy55qERWxlbWVudCBcclxuICAgIGlmIChmb2xsb3dUeXBlRGF0YVsncHJldiddID09ICdmaXhlZFRhYicpIHtcclxuICAgICAgLy/np7vpmaRjbGFzc1xyXG4gICAgICBjb250YWluZXJFbC5jbGFzc05hbWUgPSBjb250YWluZXJFbC5jbGFzc05hbWUucmVwbGFjZSh0aGlzLmZpeGVkVGFiQ29udGFpbmVyQ2xzTmFtZSwgJycpO1xyXG4gICAgICBjb250YWluZXJFbC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5wYXJlbnRGaXhlZFRhYkNvbnRhaW5lckNsc05hbWUpO1xyXG4gICAgfSBlbHNlIGlmIChmb2xsb3dUeXBlRGF0YVsnbmV4dCddID09ICdmaXhlZFRhYicpIHtcclxuICAgICAgLy8g5aKe5YqgY2xhc3NcclxuICAgICAgY29udGFpbmVyRWwuY2xhc3NOYW1lICs9ICcgJyArIHRoaXMuZml4ZWRUYWJDb250YWluZXJDbHNOYW1lO1xyXG4gICAgICAvLyDnu5nniLblhYPntKDlop7liqDpq5jluqZcclxuICAgICAgY29udGFpbmVyRWwucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMucGFyZW50Rml4ZWRUYWJDb250YWluZXJDbHNOYW1lKTtcclxuICAgIH1cclxuICAgIHRoaXMuc2Nyb2xsU3B5TGlzdEZvbGxvd1R5cGVDaGFuZ2VzW2dyb3VwaWRdID0gbnVsbDtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVNjcm9sbFNwaWVzQWN0aXZlQ2xzTmFtZShncm91cElkLGN1cnJlbnRJZCkge1xyXG4gICAgLy8g6L+95Yqg44CB56e76ZmkY2xhc3NcclxuICAgIHRoaXMuc2Nyb2xsU3BpZXNbZ3JvdXBJZF0uZWxlbWVudHMubWFwKChpdGVtOiBTY3JvbGxFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlmIChpdGVtLmlkID09IGN1cnJlbnRJZCkge1xyXG4gICAgICAgIC8vIOaJvuWIsOW9k+WJjVxyXG4gICAgICAgIGlmIChpdGVtLmVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YodGhpcy5zY3JvbGxTcHlQYXJ0QWN0aXZlQ2xzTmFtZSkgPCAwKSB7XHJcbiAgICAgICAgICBpdGVtLmVsZW1lbnQuY2xhc3NOYW1lICs9ICcgJyArIHRoaXMuc2Nyb2xsU3B5UGFydEFjdGl2ZUNsc05hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOWFtuS7llxyXG4gICAgICAgIGl0ZW0uZWxlbWVudC5jbGFzc05hbWUgPSBpdGVtLmVsZW1lbnQuY2xhc3NOYW1lLnJlcGxhY2UodGhpcy5zY3JvbGxTcHlQYXJ0QWN0aXZlQ2xzTmFtZSwgJycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5b2T6L+95YqgU2Nyb2xsU3B55Z2X55qE5pe25YCZ77yM5Yik5pat5piv5ZCm5piv5bey57uP6K6+572u55qE5b2T5YmNXHJcbiAgICogQHBhcmFtIGdyb3VwSWQgXHJcbiAgICogQHBhcmFtIHNjcm9sbEVsIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgIHVwZGF0ZVNjcm9sbFNweUFjdGl2ZUNsc05hbWUoZ3JvdXBJZCxzY3JvbGxFbDpTY3JvbGxFbGVtZW50KXtcclxuICAgIC8vIOWmguaenOW3suiuvue9rlxyXG4gICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbklkT2JqW2dyb3VwSWRdKXtcclxuICAgICAgaWYodGhpcy5jdXJyZW50U2VjdGlvbklkT2JqW2dyb3VwSWRdWydpZFZhbHVlJ109PXNjcm9sbEVsLmlkKXtcclxuICAgICAgICBzY3JvbGxFbC5lbGVtZW50LmNsYXNzTmFtZSs9JyAnK3RoaXMuc2Nyb2xsU3B5UGFydEFjdGl2ZUNsc05hbWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbiJdfQ==