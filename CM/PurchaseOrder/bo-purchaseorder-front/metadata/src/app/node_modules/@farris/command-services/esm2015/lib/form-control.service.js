import { Injectable } from "@angular/core";
export class FormControlService {
    constructor() { }
    getFormControlsByFrameContext(frameContext) {
        return frameContext && frameContext.form && frameContext.form.ngFormControls || null;
    }
    /**
     * 通过binding元数据获取NgFormControl
     * @param frameContext
     * @param binding binding
     * @returns
     */
    getFormControlByBinding(frameContext, binding) {
        const ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).find((ngFormControl) => ngFormControl && ngFormControl.binding === binding);
    }
    /**
     *
     * @param frameContext frameContext
     * @param fullPath
     * @returns
     */
    getFormControlIndexByFullPath(frameContext, fullPath) {
        const ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        const bindings = fullPath.split('/').filter(p => p);
        return Object.values(ngFormControls).findIndex((ngFormControl) => {
            if (!ngFormControl) {
                return false;
            }
            const bindingPath = frameContext.viewModel.bindingPath;
            const bindingPaths = bindingPath.split('/').filter(p => p);
            const formControlBindingPaths = ngFormControl.binding.split('.').filter(p => p);
            const fullPath = bindingPaths.concat(formControlBindingPaths);
            return fullPath.join('/') === bindings.join('/');
        });
    }
    /**
     * 通过binding元数据获取NgFormControl位置
     * @param frameContext
     * @param binding binding
     * @returns 从0开始
     */
    getFormControlIndexByBinding(frameContext, binding) {
        const ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).findIndex((ngFormControl) => ngFormControl && ngFormControl.binding === binding);
    }
}
FormControlService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
FormControlService.ctorParameters = () => [];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1jb250cm9sLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbW1hbmQtc2VydmljZXMvIiwic291cmNlcyI6WyJsaWIvZm9ybS1jb250cm9sLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUkzQyxNQUFNLE9BQU8sa0JBQWtCO0lBQzdCLGdCQUFnQixDQUFDO0lBQ1YsNkJBQTZCLENBQUMsWUFBMEI7UUFDN0QsT0FBTyxZQUFZLElBQUksWUFBWSxDQUFDLElBQUksSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUM7SUFDdkYsQ0FBQztJQUNEOzs7OztPQUtHO0lBQ0ksdUJBQXVCLENBQUMsWUFBMEIsRUFBRSxPQUFlO1FBQ3hFLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ25CLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsYUFBNEIsRUFBRSxFQUFFLENBQUMsYUFBYSxJQUFJLGFBQWEsQ0FBQyxPQUFPLEtBQUssT0FBTyxDQUFDLENBQUM7SUFFbEksQ0FBQztJQUNEOzs7OztPQUtHO0lBQ0ksNkJBQTZCLENBQUMsWUFBMEIsRUFBRSxRQUFnQjtRQUMvRSxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsYUFBNEIsRUFBRSxFQUFFO1lBQzlFLElBQUksQ0FBQyxhQUFhLEVBQUU7Z0JBQ2xCLE9BQU8sS0FBSyxDQUFDO2FBQ2Q7WUFDRCxNQUFNLFdBQVcsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQztZQUN2RCxNQUFNLFlBQVksR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNELE1BQU0sdUJBQXVCLEdBQUcsYUFBYSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEYsTUFBTSxRQUFRLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQzlELE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNEOzs7OztPQUtHO0lBQ0ksNEJBQTRCLENBQUMsWUFBMEIsRUFBRSxPQUFlO1FBQzdFLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ25CLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsYUFBNEIsRUFBRSxFQUFFLENBQUMsYUFBYSxJQUFJLGFBQWEsQ0FBQyxPQUFPLEtBQUssT0FBTyxDQUFDLENBQUM7SUFDdkksQ0FBQzs7O1lBdkRGLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IEZyYW1lQ29udGV4dCwgTmdGb3JtQ29udHJvbCB9IGZyb20gXCJAZmFycmlzL2RldmtpdFwiO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgRm9ybUNvbnRyb2xTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoKSB7IH1cbiAgcHVibGljIGdldEZvcm1Db250cm9sc0J5RnJhbWVDb250ZXh0KGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0KTogeyBbcHJvcGVydHlOYW1lOiBzdHJpbmddOiBOZ0Zvcm1Db250cm9sIH0gfCBudWxsIHtcbiAgICByZXR1cm4gZnJhbWVDb250ZXh0ICYmIGZyYW1lQ29udGV4dC5mb3JtICYmIGZyYW1lQ29udGV4dC5mb3JtLm5nRm9ybUNvbnRyb2xzIHx8IG51bGw7XG4gIH1cbiAgLyoqXG4gICAqIOmAmui/h2JpbmRpbmflhYPmlbDmja7ojrflj5ZOZ0Zvcm1Db250cm9sXG4gICAqIEBwYXJhbSBmcmFtZUNvbnRleHQgXG4gICAqIEBwYXJhbSBiaW5kaW5nIGJpbmRpbmdcbiAgICogQHJldHVybnMgXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9ybUNvbnRyb2xCeUJpbmRpbmcoZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsIGJpbmRpbmc6IHN0cmluZyk6IE5nRm9ybUNvbnRyb2wge1xuICAgIGNvbnN0IG5nRm9ybUNvbnRyb2xzID0gdGhpcy5nZXRGb3JtQ29udHJvbHNCeUZyYW1lQ29udGV4dChmcmFtZUNvbnRleHQpO1xuICAgIGlmICghbmdGb3JtQ29udHJvbHMpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhuZ0Zvcm1Db250cm9scykuZmluZCgobmdGb3JtQ29udHJvbDogTmdGb3JtQ29udHJvbCkgPT4gbmdGb3JtQ29udHJvbCAmJiBuZ0Zvcm1Db250cm9sLmJpbmRpbmcgPT09IGJpbmRpbmcpO1xuXG4gIH1cbiAgLyoqXG4gICAqIFxuICAgKiBAcGFyYW0gZnJhbWVDb250ZXh0IGZyYW1lQ29udGV4dFxuICAgKiBAcGFyYW0gZnVsbFBhdGggXG4gICAqIEByZXR1cm5zIFxuICAgKi9cbiAgcHVibGljIGdldEZvcm1Db250cm9sSW5kZXhCeUZ1bGxQYXRoKGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0LCBmdWxsUGF0aDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBuZ0Zvcm1Db250cm9scyA9IHRoaXMuZ2V0Rm9ybUNvbnRyb2xzQnlGcmFtZUNvbnRleHQoZnJhbWVDb250ZXh0KTtcbiAgICBpZiAoIW5nRm9ybUNvbnRyb2xzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgYmluZGluZ3MgPSBmdWxsUGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHApO1xuICAgIHJldHVybiBPYmplY3QudmFsdWVzKG5nRm9ybUNvbnRyb2xzKS5maW5kSW5kZXgoKG5nRm9ybUNvbnRyb2w6IE5nRm9ybUNvbnRyb2wpID0+IHtcbiAgICAgIGlmICghbmdGb3JtQ29udHJvbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjb25zdCBiaW5kaW5nUGF0aCA9IGZyYW1lQ29udGV4dC52aWV3TW9kZWwuYmluZGluZ1BhdGg7XG4gICAgICBjb25zdCBiaW5kaW5nUGF0aHMgPSBiaW5kaW5nUGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHApO1xuICAgICAgY29uc3QgZm9ybUNvbnRyb2xCaW5kaW5nUGF0aHMgPSBuZ0Zvcm1Db250cm9sLmJpbmRpbmcuc3BsaXQoJy4nKS5maWx0ZXIocCA9PiBwKTtcbiAgICAgIGNvbnN0IGZ1bGxQYXRoID0gYmluZGluZ1BhdGhzLmNvbmNhdChmb3JtQ29udHJvbEJpbmRpbmdQYXRocyk7XG4gICAgICByZXR1cm4gZnVsbFBhdGguam9pbignLycpID09PSBiaW5kaW5ncy5qb2luKCcvJyk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIOmAmui/h2JpbmRpbmflhYPmlbDmja7ojrflj5ZOZ0Zvcm1Db250cm9s5L2N572uXG4gICAqIEBwYXJhbSBmcmFtZUNvbnRleHQgXG4gICAqIEBwYXJhbSBiaW5kaW5nIGJpbmRpbmdcbiAgICogQHJldHVybnMg5LuOMOW8gOWni1xuICAgKi9cbiAgcHVibGljIGdldEZvcm1Db250cm9sSW5kZXhCeUJpbmRpbmcoZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsIGJpbmRpbmc6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3QgbmdGb3JtQ29udHJvbHMgPSB0aGlzLmdldEZvcm1Db250cm9sc0J5RnJhbWVDb250ZXh0KGZyYW1lQ29udGV4dCk7XG4gICAgaWYgKCFuZ0Zvcm1Db250cm9scykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKG5nRm9ybUNvbnRyb2xzKS5maW5kSW5kZXgoKG5nRm9ybUNvbnRyb2w6IE5nRm9ybUNvbnRyb2wpID0+IG5nRm9ybUNvbnRyb2wgJiYgbmdGb3JtQ29udHJvbC5iaW5kaW5nID09PSBiaW5kaW5nKTtcbiAgfVxufSJdfQ==