/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, EventEmitter, HostBinding, Injector, Input, Output, ViewEncapsulation, HostListener, ViewChild, ElementRef } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
import { MessagerService } from '@farris/ui-messager';
import { getMultilingualValue } from '../getValueWithLocaleId';
export class SimpleColumnsComponent {
    /**
     * @param {?} injector
     * @param {?} cd
     */
    constructor(injector, cd) {
        this.injector = injector;
        this.cd = cd;
        this.enableScheme = false;
        this.seartTypes = [];
        /**
         * 所有列
         */
        this.columns = [];
        /**
         * 显示的列
         */
        this.fields = [];
        /**
         * 点击侧边样式以外的区域隐藏面板。默认为 true
         */
        this.clickToHidden = true;
        this.top = 0;
        this._schemeList = [];
        this.cls = 'f-datagrid-settings-simple-host';
        this.formatChange = new EventEmitter();
        this.fieldsChange = new EventEmitter();
        this.submit = new EventEmitter();
        this.closed = new EventEmitter();
        this.advanced = new EventEmitter();
        this.addNewScheme = new EventEmitter();
        this.showSchemeList = new EventEmitter();
        this.activeItemChange = new EventEmitter();
        this.allCols = [];
        this.columnType = 'all';
        this.isEn = false;
        this.showSchemePanel = false;
        this.switchValue = false;
        // 当前方案
        this.currentSchemeItem = null;
        this.searchResultIsVisibleAll = false;
        this.defaultSchemeName = '系统预制';
        this.settings = {};
        this.localeSer = this.injector.get(LocaleService, null);
        this.messager = this.injector.get(MessagerService, null);
    }
    /**
     * @return {?}
     */
    get schemeList() {
        return this._schemeList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set schemeList(val) {
        if (val && val.length) {
            val.forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                n['_title_'] = getMultilingualValue(JSON.parse(n.name), this.localeSer.localeId);
            }));
        }
        this._schemeList = val || [];
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onClick($event) {
        // console.log($event);
        $event.stopPropagation();
        /** @type {?} */
        const clsname = $event.target['className'] || '';
        if (clsname.indexOf('f-datagrid-settings-simple-host') > -1) {
            // 隐藏侧边栏；
            if (this.clickToHidden) {
                this.close();
            }
        }
        this.showSchemePanel = false;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onEscKeydown($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.close();
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onEnterKeydown($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.onSubmitClick();
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onControlGKeydown($event) {
        if ($event.ctrlKey && !document.querySelector('modal-container')) {
            $event.preventDefault();
            $event.stopPropagation();
            if ($event.key.toLowerCase() === 'g') {
                this.showAdvanced($event);
            }
            else if ($event.key.toLowerCase() === 'r') {
                this.onSettingReset();
            }
            else if ($event.key.toLowerCase() === 's') {
                this.searchInput.nativeElement.focus();
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getCurrentSchemeSettings() {
        if (this.currentSchemeItem) {
            /** @type {?} */
            const schemeSettings = JSON.parse(this.currentSchemeItem.queryConditionString);
            return (/** @type {?} */ (schemeSettings[this.localeSer.localeId]));
        }
        return null;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.allCols = this.columns[0];
        if (this.gridInstance.enableScheme && this.currentSchemeItem) {
            this.settings = this.getCurrentSchemeSettings() || {};
        }
        if (this.settings && this.settings.viewColumns && this.settings.viewColumns.length) {
            this.fields = this.settings.viewColumns;
            this.dirtySettings(true);
        }
        else {
            this.fields = this.getViewColumns();
        }
        this.container.nativeElement.focus();
        this.defaultSchemeName = this.localeSer.getValue('datagrid.scheme.syspreset') || this.gridInstance.defaultSchemeName;
    }
    /**
     * @private
     * @return {?}
     */
    getViewColumns() {
        // 多表头
        /** @type {?} */
        let visibleCls = [];
        if (this.columns.length > 1) {
            this.columns.forEach((/**
             * @param {?} cols
             * @return {?}
             */
            cols => {
                visibleCls = visibleCls.concat(this._getViewColumns(cols));
            }));
        }
        else {
            visibleCls = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => (n.visible || n.visible === undefined)));
        }
        return visibleCls.map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
    }
    /**
     * @private
     * @param {?} cols
     * @return {?}
     */
    _getViewColumns(cols) {
        return cols.filter((/**
         * @param {?} c
         * @return {?}
         */
        c => !c.colspan && (c.visible || c.visible === undefined)));
    }
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    filterColumns(searchWords = '') {
        /** @type {?} */
        let cols = [];
        if (this.switchValue) {
            cols = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => this.fields.indexOf(n.field) > -1));
        }
        else {
            cols = this.columns[0];
        }
        if (searchWords) {
            cols = cols.filter((/**
             * @param {?} c
             * @return {?}
             */
            c => c.title.toLowerCase().indexOf(searchWords.toLowerCase()) > -1));
        }
        this.allCols = cols;
    }
    /**
     * @private
     * @return {?}
     */
    onFieldsChanged() {
        if (!this.gridInstance.enableScheme) {
            this.fieldsChange.emit(this.fields);
        }
    }
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    onDblClick($event, col) {
        // console.log('显示与隐藏切换事件', col);
        this.onCheckboxClick($event, col);
    }
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    onCheckboxClick($event, col) {
        // console.log('显示与隐藏切换事件', col);
        $event.stopPropagation();
        this.showSchemePanel = false;
        /** @type {?} */
        let checked = false;
        /** @type {?} */
        const index = this.fields.indexOf(col.field);
        if (index === -1) {
            this.fields.push(col.field);
            checked = true;
        }
        else {
            this.fields.splice(index, 1);
            checked = false;
        }
        /** @type {?} */
        const item = this.columns[0].find((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field === col.field));
        if (item) {
            item.visible = checked;
        }
        // this.columns[0].forEach(f => {
        //     f.visible = this.fields.indexOf(f.field) > -1;
        // });
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.searchResultIsVisibleAll = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).length === this.allCols.length;
        this.dirtySettings(true);
        this.onFieldsChanged();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    searchColumn($event) {
        /** @type {?} */
        const txt = $event.target.value;
        this.filterColumns(txt);
    }
    /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    onFieldDrop(fieldInfo, txt, ulElRef) {
        this.showSchemePanel = false;
        // console.log('drop', fieldInfo);
        const { removedIndex, addedIndex } = fieldInfo;
        /** @type {?} */
        const moveItem = this.allCols[removedIndex];
        /** @type {?} */
        const targetItem = this.allCols[addedIndex];
        /** @type {?} */
        const moveItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field === moveItem.field));
        /** @type {?} */
        const targetItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field === targetItem.field));
        /** @type {?} */
        const removedItem = this.columns[0].splice(moveItemIndex, 1);
        this.columns[0].splice(targetItemIndex, 0, ...removedItem);
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.onFieldsChanged();
        this.filterColumns(txt);
    }
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @return {?}
     */
    getCheckAllState() {
        if (!this.searchInput.nativeElement.value) {
            if (this.fields.length === 0) {
                return 0;
            }
            else {
                if (this.fields.length === this.columns[0].length) {
                    return 1;
                }
                return 2;
            }
        }
        else {
            /** @type {?} */
            const visibleLen = this.allCols.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible)).length;
            if (visibleLen === this.allCols.length) {
                return 1;
            }
            else {
                if (visibleLen < this.allCols.length) {
                    if (visibleLen === 0) {
                        return 0;
                    }
                    return 1;
                }
            }
        }
    }
    // 全选
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    onCheckAllClick($event, txt) {
        $event.stopPropagation();
        this.showSchemePanel = false;
        /** @type {?} */
        const state = this.getCheckAllState();
        /** @type {?} */
        const isCheckAll = state === 0 || state === 2;
        if (!txt) {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible = isCheckAll));
        }
        else {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                /** @type {?} */
                const item = this.allCols.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => n.field == a.field));
                if (item) {
                    n.visible = isCheckAll;
                    item.visible = isCheckAll;
                }
            }));
        }
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.searchResultIsVisibleAll = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).length === this.allCols.length;
        this.dirtySettings(true);
        this.onFieldsChanged();
        this.filterColumns(txt);
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    close($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.closed.emit();
    }
    // 打开高级设置窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    showAdvanced($event) {
        this.close($event);
        this.advanced.emit({ viewFields: this.fields });
    }
    // 恢复默认
    /**
     * @param {?=} $event
     * @return {?}
     */
    onSettingReset($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        /** @type {?} */
        const restorDefaultText = this.localeSer.getValue('datagrid.settings.restoreDefaultSettingsText') || '确认要恢复默认设置吗？';
        this.messager.confirm(restorDefaultText).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t) {
                this.reset2Default();
                this.dirtySettings(true);
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    reset2Default() {
        /** @type {?} */
        const options = this.gridInstance.dfs['_state'].initialOptions;
        if (options.columnFields && options.columnFields.length) {
            /** @type {?} */
            const newColumns = [];
            options.columnFields.forEach((/**
             * @param {?} c
             * @return {?}
             */
            c => {
                if (c.field !== '_datagrid-setting-control_') {
                    /** @type {?} */
                    const col = this.gridInstance.columns[0].find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    (n) => n.field === c.field));
                    if (col) {
                        col.visible = c.visible;
                        col.halign = c.halign;
                        col.align = c.align;
                        col.width = c.width;
                        col.footer = Object.assign({}, c.footer || {});
                        col.groupFooter = Object.assign({}, c.groupFooter || {});
                        newColumns.push(col);
                    }
                }
            }));
            this.columns = [newColumns];
        }
        this.allCols = this.columns[0];
        this.settings = {};
        this.fields = this.getViewColumns();
        this.settings.viewColumns = this.fields;
        this.settings.columnFormat = [...this.columns[0]];
        if (options.sort) {
            /** @type {?} */
            const sortOrders = options.sort.sortOrder ? options.sort.sortOrder.split(',') : [];
            /** @type {?} */
            const sortNames = options.sort.sortName ? options.sort.sortName.split(',') : [];
            this.settings.sortInfo = { sortName: sortNames, sortOrder: sortOrders };
        }
        else {
            this.settings.sortInfo = {};
        }
        this.settings.groupField = options.groupField ? options.groupField.split(',') : [];
    }
    // 确定按钮点击事件
    /**
     * @param {?=} $event
     * @return {?}
     */
    onSubmitClick($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.settings.viewColumns = this.fields;
        if (!this.enableScheme || !this.currentSchemeItem) {
            if (!this.settings.columnFormat) {
                this.settings.columnFormat = [...this.columns[0]];
            }
            if (!this.settings.sortInfo) {
                this.settings.sortInfo = {
                    sortName: this.gridInstance.sortName ? this.gridInstance.sortName.split(',') : [],
                    sortOrder: this.gridInstance.sortOrder ? this.gridInstance.sortOrder.split(',') : []
                };
            }
            if (this.settings.groupField === undefined) {
                this.settings.groupField = this.gridInstance.groupField ? this.gridInstance.groupField.split(',') : [];
            }
        }
        else {
            /** @type {?} */
            const _settings = this.getCurrentSchemeSettings();
            if (_settings) {
                this.settings = Object.assign(_settings || {}, this.settings);
            }
        }
        // this.activeItemChange.emit(this.activeSchemeItem);
        this.submit.emit({ content: this.settings, close: this.close.bind(this), target: this.btnOk.nativeElement, currentScheme: this.currentSchemeItem });
    }
    // 显示下拉方案列表
    /**
     * @param {?} $event
     * @return {?}
     */
    onChooseScheme($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = !this.showSchemePanel;
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.schemeitemsEleRef && this.currentSchemeItem) {
                /** @type {?} */
                const itemEl = this.schemeitemsEleRef.nativeElement.querySelector(`#schemeitem_${this.currentSchemeItem.id}`);
                if (itemEl) {
                    if (itemEl.scrollIntoViewIfNeeded) {
                        itemEl.scrollIntoViewIfNeeded();
                    }
                    else {
                        itemEl.scrollIntoView();
                    }
                }
            }
        }));
    }
    // 仅显示可见列
    /**
     * @param {?} $event
     * @return {?}
     */
    onlySeeVisibleColumns($event) {
        this.switchValue = $event;
        this.filterColumns();
    }
    // 新增方案
    /**
     * @param {?} $event
     * @return {?}
     */
    onNewSchemeClick($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.addNewScheme.emit();
    }
    // 显示方案列表管理窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    onShowSchemeList($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.showSchemeList.emit();
    }
    // 方案点击
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    onSchemeItemClick($event, item) {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.currentSchemeItem = item;
            this.showSchemePanel = false;
            /** @type {?} */
            let schemeSettings = null;
            if (item) {
                schemeSettings = JSON.parse(item.queryConditionString);
                schemeSettings = schemeSettings[this.localeSer.localeId];
                if (!schemeSettings) {
                    this.reset2Default();
                }
                else {
                    this.settings = schemeSettings;
                    this.fields = schemeSettings.viewColumns;
                }
            }
            else {
                this.reset2Default();
            }
            this.cd.detectChanges();
        }));
    }
    /**
     * @param {?} flag
     * @return {?}
     */
    dirtySettings(flag) {
        // this.isChanged = flag;
    }
}
SimpleColumnsComponent.decorators = [
    { type: Component, args: [{
                selector: 'datagrid-settings-simple',
                template: "<div class=\"d-flex flex-column f-datagrid-settings-simple\" tabindex=\"0\" #colcontainer\r\n    [style.top.px]=\"top\" [style.height]=\"'calc(100vh - ' +  top + 'px)'\" >\r\n\r\n    <div class=\"header d-flex\">\r\n        <div class=\"f-utils-fill title d-flex flex-row\"> {{ 'datagrid.settings.simple.title' | locale }} \r\n            <button #btnSchemeName class=\"btn ml-3 px-2 scheme-name d-flex flex-row\"  *ngIf=\"enableScheme\" (click)=\"onChooseScheme($event)\">\r\n                <!-- <span *ngIf=\"isChanged\">*</span> -->\r\n                <span>{{ currentSchemeItem? currentSchemeItem._title_ : defaultSchemeName }}</span>\r\n                <span class=\"f-icon f-icon-arrow-s ml-2\" style=\"font-size: 12px;\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"closed\" (click)=\"close($event)\">\r\n            <span class=\"f-icon f-icon-close\" style=\"font-size: 20px;\"></span>\r\n        </div>\r\n    </div>\r\n    <div class=\"scheme-manager-dropdown\" [style.display]=\"showSchemePanel? '': 'none'\" [style.left.px]=\"btnRef? btnRef.nativeElement.offsetLeft : 97\"  (click)=\"$event.stopPropagation()\">\r\n        <div class=\"f-utils-fill f-utils-flex-column m-2\">\r\n            <div class=\"pb-2\" style=\"max-height: calc(100vh - 300px);overflow: auto\">\r\n                <ul #schemeitems>\r\n                    <li class=\"scheme-manager__item\" [class.active]=\"!currentSchemeItem\" (click)=\"onSchemeItemClick($event, null)\"> \r\n                        <!-- <span *ngIf=\"isChanged && !activeSchemeItem\">*</span> -->\r\n                        {{'datagrid.scheme.syspreset' | locale}}\r\n                    </li>\r\n                    <li [attr.id]=\"'schemeitem_'+ item.id\" class=\"scheme-manager__item d-flex flex-row\" \r\n                        [class.active]=\"currentSchemeItem && currentSchemeItem?.id === item.id\"  \r\n                        *ngFor=\"let item of schemeList\" (click)=\"onSchemeItemClick($event, item)\" title=\"{{item._title_}}\">\r\n                        <!-- <span *ngIf=\"isChanged && activeSchemeItem?.id==item.id\">*</span> -->\r\n                        <span class=\"f-utils-fill mr-1\" style=\"text-overflow: ellipsis;\">{{item._title_}}</span>\r\n                        <span class=\"scheme-manager__label default\" *ngIf=\"item.isDefault\">{{'datagrid.scheme.isDefault' | locale}}</span>\r\n                        <span class=\"scheme-manager__label public\" *ngIf=\"item.type === 'public'\">{{'datagrid.scheme.isPublic' | locale}}</span>\r\n                        <span class=\"scheme-manager__label private\" *ngIf=\"!item.isDefault && item.type === 'private'\">{{'datagrid.scheme.isPrivate' | locale}}</span>\r\n                        <span class=\"scheme-manager__label org\" *ngIf=\"item.type === 'org'\">{{'datagrid.scheme.isOrg' | locale}}</span>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n\r\n            <div class=\"d-flex scheme-manager__button-add\">\r\n                <button (click)=\"onNewSchemeClick($event)\">\r\n                    <span class=\"f-icon f-icon-plus\"></span>{{'datagrid.scheme.newScheme' | locale}}\r\n                </button>\r\n            </div>\r\n\r\n            <div class=\"p-2 mt-2\">\r\n                <div class=\"btn-toolbar\" style=\"justify-content: flex-end;\">\r\n                    <button class=\"btn btn-link mr-3\" (click)=\"onShowSchemeList($event)\">{{'datagrid.scheme.mgrScheme' | locale}}</button>\r\n                    <button class=\"btn btn-primary mr-1\" (click)=\"onNewSchemeClick($event)\">{{'datagrid.scheme.saveas' | locale}} </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"f-utils-fill content d-flex flex-column\">\r\n        <div>\r\n            <div class=\"d-flex flex-row mb-2\" style=\"align-items: center;\">\r\n                <h5 class=\"count f-utils-fill m-0\" [innerHTML]=\"'datagrid.settings.simple.count' | locale | replaceX: fields.length\"></h5>\r\n                <div class=\"d-flex flex-row\">{{'datagrid.scheme.onlyshowcolumns' | locale}} \r\n                    <farris-switch style=\"position: relative;\r\n                    top: 2px;\r\n                    margin-left: 5px;\"\r\n                    id=\"only-visible-columns\"\r\n                    [square]=\"false\" [size]=\"'small'\"\r\n                    [ngModel]=\"switchValue\" \r\n                    (valueChange)=\"onlySeeVisibleColumns($event)\"\r\n                    ></farris-switch></div>\r\n            </div>\r\n\r\n            <div class=\"tip\">\r\n                {{ 'datagrid.settings.simple.tip' | locale }}\r\n            </div>\r\n            <div class=\"input-group mb-2 scheme-manager__search-box\">\r\n                <input #inputWord type=\"text\" class=\"form-control\" placeholder=\"{{'datagrid.settings.searchPlaceholder' | locale}}\"\r\n                (input)=\"searchColumn($event)\" style=\"height: 26px;\">\r\n                <div  class=\"input-group-append\">\r\n                    <span  class=\"fa f-icon-search\"></span>\r\n                </div>\r\n            </div>\r\n            \r\n\r\n            <div style=\"padding: 5px 0px;\">\r\n                <button class=\"btn btn-link \" style=\"height: 32px;padding-left: 4px;\" (click)=\"onCheckAllClick($event,inputWord.value)\">\r\n                    <span class=\"f-icon f-icon-minus-outline checkall\" [class.f-icon-checkbox]=\"!fields.length\"\r\n                        [class.f-icon-checkbox-checked]=\" searchInput.nativeElement.value ?  searchResultIsVisibleAll : fields.length === allCols.length\"></span>\r\n                    {{ 'datagrid.settings.checkall' | locale }}\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div style=\"overflow: auto;padding-right:3px\" class=\"f-utils-fill\">\r\n            <ul class=\"list-group list-group-flush\" #ul column-visible-drag (drop)=\"onFieldDrop($event, inputWord.value, ul)\">\r\n                <li class=\"list-group-item list-group-item-action smooth-dnd-draggable-wrapper format-setting-column\" *ngFor=\"let col of allCols\" \r\n                    (click)=\"onDblClick($event, col)\">\r\n                    <span class=\"f-icon checkbox\"\r\n                        [class.f-icon-checkbox-checked]=\"fields.indexOf(col.field) > -1\"\r\n                        [class.f-icon-checkbox]=\"fields.indexOf(col.field) == -1\"\r\n                        (click)=\"onCheckboxClick($event, col)\"></span>\r\n                    {{ col.title}} \r\n\r\n                    <span class=\"f-icon f-icon-drag-vertical field-drag-handle\"></span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n\r\n    </div>\r\n    <div class=\"footer\">\r\n\r\n        <div class=\"buttons\">\r\n            <button class=\"btn btn-link advanced\" (click)=\"showAdvanced($event)\">{{ 'datagrid.settings.advancedMode' | locale: '\u9AD8\u7EA7\u6A21\u5F0F' }}</button>\r\n            <button class=\"btn btn-link reset\" (click)=\"onSettingReset($event)\">{{ 'datagrid.settings.reset' | locale: '\u6062\u590D\u9ED8\u8BA4' }}</button>\r\n            <button class=\"btn btn-secondary cancel\"\r\n                (click)=\"close($event)\">{{'datagrid.settings.cancel' | locale}}</button>\r\n            <button class=\"btn btn-primary ok\" #okbtn\r\n                (click)=\"onSubmitClick($event)\">{{'datagrid.settings.ok' | locale}}</button>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n",
                encapsulation: ViewEncapsulation.None,
                styles: [".f-datagrid-settings-simple{position:fixed;top:100px;right:-500px;z-index:10000;height:calc(100vh - 100px);width:468px;background:#fff;border:1px solid #e6e9f0;border-radius:10px 0 0 10px;transition:right .3s}.f-datagrid-settings-simple:focus{outline:0}.f-datagrid-settings-simple .header{height:50px;line-height:50px;border-bottom:1px solid #eaedf3;font-size:18px;color:#2d2f33}.f-datagrid-settings-simple .header .scheme-name{border-radius:6px;color:#2a87ff;background:#ebf4ff;height:28px;align-items:center}.f-datagrid-settings-simple .header .title{padding-left:21px;font-weight:700;align-items:center}.f-datagrid-settings-simple .header .closed{width:50px;text-align:center;cursor:pointer}.f-datagrid-settings-simple .content .count{font-size:14px;color:#2d2f33}.f-datagrid-settings-simple .content .tip{background:#f7faff;border-radius:6px;line-height:20px;margin-bottom:10px;min-height:42px;align-items:center;display:flex;padding:5px}.f-datagrid-settings-simple .content .checkall{margin-left:5px;font-size:14px;color:#0089ff;margin-right:5px}.f-datagrid-settings-simple .content{margin:20px 24px}.f-datagrid-settings-simple .footer{height:32px;margin:20px}.smooth-dnd-ghost.format-setting-column{z-index:999999999!important;padding:4px 8px;background-color:#e7f1ff;border:1px solid #2a87ff}.smooth-dnd-ghost.format-setting-column .field-drag-handle{float:right}.f-datagrid-settings-simple .smooth-dnd-drop-preview-constant-class{background-color:#dee1ea}.f-datagrid-settings-simple .format-setting-column{background:#fafbfd;padding:4px 8px;margin-bottom:5px;border:1px solid #f2f4f8;border-radius:5px;color:#000}.f-datagrid-settings-simple .format-setting-column.active{border:1px solid #2a87ff;background:#e7f1ff;border-top:1px solid #2a87ff!important;border-bottom:1px solid #2a87ff!important}.format-setting-column .checkbox{font-size:14px;color:#0089ff;margin-right:5px;cursor:pointer}.f-datagrid-settings-simple .format-setting-column .field-drag-handle{float:right;cursor:-webkit-grab;cursor:grab}.f-datagrid-settings-simple .format-setting-column .field-drag-handle:active{cursor:-webkit-grabbing;cursor:grabbing}.f-datagrid-settings-simple .list-group-flush:last-child .list-group-item:last-child{border-bottom:1px solid #f2f4f8}.f-datagrid-settings-simple .list-group-flush:first-child .list-group-item:first-child{border-top:1px solid #f2f4f8}.f-datagrid-settings-simple .buttons{text-align:right}.f-datagrid-settings-simple .buttons button{width:66px;height:32px}.f-datagrid-settings-simple .buttons .cancel{margin-left:12px;margin-right:8px}.f-datagrid-settings-simple .buttons .ok{width:100px}.f-datagrid-settings-simple .buttons .advanced{width:66px;height:32px;float:left}.f-datagrid-settings-simple-host{width:100%;height:100%;position:absolute;top:0;left:0;z-index:1000}.f-datagrid-settings-simple .visible-cols-count{font-size:18px;font-weight:500}.scheme-manager-dropdown{z-index:1000;position:absolute;top:50px;width:230px;border-radius:10px;background-color:#fff;border:1px solid #eaedf3;left:95px;box-shadow:0 2px 12px 0 #d8dce6}.scheme-manager-dropdown::before{content:\"\";position:absolute;border:10px solid #0000;bottom:100%;left:20px;border-bottom-color:#e3e3e3}.scheme-manager-dropdown::after{content:\"\";position:absolute;border:10px solid #0000;bottom:100%;left:20px;border-bottom-color:#fff;margin-bottom:-1px}.scheme-manager__button-add{align-items:center;justify-content:center}.scheme-manager__button-add>button{background:#fff;width:100%;height:32px;border:1px dashed #2a87ff40;border-radius:6px;cursor:pointer}.scheme-manager__button-add>button:focus{outline:0}.scheme-manager__button-add>button>span.f-icon{position:relative;top:2px}.scheme-manager__button-add>button:hover{background:#2a87ff;color:#fff}.scheme-manager__search-box{border-radius:5px}.scheme-manager__search-box .input-group-append{width:30px;background:0 0;color:#b4bccc;display:flex;align-items:center;justify-content:center}.scheme-manager__item{line-height:30px;padding:2px 10px;font-size:13px;border-radius:6px;cursor:pointer;align-items:center}.scheme-manager__item:hover{background-color:#f7f8fb}.scheme-manager__item.active{background:#cbe1ff;color:#1564cb}#only-visible-columns .switch-small{min-width:1.88rem;height:.85rem}#only-visible-columns .switch-small small{width:.775rem;height:.775rem;left:1px;top:0}#only-visible-columns .switch.switch-small.checked small{right:1px;left:auto}.f-datagrid-save-scheme .header{height:50px;align-items:center;cursor:move;border-bottom:0}.f-datagrid-save-scheme .header .title{font-size:17px;color:#2d2f33;font-weight:500;margin-left:20px}.f-datagrid_scheme-switch .switch-medium{min-width:1.88rem!important;height:.85rem!important}.scheme-manager__label{border-radius:4px;font-size:12px;height:18px;min-width:32px;align-items:end;line-height:16px;text-align:center}.scheme-manager__label.default{border:1px solid green;color:green;background:#f0f9f2}.scheme-manager__label.public{border:1px solid #4075fa;color:#4075fa;background:#ecf2ff}.scheme-manager__label.private{border:1px solid #d8dce6;color:#878d99;background:#f7f8fb}.scheme-manager__label.org{border:1px solid #f4883e;color:#e46700;background:#fff9eb}.scheme-org-tip{padding-left:5px;color:#878d99;font-size:12px}"]
            }] }
];
/** @nocollapse */
SimpleColumnsComponent.ctorParameters = () => [
    { type: Injector },
    { type: ChangeDetectorRef }
];
SimpleColumnsComponent.propDecorators = {
    enableScheme: [{ type: Input }],
    seartTypes: [{ type: Input }],
    columns: [{ type: Input }],
    fields: [{ type: Input }],
    clickToHidden: [{ type: Input }],
    top: [{ type: Input }],
    schemeList: [{ type: Input }],
    cls: [{ type: HostBinding, args: ['class',] }],
    container: [{ type: ViewChild, args: ['colcontainer',] }],
    btnOk: [{ type: ViewChild, args: ['okbtn',] }],
    searchInput: [{ type: ViewChild, args: ['inputWord',] }],
    schemeitemsEleRef: [{ type: ViewChild, args: ['schemeitems',] }],
    btnRef: [{ type: ViewChild, args: ['btnSchemeName',] }],
    formatChange: [{ type: Output }],
    fieldsChange: [{ type: Output }],
    submit: [{ type: Output }],
    closed: [{ type: Output }],
    advanced: [{ type: Output }],
    addNewScheme: [{ type: Output }],
    showSchemeList: [{ type: Output }],
    activeItemChange: [{ type: Output }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onEscKeydown: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }],
    onEnterKeydown: [{ type: HostListener, args: ['window:keydown.enter', ['$event'],] }],
    onControlGKeydown: [{ type: HostListener, args: ['keydown', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    SimpleColumnsComponent.prototype.enableScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.seartTypes;
    /**
     * 所有列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.columns;
    /**
     * 显示的列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.fields;
    /**
     * 点击侧边样式以外的区域隐藏面板。默认为 true
     * @type {?}
     */
    SimpleColumnsComponent.prototype.clickToHidden;
    /** @type {?} */
    SimpleColumnsComponent.prototype.top;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype._schemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cls;
    /** @type {?} */
    SimpleColumnsComponent.prototype.container;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnOk;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchInput;
    /** @type {?} */
    SimpleColumnsComponent.prototype.schemeitemsEleRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.formatChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.fieldsChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.submit;
    /** @type {?} */
    SimpleColumnsComponent.prototype.closed;
    /** @type {?} */
    SimpleColumnsComponent.prototype.advanced;
    /** @type {?} */
    SimpleColumnsComponent.prototype.addNewScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.activeItemChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.allCols;
    /** @type {?} */
    SimpleColumnsComponent.prototype.columnType;
    /** @type {?} */
    SimpleColumnsComponent.prototype.gridInstance;
    /** @type {?} */
    SimpleColumnsComponent.prototype.localeSer;
    /** @type {?} */
    SimpleColumnsComponent.prototype.isEn;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemePanel;
    /** @type {?} */
    SimpleColumnsComponent.prototype.switchValue;
    /** @type {?} */
    SimpleColumnsComponent.prototype.currentSchemeItem;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchResultIsVisibleAll;
    /** @type {?} */
    SimpleColumnsComponent.prototype.defaultSchemeName;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.messager;
    /** @type {?} */
    SimpleColumnsComponent.prototype.settings;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.injector;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLWNvbHVtbnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhZ3JpZC1zZXR0aW5ncy8iLCJzb3VyY2VzIjpbImxpYi9zaW1wbGUtbW9kZS9zaW1wbGUtY29sdW1ucy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUN6RSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUYsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUd0RCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQVUvRCxNQUFNLE9BQU8sc0JBQXNCOzs7OztJQStEL0IsWUFBb0IsUUFBa0IsRUFBUyxFQUFxQjtRQUFoRCxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQVMsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUE5RDNELGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBQ3JCLGVBQVUsR0FBUSxFQUFFLENBQUM7Ozs7UUFFckIsWUFBTyxHQUFHLEVBQUUsQ0FBQzs7OztRQUViLFdBQU0sR0FBRyxFQUFFLENBQUM7Ozs7UUFFWixrQkFBYSxHQUFHLElBQUksQ0FBQztRQUVyQixRQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ1QsZ0JBQVcsR0FBRyxFQUFFLENBQUM7UUFjSCxRQUFHLEdBQUcsaUNBQWlDLENBQUM7UUFTcEQsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2xDLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztR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QzVDLHdDQUFzQzs7SUFDdEMsd0NBQXNDOztJQUN0QywwQ0FBd0M7O0lBRXhDLDhDQUE0Qzs7SUFDNUMsZ0RBQThDOztJQUM5QyxrREFBZ0Q7O0lBQ2hELHlDQUFhOztJQUNiLDRDQUFtQjs7SUFFbkIsOENBQWdDOztJQUNoQywyQ0FBeUI7O0lBQ3pCLHNDQUFhOztJQUViLGlEQUF3Qjs7SUFFeEIsNkNBQW9COztJQUVwQixtREFBeUI7O0lBRXpCLDBEQUFpQzs7SUFDakMsbURBQTJCOzs7OztJQUUzQiwwQ0FBa0M7O0lBRWxDLDBDQUE0Qjs7Ozs7SUFFaEIsMENBQTBCOztJQUFFLG9DQUE0QiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLCBJbmplY3RvciwgSW5wdXQsIE9uSW5pdCxcclxuICAgICAgICBPdXRwdXQsIFZpZXdFbmNhcHN1bGF0aW9uLCBIb3N0TGlzdGVuZXIsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgU2V0dGluZ01vZGVsIH0gZnJvbSAnLi4vc2V0dGluZy5tb2RlbCc7XHJcbmltcG9ydCB7IGdldE11bHRpbGluZ3VhbFZhbHVlIH0gZnJvbSAnLi4vZ2V0VmFsdWVXaXRoTG9jYWxlSWQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLXNldHRpbmdzLXNpbXBsZScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc2ltcGxlLWNvbHVtbnMuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbXHJcbiAgICAgICAgYC4vc2V0dGluZ3Mtc2ltcGxlLnNjc3NgXHJcbiAgICBdLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2ltcGxlQ29sdW1uc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSBlbmFibGVTY2hlbWUgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIHNlYXJ0VHlwZXM6IGFueSA9IFtdO1xyXG4gICAgLyoqIOaJgOacieWIlyAqL1xyXG4gICAgQElucHV0KCkgY29sdW1ucyA9IFtdO1xyXG4gICAgLyoqIOaYvuekuueahOWIlyAqL1xyXG4gICAgQElucHV0KCkgZmllbGRzID0gW107XHJcbiAgICAvKiog54K55Ye75L6n6L655qC35byP5Lul5aSW55qE5Yy65Z+f6ZqQ6JeP6Z2i5p2/44CC6buY6K6k5Li6IHRydWUgKi9cclxuICAgIEBJbnB1dCgpIGNsaWNrVG9IaWRkZW4gPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpIHRvcCA9IDA7XHJcbiAgICBwcml2YXRlIF9zY2hlbWVMaXN0ID0gW107XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IHNjaGVtZUxpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtZUxpc3Q7XHJcbiAgICB9XHJcbiAgICBzZXQgc2NoZW1lTGlzdCh2YWwpIHtcclxuICAgICAgICBpZiAodmFsICYmIHZhbC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFsLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBuWydfdGl0bGVfJ10gPSBnZXRNdWx0aWxpbmd1YWxWYWx1ZShKU09OLnBhcnNlKG4ubmFtZSksIHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NjaGVtZUxpc3QgPSB2YWwgfHwgW107XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGNscyA9ICdmLWRhdGFncmlkLXNldHRpbmdzLXNpbXBsZS1ob3N0JztcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjb2xjb250YWluZXInKSBjb250YWluZXI6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdva2J0bicpIGJ0bk9rOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnaW5wdXRXb3JkJykgc2VhcmNoSW5wdXQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnc2NoZW1laXRlbXMnKSBzY2hlbWVpdGVtc0VsZVJlZjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2J0blNjaGVtZU5hbWUnKSBidG5SZWY6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgQE91dHB1dCgpIGZvcm1hdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBmaWVsZHNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgc3VibWl0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBhZHZhbmNlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCkgYWRkTmV3U2NoZW1lID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNob3dTY2hlbWVMaXN0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGFjdGl2ZUl0ZW1DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBhbGxDb2xzID0gW107XHJcbiAgICBjb2x1bW5UeXBlID0gJ2FsbCc7XHJcblxyXG4gICAgZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICAgIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZTtcclxuICAgIGlzRW4gPSBmYWxzZTtcclxuXHJcbiAgICBzaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgICBzd2l0Y2hWYWx1ZSA9IGZhbHNlO1xyXG4gICAgLy8g5b2T5YmN5pa55qGIXHJcbiAgICBjdXJyZW50U2NoZW1lSXRlbSA9IG51bGw7XHJcblxyXG4gICAgc2VhcmNoUmVzdWx0SXNWaXNpYmxlQWxsID0gZmFsc2U7XHJcbiAgICBkZWZhdWx0U2NoZW1lTmFtZSA9ICfns7vnu5/pooTliLYnO1xyXG5cclxuICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZTtcclxuXHJcbiAgICBzZXR0aW5nczogU2V0dGluZ01vZGVsID0ge307XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsIHB1YmxpYyBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXIgPSB0aGlzLmluamVjdG9yLmdldChNZXNzYWdlclNlcnZpY2UsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ2xpY2soJGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJGV2ZW50KTtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgY29uc3QgY2xzbmFtZSA9ICRldmVudC50YXJnZXRbJ2NsYXNzTmFtZSddIHx8ICcnO1xyXG4gICAgICAgIGlmIChjbHNuYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtc2V0dGluZ3Mtc2ltcGxlLWhvc3QnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIC8vIOmakOiXj+S+p+i+ueagj++8m1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jbGlja1RvSGlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignd2luZG93OmtleWRvd24uZXNjJywgWyckZXZlbnQnXSlcclxuICAgIG9uRXNjS2V5ZG93bigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtb2RhbC1jb250YWluZXInKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlkb3duLmVudGVyJywgWyckZXZlbnQnXSlcclxuICAgIG9uRW50ZXJLZXlkb3duKCRldmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21vZGFsLWNvbnRhaW5lcicpKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXRDbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ29udHJvbEdLZXlkb3duKCRldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQuY3RybEtleSAmJiAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbW9kYWwtY29udGFpbmVyJykpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKCRldmVudC5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ2cnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dBZHZhbmNlZCgkZXZlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRldmVudC5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uU2V0dGluZ1Jlc2V0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJGV2ZW50LmtleS50b0xvd2VyQ2FzZSgpID09PSAncycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q3VycmVudFNjaGVtZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjaGVtZVNldHRpbmdzID0gSlNPTi5wYXJzZSh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKTtcclxuICAgICAgICAgICAgcmV0dXJuIHNjaGVtZVNldHRpbmdzW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSBhcyBTZXR0aW5nTW9kZWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmFsbENvbHMgPSB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICAgICAgaWYgKHRoaXMuZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZSAmJiB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLmdldEN1cnJlbnRTY2hlbWVTZXR0aW5ncygpIHx8IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MgJiYgdGhpcy5zZXR0aW5ncy52aWV3Q29sdW1ucyAmJiB0aGlzLnNldHRpbmdzLnZpZXdDb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuc2V0dGluZ3Mudmlld0NvbHVtbnM7XHJcbiAgICAgICAgICAgIHRoaXMuZGlydHlTZXR0aW5ncyh0cnVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuZ2V0Vmlld0NvbHVtbnMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0U2NoZW1lTmFtZSA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5zY2hlbWUuc3lzcHJlc2V0JykgfHwgdGhpcy5ncmlkSW5zdGFuY2UuZGVmYXVsdFNjaGVtZU5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRWaWV3Q29sdW1ucygpIHtcclxuICAgICAgICAvLyDlpJrooajlpLRcclxuICAgICAgICBsZXQgdmlzaWJsZUNscyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbHVtbnMubGVuZ3RoID4gMSApIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goY29scyA9PiB7XHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlQ2xzID0gdmlzaWJsZUNscy5jb25jYXQodGhpcy5fZ2V0Vmlld0NvbHVtbnMoY29scykpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2aXNpYmxlQ2xzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IChuLnZpc2libGUgfHwgbi52aXNpYmxlID09PSB1bmRlZmluZWQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB2aXNpYmxlQ2xzLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2dldFZpZXdDb2x1bW5zKGNvbHM6IGFueVtdKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbHMuZmlsdGVyKGMgPT4gIWMuY29sc3BhbiAmJiAoYy52aXNpYmxlIHx8IGMudmlzaWJsZSA9PT0gdW5kZWZpbmVkKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOagueaNruWIl+eahOexu+Wei+i/m+ihjOetm+mAiei/h+a7pO+8jFxyXG4gICAgLy8gYWxsIOaJgOacieWIl1xyXG4gICAgLy8gdmlzaWJsZSDlj6/op4HliJdcclxuICAgIC8vIGhpZGRlbiDpmpDol4/liJdcclxuICAgIC8vIGdyb3VwIOWIhue7hOWIl1xyXG4gICAgZmlsdGVyQ29sdW1ucyhzZWFyY2hXb3JkcyA9ICcnKSB7XHJcbiAgICAgICAgbGV0IGNvbHMgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3dpdGNoVmFsdWUpIHtcclxuICAgICAgICAgICAgY29scyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiB0aGlzLmZpZWxkcy5pbmRleE9mKG4uZmllbGQpID4gLTEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2VhcmNoV29yZHMpIHtcclxuICAgICAgICAgICAgY29scyA9IGNvbHMuZmlsdGVyKGMgPT4gYy50aXRsZS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoV29yZHMudG9Mb3dlckNhc2UoKSkgPiAtMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFsbENvbHMgPSBjb2xzO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBvbkZpZWxkc0NoYW5nZWQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmdyaWRJbnN0YW5jZS5lbmFibGVTY2hlbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHNDaGFuZ2UuZW1pdCh0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25EYmxDbGljaygkZXZlbnQsIGNvbCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCfmmL7npLrkuI7pmpDol4/liIfmjaLkuovku7YnLCBjb2wpO1xyXG4gICAgICAgIHRoaXMub25DaGVja2JveENsaWNrKCRldmVudCwgY29sKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrYm94Q2xpY2soJGV2ZW50LCBjb2wpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygn5pi+56S65LiO6ZqQ6JeP5YiH5o2i5LqL5Lu2JywgY29sKTtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBsZXQgY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maWVsZHMuaW5kZXhPZihjb2wuZmllbGQpO1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHMucHVzaChjb2wuZmllbGQpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5jb2x1bW5zWzBdLmZpbmQobiA9PiBuLmZpZWxkID09PSBjb2wuZmllbGQpO1xyXG4gICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGl0ZW0udmlzaWJsZSA9IGNoZWNrZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMuY29sdW1uc1swXS5mb3JFYWNoKGYgPT4ge1xyXG4gICAgICAgIC8vICAgICBmLnZpc2libGUgPSB0aGlzLmZpZWxkcy5pbmRleE9mKGYuZmllbGQpID4gLTE7XHJcbiAgICAgICAgLy8gfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VhcmNoUmVzdWx0SXNWaXNpYmxlQWxsID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4udmlzaWJsZSkubGVuZ3RoID09PSB0aGlzLmFsbENvbHMubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hDb2x1bW4oJGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgdHh0ID0gJGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnModHh0KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkZpZWxkRHJvcChmaWVsZEluZm8sIHR4dCwgdWxFbFJlZjogYW55KSB7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgIC8vIGNvbnNvbGUubG9nKCdkcm9wJywgZmllbGRJbmZvKTtcclxuICAgICAgICBjb25zdCB7IHJlbW92ZWRJbmRleCwgYWRkZWRJbmRleCB9ID0gZmllbGRJbmZvO1xyXG5cclxuICAgICAgICBjb25zdCBtb3ZlSXRlbSA9IHRoaXMuYWxsQ29sc1tyZW1vdmVkSW5kZXhdO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEl0ZW0gPSB0aGlzLmFsbENvbHNbYWRkZWRJbmRleF07XHJcblxyXG4gICAgICAgIGNvbnN0IG1vdmVJdGVtSW5kZXggPSB0aGlzLmNvbHVtbnNbMF0uZmluZEluZGV4KG4gPT4gbi5maWVsZCA9PT0gbW92ZUl0ZW0uZmllbGQpO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEl0ZW1JbmRleCA9IHRoaXMuY29sdW1uc1swXS5maW5kSW5kZXgobiA9PiBuLmZpZWxkID09PSB0YXJnZXRJdGVtLmZpZWxkKTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVtb3ZlZEl0ZW0gPSB0aGlzLmNvbHVtbnNbMF0uc3BsaWNlKG1vdmVJdGVtSW5kZXgsIDEpO1xyXG4gICAgICAgIHRoaXMuY29sdW1uc1swXS5zcGxpY2UodGFyZ2V0SXRlbUluZGV4LCAwLCAuLi5yZW1vdmVkSXRlbSk7XHJcblxyXG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAwOiAx5Liq5Lmf5rKh5pyJ6YCJ5Lit77ybIDE6IOWFqOmDqOmAieS4re+8myAyOiDmnInpgInkuK3nmoTkuZ/mnInmsqHpgInkuK3nmoRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRDaGVja0FsbFN0YXRlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5zZWFyY2hJbnB1dC5uYXRpdmVFbGVtZW50LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmllbGRzLmxlbmd0aCA9PT0gdGhpcy5jb2x1bW5zWzBdLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aXNpYmxlTGVuID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4udmlzaWJsZSkubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA9PT0gdGhpcy5hbGxDb2xzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA8IHRoaXMuYWxsQ29scy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlhajpgIlcclxuICAgIG9uQ2hlY2tBbGxDbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQsIHR4dCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5nZXRDaGVja0FsbFN0YXRlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2tBbGwgPSBzdGF0ZSA9PT0gMCB8fCBzdGF0ZSA9PT0gMjtcclxuXHJcbiAgICAgICAgaWYgKCF0eHQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiBuLnZpc2libGUgPSBpc0NoZWNrQWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5hbGxDb2xzLmZpbmQoYSA9PiBuLmZpZWxkID09IGEuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnZpc2libGUgPSBpc0NoZWNrQWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udmlzaWJsZSA9IGlzQ2hlY2tBbGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc1Zpc2libGVBbGwgPSB0aGlzLmFsbENvbHMuZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5sZW5ndGggPT09IHRoaXMuYWxsQ29scy5sZW5ndGg7XHJcblxyXG4gICAgICAgIHRoaXMuZGlydHlTZXR0aW5ncyh0cnVlKTtcclxuXHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnModHh0KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgkZXZlbnQ/OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2xvc2VkLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmiZPlvIDpq5jnuqforr7nva7nqpflj6NcclxuICAgIHNob3dBZHZhbmNlZCgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCRldmVudCk7XHJcbiAgICAgICAgdGhpcy5hZHZhbmNlZC5lbWl0KHsgdmlld0ZpZWxkczogdGhpcy5maWVsZHMgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5oGi5aSN6buY6K6kXHJcbiAgICBvblNldHRpbmdSZXNldCgkZXZlbnQ/OiBhbnkpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgcmVzdG9yRGVmYXVsdFRleHQgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3MucmVzdG9yZURlZmF1bHRTZXR0aW5nc1RleHQnKSB8fCAn56Gu6K6k6KaB5oGi5aSN6buY6K6k6K6+572u5ZCX77yfJztcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyLmNvbmZpcm0ocmVzdG9yRGVmYXVsdFRleHQpLnN1YnNjcmliZSgodDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldDJEZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlc2V0MkRlZmF1bHQoKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZ3JpZEluc3RhbmNlLmRmc1snX3N0YXRlJ10uaW5pdGlhbE9wdGlvbnM7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuY29sdW1uRmllbGRzICYmIG9wdGlvbnMuY29sdW1uRmllbGRzLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbmV3Q29sdW1ucyA9IFtdO1xyXG4gICAgICAgICAgICBvcHRpb25zLmNvbHVtbkZpZWxkcy5mb3JFYWNoKGMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGMuZmllbGQgIT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2wgPSB0aGlzLmdyaWRJbnN0YW5jZS5jb2x1bW5zWzBdLmZpbmQoKG46IGFueSkgPT4gbi5maWVsZCA9PT0gYy5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wudmlzaWJsZSA9IGMudmlzaWJsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmhhbGlnbiA9IGMuaGFsaWduO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuYWxpZ24gPSBjLmFsaWduO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wud2lkdGggPSBjLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuZm9vdGVyID0gey4uLmMuZm9vdGVyIHx8IHt9fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmdyb3VwRm9vdGVyID0gey4uLmMuZ3JvdXBGb290ZXIgfHwge319O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2x1bW5zLnB1c2goY29sKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gW25ld0NvbHVtbnNdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hbGxDb2xzID0gdGhpcy5jb2x1bW5zWzBdO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB7fTtcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuZ2V0Vmlld0NvbHVtbnMoKTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLnZpZXdDb2x1bW5zID0gdGhpcy5maWVsZHM7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5jb2x1bW5Gb3JtYXQgPSBbLi4udGhpcy5jb2x1bW5zWzBdXTtcclxuICAgICAgICBpZiAob3B0aW9ucy5zb3J0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNvcnRPcmRlcnMgPSBvcHRpb25zLnNvcnQuc29ydE9yZGVyPyBvcHRpb25zLnNvcnQuc29ydE9yZGVyLnNwbGl0KCcsJykgOiBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29ydE5hbWVzID0gb3B0aW9ucy5zb3J0LnNvcnROYW1lID8gb3B0aW9ucy5zb3J0LnNvcnROYW1lLnNwbGl0KCcsJykgOiBbXTtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zb3J0SW5mbyA9IHsgc29ydE5hbWU6IHNvcnROYW1lcywgc29ydE9yZGVyOiAgc29ydE9yZGVycyB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc29ydEluZm8gPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5ncm91cEZpZWxkID0gIG9wdGlvbnMuZ3JvdXBGaWVsZCA/IG9wdGlvbnMuZ3JvdXBGaWVsZC5zcGxpdCgnLCcpIDogW107XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56Gu5a6a5oyJ6ZKu54K55Ye75LqL5Lu2XHJcbiAgICBvblN1Ym1pdENsaWNrKCRldmVudD86IGFueSkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3Mudmlld0NvbHVtbnMgPSB0aGlzLmZpZWxkcztcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVNjaGVtZSB8fCAhdGhpcy5jdXJyZW50U2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuY29sdW1uRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNvbHVtbkZvcm1hdCA9IFsuLi50aGlzLmNvbHVtbnNbMF1dO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3Muc29ydEluZm8pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc29ydEluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE5hbWU6IHRoaXMuZ3JpZEluc3RhbmNlLnNvcnROYW1lID8gdGhpcy5ncmlkSW5zdGFuY2Uuc29ydE5hbWUuc3BsaXQoJywnKSA6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNvcnRPcmRlcjogIHRoaXMuZ3JpZEluc3RhbmNlLnNvcnRPcmRlciA/IHRoaXMuZ3JpZEluc3RhbmNlLnNvcnRPcmRlci5zcGxpdCgnLCcpIDogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdyb3VwRmllbGQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5ncm91cEZpZWxkID0gdGhpcy5ncmlkSW5zdGFuY2UuZ3JvdXBGaWVsZCA/IHRoaXMuZ3JpZEluc3RhbmNlLmdyb3VwRmllbGQuc3BsaXQoJywnKSA6IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgX3NldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50U2NoZW1lU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgaWYgKF9zZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oX3NldHRpbmdzIHx8IHt9LCB0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmFjdGl2ZUl0ZW1DaGFuZ2UuZW1pdCh0aGlzLmFjdGl2ZVNjaGVtZUl0ZW0pO1xyXG4gICAgICAgIHRoaXMuc3VibWl0LmVtaXQoe2NvbnRlbnQ6IHRoaXMuc2V0dGluZ3MsIGNsb3NlOiB0aGlzLmNsb3NlLmJpbmQodGhpcyksIHRhcmdldDogdGhpcy5idG5Pay5uYXRpdmVFbGVtZW50LCBjdXJyZW50U2NoZW1lOiB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5pi+56S65LiL5ouJ5pa55qGI5YiX6KGoXHJcbiAgICBvbkNob29zZVNjaGVtZSgkZXZlbnQpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gIXRoaXMuc2hvd1NjaGVtZVBhbmVsO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NoZW1laXRlbXNFbGVSZWYgJiYgdGhpcy5jdXJyZW50U2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbUVsID0gdGhpcy5zY2hlbWVpdGVtc0VsZVJlZi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNzY2hlbWVpdGVtXyR7dGhpcy5jdXJyZW50U2NoZW1lSXRlbS5pZH1gKTtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtRWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbUVsLnNjcm9sbEludG9WaWV3SWZOZWVkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUVsLnNjcm9sbEludG9WaWV3SWZOZWVkZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtRWwuc2Nyb2xsSW50b1ZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOS7heaYvuekuuWPr+ingeWIl1xyXG4gICAgb25seVNlZVZpc2libGVDb2x1bW5zKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuc3dpdGNoVmFsdWUgPSAkZXZlbnQ7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5paw5aKe5pa55qGIXHJcbiAgICBvbk5ld1NjaGVtZUNsaWNrKCRldmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWRkTmV3U2NoZW1lLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrmlrnmoYjliJfooajnrqHnkIbnqpflj6NcclxuICAgIG9uU2hvd1NjaGVtZUxpc3QoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lTGlzdC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5pa55qGI54K55Ye7XHJcbiAgICBvblNjaGVtZUl0ZW1DbGljaygkZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2NoZW1lSXRlbSA9IGl0ZW07XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2NoZW1lU2V0dGluZ3MgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgc2NoZW1lU2V0dGluZ3MgPSBKU09OLnBhcnNlKGl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgc2NoZW1lU2V0dGluZ3MgPSBzY2hlbWVTZXR0aW5nc1t0aGlzLmxvY2FsZVNlci5sb2NhbGVJZF07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFzY2hlbWVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQyRGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzID0gc2NoZW1lU2V0dGluZ3M7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZHMgPSBzY2hlbWVTZXR0aW5ncy52aWV3Q29sdW1uczsgICBcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0MkRlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZGlydHlTZXR0aW5ncyhmbGFnKSB7XHJcbiAgICAgICAgLy8gdGhpcy5pc0NoYW5nZWQgPSBmbGFnO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==