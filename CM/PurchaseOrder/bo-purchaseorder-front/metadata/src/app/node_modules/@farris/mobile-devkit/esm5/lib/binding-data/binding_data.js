// tslint:disable: max-line-length member-ordering
/**
 * 绑定数据相关定义
 * @author Witt<jiwt@inspur.com>
 * @todo
 * 1、全局的BindingData和局部的BindingData应该拆成两个类，两个类之间是装饰关系；；
 * 2、为了保持兼容，减少改动量，暂时放在一起，待进一步重构。
 */
import { ChangeType } from './changes';
import { BindingList } from './binding_list';
import { BindingListFactory } from './binding_list_factory';
import { PropertyUtil } from './property_util';
import { EntityUtil } from './entity_util';
/**
 * BindingData
 */
var BindingData = /** @class */ (function () {
    function BindingData() {
        this.paginationInfo = null;
    }
    Object.defineProperty(BindingData.prototype, "bindingPath", {
        /**
         * 绑定该路径
         */
        get: function () {
            if (this.viewModelContext && this.viewModelContext.viewModel.bindingPath) {
                return this.viewModelContext.viewModel.bindingPath;
            }
            return '/';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BindingData.prototype, "pagingInfo", {
        get: function () {
            return this.paginationInfo;
        },
        set: function (pagingInfo) {
            this.paginationInfo = pagingInfo;
            this.firePagingChangeEvent();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 设置分页信息
     * @param skip 跳过
     * @param take 获取
     * @param bindingPath 路径
     */
    BindingData.prototype.setPagingInfo = function (skip, take, bindingPath) {
        if (bindingPath.length < 1 || bindingPath === '/') {
            this.paginationInfo = Object.assign(this.paginationInfo, { pageSize: take, pageIndex: skip / take + 1 });
        }
        else {
            var pagingInfo_1 = this.paginationInfo || {};
            var bindingPaths = bindingPath.substr(1).split('/').filter(function (item) { return !!item && item.length > 0; }).map(function (item) { return item.substring(0, item.length - 1); });
            bindingPaths.forEach(function (path) {
                if (!pagingInfo_1.hasOwnProperty(path)) {
                    pagingInfo_1[path] = {};
                }
                pagingInfo_1 = pagingInfo_1[path];
            });
            pagingInfo_1.pageIndex = ((skip / take) || 0) + 1;
            pagingInfo_1.pageSize = take || 0;
        }
        this.firePagingChangeEvent();
    };
    BindingData.prototype.firePagingChangeEvent = function () {
        this.list.changes.next({
            type: ChangeType.PaginationInfoChange,
            path: [],
            value: this.paginationInfo
        });
    };
    Object.defineProperty(BindingData.prototype, "changes", {
        /**
         * 变更集
         */
        get: function () {
            return this.list.changes;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 设置值变化执行器工厂
     * @param value 值变化执行器工厂
     */
    BindingData.prototype.setValueChangeInvokerFactory = function (value) {
        this.valueChangeInvokerFactory = value;
    };
    /**
     * 初始化（已废弃）
     */
    BindingData.prototype.init = function (repository, bindingPath) {
        this.initByRepository(repository, null);
    };
    /**
     * 根据Repository对BindingData进行初始化
     */
    BindingData.prototype.initByRepository = function (repository, viewModelContext) {
        this.viewModelContext = viewModelContext;
        this.properties = PropertyUtil.getProperties(repository.entityType);
        this.list = BindingListFactory.create(this.properties);
        // 从repository初始化bindingData
        this.pagingInfo = repository.entityCollection.paginationInfo;
        // @todo
        // BindingData不应该知道Repository，加载数据、建立关联关系的过程应该转移到外边
        EntityUtil.loadRepository(repository, this.list);
        this.dataTypeInfo = repository.entityTypeInfo;
        this.extendProperties(this.properties);
    };
    /**
     * 初始化
     */
    BindingData.prototype.initByBindingList = function (bindingList, viewModelContext) {
        this.list = bindingList;
        this.viewModelContext = viewModelContext;
        this.extendProperties(this.list.properties);
    };
    /**
     * 获取paths对应的属性值
     * @param  paths 属性路径数组
     * @returns 属性值
     */
    BindingData.prototype.getValue = function (paths) {
        var target = this.list;
        paths.forEach(function (path) {
            if (target) {
                target = target[path];
            }
        });
        return target;
    };
    /**
     * 根据paths设置属性值
     * @param paths 属性路径数组
     * @param value 属性值
     * @param emitEventToView 如果设置为true，则发送事件通知订阅它的组件、指令去更新界面，默认为false。
     * @param emitEventToEntity 如果设置为true，则同步去更新Entity上对应的字段，默认为true。
     */
    BindingData.prototype.setValue = function (paths, value, emitEventToView, emitEventToEntity) {
        if (emitEventToView === void 0) { emitEventToView = false; }
        if (emitEventToEntity === void 0) { emitEventToEntity = true; }
        if (!paths || paths.length === 0) {
            throw Error('路径不能为空');
        }
        var parentPaths = paths.slice(0, paths.length - 1);
        var propName = paths[paths.length - 1];
        var parent = this.getValue(parentPaths);
        if (!parent) {
            throw Error('找不到要设置的对象');
        }
        if (parent instanceof BindingData) {
            parent = parent.list.currentItem;
        }
        else if (parent instanceof BindingList) {
            parent = parent.currentItem;
        }
        if (!!this.valueChangeInvokerFactory) {
            parent.setValue(propName, value, emitEventToView, emitEventToEntity, null, this.valueChangeInvokerFactory(paths));
        }
        else {
            parent.setValue(propName, value, emitEventToView, emitEventToEntity);
        }
    };
    /**
     * 根据paths清空属性值
     */
    BindingData.prototype.clearValue = function (paths, emitEventToView, emitEventToEntity) {
        if (emitEventToView === void 0) { emitEventToView = false; }
        if (emitEventToEntity === void 0) { emitEventToEntity = true; }
        var initValue;
        var propInfo = this.dataTypeInfo.getPropInfoByPath(paths);
        if (propInfo && propInfo.metadataInfo && propInfo.metadataInfo.initValue !== undefined) {
            initValue = propInfo.metadataInfo.initValue;
        }
        else {
            // 原来的帮助映射中，强行纠正了数值的情况，保持一致
            var oldValue = this.getValue(paths);
            if (typeof oldValue === 'number') {
                initValue = 0;
            }
            else {
                initValue = '';
            }
        }
        this.setValue(paths, initValue, emitEventToView, emitEventToEntity);
    };
    /**
     * 获取当前列表
     */
    BindingData.prototype.getList = function () {
        if (!this.bindingPath || this.bindingPath === '/') {
            return this.list;
        }
        var bindingPath = this.bindingPath.substr(1);
        var bindingPathArray = bindingPath.split('/').filter(function (part) {
            return part !== '';
        });
        return this.getValue(bindingPathArray);
    };
    /**
     * 获取当前对象
     */
    BindingData.prototype.getObject = function () {
        var bindingList = this.getList();
        return bindingList.currentItem;
    };
    /**
     * 扩展BindingData属性，映射BindingData所持有的绑定列表当前行的属性，减少绑定层级。
     * @param properties 关联实体的属性集合
     */
    BindingData.prototype.extendProperties = function (properties) {
        var _this = this;
        properties.forEach(function (property) {
            var propName = property.name;
            Object.defineProperty(_this, propName, {
                get: function () {
                    return _this.list.currentItem[propName];
                },
                set: function (value) {
                    _this.list.currentItem[propName] = value;
                }
            });
        });
    };
    return BindingData;
}());
export { BindingData };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZ19kYXRhLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2JpbmRpbmctZGF0YS9iaW5kaW5nX2RhdGEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsa0RBQWtEO0FBQ2xEOzs7Ozs7R0FNRztBQU9ILE9BQU8sRUFBVSxVQUFVLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFL0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSTNDOztHQUVHO0FBRUg7SUFBQTtRQTRCVSxtQkFBYyxHQUFHLElBQUksQ0FBQztJQTJNaEMsQ0FBQztJQTNOQyxzQkFBVyxvQ0FBVztRQUh0Qjs7V0FFRzthQUNIO1lBQ0UsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUU7Z0JBQ3hFLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUM7YUFDcEQ7WUFDRCxPQUFPLEdBQUcsQ0FBQztRQUNiLENBQUM7OztPQUFBO0lBYUQsc0JBQVcsbUNBQVU7YUFLckI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUM7UUFDN0IsQ0FBQzthQVBELFVBQXNCLFVBQWU7WUFDbkMsSUFBSSxDQUFDLGNBQWMsR0FBRyxVQUFVLENBQUM7WUFDakMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFDL0IsQ0FBQzs7O09BQUE7SUFLRDs7Ozs7T0FLRztJQUNJLG1DQUFhLEdBQXBCLFVBQXFCLElBQVksRUFBRSxJQUFZLEVBQUUsV0FBbUI7UUFDbEUsSUFBSSxX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LFFBQVEsRUFBRTtnQkFDcEMsR0FBRyxFQUFFO29CQUNILE9BQU8sS0FBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQ3pDLENBQUM7Z0JBQ0QsR0FBRyxFQUFFLFVBQUMsS0FBVTtvQkFDZCxLQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsR0FBRyxLQUFLLENBQUM7Z0JBQzFDLENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDSCxrQkFBQztBQUFELENBQUMsQUF2T0QsSUF1T0M7QUFFRCxPQUFPLEVBQUUsV0FBVyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0c2xpbnQ6ZGlzYWJsZTogbWF4LWxpbmUtbGVuZ3RoIG1lbWJlci1vcmRlcmluZ1xyXG4vKipcclxuICog57uR5a6a5pWw5o2u55u45YWz5a6a5LmJXHJcbiAqIEBhdXRob3IgV2l0dDxqaXd0QGluc3B1ci5jb20+XHJcbiAqIEB0b2RvXHJcbiAqIDHjgIHlhajlsYDnmoRCaW5kaW5nRGF0YeWSjOWxgOmDqOeahEJpbmRpbmdEYXRh5bqU6K+l5ouG5oiQ5Lik5Liq57G777yM5Lik5Liq57G75LmL6Ze05piv6KOF6aWw5YWz57O777yb77ybXHJcbiAqIDLjgIHkuLrkuobkv53mjIHlhbzlrrnvvIzlh4/lsJHmlLnliqjph4/vvIzmmoLml7bmlL7lnKjkuIDotbfvvIzlvoXov5vkuIDmraXph43mnoTjgIJcclxuICovXHJcblxyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBEYXRhVHlwZUluZm8gfSBmcm9tICcuLi9lbnRpdHkvZW50aXR5LXR5cGUtaW5mby9pbmRleCc7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3J5L2luZGV4JztcclxuaW1wb3J0IHsgVmlld01vZGVsQ29udGV4dCB9IGZyb20gJy4uL3ZpZXctbW9kZWwvaW5kZXgnO1xyXG5pbXBvcnQgeyBDaGFuZ2UsIENoYW5nZVR5cGUgfSBmcm9tICcuL2NoYW5nZXMnO1xyXG5pbXBvcnQgeyBCaW5kaW5nUHJvcGVydHkgfSBmcm9tICcuL2JpbmRpbmdfcHJvcGVydHknO1xyXG5pbXBvcnQgeyBCaW5kaW5nTGlzdCB9IGZyb20gJy4vYmluZGluZ19saXN0JztcclxuaW1wb3J0IHsgQmluZGluZ0xpc3RGYWN0b3J5IH0gZnJvbSAnLi9iaW5kaW5nX2xpc3RfZmFjdG9yeSc7XHJcbmltcG9ydCB7IFByb3BlcnR5VXRpbCB9IGZyb20gJy4vcHJvcGVydHlfdXRpbCc7XHJcbmltcG9ydCB7IEVudGl0eVV0aWwgfSBmcm9tICcuL2VudGl0eV91dGlsJztcclxuaW1wb3J0IHsgSW52b2tlT25WYWx1ZUNoYW5nZSB9IGZyb20gJy4vYmluZGluZ19vYmplY3QnO1xyXG5pbXBvcnQgeyBudWxsU2FmZUlzRXF1aXZhbGVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbXBpbGVyL3NyYy9vdXRwdXQvb3V0cHV0X2FzdCc7XHJcblxyXG4vKipcclxuICogQmluZGluZ0RhdGFcclxuICovXHJcblxyXG5jbGFzcyBCaW5kaW5nRGF0YSB7XHJcblxyXG4gIHByaXZhdGUgdmlld01vZGVsQ29udGV4dDogVmlld01vZGVsQ29udGV4dDtcclxuXHJcbiAgLyoqXHJcbiAgICog5pWw5o2u57G75Z6L5o+P6L+wXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkYXRhVHlwZUluZm86IERhdGFUeXBlSW5mbztcclxuXHJcbiAgLyoqXHJcbiAgICog57uR5a6a6K+l6Lev5b6EXHJcbiAgICovXHJcbiAgcHVibGljIGdldCBiaW5kaW5nUGF0aCgpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRoaXMudmlld01vZGVsQ29udGV4dCAmJiB0aGlzLnZpZXdNb2RlbENvbnRleHQudmlld01vZGVsLmJpbmRpbmdQYXRoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnZpZXdNb2RlbENvbnRleHQudmlld01vZGVsLmJpbmRpbmdQYXRoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcvJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPr+e7keWumueahOWxnuaAp+aPj+i/sFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwcm9wZXJ0aWVzOiBCaW5kaW5nUHJvcGVydHlbXTtcclxuXHJcbiAgLyoqXHJcbiAgICog5pWw5o2u5YiX6KGoXHJcbiAgICovXHJcbiAgcHVibGljIGxpc3Q6IEJpbmRpbmdMaXN0O1xyXG4gIHByaXZhdGUgcGFnaW5hdGlvbkluZm8gPSBudWxsO1xyXG5cclxuICBwdWJsaWMgc2V0IHBhZ2luZ0luZm8ocGFnaW5nSW5mbzogYW55KSB7XHJcbiAgICB0aGlzLnBhZ2luYXRpb25JbmZvID0gcGFnaW5nSW5mbztcclxuICAgIHRoaXMuZmlyZVBhZ2luZ0NoYW5nZUV2ZW50KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHBhZ2luZ0luZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYWdpbmF0aW9uSW5mbztcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6K6+572u5YiG6aG15L+h5oGvXHJcbiAgICogQHBhcmFtIHNraXAg6Lez6L+HXHJcbiAgICogQHBhcmFtIHRha2Ug6I635Y+WXHJcbiAgICogQHBhcmFtIGJpbmRpbmdQYXRoIOi3r+W+hFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRQYWdpbmdJbmZvKHNraXA6IG51bWJlciwgdGFrZTogbnVtYmVyLCBiaW5kaW5nUGF0aDogc3RyaW5nKSB7XHJcbiAgICBpZiAoYmluZGluZ1BhdGgubGVuZ3RoIDwgMSB8fCBiaW5kaW5nUGF0aCA9PT0gJy8nKSB7XHJcbiAgICAgIHRoaXMucGFnaW5hdGlvbkluZm8gPSBPYmplY3QuYXNzaWduKHRoaXMucGFnaW5hdGlvbkluZm8sIHsgcGFnZVNpemU6IHRha2UsIHBhZ2VJbmRleDogc2tpcCAvIHRha2UgKyAxIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IHBhZ2luZ0luZm8gPSB0aGlzLnBhZ2luYXRpb25JbmZvIHx8IHt9O1xyXG4gICAgICBjb25zdCBiaW5kaW5nUGF0aHMgPSBiaW5kaW5nUGF0aC5zdWJzdHIoMSkuc3BsaXQoJy8nKS5maWx0ZXIoaXRlbSA9PiAhIWl0ZW0gJiYgaXRlbS5sZW5ndGggPiAwKS5tYXAoaXRlbSA9PiBpdGVtLnN1YnN0cmluZygwLCBpdGVtLmxlbmd0aCAtIDEpKTtcclxuICAgICAgYmluZGluZ1BhdGhzLmZvckVhY2gocGF0aCA9PiB7XHJcbiAgICAgICAgaWYgKCFwYWdpbmdJbmZvLmhhc093blByb3BlcnR5KHBhdGgpKSB7XHJcbiAgICAgICAgICBwYWdpbmdJbmZvW3BhdGhdID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhZ2luZ0luZm8gPSBwYWdpbmdJbmZvW3BhdGhdO1xyXG4gICAgICB9KTtcclxuICAgICAgcGFnaW5nSW5mby5wYWdlSW5kZXggPSAoKHNraXAgLyB0YWtlKSB8fCAwKSArIDE7XHJcbiAgICAgIHBhZ2luZ0luZm8ucGFnZVNpemUgPSB0YWtlIHx8IDA7XHJcbiAgICB9XHJcbiAgICB0aGlzLmZpcmVQYWdpbmdDaGFuZ2VFdmVudCgpO1xyXG4gIH1cclxuICBwcml2YXRlIGZpcmVQYWdpbmdDaGFuZ2VFdmVudCgpIHtcclxuICAgIHRoaXMubGlzdC5jaGFuZ2VzLm5leHQoe1xyXG4gICAgICB0eXBlOiBDaGFuZ2VUeXBlLlBhZ2luYXRpb25JbmZvQ2hhbmdlLFxyXG4gICAgICBwYXRoOiBbXSxcclxuICAgICAgdmFsdWU6IHRoaXMucGFnaW5hdGlvbkluZm9cclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDlj5jmm7Tpm4ZcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IGNoYW5nZXMoKTogU3ViamVjdDxDaGFuZ2U+IHtcclxuICAgIHJldHVybiB0aGlzLmxpc3QuY2hhbmdlcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWAvOWPmOWMluaJp+ihjOWZqOW3peWOgu+8jOagueaNrui3r+W+hOS6p+eUn+aJp+ihjOWZqFxyXG4gICAqL1xyXG4gIHByaXZhdGUgdmFsdWVDaGFuZ2VJbnZva2VyRmFjdG9yeTogKHBhdGhzOiBzdHJpbmdbXSkgPT4gSW52b2tlT25WYWx1ZUNoYW5nZTtcclxuXHJcbiAgLyoqXHJcbiAgICog6K6+572u5YC85Y+Y5YyW5omn6KGM5Zmo5bel5Y6CXHJcbiAgICogQHBhcmFtIHZhbHVlIOWAvOWPmOWMluaJp+ihjOWZqOW3peWOglxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRWYWx1ZUNoYW5nZUludm9rZXJGYWN0b3J5KHZhbHVlOiAocGF0aHM6IHN0cmluZ1tdKSA9PiBJbnZva2VPblZhbHVlQ2hhbmdlKSB7XHJcbiAgICB0aGlzLnZhbHVlQ2hhbmdlSW52b2tlckZhY3RvcnkgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIneWni+WMlu+8iOW3suW6n+W8g++8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbml0KHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8YW55PiwgYmluZGluZ1BhdGg6IHN0cmluZykge1xyXG4gICAgdGhpcy5pbml0QnlSZXBvc2l0b3J5KHJlcG9zaXRvcnksIG51bGwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2uUmVwb3NpdG9yeeWvuUJpbmRpbmdEYXRh6L+b6KGM5Yid5aeL5YyWXHJcbiAgICovXHJcbiAgcHVibGljIGluaXRCeVJlcG9zaXRvcnkocmVwb3NpdG9yeTogUmVwb3NpdG9yeTxhbnk+LCB2aWV3TW9kZWxDb250ZXh0OiBWaWV3TW9kZWxDb250ZXh0KSB7XHJcbiAgICB0aGlzLnZpZXdNb2RlbENvbnRleHQgPSB2aWV3TW9kZWxDb250ZXh0O1xyXG5cclxuICAgIHRoaXMucHJvcGVydGllcyA9IFByb3BlcnR5VXRpbC5nZXRQcm9wZXJ0aWVzKHJlcG9zaXRvcnkuZW50aXR5VHlwZSk7XHJcbiAgICB0aGlzLmxpc3QgPSBCaW5kaW5nTGlzdEZhY3RvcnkuY3JlYXRlKHRoaXMucHJvcGVydGllcyk7XHJcbiAgICAvLyDku45yZXBvc2l0b3J55Yid5aeL5YyWYmluZGluZ0RhdGFcclxuICAgIHRoaXMucGFnaW5nSW5mbyA9IHJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5wYWdpbmF0aW9uSW5mbztcclxuXHJcbiAgICAvLyBAdG9kb1xyXG4gICAgLy8gQmluZGluZ0RhdGHkuI3lupTor6Xnn6XpgZNSZXBvc2l0b3J577yM5Yqg6L295pWw5o2u44CB5bu656uL5YWz6IGU5YWz57O755qE6L+H56iL5bqU6K+l6L2s56e75Yiw5aSW6L65XHJcbiAgICBFbnRpdHlVdGlsLmxvYWRSZXBvc2l0b3J5KHJlcG9zaXRvcnksIHRoaXMubGlzdCk7XHJcbiAgICB0aGlzLmRhdGFUeXBlSW5mbyA9IHJlcG9zaXRvcnkuZW50aXR5VHlwZUluZm87XHJcblxyXG4gICAgdGhpcy5leHRlbmRQcm9wZXJ0aWVzKHRoaXMucHJvcGVydGllcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJ3lp4vljJZcclxuICAgKi9cclxuICBwdWJsaWMgaW5pdEJ5QmluZGluZ0xpc3QoYmluZGluZ0xpc3Q6IEJpbmRpbmdMaXN0LCAgdmlld01vZGVsQ29udGV4dDogVmlld01vZGVsQ29udGV4dCkge1xyXG4gICAgdGhpcy5saXN0ID0gYmluZGluZ0xpc3Q7XHJcbiAgICB0aGlzLnZpZXdNb2RlbENvbnRleHQgPSB2aWV3TW9kZWxDb250ZXh0O1xyXG4gICAgdGhpcy5leHRlbmRQcm9wZXJ0aWVzKHRoaXMubGlzdC5wcm9wZXJ0aWVzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlnBhdGhz5a+55bqU55qE5bGe5oCn5YC8XHJcbiAgICogQHBhcmFtICBwYXRocyDlsZ7mgKfot6/lvoTmlbDnu4RcclxuICAgKiBAcmV0dXJucyDlsZ7mgKflgLxcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VmFsdWUocGF0aHM6IHN0cmluZ1tdKSB7XHJcbiAgICBsZXQgdGFyZ2V0OiBhbnkgPSB0aGlzLmxpc3Q7XHJcbiAgICBwYXRocy5mb3JFYWNoKChwYXRoOiBzdHJpbmcpID0+IHtcclxuICAgICAgaWYgKHRhcmdldCkge1xyXG4gICAgICAgIHRhcmdldCA9IHRhcmdldFtwYXRoXTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2ucGF0aHPorr7nva7lsZ7mgKflgLxcclxuICAgKiBAcGFyYW0gcGF0aHMg5bGe5oCn6Lev5b6E5pWw57uEXHJcbiAgICogQHBhcmFtIHZhbHVlIOWxnuaAp+WAvFxyXG4gICAqIEBwYXJhbSBlbWl0RXZlbnRUb1ZpZXcg5aaC5p6c6K6+572u5Li6dHJ1Ze+8jOWImeWPkemAgeS6i+S7tumAmuefpeiuoumYheWug+eahOe7hOS7tuOAgeaMh+S7pOWOu+abtOaWsOeVjOmdou+8jOm7mOiupOS4umZhbHNl44CCXHJcbiAgICogQHBhcmFtIGVtaXRFdmVudFRvRW50aXR5IOWmguaenOiuvue9ruS4unRydWXvvIzliJnlkIzmraXljrvmm7TmlrBFbnRpdHnkuIrlr7nlupTnmoTlrZfmrrXvvIzpu5jorqTkuLp0cnVl44CCXHJcbiAgICovXHJcbiAgcHVibGljIHNldFZhbHVlKHBhdGhzOiBzdHJpbmdbXSwgdmFsdWU6IGFueSwgZW1pdEV2ZW50VG9WaWV3OiBib29sZWFuID0gZmFsc2UsIGVtaXRFdmVudFRvRW50aXR5OiBib29sZWFuID0gdHJ1ZSkge1xyXG5cclxuICAgIGlmICghcGF0aHMgfHwgcGF0aHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHRocm93IEVycm9yKCfot6/lvoTkuI3og73kuLrnqbonKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHBhcmVudFBhdGhzID0gcGF0aHMuc2xpY2UoMCwgcGF0aHMubGVuZ3RoIC0gMSk7XHJcbiAgICBjb25zdCBwcm9wTmFtZSA9IHBhdGhzW3BhdGhzLmxlbmd0aCAtIDFdO1xyXG5cclxuICAgIGxldCBwYXJlbnQgPSB0aGlzLmdldFZhbHVlKHBhcmVudFBhdGhzKTtcclxuICAgIGlmICghcGFyZW50KSB7XHJcbiAgICAgIHRocm93IEVycm9yKCfmib7kuI3liLDopoHorr7nva7nmoTlr7nosaEnKTtcclxuICAgIH1cclxuICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBCaW5kaW5nRGF0YSkge1xyXG4gICAgICBwYXJlbnQgPSBwYXJlbnQubGlzdC5jdXJyZW50SXRlbTtcclxuICAgIH0gZWxzZSBpZiAocGFyZW50IGluc3RhbmNlb2YgQmluZGluZ0xpc3QpIHtcclxuICAgICAgcGFyZW50ID0gcGFyZW50LmN1cnJlbnRJdGVtO1xyXG4gICAgfVxyXG4gICAgaWYgKCEhdGhpcy52YWx1ZUNoYW5nZUludm9rZXJGYWN0b3J5KSB7XHJcbiAgICAgIHBhcmVudC5zZXRWYWx1ZShwcm9wTmFtZSwgdmFsdWUsIGVtaXRFdmVudFRvVmlldywgZW1pdEV2ZW50VG9FbnRpdHksIG51bGwsIHRoaXMudmFsdWVDaGFuZ2VJbnZva2VyRmFjdG9yeShwYXRocykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGFyZW50LnNldFZhbHVlKHByb3BOYW1lLCB2YWx1ZSwgZW1pdEV2ZW50VG9WaWV3LCBlbWl0RXZlbnRUb0VudGl0eSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja5wYXRoc+a4heepuuWxnuaAp+WAvFxyXG4gICAqL1xyXG4gIHB1YmxpYyBjbGVhclZhbHVlKHBhdGhzOiBzdHJpbmdbXSwgZW1pdEV2ZW50VG9WaWV3OiBib29sZWFuID0gZmFsc2UsIGVtaXRFdmVudFRvRW50aXR5OiBib29sZWFuID0gdHJ1ZSkge1xyXG4gICAgbGV0IGluaXRWYWx1ZTogYW55O1xyXG4gICAgY29uc3QgcHJvcEluZm8gPSB0aGlzLmRhdGFUeXBlSW5mby5nZXRQcm9wSW5mb0J5UGF0aChwYXRocyk7XHJcbiAgICBpZiAocHJvcEluZm8gJiYgcHJvcEluZm8ubWV0YWRhdGFJbmZvICYmIHByb3BJbmZvLm1ldGFkYXRhSW5mby5pbml0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBpbml0VmFsdWUgPSBwcm9wSW5mby5tZXRhZGF0YUluZm8uaW5pdFZhbHVlO1xyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIC8vIOWOn+adpeeahOW4ruWKqeaYoOWwhOS4re+8jOW8uuihjOe6oOato+S6huaVsOWAvOeahOaDheWGte+8jOS/neaMgeS4gOiHtFxyXG4gICAgICBjb25zdCBvbGRWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUocGF0aHMpO1xyXG4gICAgICBpZiAodHlwZW9mIG9sZFZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgIGluaXRWYWx1ZSA9IDA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5pdFZhbHVlID0gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuc2V0VmFsdWUocGF0aHMsIGluaXRWYWx1ZSwgZW1pdEV2ZW50VG9WaWV3LCBlbWl0RXZlbnRUb0VudGl0eSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blvZPliY3liJfooahcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0TGlzdCgpIHtcclxuXHJcbiAgICBpZiAoIXRoaXMuYmluZGluZ1BhdGggfHwgdGhpcy5iaW5kaW5nUGF0aCA9PT0gJy8nKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYmluZGluZ1BhdGggPSB0aGlzLmJpbmRpbmdQYXRoLnN1YnN0cigxKTtcclxuICAgIGNvbnN0IGJpbmRpbmdQYXRoQXJyYXkgPSBiaW5kaW5nUGF0aC5zcGxpdCgnLycpLmZpbHRlcigocGFydDogc3RyaW5nKSA9PiB7XHJcbiAgICAgIHJldHVybiBwYXJ0ICE9PSAnJztcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0VmFsdWUoYmluZGluZ1BhdGhBcnJheSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blvZPliY3lr7nosaFcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0T2JqZWN0KCkge1xyXG4gICAgY29uc3QgYmluZGluZ0xpc3QgPSB0aGlzLmdldExpc3QoKTtcclxuICAgIHJldHVybiBiaW5kaW5nTGlzdC5jdXJyZW50SXRlbTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJqeWxlUJpbmRpbmdEYXRh5bGe5oCn77yM5pig5bCEQmluZGluZ0RhdGHmiYDmjIHmnInnmoTnu5HlrprliJfooajlvZPliY3ooYznmoTlsZ7mgKfvvIzlh4/lsJHnu5HlrprlsYLnuqfjgIJcclxuICAgKiBAcGFyYW0gcHJvcGVydGllcyDlhbPogZTlrp7kvZPnmoTlsZ7mgKfpm4blkIhcclxuICAgKi9cclxuICBwcml2YXRlIGV4dGVuZFByb3BlcnRpZXMocHJvcGVydGllczogQmluZGluZ1Byb3BlcnR5W10pIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaCgocHJvcGVydHk6IEJpbmRpbmdQcm9wZXJ0eSkgPT4ge1xyXG4gICAgICBjb25zdCBwcm9wTmFtZSA9IHByb3BlcnR5Lm5hbWU7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBwcm9wTmFtZSwge1xyXG4gICAgICAgIGdldDogKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMubGlzdC5jdXJyZW50SXRlbVtwcm9wTmFtZV07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6ICh2YWx1ZTogYW55KSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmxpc3QuY3VycmVudEl0ZW1bcHJvcE5hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQmluZGluZ0RhdGEgfTtcclxuIl19