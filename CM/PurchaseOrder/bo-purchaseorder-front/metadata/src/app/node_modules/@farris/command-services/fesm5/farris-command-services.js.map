{"version":3,"file":"farris-command-services.js.map","sources":["ng://@farris/command-services/lib/form-loading/hide-event.service.ts","ng://@farris/command-services/lib/form-loading/form-loading.service.ts","ng://@farris/command-services/lib/languages/language-message-en.ts","ng://@farris/command-services/lib/languages/language-message-zh.ts","ng://@farris/command-services/lib/languages/language-message-zhft.ts","ng://@farris/command-services/lib/languages/language-message-factory.ts","ng://@farris/command-services/lib/languag.service.ts","ng://@farris/command-services/lib/error/types.ts","ng://@farris/command-services/lib/util/device-ability.ts","ng://@farris/command-services/lib/error/exception_strategy.ts","ng://@farris/command-services/lib/error/exception_strategy_factory.ts","ng://@farris/command-services/lib/util/http.ts","ng://@farris/command-services/lib/error/form-error.service.ts","ng://@farris/command-services/lib/form-message.service.ts","ng://@farris/command-services/lib/form-notify.service.ts","ng://@farris/command-services/lib/form-wizard.service.ts","ng://@farris/command-services/lib/check.service.ts","ng://@farris/command-services/lib/data-check.service.ts","ng://@farris/command-services/lib/event.service.ts","ng://@farris/command-services/lib/menu-state.service.ts","ng://@farris/command-services/lib/router.service.ts","ng://@farris/command-services/lib/types.ts","ng://@farris/command-services/lib/querystring.ts","ng://@farris/command-services/lib/rtf-service.ts","ng://@farris/command-services/lib/navigation-event.service.ts","ng://@farris/command-services/lib/farris-form.service.ts","ng://@farris/command-services/lib/navigation.service.ts","ng://@farris/command-services/lib/data-services/utils/edit-state.util.ts","ng://@farris/command-services/lib/data-services/utils/app-param.util.ts","ng://@farris/command-services/lib/form-notify-strategy.service.ts","ng://@farris/command-services/lib/command-service.ts","ng://@farris/command-services/lib/validation.service.ts","ng://@farris/command-services/lib/data-services/card-data.service.ts","ng://@farris/command-services/lib/navigation-middleware.service.ts","ng://@farris/command-services/lib/grid.middleware.service.ts","ng://@farris/command-services/lib/param.service.ts","ng://@farris/command-services/lib/keybinding-service.ts","ng://@farris/command-services/lib/filter-condition.service.ts","ng://@farris/command-services/lib/ui-state.service.ts","ng://@farris/command-services/lib/state-machine.service.ts","ng://@farris/command-services/lib/binding-data.service.ts","ng://@farris/command-services/lib/application-param.service.ts","ng://@farris/command-services/lib/entity-services/entity-traversing.service.ts","ng://@farris/command-services/lib/entity-services/entity-manipulation.service.ts","ng://@farris/command-services/lib/entity-services/entity-aggregation.service.ts","ng://@farris/command-services/lib/entity-services/entity-list.service.ts","ng://@farris/command-services/lib/entity-services/entity.service.ts","ng://@farris/command-services/lib/binding-path.service.ts","ng://@farris/command-services/lib/form-control.service.ts","ng://@farris/command-services/lib/frame-context.service.ts","ng://@farris/command-services/lib/focus-invalid.service.ts","ng://@farris/command-services/lib/change-item.service.ts","ng://@farris/command-services/lib/data-services/list-data.service.ts","ng://@farris/command-services/lib/data-services/sub-list-data.service.ts","ng://@farris/command-services/lib/data-services/base-data.service.ts","ng://@farris/command-services/lib/data-services/tree-table/util/parent-tree.util.ts","ng://@farris/command-services/lib/data-services/tree-table/util/path-tree.util.ts","ng://@farris/command-services/lib/data-services/tree-table/util/tree-util-factory.ts","ng://@farris/command-services/lib/data-services/tree-table/repository/parent-tree-repository.ts","ng://@farris/command-services/lib/data-services/tree-table/repository/path-tree-repository.ts","ng://@farris/command-services/lib/data-services/tree-table/repository/tree-repository-factory.ts","ng://@farris/command-services/lib/data-services/tree-data.service.ts","ng://@farris/command-services/lib/data-services/filter-condition-data.service.ts","ng://@farris/command-services/lib/data-services/edit-data.service.ts","ng://@farris/command-services/lib/data-services/remove-data.service.ts","ng://@farris/command-services/lib/data-services/save-data.service.ts","ng://@farris/command-services/lib/data-services/sub-tree-data-service.ts","ng://@farris/command-services/lib/be-action.service.ts","ng://@farris/command-services/lib/approve.service.ts","ng://@farris/command-services/lib/print.service.ts","ng://@farris/command-services/lib/attachment/types.ts","ng://@farris/command-services/lib/attachment/attachment.util.ts","ng://@farris/command-services/lib/attachment/attachment-data.service.ts","ng://@farris/command-services/lib/attachment/attachment.service.ts","ng://@farris/command-services/lib/attachment/file.service.ts","ng://@farris/command-services/lib/dialog.service.ts","ng://@farris/command-services/lib/sidebar-service.ts","ng://@farris/command-services/lib/filter-service.ts","ng://@farris/command-services/lib/component-manager.service.ts","ng://@farris/command-services/lib/authority/authority.service.ts","ng://@farris/command-services/lib/authority/authority.ts","ng://@farris/command-services/lib/exception.handler.ts","ng://@farris/command-services/lib/providers/legacy_providers.ts","ng://@farris/command-services/lib/user-settings.service.ts","ng://@farris/command-services/lib/work-flow/work-flow-message.service.ts","ng://@farris/command-services/lib/work-flow/work-flow-message.ts","ng://@farris/command-services/lib/work-flow/work-flow-message.handler.ts","ng://@farris/command-services/lib/providers/module_providers.ts","ng://@farris/command-services/lib/query-solution/enum/compare-type.enum.ts","ng://@farris/command-services/lib/query-solution/enum/value-type.enum.ts","ng://@farris/command-services/lib/query-solution/enum/relation-type.enum.ts","ng://@farris/command-services/lib/query-solution/handlers/text.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/daterage.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/dropdown.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/numberrage.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/smarthelp.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/single-year.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/checkbox.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/single-month.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/monthrange.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/single-date-time.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/single-number.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/single-date.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/combolookup.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/radio.handler.ts","ng://@farris/command-services/lib/query-solution/handlers/inputgroup.handler.ts","ng://@farris/command-services/lib/query-solution/querycondition.handler.factory.ts","ng://@farris/command-services/lib/query-solution/query-solution.service.ts","ng://@farris/command-services/lib/end-edit.service.ts","ng://@farris/command-services/lib/remote-summary.service.ts","ng://@farris/command-services/lib/batch-edit.service.ts","ng://@farris/command-services/lib/discussion-group.service.ts","ng://@farris/command-services/lib/list-filter/list-filter.service.ts","ng://@farris/command-services/lib/manifest/form_manifest_service.ts","ng://@farris/command-services/lib/manifest/form_expression_manifest_service.ts","ng://@farris/command-services/lib/localization.service.ts","ng://@farris/command-services/lib/service.ts","ng://@farris/command-services/lib/data-grid.service.ts","ng://@farris/command-services/lib/form-attention.service.ts","ng://@farris/command-services/lib/feature-edit/feature-repository.ts","ng://@farris/command-services/lib/feature-edit/types.ts","ng://@farris/command-services/lib/feature-edit/feature-data.service.ts","ng://@farris/command-services/lib/feature-edit/feature-edit.service.ts","ng://@farris/command-services/lib/expression_service.ts","ng://@farris/command-services/lib/dirty-checking.service.ts","ng://@farris/command-services/lib/pop_up.service.ts","ng://@farris/command-services/lib/form.service.ts","ng://@farris/command-services/lib/view-model.service.ts","ng://@farris/command-services/lib/pagination.service.ts","ng://@farris/command-services/lib/providers/frame_providers.ts","ng://@farris/command-services/lib/providers/dynamic_providers.ts","ng://@farris/command-services/lib/command-services-module.ts","ng://@farris/command-services/lib/rtf-message/message-pipe.ts","ng://@farris/command-services/lib/rtf-message/message-pipe-service.ts","ng://@farris/command-services/lib/back_end_message_handler.ts","ng://@farris/command-services/public-api.ts","ng://@farris/command-services/farris-command-services.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n/**\n * åéæ¶æ¯ç»FormLoadingServiceï¼\n * ä½¿å¶æ¥æ¶åè°ç¨hide()å½æ°\n * æ­¤æå¡ä»ç¨äºå¤çHttpå¼å¸¸\n */\n@Injectable()\nclass HideEventService {\n    public hideEvent = new Subject<any>();\n}\n\nexport { HideEventService };","import { Injectable, SkipSelf, Optional } from '@angular/core';\nimport { LoadingService, LoadingConfig, LoadingComponent } from '@farris/ui-loading';\nimport { HideEventService } from './hide-event.service';\nimport { AppContext, FrameContext } from '@farris/devkit';\n// tslint:disable: no-string-literal\n/**\n * å è½½æç¤ºHelper\n * 1ãåè£@farris/uiçLoadingServiceï¼\n * 2ãæä¾éå¯¹è¡¨åçå¿«æ·æ¹æ³ï¼\n */\n@Injectable()\nclass FormLoadingService {\n  private static isSuspend = false;\n  /**\n   * å è½½ä¸­ç»ä»¶å®ä¾\n   */\n  private loadingCmp: LoadingComponent;\n\n  /**\n   * å»¶è¿loadingå®æ¶å¨\n   */\n  private loadingTimerIds: any[] = [];\n\n  /**\n   * å¼ºå¶æ¾ç¤ºï¼ä¸è½éè\n   */\n\n  /**\n   * æé å½æ°\n   * æ³¨å¥@farris/uiçLoadingService\n   */\n  constructor(\n    private loadingService: LoadingService,\n    @Optional() private hideEventService: HideEventService,\n    @Optional() private applicationContext: AppContext,\n  ) {\n    if (hideEventService) {\n      this.hideEventService.hideEvent.subscribe(\n        result => {\n          this.hide();\n        }\n      );\n    }\n  }\n  public setSuspend(flag: boolean) {\n    FormLoadingService.isSuspend = flag;\n  }\n  /**\n   * æ¾ç¤ºå è½½ä¸­\n   */\n  public show(configOrMessage?: any): LoadingComponent {\n    if (FormLoadingService.isSuspend === true) {\n      return;\n    }\n    if (this.loadingCmp) {\n      this.loadingCmp.close();\n      this.loadingCmp = null;\n    }\n    this.registerService();\n    const loadingConfig = this.buildLoadingConfig(configOrMessage);\n    this.loadingCmp = this.loadingService.show(loadingConfig);\n    return this.loadingCmp;\n  }\n\n  /**\n   * å»¶è¿æ¾ç¤ºLoading\n   */\n  public showLoadingWithDelay(delayTime: number, configOrMessage?: any): any {\n    // this.show(configOrMessage);\n    const timerId = setTimeout(() => {\n      this.show(configOrMessage);\n    }, delayTime);\n    this.loadingTimerIds.push(timerId);\n    this.registerService();\n    return timerId;\n  }\n\n  /**\n   * éèå»¶è¿çLoading\n   */\n  public hideDelayLoading(timerIdToClear: any) {\n    this.clearLoadingTimer(timerIdToClear);\n    this.hide();\n  }\n\n  /**\n   * æé LoadingConfig\n   * @param configOrMessage éç½®å¯¹è±¡ææ¶æ¯å­ç¬¦ä¸²\n   */\n  private buildLoadingConfig(configOrMessage: any): LoadingConfig {\n    let loadingConfig: LoadingConfig;\n    if (!!configOrMessage) {\n      if (typeof configOrMessage === 'object') {\n        loadingConfig = configOrMessage;\n      } else {\n        loadingConfig = { 'message': configOrMessage };\n      }\n    } else {\n      loadingConfig = {};\n    }\n    if (!loadingConfig.hasOwnProperty('delay')) {\n      loadingConfig.delay = 0;\n    }\n    return loadingConfig;\n  }\n\n  /**\n   * å³é­ææloading\n   */\n  public clearAll() {\n    FormLoadingService.isSuspend = false;\n    window.setTimeout(() => {\n      this.loadingService.clearAll();\n    }, 350);\n    this.loadingCmp = null;\n    this.clearAllLoadingTimers();\n    this.destroy();\n  }\n\n  /**\n   * æ¸ç©ºLoadingå®æ¶å¨\n   */\n  private clearLoadingTimer(timerIdToClear: any) {\n    clearTimeout(timerIdToClear);\n    this.loadingTimerIds = this.loadingTimerIds.filter((timerId: any) => {\n      return timerId !== timerIdToClear;\n    });\n  }\n\n  /**\n   * æ¸ç©ºææLoadingå®æ¶å¨\n   */\n  private clearAllLoadingTimers() {\n    this.loadingTimerIds.forEach((timerId: any) => {\n      this.clearLoadingTimer(timerId);\n    });\n  }\n\n  /**\n   * éèå è½½ä¸­\n   */\n  public hide() {\n    if (!this.loadingCmp) {\n      this.destroy();\n      return;\n    }\n    if (FormLoadingService.isSuspend === true) {\n      return;\n    }\n    this.loadingCmp.close();\n    this.loadingCmp = null;\n    this.destroy();\n  }\n  /**\n   * éæ¯loadingService\n   */\n  public destroy() {\n    if (FormLoadingService.isSuspend === true) {\n      return;\n    }\n    const services: any[] = window['DEVKIT_LOADING_SERVICE'] || [];\n    if (services && Array.isArray(services) && services.length > 0) {\n      services.forEach((service: FormLoadingService) => {\n        if (service) {\n          service.clearAllLoadingTimers();\n          if (service.loadingCmp) {\n            service.loadingCmp.close();\n            service.loadingCmp = null;\n        }\n        }\n      });\n    }\n    window['DEVKIT_LOADING_SERVICE'] = [];\n  }\n\n  /**\n   * æ³¨åææçLoadingServiceå®ä¾\n   */\n  private registerService() {\n    const services: any[] = window['DEVKIT_LOADING_SERVICE'] || [];\n    services.push(this);\n    window['DEVKIT_LOADING_SERVICE'] = services;\n  }\n}\n\n\nexport { FormLoadingService };\n","\nimport { LanguageMessage } from './language-message';\n\n/**\n * è±æè¯­è¨æ¶æ¯\n */\nclass LanguageMessageForEn implements LanguageMessage {\n  yes = 'Yes';\n  no = 'No';\n  unsaveNotifyTitle = 'Exist unsave record. Do save operation or not?';\n  clientNotifyTitle = 'System Prompt In The Frontend';\n  serverNotifyTitle = 'System Prompt In The Backend';\n  cancelApproveSuccess = 'Cancel Approve Success';\n  cancelApproveFailed = 'Cancel Approve Failed';\n  unallowEmptyProcessInstanceName = 'Process Instance Name Can Not Be Empty';\n  unallowEmptyBizBillId = 'Biz Bill Id Can Not Be Empty';\n  unallowEmptyChildBizBillId = 'Child Biz Bill Id Can Not Be Empty';\n  bizDefKeyRequired = 'Biz Def Key can\\'t be empty.';\n  procInsIdRequired = 'Process instance Id can\\'t be empty.';\n  addChildFailed = 'Add Child Failed';\n  addSiblingFailed = 'Add Sibling Failed';\n  addSubChildFailed = 'Add Sub Child Failed';\n  addSubSiblingFailed = 'Add Sub Sibling Failed';\n  deleteFailed = 'Delete Failed';\n  multiSaveFailed = 'MultiSave Failed';\n  appendFailed = 'Append Failed';\n  queryFailed = 'Query Failed';\n  cancelFailed = 'Cancel Failed';\n  updateFailed = 'Update Failed';\n  addFailed = 'Add Failed';\n  loadFailed = 'Load Failed';\n  saveSuccess = 'Successfully saved!';\n  saveFailed = 'Save failed!';\n  deleteSuccess = 'Successfully deleted!';\n  deleteFaild = 'Failed to delete!';\n  confirmDeletion = 'Confirm deletion?';\n  submitSuccess = 'Submit successfully!';\n  submitFaild = 'Submit failed!';\n  notifyTitle = 'System prompt';\n  httpError = 'HTTP request error! Please check the server error!';\n  gridDataNotSave = 'The current page data is not saved. Turning the page will result in data loss. Do you want to continue turning the page?';\n  exitWithoutSave = 'There is unsaved data. Do you want to continue closing?';\n  notSupportMenuType = 'Not supported menu type!';\n  cancelWithoutSave = 'Exist unsaved change,Confirm to cancel?';\n  plsSelectDeleteData = 'Please select the data to delete!';\n  errorHierarchyKey = 'Incorrect ierarchy key';\n  plsSelectParentNode = 'Please select parent node!';\n  deleteChildFirst = 'Please delete the child nodes first!';\n  incorrectHierarchyConfig = 'Hierarchy config is incorrect!';\n  operationFailed = 'The operation failed.';\n  plsSelectEditData = 'Please select the data you want to edit!';\n  plsSelectViewData = 'Please select the data you want to view!';\n  plsUploadFirst = 'Please upload attachment first!';\n  defaultDialogTitle = 'Dialog';\n  public changeToFirst = 'The first data.';\n  public changeToLast = 'The last data.';\n  public noProcessInstanceId = 'Please provide the process instance id.';\n  public noDataExist = 'Data does not exist to access the edit state!';\n  public noAttachment = 'There are no attachments to preview.';\n  public confirm = 'Confirm';\n  public cancel = 'Cancel';\n  public plsSelectCopyData = 'Please select the data you want to copy!';\n  public copyFieldsRequired = 'The copy fields can`t be empty!';\n  public pathIsRequired = 'The request url can`t be empty!';\n  public propsIsEmpty = 'The material has no props!';\n  public historyAttachment = 'The history attachment can`t be delete!';\n  public plsSelectDownloadAtt = 'Please select the attachment you want to download!';\n  public noDownloadAtt = 'There are no attachments to download!';\n  public plsCheckBatchEditRows = 'Please check the rows you want to edit!';\n  public plsSelectDetailFormData = 'Please select a detail form data first!';\n  public dataAndStateChanged = 'Are you sure you want to load the new data and switch to $1 state?';\n  public dataChanged = 'Are you sure you want to load the data and discards the current modification?';\n  public stateChanged = 'Are you sure you want to switch $1 state?';\n  public defaultStateName = 'init';\n  public copy = 'Copy detail message';\n  public copySuccess = 'Copy success';\n  public copyFailed = 'Copy failed';\n  public roger = 'Roger';\n  public appOrFuncIdRequired = 'No menu or application parameters are configured, please configure them in the designer.';\n  public tableCanNotEmpty = 'can not empty.';\n}\n\nexport { LanguageMessageForEn };\n","import { LanguageMessage } from './language-message';\n\n/**\n * è±æè¯­è¨æ¶æ¯\n */\nclass LanguageMessageForZh implements LanguageMessage {\n  public yes = 'æ¯';\n  public no = 'å¦';\n  public unsaveNotifyTitle = 'å­å¨æªä¿å­è®°å½ãæ¯å¦è¦ä¿å­ï¼';\n  public clientNotifyTitle = 'åç«¯å¼å¸¸æç¤º';\n  public serverNotifyTitle = 'æå¡å¨ç«¯å¼å¸¸æç¤º';\n  public cancelApproveSuccess = 'åæ¶æäº¤æåï¼';\n  public cancelApproveFailed = 'åæ¶æäº¤å¤±è´¥ï¼';\n  public unallowEmptyProcessInstanceName = 'æµç¨å®ä¾åç§°ä¸è½ä¸ºç©º';\n  public unallowEmptyBizBillId = 'è¯·éæ©ä¸æ¡æ°æ®';\n  public bizDefKeyRequired = 'å¥å£åæ®ä¸è½ä¸ºç©º';\n  public unallowEmptyChildBizBillId = 'ä»è¡¨ä¸å¡åæ®ç¼å·ä¸è½ä¸ºç©ºï¼';\n  public procInsIdRequired = 'æµç¨å®ä¾Idä¸è½ä¸ºç©ºï¼';\n  public addChildFailed = 'æ°å¢å­çº§å¤±è´¥';\n  public addSiblingFailed = 'æ°å¢åçº§å¤±è´¥';\n  public addSubChildFailed = 'æ°å¢ä»è¡¨å­çº§å¤±è´¥';\n  public addSubSiblingFailed = 'æ°å¢ä»è¡¨åçº§å¤±è´¥';\n  public deleteFailed = 'å é¤å¤±è´¥';\n  public multiSaveFailed = 'æ¹éä¿å­å¤±è´¥';\n  public appendFailed = 'è¿½å å¤±è´¥';\n  public queryFailed = 'æ¥è¯¢å¤±è´¥';\n  public cancelFailed = 'åæ¶å¤±è´¥';\n  public updateFailed = 'æ´æ°å¤±è´¥';\n  public addFailed = 'æ°å¢å¤±è´¥';\n  public loadFailed = 'å è½½å¤±è´¥';\n  public saveSuccess = 'ä¿å­æåï¼';\n  public saveFailed = 'ä¿å­å¤±è´¥ï¼';\n  public deleteSuccess = 'å é¤æåï¼';\n  public deleteFaild = 'å é¤å¤±è´¥ï¼';\n  public confirmDeletion = 'ç¡®è®¤å é¤ï¼';\n  public submitSuccess = 'æäº¤å®¡æ¹æåï¼';\n  public submitFaild = 'æäº¤å®¡æ¹å¤±è´¥ï¼';\n  public notifyTitle = 'ç³»ç»æç¤º';\n  public httpError = 'HTTPè¯·æ±éè¯¯ï¼è¯·æ£æ¥Serverç«¯éè¯¯ï¼';\n  public gridDataNotSave = 'å½åé¡µæ°æ®æªä¿å­ï¼ç¿»é¡µå°å¯¼è´æ°æ®ä¸¢å¤±ï¼æ¯å¦ç»§ç»­ç¿»é¡µï¼';\n  public exitWithoutSave = 'å­å¨æªä¿å­çæ°æ®ï¼æ¯å¦ç»§ç»­å³é­ï¼';\n  public notSupportMenuType = 'å³é­çæ¢ä¸æ¯èåä¹ä¸æ¯åºç¨ã';\n  public cancelWithoutSave = 'å­å¨æªä¿å­çåæ´ï¼ç¡®è®¤åæ¶ï¼';\n  public plsSelectDeleteData = 'è¯·éæ©è¦å é¤çæ°æ®ï¼';\n  public errorHierarchyKey = 'éè¯¯çåçº§ç ';\n  public plsSelectParentNode = 'è¯·éæ©ç¶èç¹';\n  public deleteChildFirst = 'è¯·åå é¤å­èç¹';\n  public incorrectHierarchyConfig = 'åçº§ç éç½®ä¿¡æ¯éè¯¯';\n  public operationFailed = 'æä½æ§è¡å¤±è´¥ã';\n  public plsSelectEditData = 'è¯·éæ©è¦ç¼è¾çæ°æ®ï¼';\n  public plsSelectViewData = 'è¯·éæ©è¦æ¥ççæ°æ®ï¼';\n  public plsUploadFirst = 'è¯·åä¸ä¼ éä»¶ï¼';\n  public defaultDialogTitle = 'å¼¹çª';\n  public changeToFirst = 'å·²å°è¾¾ç¬¬ä¸æ¡æ°æ®';\n  public changeToLast = 'å·²å°è¾¾æåä¸æ¡æ°æ®';\n  public noProcessInstanceId = 'è¯·æå®æµç¨å®ä¾æ è¯ã';\n  public noDataExist = 'è¦ç¼è¾çæ°æ®ä¸å­å¨ï¼æ æ³è¿å¥ç¼è¾ç¶æï¼';\n  public noAttachment = 'æ²¡æå¯ä»¥é¢è§çéä»¶ã';\n  public confirm = 'ç¡®å®';\n  public cancel = 'åæ¶';\n  public plsSelectCopyData = 'è¯·éæ©è¦å¤å¶çæ°æ®ï¼';\n  public copyFieldsRequired = 'è¦å¤å¶çå­æ®µä¸è½ä¸ºç©ºï¼';\n  public pathIsRequired = 'è¯·æ±è·¯å¾ä¸è½ä¸ºç©ºï¼';\n  public propsIsEmpty = 'æ²¡æå¯ä»¥ç¼è¾çç©æç¹å¾ï¼';\n  public historyAttachment = 'åå²çæ¬éä»¶ç¦æ­¢å é¤ï¼';\n  public plsSelectDownloadAtt = 'è¯·éæ©è¦ä¸è½½çéä»¶!';\n  public noDownloadAtt = 'æ¾ä¸å°è¦ä¸è½½çéä»¶!'\n  public plsCheckBatchEditRows = 'è¯·å¾éè¦æ¹éç¼è¾çè¡ï¼';\n  public plsSelectDetailFormData = 'è¯·åéæ©ä¸æ¡ä»è¡¨æ°æ®ï¼';\n  public dataAndStateChanged = 'ç¡®å®è¦å è½½æ°æ®å¹¶åæ¢å°$1ç¶æï¼';\n  public dataChanged = 'ç¡®å®è¦å è½½æ°æ®å¹¶æ¾å¼å½åä¿®æ¹ï¼';\n  public stateChanged = 'ç¡®å®è¦åæ¢å°$1ç¶æï¼';\n  public defaultStateName = 'åå§';\n  public copy = 'å¤å¶è¯¦ç»ä¿¡æ¯';\n  public copySuccess = 'å¤å¶æå';\n  public copyFailed = 'å¤å¶å¤±è´¥';\n  public roger = 'ç¥éäº';\n  public appOrFuncIdRequired = 'æªéç½®èåæåºç¨åæ°ï¼è¯·å¨è®¾è®¡å¨ä¸­éç½®ã';\n  public tableCanNotEmpty = 'ä¸è½ä¸ºç©ºã';\n}\n\nexport { LanguageMessageForZh };\n","import { LanguageMessage } from './language-message';\n\n/**\n * ç¹ä½ä¸­æè¯­è¨æ¶æ¯\n */\nclass LanguageMessageForZhft implements LanguageMessage {\n  public yes = 'æ¯';\n  public no = 'å¦';\n  public unsaveNotifyTitle = 'å­å¨æªä¿å­è¨éãæ¯å¦è¦ä¿å­ï¼';\n  public clientNotifyTitle = 'åç«¯ç°å¸¸æç¤º';\n  public serverNotifyTitle = 'æåå¨ç«¯ç°å¸¸æç¤º';\n  public cancelApproveSuccess = 'åæ¶æäº¤æåï¼';\n  public cancelApproveFailed = 'åæ¶æäº¤å¤±æï¼';\n  public unallowEmptyProcessInstanceName = 'æµç¨å¯¦ä¾åç¨±ä¸è½çºç©º';\n  public unallowEmptyBizBillId = 'è«é¸æå£¹æ¢æ¸æ';\n  public bizDefKeyRequired = 'å¥å£å®æä¸è½çºç©º';\n  public unallowEmptyChildBizBillId = 'å¾è¡¨æ¥­åå®æç·¨èä¸è½çºç©ºï¼';\n  public procInsIdRequired = 'æµç¨å¯¦ä¾idä¸è½çºç©ºï¼';\n  public addChildFailed = 'æ°å¢å­ç´å¤±æ';\n  public addSiblingFailed = 'æ°å¢åç´å¤±æ';\n  public addSubChildFailed = 'æ°å¢å¾è¡¨å­ç´å¤±æ';\n  public addSubSiblingFailed = 'æ°å¢å¾è¡¨åç´å¤±æ';\n  public deleteFailed = 'åªé¤å¤±æ';\n  public multiSaveFailed = 'æ¹éä¿å­å¤±æ';\n  public appendFailed = 'è¿½å å¤±æ';\n  public queryFailed = 'æ¥è©¢å¤±æ';\n  public cancelFailed = 'åæ¶å¤±æ';\n  public updateFailed = 'æ´æ°å¤±æ';\n  public addFailed = 'æ°å¢å¤±æ';\n  public loadFailed = 'å è¼å¤±æ';\n  public saveSuccess = 'ä¿å­æåï¼';\n  public saveFailed = 'ä¿å­å¤±æï¼';\n  public deleteSuccess = 'åªé¤æåï¼';\n  public deleteFaild = 'åªé¤å¤±æï¼';\n  public confirmDeletion = 'ç¢ºèªåªé¤ï¼';\n  public submitSuccess = 'æäº¤å¯©æ¹æåï¼';\n  public submitFaild = 'æäº¤å¯©æ¹å¤±æï¼';\n  public notifyTitle = 'ç³»çµ±æç¤º';\n  public httpError = 'HTTPè«æ±é¯èª¤ï¼è«æª¢æ¥Serverç«¯é¯èª¤ï¼';\n  public gridDataNotSave = 'ç¶åé æ¸ææªä¿å­ï¼ç¿»é å°å°è´æ¸æä¸å¤±ï¼æ¯å¦ç¹¼çºç¿»é ï¼';\n  public exitWithoutSave = 'å­å¨æªä¿å­çæ¸æï¼æ¯å¦ç¹¼çºééï¼';\n  public notSupportMenuType = 'ééçæ¢ä¸æ¯èå®ä¹ä¸æ¯æç¨ã';\n  public cancelWithoutSave = 'å­å¨æªä¿å­çè®æ´ï¼ç¢ºèªåæ¶ï¼';\n  public plsSelectDeleteData = 'è«é¸æè¦åªé¤çæ¸æï¼';\n  public errorHierarchyKey = 'é¯èª¤çåç´ç¢¼';\n  public plsSelectParentNode = 'è«é¸æç¶ç¯é»';\n  public deleteChildFirst = 'è«ååªé¤å­ç¯é»';\n  public incorrectHierarchyConfig = 'åç´ç¢¼éç½®ä¿¡æ¯é¯èª¤';\n  public operationFailed = 'æä½å·è¡å¤±æã';\n  public plsSelectEditData = 'è«é¸æè¦ç·¨è¼¯çæ¸æï¼';\n  public plsSelectViewData = 'è«é¸æè¦æ¥ççæ¸æï¼';\n  public plsUploadFirst = 'è«åä¸å³éä»¶ï¼';\n  public defaultDialogTitle = 'å½çª';\n  public changeToFirst = 'å·²å°éç¬¬å£¹æ¢æ¸æ';\n  public changeToLast = 'å·²å°éæå¾å£¹æ¢æ¸æ';\n  public noProcessInstanceId = 'è«æå®æµç¨å¯¦ä¾æ¨è­ã';\n  public noDataExist = 'è¦ç·¨è¼¯çæ¸æä¸å­å¨ï¼ç¡æ³é²å¥ç·¨è¼¯çæï¼';\n  public noAttachment = 'æ²æå¯ä»¥é è¦½çéä»¶ã';\n  public confirm = 'ç¢ºå®';\n  public cancel = 'åæ¶';\n  public plsSelectCopyData = 'è«é¸æè¦å¾©å¶çæ¸æï¼';\n  public copyFieldsRequired = 'è¦å¾©å¶çå­æ®µä¸è½çºç©ºï¼';\n  public pathIsRequired = 'è«æ±è·¯å¾ä¸è½çºç©ºï¼';\n  public propsIsEmpty = 'æ²æå¯ä»¥ç·¨è¼¯çç©æç¹å¾ï¼';\n  public historyAttachment = 'æå²çæ¬éä»¶ç¦æ­¢åªé¤ï¼';\n  public plsSelectDownloadAtt = 'è«é¸æè¦ä¸è¼çéä»¶!';\n  public noDownloadAtt = 'æ¾ä¸å°è¦ä¸è¼çéä»¶ï¼';\n  public plsCheckBatchEditRows = 'è«å¾é¸è¦æ¹éç·¨è¼¯çè¡ï¼';\n  public plsSelectDetailFormData = 'è«åé¸æä¸æ¢å¾è¡¨æ¸æï¼';\n  public dataAndStateChanged = 'ç¢ºå®è¦å è¼æ¸æä¸¦åæå°$1çæï¼';\n  public dataChanged = 'ç¢ºå®è¦å è¼æ¸æä¸¦æ¾æ£ç¶åä¿®æ¹ï¼';\n  public stateChanged = 'ç¢ºå®è¦åæå°$1çæï¼';\n  public defaultStateName = 'åå§';\n  public copy = 'å¾©å¶è©³ç´°ä¿¡æ¯';\n  public copySuccess = 'å¾©å¶æå';\n  public copyFailed = 'å¾©å¶å¤±æ';\n  public roger = 'ç¥éäº';\n  public appOrFuncIdRequired = 'æªéç½®èå®ææç¨åæ¸ï¼è«å¨è¨­è¨å¨ä¸­éç½®ã';\n  public tableCanNotEmpty = 'ä¸è½çºç©ºã';\n}\n\nexport { LanguageMessageForZhft };\n","import { LanguageMessage } from './language-message';\nimport { LanguageMessageForZh } from './language-message-zh';\nimport { LanguageMessageForEn } from './language-message-en';\nimport { LanguageMessageForZhft } from './language-message-zhft';\nclass LanguageMessageFactory {\n\n  private static languageMessageMap: Map<string, LanguageMessage> = new Map<string, LanguageMessage>();\n\n  /**\n   * Create an instance by language\n   */\n  public static create(language: string): LanguageMessage {\n    if (this.languageMessageMap.has(language) === true) {\n      return this.languageMessageMap.get(language);\n    }\n\n    let languageMessage: LanguageMessage;\n    switch (language) {\n      case 'zh-CHS':\n        languageMessage = new LanguageMessageForZh();\n        break;\n      case 'en':\n        languageMessage = new LanguageMessageForEn();\n        break;\n      case 'zh-CHT':\n        languageMessage = new LanguageMessageForZhft();\n        break;\n      default:\n        languageMessage = new LanguageMessageForZh();\n        break;\n    }\n    this.languageMessageMap.set(language, languageMessage);\n\n    return languageMessage;\n  }\n}\n\nexport { LanguageMessageFactory };\n","import { Injectable, LOCALE_ID, Optional, Inject } from '@angular/core';\nimport { LanguageMessage, LanguageMessageFactory } from './languages/index';\n\n\n/**\n * å¤è¯­è¨æå¡\n * @scope FormModule\n */\n@Injectable()\nclass LanguageService implements LanguageMessage {\n\n  /**\n   * åä¾å¯¹è±¡\n   */\n  private static innerInstance: LanguageService = null;\n\n  // #region å®ç°LanguageMessageæ¥å£ï¼æ¹ä¾¿ä¹¦å\n  public yes: string;\n  public no: string;\n  public unsaveNotifyTitle: string;\n  public clientNotifyTitle: string;\n  public serverNotifyTitle: string;\n  public cancelApproveSuccess: string;\n  public cancelApproveFailed: string;\n  public unallowEmptyProcessInstanceName: string;\n  public unallowEmptyBizBillId: string;\n  public unallowEmptyChildBizBillId: string;\n  public bizDefKeyRequired: string;\n  public procInsIdRequired: string;\n  public addChildFailed: string;\n  public addSiblingFailed: string;\n  public addSubChildFailed: string;\n  public addSubSiblingFailed: string;\n  public deleteFailed: string;\n  public multiSaveFailed: string;\n  public appendFailed: string;\n  public queryFailed: string;\n  public cancelFailed: string;\n  public updateFailed: string;\n  public addFailed: string;\n  public loadFailed: string;\n  public saveSuccess: string;\n  public saveFailed: string;\n  public deleteSuccess: string;\n  public deleteFaild: string;\n  public confirmDeletion: string;\n  public submitSuccess: string;\n  public submitFaild: string;\n  public notifyTitle: string;\n  public httpError: string;\n  public gridDataNotSave: string;\n  public exitWithoutSave: string;\n  public notSupportMenuType: string;\n  public cancelWithoutSave: string;\n  public plsSelectDeleteData: string;\n  public errorHierarchyKey: string;\n  public plsSelectParentNode: string;\n  public deleteChildFirst: string;\n  public incorrectHierarchyConfig: string;\n  public operationFailed: string;\n  public plsSelectEditData: string;\n  public plsSelectViewData: string;\n  public plsUploadFirst: string;\n  public defaultDialogTitle: string;\n  public changeToFirst: string;\n  public changeToLast: string;\n  public noProcessInstanceId: string;\n  public noDataExist: string;\n  public noAttachment: string;\n  public confirm: string;\n  public cancel: string;\n  public plsSelectCopyData: string;\n  public copyFieldsRequired: string;\n  public pathIsRequired: string;\n  public propsIsEmpty: string;\n  public historyAttachment: string;\n  public plsSelectDownloadAtt: string;\n  public noDownloadAtt: string;\n  public plsCheckBatchEditRows: string;\n  public plsSelectDetailFormData: string;\n  public dataAndStateChanged: string;\n  public dataChanged: string;\n  public stateChanged: string;\n  public defaultStateName: string;\n  public copy: string;\n  public copySuccess: string;\n  public copyFailed: string;\n  public roger: string;\n  public appOrFuncIdRequired: string;\n  public tableCanNotEmpty: string;\n  // #endregion\n\n  /**\n   * å½åè¯­è¨\n   */\n  protected language = 'zh-CHS';\n\n  /**\n   * å½åè¯­è¨å\n   */\n  protected get languageMessage(): LanguageMessage {\n    return LanguageMessageFactory.create(this.language);\n  }\n\n  /**\n   * æé å½æ°\n   */\n  constructor(@Optional() @Inject(LOCALE_ID) localeId?: string) {\n    this.language = localeId || 'zh-CHS';\n    this.extendProperties();\n    LanguageService.innerInstance = this;\n  }\n\n  /**\n   * è·åå®ä¾\n   */\n  public static getInstance() {\n    if (this.innerInstance) {\n      return this.innerInstance;\n    }\n    const instance = new LanguageService('zh-CHS');\n    LanguageService.innerInstance = instance;\n    return instance;\n  }\n\n  /**\n   * æ©å±å±æ§\n   */\n  private extendProperties() {\n    Object.keys(this.languageMessage).forEach((propName: string) => {\n      Object.defineProperty(this, propName, {\n        get: () => {\n          return this.languageMessage[propName];\n        }\n      });\n    });\n  }\n}\n\nexport { LanguageService };\n","\n/**\n * æå¡å¨ç«¯å¼å¸¸å®ä½\n */\nclass ServerExceptionEntity {\n\n  Code: string;\n\n  Level: ExceptionLevel;\n\n  Message: string;\n\n  Detail: string;\n\n  RequestId: string;\n\n  date?: string;\n\n  innerMessage?: string;\n\n}\n\n/**\n * æå¡å¨ç«¯å¼å¸¸ç­çº§\n */\nconst enum ExceptionLevel {\n\n  /**\n   * æç¤ºä¿¡æ¯\n   */\n  Info = 0,\n\n  /**\n   * è­¦å\n   */\n  Warning,\n\n  /**\n   * éè¯¯\n   */\n  Error,\n\n  /**\n   * è´å½éè¯¯\n   */\n  Fatal\n}\n\nexport { ServerExceptionEntity, ExceptionLevel };\n","export class DeviceAbility {\n  /**\n   * å¤å¶å°ç²è´´æ¿\n   * @param text \n   * @returns \n   */\n  public static copyToClipboard(text): boolean {\n    const windowRef: any = window;\n    if (windowRef.clipboardData && windowRef.clipboardData.setData) {\n      return windowRef.clipboardData.setData(\"Text\", text);\n    } else if (document.queryCommandSupported && document.queryCommandSupported(\"copy\")) {\n      var textarea = document.createElement(\"textarea\");\n      textarea.textContent = text;\n      textarea.style.position = \"fixed\";\n      document.body.appendChild(textarea);\n      textarea.select();\n      try {\n        return document.execCommand(\"copy\");\n      } catch (ex) {\n      } finally {\n        document.body.removeChild(textarea);\n      }\n    }\n    return false;\n  }\n}","\nimport { Optional } from '@angular/core';\nimport { MessagerService } from '@farris/ui-messager';\nimport { LanguageService } from '../languag.service';\nimport { ServerExceptionEntity } from './types';\nimport { DeviceAbility } from '../util/device-ability';\nimport { BsModalRef } from '@farris/ui-modal';\nimport { FormNotifyService } from '../form-notify.service';\nimport { FrameContext } from '@farris/devkit';\nimport moment from 'moment';\n/**\n * å¼å¸¸å¤çæ¥å£\n */\nexport interface IExceptionStrategy {\n  handleException(error: ServerExceptionEntity): void;\n}\n\n\n/**\n * å¼å¸¸å¤çåºç±»\n */\nexport class ExceptionStrategy {\n  constructor(\n    public messagerService: MessagerService,\n    @Optional() public languageService: LanguageService) {\n  }\n}\n\n/**\n * ä¿¡æ¯çº§å«å¼å¸¸å¤ç\n */\nexport class InfoExceptionStrategy extends ExceptionStrategy implements IExceptionStrategy {\n  constructor(\n    messagerService: MessagerService,\n    @Optional() languageService: LanguageService) {\n    super(messagerService, languageService);\n  }\n\n  public handleException(error: ServerExceptionEntity): void {\n    if (!error) {\n      return;\n    }\n\n    this.messagerService.info(error.Message);\n  }\n}\n\n\n/**\n * è­¦åçº§å«å¼å¸¸å¤ç\n */\nexport class WarningExceptionStrategy extends ExceptionStrategy implements IExceptionStrategy {\n  constructor(\n    messagerService: MessagerService,\n    @Optional() languageService: LanguageService) {\n    super(messagerService, languageService);\n  }\n\n  public handleException(error: ServerExceptionEntity): void {\n    if (!error) {\n      return;\n    }\n\n    this.messagerService.warning(error.Message);\n  }\n}\n\n\n/**\n * éè¯¯çº§å«å¼å¸¸å¤ç\n */\nexport class ErrorExceptionStrategy extends ExceptionStrategy implements IExceptionStrategy {\n  private langService: LanguageService = null;\n  constructor(\n    messagerService: MessagerService,\n    @Optional() languageService: LanguageService) {\n    super(messagerService, languageService);\n    this.langService = languageService;\n    if (!this.langService) {\n      this.langService = new LanguageService();\n    }\n\n  }\n\n  public handleException(error: ServerExceptionEntity): void {\n    if (!error) {\n      return;\n    }\n\n    this.handleErrorLevel(error);\n  }\n\n  private handleErrorLevel(error: ServerExceptionEntity): void {\n    const exceptionMsg = error.Message || '';\n    const date = error.date || new Date();\n    const localDate = moment(date).format('YYYY-MM-DD HH:mm:ss');\n    const detail = error.Detail || `${error.Message}\\r\\nåçæ¶é´ï¼${localDate}\\r\\nè¯¦ç»ä¿¡æ¯ï¼${error.innerMessage}` || '';\n\n    const innerMessage = error.innerMessage || null;\n    let bsModalRef: BsModalRef;\n    const options = {\n      // title: this.languageService.serverNotifyTitle,\n      showMaxButton: false,\n      buttons: [\n        {\n          text: this.langService.roger,\n          cls: 'btn btn-primary btn-lg',\n          handle: () => {\n            bsModalRef.close();\n          }\n        }\n      ],\n      // showHeader: false,\n      width: 440,\n      height: 200,\n      safeHtml: false,\n      exception: {\n        date: localDate,\n        message: innerMessage,\n        copyButton: {\n          text: this.langService.copy,\n          onClick: (e) => {\n            const result = DeviceAbility.copyToClipboard(detail);\n            const text = result ? this.langService.copySuccess : this.langService.copyFailed;\n            bsModalRef.content.showMiniNotify(text, 1500);\n          }\n        }\n      }\n    };\n    this.displayError(error);\n    bsModalRef = this.messagerService.show('exception', exceptionMsg, options);\n  }\n  /**\n   * å¨æ§å¶å°ä¸­æ¾ç¤ºéè¯¯ä¿¡æ¯\n   */\n  private displayError(error: ServerExceptionEntity) {\n    if (!error) {\n      return;\n    }\n    if (!console || !console.error) {\n      return;\n    }\n    console.error(error);\n  }\n}\n\n/**\n * è´å½éè¯¯çº§å«å¼å¸¸å¤ç\n */\nexport class FatalExceptionStrategy extends ExceptionStrategy implements IExceptionStrategy {\n  constructor(\n    messagerService: MessagerService,\n    @Optional() languageService: LanguageService) {\n    super(messagerService, languageService);\n  }\n\n  public handleException(error: ServerExceptionEntity): void {\n    if (!error) {\n      return;\n    }\n\n    this.messagerService.error(error.Message);\n  }\n}\n","import { Optional, Injectable } from '@angular/core';\nimport { MessagerService } from '@farris/ui-messager';\nimport { LanguageService } from '../languag.service';\nimport { ServerExceptionEntity, ExceptionLevel } from './types';\nimport {\n  IExceptionStrategy, InfoExceptionStrategy, WarningExceptionStrategy, ErrorExceptionStrategy, FatalExceptionStrategy\n} from './exception_strategy';\n\n\n@Injectable()\nexport class ExceptionFactory {\n\n  /**\n   * å¼å¸¸å·¥åå®ä¾\n   */\n  private static exceptionFactory: ExceptionFactory = null;\n\n  /**\n   * æé å½æ°\n   * @param messagerService æ¶æ¯æå¡\n   * @param languageService å¤è¯­è¨æå¡\n   */\n  private constructor(\n    public messagerService: MessagerService,\n    @Optional() private languageService: LanguageService,\n  ) {\n\n  }\n\n  /**\n   * è·åå·¥åå®ä¾\n   * @param messagerService æ¶æ¯æå¡\n   * @param languageService å¤è¯­è¨æå¡\n   */\n  public static getInstance(messagerService: MessagerService, languageService: LanguageService): ExceptionFactory {\n    if (!this.exceptionFactory) {\n      this.exceptionFactory = new ExceptionFactory(messagerService, languageService);\n    }\n\n    return this.exceptionFactory;\n  }\n\n  /**\n   * è·åå¼å¸¸å¤çç­ç¥\n   * @param exceptionLevel å¼å¸¸ç­çº§\n   */\n  public getExceptionHandleStrategy(exceptionLevel: ExceptionLevel): IExceptionStrategy {\n    let exceptionStrategy: IExceptionStrategy;\n\n    switch (exceptionLevel) {\n      case ExceptionLevel.Info:\n        exceptionStrategy = new InfoExceptionStrategy(this.messagerService, this.languageService);\n        break;\n      case ExceptionLevel.Warning:\n        exceptionStrategy = new WarningExceptionStrategy(this.messagerService, this.languageService);\n        break;\n      case ExceptionLevel.Error:\n        exceptionStrategy = new ErrorExceptionStrategy(this.messagerService, this.languageService);\n        break;\n      case ExceptionLevel.Fatal:\n        exceptionStrategy = new FatalExceptionStrategy(this.messagerService, this.languageService);\n        break;\n      default:\n\n        // é»è®¤å¼å¸¸ç­çº§æ¯éè¯¯\n        exceptionStrategy = new ErrorExceptionStrategy(this.messagerService, this.languageService);\n        break;\n    }\n\n    return exceptionStrategy;\n  }\n}\n","// https://github.com/typeslick/status-code-enum\nenum HttpStatusType {\n    Info = 1,\n    Success,\n    Redirect,\n    ClientError,\n    ServerError\n}\n\n/**\n * httpéç¨ç±»\n */\nclass HttpUtil {\n\n    /**\n     * åºäºhttpç¶æç è¿åç¶æç±»å\n     * @param httpResponseSatus httpè¯·æ±è¿åç¶æç \n     * @returns null | HttpStatusType\n     */\n    public static getHttpStatusType(httpResponseSatus: number): any {\n        if (!httpResponseSatus) {\n            return null;\n        }\n        \n        let statusType = null; // é»è®¤å¼ä¸ºç©º\n        \n        if (httpResponseSatus < 100 || httpResponseSatus > 600) {\n            statusType = null; // ä¸åçç¶æç \n        } else if (httpResponseSatus >= 100 && httpResponseSatus < 200) {\n            statusType = HttpStatusType.Info;\n        } else if (httpResponseSatus >= 200 && httpResponseSatus < 300) {\n            statusType = HttpStatusType.Success;\n        } else if (httpResponseSatus >= 300 && httpResponseSatus < 400) {\n            statusType = HttpStatusType.Redirect;\n        } else if (httpResponseSatus >= 400 && httpResponseSatus < 500) {\n            statusType = HttpStatusType.ClientError;\n        } else if (httpResponseSatus >= 500 && httpResponseSatus < 600) {\n            statusType = HttpStatusType.ServerError;\n        }\n\n        return statusType;\n    }\n}\n\nexport { HttpUtil, HttpStatusType };","import { Injectable, Optional } from '@angular/core';\nimport { HttpErrorResponse } from '@angular/common/http';\n\nimport { FormMessageService } from '../form-message.service';\nimport { LanguageService } from '../languag.service';\nimport { HttpUtil, HttpStatusType } from '../util/http';\n\n/**\n * è¡¨åéè¯¯æç¤ºæå¡\n * @description ç»ä¸å¤çååç«¯å¼å¸¸\n */\n@Injectable()\nclass FormErrorService {\n\n  constructor(\n    private msgService: FormMessageService,\n    @Optional() private languageService: LanguageService\n  ) {\n  }\n\n  /**\n   * å¼å¸¸è·¯ç±æ¹æ³\n   */\n  public exception(message: string, error: any) {\n    // éå¯¹sessionå¤±æåç¹æ®å¤ç\n    if (error && error.hasOwnProperty('expired') && error['expired'] === true) {\n      return;\n    }\n    if (error && this.isHttpErrorResponse(error)) {\n      this.httpErrorHandler(error);\n    } else {\n\n      // todo: ç»åå¼å¸¸å¤çåï¼ç»§ç»­æè§£è¯¥æ¹æ³\n      this.commonErrorHandler(message);\n    }\n  }\n\n  /**\n   * httpè¯·æ±å¼å¸¸å¤çå¨\n   */\n  public httpErrorHandler(httpError: HttpErrorResponse): void {\n    if (!httpError) {\n      return;\n    }\n\n    const statusType = HttpUtil.getHttpStatusType(httpError.status);\n\n    switch (statusType) {\n      case HttpStatusType.ClientError:\n        if (httpError.status === 401) {\n          this.msgService.http401Error(httpError);\n          break;\n        }\n\n        this.msgService.httpErrorInClient(httpError);\n        break;\n      case HttpStatusType.ServerError:\n        this.msgService.httpErrorInServer(httpError);\n        break;\n      default:\n        throw new Error('Get invalid status code when using httpErrorHandler method.');\n    }\n  }\n\n  private commonErrorHandler(errorMsg: string): void {\n    if (!errorMsg) {\n      return;\n    }\n    this.msgService.error(errorMsg);\n  }\n  /**\n   * httpErrorResponse like\n   * @param error å¼å¸¸\n   */\n  private isHttpErrorResponse(error) {\n    if (!error) {\n      return false;\n    }\n    if (typeof error !== 'object') {\n      return false;\n    }\n    if (error.name === 'HttpErrorResponse' && error.hasOwnProperty('status') && error.hasOwnProperty('error')) {\n      return true;\n    }\n    if (error instanceof HttpErrorResponse) {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport { FormErrorService };\n\n","import { Inject, Injectable, LOCALE_ID, Optional } from '@angular/core';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { Observable, Subject, of, from } from 'rxjs';\nimport { MessagerService } from '@farris/ui-messager';\nimport { fromPromise } from 'rxjs/observable/fromPromise';\nimport { LanguageService } from './languag.service';\nimport { ServerExceptionEntity, ExceptionFactory, IExceptionStrategy } from './error/index';\nimport { BsModalRef } from '@farris/ui-modal';\n\n/**\n * è¡¨åæ¶æ¯æå¡\n * @scope FormModule\n * @summary\n * 1ãåè£@farris/uiçæ¶æ¯æå¡ï¼\n * 2ãæä¾éå¯¹è¡¨åçå¿«æ·æ¹æ³ï¼\n */\n@Injectable()\nclass FormMessageService {\n\n  /**\n   * æé å½æ°\n   * æ³¨å¥@farris/uiçLoadingService\n   */\n  constructor(\n    private messagerService: MessagerService,\n    @Optional() private languageService: LanguageService,\n    @Inject(LOCALE_ID) private curLanguage: string, // ä¸ºäºç¬ç«å¼¹åºéæ°ç»å½æç¤ºæ¡ï¼åæ¢å°è¿è¡æ¡æ¶httpæå¡åå¯ä»¥å é¤\n  ) {\n    this.languageService = this.languageService || LanguageService.getInstance();\n  }\n  /**\n   * questionå¼¹çª\n   */\n  public question(content: string): Observable<boolean> {\n    const confirmResult$: Promise<boolean> = this.confirmPromise(content);\n    return from(confirmResult$);\n  }\n\n  /**\n   * å¸¦é»è®¤ç¦ç¹çå¼¹åºæç¤º\n   * @param content åå®¹\n   */\n  public question2(content: string): Observable<boolean> {\n    const promise$: Promise<boolean> = new Promise((resolve, reject) => {\n      const dialogRef = this.messagerService.question2(\n        content,\n        [\n          {\n            text: this.languageService.no,\n            cls: 'btn btn-secondary',\n            handle: () => {\n              resolve(false);\n              dialogRef.close();\n            }\n          },\n          {\n            text: this.languageService.yes,\n            cls: 'btn btn-primary',\n            defaultFocus: true,\n            handle: () => {\n              resolve(true);\n              dialogRef.close();\n            }\n          }\n        ]);\n    });\n    return from(promise$);\n  }\n\n  /**\n   * å¼¹åºè¾å¥å¯¹è¯æ¡\n   * @param title æ é¢\n   */\n  public prompt(title: string): Observable<any> {\n    return this.messagerService.prompt(title);\n  }\n\n  /**\n   * ä½¿ç¨Promiseå®ä¾åè£åè°æ¹æ³ï¼ä»¥åæ­¥åè°æ¹æ³æ§è¡åç»æ\n   * @param content\n   */\n  private confirmPromise(content: string): Promise<boolean> {\n    return new Promise((resolve, reject) => {\n      this.messagerService.question(\n        content,\n        () => { resolve(true); },\n        () => { resolve(false); }\n      );\n    });\n  }\n\n  /**\n   * ç¡®è®¤å¼¹æ¡\n   * @param content å¼¹åºåå®¹æç¤º\n   */\n  public confirm(content: string): Observable<boolean> {\n    return this.messagerService.confirm(content);\n  }\n\n  /**\n   * æ¶æ¯å¼¹æ¡\n   */\n  public info(content: string) {\n    this.messagerService.info(content);\n  }\n\n  /**\n   * éè¯¯å¼¹æ¡\n   */\n  public error(content: string) {\n    this.messagerService.error(content);\n  }\n\n  /**\n   * è­¦åå¼¹æ¡\n   */\n  public warning(content: string) {\n    this.messagerService.warning(content);\n  }\n\n  /**\n   * æå¡å¨ç«¯å¼å¸¸æç¤ºå¼¹æ¡\n   */\n  public httpErrorInServer(httpError: HttpErrorResponse): void {\n    let error: ServerExceptionEntity = httpError.error;\n    if (typeof (error) === 'string') {\n      try {\n        error = JSON.parse(error);\n      } catch (e) { }\n    }\n    if (!error || error.Level == null || error.Level == undefined) { // æªå°è£errorææªè®¾ç½®å¼å¸¸ç­çº§\n      this.messagerService.error(httpError.message);\n      return;\n    }\n    const exceptionStrategy: IExceptionStrategy = ExceptionFactory.getInstance(this.messagerService, this.languageService).getExceptionHandleStrategy(error.Level);\n    exceptionStrategy.handleException(error);\n  }\n\n  /**\n   * å®¢æ·ç«¯å¼å¸¸æç¤ºå¼¹æ¡\n   */\n  public httpErrorInClient(httpError: HttpErrorResponse): void {\n    if (!httpError) {\n      return;\n    }\n    const message = httpError.error && httpError.error.error && httpError.error.error.message;\n    const exceptionMsg = message || httpError.message && httpError.message.replace(/http:\\/\\/[a-zA-Z0-9.:]{1,}/, '');\n    const options = {\n      // title: this.languageService.clientNotifyTitle,\n      // showMaxButton: true,\n      showHeader: false,\n      width: 400,\n      height: 200,\n      safeHtml: false\n    };\n\n    this.messagerService.show('error', exceptionMsg, options);\n  }\n\n  /**\n   * 401å¼å¸¸å¤ç\n   * ä¸ºäºç¬ç«å¼¹åºéæ°ç»å½æç¤ºæ¡ï¼åæ¢å°è¿è¡æ¡æ¶httpæå¡åå¯ä»¥å é¤\n   * @param httpError å¼å¸¸\n   */\n  public http401Error(httpError: HttpErrorResponse): void {\n    const dialogShownKey = '401ErrorShownFlag';\n\n    if (!httpError || window[dialogShownKey]) {\n      return;\n    }\n\n    const i18n = {\n      en: {\n        title: 'Warning',\n        sessionInvalid: 'Your login has expired, please login again.',\n        ok: 'ok',\n        cancel: 'cancel'\n      },\n      'zh-CHS': {\n        title: 'æç¤º',\n        sessionInvalid: 'ç¨æ·ç»å½ä¿¡æ¯å·²å¤±æï¼æ¯å¦éæ°ç»å½?',\n        ok: 'ç¡®è®¤',\n        cancel: 'åæ¶'\n      }\n    };\n    this.curLanguage = this.curLanguage || 'zh-CHS';\n\n    const messageOptions = {\n      title: i18n[this.curLanguage].title,\n      initialState: {\n        okText: i18n[this.curLanguage].ok,\n        okHandle: () => {\n          modalRef.close();\n          window[dialogShownKey] = false;\n          const eventResult = httpError && httpError.error || {};\n          const redirectUri = eventResult.redirect_uri || '/login.html';\n          window.location.href = `/logout.html#?logout-before-redirect=true&loginUri=${redirectUri}`;\n        },\n        cancelText: i18n[this.curLanguage].cancel,\n        cancelHandle: () => {\n          modalRef.close();\n          window[dialogShownKey] = false;\n        }\n      },\n      showHeader: true,\n      width: 420,\n      height: 180,\n      fitContent: false\n    };\n    const modalRef = this.messagerService.show('question', i18n[this.curLanguage].sessionInvalid, messageOptions);\n    window[dialogShownKey] = true;\n    if (modalRef && modalRef.dialog && modalRef.dialog.instance.closed) {\n      modalRef.dialog.instance.closed.subscribe(() => {\n        window[dialogShownKey] = false;\n      });\n    }\n  }\n\n}\n\nexport { FormMessageService };\n\n","import { Injectable, Optional } from '@angular/core';\nimport { NotifyService, NotifyOptions } from '@farris/ui-notify';\nimport { LanguageService } from './languag.service';\n\n/**\n * éç¥æå¡\n * @scope FormModule\n * @description\n * æ¶æ¯æç¤ºä½¿ç¨ç­ç¥ï¼æåä½¿ç¨successï¼å¤±è´¥ä½¿ç¨errorï¼è­¦åä½¿ç¨warningï¼å¶ä»åºæ¯ä½¿ç¨info\n */\n@Injectable()\nclass FormNotifyService {\n\n  /**\n   * æé å½æ°\n   * æ³¨å¥@farris/uiçNotifyService\n   */\n  constructor(private notifyService: NotifyService,\n    @Optional() private languageService: LanguageService\n  ) {\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * ä¿¡æ¯æç¤º\n   * @param content åå®¹\n   */\n  public default(content: string) {\n    return this.notifyService.default(<NotifyOptions>{\n      title: this.languageService.notifyTitle,\n      msg: content,\n      timeout: 3000\n    });\n  }\n\n  /**\n   * ä¿¡æ¯æç¤º\n   * @param content åå®¹\n   */\n  public info(content: string, options?: { [prop: string]: any }) {\n    const notifyOptions: NotifyOptions = {\n      title: this.languageService.notifyTitle,\n      msg: content,\n      timeout: 3000\n    } as NotifyOptions;\n    if (options && options.hideTitle) {\n      delete notifyOptions.title;\n    }\n    return this.notifyService.info(notifyOptions);\n  }\n\n  /**\n   * æåæç¤º\n   * @param content åå®¹\n   * @param options? éé¡¹ {shorTitle: false}\n   */\n  public success(content: string, options?: { [prop: string]: any }) {\n    const notifyOptions: NotifyOptions = {\n      title: this.languageService.notifyTitle,\n      msg: content,\n      timeout: 3000\n    } as NotifyOptions;\n    if (options && options.hideTitle) {\n      delete notifyOptions.title;\n    }\n    this.notifyService.success(notifyOptions);\n  }\n\n  /**\n   * è­¦åæç¤º\n   * @param content åå®¹\n   * @param options éé¡¹\n   */\n  public warning(content: string, options?: { [prop: string]: any }) {\n    const notifyOptions: NotifyOptions = {\n      title: this.languageService.notifyTitle,\n      msg: content,\n      timeout: 3000\n    } as NotifyOptions;\n    if (options && options.hideTitle) {\n      delete notifyOptions.title;\n    }\n    this.notifyService.warning(notifyOptions);\n  }\n\n  /**\n   * éè¯¯æç¤º\n   * @param content åå®¹\n   */\n  public error(content: string, options?: { [prop: string]: any }) {\n    const notifyOptions: NotifyOptions = {\n      title: this.languageService.notifyTitle,\n      msg: content,\n      timeout: 3000\n    } as NotifyOptions;\n    if (options && options.hideTitle) {\n      delete notifyOptions.title;\n    }\n    this.notifyService.error(notifyOptions);\n  }\n}\n\nexport { FormNotifyService };\n","import { Injectable } from '@angular/core';\nimport { WizardService, WizardEventType } from '@farris/ui-wizard';\nimport { FrameContext } from '@farris/devkit';\n\n@Injectable()\nexport class FormWizardService {\n    constructor(\n        private wizardSer: WizardService\n    ) { }\n\n    public preStep() {\n        const currentPageId = this.wizardSer.getCurrentPageId();\n        this.wizardSer.updateWizardState(WizardEventType.Prev, currentPageId);\n    }\n    public nextStep() {\n        const currentPageId = this.wizardSer.getCurrentPageId();\n        this.wizardSer.updateWizardState(WizardEventType.Next, currentPageId);\n    }\n    public cancelWizard() {\n        this.wizardSer.cancelWizard();\n    }\n\n    public finishWizard() {\n        this.wizardSer.finishWizard();\n    }\n}\n","import { Injectable } from '@angular/core';\n\n/**\n * æ£æ¥è§å\n * @scope FormModule\n */\n@Injectable()\nclass CheckService {\n\n  constructor() {\n  }\n\n  /**\n   * æ£æ¥æ¯å¦ä¸ºç©º\n   */\n  public checkEmpty(value: any) {\n    return !!value;\n  }\n}\n\nexport { CheckService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, empty, of } from 'rxjs';\nimport { CommandContext } from '@farris/devkit';\nimport { FormMessageService } from './form-message.service';\nimport { FormNotifyService } from './form-notify.service';\nimport { LanguageService } from './languag.service';\n\n/**\n * æ°æ®æ£æ¥æå¡\n */\n@Injectable()\nclass DataCheckService {\n\n  constructor(\n    private messageService: FormMessageService,\n    private formNotifyService: FormNotifyService,\n    @Optional() private languageService: LanguageService,\n  ) {\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * ç¼è¾åæ£æ¥\n   */\n  public checkBeforeEdit(idToEdit: string): any {\n\n    const ifSkipCheck = this.ifSkipCheck(idToEdit);\n    if (ifSkipCheck === true) {\n      return true;\n    }\n\n    if (idToEdit) {\n      return true;\n    }\n\n    this.formNotifyService.warning(this.languageService.plsSelectEditData, { hideTitle: true });\n    return empty();\n  }\n\n  /**\n   * æ¥çåæ£æ¥\n   */\n  public checkBeforeView(idToView: string): any {\n    const ifSkipCheck = this.ifSkipCheck(idToView);\n    if (ifSkipCheck === true) {\n      return true;\n    }\n\n    if (idToView) {\n      return true;\n    }\n\n    this.formNotifyService.warning(this.languageService.plsSelectViewData, { hideTitle: true });\n    return empty();\n  }\n  /**\n   * èè¡¨åè·³è¿æ£æ¥\n   * @todoï¼å¾å é¤ï¼å¼å®¹èè¡¨å\n   */\n  public ifSkipCheck(id: string): boolean {\n    const context = this['context'] as CommandContext;\n    const params = context.command.params;\n\n    // è¡¨åæ²¡æéæ°ä¿å­è¿çæåµ\n    if (params.hasOwnProperty('idToEdit') === false && params.hasOwnProperty('idToView') === false) {\n      return true;\n    }\n\n    // ä¿å­è¿ä½æ²¡æå¡«åæ°çæåµ\n    // @todo: ä¼æ¼æç©ºä¸²çæåµï¼ç®åä¸»é®è§£æçè¿åå¼æ¯undefinedï¼æä¸èèç©ºä¸²åºæ¯\n    if (id === '') {\n      return true;\n    }\n\n    return false;\n  }\n}\n\nexport { DataCheckService };\n","import { Injectable } from '@angular/core';\nimport { FrameEventBus } from '@farris/devkit';\n\n/**\n * æ¡æ¶äºä»¶æå¡\n * @scope FormModule\n */\n@Injectable()\nclass EventService {\n\n  constructor(private eventBus: FrameEventBus) {\n  }\n\n  trigger(eventType: string, eventData?: any, frameIds?: string[]) {\n    this.eventBus.trigger(eventType, eventData, frameIds);\n  }\n}\n\nexport { EventService };\n","import { Injectable } from '@angular/core';\n// tslint:disable: no-unused-expression\n/**\n * èåç¶ææå¡\n * @scope FormModule\n */\n@Injectable()\nclass MenuStateService {\n    private readonly COMMAND_SERVICE_LINK_STORAGE_KEY = 'COMMAND_SERVICE_LINK_STORAGE_KEY';\n    private getState() {\n        const data = !!sessionStorage && sessionStorage.getItem(this.COMMAND_SERVICE_LINK_STORAGE_KEY) || null;\n        if (!!data) {\n            return JSON.parse(data);\n        }\n        return {};\n    }\n    private setState(links) {\n        !!sessionStorage && sessionStorage.setItem(this.COMMAND_SERVICE_LINK_STORAGE_KEY, JSON.stringify(links));\n    }\n    public addMenuState(parentMenuId: string, childMenuId: string, status: boolean = true) {\n        if (!childMenuId) {\n            return;\n        }\n        const state = this.getState();\n        const isParentExist = !!state && state.hasOwnProperty(parentMenuId);\n        const childItem = { id: childMenuId, status };\n        if (isParentExist) {\n            const parent = state[parentMenuId];\n            const isChildItemExist = parent.find(item => item.id === childMenuId);\n            if (!isChildItemExist) {\n                state[parentMenuId].push(childItem);\n            }\n        } else {\n            state[parentMenuId] = [childItem];\n        }\n        this.setState(state);\n    }\n    public getMenuState(parentMenuId: string, childMenuId?: string) {\n        const state = this.getState();\n        if (state === null) {\n            return null;\n        }\n        const isParentExist = state.hasOwnProperty(parentMenuId);\n        if (!isParentExist) {\n            return null;\n        }\n        const parentMenu = state[parentMenuId];\n        const childMenu = parentMenu.filter(item => item.status === true);\n        if (typeof childMenuId === 'undefined' || childMenuId.length < 1) {\n            return childMenu;\n        }\n        return parentMenu.filter(item => item.status && item.id === childMenuId);\n    }\n    public updateMenuState(childMenuId: string, status: boolean) {\n        const state = this.getState();\n        if (state === null) {\n            return;\n        }\n        Object.keys(state).forEach(key => {\n            const childMenu = state[key].find(item => item.id === childMenuId);\n            if (!!childMenu) {\n                childMenu.status = status;\n            }\n        });\n        this.setState(state);\n    }\n    public removeMenu(menuId: string) {\n        this.removeParentMenu(menuId);\n        this.removeChildMenu(menuId);\n    }\n    private removeParentMenu(menuId: string) {\n        const state = this.getState();\n        if (state === null) {\n            return null;\n        }\n        Object.keys(state).forEach(item => {\n            if (item === menuId && state[menuId].length < 1) {\n                delete state[item];\n            }\n        });\n        this.setState(state);\n    }\n    private removeChildMenu(menuId: string) {\n        const state = this.getState();\n        if (state === null) {\n            return;\n        }\n        Object.keys(state).forEach(parentMenuId => {\n            const childMenus = state[parentMenuId];\n            if (childMenus && childMenus.length > 0) {\n                childMenus.forEach((child, index) => {\n                    if (child.id === menuId) {\n                        childMenus.splice(index, 1);\n                    }\n                });\n            }\n        });\n        this.setState(state);\n    }\n}\n\nexport { MenuStateService };\n","/*\n * @Author: Witt\n * @Date: 2018-11-15 15:56:11\n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-07-09 16:23:04\n */\n\nimport { Injectable, Optional } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { RouterParamService } from '@farris/devkit';\nimport { FrameworkService, AppService } from '@gsp-sys/rtf-common';\nimport { MenuStateService } from './menu-state.service';\nimport { Subject } from 'rxjs';\nimport { LanguageService } from './languag.service';\n\n// tslint:disable: no-string-literal\n/**\n * è·¯ç±æå¡\n * @scope FormModule\n */\n@Injectable()\nclass RouterService {\n  /**\n   * ä¸æ¬¡åæ¢çTabId\n   */\n  private lastSwitchId: string = null;\n  /**\n   * ä¸æ¬¡å³é­çTabId\n   */\n  private lastCloseId: string = null;\n  // private menuStateService: MenuStateService = null;\n  public onClosed: Subject<any> = null;\n  constructor(\n    private router: Router,\n    private routerParamService: RouterParamService,\n    private frameworkService: FrameworkService,\n    @Optional() private appService: AppService,\n    @Optional() private menuStateService: MenuStateService,\n    @Optional() private languageService: LanguageService,\n  ) {\n    if (!this.menuStateService) {\n      this.menuStateService = new MenuStateService();\n    }\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n    this.onClosed = new Subject<any>();\n    this.registerEvent();\n  }\n\n  /**\n   * åæ¢è·¯ç±\n   * @param url èåID\n   * @param params è·¯ç±åæ°\n   */\n  public route(url: string, params: any) {\n    url = this.router.createUrlTree([url]).toString();\n    this.setParams(url, params);\n    this.router.navigateByUrl(url);\n  }\n  /**\n   * æ³¨åè¿è¡æ¡æ¶äºä»¶\n   */\n  public registerEvent() {\n    const params: any = this.getParams(window.location.hash);\n    const menuId = this.getAppId() || this.getFuncId();\n    this.frameworkService.eventListner(this.frameworkService.FuncSwitch, e => {\n      if (!e) {\n        return;\n      }\n      const id = this.getOriginalId(e.id) || e.tabId;\n      const menuState = this.menuStateService.getMenuState(id);\n      if (!!id && menuId === id && !!menuState && menuState.length > 0) {\n        this.formReload();\n        this.lastSwitchId = id;\n      }\n    }, params);\n\n    this.frameworkService.eventListner(this.frameworkService.FuncClosed, e => {\n      if (!e) {\n        return;\n      }\n      this.onClosed.next(e);\n      const id = this.getOriginalId(e.id) || e.tabId;\n      if (menuId === id) {\n        return;\n      }\n      const menuState = this.menuStateService.getMenuState(menuId, id);\n      // && id !== this.lastCloseId\n      if (!!id && !!menuState && menuState.length > 0) {\n        this.removeMenuState(id);\n        this.formReload();\n        this.lastCloseId = id;\n      }\n    }, params);\n  }\n\n  private removeMenuState(tabId: string) {\n    if (this['context']) {\n      this.menuStateService.removeMenu(tabId);\n    }\n  }\n  /**\n   * è·ååå§åè½id\n   * @param id id\n   */\n  private getOriginalId(id: string) {\n    if (!id) {\n      return id;\n    }\n    if (id.indexOf('_') !== -1) {\n      id = id.split('_')[0];\n    }\n    return id;\n  }\n  /**\n   * å·æ°ç»ä»¶æ°æ®\n   */\n  private formReload() {\n    try {\n      this['context']['frameContext']['appContext']['refresh']();\n    } catch{ }\n  }\n  /**\n   * æå¼åè½èå\n   * @param funcId èååç \n   * @param params è·¯ç±åæ°ï¼å½¢å¦ï¼ { key1: val1, key2: value2 }\n   */\n  public openMenu(funcId: string, params: any, reload?: boolean) {\n    if (typeof reload === 'undefined' || typeof reload !== 'boolean') {\n      reload = false;\n    }\n    const paramsMap = this.buildParamMap(params);\n    const parentMenuId = this.getFuncId() || this.getAppId();\n    this.menuStateService.addMenuState(parentMenuId, funcId);\n    paramsMap.set('WEB_FORM_ROUTER_PARENT_ID', parentMenuId);\n    this.frameworkService.openFuncWithParam(funcId, paramsMap, reload);\n  }\n\n  /**\n   * æå¼åºç¨\n   * @param appId åºç¨åç \n   * @param appEntrance åºç¨å¥å£\n   * @param params è·¯ç±åæ°ï¼å½¢å¦ï¼ { key1: val1, key2: value2 }\n   */\n  public openApp(appId: string, appEntrance: string, params: any, reload?: boolean) {\n    if (typeof reload === 'undefined' || typeof reload !== 'boolean') {\n      reload = false;\n    }\n    const paramMap = this.buildParamMap(params);\n    const parentMenuId = this.getAppId() || this.getFuncId();\n    this.menuStateService.addMenuState(parentMenuId, appId);\n    paramMap.set('WEB_FORM_ROUTER_PARENT_ID', parentMenuId);\n    if (!!this.appService) {\n      this.appService.openApp(appId, appEntrance, paramMap, reload);\n    }\n  }\n\n  /**\n   * æé åæ°\n   */\n  private buildParamMap(params: any): Map<string, string> {\n    if (typeof params === 'undefined' || params === null || (typeof params === 'string' && params.length < 1)) {\n      params = {};\n    }\n    const paramMap = new Map<string, any>();\n    if (typeof params === 'object') {\n      params = JSON.stringify(params);\n    }\n    params = window['encodeURIComponent'](params);\n    paramMap.set('WEB_FORM_ROUTE_PARAMS', params);\n    return paramMap;\n  }\n\n  /**\n   * å³é­åè½èå\n   */\n  public closeMenu() {\n    const funcId: string | null = this.getFuncId();\n    const appId: string | null = this.getAppId();\n    const { isDialogComponent, rootComponent } = this.findDialog();\n    if (isDialogComponent) {\n      const modalRef = this.get(rootComponent, 'dialogRef');\n      modalRef['close']();\n      return;\n    }\n\n    if (funcId !== null && typeof funcId === 'string' && funcId.length > 0) {\n      this.closeFunc(funcId);\n    } else if (appId !== null && typeof appId === 'string' && appId.length > 0) {\n      const appEntrance = this.getAppEntrance();\n      this.closeApp(appId, appEntrance);\n    } else {\n      console.error(this.languageService['notSupportMenuType']);\n    }\n  }\n\n  /**\n   * æ¥æ¾å¼¹çªç»ä»¶\n   */\n  private findDialog() {\n    let frameContext = this.get(this, 'context.frameContext');\n    let isDialogComponent = this.get(frameContext, 'frameComponent.isDialogRootComponent', false);\n\n    let parentFrameContext = this.get(frameContext, 'parent');\n    while (parentFrameContext != null && !isDialogComponent) {\n      frameContext = this.get(frameContext, 'parent');\n      parentFrameContext = this.get(parentFrameContext, 'parent');\n      isDialogComponent = this.get(frameContext, 'frameComponent.isDialogRootComponent', false);\n    }\n    const rootComponent = this.get(frameContext, 'frameComponent');\n    return { isDialogComponent, rootComponent };\n\n  }\n\n  /**\n   * loadsh get\n   * @param object å¯¹è±¡\n   * @param path è·¯å¾\n   * @param defaultVal é»è®¤å¼\n   */\n  private get(object: any, path: Array<string> | string, defaultVal: any = null) {\n    const PATH = Array.isArray(path)\n      ? path\n      : path.split('.').filter(i => i.length);\n    if (!PATH.length) {\n      return object === undefined ? defaultVal : object;\n    }\n\n    if (object === null || object === undefined || typeof (object[PATH[0]]) === 'undefined') {\n      return defaultVal;\n    }\n\n    return this.get(object[PATH.shift()], PATH, defaultVal);\n  }\n\n  /**\n   * å³é­èå\n   * @param funcId èåid\n   */\n  public closeFunc(funcId?: string) {\n    if (!funcId) {\n      funcId = this.getFuncId();\n    }\n    if (!!this.frameworkService) {\n      this.frameworkService.closeFunc(funcId).subscribe();\n    }\n  }\n\n  /**\n   * å³é­app\n   * @param appId åºç¨id\n   */\n  public closeApp(appId?: string, appEntrance?: string) {\n    if (!appId) {\n      appId = this.getAppId();\n    }\n    if (typeof appEntrance === 'undefined') {\n      appEntrance = this.getAppEntrance();\n    }\n    if (!!this.appService) {\n      this.appService.closeApp(appId, appEntrance).subscribe();\n    }\n  }\n\n  /**\n   * è®¾ç½®åæ°\n   * @param params è·¯ç±åæ°\n   */\n  private setParams(url: string, params: string | { [key: string]: any; }) {\n    let paramsObj;\n    if (typeof params === 'string' && params !== '') {\n      paramsObj = JSON.parse(params);\n    } else {\n      paramsObj = params || {};\n    }\n\n    // è®¾ç½®è·¯ç±åæ°\n    this.routerParamService.setParams(url, paramsObj);\n  }\n\n  /**\n   * è·åfuncId\n   */\n  private getFuncId() {\n    const hash = window.location.hash;\n    if (!hash) {\n      return null;\n    }\n    const params = this.decodeURLParams(hash);\n    if (params && params.hasOwnProperty('funcId')) {\n      return params.funcId;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * è·åappId\n   */\n  private getAppId() {\n    const hash = window.location.hash;\n    if (!hash) {\n      return null;\n    }\n    const params = this.decodeURLParams(hash);\n    if (params && params.hasOwnProperty('appId')) {\n      return params.appId;\n    } else {\n      return null;\n    }\n  }\n\n  private getParentMenuId() {\n    const hash = window.location.hash;\n    if (!hash) {\n      return null;\n    }\n    const params = this.decodeURLParams(hash);\n    if (params && params.hasOwnProperty('WEB_FORM_ROUTER_PARENT_ID')) {\n      return params.WEB_FORM_ROUTER_PARENT_ID;\n    } else {\n      return null;\n    }\n  }\n  /**\n   * è·ååºç¨å¥å£\n   */\n  private getAppEntrance() {\n    const hash = window.location.hash;\n    if (!hash) {\n      return null;\n    }\n    const params = this.decodeURLParams(hash);\n    if (params && params.hasOwnProperty('appEntrance')) {\n      return params.appEntrance;\n    } else {\n      return null;\n    }\n  }\n  /**\n   * è§£ç åæ°\n   * @param query search|hash\n   */\n  private decodeURLParams(query: string): { [propName: string]: any } {\n    if (typeof query === 'undefined') {\n      query = window.location.hash || window.location.search;\n    }\n    const hashes = query.slice(query.indexOf('?') + 1).split('&');\n    return hashes.reduce((params, hash) => {\n      const split = hash.indexOf('=');\n      const key = hash.slice(0, split);\n      const val = hash.slice(split + 1);\n      return Object.assign(params, { [key]: decodeURIComponent(val) });\n    }, {});\n  }\n  private getParams(queryString: string): { [propName: string]: any } {\n    if (!queryString) {\n      return {};\n    }\n    const hashes = queryString.slice(queryString.indexOf('?') + 1).split('&');\n    return hashes.reduce((params, hash) => {\n      const split = hash.indexOf('=');\n      const key = hash.slice(0, split);\n      const val = hash.slice(split + 1);\n      return Object.assign(params, { [key]: decodeURIComponent(val) });\n    }, {});\n  }\n}\n\nexport { RouterService };\n","import { RequestInfo } from '@farris/bef';\n// tslint:disable: unified-signatures\nexport const TAB_EVENT = {\n    /**\n     * Tabå³é­å\n     */\n    onTabClosed: 'FuncClosed',\n    /**\n     * Tabå³é­å\n     */\n    onTabClosing: 'beforeFuncCloseEvent',\n    /**\n     * Tabåæ¢\n     */\n    onTabSwitched: 'funcSwitchEvent'\n};\n\nexport const TAB_QUERY_STRING = {\n    TabId: 'tabId',\n    AppType: 'appType',\n    AppId: 'appId',\n    AppEntrance: 'appEntrance',\n    FuncId: 'funcId'\n};\n\n/**\n * å¸¦RequestInfoçbodyå¯¹è±¡\n */\nexport interface BodyWithRequestInfo {\n    requestInfo: RequestInfo;\n    [key: string]: any;\n}\n\nexport const WEB_FORM_ROUTE_PARAMS_KEY = 'WEB_FORM_ROUTE_PARAMS';\nexport const enum DataType{\n  map = '[object Map]'\n}\nexport type KeyObject<T = any> = { key: T };","import { Injectable } from '@angular/core';\n\n/**\n * æ¥è¯¢åæ°æå¡\n * @scope FormModule\n */\n@Injectable()\nexport class QuerystringService {\n    /**\n     * è§£ç åæ°\n     * @param queryString search|hash\n     */\n    public parse(queryString: string): { [propName: string]: any } {\n        if (!queryString) {\n            return {};\n        }\n        const hashes = queryString.slice(queryString.indexOf('?') + 1).split('&');\n        return hashes.reduce((params, hash) => {\n            const split = hash.indexOf('=');\n            const key = hash.slice(0, split);\n            const val = hash.slice(split + 1);\n            return Object.assign(params, { [key]: decodeURIComponent(val) });\n        }, {});\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { EMPTY, Observable, Subject } from 'rxjs';\nimport { UID } from '@farris/devkit';\nimport { switchMap } from 'rxjs/operators';\n/*\n * @Author: aalizzwell \n * @Date: 2019-07-23 15:56:11 \n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-11-27 15:31:36\n */\n\n\n/**\n * RuntimeFrameworkService\n * @scope @FormModule\n */\n// tslint:disable: no-string-literal disable: max-line-length\n@Injectable()\nexport class RuntimeFrameworkService {\n  private rtfService: any;\n  constructor() {\n    this.rtfService = this.getService();\n  }\n  /**\n   * éåè·årtfæå¡\n   */\n  private getService() {\n    let env: Window = window;\n    while (!env['gspframeworkService'] && env !== window.top && this.isSameOrigin(env)) {\n      env = env.parent;\n    }\n    return env['gspframeworkService'] && env['gspframeworkService']['rtf'] || {};\n  }\n  // #region å¯¼èªæå¡\n  /**\n   * æå¼èåæåºç¨\n   * @param options options\n   */\n  openMenu(options: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['openMenu'] === 'function') {\n      this.rtfService.func.openMenu(options);\n    }\n  }\n  /**\n   * æå¼èåæåºç¨\n   * @param options options\n   */\n  openMenu$(options: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['openMenuByStream'] === 'function') {\n      return this.rtfService.func.openMenuByStream(options);\n    }\n    return EMPTY;\n  }\n  /**\n   * è·åå¯¼èªå®ä½æ°æ®\n   * @param tabId tabid\n   * @param callback callback\n   * @param once once\n   */\n  getEntityParam(tabId: string, callback: any, once: boolean = true) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['getEntityParam'] === 'function') {\n      this.rtfService.func.getEntityParam(tabId, callback, once);\n    }\n  }\n  /**\n   * å°è¯å³é­èåæåºç¨\n   * @param options optins\n   */\n  beforeCloseMenu(options: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['beforeClose'] === 'function') {\n      this.rtfService.func.beforeClose(options);\n    }\n  }\n  /**\n   * å³é­èå\n   * @param options options\n   */\n  closeMenu(options: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['close'] === 'function') {\n      this.rtfService.func.close(options);\n    }\n  }\n  /**\n   * è·åèåéæåæ°\n   * @param funcId èåid\n   * @param callback åè°\n   */\n  getMenuParams(funcId: string, callback: (params) => void) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('func') && typeof this.rtfService['func']['getMenuParams'] === 'function') {\n      this.rtfService.func.getMenuParams(funcId, callback);\n    }\n  }\n  /**\n   * æ·»å äºä»¶çå¬\n   */\n  addEventListener(token: string, handler: (value: any) => void, options: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('frmEvent') && typeof this.rtfService['frmEvent']['eventListener'] === 'function') {\n      this.rtfService.frmEvent.eventListener(token, handler, options);\n    }\n  }\n  /**\n   * è·åè¿è¡æ¡æ¶èååæ¢æ§å¶äºä»¶\n   * @returns Observable<any>\n   */\n  public getMenuSwitchControlEvent(): Observable<any> {\n    const subject = new Subject<any>();\n    const frmEvent = this.rtfService && this.rtfService.frmEvent || null;\n    if (frmEvent) {\n      const tabId = this.tabId;\n      const options = this.params;\n      window.setTimeout(() => {\n        frmEvent.eventListener(tabId, (response: { menuSwitchControl: { key: any, value: any }, [prop: string]: any }) => {\n          const menuSwitchControl = response && response.menuSwitchControl || null;\n          if (menuSwitchControl && menuSwitchControl.key === tabId) {\n            subject.next(menuSwitchControl.value);\n          } else {\n            subject.next(null);\n          }\n        }, options);\n      }, 0);\n    }\n    return subject;\n  }\n  //#endregion\n\n  // #region ééå±å±æ§\n  public get params() {\n    if (this.rtfService && this.rtfService.hasOwnProperty('session') && typeof this.rtfService['session']['getCommonVariable'] === 'function') {\n      return this.rtfService['session']['getCommonVariable']();\n    }\n    return null;\n  }\n  /**\n   * è·åtabId\n   */\n  public get tabId() {\n    return this.params && this.params['tabId'] || null;\n  }\n  /**\n   * è·åformToken\n   */\n  public get formToken() {\n    return this.params && this.params['formToken'] || null;\n  }\n  /**\n   * è·åfuncId\n   */\n  public get funcId() {\n    return this.params && this.params['funcId'] || null;\n  }\n  // #endregion\n\n  // #region äºä»¶éä¿¡\n  /**\n   * æ³¨åä¸»é¢\n   * @param code ä¸»é¢çæ è¯\n   * @param options tokençæè§å\n   * @param subject èªå®ä¹ä¸»é¢ï¼é»è®¤ä½¿ç¨Subject\n   * @returns string æ³¨åæååè¿åä¸»é¢çå¯ä¸æ è¯\n   */\n  public subjectRegister(code: string, options: any, subject?: Subject<any>): string {\n    if (this.rtfService && this.rtfService.hasOwnProperty('broadcast') && typeof this.rtfService['broadcast']['subjectRegister'] === 'function') {\n      return this.rtfService.broadcast.subjectRegister(code, options, subject);\n    }\n    return null;\n  }\n  /**\n   * ç§»é¤ä¸»é¢\n   * @param token ä¸»é¢å¯ä¸æ è¯\n   */\n  public subjectRemove(token: string) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('broadcast') && typeof this.rtfService['broadcast']['subjectRemove'] === 'function') {\n      this.rtfService.broadcast.subjectRemove(token);\n    }\n  }\n  /**\n   * ç»ä¸»é¢åéæ¶æ¯\n   * @param token ä¸»é¢æ è¯\n   * @param info æ¶æ¯\n   */\n  public subjectNotify(token: string, info: any) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('broadcast') && typeof this.rtfService['broadcast']['notify'] === 'function') {\n      this.rtfService.broadcast.notify(token, info);\n    }\n  }\n  /**\n   * æ³¨åä¸»é¢çå¬å¨\n   * @param token ä¸»é¢æ è¯\n   * @param handler ä¸»é¢å¤çå¨\n   * @param observerToken çå¬å¨id(å¯é)\n   * @returns çå¬å¨Id\n   * @description çå¬ä¸»é¢æ¶æ¯ï¼çå¬æåè¿åå½åçå¬èçå¯ä¸æ è¯\n   */\n  public subjectResponse(token: string, handler: (data: any) => void, observerToken?: string): string {\n    if (this.rtfService && this.rtfService.hasOwnProperty('broadcast') && typeof this.rtfService['broadcast']['response'] === 'function') {\n      let code = observerToken;\n      if (typeof observerToken === 'undefined' || !observerToken || observerToken.length < 1) {\n        code = UID.create();\n      }\n      this.rtfService.broadcast.response(token, code, handler);\n      return code;\n    }\n    return null;\n  }\n  /**\n   * åæ¶å¯¹ä¸»é¢ççå¬\n   * @param token ä¸»é¢æ è¯\n   * @param observerToken çå¬å¨æ è¯\n   */\n  public responseUnSubscribe(token: string, observerToken: string) {\n    if (this.rtfService && this.rtfService.hasOwnProperty('broadcast') && typeof this.rtfService['broadcast']['responseUnSubscribe'] === 'function') {\n      this.rtfService.broadcast.responseUnSubscribe(token, observerToken);\n    }\n  }\n  // #endregion\n\n  // #region å·¥å·å½æ°\n  /**\n   * æ¯å¦åæº\n   * @param environment window\n   */\n  private isSameOrigin(environment: Window) {\n    const host = window.location.host;\n    try {\n      if (environment && environment.location && typeof environment.location.host !== 'undefined') {\n        return environment.location.host === host;\n      }\n    } catch (e) {\n      return false;\n    }\n\n    return false;\n  }\n  // #endregion\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, of, from, EMPTY } from 'rxjs';\nimport { every, concatMap, switchMap, take, tap } from 'rxjs/operators';\nimport { AppOptions } from '@gsp-sys/rtf-common';\nimport { RuntimeFrameworkService } from './rtf-service';\nimport { MenuStateService } from './menu-state.service';\nimport { TAB_EVENT } from './types';\nimport { QuerystringService } from './querystring';\nimport { FrameContext, UID } from '@farris/devkit';\n\n/**\n * å¯¼èªäºä»¶æå¡\n * @scope FormModule\n */\n@Injectable()\nexport class NavigationEventService {\n  public frameContext: FrameContext;\n  /**\n   * å³é­åäºä»¶å¤çå¨\n   */\n  private onClosedListeners: Map<string, (options?: AppOptions) => void>;\n  /**\n   * å³é­åå¤çå¨\n   */\n  private onClosingListeners: Map<string, (options?: AppOptions) => Observable<boolean>>;\n  private onTabSwitchListeners: Map<string, (options?: AppOptions) => void>;\n  private params: { [propName: string]: any };\n\n  constructor(\n    private runtimeFrameworkService: RuntimeFrameworkService,\n    private menuStateService: MenuStateService,\n    private querystringService: QuerystringService\n  ) {\n    this.onClosedListeners = new Map<string, (options?: AppOptions) => void>();\n    this.onClosingListeners = new Map<string, (options?: AppOptions) => Observable<boolean>>();\n    this.onTabSwitchListeners = new Map<string, (options?: AppOptions) => void>();\n  }\n  private get querystrings() {\n    const params = this.querystringService.parse(window.location.hash);\n    // ä¿®æ­£formToken\n    if (params) {\n      params.formToken = this.runtimeFrameworkService.formToken;\n    }\n    return params;\n  }\n  /**\n   * æ³¨åäºä»¶\n   */\n  public registerEvent() {\n    const options = this.querystrings;\n    this.params = options;\n    // æ³¨åæ ç­¾é¡µåæ¢äºä»¶\n    this.runtimeFrameworkService.addEventListener(TAB_EVENT.onTabSwitched, (e) => this.handleTabSwitchEvent(e), options);\n    // æ³¨åæ ç­¾é¡µå³é­åäºä»¶\n    this.runtimeFrameworkService.addEventListener(TAB_EVENT.onTabClosed, (e) => this.handleTabClosedEvent(e), options);\n    // æ³¨åæ ç­¾é¡µå³é­åäºä»¶\n    this.runtimeFrameworkService.addEventListener(TAB_EVENT.onTabClosing, (e) => this.handleTabClosingEvent(e), options);\n  }\n  /**\n   * å¤çæ ç­¾é¡µåæ¢äºä»¶\n   */\n  private handleTabSwitchEvent(e: any) {\n    if (!e) {\n      return;\n    }\n    // éä¸­çè¡¨åä¸ºç³»ç»è¡¨åï¼åªè½è¿åidï¼æ²¡ætabId\n    const eventTabId = e.tabId || e.id || null;\n    if (!eventTabId) {\n      return;\n    }\n    const options = this.params; // this.querystrings;\n    const tabId = options.tabId || options.funcId || options.appId;\n    const menuState = this.menuStateService.getMenuState(eventTabId);\n    if (!!tabId && tabId === eventTabId && !!menuState && menuState.length > 0) {\n      this.formReload();\n    }\n    this.fireTabSwitchEvent(e);\n  }\n  /**\n   * è§¦åtabåæ¢äºä»¶\n   * @param e e\n   */\n  private fireTabSwitchEvent(e: any) {\n    if (!this.onTabSwitchListeners || this.onTabSwitchListeners.size < 1) {\n      return;\n    }\n    this.onTabSwitchListeners.forEach((handle, key, map) => {\n      if (typeof handle === 'function') {\n        handle(e);\n      }\n    });\n  }\n  /**\n   * æ ç­¾é¡µå³é­åäºä»¶\n   */\n  private handleTabClosingEvent(e: any) {\n    if (!e) {\n      return;\n    }\n    // è¦å³é­çè¡¨åä¸ºç³»ç»è¡¨åï¼åªè½è¿åidï¼æ²¡ætabId\n    const eventTabId = e.tabId || e.id || null;\n    const options = this.params; // this.querystrings;\n    const tabId = options.tabId || options.funcId || options.appId;\n    if (!!eventTabId && !!tabId && tabId === eventTabId) {\n      this.fireTabClosingEvent(e).subscribe(result => {\n        if (result) {\n          setTimeout(() => this.removeMenuState(eventTabId), 500);\n          const formEventServices: Map<string, any> = window['formEventServices'];\n          if (formEventServices.has(eventTabId)) {\n            formEventServices.delete(eventTabId);\n            window['formEventServices'] = formEventServices;\n          }\n          if (!(e && e.hasOwnProperty('token'))) {\n            e = Object.assign({}, e, { token: options.formToken });\n          }\n          if (this.frameContext && this.frameContext.appContext) {\n            this.frameContext.appContext.dispose();\n          }\n          this.runtimeFrameworkService.closeMenu(e);\n        }\n      });\n    }\n  }\n  /**\n   * è§¦åå³é­åäºä»¶\n   */\n  private fireTabClosingEvent(e: any): Observable<boolean> {\n    if (!this.onClosingListeners || this.onClosingListeners.size < 1) {\n      return of(true);\n    }\n    const listeners = this.onClosingListeners.values();\n    const result$ = from(listeners);\n    // ç¨æ·æç»\n    let userRejected = false;\n    return result$.pipe(\n      concatMap(handle => {\n        if (userRejected) {\n          return EMPTY;\n        }\n        return handle(e).pipe(\n          take(1),\n          tap(result => userRejected = !result),\n          switchMap(result => of(result))\n        );\n      }),\n      every(result => result)\n    );\n  }\n  /**\n   * æ ç­¾é¡µå³é­åäºä»¶\n   */\n  private handleTabClosedEvent(e: any) {\n    if (!e) {\n      return;\n    }\n    const options = this.params; // this.querystrings;\n    const tabId = options.tabId || options.funcId || options.appId;\n    const eventTabId = e.tabId || e.id || null;\n    if (tabId === eventTabId) {\n      return;\n    }\n    const menuState = this.menuStateService.getMenuState(tabId, eventTabId);\n    if (!!eventTabId && !!menuState && menuState.length > 0) {\n      this.removeMenuState(eventTabId);\n      this.formReload();\n    }\n    this.fireTabClosedEvent(e);\n  }\n  private removeMenuState(tabId: string) {\n    if (this['context']) {\n      this.menuStateService.removeMenu(tabId);\n    }\n  }\n  /**\n   * è§¦åå³é­åäºä»¶\n   * @param e event\n   */\n  private fireTabClosedEvent(e: any) {\n    if (!this.onClosedListeners || this.onClosedListeners.size < 1) {\n      return;\n    }\n    this.onClosedListeners.forEach((handle, key, map) => {\n      if (typeof handle === 'function') {\n        handle(e);\n      }\n    });\n  }\n  // #endregion\n  /**\n   * æ³¨åäºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å onTabClosed\n   * @param handler å¤çå¨\n   */\n  public addEventListener(eventType: string, handler: (options: AppOptions) => any): string {\n    const key = UID.create();\n    if (eventType === TAB_EVENT.onTabClosed) {\n      this.onClosedListeners.set(key, handler);\n      return key;\n    } else if (eventType === TAB_EVENT.onTabClosing) {\n      this.onClosingListeners.set(key, handler);\n      return key;\n    } else if (eventType === TAB_EVENT.onTabSwitched) {\n      this.onTabSwitchListeners.set(key, handler);\n      return key;\n    }\n    return null;\n  }\n  /**\n   * ç§»é¤äºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å\n   * @param key äºä»¶æ è¯\n   */\n  public removeEventListener(eventType: string, key: string) {\n    if (eventType === TAB_EVENT.onTabClosed) {\n      return this.onClosedListeners.delete(key);\n    } else if (eventType === TAB_EVENT.onTabClosing) {\n      return this.onClosingListeners.delete(key);\n    }\n    return false;\n  }\n  /**\n   * æ¸ç©ºäºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å\n   */\n  public clearEventListener(eventType: string): void {\n    if (eventType === TAB_EVENT.onTabClosed) {\n      this.onClosedListeners.clear();\n    } else if (eventType === TAB_EVENT.onTabClosing) {\n      this.onClosingListeners.clear();\n    }\n  }\n  /**\n   * å·æ°ç»ä»¶æ°æ®\n   */\n  private formReload() {\n    try {\n      // tslint:disable-next-line: no-string-literal\n      this['context']['frameContext']['appContext']['refresh']();\n    } catch { }\n  }\n}\n","import { Injectable, InjectionToken, Inject, Optional } from '@angular/core';\nexport const FARRIS_FORM_COMPONENTS = new InjectionToken<{[key: string]: any}>('è¡¨åå¼¹åºçªå£æéèç»ä»¶åè¡¨');\n\n/**\n * è¡¨åæå¡\n * @scope FormModule\n */\n@Injectable()\nexport class FarrisFormService {\n\n    private controls: { [key: string]: any} = {};\n\n    constructor(@Optional()@Inject(FARRIS_FORM_COMPONENTS) initCtrls: any = {}) {\n      if (!initCtrls) {\n        initCtrls = {};\n      }\n      this.controls = { ...initCtrls };\n    }\n\n    append(key: string, cmpIns: any) {\n        this.controls[key] = cmpIns;\n    }\n\n    getControls(key: string) {\n        if (this.controls[key]) {\n            return this.controls[key];\n        } else {\n            console.warn(`æªæ¾å°Keyä¸º${key}çç»ä»¶ï¼`);\n            return null;\n        }\n    }\n\n}\n","/*\n * @Author: aalizzwell\n * @Date: 2019-08-02 15:31:34\n * @Last Modified by: aalizzwell\n * @Last Modified time: 2020-03-03 09:33:43\n */\nimport { Injectable, Optional, Injector, ComponentFactoryResolver, ReflectiveInjector } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { RuntimeFrameworkService } from './rtf-service';\nimport { AppOptions, AppType } from '@gsp-sys/rtf-common';\nimport { MenuStateService } from './menu-state.service';\nimport { NavigationEventService } from './navigation-event.service';\nimport { QuerystringService } from './querystring';\nimport { FrameContext, TranslateToken, Translate, FrameComponent } from '@farris/devkit';\nimport { FEPageModalService } from '@farris/extend-page-modal';\nimport lodash from 'lodash-es';\nimport { FarrisFormService } from './farris-form.service';\nimport { LanguageService } from './languag.service';\nimport { map, switchMap } from 'rxjs/operators';\nimport { EMPTY, Observable, of } from 'rxjs';\nimport { FormNotifyService } from './form-notify.service';\ndeclare const System: any;\n// tslint:disable: no-string-literal max-line-length\nconst APP_CONTEXT_MANAGER = 'DEVKIT_APP_CONTEXT_MANAGER';\n/**\n * å¯¼èªæå¡\n * @scope FormModule\n */\n@Injectable()\nexport class NavigationService {\n  constructor(\n    private runtimeFrameworkService: RuntimeFrameworkService,\n    private menuStateService: MenuStateService,\n    private navigationEventService: NavigationEventService,\n    private querystringService: QuerystringService,\n    @Optional() private frameContext: FrameContext,\n    @Optional() private injector: Injector,\n    @Optional() private languageService: LanguageService\n    // @Optional() private pageModalService: FEPageModalService,\n    // @Optional() private farrisFormService: FarrisFormService,\n    // @Optional() private languageService: LanguageService\n  ) {\n    // appIdä¸åäºtabIdï¼æ¯æ¬¡è¡¨åå®ä¾åæ¶é½ä¼éæ°çæ\n    const appId = this.formAppContext && this.formAppContext.ApplicationId;\n    let tabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    // å·²ç»ç¼è¯çè¡¨åï¼ä½¿ç¨appIdè®°å½hash\n    if (appId) {\n      const appContextManager = window[APP_CONTEXT_MANAGER] || new Map<string, any>();\n      if (appContextManager && !appContextManager.has(appId)) {\n        appContextManager.set(appId, { hash: window.location.hash });\n        window[APP_CONTEXT_MANAGER] = appContextManager;\n      }\n    }\n    if (tabId) {\n      const formEventServices: Map<string, any> = window['formEventServices'] || new Map<string, any>();\n      // tabIdãappIdé½å­å¨æ¶ï¼ä½¿ç¨appIdæ¿æ¢tabId\n      if (appId) {\n        tabId = appId;\n      }\n      if (formEventServices && formEventServices.has(tabId)) {\n        this.navigationEventService = formEventServices.get(tabId);\n      } else {\n        this.navigationEventService.registerEvent();\n        formEventServices.set(tabId, this.navigationEventService);\n        this.navigationEventService.frameContext = this.frameContext;\n        window['formEventServices'] = formEventServices;\n      }\n      this.registerDestroyEvent(tabId);\n    }\n    if (!languageService) {\n      this.languageService = new LanguageService();\n    }\n  }\n  public set context(context) {\n    this.navigationEventService['context'] = context;\n    this['commandContext'] = context;\n  }\n  /**\n   * è·åæ´ä¸ªè¡¨åçappcontextï¼é¤moduleä¸çappcontextï¼\n   */\n  private get formAppContext() {\n    if (this.frameContext) {\n      let appContext = this.frameContext.appContext;\n      // tslint:disable-next-line: max-line-length\n      while (appContext && appContext.parent && appContext.parent.injector && appContext.parent.injector.get(FrameContext, null) !== null) {\n        appContext = appContext.parent;\n      }\n      return appContext;\n    }\n    return null;\n  }\n  private get querystrings() {\n    let hash = window.location.hash;\n    const appId = this.formAppContext && this.formAppContext.ApplicationId;\n    if (appId) {\n      const appContextManager = window[APP_CONTEXT_MANAGER];\n      const appContext = appContextManager && appContextManager.get(appId);\n      hash = appContext && appContext.hash || hash;\n    }\n    const params = this.querystringService.parse(hash);\n    if (params) {\n      params.formToken = this.runtimeFrameworkService.formToken;\n    }\n    return params;\n  }\n  /**\n   * æç¤ºæå¡\n   */\n  private get formNotifyService() {\n    return this.injector && this.injector.get<FormNotifyService>(FormNotifyService, null);\n  }\n  /**\n   * æ³¨åéæ¯äºä»¶\n   * @param tabId \n   */\n  private registerDestroyEvent(tabId: string) {\n    if (this.frameContext && this.frameContext.destorySignal) {\n      this.frameContext.destorySignal.subscribe(() => {\n        this.navigationEventService = null;\n      });\n    }\n    if (this.frameContext && this.frameContext.appContext && this.frameContext.appContext.destorySignal) {\n      this.frameContext.appContext.destorySignal.subscribe(() => {\n        const formEventServices = window['formEventServices'] as Map<string, any>;\n        if (formEventServices) {\n          formEventServices.delete(tabId);\n        }\n        const appContextManager = window[APP_CONTEXT_MANAGER] as Map<string, any>;\n        if (appContextManager) {\n          appContextManager.delete(tabId);\n        }\n      });\n    }\n  }\n  // #region æ¥å£\n\n  /**\n   * æå¼èå\n   * @param tabId æ ¹æ®TabIdå³å®æå¼æ°æ ç­¾é¡µæå®ä½ä¹åæå¼çæ ç­¾é¡µ\n   * @param funcId èåId\n   * @param params åæ°\n   * @param reload æ¯å¦éæ°å·æ°\n   * @param enableRefresh å¯ç¨æ°æ®å·æ°\n   * @param tabName tabæ é¢\n   * @param destructuring æ¯å¦è§£æåæ°\n   */\n  public openMenu(tabId: string, funcId: string, params: any, reload?: boolean, enableRefresh?: any, tabName?: string, destructuring?: any) {\n    if (!funcId && this.formNotifyService) {\n      this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (tabName) {\n      tabName = this.translate(tabName);\n    }\n\n    let queryStringParams = this.buildParamMap(params);\n    destructuring = this.convertToBoolean(destructuring, false);\n    if (destructuring === true) {\n      queryStringParams = this.buildParam(params);\n    }\n    const paramsMap = this.buildParamMap(params);\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    const options: AppOptions = {\n      tabId,\n      funcId,\n      appType: AppType.Menu,\n      queryStringParams: queryStringParams,\n      entityParams: paramsMap,\n      appId: undefined,\n      appEntrance: undefined,\n      isReload: reload,\n      tabName: tabName || null\n    };\n    // å¯ç¨æ°æ®å·æ°åæ°ä¸ºtrueæèæ²¡æå®ä¹ï¼åæå·æ°å¤ç\n    // æ²¡æä¼ éè¯¥åæ°æè¯¥åæ°ä¸ºç©ºï¼åè®¤ä¸ºæç§ä¹åçé»è¾å¤çï¼é»è®¤å·æ°\n    // null false \"false\" \"true\" undefined\n    enableRefresh = this.convertToBoolean(enableRefresh, true);\n    if (enableRefresh === true) {\n      this.menuStateService.addMenuState(currentTabId, tabId);\n    }\n    this.runtimeFrameworkService.openMenu(options);\n  }\n  /**\n   * æå¼èåï¼æµï¼\n   * @param tabId æ ¹æ®TabIdå³å®æå¼æ°æ ç­¾é¡µæå®ä½ä¹åæå¼çæ ç­¾é¡µ\n   * @param funcId èåId\n   * @param params åæ°\n   * @param reload æ¯å¦éæ°å·æ°\n   * @param enableRefresh å¯ç¨æ°æ®å·æ°\n   * @param destructuring è§£æåæ°\n   */\n  public openMenu$(tabId: string, funcId: string, params: any, reload?: boolean, enableRefresh?: any, tabName?: string, destructuring?: any) {\n    if (!funcId && this.formNotifyService) {\n      this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (tabName) {\n      tabName = this.translate(tabName);\n    }\n    let queryStringParams = this.buildParamMap(params);\n    destructuring = this.convertToBoolean(destructuring, false);\n    if (destructuring === true) {\n      queryStringParams = this.buildParam(params);\n    }\n    const paramsMap = this.buildParamMap(params);\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    const options: AppOptions = {\n      tabId,\n      funcId,\n      appType: AppType.Menu,\n      queryStringParams: queryStringParams,\n      entityParams: paramsMap,\n      appId: undefined,\n      appEntrance: undefined,\n      isReload: reload,\n      tabName: tabName || null\n    };\n    // å¯ç¨æ°æ®å·æ°åæ°ä¸ºtrueæèæ²¡æå®ä¹ï¼åæå·æ°å¤ç\n    enableRefresh = this.convertToBoolean(enableRefresh, true);\n    if (enableRefresh === true) {\n      this.menuStateService.addMenuState(currentTabId, tabId);\n    }\n    return this.runtimeFrameworkService.openMenu$(options);\n  }\n  /**\n   * æå¼èå(å¸¦ç»´åº¦)\n   * @param tabId æ ¹æ®TabIdå³å®æå¼æ°æ ç­¾é¡µæå®ä½ä¹åæå¼çæ ç­¾é¡µ\n   * @param funcId èåId\n   * @param params åæ°\n   * @param reload æ¯å¦éæ°å·æ°\n   * @param enableRefresh å¯ç¨æ°æ®å·æ°\n   * @param dim1 dim1\n   * @param dim2 dim2\n   * @param destructuring è§£æåæ°\n   */\n  public openMenuWithDimension(tabId: string, funcId: string, params: any, enableRefresh?: any, dim1?: any, dim2?: any, tabName?: string, metadataId?: string, destructuring?: any) {\n    if (!funcId && this.formNotifyService) {\n      this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (tabName) {\n      tabName = this.translate(tabName);\n    }\n    if (metadataId === undefined || metadataId === null) {\n      metadataId = '';\n    }\n    let queryStringParams = this.buildParamMap(params);\n    destructuring = this.convertToBoolean(destructuring, false);\n    if (destructuring === true) {\n      queryStringParams = this.buildParam(params);\n    }\n\n    const paramsMap = this.buildParamMap(params);\n    queryStringParams.set('dim1', dim1 ? dim1 : 'public');\n    queryStringParams.set('dim2', dim2 ? dim2 : 'public');\n    queryStringParams.set('metadataId', metadataId);\n    queryStringParams.set('isRtc', '1');\n    queryStringParams.set('isRootMetadata', 'true');\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    const options: AppOptions = {\n      tabId,\n      funcId,\n      appType: AppType.Menu,\n      queryStringParams: queryStringParams,\n      entityParams: paramsMap,\n      appId: undefined,\n      appEntrance: undefined,\n      isReload: false,\n      tabName: tabName || null\n    };\n    // å¯ç¨æ°æ®å·æ°åæ°ä¸ºtrueæèæ²¡æå®ä¹ï¼åæå·æ°å¤ç\n    // æ²¡æä¼ éè¯¥åæ°æè¯¥åæ°ä¸ºç©ºï¼åè®¤ä¸ºæç§ä¹åçé»è¾å¤çï¼é»è®¤å·æ°\n    // null false \"false\" \"true\" undefined\n    enableRefresh = this.convertToBoolean(enableRefresh, true);\n    if (enableRefresh === true) {\n      this.menuStateService.addMenuState(currentTabId, tabId);\n    }\n    this.runtimeFrameworkService.openMenu(options);\n  }\n  /**\n   * æå¼åºç¨\n   * @param tabId tabId æ ¹æ®TabIdå³å®æå¼æ°æ ç­¾é¡µæå®ä½ä¹åæå¼çæ ç­¾é¡µ\n   * @param appId åºç¨Id\n   * @param appEntrance åºç¨å¥å£\n   * @param params åæ°\n   * @param reload æ¯å¦éæ°å·æ°\n   * @param tabName tabæ é¢\n   * @param enableRefresh å¯ç¨æ°æ®å·æ°\n   * @param destructuring è§£æåæ°\n   */\n\n  public openApp(tabId: string, appId: string, appEntrance: string, params: any, reload?: boolean, tabName?: string, enableRefresh?: any, destructuring?: any) {\n    if (!appId && this.formNotifyService) {\n      this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (tabName) {\n      tabName = this.translate(tabName);\n    }\n    let queryStringParams = this.buildParamMap(params);\n    destructuring = this.convertToBoolean(destructuring, false);\n    if (destructuring === true) {\n      queryStringParams = this.buildParam(params);\n    }\n    const paramsMap = this.buildParamMap(params);\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    const options: AppOptions = {\n      tabId,\n      appId,\n      appEntrance,\n      funcId: undefined,\n      appType: AppType.App,\n      queryStringParams: queryStringParams,\n      entityParams: paramsMap,\n      isReload: reload,\n      tabName: tabName || null\n    };\n    enableRefresh = this.convertToBoolean(enableRefresh, true);\n    if (enableRefresh === true) {\n      this.menuStateService.addMenuState(currentTabId, tabId);\n    }\n    this.runtimeFrameworkService.openMenu(options);\n  }\n  /**\n   * æå¼åºç¨(æµå¼)\n   * @param tabId tabId æ ¹æ®TabIdå³å®æå¼æ°æ ç­¾é¡µæå®ä½ä¹åæå¼çæ ç­¾é¡µ\n   * @param appId åºç¨Id\n   * @param appEntrance åºç¨å¥å£\n   * @param params åæ°\n   * @param reload æ¯å¦éæ°å·æ°\n   * @param tabName tabæ é¢\n   * @param enableRefresh å¯ç¨æ°æ®å·æ°\n   * @param destructuring è§£æåæ°\n   */\n  public openApp$(tabId: string, appId: string, appEntrance: string, params: any, reload?: boolean, tabName?: string, enableRefresh?: any, destructuring?: any) {\n    if (!appId && this.formNotifyService) {\n      this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (tabName) {\n      tabName = this.translate(tabName);\n    }\n    let queryStringParams = this.buildParamMap(params);\n    destructuring = this.convertToBoolean(destructuring, false);\n    if (destructuring === true) {\n      queryStringParams = this.buildParam(params);\n    }\n    const paramsMap = this.buildParamMap(params);\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    const options: AppOptions = {\n      tabId,\n      appId,\n      appEntrance,\n      funcId: undefined,\n      appType: AppType.App,\n      queryStringParams: queryStringParams,\n      entityParams: paramsMap,\n      isReload: reload,\n      tabName: tabName || null\n    };\n    enableRefresh = this.convertToBoolean(enableRefresh, true);\n    if (enableRefresh === true) {\n      this.menuStateService.addMenuState(currentTabId, tabId);\n    }\n    return this.runtimeFrameworkService.openMenu$(options);\n  }\n  /**\n   * å³é­\n   * @param onCloseing å³é­åäºä»¶å¤çå¨\n   */\n  public close() {\n    const options = this.querystrings;\n    const { isDialogComponent: isInDialog, rootComponent } = this.findDialog();\n    if (isInDialog) {\n      const modalRef = this.get(rootComponent, 'dialogRef');\n      modalRef['close']();\n      return;\n    }\n    options.token = options.formToken;\n    this.runtimeFrameworkService.beforeCloseMenu(options);\n  }\n  /**\n   * å¼ºå¶å³é­\n   */\n  public destory() {\n    const options = this.querystrings;\n    options.token = options.formToken;\n    this.runtimeFrameworkService.closeMenu(options);\n  }\n  /**\n   * \n   * @param params params\n   * @deprecated å¾åºå¼ï¼ä¸buildParamMapéå¤\n   */\n  private parseParams(params: any) {\n    if (typeof params === 'undefined' || params === null || (typeof params === 'string' && params.length < 1)) {\n      params = {};\n    }\n    const paramMap = new Map<string, any>();\n    if (typeof params === 'object') {\n      params = JSON.stringify(params);\n    }\n    params = window['encodeURIComponent'](params);\n    paramMap.set('WEB_FORM_ROUTE_PARAMS', params);\n    return paramMap;\n  }\n  /**\n   * æ³¨åäºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å onTabClosed\n   * @param handler å¤çå¨\n   * @returns string è¿åäºä»¶æ è¯\n   */\n  public addEventListener(eventType: string, handler: (options: AppOptions) => any): string {\n    return this.navigationEventService.addEventListener(eventType, handler);\n  }\n  /**\n   * ç§»é¤äºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å onTabClosed | onTabCloseing\n   * @param key äºä»¶æ è¯\n   */\n  public removeEventListener(eventType: string, key: string): boolean {\n    return this.navigationEventService.removeEventListener(eventType, key);\n  }\n  /**\n   * æ¸ç©ºäºä»¶çå¬å¨\n   * @param eventType äºä»¶ç±»å\n   */\n  public clearEventListener(eventType: string): void {\n    this.navigationEventService.clearEventListener(eventType);\n  }\n  /**\n   * ä»¥å¼¹æ¡ãä¾§è¾¹æ ææ°æ ç­¾é¡µæ¹å¼æå¼è¡¨å\n   * @param mode æå¼æ¹å¼ï¼æ¯æ`modal`å¼¹çªã`sidebar`ä¾§è¾¹æ ã`tab`æ°æ ç­¾é¡µ\n   * @param modalId å¼¹çªidï¼å¦æmode=`modal`ä¸æ²¡æurlï¼\n   * @param configs å¼¹çªéç½®\n   * @param url è¿ç«¯è¡¨åurl\n   * @param tabId æ ç­¾é¡µidï¼modal=tabæ¶å¿å¡«\n   * @param tabType æ ç­¾é¡µç±»åï¼`menu` æ`app`\n   * @param funcOrAppId èåæåºç¨id\n   * @param appEntrance åºç¨å¥å£\n   * @param params åæ°\n   * @param tabName æ°æ ç­¾é¡µåç§°\n   * @param enableRefresh å¯ç¨å¯å¨å·æ°\n   * @param destructuring æ¯å¦è§£æ\n   */\n  public open(mode: 'modal' | 'sidebar' | 'tab', modalId?: string, url?: string, configs?: any, tabId?: string, tabType?: 'menu' | 'app', funcOrAppId?: string, appEntrance?: string, params?: any, tabName?: string, enableRefresh?: any, destructuring?: any) {\n    const pageModalService = this.injector.get<FEPageModalService>(FEPageModalService, null);\n    if (!pageModalService) {\n      throw new Error('get FEPageModalService failed.');\n    }\n    // æ ¡éªåæ°æ¯å¦åæ³\n    if (!mode) {\n      throw new Error('[NavigationService]->open,modeåæ°ä¸è½ä¸ºç©ºï¼');\n    }\n    if (mode === 'modal' || mode === 'sidebar') {\n      if (!modalId && !url) {\n        throw new Error('å¼¹çªåä¾§è¾¹æ æ¨¡å¼æ¶å¼¹çªå®¹å¨idåè¡¨åè·¯å¾ä¸è½åæ¶ä¸ºç©ºï¼');\n      }\n      if (modalId && url) {\n        throw new Error('å¼¹çªåä¾§è¾¹æ æ¨¡å¼æ¶å¼¹çªå®¹å¨idåè¡¨åè·¯å¾ä¸è½åæ¶å­å¨ï¼');\n      }\n      const uiStateConfig = this.getObjectTypeConfig(params);\n      const modalConfig = this.buildConfigs(configs);\n      if (mode === 'sidebar') {\n        modalConfig.dialogType = mode;\n      }\n      let pageModalRef = null;\n      if (modalId) {\n        const farrisFormService = this.injector.get<FarrisFormService>(FarrisFormService, null);\n        if (!farrisFormService) {\n          return;\n        }\n        let componentType = farrisFormService.getControls(modalId);\n        const componentRef = this.createComponentRef(componentType, uiStateConfig);\n        pageModalRef = pageModalService.show(componentRef, modalConfig);\n      } else if (url) {\n        pageModalRef = pageModalService.showByUrl(url, modalConfig);\n      }\n      if (pageModalRef && !!pageModalRef.content) {\n        pageModalRef.content.isDialogRootComponent = true;\n        pageModalRef.content.dialogRef = pageModalRef;\n        const header = pageModalRef.dialog && pageModalRef.dialog.instance && pageModalRef.dialog.instance.el && pageModalRef.dialog.instance.el.nativeElement && pageModalRef.dialog.instance.el.nativeElement.querySelector(\".f-page-header\");\n        if (header && pageModalRef.dialog.instance.draggbar) {\n          pageModalRef.dialog.instance.draggbar.handle = header;\n          header.style.cursor = 'move';\n        }\n      }\n    } else if (mode === 'tab') {\n      if (!tabId || !tabType || !funcOrAppId) {\n        if (this.formNotifyService) {\n          this.formNotifyService.warning(this.languageService.appOrFuncIdRequired, { hideTitle: true });\n        }\n        throw new Error('æ°æ ç­¾æ¨¡å¼æ¶æ ç­¾é¡µidãæ ç­¾ç±»åãèåæåºç¨idåä¸è½ä¸ºç©ºï¼');\n      }\n      if (tabType === 'app' && !appEntrance) {\n        throw new Error('ä»¥åºç¨æ¹å¼æå¼æ¶å¥å£åºç¨ä¸è½ä¸ºç©ºï¼');\n      }\n      if (tabType == 'app') {\n        this.openApp(tabId, funcOrAppId, appEntrance, params, false, tabName, enableRefresh, destructuring);\n      } else if (tabType === 'menu') {\n        this.openMenu(tabId, funcOrAppId, params, false, enableRefresh, tabName, destructuring);\n      }\n    } else {\n      throw new Error('ä¸æ¯æçæ¨¡å¼ï¼');\n    }\n    // this.pageModalService.\n  }\n  /**\n   * in app navigate\n   * @param commands commands\n   */\n  // public navigate(commands: any[]);\n  /**\n   * in app navigate\n   * @param commands commands\n   * @param options options\n   * @description options:{ relativeTo: this.activatedRoute, queryParams:{a:1,b:2},etc:...}\n   */\n  public navigate(commands: any[], options?: any): Promise<boolean> {\n    const router = this.injector && this.injector.get<Router>(Router, null);\n    const activatedRoute = this.injector && this.injector.get<ActivatedRoute>(ActivatedRoute, null);\n    const queryParams = lodash.merge({}, this.querystrings, options && options.queryParams || {});\n    if (options && options.hasOwnProperty('queryParams')) {\n      delete options.queryParams;\n    }\n    const extras = lodash.merge({ skipLocationChange: false, relativeTo: activatedRoute, queryParams }, options || {});\n    if (router) {\n      return router.navigate(commands, extras);\n    } else {\n      return null;\n    }\n  }\n  // #endregion\n\n  // #region ç§ææ¹æ³\n\n  /**\n   * å°è£è·¯ç±åæ°\n   * @param params åæ°\n   * @param options éç½®åæ°\n   */\n  private buildParamMap(params: any, options?: any): Map<string, string> {\n    if (typeof params === 'undefined' || params === null || (typeof params === 'string' && params.length < 1)) {\n      params = {};\n    }\n    const paramMap = new Map<string, any>();\n    if (options && Object.keys(options).length > 0) {\n      if (typeof params !== 'object') {\n        params = JSON.parse(params);\n      }\n      params = lodash.merge(params, options);\n    }\n    if (typeof params === 'object') {\n      params = JSON.stringify(params);\n    }\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    params = window['encodeURIComponent'](params);\n    paramMap.set('WEB_FORM_ROUTE_PARAMS', params);\n    paramMap.set('WEB_FORM_ROUTER_PARENT_ID', currentTabId);\n    return paramMap;\n  }\n  private buildParam(params, options?: any): Map<string, string> {\n    if (typeof params === 'undefined' || params === null || (typeof params === 'string' && params.length < 1)) {\n      params = {};\n    }\n    const paramMap = new Map<string, any>();\n    if (options && Object.keys(options).length > 0) {\n      if (typeof params !== 'object') {\n        params = JSON.parse(params);\n      }\n      params = lodash.merge(params, options);\n    }\n    if (typeof params !== 'object') {\n      params = JSON.parse(params);\n    }\n    Object.keys(params).forEach(key => {\n      paramMap.set(key, params[key]);\n    });\n    const currentTabId = this.querystrings.tabId || this.querystrings.funcId || this.querystrings.appId;\n    params = window['encodeURIComponent'](params);\n    paramMap.set('WEB_FORM_ROUTE_PARAMS', params);\n    paramMap.set('WEB_FORM_ROUTER_PARENT_ID', currentTabId);\n    return paramMap;\n  }\n  /**\n   * æ¥æ¾å¼¹çªç»ä»¶\n   */\n  private findDialog() {\n    let frameContext = this.get(this, 'commandContext.frameContext');\n    let isDialogComponent = this.get(frameContext, 'frameComponent.isDialogRootComponent', false);\n\n    let parentFrameContext = this.get(frameContext, 'parent');\n    while (parentFrameContext != null && !isDialogComponent) {\n      frameContext = this.get(frameContext, 'parent');\n      parentFrameContext = this.get(parentFrameContext, 'parent');\n      isDialogComponent = this.get(frameContext, 'frameComponent.isDialogRootComponent', false);\n    }\n    const rootComponent = this.get(frameContext, 'frameComponent');\n    return { isDialogComponent, rootComponent };\n  }\n\n  /**\n   * loadsh get\n   * @param object å¯¹è±¡\n   * @param path è·¯å¾\n   * @param defaultVal é»è®¤å¼\n   */\n  private get(object: any, path: Array<string> | string, defaultVal: any = null) {\n    const PATH = Array.isArray(path)\n      ? path\n      : path.split('.').filter(i => i.length);\n    if (!PATH.length) {\n      return object === undefined ? defaultVal : object;\n    }\n\n    if (object === null || object === undefined || typeof (object[PATH[0]]) === 'undefined') {\n      return defaultVal;\n    }\n\n    return this.get(object[PATH.shift()], PATH, defaultVal);\n  }\n  private convertToBoolean(value: any, defaultVal: boolean = false) {\n    if (typeof value === 'undefined' || value === null) {\n      value = defaultVal;\n    }\n    if (typeof value === 'string') {\n      value = value || String(defaultVal);\n      value = value === 'true' ? true : false;\n    }\n    return value;\n  }\n  /**\n   * ç¿»è¯èµæºé¡¹\n   * @param key èµæºé¡¹key\n   */\n  private translate(key: string) {\n    const translateService = this.injector && this.injector.get<Translate>(TranslateToken, null) || null;\n    if (translateService && key && key.startsWith('{{') && key.endsWith('}}')) {\n      key = key.replace('{{', '').replace('}}', '').trim();\n      return translateService.transform(key, null);\n    }\n    return key;\n  }\n  // #endregion\n\n  //#region å¼¹çªç¸å³æ¹æ³\n  private buildConfigs(config: any): { [prop: string]: any } {\n    let languageService = this.injector.get<LanguageService>(LanguageService, null);\n    if (!languageService) {\n      languageService = LanguageService.getInstance();\n    }\n\n    const defaultConfigs: any = {\n      title: languageService && languageService.defaultDialogTitle || '',\n      width: 800,\n      height: 500,\n      showButtons: false\n    };\n    const objectTypeConfig = this.getObjectTypeConfig(config);\n    const configs = Object.assign(defaultConfigs, objectTypeConfig);\n    const onClosingHandler = configs.beforeClose;\n    const refresh = configs['refresh'] || {};\n    const refreshCommandName = refresh && refresh.commandName || null;\n    const refreshFrameId = refresh && refresh.frameId || null;\n    // tslint:disable: no-string-literal\n    const cancelChanges = configs['cancelChanges'] || false;\n    configs.beforeClose = (ref) => {\n      if (!!onClosingHandler && typeof onClosingHandler === 'function') {\n        return onClosingHandler(ref).pipe(\n          switchMap(result => {\n            if (result) {\n              if (cancelChanges) {\n                return this.cancelChanges(ref).pipe(\n                  switchMap(() => this.refreshForm(refreshCommandName, refreshFrameId))\n                );\n              }\n            }\n            return of(result);\n          })\n        );\n      } else {\n        if (cancelChanges) {\n          return this.cancelChanges(ref).pipe(\n            switchMap(() => this.refreshForm(refreshCommandName, refreshFrameId))\n          );\n        } else {\n          return of(true);\n        }\n      }\n\n    };\n    return configs;\n  }\n  private getObjectTypeConfig(config: any) {\n    let objectTypeConfig: any\n    if (typeof config === 'undefined') {\n      config = {};\n    }\n    if (typeof config === 'string') {\n      if (config.length) {\n        try {\n          objectTypeConfig = JSON.parse(config);\n        } catch {\n          throw new Error(config + 'ä¸æ¯åæ³çjsonå­ç¬¦ä¸²');\n        }\n      } else {\n        objectTypeConfig = {};\n      }\n    } else if (typeof config === 'object') {\n      objectTypeConfig = Object.assign({}, config);\n    } else {\n      throw new Error('å¡«åå¯¹è±¡æ ¼å¼æjsonå­ç¬¦ä¸²');\n    }\n    return objectTypeConfig;\n  }\n  /**\n   * åæ¶æå¡å¨åæ´é\n   */\n  private cancelChanges(ref: any): Observable<boolean> {\n    if (ref && ref.modalRef && ref.modalRef.content) {\n      const component: FrameComponent = ref.modalRef.content as FrameComponent;\n      if (component && component.context) {\n        const repository = component.context.repository || null;\n        if (repository) {\n          return repository.cancelChanges().pipe(switchMap(() => of(true)));\n        }\n      }\n    }\n    return of(true);\n  }\n  private refreshForm(refreshCommandName: string, refreshFrameId: string): Observable<any> {\n    if (refreshCommandName && refreshFrameId) {\n      const frameContext = this.frameContext.appContext.frameContextManager.getFrameContextById(refreshFrameId);\n      if (frameContext) {\n        const viewModel = frameContext.viewModel;\n        return viewModel[refreshCommandName]().pipe(\n          map(() => true)\n        );\n      }\n    }\n    return of(true);\n  }\n  private createComponentRef(componentType: any, uiStateObject: any) {\n    let componentRef: any;\n    const frameContext = this.getFrameContext();\n    const componentFactoryResolver = this.getComponentFactoryResolver();\n    if (frameContext && componentFactoryResolver) {\n      const contentCmptFactory = componentFactoryResolver.resolveComponentFactory(componentType);\n      const modalContentInjector = ReflectiveInjector.resolveAndCreate([], frameContext.injector);\n      componentRef = contentCmptFactory.create(modalContentInjector);\n      if (componentRef && componentRef.instance && componentRef.instance.viewModel && componentRef.instance.viewModel.uiState) {\n        if (typeof uiStateObject === 'object' && Object.keys(uiStateObject).length) {\n          Object.keys(uiStateObject).forEach(item => {\n            componentRef.instance.viewModel.uiState.setPropertyValue(item, uiStateObject[item]);\n          });\n        }\n        // éå isDialogåæ°\n        componentRef.instance.viewModel.uiState.setPropertyValue('DEVKIT_DIALOG', true);\n      }\n    }\n    return componentRef;\n  }\n  /**\n   * å¼å®¹æ§å¼¹çªï¼è·åframeContext\n   */\n  private getFrameContext() {\n    if (this.frameContext) {\n      return this.frameContext\n    }\n    if (this['context'] && this['context']['frameContext']) {\n      return this['context']['frameContext'];\n    }\n    return null;\n  }\n  /**\n   * å¼å®¹æ§å¼¹çªï¼è·åComponentFactoryResolver\n   */\n  private getComponentFactoryResolver() {\n    const frameContext = this.getFrameContext();\n    let componentFactoryResolver: any;\n    if (frameContext) {\n      componentFactoryResolver = frameContext.injector.get(ComponentFactoryResolver);\n    }\n    return componentFactoryResolver;\n  }\n  //#endregion\n}\n","import { FrameContext } from '@farris/devkit';\nimport { AppParamUtil } from './app-param.util';\n\nconst IS_ADD = 'IS_ADD';\nconst LAST_MODIFIED_ID = 'LAST_MODIFIED_ID';\n\n/**\n * è¡¨åç¶æå·¥å·ç±»\n * @internal\n */\nclass EditStateUtil {\n\n    /**\n     * è·åå½åè¡id\n     */\n    public static getLastModifiedId(frameContext: FrameContext): string {\n        // const lastModifiedId = AppParamUtil.get(frameContext, LAST_MODIFIED_ID);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        let lastModifiedId = null;\n        if (virtualRootFrameContext) {\n            lastModifiedId = virtualRootFrameContext.getParam(LAST_MODIFIED_ID);\n            return lastModifiedId ? lastModifiedId : null;\n        }\n        return lastModifiedId;\n    }\n\n    /**\n     * è®¾ç½®æåä¿®æ¹çid\n     */\n    public static setLastModifiedId(frameContext: FrameContext, lastModifiedId: string): void {\n        // AppParamUtil.set(frameContext, LAST_MODIFIED_ID, lastModifiedId);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        if (virtualRootFrameContext) {\n            virtualRootFrameContext.setParam(LAST_MODIFIED_ID, lastModifiedId);\n        }\n    }\n\n    /**\n     * è·åæ°å¢ç¶æ\n     */\n    public static getAddState(frameContext: FrameContext, ): boolean {\n        // return AppParamUtil.get(frameContext, IS_ADD);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        if (virtualRootFrameContext) {\n            return virtualRootFrameContext.getParam(IS_ADD);\n        }\n    }\n\n    /**\n     * è®¾ç½®æ°å¢ç¶æ\n     */\n    public static setAddState(frameContext: FrameContext, lastModifiedId: string): void {\n        // AppParamUtil.set(frameContext, IS_ADD, true);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        if (virtualRootFrameContext) {\n            virtualRootFrameContext.setParam(IS_ADD, true);\n        }\n        this.setLastModifiedId(frameContext, lastModifiedId);\n    }\n\n    /**\n     * åæ¶æ°å¢ç¶æ\n     */\n    public static cancelAddState(frameContext: FrameContext) {\n        // AppParamUtil.set(frameContext, IS_ADD, false);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        if (virtualRootFrameContext) {\n            virtualRootFrameContext.setParam(IS_ADD, false);\n        }\n    }\n\n    /**\n     * è®¾ç½®ç¼è¾ç¶æ\n     */\n    public static setEditState(frameContext: FrameContext, id: string) {\n        // AppParamUtil.set(frameContext, IS_ADD, false);\n        const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n        if (virtualRootFrameContext) {\n            virtualRootFrameContext.setParam(IS_ADD, false);\n        }\n        this.setLastModifiedId(frameContext, id);\n    }\n}\n\nexport { EditStateUtil };\n","import { FrameContext  } from '@farris/devkit';\n\n/**\n * åºç¨ä¸ä¸æåéå·¥å·ç±»\n * @internal\n */\nclass AppParamUtil {\n\n  /**\n   * è·ååºç¨ä¸ä¸æåæ°\n   */\n  public static get(frameContext: FrameContext, name: string): any {\n    const appContext = frameContext.appContext;\n    return appContext.getParam(name);\n  }\n\n  /**\n   * è®¾ç½®åºç¨ä¸ä¸æåæ°\n   */\n  public static set(frameContext: FrameContext, name: string, value: any) {\n    const appContext = frameContext.appContext;\n    return appContext.setParam(name, value);\n  }\n}\n\nexport { AppParamUtil };\n","import { FormNotifyService } from './form-notify.service';\n\nclass FormNotifyStrategyService {\n  /**\n   * æ¶æ¯æç¤º\n   * @param formNotifyService formNotifyService\n   * @param content content\n   */\n  public static info(formNotifyService: FormNotifyService, content: string) {\n    const search = window.location.hash;\n    const { odocDisableNotification = '' } = FormNotifyStrategyService.querystring(search);\n    if (odocDisableNotification && odocDisableNotification.toLowerCase() === 'true') {\n      return;\n    }\n    formNotifyService.info(content, { hideTitle: true });\n  }\n  /**\n   * æåæç¤º\n   * @param formNotifyService formNotifyService\n   * @param content content\n   */\n  public static success(formNotifyService: FormNotifyService, content: string) {\n    const search = window.location.hash;\n    const { odocDisableNotification = '' } = FormNotifyStrategyService.querystring(search);\n    if (odocDisableNotification && odocDisableNotification.toLowerCase() === 'true') {\n      return;\n    }\n    formNotifyService.success(content, { hideTitle: true });\n  }\n  private static querystring(querystring: string): any {\n    const urlSearchParams = new URLSearchParams(querystring);\n    const result = {};\n    urlSearchParams.forEach((value: string, key: string) => {\n      result[key] = value;\n    });\n    return result;\n  }\n}\nexport { FormNotifyStrategyService };\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { filter, take } from 'rxjs/operators';\nimport { AppContext, ViewModel, CommandContext, Entity, FrameContext } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\n\n/**\n * å½ä»¤æå¡\n * @scope FrameConmponent\n */\n@Injectable()\nclass CommandService {\n\n  /**\n   * åé¨cotnext\n   */\n  private innerContext: CommandContext;\n\n  /**\n   * contextåå¼æ¹æ³\n   */\n  public get context(): CommandContext {\n    return this.innerContext;\n  }\n\n  /**\n   * contextè®¾å¼æ¹æ³\n   */\n  public set context(context: CommandContext) {\n    this.innerContext = context;\n  }\n\n  constructor(\n    private viewModel: ViewModel,\n    private appContext: AppContext\n  ) { }\n\n  /**\n   * æ§è¡å½ä»¤\n   * @param commandName å½ä»¤åç§°\n   * @param frameId æ¡æ¶ID\n   */\n  public execute(commandName: string, frameId?: string): Observable<any> {\n    if (!commandName || commandName === '' || commandName === 'undefined') {\n      return;\n    }\n    let viewModel = this.viewModel;\n    if (frameId) {\n      const targetContext = this.appContext.frameContextManager.getFrameContextById(frameId);\n      viewModel = targetContext.viewModel;\n    }\n    return viewModel[commandName]();\n  }\n\n  /**\n   * ç­å¾BeSessionåå»º\n   * @returns ææ°åå»ºåºæ¥çBeSession\n   */\n  public waitForBeSession(): Observable<string> {\n    const frameContext = this.context.frameContext;\n    const befRepository = frameContext.repository as BefRepository<Entity>;\n    const sessionService = befRepository.restService.sessionService;\n    return sessionService.getBeSessionId().pipe(\n      filter((beSessionId: string) => {\n        return beSessionId !== null;\n      }),\n      take(1)\n    );\n  }\n\n  /**\n   * æåæä¸ªä»»å¡çæ§è¡ç»æ\n   * @param taskName ä»»å¡åç§°\n   * @reutrn è¿åtaskNameå¯¹åºä»»å¡çæ§è¡ç»æ\n   */\n  public extractResult(taskName: string) {\n    const results = this.context.results;\n    return results[taskName];\n  }\n  /**\n   * æåå½åç»ä»¶çè¡åæ¢äºä»¶æåº\n   */\n  public suspendFrameContextRowSelectedEvent(frameId?: string) {\n    let frameContext: FrameContext = this.viewModel.frameContext;\n    if (frameId) {\n      frameContext = this.viewModel.frameContext.appContext.frameContextManager.getFrameContextById(frameId);\n    }\n    if (frameContext) {\n      frameContext.bindingData.rowSelectedEventSuspend = true;\n    }\n\n  }\n  public resumeFrameContextRowSelectedEvent(frameId?: string) {\n    let frameContext: FrameContext = this.viewModel.frameContext;\n    if (frameId) {\n      frameContext = this.viewModel.frameContext.appContext.frameContextManager.getFrameContextById(frameId);\n    }\n    if (frameContext) {\n      frameContext.bindingData.rowSelectedEventSuspend = false;\n    }\n  }\n}\n\nexport { CommandService };\n","// tslint:disable: max-line-length\nimport { Injectable, Optional } from '@angular/core';\nimport { Repository, Entity, FrameContext, PARENT_CLASS, ChangeType, ValidationResult, ValidationError, ValidateRule, ViewModel, DataTypeInfo, DataPropGroup, DataPropInfo, BindingList } from '@farris/devkit';\nimport { tap, switchMap } from 'rxjs/operators';\nimport { EMPTY, Observable, Subject } from 'rxjs';\nimport { zip } from 'rxjs/observable/zip';\nimport { empty } from 'rxjs/observable/empty';\nimport { of } from 'rxjs/observable/of';\nimport { VerifyDetailService } from '@farris/ui-verify-detail';\nimport { FormNotifyService } from './form-notify.service';\nimport { LanguageService } from './languag.service';\n\n/**\n * è¡¨åéªè¯æå¡\n * @scope FrameComponent\n */\n\n@Injectable()\nclass ValidationService {\n\n  private validationResults = new Subject<any>();\n  private validationAllResult = new Subject<any>();\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private repository: Repository<any>,\n    private frameContext: FrameContext,\n    @Optional() private notifyService: FormNotifyService,\n    @Optional() private languageService: LanguageService\n  ) {\n    if (!this.languageService) {\n      this.languageService = new LanguageService();\n    }\n  }\n\n  /**\n   * éªè¯è¡¨ååçææè¡¨å\n   */\n  public validate() {\n    this.repository.getList().subscribe(\n      (result: Entity[]) => {\n        for (const entity of result) {\n          entity.validate().subscribe((result: ValidationResult) => {\n            if (!result.isValid) {\n              alert(result.message);\n              this.validationResults.next(result);\n            }\n          });\n        }\n      }\n    );\n    return this.validationResults;\n  }\n  /**\n   * æ ¡éªå½åè¡\n   */\n  public validateCurrentRow(): Observable<any> {\n    const entityTypeInfo = this.repository.entityTypeInfo;\n    // ç»åè¡¨ååªæ ¡éªå½åæé®æå¨çè¡¨å\n    const primaryValue = this.frameContext.bindingData.list.currentId;\n    if (!primaryValue) {\n      return of(true);\n    }\n    // é¦åæ ¡éªå®ä½ä¸è½ä¸ºç©ºè§å\n    const entity = this.repository.entityCollection.getEntityById(primaryValue);\n    if (!entity) {\n      return of(true);\n    }\n    const isEntityValid = this.validateEntityAllowEmptyRule(entity, entityTypeInfo);\n    if (!isEntityValid) {\n      return EMPTY;\n    }\n    const entities: Entity[] = [entity];\n    const namespace = this.frameContext.namespace;\n    let frameContexts = [];\n    // ä¿®å¤ä½¿ç¨ç¸åbeåå»ºçvoçç»åè¡¨åæ ¡éªæ¶å¤ä¸ªè¡¨åæ ¡éªè§åè¢«åå¹¶çé®é¢\n    // TODO: ç®åæªèèç»åè¡¨åç»ä¸ä¿å­çåºæ¯ï¼åç»­æ¯æç»åè¡¨åç»ä¸ä¿å­æ¶åä¿®æ¹\n    if (namespace !== null) {\n      // å­å¨å½åç©ºé´ï¼è¯´æè¡¨åè¾æ°ï¼å¯ä»¥ä¾èµè¯¥ç¹æ§\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContextsByNamespace(namespace);\n    } else {\n      // è¡¨åè¾èï¼è·åææçä¸ä¸æï¼å¨æ ¡éªé¶æ®µè¿æ»¤è§å\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContexts();\n    }\n\n    const isModal = this.isInDialog();\n    const hasOwnVerifyDetailService = this.hasOwnVerifyDetailService();\n    let rootViewModel = this.frameContext.root.viewModel;\n    if (isModal && hasOwnVerifyDetailService) {\n      rootViewModel = this.frameContext.getVirtualRootFrameContext().viewModel;\n    }\n\n    let toValidate = false;\n    const formErrors = [];\n    frameContexts.forEach((frameContext: FrameContext) => {\n      if (frameContext.form && frameContext.form.enableValidate) {\n        toValidate = true;\n      }\n    });\n    if (!toValidate || entities.length < 1) {\n      return of(true);\n    }\n    rootViewModel.verifyInformations = [];\n    let formValid = true;\n    let entityValid = true;\n    const formValidationRules = new Map<string, ValidateRule[]>();\n    frameContexts.forEach((formContext: FrameContext) => {\n      const bindingObject = formContext.bindingData.getObject();\n      // éç¥ææbindingData,\n      bindingObject && bindingObject.setShowValidationMsg(true);\n      if (formContext.form && formContext.form.enableValidate) {\n        // è·åå½åè¡¨åä¸çææéªè¯è§å\n        const currentFormValidationRules = formContext.form.getValidationRules();\n        currentFormValidationRules.forEach((rules, path) => {\n          if (formValidationRules.has(path)) {\n            rules.forEach(rule => formValidationRules.get(path).push(rule));\n          } else {\n            formValidationRules.set(path, [...rules]);\n          }\n        });\n        formContext.form.setShowValidationMsg(true);\n        // éä¸ªè°ç¨è¡¨åçéªè¯ï¼éªè¯åç«¯è¡¨åè§å\n        if (!formContext.form.isFormValid()) {\n          formErrors.push(formContext.form);\n          formValid = false;\n        }\n      }\n    });\n\n    // éªè¯ææå®ä½\n    const observableList = entities.map((entity: Entity) => {\n      const index = this.frameContext.bindingData.list.getIndexById(entity.primaryValue);\n      return entity.validate(undefined, undefined, formValidationRules, null, this.frameContext);\n    });\n    const result$ = zip(...observableList).pipe(\n      tap((resultList) => {\n        frameContexts.forEach((formContext: FrameContext) => {\n          if (!formContext.form.enableValidate) {\n            return;\n          }\n          const handleErrors = (errors: ValidationError[]) => {\n            errors.forEach((validationError: ValidationError) => {\n              if (validationError.children && validationError.children.length) {\n                handleErrors(validationError.children);\n              }\n              const errMsgObj = {};\n              let id = '';\n              const findId = (target: any) => {\n                if (target && target.data && target.data.id) {\n                  id = target.data.id;\n                  return;\n                } else if (target[PARENT_CLASS]) {\n                  findId(target[PARENT_CLASS]);\n                }\n              };\n              findId(validationError.target);\n\n              // å®ä½éªè¯åºéï¼éè¦å°éè¯¯å±ç¤ºå°çé¢ä¸\n              // å®ä½ä¸ä¸å®æ¯å½åè¡\n              let parentPathData = {\n                path: [],\n                isUdt: false,\n                isGrid: false\n              };\n              if (validationError.target) {\n                parentPathData = validationError.target.getPaths();\n              }\n              const bindingPath = '/' + parentPathData.path.join('/');\n              if (validationError.constraints) {\n                Object.keys(validationError.constraints).forEach(key => {\n                  errMsgObj[key] = {\n                    name: validationError.constraints[key]\n                  };\n                  // if (this.frameContext.viewModel.bindingPath === bindingPath) {\n                  //   rootViewModel['verifyInformations'].push({\n                  //     id: id,\n                  //     title: key,\n                  //     msg: validationError.constraints[key],\n                  //     type: 'warn'\n                  //   })\n                  // }\n                });\n              }\n              const paths = parentPathData.path.concat(validationError.property);\n\n              //if (this.frameContext.viewModel.bindingPath === bindingPath) {\n              // å°éè¯¯ä¿¡æ¯æ´æ°å°formControlä¸\n              formContext.bindingData.changes.next({\n                type: ChangeType.UpdateErrors,\n                id,\n                path: paths,\n                isUdt: parentPathData.isUdt,\n                isGrid: parentPathData.isGrid,\n                value: validationError.value,\n                errors: errMsgObj\n              });\n              //}\n            });\n          };\n          // å±å¼éªè¯ç»æ\n          const isValidList = resultList.map((result: ValidationResult) => result.isValid);\n          // ä¿å­ååè°ç¨å®ä½ä¸çéªè¯è§åï¼å¨é¨éè¿ä¹åæä¿å­\n          // å®ä½éªè¯éè¿\n          if (isValidList.filter(x => x).length === observableList.length) {\n            // å°éè¯¯ä¿¡æ¯æ´æ°å°formControlä¸\n            formContext.bindingData.changes.next({\n              type: ChangeType.UpdateErrors,\n              path: []\n            });\n            // éªè¯æååéèè¾å¥æ¶çéªè¯\n            if (formValid) {\n              const bindingObject = formContext.bindingData.getObject();\n              bindingObject && bindingObject.setShowValidationMsg(false);\n              const form = formContext.form;\n              if (form) {\n                form.setShowValidationMsg(false);\n              }\n            }\n          } else {\n            // å®ä½éªè¯æéè¯¯\n            entityValid = false;\n            resultList.forEach((result: ValidationResult) => {\n              if (result.isValid) {\n                // æ¸é¤éªè¯éè¿çéè¯¯\n                formContext.bindingData.changes.next({\n                  type: ChangeType.UpdateErrors,\n                  path: []\n                });\n              } else {\n                handleErrors(result.errors);\n              }\n            });\n          }\n        });\n      }),\n      switchMap((resultList) => {\n        let isValidated = true;\n        const errors = [];\n        resultList.forEach((result: ValidationResult) => {\n          if (!result.isValid) {\n            isValidated = false;\n          }\n          errors.push(...result.errors);\n        });\n        if (errors.length > 0) {\n          this.collectValidationErrors(rootViewModel, errors, this.frameContext.namespace);\n        }\n        // rootViewModel.verifycationChanged.next(rootViewModel.verifyInformations);\n        let verifyInformations = rootViewModel.verifyInformations;\n        if (isModal && hasOwnVerifyDetailService) {\n          verifyInformations = rootViewModel.verifyInformations.filter(item => item.namespace === namespace);\n        }\n        rootViewModel.verifycationChanged.next(verifyInformations);\n        if (isValidated && !formValid) {\n          // å®ä½æ ¡éªéè¿ä½è¡¨åæ ¡éªä¸éè¿ï¼æ­¤æ¶å®ä½åè¡¨åå­å¨æ ¡éªè§åä¸ä¸è´çæåµ\n          console.warn('å®ä½åæ§ä»¶æ ¡éªè§åä¸ä¸è´ï¼ä¼å¯¼è´å½ä»¤æ§è¡ä¸­æ­ï¼');\n        }\n        if (isValidated && formValid) {\n          return of(true);\n        } else {\n          return empty();\n        }\n      })\n    );\n    return result$;\n  }\n  /**\n   * è°ç¨è¡¨ååå®ä½ä¸çéªè¯è§å, éè¿åè°ç¨åè°cb\n   */\n  validateAll(): Observable<any> {\n    // ç»åè¡¨ååªæ ¡éªå½åæé®æå¨çè¡¨å\n    const entities: Entity[] = this.repository.entityCollection.getAllEntities();\n    const namespace = this.frameContext.namespace;\n    let frameContexts = [];\n    if (namespace !== null) {\n      // å­å¨å½åç©ºé´ï¼è¯´æè¡¨åè¾æ°ï¼å¯ä»¥ä¾èµè¯¥ç¹æ§\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContextsByNamespace(namespace);\n    } else {\n      // è¡¨åè¾èï¼è·åææçä¸ä¸æï¼å¨æ ¡éªé¶æ®µè¿æ»¤è§å\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContexts();\n    }\n\n    let toValidate = false;\n    const formErrors = [];\n    frameContexts.forEach((frameContext: FrameContext) => {\n      if (frameContext.form && frameContext.form.enableValidate) {\n        toValidate = true;\n      }\n    });\n    if (!toValidate || entities.length < 1) {\n      return of(true);\n    }\n    const isModal = this.isInDialog();\n    const hasOwnVerifyDetailService = this.hasOwnVerifyDetailService();\n    let rootViewModel = this.frameContext.root.viewModel;\n    if (isModal && hasOwnVerifyDetailService) {\n      rootViewModel = this.frameContext.getVirtualRootFrameContext().viewModel;\n    }\n\n    let formValid = true;\n    let entityValid = true;\n    const formValidationRules = new Map<string, ValidateRule[]>();\n    frameContexts.forEach((formContext: FrameContext) => {\n      const bindingObject = formContext.bindingData.getObject();\n      // éç¥ææbindingData,\n      bindingObject && bindingObject.setShowValidationMsg(true);\n      if (formContext.form && formContext.form.enableValidate) {\n        // è·åå½åè¡¨åä¸çææéªè¯è§å\n        const currentFormValidationRules = formContext.form.getValidationRules();\n        currentFormValidationRules.forEach((rules, path) => {\n          if (formValidationRules.has(path)) {\n            rules.forEach(rule => formValidationRules.get(path).push(rule));\n          } else {\n            formValidationRules.set(path, [...rules]);\n          }\n        });\n        formContext.form.setShowValidationMsg(true);\n        // éä¸ªè°ç¨è¡¨åçéªè¯ï¼éªè¯åç«¯è¡¨åè§å\n        if (!formContext.form.isFormValid()) {\n          formErrors.push(formContext.form);\n          formValid = false;\n        }\n      }\n    });\n    // è§¦åææå®ä½çvalidateäºä»¶\n    const isMultiEntityValiate = entities.length > 0;\n\n    // éªè¯ææå®ä½\n    const observableList = entities.map((entity: Entity, index: number) =>\n      entity.validate(undefined, undefined, formValidationRules, isMultiEntityValiate ? index : null, this.frameContext));\n    const result$ = zip(...observableList).pipe(\n      tap((resultList) => {\n        frameContexts.forEach((formContext: FrameContext) => {\n          if (!formContext.form.enableValidate) {\n            return;\n          }\n          const handleErrors = (errors: ValidationError[]) => {\n            errors.forEach((validationError: ValidationError) => {\n              if (validationError.children && validationError.children.length) {\n                handleErrors(validationError.children);\n              }\n              const errMsgObj = {};\n              let id = '';\n              const findId = (target: any) => {\n                if (target && target.data && target.data.id) {\n                  id = target.data.id;\n                  return;\n                } else if (target[PARENT_CLASS]) {\n                  findId(target[PARENT_CLASS]);\n                }\n              };\n              findId(validationError.target);\n\n              // å®ä½éªè¯åºéï¼éè¦å°éè¯¯å±ç¤ºå°çé¢ä¸\n              // å®ä½ä¸ä¸å®æ¯å½åè¡\n              let parentPathData = {\n                path: [],\n                isUdt: false,\n                isGrid: false\n              };\n              if (validationError.target) {\n                parentPathData = validationError.target.getPaths();\n              }\n              const bindingPath = '/' + parentPathData.path.join('/');\n              if (validationError.constraints) {\n                Object.keys(validationError.constraints).forEach(key => {\n                  errMsgObj[key] = {\n                    name: validationError.constraints[key]\n                  };\n                  // if (this.frameContext.viewModel.bindingPath === bindingPath) {\n                  //   rootViewModel['verifyInformations'].push({\n                  //     id: id,\n                  //     title: key,\n                  //     msg: validationError.constraints[key],\n                  //     type: 'warn'\n                  //   })\n                  // }\n                });\n              }\n              const paths = parentPathData.path.concat(validationError.property);\n\n              //if (this.frameContext.viewModel.bindingPath === bindingPath) {\n              // å°éè¯¯ä¿¡æ¯æ´æ°å°formControlä¸\n              formContext.bindingData.changes.next({\n                type: ChangeType.UpdateErrors,\n                id,\n                path: paths,\n                isUdt: parentPathData.isUdt,\n                isGrid: parentPathData.isGrid,\n                value: validationError.value,\n                errors: errMsgObj\n              });\n              //}\n            });\n          };\n          // å±å¼éªè¯ç»æ\n          const isValidList = resultList.map((result: ValidationResult) => result.isValid);\n          // ä¿å­ååè°ç¨å®ä½ä¸çéªè¯è§åï¼å¨é¨éè¿ä¹åæä¿å­\n          // å®ä½éªè¯éè¿\n          if (isValidList.filter(x => x).length === observableList.length) {\n            // å°éè¯¯ä¿¡æ¯æ´æ°å°formControlä¸\n            formContext.bindingData.changes.next({\n              type: ChangeType.UpdateErrors,\n              path: []\n            });\n            // éªè¯æååéèè¾å¥æ¶çéªè¯\n            if (formValid) {\n              const bindingObject = formContext.bindingData.getObject();\n              bindingObject && bindingObject.setShowValidationMsg(false);\n              const form = formContext.form;\n              if (form) {\n                form.setShowValidationMsg(false);\n              }\n            }\n          } else {\n            // å®ä½éªè¯æéè¯¯\n            entityValid = false;\n            resultList.forEach((result: ValidationResult) => {\n              if (result.isValid) {\n                // æ¸é¤éªè¯éè¿çéè¯¯\n                formContext.bindingData.changes.next({\n                  type: ChangeType.UpdateErrors,\n                  path: []\n                });\n              } else {\n                handleErrors(result.errors);\n              }\n            });\n          }\n        });\n      }),\n      switchMap((resultList) => {\n        let isValidated = true;\n        const errors = [];\n        resultList.forEach((result: ValidationResult) => {\n          if (!result.isValid) {\n            isValidated = false;\n          }\n          errors.push(...result.errors);\n        });\n        if (errors.length > 0) {\n          this.collectValidationErrors(rootViewModel, errors, this.frameContext.namespace);\n        }\n        let verifyInformations = rootViewModel.verifyInformations;\n        if (isModal && hasOwnVerifyDetailService) {\n          verifyInformations = rootViewModel.verifyInformations.filter(item => item.namespace === namespace);\n        }\n        // å ä¸ºæ ¡éªç´¯å çç¼æï¼å¯¼è´ä¹åçæ ¡éªä¿¡æ¯ä¸ç´å­å¨ï¼åªè½éè¿æ ¡éªç»ææ¥ç¡®å®æ¯å¦è¿æéè¯¯ä¿¡æ¯\n        if (isValidated && formValid) {\n          verifyInformations = rootViewModel.verifyInformations = [];\n        }\n        rootViewModel.verifycationChanged.next(verifyInformations);\n        if (isValidated && formValid) {\n          return of(true);\n        } else {\n          return empty();\n        }\n      })\n    );\n    return result$;\n  }\n  /**\n   * æ ¡éªå®ä½æ¯å¦æ»¡è¶³ä¸è½ä¸ºç©ºçè§å\n   * @param entity ä¸»å®ä½\n   */\n  private validateEntityAllowEmptyRule(entity: Entity, entityTypeInfo: DataTypeInfo) {\n    // ç¡®è®¤å®ä½åä¸ªå±çº§ä¸­æ¯å¦å­å¨ä¸è½ä¸ºç©ºçè§å\n    const paths = this.getNotAllowEmptyBindingPaths(entityTypeInfo);\n    if (!paths || paths.length < 1) {\n      return true;\n    }\n    // æ¾å°ææä¸åæ³çbindingPaths\n    const invalidPaths = paths.filter((path: string) => {\n      const bindingPaths = path.split('/').filter(p => p);\n      const bindingList = this.frameContext.bindingData.getValue(bindingPaths) as BindingList;\n      if (!bindingList || bindingList.length < 1) {\n        return true;\n      }\n      return false;\n    });\n    if (invalidPaths.length > 0) {\n      const tableNames = [];\n      invalidPaths.forEach((path: string) => {\n        const viewModelName = this.getViewModelNameByBindingPaths(path.split('/'));\n        tableNames.push(viewModelName);\n      });\n      if (this.notifyService) {\n        this.notifyService.error(`${tableNames.join('ï¼')} ${this.languageService.tableCanNotEmpty}`, { hideTitle: true });\n      }\n      return false;\n    }\n    return true;\n  }\n  /**\n   * \n   * @param bindingPaths pathä¸è½ä¸ºç©ºæ/ï¼ä¸æ¯æä¸»è¡¨\n   */\n  private getViewModelNameByBindingPaths(bindingPaths: string[]) {\n    const namespace = this.frameContext.namespace;\n    let frameContexts: FrameContext[] = null;\n    if (namespace !== null) {\n      // å­å¨å½åç©ºé´ï¼è¯´æè¡¨åè¾æ°ï¼å¯ä»¥ä¾èµè¯¥ç¹æ§\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContextsByNamespace(namespace);\n    } else {\n      // è¡¨åè¾èï¼è·åææçä¸ä¸æï¼å¨æ ¡éªé¶æ®µè¿æ»¤è§å\n      frameContexts = this.frameContext.appContext.frameContextManager.getFrameContexts();\n    }\n    const bindingPath = bindingPaths.filter(p => p).join('/');\n    const frameContext = frameContexts.find((frameContext: FrameContext) => frameContext.viewModel && frameContext.viewModel.bindingPath.split('/').filter(p => p).join('/') === bindingPath);\n    const viewModelName = frameContext && frameContext.form && frameContext.form.formGroupName || '';\n    return viewModelName;\n  }\n  private getNotAllowEmptyBindingPaths(entityTypeInfo: DataTypeInfo): string[] | undefined {\n    if (!entityTypeInfo) {\n      return undefined;\n    }\n    const paths = [];\n    this.deepFirstTraversalEntityTypeInfo(entityTypeInfo, paths);\n    return paths;\n  }\n  private deepFirstTraversalEntityTypeInfo(entityTypeInfo: DataTypeInfo, result: string[] = [], previousValue: string[] = []) {\n    const list = entityTypeInfo.getPropInfosByGroup(DataPropGroup.List);\n    if (list && list.length > 0) {\n      list.forEach((propInfo: DataPropInfo) => {\n        const typeInfo = propInfo.typeInfo;\n        if (typeInfo && typeInfo.entityInfo && typeInfo.entityInfo.allowEmpty === false) {\n          previousValue.push(typeInfo.entityInfo.nodeCode);\n          this.deepFirstTraversalEntityTypeInfo(typeInfo, result, previousValue);\n        }\n      });\n    }\n    // æ²¡æä¸çº§äºï¼æ­¤æ¶åºè¯¥æ¸ç©ºæ¸¸æ ï¼å°æ¶éå°çè·¯å¾æ¾å°ç»æéä¸­\n    if (previousValue && previousValue.length > 0) {\n      const paths = previousValue.join('/');\n      result.push(paths);\n    }\n    previousValue.splice(0, previousValue.length);\n  }\n  collectValidationErrors(rootViewModel: ViewModel, errors: ValidationError[], namespace: string, filter: boolean = true) {\n    if (filter) {\n      rootViewModel.verifyInformations = rootViewModel.verifyInformations.filter(item => item.namespace !== namespace);\n    }\n    errors.forEach((validationError: ValidationError) => {\n      if (validationError.children && validationError.children.length) {\n        this.collectValidationErrors(rootViewModel, validationError.children, namespace, false);\n      }\n      let id = '';\n      const findId = (target: any) => {\n        if (target && target.data && target.data.id) {\n          id = target.data.id;\n          return;\n        } else if (target[PARENT_CLASS]) {\n          findId(target[PARENT_CLASS]);\n        }\n      };\n      findId(validationError.target);\n      if (validationError.constraints) {\n        const validationResultTypes = Object.keys(validationError.constraints);\n        if (validationResultTypes.length) {\n          const offset = rootViewModel.verifyInformations.filter(item => item.namespace === namespace).length;\n          let index = rootViewModel.verifyInformations.findIndex(item => item.namespace === namespace);\n          index = index === -1 ? 0 : index + offset;\n          rootViewModel.verifyInformations.splice(index, 0, {\n            id: id,\n            namespace,\n            targetField: validationError.field,\n            index: validationError.index,\n            title: validationError.propertyName,\n            msg: validationError.constraints[validationResultTypes[0]],\n            frameContext: validationError.frameContext,\n            fullPath: validationError.fullPath,\n            type: validationResultTypes[0] === 'required' ? 'empty' : 'error'\n          });\n        }\n      }\n    });\n  }\n  /**\n   * éç½®æ ¡éªä¿¡æ¯ï¼ä»å½åè¡¨åï¼\n   */\n  public resetValidation(): Observable<any> {\n    const isDialog = this.isInDialog();\n    let rootViewModel = this.frameContext.root.viewModel;\n    if (isDialog) {\n      rootViewModel = this.frameContext.getVirtualRootFrameContext().viewModel;\n    }\n    let verifyInformations = rootViewModel.verifyInformations;\n    if (verifyInformations.length) {\n      const namespace = this.frameContext.namespace;\n      if (namespace !== null) {\n        verifyInformations = rootViewModel.verifyInformations.filter(item => item.namespace !== namespace);\n      }\n      rootViewModel.verifyInformations = verifyInformations;\n      //rootViewModel.verifyInformations.splice(0, rootViewModel.verifyInformations.length);\n    }\n    if (rootViewModel && rootViewModel.verifycationChanged) {\n      rootViewModel.verifycationChanged.next(verifyInformations);\n    }\n    return of(null);\n  }\n  /**\n   * æ¯å¦å¨å¼¹çªåé¨\n   */\n  private isInDialog() {\n    return this.frameContext && this.frameContext.getVirtualRootFrameContext() && this.frameContext.getVirtualRootFrameContext().frameComponent && this.frameContext.getVirtualRootFrameContext().frameComponent['isDialogRootComponent'] || false;\n  }\n  /**\n   * æ¥æç¬èªçæ ¡éªæç¤ºæå¡\n   */\n  private hasOwnVerifyDetailService() {\n    return this.frameContext.injector.get<VerifyDetailService>(VerifyDetailService, null) !== this.frameContext.root.appContext.injector.get<VerifyDetailService>(VerifyDetailService, null);;\n  }\n}\n\nexport { ValidationService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Entity, BindingData, FrameContext, ViewModel } from '@farris/devkit';\nimport { BefRepository, BefRepositoryUtil } from '@farris/bef';\nimport { Observable, of, empty, EMPTY, concat, zip, from, Subject } from 'rxjs';\nimport { tap, switchMap, concatMap, concatAll, takeLast, last } from 'rxjs/operators';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { LanguageService } from '../languag.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { EditStateUtil } from './utils/index';\nimport { FormNotifyStrategyService } from '../form-notify-strategy.service';\nimport { RuntimeFrameworkService } from '../rtf-service';\nimport { DataType, WEB_FORM_ROUTE_PARAMS_KEY } from '../types';\nimport { CommandService } from '../command-service';\nimport { ValidationService } from '../validation.service';\n// tslint:disable: no-string-literal\n// tslint:disable: max-line-length\n/**\n * å¡çä»åºæå¡\n */\n@Injectable()\nclass CardDataService {\n\n  /**\n   * å®ä½ä»åº\n   */\n  private repository: BefRepository<Entity>;\n\n  /**\n   * ç»å®æ°æ®\n   */\n  private bindingData: BindingData;\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private formMessageService: FormMessageService,\n    private frameContext: FrameContext,\n    private loadingService: FormLoadingService,\n    private formNotifyService: FormNotifyService,\n    @Optional() private languageService: LanguageService,\n    private formErrorService: FormErrorService,\n    private runtimeFrameworkService: RuntimeFrameworkService,\n    private commandService: CommandService\n  ) {\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n    this.repository = this.frameContext.repository as BefRepository<Entity>;\n    this.bindingData = this.frameContext.bindingData;\n  }\n\n  /**\n   * å è½½æ°æ®\n   * @param id ä¸»å®ä½id\n   * @param enableChildrenPagination å¯ç¨å­è¡¨åé¡µ\n   */\n  public load(id: string): Observable<Entity> {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    this.frameContext.appContext.params.set(\"retrieveing\", true);\n    this.frameContext.appContext.params.delete('queryChild');\n    const get$ = this.repository.getById(id);\n    return get$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * å è½½å\n   * @param id id\n   * @param transitionActionParamName ç¶æè¿ç§»å¨ä½åæ°ç¼å·\n   * @returns \n   */\n  public onLoading(transitionActionParamName: string) {\n    const tabId = this.runtimeFrameworkService && this.runtimeFrameworkService.tabId || null;\n    if (!tabId) {\n      return;\n    }\n    let skip = true;\n    const listening = this.frameContext.appContext.params.get(tabId) || false;\n    transitionActionParamName = transitionActionParamName || 'transitionAction';\n    if (!listening) {\n      this.frameContext.appContext.params.set(tabId, true);\n      this.runtimeFrameworkService.getEntityParam(tabId, (options: any) => {\n        if (skip) {\n          skip = false;\n          return;\n        }\n        const params = this.parseParams(options);\n        if (params && params.sync) {\n          const action = params.action;\n          const id = params.id;\n          const ngCommand = this.frameContext && this.frameContext.viewModel && this.frameContext.viewModel.metadatas && this.frameContext.viewModel.metadatas[action];\n          const actionName = ngCommand.params && ngCommand.params[transitionActionParamName] || null;\n          const formPrimaryValue = this.frameContext.bindingData.list.currentId;\n          const formState = this.frameContext.stateMachine.context.state;\n          let state = null;\n          let stateName: string;\n          if (!actionName) {\n            // å¯è½æ¯ç¨æ·èªå·±éç½®çå½ä»¤ï¼æ²¡æç¶ææºåæ¢ï¼æ­¤æ¶ä¸åå¤æ­ç¶ææº\n            state = formState;\n          }\n          else {\n            const ngAction = this.frameContext && this.frameContext.stateMachine && this.frameContext.stateMachine.metadatas && this.frameContext.stateMachine.metadatas.actions && this.frameContext.stateMachine.metadatas.actions[actionName];\n            state = ngAction && ngAction.transitTo || formState;\n            stateName = this.frameContext && this.frameContext.stateMachine && this.frameContext.stateMachine.metadatas && this.frameContext.stateMachine.metadatas && this.frameContext.stateMachine.metadatas.states[state] && this.frameContext.stateMachine.metadatas.states[state].name || this.languageService.defaultStateName;\n            if (stateName && stateName.startsWith('{{') && stateName.endsWith('}}')) {\n              const key = stateName.replace('{{', '').replace('}}', '');\n              stateName = this.frameContext.translate.transform(key, null);\n            }\n          }\n          const primaryValueChanged = formPrimaryValue !== id;\n          const stateChanged = formState !== state;\n\n          if (primaryValueChanged && stateChanged) {\n            // ååçåå\n            const message = this.languageService.dataAndStateChanged.replace(/\\$1/g, stateName);\n            this.showLoadingConfirm(message).pipe(switchMap(() => {\n              return this.resetForm(action);\n            })).subscribe();\n          } else if (primaryValueChanged) {\n            // ä¸»é®åçåå\n            this.showLoadingConfirm(this.languageService.dataChanged).pipe(switchMap(() => {\n              return this.resetForm(action);\n            })).subscribe();\n          } else if (stateChanged) {\n            // ç¶æåçåå\n            const message = this.languageService.stateChanged.replace(/\\$1/g, stateName);\n            this.showLoadingConfirm(message).pipe(switchMap(() => {\n              return this.resetForm(action);\n            })).subscribe();\n          } else {\n            // æ°æ®åç¶æåæªåçåå\n            return of(true);\n          }\n        }\n      }, false);\n    }\n  }\n\n  /**\n   * æ°å¢\n   */\n  public add(): Observable<any> {\n    const lastModifiedId = this.bindingData.list.currentId;\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const create$ = this.repository.create();\n    return create$.pipe(\n      tap(\n        () => {\n          EditStateUtil.setEditState(this.frameContext, lastModifiedId);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.addFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * çº§èæ°å¢\n   */\n  public cascadeAdd(): Observable<any> {\n    const subject = new Subject<any>();\n    // æ¾å°ææviewmodel,æ¿å°äºææçframeContextï¼å¯è½æç»åè¡¨åç\n    const frameContexts = this.frameContext.appContext.frameContextManager.getFrameContexts();\n    // æ¾å°å½åframeContextçå¬å±namespace\n    const currentNamespace = this.frameContext.getVirtualRootFrameContext().namespace;\n    // æ¿å°å½åå½ä»¤æå¨frameçè¡¨åçææframeContext\n    const currentFormFrameContexts = frameContexts.filter((context: FrameContext) => context.namespace === currentNamespace) || [];\n    let bindingPaths = [];\n    if (currentFormFrameContexts && currentFormFrameContexts.length > 0) {\n      // æ¾å°ææä¸çº§frameContext\n      const childFrameContexts = currentFormFrameContexts.filter((context: FrameContext) => context.viewModel.bindingPath && context.viewModel.bindingPath !== '/');\n      if (childFrameContexts && childFrameContexts.length > 0) {\n        const childBindingPaths = childFrameContexts.map((context: FrameContext) => context.viewModel.bindingPath);\n        if (childBindingPaths && childBindingPaths.length > 0) {\n          bindingPaths = childBindingPaths.map(path => path.split('/').filter(p => p)).sort((a, b) => a.length - b.length);\n        }\n      }\n    }\n    this.loadingService.show();\n    this.repository.create().pipe(\n      switchMap((entity: Entity) => {\n        const rid = entity.primaryValue;\n        if (bindingPaths && bindingPaths.length > 0) {\n          return from(bindingPaths).pipe(\n            concatMap((bindingPath: Array<any>) => {\n              const fpath = this.getPath(this.frameContext.viewModel, '/' + bindingPath.join('/'), rid);\n              return this.repository.appendByPath(fpath);\n            })\n          );\n        } else {\n          return of(entity);\n        }\n      })\n    ).pipe(last()).subscribe(\n      () => {\n        this.loadingService.hide();\n        subject.next();\n      },\n      (error: any) => {\n        this.loadingService.hide();\n        this.formErrorService.exception(this.languageService.addFailed, error);\n      });\n    return subject;\n  }\n\n  /**\n   * ç¼è¾ï¼æ´æ°æ°æ®å¹¶æ è®°ç¼è¾ç¶æï¼\n   */\n  public edit(id?: string): Observable<Entity> {\n    const update$ = this.update();\n    return update$.pipe(\n      tap(() => {\n        const currentId = this.bindingData.list.currentId\n        EditStateUtil.setEditState(this.frameContext, currentId);\n      })\n    );\n  }\n\n  /**\n   * æ´æ°\n   * @param id ä¸»å®ä½id\n   * @param enableChildrenPagination å¯ç¨å­è¡¨åé¡µ\n   */\n  public update(id?: string): Observable<Entity> {\n    // è·åid\n    id = this.bindingData.list.currentId as string;\n    if (!id) {\n      return empty();\n    }\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const update$ = this.repository.updateById(id);\n    this.frameContext.appContext.params.set(\"retrieveing\", true);\n    return update$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.updateFailed, error);\n        }\n      )\n    );\n  }\n  public updateWithoutEmpty() {\n    // è·åid\n    const id = this.bindingData.list.currentId as string;\n    if (!id) {\n      return of(null);\n    } else {\n      return this.update();\n    }\n  }\n  /**\n   * æ ¡éªå½åè¡æ¯å¦å­å¨\n   * @returns \n   */\n  public checkBeforeUpdate(): Observable<boolean> {\n    const bindingList = this.frameContext.bindingData.list;\n    const id = bindingList && bindingList.currentId;\n    if (!id) {\n      this.formNotifyService.warning(this.languageService.noDataExist, { hideTitle: true });\n      return EMPTY;\n    }\n    return of(true);\n  }\n  /**\n   * å·²åºå¼\n   * @returns \n   */\n  public updateWithNotify() {\n    // è·åid\n    const id = this.bindingData.list.currentId as string;\n    if (!id) {\n      this.formNotifyService.warning(this.languageService.noDataExist, { hideTitle: true });\n      return EMPTY;\n    } else {\n      return this.update();\n    }\n  }\n  /**\n   * å è½½å¡çæ°æ®ï¼åé¡µå è½½å­è¡¨æ°æ®ï¼\n   * @deprecated æ¹æ³å·²åºå¼ï¼è¯·å¿ä½¿ç¨\n   */\n  public loadPaged(filter?: string, sort?: string) {\n    // è·åid\n    const id = this.bindingData.list.currentId as string;\n    if (!id) {\n      return EMPTY;\n    }\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    // this.frameContext.root.params.set('updateWithPaging', true);\n    const update$ = of(null);//this.repository.updateEntityById(id, true);\n    return update$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.updateFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * ä¿å­\n   */\n  public save(successMsg?: string): Observable<boolean> {\n    // è·åå½åè¡\n    const id = this.bindingData.list.currentId as string;\n    if (!id) {\n      return of(false);\n    }\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const update$ = this.repository.updateChangesById(id);\n    const save$ = this.repository.applyChangesById(id);\n    const result$ = update$.pipe(\n\n      // update$ => save$\n      switchMap((updateResult: boolean) => {\n        if (updateResult === false) {\n          return of(false);\n        } else {\n          return save$;\n        }\n      }),\n\n      // éèloading\n      tap(() => {\n\n        // åæ¶æ°å¢ç¶æ\n        EditStateUtil.setEditState(this.frameContext, id);\n        this.loadingService.hideDelayLoading(loadingTimerId);\n        // this.formNotifyService.info(this.languageService.saveSuccess);\n        if (successMsg && successMsg.trim()) {\n          let showMessage: boolean = true;\n          if (successMsg.startsWith('{') && successMsg.endsWith('}')) {\n            try {\n              const options = JSON.parse(successMsg);\n              if (options && options.showMessage === false) {\n                showMessage = false;\n              }\n            } catch { }\n          }\n          if (showMessage !== false) {\n            this.formNotifyService.success(successMsg, { hideTitle: true });\n          }\n        } else {\n          FormNotifyStrategyService.success(this.formNotifyService, this.languageService.saveSuccess);\n        }\n        // FormNotifyStrategyService.success(this.formNotifyService, this.languageService.saveSuccess);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.saveFailed, error);\n        }\n      )\n    );\n\n    return result$;\n  }\n\n\n  // #region åæ¶ç¸å³æ¹æ³\n\n  /**\n   * åæ¶ï¼é»è®¤åæ¶ï¼\n   */\n  public cancel(): Observable<any> {\n    return this.cancelWithCheck();\n  }\n\n  /**\n   * è¿ååæ´é\n   * @description ä¸å¸¦åæ´æ£æµæç¤º\n   */\n  public revert(options?: any): Observable<any> {\n    return this.cancelWithoutCheck(options);\n  }\n\n  /**\n   * åæ¶ï¼åæ¶åæ£æ¥æªä¿å­çåæ´ï¼\n   * @summary\n   * 1ãç¨æ·è¯¯æä½ï¼åªéè¦åä¸ªæç¤ºå°±å¯ä»¥äºï¼\n   * 2ãç¨æ·ææåæ¶ï¼ç¹å»åæ¶å°±æ¯è¦æ¾å¼ææåæ´ï¼è¿æ¶åè¯¢é®äººå®¶æ¯å¦è¦ä¿å­æèæç¤ºå­å¨åæ´æç¹å¤æ­¤ä¸ä¸¾ï¼ç¡®è®¤ä¸æå³å¯ã\n   * 3ãç¨æ·è¯¯æä½ï¼æ²¡æåæ´çæåµä¸ç´æ¥ç»åæ¶äºï¼ç¨æ·ä¼äº§çææï¼å ä¸ºç¨æ·ææ¶åå¹¶ä¸ç¡®å®æ¯å¦æåæ´ï¼åºè¯¥ä¹ç¡®è®¤ä¸æã\n   * @todo\n   * 1ãç±äºäº§åé¨å¾å¤ä»£ç è¯¯ç¨äºè¯¥æ¹æ³ï¼ä¾èµäºæ²¡æåæ´çæ¶åç´æ¥åæ¶ï¼ç°å¨å¼¹çªç¡®è®¤æ¡æ¥ï¼ä¸å¤ªåéï¼\n   * 2ãäº§åé¨éè¦ç¨cancelWithoutCheckæ¹æ³ä»£æ¿ï¼ç®ååç»å¼å®¹çï¼å¾å é¤ã\n   */\n  public cancelWithCheck() {\n\n    // @todel\n    const hasUnSavedChanges = BefRepositoryUtil.isExistUnsaveData(this.repository);\n    if (!hasUnSavedChanges) {\n      return this.cancelChanges();\n    }\n\n    // ç¡®è®¤æ¯å¦åæ¶\n    const confirm$ = this.formMessageService.question(this.languageService['cancelWithoutSave']);\n    const result$ = confirm$.pipe(\n      switchMap((ifCancel: boolean) => {\n        if (ifCancel === false) {\n          return EMPTY;\n        }\n        return this.cancelChanges();\n      })\n    );\n\n    return result$;\n  }\n\n  /**\n   * åæ¶ï¼ç´æ¥åæ¶ï¼ä¸æ§è¡æ£æ¥ï¼\n   */\n  public cancelWithoutCheck(options?: any) {\n    return this.cancelChanges(options);\n  }\n\n  /**\n   * åæ¶\n   */\n  private cancelChanges(options?: any): Observable<any> {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const cancel$ = this.repository.cancelChanges(options);\n    return cancel$.pipe(\n      tap(\n        () => {\n          EditStateUtil.setEditState(this.frameContext, '');\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.cancelFailed, error);\n        }\n      )\n    );\n  }\n\n  // #endregion\n\n\n  /**\n   * éæ°å è½½ï¼ä»ä¾å¡çåæ¶åéæ°å è½½æ°æ®ï¼å¶ä»åºæ¯è¯·å¿ä½¿ç¨ï¼\n   */\n  public reload() {\n    const isAdd = EditStateUtil.getAddState(this.frameContext);\n    let id;\n    if (isAdd === true) {\n      id = EditStateUtil.getLastModifiedId(this.frameContext);\n    } else {\n      id = this.bindingData.list.currentId as string;\n    }\n\n    if (!id) {\n      this.repository.entityCollection.loadEntities([]);\n      return;\n    }\n\n    return this.load(id);\n  }\n  private getPath(viewModel: ViewModel, bindingPath: string, rid: string): string {\n    let path = '/' + rid;\n\n    const subPaths = bindingPath.split('/');\n    if (subPaths.length > 0) {\n      // eg:bindingPathå½¢å¦/edus/grades,splitåæ¯['', 'edus', 'grades']\n      // å æ­¤indexä»1å¼å§\n      for (let index = 1; index < subPaths.length - 1; index++) {\n        const subPath = subPaths[index];\n        const subData = viewModel.bindingData[subPath];\n        if (!subData || !subData.currentId) {\n          throw Error(`è·åå­è¡¨å®æ´è·¯å¾åºéï¼æ¾ä¸å°${subData}å¯¹åºçå­è¡¨ï¼æå¯¹åºå­è¡¨æ²¡æå½åè¡ã`);\n        }\n        path += `/${subPath}/${subData.currentId}`;\n      }\n    }\n    path += '/' + subPaths[subPaths.length - 1];\n\n    return path;\n  }\n  private resetForm(action: string) {\n    const validationService = this.frameContext.injector.get<ValidationService>(ValidationService, null);\n    return this.frameContext.repository.cancelChanges().pipe(\n      switchMap(() => this.commandService.execute(action).pipe(switchMap(() => {\n        return validationService && validationService.resetValidation() || of(null);\n      }))));\n  }\n  private parseParams(options: any): { action: string, id: string, sync: boolean } | null {\n    if (options && Object.prototype.toString.call(options) === DataType.map) {\n      let params = options.get(WEB_FORM_ROUTE_PARAMS_KEY);\n      if (params && typeof params === 'string') {\n        params = decodeURIComponent(params);\n        if (params.startsWith('{') && params.endsWith('}')) {\n          params = JSON.parse(params);\n        }\n        return {\n          action: params.action,\n          id: params.idToView || params.idToEdit || params.id,\n          sync: params.sync || false\n        };\n      }\n    }\n    return null;\n  }\n  private showLoadingConfirm(message: string) {\n    return this.formMessageService.confirm(message).pipe(\n      switchMap((result: boolean) => {\n        if (result === true) {\n          return of(true);\n        } else {\n          return EMPTY;\n        }\n      })\n    );\n  }\n}\nexport { CardDataService };\n","import { Injectable, Optional } from '@angular/core';\nimport { of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { BefRepository, BefRepositoryUtil } from '@farris/bef';\nimport { TAB_EVENT } from './types';\nimport { NavigationService } from './navigation.service';\nimport { FrameContext, Repository, UID } from '@farris/devkit';\nimport { FormMessageService } from './form-message.service';\nimport { LanguageService } from './languag.service';\nimport { CardDataService } from './data-services/card-data.service';\n/**\n * å¯¼èªä¸­é´ä»¶æå¡\n * @scope FrameComponent\n */\n// tslint:disable: no-string-literal\n@Injectable()\nexport class NavigationMiddlewareService {\n  private repository: Repository<any>;\n\n  private appContext: any;\n  constructor(\n    private navigationService: NavigationService,\n    private frameContext: FrameContext,\n    private msgService: FormMessageService,\n    @Optional() private languageService: LanguageService,\n    private cardDataService: CardDataService\n  ) {\n    this.repository = frameContext.repository;\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n    if (this.frameContext) {\n      this.appContext = this.frameContext.getFormAppContext() || null;\n    }\n  }\n  /**\n   * å³é­åå¤ç\n   */\n  public onClosing() {\n    if (this.isInDialog()) {\n      return;\n    }\n    this.navigationService.addEventListener(TAB_EVENT.onTabClosing, (options) => {\n      if (this.isChanged && !this.appContext.opened) {\n        // å¦æéè¦ç¨æ·ç¡®è®¤å°±åæ¢å°å½åtab\n        if (options && options.beforeCloseHandle && typeof options.beforeCloseHandle === 'function') {\n          options.beforeCloseHandle({ selectedChange: true });\n        }\n        const conform = this.msgService.question(this.languageService['exitWithoutSave']);\n        /*è®°å½å¼¹çªå·²æå¼*/\n        this.appContext.opened = true;\n        return conform.pipe(\n          switchMap((result: boolean) => {\n            this.appContext.opened = false;\n            if (result) {\n              /*è®°å½ç¨æ·å³é­å¼¹çª*/\n              if (!!this.cardDataService) {\n                const revert$ = this.cardDataService.revert(options);\n                return revert$.pipe(\n                  switchMap(() => of(result))\n                );\n              }\n            }\n            return of(result);\n          })\n        );\n      } else if (this.isChanged && this.appContext.opened) {\n        return of(false);\n      } else {\n        return of(true);\n      }\n    });\n  }\n  /**\n   * æ¯å¦å¨æ¯å¼¹çªçªå£å\n   */\n  private isInDialog() {\n    let frameContext = this.frameContext;\n    let isDialogRootComponent = frameContext.frameComponent['isDialogRootComponent'] || false;\n    while (frameContext.parent !== null && !isDialogRootComponent) {\n      frameContext = frameContext.parent;\n      isDialogRootComponent = frameContext.frameComponent['isDialogRootComponent'];\n    }\n    return isDialogRootComponent;\n  }\n  /**\n   * è·åtabid,å¦ætargetIdå­å¨åç´æ¥ä½¿ç¨targetId\n   * @description å°ç¨æ·è¦æ¥ççæ°æ®idè½¬æ¢ä¸ºè¿è¡æ¡æ¶éè¦çtabId\n   * @param params routeråæ°\n   * @param targetId è¦ç¼è¾/æ¥ççæ°æ®id\n   */\n  public getTabId(params: string, targetId: string): any {\n    if (!!targetId) {\n      return targetId;\n    }\n    let paramsObj: any = null;\n    if (!!params && params.startsWith('{') && params.endsWith('}')) {\n      paramsObj = JSON.parse(params);\n    }\n    let paramId = null;\n    if (paramsObj && paramsObj.hasOwnProperty('id') && !!paramsObj.id) {\n      paramId = paramsObj.id;\n    } else {\n      paramId = UID.create();\n    }\n    return paramId;\n  }\n  /**\n   * æ¯å¦ææªä¿å­çåæ´\n   */\n  private get isChanged(): boolean {\n    const befRepository = this.repository as BefRepository<any>;\n    return BefRepositoryUtil.isExistUnsaveData(befRepository);\n  }\n}\n","/*\n * @Author: aalizzwell\n * @Date: 2019-08-05 11:48:27\n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-08-06 15:01:53\n */\n\nimport { Injectable, Optional } from '@angular/core';\nimport { EMPTY, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { FrameContext, Repository, ViewModel } from '@farris/devkit';\nimport { FormMessageService } from './form-message.service';\nimport { LanguageService } from './languag.service';\nimport { BefRepositoryUtil, BefRepository } from '@farris/bef';\nimport { CommandService } from './command-service';\n\n// tslint:disable: no-string-literal\n/**\n * Gridä¸­é´ä»¶æå¡\n * @scope FrameComponent\n */\n@Injectable()\nexport class GridMiddlewareService {\n  private repository: Repository<any>;\n\n  constructor(\n    private frameContext: FrameContext,\n    private msgService: FormMessageService,\n    @Optional() private languageService: LanguageService,\n    private viewModel: ViewModel,\n    private commandService: CommandService\n  ) {\n    this.repository = this.frameContext.repository;\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n  /**\n   * é¡µç åæ¢å\n   */\n  public onPageChanging() {\n    if (this.isChanged) {\n      return this.msgService.question(this.languageService['gridDataNotSave']).pipe(\n        switchMap((result: boolean) => {\n          if (!result) {\n            return EMPTY;\n          } else {\n            return of(true);\n          }\n        })\n      );\n    } else {\n      return of(true);\n    }\n  }\n  /**\n   * è¡¨æ ¼è¿æ»¤\n   * @param commandName å½ä»¤åç§°\n   * @param frameId frameId\n   * @returns \n   */\n  public filter(commandName: string, frameId: string) {\n    const self: any = this;\n    let filters = self.context && self.context.eventParam || [];\n    if (typeof (filters) === 'string') {\n      filters = JSON.parse(filters);\n    }\n    // æ¥è¯¢æ¶éç½®é¡µç ä¸ºç¬¬ä¸é¡µ\n    this.viewModel.frameContext.repository.entityCollection.pageIndex = 1;\n    this.viewModel.frameContext.repository.filterConditionManager.setConditions(this.viewModel.bindingPath, filters);\n    return this.commandService.execute(commandName, frameId);\n  }\n  /**\n   * æ¯å¦ææªä¿å­çåæ´\n   */\n  private get isChanged(): boolean {\n    const befRepository = this.repository as BefRepository<any>;\n    return BefRepositoryUtil.isExistUnsaveData(befRepository);\n  }\n}","import { Injectable } from '@angular/core';\nimport { QuerystringService } from './querystring';\nimport { RuntimeFrameworkService } from './rtf-service';\nimport { of, Observable, BehaviorSubject, Subject } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n// tslint:disable: no-string-literal\n/**\n * åæ°æå¡\n * @scope FormModule\n */\n@Injectable()\nexport class ParamService {\n  constructor(\n    private querystringService: QuerystringService,\n    private runtimeFrameworkService: RuntimeFrameworkService\n  ) { }\n  /**\n   * ééè·åææåæ°\n   */\n  public get params(): Observable<{ [propName: string]: any }> {\n    // åä»hashä¸­è·ååæ°\n    const hash = window.location.hash;\n    const params = this.querystringService.parse(hash);\n    /*\n    const appMode = params.appMode;\n    // appModeæ²¡æå®ä¹ï¼è®¤ä¸ºæ¯èè¡¨å,appMode = mdi æ spa\n    if (typeof appMode === 'undefined' || appMode === null) {\n        return of(params);\n    }\n    // appModeå­å¨ï¼ä½ä¸ºç©ºï¼ä¹è®¤ä¸ºæ¯èè¡¨å\n    if (appMode.length < 1) {\n        return of(params);\n    }\n    // æ°è¡¨åï¼ä½¿ç¨iframeæ¨¡å¼\n    if (appMode.toLowerCase() === 'mdi') {\n        return of(params);\n    }\n    */\n    // è·åtabIdï¼ææ°çæ¬ä¸å®ætabIdï¼å¦æåä¸å°tabIdåè®¤ä¸ºæ¯èè¡¨åï¼ç´æ¥ä»urlè·ååæ°\n    const tabId = params.tabId;\n    if (!tabId) {\n      // throw new Error('TabId can`t be empty!');\n      return of(params);\n    }\n    const subject = new Subject<any>();\n    // ç®¡éåæ°eå¯è½ä¸ºobjectãMapç±»å\n    this.runtimeFrameworkService.addEventListener(tabId, (e: any) => {\n      let map = {};\n      if (e instanceof Map || (e && typeof (e['get']) === 'function' && typeof e['entries'] === 'function')) {\n        map = this.parseMapParams(e);\n      }\n      let args = {};\n      if (e instanceof Map || (e && typeof (e['get']) === 'function' && typeof e['entries'] === 'function')) {\n        args = new Map(e);\n      } else {\n        args = Object.assign({}, e);\n      }\n      setTimeout(() => {\n        subject.next(Object.assign({}, args, map, params));\n      }, 0);\n    }, params);\n    return subject.asObservable();\n  }\n  /**\n   * è§£æmapç±»åçåæ°\n   * @param params params\n   */\n  private parseMapParams(params: Map<any, any>) {\n    const map = {};\n    map['WEB_FORM_ROUTE_PARAMS'] = decodeURIComponent(params.get('WEB_FORM_ROUTE_PARAMS'));\n    params.forEach((value, key) => {\n      if (key !== 'WEB_FORM_ROUTE_PARAMS') {\n        map[key] = value;\n      }\n    });\n    return map;\n  }\n  /**\n   * è·åparamåæ°\n   * @param param key\n   */\n  public get(param: string): Observable<any> {\n    return this.params.pipe(\n      switchMap(options => {\n        if (!!options && options.hasOwnProperty(param)) {\n          return of(options.param);\n        } else {\n          return of(undefined);\n        }\n      })\n    );\n  }\n  /**\n   * åæ°è½¬ä¸ºå¯¹è±¡\n   */\n  public parse(): Observable<any> {\n    return this.params.pipe(\n      switchMap(options => {\n        return of(options);\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Keybinding, ViewModel } from '@farris/devkit'\nimport * as Mousetrap from 'mousetrap';\nimport { Observable } from 'rxjs';\n\nconst enum CharCode {\n\n  Digit0 = 48,\n  Digit1 = 49,\n  Digit2 = 50,\n  Digit3 = 51,\n  Digit4 = 52,\n  Digit5 = 53,\n  Digit6 = 54,\n  Digit7 = 55,\n  Digit8 = 56,\n  Digit9 = 57,\n\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n\n  a = 97,\n  b = 98,\n  c = 99,\n  d = 100,\n  e = 101,\n  f = 102,\n  g = 103,\n  h = 104,\n  i = 105,\n  j = 106,\n  k = 107,\n  l = 108,\n  m = 109,\n  n = 110,\n  o = 111,\n  p = 112,\n  q = 113,\n  r = 114,\n  s = 115,\n  t = 116,\n  u = 117,\n  v = 118,\n  w = 119,\n  x = 120,\n  y = 121,\n  z = 122\n}\n\n/**\n * å¿«æ·é®æå¡\n * @scope FormModule\n */\n@Injectable()\nexport class KeybindingService {\n  private keyMap: Map<String, () => Observable<any>>;\n  private bindingProvider: Mousetrap;\n  private ready: boolean;\n\n  constructor() {\n    this.keyMap = new Map<String, () => Observable<any>>();\n    this.bindingProvider = Mousetrap.default;\n    this.ready = true;\n  }\n\n  /**\n   * å¯¹è§å¾æ¨¡åè®¾ç½®çå¿«æ·é®è¿è¡ç»å®å¤ç\n   * @param viewModel è§å¾æ¨¡å\n   */\n  public bind(viewModel: ViewModel) {\n    viewModel.keybindingMap.forEach((keyBinding, method) => {\n      this.register(keyBinding, () => {\n        return viewModel[method]();\n      });\n    });\n  }\n\n\t/**\n\t * æ³¨åå¿«æ·é®\n\t * @param binding é®çç»å®ä¿¡æ¯\n\t * @param handler ååºäºä»¶\n\t */\n  public register(binding: Keybinding, handler: () => Observable<any>) {\n    var combo = this._getCombo(binding);\n    if (combo) {\n      this.keyMap.set(combo, handler);\n      if (binding.ctrlKey && binding.altKey && !binding.shiftKey) {\n        // å®éåç°ï¼ctrl+altç»åï¼åªè½è§¦åkeyupäºä»¶\n        this.bindingProvider.bind(combo, this._dispatch.bind(this), 'keyup');\n      } else {\n        this.bindingProvider.bind(combo, this._dispatch.bind(this));\n      }\n    }\n  }\n\n  /**\n   * åæ¶å¿«æ·é®æ³¨å\n   * @param binding é®çç»å®ä¿¡æ¯ \n   */\n  public unregister(binding: Keybinding) {\n    var combo = this._getCombo(binding);\n    if (combo) {\n      this.keyMap.delete(combo);\n      this.bindingProvider.unbind(combo);\n    }\n  }\n\n  private _dispatch(e: KeyboardEvent): boolean {\n    if (e.repeat) return false;\n    if (this.ready) {\n      var combo = this._getCombo(e);\n      if (combo && this.keyMap.has(combo)) {\n        this.ready = false;\n        this.keyMap.get(combo)().subscribe(() => {\n          this.ready = true;\n        }, (error) => {\n          this.ready = true;\n        }, () => {\n          this.ready = true;\n        });\n      }\n    }\n    return false;\n  }\n\n\t/**\n\t * è¿åctrl+shift+alt+aå½¢å¼çç»åå­ç¬¦ä¸²ï¼å¨é¨ä¸ºå°å\n\t * @param keyInfo \n\t */\n  private _getCombo(keyInfo: Keybinding | KeyboardEvent): String | null {\n    var key = keyInfo.key.toLowerCase();\n    if (key.length != 1 || key.charCodeAt(0) < CharCode.a || key.charCodeAt(0) > CharCode.z) {\n      console.warn(\"å¿«æ·é®å­æ¯å½¢å¼ä¸ºa-z\");\n      return null;\n    }\n    var combo = (keyInfo.ctrlKey ? 'ctrl+' : '')\n      + (keyInfo.shiftKey ? 'shift+' : '')\n      + (keyInfo.altKey ? 'alt+' : '')\n      + (keyInfo.metaKey ? 'meta+' : '')\n      + key;\n\n    if (combo.length == 1) {\n      console.warn(\"å¿«æ·é®è³å°åå«ä¸ä¸ªModifieré®\");\n      return null;\n    }\n\n    return combo;\n  }\n}","// tslint:disable: max-line-length\nimport { Injectable } from '@angular/core';\n\n/**\n * @deprecated å·²åºé¤\n */\n@Injectable()\nclass FilterConditionService {\n}\nexport { FilterConditionService };\n","import { Injectable } from '@angular/core';\n\n/**\n * UIç¶ææå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass UIStateService {\n\n  constructor() {\n  }\n\n  getState(componentId: string, stateName: string) {\n    throw new Error('Not Implemented');\n  }\n\n  setState(componentId: string, stateName: string, value: any) {\n    throw new Error('Not Implemented');\n  }\n}\n\nexport { UIStateService };\n","import { Injectable, ElementRef } from '@angular/core';\nimport { StateMachine, FrameContext, AppContext } from '@farris/devkit';\n// tslint:disable: max-line-length\n/**\n * ç¶ææºæå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass StateMachineService {\n\n  constructor(\n    private stateMachine: StateMachine\n  ) {\n    if (this.stateMachine.initialState.name === 'init') {\n      window.setTimeout(() => {\n        this.initFormState();\n      }, 0);\n    }\n  }\n\n  private _clsDefaultName = 'f-form-state-default';\n  private _initLoad = true;\n  private _currentFrameContext: any\n\n  transit(action: string) {\n    if (action && typeof this.stateMachine[action] === 'function') {\n      this.stateMachine[action]();\n      this._currentFrameContext = this['context'] && this['context']['frameContext'];\n      if (this._initLoad) {\n        this.initFormState();\n        this._initLoad = false;\n      }\n      if (!this._currentFrameContext) {\n        return;\n      }\n      const currentRootFrameContext = this.getCurrentRootFrameContext(this._currentFrameContext);\n      if (!!currentRootFrameContext) {\n        this.toggleFormState(action, currentRootFrameContext);\n      }\n    }\n  }\n\n  private getCurrentRootFrameContext(currentFrameContext: FrameContext): FrameContext {\n    let currentRootFrameContext: FrameContext;\n    this.getAllRootFrameContext().forEach((rootFc: FrameContext) => {\n      if (currentFrameContext.namespace === rootFc.namespace) {\n        currentRootFrameContext = rootFc;\n      }\n    })\n    return currentRootFrameContext;\n  }\n\n  private getFrameContextManagerMap() {\n    if (this.stateMachine && this.stateMachine.frameContext) {\n      const appContext = this.stateMachine.frameContext.appContext as AppContext;\n      if (appContext) {\n        const frameContextManager = appContext.frameContextManager;\n        return frameContextManager.getFrameContextMap();\n      }\n    }\n    return null;\n    // return this.stateMachine && this.stateMachine.frameContext && this.stateMachine.frameContext.appContext && this.stateMachine.frameContext.appContext.frameContextManager && this.stateMachine.frameContext.appContext.frameContextManager.getFrameContextMap();\n  }\n\n  private getAllRootFrameContext(): any[] {\n    const rootFrameContextArr = [];\n    const frameContexts = this.getFrameContextManagerMap();\n    if (frameContexts) {\n      frameContexts.forEach(item => {\n        if ((item['namespace'] === '' && item['parent'] === null) || (item['parent'] !== null && item['namespace'] !== item['parent']['namespace'])) {\n          rootFrameContextArr.push(item);\n        }\n      })\n    }\n    return rootFrameContextArr;\n  }\n\n  private initFormState() {\n    if (!this.getFrameContextManagerMap()) {\n      return;\n    }\n    this.getAllRootFrameContext().forEach((rootFc: FrameContext) => {\n      const rootComponent = rootFc.injector.get<ElementRef>(ElementRef, null) || null;\n      if (!rootComponent || !rootComponent.nativeElement) {\n        return;\n      }\n      if (!rootComponent.nativeElement.className.includes(this._clsDefaultName) && !rootComponent.nativeElement.className.includes('f-form-state-create') && !rootComponent.nativeElement.className.includes('f-form-state-edit')) {\n        this.addCssClass(rootComponent, this._clsDefaultName);\n      }\n    })\n  }\n\n  private toggleFormState(action: string, frameContext: FrameContext) {\n    const rootComponent = frameContext.injector.get<ElementRef>(ElementRef, null) || null;\n    if (!rootComponent || !rootComponent.nativeElement || !action) {\n      return;\n    }\n    action = action.toLowerCase();\n    if (action && ['create', 'edit'].includes(action)) {\n      if (action === 'create') {\n        this.addCssClass(rootComponent, 'f-form-state-create');\n      } else if (action === 'edit') {\n        this.addCssClass(rootComponent, 'f-form-state-edit');\n      }\n      this.removeCssClass(rootComponent, this._clsDefaultName);\n    } else {\n      ['f-form-state-create', 'f-form-state-edit'].forEach(item => this.removeCssClass(rootComponent, item));\n      this.addCssClass(rootComponent, this._clsDefaultName);\n    }\n  }\n  private addCssClass(elementRef: ElementRef, className: string) {\n    if (!elementRef || !className || !elementRef.nativeElement) {\n      return;\n    }\n    const originalClassName: string = elementRef.nativeElement.className || '';\n    if (!originalClassName.includes(className)) {\n      elementRef.nativeElement.className = `${originalClassName} ${className}`;\n    }\n  }\n  private removeCssClass(elementRef: ElementRef, className: string) {\n    if (!elementRef || !className || !elementRef.nativeElement) {\n      return;\n    }\n    const originalClassName: string = elementRef.nativeElement.className || '';\n    if (originalClassName.includes(className)) {\n      elementRef.nativeElement.className = originalClassName.split(' ').filter(p => p && p !== className).join(' ');\n    }\n  }\n  private getFormRootComponent() {\n    if (this.stateMachine && this.stateMachine.frameContext) {\n      const viewContext = this.stateMachine.frameContext;\n      if (viewContext) {\n        const virtualRootContext = viewContext.getVirtualRootFrameContext();\n        if (virtualRootContext) {\n          const injector = virtualRootContext.injector;\n          if (typeof injector.get === 'function') {\n            return injector.get<ElementRef>(ElementRef, null);\n          }\n        }\n      }\n    }\n    return null;\n    // return this.stateMachine && this.stateMachine.frameContext && this.stateMachine.frameContext.getVirtualRootFrameContext() && this.stateMachine.frameContext.getVirtualRootFrameContext().injector && typeof this.stateMachine.frameContext.getVirtualRootFrameContext().injector.get === 'function' && this.stateMachine.frameContext.getVirtualRootFrameContext().injector.get<ElementRef>(ElementRef, null) || null;\n  }\n}\n\nexport { StateMachineService };\n","import { Injectable } from '@angular/core';\nimport { AppContext, BindingData, FrameContext } from '@farris/devkit';\n\n/**\n * å®ä½æå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass BindingDataService {\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private bindingData: BindingData,\n    private appContext: AppContext\n  ) { }\n\n  /**\n   * è®¾ç½®å½åæ¡æ¶çå½åè¡\n   */\n  setCurrentId(id: string, frameId: string) {\n    // let bindingData = this.bindingData;\n    // if (frameId) {\n    //   const targetContext = this.appContext.getFrameContext(frameId);\n    //   bindingData = targetContext.bindingData;\n    // }\n    // bindingData.list.setCurrentId(id);\n\n    // @todoï¼å¨é¨éæ°è®¾ç½®ä¸é\n    const frameContexts = Array.from(this.appContext.getAllFrameContexts().values());\n    frameContexts.forEach((frameContext: FrameContext) => {\n      const bindingData = frameContext.bindingData;\n      bindingData.list.setCurrentId(id, true, false);\n    });\n  }\n  public setCurrentRow(id: string, frameId: string) {\n    let bindingData = this.bindingData;\n    if (frameId) {\n      const targetContext = this.appContext.getFrameContext(frameId);\n      bindingData = targetContext.bindingData;\n    }\n    bindingData.getList().setCurrentId(id);\n  }\n}\n\nexport { BindingDataService };\n","import { ActivatedRoute, ParamMap } from '@angular/router';\nimport { take } from 'rxjs/operators';\nimport { FrameworkService } from '@gsp-sys/rtf-common';\nimport { ViewModel } from '@farris/devkit';\nimport { Injectable, Optional } from '@angular/core';\nimport { ParamService } from './param.service';\nimport { RuntimeFrameworkService } from './rtf-service';\nimport { BefRepository } from '@farris/bef';\nimport { isObservable } from 'rxjs';\n\n/**\n * åºç¨åæ°æå¡\n * @scope FormModule\n */\n\n@Injectable()\nexport class ApplicationParamService {\n  private params: any;\n  constructor(\n    @Optional() private paramService: ParamService,\n    @Optional() private runtimeFrameworkService: RuntimeFrameworkService,\n  ) {\n    if (!this.runtimeFrameworkService) {\n      this.runtimeFrameworkService = new RuntimeFrameworkService();\n    }\n  }\n  /**\n   * è§£æåæ°\n   */\n  public parseParams(route: ActivatedRoute, frameworkService: FrameworkService, viewModel: ViewModel, callback: () => void) {\n    const highOrderInvoke = this.highOrderInvoke(callback);\n    if (!this.paramService) {\n      route.queryParams.pipe(take(1)).subscribe((params: any) => {\n        this.params = params;\n        this.setupParams(params, frameworkService, viewModel, highOrderInvoke);\n      });\n    } else {\n      this.paramService.parse().pipe(take(1)).subscribe(params => {\n        this.params = params;\n        this.setupParams(params, frameworkService, viewModel, highOrderInvoke);\n      });\n    }\n  }\n\n  /**\n   * è®¾ç½®åæ°\n   */\n  private setupParams(params, frameworkService: FrameworkService, viewModel: ViewModel, callback: () => void) {\n    const queryParams = this.getParams(params);\n    if (!queryParams) {\n      callback();\n      return;\n    }\n\n    // åè®¾ç½®åæ°ï¼ä¿è¯æ®éè·¯ç±ä¹è½æ­£å¸¸æ§è¡ã\n    this.setQueryParams(queryParams, viewModel);\n\n    const funcId = this.getFuncId(queryParams);\n    const appId = this.getAppId(queryParams);\n    if (!funcId && !appId) {\n      callback();\n      return;\n    }\n\n    if (funcId) {\n      this.setStaticParams(funcId, queryParams, frameworkService, viewModel, callback);\n    } else {\n      callback();\n    }\n  }\n  /**\n   * è®¾ç½®æ¥è¯¢åæ°\n   */\n  private setQueryParams(queryParams: any, viewModel: ViewModel): any {\n    const parsedQueryParams = {};\n    // è®¾ç½®è¡¨ååæ°\n    // é¦åå¤æ­æ¯å¦ä¸ºå¼¹çª\n    const isInDialog = this.isInDialog(viewModel);\n    const uiState = viewModel && viewModel.uiState && viewModel.uiState.innerData || {};\n    // å¦ææ¯å¼¹çªï¼å¼¹çªå¤çåæ°ï¼æ è®ºè¡¨ååæ°æéæåæ°ï¼ä¸åºè¯¥è¦çå¼¹çªçåæ°ãå¼¹çªæå¼æ¶ä¼ éçåæ°ç¸å½äºå±é¨åéï¼ä¸åºè¢«è¦ç\n    Object.keys(queryParams).forEach((paramName: string) => {\n      if (!isInDialog) {\n        parsedQueryParams[paramName] = queryParams[paramName];\n      } else {\n        if (!uiState.hasOwnProperty(paramName)) {\n          parsedQueryParams[paramName] = queryParams[paramName];\n        }\n      }\n    });\n    this.updateUIState(viewModel, parsedQueryParams);\n  }\n\n  /**\n   * è®¾ç½®éæåæ°\n   */\n  private setStaticParams(\n    funcId: string, queryParams: any, frameworkService: FrameworkService, viewModel: ViewModel, callback: () => void\n  ) {\n    this.runtimeFrameworkService.getMenuParams(funcId, (staicParams) => {\n      const staticParamsObj = this.mapStaticParamsToObject(staicParams, queryParams, viewModel);\n      if (!staticParamsObj) {\n        callback();\n        return;\n      }\n      this.updateUIState(viewModel, staticParamsObj);\n      callback();\n    });\n  }\n\n  /**\n   * å°staticParamsè½¬æ¢ä¸ºæ®éå¯¹è±¡\n   * @param staticParamsï¼å½¢å¦ï¼[{'name': 'key1', 'value': 'val1'}, {'name': 'key2', 'value': 'val2'}]\n   * @return å½¢å¦ï¼{key1: val1, key2: value2 }\n   */\n  private mapStaticParamsToObject(staticParams: Map<any, any>, queryParams: any, viewModel?: ViewModel): any {\n    if (!staticParams) {\n      return;\n    }\n    const inDialog = this.isInDialog(viewModel);\n    const uiState = viewModel && viewModel.uiState && viewModel.uiState.innerData || {};\n    const result = {};\n    staticParams.forEach((value, key, map) => {\n      if (!inDialog) {\n        // éæåæ°ä¸è½è¦çæ¥è¯¢åæ°\n        if (!queryParams.hasOwnProperty(key)) {\n          result[key] = value;\n        }\n      } else {\n        if (!queryParams.hasOwnProperty(key) && !uiState.hasOwnProperty(key)) {\n          result[key] = value;\n        }\n      }\n    });\n    return result;\n  }\n  /**\n   * æ¯å¦å¨å¼¹çªå\n   * @param viewModel viewmodel\n   */\n  private isInDialog(viewModel: ViewModel) {\n    let isInDialog = false;\n    if (viewModel && viewModel.uiState) {\n      // tslint:disable-next-line: max-line-length\n      if (viewModel.uiState.innerData && viewModel.uiState.innerData.hasOwnProperty('DEVKIT_DIALOG') || viewModel.uiState['DEVKIT_DIALOG']) {\n        isInDialog = true;\n      }\n    }\n    return isInDialog;\n  }\n  /**\n   * æ´æ°UIState\n   */\n  private updateUIState(viewModel: ViewModel, params: any) {\n    if (!viewModel || !params) {\n      return;\n    }\n    const uiState = viewModel.uiState;\n\n    // å¼å®¹ä½¿ç¨stringä¼ éparamså¯¹è±¡çåºæ¯\n    if (typeof params === 'string' && params !== '') {\n      params = JSON.parse(params);\n    }\n\n    // å¨UIStateä¸ºåæ°åå»ºå±æ§\n    Object.keys(params).forEach((propName: string) => {\n      uiState.setPropertyValue(propName, params[propName]);\n      if (propName && propName === 'union_session') {\n        let sessionInfo = params[propName];\n        this.setSessionInfo(viewModel, sessionInfo);\n      }\n    });\n  }\n  private setSessionInfo(viewModel: ViewModel, sessionInfo: any) {\n    if (!viewModel || !sessionInfo) {\n      return;\n    }\n    if (sessionInfo && typeof sessionInfo === 'string' && sessionInfo.startsWith('{') && sessionInfo.endsWith('}')) {\n      sessionInfo = JSON.parse(sessionInfo);\n    }\n    const token = sessionInfo && sessionInfo.token || null;\n    const sessionId = sessionInfo && sessionInfo.sessionId || null;\n    if (token) {\n      viewModel.frameContext.appContext.Token = token;\n    }\n    if (sessionId) {\n      const befRepository = viewModel.frameContext.repository as BefRepository<any>;\n      if (befRepository) {\n        befRepository.restService.sessionService.setBeSessionId(sessionId);\n      }\n    }\n  }\n  /**\n   * è·ååè½èåid\n   */\n  private getFuncId(queryParams: any): any {\n    if (!queryParams) {\n      return;\n    }\n    return queryParams['funcId'];\n  }\n\n  /**\n   * è·ååºç¨id\n   */\n  private getAppId(queryParams: any): any {\n    if (!queryParams) {\n      return;\n    }\n    return queryParams['appId'];\n  }\n  private getTabId(queryParams: any) {\n    if (!queryParams) {\n      return;\n    }\n    return queryParams['tabId'];\n  }\n  /**\n   * è·åurlåæ°å¯¹è±¡\n   * @param queryParams urlåæ°\n   */\n  private getParams(queryParams: any): { [propName: string]: any } {\n    if (!queryParams) {\n      return {};\n    }\n    let result = {};\n    if (queryParams.hasOwnProperty('WEB_FORM_ROUTE_PARAMS')) {\n      let webFormRouteParams: string = queryParams['WEB_FORM_ROUTE_PARAMS'];\n      if (webFormRouteParams && webFormRouteParams.startsWith('{') && webFormRouteParams.endsWith('}')) {\n        webFormRouteParams = decodeURI(encodeURI(webFormRouteParams).replace(/%0A/g, '\\\\n').replace(/%09/g, '\\\\t').replace(/%0D/g, '\\\\r'));\n        result = JSON.parse(webFormRouteParams);\n      }\n      Object.keys(queryParams).forEach(prop => {\n        if (prop !== 'WEB_FORM_ROUTE_PARAMS') {\n          result[prop] = queryParams[prop];\n        }\n      });\n      return result;\n    }\n    return queryParams;\n  }\n  private highOrderInvoke(callback) {\n    return () => {\n      try {\n        const queryParams = this.getParams(this.params);\n        const tabId = this.getTabId(queryParams);\n        if (tabId) {\n          const controlEvent = this.runtimeFrameworkService.getMenuSwitchControlEvent();\n          if (controlEvent && isObservable(controlEvent)) {\n            controlEvent.subscribe((event: any) => {\n              if (event) {\n                event.next('ok');\n              }\n            });\n          }\n        }\n      } catch (e) { console.warn(e); }\n      if (callback && typeof callback === 'function') {\n        callback();\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { FrameContext, BindingData, BindingList, BindingObject } from '@farris/devkit';\n\n/**\n * å®ä½éåæå¡\n * @todo\n * å®ä½å±æ²¡æå°è£ç¸å³æ¹æ³ï¼ä¸´æ¶éè¿BindingDataæ¥è·åæ°æ®\n */\n@Injectable()\nclass EntityTraversingService {\n\n  private get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  constructor(private frameContext: FrameContext) {\n  }\n\n  /**\n   * è·åå¼\n   */\n  public getPropValue(path: string[]): any {\n    return this.bindingData.getValue(path);\n  }\n\n  /**\n   * è·åå®ä½æ°æ®\n   */\n  public getEntityData(path: string[]): any {\n    let bindingObj: BindingObject;\n    const bindingListOrObject = this.bindingData.getValue(path);\n    if (bindingListOrObject instanceof BindingList === true) {\n      bindingObj = bindingListOrObject.currentItem;\n    } else {\n      bindingObj = bindingListOrObject;\n    }\n    return bindingObj.toJSON();\n  }\n\n  /**\n   * è·åå®ä½åè¡¨æ°æ®\n   */\n  public getEntityListData(path: string[]): any[] {\n    const bindingList = this.bindingData.getValue(path) as BindingList;\n    return bindingList.toJSON();\n  }\n\n}\n\nexport { EntityTraversingService };\n","import { Injectable } from '@angular/core';\nimport { FrameContext, BindingData } from '@farris/devkit';\n\n@Injectable()\nclass EntityManipulationService {\n\n  private get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  constructor(private frameContext: FrameContext) {\n  }\n\n  /**\n   * è®¾ç½®pathå¯¹åºçå­æ®µå¼\n   */\n  public setPropValue(path: string[], value: any): any {\n\n    // å®ä½å±è¿æ²¡æå°è£ï¼ä¸´æ¶ç¨BindingDataç¸å³æ¹æ³ä»£æ¿\n    this.bindingData.setValue(path, value, true, true);\n  }\n\n}\n\nexport { EntityManipulationService };\n","import { Injectable } from '@angular/core';\nimport { FrameContext, BindingData, BindingList, BindingObject } from '@farris/devkit';\nimport { EntityTraversingService } from './entity-traversing.service';\n\ninterface SplitedPath {\n  listPath: string[];\n  propPath: string[];\n}\n\n/**\n * å®ä½èåæå¡\n */\n@Injectable()\nclass EntityAggregationService {\n\n  private get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  private traversingService: EntityTraversingService;\n\n  constructor(private frameContext: FrameContext) {\n    this.traversingService   = this.frameContext.injector.get<EntityTraversingService>(EntityTraversingService);\n  }\n\n  /**\n   * è·åpathå¯¹åºåè¡¨è®°å½çæ¡æ°\n   */\n  public count(path: string[]): number {\n    const splitedPath = this.splitPath(path);\n    const entityListData = this.traversingService.getEntityListData(splitedPath.listPath);\n    return entityListData.length;\n  }\n\n  /**\n   * è·åpathå¯¹åºå­æ®µçå\n   */\n  public sum(path: string[]) {\n    const splitedPath = this.splitPath(path);\n    const entityListData = this.traversingService.getEntityListData(splitedPath.listPath);\n\n    const total = entityListData.reduce((accTotal: number, entityData: any) => {\n      let propValue = parseFloat(this.getPropValue(entityData, splitedPath.propPath));\n      propValue = isNaN(propValue) ? 0 : propValue;\n      accTotal += propValue;\n      return accTotal;\n    }, 0);\n    return total;\n  }\n\n  /**\n   * è·åpathå¯¹åºå­æ®µçå¹³åå¼\n   */\n  public avg(path: string[]) {\n    const count = this.count(path);\n    const total = this.sum(path);\n    return count !== 0 ? total / count : 0;\n  }\n\n  /**\n   * è·åpathå¯¹åºå­æ®µçæå¤§å¼\n   */\n  public max(path: string[]): number {\n    const splitedPath = this.splitPath(path);\n    const entityListData = this.traversingService.getEntityListData(splitedPath.listPath);\n\n    const max =  entityListData.reduce((accMax: number, entityData: any) => {\n      const propValue = parseFloat(this.getPropValue(entityData, splitedPath.propPath));\n      if (isNaN(propValue) === false && ( !accMax || propValue > accMax)) {\n        accMax = propValue;\n      }\n      return accMax;\n    }, null);\n    return max ? max : 0;\n  }\n\n  /**\n   * è·åpathå¯¹åºå­æ®µçæå°å¼\n   */\n  public min(path: string[]): number {\n    const splitedPath = this.splitPath(path);\n    const entityListData = this.traversingService.getEntityListData(splitedPath.listPath);\n\n    const min = entityListData.reduce((accMin: number, entityData: any) => {\n      const propValue = parseFloat(this.getPropValue(entityData, splitedPath.propPath));\n      if (isNaN(propValue) === false && ( !accMin || propValue < accMin)) {\n        accMin = propValue;\n      }\n      return accMin;\n    }, null);\n    return min ? min : 0;\n  }\n\n  /**\n   * è·åå±æ§å¼\n   */\n  private getPropValue(entityData: any, path: string[]) {\n    let currentData = entityData;\n    path.forEach((pathItem: string) => {\n\n      // æåéåºçé½éç½®ä¸ºnullï¼ä¸»è¦éå¯¹å³èå¯¹è±¡æªèµå¼åºæ¯\n      if (!currentData) {\n        currentData = null;\n        return;\n      }\n      currentData = currentData[pathItem];\n    });\n\n    return currentData;\n  }\n\n  /**\n   * åéè·¯å¾ï¼åéç¬¦åè¡¨è·¯å¾åå±æ§è·¯å¾\n   * @return å½¢å¦ {parentListPath: [], propertyPath: []}\n   */\n  private splitPath(path: string[]): SplitedPath {\n    const listPath = path.concat([]);\n    const propPath = [];\n    let currentNode = this.bindingData.getValue(listPath);\n    while (currentNode instanceof BindingList !== true) {\n      const propPathItem = listPath.pop();\n      if (!propPathItem) {\n        return;\n      }\n      propPath.unshift(propPathItem);\n      currentNode = this.bindingData.getValue(listPath);\n    }\n\n    return {\n      listPath: listPath,\n      propPath: propPath\n    };\n  }\n\n}\n\nexport { EntityAggregationService };\n","/*\n * @Author: aalizzwell \n * @Date: 2019-05-29 19:07:30 \n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-05-29 19:31:19\n */\nimport { Injectable } from '@angular/core';\nimport { BindingData } from '@farris/devkit';\n\n/**\n * EntityListæå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass EntityListService {\n\n  constructor(private bindingData: BindingData) {}\n\n    /**\n     * è·åå½åé¡µç \n     */\n    public get pageIndex() {\n        return this.bindingData.list.pageIndex;\n    }\n\n    /**\n     * è·åå½ååé¡µå¤§å°\n     */\n    public get pageSize() {\n        return this.bindingData.list.pageSize;\n    }\n}\n\nexport { EntityListService };\n","import { Injectable } from '@angular/core';\nimport { FrameContext } from '@farris/devkit';\nimport { EntityTraversingService } from './entity-traversing.service';\nimport { EntityManipulationService } from './entity-manipulation.service';\nimport { EntityAggregationService} from './entity-aggregation.service';\n\n/**\n * å®ä½æå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass EntityService {\n\n  private traversingService: EntityTraversingService;\n\n  private manipulationService: EntityManipulationService;\n\n  private aggregationService: EntityAggregationService;\n\n  constructor(private frameContext: FrameContext) {\n    const injector = this.frameContext.injector;\n    this.traversingService   = injector.get<EntityTraversingService>(EntityTraversingService);\n    this.manipulationService = injector.get<EntityManipulationService>(EntityManipulationService);\n    this.aggregationService  = injector.get<EntityAggregationService>(EntityAggregationService);\n  }\n\n  /**\n   * è·åpathå¯¹åºçå±æ§å¼\n   */\n  public getPropValue(path: string[]): any {\n    return this.traversingService.getPropValue(path);\n  }\n\n  /**\n   * è®¾ç½®pathå¯¹åºçå±æ§å¼\n   */\n  public setPropValue(path: string[], value: any): void {\n    return this.manipulationService.setPropValue(path, value);\n  }\n\n  /**\n   * è®¾ç½®pathå¯¹åºçEntityæ°æ®\n   */\n  public getEntityData(path: string[]): any {\n    return this.traversingService.getEntityData(path);\n  }\n\n  /**\n   * è®¾ç½®pathå¯¹åºçEntityListæ°æ®\n   */\n  public getEntityListData(path: string[]): any {\n    return this.traversingService.getEntityListData(path);\n  }\n\n  /**\n   * è·åpathå¯¹åºEntityListè®°å½æ°\n   */\n  public count(path: string[]): number {\n    return this.aggregationService.count(path);\n  }\n\n  /**\n   * è·åpathå¯¹åºå±æ§çåè®¡å¼\n   */\n  public sum(path: string[]): number {\n    return this.aggregationService.sum(path);\n  }\n\n  /**\n   * è·åpathå¯¹åºå±æ§çå¹³åå¼\n   */\n  public avg(path: string[]): number {\n    return this.aggregationService.avg(path);\n  }\n\n  /**\n   * è·åpathå¯¹åºå±æ§çæå¤§å¼\n   */\n  public max(path: string[]): number {\n    return this.aggregationService.max(path);\n  }\n\n  /**\n   * è·åpathå¯¹åºå±æ§çæå°å¼\n   */\n  public min(path: string[]): number {\n    return this.aggregationService.min(path);\n  }\n}\n\nexport { EntityService };\n","import { Injectable, Injector } from \"@angular/core\";\nimport { AppContext, DataTypeInfo, Entity, FrameContext, Repository } from \"@farris/devkit\";\n\n@Injectable()\nexport class BindingPathService {\n  constructor(private injector: Injector, private appContext: AppContext, private repository: Repository<Entity>) { }\n  /**\n   * è·åç»ä»¶ä¸ä¸æçç»å®è·¯å¾\n   * @param frameContext ç»ä»¶ä¸ä¸æ\n   * @returns \n   */\n  public getBindingPathsByFrameContext(frameContext: FrameContext): string[] {\n    return frameContext && frameContext.viewModel && frameContext.viewModel.bindingPath && frameContext.viewModel.bindingPath.split('/').filter(p => p) || null;\n  }\n  /**\n   * éè¿BEè¡¨åè·åbindingPath\n   * @param dataTypeInfo \n   * @param tableName \n   * @param paths \n   * @param level\n   * @returns \n   */\n  public getBindingPathsByTableName(dataTypeInfo: DataTypeInfo, tableName: string, paths: string[] = [], level: number = 0): string[] {\n    level++;\n    if (dataTypeInfo.entityInfo && (dataTypeInfo.entityInfo.nodeCode === tableName || dataTypeInfo.entityInfo.originalCode === tableName)) {\n      if (level !== 1) {\n        paths.push(dataTypeInfo.entityInfo.nodeCode);\n      }\n      return paths;\n    }\n    const props = Array.from(dataTypeInfo.propInfoMap.values()).filter(p => p.typeInfo);\n    if (props.length < 1) {\n      paths = [];\n      return paths;\n    }\n    if (dataTypeInfo.entityInfo) {\n      if (level !== 1) {\n        paths.push(dataTypeInfo.entityInfo.nodeCode);\n      }\n    }\n\n    for (let idx = 0; idx < props.length; idx++) {\n      const dataTypeInfo = props[idx].typeInfo;\n      const path = this.getBindingPathsByTableName(dataTypeInfo, tableName, paths, level);\n      if (!path || path.length < 1) {\n        continue;\n      } else {\n        paths = paths.concat(path);\n        return paths;\n      }\n    }\n    return null;\n  }\n  /**\n   * è·åå±æ§è·¯å¾ä¸­çç»å®è·¯å¾\n   * @param paths paths\n   * @param entityTypeInfo \n   * @returns \n   */\n  public getBindingPathsByPath(paths: string[] | string, entityTypeInfo: DataTypeInfo): string[] {\n    let nodeCodes = [];\n    if (typeof paths === 'string') {\n      paths = paths.split('/').filter(p => p);\n    }\n    paths = paths.concat([]);\n    while (paths.length > 0) {\n      const dataPropInfo = entityTypeInfo.getPropInfoByPath(paths);\n      if (dataPropInfo.group === 'List') {\n        nodeCodes = paths;\n        break;\n      }\n      paths.pop();\n    }\n    return nodeCodes;\n  }\n  /**\n   * è·åå±æ§è·¯å¾ä¿¡æ¯\n   * @param path å±æ§è·¯å¾\n   * @returns \n   */\n  public getPathInfo(path: string): { bindingPath: string, propertyName: string, bindingPaths: string[], propertyNames: string[] } {\n    const paths = path.split('/').filter(p => p);\n    // è·åæå¤§å®ä½å±çº§ï¼å¶ä½ä¸ºå±æ§ï¼ç®åå±æ§ãudtãå³èãå³èåµå¥å³èï¼\n    const entityPath = this.getBindingPathsByPath(paths, this.repository.entityTypeInfo);\n    const propertyName = paths.slice(entityPath.length).join('/');\n    return { bindingPath: entityPath.join('/'), propertyName, bindingPaths: entityPath, propertyNames: propertyName.split('/').filter(p => p) };\n  }\n}","import { Injectable } from \"@angular/core\";\nimport { FrameContext, NgFormControl } from \"@farris/devkit\";\n\n@Injectable()\nexport class FormControlService {\n  constructor() { }\n  public getFormControlsByFrameContext(frameContext: FrameContext): { [propertyName: string]: NgFormControl } | null {\n    return frameContext && frameContext.form && frameContext.form.ngFormControls || null;\n  }\n  /**\n   * éè¿bindingåæ°æ®è·åNgFormControl\n   * @param frameContext \n   * @param binding binding\n   * @returns \n   */\n  public getFormControlByBinding(frameContext: FrameContext, binding: string): NgFormControl {\n    const ngFormControls = this.getFormControlsByFrameContext(frameContext);\n    if (!ngFormControls) {\n      return null;\n    }\n    return Object.values(ngFormControls).find((ngFormControl: NgFormControl) => ngFormControl && ngFormControl.binding === binding);\n\n  }\n  /**\n   * \n   * @param frameContext frameContext\n   * @param fullPath \n   * @returns \n   */\n  public getFormControlIndexByFullPath(frameContext: FrameContext, fullPath: string): number {\n    const ngFormControls = this.getFormControlsByFrameContext(frameContext);\n    if (!ngFormControls) {\n      return null;\n    }\n    const bindings = fullPath.split('/').filter(p => p);\n    return Object.values(ngFormControls).findIndex((ngFormControl: NgFormControl) => {\n      if (!ngFormControl) {\n        return false;\n      }\n      const bindingPath = frameContext.viewModel.bindingPath;\n      const bindingPaths = bindingPath.split('/').filter(p => p);\n      const formControlBindingPaths = ngFormControl.binding.split('.').filter(p => p);\n      const fullPath = bindingPaths.concat(formControlBindingPaths);\n      return fullPath.join('/') === bindings.join('/');\n    });\n  }\n  /**\n   * éè¿bindingåæ°æ®è·åNgFormControlä½ç½®\n   * @param frameContext \n   * @param binding binding\n   * @returns ä»0å¼å§\n   */\n  public getFormControlIndexByBinding(frameContext: FrameContext, binding: string): number {\n    const ngFormControls = this.getFormControlsByFrameContext(frameContext);\n    if (!ngFormControls) {\n      return null;\n    }\n    return Object.values(ngFormControls).findIndex((ngFormControl: NgFormControl) => ngFormControl && ngFormControl.binding === binding);\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { AppContext, DataPropInfo, Entity, FrameContext, Repository } from \"@farris/devkit\";\nimport { BindingPathService } from \"./binding-path.service\";\nimport { FormControlService } from './form-control.service';\n\n@Injectable()\nexport class FrameContextService {\n  constructor(\n    private injector: Injector, \n    private appContext: AppContext, \n    private frameContext: FrameContext, \n    private repository: Repository<Entity>,\n    private bindingPathService: BindingPathService,\n    private formControlService: FormControlService\n    ) { }\n  /**\n     * éè¿BEè¡¨åè·åå¯¹åºçframeContext\n     * @param tableName \n     * @returns \n     */\n  public getFrameContextsByTableName(tableName: string): null | FrameContext[] {\n    if (!tableName) {\n      throw new Error('tableName ä¸è½ä¸ºç©ºã');\n    }\n    const dataTypeInfo = this.repository && this.repository.entityTypeInfo || null;\n    if (!dataTypeInfo) {\n      return null;\n    }\n    const bindingPaths = [];\n    this.bindingPathService.getBindingPathsByTableName(dataTypeInfo, tableName, bindingPaths);\n    const frameContexts = this.appContext && this.appContext.frameContextManager.getFrameContexts() || [];\n    if (!frameContexts || frameContexts.length === 0) {\n      return null;\n    }\n    return frameContexts.filter((frameContext: FrameContext) => frameContext && frameContext.viewModel && frameContext.viewModel.bindingPath.split('/').filter(p => p).join('/') === bindingPaths.join('/'));\n  }\n  /**\n   * æ ¹æ®å­æ®µå®æ´è·¯å¾è·åæå¨çä¸ä¸æ\n   * @param propertyPath \n   * @param separtor \n   * @returns \n   */\n  public getFrameContextsByPropertyPath(propertyPath: string, separtor: string = '/'): FrameContext[] {\n    if (!propertyPath) {\n      throw new Error('propertyPath ä¸è½ä¸ºç©ºã');\n    }\n    const frameContexts = this.appContext && this.appContext.frameContextManager.getFrameContexts() || [];\n    return frameContexts.filter((frameContext: FrameContext) => {\n      const formControls = frameContext && frameContext.form && frameContext.form.ngFormControls || {};\n      const bindingPath = frameContext && frameContext.viewModel && frameContext.viewModel.bindingPath || '';\n      if (formControls && Object.keys(formControls).length > 0) {\n        const key = Object.keys(formControls).find((key: string) => {\n          const formControl = formControls[key];\n          if (!formControl || !formControl.binding) {\n            return false;\n          }\n          const bindings = formControl.binding.split('.').filter(p => p);\n          const bindingPaths = bindingPath.split('/').filter(p => p);\n          const fullPath = bindingPaths.concat(bindings);\n          return propertyPath.split(separtor).filter(p => p).join('/') === fullPath.join('/');\n        });\n        return key ? true : false;\n      }\n      return false;\n    });\n  }\n  /**\n   * éè¿BEå­æ®µåè·åå­æ®µçbindingPath\n   * @param bindingPaths ç»å®è·¯å¾\n   * @param columnName BEå­æ®µå\n   * @returns \n   */\n  public getFrameContextsByColumnName(bindingPaths: string[], columnName: string): FrameContext[] | null {\n    if (!bindingPaths) {\n      throw new Error('bindingPath ä¸è½ä¸ºç©ºã');\n    }\n    if (!columnName) {\n      throw new Error('columnName ä¸è½ä¸ºç©ºã');\n    }\n    bindingPaths = bindingPaths.filter(p => p);\n    const entityTypeInfo = this.repository && this.repository.entityTypeInfo || null;\n    if (!entityTypeInfo) {\n      return null;\n    }\n    const dataTypeInfo = entityTypeInfo.getTypeInfoByPath(bindingPaths);\n    const dataPropInfos = dataTypeInfo && dataTypeInfo.getPropInfos() || [];\n    const columnPropInfo = dataPropInfos.find((dataPropInfo: DataPropInfo) => dataPropInfo.metadataInfo && (dataPropInfo.metadataInfo.originalDataField === columnName || dataPropInfo.metadataInfo.dataField === columnName));\n    if (!columnPropInfo || !columnPropInfo.metadataInfo) {\n      return null;\n    }\n    const frameContexts = this.appContext.frameContextManager.getFrameContexts();\n    return frameContexts.filter((frameContext: FrameContext) => {\n      const ngFormControls = this.formControlService.getFormControlsByFrameContext(frameContext);\n      if (!ngFormControls || Object.keys(ngFormControls).length < 1) {\n        return false;\n      }\n      const currentBindingPaths = this.bindingPathService.getBindingPathsByFrameContext(frameContext) || [];\n      const isValidFrameContext = currentBindingPaths.join('/') === bindingPaths.join('/');\n      if (!isValidFrameContext) {\n        return false;\n      }\n      const ngFormControl = Object.values(frameContext.viewModel.form.ngFormControls).find(item => item.binding === columnPropInfo.metadataInfo.path);\n      return ngFormControl ? true : false;\n    });\n  }\n  \n  /**\n   * éè¿ç»å®è·¯å¾è·åå¯¹åºçç»ä»¶ä¸ä¸ææ°ç»\n   * @param bindingPath bindingPathå­ç¬¦ä¸²\n   * @param namespace ns,é»è®¤ä¸º''\n   */\n   public getFrameContextsByBindingPath(bindingPath: string | string[], namespace: string = ''): FrameContext[] {\n    if (Array.isArray(bindingPath)) {\n      bindingPath = bindingPath.join('/');\n    }\n    const frameContexts = this.appContext && this.appContext.frameContextManager.getFrameContexts() || [];\n    return frameContexts.filter((frameContext: FrameContext) => frameContext && frameContext.namespace === namespace && frameContext.viewModel.bindingPath === bindingPath);\n  }\n}","import { Injectable, ElementRef } from '@angular/core';\nimport { Repository, FrameContext, NgFormControl } from '@farris/devkit';\nimport { FrameContextService } from './frame-context.service';\nimport { FormControlService } from './form-control.service';\n\nconst FIXED_COLUMN_START_INDEX = 5000;\nconst GRID_COLUMN_START_INDEX = 10000;\ninterface FocusableInvalidationGrid {\n  editCell(rowId: any, field: string): void;\n  disabled: boolean;\n}\n\n/**\n * è¡¨åéªè¯æå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass FocusInvalidService {\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private repository: Repository<any>,\n    private frameContext: FrameContext,\n    private frameContextService: FrameContextService,\n    private formControlService: FormControlService\n  ) {\n  }\n\n  /**\n   * åç¬¬ä¸ä¸ªéªè¯ä¸éè¿çå­æ®µè®¾ç½®ç¦ç¹\n   */\n  public focusInvalidInput(verifyInformations: any[], rootElement: ElementRef<any>) {\n    // æ éªè¯ä¸éè¿ä¿¡æ¯æ¶ï¼ç´æ¥è¿åã\n    if (!verifyInformations || !verifyInformations.length) {\n      return;\n    }\n    let targetField = null;\n    const firstVerifyInformation = this.selectFirstVerifyInformation(verifyInformations, rootElement);\n    if (firstVerifyInformation) {\n      targetField = firstVerifyInformation.targetField;\n      if (targetField) {\n        const canFocus = this.focusElement(targetField, rootElement);\n        if (canFocus) {\n          verifyInformations['focused'] = true;\n        }\n      }\n    }\n  }\n\n  /**\n   * è®¾ç½®DataGridååæ ¼ç¦ç¹\n   */\n  public focusGridCell(verifyInformations: any[], focusableDataGrid: FocusableInvalidationGrid) {\n    if (!verifyInformations || !verifyInformations.length || verifyInformations['focused'] == true || focusableDataGrid.disabled === true) {\n      return;\n    }\n    let targetField = null;\n    let targetId = null;\n    const firstVerifyInformation = this.selectFirstVerifyInformation(verifyInformations);\n    if (firstVerifyInformation) {\n      targetField = firstVerifyInformation.targetField;\n      targetId = firstVerifyInformation.id;\n      verifyInformations['focused'] = true;\n      focusableDataGrid.editCell(targetId, targetField);\n    }\n  }\n  private updateVerifyInformationsIndex(verifyInformations: any[], rootElement?: ElementRef<any>) {\n    verifyInformations = verifyInformations.filter((verifyInformation: any) => {\n      const frameContexts = this.getFrameContextsByPropertyPath(verifyInformation.fullPath, '/');\n      const frameContext = frameContexts && frameContexts.filter(frameContext => frameContext && frameContext.frameId === this.frameContext.frameId);\n      return frameContext ? true : false;\n    });\n    return verifyInformations.map((verifyInformation: any) => {\n      let tabIndex = -1;\n      if (verifyInformation) {\n        if (rootElement && verifyInformation.targetField) {\n          const input = this.getInputElementById(verifyInformation.targetField, rootElement);\n          tabIndex = input && input.getAttribute('tabindex') || -1;\n          tabIndex = Number(tabIndex);\n        }\n        // const frameContexts = this.getFrameContextsByPropertyPath(verifyInformation.fullPath, '/');\n        const frameContext = this.frameContext;//frameContexts && frameContexts[0] || null;\n        const frameIndex = frameContext.index + 1;\n        verifyInformation.tabIndex = tabIndex;\n        verifyInformation.domIndex = -1;\n        verifyInformation.frameIndex = -1;\n        verifyInformation.position = tabIndex;\n        if (frameContext) {\n          const domIndex = verifyInformation.fullPath && this.getFieldIndex(frameContext, verifyInformation.fullPath) || 0;\n          if (domIndex > 0) {\n            const rowIndex = verifyInformation.index || 0;\n            verifyInformation.domIndex = domIndex;\n            verifyInformation.frameIndex = frameContext.index;\n            verifyInformation.position = tabIndex > 0 ? tabIndex : (frameIndex * 1000 + rowIndex * 1000 + domIndex);\n          }\n        }\n      }\n      return verifyInformation;\n    });\n  }\n  private isGridComponent(frameContext: FrameContext) {\n    if (frameContext) {\n      const dataGridColumnsName = frameContext.viewModel['dataGridColumnsName'] || null;\n      return dataGridColumnsName ? true : false;\n    }\n    return undefined;\n  }\n  private getColumnIndex(frameContext: FrameContext, binding: string) {\n    binding = binding.split('/').filter(p => p).join('/');\n    const bindingPaths = frameContext.viewModel.bindingPath.split('/').filter(p => p);\n    const dataGridColumnsName = frameContext.viewModel['dataGridColumnsName'] || null;\n    const frameIndex = frameContext.index + 1;\n    if (!dataGridColumnsName) {\n      return undefined;\n    }\n    let columns: any[] = frameContext.viewModel[dataGridColumnsName];\n    if (!columns || columns.length < 1) {\n      return undefined;\n    }\n    // æå¹³columns\n    columns = columns.reduce((results: any[], item) => {\n      if (Array.isArray(item)) {\n        return results.concat(item);\n      }\n      return results.concat([item]);\n    }, []);\n    let position = -1;\n    for (let index = 0; index < columns.length; index++) {\n      const column: any | any[] = columns[index];\n      const fields = column && column.field && column.field.split('.').filter(p => p) || null;\n      if (!fields) {\n        continue;\n      }\n      if (bindingPaths.concat(fields).join('/') === binding) {\n        const fixed = column.fixed;\n        if (fixed) {\n          const fixedColumns = columns.filter(item => item.fixed === fixed);\n          const fixedColumnIndex = this.getIndexFromColumns(fixedColumns, binding);\n          if (fixed === 'left') {\n            position = frameIndex * FIXED_COLUMN_START_INDEX + fixedColumnIndex;\n          } else {\n            position = frameIndex * GRID_COLUMN_START_INDEX + 1000 + fixedColumnIndex;\n          }\n        } else {\n          position = frameIndex * GRID_COLUMN_START_INDEX + index;\n        }\n        break;\n      }\n    }\n    return position;\n  }\n  private getIndexFromColumns(columns: any[], binding: string) {\n    const bindingPaths = this.frameContext.viewModel.bindingPath.split('/').filter(p => p);\n    return columns.findIndex(column => {\n      const fields = column && column.field && column.field.split('.').filter(p => p) || null;\n      if (!fields) {\n        return false;\n      }\n      if (bindingPaths.concat(fields).join('/') === binding) {\n        return true;\n      }\n      return false;\n    });\n  }\n  private selectFirstVerifyInformation(verifyInformations: any[], rootElement?: ElementRef<any>) {\n    verifyInformations = this.updateVerifyInformationsIndex(verifyInformations, rootElement);\n    verifyInformations.sort((v1: any, v2: any) => Number(v1.position) - Number(v2.position));\n    return verifyInformations && verifyInformations.length > 0 && verifyInformations[0] || null;\n  }\n  private getInputElementById(targetField: string, rootElement: ElementRef<any>) {\n    let element = rootElement.nativeElement.ownerDocument.getElementById(targetField) || null;\n    if (element && element.tagName !== 'INPUT') {\n      const inputs = element.getElementsByTagName('input');\n      if (inputs.length) {\n        element = inputs[0];\n      }\n    }\n    return element;\n  }\n  public getFrameContextsByPropertyPath(propertyPath: string, separtor: string = '/'): FrameContext[] {\n    if (!propertyPath) {\n      return [];\n    }\n    const frameContexts = this.frameContext && this.frameContext.appContext.frameContextManager.getFrameContexts() || [];\n    return frameContexts.filter((frameContext: FrameContext) => {\n      const formControls = frameContext && frameContext.form && frameContext.form.ngFormControls || {};\n      const bindingPath = frameContext && frameContext.viewModel && frameContext.viewModel.bindingPath || '';\n      if (formControls && Object.keys(formControls).length > 0) {\n        const key = Object.keys(formControls).find((key: string) => {\n          const formControl = formControls[key];\n          if (!formControl || !formControl.binding) {\n            return false;\n          }\n          const bindings = formControl.binding.split('.').filter(p => p);\n          const bindingPaths = bindingPath.split('/').filter(p => p);\n          const fullPath = bindingPaths.concat(bindings);\n          return propertyPath.split(separtor).filter(p => p).join('/') === fullPath.join('/');\n        });\n        return key ? true : false;\n      }\n      return false;\n    });\n  }\n  public getFormControlIndexByBindingPath(frameContext: FrameContext, binding: string): number {\n    const ngFormControls = this.getFormControlsByFrameContext(frameContext);\n    if (!ngFormControls) {\n      return null;\n    }\n    const bindings = binding.split('/').filter(p => p);\n    return Object.values(ngFormControls).findIndex((ngFormControl: NgFormControl) => {\n      if (!ngFormControl) {\n        return false;\n      }\n      const bindingPath = frameContext.viewModel.bindingPath;\n      const bindingPaths = bindingPath.split('/').filter(p => p);\n      const formControlBindingPaths = ngFormControl.binding.split('.').filter(p => p);\n      const fullPath = bindingPaths.concat(formControlBindingPaths);\n      return fullPath.join('/') === bindings.join('/');\n    });\n  }\n  public getFieldIndex(frameContext: FrameContext, binding: string) {\n    const isGridComponent = this.isGridComponent(frameContext);\n    if (isGridComponent) {\n      return this.getColumnIndex(frameContext, binding);\n    } else {\n      return this.getFormControlIndexByBindingPath(frameContext, binding);\n    }\n  }\n  public getFormControlsByFrameContext(frameContext: FrameContext): { [propertyName: string]: NgFormControl } | null {\n    return frameContext && frameContext.form && frameContext.form.ngFormControls || null;\n  }\n  public focusElement(elementId: string, rootElement: ElementRef<any>): boolean {\n    let focused = false;\n    let elementToFocus = rootElement.nativeElement.ownerDocument.getElementById(elementId);\n    // æªè·åå°æå®å­æ®µæ¶ï¼è¿åï¼ä¸åè®¾ç½®ç¦ç¹ã\n    if (elementToFocus) {\n      // å¦ææå¤ä¸ªidéå¤çåç´ ï¼åä¸å®ä½\n      const elements = rootElement.nativeElement.ownerDocument.querySelectorAll(`#${elementId}`);\n      if (elements && elements.length > 1) {\n        return focused;\n      }\n      // å¦æç»å®ç®æ å­æ®µçæ§ä»¶ä¸æ¯Inputåç´ ï¼åæ¥æ¾å¶ä¸çº§èç¹ã\n      if (elementToFocus.tagName !== 'INPUT') {\n        const subElements = elementToFocus.getElementsByTagName('input');\n        if (subElements.length) {\n          elementToFocus = subElements[0];\n        }\n      }\n      elementToFocus.focus();\n      focused = true;\n    }\n    return focused;\n  }\n  /**\n   * è®¾ç½®ç¦ç¹\n   * @param verifyInformation éè¯¯ä¿¡æ¯\n   * @param frameContext ä¸ä¸æ\n   * @returns \n   */\n  public focus(verifyInformation: any, frameContext: FrameContext) {\n    if (!verifyInformation) {\n      return;\n    }\n    const isGridValidation = verifyInformation.index !== null;\n    if (isGridValidation) {\n      const grid = this.getGridRef(frameContext);\n      if (grid) {\n        setTimeout(() => {\n          grid.editCell(verifyInformation.id, verifyInformation.targetField);\n        }, 0);\n      }\n    } else {\n      const frameElement = this.getComponentRef(frameContext);\n      const elementId = verifyInformation.targetField;\n      this.focusById(elementId, frameElement);\n    }\n  }\n\n  /**\n   * éè¿æ§ä»¶idè®¾ç½®ç¦ç¹\n   * @param elementId \n   * @param elementRef \n   */\n  private focusById(elementId: string, elementRef?: ElementRef) {\n    const document: any = elementRef && elementRef.nativeElement.ownerDocument || window.document;\n    if (document) {\n      const element = document.getElementById(elementId);\n      if (element.tagName !== 'INPUT') {\n        const subElements = element.getElementsByTagName('input');\n        if (subElements.length) {\n          const input = subElements[0];\n          if (input && typeof input.focus === 'function') {\n            input.focus();\n          }\n        }\n      } else {\n        element.focus();\n      }\n    }\n  }\n  /**\n   * è·åç»ä»¶å®ä¾\n   * @param frameContext \n   * @returns \n   */\n  private getComponentRef(frameContext: FrameContext) {\n    return this.frameContext && this.frameContext.injector.get<ElementRef>(ElementRef, null) || null;\n  }\n  /**\n   * è·ågridå®ä¾\n   * @param frameContext frameContext\n   * @returns \n   */\n  private getGridRef(frameContext: FrameContext): FocusableInvalidationGrid {\n    const namespace = frameContext.namespace;\n    const bindingPath = frameContext.viewModel.bindingPath;\n    const frameContexts: FrameContext[] = this.frameContext.appContext.frameContextManager.getFrameContextsByNamespace(namespace) || [];\n    const matchedFrameContexts = frameContexts.filter((frameContext: FrameContext) => frameContext.viewModel && frameContext.viewModel.bindingPath.split('/').filter(p => p).toString() === bindingPath.split('/').filter(p => p).toString());\n    let result = null;\n    if (matchedFrameContexts) {\n      matchedFrameContexts.every((frameContext: FrameContext) => {\n        const frameId = frameContext.frameId;\n        const componentsMap = this.frameContext.appContext.componentManager.getComponentsByFrameId(frameId);\n        if (!componentsMap) {\n          return true;\n        }\n        const datagridComponent = Array.from(componentsMap.values()).find((component: any) => component && component['__component_type__'] === 'DatagridComponent');\n        if (datagridComponent) {\n          result = datagridComponent;\n          return false;\n        } else {\n          return true;\n        }\n      });\n    }\n    return result;\n  }\n}\n\nexport { FocusableInvalidationGrid, FocusInvalidService };\n","import { Injectable } from '@angular/core';\nimport { Repository, FrameContext} from '@farris/devkit';\nimport { switchMap } from 'rxjs/operators';\nimport { Observable, Subject, Subscriber } from 'rxjs';\nimport { of } from 'rxjs/observable/of';\nimport { FormNotifyService } from './form-notify.service';\nimport { LanguageService } from './languag.service';\n\n\nconst POSTER = 'iframePoster';\nconst RECEIVER = 'iframeReceiver';\nconst REPOSITORY = 'repository';\n// window.hashä¸­funcIdçå±æ§å\nconst FUNC_ID = 'funcId=';\nconst TAB_ID = 'tabId=';\n/**\n * ChangeItemService\n * @scope FrameComponent\n */\n@Injectable()\nclass ChangeItemService {\n\n  public top = top;\n  private funcId: string;\n  private tabId: string;\n  public itemChangePoster = new Subject<any>();\n  public itemChangeReceiver = new Subject<any>();\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private repository: Repository<any>,\n    private frameContext: FrameContext,\n    private notifyService: FormNotifyService,\n    private languageService: LanguageService\n  ) {\n  }\n\n  init() {\n    this.top['topMap'] = this.top['topMap'] || {};\n    this.changeItem = this.changeItem.bind(this);\n  }\n\n  setBykey(key: string, value: any) {\n    this.top['topMap'] = this.top['topMap'] || {};\n    this.top['topMap'][this.tabId] = this.top['topMap'][this.tabId] || {};\n    const topObject = this.top['topMap'][this.tabId];\n    topObject[key] = value;\n  }\n\n  getByKey(key: string) {\n    const topObject = this.top['topMap'][this.tabId] || {};\n    return topObject[key];\n  }\n\n  // å»ºç«iframeéä¿¡\n  setIframePoster() {\n    if (this.getByKey[POSTER]) {\n      return;\n    } else {\n      this.setBykey(POSTER, this.itemChangePoster);\n    }\n  }\n\n  getIframePoster() {\n    this.itemChangePoster = this.getByKey(RECEIVER);\n    this.setBykey(RECEIVER, this.itemChangeReceiver);\n  }\n\n  changeItem(type: string, id: string, parentId: string) {\n    // æ ¹æ®æ¯å¦æ¯å¼¹åºå¼å¡çåä¸åçtabId\n    const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\n    const virtualRootComponent = virtualRootFrameContext.frameComponent;\n    const isDialogComponent = virtualRootComponent['isDialogRootComponent'] || false;\n    if (isDialogComponent) {\n      this.tabId = window.location.hash.split(TAB_ID)[1].slice(0, window.location.hash.split(TAB_ID)[1].indexOf('&'));\n    } else {\n      this.tabId = parentId;\n    }\n    this.itemChangeReceiver = this.getByKey(RECEIVER);\n    return Observable.create((subscriber: Subscriber<any>) => {\n      this.getNextItemByCurrentId(id, type).subscribe((result: any) => {\n        subscriber.next(result);\n      });\n    });\n  }\n\n  // å¨liståå§åæ¶è°ç¨ï¼ç¼å­listçrepository\n  setRepository() {\n    if (window.location.hash.includes(TAB_ID)) {\n      this.tabId = window.location.hash.split(TAB_ID)[1].slice(0, window.location.hash.split(TAB_ID)[1].indexOf('&'));\n      this.setBykey(REPOSITORY, this.frameContext.repository);\n      this.setIframePoster();\n      this.getIframePoster();\n    }\n  }\n\n  // æ ¹æ®ç±»ååidè·åç¸é»çæ°æ®\n  getNextItemByCurrentId(currentId: string, type: string) {\n    const repository = this.getByKey(REPOSITORY);\n    const { pageSize, pageIndex, total } = repository.entityCollection.paginationInfo;\n    let currentIdx = null;\n    const list = repository.entityCollection.getAllEntities();\n    list.find((x: any, idx: string) => {\n      if (x.id === currentId) {\n        currentIdx = idx;\n      }\n    });\n    // æ²¡æå¨åè¡¨ä¸­æ¾å°æ°æ®ï¼è¿åç©º\n    if (currentIdx === null) {\n      // æ°å¢åæ¶å½åæ æ°æ®æ¶ç¹ä¸ä¸æ¡ä¸ä¸æ¡\n      if (list.length) {\n        switch (type) {\n          case 'prev':\n            return of(list[list.length - 1].id);\n            break;\n          case 'next':\n            this.notifyService.info(this.languageService.changeToLast, { hideTitle: true });\n            return of(null);\n            break;\n        }\n      }\n      return of(null);\n    }\n    let nextIdx = currentIdx;\n    switch (type) {\n      case 'prev':\n        // å½åé¡µç¬¬ä¸æ¡,ä¸éç¬¬ä¸é¡µ,åä¸ä¸é¡µæåä¸æ¡\n        if (currentIdx === 0 && pageIndex !== 1) {\n          return repository.getEntities([], [], pageSize, pageIndex - 1).pipe(\n            switchMap(result => {\n              nextIdx = pageSize - 1;\n              return of(result[nextIdx].id);\n            })\n          );\n        }\n        // ç¬¬ä¸é¡µç¬¬ä¸æ¡ï¼ä»è¿ååææ°æ®\n        else if (currentIdx === 0 && pageIndex === 1) {\n          this.notifyService.info(this.languageService.changeToFirst, { hideTitle: true });\n          return of(list[nextIdx].id);\n        }\n        // ä¸æ¯ç¬¬ä¸æ¡ï¼è¿åä¸ä¸æ¡\n        else {\n          nextIdx = currentIdx - 1;\n          return of(list[nextIdx].id);\n        }\n        break;\n      case 'next':\n        // è¶è¿å½åé¡µ\n        if (currentIdx + 1 + 1 > list.length) {\n          // ä¸éæåä¸æ¡æ°æ®,åä¸ä¸é¡µç¬¬ä¸æ¡æ°æ®\n          if (((pageIndex - 1) * pageSize + currentIdx + 1) < total) {\n            return repository.getEntities([], [], pageSize, pageIndex + 1).pipe(switchMap(result => {\n              return of(result[0].id);\n            }));\n          }\n          // æåä¸æ¡æ°æ®ï¼ä»è¿ååæ°æ®\n          else {\n            this.notifyService.info(this.languageService.changeToLast, { hideTitle: true });\n            return of(list[nextIdx].id);\n          }\n        } else {\n          nextIdx = currentIdx + 1;\n          return of(list[nextIdx].id);\n        }\n        break;\n    }\n  }\n\n\n}\n\nexport { ChangeItemService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, of, empty, EMPTY } from 'rxjs';\nimport { tap, switchMap, concatMap, catchError } from 'rxjs/operators';\nimport { Repository, BindingData, Entity, ViewModel, BindingList, EntityPathConverter, BindingObject } from '@farris/devkit';\nimport { BefRepository, BefRepositoryUtil, BefDataPathUtil } from '@farris/bef';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { CommandService } from '../command-service';\nimport { FilterConditionService } from '../filter-condition.service';\n// tslint:disable: no-string-literal max-line-length\n\n/**\n * åè¡¨ä»åºæå¡\n */\n@Injectable()\nclass ListDataService {\n\n  /**\n   * æé \n   * @param msgService msgService\n   * @param repository repository\n   * @param bindingData bindingData\n   * @param loadingService loadingService\n   * @param languageService languageService\n   * @param formNotifyService formNotifyService\n   * @param formErrorService formErrorService\n   * ! @param viewModel viewModel,vmæ¯åææ³¨å¥çï¼èè¡¨åè·åä¸å°ï¼ä¸å®è¦åéç©ºå¤æ­\n   * @param filterConditionService filterConditionService\n   */\n  constructor(\n    private msgService: FormMessageService,\n    private repository: Repository<any>,\n    private bindingData: BindingData,\n    private loadingService: FormLoadingService,\n    @Optional() private languageService: LanguageService,\n    private formNotifyService: FormNotifyService,\n    private formErrorService: FormErrorService,\n    private viewModel: ViewModel,\n    private filterConditionService: FilterConditionService,\n  ) {\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n\n    // if (!filterConditionService) {\n    //   this.filterConditionService = new FilterConditionService();\n    // }\n  }\n\n  /**\n   * å è½½\n   */\n  public load(filter?: string, sort?: string): Observable<Entity[]> {\n\n    // åæ°å¤ç\n    filter = !filter ? '[]' : filter;\n    sort = !sort ? '[]' : sort;\n    // åå¹¶è¿æ»¤æ¡ä»¶\n    filter = this.mergeFilterConditions(filter);\n    // åå¹¶æåºæ¡ä»¶\n    sort = this.mergeSortConditions(sort);\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(200);\n    const query$ = this.repository.getEntities(JSON.parse(filter), JSON.parse(sort), null, null);\n    return query$.pipe(\n      tap(\n        () => {\n          // è§¦åè¿ç«¯åè®¡äºä»¶\n          this.fireQueryEvent(filter);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * è¿æ»¤æ°æ®\n   * @param filter è¿æ»¤æ¡ä»¶\n   * @param sort æåºæ¡ä»¶\n   */\n  public filter(filter?: string, sort?: string): Observable<Entity[]> {\n    // åæ°å¤ç\n    filter = !filter ? '[]' : filter;\n    sort = !sort ? '[]' : sort;\n    // åå¹¶è¿æ»¤æ¡ä»¶\n    filter = this.mergeFilterConditions(filter);\n    // åå¹¶æåºæ¡ä»¶\n    sort = this.mergeSortConditions(sort);\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(200);\n    const query$ = this.repository.filter(JSON.parse(filter), JSON.parse(sort));\n    return query$.pipe(\n      tap(\n        () => {\n          // è§¦åè¿ç«¯åè®¡äºä»¶\n          this.fireQueryEvent(filter);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * æ¥è¯¢\n   */\n  public query(filter: string, sort: string, pageSize: number, pageIndex: number): Observable<Entity[]> {\n    // åæ°å¤ç\n    filter = (filter === '') ? '[]' : filter;\n    sort = (sort === '') ? '[]' : sort;\n    // åå¹¶è¿æ»¤æ¡ä»¶\n    filter = this.mergeFilterConditions(filter);\n    // åå¹¶æåºæ¡ä»¶\n    sort = this.mergeSortConditions(sort);\n    // æ§è¡åæ°\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(5);\n    const query$ = this.repository.getEntities(JSON.parse(filter), JSON.parse(sort), pageSize, pageIndex);\n    return query$.pipe(\n      tap(\n        () => {\n          // è§¦åè¿ç«¯åè®¡äºä»¶\n          this.fireQueryEvent(filter);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.queryFailed, error);\n        }\n      )\n    );\n  }\n\n  public queryChild(filter: string, sort: string) {\n    // const isUpdateWithPaging = this.viewModel.frameContext.root.params.get('updateWithPaging') || false;\n    // if (isUpdateWithPaging) {\n    //   return of(null);\n    // }\n    // tslint:disable-next-line: max-line-length\n    const fullPaths = EntityPathConverter.toEntityPathArray(this.viewModel.bindingPath, this.bindingData);\n    const paths = fullPaths.slice(0, fullPaths.length - 1);\n    // debug\n    // tslint:disable-next-line: max-line-length\n    const bindingPaths = this.viewModel.bindingPath.split('/').filter(item => item);\n    const bindingData = this.viewModel.bindingData;\n    let nodeCode = bindingPaths[bindingPaths.length - 1];\n    nodeCode = nodeCode.substr(0, nodeCode.length - 1);\n    // è·åä¸çº§å®ä½\n    const parentPaths = bindingPaths.slice(0, bindingPaths.length - 1);\n    const BindingList = bindingData.getValue(parentPaths) as BindingList;\n    if (!BindingList) {\n      return;\n    }\n    this.viewModel.frameContext.appContext.params.delete(\"retrieveing\");\n    const configPath = `/${nodeCode}`;\n    const config = this.repository.entityCollection.getPaginationConfigByPath(configPath);\n    if (config) {\n      const { pageIndex = 1, pageSize = 0 } = config;\n      // pageSize = 0è¡¨ç¤ºæªåé¡µ\n      if (pageSize !== 0) {\n        this.viewModel.frameContext.appContext.params.set('queryChild', true);\n        const request$ = this.repository.queryChild(paths, pageIndex, pageSize);\n        return request$.pipe(\n          tap(() => { },\n            error => {\n              this.formErrorService.exception(this.languageService.queryFailed, error);\n            }\n          )\n        );\n      }\n    }\n\n  }\n\n  /**\n   * è·ååé¡µä¿¡æ¯\n   * @param nodeCode nodeCode\n   * @returns åé¡µä¿¡æ¯ï¼åæ¬ï¼åé¡µå¤§å°ãå½åé¡µç \n   * @description åºæ¬åé¡µä¿¡æ¯å¨åé¡µä¿¡æ¯ä¸­å­å¨æ¶keyä¸ºnodeCode\n   */\n  /*private getPagingInfo(nodeCode: string) {\n    const result: { pageIndex?: number, pageSize?: number } = {};\n    const nodeCodePath = `/${nodeCode}`;\n    const defaultPagingInfo = this.repository.entityCollection.getPaginationConfigByPath(nodeCodePath);\n    const pageSize = defaultPagingInfo && defaultPagingInfo.pageSize || 0;\n    const pageIndex = defaultPagingInfo && defaultPagingInfo.pageIndex || 1;\n    result.pageIndex = pageIndex;\n    result.pageSize = pageSize;\n    return result;\n  }*/\n  /**\n   * è¿½å ä¸æ¡æ°æ°æ®\n   */\n  public append(): Observable<Entity> {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'append' });\n    }\n    const append$ = this.repository.append();\n    return append$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.appendFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * å½åè¡åæåæå¥æ°æ®\n   * @param position 1 | -1\n   */\n  public insert(position: 1 | -1 = -1) {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'insert' });\n    }\n    const append$ = this.repository.insert(position);\n    return append$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.appendFailed, error);\n        }\n      )\n    );\n  }\n\n  /**\n   * æäº¤åæ´ï¼æ¹éç¼è¾é¡µé¢ï¼è¡åæ¢æ¶æäº¤å¢éï¼\n   */\n  public updateChanges(): Observable<boolean> {\n    const update$ = this.repository.updateAllChanges();\n    return update$;\n  }\n\n  /**\n   * æ¹éä¿å­\n   * @param successMsg èªå®ä¹æç¤ºä¿¡æ¯\n   */\n  public save(successMsg?: string): Observable<boolean> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'save' });\n    }\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const save$ = this.repository.applyChanges();\n    const result$ = save$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          if (successMsg && successMsg.trim()) {\n            this.formNotifyService.success(successMsg, { hideTitle: true });\n          } else {\n            this.formNotifyService.success(this.languageService.saveSuccess, { hideTitle: true });\n          }\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.multiSaveFailed, error);\n        }\n      )\n    );\n\n    return result$;\n  }\n\n  /**\n   * å é¤\n   * @param id è¦å é¤çæ°æ®çid\n   * @param ifSave æ¯å¦ä¿å­\n   * @param successMsg èªå®ä¹æç¤ºä¿¡æ¯\n   * @param confirm æ¯å¦éè¦ç¡®è®¤\n   * @param breakable æ¯å¦å¯ä¸­æ­ï¼ifSaveä¸ºfalseæ¶æµä¼ä¸­æ­\n   */\n  public remove(id: string, ifSave?: boolean | string, successMsg?: string, confirm: boolean | string = true, breakable: boolean | string = true): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'delete' });\n    }\n    if (!id) {\n      this.formNotifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n      return empty();\n    }\n    confirm = (confirm === false || confirm === 'false') ? false : true;\n    breakable = (breakable === false || breakable === 'false') ? false : true;\n    const action$ = confirm ? this.msgService.question(this.languageService.confirmDeletion) : of(true);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return empty();\n        }\n        ifSave = (ifSave === false || ifSave === 'false') ? false : true;\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.repository.removeById(id, ifSave);\n        if (!remove$) {\n          return empty();\n        }\n        return remove$.pipe(\n          tap(\n            () => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              if (successMsg && successMsg.trim()) {\n                this.formNotifyService.success(successMsg, { hideTitle: true });\n              } else {\n                this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n              }\n            },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.formErrorService.exception(this.languageService.deleteFailed, error);\n            }\n          ),\n          switchMap(() => {\n            if (ifSave === true || !breakable) {\n              // return this.load();\n              return of([]);\n            } else {\n              return empty();\n            }\n          })\n        );\n      })\n    );\n  }\n  /**\n   * æ¹éå é¤\n   * @param ids ids\n   * @param ifSave æ¯å¦ä¿å­\n   * @param successMsg èªå®ä¹æç¤ºä¿¡æ¯\n   * @param deleteCurrentRowIfNoChecks æ²¡æå¾éæ¶å é¤å½åè¡\n   */\n  public removeRows(ids: string[], ifSave?: boolean | string, successMsg?: string, deleteCurrentRowIfNoChecks: boolean | string = false): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'removeRows' });\n    }\n    deleteCurrentRowIfNoChecks = (deleteCurrentRowIfNoChecks === 'true' || deleteCurrentRowIfNoChecks === true) ? true : false;\n    if (!ids || ids.length === 0) {\n      const currentId = this.bindingData.list.currentId;\n      if (deleteCurrentRowIfNoChecks === true && currentId) {\n        ids = [this.bindingData.list.currentId];\n      } else {\n        this.formNotifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n        return empty();\n      }\n    }\n    const action$ = this.msgService.confirm(this.languageService.confirmDeletion);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return empty();\n        }\n        if (typeof ifSave === 'undefined') {\n          ifSave = true;\n        }\n        if (typeof ifSave === 'string') {\n          ifSave = ifSave.toLowerCase() === 'false' ? false : true;\n        }\n        ifSave = (ifSave === false) ? false : true;\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.repository.removeByIds(ids, ifSave);\n\n        if (!remove$) {\n          return empty();\n        }\n\n        return remove$.pipe(\n          tap(\n            () => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              if (successMsg && successMsg.trim()) {\n                this.formNotifyService.success(successMsg, { hideTitle: true });\n              } else {\n                this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n              }\n              // this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.formErrorService.exception(this.languageService.deleteFailed, error);\n            }\n          ),\n          switchMap(() => {\n            return of([]);\n          })\n        );\n      })\n    );\n  }\n\n  /**\n   * å é¤åçå·æ°\n   */\n  public refreshAfterRemoving(loadCmdName: string, loadCmdFrameId: string): Observable<any> {\n    if (this.viewModel && loadCmdName && loadCmdFrameId) {\n      const commandService = this.viewModel.frameContext.injector.get<CommandService>(CommandService, null);\n      return commandService.execute(loadCmdName, loadCmdFrameId);\n    }\n    return this.load();\n  }\n\n  /**\n   * å·æ°\n   * @param loadCmdName å·æ°å½ä»¤\n   * @param loadCmdFrameId å·æ°å½ä»¤æå¨çframeId\n   */\n  public refresh(loadCmdName: string, loadCmdFrameId: string): Observable<any> {\n    if (this.viewModel && loadCmdName && loadCmdFrameId) {\n      const commandService = this.viewModel.frameContext.injector.get<CommandService>(CommandService, null);\n      return commandService.execute(loadCmdName, loadCmdFrameId);\n    }\n    return this.load();\n  }\n  /**\n   * åæ¶æ¶æ£æµæªä¿å­è®°å½\n   */\n  public cancel(): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'cancel' });\n    }\n    // æ²¡æåæ´æ¶ç´æ¥åæ¶\n    const befRepository = this.repository as BefRepository<any>;\n    const hasUnsavedData = BefRepositoryUtil.isExistUnsaveData(befRepository);\n    if (hasUnsavedData === false) {\n      return this._cancel();\n    }\n\n    const confirmResult$ = this.msgService.question(this.languageService['cancelWithoutSave']).pipe(\n      switchMap((ifCancel: boolean) => {\n        if (ifCancel === false) {\n          return EMPTY;\n        }\n\n        return this._cancel();\n      })\n    );\n\n    return confirmResult$;\n  }\n  /**\n   * è¿ååæ´é\n   * @description ä¸å¸¦åæ´æ£æµæç¤º\n   */\n  public revert(): Observable<any> {\n    return this._cancel();\n  }\n  /**\n   * åæ¶ï¼åé¨åæ¶ï¼\n   */\n  private _cancel(): Observable<any> {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const cancel$ = this.repository.cancelChanges();\n    return cancel$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.cancelFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * è·åæ ¹ç»ä»¶appContext\n   */\n  private get messagePipe() {\n    if (this.viewModel && this.viewModel.frameContext) {\n      const appContext = this.viewModel.frameContext.getFormAppContext() || null;\n      if (appContext) {\n        return appContext.messagePipe || null;\n      }\n    }\n    return null;\n  }\n  /**\n   * è§¦åæ¥è¯¢äºä»¶\n   * @param filters è¿æ»¤æ¡ä»¶\n   */\n  private fireQueryEvent(filters: any) {\n    const messagePipe = this.messagePipe;\n    // const frameId = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameId || null;\n    if (messagePipe) {\n      messagePipe.next({ type: 'query' });\n    }\n  }\n  /**\n   * åå¹¶è¿æ»¤æ¡ä»¶\n   * @param filter è¡¨åè¿æ»¤æ¡ä»¶\n   */\n  private mergeFilterConditions(filter: any) {\n    if (typeof filter === 'string') {\n      filter = JSON.parse(filter) || [];\n    }\n    const filters: Array<any> = filter;\n    const bindingPath = this.viewModel && this.viewModel.bindingPath || null;\n    if (bindingPath) {\n      const originalConditions = this.viewModel && this.viewModel.frameContext.repository.filterConditionManager.getFilters(bindingPath) || [];\n      // this.filterConditionService.getFilters(bindingPath) || [];\n      const conditions = Array.from(originalConditions);\n      if (conditions && conditions.length > 0) {\n        /*filters.forEach((item: any, index: number) => {\n          const field = item.FilterField || null;\n          if (field) {\n            const duplicateIndex = conditions.findIndex(condition => condition.FilterField === field);\n            if (duplicateIndex !== -1) {\n              filters[index] = conditions[duplicateIndex];\n              conditions.splice(duplicateIndex, 1);\n            }\n          }\n        });*/\n        // ä¿®æ¹å½ä»¤ä¸è¿æ»¤æ¡ä»¶çæåä¸ä¸ªæ¥è¯¢å³ç³»ä¸ºand\n        if (filters.length > 0) {\n          // æåä¸ä¸ªè¿æ»¤æ¡ä»¶\n          const lastFilter = filters[filters.length - 1];\n          if (lastFilter) {\n            if (lastFilter.hasOwnProperty('Relation')) {\n              delete lastFilter.Relation;\n            }\n            lastFilter.relation = 1;\n          }\n        }\n        // åå¹¶æ°çè¿æ»¤æ¡ä»¶ååæ¥å½ä»¤ä¸çè¿æ»¤æ¡ä»¶\n        filters.push(...conditions);\n      }\n    }\n\n    return JSON.stringify(filters);\n  }\n  /**\n   * åå¹¶æåºæ¡ä»¶\n   * @param sort æåºæ¡ä»¶\n   */\n  private mergeSortConditions(sort: any) {\n    if (typeof sort === 'string') {\n      sort = JSON.parse(sort) || [];\n    }\n    const sorts: Array<any> = sort;\n    const bindingPath = this.viewModel && this.viewModel.bindingPath || null;\n    if (bindingPath) {\n      // è·åå½åç»å®è·¯å¾çæææåºæ¡ä»¶\n      const originalConditions = this.viewModel && this.viewModel.frameContext.repository.sortConditionManager.getConditionsByBindingPath(bindingPath, (direction) => {\n        if (direction === 'asc') {\n          return 0;\n        } else { return 1; }\n      }) || [];\n      const conditions = Array.from(originalConditions);\n      // å¦æå½åç»å®è·¯å¾ææåºæ¡ä»¶ï¼åå¿½ç¥å½ä»¤ä¸é¢å¶çæåºæ¡ä»¶\n      if (conditions && conditions.length > 0) {\n        // éåå·²æçè¿æ»¤æ¡ä»¶ï¼å¦ææéå¤çfieldï¼ç¨åèçè¦çå·²æç\n        /*sorts.forEach((item: any, index: number) => {\n          const field = item.SortField || null;\n          if (field) {\n            const duplicateIndex = conditions.findIndex(condition => condition.SortField === field);\n            if (duplicateIndex !== -1) {\n              sorts[index] = conditions[duplicateIndex];\n              conditions.splice(duplicateIndex, 1);\n            }\n          }\n        });*/\n        return JSON.stringify(conditions);\n        // å°å¶ä½æåºæ¡ä»¶æ·»å å°æåºæ°ç»\n        // sorts.push(...conditions);\n      }\n    }\n    return JSON.stringify(sorts);\n  }\n}\nexport { ListDataService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, empty, of, EMPTY } from 'rxjs';\nimport { tap, switchMap, concatMap } from 'rxjs/operators';\nimport { BindingList, Repository, ViewModel } from '@farris/devkit';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\n\n/**\n * å­åè¡¨åæ°æå¡\n */\n@Injectable()\nclass SubListDataService {\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private msgService: FormMessageService,\n    private repository: Repository<any>,\n    private loadingService: FormLoadingService,\n    private viewModel: ViewModel,\n    @Optional() private languageService: LanguageService,\n    private formNotifyService: FormNotifyService,\n    private formErrorService: FormErrorService\n  ) {\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n    this.viewModel = viewModel;\n  }\n\n  /**\n   * æ°å¢\n   */\n  add(): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'add' });\n    }\n    const path = this.getPath();\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const append$ = this.repository.appendByPath(path);\n    return append$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.addFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * å¨æå®ä½ç½®æå¥\n   * @param position ä½ç½®\n   */\n  public insert(position: 1 | -1 = -1) {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'insert' });\n    }\n    const path = this.getPath();\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const append$ = this.repository.insertByPath(path, position);\n    return append$.pipe(\n      tap(() => {\n        this.loadingService.hideDelayLoading(loadingTimerId);\n      },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.formErrorService.exception(this.languageService.addFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * å é¤å­è¡¨æ°æ®\n   */\n  remove(id: string, successMsg?: string): Observable<any> {\n    const msg = successMsg ? successMsg : '';\n    return this.innerRemove(id, false, msg);\n  }\n\n  /**\n   * å é¤å­è¡¨æ°æ®ï¼ä¸ç¡®è®¤ï¼\n   */\n  removeWithoutConfirm(id: string): Observable<any> {\n    return this.innerRemove(id, true, '');\n  }\n\n  /**\n   * æ¹éå é¤å­è¡¨\n   * @param ids ids\n   * @param successMsg èªå®ä¹æç¤ºä¿¡æ¯\n   */\n  removeChildrenByIds(ids: string, successMsg?: string): Observable<any> {\n    if (!ids) {\n      this.formNotifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n      return EMPTY;\n    }\n    const action$ = this.msgService.confirm(this.languageService.confirmDeletion);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return EMPTY;\n        }\n        const path = this.getPath();\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.repository.batchRemoveByPath(path, ids);\n        return remove$.pipe(\n          tap(() => {\n            this.loadingService.hideDelayLoading(loadingTimerId);\n            if (successMsg && successMsg.trim()) {\n              this.formNotifyService.success(successMsg, { hideTitle: true });\n            } else {\n              this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            }\n            // this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n          },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.formErrorService.exception(this.languageService.deleteFailed, error);\n            }\n          )\n        );\n      })\n    );\n  }\n\n  /**\n   * å é¤\n   */\n  innerRemove(id: string, isConfirm: boolean, successMsg: string): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'remove' });\n    }\n    if (!id) {\n      this.formNotifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n      return empty();\n    }\n\n    let action$: Observable<boolean>;\n    if (isConfirm === false) {\n      action$ = this.msgService.question(this.languageService.confirmDeletion);\n    } else {\n      action$ = of(true);\n    }\n\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return empty();\n        }\n        const path = this.getPath();\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.repository.removeByPath(path, id);\n        return remove$.pipe(\n          tap(() => {\n            this.loadingService.hideDelayLoading(loadingTimerId);\n            if (successMsg && successMsg.trim()) {\n              this.formNotifyService.success(successMsg, { hideTitle: true });\n            } else {\n              this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            }\n            // this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n          },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.formErrorService.exception(this.languageService.deleteFailed, error);\n            }\n          )\n        );\n      })\n    );\n  }\n\n  /**\n   * å é¤å¹¶ä¿å­\n   * @param id id\n   * @param successMsg èªå®ä¹æç¤ºä¿¡æ¯\n   */\n  removeAndSave(id: string, successMsg?: string): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'removeAndSave' });\n    }\n    if (!id) {\n      this.formNotifyService.warning(this.languageService.plsSelectDeleteData, { hideTitle: true });\n      return empty();\n    }\n    const action$ = this.msgService.confirm(this.languageService.confirmDeletion);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return empty();\n        }\n\n        // å é¤å­è¡¨æ°æ®\n        const path = this.getPath();\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.repository.removeByPath(path, id);\n\n        return remove$.pipe(\n\n          // æ§è¡ä¸»è¡¨ä¿å­\n          switchMap(() => {\n            const fid = this.viewModel.bindingData.list.currentId as string;\n            return this.repository.applyChangesById(fid);\n          }),\n\n          // éèå è½½ä¸­\n          tap(() => {\n            this.loadingService.hideDelayLoading(loadingTimerId);\n            if (successMsg && successMsg.trim()) {\n              this.formNotifyService.success(successMsg, { hideTitle: true });\n            } else {\n              this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            }\n            // this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n          },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.formErrorService.exception(this.languageService.deleteFailed, error);\n            })\n        );\n      })\n    );\n  }\n  /**\n   * ä¸ç§»æä¸ç§»æ°æ®\n   * @param direction æ¹åï¼up | down\n   * @param field æåºå­æ®µ\n   * @param targets è¦ç§»å¨çæ°æ®\n   * @description\n   * ä½¿ç¨è¯¥æ¹æ³æ¶æåºå­æ®µå¿é¡»æå¼ï¼å¦åæ æ³æåº\n   */\n  public move(direction: string | 'up' | 'down', field: string, targets: Array<any> | string) {\n    if (!targets) {\n      return;\n    }\n    if (typeof targets === 'string') {\n      targets = targets.split(',').filter(p => p);\n    }\n    const bindingPath = this.viewModel && this.viewModel.bindingPath || null;\n    if (!bindingPath) {\n      return;\n    }\n    const bindingList = this.viewModel.bindingData.getList() as BindingList;\n    if (!bindingList || bindingList.length < 1) {\n      return;\n    }\n    targets.forEach((target) => {\n      const index = bindingList.getIndexById(target);\n      if (index === -1) {\n        return;\n      }\n      const item = bindingList.findById(target);\n      const position = item.getValue(field);\n      const base = direction === 'up'  ? -1 : 1;\n      // å¾äº¤æ¢çè¡ä¿¡æ¯\n      const exchangeRowIndex = index + base;\n      if (exchangeRowIndex < 0 || exchangeRowIndex > bindingList.length) {\n        // ç¬¬ä¸è¡æ æ³ä¸ç§»ï¼æåä¸è¡æ æ³ä¸ç§»\n        return;\n      }\n      const exchangeRowId = bindingList.getIdByIndex(exchangeRowIndex);\n      const exchangeRow = bindingList.findById(exchangeRowId);\n      const exchangeRowPosition = exchangeRow[field];\n      // ç§»å¨è¡åäº¤æ¢è¡é½æ²¡ææåº\n      if (this.isNullOrEmpty(position) && this.isNullOrEmpty(exchangeRowPosition)) {\n        return;\n      }\n      bindingList.swapById(target, exchangeRowId);\n      exchangeRow.setValue(field, position,true,true);\n      item.setValue(field, exchangeRowPosition,true,true);\n    });\n\n  }\n  private isNullOrEmpty(value: any) {\n    return value === '' || value === null || value === undefined;\n  }\n  /**\n   * è·åå®æ´è·¯å¾\n   * @todoï¼å¼ºè¯å«å°ä»è¡¨è¿ä¸çº§\n   * fixed by justin: æ ¹æ®bindingPathï¼å¦ææ¯ä»ä»è¡¨ï¼éè¦è·åä¸»è¡¨æ°æ®idåä»è¡¨æ°æ®id\n   */\n  private getPath(): string {\n    const bindingPath = this.viewModel.bindingPath;\n    const rid = this.viewModel.bindingData.list.currentId; // rootè¡¨æ°æ®id\n    let path = '/' + rid;\n\n    const subPaths = bindingPath.split('/');\n    if (subPaths.length > 0) {\n      // eg:bindingPathå½¢å¦/edus/grades,splitåæ¯['', 'edus', 'grades']\n      // å æ­¤indexä»1å¼å§\n      for (let index = 1; index < subPaths.length - 1; index++) {\n        const subPath = subPaths[index];\n        const subData = this.viewModel.bindingData[subPath];\n        if (!subData || !subData.currentId) {\n          this.formNotifyService.warning(this.languageService['plsSelectDetailFormData'], { hideTitle: true });\n          throw Error(`è·åå­è¡¨å®æ´è·¯å¾åºéï¼æ¾ä¸å°${subData}å¯¹åºçå­è¡¨ï¼æå¯¹åºå­è¡¨æ²¡æå½åè¡ã`);\n        }\n        path += `/${subPath}/${subData.currentId}`;\n      }\n    }\n    path += '/' + subPaths[subPaths.length - 1];\n\n    return path;\n  }\n  /**\n   * è·åæ ¹ç»ä»¶appContext\n   */\n  private get messagePipe() {\n    if (this.viewModel && this.viewModel.frameContext) {\n      const appContext = this.viewModel.frameContext.getFormAppContext() || null;\n      if (appContext) {\n        return appContext.messagePipe || null;\n      }\n    }\n    return null;\n  }\n}\nexport { SubListDataService };\n","\nimport { Entity, FrameContext, BindingData } from '@farris/devkit';\nimport { BefRepository, BefRestService } from '@farris/bef';\n\n/**\n * åºç¡æ°æ®æå¡\n */\nclass BaseDataService {\n\n  /**\n   * æ¡æ¶ä¸ä¸æ\n   */\n  protected frameContext: FrameContext;\n\n  /**\n   * å®ä½ä»åº\n   */\n  protected get repository(): BefRepository<Entity> {\n    return this.frameContext.repository as BefRepository<Entity>;\n  }\n\n  /**\n   * Restæå¡\n   */\n  protected get restService(): BefRestService {\n    return this.repository.restService;\n  }\n\n  /**\n   * æ°æ®ç»å®\n   */\n  protected get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  /**\n   * æé å½æ°\n   */\n  constructor(frameContext: FrameContext) {\n    this.frameContext = frameContext;\n  }\n\n}\n\nexport { BaseDataService };\n","import { BindingData, BindingList } from '@farris/devkit';\n\n/**\n * æ æ°æ®çå¸®å©ç±»\n */\nclass ParentTreeNodeUtil {\n\n  /**\n   * éä¸­ç¬¬ä¸ä¸ªæ ¹èç¹\n   */\n  public selectFirstRootNode(bindingData: BindingData, hierarchyInfoKey: string) {\n\n    const treeNodesData = bindingData.list.toJSON();\n    const firstRootNodeId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    this.selectedNode(bindingData, hierarchyInfoKey, firstRootNodeId);\n  }\n  public selectNodeByBindingList(bindingList: BindingList, hierarchyInfoKey: string, selectedNodeId: string): void {\n    const treeNodesData = bindingList.toJSON();\n    // å¦æè¦è®¾ç½®çèç¹ä¸å­å¨ï¼åè®¾ç½®ç¬¬1ä¸ªæ ¹èç¹\n    const selectedNodeData = this.getNodeDataById(treeNodesData, selectedNodeId);\n    let currentId = selectedNodeId;\n    if (!selectedNodeData) {\n      currentId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    }\n    setTimeout(() => {\n      bindingList.setCurrentId(currentId, true, true);\n    }, 0);\n  }\n  /**\n   * éä¸­èç¹\n   */\n  public selectedNode(bindingData: BindingData, hierarchyInfoKey: string, selectedNodeId: string): void {\n    const treeNodesData = bindingData.list.toJSON();\n    // å¦æè¦è®¾ç½®çèç¹ä¸å­å¨ï¼åè®¾ç½®ç¬¬1ä¸ªæ ¹èç¹\n    const selectedNodeData = this.getNodeDataById(treeNodesData, selectedNodeId);\n    let currentId = selectedNodeId;\n    if (!selectedNodeData) {\n      currentId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    }\n    if (bindingData.rowSelectedEventSuspend === true) {\n      return;\n    }\n    setTimeout(() => {\n      bindingData.list.currentId = null;\n      bindingData.list.setCurrentId(currentId, true, true);\n    }, 0);\n  }\n\n  /**\n   * æ£æ¥æ¯å¦æå­èç¹\n   */\n  public hasChildNodes(treeNodesData: any[], hierarchyInfoKey: string, fid: string): boolean {\n    const fNodeData = this.getNodeDataById(treeNodesData, fid);\n    // const fLayer = fNodeData[hierarchyInfoKey]['layer'];\n    const fIsDetail = fNodeData[hierarchyInfoKey]['isDetail'];\n\n    // éæç»èç¹ï¼è¿åtrue\n    if (fIsDetail === false) {\n      return true;\n    }\n    return false;\n\n    // const childNodesData = this.getChildNodesData(treeNodesData, hierarchyInfoKey, fLayer, fid);\n    // return childNodesData.length > 0;\n  }\n\n  /**\n   * è·åæ ¹èç¹ï¼å¤ä¸ªæ ¹èç¹æ¶è·åç¬¬ä¸ä¸ªï¼\n   * @return æ¾ä¸å°æ¶è¿ånull\n   */\n  private getFirstNodeId(treeNodesData: any[], hierarchyInfoKey: string): string {\n    let rootData = treeNodesData.find((itemData: any) => {\n      const layer = itemData[hierarchyInfoKey]['layer'];\n      return layer === 1;\n    });\n    if (!rootData) {\n      const rootLayer = this.getRootLayer(treeNodesData, hierarchyInfoKey);\n      rootData = treeNodesData.find((itemData: any) => {\n        const layer = itemData[hierarchyInfoKey]['layer'];\n        return layer === rootLayer;\n      });\n    }\n    return rootData ? rootData['id'] : '';\n  }\n  private getRootLayer(treeNodesData: any[], hierarchyInfoKey: string) {\n    let layer = null;\n    if (treeNodesData && Array.isArray(treeNodesData)) {\n      const layers = treeNodesData.map(item => {\n        const layer = item[hierarchyInfoKey]['layer'];\n        return layer;\n      });\n      const minLayer = Math.min.apply(Math, layers);\n      if (!isNaN(minLayer)) {\n        layer = minLayer;\n      }\n    }\n    return layer;\n  }\n  /**\n   * è·åä¸ä¸ä¸ªèç¹ï¼å é¤åï¼\n   */\n  public getNextNodeId(treeNodesData: any[], hierarchyInfoKey: string, currentId: string): string {\n\n    // å½åèç¹ä¿¡æ¯\n    const currentNodeData = treeNodesData.find((itemData: any) => {\n      return itemData['id'] === currentId;\n    });\n    const currentLayer = currentNodeData[hierarchyInfoKey]['layer'];\n\n    // ç¶èç¹ä¿¡æ¯\n    const fLayer = currentLayer - 1;\n    const fParentElement = currentNodeData[hierarchyInfoKey]['parentElement'];\n\n    // æ¥æ¾åå¼èç¹\n    const siblingtreeNodesData = this.getChildNodesData(treeNodesData, hierarchyInfoKey, fLayer, fParentElement);\n\n    // å¦ææ²¡æåå¼èç¹ï¼åä¸æ¥æ¾\n    if (siblingtreeNodesData.length === 1) {\n      const parentData = treeNodesData.find((itemData: any) => {\n        return itemData['id'] === fParentElement;\n      });\n\n      // å­å¨ç¶èç¹ï¼åè®¾ç½®ç¶èç¹ï¼\n      // ä¸å­å¨ç¶èç¹ï¼åè®¾ç½®ç¬¬ä¸ä¸ªæ ¹èç¹ã\n      if (!parentData) {\n        return this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n      }\n      return parentData['id'];\n    } else {\n      return this.getNextSiblingNodeId(siblingtreeNodesData, currentId);\n    }\n  }\n\n  /**\n   * è·åä¸ä¸ªåå¼èç¹çid\n   */\n  public getNextSiblingNodeId(siblingtreeNodesData: any[], currentId: string): string {\n    if (siblingtreeNodesData.length <= 1) {\n      return '';\n    }\n\n    const currentIndex = siblingtreeNodesData.findIndex((itemData: any) => {\n      return itemData['id'] === currentId;\n    });\n\n    // æåä¸è¡ä¸ç§»ä¸è¡ï¼å¶ä»ä¸ç§»ä¸è¡\n    let nextIndex = -1;\n    if (currentIndex === siblingtreeNodesData.length - 1) {\n      nextIndex = currentIndex - 1;\n    } else {\n      nextIndex = currentIndex + 1;\n    }\n\n    return siblingtreeNodesData[nextIndex]['id'];\n  }\n\n  /**\n   * è·åä¸çº§èç¹çBindingObjectséå\n   */\n  public getChildNodesData(treeNodesData: any[], hierarchyInfoKey: string, fLayer: number, fParentElement: string): any[] {\n    const childtreeNodesData = treeNodesData.filter((itemData) => {\n      const layer = itemData[hierarchyInfoKey]['layer'];\n      const parentElement = itemData[hierarchyInfoKey]['parentElement'];\n      return (layer === fLayer + 1) && fParentElement == parentElement;\n    });\n    return childtreeNodesData;\n  }\n\n  /**\n   * è·åidè·åèç¹æ°æ®\n   */\n  public getNodeDataById(treeNodesData: any[], id: string): any {\n    const nodeData = treeNodesData.find((itemData: any) => {\n      return itemData['id'] === id;\n    });\n    return nodeData ? nodeData : null;\n  }\n}\n\nexport { ParentTreeNodeUtil };\n","import { BindingData, BindingList } from '@farris/devkit';\n\n/**\n * æ æ°æ®çå¸®å©ç±»\n */\nclass PathTreeNodeUtil {\n\n  /**\n   * éä¸­ç¬¬ä¸ä¸ªæ ¹èç¹\n   */\n  public selectFirstRootNode(bindingData: BindingData, hierarchyInfoKey: string) {\n\n    const treeNodesData = bindingData.list.toJSON();\n    const firstRootNodeId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    this.selectedNode(bindingData, hierarchyInfoKey, firstRootNodeId);\n  }\n  public selectNodeByBindingList(bindingList: BindingList, hierarchyInfoKey: string, selectedNodeId: string): void {\n    const treeNodesData = bindingList.toJSON();\n    // å¦æè¦è®¾ç½®çèç¹ä¸å­å¨ï¼åè®¾ç½®ç¬¬1ä¸ªæ ¹èç¹\n    const selectedNodeData = this.getNodeDataById(treeNodesData, selectedNodeId);\n    let currentId = selectedNodeId;\n    if (!selectedNodeData) {\n      currentId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    }\n\n    setTimeout(() => {\n      bindingList.setCurrentId(currentId, true, true);\n    }, 0);\n  }\n  /**\n   * éä¸­èç¹\n   */\n  public selectedNode(bindingData: BindingData, hierarchyInfoKey: string, selectedNodeId: string): void {\n    const treeNodesData = bindingData.list.toJSON();\n    // å¦æè¦è®¾ç½®çèç¹ä¸å­å¨ï¼åè®¾ç½®ç¬¬1ä¸ªæ ¹èç¹\n    const selectedNodeData = this.getNodeDataById(treeNodesData, selectedNodeId);\n    let currentId = selectedNodeId;\n    if (!selectedNodeData) {\n      currentId = this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n    }\n    if (bindingData.rowSelectedEventSuspend === true) {\n      return;\n    }\n    setTimeout(() => {\n      bindingData.list.currentId = null;\n      bindingData.list.setCurrentId(currentId, true, true);\n    }, 0);\n  }\n\n  /**\n   * æ£æ¥æ¯å¦æå­èç¹\n   */\n  public hasChildNodes(treeNodesData: any[], hierarchyInfoKey: string, fid: string): boolean {\n    const fNodeData = this.getNodeDataById(treeNodesData, fid);\n    // const fLayer = fNodeData[hierarchyInfoKey]['layer'];\n    // const fPath  = fNodeData[hierarchyInfoKey]['path'];\n    const fIsDetail = fNodeData[hierarchyInfoKey]['isDetail'];\n\n    // éæç»èç¹ï¼è¿åtrue\n    if (fIsDetail === false) {\n      return true;\n    }\n    return false;\n    // const childNodesData = this.getChildNodesData(treeNodesData, hierarchyInfoKey, fLayer, fPath);\n    // return childNodesData.length > 0;\n  }\n\n  /**\n   * è·åæ ¹èç¹ï¼å¤ä¸ªæ ¹èç¹æ¶è·åç¬¬ä¸ä¸ªï¼\n   * @return æ¾ä¸å°æ¶è¿ånull\n   */\n  private getFirstNodeId(treeNodesData: any[], hierarchyInfoKey: string): string {\n    let rootData = treeNodesData.find((itemData: any) => {\n      const layer = itemData[hierarchyInfoKey]['layer'];\n      return layer === 1;\n    });\n    if (!rootData) {\n      const rootLayer = this.getRootLayer(treeNodesData, hierarchyInfoKey);\n      rootData = treeNodesData.find((itemData: any) => {\n        const layer = itemData[hierarchyInfoKey]['layer'];\n        return layer === rootLayer;\n      });\n    }\n    return rootData ? rootData['id'] : '';\n  }\n  private getRootLayer(treeNodesData: any[], hierarchyInfoKey: string) {\n    let layer = null;\n    if (treeNodesData && Array.isArray(treeNodesData)) {\n      const layers = treeNodesData.map(item => {\n        const layer = item[hierarchyInfoKey]['layer'];\n        return layer;\n      });\n      const minLayer = Math.min.apply(Math, layers);\n      if (!isNaN(minLayer)) {\n        layer = minLayer;\n      }\n    }\n    return layer;\n  }\n  /**\n   * è·åä¸ä¸ä¸ªèç¹ï¼å é¤åï¼\n   */\n  public getNextNodeId(treeNodesData: any[], hierarchyInfoKey: string, currentId: string): string {\n\n    // å½åèç¹ä¿¡æ¯\n    const currentNodeData = treeNodesData.find((itemData: any) => {\n      return itemData['id'] === currentId;\n    });\n    const currentPath = currentNodeData[hierarchyInfoKey]['path'];\n    const currentLayer = currentNodeData[hierarchyInfoKey]['layer'];\n\n    // ç¶èç¹ä¿¡æ¯\n    const fLayer = currentLayer - 1;\n    const fPath = currentPath.substring(0, currentPath.length - 4);\n\n    // æ¥æ¾åå¼èç¹\n    const siblingtreeNodesData = this.getChildNodesData(treeNodesData, hierarchyInfoKey, fLayer, fPath);\n\n    // å¦ææ²¡æåå¼èç¹ï¼åä¸æ¥æ¾\n    if (siblingtreeNodesData.length === 1) {\n      const parentData = treeNodesData.find((itemData: any) => {\n        return itemData[hierarchyInfoKey]['path'] === fPath;\n      });\n\n      // å­å¨ç¶èç¹ï¼åè®¾ç½®ç¶èç¹ï¼\n      // ä¸å­å¨ç¶èç¹ï¼åè®¾ç½®ç¬¬ä¸ä¸ªæ ¹èç¹ã\n      if (!parentData) {\n        return this.getFirstNodeId(treeNodesData, hierarchyInfoKey);\n      }\n      return parentData['id'];\n    } else {\n      return this.getNextSiblingNodeId(siblingtreeNodesData, currentId);\n    }\n  }\n\n  /**\n   * è·åä¸ä¸ªåå¼èç¹çid\n   */\n  public getNextSiblingNodeId(siblingtreeNodesData: any[], currentId: string): string {\n    if (siblingtreeNodesData.length <= 1) {\n      return '';\n    }\n\n    const currentIndex = siblingtreeNodesData.findIndex((itemData: any) => {\n      return itemData['id'] === currentId;\n    });\n\n    // æåä¸è¡ä¸ç§»ä¸è¡ï¼å¶ä»ä¸ç§»ä¸è¡\n    let nextIndex = -1;\n    if (currentIndex === siblingtreeNodesData.length - 1) {\n      nextIndex = currentIndex - 1;\n    } else {\n      nextIndex = currentIndex + 1;\n    }\n\n    return siblingtreeNodesData[nextIndex]['id'];\n  }\n\n  /**\n   * è·åä¸çº§èç¹çBindingObjectséå\n   */\n  public getChildNodesData(treeNodesData: any[], hierarchyInfoKey: string, fLayer: number, fPath: string): any[] {\n    const childtreeNodesData = treeNodesData.filter((itemData) => {\n      const layer = itemData[hierarchyInfoKey]['layer'];\n      const path = itemData[hierarchyInfoKey]['path'];\n      return (layer === fLayer + 1) && path.startsWith(fPath);\n    });\n    return childtreeNodesData;\n  }\n\n  /**\n   * è·åidè·åèç¹æ°æ®\n   */\n  public getNodeDataById(treeNodesData: any[], id: string): any {\n    const nodeData = treeNodesData.find((itemData: any) => {\n      return itemData['id'] === id;\n    });\n    return nodeData ? nodeData : null;\n  }\n}\n\nexport { PathTreeNodeUtil };\n","/*\n * @Author: aalizzwell \n * @Date: 2019-05-30 14:12:39 \n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-05-30 16:18:47\n */\nimport { ParentTreeNodeUtil } from './parent-tree.util';\nimport { PathTreeNodeUtil } from './path-tree.util';\n\nexport class TreeUtilFactory {\n  static getInstance(treeType: string) {\n    let util = null;\n    switch (treeType) {\n      case 'path':\n        util = new PathTreeNodeUtil();\n        break;\n      case 'parent':\n        util = new ParentTreeNodeUtil();\n        break;\n      default: break;\n    }\n    return util;\n  }\n}","import { HttpHeaders } from '@angular/common/http';\nimport { of, Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { Entity, FieldMetadataUtil, FrameContext, Repository } from '@farris/devkit';\nimport { ResponseInfo, BefRepository } from '@farris/bef';\n\n/**\n * ç¶å­æ ä»åº\n */\nclass ParentTreeRepository {\n\n  /**\n   * æ·»å åå¼èç¹\n   */\n  public addSibling(repository: BefRepository<Entity>, id: string): Observable<Entity> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSiblingUri = `${baseUri}/service/parenthierarchycreatesibling`;\n    const body = {\n      dataID: id,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSiblingUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const entity = repository.buildEntity(responseInfo.returnValue);\n        repository.entityCollection.addEntity(entity);\n        return entity;\n      })\n    );\n  }\n\n  /**\n   * æ·»å åå¼èç¹\n   */\n  public addChild(repository: BefRepository<Entity>, parentId: string) {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addChildUri = `${baseUri}/service/parenthierarchycreatechildlayer`;\n\n    const body = {\n      dataID: parentId,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addChildUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const entity = repository.buildEntity(responseInfo.returnValue);\n        repository.entityCollection.addEntity(entity);\n        return entity;\n      })\n    );\n  }\n\n  /**\n   * æ·»å å­è¡¨åå¼èç¹\n   */\n  public addSubSibling(repository: BefRepository<Entity>, nodes: Array<string>, ids: Array<string>): Observable<Entity> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSubSiblingUri = `${baseUri}/service/childnodeparenthierarchycreatesibling`;\n    const body = {\n      nodes: nodes,\n      ids: ids,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSubSiblingUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        let path = this.getPaths(nodes, ids);\n        const entity = repository.entityManager.appendEntityByPath(path, responseInfo.returnValue)\n        return entity;\n      })\n    );\n  }\n\n  /**\n   * æ·»å å­è¡¨å­èç¹\n   */\n  public addSubChild(repository: BefRepository<Entity>, nodes: Array<string>, ids: Array<string>) {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSubChildUri = `${baseUri}/service/childnodeparenthierarchycreatechildlayer`;\n\n    const body = {\n      nodes: nodes,\n      ids: ids,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSubChildUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        let paths = this.getPaths(nodes, ids);\n        const entity = repository.entityManager.appendEntityByPath(paths, responseInfo.returnValue);\n        return entity;\n      })\n    );\n  }\n\n  private getPaths(nodes: string[], ids: string[]) {\n    let paths = '';\n    if (nodes && nodes.length > 0 && ids && ids.length > 0) {\n      for (let i = 0; i < ids.length; i++) {\n        if (nodes[i]) {\n          paths = paths + `/${ids[i]}`;\n          paths = paths + `/${nodes[i]}s`;\n        }\n      }\n    }\n    return paths;\n  }\n\n  /**\n   * å è½½ç¶èç¹\n   */\n  // tslint:disable-next-line: max-line-length\n  public loadByParentId(repository: BefRepository<Entity>, hierarchyInfoKey: string, parentId: string, filters: any[], sorts: any[], frozenCurrentRow: boolean = false, pagination?: { pageSize: number, pageIndex: number }, frameContext?: FrameContext, reload: boolean = false): Observable<Entity[]> {\n    const localEntities = this.getChildren(repository, hierarchyInfoKey, parentId);\n    if (localEntities && localEntities.length > 0 && !reload) {\n      return of(localEntities);\n    }\n    const restService = repository.restService;\n    const parentHierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, parentId);\n    const originalHierarchyInfoKey = this.getOriginalHierarchyInfoKey(repository, hierarchyInfoKey);\n    const filtersWithParent = this.buildFiltersWithParent(originalHierarchyInfoKey, parentHierarchyInfo, filters);\n    const isUsePagination = pagination && pagination.pageSize > 0 || false;\n    // ç»ç»EntityFilter\n    const entityFilter = {\n      FilterConditions: filtersWithParent,\n      SortConditions: sorts,\n      IsUsePagination: isUsePagination,\n      Pagination: { PageIndex: pagination && pagination.pageIndex || 0, PageSize: pagination && pagination.pageSize || 0, PageCount: 0, TotalCount: 0 }\n    };\n    const requestInfo = restService.buildRequestInfo();\n    return restService.extendQuery(entityFilter, requestInfo).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const paginationInfo = this.getPaginationInfo(responseInfo);\n        if (parentId) {\n          if (paginationInfo && paginationInfo.pageSize !== 0 && frameContext) {\n            frameContext.params.set(`_NODE_${parentId}_PAGINATION_INFO_`, paginationInfo);\n          }\n        } else {\n          if (paginationInfo && paginationInfo.pageSize !== 0 && frameContext) {\n            frameContext.repository.entityCollection.updatePaginationInfoByPath('/', paginationInfo);\n          }\n        }\n        // åæ¸ç©ºä¸çº§å®ä½\n        this.clearDescendantEntities(repository, hierarchyInfoKey, parentHierarchyInfo, frozenCurrentRow);\n        // è¿½å ä¸çº§å®ä½\n        const listData = responseInfo.returnValue.result;\n        const entities = repository.buildEntities(listData);\n        if (frozenCurrentRow) {\n          repository.entityCollection.addData(entities);\n        } else {\n          repository.entityCollection.addEntities(entities);\n        }\n        return entities;\n      })\n    );\n  }\n  // tslint:disable-next-line: max-line-length\n  public loadFullTree(repository: BefRepository<Entity>, hierarchyInfoKey: string, parentId: string, propertyName: string, fullTreeType: string, loadType: string, filters?: any[], context?: any): Observable<Entity[]> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const queryUrl = `${baseUri}/service/parentidfulltreequery`;\n    const parentHierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, parentId);\n    const entityFilter = this.buildEntityFilter(filters, null, 0, 0);\n\n    const body = {\n      dataId: parentId || '',\n      isUsePagination: false,\n      virtualPropertyName: propertyName,\n      pagination: {},\n      fullTreeType,\n      loadType,\n      filter: entityFilter,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    return restService.invoke(queryUrl, 'PUT', null, options).pipe(\n      tap((responseInfo: ResponseInfo) => {\n        // ä¿å­å±å¼çèç¹\n        if (responseInfo.returnValue && responseInfo.returnValue.selectedRowId && context && context.frameContext) {\n          const frameContext = context.frameContext as FrameContext;\n          const virtualRootFrameContext = frameContext && frameContext.getVirtualRootFrameContext() || null;\n          if (virtualRootFrameContext) {\n            const list = responseInfo.returnValue.result as any[];\n            const selectedRowId = responseInfo.returnValue.selectedRowId;\n            // ä»é¡¶å±å¼å§è®¡ç®ææéè¦å±å¼çèç¹\n            const leafNodeInfo = list.find(item => item[repository.primaryKey] === selectedRowId);\n            const hierarchyInfo = leafNodeInfo[hierarchyInfoKey] as { isDetail: boolean, layer: number, parentElement: string };\n            const ids = this.getAllParentIds(hierarchyInfo, list, hierarchyInfoKey, repository);\n            virtualRootFrameContext.params.set('_DEVKIT_expandRowIds', ids.join(','));\n            virtualRootFrameContext.params.set('_DEVKIT_selectedRowId', selectedRowId);\n            virtualRootFrameContext.uiState.setPropertyValue('__DEVKIT__selectedRow', selectedRowId);\n          }\n        }\n      }),\n      map((responseInfo: ResponseInfo) => {\n        const frozenCurrentRow = context && context.frozenCurrentRow || false;\n        // åæ¸ç©ºä¸çº§å®ä½\n        this.clearDescendantEntities(repository, hierarchyInfoKey, parentHierarchyInfo, frozenCurrentRow);\n        // è¿½å ä¸çº§å®ä½\n        const listData = responseInfo.returnValue.result;\n        const entities = repository.buildEntities(listData);\n        if (frozenCurrentRow) {\n          repository.entityCollection.addData(entities);\n        } else {\n          repository.entityCollection.addEntities(entities);\n        }\n        return entities;\n      })\n    );\n  }\n  /**\n   * æå¥å¯¹ç¶èç¹çè¿æ»¤\n   */\n  public buildFiltersWithParent(originalHierarchyInfoKey: string, parentHierarchyInfo: any, filterArray: any[]): any {\n    const relationType = filterArray && filterArray.length >= 1 ? 1 : 0;\n    const parentLayer = parentHierarchyInfo ? parentHierarchyInfo['layer'] : 0;\n    const parentElement = parentHierarchyInfo ? parentHierarchyInfo['id'] : '';\n\n    const parentFilterArray = [\n      {\n        \"FilterField\": `${originalHierarchyInfoKey}.Layer`,\n        \"Value\": parentLayer + 1,\n        \"Lbracket\": null,\n        \"Rbracket\": null,\n        \"Relation\": 1,\n        \"Expresstype\": 0,\n        \"Compare\": 0\n      }\n    ];\n    if (parentElement) {\n      parentFilterArray.push(\n        {\n          \"FilterField\": `${originalHierarchyInfoKey}.ParentElement`,\n          \"Value\": parentElement,\n          \"Lbracket\": null,\n          \"Rbracket\": null,\n          \"Relation\": relationType,\n          \"Expresstype\": 0,\n          \"Compare\": 0\n        }\n      );\n    } else {\n      parentFilterArray[0].Relation = relationType;\n    }\n    return parentFilterArray.concat(filterArray);\n  }\n  public buildEntityFilter(filter: any[], sort: any[], pageSize: number, pageIndex: number) {\n\n    // @todoï¼ä¸´æ¶å¼å®¹èä»£ç ï¼éä½æ¹å¨å¸¦æ¥çé£é©\n    if (!filter && !sort && !pageSize && !pageIndex) {\n      return null;\n    }\n    if (!filter) {\n      filter = [];\n    }\n    if (!sort) {\n      sort = [];\n    }\n    // çº æ­£æåä¸ä¸ªè¿æ»¤æ¡ä»¶çRelation\n    if (filter && filter.length > 0) {\n      filter[filter.length - 1].Relation = 0;\n    }\n    const entityFilter = {\n      FilterConditions: filter,\n      SortConditions: sort,\n      IsUsePagination: pageSize === 0 ? false : true,\n      Pagination: {\n        PageIndex: pageIndex,\n        PageSize: pageSize,\n        PageCount: 0,\n        TotalCount: 0\n      }\n    };\n    return entityFilter;\n  }\n  /**\n   * æ¸ç©ºåä»£å®ä½\n   * @description parentHierarchyInfoä¸­layerä¸ºè¦æ¸ç©ºåä»£èç¹çlayerï¼ä½éé¢çparentElementä¸æ¯ç¶çº§çidï¼èæ¯è¦æ¸ç©ºåä»£èç¹çid\n   */\n  public clearDescendantEntities(repository: BefRepository<Entity>, hierarchyInfokey: string, parentHierarchyInfo: any, frozenCurrentRow: boolean = false): void {\n    // æ¸ç©ºæ ¹èç¹\n    if (!parentHierarchyInfo) {\n      repository.entityCollection.clear();\n      return;\n    }\n    const nodes = this.getChildNodes(repository, hierarchyInfokey, parentHierarchyInfo);\n    if (frozenCurrentRow) {\n      repository.entityCollection.removeEntities((entity: Entity) => {\n        const id = entity[entity.primaryKey];\n        return nodes.includes(id);\n      });\n    } else {\n      repository.entityCollection.removeData((entity: Entity) => {\n        const id = entity[entity.primaryKey];\n        return nodes.includes(id);\n      });\n    }\n\n  }\n  /**\n   * è·åæä¸ªèç¹çææå­èç¹\n   * @param repository repository\n   * @param hierarchyInfokey hierarchyInfokey\n   * @param parentHierarchyInfo parentHierarchyInfo\n   */\n  private getChildNodes(repository: BefRepository<Entity>, hierarchyInfokey: string, parentHierarchyInfo: any) {\n    const fparentElement = parentHierarchyInfo.id;\n    const flayer = parentHierarchyInfo.layer;\n    let nodes = [];\n    repository.entityCollection.getAllEntities().forEach(entity => {\n      const hierarchyInfo = entity[hierarchyInfokey];\n      const parentElement = hierarchyInfo.parentElement;\n      const layer = hierarchyInfo.layer;\n      const result = layer >= (flayer + 1) && parentElement === fparentElement;\n      if (result) {\n        const id = entity[entity.primaryKey];\n        nodes.push(id);\n        const childHierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfokey, id);\n        const childs = this.getChildNodes(repository, hierarchyInfokey, childHierarchyInfo);\n        if (childs && childs.length > 0) {\n          nodes = nodes.concat(childs);\n        }\n      }\n    });\n    return nodes;\n  }\n  /**\n   * è·åå®ä½çåçº§ä¿¡æ¯\n   */\n  public getHierarchyInfoById(repository: BefRepository<Entity>, hierarchyInfokey: string, id: string): any {\n    if (!id) {\n      return null;\n    }\n    const entity: Entity = repository.entityCollection.getEntityById(id);\n    const hierarchyInfoEntity: Entity = entity[hierarchyInfokey];\n    const result = hierarchyInfoEntity.toJSON();\n    result['id'] = id;\n    return result;\n  }\n  public getHierarchyInfo(entity: Entity, hierarchyInfokey: string): { parentElement: string, layer: number, isDetail: boolean } {\n    return entity[hierarchyInfokey];\n  }\n  /**\n   * è·ååçº§ç çåå§çå­æ®µå\n   */\n  public getOriginalHierarchyInfoKey(repository: BefRepository<Entity>, hierarchyInfokey: string): string {\n    const ngObjects = FieldMetadataUtil.getNgObjects(repository.entityType);\n    const hierarchyInfoNgObject = ngObjects[hierarchyInfokey];\n    return hierarchyInfoNgObject.originalDataField as string;\n  }\n  private getPaginationInfo(responseInfo: ResponseInfo) {\n    return responseInfo && responseInfo.returnValue && responseInfo.returnValue.pagination || null;\n  }\n  private findParent(hierarchyInfo: { isDetail: boolean, layer: number, parentElement: string }, list: any[], hierarchyInfoKey: string) {\n    return list.find(item => {\n      const currentHierarchyInfo = item[hierarchyInfoKey] as { isDetail: boolean, layer: number, parentElement: string };\n      return currentHierarchyInfo.layer === hierarchyInfo.layer - 1 && hierarchyInfo.parentElement === currentHierarchyInfo.parentElement;\n    });\n  }\n  private getAllParentIds(hierarchyInfo: { isDetail: boolean, layer: number, parentElement: string }, list: any[], hierarchyInfoKey: string, repository: Repository<any>) {\n    let item = this.findParent(hierarchyInfo, list, hierarchyInfoKey);\n    const ids = [];\n    while (item) {\n      ids.push(item[repository.primaryKey]);\n      item = this.findParent(item[hierarchyInfoKey], list, hierarchyInfoKey);\n    }\n    return ids;\n  }\n  /**\n   * æ¥æ¾èç¹ä¸ææå­çº§ï¼ç¬¬ä¸çº§ï¼\n   * @param repository repository\n   * @param hierarchyInfoKey åçº§ç å­æ®µ\n   * @param id id\n   * @returns \n   */\n  private getChildren(repository: BefRepository<Entity>, hierarchyInfoKey: string, id: string): Entity[] {\n    const hierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, id);\n    if (!hierarchyInfo) {\n      return null;\n    }\n    const layer = hierarchyInfo.layer;\n    const parentElement = hierarchyInfo.parentElement;\n    const entities: Entity[] = repository.entityCollection.getEntities((entity: Entity) => {\n      const hierarchyInfo = this.getHierarchyInfo(entity, hierarchyInfoKey);\n      const matched = hierarchyInfo.layer === layer + 1 && (hierarchyInfo.parentElement === parentElement || !parentElement && !hierarchyInfo.parentElement);\n      if (matched) {\n        return entity;\n      } else {\n        return null;\n      }\n    });\n    return entities;\n  }\n}\n\nexport { ParentTreeRepository };\n","import { HttpHeaders } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { Entity, FieldMetadataUtil, FrameContext, Repository } from '@farris/devkit';\nimport { ResponseInfo, BefRepository } from '@farris/bef';\n\n/**\n * è·¯å¾æ ä»åº\n */\nclass PathTreeRepository {\n\n  /**\n   * æ·»å åå¼èç¹\n   */\n  public addSibling(repository: BefRepository<Entity>, id: string): Observable<Entity> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSiblingUri = `${baseUri}/service/pathhierarchycreatesibling`;\n    const body = {\n      dataID: id,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSiblingUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const entity = repository.buildEntity(responseInfo.returnValue);\n        repository.entityCollection.addEntity(entity);\n        return entity;\n      })\n    );\n  }\n\n  /**\n   * æ·»å åå¼èç¹\n   */\n  public addChild(repository: BefRepository<Entity>, parentId: string) {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addChildUri = `${baseUri}/service/pathhierarchycreatechildlayer`;\n\n    const body = {\n      dataID: parentId,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addChildUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const entity = repository.buildEntity(responseInfo.returnValue);\n        repository.entityCollection.addEntity(entity);\n        return entity;\n      })\n    );\n  }\n\n  /**\n   * æ·»å å­è¡¨åå¼èç¹\n   */\n  public addSubSibling(repository: BefRepository<Entity>, nodes: Array<string>, ids: Array<string>): Observable<Entity> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSubSiblingUri = `${baseUri}/service/childnodepathhierarchycreatesibling`;\n    const body = {\n      nodes: nodes,\n      ids: ids,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSubSiblingUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        let path = this.getPaths(nodes, ids);\n        const entity = repository.entityManager.appendEntityByPath(path, responseInfo.returnValue)\n        return entity;\n      })\n    );\n  }\n\n  /**\n  * æ·»å å­è¡¨å­èç¹\n  */\n  public addSubChild(repository: BefRepository<Entity>, nodes: Array<string>, ids: Array<string>) {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const addSubChildUri = `${baseUri}/service/childnodepathhierarchycreatechildlayer`;\n\n    const body = {\n      nodes: nodes,\n      ids: ids,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json' }),\n      body: body\n    };\n    return restService.invoke(addSubChildUri, 'PUT', null, options).pipe(\n      map((responseInfo: ResponseInfo) => {\n        let path = this.getPaths(nodes, ids);\n        const entity = repository.entityManager.appendEntityByPath(path, responseInfo.returnValue)\n        return entity;\n      })\n    );\n  }\n\n  private getPaths(nodes: string[], ids: string[]) {\n    let paths = '';\n    if (nodes && nodes.length > 0 && ids && ids.length > 0) {\n      for (let i = 0; i < ids.length; i++) {\n        if (nodes[i]) {\n          paths = paths + `/${ids[i]}`;\n          paths = paths + `/${nodes[i]}s`;\n        }\n      }\n    }\n    return paths;\n  }\n\n  /**\n   * å è½½ç¶èç¹\n   */\n  // tslint:disable-next-line: max-line-length\n  public loadByParentId(repository: BefRepository<Entity>, hierarchyInfoKey: string, parentId: string, filters: any[], sorts: any[], frozenCurrentRow: boolean = false, pagination?: { pageSize: number, pageIndex: number }, frameContext?: FrameContext, reload: boolean = false): Observable<Entity[]> {\n    const localEntities = this.getChildren(repository, hierarchyInfoKey, parentId);\n    if (localEntities && localEntities.length > 0 && !reload) {\n      return of(localEntities);\n    }\n    const restService = repository.restService;\n    const parentHierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, parentId);\n    const originalHierarchyInfoKey = this.getOriginalHierarchyInfoKey(repository, hierarchyInfoKey);\n    const filtersWithParent = this.buildFiltersWithParent(originalHierarchyInfoKey, parentHierarchyInfo, filters);\n    const isUsePagination = pagination && pagination.pageSize > 0 || false;\n    // ç»ç»EntityFilter\n    const entityFilter = {\n      FilterConditions: filtersWithParent,\n      SortConditions: sorts,\n      IsUsePagination: isUsePagination,\n      Pagination: { PageIndex: pagination && pagination.pageIndex || 0, PageSize: pagination && pagination.pageSize || 0, PageCount: 0, TotalCount: 0 }\n    };\n    const requestInfo = restService.buildRequestInfo();\n    return restService.extendQuery(entityFilter, requestInfo).pipe(\n      map((responseInfo: ResponseInfo) => {\n        const paginationInfo = this.getPaginationInfo(responseInfo);\n        if (parentId) {\n          if (paginationInfo && paginationInfo.pageSize !== 0 && frameContext) {\n            frameContext.params.set(`_NODE_${parentId}_PAGINATION_INFO_`, paginationInfo);\n          }\n        } else {\n          if (paginationInfo && paginationInfo.pageSize !== 0 && frameContext) {\n            frameContext.repository.entityCollection.updatePaginationInfoByPath('/', paginationInfo);\n          }\n        }\n        // åæ¸ç©ºä¸çº§å®ä½\n        this.clearDescendantEntities(repository, hierarchyInfoKey, parentHierarchyInfo, frozenCurrentRow);\n        // è¿½å ä¸çº§å®ä½\n        const listData = responseInfo.returnValue.result;\n        const entities = repository.buildEntities(listData);\n        if (frozenCurrentRow) {\n          repository.entityCollection.addData(entities);\n        } else {\n          repository.entityCollection.addEntities(entities);\n        }\n\n        return entities;\n      })\n    );\n  }\n  // tslint:disable-next-line: max-line-length\n  public loadFullTree(repository: BefRepository<Entity>, hierarchyInfoKey: string, parentId: string, propertyName: string, fullTreeType: string, loadType: string, filters?: any[], context?: any): Observable<Entity[]> {\n    const restService = repository.restService;\n    const baseUri = restService.baseUri;\n    const queryUrl = `${baseUri}/service/parentidfulltreequery`;\n    const pathHierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, parentId);\n    const entityFilter = this.buildEntityFilter(filters, null, 0, 0);\n    const body = {\n      dataId: parentId || '',\n      isUsePagination: false,\n      virtualPropertyName: propertyName,\n      pagination: {},\n      fullTreeType,\n      loadType,\n      filter: entityFilter,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    return restService.invoke(queryUrl, 'PUT', null, options).pipe(\n      tap((responseInfo: ResponseInfo) => {\n        // ä¿å­å±å¼çèç¹\n        if (responseInfo.returnValue && responseInfo.returnValue.selectedRowId && context && context.frameContext) {\n          const frameContext = context.frameContext as FrameContext;\n          const virtualRootFrameContext = frameContext && frameContext.getVirtualRootFrameContext() || null;\n          if (virtualRootFrameContext) {\n            const list = responseInfo.returnValue.result as any[];\n            const selectedRowId = responseInfo.returnValue.selectedRowId;\n            // ä»é¡¶å±å¼å§è®¡ç®ææéè¦å±å¼çèç¹\n            const leafNodeInfo = list.find(item => item[repository.primaryKey] === selectedRowId);\n            const hierarchyInfo = leafNodeInfo[hierarchyInfoKey] as { isDetail: boolean, layer: number, path: string };\n            const ids = this.getAllParentIds(hierarchyInfo, list, hierarchyInfoKey, repository);\n            virtualRootFrameContext.params.set('_DEVKIT_expandRowIds', ids.join(','));\n            virtualRootFrameContext.params.set('_DEVKIT_selectedRowId', selectedRowId);\n            virtualRootFrameContext.uiState.setPropertyValue('__DEVKIT__selectedRow', selectedRowId);\n          }\n        }\n      }),\n      map((responseInfo: ResponseInfo) => {\n        const frozenCurrentRow: boolean = context && context.frozenCurrentRow || false;\n        // åæ¸ç©ºä¸çº§å®ä½\n        this.clearDescendantEntities(repository, hierarchyInfoKey, pathHierarchyInfo, frozenCurrentRow);\n        // è¿½å ä¸çº§å®ä½\n        const listData = responseInfo.returnValue.result;\n        const entities = repository.buildEntities(listData);\n        if (frozenCurrentRow) {\n          repository.entityCollection.addData(entities);\n        } else {\n          repository.entityCollection.addEntities(entities);\n        }\n        return entities;\n      })\n    );\n  }\n  /**\n   * æå¥å¯¹ç¶èç¹çè¿æ»¤\n   */\n  public buildFiltersWithParent(originalHierarchyInfoKey: string, parentHierarchyInfo: any, filterArray: any[]): any {\n    const relationType = filterArray && filterArray.length >= 1 ? 1 : 0;\n\n    const parentLayer = parentHierarchyInfo ? parentHierarchyInfo['layer'] : 0;\n    const parentFilterArray = [\n      {\n        \"FilterField\": `${originalHierarchyInfoKey}.Layer`,\n        \"Value\": parentLayer + 1,\n        \"Lbracket\": null,\n        \"Rbracket\": null,\n        \"Relation\": 1,\n        \"Expresstype\": 0,\n        \"Compare\": 0\n      }\n    ];\n\n    // ç¶è·¯å¾è¿æ»¤ï¼å¦æä¸ºç©ºï¼åä¸æ·»å ï¼å¼å®¹oracleåæ°ï¼\n    const parentPath = parentHierarchyInfo ? parentHierarchyInfo['path'] : '';\n    if (parentPath) {\n      parentFilterArray.push({\n        \"FilterField\": `${originalHierarchyInfoKey}.Path`,\n        \"Value\": parentPath,\n        \"Lbracket\": null,\n        \"Rbracket\": null,\n        \"Relation\": relationType,\n        \"Expresstype\": 0,\n        \"Compare\": 7\n      });\n    } else {\n      parentFilterArray[0].Relation = relationType;\n    }\n\n    return parentFilterArray.concat(filterArray);\n  }\n  public buildEntityFilter(filter: any[], sort: any[], pageSize: number, pageIndex: number) {\n\n    // @todoï¼ä¸´æ¶å¼å®¹èä»£ç ï¼éä½æ¹å¨å¸¦æ¥çé£é©\n    if (!filter && !sort && !pageSize && !pageIndex) {\n      return null;\n    }\n    if (!filter) {\n      filter = [];\n    }\n    if (!sort) {\n      sort = [];\n    }\n    // çº æ­£æåä¸ä¸ªè¿æ»¤æ¡ä»¶çRelation\n    if (filter && filter.length > 0) {\n      filter[filter.length - 1].Relation = 0;\n    }\n    const entityFilter = {\n      FilterConditions: filter,\n      SortConditions: sort,\n      IsUsePagination: pageSize === 0 ? false : true,\n      Pagination: {\n        PageIndex: pageIndex,\n        PageSize: pageSize,\n        PageCount: 0,\n        TotalCount: 0\n      }\n    };\n    return entityFilter;\n  }\n  /**\n   * æ¸ç©ºåä»£å®ä½\n   */\n  public clearDescendantEntities(repository: BefRepository<Entity>, hierarchyInfokey: string, parentHierarchyInfo: any, frozenCurrentRow: boolean = false): void {\n\n    // æ¸ç©ºæ ¹èç¹\n    if (!parentHierarchyInfo) {\n      repository.entityCollection.clear();\n      return;\n    }\n    const fPath = parentHierarchyInfo.path;\n    const fLayer = parentHierarchyInfo.layer;\n    if (frozenCurrentRow) {\n      repository.entityCollection.removeData((entity: Entity) => {\n        const hierarchyInfo = entity[hierarchyInfokey];\n        const path = hierarchyInfo.path;\n        const layer = hierarchyInfo.layer;\n        return layer > fLayer && path.startsWith(fPath);\n      });\n    } else {\n      repository.entityCollection.removeEntities((entity: Entity) => {\n        const hierarchyInfo = entity[hierarchyInfokey];\n        const path = hierarchyInfo.path;\n        const layer = hierarchyInfo.layer;\n        return layer > fLayer && path.startsWith(fPath);\n      });\n    }\n\n  }\n\n  /**\n   * è·åå®ä½çåçº§ä¿¡æ¯\n   */\n  public getHierarchyInfoById(repository: BefRepository<Entity>, hierarchyInfokey: string, id: string): any {\n    if (!id) {\n      return null;\n    }\n    const entity: Entity = repository.entityCollection.getEntityById(id);\n    const hierarchyInfoEntity: Entity = entity[hierarchyInfokey];\n    return hierarchyInfoEntity.toJSON();\n  }\n\n  /**\n   * è·ååçº§ç çåå§çå­æ®µå\n   */\n  public getOriginalHierarchyInfoKey(repository: BefRepository<Entity>, hierarchyInfokey: string): string {\n    const ngObjects = FieldMetadataUtil.getNgObjects(repository.entityType);\n    const hierarchyInfoNgObject = ngObjects[hierarchyInfokey];\n    return hierarchyInfoNgObject.originalDataField as string;\n  }\n  private getPaginationInfo(responseInfo: ResponseInfo) {\n    return responseInfo && responseInfo.returnValue && responseInfo.returnValue.pagination || null;\n  }\n  private findParent(hierarchyInfo: { isDetail: boolean, layer: number, path: string }, list: any[], hierarchyInfoKey: string) {\n    return list.find(item => {\n      const currentHierarchyInfo = item[hierarchyInfoKey] as { isDetail: boolean, layer: number, path: string };\n      return currentHierarchyInfo.layer === hierarchyInfo.layer - 1 && hierarchyInfo.path.startsWith(currentHierarchyInfo.path);\n    });\n  }\n  private getAllParentIds(hierarchyInfo: { isDetail: boolean, layer: number, path: string }, list: any[], hierarchyInfoKey: string, repository: Repository<any>) {\n    let item = this.findParent(hierarchyInfo, list, hierarchyInfoKey);\n    const ids = [];\n    while (item) {\n      ids.push(item[repository.primaryKey]);\n      item = this.findParent(item[hierarchyInfoKey], list, hierarchyInfoKey);\n    }\n    return ids;\n  }\n  private getHierarchyInfo(entity: Entity, hierarchyInfoKey: string): { path: string, layer: number, isDetail: boolean } {\n    return entity[hierarchyInfoKey];\n  }\n  /**\n   * æ¥æ¾èç¹ä¸ææå­çº§ï¼ç¬¬ä¸çº§ï¼\n   * @param repository repository\n   * @param hierarchyInfoKey åçº§ç å­æ®µ\n   * @param id id\n   * @returns \n   */\n  private getChildren(repository: BefRepository<Entity>, hierarchyInfoKey: string, id: string): Entity[] {\n    const hierarchyInfo = this.getHierarchyInfoById(repository, hierarchyInfoKey, id);\n    if (!hierarchyInfo) {\n      return null;\n    }\n    const layer = hierarchyInfo.layer;\n    const path = hierarchyInfo.path;\n    const entities: Entity[] = repository.entityCollection.getEntities((entity: Entity) => {\n      const hierarchyInfo = this.getHierarchyInfo(entity, hierarchyInfoKey);\n      const matched = hierarchyInfo.layer === layer + 1 && hierarchyInfo.path.startsWith(path);\n      if (matched) {\n        return entity;\n      } else {\n        return null;\n      }\n    });\n    return entities;\n  }\n}\n\nexport { PathTreeRepository };\n","import { ParentTreeRepository } from './parent-tree-repository';\nimport { PathTreeRepository } from './path-tree-repository';\n\nexport class TreeRepositoryFactory {\n    static getInstance(treeType: string){\n        let repository=null;\n        switch (treeType) {\n            case \"path\":\n                repository = new PathTreeRepository();\n                break;\n            case \"parent\":\n                repository = new ParentTreeRepository();\n                break;\n            default: break;\n        }\n        return repository;\n    }\n}","import { Injectable, Optional } from '@angular/core';\nimport { Observable, of, empty, EMPTY } from 'rxjs';\nimport { tap, switchMap, concatMap } from 'rxjs/operators';\n\nimport { Entity, FrameContext, FieldMetadataUtil, NgFieldProperty } from '@farris/devkit';\nimport { BefRepository, BefRepositoryUtil } from '@farris/bef';\n\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\n\nimport { BaseDataService } from './base-data.service';\nimport { EditStateUtil } from './utils/index';\nimport { TreeUtilFactory } from './tree-table/util/tree-util-factory';\nimport { TreeRepositoryFactory } from './tree-table/repository/tree-repository-factory';\n// tslint:disable: no-string-literal\n\n/**\n * æ æ°æ®æå¡\n */\n@Injectable()\nclass TreeDataService extends BaseDataService {\n\n  /**\n   * åçº§ä¿¡æ¯å­æ®µå\n   */\n  private get hierarchyInfoKey(): string {\n    return this.virtualRootFrameContext.getParam('hierarchyInfoKey');\n  }\n  private get virtualRootFrameContext() {\n    return this.frameContext.getVirtualRootFrameContext();\n  }\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    frameContext: FrameContext,\n    private messageService: FormMessageService,\n    private loadingService: FormLoadingService,\n    private notifyService: FormNotifyService,\n    private errorService: FormErrorService,\n    @Optional() private languageService: LanguageService\n  ) {\n    super(frameContext);\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * å è½½æ°æ®\n   */\n  public load(filters?: string, sorts?: string): Observable<Entity[]> {\n    const filtersArray = this.parseConditions(filters);\n    const sortsArray = this.parseConditions(sorts);\n    const correctSelectedNode = this.repository.entityCollection.count() === 0;\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const query$ = this.repository.getEntities(filtersArray, sortsArray, null, null);\n    return query$.pipe(\n      tap(\n        () => {\n\n          // çº æ­£éä¸­èç¹\n          if (correctSelectedNode === true) {\n            const hierarchyType = this.getHierarchyType();\n            const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n            if (treeNodeUtil !== null) {\n              treeNodeUtil.selectFirstRootNode(this.bindingData, this.hierarchyInfoKey);\n            }\n          }\n\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n\n  /**\n   * åå±å è½½æ°æ®\n   */\n  public loadByLevel(filters?: string, sorts?: string, frozenCurrentRow?: boolean | string): Observable<Entity[]> {\n    this.setLoadByLevelState(filters, sorts);\n    const filtersArray = this.parseConditions(filters);\n    const sortsArray = this.parseConditions(sorts);\n    // const parentId = this.bindingData.list.currentId;\n    const parentId = this.getIdToExpand();\n    const correctSelectedNode = this.repository.entityCollection.count() === 0;\n    if (frozenCurrentRow === undefined) {\n      frozenCurrentRow = false;\n    }\n    if (typeof frozenCurrentRow !== 'boolean') {\n      frozenCurrentRow = frozenCurrentRow === 'true' ? true : false;\n    }\n    const hierarchyType = this.getHierarchyType();\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n\n    if (repository === null) {\n      return empty();\n    }\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    // æé åé¡µä¿¡æ¯\n    const pagination = this.buildPaginationInfo(parentId);\n    const reload = this.frameContext.params.get('_RELOAD_CHILDREN_') || false;\n    const query$ = repository.loadByParentId(this.repository, this.hierarchyInfoKey, parentId, filtersArray, sortsArray, frozenCurrentRow, pagination, this.frameContext, reload);\n    return query$.pipe(\n      tap(\n        (entities: Entity[]) => {\n          this.frameContext.params.delete('_RELOAD_CHILDREN_');\n          // çº æ­£éä¸­èç¹\n          if (correctSelectedNode === true) {\n            const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n            if (treeNodeUtil !== null) {\n              treeNodeUtil.selectFirstRootNode(this.bindingData, this.hierarchyInfoKey);\n            }\n          }\n          const currentRowId = this.bindingData.list.currentItem.primaryKeyValue;\n          if (frozenCurrentRow) {\n            // å¦æä¸ä¸æ¬¡éä¸­è¡ä¸ºæ¬æ¬¡å è½½æ°æ®ä¸­çä¸æ¡ï¼ååºè¯¥éæ°éä¸­è¯¥è¡\n            const containsCurrentRow = entities.find(item => item.primaryValue === currentRowId);\n            if (containsCurrentRow) {\n              this.setCurrentId(currentRowId);\n            }\n            // åæ¥çå½åè¡ä¸å¨å·²ç»å è½½çæ°æ®ä¸­ï¼å¦å±å¼å°ç¬¬ä¸çº§ï¼å°ç¬¬ä¸çº§çæè¡è®¾ä¸ºå½åè¡ï¼å¨é¨æ¶èµ·ï¼å±å¼ç¬¬ä¸çº§\n            if (!this.repository.entityCollection.getEntityById(currentRowId)) {\n              const firstChildId = entities && Array.isArray(entities) && entities.length > 0 && entities[0].primaryValue || null;\n              if (firstChildId) {\n                this.setCurrentId(firstChildId);\n              }\n            }\n          }\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * å è½½å®æ´æ \n   * @param virtualPropertyName èæå­æ®µ\n   * @param fullTreeType æ¯å¦æ¯å®æ´æ å è½½ 0ï¼å®æ´æ  1ï¼é¨åæ \n   * @param loadType æ¯å¦åçº§å è½½ 0ï¼å¨é¨å è½½ 1ï¼åçº§å è½½\n   * @param filter è¿æ»¤æ¡ä»¶\n   * @param frozenCurrentRow å»ç»å½åè¡\n   */\n  public loadFullTree(virtualPropertyName: string, fullTreeType: string, loadType: string, filters: string, frozenCurrentRow?: boolean | string): Observable<Entity[]> {\n    if (typeof fullTreeType !== 'string') {\n      throw new Error('ArgumentError: fullTreeType ä¸è½ä¸ºç©ºä¸å¿é¡»ä¸ºå­ç¬¦ä¸²ã');\n    }\n    if (typeof loadType !== 'string') {\n      throw new Error('ArgumentError: loadType ä¸è½ä¸ºç©ºä¸å¿é¡»ä¸ºå­ç¬¦ä¸²ã');\n    }\n    if (frozenCurrentRow === undefined) {\n      frozenCurrentRow = false;\n    }\n    if (typeof frozenCurrentRow !== 'boolean') {\n      frozenCurrentRow = frozenCurrentRow === 'true' ? true : false;\n    }\n    const virtualRootFrameContext = this.virtualRootFrameContext;\n    // è¿åä¸æ¬¡è®¾ç½®çç»æé\n    virtualRootFrameContext.params.delete('_DEVKIT_expandRowIds');\n    virtualRootFrameContext.params.delete('_DEVKIT_selectedRowId');\n    virtualRootFrameContext.uiState.setPropertyValue('__DEVKIT__selectedRow', null);\n    const filtersArray = this.parseConditions(filters);\n    const parentId = this.getIdToExpand();\n    const correctSelectedNode = this.repository.entityCollection.count() === 0;\n    const hierarchyType = this.getHierarchyType();\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n\n    if (repository === null) {\n      return EMPTY;\n    }\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const context = {\n      frameContext: this.frameContext,\n      frozenCurrentRow\n    };\n    // tslint:disable-next-line: max-line-length\n    const query$ = repository.loadFullTree(this.repository, this.hierarchyInfoKey, parentId, virtualPropertyName, fullTreeType, loadType, filtersArray, context);\n    return query$.pipe(\n      tap(\n        (entities: Entity[]) => {\n          const selectedRowId = virtualRootFrameContext.params.get('_DEVKIT_selectedRowId');\n          // çº æ­£éä¸­èç¹\n          if (correctSelectedNode === true || !selectedRowId) {\n            const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n            if (treeNodeUtil !== null) {\n              treeNodeUtil.selectFirstRootNode(this.bindingData, this.hierarchyInfoKey);\n            }\n          }\n          const currentRowId = this.bindingData.list.currentItem.primaryKeyValue;\n          if (frozenCurrentRow) {\n            // å¦æä¸ä¸æ¬¡éä¸­è¡ä¸ºæ¬æ¬¡å è½½æ°æ®ä¸­çä¸æ¡ï¼ååºè¯¥éæ°éä¸­è¯¥è¡\n            const containsCurrentRow = entities.find(item => item.primaryValue === currentRowId);\n            if (containsCurrentRow) {\n              this.setCurrentId(currentRowId);\n            }\n            // åæ¥çå½åè¡ä¸å¨å·²ç»å è½½çæ°æ®ä¸­ï¼å¦å±å¼å°ç¬¬ä¸çº§ï¼å°ç¬¬ä¸çº§çæè¡è®¾ä¸ºå½åè¡ï¼å¨é¨æ¶èµ·ï¼å±å¼ç¬¬ä¸çº§\n            if (!this.repository.entityCollection.getEntityById(currentRowId) && entities && entities.length > 0) {\n              const firstChildId = entities && Array.isArray(entities) && entities.length > 0 && entities[0].primaryValue || null;\n              if (firstChildId) {\n                this.setCurrentId(firstChildId);\n              }\n            }\n          }\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.loadFailed, error);\n        }\n      )\n    );\n  }\n  /**\n   * è·åææ°å±å¼çèç¹\n   */\n  public getIdToExpand() {\n    const expandNodes = this.virtualRootFrameContext.getParam('TREE_LATEST_EXPANDED_ID') || [];\n    const idToExpand = expandNodes.pop();\n    this.virtualRootFrameContext.setParam('TREE_LATEST_EXPANDED_ID', expandNodes);\n    return idToExpand;\n  }\n\n  /**\n   * è®¾ç½®ææ°å±å¼çèç¹\n   */\n  public setIdToExpand(idToExpand: string): void {\n    const expandNodes = this.virtualRootFrameContext.getParam('TREE_LATEST_EXPANDED_ID') || [];\n    expandNodes.push(idToExpand);\n    this.virtualRootFrameContext.setParam('TREE_LATEST_EXPANDED_ID', expandNodes);\n  }\n\n  /**\n   * è§£æè¿æ»¤æ¡ä»¶\n   */\n  public parseConditions(conditions?: string): any[] {\n    const conditionsString = (!conditions || conditions === '') ? '[]' : conditions;\n    return JSON.parse(conditionsString);\n  }\n\n  /**\n   * æ°å¢åçº§\n   */\n  public addSibling(id: string): Observable<any> {\n\n    // è®¾è®¡æ¶idçè·åæ¹ä¸ºä»å½ä»¤åæ°ä¸è·åï¼ä½è®¾è®¡æ¶æ²¡æåæ°å¿å¡«æ£æ¥ï¼\n    // å¦ææå¼è¡¨åä¿å­äºï¼å³æ´æ°äºææ°çå½ä»¤æä»¶ï¼ï¼ä½æ²¡æéç½®è¯¥åæ°ï¼å¯è½ä¼ä¼ éè¿æ¥ä¸ä¸ªç©ºå¼ï¼\n    // ä¸ºäºå¼å®¹æ­¤æåµï¼ä½¿ç¨å½åè¡idä½ä¸ºidçå¼\n    id = id ? id : this.bindingData.list.currentId;\n\n    // åæ°æ£æ¥\n    if (!id || id === 'undefined') {\n      id = '';\n    }\n\n    // è®°å½æè¿ä¸æ¬¡ä¿®æ¹çæ°æ®id\n    const lastModifiedId = this.bindingData.list.currentId;\n    // è·ååçº§æ¹å¼\n    const hierarchyType: string = this.getHierarchyType();\n    // æ§è¡åæ°\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n    if (!repository) {\n      // éè¯¯çåçº§ç \n      throw new Error(this.languageService['errorHierarchyKey']);\n    }\n    const result$ = repository.addSibling(this.repository, id);\n    return result$.pipe(\n      tap(\n        () => {\n          this.virtualRootFrameContext.setParam('IS_ADD', true);\n          this.virtualRootFrameContext.setParam('LAST_MODIFIED_ID', lastModifiedId);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.addSiblingFailed, error);\n        }\n      )\n    );\n  }\n\n  /**\n   * æ°å¢ä¸çº§\n   */\n  public addChild(id: string): Observable<any> {\n\n    // åå åaddSiblingçä¿®æ¹\n    id = id ? id : this.bindingData.list.currentId;\n\n    // åæ°æ£æ¥\n    if (!id) {\n      // è¯·éæ©ç¶èç¹\n      this.notifyService.warning(this.languageService['plsSelectParentNode'], { hideTitle: true });\n      return empty();\n    }\n\n    // è®°å½æè¿ä¸æ¬¡ä¿®æ¹çæ°æ®id\n    const lastModifiedId = this.bindingData.list.currentId;\n    // è·ååçº§æ¹å¼\n    const hierarchyType = this.getHierarchyType();\n    // æ§è¡åæ°\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n\n    // æ°å¢çæ¶åï¼è¦å±å¼ç¶èç¹\n    this.setIdToExpand(id);\n    const reloadChild$ = this.reloadByLevel();\n\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n    if (!repository) {\n      throw new Error(this.languageService['errorHierarchyKey']);\n    }\n    const addChild$ = repository.addChild(this.repository, id);\n    const result$ = reloadChild$.pipe(\n      switchMap(() => {\n        return addChild$;\n      }),\n      tap(\n        () => {\n          this.virtualRootFrameContext.setParam('IS_ADD', true);\n          this.virtualRootFrameContext.setParam('LAST_MODIFIED_ID', lastModifiedId);\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.addChildFailed, error);\n        }\n      )\n    );\n    return result$;\n  }\n  /**\n   * æ¹éä¿å­\n   */\n  public save(): Observable<boolean> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'save' });\n    }\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const save$ = this.repository.applyChanges();\n    const result$ = save$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.notifyService.success(this.languageService.saveSuccess, { hideTitle: true });\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.multiSaveFailed, error);\n        }\n      )\n    );\n    return result$;\n  }\n  /**\n   * å é¤\n   */\n  public remove(id: string, successMsg?: string): Observable<boolean> {\n\n    // åå åaddSibling\n    id = id ? id : this.bindingData.list.currentId;\n\n    // åæ°æ£æ¥\n    if (!id) {\n      this.notifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n      return empty();\n    }\n\n    // å­å¨å­èç¹ä¸åè®¸å é¤\n    const treeNodesData = this.repository.entityCollection.toJSON();\n    const hierarchyType = this.getHierarchyType();\n    const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n    if (treeNodeUtil === null) {\n      return empty();\n    }\n    if (treeNodeUtil.hasChildNodes(treeNodesData, this.hierarchyInfoKey, id) === true) {\n      this.notifyService.warning(this.languageService['deleteChildFirst'], { hideTitle: true });\n      return empty();\n    }\n\n    // ç¡®è®¤å é¤\n    const action$ = this.messageService.question(this.languageService.confirmDeletion);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return empty();\n        }\n\n        // è·åå é¤åè¦è®¾ç½®çèç¹id\n        const nextNodeId = treeNodeUtil.getNextNodeId(treeNodesData, this.hierarchyInfoKey, id);\n\n        // æ§è¡å é¤\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        const remove$ = this.frameContext.repository.removeById(id);\n        return remove$.pipe(\n          tap(() => {\n\n            // è®¾ç½®éä¸­èç¹\n            treeNodeUtil.selectedNode(this.bindingData, this.hierarchyInfoKey, nextNodeId);\n\n            this.loadingService.hideDelayLoading(loadingTimerId);\n            if (successMsg && successMsg.trim()) {\n              this.notifyService.success(successMsg, { hideTitle: true });\n            } else {\n              this.notifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            }\n            // this.notifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n          },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.errorService.exception(this.languageService.deleteFailed, error);\n            }\n          )\n        );\n      })\n    );\n  }\n\n  /**\n   * åæ¶æ¶æ£æµæªä¿å­è®°å½\n   */\n  public cancel(): Observable<any> {\n\n    // æ²¡æåæ´æ¶ç´æ¥åæ¶\n    // const cardDataService = this.frameContext.injector.get<CardDataService>(CardDataService);\n    const befRepository = this.repository as BefRepository<any>;\n    const hasUnsavedData = BefRepositoryUtil.isExistUnsaveData(befRepository);\n    if (!hasUnsavedData) {\n      return this._cancel();\n    }\n\n    const confirmResult$ = this.messageService.question(this.languageService['cancelWithoutSave']).pipe(\n      switchMap((ifCancel: boolean) => {\n        if (ifCancel === false) {\n          return EMPTY;\n        }\n        return this._cancel();\n      })\n    );\n    return confirmResult$;\n  }\n  /**\n   * æé åé¡µä¿¡æ¯\n   * @param parentId parentId\n   * @returns \n   */\n  private buildPaginationInfo(parentId: any) {\n    const pagination: any = { pageIndex: 0, pageSize: 0 };\n    const enableNodePagination = this.frameContext.params.get('enableNodePagination');\n    if (!parentId) {\n      // ä¸çº§åé¡µ\n      const pageSize = this.repository.entityCollection.pageSize || 0;\n      const pageIndex = this.repository.entityCollection.pageIndex || 0;\n      // å¯ç¨äºä¸çº§åé¡µ\n      if (pageSize !== 0) {\n        pagination.pageSize = pageSize;\n        pagination.pageIndex = pageIndex;\n      }\n    } else {\n      // å¦ææªå¯ç¨èç¹åé¡µæå½åä¸ºé¡¶çº§èç¹å è½½ï¼åä¸å¤çèç¹åé¡µ\n      if (enableNodePagination) {\n        const nodePageSize = this.frameContext.params.get('nodePageSize') || 0;\n        let nodePageIndex = this.frameContext.params.get(`_NODE_${parentId}_PAGE_INDEX_`);\n        if (!nodePageIndex) {\n          this.frameContext.params.set(`_NODE_${parentId}_PAGE_INDEX_`, 1);\n          nodePageIndex = 1;\n        }\n        pagination.pageIndex = nodePageIndex;\n        pagination.pageSize = nodePageSize;\n      }\n    }\n    return pagination;\n  }\n\n  /**\n   * åæ¶åæ´\n   */\n  private _cancel(): Observable<any> {\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const cancel$ = this.repository.cancelChanges();\n    return cancel$.pipe(\n      switchMap(() => {\n        const isAdd = this.virtualRootFrameContext.getParam('IS_ADD');\n        const lastModifiedId = this.virtualRootFrameContext.getParam('LAST_MODIFIED_ID');\n        const currentId = this.bindingData.list.currentId;\n\n        if (isAdd === true) {\n          this.repository.entityCollection.removeEntityById(currentId);\n\n          // éç½®ç¼è¾ç¶æ\n          this.virtualRootFrameContext.setParam('IS_ADD', false);\n          if (lastModifiedId) {\n            setTimeout(() => {\n              this.bindingData.list.setCurrentId(lastModifiedId, true, true);\n            }, 0);\n          }\n          return of(null);\n        } else {\n          return this.repository.updateById(currentId);\n        }\n      }),\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.cancelFailed, error);\n        }\n      )\n    );\n  }\n\n  /**\n   * æ£æ¥æ¯å¦å­å¨ä¸çº§èç¹ï¼åé¨æ¹æ³ï¼è¯·å¿ä½¿ç¨ï¼\n   */\n  public hasChildNodes(id: string, treeNodesData: any[]): boolean {\n    const treeNodeUtil = this.getTreeNodeUtil();\n    if (treeNodeUtil.hasChildNodes(treeNodesData, this.hierarchyInfoKey, id) === true) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * è®¡ç®å é¤åçå½åèç¹idï¼åé¨æ¹æ³ï¼è¯·å¿ä½¿ç¨ï¼\n   */\n  public getNextNodeIdAfterRemoving(idToRemove: string, treeNodesData: any[]): string {\n    const treeNodeUtil = this.getTreeNodeUtil();\n    const nextNodeId = treeNodeUtil.getNextNodeId(treeNodesData, this.hierarchyInfoKey, idToRemove);\n    return nextNodeId;\n  }\n\n  /**\n   * è®¾ç½®å é¤åçå½åèç¹èç¹ï¼åé¨æ¹æ³ï¼è¯·å¿ä½¿ç¨ï¼\n   */\n  public setNextNodeAfterRemoving(nextNodeId: string): void {\n    const treeNodeUtil = this.getTreeNodeUtil();\n    treeNodeUtil.selectedNode(this.bindingData, this.hierarchyInfoKey, nextNodeId);\n  }\n  /**\n   * è®¾ç½®æ çå½åè¡(ç»å®æ´æ ä½¿ç¨)\n   * @param id id\n   */\n  public setCurrentId(id: string) {\n    id = id || this.frameContext.getVirtualRootFrameContext().uiState['__DEVKIT__selectedRow'] || this.bindingData.list.currentItem.primaryKeyValue;\n    this.frameContext.bindingData.list.setCurrentId(id, true, true, true);\n  }\n  /**\n   * éä¸­æ çç¬¬ä¸ä¸ªèç¹\n   */\n  public selectFirstRow() {\n    const hierarchyType = this.getHierarchyType();\n    const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n    if (treeNodeUtil !== null) {\n      treeNodeUtil.selectFirstRootNode(this.bindingData, this.hierarchyInfoKey);\n    }\n  }\n  /**\n   * è·åæ èç¹å·¥å·ç±»å®ä¾\n   */\n  private getTreeNodeUtil(): any {\n    const hierarchyType = this.getHierarchyType();\n    const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n    if (treeNodeUtil === null) {\n      throw new Error(`ä¸æ¯æ${hierarchyType}ç±»åçåçº§`);\n    }\n    return treeNodeUtil;\n  }\n\n\n\n  /**\n   * è®°å½å è½½ç¶æ\n   * @todoï¼å¾å é¤\n   */\n  private setLoadByLevelState(filters: string, sorts: string) {\n\n    // @todoï¼ä¸´æ¶å¤ç\n    this.virtualRootFrameContext.setParam('isLoadTreeByLevel', true);\n    this.virtualRootFrameContext.setParam('loadTreeByLevelFilter', filters);\n    this.virtualRootFrameContext.setParam('loadTreeByLevelSort', sorts);\n  }\n\n  /**\n   * å±å¼å½åèç¹\n   * @todoï¼å¾å é¤\n   */\n  private reloadByLevel(): Observable<Entity[]> {\n    const isLoadByLevel = this.virtualRootFrameContext.getParam('isLoadTreeByLevel');\n    if (isLoadByLevel === true) {\n      const filters = this.virtualRootFrameContext.getParam('loadTreeByLevelFilter');\n      const sorts = this.virtualRootFrameContext.getParam('loadTreeByLevelSort');\n      return this.loadByLevel(filters, sorts);\n    }\n    return of([]);\n  }\n\n  private getHierarchyType() {\n    const ngObjects = FieldMetadataUtil.getNgObjects(this.repository.entityType);\n    const hierarchyInfoNgObjectInfo = ngObjects[this.hierarchyInfoKey];\n    let hierarchyType = 'path'; // åçº§ç é»è®¤ä¸ºpathï¼å¼å®¹åè¡¨å\n    if (hierarchyInfoNgObjectInfo.hasOwnProperty('hierarchyType') && hierarchyInfoNgObjectInfo['hierarchyType'] != null) {\n      hierarchyType = hierarchyInfoNgObjectInfo['hierarchyType'] as string;\n    }\n    if (hierarchyType == null || hierarchyType.length < 1) {\n      // 'åçº§ç éç½®ä¿¡æ¯éè¯¯'\n      throw new Error(this.languageService['incorrectHierarchyConfig']);\n    }\n    return hierarchyType;\n  }\n  /**\n   * è·åæ ¹ç»ä»¶æ¶æ¯ç®¡é\n   */\n  private get messagePipe() {\n    if (this.frameContext) {\n      const appContext = this.frameContext.getFormAppContext() || null;\n      if (appContext) {\n        return appContext.messagePipe || null;\n      }\n    }\n    return null;\n  }\n}\nexport { TreeDataService };\n","import { Injectable } from '@angular/core';\nimport { ViewModel } from '@farris/devkit';\nimport { FilterConditionService } from '../filter-condition.service';\nimport { CommandService } from '../command-service';\n\n@Injectable()\nclass FilterConditionDataService {\n    constructor(\n        private viewModel: ViewModel,\n        private filterConditionService: FilterConditionService,\n        private commandService: CommandService\n    ) { }\n\n    /**\n     * æ§è¡è¿æ»¤\n     * @param commandName å½ä»¤åç§°\n     * @param frameId å½ä»¤æå¨çframeId\n     */\n    public filter(commandName: string, frameId: string) {\n        const self: any = this;\n        let filters = self.context && self.context.eventParam && self.context.eventParam.data || [];\n        if (typeof (filters) === 'string') {\n            filters = JSON.parse(filters);\n        }\n        // æ¥è¯¢æ¶éç½®é¡µç ä¸ºç¬¬ä¸é¡µ\n        this.viewModel.frameContext.repository.entityCollection.pageIndex = 1;\n        this.viewModel.frameContext.repository.filterConditionManager.setConditions(this.viewModel.bindingPath, filters);\n        return this.commandService.execute(commandName, frameId);\n    }\n}\nexport { FilterConditionDataService };\n","import { Injectable } from '@angular/core';\nimport { Entity, BindingData, FrameContext } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\nimport { Observable, EMPTY } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { LanguageService } from '../languag.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { EditStateUtil } from './utils/index';\n\n\n/**\n * æ°æ®ç¼è¾æå¡\n */\n@Injectable()\nclass EditDataService {\n\n  /**\n   * å®ä½ä»åº\n   */\n  private repository: BefRepository<Entity>;\n\n  /**\n   * ç»å®æ°æ®\n   */\n  private bindingData: BindingData;\n\n  /**\n   * Loadingæå¡\n   */\n  private loadingService: FormLoadingService;\n\n  /**\n   * è¯­è¨æå¡\n   */\n  private languageService: LanguageService;\n\n  /**\n   * éè¯¯å¤çæå¡\n   */\n  private errorService: FormErrorService;\n\n  /**\n   * æé å½æ°\n   */\n  constructor(private frameContext: FrameContext) {\n    this.repository = this.frameContext.repository as BefRepository<Entity>;\n    this.bindingData = this.frameContext.bindingData;\n    this.loadingService = this.frameContext.injector.get<FormLoadingService>(FormLoadingService, null);\n    this.languageService = this.frameContext.injector.get<LanguageService>(LanguageService, null);\n    this.errorService = this.frameContext.injector.get<FormErrorService>(FormErrorService, null);\n  }\n\n  /**\n   * ç¼è¾ï¼æ¯æå éï¼\n   */\n  public edit(id: string): Observable<Entity> {\n\n    id = id || this.bindingData.list.currentId;\n    if (!id) {\n      return EMPTY;\n    }\n\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const edit$ = this.repository.editEntityById(id);\n    const result$ = edit$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          EditStateUtil.setEditState(this.frameContext, id);\n        },\n        (error: any) => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.updateFailed, error);\n        }\n      )\n    );\n    return result$;\n  }\n}\n\n\nexport { EditDataService };\n","import { Injectable } from '@angular/core';\nimport { Observable, of, EMPTY } from 'rxjs';\nimport { tap, switchMap, concatMap } from 'rxjs/operators';\nimport { FrameContext, Entity, } from '@farris/devkit';\nimport { BefRepository, } from '@farris/bef';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { CommandService } from '../command-service';\nimport { ListDataService } from './list-data.service';\nimport { TreeDataService } from './tree-data.service';\n\n/**\n * å é¤æå¡\n */\n@Injectable()\nclass RemoveDataService {\n\n  private notifyService: FormNotifyService;\n\n  private messageService: FormMessageService;\n\n  private loadingService: FormLoadingService;\n\n  private errorService: FormErrorService;\n\n  private languageService: LanguageService;\n\n  private befRepository: BefRepository<any>;\n\n  private commandService: CommandService;\n\n  private listDataService: ListDataService;\n\n  private treeDataService: TreeDataService;\n\n  /**\n   * æé å½æ°\n   * @param frameContext ç»ä»¶ä¸ä¸æ\n   */\n  constructor(private frameContext: FrameContext) {\n    this.notifyService = this.frameContext.injector.get<FormNotifyService>(FormNotifyService, null);\n    this.messageService = this.frameContext.injector.get<FormMessageService>(FormMessageService, null);\n    this.errorService = this.frameContext.injector.get<FormErrorService>(FormErrorService, null);\n    this.loadingService = this.frameContext.injector.get<FormLoadingService>(FormLoadingService, null);\n\n    this.languageService = this.frameContext.injector.get<LanguageService>(LanguageService, null);\n    this.commandService = this.frameContext.injector.get<CommandService>(CommandService, null);\n    this.listDataService = this.frameContext.injector.get<ListDataService>(ListDataService, null);\n    this.treeDataService = this.frameContext.injector.get<TreeDataService>(TreeDataService, null);\n    this.befRepository = this.frameContext.repository as BefRepository<Entity>;\n  }\n\n  /**\n   * å é¤idå¯¹åºçå®ä½\n   * @param id è¦å é¤çæ°æ®id\n   * @param ifSave æ¯å¦ä¿å­\n   * @param enableRemoveAndSave æ¯å¦å¯ç¨å é¤å¹¶ä¿å­ï¼ä»ä¸ºå¼å®¹ï¼æ°è°ç¨è¯·å¿è®¾ç½®ï¼\n   * @summary\n   * enableRemoveAndSaveå­å¨çæä¹ï¼\n   * 1ãèè¡¨åçå¯è½æ²¡ædelAndSaveæ¹æ³ï¼\n   * 2ãä¸ºäºå°ListDataServiceä¸­çremoveæ¹æ³è¿ç§»å°æ­¤æ¹æ³ä¸ï¼æ¾ç¤ºè®¾ç½®ä¸ºfalseï¼ä¿æåä»¥åè¡ä¸ºä¸è´ï¼\n   * 3ãè¯¥åæ°é»è®¤ä¸ºtrueï¼å¹¶ä¸å¨WebComponentå±ä¸æ´é²ï¼æ°å½ä»¤ä¸éè¦ä¼ éï¼é»è®¤ä¸ºtrueï¼\n   */\n  public removeById(id: string, ifSave: boolean, enableRemoveAndSave: boolean = true, successMsg?: string): Observable<boolean> {\n    const msg = successMsg ? successMsg : '';\n    return this.innerRemoveById(id, ifSave, enableRemoveAndSave, msg);\n  }\n\n  public removeByIds(ids: string[]): Observable<boolean> {\n    throw new Error('Not Implemented');\n  }\n\n  /**\n   * å é¤idå¯¹åºçå®ä½ï¼å¹¶æ§è¡ä¿å­\n   */\n  public removeAndSaveById(id: string, successMsg?: string): Observable<boolean> {\n    const msg = successMsg ? successMsg : '';\n    return this.innerRemoveById(id, true, true, msg);\n  }\n\n  /**\n   * å é¤å¹¶ä¿å­æ èç¹æ°æ®\n   */\n  public removeAndSaveByIdForTree(id: string, successMsg?: string): Observable<boolean> {\n    const msg = successMsg ? successMsg : '';\n    // æ£æ¥è¦å é¤çidæ¯å¦å­å¨\n    if (this.checkIdsToRemove([id]) === false) {\n      this.notifyService.warning(this.languageService.plsSelectDeleteData, { hideTitle: true });\n      return EMPTY;\n    }\n\n    // æ£æ¥æ¯å¦æå­èç¹\n    const treeNodesData = this.befRepository.entityCollection.toJSON();\n    if (this.treeDataService.hasChildNodes(id, treeNodesData) === true) {\n      this.messageService.warning(this.languageService.deleteChildFirst);\n      return EMPTY;\n    }\n\n    // æ§è¡å é¤\n    const remove$ = this.innerRemoveById(id, true, true, msg);\n    const nextNodeId = this.treeDataService.getNextNodeIdAfterRemoving(id, treeNodesData);;\n    const result$ = remove$.pipe(\n      tap(() => {\n        this.treeDataService.setNextNodeAfterRemoving(nextNodeId);\n      })\n    );\n\n    return result$;\n  }\n\n\n  /**\n   * æ¹éå é¤å¹¶ä¿å­\n   */\n  public removeAndSaveByIds() {\n    throw new Error('Not Implemented');\n  }\n\n  /**\n   * å é¤åçå·æ°\n   */\n  public refreshAfterRemoving(loadCmdName: string, loadCmdFrameId: string): Observable<any> {\n    if (!this.frameContext || !loadCmdName || !loadCmdFrameId) {\n      return;\n    }\n    const commandService = this.frameContext.injector.get<CommandService>(CommandService, null);\n    return commandService.execute(loadCmdName, loadCmdFrameId);\n  }\n\n  /**\n   * å é¤idå¯¹åºçå®ä½\n   * @param id å®ä½id\n   * @param ifSave æ¯å¦ä¿å­\n   * @param enableRemoveAndSave æ¯å¦å¯ç¨å é¤å¹¶ä¿å­ï¼èEAPIä¸æ²¡ææ­¤æ¹æ³ï¼éè¿å¼å³è¿è¡å¼å®¹ï¼\n   * @summary\n   * enableRemoveAndSaveåæ°è¯´æï¼\n   * 1ãèEAPIä¸æ²¡ædelAndSaveæ¹æ³ï¼åªè½åä¸¤æ¬¡è¯·æ±ï¼å é¤åä¿å­ï¼ï¼\n   * 2ãæ­¤å¼å³ç¨äºéæ©ä½¿ç¨åªç§æ¹å¼ï¼å¼å®¹èè¡¨åã\n   */\n  private innerRemoveById(id: string, ifSave: boolean, enableRemoveAndSave: boolean, successMsg: string): Observable<boolean> {\n\n    // æ£æ¥è¦å é¤çidæ¯å¦å­å¨\n    if (this.checkIdsToRemove([id]) === false) {\n      this.notifyService.warning(this.languageService.plsSelectDeleteData, { hideTitle: true });\n      return EMPTY;\n    }\n\n    const confirm$ = this.confirmToRemove();\n    const remove$ = enableRemoveAndSave && ifSave ?\n      this.befRepository.removeEntityAndSaveById(id) :\n      this.befRepository.removeById(id, ifSave);\n\n    const result$ = confirm$.pipe(\n      concatMap((ifRemove: boolean) => {\n        if (ifRemove === false) {\n          return EMPTY;\n        }\n        const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n        return remove$.pipe(\n          tap(\n            () => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              if (successMsg && successMsg.trim()) {\n                this.notifyService.success(successMsg, { hideTitle: true });\n              } else {\n                this.notifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n              }\n              // this.notifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            },\n            (error: any) => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.errorService.exception(this.languageService.deleteFailed, error);\n            }\n          ),\n          switchMap(() => {\n            const saved = enableRemoveAndSave && ifSave;\n            if (!saved) {\n              return EMPTY;\n            } else {\n              return of(null);\n            }\n          })\n        );\n      })\n    );\n\n    return result$;\n  }\n\n  /**\n   * æ£æ¥è¦å é¤çidsæ¯å¦ä¸ºç©º\n   */\n  private checkIdsToRemove(ids: string[]): boolean {\n    if (!ids) {\n      return false;\n    }\n    const filteredIds = ids.filter((id: string) => {\n      return !!id;\n    });\n    if (filteredIds.length === 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * ç¡®è®¤å é¤\n   */\n  private confirmToRemove(): Observable<boolean> {\n    const confirm$ = this.messageService.question(this.languageService.confirmDeletion);\n    const result$ = confirm$.pipe(\n      concatMap((ifRemove: boolean) => {\n        if (ifRemove === false) {\n          return EMPTY;\n        } else {\n          return of(true);\n        }\n      }\n      ));\n    return result$;\n  }\n}\n\nexport { RemoveDataService };\n\n\n","import { Injectable } from '@angular/core';\nimport { FrameContext, Entity } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormErrorService } from '../error/form-error.service';\n\n/**\n * å é¤æå¡\n */\n@Injectable()\nclass SaveDataService {\n\n  private notifyService: FormNotifyService;\n\n  private messageService: FormMessageService;\n\n  private loadingService: FormLoadingService;\n\n  private errorService: FormErrorService;\n\n  private languageService: LanguageService;\n\n  private befRepository: BefRepository<any>;\n\n  /**\n   * æé å½æ°\n   * @param frameContext ç»ä»¶ä¸ä¸æ\n   */\n  constructor(private frameContext: FrameContext) {\n    this.notifyService = this.frameContext.injector.get<FormNotifyService>(FormNotifyService, null);\n    this.messageService = this.frameContext.injector.get<FormMessageService>(FormMessageService, null);\n    this.loadingService = this.frameContext.injector.get<FormLoadingService>(FormLoadingService, null);\n    this.languageService = this.frameContext.injector.get<LanguageService>(LanguageService, null);\n    this.befRepository = this.frameContext.repository as BefRepository<Entity>;\n  }\n}\n\nexport { SaveDataService };\n","import { Injectable, Optional } from '@angular/core';\nimport { EMPTY, Observable } from 'rxjs';\nimport { tap, switchMap, concatMap } from 'rxjs/operators';\n\nimport { BindingList, FrameContext, ViewModel } from '@farris/devkit';\nimport { BaseDataService } from './base-data.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { LanguageService } from '../languag.service';\nimport { TreeRepositoryFactory } from './tree-table/repository/tree-repository-factory';\nimport { TreeUtilFactory } from './tree-table/util/tree-util-factory';\n\n\n\n/**\n * æ æ°æ®æå¡\n */\n@Injectable()\nclass SubTreeDataService extends BaseDataService {\n\n  /**\n   * åçº§ç ä¿¡æ¯\n   */\n  private get hierarchyInfoKey(): string {\n    return this.virtualRootFrameContext.getParam('hierarchyInfoKey');\n  }\n  private get hierarchyInfoField(): string {\n    return this.hierarchyInfoKey.split('/').filter(p => p).pop();\n  }\n  private get virtualRootFrameContext() {\n    return this.frameContext.getVirtualRootFrameContext();\n  }\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    frameContext: FrameContext,\n    private viewModel: ViewModel,\n    private messageService: FormMessageService,\n    private loadingService: FormLoadingService,\n    private errorService: FormErrorService,\n    private formNotifyService: FormNotifyService,\n    @Optional() private languageService: LanguageService\n  ) {\n    super(frameContext);\n    if (!languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  private get messagePipe() {\n    if (this.viewModel && this.viewModel.frameContext) {\n      const appContext = this.viewModel.frameContext.getFormAppContext() || null;\n      if (appContext) {\n        return appContext.messagePipe || null;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * æ°å¢å­è¡¨åçº§\n   */\n  public addSubSibling(): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'addSubSibling' });\n    }\n    let params: { nodeCodes: string[], ids: string[] } = this.getParams();\n    // è·ååçº§æ¹å¼\n    const hierarchyType: string = this.getHierarchyType();\n    // æ§è¡åæ°\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n    if (!repository) {\n      // éè¯¯çåçº§ç \n      throw new Error(this.languageService['errorHierarchyKey']);\n    }\n    const result$ = repository.addSubSibling(this.repository, params.nodeCodes, params.ids);\n    return result$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.errorService.exception(this.languageService.addSubSiblingFailed, error);\n        }\n      )\n    );\n  }\n\n  /**\n   * æ°å¢ä¸çº§\n   */\n  public addSubChild(): Observable<any> {\n    if (this.messagePipe) {\n      this.messagePipe.next({ messageType: 'addSubChild' });\n    }\n    let params: { nodeCodes: string[], ids: string[] } = this.getParams();\n    // è·ååçº§æ¹å¼\n    const hierarchyType = this.getHierarchyType();\n\n    const currentList = this.frameContext && this.frameContext.bindingData && this.frameContext.bindingData.getList();\n    if (!currentList['currentId']) {\n      // è¯·éæ©ç¶èç¹\n      this.formNotifyService.warning(this.languageService['plsSelectParentNode'], { hideTitle: true });\n      return EMPTY;\n    }\n    // æ§è¡åæ°\n    const loadingTimerId = this.loadingService.showLoadingWithDelay(500);\n\n    const repository = TreeRepositoryFactory.getInstance(hierarchyType);\n    if (!repository) {\n      throw new Error(this.languageService['errorHierarchyKey']);\n    }\n    const addSubChild$ = repository.addSubChild(this.repository, params.nodeCodes, params.ids);\n    const result$ = addSubChild$.pipe(\n      tap(\n        () => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n        },\n        error => {\n          this.loadingService.hideDelayLoading(loadingTimerId);\n          this.errorService.exception(this.languageService.addSubChildFailed, error);\n        }\n      )\n    );\n    return result$;\n  }\n  /**\n   * å é¤å­è¡¨æ èç¹\n   * @param id id\n   */\n  public remove(id: string, successMsg?: string): Observable<any> {\n    // åæ°æ£æ¥\n    if (!id) {\n      this.formNotifyService.warning(this.languageService['plsSelectDeleteData'], { hideTitle: true });\n      return EMPTY;\n    }\n    // è·ååçº§æ¹å¼\n    const hierarchyType = this.getHierarchyType();\n    // æå­èç¹æ¶ä¸åè®¸å é¤\n    const treeNodesData = this.frameContext.bindingData.getList().toJSON();\n    const bindingList = this.frameContext.bindingData.getList();\n    const treeNodeUtil = TreeUtilFactory.getInstance(hierarchyType);\n    if (treeNodeUtil === null) {\n      return EMPTY;\n    }\n    if (treeNodeUtil.hasChildNodes(treeNodesData, this.hierarchyInfoField, id) === true) {\n      this.messageService.warning(this.languageService['deleteChildFirst']);\n      return EMPTY;\n    }\n    // ç¡®è®¤å é¤\n    const action$ = this.messageService.question(this.languageService.confirmDeletion);\n    return action$.pipe(\n      concatMap(result => {\n        if (!result) {\n          return EMPTY;\n        }\n        // è·åå é¤åè¦è®¾ç½®çèç¹id\n        const nextNodeId = treeNodeUtil.getNextNodeId(treeNodesData, this.hierarchyInfoField, id);\n\n        // æ§è¡å é¤\n        const loadingTimerId = this.loadingService.show();\n        const path = this.getPath();\n        const remove$ = this.frameContext.repository.removeByPath(path, id);\n        return remove$.pipe(\n          tap(() => {\n            // è®¾ç½®éä¸­èç¹\n            treeNodeUtil.selectNodeByBindingList(bindingList, this.hierarchyInfoField, nextNodeId);\n            this.loadingService.hideDelayLoading(loadingTimerId);\n            if (successMsg && successMsg.trim()) {\n              this.formNotifyService.success(successMsg, { hideTitle: true });\n            } else {\n              this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n            }\n            // this.formNotifyService.success(this.languageService.deleteSuccess, { hideTitle: true });\n          },\n            error => {\n              this.loadingService.hideDelayLoading(loadingTimerId);\n              this.errorService.exception(this.languageService.deleteFailed, error);\n            }\n          )\n        );\n      })\n    );\n  }\n\n  private getHierarchyType() {\n    const propInfo = this.repository.entityTypeInfo.getPropInfoByPath(this.hierarchyInfoKey.split('/'));\n    let hierarchyType = propInfo.metadataInfo['hierarchyType'] || null;\n    if (hierarchyType == null || hierarchyType.length < 1) {\n      // 'åçº§ç éç½®ä¿¡æ¯éè¯¯'\n      throw new Error(this.languageService['incorrectHierarchyConfig']);\n    }\n    return hierarchyType;\n  }\n\n  /**\n   * è·ååæ°\n   * /parentId/childCodes/childId/grandsonCodes\n   * [childCodes, grandsonCodes]\n   * [parntId, childId]\n   */\n  private getParams(): { nodeCodes: string[], ids: string[] } {\n    let nodeCodes = this.viewModel.bindingPath.substr(1).split('/');\n    let ids = [];\n    let nodeCodeArray = [];\n    const rid = this.viewModel.bindingData.list.currentId; // rootè¡¨æ°æ®id\n    ids.push(rid);\n    let subData: any = this.viewModel.bindingData;\n    if (nodeCodes.length > 0) {\n      nodeCodes.map(nodeCode => {\n        subData = subData[nodeCode];\n        if (subData && subData.currentId) {\n          ids.push(subData.currentId);\n        }\n        //å»é¤nodeCodeçs\n        nodeCode ? nodeCodeArray.push(nodeCode.substring(0, nodeCode.length - 1)) : nodeCodeArray.push(nodeCode);\n      })\n    }\n    return { nodeCodes: nodeCodeArray, ids: ids };\n  }\n  /**\n   * è·åå®æ´è·¯å¾\n   * fixed by justin: æ ¹æ®bindingPathï¼å¦ææ¯ä»ä»è¡¨ï¼éè¦è·åä¸»è¡¨æ°æ®idåä»è¡¨æ°æ®id\n   */\n  private getPath(): string {\n    const bindingPath = this.viewModel.bindingPath;\n    const rid = this.viewModel.bindingData.list.currentId; // rootè¡¨æ°æ®id\n    let path = '/' + rid;\n\n    const subPaths = bindingPath.split('/').filter(p => p);\n    if (subPaths.length > 0) {\n      // eg:bindingPathå½¢å¦/edus/grades,splitåæ¯['edus', 'grades']\n      let subData: any = this.viewModel.bindingData;\n      for (let index = 1; index < subPaths.length - 1; index++) {\n        const subPath = subPaths[index];\n        subData = subData[subPath];\n        if (!subData || !subData.currentId) {\n          throw Error(`è·åå­è¡¨å®æ´è·¯å¾åºéï¼æ¾ä¸å°${subData}å¯¹åºçå­è¡¨ï¼æå¯¹åºå­è¡¨æ²¡æå½åè¡ã`);\n        }\n        path += `/${subPath}/${subData.currentId}`;\n      }\n    }\n    path += '/' + subPaths[subPaths.length - 1];\n\n    return path;\n  }\n}\nexport { SubTreeDataService };\n","import { Injectable, Optional } from '@angular/core';\nimport { HttpHeaders, HttpErrorResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { Repository } from '@farris/devkit';\nimport { BefRepository, BefRestService, RequestInfo, ResponseInfo } from '@farris/bef';\nimport { BodyWithRequestInfo } from './types';\nimport { FormLoadingService } from './form-loading/form-loading.service';\nimport { FormMessageService } from './form-message.service';\nimport { FormNotifyService } from './form-notify.service';\nimport { FormErrorService } from './error/form-error.service';\nimport { LanguageService } from './languag.service';\n// tslint:disable: no-string-literal\n\n/**\n * åè¡¨ä»åºæå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass BeActionService {\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private repository: Repository<any>,\n    private loadingService: FormLoadingService,\n    private msgService: FormMessageService,\n    private notifyService: FormNotifyService,\n    private formErrorService: FormErrorService,\n    @Optional() private languageService: LanguageService,\n  ) {\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * æ§è¡èªå®ä¹å¨ä½\n   */\n  public invokeAction(\n    actionUri: string, httpMethod: string, httpHeaders?: any, queryParams?: any, body?: BodyWithRequestInfo\n  ): Observable<ResponseInfo> {\n    return this.innerInvokeAction(actionUri, httpMethod, httpHeaders, queryParams, body, true);\n  }\n\n  /**\n   * å·²å¼ç¨ï¼è¯·ä½¿ç¨invokeActionä»£æ¿\n   * @deprecated\n   * @summary\n   * è¿ç§»æ¶è¯·æ³¨æï¼invokeActionä¸­bodyè¯·ä¼ éæ»¡è¶³BodyWithRequestInfoæ¥å£çæ ¼å¼ï¼å½¢å¦ï¼\n   * { requestInfo: reqeustInfoInstance, key1: value1, key2: value2 }\n   */\n  public executeAction(\n    actionUri: string, httpMethod: string, httpHeaders?: any, queryParams?: any, body?: any\n  ): Observable<any> {\n\n    // 1ãä¸ç¡®å®bodyä¸­æ¯å¦æRequestInfoå¯¹è±¡\n    // 2ãrestServiceçreqeustä¼æ ¹æ®bodyä¸­æ¯å¦ækeyä¸ºReqeustInfoï¼å¤§åå¼å¤´ï¼çåæ°æ¥ç¡®å®ï¼\n    // 3ãå¦æbodyä¸­æ²¡ækeyä¸ºReqeustInfoçåæ°ï¼ä¸ç´æ¥è¿åResponseInfoï¼èæ¯è¿ä¸æ­¥è§£æï¼è¿åå¶ä¸­çreturnValueã\n    return this.innerInvokeAction(actionUri, httpMethod, httpHeaders, queryParams, body, false);\n  }\n\n  /**\n   * æé æ¥è¯¢å­ç¬¦ä¸²\n   */\n  public buildQueryParams(queryParams: string): string {\n    if (typeof queryParams === 'string') {\n      queryParams = JSON.parse(queryParams);\n    }\n\n    let queryParamsString = '';\n    Object.keys(queryParams).forEach((key: string) => {\n      queryParamsString += `${key}=${queryParams[key]}`;\n    });\n\n    return queryParamsString;\n  }\n\n  /**\n   * è·åRestæå¡\n   */\n  public getRestService(): BefRestService {\n    const befRepository = this.repository as BefRepository<any>;\n    return befRepository.restService;\n  }\n\n\n  /**\n   * è°ç¨èªå®ä¹å¨ä½\n   */\n  private innerInvokeAction(\n    actionUri: string, httpMethod: string, httpHeaders?: any, queryParams?: any, body?: any, hasRequestInfo?: boolean\n  ): Observable<any>  {\n    const options = {};\n    const restService = this.getRestService();\n    const baseUri = restService.baseUri;\n\n    // æé url\n    let fullActionUri = `${baseUri}/service/${actionUri}`;\n    if (queryParams && queryParams !== '') {\n      const queryParamsString = this.buildQueryParams(queryParams);\n      fullActionUri += queryParamsString;\n    }\n\n\n    // bodyæé \n    if (body && body !== '') {\n      if (typeof body === 'string' && body.startsWith('{') && body.endsWith('}')) {\n        body = JSON.parse(body);\n      }\n      options['body'] = body;\n    }\n\n    // httpå¤´æé \n    if (httpHeaders && httpHeaders !== '') {\n      httpHeaders = JSON.parse(httpHeaders);\n\n      // å¦ææ²¡æè®¾ç½®Content-Typeï¼é»è®¤ç¨jsonæ ¼å¼\n      if (!httpHeaders['Content-Type']) {\n        httpHeaders['Content-Type'] = 'application/json';\n      }\n      options['headers'] = new HttpHeaders(httpHeaders);\n    } else {\n      options['headers'] = new HttpHeaders({ 'Content-Type': 'application/json' });\n    }\n\n    // æ§è¡æå¡å¨ç«¯è¯·æ±\n    this.loadingService.show();\n\n    // invokeæ¹æ³\n    // 1ãRequestInfo=>æ¥é\n    // 2ãrequestInfo=>ResponseInfo\n    // requestæ¹æ³\n    // 1ãRequestInfo=>ResponseInfo\n    // 2ãrequestInfo=>returnValue\n    const methodName = hasRequestInfo ? 'invoke' : 'request';\n    const result$ = restService[methodName](fullActionUri, httpMethod, null, options);\n    return result$.pipe(\n      tap(\n        () => {\n          this.loadingService.hide();\n        },\n        (error: any) => {\n          this.loadingService.hide();\n          const errorMsg = fullActionUri + this.languageService['operationFailed'];\n          this.formErrorService.exception(errorMsg, error);\n        }\n      )\n    );\n  }\n}\n\n\nexport { BeActionService };\n\n\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, empty, of, from, EMPTY } from 'rxjs';\nimport { tap, map, switchMap, catchError } from 'rxjs/operators';\nimport { BeActionService } from './be-action.service';\nimport { FormMessageService } from './form-message.service';\nimport { FormNotifyService } from './form-notify.service';\nimport { LanguageService } from './languag.service';\nimport { FormLoadingService } from './form-loading/form-loading.service';\nimport { FormErrorService } from './error/form-error.service';\nimport { WFSubmiteService, InteractionResponse, ExcutionResponse } from '@gsp-wf/rtdevkit';\nimport { WfTaskHandlerService } from '@gsp-wf/wf-task-handler';\nimport { BefRepository } from '@farris/bef';\nimport { Entity, FrameContext } from '@farris/devkit';\nimport { WFFlowchartService } from '@gsp-wf/ui-flowchart';\nimport { FormNotifyStrategyService } from './form-notify-strategy.service';\nimport { BodyWithRequestInfo } from './../lib/types';\n// tslint:disable: max-line-length\n/**\n * å®¡æ¹æå¡\n * @Scope FrameComponent\n */\n@Injectable()\nclass ApproveService {\n\n  /**\n   * å®ä½ä»åº\n   */\n  private repository: BefRepository<Entity>;\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private formLoadingService: FormLoadingService,\n    private beActionService: BeActionService,\n    private msgService: FormMessageService,\n    private notifyService: FormNotifyService,\n    @Optional() private languageService: LanguageService,\n    private formErrorService: FormErrorService,\n    private frameContext: FrameContext,\n    @Optional() private submitter: WFSubmiteService,\n    @Optional() private flowchartService: WFFlowchartService,\n    @Optional() private wfTaskHandlerService: WfTaskHandlerService\n  ) {\n    if (this.frameContext) {\n      this.repository = this.frameContext.repository as BefRepository<Entity>;\n      if (!this.wfTaskHandlerService) {\n        this.wfTaskHandlerService = this.frameContext.injector.get(WfTaskHandlerService, null);\n      }\n    }\n  }\n\n  /**\n   * å¸¦æäº¤äºçæäº¤å®¡æ¹\n   */\n  submitApproveWithInteraction(bizBillID: string) {\n    return this.submitApprove(bizBillID);\n  }\n\n  /**\n   * æäº¤å®¡æ¹\n   * @param bizBillID ä¸å¡åæ®id\n   * @param interactionResult åç«¯äº¤äºç»æ\n   * @deprecated å·²åºå¼ï¼æ¸ä½¿ç¨åå«å¥å£åæ®çå®¡æ¹\n   */\n  submitApprove(bizBillID: string, interactionResult?: InteractionResponse): Observable<any> {\n    if (!bizBillID) {\n      // this.msgService.error(this.languageService.unallowEmptyBizBillId);\n      this.notifyService.info(this.languageService.unallowEmptyBizBillId, { hideTitle: true });\n      return empty();\n    }\n\n    const actionUri = 'submittoapprovevoaction';\n\n    const restService = this.beActionService.getRestService();\n\n    const body: BodyWithRequestInfo = {\n      requestInfo: restService.buildRequestInfo(),\n      bizInstID: bizBillID,\n      interactionResult: interactionResult ? {\n        procDefId: interactionResult.processDefinitionId\n      } : {}\n    };\n\n    this.formLoadingService.show();\n\n    // æ·»å æç¤º\n    const action$ = this.beActionService.invokeAction(actionUri, 'PUT', null, null, body);\n    // ç®ååå«ä¸ç§æåµï¼\n    // 1. ç¬¬ä¸æ¬¡æäº¤æåï¼æå¡ç«¯è¿åæµç¨å®ä¾id\n    // 2. ç¬¬ä¸æ¬¡æäº¤æåï¼æå¡ç«¯è¿åæµç¨å®ä¾idï¼å¹¶è¿åå¤ä¸ªåä¸èï¼äº¤äºæ¶æäº¤åä¸è\n    // 3. ç¬¬ä¸æ¬¡æäº¤æªæåï¼æå¡ç«¯è¿åå¤ä¸ªæµç¨å®ä¹ï¼éè¦äº¤äºåç¬¬äºæ¬¡æäº¤å®¡æ¹ï¼ç¬¬äºæ¬¡æäº¤ä¼åºç°æåµ1åæåµ2\n\n    return action$.pipe(\n      map((result): ExcutionResponse => {\n        if (result && result.returnValue && result.returnValue.excutionResponse) {\n          var wfResponse: ExcutionResponse = result.returnValue.excutionResponse;\n          return wfResponse;\n        }\n      }),\n      switchMap((response: ExcutionResponse) => {\n        if (response && response.procInstId) {\n          if (this.repository) {\n            const updating$ = this.repository.updateById(bizBillID);\n            return updating$.pipe(tap(() => {\n              this.formLoadingService.hide();\n              // this.notifyService.info(this.languageService.submitSuccess);\n              FormNotifyStrategyService.success(this.notifyService, this.languageService.submitSuccess);\n            }), map(() => {\n              return response;\n            }));\n          } else {\n            this.formLoadingService.hide();\n            // this.notifyService.info(this.languageService.submitSuccess);\n            FormNotifyStrategyService.success(this.notifyService, this.languageService.submitSuccess);\n            return of(response);\n          }\n        } else {\n          return of(response);\n        }\n      }),\n      switchMap((response: ExcutionResponse) => {\n        if (response.needInteraction) {\n          return from(new Promise((resolve) => {\n            this.submitter.excute(response, (interactionResponse: InteractionResponse) => {\n              // å¦ææ­¤æ¬¡æªæäº¤ï¼èéæ©åå¾å°äºæµç¨å®ä¹IDï¼åå¨æ­¤æäº¤å®¡æ¹\n              if (!response.procInstId && interactionResponse.processDefinitionId) {\n                this.submitApprove(bizBillID, interactionResponse).subscribe(() => {\n                  resolve();\n                });\n              } else {\n                resolve();\n              }\n            });\n          }));\n        } else {\n          return of(null);\n        }\n      }),\n      catchError(\n        error => {\n          this.formLoadingService.hide();\n          // this.formErrorService.exception(this.languageService.submitFaild, error);\n          return of(error);\n        }\n      )\n    );\n  }\n  /**\n   * æäº¤å®¡æ¹(å¸¦å¥å£åæ®)\n   * @param bizBillID ä¸å¡åæ®Id\n   * @param bizDefKey å¥å£åæ®Id\n   * @param options options\n   * @param interactionResult äº¤äºç»æ\n   */\n\n  public submitApproveWithBizDefKey(bizBillID: string, bizDefKey: string, options?: any, interactionResult?: InteractionResponse): Observable<any> {\n    if (!bizBillID) {\n      this.notifyService.warning(this.languageService.unallowEmptyBizBillId, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!bizDefKey) {\n      this.notifyService.warning(this.languageService.bizDefKeyRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    try {\n      if (options && typeof (options) === 'string') {\n        options = JSON.parse(options);\n      }\n    } catch (e) {\n      throw new Error('ArgumentError:options not a valid json string.');\n    }\n\n    const actionUri = 'submittoapprovewithpayload';\n\n    const restService = this.beActionService.getRestService();\n\n    const body: BodyWithRequestInfo = {\n      requestInfo: restService.buildRequestInfo(),\n      approvePayload: {\n        startProcessPayload: {\n          bizDefKey: bizDefKey,\n          dataId: bizBillID,\n          name: options && options.name || '',\n          variables: options && options.variables || {}\n        }\n      }\n    };\n    if (interactionResult) {\n      body.approvePayload.startProcessPayload.processDefinitionId = interactionResult.processDefinitionId;\n      body.approvePayload.startProcessPayload.processDefinitionKey = interactionResult['processDefinitionKey'];\n    }\n    this.formLoadingService.show();\n\n    // æ·»å æç¤º\n    const action$ = this.beActionService.invokeAction(actionUri, 'PUT', null, null, body);\n    // ç®ååå«ä¸ç§æåµï¼\n    // 1. ç¬¬ä¸æ¬¡æäº¤æåï¼æå¡ç«¯è¿åæµç¨å®ä¾id\n    // 2. ç¬¬ä¸æ¬¡æäº¤æåï¼æå¡ç«¯è¿åæµç¨å®ä¾idï¼å¹¶è¿åå¤ä¸ªåä¸èï¼äº¤äºæ¶æäº¤åä¸è\n    // 3. ç¬¬ä¸æ¬¡æäº¤æªæåï¼æå¡ç«¯è¿åå¤ä¸ªæµç¨å®ä¹ï¼éè¦äº¤äºåç¬¬äºæ¬¡æäº¤å®¡æ¹ï¼ç¬¬äºæ¬¡æäº¤ä¼åºç°æåµ1åæåµ2\n\n    return action$.pipe(\n      map((result): ExcutionResponse => {\n        if (result && result.returnValue && result.returnValue.excutionResponse) {\n          const wfResponse: ExcutionResponse = result.returnValue.excutionResponse;\n          return wfResponse;\n        }\n      }),\n      switchMap((response: ExcutionResponse) => {\n        if (response && response.procInstId) {\n          if (this.repository) {\n            const updating$ = this.repository.updateById(bizBillID);\n            return updating$.pipe(tap(() => {\n              this.formLoadingService.hide();\n              // this.notifyService.info(this.languageService.submitSuccess);\n              FormNotifyStrategyService.success(this.notifyService, this.languageService.submitSuccess);\n            }), map(() => {\n              return response;\n            }));\n          } else {\n            this.formLoadingService.hide();\n            // this.notifyService.info(this.languageService.submitSuccess);\n            FormNotifyStrategyService.success(this.notifyService, this.languageService.submitSuccess);\n            return of(response);\n          }\n        } else {\n          return of(response);\n        }\n      }),\n      switchMap((response: ExcutionResponse) => {\n        if (response.needInteraction) {\n          return from(new Promise((resolve) => {\n            this.submitter.excute(response, (interactionResponse: InteractionResponse) => {\n              // å¦ææ­¤æ¬¡æªæäº¤ï¼èéæ©åå¾å°äºæµç¨å®ä¹IDï¼åå¨æ­¤æäº¤å®¡æ¹\n              if (!response.procInstId && interactionResponse.processDefinitionId) {\n                this.submitApproveWithBizDefKey(bizBillID, bizDefKey, options, interactionResponse).subscribe(() => {\n                  resolve();\n                });\n              } else {\n                resolve();\n              }\n            });\n          }));\n        } else {\n          return of(null);\n        }\n      }),\n      catchError(\n        error => {\n          this.formLoadingService.hide();\n          // this.formErrorService.exception(this.languageService.submitFaild, error);\n          return of(error);\n        }\n      )\n    );\n  }\n  /**\n   * æäº¤å®¡æ¹(å¸¦å¥å£åæ®ä½¿ç¨wfæ§ä»¶)\n   * @param bizBillID ä¸å¡åæ®Id\n   * @param bizDefKey å¥å£åæ®Id\n   * @param options ä¸ä¸æåæ°\n   * @param variables å¯éåæ°\n   */\n  public submitApproveWithBizDefKeyUseControl(bizBillID: string, bizDefKey: string, options: any = {}, variables?: any) {\n    if (!bizBillID) {\n      this.notifyService.warning(this.languageService.unallowEmptyBizBillId, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!bizDefKey) {\n      this.notifyService.warning(this.languageService.bizDefKeyRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!options || typeof options !== 'object') {\n      options = {};\n    }\n    const payload: any = {\n      dataId: bizBillID,\n      bizDefKey,\n      ...options\n    };\n    // å¤çvariablesåæ°\n    if (variables) {\n      if (variables.startsWith('{') && variables.endsWith('}')) {\n        try {\n          variables = JSON.parse(variables);\n        } catch {\n          variables = {};\n        }\n      }\n      payload.variables = variables;\n    }\n    return this.wfTaskHandlerService && this.wfTaskHandlerService.startProcess(payload);\n  }\n  /**\n   * å­è¡¨æäº¤å®¡æ¹\n   * @param bizDefKey å¥å£åæ®Id\n   * @param bizId ä¸å¡åæ®Idï¼ä¸»è¡¨ï¼\n   * @param childBizId ä¸å¡åæ®Idï¼ä»è¡¨ï¼\n   * @param options ä¸ä¸æåæ°\n   * @param variables å¯éåæ°\n   */\n  public childSubmitApproveWithBizDefKey(bizDefKey: string, bizId: string, childBizId: string, options: any = {}, variables?: any): Observable<any> {\n    // å¥å£åæ®ä¸è½ä¸ºç©º\n    if (!bizDefKey) {\n      this.notifyService.warning(this.languageService.bizDefKeyRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    // ä¸»ä¸å¡åæ®Idä¸è½ä¸ºç©º\n    if (!bizId) {\n      this.notifyService.warning(this.languageService.unallowEmptyBizBillId, { hideTitle: true });\n      return EMPTY;\n    }\n    // ä»è¡¨ä¸å¡åæ®Idä¸è½ä¸ºç©º\n    if (!childBizId) {\n      this.notifyService.warning(this.languageService.unallowEmptyChildBizBillId, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!options || typeof options !== 'object') {\n      options = {};\n    }\n    const payload: any = {\n      dataId: `${bizId},${childBizId}`,\n      bizDefKey,\n      ...options\n    };\n    // å¤çvariablesåæ°\n    if (variables) {\n      if (variables.startsWith('{') && variables.endsWith('}')) {\n        try {\n          variables = JSON.parse(variables);\n        } catch {\n          variables = {};\n        }\n      }\n      payload.variables = variables;\n    }\n    return this.wfTaskHandlerService && this.wfTaskHandlerService.startProcess(payload);\n  }\n  /**\n   * åæ¶å®¡æ¹\n   * @deprecated å·²åºå¼ï¼è¯·ä½¿ç¨cancelSubmit\n   */\n  public cancelApprove(bizBillID: string): Observable<any> {\n    if (!bizBillID) {\n      this.notifyService.warning(this.languageService.unallowEmptyBizBillId, { hideTitle: true });\n      return empty();\n    }\n\n    const actionUri = 'canceltosubmitvoaction';\n\n    const restService = this.beActionService.getRestService();\n\n    const body = {\n      requestInfo: restService.buildRequestInfo(),\n      bizInstID: bizBillID,\n    };\n\n    this.formLoadingService.show();\n\n    const action$ = this.beActionService.executeAction(actionUri, 'PUT', null, null, body);\n    return action$.pipe(\n      switchMap(() => {\n        if (this.repository) {\n          const updating$ = this.repository.updateById(bizBillID);\n          return updating$.pipe(tap(() => {\n            this.formLoadingService.hide();\n            // this.notifyService.info(this.languageService.cancelApproveSuccess);\n            FormNotifyStrategyService.success(this.notifyService, this.languageService.cancelApproveSuccess);\n          }));\n        } else {\n          this.formLoadingService.hide();\n          // this.notifyService.info(this.languageService.cancelApproveSuccess);\n          FormNotifyStrategyService.success(this.notifyService, this.languageService.cancelApproveSuccess);\n          return of();\n        }\n      }\n      ),\n      catchError(error => {\n        this.formLoadingService.hide();\n        // this.formErrorService.exception(this.languageService.cancelApproveFailed, error);\n        return of(error);\n      }));\n  }\n  /**\n   * åæ¶å®¡æ¹(æ¯æä¸»è¡¨ãå­è¡¨)\n   * @param procInstId æµç¨å®ä¾Id\n   */\n  public cancelSubmit(procInstId: string): Observable<any> {\n    if (!procInstId) {\n      this.notifyService.warning(this.languageService.procInsIdRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    return this.wfTaskHandlerService && this.wfTaskHandlerService.cancelSubmit({ procInstId: procInstId });\n  }\n  /**\n   * æ¥çæµç¨å¾\n   * @param procInstId æµç¨å®ä¾ID\n   */\n  viewProcess(procInstId: string) {\n    if (this.flowchartService) {\n      if (!procInstId) {\n        this.notifyService.warning(this.languageService.noProcessInstanceId, { hideTitle: true });\n        return;\n      }\n      return this.flowchartService.viewFlowChart(procInstId);\n    }\n  }\n\n\n  /**\n   * è½¬æ¢éç½®å¤§å°å\n   * @param jsonObj Object\n   * @deprecated\n   */\n  private switchPrefixLetter(jsonObj: any, toUpper: boolean): any {\n    if (typeof (jsonObj) === 'object' && !!jsonObj) {\n      if (Array.isArray(jsonObj)) {\n        for (var i = 0; i < jsonObj.length; i++) {\n          this.switchPrefixLetter(jsonObj[i], toUpper);\n        }\n      } else {\n        for (const key of Object.keys(jsonObj)) {\n          var newKey = (toUpper ? key.substring(0, 1).toUpperCase() : key.substring(0, 1).toLowerCase()) + key.substring(1);\n          jsonObj[newKey] = jsonObj[key];\n          if (typeof jsonObj[key] === 'object') {\n            this.switchPrefixLetter(jsonObj[key], toUpper);\n          }\n          delete (jsonObj[key]);\n        }\n      }\n    }\n    return jsonObj;\n  }\n}\nexport { ApproveService };\n","import { Injectable, Injector, Optional } from '@angular/core';\nimport { EMPTY } from 'rxjs';\nimport { FormMessageService } from './form-message.service';\nimport { LanguageService } from './languag.service';\nimport { BefRepository } from '@farris/bef';\nimport { CommandContext, Entity, FrameContext } from '@farris/devkit';\nimport { CloudprintService, OutputOptions, SourceOptions, OutputType, FileType, SourceFilterOptions, PrintType } from '@gsp-svc/cloudprint';\nimport { FormNotifyService } from './form-notify.service';\n// tslint:disable: unified-signatures\n// tslint:disable: max-line-length\n/**\n * æå°æå¡\n * @Scope FrameComponent\n */\n@Injectable()\nclass PrintService {\n  /**\n   * å®ä½ä»åº\n   */\n  private repository: BefRepository<Entity>;\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private msgService: FormMessageService,\n    private languageService: LanguageService,\n    private printService: CloudprintService,\n    @Optional() private formNotifyService: FormNotifyService,\n  ) {\n  }\n\n  /**\n   * æå°åæ®\n   * @param beMetaId BEåæ°æ®æ è¯\n   * @param bizBillId ä¸å¡åæ®æ è¯\n   */\n  public printSingle(beMetaId: string, bizBillId: string) {\n    if (!bizBillId) {\n      // this.msgService.error(this.languageService.unallowEmptyBizBillId);\n      this.showWarning(this.languageService.unallowEmptyBizBillId);\n      return EMPTY;\n    }\n    return this.printArray(beMetaId, [bizBillId]);\n  }\n  /**\n   * æå°åæ®ï¼éè¿idæidsï¼\n   * @param beMetaId beåæ°æ®Id\n   * @param ids åæ®idæids\n   */\n  public printByIds(beMetaId: string, ids: string) {\n    if (!ids) {\n      // this.msgService.error(this.languageService.unallowEmptyBizBillId);\n      this.showWarning(this.languageService.unallowEmptyBizBillId);\n      return EMPTY;\n    }\n    const dataIds: Array<string> = ids.split(',').filter(item => item);\n    return this.printArray(beMetaId, dataIds);\n  }\n  /**\n   * æå°åæ®ï¼å¸¦ç»´åº¦ï¼\n   * @param beMetaId beåæ°æ®Id\n   * @param ids åæ®idæids\n   * @param dim1 ç»´åº¦1å¼\n   * @param dim2 ç»´åº¦2å¼\n   * @param billCategoryId åæ®ç±»åId\n   */\n  public printByIdsWithDimension(beMetaId: string, ids: string, dim1: string, dim2: string, billCategoryId?: string) {\n    if (!ids) {\n      // this.msgService.error(this.languageService.unallowEmptyBizBillId);\n      this.showWarning(this.languageService.unallowEmptyBizBillId);\n      return EMPTY;\n    }\n    const dataIds: Array<string> = ids.split(',').filter(item => item);\n    return this.printArray(beMetaId, dataIds, dim1, dim2, billCategoryId);\n  }\n  /**\n   * æå°å¤ä¸ªåæ®\n   * @param beMetaId BEåæ°æ®æ è¯\n   * @param dataIds ä¸å¡åæ®æ è¯æ°ç»\n   * @param dim1 ç»´åº¦1\n   * @param dim2 ç»´åº¦2\n   * @param billCategoryId ä¸å¡åæ®ç±»åId\n   */\n  public printArray(beMetaId: string, dataIds: string[], dim1?: any, dim2?: any, billCategoryId?: string) {\n    if (!dataIds || dataIds.length === 0) {\n      // this.msgService.error(this.languageService.unallowEmptyBizBillId);\n      this.showWarning(this.languageService.unallowEmptyBizBillId);\n      return EMPTY;\n    }\n    const sourceOptions: SourceOptions = this.buildSourceOptions({\n      dataIds: dataIds,\n      sourceId: beMetaId\n    });\n\n    const outputOptions: OutputOptions = this.buildOutputOptions();\n\n    if (typeof dim1 !== 'undefined') {\n      sourceOptions.FirstDimensionVal = dim1;\n    }\n    if (typeof dim2 !== 'undefined') {\n      sourceOptions.SecondDimensionVal = dim2;\n    }\n    if (typeof billCategoryId !== 'undefined') {\n      sourceOptions.billCategoryId = billCategoryId;\n    }\n    return this.printService.outputBEData(sourceOptions, outputOptions, 'tab');\n  }\n\n  /**\n   * æç§BEåæ°æ¹å¼æ¹éæå°åæ®\n   * @param beMetaId BEåæ°æ®æ è¯\n   * @param filterCondition è¿æ»¤æ¡ä»¶\n   * @param sortCondition æåºæ¡ä»¶\n   * @param includeChildData åå«å­è¡¨æ°æ®\n   */\n  public printMulti(beMetaId: string, filterCondition: string, sortCondition: string, includeChildData: boolean = true) {\n    const entryFilter = { 'isUsePagination': false, 'filterConditions': [], 'sortConditions': [], 'pagination': null };\n    if (filterCondition) {\n      // ç»ä¸çº æ­£æåä¸ä¸ªè¿æ»¤æ¡ä»¶çRelation\n      const filters = JSON.parse(filterCondition);\n      if (filters && filters.length > 0) {\n        filters[filters.length - 1].Relation = 0;\n      }\n      entryFilter.filterConditions = filters;\n    }\n\n    if (sortCondition) {\n      entryFilter.sortConditions = JSON.parse(sortCondition);\n    }\n    // sfo:SourceFilterOptions\n    const sourceFilterOptions: SourceFilterOptions = this.buildSourceFilterOptions({ sourceId: beMetaId, entryFilter, includeChildData });\n    const outputOptions: OutputOptions = this.buildOutputOptions();\n    return this.printService.outputBEDataWithFilter(sourceFilterOptions, outputOptions, 'tab');\n  }\n  /**\n   * æç§BEåæ°æ¹å¼æ¹éæå°åæ®(å¸¦ç»´åº¦)\n   * @param beMetaId BEåæ°æ®æ è¯\n   * @param filterCondition è¿æ»¤æ¡ä»¶\n   * @param sortCondition æåºæ¡ä»¶\n   * @param dim1 ç»´åº¦1value\n   * @param dim2 ç»´åº¦2value\n   * @param billCategoryId ä¸å¡åæ®ç±»åId\n   * @param includeChildData åå«å­è¡¨æ°æ®\n   */\n  public printMultiWithDimension(beMetaId: string, filterCondition: string, sortCondition: string, dim1: string, dim2: string, billCategoryId?: string, includeChildData: boolean = true) {\n    const entryFilter = { 'isUsePagination': false, 'filterConditions': [], 'sortConditions': [], 'pagination': null };\n    if (filterCondition) {\n      // ç»ä¸çº æ­£æåä¸ä¸ªè¿æ»¤æ¡ä»¶çRelation\n      const filters = JSON.parse(filterCondition);\n      if (filters && filters.length > 0) {\n        filters[filters.length - 1].Relation = 0;\n      }\n      entryFilter.filterConditions = filters;\n    }\n\n    if (sortCondition) {\n      entryFilter.sortConditions = JSON.parse(sortCondition);\n    }\n    const sfo: SourceFilterOptions = this.buildSourceFilterOptions({ sourceId: beMetaId, entryFilter, includeChildData });\n    if (typeof dim1 !== 'undefined') {\n      sfo.FirstDimensionVal = dim1;\n    }\n    if (typeof dim2 !== 'undefined') {\n      sfo.SecondDimensionVal = dim2;\n    }\n    if (typeof billCategoryId !== 'undefined') {\n      sfo.billCategoryId = billCategoryId;\n    }\n    const outputOptions: OutputOptions = this.buildOutputOptions();\n    return this.printService.outputBEDataWithFilter(sfo, outputOptions, 'tab');\n  }\n  /**\n   * æé SourceOptions\n   * @param options options\n   */\n  private buildSourceOptions(options: { dataIds: string[], sourceId: string, [prop: string]: any }): SourceOptions {\n    const so: SourceOptions = {\n      DataIds: options && options.dataIds || undefined,\n      SourceId: options && options.sourceId || undefined,\n      FirstDimensionVal: options && options.dim1 || undefined,\n      SecondDimensionVal: options && options.dim2 || undefined,\n      RetrieveParam: options && options.retrieveParam || undefined,\n      FormatId: options && options.formatId || undefined,\n      billCategoryId: options && options.billCategoryId || undefined,\n      ServiceUnit: options && options.serviceUnit || undefined,\n      currentPage: options && options.currentPage || undefined,\n      pageRowCount: options && options.pageRowCount || undefined,\n      queryType: options && options.queryType || undefined,\n      queryServiceId: options && options.queryServiceId || undefined,\n      queryParam: options && options.queryParam || undefined\n    };\n    return so;\n  }\n  /**\n   * æé OutputOptions\n   * @param options options\n   */\n  private buildOutputOptions(options?: { [prop: string]: any }): OutputOptions {\n    const oo: OutputOptions = {\n      OutputType: options && options.outputType || OutputType.PRINT,\n      FileType: options && options.fileType || FileType.Html5,\n      Path: options && options.path || undefined,\n      DeviceId: options && options.deviceId || undefined,\n      printJob: options && options.printJob || undefined,\n      printerName: options && options.printerName || undefined,\n      printSetting: options && options.printSetting || undefined,\n      printType: options && options.printType || PrintType.Form\n    };\n    return oo;\n  }\n  /**\n   * æé SourceFilterOptions\n   * @param options options\n   */\n  private buildSourceFilterOptions(options: { sourceId: string, [prop: string]: any }): SourceFilterOptions {\n    const entryFilter = { 'isUsePagination': false, 'filterConditions': [], 'sortConditions': [], 'pagination': null };\n    const sfo: SourceFilterOptions & { [prop: string]: any } = {\n      SourceId: options.sourceId,\n      EntityFilter: options && options.entryFilter || entryFilter,\n      FirstDimensionVal: options && options.dim1 || undefined,\n      SecondDimensionVal: options && options.dim2 || undefined,\n      FormatId: options && options.formatId || undefined,\n      ServiceUnit: options && options.serviceUnit || undefined,\n      billCategoryId: options && options.billCategoryId || undefined,\n      currentPage: options && options.currentPage || undefined,\n      pageRowCount: options && options.pageRowCount || undefined,\n      queryParam: options && options.queryParam || undefined,\n      queryServiceId: options && options.queryServiceId || undefined,\n      queryType: options && options.queryType || undefined,\n      includeChildData: options && options.hasOwnProperty('includeChildData') ? options.includeChildData : true\n    };\n    return sfo;\n  }\n  /**\n   * å±ç¤ºéè¯¯æ¶æ¯\n   * @param message éè¯¯æ¶æ¯\n   */\n  private showWarning(message: string) {\n    if (this.notifyService) {\n      this.notifyService.warning(message, { hideTitle: true });\n    } else if (this.msgService) {\n      this.msgService.error(message);\n    }\n  }\n  private get notifyService(): FormNotifyService | null {\n    if (this.formNotifyService) {\n      return this.formNotifyService;\n    } else if (this.injector) {\n      return this.injector.get<FormNotifyService>(FormNotifyService, null);\n    }\n    return null;\n  }\n  private get commandContext(): CommandContext | null {\n    return this['context'] || null;\n  }\n  private get frameContext(): FrameContext | null {\n    return this.commandContext && this.commandContext.frameContext || null;\n  }\n  private get injector(): Injector | null {\n    return this.frameContext && this.frameContext.injector || null;\n  }\n}\n\nexport { PrintService };\n","/**\n * éä»¶ä¿¡æ¯å®ä¹\n */\ninterface AttachmentInfo {\n\n  /**\n   * éä»¶id\n   */\n  attachmentId: string;\n\n  /**\n   * éä»¶åç§°\n   */\n  fileName: string;\n}\n\n\n/**\n * æå¡å¨ç«¯æéçéä»¶ä¿¡æ¯å®ä¹\n */\ninterface ServerAttachmentInfo {\n\n  /**\n   * è¡¨åè·¯å¾\n   */\n  NodeCodes: string[];\n\n  /**\n   * ä¸»é®è·¯å¾\n   */\n  HiretryIds: string[];\n\n  /**\n   * éä»¶idæ°ç»ï¼æ¹éæ°å¢æ¶ä½¿ç¨ï¼\n   */\n  AttachmentIds?: string[];\n\n  /**\n   * éä»¶idï¼æ´æ°æ¶ä½¿ç¨ï¼\n   */\n  AttachmentId?: string;\n}\n/**\n * éä»¶udtæåºå­æ®µ\n */\nconst ATTACHMENT_ORDER_FIELD = 'fileSortOrder';\n\nexport { AttachmentInfo, ServerAttachmentInfo, ATTACHMENT_ORDER_FIELD };\n","import { UploadFileInfo } from '@gsp-svc/formdoc-upload';\nimport { AttachmentInfo } from './types';\n\n/**\n * éä»¶ä¿¡æ¯å¤çå·¥å·ç±»\n */\nclass AttachmentUtil {\n\n  /**\n   * è½¬æ¢ä¸ºéä»¶ä¿¡æ¯æ°ç»\n   */\n  public static convertToAttachmentInfos(fileInfos: UploadFileInfo[]): AttachmentInfo[] {\n    if (!fileInfos) {\n      return [];\n    }\n    const attachmentInfos: AttachmentInfo[] = fileInfos.map((fileInfo: UploadFileInfo) => {\n      return this.convertToAttachmentInfo(fileInfo);\n    });\n    return attachmentInfos;\n  }\n\n  /**\n   * è½¬æ¢ä¸ºéä»¶ä¿¡æ¯\n   */\n  public static convertToAttachmentInfo(fileInfo: UploadFileInfo): AttachmentInfo {\n    const attachmentInfo: AttachmentInfo = {\n      attachmentId: fileInfo.metadataId,\n      fileName: fileInfo.fileName\n    };\n    return attachmentInfo;\n  }\n\n  /**\n   * è·åéä»¶åè¡¨ä¸­çç¬¬ä¸ä¸ªéä»¶\n   */\n  public static getFirstAttachmentInfo(attachmentInfos: AttachmentInfo[]) {\n    if (!attachmentInfos || attachmentInfos.length === 0) {\n      return;\n    }\n    const firstAttachmentInfo = attachmentInfos[0];\n    return firstAttachmentInfo;\n  }\n\n  /**\n   * æåéä»¶idæ°ç»\n   */\n  public static peekAttachmentIds(attachmentInfos: AttachmentInfo[]) {\n    if (!attachmentInfos) {\n      attachmentInfos = [];\n    }\n    const attachmentIds = attachmentInfos.map((attachmentInfo: AttachmentInfo) => {\n      return attachmentInfo.attachmentId;\n    });\n\n    return attachmentIds;\n  }\n\n}\n\nexport { AttachmentUtil };\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { tap, switchMap, map } from 'rxjs/operators';\nimport { FrameContext, Entity, BindingData, BindingPathConverter } from '@farris/devkit';\nimport { BefRepository, BefDataPathUtil, ResponseInfo } from '@farris/bef';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { AttachmentInfo, ServerAttachmentInfo } from './types';\nimport { AttachmentUtil } from './attachment.util';\n\n/**\n * éä»¶è°ç¨\n */\n@Injectable()\nclass AttachmentDataService {\n\n  /**\n   * å®ä½ä»åº\n   */\n  private get repository(): BefRepository<Entity> {\n    return this.frameContext.repository as BefRepository<Entity>;\n  }\n\n  /**\n   * ç»å®æ°æ®\n   */\n  private get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  constructor(private frameContext: FrameContext, private loadingService: FormLoadingService) {\n  }\n\n  /**\n   * æ´æ°éä»¶ä¿¡æ¯\n   */\n  public updateRow(attachmentInfoFieldPath: string, attachmentInfo: AttachmentInfo): Observable<any> {\n    const restService = this.repository.restService;\n    const baseUri = restService.baseUri;\n    const updateUri = `${baseUri}/service/updateattachment`;\n    const serverAttachInfo = this.createUpdateAttachInfo(attachmentInfoFieldPath, attachmentInfo);\n    const body = {\n      updateAttachInfo: serverAttachInfo,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    this.loadingService.show();\n    return restService.invoke(updateUri, 'PUT', null, options).pipe(\n      switchMap((responseInfo: ResponseInfo) => {\n        return this.syncAttachmentInfosToClient();\n      }),\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * éè¿å±æ§åæ´æ°éä»¶ä¿¡æ¯\n   * @param attachmentInfoFieldPath éä»¶å­æ®µ\n   * @param attachmentInfo éä»¶ä¿¡æ¯\n   */\n  public updateRowWithPropertyName(attachmentInfoFieldPath: string, attachmentInfo: AttachmentInfo): Observable<any> {\n    const restService = this.repository.restService;\n    const baseUri = restService.baseUri;\n    const updateUri = `${baseUri}/service/updateattachmentwithproptyname`;\n    const serverAttachInfo = this.createUpdateAttachInfo(attachmentInfoFieldPath, attachmentInfo);\n    const propertyName = attachmentInfoFieldPath.split('/').filter(p => p).pop();\n    const body = {\n      updateAttachInfo: serverAttachInfo,\n      propertyName,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    this.loadingService.show();\n    return restService.invoke(updateUri, 'PUT', null, options).pipe(\n      switchMap((responseInfo: ResponseInfo) => {\n        return this.syncAttachmentInfosToClient();\n      }),\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ¹éåå»ºéä»¶è¡æ°æ®\n   */\n  public updateRows(attachmentInfoFieldPath: string, attachmentInfos: AttachmentInfo[]): Observable<any> {\n    const restService = this.repository.restService;\n    const baseUri = restService.baseUri;\n    const updateUri = `${baseUri}/service/batchuploadattachment`;\n    const serverAttachInfo = this.createBatchCreateAttachInfo(attachmentInfoFieldPath, attachmentInfos);\n    const isRootEntity = serverAttachInfo.NodeCodes.length === 0;\n\n    const body = {\n      batchUploadInfo: serverAttachInfo,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    return restService.invoke(updateUri, 'PUT', null, options).pipe(\n      switchMap((responseInfo: ResponseInfo) => {\n        return this.appendAttachmentInfosToClient(responseInfo.returnValue, isRootEntity);\n      }),\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ¹éåå»ºéä»¶è¡æ°æ®\n   */\n  public updateRowsWithConfigs(attachmentInfoFieldPath: string, attachmentInfos: AttachmentInfo[], configs: { [prop: string]: any }): Observable<any> {\n    const restService = this.repository.restService;\n    const baseUri = restService.baseUri;\n    const updateUri = `${baseUri}/service/batchuploadattachment`;\n    const serverAttachInfo = this.createBatchCreateAttachInfo(attachmentInfoFieldPath, attachmentInfos);\n    // const isRootEntity = serverAttachInfo.NodeCodes.length === 0;\n\n    const body = {\n      batchUploadInfo: serverAttachInfo,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    return restService.invoke(updateUri, 'PUT', null, options).pipe(\n      switchMap((responseInfo: ResponseInfo) => {\n        return this.appendAttachmentInfos(responseInfo.returnValue, configs);\n      }),\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ ¹æ®å±æ§åæ¹éåå»ºéä»¶è¡æ°æ®\n   */\n  public updateRowsWithPropertyName(attachmentInfoFieldPath: string, attachmentInfos: AttachmentInfo[]): Observable<any> {\n    const restService = this.repository.restService;\n    const baseUri = restService.baseUri;\n    const updateUri = `${baseUri}/service/batchuploadattachmentwithproptyname`;\n    const serverAttachInfo = this.createBatchCreateAttachInfo(attachmentInfoFieldPath, attachmentInfos);\n    const isRootEntity = serverAttachInfo.NodeCodes.length === 0;\n    const propertyName = attachmentInfoFieldPath.split('/').filter(p => p).pop();\n\n    const body = {\n      batchUploadInfo: serverAttachInfo,\n      propertyName,\n      requestInfo: restService.buildRequestInfo()\n    };\n    const options = {\n      body: body\n    };\n    return restService.invoke(updateUri, 'PUT', null, options).pipe(\n      switchMap((responseInfo: ResponseInfo) => {\n        return this.appendAttachmentInfosToClient(responseInfo.returnValue, isRootEntity);\n      }),\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n\n  /**\n   * åå»ºæå¡å¨ç«¯éè¦çæ´æ°ä¿¡æ¯\n   */\n  private createUpdateAttachInfo(attachmentInfoFieldPath: string, attachmentInfo: AttachmentInfo): ServerAttachmentInfo {\n\n    const attachmentId = attachmentInfo.attachmentId;\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    parentBindingPathArray.pop();\n    const nodeCodes = BefDataPathUtil.convertToObjectCodes(parentBindingPathArray, this.bindingData);\n    const hiretryIds = BefDataPathUtil.convertToDataIdsForUpdate(parentBindingPathArray, this.bindingData);\n\n    const serverAttachInfo: ServerAttachmentInfo = {\n      NodeCodes: nodeCodes,\n      HiretryIds: hiretryIds,\n      AttachmentIds: [attachmentId],\n      AttachmentId: attachmentId\n    };\n\n    return serverAttachInfo;\n  }\n\n  /**\n   * åå»ºæå¡å¨ç«¯éè¦çæ¹éæ°å¢éä»¶ä¿¡æ¯\n   */\n  private createBatchCreateAttachInfo(attachmentInfoFieldPath: string, attachmentInfo: AttachmentInfo[]): ServerAttachmentInfo {\n    const attachmentIds = AttachmentUtil.peekAttachmentIds(attachmentInfo);\n\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    parentBindingPathArray.pop();\n    const nodeCodes = BefDataPathUtil.convertToObjectCodes(parentBindingPathArray, this.bindingData);\n    const hiretryIds = BefDataPathUtil.convertToDataIdsForAdd(parentBindingPathArray, this.bindingData);\n\n    const serverAttachInfo = {\n      NodeCodes: nodeCodes,\n      HiretryIds: hiretryIds,\n      AttachmentIds: attachmentIds,\n      AttachmentId: null\n    };\n\n    return serverAttachInfo;\n  }\n\n  /**\n   * åæ­¥æå¡å¨ç«¯ææ°ä¿¡æ¯å°å®¢æ·ç«¯\n   * @todo:\n   * 1ãä¸»å¯¹è±¡æ¹éæ°å¢æ¶ä¸æ¯æ\n   */\n  public syncAttachmentInfosToClient() {\n    const rootDataId = this.bindingData.list.currentId;\n    return this.repository.updateEntityById(rootDataId);\n  }\n\n  /**\n   * è¿½å ä¸»è¡¨æ°æ®å°å®¢æ·ç«¯\n   */\n  public appendAttachmentInfosToClient(listData: any[], isRootEntity: boolean): Observable<any[]> {\n    if (isRootEntity === true) {\n      const entities = this.repository.buildEntities(listData);\n      this.repository.entityCollection.addEntities(entities);\n      return of(listData);\n    } else {\n      const rootDataId = this.bindingData.list.currentId;\n      return this.repository.updateEntityById(rootDataId).pipe(\n        map(() => listData)\n      );\n    }\n  }\n  public appendAttachmentInfos(listData: any[], keyValues: { [prop: string]: any }): Observable<any[]> {\n    const entities = this.repository.buildEntities(listData);\n    this.repository.entityCollection.addEntities(entities);\n    // æ´æ°å®ä½ä½¿ä¹äº§çåæ´é\n    this.updateEntities(entities, keyValues);\n    return of(listData);\n  }\n  private updateEntities(entities: Entity[], keyValues: { [prop: string]: any }) {\n    entities.forEach((entity: Entity) => {\n      this.updateEntity(entity, keyValues);\n    });\n  }\n  private updateEntity(target: Entity, keyValues: { [prop: string]: any }) {\n    Object.keys(keyValues).forEach((key: string) => {\n      this.setValueByPath(target, key, keyValues[key]);\n    });\n  }\n  private setValueByPath(target: object, path: string, value: any) {\n    if (target) {\n      const paths = path.split('.');\n      if (paths.length <= 1) {\n        target[path] = value;\n      } else {\n        paths.slice(0, -1).reduce((prev, path) => {\n          if (!(prev.hasOwnProperty(path) || prev['__proto__'].hasOwnProperty(path))) {\n            prev[path] = {};\n          }\n          return prev[path];\n        }, target)[paths[paths.length - 1]] = value;\n      }\n    }\n  }\n}\n\n\nexport { AttachmentDataService };\n","import { Injectable, InjectFlags, Optional } from '@angular/core';\nimport { Observable, from, of, empty, EMPTY } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { UploadDialogService, UploadFileInfo, UploadLimit, DownloadService, FileState } from '@gsp-svc/formdoc-upload';\nimport { FileViewerService } from '@gsp-svc/file-viewer';\nimport { FrameContext, BindingData, BindingPathConverter, BindingList, DataPathUtil, DataPathCreator, EntityList, Entity } from '@farris/devkit';\nimport { FormNotifyService } from '../form-notify.service';\nimport { AttachmentUtil } from './attachment.util';\nimport { AttachmentDataService } from './attachment-data.service';\nimport { LanguageService } from '../languag.service';\nimport { EntityService } from '../entity-services/index';\nimport { BefRepository } from '@farris/bef';\n\n// tslint:disable: max-line-length\n/**\n * éä»¶æå¡\n */\n@Injectable()\nclass AttachmentService {\n\n  /**\n   * é»è®¤æ ¹ç®å½\n   */\n  private defaultRootDirId = '';\n\n  /**\n   * é»è®¤ç¶è·¯å¾\n   */\n  private get defaultParentDirName(): string {\n    return this.frameContext.bindingData.list.currentId;\n  }\n\n  /**\n   * ç»å®æ°æ®\n   */\n  private get bindingData(): BindingData {\n    return this.frameContext.bindingData;\n  }\n\n  /**\n   * å¤è¯­æå¡\n   */\n  private languageService: LanguageService;\n\n  /**\n   * éä»¶é¢è§æå¡\n   */\n  private fileViewerService: FileViewerService;\n\n  /**\n   * å®ä½æå¡\n   */\n  private entityService: EntityService;\n\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private frameContext: FrameContext,\n    private attachDataService: AttachmentDataService,\n    private notifyService: FormNotifyService,\n    private uploadDialogService: UploadDialogService,\n    @Optional() private downloadService: DownloadService\n  ) {\n    this.setLanguageService();\n    this.fileViewerService = this.frameContext.injector.get<FileViewerService>(FileViewerService, null, InjectFlags.Optional);\n    this.entityService = this.frameContext.injector.get<EntityService>(EntityService, null, InjectFlags.Optional);\n    if (!this.downloadService && typeof DownloadService !== 'undefined') {\n      this.downloadService = this.frameContext.injector.get<DownloadService>(DownloadService, null);\n    }\n  }\n\n  /**\n   * è®¾ç½®è¯­è¨æå¡\n   */\n  private setLanguageService() {\n    const injector = this.frameContext.injector;\n    this.languageService = injector.get<LanguageService>(LanguageService, null, InjectFlags.Optional);\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * ä¸ä¼ åä¸ªæä»¶\n   * @param attachmentIdPath éä»¶åç å­æ®µçè·¯å¾ï¼å½¢å¦/attachInfo/attachmentIdï¼\n   * @param attachmentNamePath éä»¶åç§°å­æ®µçè·¯å¾\n   */\n  public uploadAndUpdateRow(attachmentInfoFieldPath: string, rootDirId?: string, parentDirName?: string, fileType?: string, id?: string): Observable<any> {\n    const rootId = rootDirId ? rootDirId : this.defaultRootDirId;\n    const formId = parentDirName ? parentDirName : this.defaultParentDirName;\n    if (!rootId || !formId) {\n      throw new Error('rootDirIdåparentDirNameä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n\n    const uploadLimit: UploadLimit = new UploadLimit();\n    uploadLimit.fileCount = 1;\n    if (fileType) {\n      uploadLimit.fileType = fileType;\n    }\n    // è·åèçéä»¶idæ°ç»\n    const attachmentIdList = [];\n    let currentItem = null;\n    if (id) {\n      // ä¿®æ­£å½åè¡\n      const bindingList: BindingList = this.frameContext.bindingData.getList();\n      if (bindingList.currentId !== id) {\n        bindingList.setCurrentId(id, true, true);\n      }\n      // å¦ææå®äºidåè·åæå®idçè¡\n      currentItem = this.getSpecialRow(attachmentInfoFieldPath, id);\n    } else {\n      // æ²¡ææå®åä½¿ç¨å½åè¡ï¼å¯è½å­å¨å½åè¡åäºä»¶è¡ä¸ä¸è´çæåµï¼æ­¤æ¶åºè¯¥å¨å½ä»¤ä¸­ä¼ éidåæ°\n      currentItem = this.getCurrentRow(attachmentInfoFieldPath);\n    }\n    if (currentItem && currentItem.primaryKeyValue) {\n      const attachmentIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, [currentItem.primaryKeyValue]);\n      if (attachmentIds && attachmentIds.length > 0) {\n        attachmentIdList.push.apply(attachmentIdList, attachmentIds);\n      }\n    }\n\n    const dialog$ = from(this.uploadDialogService.uploadFileWithLimit(formId, rootId, uploadLimit, attachmentIdList));\n    const result$ = dialog$.pipe(\n      switchMap((fileInfos: UploadFileInfo[]) => {\n        if (!fileInfos || fileInfos.length === 0) {\n          this.notifyService.warning(this.languageService.plsUploadFirst, { hideTitle: true });\n          return empty();\n        }\n        // è¿æ»¤åºstateä¸ºæ°å¢çéä»¶\n        fileInfos = fileInfos.filter((fileInfo: UploadFileInfo) => {\n          if (fileInfo.hasOwnProperty('state')) {\n            return fileInfo.state === FileState.New;\n          }\n          return true;\n        });\n        if (fileInfos.length === 0) {\n          return of(true);\n        }\n        // æ¯å¦ä¸ä¼ å¤æ­\n        const attachmentInfos = AttachmentUtil.convertToAttachmentInfos(fileInfos);\n        const firstAttachmentInfo = AttachmentUtil.getFirstAttachmentInfo(attachmentInfos);\n        return this.attachDataService.updateRow(attachmentInfoFieldPath, firstAttachmentInfo);\n      })\n    );\n\n    return result$;\n  }\n  /**\n   * ä¸ä¼ åä¸ªæä»¶ï¼æ¯æå¤åï¼\n   * @param attachmentInfoFieldPath éä»¶åç å­æ®µçè·¯å¾ï¼å½¢å¦/attachInfo/attachmentIdï¼\n   * @param rootDirId éä»¶å­å¨æ ¹ç®å½\n   * @param parentDirName éä»¶å­å¨ç®å½\n   * @param fileType æä»¶ç±»åï¼like .txt,.docx\n   */\n  public uploadAndUpdateRowWithPropertyName(attachmentInfoFieldPath: string, rootDirId?: string, parentDirName?: string, fileType?: string, id?: string): Observable<any> {\n    const rootId = rootDirId ? rootDirId : this.defaultRootDirId;\n    const formId = parentDirName ? parentDirName : this.defaultParentDirName;\n    if (!rootId || !formId) {\n      throw new Error('rootDirIdåparentDirNameä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n\n    const uploadLimit: UploadLimit = new UploadLimit();\n    uploadLimit.fileCount = 1;\n    if (fileType) {\n      uploadLimit.fileType = fileType;\n    }\n\n    // è·åèçéä»¶idæ°ç»\n    const attachmentIdList = [];\n    let currentItem = null;\n    if (id) {\n      // ä¿®æ­£å½åè¡\n      const bindingList: BindingList = this.frameContext.bindingData.getList();\n      if (bindingList.currentId !== id) {\n        bindingList.setCurrentId(id, true, true);\n      }\n      // å¦ææå®äºidåè·åæå®idçè¡\n      currentItem = this.getSpecialRow(attachmentInfoFieldPath, id);\n    } else {\n      // æ²¡ææå®åä½¿ç¨å½åè¡ï¼å¯è½å­å¨å½åè¡åäºä»¶è¡ä¸ä¸è´çæåµï¼æ­¤æ¶åºè¯¥å¨å½ä»¤ä¸­ä¼ éidåæ°\n      currentItem = this.getCurrentRow(attachmentInfoFieldPath);\n    }\n    if (currentItem && currentItem.primaryKeyValue) {\n      const attachmentIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, [currentItem.primaryKeyValue]);\n      if (attachmentIds && attachmentIds.length > 0) {\n        attachmentIdList.push.apply(attachmentIdList, attachmentIds);\n      }\n    }\n\n    const dialog$ = from(this.uploadDialogService.uploadFileWithLimit(formId, rootId, uploadLimit, attachmentIdList));\n    const result$ = dialog$.pipe(\n      switchMap((fileInfos: UploadFileInfo[]) => {\n        if (!fileInfos || fileInfos.length === 0) {\n          this.notifyService.warning(this.languageService.plsUploadFirst, { hideTitle: true });\n          return EMPTY;\n        }\n        // è¿æ»¤åºstateä¸ºæ°å¢çéä»¶\n        fileInfos = fileInfos.filter((fileInfo: UploadFileInfo) => {\n          if (fileInfo.hasOwnProperty('state')) {\n            return fileInfo.state === FileState.New;\n          }\n          return true;\n        });\n        if (fileInfos.length === 0) {\n          return of(true);\n        }\n        // æ¯å¦ä¸ä¼ å¤æ­\n        const attachmentInfos = AttachmentUtil.convertToAttachmentInfos(fileInfos);\n        const firstAttachmentInfo = AttachmentUtil.getFirstAttachmentInfo(attachmentInfos);\n        return this.attachDataService.updateRowWithPropertyName(attachmentInfoFieldPath, firstAttachmentInfo);\n      })\n    );\n\n    return result$;\n  }\n  /**\n   * ä¸ä¼ å¤ä¸ªæä»¶\n   */\n  public uploadAndBatchAddRows(attachmentInfoFieldPath: string, rootDirId?: string, parentDirName?: string, fileType?: string): Observable<any> {\n    const rootId = rootDirId ? rootDirId : this.defaultRootDirId;\n    const formId = parentDirName ? parentDirName : this.defaultParentDirName;\n    if (!rootId || !formId) {\n      throw new Error('rootDirIdåparentDirNameä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n\n    const uploadLimit: UploadLimit = new UploadLimit();\n    if (fileType) {\n      uploadLimit.fileType = fileType;\n    }\n    const dialog$ = from(this.uploadDialogService.uploadFileWithLimit(formId, rootId, uploadLimit));\n    const result$ = dialog$.pipe(\n      switchMap((fileInfos: UploadFileInfo[]) => {\n        if (!fileInfos || fileInfos.length === 0) {\n          this.notifyService.warning(this.languageService.plsUploadFirst, { hideTitle: true });\n          return EMPTY;\n        }\n        // è¿æ»¤åºstateä¸ºæ°å¢çéä»¶\n        fileInfos = fileInfos.filter((fileInfo: UploadFileInfo) => {\n          if (fileInfo.hasOwnProperty('state')) {\n            return fileInfo.state === FileState.New;\n          }\n          return true;\n        });\n        if (fileInfos.length === 0) {\n          return of(true);\n        }\n        const attachmentInfos = AttachmentUtil.convertToAttachmentInfos(fileInfos);\n        return this.attachDataService.updateRows(attachmentInfoFieldPath, attachmentInfos);\n      })\n    );\n    return result$;\n  }\n  /**\n   * ä¸ä¼ å¤ä¸ªæä»¶\n   */\n  public uploadAndBatchAddRowsWithPropertyName(attachmentInfoFieldPath: string, rootDirId?: string, parentDirName?: string, fileType?: string): Observable<any> {\n    const rootId = rootDirId ? rootDirId : this.defaultRootDirId;\n    const formId = parentDirName ? parentDirName : this.defaultParentDirName;\n    if (!rootId || !formId) {\n      throw new Error('rootDirIdåparentDirNameä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n    const uploadLimit: UploadLimit = new UploadLimit();\n    if (fileType) {\n      uploadLimit.fileType = fileType;\n    }\n    const dialog$ = from(this.uploadDialogService.uploadFileWithLimit(formId, rootId, uploadLimit));\n    const result$ = dialog$.pipe(\n      switchMap((fileInfos: UploadFileInfo[]) => {\n        if (!fileInfos || fileInfos.length === 0) {\n          this.notifyService.warning(this.languageService.plsUploadFirst, { hideTitle: true });\n          return EMPTY;\n        }\n        // è¿æ»¤åºstateä¸ºæ°å¢çéä»¶\n        fileInfos = fileInfos.filter((fileInfo: UploadFileInfo) => {\n          if (fileInfo.hasOwnProperty('state')) {\n            return fileInfo.state === FileState.New;\n          }\n          return true;\n        });\n        if (fileInfos.length === 0) {\n          return of(true);\n        }\n        const attachmentInfos = AttachmentUtil.convertToAttachmentInfos(fileInfos);\n        return this.attachDataService.updateRowsWithPropertyName(attachmentInfoFieldPath, attachmentInfos);\n      })\n    );\n    return result$;\n  }\n  /**\n   * ä¸è½½éä»¶ï¼æ ¹æ®éä»¶idï¼\n   */\n  public download(attachId: string, rootId?: string): any {\n    if (!attachId) {\n      this.notifyService.warning(this.languageService.plsSelectDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n    rootId = rootId || 'default-root';\n    const url = this.getDownloadUrl([attachId], rootId);\n    // let url = '';\n    // if (rootId) {\n    //   url = `/api/runtime/dfs/v1.0/formdoc/filecontent?metadataid=${attachId}&rootid=${rootId}`;\n    // } else {\n    //   url = `/api/runtime/dfs/v1.0/formdoc/download/${attachId}`;\n    // }\n    window.open(url);\n    return of(true);\n  }\n  /**\n   * æ¹éä¸è½½éä»¶ï¼æ ¹æ®éä»¶idæ°ç»ï¼\n   */\n  public batchDownload(attachIds: string[], rootId: string): any {\n    if (!attachIds || attachIds.length === 0) {\n      this.notifyService.warning(this.languageService.plsSelectDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n    // åªéæ©ä¸ä¸ªéä»¶æ¶æåä¸ªéä»¶ä¸è½½å¤ç\n    if (attachIds.length === 1) {\n      return this.download(attachIds[0], rootId);\n    }\n    // const attachIdsString = JSON.stringify(attachIds);\n    // const url = `/api/runtime/dfs/v1.0/formdoc/multiple/download?metadataidlist=${attachIdsString}&rootid=${rootId}`;\n    const url = this.getDownloadUrl(attachIds, rootId);\n    window.open(url);\n    return of(true);\n  }\n  /**\n   * è·åä¸è½½è·¯å¾\n   * @param metadataidlist éä»¶idæ°ç»\n   * @param rootId rootId\n   */\n  private getDownloadUrl(metadataidlist: Array<string>, rootId: string): string {\n    rootId = rootId || 'default-root';\n    if (this.downloadService) {\n      if (metadataidlist.length === 1) {\n        return this.downloadService.getDownloadUrl(metadataidlist[0], rootId);\n      } else {\n        const attachIdsString = JSON.stringify(metadataidlist);\n        return this.downloadService.getMultipleDownloadUrl(attachIdsString, rootId);\n      }\n    } else {\n      console.warn('å å®å¨é®é¢ï¼éä»¶ä¸è½½æä¾å®å¨æ ¡éªæºå¶ï¼éä»¶ä¸è½½åè½ééæ°ç¼è¯ã');\n      if (metadataidlist.length === 1) {\n        return `/api/runtime/dfs/v1.0/formdoc/filecontent?metadataid=${metadataidlist[0]}&rootid=${rootId}`;\n      } else {\n        const attachIdsString = JSON.stringify(metadataidlist);\n        return `/api/runtime/dfs/v1.0/formdoc/multiple/download?metadataidlist=${attachIdsString}&rootid=${rootId}`;\n      }\n    }\n  }\n  /**\n   * ä¸è½½ï¼æ ¹æ®æ°æ®idï¼\n   */\n  public downloadByDataId(dataId: string, attachmentInfoFieldPath: string, rootId: string): Observable<any> {\n    if (!dataId) {\n      this.notifyService.warning(this.languageService.plsSelectDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n\n    const dataIds = [dataId];\n    const attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, dataIds);\n    if (attachIds.length === 0) {\n      this.notifyService.warning(this.languageService.noDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n\n    const attachId = attachIds[0];\n    return this.download(attachId);\n  }\n\n  /**\n   * æ¹éä¸è½½éä»¶\n   */\n  public batchDownloadByDataIds(dataIds: string[] | string, attachmentInfoFieldPath: string, rootId: string): Observable<any> {\n    if (typeof dataIds === 'string' && dataIds && dataIds.length > 0) {\n      dataIds = dataIds.split(',').filter(p => p);\n    }\n    if (!dataIds || Array.isArray(dataIds) === false || dataIds.length === 0) {\n      this.notifyService.warning(this.languageService.plsSelectDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n    const ids = [].concat(dataIds);\n    const attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, ids);\n    if (attachIds.length === 0) {\n      this.notifyService.warning(this.languageService.noDownloadAtt, { hideTitle: true });\n      return EMPTY;\n    }\n\n    return this.batchDownload(attachIds, rootId);\n  }\n\n  /**\n   * æ ¹æ®éä»¶UDTå­æ®µçè·¯å¾é¢è§éä»¶\n   * @param attachmentInfoFieldPath éä»¶UDTå­æ®µpath\n   * @param rootDirId è·ç®å½id\n   * @param ids éä»¶id\n   */\n  public previewByAttachmentInfoFieldPath(attachmentInfoFieldPath: string, rootDirId: string, ids?: any) {\n    if (!attachmentInfoFieldPath || !rootDirId) {\n      throw new Error('attachmentInfoFieldPathårootDirIdä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n    let attachIds = [];\n    let dataIds = [];\n    if (ids && ids.length > 0) {\n      if (typeof (ids) === 'string') {\n        dataIds.push(ids);\n      } else {\n        dataIds = ids;\n      }\n      attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, dataIds);\n    } else {\n      attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, null);\n    }\n    if (attachIds && attachIds.length === 0) {\n      this.notifyService.warning(this.languageService.noAttachment, { hideTitle: true });\n      return EMPTY;\n    }\n    return this.previewByAttachmentIds(attachIds, rootDirId);\n  }\n  /**\n   * æ ¹æ®éä»¶UDTå­æ®µçè·¯å¾é¢è§å½åè¡çéä»¶\n   * @param attachmentInfoFieldPath éä»¶UDTå­æ®µpath\n   * @param rootDirId æ ¹ç®å½id\n   */\n  public previewByAttachmentInfoFieldPathWithIndex(attachmentInfoFieldPath: string, rootDirId: string): Observable<any> {\n    if (!attachmentInfoFieldPath || !rootDirId) {\n      throw new Error('attachmentInfoFieldPathårootDirIdä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n    const currentRow = this.getCurrentRow(attachmentInfoFieldPath);\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    const attachmentFieldName = parentBindingPathArray.pop();\n    if (!currentRow[attachmentFieldName] || !currentRow[attachmentFieldName]['attachmentId']) {\n      this.notifyService.warning(this.languageService.noAttachment, { hideTitle: true });\n      return EMPTY;\n    }\n    const attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, null);\n    if (attachIds && attachIds.length === 0) {\n      this.notifyService.warning(this.languageService.noAttachment, { hideTitle: true });\n      return EMPTY;\n    }\n    const attachmentId = this.getCurrentAttachmentId(attachmentInfoFieldPath);\n    if (!attachmentId) {\n      throw new Error('è¦é¢è§çéä»¶idä¸å­å¨ï¼è¯·ç¡®è®¤');\n    } else {\n      return this.previewFileListWithIndex(attachIds, rootDirId, attachmentId);\n    }\n  }\n  /**\n   * æ ¹æ®ç®å½é¢è§éä»¶\n   * @param subDirName ç¶ç®å½åç§°\n   * @param rootDirId æ ¹ç®å½id\n   */\n  public previewBySubDirName(subDirName: string, rootDirId: string): Observable<any> {\n    if (!subDirName || !rootDirId) {\n      throw new Error('subDirNameårootDirIdä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n    const viewer$ = from(this.fileViewerService.viewerFormFile(subDirName, rootDirId));\n    return viewer$;\n  }\n  /**\n   * æ ¹æ®ç®å½é¢è§æå®ç´¢å¼çéä»¶\n   * @param attachmentInfoFieldPath éä»¶UDTå­æ®µpath\n   * @param subDirName å­ç®å½åç§°\n   * @param rootDirId æ ¹ç®å½id\n   */\n  public previewBySubDirNameWithIndex(attachmentInfoFieldPath: string, subDirName: string, rootDirId: string): Observable<any> {\n    if (!subDirName || !rootDirId) {\n      throw new Error('subDirNameårootDirIdä¸è½ä¸ºç©ºï¼è¯·å¡«å');\n    }\n    // const attachIds = this.getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath, null);\n    const attachmentId = this.getCurrentAttachmentId(attachmentInfoFieldPath);\n    if (!attachmentId) {\n      this.notifyService.warning(this.languageService.noAttachment, { hideTitle: true });\n      return EMPTY;\n    }\n    const viewer$ = from(this.fileViewerService.viewerFormFileWithIndex(subDirName, rootDirId, attachmentId));\n    return viewer$;\n  }\n  /**\n   * æ ¹æ®éä»¶idæ°ç»é¢è§éä»¶\n   * @param attachmentIds éä»¶idæ°ç»\n   * @param rootDirId æ ¹ç®å½id\n   */\n  public previewByAttachmentIds(attachmentIds: string[], rootDirId: string): Observable<any> {\n    const viewer$ = from(this.fileViewerService.viewerFileList(attachmentIds, rootDirId));\n    return viewer$;\n  }\n  /**\n   * æ ¹æ®éä»¶idæ°ç»é¢è§æå®ç´¢å¼çéä»¶\n   * @param attachmentIds éä»¶idæ°ç»\n   * @param rootDirId æ ¹ç®å½id\n   * @param attachmentId éä»¶Id\n   */\n  public previewFileListWithIndex(attachmentIds: string[], rootDirId: string, attachmentId: string) {\n    const viewer$ = from(this.fileViewerService.viewerFileListWithIndex(attachmentIds, rootDirId, attachmentId));\n    return viewer$;\n  }\n  /**\n   * çæçæ¬å·\n   * @param versions åå²çæ¬å·\n   * @description é»è®¤ç¼ç è§åv1.0 v2.0 ...\n   */\n  public genVersion(versions: string[]) {\n    if (!versions) {\n      versions = [];\n    }\n    const mainCode = versions.length + 1;\n    return `V${mainCode}.0`;\n  }\n  /**\n   * æ´æ°éä»¶çæ¬ä¿¡æ¯\n   * @param versionField éä»¶çæ¬å­æ®µ\n   * @param historyField æ¯å¦åå²çæ¬å­æ®µ\n   * @param attachmentFieldPath éä»¶udtå­æ®µè·¯å¾\n   */\n  public updateAttachmentVersion(versionField: string, historyField: string, attachmentFieldPath: string) {\n    /**\n     * éåææéä»¶è¡\n     * æ¾å°æææ²¡æéä»¶çæ¬çè¡\n     * éåè¿äºè¡\n     * éè¿æä»¶åå»æ¥æ¾ååçä¸æéä»¶çæ¬å·çè¡ \n     * è¿äºè¡åå²çæ¬å­æ®µç½®ä¸ºtrue\n     * æ çæ¬å·çè¡ï¼çæ¬= ä¸è¡æ° + 1\n     * \n     */\n    const bindingPaths = attachmentFieldPath.split('/').filter(p => p);\n    // å¼¹åºéä»¶udtå­æ®µ\n    const attachmentField = bindingPaths.pop();\n    // è·åå°ææçéä»¶\n    const attachmentBindingList = this.frameContext.bindingData.getValue(bindingPaths) as BindingList;\n    const befRepository = this.frameContext.repository as BefRepository<any>;\n    const entityManager = befRepository.entityManager;\n    const dataPath = DataPathCreator.createByShortPathFromRoot(bindingPaths, entityManager, this.frameContext.bindingData);\n    const paths = dataPath.toArray().map((path: string) => {\n      if (path.startsWith('PropName:')) {\n        return path.split(':')[1];\n      } else {\n        return path;\n      }\n    });\n    if (attachmentBindingList) {\n      const attachments = attachmentBindingList.toJSON();\n      // åªå¤çæéä»¶çæåµ\n      if (attachments) {\n        const versionLessRows = attachments.filter(item => !item[versionField]);\n        versionLessRows.forEach(item => {\n          const fileName = item[attachmentField]['fileName'];\n          const versionedRows = attachments.filter(row => row[attachmentField]['fileName'] === fileName && row[versionField]);\n          paths.pop();\n          paths.push(`DataId:${item[attachmentBindingList.primaryKey]}`);\n          let entity = this.frameContext.repository.entityCollection.getEntityByPath(paths);\n          const version = this.genVersion(versionedRows);\n          entity[versionField] = version;\n          entity[historyField] = false;\n          // å¤çåå²è®°å½\n          versionedRows.forEach(row => {\n            paths.pop();\n            paths.push(`DataId:${row[attachmentBindingList.primaryKey]}`);\n            entity = this.frameContext.repository.entityCollection.getEntityByPath(paths);\n            entity[historyField] = true;\n          });\n        });\n      }\n    }\n  }\n  public isAttachmentCanDelete(historyField: string, attachmentFieldPath: string) {\n    const bindingPaths = attachmentFieldPath.split('/').filter(p => p);\n    // å¼¹åºéä»¶udtå­æ®µ\n    bindingPaths.pop();\n    const attachmentBindingList = this.frameContext.bindingData.getValue(bindingPaths) as BindingList;\n    const bindingObject = attachmentBindingList.currentItem;\n    if (bindingObject[historyField] === true) {\n      this.notifyService.warning(this.languageService.historyAttachment, { hideTitle: true });\n      return EMPTY;\n    }\n  }\n  public updateAttachmentHistory(versionField: string, historyField: string, attachmentFieldPath: string) {\n    const bindingPaths = attachmentFieldPath.split('/').filter(p => p);\n    // å¼¹åºéä»¶udtå­æ®µ\n    const attachmentField = bindingPaths.pop();\n    // è·åå°ææçéä»¶\n    const attachmentBindingList = this.frameContext.bindingData.getValue(bindingPaths) as BindingList;\n    // const befRepository = this.frameContext.repository as BefRepository<any>;\n    // const entityManager = befRepository.entityManager;\n    if (attachmentBindingList) {\n      const attachments = attachmentBindingList.toJSON();\n      const versionedRows = attachments.filter(item => item[versionField]);\n      const fileNameMap = new Map<string, Array<any>>();\n      const befRepository = this.frameContext.repository as BefRepository<any>;\n      const entityManager = befRepository.entityManager;\n      const dataPath = DataPathCreator.createByShortPathFromRoot(bindingPaths, entityManager, this.frameContext.bindingData);\n      const paths = dataPath.toArray().map((path: string) => {\n        if (path.startsWith('PropName:')) {\n          return path.split(':')[1];\n        } else {\n          return path;\n        }\n      });\n      versionedRows.forEach(item => {\n        const fileName = item[attachmentField]['fileName'];\n        if (fileNameMap.has(fileName)) {\n          fileNameMap.get(fileName).push(item);\n        } else {\n          fileNameMap.set(fileName, [item]);\n        }\n      });\n      Array.from(fileNameMap.values()).forEach((array: Array<any>) => {\n        array.sort((x, y) => {\n          const xVersion = parseInt(x[versionField].replace(/[a-zA-Z\\.]/g, ''));\n          const yVersion = parseInt(y[versionField].replace(/[a-zA-Z\\.]/g, ''));\n          return yVersion - xVersion;\n        });\n        const row = array[0];\n        paths.pop();\n        paths.push(`DataId:${row[attachmentBindingList.primaryKey]}`);\n        const entity = this.frameContext.repository.entityCollection.getEntityByPath(paths);\n        entity[historyField] = false;\n      });\n    }\n  }\n  /**\n   * è·åå½åè§å¾æ¨¡åå½åè¡çéä»¶id\n   * @param attachmentInfoFieldPath éä»¶udtå­æ®µ\n   */\n  private getCurrentAttachmentId(attachmentInfoFieldPath: string) {\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    const attachmentFieldName = parentBindingPathArray.pop();\n    const bindingList: BindingList = this.frameContext.bindingData.getValue(parentBindingPathArray) as BindingList;\n    const currentItem = bindingList.currentItem;\n    if (currentItem && currentItem.primaryKeyValue) {\n      return currentItem[attachmentFieldName] && currentItem[attachmentFieldName]['attachmentId'] || null;\n    } else {\n      return null;\n    }\n  }\n  /**\n   * è·åå½åè¡\n   * @param attachmentInfoFieldPath udtå­æ®µ\n   */\n  private getCurrentRow(attachmentInfoFieldPath: string) {\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    parentBindingPathArray.pop();\n    const bindingList: BindingList = this.frameContext.bindingData.getValue(parentBindingPathArray) as BindingList;\n    const currentItem = bindingList && bindingList.currentItem;\n    return currentItem;\n  }\n  /**\n   * è·åæå®éä»¶ä¿¡æ¯è¡¨çæå®è¡\n   * @param attachmentInfoFieldPath \n   * @param primaryValue \n   * @returns \n   */\n  private getSpecialRow(attachmentInfoFieldPath: string, primaryValue: string) {\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    parentBindingPathArray.pop();\n    const bindingList: BindingList = this.frameContext.bindingData.getValue(parentBindingPathArray) as BindingList;\n    const currentItem = bindingList && bindingList.findById(primaryValue);\n    return currentItem;\n  }\n  /**\n   * è·ådataIdså¯¹åºEntityä¸çéä»¶idæ°ç»\n   */\n  private getAttachmentIdsByPathAndDataIds(attachmentInfoFieldPath: string, dataIds?: string[]): string[] {\n\n    // è§£æè·¯å¾\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    const attachmentFieldName = parentBindingPathArray.pop();\n\n    // è·åéä»¶æå¨å®ä½çæ°æ®åè¡¨ï¼ä¸ä¼ édataIdsåæ°ï¼åè¿åå¨é¨\n    const entityListData = this.entityService.getEntityListData(parentBindingPathArray);\n    let filteredEntityListData = [];\n    if (dataIds && Array.isArray(dataIds) === true) {\n      filteredEntityListData = entityListData.filter((entityData: any) => {\n        return dataIds.indexOf(entityData.id) > -1;\n      });\n    } else {\n      filteredEntityListData = entityListData;\n    }\n\n    // è½¬æ¢ä¸ºéä»¶Idæ°ç»\n    const attachmentIds = [];\n    filteredEntityListData.forEach((entityData: any) => {\n      if (entityData[attachmentFieldName]) {\n        const attachmentId = entityData[attachmentFieldName]['attachmentId'];\n        if (attachmentId) {\n          attachmentIds.push(attachmentId);\n        }\n      }\n    });\n\n    return attachmentIds;\n  }\n}\n\nexport { AttachmentService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, forkJoin, Subject } from 'rxjs';\nimport { FUploadFileExtend } from '@farris/extend-file-upload';\nimport { FrameContext, CommandContext, BindingPathConverter, BindingList, BindingObject } from '@farris/devkit';\nimport { FormNotifyService } from '../form-notify.service';\nimport { AttachmentInfo, ATTACHMENT_ORDER_FIELD } from './types';\nimport { AttachmentDataService } from './attachment-data.service';\nimport { LanguageService } from '../languag.service';\nimport { EntityService } from '../entity-services/index';\nimport { ListDataService, SubListDataService } from '../data-services/index';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { debounceTime, tap } from 'rxjs/operators';\n\n/**\n * éä»¶ä¸ä¼ \n * @summary\n * fileExtendï¼å½åæä»¶ä¸ä¼ æé¢è§ç»ä»¶ä¼ éè¿æ¥çæ°æ®ï¼\n * fileExtendFieldPathï¼å½åéä»¶UDTçå­æ®µè·¯å¾ï¼\n * attachmentInfoï¼å½åéä»¶UDTæéçä¿¡æ¯ï¼\n */\n@Injectable()\nclass FileService {\n  private subject: Subject<{ fileInfoFieldPath: string, configs: string }>;\n  private attachmentInfos: AttachmentInfo[];\n  /**\n   * æé å½æ°\n   */\n  constructor(\n    private frameContext: FrameContext,\n    private attachDataService: AttachmentDataService,\n    private entityService: EntityService,\n    private subListDataService: SubListDataService,\n    private notifyService: FormNotifyService,\n    private languageService: LanguageService,\n    private listDataService: ListDataService,\n    @Optional() private formLoadingService: FormLoadingService\n  ) {\n    this.subject = new Subject<{ fileInfoFieldPath: string, configs: string }>();\n    this.subject.pipe(debounceTime(500)).subscribe((data: { fileInfoFieldPath: string, configs: string }) => {\n      this.process(data.fileInfoFieldPath, data.configs);\n    });\n    this.attachmentInfos = [];\n  }\n\n  // #region ä¸ä¼ æä»¶\n\n  /**\n   * æ¹éæ·»å éä»¶è¡\n   */\n  public addFileRows(fileInfoFieldPath: string) {\n    const attachmentInfos = this.getAttachmentInfosToAddFromContext();\n    if (attachmentInfos.length === 0) {\n      this.notifyService.info('è¯·åä¸ä¼ éä»¶');\n    }\n    return this.attachDataService.updateRows(fileInfoFieldPath, attachmentInfos);\n  }\n  /**\n   * æ¹éæ·»å å¸¦éä»¶ç±»åçéä»¶è¡\n   * @param fileInfoFieldPath éä»¶udtå­æ®µ\n   * @param configs éä»¶æ©å±ä¿¡æ¯éç½® \n   * @description configséç½®å¦{\"billId\":\"{UISTATE~/root/billId}\",\"rowId\":\"{UISTATE~/root/rowId}\",\"attachmentType\":\"xueli\"}\n   */\n  public addFileRowsWithConfigs(fileInfoFieldPath: string, configs: string) {\n    const attachmentInfos = this.getAttachmentInfosToAddFromContext();\n    if (attachmentInfos.length === 0) {\n      this.notifyService.info('è¯·åä¸ä¼ éä»¶');\n    }\n    // let mapFields = null;\n    // if (typeof configs === 'string') {\n    //   // å»æé¦å°¾ç©ºæ ¼\n    //   configs = configs.trim();\n    // }\n    // if (configs.startsWith('{') && configs.endsWith('}')) {\n    //   try {\n    //     mapFields = JSON.parse(configs);\n    //   } catch {\n    //     throw new Error('éä»¶æ©å±ä¿¡æ¯éç½®ä¸æ¯åæ³çjsonå­ç¬¦ä¸²ã');\n    //   }\n    // } else {\n    //   throw new Error('éä»¶æ©å±ä¿¡æ¯éç½®ä¸æ¯åæ³çjsonå­ç¬¦ä¸²ã');\n    // }\n    this.attachmentInfos = this.attachmentInfos.concat(attachmentInfos);\n    this.subject.next({ fileInfoFieldPath, configs });\n    //return this.attachDataService.updateRowsWithConfigs(fileInfoFieldPath, attachmentInfos, mapFields);\n  }\n  private process(fileInfoFieldPath: string, configs: string) {\n    if (this.attachmentInfos && this.attachmentInfos.length > 0) {\n      const attachmentInfos = this.attachmentInfos.concat([]);\n      let mapFields = null;\n      if (typeof configs === 'string') {\n        // å»æé¦å°¾ç©ºæ ¼\n        configs = configs.trim();\n      }\n      if (configs.startsWith('{') && configs.endsWith('}')) {\n        try {\n          mapFields = JSON.parse(configs);\n        } catch {\n          throw new Error('éä»¶æ©å±ä¿¡æ¯éç½®ä¸æ¯åæ³çjsonå­ç¬¦ä¸²ã');\n        }\n      } else {\n        throw new Error('éä»¶æ©å±ä¿¡æ¯éç½®ä¸æ¯åæ³çjsonå­ç¬¦ä¸²ã');\n      }\n      this.attachDataService.updateRowsWithConfigs(fileInfoFieldPath, attachmentInfos, mapFields).pipe(\n        tap(() => {\n          this.attachmentInfos = this.attachmentInfos.filter(item => !attachmentInfos.find(attachmentInfo => attachmentInfo.attachmentId === item.attachmentId));\n          if (this.attachmentInfos.length > 0) {\n            this.process(fileInfoFieldPath, configs);\n          }\n        })\n      ).subscribe();\n    }\n\n  }\n\n  /**\n   * è·åè¦æ·»å çéä»¶ä¿¡æ¯æ°ç»\n   */\n  private getAttachmentInfosToAddFromContext(): AttachmentInfo[] {\n    const fileExtends = this.getFileExtendsFromContext();\n    const attachmentInfos = this.convertToAttachmentInfos(fileExtends);\n    return attachmentInfos;\n  }\n\n  /**\n   * å°éä»¶ä¸ä¼ ç»ä»¶è¿åçéä»¶ä¿¡æ¯è½¬æ¢ä¸ºæå¡å¨ç«¯éè¦çæ ¼å¼\n   */\n  private convertToAttachmentInfos(fileExtends: FUploadFileExtend[]): AttachmentInfo[] {\n    if (!fileExtends) {\n      return [];\n    }\n\n    const attachmentInfos: AttachmentInfo[] = [];\n    fileExtends.forEach((fUploadOutPut: FUploadFileExtend) => {\n      const attachmentInfo: AttachmentInfo = {\n        attachmentId: fUploadOutPut.extend.metadataId,\n        fileName: fUploadOutPut.extend.fileName,\n      };\n      attachmentInfos.push(attachmentInfo);\n    });\n    return attachmentInfos;\n  }\n\n  // #endregion\n\n\n  // #region å é¤æä»¶\n\n  /**\n   * å é¤éä»¶è¡\n   */\n  public removeFileRows(fileInfoFieldPath: string): Observable<any> {\n    const dataIds = this.getDataIdsToRemoveFromContext(fileInfoFieldPath);\n    if (dataIds.length === 0) {\n      this.notifyService.info('è¯·éæ©è¦å é¤çéä»¶');\n    }\n    const isSublist = fileInfoFieldPath.split('/').filter(p => p).length >= 2;\n    const removeObservables: Observable<any>[] = [];\n    if (isSublist) {\n      dataIds.forEach((dataId: string) => {\n        let removeObservable;\n        removeObservable = this.subListDataService.removeWithoutConfirm(dataId);\n        removeObservables.push(removeObservable);\n      });\n      return forkJoin(removeObservables);\n    } else {\n      return this.listDataService.removeRows(dataIds, false, null, false);\n    }\n  }\n\n  /**\n   * è·åè¦å é¤çæ°æ®\n   */\n  private getDataIdsToRemoveFromContext(fileExtendFieldPath: string): string[] {\n\n    // ä»ä¸ä¸æä¸­è·åè¦å¤ççéä»¶ä¿¡æ¯æ°ç»\n    const fileExtends = this.getFileExtendsFromContext();\n\n    // å°éä»¶æ°ç»è½¬æ¢ä¸ºå¯¹åºçæ°æ®id\n    const dataIds: string[] = [];\n    fileExtends.forEach((fileExtend: FUploadFileExtend) => {\n\n      // ä¸ä¼ å é¤åé¢è§å é¤ä¼ éè¿æ¥çfileIdçkeyå¯è½ä¸ä¸è´ï¼è¦åå¼å®¹\n      const fileId = fileExtend.extend.metadataId;\n      const dataId = this.convertFileIdToDataId(fileId, fileExtendFieldPath);\n      dataIds.push(dataId);\n    });\n    return dataIds;\n  }\n\n  /**\n   * æ ¹æ®è·¯å¾è·åéä»¶å­æ®µå¼æ°ç»\n   * @param fieldPath å­æ®µè·¯å¾\n   */\n  private convertFileIdToDataId(fileId: string, fileExtendFieldPath: string): string {\n\n    // è§£æè·¯å¾\n    const fileBindingPath = BindingPathConverter.toBindingPathArray(fileExtendFieldPath);\n    const fileFieldName = fileBindingPath.pop();\n    const fileListBindingPath = fileBindingPath;\n\n    // è·åéä»¶idæ°ç»\n    const entityListData = this.entityService.getEntityListData(fileListBindingPath);\n    const targetEntityData = entityListData.find((entityData: any) => {\n      if (entityData[fileFieldName]) {\n        const attachmentId = entityData[fileFieldName]['attachmentId'];\n        if (attachmentId === fileId) {\n          return true;\n        }\n      }\n    });\n\n    return targetEntityData.id;\n  }\n\n  // #endregion\n  //#region æä»¶æåº\n  /**\n   * æ´æ°éä»¶æåº\n   * @param attachmentInfoFieldPath éä»¶udtå­æ®µè·¯å¾\n   * @param ids éä»¶æåºåçéä»¶idæ°ç»\n   */\n  public updateOrder(attachmentInfoFieldPath: string, ids: string[]) {\n    if (!attachmentInfoFieldPath) {\n      throw new Error('éä»¶udtå­æ®µè·¯å¾åæ°ä¸è½ä¸ºç©º');\n    }\n    // æ¯æä»ä»£ç ä¸­ç´æ¥è°ç¨ï¼å¦æåæ°ä¸­ä¼ éäºidsåä½¿ç¨ï¼å¦åä½¿ç¨å½ä»¤ä¸ä¸æä¸­çäºä»¶åæ°\n    if (!ids) {\n      // è·åäºä»¶åæ°\n      const commandContext = this['context'] as CommandContext;\n      // ä¸ç»ä»¶çº¦å®äºä»¶åæ°ä¸ºæ°æ®ä¸»é®æ°ç»\n      ids = commandContext && commandContext.eventParam && commandContext.eventParam.data;\n    }\n    // å¯¹æ¶éçä¸»é®æ°ç»è¿è¡å¤æ­\n    if (!ids || !Array.isArray(ids)) {\n      return;\n    }\n    // å½åå½ä»¤æå¨ç»ä»¶çç»å®æ°æ®\n    const bindingList: BindingList = this.frameContext.bindingData.getList();\n    // æ ç»å®æ°æ®æ¶ä¸å¤ç\n    if (!bindingList || bindingList.length < 1) {\n      return;\n    }\n    // ç»ä¸è·åéä»¶udtä¿¡æ¯\n    const parentBindingPathArray = BindingPathConverter.toBindingPathArray(attachmentInfoFieldPath);\n    const attachmentField = parentBindingPathArray.pop();\n    // åºç°udtå­æ®µä¸å­å¨çæåµï¼è¯´æå½ä»¤ä¸­éä»¶udtå­æ®µéç½®éè¯¯ævoä¸­æ²¡æéä»¶udtãæ§å¶å¨ä¸å¼å®¹éè¯¯ï¼æ­¤å¤å¤æ­åªä¸ºé»æ­¢åç»­çéå\n    if (!attachmentField) {\n      throw new Error('æ æ³è·åéä»¶udtå­æ®µï¼è¯·ç¡®è®¤å½ä»¤ä¸­éä»¶udtå­æ®µè·¯å¾éç½®æ­£ç¡®ï¼ä¸è§å¾æ¨¡åä¸­å­å¨éä»¶udtå­æ®µ');\n    }\n    const data = bindingList.toJSON();\n    // æ´æ°ç»å®æ°æ®ä¸­éä»¶udtå­æ®µä¸­æåºå­æ®µçå¼,ä»æ´æ°æéä»¶çè¡\n    ids.forEach((id: string, index: number) => {\n      const item = data.find(item => item && item[attachmentField] && item[attachmentField]['attachmentId'] === id);\n      const primaryKeyValue = item && item.id;\n      if (!primaryKeyValue) {\n        return;\n      }\n      const bindingObject = bindingList.findById(primaryKeyValue);\n      if (bindingObject) {\n        // éä»¶udtå¯¹è±¡\n        const attachment = bindingObject[attachmentField] as BindingObject;\n        if (attachment) {\n          // è·åæ§å¼\n          const order = attachment.getValue(ATTACHMENT_ORDER_FIELD);\n          if (order !== index) {\n            // æ´æ°æåº\n            attachment.setValue(ATTACHMENT_ORDER_FIELD, index, true, true);\n          }\n        }\n      }\n    });\n  }\n  //#endregion\n\n  // #region å¶ä»å·¥å·æ¹æ³\n\n  /**\n   * ä»ä¸ä¸æä¸­è·åè¦å¤ççéä»¶ä¿¡æ¯æ°ç»\n   * @summary\n   * ä¸ºäºç»ä¸åä¸ªåå¤ä¸ªéä»¶çå¤çæ¹å¼ï¼ç»ä¸åè£ä¸ºæ°ç»\n   */\n  private getFileExtendsFromContext(): FUploadFileExtend[] {\n\n    const commandContext = this['context'] as CommandContext;\n    const eventParam = commandContext.eventParam;\n    if (!eventParam) {\n      return [];\n    }\n\n    let fileExtends: any[];\n    if (Array.isArray(eventParam) === false) {\n      fileExtends = [eventParam];\n    } else {\n      fileExtends = eventParam.concat([]);\n    }\n\n    return fileExtends as FUploadFileExtend[];\n  }\n  // #endregion\n}\n\nexport { FileService };\n","import { Injectable, ComponentFactoryResolver, ReflectiveInjector, Provider, ComponentRef, InjectFlags, NgModuleFactory, Injector, Optional } from '@angular/core';\nimport { BsModalService, ModalOptions } from '@farris/ui-modal';\nimport { FarrisFormService } from './farris-form.service';\nimport { FrameContext, FrameComponent, BindingList } from '@farris/devkit';\nimport { of, Observable, Subject } from 'rxjs';\nimport { LanguageService } from './languag.service';\nimport { switchMap } from 'rxjs/operators';\ndeclare const System: any;\n/**\n * å¼¹çªæå¡\n * @scope FormModule\n */\n@Injectable()\nclass DialogService {\n\n  private _providers: Provider[] = [];\n\n  private languageService: LanguageService;\n  private modalRef: any;\n  private modals: any = {};\n\n  constructor(\n    private modalService: BsModalService,\n    private farrisFormService: FarrisFormService,\n    private _componentFactoryResolver: ComponentFactoryResolver,\n    private frameContext?: FrameContext,\n    @Optional() private injector?: Injector\n  ) {\n    this.setLanguageService();\n  }\n\n  /**\n   * è®¾ç½®è¯­è¨æå¡\n   */\n  private setLanguageService() {\n\n    // FrameContextä¸ä¸å®å­å¨ï¼ä¸è½ç´æ¥ç¨\n    const frameContext = this.getFrameContext();\n    if (frameContext) {\n      const injector = this.frameContext.injector;\n      this.languageService = injector.get<LanguageService>(LanguageService, null, InjectFlags.Optional);\n    }\n\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  /**\n   * å¼å®¹æ§å¼¹çªï¼è·åframeContext\n   */\n  private getFrameContext() {\n    if (this.frameContext) {\n      return this.frameContext\n    }\n    if (this['context'] && this['context']['frameContext']) {\n      return this['context']['frameContext'];\n    }\n    return null;\n  }\n  /**\n   * å¼å®¹æ§å¼¹çªï¼è·åComponentFactoryResolver\n   */\n  private getComponentFactoryResolver() {\n    const frameContext = this.getFrameContext();\n    let componentFactoryResolver: any;\n    if (frameContext) {\n      componentFactoryResolver = frameContext.injector.get(ComponentFactoryResolver);\n    }\n    return componentFactoryResolver;\n  }\n\n  /**\n   * è·åconfigè½¬æ¢æå¯¹è±¡ç±»åçéç½®\n   * @param config éç½®é¡¹\n   */\n  private getObjectTypeConfig(config: any) {\n    let objectTypeConfig: any\n    if (typeof config === 'string') {\n      if (config.length) {\n        try {\n          objectTypeConfig = JSON.parse(config);\n        } catch {\n          throw new Error(config + 'ä¸æ¯åæ³çjsonå­ç¬¦ä¸²');\n        }\n      } else {\n        objectTypeConfig = {};\n      }\n    } else if (typeof config === 'object') {\n      objectTypeConfig = Object.assign({}, config);\n    } else {\n      throw new Error('å¡«åå¯¹è±¡æ ¼å¼æjsonå­ç¬¦ä¸²');\n    }\n    return objectTypeConfig;\n  }\n\n  /**\n   * åå»ºæ¨¡ææ¡åç»ä»¶å®ä¾ï¼å¹¶è¿åæ¨¡ææ¡å®ä¾ï¼åäºå¼å®¹èè¡¨åå¤ç\n   * @param config å¼¹çªéç½®\n   * @param compnent å¼¹çªåç»ä»¶\n   * @param uiStateObject ç»å®å¼¹çªåç»ä»¶uiState\n   */\n  private createModalComponentRef(config: any, component: any, uiStateObject: any) {\n    let componentRef: any;\n    let modalRef: any;\n    const frameContext = this.getFrameContext();\n    const componentFactoryResolver = this.getComponentFactoryResolver();\n    if (frameContext && componentFactoryResolver) {\n      const contentCmptFactory = componentFactoryResolver.resolveComponentFactory(component);\n      const modalContentInjector = ReflectiveInjector.resolveAndCreate([...this._providers], frameContext.injector);\n      componentRef = contentCmptFactory.create(modalContentInjector);\n      if (componentRef && componentRef.instance && componentRef.instance.viewModel && componentRef.instance.viewModel.uiState) {\n        if (typeof uiStateObject === 'object' && Object.keys(uiStateObject).length) {\n          Object.keys(uiStateObject).forEach(item => {\n            componentRef.instance.viewModel.uiState.setPropertyValue(item, uiStateObject[item]);\n          });\n        }\n        // éå isDialogåæ°\n        componentRef.instance.viewModel.uiState.setPropertyValue('DEVKIT_DIALOG', true);\n      }\n      modalRef = this.modalService.show(componentRef, config);\n    } else {\n      modalRef = this.modalService.show(component, config);\n    }\n    return modalRef;\n  }\n  /**\n   * \n   * @param config æ¨¡ææ¡æ¬èº«éç½®\n   * @param modalId æ¨¡ææ¡åç»ä»¶çid\n   * @param uiStateConfig æ¨¡ææ¡åç»ä»¶uiStateä¸çå­æ®µåå¼\n   */\n  public openModal(config: any = {}, modalId: string, uiStateConfig: any = {}, callback?: (modalRef: any) => any) {\n\n    const configObj = this.getObjectTypeConfig(config);\n    const uiStateObject = this.getObjectTypeConfig(uiStateConfig);\n    let innerCompopnent = this.farrisFormService.getControls(modalId);\n    let modalRef: any;\n    let modalConfig: any = {\n      title: this.languageService.defaultDialogTitle,\n      width: 760,\n      height: 450,\n      showButtons: false\n    };\n    modalConfig = Object.assign(modalConfig, configObj);\n    const onClosingHandler = modalConfig.beforeClose;\n    // tslint:disable: no-string-literal\n    const cancelChanges = modalConfig['cancelChanges'] || false;\n    modalConfig.beforeClose = (ref) => {\n      // if (ref && ref.modalRef && ref.modalRef.content) {\n      //   ref.modalRef.content.isDialogRootComponent = false;\n      // }\n      if (!!onClosingHandler && typeof onClosingHandler === 'function') {\n        return onClosingHandler(ref).pipe(\n          switchMap(result => {\n            if (result) {\n              if (cancelChanges) {\n                return this.cancelChanges(ref);\n              }\n            }\n            return of(result);\n          })\n        );\n      }\n      if (cancelChanges) {\n        return this.cancelChanges(ref);\n      } else {\n        return of(true);\n      }\n    };\n    const remote = modalConfig.remote || false;\n    if (remote) {\n      this.createRemoteForm(modalConfig, uiStateObject).subscribe(\n        (modalRef: any) => {\n          this.modalRef = modalRef;\n          if (modalRef && !!modalRef.content) {\n            modalRef.content.isDialogRootComponent = true;\n            modalRef.content.dialogRef = modalRef;\n          }\n          callback(modalRef);\n        }\n      );\n    } else {\n      if (!innerCompopnent) {\n        console.error(`è·åæ§ä»¶å¤±è´¥ï¼modalId=${modalId}`);\n        return;\n      }\n      if (typeof innerCompopnent === 'string') {\n        modalConfig.dialogType = 'iframe';\n        modalRef = this.modalService.show(innerCompopnent, modalConfig);\n      } else if (typeof innerCompopnent === 'function') {\n        modalRef = this.createModalComponentRef(modalConfig, innerCompopnent, uiStateObject);\n      } else if (typeof innerCompopnent === 'object') {\n        // å¦ææ¯å¯¹è±¡ ä¸ä½¿ç¨ç¬ç«jså è½½\n        // {\"useIsolateJs\":true,\"modalInstance\":f()}\n        if (innerCompopnent.useIsolateJs) {\n          const parameter = {\n            injector: this.injector,\n            uiState: uiStateObject,\n            modalService: this.modalService,\n            dialogServiceInstance: this,\n            eventBus: this.frameContext.getVirtualRootFrameContext().eventBus,\n            componentCallback: this.componentModify,\n            modalInstanceCallback: this.modalInstanceCallback\n          };\n          // ä¼å¨åé¨è¿è¡\n          return innerCompopnent[\"modalInstance\"](modalConfig, parameter);\n\n        } else {\n          modalRef = this.modalService.show(innerCompopnent, modalConfig);\n        }\n      }\n\n      this.modalRef = modalRef;\n      if (modalRef && !!modalRef.content) {\n        modalRef.content.isDialogRootComponent = true;\n        modalRef.content.dialogRef = modalRef;\n      }\n      return modalRef;\n    }\n  }\n\n  private componentModify(cmpRef: any, parameter: {\n    uistate: any\n  }) {\n    if (cmpRef && cmpRef.instance && cmpRef.instance.viewModel && cmpRef.instance.viewModel.uiState) {\n      if (parameter.uistate && typeof parameter.uistate === \"string\") {\n        parameter.uistate = JSON.parse(parameter.uistate);\n      }\n      if (typeof parameter.uistate === 'object' && Object.keys(parameter.uistate).length) {\n        Object.keys(parameter.uistate).forEach(item => {\n          cmpRef.instance.viewModel.uiState.setPropertyValue(item, parameter.uistate[item]);\n        });\n      }\n      // éå isDialogåæ°\n      cmpRef.instance.viewModel.uiState.setPropertyValue('DEVKIT_DIALOG', true);\n    }\n  }\n\n  private modalInstanceCallback(cmpRef: any, options: any, parameter: any) {\n    if (parameter && parameter.modalService) {\n      const modalRef = parameter.modalService.show(cmpRef, options);\n      if (modalRef && !!modalRef.content) {\n        modalRef.content.isDialogRootComponent = true;\n        modalRef.content.dialogRef = modalRef;\n      }\n      return modalRef;\n    }\n  }\n\n  /**\n   * æå¼ç±»å¸®å©è¡¨å\n   * @param frameId \n   * @param params \n   * @param configs \n   * @description å¼¹åºè¡¨ååå¼¹åºè¿ç«¯è¡¨ååºå«ä¸ºå¼¹åºè¡¨åéè¦éç½®å­æ®µæ å°\n   */\n  public openHelpModal(frameId: string, params: string, configs?: any) {\n    const events = this['context']['eventParam'] || {};\n    // å¡çåºæ¯ä¼ éè¿æ¥çäºä»¶æ¯èªå®ä¹å¯¹è±¡ï¼åå«eventåoptionsãåè¡¨åºæ¯ä¼ éè¿æ¥çäºä»¶åæ°æ¯æ®éäºä»¶åæ°ï¼å¨åæ°ä¸­æºå¸¦äºeditor.options\n    const event = events.event || events;\n    const options = events.options || events.editor && events.editor.options || {};\n    const context = events && events.context;\n    const subject = new Subject<any>();\n    // modalIdå¨ä¸¤ç§åºæ¯ä¸é½éè¦ï¼ç¨æ¥åºåå®ä¾\n    const { modalId = null } = options;\n    if (!configs) {\n      configs = '{}';\n    }\n    if (typeof configs === 'string' && configs.length > 0) {\n      configs = JSON.parse(configs);\n    }\n    const { remote = false, currentRow = false, areaResponse = undefined } = configs || {};\n    // æ¯æareaResponseéç½®\n    if (areaResponse !== undefined && options.areaResponse === undefined) {\n      options.areaResponse = areaResponse;\n    }\n    if (remote) {\n      const mapFields = configs.mapFields || {};\n      options.remote = remote + '?v=' + new Date().valueOf();\n      this.openModal(options, modalId, params, (dialogRef: any) => {\n        // æ°å¢eventåæ°ï¼ä¸ºäºä»¥åè°ç¨eventä¸­çformControlä»¥ééåè¡¨ä¸­çæºè½è¾å¥æ¡å¼¹åºè¡¨åï¼\n        this.modals[modalId] = { subject, frameId: frameId, mapFields, dialogRef, currentRow, event: event, context };\n      });\n    } else {\n      const dialogRef = this.openModal(options, modalId, params);\n      const mapFields = options.mapFields || {};\n      this.modals[modalId] = { subject, frameId: frameId, mapFields, dialogRef, currentRow, event: event, context };\n    }\n    return subject;\n  }\n\n  /**\n   * æå¼å¸¦åè°çå¼¹çª\n   * @param frameId frameId\n   * @param params åæ°\n   * @param configs éç½®\n   * @returns \n   */\n  public openCallbackableModal(frameId: string, params?: string, configs?: any) {\n    if (!configs) {\n      configs = '{}';\n    }\n    if (typeof configs === 'string') {\n      configs = JSON.parse(configs);\n    }\n    const events = this['context'] && this['context']['eventParam'] || {};\n    const options = events.options;\n    options.showButtons = true;\n    options.buttons = [\n      {\n        text: this.languageService.confirm, cls: 'btn btn-primary', handle: (event: any) => {\n          const { modalId = null } = options || {};\n          if (modalId) {\n            const modal = this.modals[modalId];\n            const { subject = null, dialogRef = null, frameId = null, handle = null, currentRow = false } = modal || {};\n            const formCmp = dialogRef.content; // å¼¹çªè¡¨åå®ä¾\n            if (!formCmp) {\n              throw new Error('ä¸æ¯æçè¡¨åç±»å');\n            }\n            let selectedItems = [];\n            if (currentRow === true) {\n              let frameComtext: FrameContext;\n              if (formCmp.context) {\n                frameComtext = formCmp.context.appContext.frameContextManager.getFrameContextById(frameId) as FrameContext;\n              } else {\n                frameComtext = formCmp.appContext.frameContextManager.getFrameContextById(frameId) as FrameContext;\n              }\n\n              if (!frameComtext) {\n                throw new Error(`æ æçframeIdï¼${frameId}ï¼è¯·ç¡®è®¤å½ä»¤ä¸­frameIdæ­£ç¡®ã`);\n              }\n              const bindingList = frameComtext.bindingData.getList() as BindingList;\n              const item = bindingList && bindingList.currentItem && bindingList.currentItem.toJSON();\n              selectedItems = [item];\n            } else {\n              let rows: Map<string, any>;\n              // å¦æcontextä¸ºç©º é£ä¹å°è¯ä»å¯¹åºçappcontextè¯»åï¼ä¸»è¦ç®çæ¯ä¸ºäºè§£æè¡¨åçå¼¹åº\n              if (formCmp.context) {\n                rows = formCmp.context.appContext.frameContextManager.getFrameContextById(frameId).uiState.rows || new Map<string, any>();\n              } else {\n                rows = formCmp.appContext.frameContextManager.getFrameContextById(frameId).uiState.rows || new Map<string, any>();\n              }\n\n              selectedItems = Array.from(rows.values());\n            }\n            if (typeof handle === 'function') {\n              handle(selectedItems);\n            }\n            if (subject) {\n              subject.next();\n            }\n            dialogRef.close(options);\n          }\n        }\n      },\n      { text: this.languageService.cancel, cls: 'btn', handle: (event: any) => this.cancel(options) }\n    ];\n\n    const subject = new Subject<any>();\n    const { modalId = null } = options;\n    const { remote = null, currentRow = false, areaResponse = undefined } = configs;\n    const handle = options.handle;\n    // æ¯æareaResponseéç½®\n    if (areaResponse !== undefined && options.areaResponse === undefined) {\n      options.areaResponse = areaResponse;\n    }\n    if (remote) {\n      options.remote = remote + '?v=' + new Date().valueOf();\n      this.openModal(options, modalId, params, (dialogRef: any) => {\n        this.modals[modalId] = { subject, frameId: frameId, dialogRef, handle, currentRow, event: events.event };\n      });\n    } else {\n      const dialogRef = this.openModal(options, modalId, params);\n      this.modals[modalId] = { subject, frameId: frameId, dialogRef, handle, currentRow, event: events.event };\n    }\n    return subject;\n  }\n\n  /**\n   * ç¡®è®¤æé®äºä»¶\n   * @param args \n   */\n  public confirm() {\n    const events = this['context'] && this['context']['eventParam'] || {};\n    const { modalId = null } = events || {};\n    if (modalId) {\n      const modal = this.modals[modalId];\n      const { subject = null, dialogRef = null, mapFields = {}, frameId = null, currentRow = false, event = null, context = null } = modal || {};\n      const formCmp = dialogRef.content; // å¼¹çªè¡¨åå®ä¾\n      if (!formCmp) {\n        throw new Error('ä¸æ¯æçè¡¨åç±»å');\n      }\n      // const selectedIds = formCmp.context.appContext.frameContextManager.getFrameContextById(frameId).uiState.ids;\n\n      let selectedItems = [];\n      if (currentRow === true) {\n        const frameComtext = formCmp.context.appContext.frameContextManager.getFrameContextById(frameId) as FrameContext;\n        if (!frameComtext) {\n          throw new Error(`æ æçframeIdï¼${frameId}ï¼è¯·ç¡®è®¤å½ä»¤ä¸­frameIdæ­£ç¡®ã`);\n        }\n        const bindingList = frameComtext.bindingData.getList() as BindingList;\n        const item = bindingList && bindingList.currentItem && bindingList.currentItem.toJSON();\n        if (item && Object.keys(item).length > 0) {\n          selectedItems = [item];\n        }\n      } else {\n        const rows: Map<string, any> = formCmp.context.appContext.frameContextManager.getFrameContextById(frameId).uiState.rows || new Map<string, any>();\n        selectedItems = Array.from(rows.values());\n      }\n\n      // æ å°å­æ®µæ°æ®\n      // è·åè§¦åå¼¹æ¡çç¼è¾å¨çå­æ®µåç§°\n      let editorField = undefined;\n      if (event && event.editor && event.editor.column) {\n        editorField = event.editor.column.field;\n      }\n      if (selectedItems && mapFields) {\n        Object.keys(mapFields).forEach(k => {\n          const targetField: string = mapFields[k];\n          const sourceKeyArray = k.split('.').filter(p => p) || [];\n          const targetValue = selectedItems.map(r => {\n            return sourceKeyArray.reduce((target, key) => {\n              if (target && (target.hasOwnProperty(key) || target['__proto__'].hasOwnProperty(key))) {\n                return target[key];\n              } else {\n                return '';\n              }\n            }, r);\n          }).join(',');\n          if (targetField) {\n            const bindingPaths = this.frameContext.viewModel.bindingPath.split('/').filter(p => p);\n            const targetFields = targetField.split(',').filter(p => p);\n            targetFields.forEach(target => {\n              if (context) {\n                this.setValueByPath(context, target, targetValue);\n              } else {\n                const targetPath = target.split('.');\n                this.frameContext.bindingData.setValue(bindingPaths.concat(targetPath), targetValue, true, true);\n              }\n\n            });\n          }\n        })\n      }\n      if (subject) {\n        subject.next();\n      }\n      dialogRef.close();\n    }\n  }\n  /**\n   * åæ¶æé®äºä»¶\n   * @param args \n   */\n  public cancel(event?: any) {\n    const events = event || this['context'] && this['context']['eventParam'] || {};\n    const { modalId = null } = events || {};\n    if (modalId) {\n      const modal = this.modals[modalId];\n      const { subject = null, dialogRef = null } = modal || {};\n      if (subject) {\n        subject.next();\n      }\n      if (dialogRef) {\n        dialogRef.close();\n      }\n    }\n  }\n  /**\n   * åæ¶æå¡å¨åæ´é\n   */\n  private cancelChanges(ref: any): Observable<boolean> {\n    if (ref && ref.modalRef && ref.modalRef.content) {\n      const component: FrameComponent = ref.modalRef.content as FrameComponent;\n      if (component && component.context) {\n        const repository = component.context.repository || null;\n        if (repository) {\n          return repository.cancelChanges().pipe(switchMap(() => of(true)));\n        }\n      }\n    }\n    return of(true);\n  }\n  /**\n   * å³é­è¯¥å¼¹çª\n   */\n  closeModal() {\n    if (this.modalRef) {\n      this.modalRef.close();\n    }\n  }\n  /**\n   * åå»ºè¿ç¨è¡¨åå®ä¾\n   * @param options dialogéç½®\n   * @param uiState uistate\n   */\n  private createRemoteForm(options: any, uiState: any): Subject<any> {\n    const remote = options.remote || false;\n    const subject = new Subject<any>();\n    if (remote) {\n      let moduleName = options.moduleName || null;\n      System.import(remote).then((module: any) => {\n        if (!moduleName) {\n          moduleName = Object.keys(module).pop();\n        }\n        const moduleFactory = module[moduleName] as NgModuleFactory<any>;\n        const moduleRef = moduleFactory.create(this.injector);\n        const entryComponent = moduleRef['_bootstrapComponents'][0];\n        if (entryComponent) {\n          const compFactory = moduleRef.componentFactoryResolver.resolveComponentFactory(entryComponent);\n          const componentRef: ComponentRef<any> = compFactory.create(this.injector);\n\n          if (componentRef && componentRef.instance && componentRef.instance.viewModel && componentRef.instance.viewModel.uiState) {\n            if (typeof uiState === 'object' && Object.keys(uiState).length) {\n              Object.keys(uiState).forEach(item => {\n                componentRef.instance.viewModel.uiState.setPropertyValue(item, uiState[item]);\n              });\n            }\n            // éå isDialogåæ°\n            componentRef.instance.viewModel.uiState.setPropertyValue('DEVKIT_DIALOG', true);\n          }\n          const modalRef = this.modalService.show(componentRef, options);\n          subject.next(modalRef);\n        } else {\n          throw new Error(`æ æ³æ¾å°å¥å£è¡¨åï¼`);\n        }\n      });\n    }\n    return subject;\n  }\n  private setValueByPath(target: object, path: string, value: any) {\n    if (target) {\n      const paths = path.split('.');\n      if (paths.length <= 1) {\n        target[path] = value;\n      } else {\n        paths.slice(0, -1).reduce((prev, path) => {\n          if (!(prev.hasOwnProperty(path) || prev['__proto__'].hasOwnProperty(path))) {\n            prev[path] = {};\n          }\n          return prev[path];\n        }, target)[paths[paths.length - 1]] = value;\n      }\n    }\n  }\n}\n\nexport { DialogService };\n","import { Injectable, Optional } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { FarrisSidebarService } from '@farris/ui-sidebar';\nimport { Entity, FrameContext } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\nimport { FormMessageService } from './form-message.service';\nimport { LanguageService } from './languag.service';\n\n\n/**\n * ä¾§è¾¹æ æå¡\n * @scope FrameComponent\n */\n@Injectable()\nclass SidebarService {\n\n  private get repository(): BefRepository<Entity> {\n    return this.frameContext.repository as BefRepository<Entity>;\n  }\n\n  constructor(\n    private frameContext: FrameContext,\n    private sidebarUIService: FarrisSidebarService,\n    private messageService: FormMessageService,\n    @Optional() private languageService: LanguageService,\n  ) {\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n\n  openSidebar() {\n    this.sidebarUIService.sendIsOpen(true);\n  }\n\n  closeSidebar() {\n    this.sidebarUIService.sendIsOpen(false);\n  }\n\n  /**\n   * å³é­åååæ¶åæ´\n   */\n  confirmBeforeClosingSidebar(): Observable<boolean> {\n\n    // æ£æ¥æ¯å¦æåæ´ï¼æ²¡æåæ´ç´æ¥å³é­\n    const ifChangesExist = this.repository.entityManager.checkAllEntityChanges();\n    if (!ifChangesExist) {\n      return of(true);\n    }\n\n    // ç¡®è®¤æ¯å¦å³é­\n    const confirm$ = this.messageService.question(this.languageService['exitWithoutSave']);\n    const result$ = confirm$.pipe(\n      switchMap((confirmResult: boolean) => {\n        if (confirmResult === false) {\n          return of(false);\n        } else {\n          return of(true);\n        }\n      })\n    );\n\n    return result$;\n  }\n\n  /**\n   * ç»§ç»­å³é­ä¾§è¾¹æ \n   */\n  public continueClosingSidebar(): Observable<boolean> {\n    return of(true);\n  }\n\n  /**\n   * é»æ­¢ä¾§è¾¹æ å³é­\n   */\n  public stopClosingSidebar(): Observable<boolean> {\n    return of(false);\n  }\n}\n\nexport { SidebarService };\n","import { Injectable } from '@angular/core';\n\n/**\n * è¿æ»¤æ¡ä»¶æå¡\n * @scope FormModule\n */\n@Injectable()\nclass FilterService {\n\n  /**\n   * ç§»é¤åå«ç¹æ®å¼çè¿æ»¤æ¡ä»¶\n   * @todoï¼åå®filtersä¸ºå­ç¬¦ä¸²ï¼å¾è®¾è®¡æ¶æ¯ææ°ç»åæ°åä¸èµ·è°æ´\n   */\n  public stripFiltersWithSpecialValue(filters: string, specialValues: string): string {\n    if (!filters || !specialValues) {\n      return filters;\n    }\n\n    const filterArray: any[] = JSON.parse(filters);\n    const strippedFilterArray = filterArray.filter((filter: any) => {\n      const filterValue = this.getFilterValue(filter);\n      return specialValues.indexOf(filterValue) === -1;\n    });\n\n    return JSON.stringify(strippedFilterArray);\n  }\n\n  /**\n   * è·åè¿æ»¤æ¡ä»¶çå¼\n   * @todoï¼æ²¡æFilteræ¥å£å®ä¹ï¼ç®åäº§åé¨å¤§å°åä¸ä¸è´ã\n   */\n  private getFilterValue(filter: any) {\n    return filter.Value || filter.value;\n  }\n}\n\nexport { FilterService };\n","import { Injectable, InjectionToken, Inject, Optional } from '@angular/core';\nexport const FARRIS_FORM_COMPONENTS = new InjectionToken<{ [key: string]: any }>('è¡¨åå¼¹åºçªå£æéèç»ä»¶åè¡¨');\n\n/**\n * è¡¨åæå¡\n * @scope FormModule\n */\n@Injectable()\nexport class ComponentManagerService {\n\n  private controls: { [key: string]: any } = {};\n\n  appendControl(key: string, cmpIns: any) {\n    this.controls[key] = cmpIns;\n  }\n\n  getControl(key: string) {\n    if (this.controls[key]) {\n      return this.controls[key];\n    } else {\n      console.warn(`æªæ¾å°Keyä¸º${key}çç»ä»¶ï¼`);\n      return null;\n    }\n  }\n  public clear(key?: string) {\n    if (key) {\n      this.controls[key] = null;\n      delete this.controls[key];\n    } else {\n      this.controls = {};\n    }\n  }\n}\n","import { Observable, of,Subject } from \"rxjs\";\n\nexport class AuthorityService {\n    queryOperationAuthority(operationIds: Array<string>): Observable<Map<string, boolean>>{\n        var queryResult = new Map<string, boolean>();\n        var i=0;\n        for(var j=0; j<operationIds.length; j++) {\n            queryResult.set(operationIds[j], i%2==0? true:false);\n            i++;            \n        }\n\n        var dummyResult = new Subject<Map<string, boolean>>();\n        setTimeout(() => {\n            dummyResult.next(queryResult);\n        }, 0);\n\n        return dummyResult;\n    }\n}\n","import { AuthorityService } from './authority.service';\nimport {Observable, empty} from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n/**\n * æé\n */\nexport class Authority {\n    \n    constructor() {\n        this.operationLabelMap = new Map<string, string>();\n        this.authOfLabel = new Map<string, boolean>();\n    }\n\n    /**\n     * ä»labelå°æä½æéIDçæ å°ï¼labelå¯ä»¥æ¯button idç­\n     */\n    private operationLabelMap: Map<string, string>;\n\n    /**\n     * è®°å½labelå¯¹äºçæä½æéï¼æ¯å¦éè¿\n     */\n    private authOfLabel: Map<string, boolean>;\n\n    /**\n     * è®¾ç½®labelå°operation idçæ å°\n     * @param labelMap \n     */\n    protected setLabelMap(labelMap: Object) {\n        for(var i in labelMap) {\n            this.operationLabelMap.set(i, labelMap[i]);\n        }\n        this.operationLabelMap.forEach((opId, label) => {\n            this[label] = false;\n        });        \n    }\n    \n    /**\n     * åå§åæéçå¼\n     */\n    initialize(authorityService: AuthorityService): Observable<void> {\n        if(this.operationLabelMap && this.operationLabelMap.size>0) {\n            return authorityService.queryOperationAuthority(Array.from(this.operationLabelMap.values())).pipe(\n                map((operationAuth) => {\n                    this.operationLabelMap.forEach((opId, label) => {\n                        this.authOfLabel.set(label, operationAuth.has(opId) ? operationAuth.get(opId) : false);\n                    });\n                })\n            );\n        }else{\n            return empty();\n        }\n    }\n\n    /**\n     * è¿åæä½æéï¼å³ç¨æ·æ¯å¦æ¥æLabelæå¯¹åºçæé\n     * @param label æ ç­¾ï¼å¯ä»¥æ¯button idç­\n     */\n    hasOperation(label:string) {        \n        return this.authOfLabel.has(label) && this.authOfLabel.get(label);\n    }\n\n    // è¿åå­æ®µæé\n    // hasField(field:string)\n}","/*\n * @Author: aalizzwell\n * @Date: 2019-05-30 10:35:09\n * @Last Modified by: aalizzwell\n * @Last Modified time: 2019-06-15 19:22:13\n */\nimport { Injectable, Optional } from '@angular/core';\nimport { LanguageService } from './languag.service';\nimport { FormErrorService } from './error/form-error.service';\nimport { IExceptionHandler, AppContext } from '@farris/devkit';\n\n/**\n * é»è®¤å¼å¸¸å¤çå¨\n * @scope æ²¡ææä¾å¯¹åºProvider\n */\n@Injectable()\nclass ExceptionHandler implements IExceptionHandler {\n  private appContext: AppContext = null;\n  constructor(\n    private formErrorService: FormErrorService,\n    @Optional() private languageService: LanguageService,\n    private applicationContext: AppContext,\n  ) {\n    if (this.languageService == null) {\n      this.languageService = LanguageService.getInstance();\n    }\n  }\n  public setContext(applicationContext: AppContext) {\n    this.appContext = applicationContext;\n  }\n  public handle(error: any) {\n    if (!!this.formErrorService) {\n      this.formErrorService.exception(this.languageService.loadFailed, error);\n    }\n  }\n}\n\nexport { ExceptionHandler };\n","import { Provider } from '@angular/core';\nimport { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormMessageService } from '../form-message.service';\nimport { HideEventService } from '../form-loading/hide-event.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { CheckService } from '../check.service';\nimport { DataCheckService } from '../data-check.service';\n\nimport { EventService } from '../event.service';\nimport { MenuStateService } from '../menu-state.service';\nimport { RouterService } from '../router.service';\nimport { UIStateService } from '../ui-state.service';\nimport { StateMachineService } from '../state-machine.service';\nimport { ValidationService } from '../validation.service';\nimport { BindingDataService } from '../binding-data.service';\nimport { CommandService } from '../command-service';\n\nimport { QuerystringService } from '../querystring';\nimport { RuntimeFrameworkService } from '../rtf-service';\nimport { NavigationEventService } from '../navigation-event.service';\nimport { NavigationService } from '../navigation.service';\nimport { NavigationMiddlewareService } from '../navigation-middleware.service';\nimport { GridMiddlewareService } from '../grid.middleware.service';\nimport { ParamService } from '../param.service';\n\nimport { BeActionService } from '../be-action.service';\nimport { ApproveService } from '../approve.service';\nimport { PrintService } from '../print.service';\nimport { AttachmentDataService, AttachmentService } from '../attachment/index';\nimport { ApplicationParamService } from '../application-param.service';\nimport {\n  EntityTraversingService, EntityManipulationService, EntityAggregationService,\n  EntityListService, EntityService\n} from '../entity-services/index';\nimport { LanguageService } from '../languag.service';\nimport { DialogService } from '../dialog.service';\nimport { SidebarService } from '../sidebar-service';\nimport { FarrisFormService } from '../farris-form.service';\nimport { FilterService } from '../filter-service';\nimport { ChangeItemService } from '../change-item.service';\n\n// data-services\nimport { ListDataService } from '../data-services/list-data.service';\nimport { TreeDataService } from '../data-services/tree-data.service';\nimport { CardDataService } from '../data-services/card-data.service';\nimport { SubListDataService } from '../data-services/sub-list-data.service';\nimport { KeybindingService } from '../keybinding-service';\nimport { FocusInvalidService } from '../focus-invalid.service';\nimport { SubTreeDataService } from '../data-services/sub-tree-data-service';\n\n/**\n * éççèProviders\n */\nconst FARRIS_COMMAND_SERVICE_PROVIDERS: Provider[] = [\n\n  // è¡¨åæ¨¡åæ³¨å¥ï¼18ä¸ªï¼\n  FormLoadingService,\n  FormMessageService,\n  FormNotifyService,\n  FormErrorService,\n  CheckService,\n  DataCheckService,\n  EventService,\n  FilterService,\n  KeybindingService,\n  LanguageService,\n  ParamService,\n  MenuStateService,\n  QuerystringService,\n  RuntimeFrameworkService,\n  NavigationEventService,\n  NavigationService,\n  RouterService,\n  ApplicationParamService,\n\n  // FrameComponentï¼20ä¸ªï¼\n  ValidationService,\n  FocusInvalidService,\n  ChangeItemService,\n  UIStateService,\n  StateMachineService,\n  BindingDataService,\n  CommandService,\n\n  // entity-services\n  EntityTraversingService,\n  EntityManipulationService,\n  EntityAggregationService,\n  EntityListService,\n  EntityService,\n\n  ListDataService,\n  TreeDataService,\n  SubTreeDataService,\n  CardDataService,\n  SubListDataService,\n\n  BeActionService,\n  ApproveService,\n  PrintService,\n  AttachmentDataService,\n  AttachmentService,\n  NavigationMiddlewareService,\n  GridMiddlewareService,\n  SidebarService,\n  FarrisFormService,\n  DialogService,\n];\n\nexport { FARRIS_COMMAND_SERVICE_PROVIDERS };\n","import { Injectable, Injector, Optional } from '@angular/core';\nimport { NumberFormat, UserSettings } from '@farris/devkit';\nimport { FrmI18nSettingService } from '@gsp-sys/rtf-common';\n\n@Injectable()\nexport class UserSettingsService implements UserSettings {\n  constructor(private injector: Injector, @Optional() private frmI18nSettingService: FrmI18nSettingService) { }\n\n  /**\n   * ç¨æ·æ¶åºå­ç¬¦ä¸²\n   */\n  public get timeZone(): string {\n    return this.timezone && this.timezone.id || null;\n  }\n  /**\n   * æ¶åºåç§»\n   */\n  public get timeZoneOffset(): number {\n    const offset = this.timezone && this.timezone.baseOffset;\n    if (offset !== null && offset !== undefined) {\n      return offset;\n    } else {\n      return null;\n    }\n  }\n  /**\n   * é»è®¤è¯­è¨\n   */\n  public get defaultLanguage(): string {\n    return this.i18nSetting && this.i18nSetting.defaultLanguage || null;\n  }\n  /**\n   * æ¥ææ ¼å¼åå­ç¬¦ä¸²\n   * like: yyyy-MM-dd\n   */\n  public get dateFormat(): string {\n    return this.i18nSetting && this.i18nSetting.userDateFormat || null;\n  }\n  /**\n   * æ¶é´æ ¼å¼\n   * like: HH:MM:ss\n   */\n  public get timeFormat(): string {\n    return this.i18nSetting && this.i18nSetting.userTimeFormat || null;\n  }\n  public get dateTimeFormat(): string {\n    const dateFormat = this.i18nSetting && this.i18nSetting.userDateFormat || 'yyyy-MM-dd';\n    const timeFormat = this.i18nSetting && this.i18nSetting.userTimeFormat || 'HH:mm:ss';\n    return `${dateFormat} ${timeFormat}`;\n  }\n  /**\n   * å°åæ ¼å¼\n   */\n  public get addressFormat(): any {\n    return null;\n  }\n  /**\n   * æ°å­æ ¼å¼\n   */\n  public get numberFormat(): NumberFormat {\n    if (this.i18nSetting && this.i18nSetting.userNumberFormat) {\n      const userNumberFormat = this.i18nSetting.userNumberFormat;\n      const numberFormat: NumberFormat = {\n        negativeSign: userNumberFormat.negativeSign || '-',\n        numberDecimalDigits: userNumberFormat.numberDecimalDigits || 2,\n        numberDecimalSeparator: userNumberFormat.numberDecimalSeparator || '.',\n        numberGroupSeparator: userNumberFormat.numberGroupSeparator || ','\n      };\n      return numberFormat;\n    }\n    return null;\n  }\n  /**\n   * åºåä»£ç \n   */\n  public get regionCode(): string {\n    return this.i18nSetting && this.i18nSetting.userRegionCode || null;\n  }\n  /**\n   * ç¨æ·éç½®\n   */\n  private get userSettings(): any {\n    const userSettings = this.frmI18nSettingService && this.frmI18nSettingService.getSetting();\n    return userSettings;\n  }\n  private get timezone() {\n    return this.i18nSetting && this.i18nSetting.timezone;\n  }\n  private get i18nSetting() {\n    return this.userSettings && this.userSettings.i18nSetting;\n  }\n}","import { Injectable } from \"@angular/core\";\nimport { WorkFlow } from \"./types\";\n\n@Injectable()\nexport class WorkFlowMessageService {\n  private messageHandler: (callback: (e: WorkFlow.IMessage) => void) => (event: any) => void;\n  private handler: (event: any) => void;\n  constructor() {\n    this.messageHandler = (callback: (e: WorkFlow.IMessage) => void) => {\n      return (event: any) => {\n        var message = event.data as WorkFlow.IMessage;\n        if (message) {\n          message.sender = event.source;\n        }\n        if (typeof callback === 'function') {\n          callback(message);\n        }\n      }\n    }\n  }\n  /**\n   * çå¬å·¥ä½æµæ¶æ¯\n   * @param callback åè°\n   */\n  public listen(callback: (e: WorkFlow.IMessage) => void) {\n    this.handler = this.messageHandler(callback);\n    window.addEventListener('message', this.handler);\n  }\n  public destroy() {\n    if (this.handler) {\n      window.removeEventListener('message', this.handler);\n    }\n\n  }\n  /**\n   * ç»å·¥ä½æµè¡¨ååéæ¶æ¯\n   * @param message \n   */\n  public send(message: WorkFlow.IMessage): void {\n    if (!message) {\n      return;\n    }\n    let win: Window = window;\n    if (message.target) {\n      win = message.target as Window || window;\n      delete message.target;\n    }\n    if (win) {\n      win.postMessage(message, '*');\n    }\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { WorkFlow } from \"./types\";\nimport { WorkFlowMessageService } from \"./work-flow-message.service\";\n\n/**\n * å·¥ä½æµæ¶æ¯\n * @warning ç¦æ­¢ä½¿ç¨è¡¨åä¸ä¸æï¼ææä¸ä¸æå¿é¡»ä»å¤é¨ä¼ å¥\n */\n@Injectable()\nexport class WorkFlowMessage {\n  private listeners: Map<string, any>;\n  constructor(private injector: Injector, public workFlowMessageService: WorkFlowMessageService) {\n    this.listeners = new Map<string, any>();\n  }\n  public setup() {\n    if (!this.workFlowMessageService) {\n      return;\n    }\n    this.workFlowMessageService.listen((message: WorkFlow.IMessage) => {\n      if (!this.listeners || this.listeners.size < 1) {\n        return;\n      }\n      this.listeners.forEach((callback: any, key: string) => {\n        if (typeof callback === 'function') {\n          callback(message);\n        }\n      })\n    });\n  }\n  public addEventListener(callback: (event: MessageEvent) => void): string {\n    const id = `${new Date().valueOf().toString(16)}-${Math.ceil(Math.random() * 100)}`;\n    this.listeners.set(id, callback);\n    return id;\n  }\n  public removeEventListener(eventId: string): void {\n    if (!this.listeners || this.listeners.size < 1) {\n      return;\n    }\n    this.listeners.delete(eventId);\n    eventId = null;\n  }\n}\n","import { Injectable, Injector } from \"@angular/core\";\nimport { AppContext, AppContextManager, FrameContext, onFrameComponentInit } from \"@farris/devkit\";\nimport { from, Observable, of } from \"rxjs\";\nimport { BefRepository, BefRepositoryUtil } from '@farris/bef';\nimport { concatMap, throwIfEmpty } from \"rxjs/operators\";\nimport { ValidationService } from \"../validation.service\";\nimport { WorkFlow } from \"./types\";\nimport { WorkFlowMessage } from \"./work-flow-message\";\nimport { WorkFlowMessageService } from \"./work-flow-message.service\";\n\n@Injectable()\nexport class WorkFlowMessageHandler implements onFrameComponentInit {\n  constructor(private injector: Injector, private frameContext: FrameContext, private workFlowMessageService: WorkFlowMessageService, private workFlowMessage: WorkFlowMessage) {\n\n  }\n  public onComponentInit(frameContext: FrameContext) {\n    const eventId = this.workFlowMessage.addEventListener(this.handle.bind(this));\n    const frameContextDestroySignal = this.frameContext.destorySignal;\n    if (frameContextDestroySignal) {\n      frameContextDestroySignal.subscribe(() => {\n        this.workFlowMessage.removeEventListener(eventId);\n      });\n    }\n    const appContextDestroySignal = this.frameContext.appContext.destorySignal;\n    if (appContextDestroySignal) {\n      appContextDestroySignal.subscribe(() => {\n        this.workFlowMessage.workFlowMessageService.destroy();\n      });\n    }\n  }\n  public handle(message: WorkFlow.IMessage): void {\n    const source = message.sender as Window;\n    const data = message.data as WorkFlow.IMessageBody;\n    const commandName = data && data.command || null;\n    let resultTask: Observable<any> = null;\n    if (!commandName) {\n      return;\n    }\n    if (commandName == 'wf-required-verification') {\n      // å·¥ä½æµçå¿å¡«æ ¡éª\n      // å¦æ­¤è·åçæ¯å½åç»ä»¶çæ ¡éªæå¡ï¼åºè¯¥ænamespaceæ¥åºåï¼ä¸åçnamespaceéè¦åå«æ§è¡æ ¡éª\n      const formFrameContexts = this.getFormFrameContexts();\n      resultTask = from(formFrameContexts).pipe(\n        concatMap((frameContext: FrameContext) => {\n          var validation = frameContext.injector.get<ValidationService>(ValidationService, null);\n          if (validation) {\n            return validation.validateAll();\n          }\n          return of(true);\n        })\n      );\n    } else {\n      var command = this.frameContext.viewModel[commandName];\n      if (command) {\n        resultTask = command(data.arguments);\n      }\n    }\n    if (resultTask) {\n      const message: WorkFlow.IMessage = this.buildMessage(true, source, this.isChanged);\n      resultTask.pipe(throwIfEmpty()).subscribe((result) => {\n        // åæ¥æºæ¹åä¼ æ¶æ¯\n        this.workFlowMessageService.send(message);\n      }, () => {\n        message.data.result = false;\n        this.workFlowMessageService.send(message);\n      });\n    }\n  }\n  private buildMessage(result: boolean, target: any, dataChanged: boolean, type: string = 'message') {\n    const message: WorkFlow.IMessage = {\n      data: {\n        result,\n        dataChanged\n      },\n      type: type,\n      target: target,\n    };\n    return message;\n  }\n  private getFormFrameContexts(): FrameContext[] {\n    const appContextManager = this.injector.get<AppContextManager>(AppContextManager, null);\n    const formFrameContexts = [];\n    if (appContextManager) {\n      const appContexts: AppContext[] = appContextManager.getAppContexts();\n      if (appContexts && appContexts.length > 0) {\n        appContexts.forEach((appContext: AppContext) => {\n          const frameContexts: FrameContext[] = appContext.frameContextManager.getFrameContexts();\n          frameContexts.reduce((contexts: FrameContext[], frameContext: FrameContext) => {\n            const namespace = frameContext.namespace;\n            const index = contexts.findIndex((frame: FrameContext) => frame.namespace === namespace);\n            if (index === -1) {\n              const root = frameContext.getVirtualRootFrameContext();\n              contexts.push(root);\n            }\n            return contexts;\n          }, formFrameContexts);\n        });\n      }\n    }\n    return formFrameContexts;\n  }\n  /**\n   * æ¯å¦ææªä¿å­çåæ´\n   */\n  private get isChanged(): boolean {\n    const befRepository = this.frameContext.repository as BefRepository<any>;\n    return BefRepositoryUtil.isExistUnsaveData(befRepository);\n  }\n}","import { FormLoadingService } from '../form-loading/form-loading.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { FormErrorService } from '../error/form-error.service';\nimport { FormWizardService } from '../form-wizard.service';\n\nimport { CheckService } from '../check.service';\nimport { DataCheckService } from '../data-check.service';\nimport { EventService } from '../event.service';\nimport { ComponentManagerService } from '../component-manager.service';\nimport { FilterService } from '../filter-service';\nimport { KeybindingService } from '../keybinding-service';\nimport { LanguageService } from '../languag.service';\n\nimport { MenuStateService } from '../menu-state.service';\nimport { QuerystringService } from '../querystring';\nimport { RuntimeFrameworkService } from '../rtf-service';\nimport { NavigationEventService } from '../navigation-event.service';\nimport { NavigationService } from '../navigation.service';\nimport { ParamService } from '../param.service';\nimport { RouterService } from '../router.service';\nimport { ApplicationParamService } from '../application-param.service';\nimport { FilterConditionService } from '../filter-condition.service';\nimport { UserSettingsService } from '../user-settings.service';\nimport { UserSettingsToken } from '@farris/devkit';\nimport { WorkFlowMessage, WorkFlowMessageService } from '../work-flow/index';\n/**\n * æ¨¡åçº§æ³¨å¥(å±20ä¸ª)\n */\nconst FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS = [\n  FormLoadingService,\n  FormMessageService,\n  FormNotifyService,\n  FormErrorService,\n  FormWizardService,\n  CheckService,\n  DataCheckService,\n  EventService,\n  ComponentManagerService,\n  FilterService,\n  KeybindingService,\n  LanguageService,\n  ParamService,\n  MenuStateService,\n  QuerystringService,\n  RuntimeFrameworkService,\n  NavigationEventService,\n  NavigationService,\n  RouterService,\n  ApplicationParamService,\n  FilterConditionService,\n  { provide: UserSettingsToken, useClass: UserSettingsService },\n  WorkFlowMessageService,\n  WorkFlowMessage\n];\n\nexport { FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS }\n","/**\n * æ¯è¾ç¬¦\n */\nexport enum CompareType{\n    Equal = 0,\n    NotEqual = 1,\n    Greater = 2,\n    GreaterOrEqual = 3,\n    Less = 4,\n    LessOrEqual = 5,\n    Like = 6,\n    LikeStartWith = 7,\n    LikeEndWith = 8,\n    NotLike = 9,\n    NotLikeStartWith = 10,\n    NotLikeEndWith = 11,\n    Is = 12,\n    IsNot = 13,\n    In = 14,\n    NotIn = 15\n}","export enum ValueType{\n\n    /**\n     *å¼ç±»å\n     */\n    Value = 0,\n\n    /**\n     * è¡¨è¾¾å¼\n     */\n    Express = 1\n}","export enum RelationType{\n\n    Empty = 0,\n\n    /**\n     * ä¸\n     */\n    // And=0,\n    And = 1,\n\n    /**\n     * æ\n     */\n    // Or=1\n    Or = 2\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, TextValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class TextHandler implements IQueryConditionHandler {\n  convert(qc: QueryCondition) {\n    const tv = (qc.value as TextValue);\n    return [{\n      'FilterField': qc.fieldCode,\n      'Compare': CompareType.Like,\n      'Value': tv.value, // jsonè½¬ä¹ä¸encodeUriComponentä¸åï¼ä¸åºå¨æ­¤è½¬ä¹ï¼ç±jsonåé¨è½¬ä¹å³å¯\n      'Relation': RelationType.And,\n      'Expresstype': ValueType.Value\n    }];\n  }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, DateRangeValue} from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class DateRangeHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const arr = [];\n        const drv = (qc.value as DateRangeValue);\n        drv.startTime && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.GreaterOrEqual, //GreaterOrEqual\n            'Value' : drv.startTime,\n            'Relation' : RelationType.And, //and\n            'Expresstype': ValueType.Value\n        });\n        drv.endTime && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.LessOrEqual, //LessOrEqual\n            'Value' : drv.endTime,\n            'Relation' : RelationType.And,//and\n            'Expresstype': ValueType.Value\n        });\n\n        return arr;\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, DropDownListValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class DropDownHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const ddv = (qc.value as DropDownListValue);\n        const arr = [];\n        ddv.value.forEach(dv => {\n            arr.push({\n                'FilterField' : qc.fieldCode,\n                'Compare' : CompareType.Equal,\n                'Value' : dv.value,\n                'Relation' : RelationType.Or,\n                'Expresstype':ValueType.Value\n            });\n        });\n        arr[0]['Lbracket'] = '(';\n        arr[arr.length -1]['Rbracket'] = ')';\n        arr[arr.length -1]['Relation'] = RelationType.And;\n        return arr;\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, NumberRangeValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class NumberRangeHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const arr = [];\n        const nrv = (qc.value as NumberRangeValue);\n        (nrv.startValue != null) && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.GreaterOrEqual, //GreaterOrEqual\n            'Value' : nrv.startValue,\n            'Relation' : RelationType.And, //and\n            'Expresstype': ValueType.Value\n        });\n        (nrv.endValue != null) && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.LessOrEqual, //LessOrEqual\n            'Value' : nrv.endValue,\n            'Relation' : RelationType.And,//and\n            'Expresstype': ValueType.Value\n        });\n\n        return arr;\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SmartHelpValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SmartHelpHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const shv = (qc.value as SmartHelpValue);\n        if(shv.value.length == 0) return [];\n\n        const arr = [];\n        if(shv.isInputText || shv.valueField == null){\n            arr.push({\n                'FilterField' : qc.fieldCode,\n                'Compare' : CompareType.Like,\n                'Value' : shv.textValue,\n                'Relation' : RelationType.And,\n                'Expresstype':ValueType.Value\n            });\n            return arr;\n        }else{\n            shv.getOriginalValue().split(',').forEach(id => {\n                id && arr.push({\n                    'FilterField' : qc.fieldCode,\n                    'Compare' : CompareType.Equal,\n                    'Value' : id,\n                    'Relation' : RelationType.Or,\n                    'Expresstype':ValueType.Value\n                });\n            });\n            if(arr.length > 0){\n                arr[0]['Lbracket'] = '(';\n                arr[arr.length -1]['Rbracket'] = ')';\n                arr[arr.length -1]['Relation'] = RelationType.And;\n                return arr;\n            }else{\n                return [];\n            }\n        }\n    }\n}\n","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SingleYearValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SingleYearHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const yv = (qc.value as SingleYearValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : yv.yearValue,\n            'Relation' : RelationType.And, //and undefined\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, CheckBoxValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class CheckBoxHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const arr = [];\n        const tv = (qc.value as CheckBoxValue);\n        if(tv.value.length == 1)\n            return [{\n                'FilterField' : qc.fieldCode,\n                'Compare' : CompareType.Equal,\n                'Value' : tv.value[0],\n                'Relation' : RelationType.And,\n                'Expresstype':ValueType.Value\n            }];\n        tv.value.forEach(tvv => {\n            arr.push({\n                'FilterField' : qc.fieldCode,\n                'Compare' : CompareType.Equal,\n                'Value' : tvv,\n                'Relation' : RelationType.Or,\n                'Expresstype':ValueType.Value\n            });\n        });\n        arr[0]['Lbracket'] = '(';\n        arr[arr.length -1]['Rbracket'] = ')';\n        arr[arr.length -1]['Relation'] = RelationType.And;\n        return arr;\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SingleMonthValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SingleMonthHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const mv = (qc.value as SingleMonthValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : mv.monthValue,\n            'Relation' : RelationType.And, //and undefined\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, MonthRangeValue} from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class MonthRangeHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const arr = [];\n        const mrv = (qc.value as MonthRangeValue);\n        mrv.startTime && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.GreaterOrEqual, //GreaterOrEqual\n            'Value' : mrv.startTime,\n            'Relation' : RelationType.And, //and\n            'Expresstype': ValueType.Value\n        });\n        mrv.endTime && arr.push({\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.LessOrEqual, //LessOrEqual\n            'Value' : mrv.endTime,\n            'Relation' : RelationType.And,//and\n            'Expresstype': ValueType.Value\n        });\n\n        return arr;\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SingleDateTimeValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SingleDateTimeHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const dtv = (qc.value as SingleDateTimeValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : dtv.datetimeValue,\n            'Relation' : RelationType.And, //and undefined\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SingleNumberValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SingleNumberHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const dtv = (qc.value as SingleNumberValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : dtv.numValue,\n            'Relation' : RelationType.And, //and undefined\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, SingleDateValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class SingleDateHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const dtv = (qc.value as SingleDateValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : dtv.dateValue,\n            'Relation' : RelationType.And, //and undefined\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, ComboLookUpValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class ComboLookUpHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const cluv = (qc.value as ComboLookUpValue);\n        if(cluv.value.length == 0 || !cluv.valueField){\n            return [];\n        }else{\n            const arr = [];\n            cluv.getOriginalValue().split(',').forEach(id => {\n                id && arr.push({\n                    'FilterField' : qc.fieldCode,\n                    'Compare' : CompareType.Equal,\n                    'Value' : id,\n                    'Relation' : RelationType.Or,\n                    'Expresstype':ValueType.Value\n                });\n            });\n            if(arr.length > 0){\n                arr[0]['Lbracket'] = '(';\n                arr[arr.length -1]['Rbracket'] = ')';\n                arr[arr.length -1]['Relation'] = RelationType.And;\n                return arr;\n            }else{\n                return [];\n            }\n        }\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, RadioValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class RadioHandler implements IQueryConditionHandler{\n    convert(qc: QueryCondition) {\n        const arr = [];\n        const rv = (qc.value as RadioValue);\n        return [{\n            'FilterField' : qc.fieldCode,\n            'Compare' : CompareType.Equal,\n            'Value' : rv.value,\n            'Relation' : RelationType.And,\n            'Expresstype':ValueType.Value\n        }];\n    }\n}","import { IQueryConditionHandler } from \"./iquerycondition.handler\";\nimport { QueryCondition, InputGroupValue } from \"@farris/component-querycondition\";\nimport { CompareType } from '../enum/compare-type.enum';\nimport { ValueType } from '../enum/value-type.enum';\nimport { RelationType } from '../enum/relation-type.enum';\n\nexport class InputGroupHandler implements IQueryConditionHandler {\n  convert(qc: QueryCondition) {\n    const igv = (qc.value as InputGroupValue);\n    const arr = [];\n\n    if (igv.isInputText || igv.textField == null) {\n      arr.push({\n        'FilterField': qc.fieldCode,\n        'Compare': CompareType.Like,\n        'Value': igv.textValue,//encodeURIComponent(igv.textValue),\n        'Relation': RelationType.And,\n        'Expresstype': ValueType.Value\n      });\n      return arr;\n    }\n    else {\n      igv.getOriginalValue().split(',').forEach(itemValue => {\n        itemValue && arr.push({\n          'FilterField': qc.fieldCode,\n          'Compare': CompareType.Equal,\n          'Value': itemValue,\n          'Relation': RelationType.Or,\n          'Expresstype': ValueType.Value\n        });\n      });\n      if (arr.length > 0) {\n        arr[0]['Lbracket'] = '(';\n        arr[arr.length - 1]['Rbracket'] = ')';\n        arr[arr.length - 1]['Relation'] = RelationType.And;\n        return arr;\n      } else {\n        return [];\n      }\n    }\n  }\n}\n","import { ControlType } from \"@farris/component-querycondition\";\nimport { IQueryConditionHandler } from \"./handlers/iquerycondition.handler\";\nimport { TextHandler } from \"./handlers/text.handler\";\nimport { DateRangeHandler } from \"./handlers/daterage.handler\";\nimport { DropDownHandler } from \"./handlers/dropdown.handler\";\nimport { NumberRangeHandler } from \"./handlers/numberrage.handler\";\nimport { SmartHelpHandler } from \"./handlers/smarthelp.handler\";\nimport { SingleYearHandler } from './handlers/single-year.handler';\nimport { CheckBoxHandler } from './handlers/checkbox.handler';\nimport { SingleMonthHandler } from './handlers/single-month.handler';\nimport { MonthRangeHandler } from './handlers/monthrange.handler';\nimport { SingleDateTimeHandler } from './handlers/single-date-time.handler';\nimport { SingleNumberHandler } from './handlers/single-number.handler';\nimport { SingleDateHandler } from './handlers/single-date.handler';\nimport { ComboLookUpHandler } from './handlers/combolookup.handler';\nimport { RadioHandler } from './handlers/radio.handler';\nimport { InputGroupHandler } from './handlers/inputgroup.handler';\n\nexport class QueryConditionHandlerFactory {\n\n    private static _instance: QueryConditionHandlerFactory = null;\n    private queryConditionHandlerMapping: Map<ControlType, IQueryConditionHandler> = new Map<ControlType, IQueryConditionHandler>();\n    private constructor(){\n        this.queryConditionHandlerMapping.set(ControlType.Text, new TextHandler());\n        this.queryConditionHandlerMapping.set(ControlType.InputGroup, new InputGroupHandler());\n        this.queryConditionHandlerMapping.set(ControlType.DateRange, new DateRangeHandler());\n        this.queryConditionHandlerMapping.set(ControlType.DateTimeRange, new DateRangeHandler());\n        this.queryConditionHandlerMapping.set(ControlType.DropDownList, new DropDownHandler());\n        this.queryConditionHandlerMapping.set(ControlType.NumberRange, new NumberRangeHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SmartHelp, new SmartHelpHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SingleYear, new SingleYearHandler());\n        this.queryConditionHandlerMapping.set(ControlType.BoolCheck, new CheckBoxHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SingleMonth, new SingleMonthHandler());\n        this.queryConditionHandlerMapping.set(ControlType.MonthRange, new MonthRangeHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SingleDateTime, new SingleDateTimeHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SingleNumber, new SingleNumberHandler());\n        this.queryConditionHandlerMapping.set(ControlType.SingleDate, new SingleDateHandler());\n        this.queryConditionHandlerMapping.set(ControlType.ComboLookUp, new ComboLookUpHandler());\n        this.queryConditionHandlerMapping.set(ControlType.Radio, new RadioHandler());\n    }\n    public static getInstance(){\n        if(!QueryConditionHandlerFactory._instance){\n            QueryConditionHandlerFactory._instance = new QueryConditionHandlerFactory();\n        }\n        return QueryConditionHandlerFactory._instance;\n    }\n\n    getHandler(controlType: ControlType): IQueryConditionHandler{\n        return this.queryConditionHandlerMapping.get(controlType);\n    }\n}","import { Injectable } from '@angular/core';\nimport { QueryCondition } from '@farris/component-querycondition';\nimport { IQueryConditionHandler } from './handlers/iquerycondition.handler';\nimport { QueryConditionHandlerFactory } from './querycondition.handler.factory';\nimport { FrameContext } from '@farris/devkit';\nimport { IQuerySolutionHandler,QuerySolutionComponent } from '@gsp-cmp/querysolution';\nimport { FrameworkSessionService } from '@farris/bef';\n\n@Injectable()\nexport class QuerySolutionService implements IQuerySolutionHandler {\n\n  constructor(\n    private frameContext: FrameContext,\n    private frameworkSessionService: FrameworkSessionService\n  ) {\n\n  }\n\n  getUserSessionId(): string {\n    return this.frameworkSessionService.getUserSessionId();\n  }\n\n  public setFilterConditions(params: Array<QueryCondition>): void {\n    let queryConditionHandler: IQueryConditionHandler;\n    const filterConditionList = [];\n    params.forEach(qc => {\n      if (!qc.value.isEmpty()) {\n        queryConditionHandler = QueryConditionHandlerFactory.getInstance().getHandler(qc.control.getControlType());\n        queryConditionHandler && filterConditionList.push(...queryConditionHandler.convert(qc));\n      }\n    });\n    //è®¾ç½®å°NgCommand params.filterå±æ§ä¸ï¼{UISTATE~/root-component/filterConditionList}\n    this.frameContext.uiState['filterConditionList'] = JSON.stringify(filterConditionList);\n    // const originalConditions = this.getOriginalQueryConditions(filterConditionList);\n    this.frameContext.uiState['originalFilterConditionList'] = JSON.stringify(filterConditionList);\n  }\n\n  public setCurrentQueryConditions(conditions: QueryCondition[]): void {\n    this.frameContext.uiState['currentQueryConditions'] = conditions;\n  }\n  /**\n   * è¿åè¿æ»¤æ¡ä»¶ä¸­çencode\n   * @param conditions æ¥è¯¢æ¹æ¡æé å®çè¿æ»¤æ¡ä»¶\n   */\n  // private getOriginalQueryConditions(conditions: Array<any>): Array<any> {\n  //   conditions = JSON.parse(JSON.stringify(conditions));\n  //   if (conditions && Array.isArray(conditions) && conditions.length > 0) {\n  //     conditions = conditions.map((item) => {\n  //       if (item.hasOwnProperty('Value')) {\n  //         item.Value = decodeURIComponent(item.Value);\n  //       } else if (item.hasOwnProperty('value')) {\n  //         const value = item.value;\n  //         delete item.value;\n  //         item.Value = decodeURIComponent(value);\n  //       }\n  //       return item;\n  //     });\n  //   }\n  //   return conditions;\n  // }\n\n}\n","import { Injectable } from '@angular/core';\nimport { AppContext, FrameContext } from '@farris/devkit';\nimport { of } from 'rxjs';\nimport { concatMap, tap, delay } from 'rxjs/operators';\n\n/**\n * ç»æè¡¨åç¼è¾ç¶ææå¡\n */\n@Injectable()\nclass EndEditService {\n  constructor(private frameContext: FrameContext) {\n  }\n  /**\n   * ç»æç¼è¾\n   */\n  public endEdit() {\n    const appContext: AppContext = this.frameContext && this.frameContext.getFormAppContext();\n    return of(null).pipe(\n      tap(() => {\n        if (appContext) {\n          appContext.messagePipe.next({ type: 'endEdit' });\n        }\n      }),\n      // todo: ä¸åºè¯¥ä½¿ç¨delayï¼åºè¯¥ä¸²æµ\n      delay(5)\n    );\n  }\n}\nexport { EndEditService };\n","import { Injectable } from '@angular/core';\nimport { ViewModel } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\nimport { of, Observable } from 'rxjs';\n\n@Injectable()\nexport class RemoteSummaryService {\n  constructor(private viewModel: ViewModel) { }\n  /**\n   * æå¡å¨ç«¯åè®¡\n   * @param methodName æå¡å¨ç«¯åè®¡èªå®ä¹å¨ä½åç§°\n   * @param filters è¿æ»¤æ¡ä»¶\n   */\n  public summary(methodName: string, filters: any) {\n    const repository = this.viewModel.frameContext.repository as BefRepository<any> || null;\n    if (repository) {\n      const proxy = repository.proxy;\n      if (proxy && typeof proxy[methodName] === 'function') {\n        return proxy[methodName](filters) as Observable<any>;\n      }\n    }\n    return of(null);\n  }\n}\n","import { Injectable, Injector, Optional } from '@angular/core';\nimport { BindingList, ViewModel, BindingObject, Repository, Entity, FrameContext, BindingData, AppContext, BindingProperty, DataTypeInfo, createEntities, EntityList } from '@farris/devkit';\nimport { from, EMPTY, concat, of, Subject, Observable } from 'rxjs';\nimport { concatMap, catchError, tap, switchMap, last, map, delay } from 'rxjs/operators';\nimport { BefRepository, ResponseInfo } from '@farris/bef';\nimport { BatchEditDialogService } from '@farris/ui-batch-edit-dialog';\nimport { DateTimeHelperService } from '@farris/ui-common/date';\nimport { ComponentManagerService } from './component-manager.service';\nimport { FormLoadingService } from './form-loading/form-loading.service';\nimport { LanguageService } from './languag.service';\nimport { FormNotifyService } from './form-notify.service';\n\n// tslint:disable: max-line-length\n/**\n * æ¹éç¼è¾æå¡\n */\n@Injectable()\nexport class BatchEditService {\n  private formLoadingService: FormLoadingService;\n  private onHelpClose: Subject<any>;\n  constructor(\n    private injector: Injector,\n    private componentManagerService: ComponentManagerService,\n    private viewModel: ViewModel,\n    private repository: Repository<any>,\n    private batchEditDialogService: BatchEditDialogService,\n    private dateService: DateTimeHelperService,\n    private languageService: LanguageService,\n    private formNotifyService: FormNotifyService\n  ) {\n    this.formLoadingService = this.injector.get<FormLoadingService>(FormLoadingService, null);\n    if (!this.languageService) {\n      this.languageService = LanguageService.getInstance();\n    }\n    if (!this.formNotifyService) {\n      this.formNotifyService = this.injector.get<FormNotifyService>(FormNotifyService, null);\n    }\n    this.onHelpClose = new Subject<any>();\n    this.onHelpClose.subscribe(result => {\n      const { frameId = '', mapFields = '', data = [] } = result || {};\n      this.onHelpCloseHandler(frameId, mapFields, data);\n    });\n  }\n\n  /**\n   * æå¼æ¹éç¼è¾å¯¹è¯æ¡\n   * @param frameId frameId\n   */\n  public openBatchEditDialog(frameId: string) {\n    if (!frameId) {\n      throw new Error('frameId is required.');\n    }\n    if (this.batchEditDialogService) {\n      let columns = [];\n      if (this.viewModel) {\n        const gridFrameContext: FrameContext = this.viewModel.frameContext.root.appContext.frameContextManager.getFrameContextById(frameId);\n        const gridViewModel = gridFrameContext.viewModel;\n        if (gridViewModel && gridViewModel.hasOwnProperty('dataGridColumnsName')) {\n          // tslint:disable-next-line: no-string-literal\n          const gridColumnsAttrName = gridViewModel['dataGridColumnsName'];\n          columns = gridViewModel[gridColumnsAttrName];\n        } else if (gridViewModel && gridViewModel.hasOwnProperty('dataGridColumns')) {\n          columns = gridViewModel['dataGridColumns'];\n        }\n        const ids: string[] = gridViewModel.uiState['ids'] || [];\n        if (!ids || ids.length < 1) {\n          this.formNotifyService.warning(this.languageService.plsCheckBatchEditRows, { hideTitle: true });\n          return EMPTY;\n        }\n        const dialogRef: any = this.batchEditDialogService.batchEdit(columns, {\n          rows: ids.length,\n          onConfirm: (inputs: Array<any>) => {\n            if (Array.isArray(ids) && ids.length > 0) {\n              // console.log('openBatchEditDialog', inputs);\n              const appContext = this.viewModel.frameContext.appContext;\n              appContext.changeDetectionController.detach();\n              inputs.forEach(input => {\n                this.updateBindingData(input, ids);\n              });\n              appContext.changeDetectionController.reattach();\n            }\n            dialogRef.close();\n          }\n        });\n      }\n    }\n  }\n  /**\n   * æå¼éèå¸®å©\n   * @param helpId å¸®å©id\n   */\n  public openHiddenHelp(helpId: string) {\n    if (!helpId) {\n      throw new Error('Argument error,helpId can`t be empty');\n    }\n    const componentManagerService = this.componentManagerService.getControl(helpId);\n    if (componentManagerService) {\n      componentManagerService.showDialog();\n    } else {\n      throw new Error(`the component which id is ${helpId} can't be found!`);\n    }\n  }\n  /**\n   * æ¸ç©ºå¸®å©å¾éï¼åªè½æè½½å°å¸®å©åäºä»¶ï¼\n   */\n  public clearHelpSelections() {\n    const self: any = this;\n    const helpElement = self.context && self.context.eventParam && self.context.eventParam.instance || null;\n    if (helpElement) {\n      helpElement.displayValue = '';\n    }\n  }\n  /**\n   * å¾éå½åè¡\n   * @param frameId frameId\n   * @param mapFields å­æ®µæ å°\n   * @param primaryKeyValue å¸®å©ä¸»é®å­æ®µ\n   */\n  public checkCurrentRow(frameId: string, mapFields: string, primaryKeyValue: string) {\n    const self: any = this;\n    const helpElement = self.context && self.context.eventParam && self.context.eventParam.instance || null;\n    if (!primaryKeyValue) {\n      primaryKeyValue = 'id';\n    }\n    const mappings = JSON.parse(mapFields);\n    if (helpElement) {\n      frameId = frameId || this.viewModel.frameContext.frameId;\n      if (frameId) {\n        const frameContext = this.getFrameContextById(frameId);\n        if (frameContext) {\n          const bindingPath = frameContext.viewModel.bindingPath;\n          if (bindingPath) {\n            const bindingPaths = bindingPath.split('/').filter(p => p);\n            const bindingList = frameContext.bindingData.getValue(bindingPaths) as BindingList;\n            const currentRow = bindingList.currentItem;\n            const path = mappings[primaryKeyValue];\n            if (path) {\n              const value = this.getValueByPath(currentRow, path);\n              helpElement.displayValue = value;\n            }\n          }\n        }\n      }\n    }\n  }\n  /**\n   * ä»¥å¸®å©å¾éæ°æ®ä½ä¸ºä¾æ®ï¼æ¹éæ°å¢ä¸»è¡¨æ°æ®\n   * @param frameId ä¸»è¡¨æå¨frameçid\n   * @param mapFields å¸®å©å­æ®µä¸ä¸»è¡¨å­æ®µæ å°\n   * @description ä»¥å¸®å©å¾éæ°æ®ä½ä¸ºä¾æ®ï¼æ¹éæ°å¢ä¸»è¡¨æ°æ®\n   */\n  public batchAppend(frameId: string, mapFields: string) {\n    const self: any = this;\n    const result = self.context && self.context.eventParam || [];\n    if (!mapFields) {\n      throw new Error('mapFields can`t be empty.');\n    }\n    if (result && Array.isArray(result) && result.length > 0) {\n      const mappings = JSON.parse(mapFields);\n      // ä¸æ¯bindingPathåæframeIdå¤ç\n      let bindingPath = '/';\n      const appContext = this.injector.get<AppContext>(AppContext, null);\n      if (appContext) {\n        const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n        if (frameContext) {\n          bindingPath = frameContext.viewModel.bindingPath || '/';\n        } else {\n          throw new Error('frameId is invalid!');\n        }\n      }\n      const defaultValues = [];\n      result.forEach((item) => {\n        const defaultValue = {};\n        Object.keys(mappings).forEach((prop: string) => {\n          const value = this.getValueByPath(item, prop);\n          const fields = mappings[prop];\n          const groups: any[] = fields.split(',').filter(p => p);\n          groups.forEach(group => {\n            const paths = group.split('.').filter(p => p);\n            this.setValueByPath(defaultValue, paths.join('.'), value);\n          });\n        });\n        defaultValues.push(defaultValue);\n      });\n      this.formLoadingService.show();\n      return this.repository.batchAppend(defaultValues).pipe(\n        tap(() => this.formLoadingService.hide()),\n        map(() => true)\n      );\n    }\n    return of(true);\n  }\n  /**\n   * ä»¥å¸®å©å¾éæ°æ®ä½ä¸ºä¾æ®ï¼æ¹éæ°å¢ä»è¡¨/ä»ä»è¡¨\n   * @param frameId ä»è¡¨/ä»ä»è¡¨æå¨frameçid\n   * @param mapFields å¸®å©å­æ®µä¸ä»è¡¨/ä»ä»è¡¨å­æ®µæ å°\n   * @description ä»¥å¸®å©å¾éæ°æ®ä½ä¸ºä¾æ®ï¼æ¹éæ°å¢ä»è¡¨/ä»ä»è¡¨\n   */\n  public batchAppendByPathBasedOnHelpSelections(frameId: string, mapFields: string) {\n    const self: any = this;\n    const result = self.context && self.context.eventParam || [];\n    if (!mapFields) {\n      throw new Error('mapFields can`t be empty.');\n    }\n    if (result && Array.isArray(result) && result.length > 0) {\n      const mappings = JSON.parse(mapFields);\n      // ä¸æ¯bindingPathåæframeIdå¤ç\n      let bindingPath = '/';\n      const appContext = this.injector.get<AppContext>(AppContext, null);\n      if (appContext) {\n        const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n        if (frameContext) {\n          bindingPath = frameContext.viewModel.bindingPath || '/';\n        } else {\n          throw new Error('frameId is invalid!');\n        }\n      }\n      const defaultValues = [];\n      result.forEach((item) => {\n        const defaultValue = {};\n        Object.keys(mappings).forEach((prop: string) => {\n          const value = this.getValueByPath(item, prop);\n          const fields = mappings[prop];\n          const groups: any[] = fields.split(',').filter(p => p);\n          groups.forEach(group => {\n            const paths = group.split('.').filter(p => p);\n            this.setValueByPath(defaultValue, paths.join('.'), value);\n          });\n        });\n        defaultValues.push(defaultValue);\n      });\n      this.formLoadingService.show();\n      const path = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n      return this.repository.batchAppendByPath(path, defaultValues).pipe(\n        tap(() => this.formLoadingService.hide()),\n        map(() => true)\n      );\n    }\n    return of(true);\n  }\n  /**\n   * è¡åå¸®å©å¤éæ¹éæ°å¢ææ¿æ¢å­è¡¨æ°æ®\n   * @param frameId frameId, optional,ä¸ºç©ºæ¶ä½¿ç¨å½ä»¤æ§è¡æ¶æå¨çä¸ä¸æ\n   * @param mapFields å­æ®µæ å°\n   * @returns \n   */\n  public batchAppendBasedOnRowHelpSelections(frameId: string, mapFields: string) {\n    const self: any = this;\n    let result: any[] = self.context && self.context.eventParam || [];\n    if (!mapFields) {\n      return of(true);\n    }\n    const mappings = JSON.parse(mapFields);\n    if (!mappings || !mappings.hasOwnProperty('id')) {\n      return of(true);\n    }\n    frameId = frameId || this.viewModel.frameContext.frameId;\n    if (!frameId) {\n      return of(true);\n    }\n    const frameContext = this.getFrameContextById(frameId);\n    if (!frameContext) {\n      return of(true);\n    }\n    setTimeout(() => {\n      this.endEdit(frameContext).subscribe(() => {\n        if (result && Array.isArray(result) && result.length > 0) {\n          const bindingPath = frameContext.viewModel.bindingPath || '/';\n          const bindingPaths = bindingPath.split('/').filter(p => p);\n          const defaultValues = [];\n          // è·åå½åè¡\n          const bindingList: BindingList = frameContext.bindingData.getValue(bindingPaths) as BindingList;\n          const currentRow = bindingList.currentItem;\n          const currentRowId = bindingList.currentId;\n          const currentEntity = this.getEntityByPath(frameContext, bindingPaths, currentRowId);\n          const headItem = result[0];\n          // å¦æä»å¾éä¸æ¡ï¼ååºæ¿æ¢å½åè¡çæ å°\n          if (result.length === 1) {\n            this.mappingRow(headItem, mappings, currentEntity, bindingPath);\n            return of(true);\n          } else {\n            const idMapField = mappings['id'];\n            const sourceItemId = this.getValueByPath(currentEntity, idMapField);\n            // å¦æå½åè¡æ²¡ææ å°æå¾éç»æä¸­æ¾ä¸å°å½åè¡çæ å°\n            if (!sourceItemId || result.findIndex(item => item[bindingList.primaryKey] === sourceItemId) === -1) {\n              // éæ°æ å°å½åè¡\n              this.mappingRow(headItem, mappings, currentEntity, bindingPath);\n              result = result.slice(1);\n            } else if (sourceItemId) {\n              const index = result.findIndex(item => item[bindingList.primaryKey] === sourceItemId);\n              // éæ°æ å°å½åè¡\n              this.mappingRow(result[index], mappings, currentEntity, bindingPath);\n              result.splice(index, 1);\n            }\n            // å½åè¡å¤çå®æ\n            // å¤çæªæ å°çè¡\n            const emptyRows = bindingList.toArray().filter(bindingObject => {\n              const id = this.getValueByPath(bindingObject, mappings[bindingList.primaryKey]);\n              return !id;\n            });\n            if (emptyRows && emptyRows.length > 0) {\n              let rows = result;\n              if (result.length > emptyRows.length) {\n                rows = result.slice(0, emptyRows.length);\n                result = result.slice(emptyRows.length);\n              } else {\n                result = [];\n              }\n              rows.forEach((item, index) => {\n                const targetItem = emptyRows[index];\n                const entity = this.getEntityByPath(frameContext, bindingPaths, targetItem.primaryKeyValue);\n                this.mappingRow(item, mappings, entity, bindingPath);\n              });\n            }\n            // å¤çå©ä½å¾é\n            result.forEach((item) => {\n              const defaultValue = {};\n              Object.keys(mappings).forEach((prop: string) => {\n                const value = this.getValueByPath(item, prop);\n                const fields = mappings[prop];\n                const groups: any[] = fields.split(',').filter(p => p);\n                groups.forEach(group => {\n                  const paths = group.split('.').filter(p => p);\n                  this.setValueByPath(defaultValue, paths.join('.'), value);\n                });\n              });\n              defaultValues.push(defaultValue);\n            });\n            if (defaultValues.length > 0) {\n              this.formLoadingService.show();\n              const path = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n              this.repository.batchAppendByPath(path, defaultValues).pipe(\n                tap(() => this.formLoadingService.hide())\n              ).subscribe();\n            }\n          }\n        }\n      });\n    }, 100);\n    return of(true);\n  }\n  /**\n   * å¤å¶ä¸»è¡¨æ°æ®\n   * @param id è¦å¤å¶çæ°æ®id\n   * @param fields è¦å¤å¶çå­æ®µ\n   * @description ä»æ¯æå¤å¶ä¸»è¡¨æ°æ®\n   * @deprecated è¯¥æ¹æ³å·²è¢«åºå¼ï¼è¯·ä½¿ç¨cloneæ¹æ³æ¿ä»£ã\n   */\n  public copy(id: string): Observable<any> {\n    if (!id) {\n      this.formNotifyService.warning(this.languageService.plsSelectCopyData, { hideTitle: true });\n      return EMPTY;\n    }\n\n    const befRepository = this.repository as BefRepository<any>;\n    const baseUri = befRepository.restService.baseUri;\n    const url = `${baseUri}/service/copymainobjvoaction`;\n    const requestInfo = befRepository.restService.buildRequestInfo();\n    const body = {\n      requestInfo,\n      dataID: id\n    };\n    const options = {\n      body\n    };\n    this.formLoadingService.show();\n    return befRepository.proxy.request(url, 'PUT', null, options).pipe(\n      tap(() => {\n        this.formLoadingService.hide();\n      }),\n      map((responseInfo: ResponseInfo) => {\n        const returnValue = responseInfo.returnValue;\n        const entity = this.repository.buildEntity(returnValue);\n        this.repository.entityCollection.addEntity(entity);\n        return entity;\n      }),\n    );\n  }\n  /**\n   * å¤å¶æ°æ®ï¼æ¯æä¸»è¡¨ãä»è¡¨ãä»ä»è¡¨ï¼\n   * @param id è¦å¤å¶çè¡\n   * @param path è¯·æ±è·¯å¾\n   * @returns \n   */\n  public clone(id: string, path: string) {\n    if (!id) {\n      this.formNotifyService.warning(this.languageService.plsSelectCopyData, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!path) {\n      this.formNotifyService.warning(this.languageService.pathIsRequired, { hideTitle: true });\n      return EMPTY;\n    }\n    if (!path.startsWith('/')) {\n      path = '/' + path;\n    }\n    path = path.toLowerCase();\n    const bindingPath = this.viewModel.bindingPath;\n    const befRepository = this.repository as BefRepository<any>;\n    const baseUri = befRepository.restService.baseUri;\n    const url = `${baseUri}${path}`;\n    const requestInfo = befRepository.restService.buildRequestInfo();\n    const ids = this.buildIds(bindingPath);\n    ids.push(id);\n    const body = {\n      requestInfo,\n      dataID: ids.join(',')\n    };\n    const options = {\n      body\n    };\n    this.formLoadingService.show();\n    return befRepository.proxy.request(url, 'PUT', null, options).pipe(\n      tap(() => {\n        this.formLoadingService.hide();\n      }),\n      map((responseInfo: ResponseInfo) => {\n        const returnValue = responseInfo.returnValue;\n        let entity = null;\n        if (bindingPath.split('/').filter(p => p).length === 0) {\n          entity = this.repository.buildEntity(returnValue);\n          this.repository.entityCollection.addEntity(entity, true);\n        } else {\n          const fpath = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n          entity = befRepository.entityManager.appendEntityByPath(fpath, returnValue, returnValue, true);\n        }\n        return entity;\n      }),\n    );\n  }\n\n  //#region æ§çå®ç°\n\n  /**\n   * å¤å¶è¡\n   * @param frameId frameId\n   * @param ignoreFields å¤å¶æ¶å¿½ç¥å­æ®µ\n   * @param repeat éå¤å¤å¶æ¬¡æ°ï¼é»è®¤ä¸º1\n   */\n  public copyRow(frameId: string, ignoreFields: string, repeat: number = 1) {\n    if (typeof repeat !== 'number') {\n      repeat = parseInt(repeat, 10);\n    }\n    if (repeat < 1) {\n      throw new Error('ArgumentError: repeat must >= 1');\n    }\n    // è·åå½åè¡\n    const frameContext = this.viewModel.frameContext.appContext.frameContextManager.getFrameContextById(frameId);\n    const primaryValue = frameContext.bindingData.list.currentId;\n    const bindingPath = frameContext.viewModel.bindingPath || '/';\n    let bindingData = null;\n    let currentItem: BindingObject = null;\n    if (bindingPath === '/') {\n      // ä¸»è¡¨ç´æ¥åå½åè¡\n      currentItem = frameContext.bindingData.list.currentItem;\n    } else {\n      // åä»è¡¨/ä»ä»è¡¨å½åè¡\n      const paths = bindingPath.split('/').filter(p => p);\n      currentItem = (frameContext.bindingData.getValue(paths) as BindingList).currentItem;\n    }\n    bindingData = currentItem.toJSON();\n    if (!currentItem.primaryKeyValue) {\n      if (this.formNotifyService) {\n        this.formNotifyService.warning(this.languageService.plsSelectCopyData, { hideTitle: true });\n      }\n      return EMPTY;\n    }\n    const ignoreFieldsArray = ignoreFields.split(',').filter(item => item);\n\n    const sources = new Array(repeat);\n    return from(sources).pipe(\n      concatMap(() => {\n        let action$ = null;\n        if (bindingPath !== '/') {\n          const fullPath = this.buildPath(bindingPath, primaryValue);\n          action$ = this.repository.appendByPath(fullPath);\n        } else {\n          action$ = this.repository.append();\n        }\n        return action$.pipe(\n          tap((entity: Entity) => {\n            // ä¿®æ­£å®ä½ä¸»é®\n            bindingData[entity.primaryKey] = entity.primaryValue;\n            // å¿½ç¥æå®å­æ®µ\n            ignoreFieldsArray.forEach((field: string) => {\n              const extractedFields = field.split('.').filter(item => item);\n              if (extractedFields.length === 1) {\n                delete bindingData[field];\n              }\n              const parent = extractedFields.slice(0, -1).reduce((prev, current, index) => {\n                return prev[current];\n              }, bindingData);\n              delete parent[extractedFields[extractedFields.length - 1]];\n            });\n            bindingData = Object.assign({}, entity.toJSON(), bindingData);\n            entity.load(bindingData, { loadChild: false });\n          }),\n          catchError(() => {\n            return EMPTY;\n          })\n        );\n      })\n    );\n  }\n  /**\n   * å¢éå¤éå¸®å©æ¹éèµå¼å¸®å©åäºä»¶\n   * @param frameId frameId\n   * @param mapFields å­æ®µæ å°\n   * @param associatedField å³èå­æ®µ\n   */\n  public afterIncrementalSelectHelpClose(frameId: string, mapFields: string, associatedField: string) {\n    const self: any = this;\n    const result = self.context && self.context.eventParam || [];\n    // tslint:disable-next-line: max-line-length\n    // const mapping = '{\"id\":\"userRef.userRef\", \"name\":\"name\", \"sex\":\"sex\",\"age\":\"userRef.userRef_Age\",\"address\":\"userRef.userRef_Address\",\"birthday\":\"userRef.userRef_Birthday\",\"height\":\"userRef.userRef_Height\",\"isMarried\":\"userRef.userRef_IsMarried\"}';\n    if (!associatedField) {\n      throw new Error('associated field can`t be empty.');\n    }\n    if (!mapFields) {\n      throw new Error('mapFields can`t be empty.');\n    }\n    const mappings = JSON.parse(mapFields);\n    const foreignKey = associatedField;\n    // å°éæ©äººåä¿å­å°uistateä¸­\n    const rootFrameContext = this.viewModel.frameContext.root;\n    // ä¸æ¯bindingPathåæframeIdå¤ç\n    let bindingPath = '/';\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    if (appContext) {\n      const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n      if (frameContext) {\n        bindingPath = frameContext.viewModel.bindingPath || '/';\n      } else {\n        throw new Error('frameId is invalid!');\n      }\n    }\n    // tslint:disable-next-line: no-string-literal\n    rootFrameContext.uiState['selections'] = result;\n    if (result && Array.isArray(result)) {\n      // æ ¹æ®bindingPathè·åbindingdataä¸­ç°ææ°æ®\n      const bindingPaths = bindingPath.split('/').filter(item => item);\n      const currentData: BindingList = this.viewModel.bindingData.getValue(bindingPaths);\n      const currentDataArray = currentData.toArray();\n      // æ¾å°resultä¸­æï¼ä½bindingDataä¸­æ²¡æçï¼ä¸ºå¾æ°å¢é¡¹\n      const appends = [];\n      result.reduce((prev: Array<any>, item) => {\n        const itemId = item && item[currentData.primaryKey] || null;\n        const isExist = currentDataArray.find((bindingObject: BindingObject) => bindingObject[foreignKey][foreignKey] === itemId);\n        if (!isExist) {\n          prev.push(item);\n        }\n        return prev;\n      }, appends);\n\n      // æ¾å°bindingDataä¸­æï¼resultä¸­æ²¡æçï¼ä¸ºå¾å é¤é¡¹\n      const removes = [];\n      currentDataArray.reduce((results: any, item: BindingObject) => {\n        const index = result.findIndex(selectItem => selectItem[currentData.primaryKey] === item[foreignKey][foreignKey]);\n        if (index === -1) {\n          results.push(item.primaryKeyValue);\n        }\n        return results;\n      }, removes);\n\n      // console.log('addItems', appends, 'removeItems', removes);\n      // è°ç¨åç«¯æ¥å£æ°å¢æ°æ®\n      const addAction$ = from(appends).pipe(\n        concatMap(item => {\n          const path = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n          return this.repository.appendByPath(path).pipe(\n            tap((entity: Entity) => {\n              Object.keys(mappings).forEach(prop => {\n                const value = this.getValueByPath(item, prop);\n                const fields = mappings[prop];\n                const groups: any[] = fields.split(',').filter(p => p);\n                groups.forEach(group => {\n                  const paths = group.split('.').filter(p => p);\n                  this.setValueByPath(entity, paths.join('.'), value);\n                });\n              });\n            }),\n            catchError(() => {\n              return EMPTY;\n            })\n          );\n        })\n      );\n\n      const removeAction$ = from(removes).pipe(\n        concatMap(item => {\n          const path = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n          return this.repository.removeByPath(path, item).pipe(\n            tap(() => {\n              const befRepository: BefRepository<any> = this.repository as BefRepository<any>;\n              befRepository.entityManager.removeEntityByPath(path, item);\n            }),\n            catchError(() => {\n              return EMPTY;\n            })\n          );\n        })\n      );\n      if (!appends && !removes || appends && appends.length < 1 && removes && removes.length < 1) {\n        return of(true);\n      }\n      return concat(addAction$, removeAction$).pipe(\n        catchError(() => EMPTY)\n      );\n    }\n    return of(true);\n  }\n  // todo:æ¨¡æç¨æ·æä½ï¼å¾åç«¯æ¥å£æ¯æä¸»è¡¨æ¹éæ°å¢åéå\n  /**\n   * å¤éå¸®å©æ¹éèµå¼å¸®å©åäºä»¶\n   */\n  public beforeMultiSelectHelpOpen() {\n    return this.clearHelpSelections();\n  }\n  /**\n   * å¤éå¸®å©æ¹éèµå¼å¸®å©åäºä»¶\n   * @param frameId ç»å®è·¯å¾\n   * @param mapFields å­æ®µæ å°\n   * @param commandFrameId åè°å½ä»¤æå¨frameId\n   * @param commandName åè°å½ä»¤\n   * @deprecated æ¨¡æç¨æ·æä½ï¼å¾æ¹éèµå¼æ¯æä¸»è¡¨ååºå¼\n   */\n  public afterMultiSelectHelpClose(frameId: string, mapFields: string, commandFrameId?: string, commandName?: string) {\n    const self: any = this;\n    const result = self.context && self.context.eventParam || [];\n    if (result && Array.isArray(result)) {\n      // è°ç¨åç«¯æ¥å£æ°å¢æ°æ®\n      if (!result || result.length < 1) {\n        return of(true);\n      }\n      this.onHelpClose.next({ frameId, mapFields, data: result, commandFrameId, commandName });\n      return of(true);\n    }\n    return of(true);\n  }\n  /**\n    * å¸®å©å³é­åå¤çå¨\n    * @param frameId frameid\n    * @param mapFields mapFields\n    * @param result å¸®å©æ°æ®ç»æ\n    */\n  private onHelpCloseHandler(frameId: string, mapFields: string, result: any[]) {\n    if (!mapFields) {\n      throw new Error('mapFields can`t be empty.');\n    }\n    const mappings = JSON.parse(mapFields);\n    // ä¸æ¯bindingPathåæframeIdå¤ç\n    let bindingPath = '/';\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    if (appContext) {\n      const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n      if (frameContext) {\n        bindingPath = frameContext.viewModel.bindingPath || '/';\n      } else {\n        throw new Error('frameId is invalid!');\n      }\n    }\n    // å°éæ©äººåä¿å­å°uistateä¸­\n    const rootFrameContext = this.viewModel.frameContext.root;\n    const befRepository = this.repository as BefRepository<any>;\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    // tslint:disable-next-line: no-string-literal\n    rootFrameContext.uiState['selections'] = result;\n    if (result && Array.isArray(result)) {\n      const addAction$ = from(result).pipe(\n        concatMap(item => {\n          const requestInfo = befRepository.restService.buildRequestInfo();\n          if (bindingPaths.length > 0) {\n            const path = this.buildPath(bindingPath, this.viewModel.bindingData.list.currentId);\n            return befRepository.restService.createByPath(path, requestInfo).pipe(\n              tap((responseInfo: ResponseInfo) => {\n                const data = responseInfo.returnValue;\n                const newEntity = befRepository.entityManager.appendEntityByPath(path, data, data);\n                Object.keys(mappings).forEach(prop => {\n                  const value = this.getValueByPath(item, prop);\n                  const fields = mappings[prop];\n                  const groups: any[] = fields.split(',').filter(p => p);\n                  groups.forEach(group => {\n                    const paths = group.split('.').filter(p => p);\n                    this.setValueByPath(newEntity, paths.join('.'), value);\n                  });\n                });\n                return newEntity;\n              })\n            );\n          } else {\n            return befRepository.restService.create(null, requestInfo).pipe(\n              tap((responseInfo: ResponseInfo) => {\n                const data = responseInfo.returnValue;\n                const newEntity = this.repository.buildEntity(data);\n                Object.keys(mappings).forEach(prop => {\n                  const value = this.getValueByPath(item, prop);\n                  const fields = mappings[prop];\n                  const groups: any[] = fields.split(',').filter(p => p);\n                  groups.forEach(group => {\n                    const paths = group.split('.').filter(p => p);\n                    this.setValueByPath(newEntity, paths.join('.'), value);\n                  });\n                });\n                this.repository.entityCollection.addEntity(newEntity);\n                return newEntity;\n              })\n            );\n          }\n        })\n      );\n      // const formLoadingService = this.injector.get<FormLoadingService>(FormLoadingService, null);\n      if (this.formLoadingService) {\n        this.suspendFrameContextEvent(frameId);\n        this.formLoadingService.show();\n        this.formLoadingService.setSuspend(true);\n      }\n      return addAction$.pipe(\n        last(),\n      ).pipe(\n        switchMap(() => {\n          const primaryValue = this.viewModel.bindingData.list.currentId;\n          if (primaryValue) {\n            return befRepository.updateChangesById(primaryValue);\n          } else {\n            return of(null);\n          }\n        })\n      ).subscribe(() => {\n        if (this.formLoadingService) {\n          this.resumeFrameContextEvent(frameId);\n          this.formLoadingService.setSuspend(false);\n          this.formLoadingService.hide();\n        }\n      }, () => {\n        if (this.formLoadingService) {\n          this.resumeFrameContextEvent(frameId);\n          this.formLoadingService.setSuspend(false);\n          this.formLoadingService.hide();\n        }\n      });\n    }\n    return of(null);\n  }\n  private suspendFrameContextEvent(frameId: string) {\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    if (appContext) {\n      const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n      frameContext.suspend = true;\n    }\n  }\n  private resumeFrameContextEvent(frameId: string) {\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    if (appContext) {\n      const frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n      frameContext.suspend = false;\n      frameContext.appContext.messagePipe.next('bindData');\n    }\n  }\n\n  //#endregion\n  private setValueByPath(target: object, path: string, value: any) {\n    if (target) {\n      const paths = path.split('.');\n      if (paths.length <= 1) {\n        target[path] = value;\n      } else {\n        paths.slice(0, -1).reduce((prev, path) => {\n          if (!(prev.hasOwnProperty(path) || prev['__proto__'].hasOwnProperty(path))) {\n            prev[path] = {};\n          }\n          return prev[path];\n        }, target)[paths[paths.length - 1]] = value;\n      }\n    }\n  }\n  private getValueByPath(target: object, path: string) {\n    const paths = path.split('.');\n    if (paths.length < 1) {\n      return;\n    }\n    if (paths.length === 1) {\n      return target[path];\n    }\n    let result = null;\n    paths.forEach((prop, index) => {\n      if (index === 0) {\n        result = target && target[prop] || null;\n      } else {\n        result = result && result[prop] || null;\n      }\n    });\n    return result;\n  }\n  /**\n   * æé å­è¡¨è·¯å¾\n   * @param bindingPath ç»å®è·¯å¾\n   * @param id id\n   */\n  private buildPath(bindingPath: string, id: any) {\n    let path = '/' + id;\n    const subPaths = bindingPath.split('/');\n    if (subPaths.length > 0) {\n      // eg:bindingPathå½¢å¦/edus/grades,splitåæ¯['', 'edus', 'grades']\n      // å æ­¤indexä»1å¼å§\n      for (let index = 1; index < subPaths.length - 1; index++) {\n        const subPath = subPaths[index];\n        const subData = this.viewModel.bindingData[subPath];\n        if (!subData || !subData.currentId) {\n          throw Error(`è·åå­è¡¨å®æ´è·¯å¾åºéï¼æ¾ä¸å°${subData}å¯¹åºçå­è¡¨ï¼æå¯¹åºå­è¡¨æ²¡æå½åè¡ã`);\n        }\n        path += `/${subPath}/${subData.currentId}`;\n      }\n    }\n    path += '/' + subPaths[subPaths.length - 1];\n\n    return path;\n  }\n  /**\n   * è·åç»å®è·¯å¾çå½åè¡æ°ç»\n   * @param bindingPath bindingPath\n   * @returns \n   */\n  private buildIds(bindingPath: string): string[] {\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    const primaryValue = this.viewModel.bindingData.list.currentId;\n    const result = [];\n    const paths = [];\n    if (bindingPaths.length > 0) {\n      result.push(primaryValue);\n      // ä»è¡¨æä»ä»è¡¨è¦å¤å¶çè¡ä¸ä¸å®æ¯å½åè¡ï¼ç¨æ·å¯ä»¥æå®\n      bindingPaths.pop();\n      bindingPaths.forEach((path: string) => {\n        paths.push(path);\n        const bindingList = this.viewModel.bindingData.getValue(paths) as BindingList;\n        if (bindingList) {\n          result.push(bindingList.currentId);\n        }\n      });\n    }\n    return result;\n  }\n  private updateBindingData(input: any, ids: Array<any>) {\n    const { controlType = null, value = null, options = {}, dataType = null } = input || {};\n    if (controlType) {\n      // å¯¹å¸®å©åç¹æ®å¤ç\n      if (controlType === 'lookup' || controlType === 'combo-lookup') {\n        const mapFields = options.mapFields;\n        this.updateLookupField(ids, value, mapFields);\n      } else {\n        this.updateSimpleField(ids, value, input);\n      }\n    }\n  }\n  private updateSimpleField(ids: Array<any>, value: any, column: any) {\n    if (!column) {\n      return;\n    }\n    const currentColumnType = column.dataType;\n    // å­å¨è¡ç¼è¾å¨\n    let result = value;\n    if (currentColumnType === 'date') {\n      let dateStr = this.dateService.formatTo(value, 'yyyy-MM-dd');\n      if (!dateStr) {\n        dateStr = '0001-01-01T00:00:00';\n      }\n      result = dateStr;\n    } else if (currentColumnType === 'number') {\n      result = Number(value) || 0;\n    }\n    const field = column.field;\n    ids.forEach(id => {\n      this.updateBindingList(id, field, result);\n    });\n  }\n  private updateLookupField(ids: Array<any>, helpData: any, mapFields: any) {\n    if (!mapFields) {\n      return;\n    }\n    let helpFields = Object.keys(mapFields);\n    const idIndex = helpFields.findIndex(item => item === 'id');\n    if (helpFields.includes('id') && idIndex !== 0) {\n      helpFields.splice(idIndex, 1);\n      helpFields = ['id', ...helpFields];\n    }\n    helpFields.forEach((helpField: any) => {\n      let helpValue: any = '';\n      if (helpData) {\n        if (helpData instanceof Array) {\n          helpValue = helpData.map((item: any) => {\n            return this.getValue(helpField, item);\n          }).join(',');\n        } else {\n          helpValue = this.getValue(helpField, helpData);\n        }\n      }\n      ids.forEach(id => {\n        this.updateBindingList(id, mapFields[helpField], helpValue);\n      });\n    });\n  }\n  private updateBindingList(primaryValue: any, propertyName: string, value: any) {\n    const viewModel = this.viewModel || null;\n    if (!viewModel || !propertyName) {\n      return;\n    }\n    // æ´æ°ä¸»è¡¨é¨åè¡çå­æ®µ\n    const propertyNames = propertyName.split('.').filter(item => item);\n    const bindingObject = this.bindingList.findById(primaryValue);\n\n    if (propertyNames.length < 2) {\n      bindingObject.setValue(propertyName, value, true, true);\n    } else {\n      let targetBindingObject = null;\n      const fpaths = propertyNames.slice(0, propertyNames.length - 1);\n      const targetPropertyName = propertyNames[propertyNames.length - 1];\n      fpaths.forEach(prop => {\n        targetBindingObject = targetBindingObject && targetBindingObject[prop] || bindingObject[prop];\n      });\n      // todo:éè¦æ·»å å¼ååäºä»¶\n      targetBindingObject.setValue(targetPropertyName, value, true, true);\n    }\n  }\n  private getBindingPathArray(): any[] {\n    const path = this.viewModel.bindingPath;\n    if (path) {\n      return path.split('/').filter(n => n !== '');\n    }\n    return [];\n  }\n  private getValue(f: string, data: any) {\n    let val = '';\n    if (f.indexOf('.') === -1) {\n      val = data[f];\n    } else {\n      val = f.split('.').reduce((a, b) => {\n        return a[b];\n      }, data);\n    }\n\n    return val;\n  }\n  protected get bindingList(): BindingList {\n    // æ ¹å®ä½\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\n      return this.viewModel.bindingData.list;\n    }\n    // å­å®ä½\n    let bindingPath = this.viewModel.bindingPath.substr(1);\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\n    const paths = bindingPath.split('/');\n\n    const filteredPaths = paths.filter((part: string) => {\n      return part !== '';\n    });\n    return this.viewModel.bindingData.getValue(filteredPaths);\n  }\n  /**\n   * æ ¹æ®æ å°å°æ°æ®èµå¼ç»bindingData\n   * @param data \n   * @param mapFields \n   * @param bindingData \n   */\n  private mappingRow(data: any, mapFields: any, entity: Entity, bindingPath: string) {\n    Object.keys(mapFields).forEach((prop: string) => {\n      const value = this.getValueByPath(data, prop);\n      const fields = mapFields[prop];\n      const groups: any[] = fields.split(',').filter(p => p);\n      groups.forEach(group => {\n        const paths = group.split('.').filter(p => p);\n        this.setValueByPath(entity, paths.join('.'), value);\n      });\n    });\n  }\n  /**\n   * éè¿frameIdè·åå¯¹åºçç»ä»¶ä¸ä¸æ\n   * @param frameId frameId\n   * @returns \n   */\n  private getFrameContextById(frameId: string): FrameContext | null {\n    if (!frameId) {\n      return null;\n    }\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    let frameContext: FrameContext = null;\n    if (appContext) {\n      frameContext = appContext.frameContextManager.getFrameContextById(frameId);\n    }\n    return frameContext;\n  }\n  private getEntityByPath(frameContext: FrameContext, bindingPaths: any[], currentId: string) {\n    bindingPaths = [...bindingPaths];\n    const id = frameContext.bindingData.list.currentId;\n    const entity: Entity = frameContext.repository.entityCollection.getEntityById(id) as Entity;\n    let item: Entity = entity;\n    const paths = [];\n    const tailPath = bindingPaths.pop();\n    const parent = bindingPaths.reduce((object: Entity, path: string) => {\n      paths.push(path);\n      if (object && (object.hasOwnProperty(path) || object['__proto__'].hasOwnProperty(path))) {\n        const value = object[path];\n        if (value && value instanceof EntityList) {\n          const bindingList = frameContext.bindingData.getValue(paths) as BindingList;\n          const currentItemId = bindingList.currentId;\n          return value.get(currentItemId);\n        } else {\n          return value;\n        }\n      } else {\n        return null;\n      }\n    }, item);\n    if (parent instanceof Entity) {\n      const list = parent[tailPath] as EntityList<any>;\n      if (list) {\n        return list.get(currentId);\n      } else {\n        throw new Error(`æ æçbindingPath.`);\n      }\n    } else {\n      throw new Error(`æ æçbindingPath.`);\n    }\n  }\n  private endEdit(frameContext: FrameContext) {\n    const appContext: AppContext = frameContext && frameContext.getFormAppContext();\n    return of(null).pipe(\n      tap(() => {\n        if (appContext) {\n          appContext.messagePipe.next({ type: 'endEdit' });\n        }\n      }),\n      // todo: ä¸åºè¯¥ä½¿ç¨delayï¼åºè¯¥ä¸²æµ\n      delay(5)\n    );\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { FrameContext, Entity } from '@farris/devkit';\nimport { BefRepository } from '@farris/bef';\nimport { FormLoadingService } from './form-loading/form-loading.service';\nimport { RuntimeFrameworkService } from './rtf-service';\nimport { tap } from 'rxjs/operators';\nimport { Observable, of, EMPTY } from 'rxjs';\n// tslint:disable: max-line-length\n@Injectable()\nexport class DiscussionGroupService {\n  /**\n   * å®ä½ä»åº\n   */\n  private get repository(): BefRepository<Entity> {\n    return this.frameContext.repository as BefRepository<Entity>;\n  }\n  /**\n   * å½ä»¤åæ°\n   */\n  private get params() {\n    return this['context'] && this['context']['eventParam'] || {};\n  }\n  constructor(private injector: Injector, private frameContext: FrameContext, private loadingService: FormLoadingService, private runtimeFrameworkService: RuntimeFrameworkService) {\n  }\n\n  public addComment(id?: string, summary?: string, configId?: string, text?: string, visibility?: string, parentId?: string): Observable<any> {\n    id = id || this.frameContext && this.frameContext.bindingData.list.currentId || null;\n    if (!id) {\n      return EMPTY;\n    }\n    const params = this.buildAddCommentParam(id, text, parentId, summary, visibility, configId);\n    const restService = this.repository.restService;\n    const url = '/api/runtime/comment/v1.0/bill-comment/comment';\n    const requestInfo = restService.buildRequestInfo();\n    const options = {\n      body: {\n        requestInfo,\n        ...params\n      }\n    };\n    this.loadingService.show();\n    return restService.invoke(url, 'POST', null, options).pipe(\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ¥è¯¢è¯è®º\n   * @param id id\n   */\n  public queryComments(id: string, configId: string, pageIndex?: number | null, pageSize?: number | null): Observable<any> {\n    id = id || this.frameContext && this.frameContext.bindingData.list.currentId || null;\n    if (!id) {\n      return EMPTY;\n    }\n\n    const restService = this.repository.restService;\n\n    const url = this.buildQueryCommentsUrl(id, pageIndex, pageSize, configId);\n    this.loadingService.show();\n    return restService.invoke(url, 'GET').pipe(\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ¥è¯¢ææé¨é¨ä¿¡æ¯\n   */\n  public queryAllOrgs() {\n    const restService = this.repository.restService;\n    const url = '/api/runtime/sys/v1.0/sysOrgs?param={\"layer\":\"1\"}';\n    this.loadingService.show();\n    return restService.invoke(url, 'GET').pipe(\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æ¥è¯¢å¸¸ç¨@ç¨æ· \n   * @param pageIndex \n   * @param pageSize \n   */\n  public queryFrequentAtUsers(pageIndex?: number | null, pageSize?: number | null) {\n    const restService = this.repository.restService;\n    const url = this.buildQueryFrequentAtUsersUrl(pageIndex, pageSize);\n    this.loadingService.show();\n    return restService.invoke(url, 'GET').pipe(\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * è·åatç¨æ·åè¡¨\n   * @param user ç¨æ·ç¼å·æèç¨æ·åç§°ï¼è¿æ»¤ä½¿ç¨ï¼\n   * @param pageIndex pageIndex\n   * @param pageSize pageSize\n   */\n  public queryAtUsers(user?: string, pageIndex?: number | null, pageSize?: number | null) {\n    const restService = this.repository.restService;\n    const url = this.buildQueryAtUsersUrl(user, pageIndex, pageSize);\n    this.loadingService.show();\n    return restService.invoke(url, 'GET').pipe(\n      tap(() => {\n        this.loadingService.hide();\n      })\n    );\n  }\n  /**\n   * æé è·åè¯è®ºåè¡¨çurl\n   * @param id id\n   */\n  private buildQueryCommentsUrl(id: string, pageIndex: number | null, pageSize: number | null, configId: string) {\n    if (typeof pageIndex === 'undefined' || pageIndex === null) {\n      pageIndex = this.params.pageIndex || 0;\n    }\n    if (typeof pageSize === 'undefined' || pageSize === null) {\n      pageSize = this.params.pageSize || 10;\n    }\n    const serverUri = this.repository.serverUri;\n    // const funcId = this.runtimeFrameworkService && this.runtimeFrameworkService.funcId || '';\n    return `/api/runtime/comment/v1.0/bill-comment/comment/byBill?configId=${configId}&billId=${id}&pageSize=${pageSize}&pageIndex=${pageIndex}`;\n  }\n  /**\n   * æé è·å@ç¨æ·url\n   */\n  private buildQueryAtUsersUrl(user?: string, pageIndex?: number | null, pageSize?: number | null) {\n    const params: string[] = [];\n    if (typeof pageIndex === 'undefined' || pageIndex === null) {\n      pageIndex = this.params.pageIndex || 0;\n    }\n    if (typeof pageSize === 'undefined' || pageSize === null) {\n      pageSize = this.params.pageSize || 1000;\n    }\n    if (user) {\n      params.push(`param=${user}`);\n    }\n    params.push(`pageSize=${pageSize}`);\n    params.push(`pageIndex=${pageIndex}`);\n    return `/api/runtime/comment/v1.0/bill-comment/atUser?${params.join('&')}`;\n  }\n  private buildQueryFrequentAtUsersUrl(pageIndex?: number | null, pageSize?: number | null) {\n    const params: string[] = [];\n    if (typeof pageIndex === 'undefined' || pageIndex === null) {\n      pageIndex = this.params.pageIndex || 0;\n    }\n    if (typeof pageSize === 'undefined' || pageSize === null) {\n      pageSize = this.params.pageSize || 6;\n    }\n    params.push(`pageSize=${pageSize}`);\n    params.push(`pageIndex=${pageIndex}`);\n    return `/api/runtime/comment/v1.0/bill-comment/frequentAtUsers?${params.join('&')}`;\n  }\n  private buildAddCommentParam(id: string, text: string, parentId: string, summary: string, visibility: string, configId: string) {\n    if (typeof text === 'undefined') {\n      text = this.params.text;\n    }\n    if (typeof parentId === 'undefined') {\n      parentId = this.params.parentId;\n    }\n    if (typeof visibility === 'undefined') {\n      visibility = this.params.visibility;\n    }\n    return {\n      'bill': {\n        'billId': id,\n        'configId': configId,\n        'summary': summary\n      },\n      'comment': {\n        'billId': id,\n        'configId': configId,\n        'parentId': parentId || null,\n        'text': text,\n        'visibility': visibility\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { FrameContext } from '@farris/devkit';\nimport { ListFilterHandler, QueryCondition } from '@farris/ui-list-filter';\n\n@Injectable()\nexport class ListFilterConditionsService implements ListFilterHandler {\n\n    constructor(private frameContext: FrameContext) { }\n\n    public setCurrentFilterConditions(conditions: QueryCondition[]): void {\n        this.frameContext.uiState['currentFilterConditions'] = conditions;\n    }\n\n}\n","import { HttpClient } from \"@angular/common/http\";\nimport { Inject, Injectable, Injector } from \"@angular/core\";\nimport { Observable } from \"rxjs\";\nimport { FORM_PATH_TOKEN, FormManifest, IFormManifestService } from \"@farris/devkit\";\nimport { share } from \"rxjs/operators\";\n\n@Injectable()\nexport class FormManifestService implements IFormManifestService {\n  private static mainfests = new Map<string, Observable<FormManifest>>();\n  constructor(\n    private injector: Injector,\n    @Inject(FORM_PATH_TOKEN) private modulePath,\n    private httpClient: HttpClient\n  ) { }\n  public load(): Observable<FormManifest> {\n    if (this.modulePath.endsWith('\\/')) {\n      this.modulePath = this.modulePath.substring(0, this.modulePath.length - 1);\n    }\n    const formManifestPath = `${this.modulePath}/expressions/form.manifest.json?version=${new Date().valueOf().toString()}`;\n    const request$ = FormManifestService.mainfests.get(this.modulePath);\n    if (request$) {\n      return request$;\n    } else {\n      const req$ = this.httpClient.get<FormManifest>(formManifestPath, { responseType: 'json' }).pipe(share());\n      FormManifestService.mainfests.set(this.modulePath, req$);\n      return req$;\n    }\n  }\n}\n","import { HttpClient } from \"@angular/common/http\";\nimport { Inject, Injectable, Injector } from \"@angular/core\";\nimport { Observable, of } from \"rxjs\";\nimport { share, switchMap } from \"rxjs/operators\";\nimport { FORM_PATH_TOKEN, FrameContext, FormExpressionsManifest, FormManifest, IFormExpressionManifestService, FORM_MANIFEST_SERVICE_TOKEN, IFormManifestService } from \"@farris/devkit\";\n\n@Injectable()\nexport class FormExpressionManifestService implements IFormExpressionManifestService {\n  private static mainfests = new Map<string, Observable<any>>();\n  constructor(\n    private injector: Injector,\n    private frameContext: FrameContext,\n    private httpClient: HttpClient,\n    @Inject(FORM_PATH_TOKEN) private modulePath,\n    @Inject(FORM_MANIFEST_SERVICE_TOKEN) private formManifestService: IFormManifestService) { }\n\n  public load(): Observable<any> {\n    if (this.modulePath.endsWith('\\/')) {\n      this.modulePath = this.modulePath.substring(0, this.modulePath.length - 1);\n    }\n\n    return this.formManifestService.load().pipe(\n      switchMap((formManifest: FormManifest) => {\n        const expressions = formManifest.expressions;\n        const expressionManifest = expressions.find((expressionManifest: FormExpressionsManifest) => expressionManifest.ns === this.frameContext.namespace);\n        if (expressionManifest) {\n          const expressionPath = `${this.modulePath}/expressions/${expressionManifest.path}?version=${new Date().valueOf().toString()}`;\n          const key = `${this.modulePath}/expressions/${expressionManifest.path}`;\n          const request$ = FormExpressionManifestService.mainfests.get(key);\n          if (request$) {\n            return request$;\n          } else {\n            const req$ = this.httpClient.get(expressionPath, { responseType: 'json' }).pipe(share());\n            FormExpressionManifestService.mainfests.set(key, req$);\n            return req$;\n          }\n        } else {\n          return of({});\n        }\n      })\n    );\n  }\n}","import { Inject, Injectable, Injector } from \"@angular/core\";\nimport { BigNumber } from 'bignumber.js';\nimport moment from 'moment';\nimport { NumberFormat, UserSettings, UserSettingsToken } from \"@farris/devkit\";\n\n@Injectable()\nexport class LocalizationService {\n  constructor(private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings) { }\n\n  /**\n   * ç¨æ·éç½®æ ¼å¼\n   */\n  public get formats(): { date: { dateFormat: string, timeFormat: string, dateTimeFormat: string }, number: { negativeSign: string, numberDecimalDigits: number, numberDecimalSeparator: string, numberGroupSeparator: string }, [prop: string]: any } {\n    const { dateFormat = null, timeFormat = null } = this.userSettings || {};\n    let dateTimeFormat = null;\n    if (dateFormat && timeFormat) {\n      dateTimeFormat = `${dateFormat} ${timeFormat}`;\n    }\n    const date = {\n      dateFormat,\n      timeFormat,\n      dateTimeFormat\n    };\n    const { negativeSign = null, numberDecimalDigits = null, numberDecimalSeparator = null, numberGroupSeparator = null } = this.numberFormat || {};\n    const number = {\n      negativeSign,\n      numberDecimalDigits,\n      numberDecimalSeparator,\n      numberGroupSeparator\n    };\n    return { date, number };\n  }\n  /**\n   * æ ¹æ®æ°æ®ç±»åæ¬å°åæ°æ®\n   * @param value value\n   * @param dataType æ°æ®ç±»å\n   * @returns string\n   */\n  public localize(value: any, dataType: string): string {\n    if (dataType && value) {\n      dataType = dataType.toLowerCase();\n      if (dataType === 'date') {\n        return this.transformDate(value);\n      } else if (dataType === 'datetime') {\n        return this.transformDateTime(value);\n      } else if (dataType === 'number') {\n        return this.transformNumber(value);\n      } else {\n        return value;\n      }\n    } else {\n      return value;\n    }\n  }\n  /**\n   * æ ¹æ®å½éåç±»åè·åæ ¼å¼åå­ç¬¦ä¸²\n   * @param localizationType å½éåç±»å\n   * @returns \n   */\n  public getFormat(localizationType: string): string {\n    if (localizationType) {\n      localizationType = localizationType.toLowerCase();\n    }\n    if (localizationType === 'date') {\n      return this.formats.date.dateFormat;\n    } else if (localizationType === 'datetime') {\n      return this.formats.date.dateTimeFormat;\n    } else {\n      return '';\n    }\n  }\n  /**\n   * è½¬æ¢æ¥æ\n   * @param value value\n   */\n  private transformDate(value: any) {\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || 'YYYY-MM-DD';\n    if (!dateFormat || !value) {\n      return value;\n    }\n    const date = moment(value);\n    const isValid = date.isValid();\n    if (!isValid) {\n      return value;\n    }\n    dateFormat = this.parseDateFormat(dateFormat);\n    return date.format(dateFormat);\n  }\n  /**\n   * è½¬æ¢æ¥ææ¶é´\n   * @param value value\n   * todo: ç®åæ æ³å®ä¹æ¥ææ¶é´æ ¼å¼\n   */\n  private transformDateTime(value: any) {\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || 'YYYY-MM-DD';\n    let timeFormat = this.userSettings && this.userSettings.timeFormat || 'HH:mm:ss';\n    if (!dateFormat || !timeFormat) {\n      return value;\n    }\n    const dateTime = moment(value);\n    const isValid = dateTime.isValid();\n    if (!isValid) {\n      return value;\n    }\n    if (dateFormat) {\n      dateFormat = this.parseDateFormat(dateFormat);\n    }\n    if (timeFormat) {\n      timeFormat = this.parseTimeFormat(timeFormat);\n    }\n    const dateTimeFormat = dateFormat + ' ' + timeFormat;\n    return dateTime.format(dateTimeFormat);\n  }\n  /**\n   * è½¬æ¢æ°å­\n   * @param value value\n   */\n  private transformNumber(value): string {\n    if (value === null || value === undefined || value === '') {\n      return '';\n    }\n    const bigNumber = new BigNumber(value);\n    // å¦æä¸æ¯æ°å­ï¼ä¸åä»»ä½å¤ç\n    if (!BigNumber.isBigNumber(bigNumber)) {\n      return value;\n    }\n    const isNegative = bigNumber.isNegative();\n    const format = this.buildNumberFormat();\n    const { negativeSign = null, numberDecimalDigits = null } = this.numberFormat || {};\n    if (isNegative) {\n      if (negativeSign !== null) {\n        format.prefix = negativeSign;\n        return bigNumber.absoluteValue().toFormat(numberDecimalDigits, null, format);\n      }\n    }\n    return bigNumber.toFormat(numberDecimalDigits, null, format);\n  }\n  /**\n   * è½¬æ¢æ¥ææ ¼å¼è§åä¸ºmomentçformatè§å\n   * @param format format\n   */\n  private parseDateFormat(format: string) {\n    return format.replace(/y/g, 'Y').replace(/d/g, 'D');\n  }\n  /**\n   * è½¬æ¢æ¶é´æ ¼å¼è§åä¸ºmomentçformatè§å\n   * @param format format\n   */\n  private parseTimeFormat(format: string) {\n    return format.replace(/M/g, 'm');\n  }\n  /**\n   * æé bignumberæ°å­æ ¼å¼åéé¡¹\n   */\n  private buildNumberFormat() {\n    if (this.numberFormat) {\n      const { numberDecimalSeparator = null, numberGroupSeparator = null } = this.numberFormat;\n      const format: any = {\n        groupSize: 3,\n      };\n      if (numberDecimalSeparator !== null) {\n        format.decimalSeparator = numberDecimalSeparator;\n      }\n      if (numberGroupSeparator !== null) {\n        format.groupSeparator = numberGroupSeparator;\n      }\n      return format;\n    }\n  }\n  private get numberFormat(): NumberFormat {\n    return this.userSettings && this.userSettings.numberFormat || null;\n  }\n}","import { CommandContext } from \"@farris/devkit\";\n\nexport abstract class Service {\n  public context: CommandContext;\n  /**\n   * å½ä»¤åæ°\n   */\n  public get eventParam(){\n    return this.context && this.context.eventParam || null;\n  }\n}","import { Injectable } from \"@angular/core\";\nimport { Service } from \"./service\";\nimport { DatagridComponent } from '@farris/ui-datagrid';\nimport { QueryCondition } from '@farris/component-querycondition';\nimport { CommandContext, FrameContext } from \"@farris/devkit\";\n@Injectable()\nexport class DataGridService extends Service {\n  /**\n   * æ¸ç©ºææå¾éè¡\n   * @description åæ¶å¾éå½åè¡¨åææå¾éè¡\n   */\n  public clearChecks() {\n    // const params = this.eventParam;\n    // if (params && Array.isArray(params)) {\n    // const param = params[0];\n    // if (param instanceof QueryCondition) {\n    const gridComponents = this.getFormGridComponents(this.context);\n    if (gridComponents && gridComponents.length > 0) {\n      gridComponents.forEach((gridComponent: DatagridComponent) => {\n        let clearSelections = true;\n        if (gridComponent.hasOwnProperty('clearSelectionsWhenDataIsEmpty')) {\n          clearSelections = gridComponent['clearSelectionsWhenDataIsEmpty'];\n        }\n        if (clearSelections) {\n          gridComponent.clearCheckeds(true);\n        }\n      });\n    }\n    // }\n    // }\n  }\n  /**\n   * åæ¶å¾éå é¤çè¡\n   * @param ids ids\n   * @returns \n   * @description åæ¶å¾éå½åç»å®è·¯å¾ä¸æå®æ°æ®ï¼æ¸ç©ºä¸çº§è¡¨æ ¼ä¸­ææå¾éè¡ï¼ä»ä¾å é¤åºæ¯ä½¿ç¨\n   */\n  public uncheckDeletedRows(ids: any) {\n    if (typeof ids === 'string') {\n      if (ids.indexOf(',') !== -1) {\n        ids = ids.split(',').filter(p => p);\n      } else {\n        ids = [ids];\n      }\n    }\n    if (!ids || ids.length < 1) {\n      return;\n    }\n    // è·åbindingPathåns\n    const frameContext = this.context.frameContext;\n    if (!frameContext) {\n      return;\n    }\n    const appContext = frameContext.appContext;\n    const ns = frameContext.namespace;\n    const bindingPath = frameContext.viewModel && frameContext.viewModel.bindingPath;\n    if (!appContext) {\n      return;\n    }\n    // æ ¹æ®bindingPathè·åææå¯è½çframeContext\n    const frameContexts = appContext.frameContextManager.getFrameContextsByNamespace(ns);\n    const frameContextsInCurrentBindingPath = frameContexts.filter(frameContext => frameContext && frameContext.viewModel && frameContext.viewModel.bindingPath === bindingPath);\n    // è·åè¿äºframeä¸­ææçè¡¨æ ¼ç»ä»¶map\n    const gridInCurrentFrame = this.getGridComponentByFrameContexts(frameContextsInCurrentBindingPath);\n    if (!gridInCurrentFrame) {\n      return;\n    }\n    // ä¸ä¸ªbindingPathä¸åºè¯¥åªæä¸ä¸ªgrid\n    const grid: DatagridComponent = gridInCurrentFrame.pop();\n    // æ¸ç©ºå½ä»¤æå¨çframeä¸è¡¨æ ¼çæå®å¾é\n    if(grid){\n      grid.unCheckRows(ids, true);\n    }\n    // æ¸ç©ºä¸çº§è¡¨æ ¼çææå¾éè¡æ°æ®\n    const childrenFrameContexts = frameContexts.filter(frameContext => frameContext.viewModel.bindingPath !== bindingPath && frameContext.viewModel.bindingPath.startsWith(bindingPath));\n    const childrenGridComponents = this.getGridComponentByFrameContexts(childrenFrameContexts);\n    // æ¸ç©ºå½ä»¤æå¨frame\n    if (childrenGridComponents && childrenGridComponents.length > 0) {\n      childrenGridComponents.forEach((gridComponent: DatagridComponent) => {\n        // æ¸ç©ºææå¾é\n        gridComponent.checkedRows = [];\n      });\n    }\n  }\n  /**\n   * åæ¶å¾éè¡\n   * @param ids ids\n   * @returns \n   */\n  public uncheckRows(ids: any) {\n    if (typeof ids === 'string') {\n      ids = [ids];\n    }\n    if (!ids || ids.length < 1) {\n      return;\n    }\n    const gridComponents = this.getFormGridComponents(this.context);\n    if (gridComponents && gridComponents.length > 0) {\n      gridComponents.forEach((gridComponent: DatagridComponent) => {\n        gridComponent.unCheckRows(ids, true);\n      });\n    }\n  }\n  /**\n   * æ ¹æ®å½ä»¤ä¸ä¸æè·åå½åå½ä»¤æå¨ç»ä»¶çè¡¨æ ¼å®ä¾\n   * @param commandContext å½ä»¤ä¸ä¸æ\n   * @returns \n   */\n  private getFormGridComponents(commandContext: CommandContext) {\n    let grids = [];\n    const frameContext = commandContext && commandContext.frameContext;\n    const appContext = frameContext && frameContext.appContext || null;\n    if (appContext) {\n      const componentRefs: Map<string, Map<string, any>> = appContext.componentRefs;\n      const collect = Array.from(componentRefs.values());// [Map<string,any>,Map<string,any>]\n      collect.forEach((item: Map<string, any>) => {\n        const components = Array.from(item.values());\n        const bindingPath = frameContext\n        const gridComponents = components.filter((component: any) => component instanceof DatagridComponent);\n        grids = grids.concat(gridComponents);\n      });\n    }\n    return grids;\n  }\n  private getGridComponentByFrameContexts(frameContexts: FrameContext[]) {\n    return frameContexts.reduce((result, frameContext) => {\n      const appContext = frameContext.appContext;\n      const frameId = frameContext.frameId;\n      // è·åå½åç»ä»¶ä¸ææçç»ä»¶å®ä¾\n      const componentsRef = appContext.componentRefs.get(frameId);\n      const grids = componentsRef && Array.from(componentsRef.values()).filter(component => component instanceof DatagridComponent);\n      if (grids && grids.length > 0) {\n        result = result.concat(grids);\n      }\n      return result;\n    }, []);\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { FrameContext } from \"@farris/devkit\";\nimport { EMPTY } from \"rxjs\";\nimport { AttentionService, AttentionElement } from '@farris/ui-tooltip';\n\n\n@Injectable()\nexport class FormAttentionService {\n  constructor(private injector: Injector, private frameContext: FrameContext, private attentionService: AttentionService) { }\n  /**\n   * éªçæé®\n   * @param ids idå­ç¬¦ä¸²ææ°ç»\n   * @param duration æ¶é´é´é\n   * @returns \n   */\n  public blink(ids: string | string[], duration?: any) {\n    if (typeof ids === 'string') {\n      ids = ids.split(',').filter(p => p);\n    }\n    if (!Array.isArray(ids) || ids.length < 1) {\n      return EMPTY;\n    }\n    if (typeof duration === 'string') {\n      duration = duration.trim();\n    }\n    if (!duration) {\n      duration = 600;\n    }\n    duration = parseInt(duration);\n    if (isNaN(duration) || duration <= 0) {\n      duration = 600;\n    }\n    const elements: AttentionElement[] = ids.map((item: string) => {\n      return {\n        idOrEl: item,\n        // type:'',\n        // class:''\n      };\n    });\n    this.attentionService.catchAttention(elements, duration);\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { BefRepository, ResponseInfo } from \"@farris/bef\";\nimport { Repository } from '@farris/devkit';\nimport { Observable } from \"rxjs\";\nimport { map } from \"rxjs/operators\";\nimport { Prop } from \"./types\";\n\n@Injectable()\nexport class FeatureRepository {\n  constructor(\n    private injector: Injector,\n    private repository: Repository<any>,\n  ) { }\n  /**\n   * æ ¹æ®ç©æidè·åç©æç¹å¾é¡¹åç¹å¾å¼ï¼å¬å±é»è®¤å¼ï¼\n   * @param materialId ç©æid\n   */\n  public getFeaturesByMaterialId(materialId: string): Observable<ResponseInfo> {\n    const url = '/api/scm/scmfnd/v1.0/scmcommoncmpservice/service/getmaterialprops';\n    const body = {\n      materialID: materialId\n    };\n    const options = {\n      body\n    };\n    const befRepository: BefRepository<any> = this.repository as BefRepository<any>;\n    return befRepository.proxy.request(url, 'put', null, options);\n  }\n  /**\n   * æ ¹æ®ç©æidåç©æç¹å¾ä¿å­åçhashè·åè¯¥ç©æå·²ç»å­å¨çç¹å¾é¡¹å¼\n   * @param materialId ç©æId\n   * @param configID å¯¹åºè¯¥ç©æçç¹å¾é¡¹hash\n   * @returns \n   */\n  public getConfigedValueByFeatureId(materialId: string, configID: string, configType: string = 'Materials'): Observable<ResponseInfo> {\n    const url = '/api/bf/df/v1.0/charactconfigservice/service/getcharactconfiginfo';\n    const body = { objType: configType, objID: materialId, configID };\n    const befRepository: BefRepository<any> = this.repository as BefRepository<any>;\n    const options = {\n      body\n    };\n    return befRepository.proxy.request(url, 'put', null, options);\n  }\n  /**\n   * ä¿å­ç©æç¹å¾é¡¹\n   * @param materialId ç©æid\n   * @param charactValue ç¹å¾å¼\n   * @param configType éç½®ç±»å\n   * @returns \n   */\n  public applyFeatures(materialId: string, charactValue: any, configType: string = 'Materials') {\n    const body = { objType: configType, objID: materialId, charactValue };\n    const befRepository: BefRepository<any> = this.repository as BefRepository<any>;\n    const options = {\n      body\n    };\n    return befRepository.proxy.request('/api/bf/df/v1.0/charactconfigservice/service/matchcharactconfigid', 'put', null, options);\n  }\n  /**\n   * è·åå¸®å©ä¿¡æ¯\n   * @param helpid å¸®å©id\n   * @param filter è¿æ»¤æ¡ä»¶\n   * @param params åæ°\n   * @returns \n   */\n  public getHelpInfo(helpid: string, filter: string, params: any): Observable<any> {\n    const url = '/api/scm/scmfnd/v1.0/scmcommoncmpservice/service/gethelpdata';\n    const httpParams: any = {};\n    if (params) {\n      if (params.pageIndex) {\n        httpParams['pageIndex'] = JSON.stringify(params.pageIndex - 0);\n      }\n      if (params.pageSize) {\n        httpParams['pageSize'] = JSON.stringify(params.pageSize - 0);\n      }\n      if (params.condition) {\n        httpParams['condition'] = JSON.stringify(params.condition);\n      }\n      if (params.searchValue) {\n        httpParams['search'] = params.searchValue;\n      }\n    }\n    const body = {\n      helpID: helpid,\n      queryParam: JSON.stringify(httpParams),\n      filterStr: filter\n    };\n    const befRepository: BefRepository<any> = this.repository as BefRepository<any>;\n    const options = {\n      body\n    };\n    return befRepository.proxy.request(url, 'put', null, options);\n  }\n}","export namespace Prop {\n  /**\n   * ç¹å¾é\n   */\n  export interface IPropSet {\n    id: string;\n    /**\n     * ç¹å¾éç¼å·\n     */\n    code: string;\n    /**\n     * å¨æå­æ®µï¼è¿åå¼ä¸­ä¸å­å¨ï¼ç¨äºå±ç¤ºå½åè¯­è¨çææ¬\n     */\n    name?: string;\n    /**\n     * ç¹å¾éåç§°-è±æ\n     */\n    name_en: string;\n    /**\n     * ç¹å¾éåç§°-ç®ä½\n     */\n    name_chs: string;\n    /**\n     * ç¹å¾éåç§°-ç¹ä½\n     */\n    name_cht: string;\n  }\n  /**\n   * ç¹å¾é¡¹\n   */\n  export interface IProp {\n    /**\n     * ç¹å¾é¡¹id\n     */\n    id: string;\n    /**\n     * ç¹å¾é¡¹ç¼å·\n     */\n    code: string;\n    /**\n     * ç¼å·å­æ®µï¼æä¸ä½¿ç¨ï¼\n     */\n    codefield: string;\n    /**\n     * å¨æå­æ®µ\n     */\n    name?: string;\n    /**\n     * ç¹å¾é¡¹åç§°-è±æ\n     */\n    name_en: string;\n    /**\n     * ç¹å¾é¡¹ç¼å·-ç®ä½\n     */\n    name_chs: string;\n    /**\n     * ç¹å¾é¡¹ç¼å·-ç¹ä½\n     */\n    name_cht: string;\n    /**\n     * ç¹å¾å¼\n     */\n    value: any;\n    /**\n     * å¼å­æ®µ\n     */\n    valuefield: string;\n    /**\n     * ç¹å¾é¡¹å¯¹åºçè¾å¥æ§ä»¶ç±»å\n     */\n    inputtype: string;\n    /**\n     * æ°å­ç²¾åº¦\n     */\n    digitalaccuracy: number;\n    /**\n     * ç¹å¾éid\n     */\n    setid: string;\n    helpid: string;\n    /**\n     * æä¸¾æ°æ®æº\n     * @attention æ¥å£è¿åç»æä¸ºå­ç¬¦ä¸²\n     */\n    enuminfo: string;\n    /**\n     * æä¸¾æ°æ®æº\n     */\n    data: IEnumInfo[];\n    /**\n     * æ åä»£ç éæ¯å¦ä¸ºæ \n     */\n    setistree: string;\n    /**\n     * æ åä»£ç éid\n     */\n    codesetid: string;\n    /**\n     * ææ¬å­æ®µ\n     */\n    textfield: string;\n    /**\n     * è¿æ»¤æ¡ä»¶\n     */\n    filtercondition: any;\n    /**\n     * å¿å¡«\n     */\n    isrequired: string | boolean;\n    /**\n     * åªè¯»\n     */\n    isreadonly: string | boolean;\n    /**\n     * æåº\n     */\n    sortorder: number;\n\n    timestamp_createdon: string;\n    timestamp_lastchangedon: string;\n\n    timestamp_createdby: string;\n    timestamp_lastchangedby: string;\n\n  }\n  /**\n   * æä¸¾æ°æ®æºæ ¼å¼\n   */\n  export interface IEnumInfo {\n    id: string;\n    text: string;\n  }\n  export interface IReturnValue {\n    propset: IPropSet[],\n    props: IProp[]\n  }\n  export enum InputType {\n    enum = 'Enum',\n    string = 'String',\n    help = 'Help',\n    number = 'Number',\n    date = 'Date'\n  }\n}\n","import { Inject, Injectable, Injector, LOCALE_ID, Optional } from \"@angular/core\";\nimport { BefRepository, ResponseInfo } from \"@farris/bef\";\nimport { FrameContext, RestfulService, Repository } from '@farris/devkit';\nimport { Observable } from \"rxjs\";\nimport { map } from \"rxjs/operators\";\nimport { FeatureRepository } from \"./feature-repository\";\nimport { Prop } from \"./types\";\n\n@Injectable()\nexport class FeatureDataService {\n  constructor(\n    private injector: Injector,\n    private repository: FeatureRepository,\n    @Optional() @Inject(LOCALE_ID) private localeId?: string\n  ) {\n    this.localeId = this.localeId || 'zh-CHS';\n  }\n  /**\n   * æ ¹æ®ç©æidè·åç©æç¹å¾é¡¹åç¹å¾å¼ï¼å¬å±é»è®¤å¼ï¼\n   * @param materialId ç©æid\n   */\n  public getFeaturesByMaterialId(materialId: string): Observable<Prop.IReturnValue> {\n    return this.repository.getFeaturesByMaterialId(materialId).pipe(\n      map((response: ResponseInfo) => {\n        if (!response || !response.returnValue) {\n          return null;\n        }\n        const returnValue = JSON.parse(response.returnValue);\n        const result: Prop.IReturnValue = { propset: [], props: [] };\n        const propsets = returnValue.propset || null;\n        const props = returnValue.props || null;\n        if (propsets && Array.isArray(propsets)) {\n          propsets.map((propset: Prop.IPropSet) => {\n            propset.name = this.translateName(propset);\n            return propset;\n          });\n          result.propset = propsets;\n        }\n        if (props && Array.isArray(props) && props.length > 0) {\n          props.map((prop: Prop.IProp) => {\n            // å¤çå¤è¯­\n            prop.name = this.translateName(prop);\n            // å¤çæä¸¾\n            if (prop.inputtype === Prop.InputType.enum && prop.enuminfo) {\n              prop.data = JSON.parse(prop.enuminfo);\n            }\n            // å¤çå¿å¡«ååªè¯»\n            prop.isreadonly = prop.isreadonly === '1' ? true : false;\n            prop.isrequired = prop.isrequired === '1' ? true : false;\n            return prop;\n          });\n          result.props = props;\n        }\n        return result;\n      })\n    );\n  }\n  /**\n   * æ ¹æ®ç©æidåç©æç¹å¾ä¿å­åçhashè·åè¯¥ç©æå·²ç»å­å¨çç¹å¾é¡¹å¼\n   * @param materialId ç©æId\n   * @param configID å¯¹åºè¯¥ç©æçç¹å¾é¡¹hash\n   * @returns \n   */\n  public getConfigedValueByFeatureId(materialId: string, configID: string, configType: string = 'Materials'): Observable<any> {\n    return this.repository.getConfigedValueByFeatureId(materialId, configID, configType).pipe(map((result: any) => {\n      return JSON.parse(result);\n    }));\n  }\n  /**\n   * ä¿å­ç©æç¹å¾é¡¹\n   * @param materialId ç©æid\n   * @param charactValue ç¹å¾å¼\n   * @param configType éç½®ç±»å\n   * @returns \n   */\n  public applyFeatures(materialId: string, charactValue: any, configType: string = 'Materials') {\n    return this.repository.applyFeatures(materialId, charactValue, configType).pipe(map((config: any) => {\n      return JSON.parse(config);\n    }));\n  }\n  /**\n   * è·åå¸®å©ä¿¡æ¯\n   * @param helpid å¸®å©id\n   * @param filter è¿æ»¤æ¡ä»¶\n   * @param params åæ°\n   * @returns \n   */\n  public getHelpInfo(helpid: string, filter: string, params: any): Observable<any> {\n    const url = '/api/scm/scmfnd/v1.0/scmcommoncmpservice/service/gethelpdata';\n    const httpParams: any = {};\n    if (params) {\n      if (params.pageIndex) {\n        httpParams['pageIndex'] = JSON.stringify(params.pageIndex - 0);\n      }\n      if (params.pageSize) {\n        httpParams['pageSize'] = JSON.stringify(params.pageSize - 0);\n      }\n      if (params.condition) {\n        httpParams['condition'] = JSON.stringify(params.condition);\n      }\n      if (params.searchValue) {\n        httpParams['search'] = params.searchValue;\n      }\n    }\n    const body = {\n      helpID: helpid,\n      queryParam: JSON.stringify(httpParams),\n      filterStr: filter\n    };\n    const befRepository: BefRepository<any> = null;//this.repository as BefRepository<any>;\n    const options = {\n      body\n    };\n    return befRepository.proxy.request(url, 'put', null, options).pipe(\n      map((result: any) => JSON.parse(result))\n    );\n  }\n  /**\n   * å½éåç¹å¾é¡¹æç¹å¾éåç§°\n   * @param object ç¹å¾éæç¹å¾é¡¹å¯¹è±¡\n   * @returns \n   */\n  private translateName(object: Prop.IPropSet | Prop.IProp): string {\n    if (!object) {\n      return null;\n    }\n    let name = null;\n    switch (this.localeId) {\n      case 'en': {\n        name = object['name_en'];\n      } break;\n      case 'zh-CHS': {\n        name = object['name_chs'];\n      } break;\n      case 'zh-CHT': {\n        name = object['name_cht'];\n      } break;\n      default: name = object['name_chs'];\n    }\n    return name;\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { FeatureEditorService } from '@farris/ui-feature-editor';\nimport { FormNotifyService } from \"../form-notify.service\";\nimport { map, switchMap, tap } from \"rxjs/operators\";\nimport { FormLoadingService } from \"../form-loading/form-loading.service\";\nimport { FeatureDataService } from './feature-data.service';\nimport { LanguageService } from '../languag.service';\nimport { of } from \"rxjs\";\n\n@Injectable()\nexport class FeatureEditService {\n  constructor(\n    private injector: Injector,\n    private featureEditorService: FeatureEditorService,\n    private featureDataService: FeatureDataService,\n    private loadingService: FormLoadingService,\n    private notifyService: FormNotifyService,\n    private languageService: LanguageService,\n  ) { }\n\n  public edit(materialId: string, materialFeatureId?: string, options?: any) {\n    if (!materialId) {\n      throw new Error('[FeatureEditService]ç©æidä¸è½ä¸ºç©ºï¼');\n    }\n    if (!options) {\n      options = {};\n    }\n    if (typeof options === 'string' && options.startsWith('{') && options.endsWith('}')) {\n      options = JSON.parse(options);\n    }\n    options.getHelpInfo = this.featureDataService.getHelpInfo;\n    this.loadingService.show();\n    return this.featureDataService.getFeaturesByMaterialId(materialId).pipe(\n      tap((result: any) => {\n        this.loadingService.hide();\n        const returnValue = result || null;\n        if (returnValue) {\n          const featureInfo = JSON.parse(returnValue);\n          const props = featureInfo.props || null;\n          if (!props || props.length < 1) {\n            this.notifyService.warning(this.languageService.propsIsEmpty);\n            return;\n          }\n          this.featureEditorService.show(props, options);\n        } else {\n          this.notifyService.error(this.languageService.propsIsEmpty);\n        }\n      })\n    );\n  }\n  private buildFeatures(materialId: string, materialFeatureId?: string) {\n    const features$ = this.featureDataService.getFeaturesByMaterialId(materialId);\n    return features$.pipe(\n      switchMap(featureSet => {\n        if (materialFeatureId) {\n          const configedFeatures$ = this.featureDataService.getConfigedValueByFeatureId(materialFeatureId, materialFeatureId);\n          return configedFeatures$.pipe(\n            map(defaultConfigs => {\n              const featureTemplate = featureSet.props;\n              const features = this.mergeFeatures(featureTemplate, defaultConfigs);\n              return features;\n            })\n          );\n        } else {\n          return of(featureSet.props);\n        }\n      })\n    );\n\n  }\n  private mergeFeatures(featureTemplate: any, defaultConfigs: any) {\n    return null;\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { BigNumber } from 'bignumber.js';\nimport { AppContext, FrameContext, Repository, ENTITY_TEMPLATE, ResolveService, ExpressionUtil, ExpressionExecutor } from \"@farris/devkit\";\nimport { Observable, of } from \"rxjs\";\n\n@Injectable()\nexport class ExpressionService {\n  constructor(private injector: Injector, private resolveService: ResolveService, private frameContext: FrameContext, private expressionExecutor: ExpressionExecutor) { }\n  /**\n   * æ§è¡è¡¨è¾¾å¼è®¡ç®\n   * @param expression è¡¨è¾¾å¼\n   * @param customContext èªå®ä¹ä¸ä¸æ\n   * @returns \n   */\n  public execute(expression: string, customContext?: { [prop: string]: any }): any {\n    const deps = this.resolveService.resolve(expression);\n    const groupDependencies = ExpressionUtil.getGroupFunctionDependency(expression, this.frameContext.repository.entityTypeInfo);\n    const entityContext = this.buildEntityContext(deps, groupDependencies);\n    const stateContext = this.buildStateContext();\n    const context = {\n      [this.entityOriginalNodeCode]: entityContext,\n      ...stateContext,\n      BigNumber,\n      frameContext: this.frameContext,\n      bindingData: this.frameContext.bindingData,\n      repository: this.frameContext.repository,\n      ...customContext\n    }\n    return this.expressionExecutor.eval(expression, context);\n  }\n  /**\n   * æ§è¡è¡¨è¾¾å¼ï¼è¿åå¯è§å¯å¯¹è±¡ï¼\n   * @param expression è¡¨è¾¾å¼\n   * @param customContext èªå®ä¹ä¸ä¸æ\n   * @returns \n   */\n  public executeAsync(expression: string, customContext?: { [prop: string]: any }): Observable<any> {\n    const result = this.execute(expression, customContext);\n    return of(result);\n  }\n  /**\n   * æé å®ä½ä¸ä¸æ\n   * @param deps \n   * @param groupDependencies \n   * @param context \n   * @returns \n   */\n  private buildEntityContext(deps: string[], groupDependencies: string[], context?: { [prop: string]: any }) {\n    let isGroupdMainEntity = false;\n    deps.forEach((dep: string) => {\n      const isEntityDependency = this.isEntityDependency(dep);\n      const isGroupDependency = groupDependencies.findIndex(item => item === dep) !== -1;\n      // å¦æä¾èµçæ¯stateï¼æ éå¤çï¼ç°å¨éè¦ç¡®å®çæ¯è¿åå¤å°å®ä½çé®é¢ï¼åstateæ²¡æå³ç³»\n      // è¡¨è¾¾å¼ä¾èµäºå®ä½\n      if (isEntityDependency) {\n        // æ¯èåä¾èµ\n        if (isGroupDependency) {\n          const dependencyLength = dep.split('/').filter(p => p).length - 1;\n          if (dependencyLength === 1) {\n            // èåäºä¸»è¡¨å­æ®µï¼ææä¸»è¡¨æ°æ®é½éè¦åä¸è¿ç®ï¼æ­¤æ¶å·²ç»ç¡®å®è®¡ç®çå®ä½ä¸ä¸æäºã\n            isGroupdMainEntity = true;\n          } else {\n            // èåäºå­è¡¨å­æ®µï¼åªéè¦ä¼ éå½åå®ä½\n          }\n        } else {\n          // å½åä¾èµä¸æ¯èåï¼åªéè¦ä¼ éå½åå®ä½\n        }\n      }\n    });\n    const data = this.getEntity();\n    if (isGroupdMainEntity) {\n      const collection = this.frameContext.repository.entityCollection.toJSON();\n      data['__type__'] = 'List';\n      data['__items__'] = collection;\n    }\n    return data;\n  }\n  /**\n   * æ¯å¦ä¸ºå®ä½ä¾èµ\n   * @param dep \n   * @returns \n   */\n  private isEntityDependency(dep: string) {\n    return dep.startsWith(ENTITY_TEMPLATE);\n  }\n  /**\n   * è·åå®ä½\n   * @param event \n   * @returns \n   */\n  public getEntity() {\n    const entityTypeInfo = this.frameContext.repository.entityTypeInfo;\n    const bindingData = this.frameContext.bindingData;\n    const childrenEntityPaths = [];\n    ExpressionUtil.getChildrenEntityPaths(entityTypeInfo, childrenEntityPaths);\n    const entity = this.frameContext.bindingData.list.currentItem.toJSON();\n    entity['__type__'] = 'Entity';\n    if (!childrenEntityPaths || childrenEntityPaths.length < 1) {\n      return entity;\n    }\n    // æ¾å°ææå­è¡¨\n    childrenEntityPaths.forEach((paths: string[]) => {\n      const row = ExpressionUtil.getCurrentRowByPaths(paths, bindingData);\n      if (row) {\n        const propertyName = paths.pop();\n        let parent = paths.reduce((object: any, path: string) => {\n          return object && object[path] || null;\n        }, entity);\n        const node = { __items__: [...parent[propertyName]], ...row, __type__: 'List' };\n        parent[propertyName] = node;\n      }\n    });\n    return entity;\n  }\n  /**\n   * è·åä¸»å®ä½åå§å­æ®µå\n   */\n  protected get entityOriginalNodeCode(): string {\n    const repository = this.injector.get(Repository);\n    return repository && repository.entityTypeInfo && repository.entityTypeInfo.entityInfo && repository.entityTypeInfo.entityInfo.originalCode || null;\n  }\n  /**\n   * æé åéä¸ä¸æ\n   * @param event \n   * @returns \n   */\n  public buildStateContext() {\n    const ns = this.frameContext.namespace;\n    const appContext = this.injector.get<AppContext>(AppContext, null);\n    const frameContexts = appContext.frameContextManager.getFrameContextsByNamespace(ns);\n    const result = {};\n    if (frameContexts && frameContexts.length > 0) {\n      const anonymousFrameContext = frameContexts[0];\n      const rootFrameContext = anonymousFrameContext.getVirtualRootFrameContext();\n      if (rootFrameContext) {\n        const uiState = rootFrameContext.viewModel.uiState;\n        const propertyNames = Object.getOwnPropertyNames(uiState) || [];\n        propertyNames.forEach((prop: string) => {\n          if (prop.match(/^[a-zA-Z0-9_\\$]+$/g) !== null) {\n            result[prop] = uiState[prop];\n          }\n        });\n      }\n    }\n    return result;\n  }\n}","import { ApplicationRef, ChangeDetectorRef, Injectable, Injector } from \"@angular/core\";\n\n/**\n * angular èå¼æ£æ¥æå¡\n */\n@Injectable()\nexport class DirtyCheckingService {\n  constructor(public injector: Injector, private cd: ChangeDetectorRef, private appRef: ApplicationRef) {\n  }\n  /**\n   * Checks this view and its children. \n   * @param global æ¯å¦å¨å±æ£æ¥\n   */\n  public detectChanges(global?: boolean | string) {\n    global = (global === true || global === 'true') ? true : false;\n    if (global && this.appRef) {\n      this.appRef.tick();\n    } else if (this.cd) {\n      this.cd.detectChanges();\n    }\n  }\n  /**\n   * å¨æå®æ¶é´ï¼msï¼åè§¦åAngularèå¼æ£æ¥\n   * @param duration è¶æ¶æ¶é´(ms)\n   * @param global æ¯å¦å¨å±æ£æ¥\n   */\n  public detectChangesAfter(duration: number, global?: boolean | string) {\n    global = (global === true || global === 'true') ? true : false;\n    if (isNaN(duration)) {\n      return;\n    }\n    if (global && this.appRef) {\n      window.setTimeout(() => {\n        this.appRef.tick();\n      }, duration);\n    } else if (this.cd) {\n      window.setTimeout(() => {\n        this.cd.detectChanges();\n      }, duration);\n    }\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { EMPTY, of } from \"rxjs\";\nimport { switchMap, tap } from \"rxjs/operators\";\nimport { BefRepository } from \"@farris/bef\";\nimport { FrameContext, DataPathCreator, Repository, DataPath, EntityList, BindingList, Entity } from \"@farris/devkit\";\nimport { LanguageService } from \"./languag.service\";\nimport { FormMessageService } from \"./form-message.service\";\n\n@Injectable()\nexport class PopUpService {\n  constructor(\n    private injector: Injector,\n    private frameContext: FrameContext,\n    private repository: Repository<any>,\n    private languageService: LanguageService,\n    private messageService: FormMessageService\n  ) { }\n  public confirm() { }\n  /**\n   * åæ¶åæ´\n   * @param frameId \n   * @param id \n   * @returns \n   */\n  public cancel(frameId: string, id?: string) {\n    const frameContext = this.frameContext.appContext.frameContextManager.getFrameContextById(frameId);\n    if (!frameContext) {\n      throw new Error(`[PopUpService]Invalid frameId ${frameId}`);\n    }\n    const primaryValue = this.frameContext.bindingData.list.currentId;\n    const bindingPath = frameContext.viewModel.bindingPath;\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    if (!id) {\n      const bindingList = this.frameContext.bindingData.getList() as BindingList;\n      id = bindingList.currentId;\n    }\n    const befRepository = this.repository as BefRepository<any>;\n    const longPaths = (DataPathCreator.createByShortPathFromRoot(bindingPaths, befRepository.entityManager, this.frameContext.bindingData) as DataPath).toArray().map((path: string) => path.split(':')[1]);\n    const entityListPaths = Array.from(longPaths);\n    //èå¼å½åè¡¨å½åè¡\n    entityListPaths.pop();\n    const dialogRef = this.frameContext.frameComponent['dialogRef'];\n    if (entityListPaths.length < 1) {\n      // ä¸»è¡¨\n      const entity = this.repository.entityCollection.getEntityById(id) as Entity;\n      const originalData = entity['originalData'];\n      entity.load(originalData, { loadChild: false });\n    } else {\n      const entityList = befRepository.entityManager.getEntityNodeByPath(entityListPaths) as EntityList<any>;\n      if (entityList) {\n        const originalData: any[] = entityList['originalData'];\n        const item = originalData.find(item => item.id === id);\n        if (item) {\n          // å·²ææ°æ®ï¼è¿ååæ´\n          const entity: Entity = befRepository.entityManager.getEntityByPath(longPaths) as Entity;\n          if (entity.changes && entity.changes.length > 0) {\n            return this.messageService.confirm(this.languageService.cancelWithoutSave).pipe(\n              tap((result: boolean) => {\n                if (result) {\n                  entity.load(item, { loadChild: false });\n                  entity.changes.splice(0, entity.changes.length);\n                }\n              })\n            );\n          } else {\n            // æ²¡æä¿®æ¹ï¼ç´æ¥å³é­\n            if (dialogRef) {\n              dialogRef.close();\n            }\n          }\n        } else {\n          // æ°å¢çæ°æ®ï¼å é¤\n          const paths = this.buildPath(bindingPath, primaryValue);\n          return this.messageService.confirm(this.languageService.cancelWithoutSave).pipe(\n            switchMap(result => {\n              if (result) {\n                return befRepository.removeEntityByPath(paths, id).pipe(\n                  tap(() => {\n                    befRepository.entityManager.removeEntityByPath(paths, id);\n\n                    if (entityList.count() === 0 && dialogRef) {\n                      dialogRef.close();\n                    }\n                  })\n                );\n              } else {\n                return EMPTY;\n              }\n            })\n          );\n        }\n      }\n    }\n    return of([]);\n  }\n  /**\n   * åæ­¥å½åè¡\n   */\n  public updateCurrentRow(id?: string) {\n    const bindingPath = this.frameContext.viewModel.bindingPath;\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    // const frameId = this.frameContext.frameId;\n    const root = this.frameContext.appContext.frameContextManager.getRootFrameContext();\n    const primaryKeyValue = root.bindingData.list.currentId;\n    this.frameContext.bindingData.list.setCurrentId(primaryKeyValue);\n    if (bindingPaths.length > 0) {\n      const paths = [];\n      bindingPaths.forEach((path: string, index: number, array) => {\n        paths.push(path);\n        const bindingList = root.bindingData.getValue(paths) as BindingList;\n        if (bindingList) {\n          const currentId = bindingList.currentId;\n          const modalBindingList = this.frameContext.bindingData.getValue(paths) as BindingList;\n          if (index === bindingPath.length - 1 && id) {\n            modalBindingList.setCurrentId(id);\n          } else if (modalBindingList) {\n            modalBindingList.setCurrentId(currentId);\n          }\n        }\n      });\n    }\n  }\n  public closeCheck() {\n    const frameContext = this.frameContext;\n    const bindingPath = frameContext.viewModel.bindingPath;\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    const befRepository = this.repository as BefRepository<any>;\n    const longPaths = (DataPathCreator.createByShortPathFromRoot(bindingPaths, befRepository.entityManager, this.frameContext.bindingData) as DataPath).toArray().map((path: string) => path.split(':')[1]);\n    const entityListPaths = Array.from(longPaths);\n    entityListPaths.pop();\n    const entityList = befRepository.entityManager.getEntityNodeByPath(entityListPaths) as EntityList<any>;\n    const dialogRef = this.frameContext.frameComponent['dialogRef'];\n    if (entityList.count() === 0 && dialogRef) {\n      dialogRef.close();\n    }\n  }\n  /**\n   * æé å­è¡¨è·¯å¾\n   * @param bindingPath ç»å®è·¯å¾\n   * @param id id\n   */\n  private buildPath(bindingPath: string, id: any) {\n    let path = '/' + id;\n    const subPaths = bindingPath.split('/');\n    if (subPaths.length > 0) {\n      // eg:bindingPathå½¢å¦/edus/grades,splitåæ¯['', 'edus', 'grades']\n      // å æ­¤indexä»1å¼å§\n      for (let index = 1; index < subPaths.length - 1; index++) {\n        const subPath = subPaths[index];\n        const subData = this.frameContext.viewModel.bindingData[subPath];\n        if (!subData || !subData.currentId) {\n          throw Error(`è·åå­è¡¨å®æ´è·¯å¾åºéï¼æ¾ä¸å°${subData}å¯¹åºçå­è¡¨ï¼æå¯¹åºå­è¡¨æ²¡æå½åè¡ã`);\n        }\n        path += `/${subPath}/${subData.currentId}`;\n      }\n    }\n    path += '/' + subPaths[subPaths.length - 1];\n\n    return path;\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { AppContext, DataPropInfo, DataTypeInfo, Entity, FrameContext, NgFormControl, Repository } from \"@farris/devkit\";\n\n@Injectable()\nexport class FormService {\n  constructor(\n    private injector: Injector,\n    private appContext: AppContext,\n    private repository: Repository<Entity>\n  ) {\n  }\n  /**\n   * æ ¹æ®å­æ®µè·¯å¾è·åè¯¥å­æ®µå¨å¡çæè¡¨æ ¼ä¸­çç´¢å¼\n   * @param source ngFormControlsæany[][]\n   * @param propertyPath å­æ®µé¤bindingPathä¹å¤çå®æ´è·¯å¾\n   * @returns \n   */\n  public getIndex(source: { [propertyName: string]: NgFormControl } | any[], propertyPath: string) {\n    if (Array.isArray(source)) {\n      const combine: any[] = source.reduce((result: any[], group: any[]) => {\n        return result.concat(group);\n      }, []);\n      return combine.findIndex((item: any) => item.field === propertyPath);\n    } else if (Object.prototype.toString.call(source) === '[object Object]') {\n      return Object.keys(source).findIndex(key => source[key].binding === propertyPath);\n    }\n  }\n  \n}","import { Injectable } from \"@angular/core\";\nimport { FrameContext } from \"@farris/devkit\";\n\n@Injectable()\nexport class ViewModelService {\n  constructor() { }\n  public getGridColumns(frameContext: FrameContext): any[] {\n    const dataGridColumnsName = frameContext && frameContext.viewModel && frameContext.viewModel['dataGridColumnsName'] || null;\n    return dataGridColumnsName && frameContext.viewModel[dataGridColumnsName] || [];\n  }\n}","import { Injectable, Injector } from \"@angular/core\";\nimport { DataPropGroup, FrameContext } from \"@farris/devkit\";\n\n@Injectable()\nexport class PaginationService {\n  constructor(private injector: Injector, private frameContext: FrameContext) { }\n  /**\n   * éç½®å­è¡¨åé¡µä¿¡æ¯\n   */\n  public resetChildrenPagination() {\n    const paginationInfo = this.frameContext.repository.entityCollection.paginationInfo || {};\n    const childrenEntityCodes = this.frameContext.repository.entityTypeInfo.getPropNamesByGroup(DataPropGroup.List) || [];\n    if (paginationInfo && Object.keys(paginationInfo).length > 0) {\n      const keys = Object.keys(paginationInfo);\n      keys.forEach((key: string) => {\n        const value = paginationInfo[key];\n        if (Object.prototype.toString.apply(value) !== '[object Object]') {\n          return;\n        }\n        const rowPagination = childrenEntityCodes.find((nodeCode: string) => {\n          // å»æs\n          nodeCode = nodeCode.slice(0, -1);\n          return key.startsWith(`${nodeCode}_`);\n        });\n        if (rowPagination) {\n          delete paginationInfo[key];\n        } else {\n          paginationInfo[key].pageIndex = 1;\n          delete paginationInfo[key].total;\n          delete paginationInfo[key].pageCount;\n        }\n      });\n      this.frameContext.repository.entityCollection.updatePaginationInfoByPath('/', paginationInfo);\n    }\n  }\n}","import { Provider } from '@angular/core';\n\nimport { UIStateService } from '../ui-state.service';\nimport { StateMachineService } from '../state-machine.service';\nimport { ValidationService } from '../validation.service';\nimport { BindingDataService } from '../binding-data.service';\nimport { CommandService } from '../command-service';\nimport { NavigationMiddlewareService } from '../navigation-middleware.service';\nimport { GridMiddlewareService } from '../grid.middleware.service';\nimport { BeActionService } from '../be-action.service';\nimport { ApproveService } from '../approve.service';\nimport { PrintService } from '../print.service';\nimport { AttachmentDataService, AttachmentService, FileService } from '../attachment/index';\nimport {\n  EntityTraversingService, EntityManipulationService, EntityAggregationService,\n  EntityListService, EntityService\n} from '../entity-services/index';\nimport { SidebarService } from '../sidebar-service';\nimport { ChangeItemService } from '../change-item.service';\n\nimport {\n  ListDataService, CardDataService, SubListDataService, TreeDataService,\n  RemoveDataService, SaveDataService, EditDataService, SubTreeDataService\n} from '../data-services/index';\n\nimport { FarrisFormService } from '../farris-form.service';\nimport { DialogService } from '../dialog.service';\nimport { NavigationEventService } from '../navigation-event.service';\nimport { NavigationService } from '../navigation.service';\nimport { RouterService } from '../router.service';\nimport { AuthorityService } from '../authority/authority.service';\n\nimport { QuerySolutionService } from '../query-solution/query-solution.service';\nimport { QUERYSOLUTION_HANDLER_TOKEN } from '@gsp-cmp/querysolution';\nimport { FilterConditionDataService } from '../data-services/filter-condition-data.service';\nimport { FocusInvalidService } from '../focus-invalid.service';\nimport { EndEditService } from '../end-edit.service';\nimport { RemoteSummaryService } from '../remote-summary.service';\nimport { BatchEditService } from '../batch-edit.service';\nimport { BatchEditDialogService } from '@farris/ui-batch-edit-dialog';\nimport { FeatureEditorService } from '@farris/ui-feature-editor';\nimport { DiscussionGroupService } from '../discussion-group.service';\nimport { ListFilterConditionsService } from '../list-filter/list-filter.service';\nimport { LISTFILTER_HANDLER_TOKEN } from '@farris/ui-list-filter';\nimport { FORM_MANIFEST_SERVICE_TOKEN, FORM_EXPRESSION_MANIFEST_SERVICE_TOKEN, MESSAGE_SERVICE_TOKEN, NOTIFY_SERVICE_TOKEN, FRAME_COMPONENT_INIT_HANDLER_TOKEN } from '@farris/devkit';\nimport { FormManifestService, FormExpressionManifestService } from '../manifest/index';\nimport { LocalizationService } from '../localization.service';\nimport { DataGridService } from '../data-grid.service';\nimport { FormAttentionService } from '../form-attention.service';\nimport { FeatureDataService, FeatureEditService } from '../feature-edit/index';\nimport { ExpressionService } from '../expression_service';\nimport { DirtyCheckingService } from '../dirty-checking.service';\nimport { FormMessageService } from '../form-message.service';\nimport { FormNotifyService } from '../form-notify.service';\nimport { PopUpService } from '../pop_up.service';\nimport { WorkFlowMessageHandler } from '../work-flow/index';\nimport { FormService } from '../form.service';\nimport { FormControlService } from '../form-control.service';\nimport { BindingPathService } from '../binding-path.service';\nimport { FrameContextService } from '../frame-context.service';\nimport { ViewModelService } from '../view-model.service';\nimport { PaginationService } from '../pagination.service';\n/**\n * ç»ä»¶çº§æ³¨å¥æ³¨å¥(å±23ä¸ª)\n */\nconst FARRIS_COMMAND_SERVICE_FRAME_PROVIDERS: Provider[] = [\n  ValidationService,\n  FocusInvalidService,\n  ChangeItemService,\n  UIStateService,\n  StateMachineService,\n  BindingDataService,\n  CommandService,\n\n  // entity-services\n  EntityTraversingService,\n  EntityManipulationService,\n  EntityAggregationService,\n  EntityListService,\n  EntityService,\n\n  // data-services\n  ListDataService,\n  TreeDataService,\n  SubTreeDataService,\n  CardDataService,\n  SubListDataService,\n  RemoveDataService,\n  SaveDataService,\n  EditDataService,\n  FilterConditionDataService,\n  RemoteSummaryService,\n\n  BeActionService,\n  ApproveService,\n  PrintService,\n  AttachmentDataService,\n  AttachmentService,\n  FileService,\n  NavigationMiddlewareService,\n  GridMiddlewareService,\n  SidebarService,\n  FarrisFormService,\n  DialogService,\n  NavigationEventService,\n  NavigationService,\n  RouterService,\n  AuthorityService,\n  {\n    provide: QUERYSOLUTION_HANDLER_TOKEN,\n    useClass: QuerySolutionService\n  },\n  {\n    provide: LISTFILTER_HANDLER_TOKEN,\n    useClass: ListFilterConditionsService\n  },\n  EndEditService,\n  BatchEditDialogService,\n  BatchEditService,\n  DiscussionGroupService,\n  LocalizationService,\n  DataGridService,\n  FormAttentionService,\n  FeatureEditorService,\n  FeatureDataService,\n  FeatureEditService,\n  ExpressionService,\n  PopUpService,\n  DirtyCheckingService,\n  FormService,\n  FormControlService,\n  BindingPathService,\n  FrameContextService,\n  ViewModelService,\n  PaginationService,\n  // è¡¨è¾¾å¼\n  { provide: FORM_MANIFEST_SERVICE_TOKEN, useClass: FormManifestService },\n  { provide: FORM_EXPRESSION_MANIFEST_SERVICE_TOKEN, useClass: FormExpressionManifestService },\n  { provide: MESSAGE_SERVICE_TOKEN, useClass: FormMessageService },\n  { provide: NOTIFY_SERVICE_TOKEN, useClass: FormNotifyService },\n  { provide: FRAME_COMPONENT_INIT_HANDLER_TOKEN, useClass: WorkFlowMessageHandler, multi: true }\n];\n\nexport { FARRIS_COMMAND_SERVICE_FRAME_PROVIDERS };\n","import { Provider } from '@angular/core';\n\nimport { RouterService } from '../router.service';\nimport { UIStateService } from '../ui-state.service';\nimport { StateMachineService } from '../state-machine.service';\nimport { ValidationService } from '../validation.service';\nimport { BindingDataService } from '../binding-data.service';\nimport { CommandService } from '../command-service';\n\nimport { NavigationEventService } from '../navigation-event.service';\nimport { NavigationService } from '../navigation.service';\nimport { NavigationMiddlewareService } from '../navigation-middleware.service';\nimport { GridMiddlewareService } from '../grid.middleware.service';\n\nimport { BeActionService } from '../be-action.service';\nimport { ApproveService } from '../approve.service';\nimport { PrintService } from '../print.service';\nimport { AttachmentDataService, AttachmentService, FileService } from '../attachment/index';\nimport {\n    EntityTraversingService, EntityManipulationService, EntityAggregationService,\n    EntityListService, EntityService\n} from '../entity-services/index';\nimport { DialogService } from '../dialog.service';\nimport { SidebarService } from '../sidebar-service';\nimport { FarrisFormService } from '../farris-form.service';\nimport { ChangeItemService } from '../change-item.service';\n\n// data-services\nimport { ListDataService } from '../data-services/list-data.service';\nimport { TreeDataService } from '../data-services/tree-data.service';\nimport { CardDataService } from '../data-services/card-data.service';\nimport { SubListDataService } from '../data-services/sub-list-data.service';\nimport { FocusInvalidService } from '../focus-invalid.service';\nimport { SubTreeDataService } from '../data-services/sub-tree-data-service';\nimport { RemoveDataService } from '../data-services/remove-data.service';\nimport { SaveDataService } from '../data-services/save-data.service';\nimport { EditDataService } from '../data-services/edit-data.service';\nimport { FilterConditionDataService } from '../data-services/filter-condition-data.service';\nimport { RemoteSummaryService } from '../remote-summary.service';\nimport { AuthorityService } from '../authority/authority.service';\nimport { EndEditService } from '../end-edit.service';\nimport { BatchEditService } from '../batch-edit.service';\nimport { DiscussionGroupService } from '../discussion-group.service';\nimport { LocalizationService } from '../localization.service';\nimport { DataGridService } from '../data-grid.service';\nimport { FormAttentionService } from '../form-attention.service';\nimport { FormManifestService } from '../manifest/form_manifest_service';\nimport { FormExpressionManifestService } from '../manifest/form_expression_manifest_service';\nimport { ListFilterConditionsService } from '../list-filter/list-filter.service';\nimport { QuerySolutionService } from '../query-solution/query-solution.service';\nimport { BatchEditDialogService } from '@farris/ui-batch-edit-dialog';\nimport { FORM_MANIFEST_SERVICE_TOKEN, FORM_EXPRESSION_MANIFEST_SERVICE_TOKEN } from '@farris/devkit';\nimport { QUERYSOLUTION_HANDLER_TOKEN } from '@gsp-cmp/querysolution';\nimport { LISTFILTER_HANDLER_TOKEN } from '@farris/ui-list-filter';\n\n/**\n * ç»ä»¶çº§æ³¨å¥æ³¨å¥(å±23ä¸ª)\n */\nconst DYNAMIC_FARRIS_COMMAND_SERVICE_PROVIDERS: Provider[] = [\n    { provide: 'ValidationService', useClass: ValidationService },\n    { provide: 'FocusInvalidService', useClass: FocusInvalidService },\n    { provide: 'ChangeItemService', useClass: ChangeItemService },\n    { provide: 'UIStateService', useClass: UIStateService },\n    { provide: 'StateMachineService', useClass: StateMachineService },\n    { provide: 'BindingDataService', useClass: BindingDataService },\n    { provide: 'CommandService', useClass: CommandService },\n\n    // entity-services\n    { provide: 'EntityTraversingService', useClass: EntityTraversingService },\n    { provide: 'EntityManipulationService', useClass: EntityManipulationService },\n    { provide: 'EntityAggregationService', useClass: EntityAggregationService },\n    { provide: 'EntityListService', useClass: EntityListService },\n    { provide: 'EntityService', useClass: EntityService },\n\n    // data-services\n    { provide: 'ListDataService', useClass: ListDataService },\n    { provide: 'TreeDataService', useClass: TreeDataService },\n    { provide: 'SubTreeDataService', useClass: SubTreeDataService },\n    { provide: 'CardDataService', useClass: CardDataService },\n    { provide: 'SubListDataService', useClass: SubListDataService },\n    { provide: 'RemoveDataService', useClass: RemoveDataService },\n    { provide: 'SaveDataService', useClass: SaveDataService },\n    { provide: 'EditDataService', useClass: EditDataService },\n    { provide: 'FilterConditionDataService', useClass: FilterConditionDataService },\n    { provide: 'RemoteSummaryService', useClass: RemoteSummaryService },\n\n    { provide: 'BeActionService', useClass: BeActionService },\n    { provide: 'ApproveService', useClass: ApproveService },\n    { provide: 'PrintService', useClass: PrintService },\n    { provide: 'AttachmentDataService', useClass: AttachmentDataService },\n    { provide: 'AttachmentService', useClass: AttachmentService },\n    { provide: 'FileService', useClass: FileService },\n    { provide: 'NavigationMiddlewareService', useClass: NavigationMiddlewareService },\n    { provide: 'GridMiddlewareService', useClass: GridMiddlewareService },\n    { provide: 'SidebarService', useClass: SidebarService },\n    { provide: 'FarrisFormService', useClass: FarrisFormService },\n    { provide: 'DialogService', useClass: DialogService },\n    { provide: 'NavigationEventService', useClass: NavigationEventService },\n    { provide: 'NavigationService', useClass: NavigationService },\n    { provide: 'RouterService', useClass: RouterService },\n    { provide: 'AuthorityService', useClass: AuthorityService },\n    {\n        provide: QUERYSOLUTION_HANDLER_TOKEN,\n        useClass: QuerySolutionService\n    },\n    {\n        provide: LISTFILTER_HANDLER_TOKEN,\n        useClass: ListFilterConditionsService\n    },\n    { provide: 'EndEditService', useClass: EndEditService },\n    { provide: 'BatchEditDialogService', useClass: BatchEditDialogService },\n    { provide: 'BatchEditService', useClass: BatchEditService },\n    { provide: 'DiscussionGroupService', useClass: DiscussionGroupService },\n    { provide: 'LocalizationService', useClass: LocalizationService },\n    { provide: 'DataGridService', useClass: DataGridService },\n    { provide: 'FormAttentionService', useClass: FormAttentionService },\n    // è¡¨è¾¾å¼\n    { provide: FORM_MANIFEST_SERVICE_TOKEN, useClass: FormManifestService },\n    { provide: FORM_EXPRESSION_MANIFEST_SERVICE_TOKEN, useClass: FormExpressionManifestService }\n];\n\n\nexport { DYNAMIC_FARRIS_COMMAND_SERVICE_PROVIDERS };\n","import { NgModule } from '@angular/core';\nimport { FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS } from './providers/index';\nimport { WfTaskHandlerModule } from '@gsp-wf/wf-task-handler';\nimport { WorkFlowMessage } from './work-flow/index';\n\n@NgModule({\n  providers: FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS,\n  imports: [\n    WfTaskHandlerModule\n  ],\n  exports: [\n    WfTaskHandlerModule\n  ]\n})\nclass CommandServicesModule {\n  constructor(private workFlowMessage: WorkFlowMessage) {\n    if (this.workFlowMessage) {\n      this.workFlowMessage.setup();\n    }\n  }\n}\n\nexport { CommandServicesModule };\n","import { RuntimeFrameworkService } from '../rtf-service';\nimport { UID } from '@farris/devkit';\n\nexport class MessagePipe {\n    constructor(public token: string, private rtfService: RuntimeFrameworkService) { }\n    /**\n     * åç®¡éåéæ¶æ¯\n     * @param message æ¶æ¯\n     */\n    public sendMessage(message: any) {\n        this.rtfService.subjectNotify(this.token, message);\n        return this;\n    }\n    /**\n     * çå¬ç®¡éæ¶æ¯\n     * @param handler æ¶æ¯å¤çå¨\n     */\n    public listen(handler: (data: any) => void): () => void {\n        const observerToken = UID.create();\n        this.rtfService.subjectResponse(this.token, handler, observerToken);\n        const unListen = () => {\n            this.rtfService.responseUnSubscribe(this.token, observerToken);\n        };\n        return unListen;\n    }\n    /**\n     * éæ¯ç®¡é\n     */\n    public destory() {\n        this.rtfService.subjectRemove(this.token);\n    }\n}\n","import { MessagePipe } from './message-pipe';\nimport { RuntimeFrameworkService } from '../rtf-service';\nimport { Subject } from 'rxjs';\nimport { QuerystringService } from '../querystring';\n\nexport class MessagePipeService {\n  private static rtfService: RuntimeFrameworkService = new RuntimeFrameworkService();\n  private static querystringService: QuerystringService = new QuerystringService();\n  /**\n   * éè¿tokenè·åæ¶æ¯ç®¡é\n   * @param token æ¶æ¯ç®¡éæ è¯\n   */\n  public static get(token: string): MessagePipe {\n    const pipe = new MessagePipe(token, this.rtfService);\n    return pipe;\n  }\n  /**\n   * åå»ºæ¶æ¯ç®¡é\n   * @param pipeName ç®¡éåç§°\n   * @param useFormContext æ¯å¦ä½¿ç¨è¡¨åä¸ä¸æåå»ºç®¡éæ è¯\n   * @param pipeType ç®¡éç±»å(å¯é)ï¼é»è®¤Subject<any>\n   */\n  public static create(pipeName: string, useFormContext: boolean, pipeType?: Subject<any>): MessagePipe {\n    let options = null;\n    if (useFormContext) {\n      const params = this.querystringService.parse(window.location.hash);\n      const { funcId, appId, appEntrance } = params;\n      options = { funcId, appId, appEntrance };\n    }\n    const token = this.rtfService.subjectRegister(pipeName, options, pipeType);\n    if (!token) {\n      return null;\n    }\n    const pipe = new MessagePipe(token, this.rtfService);\n    return pipe;\n  }\n}\n","import { Inject, Injectable, Injector } from '@angular/core';\nimport { AppContext, BackEndMessage, BindingList, DataPropInfo, EventBus, FrameComponent, FrameContext, NgFormControl, Translate, TranslateToken } from '@farris/devkit';\n/**\n * åç«¯æ¶æ¯å¤çæå¡\n * @description\n * ### æå¡æ³¨å¥ä½ç½®\n *  1ãæ´ä¸ªè¡¨åçroot-component \n *  2ãå¼¹åºçªå£çroot-component \n */\n@Injectable()\nexport class BackEndMessageHandler implements BackEndMessage.IBackEndMessageHandler {\n  constructor(private injector: Injector, private frameContext: FrameContext, @Inject(TranslateToken) private translate: Translate) { }\n  /**\n   * å¤çåç«¯è¿åçæ¶æ¯æéè¯¯\n   * @param message æ¶æ¯æéè¯¯\n   */\n  public handle(message: BackEndMessage.IMessage, context: any) {\n    const isException = context && context.isException || false;\n    const hasThrowError = context && context.hasThrowError || false;\n    const eventBus = context && context.eventBus || null;\n    const error = context && context.error || null;\n    const formAppContext = context && context.formAppContext || null;\n    const result = this.collect(message, isException, hasThrowError, eventBus, error, formAppContext);\n    if (result && result.form && result.form.length > 0) {\n      result.form.forEach((item: { frameContext: FrameContext, message: any }) => {\n        item.frameContext.viewModel.form.updateFormErrors(item.message, true, 'backend');\n      });\n    } else {\n      this.resetFormMessage(message.context.appContext, message.context.ns);\n    }\n    const targetFrameContext: FrameContext = this.findTargetFrameContext(this.frameContext);\n    if (result && result.all && result.all.length > 0) {\n      targetFrameContext.viewModel.verifycationChanged.next(result.all);\n    } else {\n      if (result !== null) {\n        targetFrameContext.viewModel.verifycationChanged.next([]);\n      }\n    }\n  }\n  /**\n   * æ¶éæ±æ»ä¿¡æ¯åformä¿¡æ¯\n   * @param backEndMessage \n   */\n  private collect(backEndMessage: BackEndMessage.IMessage, isException: boolean = false, hasThrowError: boolean = false, eventBus: EventBus = null, error: any = null, formAppContext: AppContext = null): { form: { frameContext: FrameContext, message: any }[], all: any[] } {\n    const bizMessages = backEndMessage && backEndMessage.bizMessages || null;\n    const appContext = backEndMessage && backEndMessage.context.appContext;\n    const ns = backEndMessage.context.ns;\n    if (!bizMessages || bizMessages.length < 1) {\n      return null;\n    }\n    const result = {\n      form: [],\n      all: []\n    };\n    let hasFormlessError = false;\n    for (let bizMessage of bizMessages) {\n      const message = bizMessage.message;\n      const location = bizMessage.location || null;\n      const columns = location && location.columns || null;\n      const nodeCode = location && location.nodeCode || null;\n      const rows = location && location.rows;\n      const bindingPath = this.getBindingPath(appContext, ns, nodeCode);\n      const bindingPaths = bindingPath && bindingPath.split('/').filter(p => p);\n\n      // ç®åä»å¤çælocationï¼ä¸æidãååãè¡¨åçã\n      if (!location || !columns || columns.length < 1 || !nodeCode || !rows || rows.length < 1) {\n        continue;\n      }\n      // éåæ°æ®è¡\n      for (let row of rows) {\n        for (let column of columns) {\n          // è·åå°ææç»å®è¯¥åæ°æ®çframeContext\n          let frameContexts = this.getFrameContextsByBindingPathAndColumnName(appContext, ns, bindingPath, column);\n          if (!frameContexts || frameContexts.length < 1) {\n            // æ²¡æä»»ä½ä¸ä¸ªç»ä»¶ç»å®è¯¥åçæ°æ®\n            hasFormlessError = true;\n            continue;\n          }\n          // æé¤æåªè¯»datagrid\n          frameContexts = frameContexts.filter((frameContext: FrameContext) => {\n            const isDataGridComponent = this.isDataGridComponent(frameContext.frameComponent);\n            if (isDataGridComponent) {\n              const isReadonlyDataGrid = this.isReadonlyDataGrid(frameContext.frameComponent);\n              if (isReadonlyDataGrid) {\n                return false;\n              } else {\n                return true;\n              }\n            }\n            return true;\n          });\n          // éåçè¡æ¯å¦ä¸ºå½åè¡\n          const isCurrentRow = this.isCurrentRow(appContext, ns, bindingPath, row);\n          // å¦ææ¯å½åè¡çè¯éè¦å°éè¯¯ä¿¡æ¯æ¾å°formä¸­\n          if (isCurrentRow) {\n            // å¿½ç¥grid\n            // const formFrameContexts = frameContexts.filter(frameContext => !this.isGridComponent(frameContext.frameComponent));\n            if (frameContexts && frameContexts.length > 0) {\n              frameContexts.forEach((frameContext: FrameContext) => {\n                // åªå¤çäºä¸ä¸ªç»ä»¶ä¸­ååªç»å®å°ä¸ä¸ªåç«¯æ§ä»¶çåºæ¯\n                const formControls = this.getFormControlByColumnName(frameContext, column);\n                if (formControls && formControls.length > 0) {\n                  formControls.forEach(([domPropertyName, formControl]) => {\n                    //const domPropertyName = formControl && formControl. || null;\n                    this.mergeMessage(result.form, frameContext, domPropertyName, message);\n                  });\n                }\n\n                //if (formControl && domPropertyName) {\n\n                //}\n              });\n            } else {\n            }\n          }\n          // å°éè¯¯ä¿¡æ¯æ¾å°æ±æ»ä¸­\n          frameContexts.forEach((frameContext: FrameContext) => {\n            const viewModelName = frameContext.viewModel.form.formGroupName;\n            const formControls = this.getFormControlByColumnName(frameContext, column);\n            if (formControls && formControls.length > 0) {\n              const [domPropertyName, formControl] = formControls.find(([propertyName, formControl]) => propertyName && propertyName.length > 0);\n              // const domPropertyName = domProperty && domProperty.propertyName;\n              const bindingList = frameContext.viewModel.bindingData.getValue(bindingPaths) as BindingList;\n              let index = bindingList.getIndexById(row);\n              const primary = `${row}_${column}_${message}`;\n              // TODO:è½ç¶è½çº æ­£æ±æ»æ¶æ¯æ¾ç¤ºéå¤çé®é¢ï¼ä½å¯è½å¯¼è´ç¹å»éè¯¯æ æ³å®ä½å°å¯¹åºæ§ä»¶çé®é¢ï¼å¾åç»­ä¼å\n              if (index >= 0 && result.all.findIndex(p => p.id === primary) === -1) {\n                // æ°æ®æºä¸­æå¤äº1è¡æ¶æ¾ç¤ºç´¢å¼\n                const position = (bindingList && bindingList.length > 1) ? (index + 1) : -1;\n                const title = this.buildItemTitle(viewModelName, formControl.name || formControl.defaultI18nValue || domPropertyName, position);\n                const item = {\n                  id: primary,\n                  index,\n                  targetField: formControl.id,\n                  title,\n                  msg: message,\n                  namespace: ns,\n                  bindingPath,\n                  type: 'error'\n                };\n                result.all.push(item);\n              }\n            }\n\n          });\n        }\n      }\n    }\n    if (hasFormlessError && isException && !hasThrowError && eventBus) {\n      eventBus.post('Exception', '', 'onException', error, formAppContext);\n    }\n    return result;\n  }\n  private mergeMessage(formItems: { frameContext: FrameContext, message: { [domPropertyName: string]: { errors: { [messageType: string]: { name: string } } } } }[], frameContext: FrameContext, domPropertyName: string, message: string) {\n    const targetItem = formItems.find(item => item.frameContext.frameId === frameContext.frameId);\n    if (targetItem) {\n      const isPropertyExist = targetItem.message && Object.keys(targetItem.message).includes(domPropertyName);\n      const messageType = `backend-message-${Object.keys(targetItem.message).length + 1}`;\n      if (isPropertyExist) {\n        targetItem.message[domPropertyName]['errors'][messageType] = { name: message };\n      } else {\n        targetItem.message[domPropertyName] = { errors: { [messageType]: { name: message } } };\n      }\n    } else {\n      formItems.push({\n        frameContext: frameContext,\n        message: {\n          [domPropertyName]: {\n            errors: {\n              'backend-message-1': { name: message }\n            }\n          }\n        }\n      });\n    }\n  }\n  private buildItemTitle(viewModelName: string, propertyName: string, index: any) {\n    const template = {\n      'zh-CHS': {\n        viewModelName: `$viewModel`,\n        index: `ç¬¬ $index è¡`,\n        propertyName: `- $propertyName`\n      },\n      'en': {\n        viewModelName: `$viewModel`,\n        index: `row $index`,\n        propertyName: `- $propertyName`\n      },\n      'zh-CHT': {\n        viewModelName: `$viewModel`,\n        index: `ç¬¬ $index è¡`,\n        propertyName: `- $propertyName`\n      }\n    };\n    const currentLanguage = this.translate.getCurrentLanguage() || 'zh-CHS';\n    const message = [];\n    if (viewModelName) {\n      message.push(template[currentLanguage]['viewModelName'].replace('$viewModel', viewModelName));\n    }\n    if (index > 0) {\n      message.push(template[currentLanguage]['index'].replace('$index', index));\n    }\n    if (propertyName) {\n      message.push(template[currentLanguage]['propertyName'].replace('$propertyName', propertyName));\n    }\n    return message.join(' ');\n  }\n  /**\n   * æ ¹æ®è¡¨åænodeCodeè·åç»å®è·¯å¾\n   * @param appContext appContext\n   * @param ns ns\n   * @param nodeCode è¡¨å\n   */\n  private getBindingPath(appContext: AppContext, ns: string, nodeCode: string) {\n    const frameContext = this.getFrameContext(appContext, ns);\n    return frameContext.repository.entityTypeInfo.getBindingPathByTableName(nodeCode);\n  }\n  /**\n   * éè¿ç»å®è·¯å¾åååæ¾å°ææç¬¦åæ¡ä»¶çè§å¾æ¨¡å(åæ¬gridåform)\n   * @param appContext appContext\n   * @param ns namespace\n   * @param bindingPath ç»å®è·¯å¾\n   * @param columnName åå\n   */\n  private getFrameContextsByBindingPathAndColumnName(appContext: AppContext, ns: string, bindingPath: string, columnName: string): FrameContext[] {\n    let frameContexts = appContext.frameContextManager.getFrameContexts();\n    if (frameContexts && frameContexts.length > 0) {\n      // æ¾å°formä¸­ææ§ä»¶çframeContext\n      frameContexts = frameContexts.filter((frameContext: FrameContext) => {\n        // åºæ¬æ¡ä»¶æ¯å¦æ»¡è¶³\n        let isValidFrameContext = frameContext.namespace === ns && frameContext.viewModel.bindingPath === bindingPath && frameContext.viewModel.form && frameContext.viewModel.form.controls && Object.keys(frameContext.viewModel.form.controls).length > 0;\n        if (!isValidFrameContext) {\n          return false;\n        }\n        // åéè¿ååè¿æ»¤\n        const bindingPaths = bindingPath.split('/').filter(p => p);\n        const dataTypeInfo = frameContext.repository.entityTypeInfo.getTypeInfoByPath(bindingPaths);\n        if (dataTypeInfo) {\n          const dataPropInfos = Array.from(dataTypeInfo.propInfoMap.values());\n          // ä»å½åå®ä½å±æ§ä¸­æ¾å°æ°æ®å­æ®µä¸ºååçå±æ§\n          const entityPropertyInfo = dataPropInfos.find((propInfo: DataPropInfo) => propInfo.metadataInfo && (propInfo.metadataInfo.originalDataField === columnName || propInfo.metadataInfo.dataField === columnName));\n          if (entityPropertyInfo) {\n            const entityPropertyName = entityPropertyInfo.name;\n            const ngFormControl = Object.values(frameContext.viewModel.form.ngFormControls).find(item => item.binding === entityPropertyName);\n            if (ngFormControl) {\n              return true;\n            } else {\n              const item = Object.keys(frameContext.viewModel.form.ngFormControls).find(key => key === entityPropertyName);\n              return item ? true : false;\n            }\n          } else {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      });\n      return frameContexts;\n    }\n    return null;\n  }\n  /**\n   * æ¯å¦ä¸ºdatagridç»ä»¶\n   * @param frameComponent component\n   */\n  private isDataGridComponent(frameComponent: FrameComponent) {\n    const columnNames = frameComponent.context.viewModel['dataGridColumnsName'] || null;\n    return columnNames ? true : false;\n  }\n  /**\n   * gridç»ä»¶æ¯å¦æ¯åªè¯»ç\n   * @param frameComponent frameComponent\n   * @returns \n   */\n  private isReadonlyDataGrid(frameComponent: FrameComponent) {\n    const frameContext = frameComponent.context;\n    const dataGridColumnsName = frameContext.viewModel['dataGridColumnsName'] || null;\n    if (dataGridColumnsName) {\n      const datagridColumns: any[] = frameContext.viewModel[dataGridColumnsName];\n      return datagridColumns.every((group: Array<any>) => {\n        return group.every(item => !item.editor);\n      });\n    } else {\n      throw new Error(`ä¼ å¥çç»ä»¶ä¸æ¯ä¸ä¸ªè¡¨æ ¼ï¼`);\n    }\n  }\n  /**\n   * idæ¯å¦ä¸ºå½åè¡\n   * @param appContext appContext\n   * @param ns namespace\n   * @param bindingPath bindingPath\n   * @param id id\n   */\n  private isCurrentRow(appContext: AppContext, ns: string, bindingPath: string, id: string) {\n    const bindingPaths = bindingPath.split('/').filter(p => p);\n    const frameContext = this.getFrameContext(appContext, ns);\n    const bindingData = frameContext.bindingData;\n    const bindingList = bindingData.getValue(bindingPaths) as BindingList;\n    return bindingList.currentItem.primaryKeyValue === id;\n  }\n  /**\n   * è·åå½ånsä¸çrootFrameContext\n   * @param appContext appcontext\n   * @param ns namespace\n   */\n  private getFrameContext(appContext: AppContext, ns: string) {\n    const frameContexts = appContext.frameContextManager.getFrameContexts();\n    if (frameContexts && frameContexts.length > 0) {\n      const randomFrameContext = frameContexts.find(frameContext => frameContext.namespace === ns);\n      if (randomFrameContext) {\n        const virtualRootFrameContext = randomFrameContext.getVirtualRootFrameContext();\n        return virtualRootFrameContext;\n      }\n    }\n    return null;\n  }\n  /**\n   * éè¿ç»å®è·¯å¾åååè·åç»å®å°è¯¥åçformControl\n   */\n  private getFormControlByColumnName(frameContext: FrameContext, columnName: string): Array<[string, NgFormControl]> {\n    const bindingPaths = frameContext.viewModel.bindingPath.split('/').filter(p => p);\n    // éè¿bindingPathæ¾å°å¯¹åºçå®ä½ä¿¡æ¯\n    const typeInfo = frameContext.repository.entityTypeInfo.getTypeInfoByPath(bindingPaths);\n\n    const propsInfo = Array.from(typeInfo.propInfoMap.values());\n    const propInfo = propsInfo.find((propInfo: DataPropInfo) => propInfo.metadataInfo && (propInfo.metadataInfo.originalDataField === columnName || propInfo.metadataInfo.dataField === columnName));\n    if (propInfo) {\n      const mappingName = propInfo.name;\n      const formControls: Array<[string, NgFormControl]> = Object.entries(frameContext.viewModel.form.ngFormControls).filter((item) => item[1].binding === mappingName || item[0] === mappingName);\n      // const ngFormControl = Object.values(frameContext.viewModel.form.ngFormControls).find(item => item.binding === mappingName);\n      if (formControls) {\n        return formControls;\n      }\n    }\n    return null;\n  }\n  private resetFormMessage(appContext: AppContext, ns: string) {\n    const frameContexts = appContext.frameContextManager.getFrameContexts().filter(frameContext => frameContext.namespace === ns);\n    frameContexts.forEach(frameContext => frameContext && frameContext.viewModel && frameContext.viewModel.form && frameContext.viewModel.form.clearBackendError());\n  }\n  /**\n   * éå½æ¾å°å±ç¤ºæ¶æ¯çç»ä»¶ä¸ä¸æ\n   * @param frameContext frameContext\n   */\n  private findTargetFrameContext(frameContext: FrameContext): FrameContext {\n    const virtualRootFrameContext = frameContext.getVirtualRootFrameContext();\n    const virtualRootComponent = virtualRootFrameContext.frameComponent;\n    const isDialogComponent = virtualRootComponent && virtualRootComponent['isDialogRootComponent'] || false;\n    if (isDialogComponent) {\n      // å¦ææ¶æ¯å¤çæå¡æ¯å¼¹çªåçï¼åæ¶æ¯æç¤ºå±ç¤ºå¨å¼¹çªå\n      return virtualRootFrameContext;\n    } else {\n      // å½åæ¶æ¯æå¡ä¸å¨å¼¹çªåï¼éå½åä¸æ¥æ¾ï¼æ¾å°ç¬¬ä¸ä¸ªå¼¹çªï¼å¦ææ¾ä¸å°åæ¾å°æä¸çroot-component\n      const parentFrameContext = virtualRootFrameContext.parent;\n      if (parentFrameContext) {\n        return this.findTargetFrameContext(parentFrameContext);\n      } else {\n        return virtualRootFrameContext;\n      }\n    }\n  }\n}","import { FormLoadingService } from './lib/form-loading/form-loading.service';\nimport { FormMessageService } from './lib/form-message.service';\nimport { HideEventService } from './lib/form-loading/hide-event.service';\nimport { FormNotifyService } from './lib/form-notify.service';\nimport { FormErrorService } from './lib/error/form-error.service';\nimport { FormWizardService } from './lib/form-wizard.service';\n\nimport { CheckService } from './lib/check.service';\nimport { DataCheckService } from './lib/data-check.service';\nimport { EventService } from './lib/event.service';\nimport { MenuStateService } from './lib/menu-state.service';\nimport { RouterService } from './lib/router.service';\nimport { LanguageService } from './lib/languag.service';\nimport { TAB_EVENT, TAB_QUERY_STRING, BodyWithRequestInfo } from './lib/types';\nimport { QuerystringService } from './lib/querystring';\nimport { RuntimeFrameworkService } from './lib/rtf-service';\nimport { NavigationEventService } from './lib/navigation-event.service';\nimport { NavigationService } from './lib/navigation.service';\nimport { NavigationMiddlewareService } from './lib/navigation-middleware.service';\nimport { GridMiddlewareService } from './lib/grid.middleware.service';\nimport { ParamService } from './lib/param.service';\nimport { KeybindingService } from './lib/keybinding-service';\nimport { FilterConditionService } from './lib/filter-condition.service';\n\nimport { UIStateService } from './lib/ui-state.service';\nimport { StateMachineService } from './lib/state-machine.service';\nimport { BindingDataService } from './lib/binding-data.service';\nimport { CommandService } from './lib/command-service';\nimport { ApplicationParamService } from './lib/application-param.service';\nimport {\n  EntityTraversingService, EntityManipulationService, EntityAggregationService,\n  EntityListService, EntityService\n} from './lib/entity-services/index';\nimport { ValidationService } from './lib/validation.service';\nimport { FocusInvalidService, FocusableInvalidationGrid } from './lib/focus-invalid.service';\nimport { ChangeItemService } from './lib/change-item.service';\n\n// data-services\nimport {\n  ListDataService, CardDataService, SubListDataService, TreeDataService,\n  RemoveDataService, SaveDataService, EditDataService, FilterConditionDataService, SubTreeDataService\n} from './lib/data-services/index';\n\nimport { BeActionService } from './lib/be-action.service';\nimport { ApproveService } from './lib/approve.service';\nimport { PrintService } from './lib/print.service';\nimport { AttachmentDataService, AttachmentService, FileService } from './lib/attachment/index';\nimport { DialogService } from './lib/dialog.service';\nimport { SidebarService } from './lib/sidebar-service';\nimport { FarrisFormService, FARRIS_FORM_COMPONENTS } from './lib/farris-form.service';\nimport { FilterService } from './lib/filter-service';\nimport { ComponentManagerService } from './lib/component-manager.service';\nimport { AuthorityService } from './lib/authority/authority.service';\nimport { Authority } from './lib/authority/authority';\n\n// exception_handler\nimport { ExceptionHandler } from './lib/exception.handler';\nimport {\n  FARRIS_COMMAND_SERVICE_PROVIDERS,\n  FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS,\n  FARRIS_COMMAND_SERVICE_FRAME_PROVIDERS,\n  DYNAMIC_FARRIS_COMMAND_SERVICE_PROVIDERS\n} from './lib/providers/index';\nimport { CommandServicesModule } from './lib/command-services-module';\nimport { MessagePipeService, MessagePipe } from './lib/rtf-message/index';\nimport { EndEditService } from './lib/end-edit.service';\nimport { RemoteSummaryService } from './lib/remote-summary.service';\nimport { BatchEditService } from './lib/batch-edit.service';\nimport { DiscussionGroupService } from './lib/discussion-group.service';\nimport { FormManifestService, FormExpressionManifestService } from './lib/manifest/index';\nimport { UserSettingsService } from './lib/user-settings.service';\nimport { LocalizationService } from './lib/localization.service';\nimport { DataGridService } from './lib/data-grid.service';\nimport { BackEndMessageHandler } from './lib/back_end_message_handler';\nimport { FormAttentionService } from './lib/form-attention.service';\nimport { FormNotifyStrategyService } from './lib/form-notify-strategy.service';\nimport { FeatureDataService, FeatureEditService, FeatureRepository } from './lib/feature-edit/index';\nimport { ExpressionService } from './lib/expression_service';\nimport { DirtyCheckingService } from './lib/dirty-checking.service';\nimport { PopUpService } from './lib/pop_up.service';\nimport { WorkFlowMessage, WorkFlowMessageService, WorkFlowMessageHandler, WorkFlow } from './lib/work-flow/index';\nimport { FormControlService } from './lib/form-control.service';\nimport { BindingPathService } from './lib/binding-path.service';\nimport { FrameContextService } from './lib/frame-context.service';\nimport { ViewModelService } from './lib/view-model.service';\nimport { FormService } from './lib/form.service';\nimport { PaginationService } from './lib/pagination.service';\n\nexport {\n  FormLoadingService,\n  FormMessageService,\n  HideEventService,\n  FormNotifyService,\n  FormErrorService,\n  FormWizardService,\n  CheckService,\n  DataCheckService,\n  EventService,\n  MenuStateService,\n  RouterService,\n  LanguageService,\n  TAB_EVENT,\n  TAB_QUERY_STRING,\n  BodyWithRequestInfo,\n  QuerystringService,\n  RuntimeFrameworkService,\n  NavigationEventService,\n  NavigationService,\n  NavigationMiddlewareService,\n  GridMiddlewareService,\n  ParamService,\n  FilterConditionService,\n  FilterConditionDataService,\n\n  // devkit\n  UIStateService,\n  StateMachineService,\n  BindingDataService,\n  CommandService,\n  ValidationService,\n  FocusInvalidService,\n  FocusableInvalidationGrid,\n  ApplicationParamService,\n  ChangeItemService,\n\n  // entity-services\n  EntityTraversingService,\n  EntityManipulationService,\n  EntityAggregationService,\n  EntityListService,\n  EntityService,\n\n  // data-services\n  ListDataService,\n  CardDataService,\n  SubListDataService,\n  TreeDataService,\n  RemoveDataService,\n  SaveDataService,\n  EditDataService,\n  RemoteSummaryService,\n  SubTreeDataService,\n  BeActionService,\n  ApproveService,\n  PrintService,\n  AttachmentDataService,\n  AttachmentService,\n  FileService,\n  DialogService,\n  SidebarService,\n  FilterService,\n  AuthorityService,\n  Authority,\n\n  FarrisFormService,\n  FARRIS_FORM_COMPONENTS,\n  ExceptionHandler,\n  KeybindingService,\n\n  FARRIS_COMMAND_SERVICE_PROVIDERS,\n  FARRIS_COMMAND_SERVICE_MODULE_PROVIDERS,\n  FARRIS_COMMAND_SERVICE_FRAME_PROVIDERS,\n  DYNAMIC_FARRIS_COMMAND_SERVICE_PROVIDERS,\n  CommandServicesModule,\n  ComponentManagerService,\n  MessagePipeService,\n  MessagePipe,\n  EndEditService,\n  BatchEditService,\n  DiscussionGroupService,\n  FormManifestService,\n  FormExpressionManifestService,\n  UserSettingsService,\n  LocalizationService,\n  DataGridService,\n  BackEndMessageHandler,\n  FormAttentionService,\n  FormNotifyStrategyService,\n  FeatureDataService,\n  FeatureEditService,\n  FeatureRepository,\n  ExpressionService,\n  PopUpService,\n  DirtyCheckingService,\n  WorkFlowMessage,\n  WorkFlowMessageService,\n  WorkFlowMessageHandler,\n  WorkFlow,\n  FormControlService,\n  BindingPathService,\n  FrameContextService,\n  ViewModelService,\n  FormService,\n  PaginationService\n};\n\n// export * from './public-api-common';\n// export * from './public-api-extend';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {BaseDataService as Éµa} from './lib/data-services/base-data.service';\nexport {ListFilterConditionsService as Éµc} from './lib/list-filter/list-filter.service';\nexport {QuerySolutionService as Éµb} from './lib/query-solution/query-solution.service';\nexport {Service as Éµd} from './lib/service';"],"names":["tslib_1.__extends","map","tslib_1.__values","of","empty","filter","Mousetrap.default","BindingList","FARRIS_FORM_COMPONENTS"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;;;;;AAKA;IAAA;QAEW,cAAS,GAAG,IAAI,OAAO,EAAO,CAAC;KACzC;;gBAHA,UAAU;;IAGX,uBAAC;CAHD;;ACJA;;;;;;AAMA;;;;;;;;IAqBE,4BACU,cAA8B,EAClB,gBAAkC,EAClC,kBAA8B;QAHpD,iBAYC;QAXS,mBAAc,GAAd,cAAc,CAAgB;QAClB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,uBAAkB,GAAlB,kBAAkB,CAAY;;;;QAb5C,oBAAe,GAAU,EAAE,CAAC;QAelC,IAAI,gBAAgB,EAAE;YACpB,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,SAAS,CACvC,UAAA,MAAM;gBACJ,KAAI,CAAC,IAAI,EAAE,CAAC;aACb,CACF,CAAC;SACH;KACF;IACM,uCAAU,GAAjB,UAAkB,IAAa;QAC7B,kBAAkB,CAAC,SAAS,GAAG,IAAI,CAAC;KACrC;;;;IAIM,iCAAI,GAAX,UAAY,eAAqB;QAC/B,IAAI,kBAAkB,CAAC,SAAS,KAAK,IAAI,EAAE;YACzC,OAAO;SACR;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;YACxB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;SACxB;QACD,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,CAAC;QAC/D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAC1D,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;;;;IAKM,iDAAoB,GAA3B,UAA4B,SAAiB,EAAE,eAAqB;QAApE,iBAQC;;QANC,IAAM,OAAO,GAAG,UAAU,CAAC;YACzB,KAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SAC5B,EAAE,SAAS,CAAC,CAAC;QACd,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACnC,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,OAAO,OAAO,CAAC;KAChB;;;;IAKM,6CAAgB,GAAvB,UAAwB,cAAmB;QACzC,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC;QACvC,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;;;;;IAMO,+CAAkB,GAA1B,UAA2B,eAAoB;QAC7C,IAAI,aAA4B,CAAC;QACjC,IAAI,CAAC,CAAC,eAAe,EAAE;YACrB,IAAI,OAAO,eAAe,KAAK,QAAQ,EAAE;gBACvC,aAAa,GAAG,eAAe,CAAC;aACjC;iBAAM;gBACL,aAAa,GAAG,EAAE,SAAS,EAAE,eAAe,EAAE,CAAC;aAChD;SACF;aAAM;YACL,aAAa,GAAG,EAAE,CAAC;SACpB;QACD,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;YAC1C,aAAa,CAAC,KAAK,GAAG,CAAC,CAAC;SACzB;QACD,OAAO,aAAa,CAAC;KACtB;;;;IAKM,qCAAQ,GAAf;QAAA,iBAQC;QAPC,kBAAkB,CAAC,SAAS,GAAG,KAAK,CAAC;QACrC,MAAM,CAAC,UAAU,CAAC;YAChB,KAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;SAChC,EAAE,GAAG,CAAC,CAAC;QACR,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,IAAI,CAAC,OAAO,EAAE,CAAC;KAChB;;;;IAKO,8CAAiB,GAAzB,UAA0B,cAAmB;QAC3C,YAAY,CAAC,cAAc,CAAC,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,UAAC,OAAY;YAC9D,OAAO,OAAO,KAAK,cAAc,CAAC;SACnC,CAAC,CAAC;KACJ;;;;IAKO,kDAAqB,GAA7B;QAAA,iBAIC;QAHC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,UAAC,OAAY;YACxC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;SACjC,CAAC,CAAC;KACJ;;;;IAKM,iCAAI,GAAX;QACE,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,OAAO;SACR;QACD,IAAI,kBAAkB,CAAC,SAAS,KAAK,IAAI,EAAE;YACzC,OAAO;SACR;QACD,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;QACxB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,OAAO,EAAE,CAAC;KAChB;;;;IAIM,oCAAO,GAAd;QACE,IAAI,kBAAkB,CAAC,SAAS,KAAK,IAAI,EAAE;YACzC,OAAO;SACR;QACD,IAAM,QAAQ,GAAU,MAAM,CAAC,wBAAwB,CAAC,IAAI,EAAE,CAAC;QAC/D,IAAI,QAAQ,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9D,QAAQ,CAAC,OAAO,CAAC,UAAC,OAA2B;gBAC3C,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,qBAAqB,EAAE,CAAC;oBAChC,IAAI,OAAO,CAAC,UAAU,EAAE;wBACtB,OAAO,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;wBAC3B,OAAO,CAAC,UAAU,GAAG,IAAI,CAAC;qBAC7B;iBACA;aACF,CAAC,CAAC;SACJ;QACD,MAAM,CAAC,wBAAwB,CAAC,GAAG,EAAE,CAAC;KACvC;;;;IAKO,4CAAe,GAAvB;QACE,IAAM,QAAQ,GAAU,MAAM,CAAC,wBAAwB,CAAC,IAAI,EAAE,CAAC;QAC/D,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpB,MAAM,CAAC,wBAAwB,CAAC,GAAG,QAAQ,CAAC;KAC7C;IA1Kc,4BAAS,GAAG,KAAK,CAAC;;gBAFlC,UAAU;;;;gBATF,cAAc;gBACd,gBAAgB,uBA+BpB,QAAQ;gBA9BJ,UAAU,uBA+Bd,QAAQ;;IAqJb,yBAAC;CA7KD;;ACPA;;;AAGA;IAAA;QACE,QAAG,GAAG,KAAK,CAAC;QACZ,OAAE,GAAG,IAAI,CAAC;QACV,sBAAiB,GAAG,gDAAgD,CAAC;QACrE,sBAAiB,GAAG,+BAA+B,CAAC;QACpD,sBAAiB,GAAG,8BAA8B,CAAC;QACnD,yBAAoB,GAAG,wBAAwB,CAAC;QAChD,wBAAmB,GAAG,uBAAuB,CAAC;QAC9C,oCAA+B,GAAG,wCAAwC,CAAC;QAC3E,0BAAqB,GAAG,8BAA8B,CAAC;QACvD,+BAA0B,GAAG,oCAAoC,CAAC;QAClE,sBAAiB,GAAG,8BAA8B,CAAC;QACnD,sBAAiB,GAAG,sCAAsC,CAAC;QAC3D,mBAAc,GAAG,kBAAkB,CAAC;QACpC,qBAAgB,GAAG,oBAAoB,CAAC;QACxC,sBAAiB,GAAG,sBAAsB,CAAC;QAC3C,wBAAmB,GAAG,wBAAwB,CAAC;QAC/C,iBAAY,GAAG,eAAe,CAAC;QAC/B,oBAAe,GAAG,kBAAkB,CAAC;QACrC,iBAAY,GAAG,eAAe,CAAC;QAC/B,gBAAW,GAAG,cAAc,CAAC;QAC7B,iBAAY,GAAG,eAAe,CAAC;QAC/B,iBAAY,GAAG,eAAe,CAAC;QAC/B,cAAS,GAAG,YAAY,CAAC;QACzB,eAAU,GAAG,aAAa,CAAC;QAC3B,gBAAW,GAAG,qBAAqB,CAAC;QACpC,eAAU,GAAG,cAAc,CAAC;QAC5B,kBAAa,GAAG,uBAAuB,CAAC;QACxC,gBAAW,GAAG,mBAAmB,CAAC;QAClC,oBAAe,GAAG,mBAAmB,CAAC;QACtC,kBAAa,GAAG,sBAAsB,CAAC;QACvC,gBAAW,GAAG,gBAAgB,CAAC;QAC/B,gBAAW,GAAG,eAAe,CAAC;QAC9B,cAAS,GAAG,oDAAoD,CAAC;QACjE,oBAAe,GAAG,0HAA0H,CAAC;QAC7I,oBAAe,GAAG,yDAAyD,CAAC;QAC5E,uBAAkB,GAAG,0BAA0B,CAAC;QAChD,sBAAiB,GAAG,yCAAyC,CAAC;QAC9D,wBAAmB,GAAG,mCAAmC,CAAC;QAC1D,sBAAiB,GAAG,wBAAwB,CAAC;QAC7C,wBAAmB,GAAG,4BAA4B,CAAC;QACnD,qBAAgB,GAAG,sCAAsC,CAAC;QAC1D,6BAAwB,GAAG,gCAAgC,CAAC;QAC5D,oBAAe,GAAG,uBAAuB,CAAC;QAC1C,sBAAiB,GAAG,0CAA0C,CAAC;QAC/D,sBAAiB,GAAG,0CAA0C,CAAC;QAC/D,mBAAc,GAAG,iCAAiC,CAAC;QACnD,uBAAkB,GAAG,QAAQ,CAAC;QACvB,kBAAa,GAAG,iBAAiB,CAAC;QAClC,iBAAY,GAAG,gBAAgB,CAAC;QAChC,wBAAmB,GAAG,yCAAyC,CAAC;QAChE,gBAAW,GAAG,+CAA+C,CAAC;QAC9D,iBAAY,GAAG,sCAAsC,CAAC;QACtD,YAAO,GAAG,SAAS,CAAC;QACpB,WAAM,GAAG,QAAQ,CAAC;QAClB,sBAAiB,GAAG,0CAA0C,CAAC;QAC/D,uBAAkB,GAAG,iCAAiC,CAAC;QACvD,mBAAc,GAAG,iCAAiC,CAAC;QACnD,iBAAY,GAAG,4BAA4B,CAAC;QAC5C,sBAAiB,GAAG,yCAAyC,CAAC;QAC9D,yBAAoB,GAAG,oDAAoD,CAAC;QAC5E,kBAAa,GAAG,uCAAuC,CAAC;QACxD,0BAAqB,GAAG,yCAAyC,CAAC;QAClE,4BAAuB,GAAG,yCAAyC,CAAC;QACpE,wBAAmB,GAAG,oEAAoE,CAAC;QAC3F,gBAAW,GAAG,+EAA+E,CAAC;QAC9F,iBAAY,GAAG,2CAA2C,CAAC;QAC3D,qBAAgB,GAAG,MAAM,CAAC;QAC1B,SAAI,GAAG,qBAAqB,CAAC;QAC7B,gBAAW,GAAG,cAAc,CAAC;QAC7B,eAAU,GAAG,aAAa,CAAC;QAC3B,UAAK,GAAG,OAAO,CAAC;QAChB,wBAAmB,GAAG,0FAA0F,CAAC;QACjH,qBAAgB,GAAG,gBAAgB,CAAC;KAC5C;IAAD,2BAAC;CAAA,IAAA;;AC9ED;;;AAGA;IAAA;QACS,QAAG,GAAG,GAAG,CAAC;QACV,OAAE,GAAG,GAAG,CAAC;QACT,sBAAiB,GAAG,gBAAgB,CAAC;QACrC,sBAAiB,GAAG,QAAQ,CAAC;QAC7B,sBAAiB,GAAG,UAAU,CAAC;QAC/B,yBAAoB,GAAG,SAAS,CAAC;QACjC,wBAAmB,GAAG,SAAS,CAAC;QAChC,oCAA+B,GAAG,YAAY,CAAC;QAC/C,0BAAqB,GAAG,SAAS,CAAC;QAClC,sBAAiB,GAAG,UAAU,CAAC;QAC/B,+BAA0B,GAAG,eAAe,CAAC;QAC7C,sBAAiB,GAAG,aAAa,CAAC;QAClC,mBAAc,GAAG,QAAQ,CAAC;QAC1B,qBAAgB,GAAG,QAAQ,CAAC;QAC5B,sBAAiB,GAAG,UAAU,CAAC;QAC/B,wBAAmB,GAAG,UAAU,CAAC;QACjC,iBAAY,GAAG,MAAM,CAAC;QACtB,oBAAe,GAAG,QAAQ,CAAC;QAC3B,iBAAY,GAAG,MAAM,CAAC;QACtB,gBAAW,GAAG,MAAM,CAAC;QACrB,iBAAY,GAAG,MAAM,CAAC;QACtB,iBAAY,GAAG,MAAM,CAAC;QACtB,cAAS,GAAG,MAAM,CAAC;QACnB,eAAU,GAAG,MAAM,CAAC;QACpB,gBAAW,GAAG,OAAO,CAAC;QACtB,eAAU,GAAG,OAAO,CAAC;QACrB,kBAAa,GAAG,OAAO,CAAC;QACxB,gBAAW,GAAG,OAAO,CAAC;QACtB,oBAAe,GAAG,OAAO,CAAC;QAC1B,kBAAa,GAAG,SAAS,CAAC;QAC1B,gBAAW,GAAG,SAAS,CAAC;QACxB,gBAAW,GAAG,MAAM,CAAC;QACrB,cAAS,GAAG,wBAAwB,CAAC;QACrC,oBAAe,GAAG,4BAA4B,CAAC;QAC/C,oBAAe,GAAG,kBAAkB,CAAC;QACrC,uBAAkB,GAAG,gBAAgB,CAAC;QACtC,sBAAiB,GAAG,gBAAgB,CAAC;QACrC,wBAAmB,GAAG,YAAY,CAAC;QACnC,sBAAiB,GAAG,QAAQ,CAAC;QAC7B,wBAAmB,GAAG,QAAQ,CAAC;QAC/B,qBAAgB,GAAG,SAAS,CAAC;QAC7B,6BAAwB,GAAG,WAAW,CAAC;QACvC,oBAAe,GAAG,SAAS,CAAC;QAC5B,sBAAiB,GAAG,YAAY,CAAC;QACjC,sBAAiB,GAAG,YAAY,CAAC;QACjC,mBAAc,GAAG,SAAS,CAAC;QAC3B,uBAAkB,GAAG,IAAI,CAAC;QAC1B,kBAAa,GAAG,UAAU,CAAC;QAC3B,iBAAY,GAAG,WAAW,CAAC;QAC3B,wBAAmB,GAAG,YAAY,CAAC;QACnC,gBAAW,GAAG,qBAAqB,CAAC;QACpC,iBAAY,GAAG,YAAY,CAAC;QAC5B,YAAO,GAAG,IAAI,CAAC;QACf,WAAM,GAAG,IAAI,CAAC;QACd,sBAAiB,GAAG,YAAY,CAAC;QACjC,uBAAkB,GAAG,aAAa,CAAC;QACnC,mBAAc,GAAG,WAAW,CAAC;QAC7B,iBAAY,GAAG,cAAc,CAAC;QAC9B,sBAAiB,GAAG,aAAa,CAAC;QAClC,yBAAoB,GAAG,YAAY,CAAC;QACpC,kBAAa,GAAG,YAAY,CAAA;QAC5B,0BAAqB,GAAG,aAAa,CAAC;QACtC,4BAAuB,GAAG,aAAa,CAAC;QACxC,wBAAmB,GAAG,kBAAkB,CAAC;QACzC,gBAAW,GAAG,iBAAiB,CAAC;QAChC,iBAAY,GAAG,aAAa,CAAC;QAC7B,qBAAgB,GAAG,IAAI,CAAC;QACxB,SAAI,GAAG,QAAQ,CAAC;QAChB,gBAAW,GAAG,MAAM,CAAC;QACrB,eAAU,GAAG,MAAM,CAAC;QACpB,UAAK,GAAG,KAAK,CAAC;QACd,wBAAmB,GAAG,sBAAsB,CAAC;QAC7C,qBAAgB,GAAG,OAAO,CAAC;KACnC;IAAD,2BAAC;CAAA,IAAA;;AC7ED;;;AAGA;IAAA;QACS,QAAG,GAAG,GAAG,CAAC;QACV,OAAE,GAAG,GAAG,CAAC;QACT,sBAAiB,GAAG,gBAAgB,CAAC;QACrC,sBAAiB,GAAG,QAAQ,CAAC;QAC7B,sBAAiB,GAAG,UAAU,CAAC;QAC/B,yBAAoB,GAAG,SAAS,CAAC;QACjC,wBAAmB,GAAG,SAAS,CAAC;QAChC,oCAA+B,GAAG,YAAY,CAAC;QAC/C,0BAAqB,GAAG,SAAS,CAAC;QAClC,sBAAiB,GAAG,UAAU,CAAC;QAC/B,+BAA0B,GAAG,eAAe,CAAC;QAC7C,sBAAiB,GAAG,aAAa,CAAC;QAClC,mBAAc,GAAG,QAAQ,CAAC;QAC1B,qBAAgB,GAAG,QAAQ,CAAC;QAC5B,sBAAiB,GAAG,UAAU,CAAC;QAC/B,wBAAmB,GAAG,UAAU,CAAC;QACjC,iBAAY,GAAG,MAAM,CAAC;QACtB,oBAAe,GAAG,QAAQ,CAAC;QAC3B,iBAAY,GAAG,MAAM,CAAC;QACtB,gBAAW,GAAG,MAAM,CAAC;QACrB,iBAAY,GAAG,MAAM,CAAC;QACtB,iBAAY,GAAG,MAAM,CAAC;QACtB,cAAS,GAAG,MAAM,CAAC;QACnB,eAAU,GAAG,MAAM,CAAC;QACpB,gBAAW,GAAG,OAAO,CAAC;QACtB,eAAU,GAAG,OAAO,CAAC;QACrB,kBAAa,GAAG,OAAO,CAAC;QACxB,gBAAW,GAAG,OAAO,CAAC;QACtB,oBAAe,GAAG,OAAO,CAAC;QAC1B,kBAAa,GAAG,SAAS,CAAC;QAC1B,gBAAW,GAAG,SAAS,CAAC;QACxB,gBAAW,GAAG,MAAM,CAAC;QACrB,cAAS,GAAG,wBAAwB,CAAC;QACrC,oBAAe,GAAG,4BAA4B,CAAC;QAC/C,oBAAe,GAAG,kBAAkB,CAAC;QACrC,uBAAkB,GAAG,gBAAgB,CAAC;QACtC,sBAAiB,GAAG,gBAAgB,CAAC;QACrC,wBAAmB,GAAG,YAAY,CAAC;QACnC,sBAAiB,GAAG,QAAQ,CAAC;QAC7B,wBAAmB,GAAG,QAAQ,CAAC;QAC/B,qBAAgB,GAAG,SAAS,CAAC;QAC7B,6BAAwB,GAAG,WAAW,CAAC;QACvC,oBAAe,GAAG,SAAS,CAAC;QAC5B,sBAAiB,GAAG,YAAY,CAAC;QACjC,sBAAiB,GAAG,YAAY,CAAC;QACjC,mBAAc,GAAG,SAAS,CAAC;QAC3B,uBAAkB,GAAG,IAAI,CAAC;QAC1B,kBAAa,GAAG,UAAU,CAAC;QAC3B,iBAAY,GAAG,WAAW,CAAC;QAC3B,wBAAmB,GAAG,YAAY,CAAC;QACnC,gBAAW,GAAG,qBAAqB,CAAC;QACpC,iBAAY,GAAG,YAAY,CAAC;QAC5B,YAAO,GAAG,IAAI,CAAC;QACf,WAAM,GAAG,IAAI,CAAC;QACd,sBAAiB,GAAG,YAAY,CAAC;QACjC,uBAAkB,GAAG,aAAa,CAAC;QACnC,mBAAc,GAAG,WAAW,CAAC;QAC7B,iBAAY,GAAG,cAAc,CAAC;QAC9B,sBAAiB,GAAG,aAAa,CAAC;QAClC,yBAAoB,GAAG,YAAY,CAAC;QACpC,kBAAa,GAAG,YAAY,CAAC;QAC7B,0BAAqB,GAAG,aAAa,CAAC;QACtC,4BAAuB,GAAG,aAAa,CAAC;QACxC,wBAAmB,GAAG,kBAAkB,CAAC;QACzC,gBAAW,GAAG,iBAAiB,CAAC;QAChC,iBAAY,GAAG,aAAa,CAAC;QAC7B,qBAAgB,GAAG,IAAI,CAAC;QACxB,SAAI,GAAG,QAAQ,CAAC;QAChB,gBAAW,GAAG,MAAM,CAAC;QACrB,eAAU,GAAG,MAAM,CAAC;QACpB,UAAK,GAAG,KAAK,CAAC;QACd,wBAAmB,GAAG,sBAAsB,CAAC;QAC7C,qBAAgB,GAAG,OAAO,CAAC;KACnC;IAAD,6BAAC;CAAA,IAAA;;AC3ED;IAAA;KA+BC;;;;IAxBe,6BAAM,GAApB,UAAqB,QAAgB;QACnC,IAAI,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,IAAI,EAAE;YAClD,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SAC9C;QAED,IAAI,eAAgC,CAAC;QACrC,QAAQ,QAAQ;YACd,KAAK,QAAQ;gBACX,eAAe,GAAG,IAAI,oBAAoB,EAAE,CAAC;gBAC7C,MAAM;YACR,KAAK,IAAI;gBACP,eAAe,GAAG,IAAI,oBAAoB,EAAE,CAAC;gBAC7C,MAAM;YACR,KAAK,QAAQ;gBACX,eAAe,GAAG,IAAI,sBAAsB,EAAE,CAAC;gBAC/C,MAAM;YACR;gBACE,eAAe,GAAG,IAAI,oBAAoB,EAAE,CAAC;gBAC7C,MAAM;SACT;QACD,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;QAEvD,OAAO,eAAe,CAAC;KACxB;IA5Bc,yCAAkB,GAAiC,IAAI,GAAG,EAA2B,CAAC;IA6BvG,6BAAC;CA/BD,IA+BC;;AC/BD;;;;AAIA;;;;IAmGE,yBAA2C,QAAiB;;;;;QAZlD,aAAQ,GAAG,QAAQ,CAAC;QAa5B,IAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI,QAAQ,CAAC;QACrC,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,eAAe,CAAC,aAAa,GAAG,IAAI,CAAC;KACtC;IAXD,sBAAc,4CAAe;;;;aAA7B;YACE,OAAO,sBAAsB,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACrD;;;OAAA;;;;IAca,2BAAW,GAAzB;QACE,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;QACD,IAAM,QAAQ,GAAG,IAAI,eAAe,CAAC,QAAQ,CAAC,CAAC;QAC/C,eAAe,CAAC,aAAa,GAAG,QAAQ,CAAC;QACzC,OAAO,QAAQ,CAAC;KACjB;;;;IAKO,0CAAgB,GAAxB;QAAA,iBAQC;QAPC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,UAAC,QAAgB;YACzD,MAAM,CAAC,cAAc,CAAC,KAAI,EAAE,QAAQ,EAAE;gBACpC,GAAG,EAAE;oBACH,OAAO,KAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;iBACvC;aACF,CAAC,CAAC;SACJ,CAAC,CAAC;KACJ;;;;IA1Hc,6BAAa,GAAoB,IAAI,CAAC;;gBANtD,UAAU;;;;6CAmGI,QAAQ,YAAI,MAAM,SAAC,SAAS;;IA8B3C,sBAAC;CAjID;;ACPA;;GAEG;;ACHH;IAAA;KAyBC;;;;;;IAnBe,6BAAe,GAA7B,UAA8B,IAAI;QAChC,IAAM,SAAS,GAAQ,MAAM,CAAC;QAC9B,IAAI,SAAS,CAAC,aAAa,IAAI,SAAS,CAAC,aAAa,CAAC,OAAO,EAAE;YAC9D,OAAO,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;SACtD;aAAM,IAAI,QAAQ,CAAC,qBAAqB,IAAI,QAAQ,CAAC,qBAAqB,CAAC,MAAM,CAAC,EAAE;YACnF,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YAClD,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC;YAC5B,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;YAClC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACpC,QAAQ,CAAC,MAAM,EAAE,CAAC;YAClB,IAAI;gBACF,OAAO,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aACrC;YAAC,OAAO,EAAE,EAAE;aACZ;oBAAS;gBACR,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;aACrC;SACF;QACD,OAAO,KAAK,CAAC;KACd;IACH,oBAAC;CAAA,IAAA;;ACPD;;;AAGA;IACE,2BACS,eAAgC,EACpB,eAAgC;QAD5C,oBAAe,GAAf,eAAe,CAAiB;QACpB,oBAAe,GAAf,eAAe,CAAiB;KACpD;;;gBAvBM,eAAe;gBACf,eAAe,uBAqBnB,QAAQ;;IAEb,wBAAC;CALD,IAKC;AAED;;;AAGA;IAA2CA,yCAAiB;IAC1D,+BACE,eAAgC,EACpB,eAAgC;eAC5C,kBAAM,eAAe,EAAE,eAAe,CAAC;KACxC;IAEM,+CAAe,GAAtB,UAAuB,KAA4B;QACjD,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KAC1C;;;gBA1CM,eAAe;gBACf,eAAe,uBA+BnB,QAAQ;;IAWb,4BAAC;CAAA,CAd0C,iBAAiB,GAc3D;AAGD;;;AAGA;IAA8CA,4CAAiB;IAC7D,kCACE,eAAgC,EACpB,eAAgC;eAC5C,kBAAM,eAAe,EAAE,eAAe,CAAC;KACxC;IAEM,kDAAe,GAAtB,UAAuB,KAA4B;QACjD,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KAC7C;;;gBA9DM,eAAe;gBACf,eAAe,uBAmDnB,QAAQ;;IAWb,+BAAC;CAAA,CAd6C,iBAAiB,GAc9D;AAGD;;;AAGA;IAA4CA,0CAAiB;IAE3D,gCACE,eAAgC,EACpB,eAAgC;QAF9C,YAGE,kBAAM,eAAe,EAAE,eAAe,CAAC,SAMxC;QAVO,iBAAW,GAAoB,IAAI,CAAC;QAK1C,KAAI,CAAC,WAAW,GAAG,eAAe,CAAC;QACnC,IAAI,CAAC,KAAI,CAAC,WAAW,EAAE;YACrB,KAAI,CAAC,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;SAC1C;;KAEF;IAEM,gDAAe,GAAtB,UAAuB,KAA4B;QACjD,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;KAC9B;IAEO,iDAAgB,GAAxB,UAAyB,KAA4B;QAArD,iBAuCC;QAtCC,IAAM,YAAY,GAAG,KAAK,CAAC,OAAO,IAAI,EAAE,CAAC;QACzC,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,EAAE,CAAC;QACtC,IAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;QAC7D,IAAM,MAAM,GAAG,KAAK,CAAC,MAAM,IAAO,KAAK,CAAC,OAAO,0CAAY,SAAS,0CAAY,KAAK,CAAC,YAAc,IAAI,EAAE,CAAC;QAE3G,IAAM,YAAY,GAAG,KAAK,CAAC,YAAY,IAAI,IAAI,CAAC;QAChD,IAAI,UAAsB,CAAC;QAC3B,IAAM,OAAO,GAAG;;YAEd,aAAa,EAAE,KAAK;YACpB,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK;oBAC5B,GAAG,EAAE,wBAAwB;oBAC7B,MAAM,EAAE;wBACN,UAAU,CAAC,KAAK,EAAE,CAAC;qBACpB;iBACF;aACF;;YAED,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;YACX,QAAQ,EAAE,KAAK;YACf,SAAS,EAAE;gBACT,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,YAAY;gBACrB,UAAU,EAAE;oBACV,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI;oBAC3B,OAAO,EAAE,UAAC,CAAC;wBACT,IAAM,MAAM,GAAG,aAAa,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;wBACrD,IAAM,IAAI,GAAG,MAAM,GAAG,KAAI,CAAC,WAAW,CAAC,WAAW,GAAG,KAAI,CAAC,WAAW,CAAC,UAAU,CAAC;wBACjF,UAAU,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;qBAC/C;iBACF;aACF;SACF,CAAC;QACF,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QACzB,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;KAC5E;;;;IAIO,6CAAY,GAApB,UAAqB,KAA4B;QAC/C,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QACD,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;YAC9B,OAAO;SACR;QACD,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;KACtB;;;gBA7IM,eAAe;gBACf,eAAe,uBAwEnB,QAAQ;;IAqEb,6BAAC;CAAA,CAzE2C,iBAAiB,GAyE5D;AAED;;;AAGA;IAA4CA,0CAAiB;IAC3D,gCACE,eAAgC,EACpB,eAAgC;eAC5C,kBAAM,eAAe,EAAE,eAAe,CAAC;KACxC;IAEM,gDAAe,GAAtB,UAAuB,KAA4B;QACjD,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KAC3C;;;gBAhKM,eAAe;gBACf,eAAe,uBAqJnB,QAAQ;;IAWb,6BAAC;CAAA,CAd2C,iBAAiB,GAc5D;;AC1JD;;;;;;IAaE,0BACS,eAAgC,EACnB,eAAgC;QAD7C,oBAAe,GAAf,eAAe,CAAiB;QACnB,oBAAe,GAAf,eAAe,CAAiB;KAGrD;;;;;;IAOa,4BAAW,GAAzB,UAA0B,eAAgC,EAAE,eAAgC;QAC1F,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAI,gBAAgB,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;SAChF;QAED,OAAO,IAAI,CAAC,gBAAgB,CAAC;KAC9B;;;;;IAMM,qDAA0B,GAAjC,UAAkC,cAA8B;QAC9D,IAAI,iBAAqC,CAAC;QAE1C,QAAQ,cAAc;YACpB;gBACE,iBAAiB,GAAG,IAAI,qBAAqB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;gBAC1F,MAAM;YACR;gBACE,iBAAiB,GAAG,IAAI,wBAAwB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;gBAC7F,MAAM;YACR;gBACE,iBAAiB,GAAG,IAAI,sBAAsB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;gBAC3F,MAAM;YACR;gBACE,iBAAiB,GAAG,IAAI,sBAAsB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;gBAC3F,MAAM;YACR;;gBAGE,iBAAiB,GAAG,IAAI,sBAAsB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;gBAC3F,MAAM;SACT;QAED,OAAO,iBAAiB,CAAC;KAC1B;;;;IAvDc,iCAAgB,GAAqB,IAAI,CAAC;;gBAN1D,UAAU;;;;gBARF,eAAe;gBACf,eAAe,uBAsBnB,QAAQ;;IA+Cb,uBAAC;CA9DD,IA8DC;;ACvED;AACA,IAAK,cAMJ;AAND,WAAK,cAAc;IACf,mDAAQ,CAAA;IACR,yDAAO,CAAA;IACP,2DAAQ,CAAA;IACR,iEAAW,CAAA;IACX,iEAAW,CAAA;CACd,EANI,cAAc,KAAd,cAAc,QAMlB;;;;AAKD;IAAA;KA8BC;;;;;;IAvBiB,0BAAiB,GAA/B,UAAgC,iBAAyB;QACrD,IAAI,CAAC,iBAAiB,EAAE;YACpB,OAAO,IAAI,CAAC;SACf;QAED,IAAI,UAAU,GAAG,IAAI,CAAC;QAEtB,IAAI,iBAAiB,GAAG,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YACpD,UAAU,GAAG,IAAI,CAAC;SACrB;aAAM,IAAI,iBAAiB,IAAI,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YAC5D,UAAU,GAAG,cAAc,CAAC,IAAI,CAAC;SACpC;aAAM,IAAI,iBAAiB,IAAI,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YAC5D,UAAU,GAAG,cAAc,CAAC,OAAO,CAAC;SACvC;aAAM,IAAI,iBAAiB,IAAI,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YAC5D,UAAU,GAAG,cAAc,CAAC,QAAQ,CAAC;SACxC;aAAM,IAAI,iBAAiB,IAAI,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YAC5D,UAAU,GAAG,cAAc,CAAC,WAAW,CAAC;SAC3C;aAAM,IAAI,iBAAiB,IAAI,GAAG,IAAI,iBAAiB,GAAG,GAAG,EAAE;YAC5D,UAAU,GAAG,cAAc,CAAC,WAAW,CAAC;SAC3C;QAED,OAAO,UAAU,CAAC;KACrB;IACL,eAAC;CAAA,IAAA;;ACnCD;;;;AAIA;IAGE,0BACU,UAA8B,EAClB,eAAgC;QAD5C,eAAU,GAAV,UAAU,CAAoB;QAClB,oBAAe,GAAf,eAAe,CAAiB;KAErD;;;;IAKM,oCAAS,GAAhB,UAAiB,OAAe,EAAE,KAAU;;QAE1C,IAAI,KAAK,IAAI,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,KAAK,IAAI,EAAE;YACzE,OAAO;SACR;QACD,IAAI,KAAK,IAAI,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,EAAE;YAC5C,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;SAC9B;aAAM;;YAGL,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;SAClC;KACF;;;;IAKM,2CAAgB,GAAvB,UAAwB,SAA4B;QAClD,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QAED,IAAM,UAAU,GAAG,QAAQ,CAAC,iBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAEhE,QAAQ,UAAU;YAChB,KAAK,cAAc,CAAC,WAAW;gBAC7B,IAAI,SAAS,CAAC,MAAM,KAAK,GAAG,EAAE;oBAC5B,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;oBACxC,MAAM;iBACP;gBAED,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAC7C,MAAM;YACR,KAAK,cAAc,CAAC,WAAW;gBAC7B,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAC7C,MAAM;YACR;gBACE,MAAM,IAAI,KAAK,CAAC,6DAA6D,CAAC,CAAC;SAClF;KACF;IAEO,6CAAkB,GAA1B,UAA2B,QAAgB;QACzC,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO;SACR;QACD,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;KACjC;;;;;IAKO,8CAAmB,GAA3B,UAA4B,KAAK;QAC/B,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,OAAO,KAAK,CAAC;SACd;QACD,IAAI,KAAK,CAAC,IAAI,KAAK,mBAAmB,IAAI,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;YACzG,OAAO,IAAI,CAAC;SACb;QACD,IAAI,KAAK,YAAY,iBAAiB,EAAE;YACtC,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;KACd;;gBA7EF,UAAU;;;;gBARF,kBAAkB;gBAClB,eAAe,uBAYnB,QAAQ;;IAyEb,uBAAC;CA9ED;;ACFA;;;;;;;AAOA;;;;;IAOE,4BACU,eAAgC,EACpB,eAAgC,EACzB,WAAmB;QAFtC,oBAAe,GAAf,eAAe,CAAiB;QACpB,oBAAe,GAAf,eAAe,CAAiB;QACzB,gBAAW,GAAX,WAAW,CAAQ;QAE9C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,IAAI,eAAe,CAAC,WAAW,EAAE,CAAC;KAC9E;;;;IAIM,qCAAQ,GAAf,UAAgB,OAAe;QAC7B,IAAM,cAAc,GAAqB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QACtE,OAAO,IAAI,CAAC,cAAc,CAAC,CAAC;KAC7B;;;;;IAMM,sCAAS,GAAhB,UAAiB,OAAe;QAAhC,iBAyBC;QAxBC,IAAM,QAAQ,GAAqB,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC7D,IAAM,SAAS,GAAG,KAAI,CAAC,eAAe,CAAC,SAAS,CAC9C,OAAO,EACP;gBACE;oBACE,IAAI,EAAE,KAAI,CAAC,eAAe,CAAC,EAAE;oBAC7B,GAAG,EAAE,mBAAmB;oBACxB,MAAM,EAAE;wBACN,OAAO,CAAC,KAAK,CAAC,CAAC;wBACf,SAAS,CAAC,KAAK,EAAE,CAAC;qBACnB;iBACF;gBACD;oBACE,IAAI,EAAE,KAAI,CAAC,eAAe,CAAC,GAAG;oBAC9B,GAAG,EAAE,iBAAiB;oBACtB,YAAY,EAAE,IAAI;oBAClB,MAAM,EAAE;wBACN,OAAO,CAAC,IAAI,CAAC,CAAC;wBACd,SAAS,CAAC,KAAK,EAAE,CAAC;qBACnB;iBACF;aACF,CAAC,CAAC;SACN,CAAC,CAAC;QACH,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC;KACvB;;;;;IAMM,mCAAM,GAAb,UAAc,KAAa;QACzB,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;KAC3C;;;;;IAMO,2CAAc,GAAtB,UAAuB,OAAe;QAAtC,iBAQC;QAPC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,KAAI,CAAC,eAAe,CAAC,QAAQ,CAC3B,OAAO,EACP,cAAQ,OAAO,CAAC,IAAI,CAAC,CAAC,EAAE,EACxB,cAAQ,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAC1B,CAAC;SACH,CAAC,CAAC;KACJ;;;;;IAMM,oCAAO,GAAd,UAAe,OAAe;QAC5B,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;KAC9C;;;;IAKM,iCAAI,GAAX,UAAY,OAAe;QACzB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACpC;;;;IAKM,kCAAK,GAAZ,UAAa,OAAe;QAC1B,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KACrC;;;;IAKM,oCAAO,GAAd,UAAe,OAAe;QAC5B,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;KACvC;;;;IAKM,8CAAiB,GAAxB,UAAyB,SAA4B;QACnD,IAAI,KAAK,GAA0B,SAAS,CAAC,KAAK,CAAC;QACnD,IAAI,QAAQ,KAAK,CAAC,KAAK,QAAQ,EAAE;YAC/B,IAAI;gBACF,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAC3B;YAAC,OAAO,CAAC,EAAE,GAAG;SAChB;QACD,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,IAAI,IAAI,IAAI,KAAK,CAAC,KAAK,IAAI,SAAS,EAAE;YAC7D,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YAC9C,OAAO;SACR;QACD,IAAM,iBAAiB,GAAuB,gBAAgB,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC,0BAA0B,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC/J,iBAAiB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;KAC1C;;;;IAKM,8CAAiB,GAAxB,UAAyB,SAA4B;QACnD,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QACD,IAAM,OAAO,GAAG,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,KAAK,CAAC,KAAK,IAAI,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC;QAC1F,IAAM,YAAY,GAAG,OAAO,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,4BAA4B,EAAE,EAAE,CAAC,CAAC;QACjH,IAAM,OAAO,GAAG;;;YAGd,UAAU,EAAE,KAAK;YACjB,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;YACX,QAAQ,EAAE,KAAK;SAChB,CAAC;QAEF,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;KAC3D;;;;;;IAOM,yCAAY,GAAnB,UAAoB,SAA4B;QAC9C,IAAM,cAAc,GAAG,mBAAmB,CAAC;QAE3C,IAAI,CAAC,SAAS,IAAI,MAAM,CAAC,cAAc,CAAC,EAAE;YACxC,OAAO;SACR;QAED,IAAM,IAAI,GAAG;YACX,EAAE,EAAE;gBACF,KAAK,EAAE,SAAS;gBAChB,cAAc,EAAE,6CAA6C;gBAC7D,EAAE,EAAE,IAAI;gBACR,MAAM,EAAE,QAAQ;aACjB;YACD,QAAQ,EAAE;gBACR,KAAK,EAAE,IAAI;gBACX,cAAc,EAAE,mBAAmB;gBACnC,EAAE,EAAE,IAAI;gBACR,MAAM,EAAE,IAAI;aACb;SACF,CAAC;QACF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,IAAI,QAAQ,CAAC;QAEhD,IAAM,cAAc,GAAG;YACrB,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,KAAK;YACnC,YAAY,EAAE;gBACZ,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE;gBACjC,QAAQ,EAAE;oBACR,QAAQ,CAAC,KAAK,EAAE,CAAC;oBACjB,MAAM,CAAC,cAAc,CAAC,GAAG,KAAK,CAAC;oBAC/B,IAAM,WAAW,GAAG,SAAS,IAAI,SAAS,CAAC,KAAK,IAAI,EAAE,CAAC;oBACvD,IAAM,WAAW,GAAG,WAAW,CAAC,YAAY,IAAI,aAAa,CAAC;oBAC9D,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,wDAAsD,WAAa,CAAC;iBAC5F;gBACD,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,MAAM;gBACzC,YAAY,EAAE;oBACZ,QAAQ,CAAC,KAAK,EAAE,CAAC;oBACjB,MAAM,CAAC,cAAc,CAAC,GAAG,KAAK,CAAC;iBAChC;aACF;YACD,UAAU,EAAE,IAAI;YAChB,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;YACX,UAAU,EAAE,KAAK;SAClB,CAAC;QACF,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,EAAE,cAAc,CAAC,CAAC;QAC9G,MAAM,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC;QAC9B,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE;YAClE,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC;gBACxC,MAAM,CAAC,cAAc,CAAC,GAAG,KAAK,CAAC;aAChC,CAAC,CAAC;SACJ;KACF;;gBAxMF,UAAU;;;;gBAbF,eAAe;gBAEf,eAAe,uBAoBnB,QAAQ;6CACR,MAAM,SAAC,SAAS;;IAgMrB,yBAAC;CA1MD;;ACZA;;;;;;AAMA;;;;;IAOE,2BAAoB,aAA4B,EAC1B,eAAgC;QADlC,kBAAa,GAAb,aAAa,CAAe;QAC1B,oBAAe,GAAf,eAAe,CAAiB;QAEpD,IAAI,CAAC,eAAe,EAAE;YACpB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;;IAMM,mCAAO,GAAd,UAAe,OAAe;QAC5B,OAAO,IAAI,CAAC,aAAa,CAAC,OAAO,CAAgB;YAC/C,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,WAAW;YACvC,GAAG,EAAE,OAAO;YACZ,OAAO,EAAE,IAAI;SACd,CAAC,CAAC;KACJ;;;;;IAMM,gCAAI,GAAX,UAAY,OAAe,EAAE,OAAiC;QAC5D,IAAM,aAAa,GAAkB;YACnC,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,WAAW;YACvC,GAAG,EAAE,OAAO;YACZ,OAAO,EAAE,IAAI;SACG,CAAC;QACnB,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;YAChC,OAAO,aAAa,CAAC,KAAK,CAAC;SAC5B;QACD,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;KAC/C;;;;;;IAOM,mCAAO,GAAd,UAAe,OAAe,EAAE,OAAiC;QAC/D,IAAM,aAAa,GAAkB;YACnC,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,WAAW;YACvC,GAAG,EAAE,OAAO;YACZ,OAAO,EAAE,IAAI;SACG,CAAC;QACnB,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;YAChC,OAAO,aAAa,CAAC,KAAK,CAAC;SAC5B;QACD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;KAC3C;;;;;;IAOM,mCAAO,GAAd,UAAe,OAAe,EAAE,OAAiC;QAC/D,IAAM,aAAa,GAAkB;YACnC,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,WAAW;YACvC,GAAG,EAAE,OAAO;YACZ,OAAO,EAAE,IAAI;SACG,CAAC;QACnB,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;YAChC,OAAO,aAAa,CAAC,KAAK,CAAC;SAC5B;QACD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;KAC3C;;;;;IAMM,iCAAK,GAAZ,UAAa,OAAe,EAAE,OAAiC;QAC7D,IAAM,aAAa,GAAkB;YACnC,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,WAAW;YACvC,GAAG,EAAE,OAAO;YACZ,OAAO,EAAE,IAAI;SACG,CAAC;QACnB,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;YAChC,OAAO,aAAa,CAAC,KAAK,CAAC;SAC5B;QACD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;KACzC;;gBA3FF,UAAU;;;;gBATF,aAAa;gBACb,eAAe,uBAgBnB,QAAQ;;IAoFb,wBAAC;CA5FD;;;ICJI,2BACY,SAAwB;QAAxB,cAAS,GAAT,SAAS,CAAe;KAC/B;IAEE,mCAAO,GAAd;QACI,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC;QACxD,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;KACzE;IACM,oCAAQ,GAAf;QACI,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC;QACxD,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;KACzE;IACM,wCAAY,GAAnB;QACI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;KACjC;IAEM,wCAAY,GAAnB;QACI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;KACjC;;gBApBJ,UAAU;;;;gBAHF,aAAa;;IAwBtB,wBAAC;CArBD;;ACFA;;;;AAIA;IAGE;KACC;;;;IAKM,iCAAU,GAAjB,UAAkB,KAAU;QAC1B,OAAO,CAAC,CAAC,KAAK,CAAC;KAChB;;gBAXF,UAAU;;;;IAYX,mBAAC;CAZD;;ACCA;;;AAGA;IAGE,0BACU,cAAkC,EAClC,iBAAoC,EACxB,eAAgC;QAF5C,mBAAc,GAAd,cAAc,CAAoB;QAClC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACxB,oBAAe,GAAf,eAAe,CAAiB;QAEpD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;IAKM,0CAAe,GAAtB,UAAuB,QAAgB;QAErC,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAC/C,IAAI,WAAW,KAAK,IAAI,EAAE;YACxB,OAAO,IAAI,CAAC;SACb;QAED,IAAI,QAAQ,EAAE;YACZ,OAAO,IAAI,CAAC;SACb;QAED,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5F,OAAO,KAAK,EAAE,CAAC;KAChB;;;;IAKM,0CAAe,GAAtB,UAAuB,QAAgB;QACrC,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAC/C,IAAI,WAAW,KAAK,IAAI,EAAE;YACxB,OAAO,IAAI,CAAC;SACb;QAED,IAAI,QAAQ,EAAE;YACZ,OAAO,IAAI,CAAC;SACb;QAED,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5F,OAAO,KAAK,EAAE,CAAC;KAChB;;;;;IAKM,sCAAW,GAAlB,UAAmB,EAAU;QAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAmB,CAAC;QAClD,IAAM,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC;;QAGtC,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,KAAK,KAAK,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE;YAC9F,OAAO,IAAI,CAAC;SACb;;;QAID,IAAI,EAAE,KAAK,EAAE,EAAE;YACb,OAAO,IAAI,CAAC;SACb;QAED,OAAO,KAAK,CAAC;KACd;;gBAnEF,UAAU;;;;gBAPF,kBAAkB;gBAClB,iBAAiB;gBACjB,eAAe,uBAWnB,QAAQ;;IA8Db,uBAAC;CApED;;ACPA;;;;AAIA;IAGE,sBAAoB,QAAuB;QAAvB,aAAQ,GAAR,QAAQ,CAAe;KAC1C;IAED,8BAAO,GAAP,UAAQ,SAAiB,EAAE,SAAe,EAAE,QAAmB;QAC7D,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;KACvD;;gBARF,UAAU;;;;gBANF,aAAa;;IAetB,mBAAC;CATD;;ACNA;;;;;AAKA;IAAA;QAEqB,qCAAgC,GAAG,kCAAkC,CAAC;KA2F1F;IA1FW,mCAAQ,GAAhB;QACI,IAAM,IAAI,GAAG,CAAC,CAAC,cAAc,IAAI,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,gCAAgC,CAAC,IAAI,IAAI,CAAC;QACvG,IAAI,CAAC,CAAC,IAAI,EAAE;YACR,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAC3B;QACD,OAAO,EAAE,CAAC;KACb;IACO,mCAAQ,GAAhB,UAAiB,KAAK;QAClB,CAAC,CAAC,cAAc,IAAI,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,gCAAgC,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;KAC5G;IACM,uCAAY,GAAnB,UAAoB,YAAoB,EAAE,WAAmB,EAAE,MAAsB;QAAtB,uBAAA,EAAA,aAAsB;QACjF,IAAI,CAAC,WAAW,EAAE;YACd,OAAO;SACV;QACD,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAM,aAAa,GAAG,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;QACpE,IAAM,SAAS,GAAG,EAAE,EAAE,EAAE,WAAW,EAAE,MAAM,QAAA,EAAE,CAAC;QAC9C,IAAI,aAAa,EAAE;YACf,IAAM,QAAM,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC;YACnC,IAAM,gBAAgB,GAAG,QAAM,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,WAAW,GAAA,CAAC,CAAC;YACtE,IAAI,CAAC,gBAAgB,EAAE;gBACnB,KAAK,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACvC;SACJ;aAAM;YACH,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;SACrC;QACD,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;KACxB;IACM,uCAAY,GAAnB,UAAoB,YAAoB,EAAE,WAAoB;QAC1D,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,KAAK,KAAK,IAAI,EAAE;YAChB,OAAO,IAAI,CAAC;SACf;QACD,IAAM,aAAa,GAAG,KAAK,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;QACzD,IAAI,CAAC,aAAa,EAAE;YAChB,OAAO,IAAI,CAAC;SACf;QACD,IAAM,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC;QACvC,IAAM,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,MAAM,KAAK,IAAI,GAAA,CAAC,CAAC;QAClE,IAAI,OAAO,WAAW,KAAK,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9D,OAAO,SAAS,CAAC;SACpB;QACD,OAAO,UAAU,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,EAAE,KAAK,WAAW,GAAA,CAAC,CAAC;KAC5E;IACM,0CAAe,GAAtB,UAAuB,WAAmB,EAAE,MAAe;QACvD,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,KAAK,KAAK,IAAI,EAAE;YAChB,OAAO;SACV;QACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;YAC1B,IAAM,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,WAAW,GAAA,CAAC,CAAC;YACnE,IAAI,CAAC,CAAC,SAAS,EAAE;gBACb,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;aAC7B;SACJ,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;KACxB;IACM,qCAAU,GAAjB,UAAkB,MAAc;QAC5B,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;QAC9B,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;KAChC;IACO,2CAAgB,GAAxB,UAAyB,MAAc;QACnC,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,KAAK,KAAK,IAAI,EAAE;YAChB,OAAO,IAAI,CAAC;SACf;QACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;YAC3B,IAAI,IAAI,KAAK,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7C,OAAO,KAAK,CAAC,IAAI,CAAC,CAAC;aACtB;SACJ,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;KACxB;IACO,0CAAe,GAAvB,UAAwB,MAAc;QAClC,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,KAAK,KAAK,IAAI,EAAE;YAChB,OAAO;SACV;QACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY;YACnC,IAAM,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,CAAC;YACvC,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrC,UAAU,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;oBAC5B,IAAI,KAAK,CAAC,EAAE,KAAK,MAAM,EAAE;wBACrB,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;qBAC/B;iBACJ,CAAC,CAAC;aACN;SACJ,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;KACxB;;gBA5FJ,UAAU;;IA6FX,uBAAC;CA7FD;;ACNA;;;;;;AAOA,AAQA;;;;;AAKA;IAYE,uBACU,MAAc,EACd,kBAAsC,EACtC,gBAAkC,EACtB,UAAsB,EACtB,gBAAkC,EAClC,eAAgC;QAL5C,WAAM,GAAN,MAAM,CAAQ;QACd,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,qBAAgB,GAAhB,gBAAgB,CAAkB;QACtB,eAAU,GAAV,UAAU,CAAY;QACtB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,oBAAe,GAAf,eAAe,CAAiB;;;;QAb9C,iBAAY,GAAW,IAAI,CAAC;;;;QAI5B,gBAAW,GAAW,IAAI,CAAC;;QAE5B,aAAQ,GAAiB,IAAI,CAAC;QASnC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAI,gBAAgB,EAAE,CAAC;SAChD;QACD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,QAAQ,GAAG,IAAI,OAAO,EAAO,CAAC;QACnC,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;;;;;;IAOM,6BAAK,GAAZ,UAAa,GAAW,EAAE,MAAW;QACnC,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;QAClD,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QAC5B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;KAChC;;;;IAIM,qCAAa,GAApB;QAAA,iBAgCC;QA/BC,IAAM,MAAM,GAAQ,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACzD,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;QACnD,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAA,CAAC;YACpE,IAAI,CAAC,CAAC,EAAE;gBACN,OAAO;aACR;YACD,IAAM,EAAE,GAAG,KAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;YAC/C,IAAM,SAAS,GAAG,KAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;YACzD,IAAI,CAAC,CAAC,EAAE,IAAI,MAAM,KAAK,EAAE,IAAI,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBAChE,KAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,KAAI,CAAC,YAAY,GAAG,EAAE,CAAC;aACxB;SACF,EAAE,MAAM,CAAC,CAAC;QAEX,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAA,CAAC;YACpE,IAAI,CAAC,CAAC,EAAE;gBACN,OAAO;aACR;YACD,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACtB,IAAM,EAAE,GAAG,KAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;YAC/C,IAAI,MAAM,KAAK,EAAE,EAAE;gBACjB,OAAO;aACR;YACD,IAAM,SAAS,GAAG,KAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;;YAEjE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/C,KAAI,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;gBACzB,KAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,KAAI,CAAC,WAAW,GAAG,EAAE,CAAC;aACvB;SACF,EAAE,MAAM,CAAC,CAAC;KACZ;IAEO,uCAAe,GAAvB,UAAwB,KAAa;QACnC,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE;YACnB,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;SACzC;KACF;;;;;IAKO,qCAAa,GAArB,UAAsB,EAAU;QAC9B,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,EAAE,CAAC;SACX;QACD,IAAI,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;YAC1B,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;SACvB;QACD,OAAO,EAAE,CAAC;KACX;;;;IAIO,kCAAU,GAAlB;QACE,IAAI;YACF,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC;SAC5D;QAAC,WAAK,GAAG;KACX;;;;;;IAMM,gCAAQ,GAAf,UAAgB,MAAc,EAAE,MAAW,EAAE,MAAgB;QAC3D,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,MAAM,KAAK,SAAS,EAAE;YAChE,MAAM,GAAG,KAAK,CAAC;SAChB;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;QACzD,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;QACzD,SAAS,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QACzD,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,MAAM,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;KACpE;;;;;;;IAQM,+BAAO,GAAd,UAAe,KAAa,EAAE,WAAmB,EAAE,MAAW,EAAE,MAAgB;QAC9E,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,MAAM,KAAK,SAAS,EAAE;YAChE,MAAM,GAAG,KAAK,CAAC;SAChB;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;QACzD,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QACxD,QAAQ,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QACxD,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE;YACrB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,WAAW,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;SAC/D;KACF;;;;IAKO,qCAAa,GAArB,UAAsB,MAAW;QAC/B,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM,KAAK,IAAI,KAAK,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;YACzG,MAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,IAAI,GAAG,EAAe,CAAC;QACxC,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACjC;QACD,MAAM,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;QAC9C,OAAO,QAAQ,CAAC;KACjB;;;;IAKM,iCAAS,GAAhB;QACE,IAAM,MAAM,GAAkB,IAAI,CAAC,SAAS,EAAE,CAAC;QAC/C,IAAM,KAAK,GAAkB,IAAI,CAAC,QAAQ,EAAE,CAAC;QACvC,IAAA,sBAAwD,EAAtD,wCAAiB,EAAE,gCAAmC,CAAC;QAC/D,IAAI,iBAAiB,EAAE;YACrB,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;YACtD,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YACpB,OAAO;SACR;QAED,IAAI,MAAM,KAAK,IAAI,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACtE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACxB;aAAM,IAAI,KAAK,KAAK,IAAI,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1E,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YAC1C,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;SACnC;aAAM;YACL,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,CAAC,CAAC;SAC3D;KACF;;;;IAKO,kCAAU,GAAlB;QACE,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,sBAAsB,CAAC,CAAC;QAC1D,IAAI,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,sCAAsC,EAAE,KAAK,CAAC,CAAC;QAE9F,IAAI,kBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAC1D,OAAO,kBAAkB,IAAI,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACvD,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;YAChD,kBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;YAC5D,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,sCAAsC,EAAE,KAAK,CAAC,CAAC;SAC3F;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;QAC/D,OAAO,EAAE,iBAAiB,mBAAA,EAAE,aAAa,eAAA,EAAE,CAAC;KAE7C;;;;;;;IAQO,2BAAG,GAAX,UAAY,MAAW,EAAE,IAA4B,EAAE,UAAsB;QAAtB,2BAAA,EAAA,iBAAsB;QAC3E,IAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;cAC5B,IAAI;cACJ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,MAAM,GAAA,CAAC,CAAC;QAC1C,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,OAAO,MAAM,KAAK,SAAS,GAAG,UAAU,GAAG,MAAM,CAAC;SACnD;QAED,IAAI,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,SAAS,IAAI,QAAQ,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;YACvF,OAAO,UAAU,CAAC;SACnB;QAED,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC;KACzD;;;;;IAMM,iCAAS,GAAhB,UAAiB,MAAe;QAC9B,IAAI,CAAC,MAAM,EAAE;YACX,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;SAC3B;QACD,IAAI,CAAC,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC3B,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;SACrD;KACF;;;;;IAMM,gCAAQ,GAAf,UAAgB,KAAc,EAAE,WAAoB;QAClD,IAAI,CAAC,KAAK,EAAE;YACV,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;SACzB;QACD,IAAI,OAAO,WAAW,KAAK,WAAW,EAAE;YACtC,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;SACrC;QACD,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE;YACrB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC,SAAS,EAAE,CAAC;SAC1D;KACF;;;;;IAMO,iCAAS,GAAjB,UAAkB,GAAW,EAAE,MAAwC;QACrE,IAAI,SAAS,CAAC;QACd,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,KAAK,EAAE,EAAE;YAC/C,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAChC;aAAM;YACL,SAAS,GAAG,MAAM,IAAI,EAAE,CAAC;SAC1B;;QAGD,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;KACnD;;;;IAKO,iCAAS,GAAjB;QACE,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,MAAM,IAAI,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;YAC7C,OAAO,MAAM,CAAC,MAAM,CAAC;SACtB;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;;;;IAKO,gCAAQ,GAAhB;QACE,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,MAAM,IAAI,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;YAC5C,OAAO,MAAM,CAAC,KAAK,CAAC;SACrB;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;IAEO,uCAAe,GAAvB;QACE,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,MAAM,IAAI,MAAM,CAAC,cAAc,CAAC,2BAA2B,CAAC,EAAE;YAChE,OAAO,MAAM,CAAC,yBAAyB,CAAC;SACzC;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;;;;IAIO,sCAAc,GAAtB;QACE,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,MAAM,IAAI,MAAM,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;YAClD,OAAO,MAAM,CAAC,WAAW,CAAC;SAC3B;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;;;;;IAKO,uCAAe,GAAvB,UAAwB,KAAa;QACnC,IAAI,OAAO,KAAK,KAAK,WAAW,EAAE;YAChC,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;SACxD;QACD,IAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC9D,OAAO,MAAM,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;;YAChC,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAChC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;YACjC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YAClC,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,YAAI,GAAC,GAAG,IAAG,kBAAkB,CAAC,GAAG,CAAC,MAAG,CAAC;SAClE,EAAE,EAAE,CAAC,CAAC;KACR;IACO,iCAAS,GAAjB,UAAkB,WAAmB;QACnC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,EAAE,CAAC;SACX;QACD,IAAM,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC1E,OAAO,MAAM,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;;YAChC,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAChC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;YACjC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YAClC,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,YAAI,GAAC,GAAG,IAAG,kBAAkB,CAAC,GAAG,CAAC,MAAG,CAAC;SAClE,EAAE,EAAE,CAAC,CAAC;KACR;;gBA3VF,UAAU;;;;gBAZF,MAAM;gBACN,kBAAkB;gBAClB,gBAAgB;gBAAE,UAAU,uBA0BhC,QAAQ;gBAzBJ,gBAAgB,uBA0BpB,QAAQ;gBAxBJ,eAAe,uBAyBnB,QAAQ;;IA0Ub,oBAAC;CA5VD;;ACnBA;AACA,IAAa,SAAS,GAAG;;;;IAIrB,WAAW,EAAE,YAAY;;;;IAIzB,YAAY,EAAE,sBAAsB;;;;IAIpC,aAAa,EAAE,iBAAiB;CACnC,CAAC;AAEF,IAAa,gBAAgB,GAAG;IAC5B,KAAK,EAAE,OAAO;IACd,OAAO,EAAE,SAAS;IAClB,KAAK,EAAE,OAAO;IACd,WAAW,EAAE,aAAa;IAC1B,MAAM,EAAE,QAAQ;CACnB,CAAC;AAUF,AAAO,IAAM,yBAAyB,GAAG,uBAAuB,CAAC;;AC/BjE;;;;AAIA;IAAA;KAkBC;;;;;IAZU,kCAAK,GAAZ,UAAa,WAAmB;QAC5B,IAAI,CAAC,WAAW,EAAE;YACd,OAAO,EAAE,CAAC;SACb;QACD,IAAM,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC1E,OAAO,MAAM,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;;YAC9B,IAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAChC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;YACjC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YAClC,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,YAAI,GAAC,GAAG,IAAG,kBAAkB,CAAC,GAAG,CAAC,MAAG,CAAC;SACpE,EAAE,EAAE,CAAC,CAAC;KACV;;gBAjBJ,UAAU;;IAkBX,yBAAC;CAlBD;;ACFA;;;;;;;;;;;AAaA;IAGE;QACE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;KACrC;;;;IAIO,4CAAU,GAAlB;QACE,IAAI,GAAG,GAAW,MAAM,CAAC;QACzB,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC,IAAI,GAAG,KAAK,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;YAClF,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC;SAClB;QACD,OAAO,GAAG,CAAC,qBAAqB,CAAC,IAAI,GAAG,CAAC,qBAAqB,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;KAC9E;;;;;;IAMD,0CAAQ,GAAR,UAAS,OAAY;QACnB,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC,KAAK,UAAU,EAAE;YAC1H,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SACxC;KACF;;;;;IAKD,2CAAS,GAAT,UAAU,OAAY;QACpB,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,kBAAkB,CAAC,KAAK,UAAU,EAAE;YAClI,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;SACvD;QACD,OAAO,KAAK,CAAC;KACd;;;;;;;IAOD,gDAAc,GAAd,UAAe,KAAa,EAAE,QAAa,EAAE,IAAoB;QAApB,qBAAA,EAAA,WAAoB;QAC/D,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,KAAK,UAAU,EAAE;YAChI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC5D;KACF;;;;;IAKD,iDAAe,GAAf,UAAgB,OAAY;QAC1B,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,aAAa,CAAC,KAAK,UAAU,EAAE;YAC7H,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;SAC3C;KACF;;;;;IAKD,2CAAS,GAAT,UAAU,OAAY;QACpB,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,KAAK,UAAU,EAAE;YACvH,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SACrC;KACF;;;;;;IAMD,+CAAa,GAAb,UAAc,MAAc,EAAE,QAA0B;QACtD,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,eAAe,CAAC,KAAK,UAAU,EAAE;YAC/H,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SACtD;KACF;;;;IAID,kDAAgB,GAAhB,UAAiB,KAAa,EAAE,OAA6B,EAAE,OAAY;QACzE,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,KAAK,UAAU,EAAE;YACvI,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;SACjE;KACF;;;;;IAKM,2DAAyB,GAAhC;QACE,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;QACnC,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,IAAI,IAAI,CAAC;QACrE,IAAI,QAAQ,EAAE;YACZ,IAAM,OAAK,GAAG,IAAI,CAAC,KAAK,CAAC;YACzB,IAAM,SAAO,GAAG,IAAI,CAAC,MAAM,CAAC;YAC5B,MAAM,CAAC,UAAU,CAAC;gBAChB,QAAQ,CAAC,aAAa,CAAC,OAAK,EAAE,UAAC,QAA8E;oBAC3G,IAAM,iBAAiB,GAAG,QAAQ,IAAI,QAAQ,CAAC,iBAAiB,IAAI,IAAI,CAAC;oBACzE,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,GAAG,KAAK,OAAK,EAAE;wBACxD,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;qBACvC;yBAAM;wBACL,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;qBACpB;iBACF,EAAE,SAAO,CAAC,CAAC;aACb,EAAE,CAAC,CAAC,CAAC;SACP;QACD,OAAO,OAAO,CAAC;KAChB;IAID,sBAAW,2CAAM;;;aAAjB;YACE,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,mBAAmB,CAAC,KAAK,UAAU,EAAE;gBACzI,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,mBAAmB,CAAC,EAAE,CAAC;aAC1D;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;IAID,sBAAW,0CAAK;;;;aAAhB;YACE,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;SACpD;;;OAAA;IAID,sBAAW,8CAAS;;;;aAApB;YACE,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC;SACxD;;;OAAA;IAID,sBAAW,2CAAM;;;;aAAjB;YACE,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC;SACrD;;;OAAA;;;;;;;;;;IAWM,iDAAe,GAAtB,UAAuB,IAAY,EAAE,OAAY,EAAE,OAAsB;QACvE,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,iBAAiB,CAAC,KAAK,UAAU,EAAE;YAC3I,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,eAAe,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;SAC1E;QACD,OAAO,IAAI,CAAC;KACb;;;;;IAKM,+CAAa,GAApB,UAAqB,KAAa;QAChC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,eAAe,CAAC,KAAK,UAAU,EAAE;YACzI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SAChD;KACF;;;;;;IAMM,+CAAa,GAApB,UAAqB,KAAa,EAAE,IAAS;QAC3C,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;YAClI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SAC/C;KACF;;;;;;;;;IASM,iDAAe,GAAtB,UAAuB,KAAa,EAAE,OAA4B,EAAE,aAAsB;QACxF,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,UAAU,CAAC,KAAK,UAAU,EAAE;YACpI,IAAI,IAAI,GAAG,aAAa,CAAC;YACzB,IAAI,OAAO,aAAa,KAAK,WAAW,IAAI,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtF,IAAI,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;aACrB;YACD,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;YACzD,OAAO,IAAI,CAAC;SACb;QACD,OAAO,IAAI,CAAC;KACb;;;;;;IAMM,qDAAmB,GAA1B,UAA2B,KAAa,EAAE,aAAqB;QAC7D,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,qBAAqB,CAAC,KAAK,UAAU,EAAE;YAC/I,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,mBAAmB,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;SACrE;KACF;;;;;;;IAQO,8CAAY,GAApB,UAAqB,WAAmB;QACtC,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClC,IAAI;YACF,IAAI,WAAW,IAAI,WAAW,CAAC,QAAQ,IAAI,OAAO,WAAW,CAAC,QAAQ,CAAC,IAAI,KAAK,WAAW,EAAE;gBAC3F,OAAO,WAAW,CAAC,QAAQ,CAAC,IAAI,KAAK,IAAI,CAAC;aAC3C;SACF;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,KAAK,CAAC;SACd;QAED,OAAO,KAAK,CAAC;KACd;;gBAvNF,UAAU;;;;IAyNX,8BAAC;CAzND;;ACPA;;;;AAIA;IAcE,gCACU,uBAAgD,EAChD,gBAAkC,EAClC,kBAAsC;QAFtC,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAE9C,IAAI,CAAC,iBAAiB,GAAG,IAAI,GAAG,EAA0C,CAAC;QAC3E,IAAI,CAAC,kBAAkB,GAAG,IAAI,GAAG,EAAyD,CAAC;QAC3F,IAAI,CAAC,oBAAoB,GAAG,IAAI,GAAG,EAA0C,CAAC;KAC/E;IACD,sBAAY,gDAAY;aAAxB;YACE,IAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;;YAEnE,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC;aAC3D;YACD,OAAO,MAAM,CAAC;SACf;;;OAAA;;;;IAIM,8CAAa,GAApB;QAAA,iBASC;QARC,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QAClC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC;;QAEtB,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,SAAS,CAAC,aAAa,EAAE,UAAC,CAAC,IAAK,OAAA,KAAI,CAAC,oBAAoB,CAAC,CAAC,CAAC,GAAA,EAAE,OAAO,CAAC,CAAC;;QAErH,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,SAAS,CAAC,WAAW,EAAE,UAAC,CAAC,IAAK,OAAA,KAAI,CAAC,oBAAoB,CAAC,CAAC,CAAC,GAAA,EAAE,OAAO,CAAC,CAAC;;QAEnH,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,SAAS,CAAC,YAAY,EAAE,UAAC,CAAC,IAAK,OAAA,KAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,GAAA,EAAE,OAAO,CAAC,CAAC;KACtH;;;;IAIO,qDAAoB,GAA5B,UAA6B,CAAM;QACjC,IAAI,CAAC,CAAC,EAAE;YACN,OAAO;SACR;;QAED,IAAM,UAAU,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC;QAC3C,IAAI,CAAC,UAAU,EAAE;YACf,OAAO;SACR;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;QAC5B,IAAM,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC;QAC/D,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;QACjE,IAAI,CAAC,CAAC,KAAK,IAAI,KAAK,KAAK,UAAU,IAAI,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1E,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;QACD,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;KAC5B;;;;;IAKO,mDAAkB,GAA1B,UAA2B,CAAM;QAC/B,IAAI,CAAC,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,IAAI,GAAG,CAAC,EAAE;YACpE,OAAO;SACR;QACD,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,UAAC,MAAM,EAAE,GAAG,EAAEC,MAAG;YACjD,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE;gBAChC,MAAM,CAAC,CAAC,CAAC,CAAC;aACX;SACF,CAAC,CAAC;KACJ;;;;IAIO,sDAAqB,GAA7B,UAA8B,CAAM;QAApC,iBA2BC;QA1BC,IAAI,CAAC,CAAC,EAAE;YACN,OAAO;SACR;;QAED,IAAM,UAAU,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC;QAC3C,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;QAC5B,IAAM,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC;QAC/D,IAAI,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,KAAK,IAAI,KAAK,KAAK,UAAU,EAAE;YACnD,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;gBAC1C,IAAI,MAAM,EAAE;oBACV,UAAU,CAAC,cAAM,OAAA,KAAI,CAAC,eAAe,CAAC,UAAU,CAAC,GAAA,EAAE,GAAG,CAAC,CAAC;oBACxD,IAAM,iBAAiB,GAAqB,MAAM,CAAC,mBAAmB,CAAC,CAAC;oBACxE,IAAI,iBAAiB,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;wBACrC,iBAAiB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;wBACrC,MAAM,CAAC,mBAAmB,CAAC,GAAG,iBAAiB,CAAC;qBACjD;oBACD,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,EAAE;wBACrC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC;qBACxD;oBACD,IAAI,KAAI,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,UAAU,EAAE;wBACrD,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;qBACxC;oBACD,KAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;SACJ;KACF;;;;IAIO,oDAAmB,GAA3B,UAA4B,CAAM;QAChC,IAAI,CAAC,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,kBAAkB,CAAC,IAAI,GAAG,CAAC,EAAE;YAChE,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,CAAC;QACnD,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;;QAEhC,IAAI,YAAY,GAAG,KAAK,CAAC;QACzB,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,YAAY,EAAE;gBAChB,OAAO,KAAK,CAAC;aACd;YACD,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CACnB,IAAI,CAAC,CAAC,CAAC,EACP,GAAG,CAAC,UAAA,MAAM,IAAI,OAAA,YAAY,GAAG,CAAC,MAAM,GAAA,CAAC,EACrC,SAAS,CAAC,UAAA,MAAM,IAAI,OAAA,EAAE,CAAC,MAAM,CAAC,GAAA,CAAC,CAChC,CAAC;SACH,CAAC,EACF,KAAK,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,GAAA,CAAC,CACxB,CAAC;KACH;;;;IAIO,qDAAoB,GAA5B,UAA6B,CAAM;QACjC,IAAI,CAAC,CAAC,EAAE;YACN,OAAO;SACR;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;QAC5B,IAAM,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC;QAC/D,IAAM,UAAU,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC;QAC3C,IAAI,KAAK,KAAK,UAAU,EAAE;YACxB,OAAO;SACR;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;QACxE,IAAI,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACvD,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YACjC,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;QACD,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;KAC5B;IACO,gDAAe,GAAvB,UAAwB,KAAa;QACnC,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE;YACnB,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;SACzC;KACF;;;;;IAKO,mDAAkB,GAA1B,UAA2B,CAAM;QAC/B,IAAI,CAAC,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,iBAAiB,CAAC,IAAI,GAAG,CAAC,EAAE;YAC9D,OAAO;SACR;QACD,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAC,MAAM,EAAE,GAAG,EAAEA,MAAG;YAC9C,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE;gBAChC,MAAM,CAAC,CAAC,CAAC,CAAC;aACX;SACF,CAAC,CAAC;KACJ;;;;;;;IAOM,iDAAgB,GAAvB,UAAwB,SAAiB,EAAE,OAAqC;QAC9E,IAAM,GAAG,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;QACzB,IAAI,SAAS,KAAK,SAAS,CAAC,WAAW,EAAE;YACvC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YACzC,OAAO,GAAG,CAAC;SACZ;aAAM,IAAI,SAAS,KAAK,SAAS,CAAC,YAAY,EAAE;YAC/C,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAC1C,OAAO,GAAG,CAAC;SACZ;aAAM,IAAI,SAAS,KAAK,SAAS,CAAC,aAAa,EAAE;YAChD,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAC5C,OAAO,GAAG,CAAC;SACZ;QACD,OAAO,IAAI,CAAC;KACb;;;;;;IAMM,oDAAmB,GAA1B,UAA2B,SAAiB,EAAE,GAAW;QACvD,IAAI,SAAS,KAAK,SAAS,CAAC,WAAW,EAAE;YACvC,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SAC3C;aAAM,IAAI,SAAS,KAAK,SAAS,CAAC,YAAY,EAAE;YAC/C,OAAO,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SAC5C;QACD,OAAO,KAAK,CAAC;KACd;;;;;IAKM,mDAAkB,GAAzB,UAA0B,SAAiB;QACzC,IAAI,SAAS,KAAK,SAAS,CAAC,WAAW,EAAE;YACvC,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;SAChC;aAAM,IAAI,SAAS,KAAK,SAAS,CAAC,YAAY,EAAE;YAC/C,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;SACjC;KACF;;;;IAIO,2CAAU,GAAlB;QACE,IAAI;;YAEF,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC;SAC5D;QAAC,WAAM,GAAG;KACZ;;gBAjOF,UAAU;;;;gBAVF,uBAAuB;gBACvB,gBAAgB;gBAEhB,kBAAkB;;IAyO3B,6BAAC;CAlOD;;ICba,sBAAsB,GAAG,IAAI,cAAc,CAAuB,eAAe,CAAC,CAAC;;;;;AAMhG;IAKI,2BAAuD,SAAmB;QAA9D,0BAAA,EAAA,cAA8D;QAFlE,aAAQ,GAA0B,EAAE,CAAC;QAG3C,IAAI,CAAC,SAAS,EAAE;YACd,SAAS,GAAG,EAAE,CAAC;SAChB;QACD,IAAI,CAAC,QAAQ,gBAAQ,SAAS,CAAE,CAAC;KAClC;IAED,kCAAM,GAAN,UAAO,GAAW,EAAE,MAAW;QAC3B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;KAC/B;IAED,uCAAW,GAAX,UAAY,GAAW;QACnB,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YACpB,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SAC7B;aAAM;YACH,OAAO,CAAC,IAAI,CAAC,gCAAU,GAAG,6BAAM,CAAC,CAAC;YAClC,OAAO,IAAI,CAAC;SACf;KACJ;;gBAvBJ,UAAU;;;;gDAKM,QAAQ,YAAG,MAAM,SAAC,sBAAsB;;IAoBzD,wBAAC;CAzBD;;ACPA;;;;;;AAMA,AAgBA;AACA,IAAM,mBAAmB,GAAG,4BAA4B,CAAC;;;;;AAKzD;IAEE,2BACU,uBAAgD,EAChD,gBAAkC,EAClC,sBAA8C,EAC9C,kBAAsC,EAC1B,YAA0B,EAC1B,QAAkB,EAClB,eAAgC;;;;;QAN5C,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,uBAAkB,GAAlB,kBAAkB,CAAoB;QAC1B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,aAAQ,GAAR,QAAQ,CAAU;QAClB,oBAAe,GAAf,eAAe,CAAiB;;QAMpD,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;QACvE,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;;QAE3F,IAAI,KAAK,EAAE;YACT,IAAM,iBAAiB,GAAG,MAAM,CAAC,mBAAmB,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YAChF,IAAI,iBAAiB,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACtD,iBAAiB,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;gBAC7D,MAAM,CAAC,mBAAmB,CAAC,GAAG,iBAAiB,CAAC;aACjD;SACF;QACD,IAAI,KAAK,EAAE;YACT,IAAM,iBAAiB,GAAqB,MAAM,CAAC,mBAAmB,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;;YAElG,IAAI,KAAK,EAAE;gBACT,KAAK,GAAG,KAAK,CAAC;aACf;YACD,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACrD,IAAI,CAAC,sBAAsB,GAAG,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;aAC5D;iBAAM;gBACL,IAAI,CAAC,sBAAsB,CAAC,aAAa,EAAE,CAAC;gBAC5C,iBAAiB,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;gBAC1D,IAAI,CAAC,sBAAsB,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;gBAC7D,MAAM,CAAC,mBAAmB,CAAC,GAAG,iBAAiB,CAAC;aACjD;YACD,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;SAClC;QACD,IAAI,CAAC,eAAe,EAAE;YACpB,IAAI,CAAC,eAAe,GAAG,IAAI,eAAe,EAAE,CAAC;SAC9C;KACF;IACD,sBAAW,sCAAO;aAAlB,UAAmB,OAAO;YACxB,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC;YACjD,IAAI,CAAC,gBAAgB,CAAC,GAAG,OAAO,CAAC;SAClC;;;OAAA;IAID,sBAAY,6CAAc;;;;aAA1B;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;;gBAE9C,OAAO,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,QAAQ,IAAI,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,IAAI,EAAE;oBACnI,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC;iBAChC;gBACD,OAAO,UAAU,CAAC;aACnB;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;IACD,sBAAY,2CAAY;aAAxB;YACE,IAAI,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;YAChC,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACvE,IAAI,KAAK,EAAE;gBACT,IAAM,iBAAiB,GAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC;gBACtD,IAAM,UAAU,GAAG,iBAAiB,IAAI,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBACrE,IAAI,GAAG,UAAU,IAAI,UAAU,CAAC,IAAI,IAAI,IAAI,CAAC;aAC9C;YACD,IAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACnD,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC;aAC3D;YACD,OAAO,MAAM,CAAC;SACf;;;OAAA;IAID,sBAAY,gDAAiB;;;;aAA7B;YACE,OAAO,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;SACvF;;;OAAA;;;;;IAKO,gDAAoB,GAA5B,UAA6B,KAAa;QAA1C,iBAkBC;QAjBC,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE;YACxD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,CAAC;gBACxC,KAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;aACpC,CAAC,CAAC;SACJ;QACD,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,aAAa,EAAE;YACnG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC;gBACnD,IAAM,iBAAiB,GAAG,MAAM,CAAC,mBAAmB,CAAqB,CAAC;gBAC1E,IAAI,iBAAiB,EAAE;oBACrB,iBAAiB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBACjC;gBACD,IAAM,iBAAiB,GAAG,MAAM,CAAC,mBAAmB,CAAqB,CAAC;gBAC1E,IAAI,iBAAiB,EAAE;oBACrB,iBAAiB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBACjC;aACF,CAAC,CAAC;SACJ;KACF;;;;;;;;;;;;IAaM,oCAAQ,GAAf,UAAgB,KAAa,EAAE,MAAc,EAAE,MAAW,EAAE,MAAgB,EAAE,aAAmB,EAAE,OAAgB,EAAE,aAAmB;QACtI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACrC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,EAAE;YACX,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QAED,IAAI,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACnD,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SAC7C;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,IAAM,OAAO,GAAe;YAC1B,KAAK,OAAA;YACL,MAAM,QAAA;YACN,OAAO,EAAE,OAAO,CAAC,IAAI;YACrB,iBAAiB,EAAE,iBAAiB;YACpC,YAAY,EAAE,SAAS;YACvB,KAAK,EAAE,SAAS;YAChB,WAAW,EAAE,SAAS;YACtB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,OAAO,IAAI,IAAI;SACzB,CAAC;;;;QAIF,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACzD;QACD,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;KAChD;;;;;;;;;;IAUM,qCAAS,GAAhB,UAAiB,KAAa,EAAE,MAAc,EAAE,MAAW,EAAE,MAAgB,EAAE,aAAmB,EAAE,OAAgB,EAAE,aAAmB;QACvI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACrC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,EAAE;YACX,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QACD,IAAI,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACnD,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SAC7C;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,IAAM,OAAO,GAAe;YAC1B,KAAK,OAAA;YACL,MAAM,QAAA;YACN,OAAO,EAAE,OAAO,CAAC,IAAI;YACrB,iBAAiB,EAAE,iBAAiB;YACpC,YAAY,EAAE,SAAS;YACvB,KAAK,EAAE,SAAS;YAChB,WAAW,EAAE,SAAS;YACtB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,OAAO,IAAI,IAAI;SACzB,CAAC;;QAEF,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACzD;QACD,OAAO,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;KACxD;;;;;;;;;;;;IAYM,iDAAqB,GAA5B,UAA6B,KAAa,EAAE,MAAc,EAAE,MAAW,EAAE,aAAmB,EAAE,IAAU,EAAE,IAAU,EAAE,OAAgB,EAAE,UAAmB,EAAE,aAAmB;QAC9K,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACrC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,EAAE;YACX,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QACD,IAAI,UAAU,KAAK,SAAS,IAAI,UAAU,KAAK,IAAI,EAAE;YACnD,UAAU,GAAG,EAAE,CAAC;SACjB;QACD,IAAI,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACnD,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SAC7C;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,iBAAiB,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,GAAG,IAAI,GAAG,QAAQ,CAAC,CAAC;QACtD,iBAAiB,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,GAAG,IAAI,GAAG,QAAQ,CAAC,CAAC;QACtD,iBAAiB,CAAC,GAAG,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;QAChD,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;QACpC,iBAAiB,CAAC,GAAG,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC;QAChD,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,IAAM,OAAO,GAAe;YAC1B,KAAK,OAAA;YACL,MAAM,QAAA;YACN,OAAO,EAAE,OAAO,CAAC,IAAI;YACrB,iBAAiB,EAAE,iBAAiB;YACpC,YAAY,EAAE,SAAS;YACvB,KAAK,EAAE,SAAS;YAChB,WAAW,EAAE,SAAS;YACtB,QAAQ,EAAE,KAAK;YACf,OAAO,EAAE,OAAO,IAAI,IAAI;SACzB,CAAC;;;;QAIF,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACzD;QACD,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;KAChD;;;;;;;;;;;;IAaM,mCAAO,GAAd,UAAe,KAAa,EAAE,KAAa,EAAE,WAAmB,EAAE,MAAW,EAAE,MAAgB,EAAE,OAAgB,EAAE,aAAmB,EAAE,aAAmB;QACzJ,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACpC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,EAAE;YACX,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QACD,IAAI,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACnD,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SAC7C;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,IAAM,OAAO,GAAe;YAC1B,KAAK,OAAA;YACL,KAAK,OAAA;YACL,WAAW,aAAA;YACX,MAAM,EAAE,SAAS;YACjB,OAAO,EAAE,OAAO,CAAC,GAAG;YACpB,iBAAiB,EAAE,iBAAiB;YACpC,YAAY,EAAE,SAAS;YACvB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,OAAO,IAAI,IAAI;SACzB,CAAC;QACF,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACzD;QACD,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;KAChD;;;;;;;;;;;;IAYM,oCAAQ,GAAf,UAAgB,KAAa,EAAE,KAAa,EAAE,WAAmB,EAAE,MAAW,EAAE,MAAgB,EAAE,OAAgB,EAAE,aAAmB,EAAE,aAAmB;QAC1J,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACpC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,EAAE;YACX,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SACnC;QACD,IAAI,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACnD,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SAC7C;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,IAAM,OAAO,GAAe;YAC1B,KAAK,OAAA;YACL,KAAK,OAAA;YACL,WAAW,aAAA;YACX,MAAM,EAAE,SAAS;YACjB,OAAO,EAAE,OAAO,CAAC,GAAG;YACpB,iBAAiB,EAAE,iBAAiB;YACpC,YAAY,EAAE,SAAS;YACvB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,OAAO,IAAI,IAAI;SACzB,CAAC;QACF,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACzD;QACD,OAAO,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;KACxD;;;;;IAKM,iCAAK,GAAZ;QACE,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QAC5B,IAAA,sBAAoE,EAAlE,iCAA6B,EAAE,gCAAmC,CAAC;QAC3E,IAAI,UAAU,EAAE;YACd,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;YACtD,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YACpB,OAAO;SACR;QACD,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC;QAClC,IAAI,CAAC,uBAAuB,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;KACvD;;;;IAIM,mCAAO,GAAd;QACE,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;QAClC,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC;QAClC,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;KACjD;;;;;;IAMO,uCAAW,GAAnB,UAAoB,MAAW;QAC7B,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM,KAAK,IAAI,KAAK,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;YACzG,MAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,IAAI,GAAG,EAAe,CAAC;QACxC,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACjC;QACD,MAAM,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;QAC9C,OAAO,QAAQ,CAAC;KACjB;;;;;;;IAOM,4CAAgB,GAAvB,UAAwB,SAAiB,EAAE,OAAqC;QAC9E,OAAO,IAAI,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;KACzE;;;;;;IAMM,+CAAmB,GAA1B,UAA2B,SAAiB,EAAE,GAAW;QACvD,OAAO,IAAI,CAAC,sBAAsB,CAAC,mBAAmB,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;KACxE;;;;;IAKM,8CAAkB,GAAzB,UAA0B,SAAiB;QACzC,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;KAC3D;;;;;;;;;;;;;;;;IAgBM,gCAAI,GAAX,UAAY,IAAiC,EAAE,OAAgB,EAAE,GAAY,EAAE,OAAa,EAAE,KAAc,EAAE,OAAwB,EAAE,WAAoB,EAAE,WAAoB,EAAE,MAAY,EAAE,OAAgB,EAAE,aAAmB,EAAE,aAAmB;QAC1P,IAAM,gBAAgB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QACzF,IAAI,CAAC,gBAAgB,EAAE;YACrB,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;SACnD;;QAED,IAAI,CAAC,IAAI,EAAE;YACT,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC;SAC1D;QACD,IAAI,IAAI,KAAK,OAAO,IAAI,IAAI,KAAK,SAAS,EAAE;YAC1C,IAAI,CAAC,OAAO,IAAI,CAAC,GAAG,EAAE;gBACpB,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;aAChD;YACD,IAAI,OAAO,IAAI,GAAG,EAAE;gBAClB,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;aAChD;YACD,IAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;YACvD,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;YAC/C,IAAI,IAAI,KAAK,SAAS,EAAE;gBACtB,WAAW,CAAC,UAAU,GAAG,IAAI,CAAC;aAC/B;YACD,IAAI,YAAY,GAAG,IAAI,CAAC;YACxB,IAAI,OAAO,EAAE;gBACX,IAAM,iBAAiB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;gBACxF,IAAI,CAAC,iBAAiB,EAAE;oBACtB,OAAO;iBACR;gBACD,IAAI,aAAa,GAAG,iBAAiB,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBAC3D,IAAM,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC;gBAC3E,YAAY,GAAG,gBAAgB,CAAC,IAAI,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;aACjE;iBAAM,IAAI,GAAG,EAAE;gBACd,YAAY,GAAG,gBAAgB,CAAC,SAAS,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;aAC7D;YACD,IAAI,YAAY,IAAI,CAAC,CAAC,YAAY,CAAC,OAAO,EAAE;gBAC1C,YAAY,CAAC,OAAO,CAAC,qBAAqB,GAAG,IAAI,CAAC;gBAClD,YAAY,CAAC,OAAO,CAAC,SAAS,GAAG,YAAY,CAAC;gBAC9C,IAAM,MAAM,GAAG,YAAY,CAAC,MAAM,IAAI,YAAY,CAAC,MAAM,CAAC,QAAQ,IAAI,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,IAAI,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,aAAa,IAAI,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;gBACxO,IAAI,MAAM,IAAI,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE;oBACnD,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;oBACtD,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;iBAC9B;aACF;SACF;aAAM,IAAI,IAAI,KAAK,KAAK,EAAE;YACzB,IAAI,CAAC,KAAK,IAAI,CAAC,OAAO,IAAI,CAAC,WAAW,EAAE;gBACtC,IAAI,IAAI,CAAC,iBAAiB,EAAE;oBAC1B,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBAC/F;gBACD,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;aACnD;YACD,IAAI,OAAO,KAAK,KAAK,IAAI,CAAC,WAAW,EAAE;gBACrC,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;aACtC;YACD,IAAI,OAAO,IAAI,KAAK,EAAE;gBACpB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;aACrG;iBAAM,IAAI,OAAO,KAAK,MAAM,EAAE;gBAC7B,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,WAAW,EAAE,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC;aACzF;SACF;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC;SAC5B;;KAEF;;;;;;;;;;;;IAYM,oCAAQ,GAAf,UAAgB,QAAe,EAAE,OAAa;QAC5C,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAS,MAAM,EAAE,IAAI,CAAC,CAAC;QACxE,IAAM,cAAc,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAiB,cAAc,EAAE,IAAI,CAAC,CAAC;QAChG,IAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,IAAI,CAAC,YAAY,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC;QAC9F,IAAI,OAAO,IAAI,OAAO,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;YACpD,OAAO,OAAO,CAAC,WAAW,CAAC;SAC5B;QACD,IAAM,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,kBAAkB,EAAE,KAAK,EAAE,UAAU,EAAE,cAAc,EAAE,WAAW,aAAA,EAAE,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;QACnH,IAAI,MAAM,EAAE;YACV,OAAO,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;SAC1C;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;;;;;;;;IAUO,yCAAa,GAArB,UAAsB,MAAW,EAAE,OAAa;QAC9C,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM,KAAK,IAAI,KAAK,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;YACzG,MAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,IAAI,GAAG,EAAe,CAAC;QACxC,IAAI,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9C,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;gBAC9B,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;aAC7B;YACD,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;SACxC;QACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACjC;QACD,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,MAAM,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QACxD,OAAO,QAAQ,CAAC;KACjB;IACO,sCAAU,GAAlB,UAAmB,MAAM,EAAE,OAAa;QACtC,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM,KAAK,IAAI,KAAK,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;YACzG,MAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,IAAI,GAAG,EAAe,CAAC;QACxC,IAAI,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9C,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;gBAC9B,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;aAC7B;YACD,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;SACxC;QACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC7B;QACD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;YAC7B,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;SAChC,CAAC,CAAC;QACH,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QACpG,MAAM,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;QAC9C,QAAQ,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QACxD,OAAO,QAAQ,CAAC;KACjB;;;;IAIO,sCAAU,GAAlB;QACE,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,6BAA6B,CAAC,CAAC;QACjE,IAAI,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,sCAAsC,EAAE,KAAK,CAAC,CAAC;QAE9F,IAAI,kBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAC1D,OAAO,kBAAkB,IAAI,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACvD,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;YAChD,kBAAkB,GAAG,IAAI,CAAC,GAAG,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;YAC5D,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,sCAAsC,EAAE,KAAK,CAAC,CAAC;SAC3F;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;QAC/D,OAAO,EAAE,iBAAiB,mBAAA,EAAE,aAAa,eAAA,EAAE,CAAC;KAC7C;;;;;;;IAQO,+BAAG,GAAX,UAAY,MAAW,EAAE,IAA4B,EAAE,UAAsB;QAAtB,2BAAA,EAAA,iBAAsB;QAC3E,IAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;cAC5B,IAAI;cACJ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,MAAM,GAAA,CAAC,CAAC;QAC1C,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,OAAO,MAAM,KAAK,SAAS,GAAG,UAAU,GAAG,MAAM,CAAC;SACnD;QAED,IAAI,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,SAAS,IAAI,QAAQ,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;YACvF,OAAO,UAAU,CAAC;SACnB;QAED,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC;KACzD;IACO,4CAAgB,GAAxB,UAAyB,KAAU,EAAE,UAA2B;QAA3B,2BAAA,EAAA,kBAA2B;QAC9D,IAAI,OAAO,KAAK,KAAK,WAAW,IAAI,KAAK,KAAK,IAAI,EAAE;YAClD,KAAK,GAAG,UAAU,CAAC;SACpB;QACD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,KAAK,GAAG,KAAK,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC;YACpC,KAAK,GAAG,KAAK,KAAK,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC;SACzC;QACD,OAAO,KAAK,CAAC;KACd;;;;;IAKO,qCAAS,GAAjB,UAAkB,GAAW;QAC3B,IAAM,gBAAgB,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAY,cAAc,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;QACrG,IAAI,gBAAgB,IAAI,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YACzE,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;YACrD,OAAO,gBAAgB,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;SAC9C;QACD,OAAO,GAAG,CAAC;KACZ;;;IAIO,wCAAY,GAApB,UAAqB,MAAW;QAAhC,iBA8CC;QA7CC,IAAI,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAChF,IAAI,CAAC,eAAe,EAAE;YACpB,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACjD;QAED,IAAM,cAAc,GAAQ;YAC1B,KAAK,EAAE,eAAe,IAAI,eAAe,CAAC,kBAAkB,IAAI,EAAE;YAClE,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;YACX,WAAW,EAAE,KAAK;SACnB,CAAC;QACF,IAAM,gBAAgB,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QAC1D,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,gBAAgB,CAAC,CAAC;QAChE,IAAM,gBAAgB,GAAG,OAAO,CAAC,WAAW,CAAC;QAC7C,IAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACzC,IAAM,kBAAkB,GAAG,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,IAAI,CAAC;QAClE,IAAM,cAAc,GAAG,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC;;QAE1D,IAAM,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,IAAI,KAAK,CAAC;QACxD,OAAO,CAAC,WAAW,GAAG,UAAC,GAAG;YACxB,IAAI,CAAC,CAAC,gBAAgB,IAAI,OAAO,gBAAgB,KAAK,UAAU,EAAE;gBAChE,OAAO,gBAAgB,CAAC,GAAG,CAAC,CAAC,IAAI,CAC/B,SAAS,CAAC,UAAA,MAAM;oBACd,IAAI,MAAM,EAAE;wBACV,IAAI,aAAa,EAAE;4BACjB,OAAO,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,IAAI,CACjC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,cAAc,CAAC,GAAA,CAAC,CACtE,CAAC;yBACH;qBACF;oBACD,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;iBACnB,CAAC,CACH,CAAC;aACH;iBAAM;gBACL,IAAI,aAAa,EAAE;oBACjB,OAAO,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,IAAI,CACjC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,cAAc,CAAC,GAAA,CAAC,CACtE,CAAC;iBACH;qBAAM;oBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF;SAEF,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;IACO,+CAAmB,GAA3B,UAA4B,MAAW;QACrC,IAAI,gBAAqB,CAAA;QACzB,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;YACjC,MAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,IAAI,MAAM,CAAC,MAAM,EAAE;gBACjB,IAAI;oBACF,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;iBACvC;gBAAC,WAAM;oBACN,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,cAAc,CAAC,CAAC;iBAC1C;aACF;iBAAM;gBACL,gBAAgB,GAAG,EAAE,CAAC;aACvB;SACF;aAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YACrC,gBAAgB,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;SAC9C;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;SACnC;QACD,OAAO,gBAAgB,CAAC;KACzB;;;;IAIO,yCAAa,GAArB,UAAsB,GAAQ;QAC5B,IAAI,GAAG,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE;YAC/C,IAAM,SAAS,GAAmB,GAAG,CAAC,QAAQ,CAAC,OAAyB,CAAC;YACzE,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,EAAE;gBAClC,IAAM,UAAU,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC;gBACxD,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,cAAM,OAAA,EAAE,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC,CAAC;iBACnE;aACF;SACF;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;IACO,uCAAW,GAAnB,UAAoB,kBAA0B,EAAE,cAAsB;QACpE,IAAI,kBAAkB,IAAI,cAAc,EAAE;YACxC,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,cAAc,CAAC,CAAC;YAC1G,IAAI,YAAY,EAAE;gBAChB,IAAM,SAAS,GAAG,YAAY,CAAC,SAAS,CAAC;gBACzC,OAAO,SAAS,CAAC,kBAAkB,CAAC,EAAE,CAAC,IAAI,CACzC,GAAG,CAAC,cAAM,OAAA,IAAI,GAAA,CAAC,CAChB,CAAC;aACH;SACF;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;IACO,8CAAkB,GAA1B,UAA2B,aAAkB,EAAE,aAAkB;QAC/D,IAAI,YAAiB,CAAC;QACtB,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAM,wBAAwB,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;QACpE,IAAI,YAAY,IAAI,wBAAwB,EAAE;YAC5C,IAAM,kBAAkB,GAAG,wBAAwB,CAAC,uBAAuB,CAAC,aAAa,CAAC,CAAC;YAC3F,IAAM,oBAAoB,GAAG,kBAAkB,CAAC,gBAAgB,CAAC,EAAE,EAAE,YAAY,CAAC,QAAQ,CAAC,CAAC;YAC5F,YAAY,GAAG,kBAAkB,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC;YAC/D,IAAI,YAAY,IAAI,YAAY,CAAC,QAAQ,IAAI,YAAY,CAAC,QAAQ,CAAC,SAAS,IAAI,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,EAAE;gBACvH,IAAI,OAAO,aAAa,KAAK,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE;oBAC1E,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;wBACrC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;qBACrF,CAAC,CAAC;iBACJ;;gBAED,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;aACjF;SACF;QACD,OAAO,YAAY,CAAC;KACrB;;;;IAIO,2CAAe,GAAvB;QACE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,OAAO,IAAI,CAAC,YAAY,CAAA;SACzB;QACD,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,EAAE;YACtD,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,CAAC;SACxC;QACD,OAAO,IAAI,CAAC;KACb;;;;IAIO,uDAA2B,GAAnC;QACE,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAI,wBAA6B,CAAC;QAClC,IAAI,YAAY,EAAE;YAChB,wBAAwB,GAAG,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;SAChF;QACD,OAAO,wBAAwB,CAAC;KACjC;;gBApvBF,UAAU;;;;gBApBF,uBAAuB;gBAEvB,gBAAgB;gBAChB,sBAAsB;gBACtB,kBAAkB;gBAClB,YAAY,uBAsBhB,QAAQ;gBA7BkB,QAAQ,uBA8BlC,QAAQ;gBAnBJ,eAAe,uBAoBnB,QAAQ;;IA6uBb,wBAAC;CAtvBD;;ACzBA,IAAM,MAAM,GAAG,QAAQ,CAAC;AACxB,IAAM,gBAAgB,GAAG,kBAAkB,CAAC;;;;;AAM5C;IAAA;KAwEC;;;;IAnEiB,+BAAiB,GAA/B,UAAgC,YAA0B;;QAEtD,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,cAAc,GAAG,IAAI,CAAC;QAC1B,IAAI,uBAAuB,EAAE;YACzB,cAAc,GAAG,uBAAuB,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;YACpE,OAAO,cAAc,GAAG,cAAc,GAAG,IAAI,CAAC;SACjD;QACD,OAAO,cAAc,CAAC;KACzB;;;;IAKa,+BAAiB,GAA/B,UAAgC,YAA0B,EAAE,cAAsB;;QAE9E,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,uBAAuB,EAAE;YACzB,uBAAuB,CAAC,QAAQ,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC;SACtE;KACJ;;;;IAKa,yBAAW,GAAzB,UAA0B,YAA0B;;QAEhD,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,uBAAuB,EAAE;YACzB,OAAO,uBAAuB,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;SACnD;KACJ;;;;IAKa,yBAAW,GAAzB,UAA0B,YAA0B,EAAE,cAAsB;;QAExE,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,uBAAuB,EAAE;YACzB,uBAAuB,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;SAClD;QACD,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;KACxD;;;;IAKa,4BAAc,GAA5B,UAA6B,YAA0B;;QAEnD,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,uBAAuB,EAAE;YACzB,uBAAuB,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SACnD;KACJ;;;;IAKa,0BAAY,GAA1B,UAA2B,YAA0B,EAAE,EAAU;;QAE7D,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAI,uBAAuB,EAAE;YACzB,uBAAuB,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SACnD;QACD,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;KAC5C;IACL,oBAAC;CAAA,IAAA;;AChFD;;;GAGG;;;ICHH;KAmCC;;;;;;IA7Be,8BAAI,GAAlB,UAAmB,iBAAoC,EAAE,OAAe;QACtE,IAAM,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAC5B,IAAA,0EAA4B,EAA5B,iDAA4B,CAAmD;QACvF,IAAI,uBAAuB,IAAI,uBAAuB,CAAC,WAAW,EAAE,KAAK,MAAM,EAAE;YAC/E,OAAO;SACR;QACD,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;KACtD;;;;;;IAMa,iCAAO,GAArB,UAAsB,iBAAoC,EAAE,OAAe;QACzE,IAAM,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAC5B,IAAA,0EAA4B,EAA5B,iDAA4B,CAAmD;QACvF,IAAI,uBAAuB,IAAI,uBAAuB,CAAC,WAAW,EAAE,KAAK,MAAM,EAAE;YAC/E,OAAO;SACR;QACD,iBAAiB,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;KACzD;IACc,qCAAW,GAA1B,UAA2B,WAAmB;QAC5C,IAAM,eAAe,GAAG,IAAI,eAAe,CAAC,WAAW,CAAC,CAAC;QACzD,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,eAAe,CAAC,OAAO,CAAC,UAAC,KAAa,EAAE,GAAW;YACjD,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;SACrB,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;KACf;IACH,gCAAC;CAAA;;AC/BD;;;;AAIA;IAsBE,wBACU,SAAoB,EACpB,UAAsB;QADtB,cAAS,GAAT,SAAS,CAAW;QACpB,eAAU,GAAV,UAAU,CAAY;KAC3B;IAdL,sBAAW,mCAAO;;;;aAAlB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;;;;aAKD,UAAmB,OAAuB;YACxC,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;SAC7B;;;OAPA;;;;;;IAmBM,gCAAO,GAAd,UAAe,WAAmB,EAAE,OAAgB;QAClD,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,EAAE,IAAI,WAAW,KAAK,WAAW,EAAE;YACrE,OAAO;SACR;QACD,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,IAAI,OAAO,EAAE;YACX,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACvF,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC;SACrC;QACD,OAAO,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC;KACjC;;;;;IAMM,yCAAgB,GAAvB;QACE,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;QAC/C,IAAM,aAAa,GAAG,YAAY,CAAC,UAAmC,CAAC;QACvE,IAAM,cAAc,GAAG,aAAa,CAAC,WAAW,CAAC,cAAc,CAAC;QAChE,OAAO,cAAc,CAAC,cAAc,EAAE,CAAC,IAAI,CACzC,MAAM,CAAC,UAAC,WAAmB;YACzB,OAAO,WAAW,KAAK,IAAI,CAAC;SAC7B,CAAC,EACF,IAAI,CAAC,CAAC,CAAC,CACR,CAAC;KACH;;;;;;IAOM,sCAAa,GAApB,UAAqB,QAAgB;QACnC,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;QACrC,OAAO,OAAO,CAAC,QAAQ,CAAC,CAAC;KAC1B;;;;IAIM,4DAAmC,GAA1C,UAA2C,OAAgB;QACzD,IAAI,YAAY,GAAiB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC;QAC7D,IAAI,OAAO,EAAE;YACX,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;SACxG;QACD,IAAI,YAAY,EAAE;YAChB,YAAY,CAAC,WAAW,CAAC,uBAAuB,GAAG,IAAI,CAAC;SACzD;KAEF;IACM,2DAAkC,GAAzC,UAA0C,OAAgB;QACxD,IAAI,YAAY,GAAiB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC;QAC7D,IAAI,OAAO,EAAE;YACX,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;SACxG;QACD,IAAI,YAAY,EAAE;YAChB,YAAY,CAAC,WAAW,CAAC,uBAAuB,GAAG,KAAK,CAAC;SAC1D;KACF;;gBA1FF,UAAU;;;;gBAPU,SAAS;gBAArB,UAAU;;IAkGnB,qBAAC;CA3FD;;ACEA;;;;AAKA;;;;IAQE,2BACU,UAA2B,EAC3B,YAA0B,EACd,aAAgC,EAChC,eAAgC;QAH5C,eAAU,GAAV,UAAU,CAAiB;QAC3B,iBAAY,GAAZ,YAAY,CAAc;QACd,kBAAa,GAAb,aAAa,CAAmB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAT9C,sBAAiB,GAAG,IAAI,OAAO,EAAO,CAAC;QACvC,wBAAmB,GAAG,IAAI,OAAO,EAAO,CAAC;QAU/C,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,IAAI,eAAe,EAAE,CAAC;SAC9C;KACF;;;;IAKM,oCAAQ,GAAf;QAAA,iBAcC;QAbC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,SAAS,CACjC,UAAC,MAAgB;;;gBACf,KAAqB,IAAA,WAAAC,SAAA,MAAM,CAAA,8BAAA,kDAAE;oBAAxB,IAAM,MAAM,mBAAA;oBACf,MAAM,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAAwB;wBACnD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;4BACnB,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;4BACtB,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;yBACrC;qBACF,CAAC,CAAC;iBACJ;;;;;;;;;SACF,CACF,CAAC;QACF,OAAO,IAAI,CAAC,iBAAiB,CAAC;KAC/B;;;;IAIM,8CAAkB,GAAzB;QAAA,iBAiNC;QAhNC,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC;;QAEtD,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAClE,IAAI,CAAC,YAAY,EAAE;YACjB,OAAOC,IAAE,CAAC,IAAI,CAAC,CAAC;SACjB;;QAED,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;QAC5E,IAAI,CAAC,MAAM,EAAE;YACX,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,4BAA4B,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;QAChF,IAAI,CAAC,aAAa,EAAE;YAClB,OAAO,KAAK,CAAC;SACd;QACD,IAAM,QAAQ,GAAa,CAAC,MAAM,CAAC,CAAC;QACpC,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;QAC9C,IAAI,aAAa,GAAG,EAAE,CAAC;;;QAGvB,IAAI,SAAS,KAAK,IAAI,EAAE;;YAEtB,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;SACzG;aAAM;;YAEL,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;SACrF;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QAClC,IAAM,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;QACnE,IAAI,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC;QACrD,IAAI,OAAO,IAAI,yBAAyB,EAAE;YACxC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,SAAS,CAAC;SAC1E;QAED,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,IAAM,UAAU,GAAG,EAAE,CAAC;QACtB,aAAa,CAAC,OAAO,CAAC,UAAC,YAA0B;YAC/C,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,EAAE;gBACzD,UAAU,GAAG,IAAI,CAAC;aACnB;SACF,CAAC,CAAC;QACH,IAAI,CAAC,UAAU,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACtC,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,aAAa,CAAC,kBAAkB,GAAG,EAAE,CAAC;QACtC,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,IAAM,mBAAmB,GAAG,IAAI,GAAG,EAA0B,CAAC;QAC9D,aAAa,CAAC,OAAO,CAAC,UAAC,WAAyB;YAC9C,IAAM,aAAa,GAAG,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;;YAE1D,aAAa,IAAI,aAAa,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;YAC1D,IAAI,WAAW,CAAC,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,cAAc,EAAE;;gBAEvD,IAAM,0BAA0B,GAAG,WAAW,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACzE,0BAA0B,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,IAAI;oBAC7C,IAAI,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACjC,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC;qBACjE;yBAAM;wBACL,mBAAmB,CAAC,GAAG,CAAC,IAAI,WAAM,KAAK,EAAE,CAAC;qBAC3C;iBACF,CAAC,CAAC;gBACH,WAAW,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;;gBAE5C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE;oBACnC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;oBAClC,SAAS,GAAG,KAAK,CAAC;iBACnB;aACF;SACF,CAAC,CAAC;;QAGH,IAAM,cAAc,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,MAAc;YACjD,IAAM,KAAK,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YACnF,OAAO,MAAM,CAAC,QAAQ,CAAC,SAAS,EAAE,SAAS,EAAE,mBAAmB,EAAE,IAAI,EAAE,KAAI,CAAC,YAAY,CAAC,CAAC;SAC5F,CAAC,CAAC;QACH,IAAM,OAAO,GAAG,GAAG,wBAAI,cAAc,GAAE,IAAI,CACzC,GAAG,CAAC,UAAC,UAAU;YACb,aAAa,CAAC,OAAO,CAAC,UAAC,WAAyB;gBAC9C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,EAAE;oBACpC,OAAO;iBACR;gBACD,IAAM,YAAY,GAAG,UAAC,MAAyB;oBAC7C,MAAM,CAAC,OAAO,CAAC,UAAC,eAAgC;wBAC9C,IAAI,eAAe,CAAC,QAAQ,IAAI,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE;4BAC/D,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;yBACxC;wBACD,IAAM,SAAS,GAAG,EAAE,CAAC;wBACrB,IAAI,EAAE,GAAG,EAAE,CAAC;wBACZ,IAAM,MAAM,GAAG,UAAC,MAAW;4BACzB,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE;gCAC3C,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;gCACpB,OAAO;6BACR;iCAAM,IAAI,MAAM,CAAC,YAAY,CAAC,EAAE;gCAC/B,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;6BAC9B;yBACF,CAAC;wBACF,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;;;wBAI/B,IAAI,cAAc,GAAG;4BACnB,IAAI,EAAE,EAAE;4BACR,KAAK,EAAE,KAAK;4BACZ,MAAM,EAAE,KAAK;yBACd,CAAC;wBACF,IAAI,eAAe,CAAC,MAAM,EAAE;4BAC1B,cAAc,GAAG,eAAe,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;yBACpD;wBACD,IAAM,WAAW,GAAG,GAAG,GAAG,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBACxD,IAAI,eAAe,CAAC,WAAW,EAAE;4BAC/B,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;gCAClD,SAAS,CAAC,GAAG,CAAC,GAAG;oCACf,IAAI,EAAE,eAAe,CAAC,WAAW,CAAC,GAAG,CAAC;iCACvC,CAAC;;;;;;;;;6BASH,CAAC,CAAC;yBACJ;wBACD,IAAM,KAAK,GAAG,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;;;wBAInE,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;4BACnC,IAAI,EAAE,UAAU,CAAC,YAAY;4BAC7B,EAAE,IAAA;4BACF,IAAI,EAAE,KAAK;4BACX,KAAK,EAAE,cAAc,CAAC,KAAK;4BAC3B,MAAM,EAAE,cAAc,CAAC,MAAM;4BAC7B,KAAK,EAAE,eAAe,CAAC,KAAK;4BAC5B,MAAM,EAAE,SAAS;yBAClB,CAAC,CAAC;;qBAEJ,CAAC,CAAC;iBACJ,CAAC;;gBAEF,IAAM,WAAW,GAAG,UAAU,CAAC,GAAG,CAAC,UAAC,MAAwB,IAAK,OAAA,MAAM,CAAC,OAAO,GAAA,CAAC,CAAC;;;gBAGjF,IAAI,WAAW,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,MAAM,KAAK,cAAc,CAAC,MAAM,EAAE;;oBAE/D,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;wBACnC,IAAI,EAAE,UAAU,CAAC,YAAY;wBAC7B,IAAI,EAAE,EAAE;qBACT,CAAC,CAAC;;oBAEH,IAAI,SAAS,EAAE;wBACb,IAAM,aAAa,GAAG,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;wBAC1D,aAAa,IAAI,aAAa,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;wBAC3D,IAAM,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;wBAC9B,IAAI,IAAI,EAAE;4BACR,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;yBAClC;qBACF;iBACF;qBAAM;oBAGL,UAAU,CAAC,OAAO,CAAC,UAAC,MAAwB;wBAC1C,IAAI,MAAM,CAAC,OAAO,EAAE;;4BAElB,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;gCACnC,IAAI,EAAE,UAAU,CAAC,YAAY;gCAC7B,IAAI,EAAE,EAAE;6BACT,CAAC,CAAC;yBACJ;6BAAM;4BACL,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;yBAC7B;qBACF,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;SACJ,CAAC,EACF,SAAS,CAAC,UAAC,UAAU;YACnB,IAAI,WAAW,GAAG,IAAI,CAAC;YACvB,IAAM,MAAM,GAAG,EAAE,CAAC;YAClB,UAAU,CAAC,OAAO,CAAC,UAAC,MAAwB;gBAC1C,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;oBACnB,WAAW,GAAG,KAAK,CAAC;iBACrB;gBACD,MAAM,CAAC,IAAI,OAAX,MAAM,WAAS,MAAM,CAAC,MAAM,GAAE;aAC/B,CAAC,CAAC;YACH,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,KAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE,MAAM,EAAE,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;aAClF;;YAED,IAAI,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC;YAC1D,IAAI,OAAO,IAAI,yBAAyB,EAAE;gBACxC,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC;aACpG;YACD,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC3D,IAAI,WAAW,IAAI,CAAC,SAAS,EAAE;;gBAE7B,OAAO,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;aACzC;YACD,IAAI,WAAW,IAAI,SAAS,EAAE;gBAC5B,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;aACjB;iBAAM;gBACL,OAAOC,OAAK,EAAE,CAAC;aAChB;SACF,CAAC,CACH,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;IAID,uCAAW,GAAX;QAAA,iBA+LC;;QA7LC,IAAM,QAAQ,GAAa,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,cAAc,EAAE,CAAC;QAC7E,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;QAC9C,IAAI,aAAa,GAAG,EAAE,CAAC;QACvB,IAAI,SAAS,KAAK,IAAI,EAAE;;YAEtB,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;SACzG;aAAM;;YAEL,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;SACrF;QAED,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,IAAM,UAAU,GAAG,EAAE,CAAC;QACtB,aAAa,CAAC,OAAO,CAAC,UAAC,YAA0B;YAC/C,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,EAAE;gBACzD,UAAU,GAAG,IAAI,CAAC;aACnB;SACF,CAAC,CAAC;QACH,IAAI,CAAC,UAAU,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACtC,OAAOD,IAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QAClC,IAAM,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;QACnE,IAAI,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC;QACrD,IAAI,OAAO,IAAI,yBAAyB,EAAE;YACxC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,SAAS,CAAC;SAC1E;QAED,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,IAAM,mBAAmB,GAAG,IAAI,GAAG,EAA0B,CAAC;QAC9D,aAAa,CAAC,OAAO,CAAC,UAAC,WAAyB;YAC9C,IAAM,aAAa,GAAG,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;;YAE1D,aAAa,IAAI,aAAa,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;YAC1D,IAAI,WAAW,CAAC,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,cAAc,EAAE;;gBAEvD,IAAM,0BAA0B,GAAG,WAAW,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACzE,0BAA0B,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,IAAI;oBAC7C,IAAI,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;wBACjC,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC;qBACjE;yBAAM;wBACL,mBAAmB,CAAC,GAAG,CAAC,IAAI,WAAM,KAAK,EAAE,CAAC;qBAC3C;iBACF,CAAC,CAAC;gBACH,WAAW,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;;gBAE5C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE;oBACnC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;oBAClC,SAAS,GAAG,KAAK,CAAC;iBACnB;aACF;SACF,CAAC,CAAC;;QAEH,IAAM,oBAAoB,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;;QAGjD,IAAM,cAAc,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,MAAc,EAAE,KAAa;YAChE,OAAA,MAAM,CAAC,QAAQ,CAAC,SAAS,EAAE,SAAS,EAAE,mBAAmB,EAAE,oBAAoB,GAAG,KAAK,GAAG,IAAI,EAAE,KAAI,CAAC,YAAY,CAAC;SAAA,CAAC,CAAC;QACtH,IAAM,OAAO,GAAG,GAAG,wBAAI,cAAc,GAAE,IAAI,CACzC,GAAG,CAAC,UAAC,UAAU;YACb,aAAa,CAAC,OAAO,CAAC,UAAC,WAAyB;gBAC9C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,EAAE;oBACpC,OAAO;iBACR;gBACD,IAAM,YAAY,GAAG,UAAC,MAAyB;oBAC7C,MAAM,CAAC,OAAO,CAAC,UAAC,eAAgC;wBAC9C,IAAI,eAAe,CAAC,QAAQ,IAAI,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE;4BAC/D,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;yBACxC;wBACD,IAAM,SAAS,GAAG,EAAE,CAAC;wBACrB,IAAI,EAAE,GAAG,EAAE,CAAC;wBACZ,IAAM,MAAM,GAAG,UAAC,MAAW;4BACzB,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE;gCAC3C,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;gCACpB,OAAO;6BACR;iCAAM,IAAI,MAAM,CAAC,YAAY,CAAC,EAAE;gCAC/B,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;6BAC9B;yBACF,CAAC;wBACF,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;;;wBAI/B,IAAI,cAAc,GAAG;4BACnB,IAAI,EAAE,EAAE;4BACR,KAAK,EAAE,KAAK;4BACZ,MAAM,EAAE,KAAK;yBACd,CAAC;wBACF,IAAI,eAAe,CAAC,MAAM,EAAE;4BAC1B,cAAc,GAAG,eAAe,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;yBACpD;wBACD,IAAM,WAAW,GAAG,GAAG,GAAG,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBACxD,IAAI,eAAe,CAAC,WAAW,EAAE;4BAC/B,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;gCAClD,SAAS,CAAC,GAAG,CAAC,GAAG;oCACf,IAAI,EAAE,eAAe,CAAC,WAAW,CAAC,GAAG,CAAC;iCACvC,CAAC;;;;;;;;;6BASH,CAAC,CAAC;yBACJ;wBACD,IAAM,KAAK,GAAG,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;;;wBAInE,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;4BACnC,IAAI,EAAE,UAAU,CAAC,YAAY;4BAC7B,EAAE,IAAA;4BACF,IAAI,EAAE,KAAK;4BACX,KAAK,EAAE,cAAc,CAAC,KAAK;4BAC3B,MAAM,EAAE,cAAc,CAAC,MAAM;4BAC7B,KAAK,EAAE,eAAe,CAAC,KAAK;4BAC5B,MAAM,EAAE,SAAS;yBAClB,CAAC,CAAC;;qBAEJ,CAAC,CAAC;iBACJ,CAAC;;gBAEF,IAAM,WAAW,GAAG,UAAU,CAAC,GAAG,CAAC,UAAC,MAAwB,IAAK,OAAA,MAAM,CAAC,OAAO,GAAA,CAAC,CAAC;;;gBAGjF,IAAI,WAAW,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,MAAM,KAAK,cAAc,CAAC,MAAM,EAAE;;oBAE/D,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;wBACnC,IAAI,EAAE,UAAU,CAAC,YAAY;wBAC7B,IAAI,EAAE,EAAE;qBACT,CAAC,CAAC;;oBAEH,IAAI,SAAS,EAAE;wBACb,IAAM,aAAa,GAAG,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;wBAC1D,aAAa,IAAI,aAAa,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;wBAC3D,IAAM,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;wBAC9B,IAAI,IAAI,EAAE;4BACR,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;yBAClC;qBACF;iBACF;qBAAM;oBAGL,UAAU,CAAC,OAAO,CAAC,UAAC,MAAwB;wBAC1C,IAAI,MAAM,CAAC,OAAO,EAAE;;4BAElB,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC;gCACnC,IAAI,EAAE,UAAU,CAAC,YAAY;gCAC7B,IAAI,EAAE,EAAE;6BACT,CAAC,CAAC;yBACJ;6BAAM;4BACL,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;yBAC7B;qBACF,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;SACJ,CAAC,EACF,SAAS,CAAC,UAAC,UAAU;YACnB,IAAI,WAAW,GAAG,IAAI,CAAC;YACvB,IAAM,MAAM,GAAG,EAAE,CAAC;YAClB,UAAU,CAAC,OAAO,CAAC,UAAC,MAAwB;gBAC1C,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;oBACnB,WAAW,GAAG,KAAK,CAAC;iBACrB;gBACD,MAAM,CAAC,IAAI,OAAX,MAAM,WAAS,MAAM,CAAC,MAAM,GAAE;aAC/B,CAAC,CAAC;YACH,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,KAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE,MAAM,EAAE,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;aAClF;YACD,IAAI,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC;YAC1D,IAAI,OAAO,IAAI,yBAAyB,EAAE;gBACxC,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC;aACpG;;YAED,IAAI,WAAW,IAAI,SAAS,EAAE;gBAC5B,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,GAAG,EAAE,CAAC;aAC5D;YACD,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC3D,IAAI,WAAW,IAAI,SAAS,EAAE;gBAC5B,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;aACjB;iBAAM;gBACL,OAAOC,OAAK,EAAE,CAAC;aAChB;SACF,CAAC,CACH,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;;IAKO,wDAA4B,GAApC,UAAqC,MAAc,EAAE,cAA4B;QAAjF,iBA2BC;;QAzBC,IAAM,KAAK,GAAG,IAAI,CAAC,4BAA4B,CAAC,cAAc,CAAC,CAAC;QAChE,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9B,OAAO,IAAI,CAAC;SACb;;QAED,IAAM,YAAY,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;YAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YACpD,IAAM,WAAW,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;YACxF,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC1C,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;QACH,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,IAAM,YAAU,GAAG,EAAE,CAAC;YACtB,YAAY,CAAC,OAAO,CAAC,UAAC,IAAY;gBAChC,IAAM,aAAa,GAAG,KAAI,CAAC,8BAA8B,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC3E,YAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;aAChC,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,aAAa,EAAE;gBACtB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAI,YAAU,CAAC,IAAI,CAAC,GAAG,CAAC,SAAI,IAAI,CAAC,eAAe,CAAC,gBAAkB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;aACnH;YACD,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC;KACb;;;;;IAKO,0DAA8B,GAAtC,UAAuC,YAAsB;QAC3D,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;QAC9C,IAAI,aAAa,GAAmB,IAAI,CAAC;QACzC,IAAI,SAAS,KAAK,IAAI,EAAE;;YAEtB,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;SACzG;aAAM;;YAEL,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;SACrF;QACD,IAAM,WAAW,GAAG,YAAY,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC1D,IAAM,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,YAA0B,IAAK,OAAA,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,WAAW,GAAA,CAAC,CAAC;QAC1L,IAAM,aAAa,GAAG,YAAY,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,aAAa,IAAI,EAAE,CAAC;QACjG,OAAO,aAAa,CAAC;KACtB;IACO,wDAA4B,GAApC,UAAqC,cAA4B;QAC/D,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,SAAS,CAAC;SAClB;QACD,IAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,gCAAgC,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;QAC7D,OAAO,KAAK,CAAC;KACd;IACO,4DAAgC,GAAxC,UAAyC,cAA4B,EAAE,MAAqB,EAAE,aAA4B;QAA1H,iBAiBC;QAjBsE,uBAAA,EAAA,WAAqB;QAAE,8BAAA,EAAA,kBAA4B;QACxH,IAAM,IAAI,GAAG,cAAc,CAAC,mBAAmB,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QACpE,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,IAAI,CAAC,OAAO,CAAC,UAAC,QAAsB;gBAClC,IAAM,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC;gBACnC,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,UAAU,CAAC,UAAU,KAAK,KAAK,EAAE;oBAC/E,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;oBACjD,KAAI,CAAC,gCAAgC,CAAC,QAAQ,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC;iBACxE;aACF,CAAC,CAAC;SACJ;;QAED,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7C,IAAM,KAAK,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACtC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACpB;QACD,aAAa,CAAC,MAAM,CAAC,CAAC,EAAE,aAAa,CAAC,MAAM,CAAC,CAAC;KAC/C;IACD,mDAAuB,GAAvB,UAAwB,aAAwB,EAAE,MAAyB,EAAE,SAAiB,EAAEC,SAAsB;QAAtH,iBAsCC;QAtC+F,0BAAA,EAAAA,gBAAsB;QACpH,IAAIA,SAAM,EAAE;YACV,aAAa,CAAC,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC;SAClH;QACD,MAAM,CAAC,OAAO,CAAC,UAAC,eAAgC;YAC9C,IAAI,eAAe,CAAC,QAAQ,IAAI,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE;gBAC/D,KAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE,eAAe,CAAC,QAAQ,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;aACzF;YACD,IAAI,EAAE,GAAG,EAAE,CAAC;YACZ,IAAM,MAAM,GAAG,UAAC,MAAW;gBACzB,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE;oBAC3C,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;oBACpB,OAAO;iBACR;qBAAM,IAAI,MAAM,CAAC,YAAY,CAAC,EAAE;oBAC/B,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;iBAC9B;aACF,CAAC;YACF,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;YAC/B,IAAI,eAAe,CAAC,WAAW,EAAE;gBAC/B,IAAM,qBAAqB,GAAG,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;gBACvE,IAAI,qBAAqB,CAAC,MAAM,EAAE;oBAChC,IAAM,MAAM,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC,MAAM,CAAC;oBACpG,IAAI,KAAK,GAAG,aAAa,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC;oBAC7F,KAAK,GAAG,KAAK,KAAK,CAAC,CAAC,GAAG,CAAC,GAAG,KAAK,GAAG,MAAM,CAAC;oBAC1C,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;wBAChD,EAAE,EAAE,EAAE;wBACN,SAAS,WAAA;wBACT,WAAW,EAAE,eAAe,CAAC,KAAK;wBAClC,KAAK,EAAE,eAAe,CAAC,KAAK;wBAC5B,KAAK,EAAE,eAAe,CAAC,YAAY;wBACnC,GAAG,EAAE,eAAe,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;wBAC1D,YAAY,EAAE,eAAe,CAAC,YAAY;wBAC1C,QAAQ,EAAE,eAAe,CAAC,QAAQ;wBAClC,IAAI,EAAE,qBAAqB,CAAC,CAAC,CAAC,KAAK,UAAU,GAAG,OAAO,GAAG,OAAO;qBAClE,CAAC,CAAC;iBACJ;aACF;SACF,CAAC,CAAC;KACJ;;;;IAIM,2CAAe,GAAtB;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QACnC,IAAI,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC;QACrD,IAAI,QAAQ,EAAE;YACZ,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,SAAS,CAAC;SAC1E;QACD,IAAI,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC;QAC1D,IAAI,kBAAkB,CAAC,MAAM,EAAE;YAC7B,IAAM,WAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;YAC9C,IAAI,WAAS,KAAK,IAAI,EAAE;gBACtB,kBAAkB,GAAG,aAAa,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,SAAS,KAAK,WAAS,GAAA,CAAC,CAAC;aACpG;YACD,aAAa,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;;SAEvD;QACD,IAAI,aAAa,IAAI,aAAa,CAAC,mBAAmB,EAAE;YACtD,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SAC5D;QACD,OAAOF,IAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;IAIO,sCAAU,GAAlB;QACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,cAAc,IAAI,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,cAAc,CAAC,uBAAuB,CAAC,IAAI,KAAK,CAAC;KAChP;;;;IAIO,qDAAyB,GAAjC;QACE,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAsB,mBAAmB,EAAE,IAAI,CAAC,KAAK,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAsB,mBAAmB,EAAE,IAAI,CAAC,CAAC;KAC1L;;gBAnlBF,UAAU;;;;gBAfF,UAAU;gBAAU,YAAY;gBAOhC,iBAAiB,uBAmBrB,QAAQ;gBAlBJ,eAAe,uBAmBnB,QAAQ;;IAwkBb,wBAAC;CAplBD;;ACDA;;;;;AAKA;;;;IAgBE,yBACU,kBAAsC,EACtC,YAA0B,EAC1B,cAAkC,EAClC,iBAAoC,EACxB,eAAgC,EAC5C,gBAAkC,EAClC,uBAAgD,EAChD,cAA8B;QAP9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,iBAAY,GAAZ,YAAY,CAAc;QAC1B,mBAAc,GAAd,cAAc,CAAoB;QAClC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACxB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,eAAe,EAAE;YACpB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;QACxE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;KAClD;;;;;;IAOM,8BAAI,GAAX,UAAY,EAAU;QAAtB,iBAgBC;QAfC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC7D,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QACzD,IAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACzC,OAAO,IAAI,CAAC,IAAI,CACd,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACzE,CACF,CACF,CAAC;KACH;;;;;;;IAOM,mCAAS,GAAhB,UAAiB,yBAAiC;QAAlD,iBAiEC;QAhEC,IAAM,KAAK,GAAG,IAAI,CAAC,uBAAuB,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,IAAI,IAAI,CAAC;QACzF,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QACD,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;QAC1E,yBAAyB,GAAG,yBAAyB,IAAI,kBAAkB,CAAC;QAC5E,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YACrD,IAAI,CAAC,uBAAuB,CAAC,cAAc,CAAC,KAAK,EAAE,UAAC,OAAY;gBAC9D,IAAI,IAAI,EAAE;oBACR,IAAI,GAAG,KAAK,CAAC;oBACb,OAAO;iBACR;gBACD,IAAM,MAAM,GAAG,KAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACzC,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE;oBACzB,IAAM,QAAM,GAAG,MAAM,CAAC,MAAM,CAAC;oBAC7B,IAAM,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC;oBACrB,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,SAAS,IAAI,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,IAAI,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,QAAM,CAAC,CAAC;oBAC7J,IAAM,UAAU,GAAG,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,CAAC,yBAAyB,CAAC,IAAI,IAAI,CAAC;oBAC3F,IAAM,gBAAgB,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;oBACtE,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC;oBAC/D,IAAI,KAAK,GAAG,IAAI,CAAC;oBACjB,IAAI,SAAS,SAAQ,CAAC;oBACtB,IAAI,CAAC,UAAU,EAAE;;wBAEf,KAAK,GAAG,SAAS,CAAC;qBACnB;yBACI;wBACH,IAAM,QAAQ,GAAG,KAAI,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,OAAO,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;wBACrO,KAAK,GAAG,QAAQ,IAAI,QAAQ,CAAC,SAAS,IAAI,SAAS,CAAC;wBACpD,SAAS,GAAG,KAAI,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,IAAI,KAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC;wBAC1T,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;4BACvE,IAAM,GAAG,GAAG,SAAS,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;4BAC1D,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;yBAC9D;qBACF;oBACD,IAAM,mBAAmB,GAAG,gBAAgB,KAAK,EAAE,CAAC;oBACpD,IAAM,YAAY,GAAG,SAAS,KAAK,KAAK,CAAC;oBAEzC,IAAI,mBAAmB,IAAI,YAAY,EAAE;;wBAEvC,IAAM,OAAO,GAAG,KAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,OAAO,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;wBACpF,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;4BAC9C,OAAO,KAAI,CAAC,SAAS,CAAC,QAAM,CAAC,CAAC;yBAC/B,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;qBACjB;yBAAM,IAAI,mBAAmB,EAAE;;wBAE9B,KAAI,CAAC,kBAAkB,CAAC,KAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;4BACvE,OAAO,KAAI,CAAC,SAAS,CAAC,QAAM,CAAC,CAAC;yBAC/B,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;qBACjB;yBAAM,IAAI,YAAY,EAAE;;wBAEvB,IAAM,OAAO,GAAG,KAAI,CAAC,eAAe,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;wBAC7E,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;4BAC9C,OAAO,KAAI,CAAC,SAAS,CAAC,QAAM,CAAC,CAAC;yBAC/B,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;qBACjB;yBAAM;;wBAEL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;qBACjB;iBACF;aACF,EAAE,KAAK,CAAC,CAAC;SACX;KACF;;;;IAKM,6BAAG,GAAV;QAAA,iBAiBC;QAhBC,IAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAEvD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;QACzC,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;YACE,aAAa,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;YAC9D,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACxE,CACF,CACF,CAAC;KACH;;;;IAIM,oCAAU,GAAjB;QAAA,iBA4CC;QA3CC,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;;QAEnC,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;;QAE1F,IAAM,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,SAAS,CAAC;;QAElF,IAAM,wBAAwB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,OAAqB,IAAK,OAAA,OAAO,CAAC,SAAS,KAAK,gBAAgB,GAAA,CAAC,IAAI,EAAE,CAAC;QAC/H,IAAI,YAAY,GAAG,EAAE,CAAC;QACtB,IAAI,wBAAwB,IAAI,wBAAwB,CAAC,MAAM,GAAG,CAAC,EAAE;;YAEnE,IAAM,kBAAkB,GAAG,wBAAwB,CAAC,MAAM,CAAC,UAAC,OAAqB,IAAK,OAAA,OAAO,CAAC,SAAS,CAAC,WAAW,IAAI,OAAO,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,GAAA,CAAC,CAAC;YAC9J,IAAI,kBAAkB,IAAI,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE;gBACvD,IAAM,iBAAiB,GAAG,kBAAkB,CAAC,GAAG,CAAC,UAAC,OAAqB,IAAK,OAAA,OAAO,CAAC,SAAS,CAAC,WAAW,GAAA,CAAC,CAAC;gBAC3G,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;oBACrD,YAAY,GAAG,iBAAiB,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,GAAA,CAAC,CAAC;iBAClH;aACF;SACF;QACD,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,IAAI,CAC3B,SAAS,CAAC,UAAC,MAAc;YACvB,IAAM,GAAG,GAAG,MAAM,CAAC,YAAY,CAAC;YAChC,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3C,OAAO,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAC5B,SAAS,CAAC,UAAC,WAAuB;oBAChC,IAAM,KAAK,GAAG,KAAI,CAAC,OAAO,CAAC,KAAI,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,GAAG,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC;oBAC1F,OAAO,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;iBAC5C,CAAC,CACH,CAAC;aACH;iBAAM;gBACL,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;aACnB;SACF,CAAC,CACH,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,SAAS,CACtB;YACE,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;YAC3B,OAAO,CAAC,IAAI,EAAE,CAAC;SAChB,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;YAC3B,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACxE,CAAC,CAAC;QACL,OAAO,OAAO,CAAC;KAChB;;;;IAKM,8BAAI,GAAX,UAAY,EAAW;QAAvB,iBAQC;QAPC,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC9B,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,IAAM,SAAS,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAA;YACjD,aAAa,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;SAC1D,CAAC,CACH,CAAC;KACH;;;;;;IAOM,gCAAM,GAAb,UAAc,EAAW;QAAzB,iBAmBC;;QAjBC,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;QAC/C,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,KAAK,EAAE,CAAC;SAChB;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QAC/C,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAC7D,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;IACM,4CAAkB,GAAzB;;QAEE,IAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;QACrD,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;aAAM;YACL,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC;SACtB;KACF;;;;;IAKM,2CAAiB,GAAxB;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC;QACvD,IAAM,EAAE,GAAG,WAAW,IAAI,WAAW,CAAC,SAAS,CAAC;QAChD,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACtF,OAAO,KAAK,CAAC;SACd;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;IAKM,0CAAgB,GAAvB;;QAEE,IAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;QACrD,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACtF,OAAO,KAAK,CAAC;SACd;aAAM;YACL,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC;SACtB;KACF;;;;;IAKM,mCAAS,GAAhB,UAAiBE,SAAe,EAAE,IAAa;QAA/C,iBAoBC;;QAlBC,IAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;QACrD,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,KAAK,CAAC;SACd;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;;QAErE,IAAM,OAAO,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;QACzB,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;;;;IAIM,8BAAI,GAAX,UAAY,UAAmB;QAA/B,iBAsDC;;QApDC,IAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;QACrD,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;SAClB;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;QACtD,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;QACnD,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI;;QAG1B,SAAS,CAAC,UAAC,YAAqB;YAC9B,IAAI,YAAY,KAAK,KAAK,EAAE;gBAC1B,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;aAClB;iBAAM;gBACL,OAAO,KAAK,CAAC;aACd;SACF,CAAC;;QAGF,GAAG,CAAC;;YAGF,aAAa,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;YAClD,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;;YAErD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;gBACnC,IAAI,WAAW,GAAY,IAAI,CAAC;gBAChC,IAAI,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAC1D,IAAI;wBACF,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;wBACvC,IAAI,OAAO,IAAI,OAAO,CAAC,WAAW,KAAK,KAAK,EAAE;4BAC5C,WAAW,GAAG,KAAK,CAAC;yBACrB;qBACF;oBAAC,WAAM,GAAG;iBACZ;gBACD,IAAI,WAAW,KAAK,KAAK,EAAE;oBACzB,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;aACF;iBAAM;gBACL,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,iBAAiB,EAAE,KAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;aAC7F;;SAEF,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACzE,CACF,CACF,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;;IAQM,gCAAM,GAAb;QACE,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC;KAC/B;;;;;IAMM,gCAAM,GAAb,UAAc,OAAa;QACzB,OAAO,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;KACzC;;;;;;;;;;;IAYM,yCAAe,GAAtB;QAAA,iBAoBC;;QAjBC,IAAM,iBAAiB,GAAG,iBAAiB,CAAC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC/E,IAAI,CAAC,iBAAiB,EAAE;YACtB,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;SAC7B;;QAGD,IAAM,QAAQ,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC;QAC7F,IAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,CAC3B,SAAS,CAAC,UAAC,QAAiB;YAC1B,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACtB,OAAO,KAAK,CAAC;aACd;YACD,OAAO,KAAI,CAAC,aAAa,EAAE,CAAC;SAC7B,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;IAKM,4CAAkB,GAAzB,UAA0B,OAAa;QACrC,OAAO,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;KACpC;;;;IAKO,uCAAa,GAArB,UAAsB,OAAa;QAAnC,iBAeC;QAdC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QACvD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;YACE,aAAa,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;YAClD,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;;;;;IAQM,gCAAM,GAAb;QACE,IAAM,KAAK,GAAG,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAC3D,IAAI,EAAE,CAAC;QACP,IAAI,KAAK,KAAK,IAAI,EAAE;YAClB,EAAE,GAAG,aAAa,CAAC,iBAAiB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SACzD;aAAM;YACL,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;SAChD;QAED,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;YAClD,OAAO;SACR;QAED,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACtB;IACO,iCAAO,GAAf,UAAgB,SAAoB,EAAE,WAAmB,EAAE,GAAW;QACpE,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC;QAErB,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;;;YAGvB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBACxD,IAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAChC,IAAM,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBAC/C,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBAClC,MAAM,KAAK,CAAC,yFAAiB,OAAO,2GAAmB,CAAC,CAAC;iBAC1D;gBACD,IAAI,IAAI,MAAI,OAAO,SAAI,OAAO,CAAC,SAAW,CAAC;aAC5C;SACF;QACD,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;KACb;IACO,mCAAS,GAAjB,UAAkB,MAAc;QAAhC,iBAMC;QALC,IAAM,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;QACrG,OAAO,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC,IAAI,CACtD,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;YACjE,OAAO,iBAAiB,IAAI,iBAAiB,CAAC,eAAe,EAAE,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC;SAC7E,CAAC,CAAC,GAAA,CAAC,CAAC,CAAC;KACT;IACO,qCAAW,GAAnB,UAAoB,OAAY;QAC9B,IAAI,OAAO,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,+BAAmB;YACvE,IAAI,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;YACpD,IAAI,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;gBACxC,MAAM,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;gBACpC,IAAI,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAClD,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;iBAC7B;gBACD,OAAO;oBACL,MAAM,EAAE,MAAM,CAAC,MAAM;oBACrB,EAAE,EAAE,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,EAAE;oBACnD,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,KAAK;iBAC3B,CAAC;aACH;SACF;QACD,OAAO,IAAI,CAAC;KACb;IACO,4CAAkB,GAA1B,UAA2B,OAAe;QACxC,OAAO,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAClD,SAAS,CAAC,UAAC,MAAe;YACxB,IAAI,MAAM,KAAK,IAAI,EAAE;gBACnB,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;iBAAM;gBACL,OAAO,KAAK,CAAC;aACd;SACF,CAAC,CACH,CAAC;KACH;;gBA7fF,UAAU;;;;gBAbF,kBAAkB;gBAPG,YAAY;gBAIjC,kBAAkB;gBAElB,iBAAiB;gBADjB,eAAe,uBAoCnB,QAAQ;gBAjCJ,gBAAgB;gBAGhB,uBAAuB;gBAEvB,cAAc;;IAqgBvB,sBAAC;CA9fD;;ACXA;;;;;AAKA;IAKE,qCACU,iBAAoC,EACpC,YAA0B,EAC1B,UAA8B,EAClB,eAAgC,EAC5C,eAAgC;QAJhC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,iBAAY,GAAZ,YAAY,CAAc;QAC1B,eAAU,GAAV,UAAU,CAAoB;QAClB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,oBAAe,GAAf,eAAe,CAAiB;QAExC,IAAI,CAAC,UAAU,GAAG,YAAY,CAAC,UAAU,CAAC;QAC1C,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;QACD,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;SACjE;KACF;;;;IAIM,+CAAS,GAAhB;QAAA,iBAkCC;QAjCC,IAAI,IAAI,CAAC,UAAU,EAAE,EAAE;YACrB,OAAO;SACR;QACD,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,SAAS,CAAC,YAAY,EAAE,UAAC,OAAO;YACtE,IAAI,KAAI,CAAC,SAAS,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,MAAM,EAAE;;gBAE7C,IAAI,OAAO,IAAI,OAAO,CAAC,iBAAiB,IAAI,OAAO,OAAO,CAAC,iBAAiB,KAAK,UAAU,EAAE;oBAC3F,OAAO,CAAC,iBAAiB,CAAC,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC,CAAC;iBACrD;gBACD,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC,CAAC;;gBAElF,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;gBAC9B,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAC,MAAe;oBACxB,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;oBAC/B,IAAI,MAAM,EAAE;;wBAEV,IAAI,CAAC,CAAC,KAAI,CAAC,eAAe,EAAE;4BAC1B,IAAM,OAAO,GAAG,KAAI,CAAC,eAAe,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;4BACrD,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,cAAM,OAAA,EAAE,CAAC,MAAM,CAAC,GAAA,CAAC,CAC5B,CAAC;yBACH;qBACF;oBACD,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;iBACnB,CAAC,CACH,CAAC;aACH;iBAAM,IAAI,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,UAAU,CAAC,MAAM,EAAE;gBACnD,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;aAClB;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC,CAAC;KACJ;;;;IAIO,gDAAU,GAAlB;QACE,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QACrC,IAAI,qBAAqB,GAAG,YAAY,CAAC,cAAc,CAAC,uBAAuB,CAAC,IAAI,KAAK,CAAC;QAC1F,OAAO,YAAY,CAAC,MAAM,KAAK,IAAI,IAAI,CAAC,qBAAqB,EAAE;YAC7D,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC;YACnC,qBAAqB,GAAG,YAAY,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAC;SAC9E;QACD,OAAO,qBAAqB,CAAC;KAC9B;;;;;;;IAOM,8CAAQ,GAAf,UAAgB,MAAc,EAAE,QAAgB;QAC9C,IAAI,CAAC,CAAC,QAAQ,EAAE;YACd,OAAO,QAAQ,CAAC;SACjB;QACD,IAAI,SAAS,GAAQ,IAAI,CAAC;QAC1B,IAAI,CAAC,CAAC,MAAM,IAAI,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YAC9D,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAChC;QACD,IAAI,OAAO,GAAG,IAAI,CAAC;QACnB,IAAI,SAAS,IAAI,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,EAAE,EAAE;YACjE,OAAO,GAAG,SAAS,CAAC,EAAE,CAAC;SACxB;aAAM;YACL,OAAO,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;SACxB;QACD,OAAO,OAAO,CAAC;KAChB;IAID,sBAAY,kDAAS;;;;aAArB;YACE,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;YAC5D,OAAO,iBAAiB,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;SAC3D;;;OAAA;;gBAlGF,UAAU;;;;gBAVF,iBAAiB;gBACjB,YAAY;gBACZ,kBAAkB;gBAClB,eAAe,uBAgBnB,QAAQ;gBAfJ,eAAe;;IAyGxB,kCAAC;CAnGD;;ACfA;;;;;;AAOA,AASA;;;;;AAKA;IAIE,+BACU,YAA0B,EAC1B,UAA8B,EAClB,eAAgC,EAC5C,SAAoB,EACpB,cAA8B;QAJ9B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,eAAU,GAAV,UAAU,CAAoB;QAClB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,cAAS,GAAT,SAAS,CAAW;QACpB,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;IAIM,8CAAc,GAArB;QACE,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAC3E,SAAS,CAAC,UAAC,MAAe;gBACxB,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO,KAAK,CAAC;iBACd;qBAAM;oBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF,CAAC,CACH,CAAC;SACH;aAAM;YACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;KACF;;;;;;;IAOM,sCAAM,GAAb,UAAc,WAAmB,EAAE,OAAe;QAChD,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;QAC5D,IAAI,QAAQ,OAAO,CAAC,KAAK,QAAQ,EAAE;YACjC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC/B;;QAED,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,GAAG,CAAC,CAAC;QACtE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,sBAAsB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;QACjH,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;KAC1D;IAID,sBAAY,4CAAS;;;;aAArB;YACE,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;YAC5D,OAAO,iBAAiB,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;SAC3D;;;OAAA;;gBAzDF,UAAU;;;;gBAXF,YAAY;gBACZ,kBAAkB;gBAClB,eAAe,uBAgBnB,QAAQ;gBAlBsB,SAAS;gBAInC,cAAc;;IAiEvB,4BAAC;CA1DD;;AChBA;;;;;AAKA;IAEE,sBACU,kBAAsC,EACtC,uBAAgD;QADhD,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,4BAAuB,GAAvB,uBAAuB,CAAyB;KACrD;IAIL,sBAAW,gCAAM;;;;aAAjB;YAAA,iBA2CC;;YAzCC,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;YAClC,IAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;;;;;;;;;;;;;;;;;YAiBnD,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;YAC3B,IAAI,CAAC,KAAK,EAAE;;gBAEV,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;aACnB;YACD,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;;YAEnC,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,KAAK,EAAE,UAAC,CAAM;gBAC1D,IAAIJ,MAAG,GAAG,EAAE,CAAC;gBACb,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,IAAI,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,UAAU,IAAI,OAAO,CAAC,CAAC,SAAS,CAAC,KAAK,UAAU,CAAC,EAAE;oBACrGA,MAAG,GAAG,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;iBAC9B;gBACD,IAAI,IAAI,GAAG,EAAE,CAAC;gBACd,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,IAAI,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,UAAU,IAAI,OAAO,CAAC,CAAC,SAAS,CAAC,KAAK,UAAU,CAAC,EAAE;oBACrG,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC;iBACnB;qBAAM;oBACL,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;iBAC7B;gBACD,UAAU,CAAC;oBACT,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAEA,MAAG,EAAE,MAAM,CAAC,CAAC,CAAC;iBACpD,EAAE,CAAC,CAAC,CAAC;aACP,EAAE,MAAM,CAAC,CAAC;YACX,OAAO,OAAO,CAAC,YAAY,EAAE,CAAC;SAC/B;;;OAAA;;;;;IAKO,qCAAc,GAAtB,UAAuB,MAAqB;QAC1C,IAAMA,MAAG,GAAG,EAAE,CAAC;QACfA,MAAG,CAAC,uBAAuB,CAAC,GAAG,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC,CAAC;QACvF,MAAM,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,GAAG;YACxB,IAAI,GAAG,KAAK,uBAAuB,EAAE;gBACnCA,MAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;aAClB;SACF,CAAC,CAAC;QACH,OAAOA,MAAG,CAAC;KACZ;;;;;IAKM,0BAAG,GAAV,UAAW,KAAa;QACtB,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CACrB,SAAS,CAAC,UAAA,OAAO;YACf,IAAI,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;gBAC9C,OAAO,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aAC1B;iBAAM;gBACL,OAAO,EAAE,CAAC,SAAS,CAAC,CAAC;aACtB;SACF,CAAC,CACH,CAAC;KACH;;;;IAIM,4BAAK,GAAZ;QACE,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CACrB,SAAS,CAAC,UAAA,OAAO;YACf,OAAO,EAAE,CAAC,OAAO,CAAC,CAAC;SACpB,CAAC,CACH,CAAC;KACH;;gBA3FF,UAAU;;;;gBATF,kBAAkB;gBAClB,uBAAuB;;IAoGhC,mBAAC;CA5FD;;AC+DA;;;;AAIA;IAME;QACE,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,EAAiC,CAAC;QACvD,IAAI,CAAC,eAAe,GAAGK,kBAAiB,CAAC;QACzC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;KACnB;;;;;IAMM,gCAAI,GAAX,UAAY,SAAoB;QAAhC,iBAMC;QALC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,UAAC,UAAU,EAAE,MAAM;YACjD,KAAI,CAAC,QAAQ,CAAC,UAAU,EAAE;gBACxB,OAAO,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC;aAC5B,CAAC,CAAC;SACJ,CAAC,CAAC;KACJ;;;;;;IAOM,oCAAQ,GAAf,UAAgB,OAAmB,EAAE,OAA8B;QACjE,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACpC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YAChC,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;;gBAE1D,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,CAAC;aACtE;iBAAM;gBACL,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aAC7D;SACF;KACF;;;;;IAMM,sCAAU,GAAjB,UAAkB,OAAmB;QACnC,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACpC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC1B,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SACpC;KACF;IAEO,qCAAS,GAAjB,UAAkB,CAAgB;QAAlC,iBAgBC;QAfC,IAAI,CAAC,CAAC,MAAM;YAAE,OAAO,KAAK,CAAC;QAC3B,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACnC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;gBACnB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,SAAS,CAAC;oBACjC,KAAI,CAAC,KAAK,GAAG,IAAI,CAAC;iBACnB,EAAE,UAAC,KAAK;oBACP,KAAI,CAAC,KAAK,GAAG,IAAI,CAAC;iBACnB,EAAE;oBACD,KAAI,CAAC,KAAK,GAAG,IAAI,CAAC;iBACnB,CAAC,CAAC;aACJ;SACF;QACD,OAAO,KAAK,CAAC;KACd;;;;;IAMO,qCAAS,GAAjB,UAAkB,OAAmC;QACnD,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;QACpC,IAAI,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,gBAAe;YACvF,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC5B,OAAO,IAAI,CAAC;SACb;QACD,IAAI,KAAK,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,OAAO,GAAG,EAAE;eACtC,OAAO,CAAC,QAAQ,GAAG,QAAQ,GAAG,EAAE,CAAC;eACjC,OAAO,CAAC,MAAM,GAAG,MAAM,GAAG,EAAE,CAAC;eAC7B,OAAO,CAAC,OAAO,GAAG,OAAO,GAAG,EAAE,CAAC;cAChC,GAAG,CAAC;QAER,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;YACrB,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;YACnC,OAAO,IAAI,CAAC;SACb;QAED,OAAO,KAAK,CAAC;KACd;;gBA9FF,UAAU;;;;IA+FX,wBAAC;CA/FD;;AC7EA;AACA,AAEA;;;AAGA;IAAA;KAEC;;gBAFA,UAAU;;IAEX,6BAAC;CAFD;;ACJA;;;;AAIA;IAGE;KACC;IAED,iCAAQ,GAAR,UAAS,WAAmB,EAAE,SAAiB;QAC7C,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;KACpC;IAED,iCAAQ,GAAR,UAAS,WAAmB,EAAE,SAAiB,EAAE,KAAU;QACzD,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;KACpC;;gBAZF,UAAU;;;;IAaX,qBAAC;CAbD;;ACJA;;;;;AAKA;IAGE,6BACU,YAA0B;QADpC,iBAQC;QAPS,iBAAY,GAAZ,YAAY,CAAc;QAS5B,oBAAe,GAAG,sBAAsB,CAAC;QACzC,cAAS,GAAG,IAAI,CAAC;QARvB,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,KAAK,MAAM,EAAE;YAClD,MAAM,CAAC,UAAU,CAAC;gBAChB,KAAI,CAAC,aAAa,EAAE,CAAC;aACtB,EAAE,CAAC,CAAC,CAAC;SACP;KACF;IAMD,qCAAO,GAAP,UAAQ,MAAc;QACpB,IAAI,MAAM,IAAI,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;YAC7D,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC;YAC5B,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,CAAC;YAC/E,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;aACxB;YACD,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;gBAC9B,OAAO;aACR;YACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;YAC3F,IAAI,CAAC,CAAC,uBAAuB,EAAE;gBAC7B,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,uBAAuB,CAAC,CAAC;aACvD;SACF;KACF;IAEO,wDAA0B,GAAlC,UAAmC,mBAAiC;QAClE,IAAI,uBAAqC,CAAC;QAC1C,IAAI,CAAC,sBAAsB,EAAE,CAAC,OAAO,CAAC,UAAC,MAAoB;YACzD,IAAI,mBAAmB,CAAC,SAAS,KAAK,MAAM,CAAC,SAAS,EAAE;gBACtD,uBAAuB,GAAG,MAAM,CAAC;aAClC;SACF,CAAC,CAAA;QACF,OAAO,uBAAuB,CAAC;KAChC;IAEO,uDAAyB,GAAjC;QACE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE;YACvD,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,UAAwB,CAAC;YAC3E,IAAI,UAAU,EAAE;gBACd,IAAM,mBAAmB,GAAG,UAAU,CAAC,mBAAmB,CAAC;gBAC3D,OAAO,mBAAmB,CAAC,kBAAkB,EAAE,CAAC;aACjD;SACF;QACD,OAAO,IAAI,CAAC;;KAEb;IAEO,oDAAsB,GAA9B;QACE,IAAM,mBAAmB,GAAG,EAAE,CAAC;QAC/B,IAAM,aAAa,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;QACvD,IAAI,aAAa,EAAE;YACjB,aAAa,CAAC,OAAO,CAAC,UAAA,IAAI;gBACxB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,MAAM,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC,EAAE;oBAC3I,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAChC;aACF,CAAC,CAAA;SACH;QACD,OAAO,mBAAmB,CAAC;KAC5B;IAEO,2CAAa,GAArB;QAAA,iBAaC;QAZC,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE,EAAE;YACrC,OAAO;SACR;QACD,IAAI,CAAC,sBAAsB,EAAE,CAAC,OAAO,CAAC,UAAC,MAAoB;YACzD,IAAM,aAAa,GAAG,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;YAChF,IAAI,CAAC,aAAa,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE;gBAClD,OAAO;aACR;YACD,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,CAAC,qBAAqB,CAAC,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,CAAC,mBAAmB,CAAC,EAAE;gBAC3N,KAAI,CAAC,WAAW,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,CAAC;aACvD;SACF,CAAC,CAAA;KACH;IAEO,6CAAe,GAAvB,UAAwB,MAAc,EAAE,YAA0B;QAAlE,iBAiBC;QAhBC,IAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;QACtF,IAAI,CAAC,aAAa,IAAI,CAAC,aAAa,CAAC,aAAa,IAAI,CAAC,MAAM,EAAE;YAC7D,OAAO;SACR;QACD,MAAM,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;QAC9B,IAAI,MAAM,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACjD,IAAI,MAAM,KAAK,QAAQ,EAAE;gBACvB,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,qBAAqB,CAAC,CAAC;aACxD;iBAAM,IAAI,MAAM,KAAK,MAAM,EAAE;gBAC5B,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,mBAAmB,CAAC,CAAC;aACtD;YACD,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;SAC1D;aAAM;YACL,CAAC,qBAAqB,EAAE,mBAAmB,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,GAAA,CAAC,CAAC;YACvG,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;SACvD;KACF;IACO,yCAAW,GAAnB,UAAoB,UAAsB,EAAE,SAAiB;QAC3D,IAAI,CAAC,UAAU,IAAI,CAAC,SAAS,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE;YAC1D,OAAO;SACR;QACD,IAAM,iBAAiB,GAAW,UAAU,CAAC,aAAa,CAAC,SAAS,IAAI,EAAE,CAAC;QAC3E,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;YAC1C,UAAU,CAAC,aAAa,CAAC,SAAS,GAAM,iBAAiB,SAAI,SAAW,CAAC;SAC1E;KACF;IACO,4CAAc,GAAtB,UAAuB,UAAsB,EAAE,SAAiB;QAC9D,IAAI,CAAC,UAAU,IAAI,CAAC,SAAS,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE;YAC1D,OAAO;SACR;QACD,IAAM,iBAAiB,GAAW,UAAU,CAAC,aAAa,CAAC,SAAS,IAAI,EAAE,CAAC;QAC3E,IAAI,iBAAiB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;YACzC,UAAU,CAAC,aAAa,CAAC,SAAS,GAAG,iBAAiB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,IAAI,CAAC,KAAK,SAAS,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC/G;KACF;IACO,kDAAoB,GAA5B;QACE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE;YACvD,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC;YACnD,IAAI,WAAW,EAAE;gBACf,IAAM,kBAAkB,GAAG,WAAW,CAAC,0BAA0B,EAAE,CAAC;gBACpE,IAAI,kBAAkB,EAAE;oBACtB,IAAM,QAAQ,GAAG,kBAAkB,CAAC,QAAQ,CAAC;oBAC7C,IAAI,OAAO,QAAQ,CAAC,GAAG,KAAK,UAAU,EAAE;wBACtC,OAAO,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;qBACnD;iBACF;aACF;SACF;QACD,OAAO,IAAI,CAAC;;KAEb;;gBAxIF,UAAU;;;;gBANF,YAAY;;IA+IrB,0BAAC;CAzID;;ACJA;;;;AAIA;;;;IAME,4BACU,WAAwB,EACxB,UAAsB;QADtB,gBAAW,GAAX,WAAW,CAAa;QACxB,eAAU,GAAV,UAAU,CAAY;KAC3B;;;;IAKL,yCAAY,GAAZ,UAAa,EAAU,EAAE,OAAe;;;;;;;;QAStC,IAAM,aAAa,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,mBAAmB,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC;QACjF,aAAa,CAAC,OAAO,CAAC,UAAC,YAA0B;YAC/C,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;YAC7C,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;SAChD,CAAC,CAAC;KACJ;IACM,0CAAa,GAApB,UAAqB,EAAU,EAAE,OAAe;QAC9C,IAAI,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QACnC,IAAI,OAAO,EAAE;YACX,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;YAC/D,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC;SACzC;QACD,WAAW,CAAC,OAAO,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;KACxC;;gBApCF,UAAU;;;;gBANU,WAAW;gBAAvB,UAAU;;IA2CnB,yBAAC;CArCD;;ACGA;;;;AAKA;IAGE,iCACsB,YAA0B,EAC1B,uBAAgD;QADhD,iBAAY,GAAZ,YAAY,CAAc;QAC1B,4BAAuB,GAAvB,uBAAuB,CAAyB;QAEpE,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;YACjC,IAAI,CAAC,uBAAuB,GAAG,IAAI,uBAAuB,EAAE,CAAC;SAC9D;KACF;;;;IAIM,6CAAW,GAAlB,UAAmB,KAAqB,EAAE,gBAAkC,EAAE,SAAoB,EAAE,QAAoB;QAAxH,iBAaC;QAZC,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,MAAW;gBACpD,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,gBAAgB,EAAE,SAAS,EAAE,eAAe,CAAC,CAAC;aACxE,CAAC,CAAC;SACJ;aAAM;YACL,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;gBACtD,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,gBAAgB,EAAE,SAAS,EAAE,eAAe,CAAC,CAAC;aACxE,CAAC,CAAC;SACJ;KACF;;;;IAKO,6CAAW,GAAnB,UAAoB,MAAM,EAAE,gBAAkC,EAAE,SAAoB,EAAE,QAAoB;QACxG,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAC3C,IAAI,CAAC,WAAW,EAAE;YAChB,QAAQ,EAAE,CAAC;YACX,OAAO;SACR;;QAGD,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;QAE5C,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC3C,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QACzC,IAAI,CAAC,MAAM,IAAI,CAAC,KAAK,EAAE;YACrB,QAAQ,EAAE,CAAC;YACX,OAAO;SACR;QAED,IAAI,MAAM,EAAE;YACV,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;SAClF;aAAM;YACL,QAAQ,EAAE,CAAC;SACZ;KACF;;;;IAIO,gDAAc,GAAtB,UAAuB,WAAgB,EAAE,SAAoB;QAC3D,IAAM,iBAAiB,GAAG,EAAE,CAAC;;;QAG7B,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAC9C,IAAM,OAAO,GAAG,SAAS,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;;QAEpF,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,UAAC,SAAiB;YACjD,IAAI,CAAC,UAAU,EAAE;gBACf,iBAAiB,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC;aACvD;iBAAM;gBACL,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE;oBACtC,iBAAiB,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC;iBACvD;aACF;SACF,CAAC,CAAC;QACH,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,iBAAiB,CAAC,CAAC;KAClD;;;;IAKO,iDAAe,GAAvB,UACE,MAAc,EAAE,WAAgB,EAAE,gBAAkC,EAAE,SAAoB,EAAE,QAAoB;QADlH,iBAYC;QATC,IAAI,CAAC,uBAAuB,CAAC,aAAa,CAAC,MAAM,EAAE,UAAC,WAAW;YAC7D,IAAM,eAAe,GAAG,KAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;YAC1F,IAAI,CAAC,eAAe,EAAE;gBACpB,QAAQ,EAAE,CAAC;gBACX,OAAO;aACR;YACD,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;YAC/C,QAAQ,EAAE,CAAC;SACZ,CAAC,CAAC;KACJ;;;;;;IAOO,yDAAuB,GAA/B,UAAgC,YAA2B,EAAE,WAAgB,EAAE,SAAqB;QAClG,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO;SACR;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAC5C,IAAM,OAAO,GAAG,SAAS,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;QACpF,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,YAAY,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,GAAG,EAAEL,MAAG;YACnC,IAAI,CAAC,QAAQ,EAAE;;gBAEb,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBACpC,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;iBACrB;aACF;iBAAM;gBACL,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBACpE,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;iBACrB;aACF;SACF,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;KACf;;;;;IAKO,4CAAU,GAAlB,UAAmB,SAAoB;QACrC,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,EAAE;;YAElC,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,IAAI,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,cAAc,CAAC,eAAe,CAAC,IAAI,SAAS,CAAC,OAAO,CAAC,eAAe,CAAC,EAAE;gBACpI,UAAU,GAAG,IAAI,CAAC;aACnB;SACF;QACD,OAAO,UAAU,CAAC;KACnB;;;;IAIO,+CAAa,GAArB,UAAsB,SAAoB,EAAE,MAAW;QAAvD,iBAmBC;QAlBC,IAAI,CAAC,SAAS,IAAI,CAAC,MAAM,EAAE;YACzB,OAAO;SACR;QACD,IAAM,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;;QAGlC,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,KAAK,EAAE,EAAE;YAC/C,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC7B;;QAGD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAC,QAAgB;YAC3C,OAAO,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;YACrD,IAAI,QAAQ,IAAI,QAAQ,KAAK,eAAe,EAAE;gBAC5C,IAAI,WAAW,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;gBACnC,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;aAC7C;SACF,CAAC,CAAC;KACJ;IACO,gDAAc,GAAtB,UAAuB,SAAoB,EAAE,WAAgB;QAC3D,IAAI,CAAC,SAAS,IAAI,CAAC,WAAW,EAAE;YAC9B,OAAO;SACR;QACD,IAAI,WAAW,IAAI,OAAO,WAAW,KAAK,QAAQ,IAAI,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YAC9G,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;SACvC;QACD,IAAM,KAAK,GAAG,WAAW,IAAI,WAAW,CAAC,KAAK,IAAI,IAAI,CAAC;QACvD,IAAM,SAAS,GAAG,WAAW,IAAI,WAAW,CAAC,SAAS,IAAI,IAAI,CAAC;QAC/D,IAAI,KAAK,EAAE;YACT,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,KAAK,GAAG,KAAK,CAAC;SACjD;QACD,IAAI,SAAS,EAAE;YACb,IAAM,aAAa,GAAG,SAAS,CAAC,YAAY,CAAC,UAAgC,CAAC;YAC9E,IAAI,aAAa,EAAE;gBACjB,aAAa,CAAC,WAAW,CAAC,cAAc,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;aACpE;SACF;KACF;;;;IAIO,2CAAS,GAAjB,UAAkB,WAAgB;QAChC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACD,OAAO,WAAW,CAAC,QAAQ,CAAC,CAAC;KAC9B;;;;IAKO,0CAAQ,GAAhB,UAAiB,WAAgB;QAC/B,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACD,OAAO,WAAW,CAAC,OAAO,CAAC,CAAC;KAC7B;IACO,0CAAQ,GAAhB,UAAiB,WAAgB;QAC/B,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACD,OAAO,WAAW,CAAC,OAAO,CAAC,CAAC;KAC7B;;;;;IAKO,2CAAS,GAAjB,UAAkB,WAAgB;QAChC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,EAAE,CAAC;SACX;QACD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,WAAW,CAAC,cAAc,CAAC,uBAAuB,CAAC,EAAE;YACvD,IAAI,kBAAkB,GAAW,WAAW,CAAC,uBAAuB,CAAC,CAAC;YACtE,IAAI,kBAAkB,IAAI,kBAAkB,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBAChG,kBAAkB,GAAG,SAAS,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;gBACnI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;aACzC;YACD,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;gBACnC,IAAI,IAAI,KAAK,uBAAuB,EAAE;oBACpC,MAAM,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;iBAClC;aACF,CAAC,CAAC;YACH,OAAO,MAAM,CAAC;SACf;QACD,OAAO,WAAW,CAAC;KACpB;IACO,iDAAe,GAAvB,UAAwB,QAAQ;QAAhC,iBAoBC;QAnBC,OAAO;YACL,IAAI;gBACF,IAAM,WAAW,GAAG,KAAI,CAAC,SAAS,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC;gBAChD,IAAM,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;gBACzC,IAAI,KAAK,EAAE;oBACT,IAAM,YAAY,GAAG,KAAI,CAAC,uBAAuB,CAAC,yBAAyB,EAAE,CAAC;oBAC9E,IAAI,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,EAAE;wBAC9C,YAAY,CAAC,SAAS,CAAC,UAAC,KAAU;4BAChC,IAAI,KAAK,EAAE;gCACT,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;6BAClB;yBACF,CAAC,CAAC;qBACJ;iBACF;aACF;YAAC,OAAO,CAAC,EAAE;gBAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aAAE;YAChC,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;gBAC9C,QAAQ,EAAE,CAAC;aACZ;SACF,CAAA;KACF;;gBArPF,UAAU;;;;gBAVF,YAAY,uBAchB,QAAQ;gBAbJ,uBAAuB,uBAc3B,QAAQ;;IAiPb,8BAAC;CAtPD;;ACZA;;;;;AAKA;IAOE,iCAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;KAC7C;IALD,sBAAY,gDAAW;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;;;;IAQM,8CAAY,GAAnB,UAAoB,IAAc;QAChC,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KACxC;;;;IAKM,+CAAa,GAApB,UAAqB,IAAc;QACjC,IAAI,UAAyB,CAAC;QAC9B,IAAM,mBAAmB,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QAC5D,IAAI,mBAAmB,YAAY,WAAW,KAAK,IAAI,EAAE;YACvD,UAAU,GAAG,mBAAmB,CAAC,WAAW,CAAC;SAC9C;aAAM;YACL,UAAU,GAAG,mBAAmB,CAAC;SAClC;QACD,OAAO,UAAU,CAAC,MAAM,EAAE,CAAC;KAC5B;;;;IAKM,mDAAiB,GAAxB,UAAyB,IAAc;QACrC,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAgB,CAAC;QACnE,OAAO,WAAW,CAAC,MAAM,EAAE,CAAC;KAC7B;;gBArCF,UAAU;;;;gBAPF,YAAY;;IA8CrB,8BAAC;CAvCD;;;ICEE,mCAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;KAC7C;IALD,sBAAY,kDAAW;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;;;;IAQM,gDAAY,GAAnB,UAAoB,IAAc,EAAE,KAAU;;QAG5C,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KACpD;;gBAjBF,UAAU;;;;gBAFF,YAAY;;IAqBrB,gCAAC;CAnBD;;ACMA;;;AAGA;IASE,kCAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAC5C,IAAI,CAAC,iBAAiB,GAAK,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAA0B,uBAAuB,CAAC,CAAC;KAC7G;IARD,sBAAY,iDAAW;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;;;;IAWM,wCAAK,GAAZ,UAAa,IAAc;QACzB,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACzC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACtF,OAAO,cAAc,CAAC,MAAM,CAAC;KAC9B;;;;IAKM,sCAAG,GAAV,UAAW,IAAc;QAAzB,iBAWC;QAVC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACzC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAEtF,IAAM,KAAK,GAAG,cAAc,CAAC,MAAM,CAAC,UAAC,QAAgB,EAAE,UAAe;YACpE,IAAI,SAAS,GAAG,UAAU,CAAC,KAAI,CAAC,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;YAChF,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;YAC7C,QAAQ,IAAI,SAAS,CAAC;YACtB,OAAO,QAAQ,CAAC;SACjB,EAAE,CAAC,CAAC,CAAC;QACN,OAAO,KAAK,CAAC;KACd;;;;IAKM,sCAAG,GAAV,UAAW,IAAc;QACvB,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC7B,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,GAAG,KAAK,GAAG,CAAC,CAAC;KACxC;;;;IAKM,sCAAG,GAAV,UAAW,IAAc;QAAzB,iBAYC;QAXC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACzC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAEtF,IAAM,GAAG,GAAI,cAAc,CAAC,MAAM,CAAC,UAAC,MAAc,EAAE,UAAe;YACjE,IAAM,SAAS,GAAG,UAAU,CAAC,KAAI,CAAC,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;YAClF,IAAI,KAAK,CAAC,SAAS,CAAC,KAAK,KAAK,KAAM,CAAC,MAAM,IAAI,SAAS,GAAG,MAAM,CAAC,EAAE;gBAClE,MAAM,GAAG,SAAS,CAAC;aACpB;YACD,OAAO,MAAM,CAAC;SACf,EAAE,IAAI,CAAC,CAAC;QACT,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;KACtB;;;;IAKM,sCAAG,GAAV,UAAW,IAAc;QAAzB,iBAYC;QAXC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACzC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAEtF,IAAM,GAAG,GAAG,cAAc,CAAC,MAAM,CAAC,UAAC,MAAc,EAAE,UAAe;YAChE,IAAM,SAAS,GAAG,UAAU,CAAC,KAAI,CAAC,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;YAClF,IAAI,KAAK,CAAC,SAAS,CAAC,KAAK,KAAK,KAAM,CAAC,MAAM,IAAI,SAAS,GAAG,MAAM,CAAC,EAAE;gBAClE,MAAM,GAAG,SAAS,CAAC;aACpB;YACD,OAAO,MAAM,CAAC;SACf,EAAE,IAAI,CAAC,CAAC;QACT,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;KACtB;;;;IAKO,+CAAY,GAApB,UAAqB,UAAe,EAAE,IAAc;QAClD,IAAI,WAAW,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,OAAO,CAAC,UAAC,QAAgB;;YAG5B,IAAI,CAAC,WAAW,EAAE;gBAChB,WAAW,GAAG,IAAI,CAAC;gBACnB,OAAO;aACR;YACD,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,CAAC;SACrC,CAAC,CAAC;QAEH,OAAO,WAAW,CAAC;KACpB;;;;;IAMO,4CAAS,GAAjB,UAAkB,IAAc;QAC9B,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QACjC,IAAM,QAAQ,GAAG,EAAE,CAAC;QACpB,IAAI,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACtD,OAAO,WAAW,YAAY,WAAW,KAAK,IAAI,EAAE;YAClD,IAAM,YAAY,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC;YACpC,IAAI,CAAC,YAAY,EAAE;gBACjB,OAAO;aACR;YACD,QAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;YAC/B,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SACnD;QAED,OAAO;YACL,QAAQ,EAAE,QAAQ;YAClB,QAAQ,EAAE,QAAQ;SACnB,CAAC;KACH;;gBAxHF,UAAU;;;;gBAXF,YAAY;;IAqIrB,+BAAC;CA1HD;;ACZA;;;;;;AAMA,AAGA;;;;AAIA;IAGE,2BAAoB,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;KAAI;IAK9C,sBAAW,wCAAS;;;;aAApB;YACI,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;SAC1C;;;OAAA;IAKD,sBAAW,uCAAQ;;;;aAAnB;YACI,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC;SACzC;;;OAAA;;gBAjBJ,UAAU;;;;gBANF,WAAW;;IAwBpB,wBAAC;CAlBD;;ACPA;;;;AAIA;IASE,uBAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAC5C,IAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;QAC5C,IAAI,CAAC,iBAAiB,GAAK,QAAQ,CAAC,GAAG,CAA0B,uBAAuB,CAAC,CAAC;QAC1F,IAAI,CAAC,mBAAmB,GAAG,QAAQ,CAAC,GAAG,CAA4B,yBAAyB,CAAC,CAAC;QAC9F,IAAI,CAAC,kBAAkB,GAAI,QAAQ,CAAC,GAAG,CAA2B,wBAAwB,CAAC,CAAC;KAC7F;;;;IAKM,oCAAY,GAAnB,UAAoB,IAAc;QAChC,OAAO,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;KAClD;;;;IAKM,oCAAY,GAAnB,UAAoB,IAAc,EAAE,KAAU;QAC5C,OAAO,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;KAC3D;;;;IAKM,qCAAa,GAApB,UAAqB,IAAc;QACjC,OAAO,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;KACnD;;;;IAKM,yCAAiB,GAAxB,UAAyB,IAAc;QACrC,OAAO,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;KACvD;;;;IAKM,6BAAK,GAAZ,UAAa,IAAc;QACzB,OAAO,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;KAC5C;;;;IAKM,2BAAG,GAAV,UAAW,IAAc;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KAC1C;;;;IAKM,2BAAG,GAAV,UAAW,IAAc;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KAC1C;;;;IAKM,2BAAG,GAAV,UAAW,IAAc;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KAC1C;;;;IAKM,2BAAG,GAAV,UAAW,IAAc;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KAC1C;;gBA7EF,UAAU;;;;gBATF,YAAY;;IAuFrB,oBAAC;CA9ED;;;ICLE,4BAAoB,QAAkB,EAAU,UAAsB,EAAU,UAA8B;QAA1F,aAAQ,GAAR,QAAQ,CAAU;QAAU,eAAU,GAAV,UAAU,CAAY;QAAU,eAAU,GAAV,UAAU,CAAoB;KAAK;;;;;;IAM5G,0DAA6B,GAApC,UAAqC,YAA0B;QAC7D,OAAO,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,IAAI,IAAI,CAAC;KAC7J;;;;;;;;;IASM,uDAA0B,GAAjC,UAAkC,YAA0B,EAAE,SAAiB,EAAE,KAAoB,EAAE,KAAiB;QAAvC,sBAAA,EAAA,UAAoB;QAAE,sBAAA,EAAA,SAAiB;QACtH,KAAK,EAAE,CAAC;QACR,IAAI,YAAY,CAAC,UAAU,KAAK,YAAY,CAAC,UAAU,CAAC,QAAQ,KAAK,SAAS,IAAI,YAAY,CAAC,UAAU,CAAC,YAAY,KAAK,SAAS,CAAC,EAAE;YACrI,IAAI,KAAK,KAAK,CAAC,EAAE;gBACf,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;aAC9C;YACD,OAAO,KAAK,CAAC;SACd;QACD,IAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,QAAQ,GAAA,CAAC,CAAC;QACpF,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACpB,KAAK,GAAG,EAAE,CAAC;YACX,OAAO,KAAK,CAAC;SACd;QACD,IAAI,YAAY,CAAC,UAAU,EAAE;YAC3B,IAAI,KAAK,KAAK,CAAC,EAAE;gBACf,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;aAC9C;SACF;QAED,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;YAC3C,IAAM,cAAY,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC;YACzC,IAAM,IAAI,GAAG,IAAI,CAAC,0BAA0B,CAAC,cAAY,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;YACpF,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC5B,SAAS;aACV;iBAAM;gBACL,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;gBAC3B,OAAO,KAAK,CAAC;aACd;SACF;QACD,OAAO,IAAI,CAAC;KACb;;;;;;;IAOM,kDAAqB,GAA5B,UAA6B,KAAwB,EAAE,cAA4B;QACjF,IAAI,SAAS,GAAG,EAAE,CAAC;QACnB,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;SACzC;QACD,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QACzB,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACvB,IAAM,YAAY,GAAG,cAAc,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;YAC7D,IAAI,YAAY,CAAC,KAAK,KAAK,MAAM,EAAE;gBACjC,SAAS,GAAG,KAAK,CAAC;gBAClB,MAAM;aACP;YACD,KAAK,CAAC,GAAG,EAAE,CAAC;SACb;QACD,OAAO,SAAS,CAAC;KAClB;;;;;;IAMM,wCAAW,GAAlB,UAAmB,IAAY;QAC7B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAE7C,IAAM,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QACrF,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC9D,OAAO,EAAE,WAAW,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,YAAY,cAAA,EAAE,YAAY,EAAE,UAAU,EAAE,aAAa,EAAE,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,EAAE,CAAC;KAC7I;;gBAnFF,UAAU;;;;gBAHU,QAAQ;gBACpB,UAAU;gBAAsC,UAAU;;IAsFnE,yBAAC;CApFD;;;ICEE;KAAiB;IACV,0DAA6B,GAApC,UAAqC,YAA0B;QAC7D,OAAO,YAAY,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC;KACtF;;;;;;;IAOM,oDAAuB,GAA9B,UAA+B,YAA0B,EAAE,OAAe;QACxE,IAAM,cAAc,GAAG,IAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,UAAC,aAA4B,IAAK,OAAA,aAAa,IAAI,aAAa,CAAC,OAAO,KAAK,OAAO,GAAA,CAAC,CAAC;KAEjI;;;;;;;IAOM,0DAA6B,GAApC,UAAqC,YAA0B,EAAE,QAAgB;QAC/E,IAAM,cAAc,GAAG,IAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QACpD,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,SAAS,CAAC,UAAC,aAA4B;YAC1E,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO,KAAK,CAAC;aACd;YACD,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;YACvD,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAC3D,IAAM,uBAAuB,GAAG,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAChF,IAAM,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;YAC9D,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAClD,CAAC,CAAC;KACJ;;;;;;;IAOM,yDAA4B,GAAnC,UAAoC,YAA0B,EAAE,OAAe;QAC7E,IAAM,cAAc,GAAG,IAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,SAAS,CAAC,UAAC,aAA4B,IAAK,OAAA,aAAa,IAAI,aAAa,CAAC,OAAO,KAAK,OAAO,GAAA,CAAC,CAAC;KACtI;;gBAvDF,UAAU;;;;IAwDX,yBAAC;CAxDD;;;ICIE,6BACU,QAAkB,EAClB,UAAsB,EACtB,YAA0B,EAC1B,UAA8B,EAC9B,kBAAsC,EACtC,kBAAsC;QALtC,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAY;QACtB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,eAAU,GAAV,UAAU,CAAoB;QAC9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,uBAAkB,GAAlB,kBAAkB,CAAoB;KACzC;;;;;;IAMA,yDAA2B,GAAlC,UAAmC,SAAiB;QAClD,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;SACpC;QACD,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,IAAI,IAAI,CAAC;QAC/E,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,YAAY,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,kBAAkB,CAAC,0BAA0B,CAAC,YAAY,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;QAC1F,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,IAAI,EAAE,CAAC;QACtG,IAAI,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;YAChD,OAAO,IAAI,CAAC;SACb;QACD,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B,IAAK,OAAA,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,GAAA,CAAC,CAAC;KAC1M;;;;;;;IAOM,4DAA8B,GAArC,UAAsC,YAAoB,EAAE,QAAsB;QAAtB,yBAAA,EAAA,cAAsB;QAChF,IAAI,CAAC,YAAY,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;SACvC;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,IAAI,EAAE,CAAC;QACtG,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B;YACrD,IAAM,YAAY,GAAG,YAAY,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,IAAI,EAAE,CAAC;YACjG,IAAM,WAAW,GAAG,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,EAAE,CAAC;YACvG,IAAI,YAAY,IAAI,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxD,IAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,UAAC,GAAW;oBACrD,IAAM,WAAW,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC;oBACtC,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;wBACxC,OAAO,KAAK,CAAC;qBACd;oBACD,IAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBAC/D,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBAC3D,IAAM,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;oBAC/C,OAAO,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACrF,CAAC,CAAC;gBACH,OAAO,GAAG,GAAG,IAAI,GAAG,KAAK,CAAC;aAC3B;YACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;KACJ;;;;;;;IAOM,0DAA4B,GAAnC,UAAoC,YAAsB,EAAE,UAAkB;QAA9E,iBAgCC;QA/BC,IAAI,CAAC,YAAY,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;SACtC;QACD,IAAI,CAAC,UAAU,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;SACrC;QACD,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAC3C,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,IAAI,IAAI,CAAC;QACjF,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,YAAY,GAAG,cAAc,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;QACpE,IAAM,aAAa,GAAG,YAAY,IAAI,YAAY,CAAC,YAAY,EAAE,IAAI,EAAE,CAAC;QACxE,IAAM,cAAc,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,YAA0B,IAAK,OAAA,YAAY,CAAC,YAAY,KAAK,YAAY,CAAC,YAAY,CAAC,iBAAiB,KAAK,UAAU,IAAI,YAAY,CAAC,YAAY,CAAC,SAAS,KAAK,UAAU,CAAC,GAAA,CAAC,CAAC;QAC3N,IAAI,CAAC,cAAc,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE;YACnD,OAAO,IAAI,CAAC;SACb;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;QAC7E,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B;YACrD,IAAM,cAAc,GAAG,KAAI,CAAC,kBAAkB,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;YAC3F,IAAI,CAAC,cAAc,IAAI,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7D,OAAO,KAAK,CAAC;aACd;YACD,IAAM,mBAAmB,GAAG,KAAI,CAAC,kBAAkB,CAAC,6BAA6B,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;YACtG,IAAM,mBAAmB,GAAG,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACrF,IAAI,CAAC,mBAAmB,EAAE;gBACxB,OAAO,KAAK,CAAC;aACd;YACD,IAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,OAAO,KAAK,cAAc,CAAC,YAAY,CAAC,IAAI,GAAA,CAAC,CAAC;YAChJ,OAAO,aAAa,GAAG,IAAI,GAAG,KAAK,CAAC;SACrC,CAAC,CAAC;KACJ;;;;;;IAOO,2DAA6B,GAApC,UAAqC,WAA8B,EAAE,SAAsB;QAAtB,0BAAA,EAAA,cAAsB;QAC1F,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;YAC9B,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACrC;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,IAAI,EAAE,CAAC;QACtG,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B,IAAK,OAAA,YAAY,IAAI,YAAY,CAAC,SAAS,KAAK,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,KAAK,WAAW,GAAA,CAAC,CAAC;KACzK;;gBAhHF,UAAU;;;;gBALU,QAAQ;gBACpB,UAAU;gBAAwB,YAAY;gBAAE,UAAU;gBAC1D,kBAAkB;gBAClB,kBAAkB;;IAmH3B,0BAAC;CAjHD;;ACAA,IAAM,wBAAwB,GAAG,IAAI,CAAC;AACtC,IAAM,uBAAuB,GAAG,KAAK,CAAC;;;;;AAUtC;;;;IAKE,6BACU,UAA2B,EAC3B,YAA0B,EAC1B,mBAAwC,EACxC,kBAAsC;QAHtC,eAAU,GAAV,UAAU,CAAiB;QAC3B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,uBAAkB,GAAlB,kBAAkB,CAAoB;KAE/C;;;;IAKM,+CAAiB,GAAxB,UAAyB,kBAAyB,EAAE,WAA4B;;QAE9E,IAAI,CAAC,kBAAkB,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE;YACrD,OAAO;SACR;QACD,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,IAAM,sBAAsB,GAAG,IAAI,CAAC,4BAA4B,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC;QAClG,IAAI,sBAAsB,EAAE;YAC1B,WAAW,GAAG,sBAAsB,CAAC,WAAW,CAAC;YACjD,IAAI,WAAW,EAAE;gBACf,IAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;gBAC7D,IAAI,QAAQ,EAAE;oBACZ,kBAAkB,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;iBACtC;aACF;SACF;KACF;;;;IAKM,2CAAa,GAApB,UAAqB,kBAAyB,EAAE,iBAA4C;QAC1F,IAAI,CAAC,kBAAkB,IAAI,CAAC,kBAAkB,CAAC,MAAM,IAAI,kBAAkB,CAAC,SAAS,CAAC,IAAI,IAAI,IAAI,iBAAiB,CAAC,QAAQ,KAAK,IAAI,EAAE;YACrI,OAAO;SACR;QACD,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,IAAI,QAAQ,GAAG,IAAI,CAAC;QACpB,IAAM,sBAAsB,GAAG,IAAI,CAAC,4BAA4B,CAAC,kBAAkB,CAAC,CAAC;QACrF,IAAI,sBAAsB,EAAE;YAC1B,WAAW,GAAG,sBAAsB,CAAC,WAAW,CAAC;YACjD,QAAQ,GAAG,sBAAsB,CAAC,EAAE,CAAC;YACrC,kBAAkB,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;YACrC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;SACnD;KACF;IACO,2DAA6B,GAArC,UAAsC,kBAAyB,EAAE,WAA6B;QAA9F,iBAiCC;QAhCC,kBAAkB,GAAG,kBAAkB,CAAC,MAAM,CAAC,UAAC,iBAAsB;YACpE,IAAM,aAAa,GAAG,KAAI,CAAC,8BAA8B,CAAC,iBAAiB,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;YAC3F,IAAM,YAAY,GAAG,aAAa,IAAI,aAAa,CAAC,MAAM,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,IAAI,YAAY,CAAC,OAAO,KAAK,KAAI,CAAC,YAAY,CAAC,OAAO,GAAA,CAAC,CAAC;YAC/I,OAAO,YAAY,GAAG,IAAI,GAAG,KAAK,CAAC;SACpC,CAAC,CAAC;QACH,OAAO,kBAAkB,CAAC,GAAG,CAAC,UAAC,iBAAsB;YACnD,IAAI,QAAQ,GAAG,CAAC,CAAC,CAAC;YAClB,IAAI,iBAAiB,EAAE;gBACrB,IAAI,WAAW,IAAI,iBAAiB,CAAC,WAAW,EAAE;oBAChD,IAAM,KAAK,GAAG,KAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;oBACnF,QAAQ,GAAG,KAAK,IAAI,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;oBACzD,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;iBAC7B;;gBAED,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC;gBACvC,IAAM,UAAU,GAAG,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC;gBAC1C,iBAAiB,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBACtC,iBAAiB,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;gBAChC,iBAAiB,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;gBAClC,iBAAiB,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBACtC,IAAI,YAAY,EAAE;oBAChB,IAAM,QAAQ,GAAG,iBAAiB,CAAC,QAAQ,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,EAAE,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;oBACjH,IAAI,QAAQ,GAAG,CAAC,EAAE;wBAChB,IAAM,QAAQ,GAAG,iBAAiB,CAAC,KAAK,IAAI,CAAC,CAAC;wBAC9C,iBAAiB,CAAC,QAAQ,GAAG,QAAQ,CAAC;wBACtC,iBAAiB,CAAC,UAAU,GAAG,YAAY,CAAC,KAAK,CAAC;wBAClD,iBAAiB,CAAC,QAAQ,GAAG,QAAQ,GAAG,CAAC,GAAG,QAAQ,IAAI,UAAU,GAAG,IAAI,GAAG,QAAQ,GAAG,IAAI,GAAG,QAAQ,CAAC,CAAC;qBACzG;iBACF;aACF;YACD,OAAO,iBAAiB,CAAC;SAC1B,CAAC,CAAC;KACJ;IACO,6CAAe,GAAvB,UAAwB,YAA0B;QAChD,IAAI,YAAY,EAAE;YAChB,IAAM,mBAAmB,GAAG,YAAY,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC;YAClF,OAAO,mBAAmB,GAAG,IAAI,GAAG,KAAK,CAAC;SAC3C;QACD,OAAO,SAAS,CAAC;KAClB;IACO,4CAAc,GAAtB,UAAuB,YAA0B,EAAE,OAAe;QAChE,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACtD,IAAM,YAAY,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAClF,IAAM,mBAAmB,GAAG,YAAY,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC;QAClF,IAAM,UAAU,GAAG,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC;QAC1C,IAAI,CAAC,mBAAmB,EAAE;YACxB,OAAO,SAAS,CAAC;SAClB;QACD,IAAI,OAAO,GAAU,YAAY,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;QACjE,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YAClC,OAAO,SAAS,CAAC;SAClB;;QAED,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,UAAC,OAAc,EAAE,IAAI;YAC5C,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBACvB,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAC7B;YACD,OAAO,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;SAC/B,EAAE,EAAE,CAAC,CAAC;QACP,IAAI,QAAQ,GAAG,CAAC,CAAC,CAAC;gCACT,KAAK;YACZ,IAAM,MAAM,GAAgB,OAAO,CAAC,KAAK,CAAC,CAAC;YAC3C,IAAM,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,IAAI,IAAI,CAAC;YACxF,IAAI,CAAC,MAAM,EAAE;;aAEZ;YACD,IAAI,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,OAAO,EAAE;gBACrD,IAAM,OAAK,GAAG,MAAM,CAAC,KAAK,CAAC;gBAC3B,IAAI,OAAK,EAAE;oBACT,IAAM,YAAY,GAAG,OAAO,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,KAAK,OAAK,GAAA,CAAC,CAAC;oBAClE,IAAM,gBAAgB,GAAG,OAAK,mBAAmB,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;oBACzE,IAAI,OAAK,KAAK,MAAM,EAAE;wBACpB,QAAQ,GAAG,UAAU,GAAG,wBAAwB,GAAG,gBAAgB,CAAC;qBACrE;yBAAM;wBACL,QAAQ,GAAG,UAAU,GAAG,uBAAuB,GAAG,IAAI,GAAG,gBAAgB,CAAC;qBAC3E;iBACF;qBAAM;oBACL,QAAQ,GAAG,UAAU,GAAG,uBAAuB,GAAG,KAAK,CAAC;iBACzD;;aAEF;;;QApBH,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,OAAO,CAAC,MAAM,EAAE,KAAK,EAAE;kCAA1C,KAAK;;;SAqBb;QACD,OAAO,QAAQ,CAAC;KACjB;IACO,iDAAmB,GAA3B,UAA4B,OAAc,EAAE,OAAe;QACzD,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QACvF,OAAO,OAAO,CAAC,SAAS,CAAC,UAAA,MAAM;YAC7B,IAAM,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,IAAI,IAAI,CAAC;YACxF,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,CAAC;aACd;YACD,IAAI,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,OAAO,EAAE;gBACrD,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;KACJ;IACO,0DAA4B,GAApC,UAAqC,kBAAyB,EAAE,WAA6B;QAC3F,kBAAkB,GAAG,IAAI,CAAC,6BAA6B,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC;QACzF,kBAAkB,CAAC,IAAI,CAAC,UAAC,EAAO,EAAE,EAAO,IAAK,OAAA,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,GAAA,CAAC,CAAC;QACzF,OAAO,kBAAkB,IAAI,kBAAkB,CAAC,MAAM,GAAG,CAAC,IAAI,kBAAkB,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC;KAC7F;IACO,iDAAmB,GAA3B,UAA4B,WAAmB,EAAE,WAA4B;QAC3E,IAAI,OAAO,GAAG,WAAW,CAAC,aAAa,CAAC,aAAa,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC;QAC1F,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,KAAK,OAAO,EAAE;YAC1C,IAAM,MAAM,GAAG,OAAO,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;YACrD,IAAI,MAAM,CAAC,MAAM,EAAE;gBACjB,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;aACrB;SACF;QACD,OAAO,OAAO,CAAC;KAChB;IACM,4DAA8B,GAArC,UAAsC,YAAoB,EAAE,QAAsB;QAAtB,yBAAA,EAAA,cAAsB;QAChF,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO,EAAE,CAAC;SACX;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,IAAI,EAAE,CAAC;QACrH,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B;YACrD,IAAM,YAAY,GAAG,YAAY,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,IAAI,EAAE,CAAC;YACjG,IAAM,WAAW,GAAG,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,EAAE,CAAC;YACvG,IAAI,YAAY,IAAI,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxD,IAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,UAAC,GAAW;oBACrD,IAAM,WAAW,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC;oBACtC,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;wBACxC,OAAO,KAAK,CAAC;qBACd;oBACD,IAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBAC/D,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBAC3D,IAAM,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;oBAC/C,OAAO,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACrF,CAAC,CAAC;gBACH,OAAO,GAAG,GAAG,IAAI,GAAG,KAAK,CAAC;aAC3B;YACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;KACJ;IACM,8DAAgC,GAAvC,UAAwC,YAA0B,EAAE,OAAe;QACjF,IAAM,cAAc,GAAG,IAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,QAAQ,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QACnD,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,SAAS,CAAC,UAAC,aAA4B;YAC1E,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO,KAAK,CAAC;aACd;YACD,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;YACvD,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAC3D,IAAM,uBAAuB,GAAG,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAChF,IAAM,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;YAC9D,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAClD,CAAC,CAAC;KACJ;IACM,2CAAa,GAApB,UAAqB,YAA0B,EAAE,OAAe;QAC9D,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;QAC3D,IAAI,eAAe,EAAE;YACnB,OAAO,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;SACnD;aAAM;YACL,OAAO,IAAI,CAAC,gCAAgC,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;SACrE;KACF;IACM,2DAA6B,GAApC,UAAqC,YAA0B;QAC7D,OAAO,YAAY,IAAI,YAAY,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC;KACtF;IACM,0CAAY,GAAnB,UAAoB,SAAiB,EAAE,WAA4B;QACjE,IAAI,OAAO,GAAG,KAAK,CAAC;QACpB,IAAI,cAAc,GAAG,WAAW,CAAC,aAAa,CAAC,aAAa,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;;QAEvF,IAAI,cAAc,EAAE;;YAElB,IAAM,QAAQ,GAAG,WAAW,CAAC,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC,MAAI,SAAW,CAAC,CAAC;YAC3F,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnC,OAAO,OAAO,CAAC;aAChB;;YAED,IAAI,cAAc,CAAC,OAAO,KAAK,OAAO,EAAE;gBACtC,IAAM,WAAW,GAAG,cAAc,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;gBACjE,IAAI,WAAW,CAAC,MAAM,EAAE;oBACtB,cAAc,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;iBACjC;aACF;YACD,cAAc,CAAC,KAAK,EAAE,CAAC;YACvB,OAAO,GAAG,IAAI,CAAC;SAChB;QACD,OAAO,OAAO,CAAC;KAChB;;;;;;;IAOM,mCAAK,GAAZ,UAAa,iBAAsB,EAAE,YAA0B;QAC7D,IAAI,CAAC,iBAAiB,EAAE;YACtB,OAAO;SACR;QACD,IAAM,gBAAgB,GAAG,iBAAiB,CAAC,KAAK,KAAK,IAAI,CAAC;QAC1D,IAAI,gBAAgB,EAAE;YACpB,IAAM,MAAI,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;YAC3C,IAAI,MAAI,EAAE;gBACR,UAAU,CAAC;oBACT,MAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE,EAAE,iBAAiB,CAAC,WAAW,CAAC,CAAC;iBACpE,EAAE,CAAC,CAAC,CAAC;aACP;SACF;aAAM;YACL,IAAM,cAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;YACxD,IAAM,SAAS,GAAG,iBAAiB,CAAC,WAAW,CAAC;YAChD,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,cAAY,CAAC,CAAC;SACzC;KACF;;;;;;IAOO,uCAAS,GAAjB,UAAkB,SAAiB,EAAE,UAAuB;QAC1D,IAAM,QAAQ,GAAQ,UAAU,IAAI,UAAU,CAAC,aAAa,CAAC,aAAa,IAAI,MAAM,CAAC,QAAQ,CAAC;QAC9F,IAAI,QAAQ,EAAE;YACZ,IAAM,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YACnD,IAAI,OAAO,CAAC,OAAO,KAAK,OAAO,EAAE;gBAC/B,IAAM,WAAW,GAAG,OAAO,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;gBAC1D,IAAI,WAAW,CAAC,MAAM,EAAE;oBACtB,IAAM,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;oBAC7B,IAAI,KAAK,IAAI,OAAO,KAAK,CAAC,KAAK,KAAK,UAAU,EAAE;wBAC9C,KAAK,CAAC,KAAK,EAAE,CAAC;qBACf;iBACF;aACF;iBAAM;gBACL,OAAO,CAAC,KAAK,EAAE,CAAC;aACjB;SACF;KACF;;;;;;IAMO,6CAAe,GAAvB,UAAwB,YAA0B;QAChD,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;KAClG;;;;;;IAMO,wCAAU,GAAlB,UAAmB,YAA0B;QAA7C,iBAuBC;QAtBC,IAAM,SAAS,GAAG,YAAY,CAAC,SAAS,CAAC;QACzC,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;QACvD,IAAM,aAAa,GAAmB,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACpI,IAAM,oBAAoB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B,IAAK,OAAA,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,QAAQ,EAAE,KAAK,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,QAAQ,EAAE,GAAA,CAAC,CAAC;QAC1O,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,IAAI,oBAAoB,EAAE;YACxB,oBAAoB,CAAC,KAAK,CAAC,UAAC,YAA0B;gBACpD,IAAM,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC;gBACrC,IAAM,aAAa,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;gBACpG,IAAI,CAAC,aAAa,EAAE;oBAClB,OAAO,IAAI,CAAC;iBACb;gBACD,IAAM,iBAAiB,GAAG,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,SAAc,IAAK,OAAA,SAAS,IAAI,SAAS,CAAC,oBAAoB,CAAC,KAAK,mBAAmB,GAAA,CAAC,CAAC;gBAC5J,IAAI,iBAAiB,EAAE;oBACrB,MAAM,GAAG,iBAAiB,CAAC;oBAC3B,OAAO,KAAK,CAAC;iBACd;qBAAM;oBACL,OAAO,IAAI,CAAC;iBACb;aACF,CAAC,CAAC;SACJ;QACD,OAAO,MAAM,CAAC;KACf;;gBAjUF,UAAU;;;;gBAfF,UAAU;gBAAE,YAAY;gBACxB,mBAAmB;gBACnB,kBAAkB;;IA+U3B,0BAAC;CAlUD;;ACPA,IAAM,MAAM,GAAG,cAAc,CAAC;AAC9B,IAAM,QAAQ,GAAG,gBAAgB,CAAC;AAClC,IAAM,UAAU,GAAG,YAAY,CAAC;AAChC,AAEA,IAAM,MAAM,GAAG,QAAQ,CAAC;;;;;AAKxB;;;;IAWE,2BACU,UAA2B,EAC3B,YAA0B,EAC1B,aAAgC,EAChC,eAAgC;QAHhC,eAAU,GAAV,UAAU,CAAiB;QAC3B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,kBAAa,GAAb,aAAa,CAAmB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAZnC,QAAG,GAAG,GAAG,CAAC;QAGV,qBAAgB,GAAG,IAAI,OAAO,EAAO,CAAC;QACtC,uBAAkB,GAAG,IAAI,OAAO,EAAO,CAAC;KAU9C;IAED,gCAAI,GAAJ;QACE,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QAC9C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC9C;IAED,oCAAQ,GAAR,UAAS,GAAW,EAAE,KAAU;QAC9B,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QAC9C,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;QACtE,IAAM,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjD,SAAS,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;KACxB;IAED,oCAAQ,GAAR,UAAS,GAAW;QAClB,IAAM,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;QACvD,OAAO,SAAS,CAAC,GAAG,CAAC,CAAC;KACvB;;IAGD,2CAAe,GAAf;QACE,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACzB,OAAO;SACR;aAAM;YACL,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;SAC9C;KACF;IAED,2CAAe,GAAf;QACE,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAChD,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;KAClD;IAED,sCAAU,GAAV,UAAW,IAAY,EAAE,EAAU,EAAE,QAAgB;QAArD,iBAgBC;;QAdC,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC/E,IAAM,oBAAoB,GAAG,uBAAuB,CAAC,cAAc,CAAC;QACpE,IAAM,iBAAiB,GAAG,oBAAoB,CAAC,uBAAuB,CAAC,IAAI,KAAK,CAAC;QACjF,IAAI,iBAAiB,EAAE;YACrB,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;SACjH;aAAM;YACL,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC;SACvB;QACD,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAClD,OAAO,UAAU,CAAC,MAAM,CAAC,UAAC,UAA2B;YACnD,KAAI,CAAC,sBAAsB,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,SAAS,CAAC,UAAC,MAAW;gBAC1D,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACzB,CAAC,CAAC;SACJ,CAAC,CAAC;KACJ;;IAGD,yCAAa,GAAb;QACE,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACzC,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;YAChH,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACxD,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,eAAe,EAAE,CAAC;SACxB;KACF;;IAGD,kDAAsB,GAAtB,UAAuB,SAAiB,EAAE,IAAY;QACpD,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACvC,IAAA,+CAA2E,EAAzE,sBAAQ,EAAE,wBAAS,EAAE,gBAAoD,CAAC;QAClF,IAAI,UAAU,GAAG,IAAI,CAAC;QACtB,IAAM,IAAI,GAAG,UAAU,CAAC,gBAAgB,CAAC,cAAc,EAAE,CAAC;QAC1D,IAAI,CAAC,IAAI,CAAC,UAAC,CAAM,EAAE,GAAW;YAC5B,IAAI,CAAC,CAAC,EAAE,KAAK,SAAS,EAAE;gBACtB,UAAU,GAAG,GAAG,CAAC;aAClB;SACF,CAAC,CAAC;;QAEH,IAAI,UAAU,KAAK,IAAI,EAAE;;YAEvB,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,QAAQ,IAAI;oBACV,KAAK,MAAM;wBACT,OAAOE,IAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;wBACpC,MAAM;oBACR,KAAK,MAAM;wBACT,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;wBAChF,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;wBAChB,MAAM;iBACT;aACF;YACD,OAAOA,IAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAI,OAAO,GAAG,UAAU,CAAC;QACzB,QAAQ,IAAI;YACV,KAAK,MAAM;;gBAET,IAAI,UAAU,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,EAAE;oBACvC,OAAO,UAAU,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC,IAAI,CACjE,SAAS,CAAC,UAAA,MAAM;wBACd,OAAO,GAAG,QAAQ,GAAG,CAAC,CAAC;wBACvB,OAAOA,IAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;qBAC/B,CAAC,CACH,CAAC;iBACH;;qBAEI,IAAI,UAAU,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,EAAE;oBAC5C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;oBACjF,OAAOA,IAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;iBAC7B;;qBAEI;oBACH,OAAO,GAAG,UAAU,GAAG,CAAC,CAAC;oBACzB,OAAOA,IAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;iBAC7B;gBACD,MAAM;YACR,KAAK,MAAM;;gBAET,IAAI,UAAU,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE;;oBAEpC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,GAAG,UAAU,GAAG,CAAC,IAAI,KAAK,EAAE;wBACzD,OAAO,UAAU,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,UAAA,MAAM;4BAClF,OAAOA,IAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;yBACzB,CAAC,CAAC,CAAC;qBACL;;yBAEI;wBACH,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;wBAChF,OAAOA,IAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;qBAC7B;iBACF;qBAAM;oBACL,OAAO,GAAG,UAAU,GAAG,CAAC,CAAC;oBACzB,OAAOA,IAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;iBAC7B;gBACD,MAAM;SACT;KACF;;gBApJF,UAAU;;;;gBAlBF,UAAU;gBAAE,YAAY;gBAIxB,iBAAiB;gBACjB,eAAe;;IAoKxB,wBAAC;CAvJD;;ACPA;;;;AAKA;;;;;;;;;;;;;IAeE,yBACU,UAA8B,EAC9B,UAA2B,EAC3B,WAAwB,EACxB,cAAkC,EACtB,eAAgC,EAC5C,iBAAoC,EACpC,gBAAkC,EAClC,SAAoB,EACpB,sBAA8C;QAR9C,eAAU,GAAV,UAAU,CAAoB;QAC9B,eAAU,GAAV,UAAU,CAAiB;QAC3B,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAoB;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,cAAS,GAAT,SAAS,CAAW;QACpB,2BAAsB,GAAtB,sBAAsB,CAAwB;QAEtD,IAAI,CAAC,eAAe,EAAE;YACpB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;;;;KAKF;;;;IAKM,8BAAI,GAAX,UAAYE,SAAe,EAAE,IAAa;QAA1C,iBAyBC;;QAtBCA,SAAM,GAAG,CAACA,SAAM,GAAG,IAAI,GAAGA,SAAM,CAAC;QACjC,IAAI,GAAG,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC;;QAE3BA,SAAM,GAAG,IAAI,CAAC,qBAAqB,CAACA,SAAM,CAAC,CAAC;;QAE5C,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QAEtC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAACA,SAAM,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAC7F,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD;;YAEE,KAAI,CAAC,cAAc,CAACA,SAAM,CAAC,CAAC;YAC5B,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACzE,CACF,CACF,CAAC;KACH;;;;;;IAMM,gCAAM,GAAb,UAAcA,SAAe,EAAE,IAAa;QAA5C,iBAwBC;;QAtBCA,SAAM,GAAG,CAACA,SAAM,GAAG,IAAI,GAAGA,SAAM,CAAC;QACjC,IAAI,GAAG,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC;;QAE3BA,SAAM,GAAG,IAAI,CAAC,qBAAqB,CAACA,SAAM,CAAC,CAAC;;QAE5C,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QAEtC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAACA,SAAM,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;QAC5E,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD;;YAEE,KAAI,CAAC,cAAc,CAACA,SAAM,CAAC,CAAC;YAC5B,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACzE,CACF,CACF,CAAC;KACH;;;;IAIM,+BAAK,GAAZ,UAAaA,SAAc,EAAE,IAAY,EAAE,QAAgB,EAAE,SAAiB;QAA9E,iBAwBC;;QAtBCA,SAAM,GAAG,CAACA,SAAM,KAAK,EAAE,IAAI,IAAI,GAAGA,SAAM,CAAC;QACzC,IAAI,GAAG,CAAC,IAAI,KAAK,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC;;QAEnCA,SAAM,GAAG,IAAI,CAAC,qBAAqB,CAACA,SAAM,CAAC,CAAC;;QAE5C,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;;QAEtC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC;QACnE,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAACA,SAAM,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;QACtG,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD;;YAEE,KAAI,CAAC,cAAc,CAACA,SAAM,CAAC,CAAC;YAC5B,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;SAC1E,CACF,CACF,CAAC;KACH;IAEM,oCAAU,GAAjB,UAAkBA,SAAc,EAAE,IAAY;QAA9C,iBAuCC;;;;;;QAjCC,IAAM,SAAS,GAAG,mBAAmB,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACtG,IAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;;QAGvD,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;QAChF,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QAC/C,IAAI,QAAQ,GAAG,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACrD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;QAEnD,IAAM,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACnE,IAAME,cAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAgB,CAAC;QACrE,IAAI,CAACA,cAAW,EAAE;YAChB,OAAO;SACR;QACD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QACpE,IAAM,UAAU,GAAG,MAAI,QAAU,CAAC;QAClC,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,UAAU,CAAC,CAAC;QACtF,IAAI,MAAM,EAAE;YACF,IAAA,qBAAa,EAAb,kCAAa,EAAE,oBAAY,EAAZ,iCAAY,CAAY;;YAE/C,IAAI,QAAQ,KAAK,CAAC,EAAE;gBAClB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;gBACtE,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;gBACxE,OAAO,QAAQ,CAAC,IAAI,CAClB,GAAG,CAAC,eAAS,EACX,UAAA,KAAK;oBACH,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;iBAC1E,CACF,CACF,CAAC;aACH;SACF;KAEF;;;;;;;;;;;;;;;;;;;;IAqBM,gCAAM,GAAb;QAAA,iBAgBC;QAfC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;QACzC,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;;;;;IAKM,gCAAM,GAAb,UAAc,QAAqB;QAAnC,iBAgBC;QAhBa,yBAAA,EAAA,YAAoB,CAAC;QACjC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACjD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;;;;IAKM,uCAAa,GAApB;QACE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,CAAC;QACnD,OAAO,OAAO,CAAC;KAChB;;;;;IAMM,8BAAI,GAAX,UAAY,UAAmB;QAA/B,iBAwBC;QAvBC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,MAAM,EAAE,CAAC,CAAC;SAChD;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC;QAC7C,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CACxB,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;gBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;aACjE;iBAAM;gBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;aACvF;SACF,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;SAC9E,CACF,CACF,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;;;;;;IAUM,gCAAM,GAAb,UAAc,EAAU,EAAE,MAAyB,EAAE,UAAmB,EAAE,OAAgC,EAAE,SAAkC;QAA9I,iBAgDC;QAhDyE,wBAAA,EAAA,cAAgC;QAAE,0BAAA,EAAA,gBAAkC;QAC5I,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;QACD,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,EAAE,CAAC;SAChB;QACD,OAAO,GAAG,CAAC,OAAO,KAAK,KAAK,IAAI,OAAO,KAAK,OAAO,IAAI,KAAK,GAAG,IAAI,CAAC;QACpE,SAAS,GAAG,CAAC,SAAS,KAAK,KAAK,IAAI,SAAS,KAAK,OAAO,IAAI,KAAK,GAAG,IAAI,CAAC;QAC1E,IAAM,OAAO,GAAG,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;QACpG,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,EAAE,CAAC;aAChB;YACD,MAAM,GAAG,CAAC,MAAM,KAAK,KAAK,IAAI,MAAM,KAAK,OAAO,IAAI,KAAK,GAAG,IAAI,CAAC;YACjE,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;YACvD,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,EAAE,CAAC;aAChB;YACD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;gBACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;aACF,EACD,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC3E,CACF,EACD,SAAS,CAAC;gBACR,IAAI,MAAM,KAAK,IAAI,IAAI,CAAC,SAAS,EAAE;;oBAEjC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;iBACf;qBAAM;oBACL,OAAO,KAAK,EAAE,CAAC;iBAChB;aACF,CAAC,CACH,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;;;;;IAQM,oCAAU,GAAjB,UAAkB,GAAa,EAAE,MAAyB,EAAE,UAAmB,EAAE,0BAAoD;QAArI,iBAwDC;QAxDgF,2CAAA,EAAA,kCAAoD;QACnI,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,YAAY,EAAE,CAAC,CAAC;SACtD;QACD,0BAA0B,GAAG,CAAC,0BAA0B,KAAK,MAAM,IAAI,0BAA0B,KAAK,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC;QAC3H,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,EAAE;YAC5B,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;YAClD,IAAI,0BAA0B,KAAK,IAAI,IAAI,SAAS,EAAE;gBACpD,GAAG,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACzC;iBAAM;gBACL,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACjG,OAAO,KAAK,EAAE,CAAC;aAChB;SACF;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QAC9E,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,EAAE,CAAC;aAChB;YACD,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;gBACjC,MAAM,GAAG,IAAI,CAAC;aACf;YACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;gBAC9B,MAAM,GAAG,MAAM,CAAC,WAAW,EAAE,KAAK,OAAO,GAAG,KAAK,GAAG,IAAI,CAAC;aAC1D;YACD,MAAM,GAAG,CAAC,MAAM,KAAK,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC;YAC3C,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAEzD,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,EAAE,CAAC;aAChB;YAED,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;gBACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;;aAEF,EACD,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC3E,CACF,EACD,SAAS,CAAC;gBACR,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;aACf,CAAC,CACH,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;IAKM,8CAAoB,GAA3B,UAA4B,WAAmB,EAAE,cAAsB;QACrE,IAAI,IAAI,CAAC,SAAS,IAAI,WAAW,IAAI,cAAc,EAAE;YACnD,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAiB,cAAc,EAAE,IAAI,CAAC,CAAC;YACtG,OAAO,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;SAC5D;QACD,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;KACpB;;;;;;IAOM,iCAAO,GAAd,UAAe,WAAmB,EAAE,cAAsB;QACxD,IAAI,IAAI,CAAC,SAAS,IAAI,WAAW,IAAI,cAAc,EAAE;YACnD,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAiB,cAAc,EAAE,IAAI,CAAC,CAAC;YACtG,OAAO,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;SAC5D;QACD,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;KACpB;;;;IAIM,gCAAM,GAAb;QAAA,iBAsBC;QArBC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;;QAED,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,cAAc,GAAG,iBAAiB,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;QAC1E,IAAI,cAAc,KAAK,KAAK,EAAE;YAC5B,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC;SACvB;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAC7F,SAAS,CAAC,UAAC,QAAiB;YAC1B,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACtB,OAAO,KAAK,CAAC;aACd;YAED,OAAO,KAAI,CAAC,OAAO,EAAE,CAAC;SACvB,CAAC,CACH,CAAC;QAEF,OAAO,cAAc,CAAC;KACvB;;;;;IAKM,gCAAM,GAAb;QACE,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC;KACvB;;;;IAIO,iCAAO,GAAf;QAAA,iBAaC;QAZC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;QAChD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;IAID,sBAAY,wCAAW;;;;aAAvB;YACE,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;gBACjD,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;gBAC3E,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC;iBACvC;aACF;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;;;;;IAKO,wCAAc,GAAtB,UAAuB,OAAY;QACjC,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;;QAErC,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;SACrC;KACF;;;;;IAKO,+CAAqB,GAA7B,UAA8BF,SAAW;QACvC,IAAI,OAAOA,SAAM,KAAK,QAAQ,EAAE;YAC9BA,SAAM,GAAG,IAAI,CAAC,KAAK,CAACA,SAAM,CAAC,IAAI,EAAE,CAAC;SACnC;QACD,IAAM,OAAO,GAAeA,SAAM,CAAC;QACnC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC;QACzE,IAAI,WAAW,EAAE;YACf,IAAM,kBAAkB,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,sBAAsB,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;;YAEzI,IAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAClD,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;;;;;;;;;;;;gBAYvC,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;;oBAEtB,IAAM,UAAU,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;oBAC/C,IAAI,UAAU,EAAE;wBACd,IAAI,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE;4BACzC,OAAO,UAAU,CAAC,QAAQ,CAAC;yBAC5B;wBACD,UAAU,CAAC,QAAQ,GAAG,CAAC,CAAC;qBACzB;iBACF;;gBAED,OAAO,CAAC,IAAI,OAAZ,OAAO,WAAS,UAAU,GAAE;aAC7B;SACF;QAED,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;KAChC;;;;;IAKO,6CAAmB,GAA3B,UAA4B,IAAS;QACnC,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAC5B,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;SAC/B;QACD,IAAM,KAAK,GAAe,IAAI,CAAC;QAC/B,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC;QACzE,IAAI,WAAW,EAAE;;YAEf,IAAM,kBAAkB,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,oBAAoB,CAAC,0BAA0B,CAAC,WAAW,EAAE,UAAC,SAAS;gBACzJ,IAAI,SAAS,KAAK,KAAK,EAAE;oBACvB,OAAO,CAAC,CAAC;iBACV;qBAAM;oBAAE,OAAO,CAAC,CAAC;iBAAE;aACrB,CAAC,IAAI,EAAE,CAAC;YACT,IAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;;YAElD,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;;;;;;;;;;;;gBAYvC,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;;;aAGnC;SACF;QACD,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;KAC9B;;gBA9iBF,UAAU;;;;gBATF,kBAAkB;gBALlB,UAAU;gBAAE,WAAW;gBAEvB,kBAAkB;gBAElB,eAAe,uBA8BnB,QAAQ;gBA/BJ,iBAAiB;gBAGjB,gBAAgB;gBANiB,SAAS;gBAQ1C,sBAAsB;;IAqjB/B,sBAAC;CA/iBD;;ACPA;;;AAGA;;;;IAME,4BACU,UAA8B,EAC9B,UAA2B,EAC3B,cAAkC,EAClC,SAAoB,EACR,eAAgC,EAC5C,iBAAoC,EACpC,gBAAkC;QANlC,eAAU,GAAV,UAAU,CAAoB;QAC9B,eAAU,GAAV,UAAU,CAAiB;QAC3B,mBAAc,GAAd,cAAc,CAAoB;QAClC,cAAS,GAAT,SAAS,CAAW;QACR,oBAAe,GAAf,eAAe,CAAiB;QAC5C,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAE1C,IAAI,CAAC,eAAe,EAAE;YACpB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;KAC5B;;;;IAKD,gCAAG,GAAH;QAAA,iBAiBC;QAhBC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;SAC/C;QACD,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QACnD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACxE,CACF,CACF,CAAC;KACH;;;;;IAKM,mCAAM,GAAb,UAAc,QAAqB;QAAnC,iBAiBC;QAjBa,yBAAA,EAAA,YAAoB,CAAC;QACjC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;QACD,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAC7D,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACC,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACxE,CACF,CACF,CAAC;KACH;;;;IAID,mCAAM,GAAN,UAAO,EAAU,EAAE,UAAmB;QACpC,IAAM,GAAG,GAAG,UAAU,GAAG,UAAU,GAAG,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;KACzC;;;;IAKD,iDAAoB,GAApB,UAAqB,EAAU;QAC7B,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;KACvC;;;;;;IAOD,gDAAmB,GAAnB,UAAoB,GAAW,EAAE,UAAmB;QAApD,iBAgCC;QA/BC,IAAI,CAAC,GAAG,EAAE;YACR,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,CAAC;SACd;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QAC9E,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,CAAC;aACd;YACD,IAAM,IAAI,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAC7D,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;gBACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;;aAEF,EACC,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC3E,CACF,CACF,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;IAKD,wCAAW,GAAX,UAAY,EAAU,EAAE,SAAkB,EAAE,UAAkB;QAA9D,iBA0CC;QAzCC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE,CAAC,CAAC;SAClD;QACD,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,EAAE,CAAC;SAChB;QAED,IAAI,OAA4B,CAAC;QACjC,IAAI,SAAS,KAAK,KAAK,EAAE;YACvB,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;SAC1E;aAAM;YACL,OAAO,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;SACpB;QAED,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,EAAE,CAAC;aAChB;YACD,IAAM,IAAI,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YACvD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;gBACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;;aAEF,EACC,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC3E,CACF,CACF,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;;;IAOD,0CAAa,GAAb,UAAc,EAAU,EAAE,UAAmB;QAA7C,iBA6CC;QA5CC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,eAAe,EAAE,CAAC,CAAC;SACzD;QACD,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9F,OAAO,KAAK,EAAE,CAAC;SAChB;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QAC9E,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,EAAE,CAAC;aAChB;;YAGD,IAAM,IAAI,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAEvD,OAAO,OAAO,CAAC,IAAI;;YAGjB,SAAS,CAAC;gBACR,IAAM,GAAG,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAmB,CAAC;gBAChE,OAAO,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;aAC9C,CAAC;;YAGF,GAAG,CAAC;gBACF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;;aAEF,EACC,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC3E,CAAC,CACL,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;;;;;;IASM,iCAAI,GAAX,UAAY,SAAiC,EAAE,KAAa,EAAE,OAA4B;QAA1F,iBAyCC;QAxCC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO;SACR;QACD,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC/B,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;SAC7C;QACD,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC;QACzE,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACD,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,EAAiB,CAAC;QACxE,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1C,OAAO;SACR;QACD,OAAO,CAAC,OAAO,CAAC,UAAC,MAAM;YACrB,IAAM,KAAK,GAAG,WAAW,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;YAC/C,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;gBAChB,OAAO;aACR;YACD,IAAM,IAAI,GAAG,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC1C,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACtC,IAAM,IAAI,GAAG,SAAS,KAAK,IAAI,GAAI,CAAC,CAAC,GAAG,CAAC,CAAC;;YAE1C,IAAM,gBAAgB,GAAG,KAAK,GAAG,IAAI,CAAC;YACtC,IAAI,gBAAgB,GAAG,CAAC,IAAI,gBAAgB,GAAG,WAAW,CAAC,MAAM,EAAE;;gBAEjE,OAAO;aACR;YACD,IAAM,aAAa,GAAG,WAAW,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAC;YACjE,IAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;YACxD,IAAM,mBAAmB,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC;;YAE/C,IAAI,KAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,KAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,EAAE;gBAC3E,OAAO;aACR;YACD,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;YAC5C,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,EAAC,IAAI,EAAC,IAAI,CAAC,CAAC;YAChD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,mBAAmB,EAAC,IAAI,EAAC,IAAI,CAAC,CAAC;SACrD,CAAC,CAAC;KAEJ;IACO,0CAAa,GAArB,UAAsB,KAAU;QAC9B,OAAO,KAAK,KAAK,EAAE,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,CAAC;KAC9D;;;;;;IAMO,oCAAO,GAAf;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QAC/C,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACtD,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC;QAErB,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;;;YAGvB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBACxD,IAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAChC,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACpD,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBAClC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,yBAAyB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;oBACrG,MAAM,KAAK,CAAC,yFAAiB,OAAO,2GAAmB,CAAC,CAAC;iBAC1D;gBACD,IAAI,IAAI,MAAI,OAAO,SAAI,OAAO,CAAC,SAAW,CAAC;aAC5C;SACF;QACD,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;KACb;IAID,sBAAY,2CAAW;;;;aAAvB;YACE,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;gBACjD,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;gBAC3E,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC;iBACvC;aACF;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;;gBApTF,UAAU;;;;gBANF,kBAAkB;gBAJL,UAAU;gBACvB,kBAAkB;gBADO,SAAS;gBAGlC,eAAe,uBAkBnB,QAAQ;gBAnBJ,iBAAiB;gBAGjB,gBAAgB;;IA0TzB,yBAAC;CArTD;;ACTA;;;AAGA;;;;IA+BE,yBAAY,YAA0B;QACpC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;KAClC;IAvBD,sBAAc,uCAAU;;;;aAAxB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;SAC9D;;;OAAA;IAKD,sBAAc,wCAAW;;;;aAAzB;YACE,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;SACpC;;;OAAA;IAKD,sBAAc,wCAAW;;;;aAAzB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;IASH,sBAAC;CAAA;;ACxCD;;;AAGA;IAAA;KA4KC;;;;IAvKQ,gDAAmB,GAA1B,UAA2B,WAAwB,EAAE,gBAAwB;QAE3E,IAAM,aAAa,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;QAChD,IAAM,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;QAC7E,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,gBAAgB,EAAE,eAAe,CAAC,CAAC;KACnE;IACM,oDAAuB,GAA9B,UAA+B,WAAwB,EAAE,gBAAwB,EAAE,cAAsB;QACvG,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC;;QAE3C,IAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QAC7E,IAAI,SAAS,GAAG,cAAc,CAAC;QAC/B,IAAI,CAAC,gBAAgB,EAAE;YACrB,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;SAClE;QACD,UAAU,CAAC;YACT,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACjD,EAAE,CAAC,CAAC,CAAC;KACP;;;;IAIM,yCAAY,GAAnB,UAAoB,WAAwB,EAAE,gBAAwB,EAAE,cAAsB;QAC5F,IAAM,aAAa,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;;QAEhD,IAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QAC7E,IAAI,SAAS,GAAG,cAAc,CAAC;QAC/B,IAAI,CAAC,gBAAgB,EAAE;YACrB,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;SAClE;QACD,IAAI,WAAW,CAAC,uBAAuB,KAAK,IAAI,EAAE;YAChD,OAAO;SACR;QACD,UAAU,CAAC;YACT,WAAW,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAClC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACtD,EAAE,CAAC,CAAC,CAAC;KACP;;;;IAKM,0CAAa,GAApB,UAAqB,aAAoB,EAAE,gBAAwB,EAAE,GAAW;QAC9E,IAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;;QAE3D,IAAM,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC,CAAC,UAAU,CAAC,CAAC;;QAG1D,IAAI,SAAS,KAAK,KAAK,EAAE;YACvB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;;;KAId;;;;;IAMO,2CAAc,GAAtB,UAAuB,aAAoB,EAAE,gBAAwB;QACnE,IAAI,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YAC9C,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;YAClD,OAAO,KAAK,KAAK,CAAC,CAAC;SACpB,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,EAAE;YACb,IAAM,WAAS,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;YACrE,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;gBAC1C,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBAClD,OAAO,KAAK,KAAK,WAAS,CAAC;aAC5B,CAAC,CAAC;SACJ;QACD,OAAO,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KACvC;IACO,yCAAY,GAApB,UAAqB,aAAoB,EAAE,gBAAwB;QACjE,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,IAAI,aAAa,IAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE;YACjD,IAAM,MAAM,GAAG,aAAa,CAAC,GAAG,CAAC,UAAA,IAAI;gBACnC,IAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBAC9C,OAAO,KAAK,CAAC;aACd,CAAC,CAAC;YACH,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;YAC9C,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;gBACpB,KAAK,GAAG,QAAQ,CAAC;aAClB;SACF;QACD,OAAO,KAAK,CAAC;KACd;;;;IAIM,0CAAa,GAApB,UAAqB,aAAoB,EAAE,gBAAwB,EAAE,SAAiB;;QAGpF,IAAM,eAAe,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YACvD,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;SACrC,CAAC,CAAC;QACH,IAAM,YAAY,GAAG,eAAe,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;;QAGhE,IAAM,MAAM,GAAG,YAAY,GAAG,CAAC,CAAC;QAChC,IAAM,cAAc,GAAG,eAAe,CAAC,gBAAgB,CAAC,CAAC,eAAe,CAAC,CAAC;;QAG1E,IAAM,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,gBAAgB,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;;QAG7G,IAAI,oBAAoB,CAAC,MAAM,KAAK,CAAC,EAAE;YACrC,IAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;gBAClD,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,cAAc,CAAC;aAC1C,CAAC,CAAC;;;YAIH,IAAI,CAAC,UAAU,EAAE;gBACf,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;aAC7D;YACD,OAAO,UAAU,CAAC,IAAI,CAAC,CAAC;SACzB;aAAM;YACL,OAAO,IAAI,CAAC,oBAAoB,CAAC,oBAAoB,EAAE,SAAS,CAAC,CAAC;SACnE;KACF;;;;IAKM,iDAAoB,GAA3B,UAA4B,oBAA2B,EAAE,SAAiB;QACxE,IAAI,oBAAoB,CAAC,MAAM,IAAI,CAAC,EAAE;YACpC,OAAO,EAAE,CAAC;SACX;QAED,IAAM,YAAY,GAAG,oBAAoB,CAAC,SAAS,CAAC,UAAC,QAAa;YAChE,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;SACrC,CAAC,CAAC;;QAGH,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;QACnB,IAAI,YAAY,KAAK,oBAAoB,CAAC,MAAM,GAAG,CAAC,EAAE;YACpD,SAAS,GAAG,YAAY,GAAG,CAAC,CAAC;SAC9B;aAAM;YACL,SAAS,GAAG,YAAY,GAAG,CAAC,CAAC;SAC9B;QAED,OAAO,oBAAoB,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC;KAC9C;;;;IAKM,8CAAiB,GAAxB,UAAyB,aAAoB,EAAE,gBAAwB,EAAE,MAAc,EAAE,cAAsB;QAC7G,IAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,QAAQ;YACvD,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;YAClD,IAAM,aAAa,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,eAAe,CAAC,CAAC;YAClE,OAAO,CAAC,KAAK,KAAK,MAAM,GAAG,CAAC,KAAK,cAAc,IAAI,aAAa,CAAC;SAClE,CAAC,CAAC;QACH,OAAO,kBAAkB,CAAC;KAC3B;;;;IAKM,4CAAe,GAAtB,UAAuB,aAAoB,EAAE,EAAU;QACrD,IAAM,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YAChD,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;SAC9B,CAAC,CAAC;QACH,OAAO,QAAQ,GAAG,QAAQ,GAAG,IAAI,CAAC;KACnC;IACH,yBAAC;CAAA,IAAA;;AC/KD;;;AAGA;IAAA;KA8KC;;;;IAzKQ,8CAAmB,GAA1B,UAA2B,WAAwB,EAAE,gBAAwB;QAE3E,IAAM,aAAa,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;QAChD,IAAM,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;QAC7E,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,gBAAgB,EAAE,eAAe,CAAC,CAAC;KACnE;IACM,kDAAuB,GAA9B,UAA+B,WAAwB,EAAE,gBAAwB,EAAE,cAAsB;QACvG,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC;;QAE3C,IAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QAC7E,IAAI,SAAS,GAAG,cAAc,CAAC;QAC/B,IAAI,CAAC,gBAAgB,EAAE;YACrB,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;SAClE;QAED,UAAU,CAAC;YACT,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACjD,EAAE,CAAC,CAAC,CAAC;KACP;;;;IAIM,uCAAY,GAAnB,UAAoB,WAAwB,EAAE,gBAAwB,EAAE,cAAsB;QAC5F,IAAM,aAAa,GAAG,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;;QAEhD,IAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QAC7E,IAAI,SAAS,GAAG,cAAc,CAAC;QAC/B,IAAI,CAAC,gBAAgB,EAAE;YACrB,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;SAClE;QACD,IAAI,WAAW,CAAC,uBAAuB,KAAK,IAAI,EAAE;YAChD,OAAO;SACR;QACD,UAAU,CAAC;YACT,WAAW,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAClC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACtD,EAAE,CAAC,CAAC,CAAC;KACP;;;;IAKM,wCAAa,GAApB,UAAqB,aAAoB,EAAE,gBAAwB,EAAE,GAAW;QAC9E,IAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;;;QAG3D,IAAM,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC,CAAC,UAAU,CAAC,CAAC;;QAG1D,IAAI,SAAS,KAAK,KAAK,EAAE;YACvB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;;;KAGd;;;;;IAMO,yCAAc,GAAtB,UAAuB,aAAoB,EAAE,gBAAwB;QACnE,IAAI,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YAC9C,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;YAClD,OAAO,KAAK,KAAK,CAAC,CAAC;SACpB,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,EAAE;YACb,IAAM,WAAS,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;YACrE,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;gBAC1C,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBAClD,OAAO,KAAK,KAAK,WAAS,CAAC;aAC5B,CAAC,CAAC;SACJ;QACD,OAAO,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KACvC;IACO,uCAAY,GAApB,UAAqB,aAAoB,EAAE,gBAAwB;QACjE,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,IAAI,aAAa,IAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE;YACjD,IAAM,MAAM,GAAG,aAAa,CAAC,GAAG,CAAC,UAAA,IAAI;gBACnC,IAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBAC9C,OAAO,KAAK,CAAC;aACd,CAAC,CAAC;YACH,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;YAC9C,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;gBACpB,KAAK,GAAG,QAAQ,CAAC;aAClB;SACF;QACD,OAAO,KAAK,CAAC;KACd;;;;IAIM,wCAAa,GAApB,UAAqB,aAAoB,EAAE,gBAAwB,EAAE,SAAiB;;QAGpF,IAAM,eAAe,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YACvD,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;SACrC,CAAC,CAAC;QACH,IAAM,WAAW,GAAG,eAAe,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,CAAC;QAC9D,IAAM,YAAY,GAAG,eAAe,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;;QAGhE,IAAM,MAAM,GAAG,YAAY,GAAG,CAAC,CAAC;QAChC,IAAM,KAAK,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;QAG/D,IAAM,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,gBAAgB,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;;QAGpG,IAAI,oBAAoB,CAAC,MAAM,KAAK,CAAC,EAAE;YACrC,IAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;gBAClD,OAAO,QAAQ,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,KAAK,KAAK,CAAC;aACrD,CAAC,CAAC;;;YAIH,IAAI,CAAC,UAAU,EAAE;gBACf,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;aAC7D;YACD,OAAO,UAAU,CAAC,IAAI,CAAC,CAAC;SACzB;aAAM;YACL,OAAO,IAAI,CAAC,oBAAoB,CAAC,oBAAoB,EAAE,SAAS,CAAC,CAAC;SACnE;KACF;;;;IAKM,+CAAoB,GAA3B,UAA4B,oBAA2B,EAAE,SAAiB;QACxE,IAAI,oBAAoB,CAAC,MAAM,IAAI,CAAC,EAAE;YACpC,OAAO,EAAE,CAAC;SACX;QAED,IAAM,YAAY,GAAG,oBAAoB,CAAC,SAAS,CAAC,UAAC,QAAa;YAChE,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;SACrC,CAAC,CAAC;;QAGH,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;QACnB,IAAI,YAAY,KAAK,oBAAoB,CAAC,MAAM,GAAG,CAAC,EAAE;YACpD,SAAS,GAAG,YAAY,GAAG,CAAC,CAAC;SAC9B;aAAM;YACL,SAAS,GAAG,YAAY,GAAG,CAAC,CAAC;SAC9B;QAED,OAAO,oBAAoB,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC;KAC9C;;;;IAKM,4CAAiB,GAAxB,UAAyB,aAAoB,EAAE,gBAAwB,EAAE,MAAc,EAAE,KAAa;QACpG,IAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,QAAQ;YACvD,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;YAClD,IAAM,IAAI,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,CAAC;YAChD,OAAO,CAAC,KAAK,KAAK,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;SACzD,CAAC,CAAC;QACH,OAAO,kBAAkB,CAAC;KAC3B;;;;IAKM,0CAAe,GAAtB,UAAuB,aAAoB,EAAE,EAAU;QACrD,IAAM,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAa;YAChD,OAAO,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;SAC9B,CAAC,CAAC;QACH,OAAO,QAAQ,GAAG,QAAQ,GAAG,IAAI,CAAC;KACnC;IACH,uBAAC;CAAA,IAAA;;ACnLD;;;;;;AAMA,AAGA;IAAA;KAcC;IAbQ,2BAAW,GAAlB,UAAmB,QAAgB;QACjC,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,QAAQ,QAAQ;YACd,KAAK,MAAM;gBACT,IAAI,GAAG,IAAI,gBAAgB,EAAE,CAAC;gBAC9B,MAAM;YACR,KAAK,QAAQ;gBACX,IAAI,GAAG,IAAI,kBAAkB,EAAE,CAAC;gBAChC,MAAM;YACR,SAAS,MAAM;SAChB;QACD,OAAO,IAAI,CAAC;KACb;IACH,sBAAC;CAAA,IAAA;;ACjBD;;;AAGA;IAAA;KAkZC;;;;IA7YQ,yCAAU,GAAjB,UAAkB,UAAiC,EAAE,EAAU;QAC7D,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,aAAa,GAAM,OAAO,0CAAuC,CAAC;QACxE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,EAAE;YACV,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CACjE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,MAAM,GAAG,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YAChE,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC9C,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,uCAAQ,GAAf,UAAgB,UAAiC,EAAE,QAAgB;QACjE,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,WAAW,GAAM,OAAO,6CAA0C,CAAC;QAEzE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,QAAQ;YAChB,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC/D,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,MAAM,GAAG,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YAChE,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC9C,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,4CAAa,GAApB,UAAqB,UAAiC,EAAE,KAAoB,EAAE,GAAkB;QAAhG,iBAoBC;QAnBC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,gBAAgB,GAAM,OAAO,mDAAgD,CAAC;QACpF,IAAM,IAAI,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,GAAG,EAAE,GAAG;YACR,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,gBAAgB,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CACpE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAI,IAAI,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACrC,IAAM,MAAM,GAAG,UAAU,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,EAAE,YAAY,CAAC,WAAW,CAAC,CAAA;YAC1F,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,0CAAW,GAAlB,UAAmB,UAAiC,EAAE,KAAoB,EAAE,GAAkB;QAA9F,iBAqBC;QApBC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,cAAc,GAAM,OAAO,sDAAmD,CAAC;QAErF,IAAM,IAAI,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,GAAG,EAAE,GAAG;YACR,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAClE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAI,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACtC,IAAM,MAAM,GAAG,UAAU,CAAC,aAAa,CAAC,kBAAkB,CAAC,KAAK,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC;YAC5F,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;IAEO,uCAAQ,GAAhB,UAAiB,KAAe,EAAE,GAAa;QAC7C,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;oBACZ,KAAK,GAAG,KAAK,IAAG,MAAI,GAAG,CAAC,CAAC,CAAG,CAAA,CAAC;oBAC7B,KAAK,GAAG,KAAK,IAAG,MAAI,KAAK,CAAC,CAAC,CAAC,MAAG,CAAA,CAAC;iBACjC;aACF;SACF;QACD,OAAO,KAAK,CAAC;KACd;;;;;IAMM,6CAAc,GAArB,UAAsB,UAAiC,EAAE,gBAAwB,EAAE,QAAgB,EAAE,OAAc,EAAE,KAAY,EAAE,gBAAiC,EAAE,UAAoD,EAAE,YAA2B,EAAE,MAAuB;QAAhR,iBA2CC;QA3CkI,iCAAA,EAAA,wBAAiC;QAAqF,uBAAA,EAAA,cAAuB;QAC9Q,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC/E,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE;YACxD,OAAO,EAAE,CAAC,aAAa,CAAC,CAAC;SAC1B;QACD,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,mBAAmB,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC9F,IAAM,wBAAwB,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;QAChG,IAAM,iBAAiB,GAAG,IAAI,CAAC,sBAAsB,CAAC,wBAAwB,EAAE,mBAAmB,EAAE,OAAO,CAAC,CAAC;QAC9G,IAAM,eAAe,GAAG,UAAU,IAAI,UAAU,CAAC,QAAQ,GAAG,CAAC,IAAI,KAAK,CAAC;;QAEvE,IAAM,YAAY,GAAG;YACnB,gBAAgB,EAAE,iBAAiB;YACnC,cAAc,EAAE,KAAK;YACrB,eAAe,EAAE,eAAe;YAChC,UAAU,EAAE,EAAE,SAAS,EAAE,UAAU,IAAI,UAAU,CAAC,SAAS,IAAI,CAAC,EAAE,QAAQ,EAAE,UAAU,IAAI,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE;SAClJ,CAAC;QACF,IAAM,WAAW,GAAG,WAAW,CAAC,gBAAgB,EAAE,CAAC;QACnD,OAAO,WAAW,CAAC,WAAW,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC,IAAI,CAC5D,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,cAAc,GAAG,KAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAC5D,IAAI,QAAQ,EAAE;gBACZ,IAAI,cAAc,IAAI,cAAc,CAAC,QAAQ,KAAK,CAAC,IAAI,YAAY,EAAE;oBACnE,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,WAAS,QAAQ,sBAAmB,EAAE,cAAc,CAAC,CAAC;iBAC/E;aACF;iBAAM;gBACL,IAAI,cAAc,IAAI,cAAc,CAAC,QAAQ,KAAK,CAAC,IAAI,YAAY,EAAE;oBACnE,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,0BAA0B,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;iBAC1F;aACF;;YAED,KAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;;YAElG,IAAM,QAAQ,GAAG,YAAY,CAAC,WAAW,CAAC,MAAM,CAAC;YACjD,IAAM,QAAQ,GAAG,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,gBAAgB,EAAE;gBACpB,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aAC/C;iBAAM;gBACL,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;aACnD;YACD,OAAO,QAAQ,CAAC;SACjB,CAAC,CACH,CAAC;KACH;;IAEM,2CAAY,GAAnB,UAAoB,UAAiC,EAAE,gBAAwB,EAAE,QAAgB,EAAE,YAAoB,EAAE,YAAoB,EAAE,QAAgB,EAAE,OAAe,EAAE,OAAa;QAA/L,iBAsDC;QArDC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,QAAQ,GAAM,OAAO,mCAAgC,CAAC;QAC5D,IAAM,mBAAmB,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC9F,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAEjE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,QAAQ,IAAI,EAAE;YACtB,eAAe,EAAE,KAAK;YACtB,mBAAmB,EAAE,YAAY;YACjC,UAAU,EAAE,EAAE;YACd,YAAY,cAAA;YACZ,QAAQ,UAAA;YACR,MAAM,EAAE,YAAY;YACpB,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC5D,GAAG,CAAC,UAAC,YAA0B;;YAE7B,IAAI,YAAY,CAAC,WAAW,IAAI,YAAY,CAAC,WAAW,CAAC,aAAa,IAAI,OAAO,IAAI,OAAO,CAAC,YAAY,EAAE;gBACzG,IAAM,YAAY,GAAG,OAAO,CAAC,YAA4B,CAAC;gBAC1D,IAAM,uBAAuB,GAAG,YAAY,IAAI,YAAY,CAAC,0BAA0B,EAAE,IAAI,IAAI,CAAC;gBAClG,IAAI,uBAAuB,EAAE;oBAC3B,IAAM,IAAI,GAAG,YAAY,CAAC,WAAW,CAAC,MAAe,CAAC;oBACtD,IAAM,eAAa,GAAG,YAAY,CAAC,WAAW,CAAC,aAAa,CAAC;;oBAE7D,IAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,eAAa,GAAA,CAAC,CAAC;oBACtF,IAAM,aAAa,GAAG,YAAY,CAAC,gBAAgB,CAAgE,CAAC;oBACpH,IAAM,GAAG,GAAG,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,IAAI,EAAE,gBAAgB,EAAE,UAAU,CAAC,CAAC;oBACpF,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,EAAE,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC1E,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,uBAAuB,EAAE,eAAa,CAAC,CAAC;oBAC3E,uBAAuB,CAAC,OAAO,CAAC,gBAAgB,CAAC,uBAAuB,EAAE,eAAa,CAAC,CAAC;iBAC1F;aACF;SACF,CAAC,EACF,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,gBAAgB,GAAG,OAAO,IAAI,OAAO,CAAC,gBAAgB,IAAI,KAAK,CAAC;;YAEtE,KAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;;YAElG,IAAM,QAAQ,GAAG,YAAY,CAAC,WAAW,CAAC,MAAM,CAAC;YACjD,IAAM,QAAQ,GAAG,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,gBAAgB,EAAE;gBACpB,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aAC/C;iBAAM;gBACL,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;aACnD;YACD,OAAO,QAAQ,CAAC;SACjB,CAAC,CACH,CAAC;KACH;;;;IAIM,qDAAsB,GAA7B,UAA8B,wBAAgC,EAAE,mBAAwB,EAAE,WAAkB;QAC1G,IAAM,YAAY,GAAG,WAAW,IAAI,WAAW,CAAC,MAAM,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACpE,IAAM,WAAW,GAAG,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC3E,IAAM,aAAa,GAAG,mBAAmB,GAAG,mBAAmB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;QAE3E,IAAM,iBAAiB,GAAG;YACxB;gBACE,aAAa,EAAK,wBAAwB,WAAQ;gBAClD,OAAO,EAAE,WAAW,GAAG,CAAC;gBACxB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,CAAC;gBACb,aAAa,EAAE,CAAC;gBAChB,SAAS,EAAE,CAAC;aACb;SACF,CAAC;QACF,IAAI,aAAa,EAAE;YACjB,iBAAiB,CAAC,IAAI,CACpB;gBACE,aAAa,EAAK,wBAAwB,mBAAgB;gBAC1D,OAAO,EAAE,aAAa;gBACtB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,YAAY;gBACxB,aAAa,EAAE,CAAC;gBAChB,SAAS,EAAE,CAAC;aACb,CACF,CAAC;SACH;aAAM;YACL,iBAAiB,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,YAAY,CAAC;SAC9C;QACD,OAAO,iBAAiB,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;KAC9C;IACM,gDAAiB,GAAxB,UAAyBA,SAAa,EAAE,IAAW,EAAE,QAAgB,EAAE,SAAiB;;QAGtF,IAAI,CAACA,SAAM,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,SAAS,EAAE;YAC/C,OAAO,IAAI,CAAC;SACb;QACD,IAAI,CAACA,SAAM,EAAE;YACXA,SAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAI,CAAC,IAAI,EAAE;YACT,IAAI,GAAG,EAAE,CAAC;SACX;;QAED,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/BA,SAAM,CAACA,SAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;SACxC;QACD,IAAM,YAAY,GAAG;YACnB,gBAAgB,EAAEA,SAAM;YACxB,cAAc,EAAE,IAAI;YACpB,eAAe,EAAE,QAAQ,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;YAC9C,UAAU,EAAE;gBACV,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAE,QAAQ;gBAClB,SAAS,EAAE,CAAC;gBACZ,UAAU,EAAE,CAAC;aACd;SACF,CAAC;QACF,OAAO,YAAY,CAAC;KACrB;;;;;IAKM,sDAAuB,GAA9B,UAA+B,UAAiC,EAAE,gBAAwB,EAAE,mBAAwB,EAAE,gBAAiC;QAAjC,iCAAA,EAAA,wBAAiC;;QAErJ,IAAI,CAAC,mBAAmB,EAAE;YACxB,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;YACpC,OAAO;SACR;QACD,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,gBAAgB,EAAE,mBAAmB,CAAC,CAAC;QACpF,IAAI,gBAAgB,EAAE;YACpB,UAAU,CAAC,gBAAgB,CAAC,cAAc,CAAC,UAAC,MAAc;gBACxD,IAAM,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;gBACrC,OAAO,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;aAC3B,CAAC,CAAC;SACJ;aAAM;YACL,UAAU,CAAC,gBAAgB,CAAC,UAAU,CAAC,UAAC,MAAc;gBACpD,IAAM,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;gBACrC,OAAO,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;aAC3B,CAAC,CAAC;SACJ;KAEF;;;;;;;IAOO,4CAAa,GAArB,UAAsB,UAAiC,EAAE,gBAAwB,EAAE,mBAAwB;QAA3G,iBAoBC;QAnBC,IAAM,cAAc,GAAG,mBAAmB,CAAC,EAAE,CAAC;QAC9C,IAAM,MAAM,GAAG,mBAAmB,CAAC,KAAK,CAAC;QACzC,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,UAAU,CAAC,gBAAgB,CAAC,cAAc,EAAE,CAAC,OAAO,CAAC,UAAA,MAAM;YACzD,IAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,CAAC;YAC/C,IAAM,aAAa,GAAG,aAAa,CAAC,aAAa,CAAC;YAClD,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;YAClC,IAAM,MAAM,GAAG,KAAK,KAAK,MAAM,GAAG,CAAC,CAAC,IAAI,aAAa,KAAK,cAAc,CAAC;YACzE,IAAI,MAAM,EAAE;gBACV,IAAM,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;gBACrC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACf,IAAM,kBAAkB,GAAG,KAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,EAAE,CAAC,CAAC;gBACvF,IAAM,MAAM,GAAG,KAAI,CAAC,aAAa,CAAC,UAAU,EAAE,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;gBACpF,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC/B,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iBAC9B;aACF;SACF,CAAC,CAAC;QACH,OAAO,KAAK,CAAC;KACd;;;;IAIM,mDAAoB,GAA3B,UAA4B,UAAiC,EAAE,gBAAwB,EAAE,EAAU;QACjG,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAW,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACrE,IAAM,mBAAmB,GAAW,MAAM,CAAC,gBAAgB,CAAC,CAAC;QAC7D,IAAM,MAAM,GAAG,mBAAmB,CAAC,MAAM,EAAE,CAAC;QAC5C,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;QAClB,OAAO,MAAM,CAAC;KACf;IACM,+CAAgB,GAAvB,UAAwB,MAAc,EAAE,gBAAwB;QAC9D,OAAO,MAAM,CAAC,gBAAgB,CAAC,CAAC;KACjC;;;;IAIM,0DAA2B,GAAlC,UAAmC,UAAiC,EAAE,gBAAwB;QAC5F,IAAM,SAAS,GAAG,iBAAiB,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACxE,IAAM,qBAAqB,GAAG,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC1D,OAAO,qBAAqB,CAAC,iBAA2B,CAAC;KAC1D;IACO,gDAAiB,GAAzB,UAA0B,YAA0B;QAClD,OAAO,YAAY,IAAI,YAAY,CAAC,WAAW,IAAI,YAAY,CAAC,WAAW,CAAC,UAAU,IAAI,IAAI,CAAC;KAChG;IACO,yCAAU,GAAlB,UAAmB,aAA0E,EAAE,IAAW,EAAE,gBAAwB;QAClI,OAAO,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI;YACnB,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAgE,CAAC;YACnH,OAAO,oBAAoB,CAAC,KAAK,KAAK,aAAa,CAAC,KAAK,GAAG,CAAC,IAAI,aAAa,CAAC,aAAa,KAAK,oBAAoB,CAAC,aAAa,CAAC;SACrI,CAAC,CAAC;KACJ;IACO,8CAAe,GAAvB,UAAwB,aAA0E,EAAE,IAAW,EAAE,gBAAwB,EAAE,UAA2B;QACpK,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;QAClE,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,OAAO,IAAI,EAAE;YACX,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC;YACtC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;SACxE;QACD,OAAO,GAAG,CAAC;KACZ;;;;;;;;IAQO,0CAAW,GAAnB,UAAoB,UAAiC,EAAE,gBAAwB,EAAE,EAAU;QAA3F,iBAiBC;QAhBC,IAAM,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,EAAE,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,EAAE;YAClB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;QAClC,IAAM,aAAa,GAAG,aAAa,CAAC,aAAa,CAAC;QAClD,IAAM,QAAQ,GAAa,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,UAAC,MAAc;YAChF,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;YACtE,IAAM,OAAO,GAAG,aAAa,CAAC,KAAK,KAAK,KAAK,GAAG,CAAC,KAAK,aAAa,CAAC,aAAa,KAAK,aAAa,IAAI,CAAC,aAAa,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;YACvJ,IAAI,OAAO,EAAE;gBACX,OAAO,MAAM,CAAC;aACf;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF,CAAC,CAAC;QACH,OAAO,QAAQ,CAAC;KACjB;IACH,2BAAC;CAAA,IAAA;;ACrZD;;;AAGA;IAAA;KA6XC;;;;IAxXQ,uCAAU,GAAjB,UAAkB,UAAiC,EAAE,EAAU;QAC7D,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,aAAa,GAAM,OAAO,wCAAqC,CAAC;QACtE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,EAAE;YACV,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CACjE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,MAAM,GAAG,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YAChE,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC9C,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,qCAAQ,GAAf,UAAgB,UAAiC,EAAE,QAAgB;QACjE,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,WAAW,GAAM,OAAO,2CAAwC,CAAC;QAEvE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,QAAQ;YAChB,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC/D,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,MAAM,GAAG,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YAChE,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC9C,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,0CAAa,GAApB,UAAqB,UAAiC,EAAE,KAAoB,EAAE,GAAkB;QAAhG,iBAoBC;QAnBC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,gBAAgB,GAAM,OAAO,iDAA8C,CAAC;QAClF,IAAM,IAAI,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,GAAG,EAAE,GAAG;YACR,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,gBAAgB,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CACpE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAI,IAAI,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACrC,IAAM,MAAM,GAAG,UAAU,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,EAAE,YAAY,CAAC,WAAW,CAAC,CAAA;YAC1F,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;IAKM,wCAAW,GAAlB,UAAmB,UAAiC,EAAE,KAAoB,EAAE,GAAkB;QAA9F,iBAqBC;QApBC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,cAAc,GAAM,OAAO,oDAAiD,CAAC;QAEnF,IAAM,IAAI,GAAG;YACX,KAAK,EAAE,KAAK;YACZ,GAAG,EAAE,GAAG;YACR,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,OAAO,EAAE,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC;YAChE,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAClE,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAI,IAAI,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACrC,IAAM,MAAM,GAAG,UAAU,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,EAAE,YAAY,CAAC,WAAW,CAAC,CAAA;YAC1F,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;IAEO,qCAAQ,GAAhB,UAAiB,KAAe,EAAE,GAAa;QAC7C,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACnC,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;oBACZ,KAAK,GAAG,KAAK,IAAG,MAAI,GAAG,CAAC,CAAC,CAAG,CAAA,CAAC;oBAC7B,KAAK,GAAG,KAAK,IAAG,MAAI,KAAK,CAAC,CAAC,CAAC,MAAG,CAAA,CAAC;iBACjC;aACF;SACF;QACD,OAAO,KAAK,CAAC;KACd;;;;;IAMM,2CAAc,GAArB,UAAsB,UAAiC,EAAE,gBAAwB,EAAE,QAAgB,EAAE,OAAc,EAAE,KAAY,EAAE,gBAAiC,EAAE,UAAoD,EAAE,YAA2B,EAAE,MAAuB;QAAhR,iBA4CC;QA5CkI,iCAAA,EAAA,wBAAiC;QAAqF,uBAAA,EAAA,cAAuB;QAC9Q,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC/E,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE;YACxD,OAAO,EAAE,CAAC,aAAa,CAAC,CAAC;SAC1B;QACD,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,mBAAmB,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC9F,IAAM,wBAAwB,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;QAChG,IAAM,iBAAiB,GAAG,IAAI,CAAC,sBAAsB,CAAC,wBAAwB,EAAE,mBAAmB,EAAE,OAAO,CAAC,CAAC;QAC9G,IAAM,eAAe,GAAG,UAAU,IAAI,UAAU,CAAC,QAAQ,GAAG,CAAC,IAAI,KAAK,CAAC;;QAEvE,IAAM,YAAY,GAAG;YACnB,gBAAgB,EAAE,iBAAiB;YACnC,cAAc,EAAE,KAAK;YACrB,eAAe,EAAE,eAAe;YAChC,UAAU,EAAE,EAAE,SAAS,EAAE,UAAU,IAAI,UAAU,CAAC,SAAS,IAAI,CAAC,EAAE,QAAQ,EAAE,UAAU,IAAI,UAAU,CAAC,QAAQ,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE;SAClJ,CAAC;QACF,IAAM,WAAW,GAAG,WAAW,CAAC,gBAAgB,EAAE,CAAC;QACnD,OAAO,WAAW,CAAC,WAAW,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC,IAAI,CAC5D,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,cAAc,GAAG,KAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAC5D,IAAI,QAAQ,EAAE;gBACZ,IAAI,cAAc,IAAI,cAAc,CAAC,QAAQ,KAAK,CAAC,IAAI,YAAY,EAAE;oBACnE,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,WAAS,QAAQ,sBAAmB,EAAE,cAAc,CAAC,CAAC;iBAC/E;aACF;iBAAM;gBACL,IAAI,cAAc,IAAI,cAAc,CAAC,QAAQ,KAAK,CAAC,IAAI,YAAY,EAAE;oBACnE,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,0BAA0B,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;iBAC1F;aACF;;YAED,KAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;;YAElG,IAAM,QAAQ,GAAG,YAAY,CAAC,WAAW,CAAC,MAAM,CAAC;YACjD,IAAM,QAAQ,GAAG,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,gBAAgB,EAAE;gBACpB,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aAC/C;iBAAM;gBACL,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;aACnD;YAED,OAAO,QAAQ,CAAC;SACjB,CAAC,CACH,CAAC;KACH;;IAEM,yCAAY,GAAnB,UAAoB,UAAiC,EAAE,gBAAwB,EAAE,QAAgB,EAAE,YAAoB,EAAE,YAAoB,EAAE,QAAgB,EAAE,OAAe,EAAE,OAAa;QAA/L,iBAqDC;QApDC,IAAM,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;QAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,QAAQ,GAAM,OAAO,mCAAgC,CAAC;QAC5D,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QAC5F,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACjE,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,QAAQ,IAAI,EAAE;YACtB,eAAe,EAAE,KAAK;YACtB,mBAAmB,EAAE,YAAY;YACjC,UAAU,EAAE,EAAE;YACd,YAAY,cAAA;YACZ,QAAQ,UAAA;YACR,MAAM,EAAE,YAAY;YACpB,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC5D,GAAG,CAAC,UAAC,YAA0B;;YAE7B,IAAI,YAAY,CAAC,WAAW,IAAI,YAAY,CAAC,WAAW,CAAC,aAAa,IAAI,OAAO,IAAI,OAAO,CAAC,YAAY,EAAE;gBACzG,IAAM,YAAY,GAAG,OAAO,CAAC,YAA4B,CAAC;gBAC1D,IAAM,uBAAuB,GAAG,YAAY,IAAI,YAAY,CAAC,0BAA0B,EAAE,IAAI,IAAI,CAAC;gBAClG,IAAI,uBAAuB,EAAE;oBAC3B,IAAM,IAAI,GAAG,YAAY,CAAC,WAAW,CAAC,MAAe,CAAC;oBACtD,IAAM,eAAa,GAAG,YAAY,CAAC,WAAW,CAAC,aAAa,CAAC;;oBAE7D,IAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,eAAa,GAAA,CAAC,CAAC;oBACtF,IAAM,aAAa,GAAG,YAAY,CAAC,gBAAgB,CAAuD,CAAC;oBAC3G,IAAM,GAAG,GAAG,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,IAAI,EAAE,gBAAgB,EAAE,UAAU,CAAC,CAAC;oBACpF,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,EAAE,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC1E,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,uBAAuB,EAAE,eAAa,CAAC,CAAC;oBAC3E,uBAAuB,CAAC,OAAO,CAAC,gBAAgB,CAAC,uBAAuB,EAAE,eAAa,CAAC,CAAC;iBAC1F;aACF;SACF,CAAC,EACF,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,gBAAgB,GAAY,OAAO,IAAI,OAAO,CAAC,gBAAgB,IAAI,KAAK,CAAC;;YAE/E,KAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,gBAAgB,CAAC,CAAC;;YAEhG,IAAM,QAAQ,GAAG,YAAY,CAAC,WAAW,CAAC,MAAM,CAAC;YACjD,IAAM,QAAQ,GAAG,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,gBAAgB,EAAE;gBACpB,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aAC/C;iBAAM;gBACL,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;aACnD;YACD,OAAO,QAAQ,CAAC;SACjB,CAAC,CACH,CAAC;KACH;;;;IAIM,mDAAsB,GAA7B,UAA8B,wBAAgC,EAAE,mBAAwB,EAAE,WAAkB;QAC1G,IAAM,YAAY,GAAG,WAAW,IAAI,WAAW,CAAC,MAAM,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAEpE,IAAM,WAAW,GAAG,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC3E,IAAM,iBAAiB,GAAG;YACxB;gBACE,aAAa,EAAK,wBAAwB,WAAQ;gBAClD,OAAO,EAAE,WAAW,GAAG,CAAC;gBACxB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,CAAC;gBACb,aAAa,EAAE,CAAC;gBAChB,SAAS,EAAE,CAAC;aACb;SACF,CAAC;;QAGF,IAAM,UAAU,GAAG,mBAAmB,GAAG,mBAAmB,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;QAC1E,IAAI,UAAU,EAAE;YACd,iBAAiB,CAAC,IAAI,CAAC;gBACrB,aAAa,EAAK,wBAAwB,UAAO;gBACjD,OAAO,EAAE,UAAU;gBACnB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,IAAI;gBAChB,UAAU,EAAE,YAAY;gBACxB,aAAa,EAAE,CAAC;gBAChB,SAAS,EAAE,CAAC;aACb,CAAC,CAAC;SACJ;aAAM;YACL,iBAAiB,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,YAAY,CAAC;SAC9C;QAED,OAAO,iBAAiB,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;KAC9C;IACM,8CAAiB,GAAxB,UAAyBA,SAAa,EAAE,IAAW,EAAE,QAAgB,EAAE,SAAiB;;QAGtF,IAAI,CAACA,SAAM,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,SAAS,EAAE;YAC/C,OAAO,IAAI,CAAC;SACb;QACD,IAAI,CAACA,SAAM,EAAE;YACXA,SAAM,GAAG,EAAE,CAAC;SACb;QACD,IAAI,CAAC,IAAI,EAAE;YACT,IAAI,GAAG,EAAE,CAAC;SACX;;QAED,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/BA,SAAM,CAACA,SAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;SACxC;QACD,IAAM,YAAY,GAAG;YACnB,gBAAgB,EAAEA,SAAM;YACxB,cAAc,EAAE,IAAI;YACpB,eAAe,EAAE,QAAQ,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;YAC9C,UAAU,EAAE;gBACV,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAE,QAAQ;gBAClB,SAAS,EAAE,CAAC;gBACZ,UAAU,EAAE,CAAC;aACd;SACF,CAAC;QACF,OAAO,YAAY,CAAC;KACrB;;;;IAIM,oDAAuB,GAA9B,UAA+B,UAAiC,EAAE,gBAAwB,EAAE,mBAAwB,EAAE,gBAAiC;QAAjC,iCAAA,EAAA,wBAAiC;;QAGrJ,IAAI,CAAC,mBAAmB,EAAE;YACxB,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;YACpC,OAAO;SACR;QACD,IAAM,KAAK,GAAG,mBAAmB,CAAC,IAAI,CAAC;QACvC,IAAM,MAAM,GAAG,mBAAmB,CAAC,KAAK,CAAC;QACzC,IAAI,gBAAgB,EAAE;YACpB,UAAU,CAAC,gBAAgB,CAAC,UAAU,CAAC,UAAC,MAAc;gBACpD,IAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,CAAC;gBAC/C,IAAM,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC;gBAChC,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;gBAClC,OAAO,KAAK,GAAG,MAAM,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;aACjD,CAAC,CAAC;SACJ;aAAM;YACL,UAAU,CAAC,gBAAgB,CAAC,cAAc,CAAC,UAAC,MAAc;gBACxD,IAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,CAAC;gBAC/C,IAAM,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC;gBAChC,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;gBAClC,OAAO,KAAK,GAAG,MAAM,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;aACjD,CAAC,CAAC;SACJ;KAEF;;;;IAKM,iDAAoB,GAA3B,UAA4B,UAAiC,EAAE,gBAAwB,EAAE,EAAU;QACjG,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAW,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACrE,IAAM,mBAAmB,GAAW,MAAM,CAAC,gBAAgB,CAAC,CAAC;QAC7D,OAAO,mBAAmB,CAAC,MAAM,EAAE,CAAC;KACrC;;;;IAKM,wDAA2B,GAAlC,UAAmC,UAAiC,EAAE,gBAAwB;QAC5F,IAAM,SAAS,GAAG,iBAAiB,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACxE,IAAM,qBAAqB,GAAG,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC1D,OAAO,qBAAqB,CAAC,iBAA2B,CAAC;KAC1D;IACO,8CAAiB,GAAzB,UAA0B,YAA0B;QAClD,OAAO,YAAY,IAAI,YAAY,CAAC,WAAW,IAAI,YAAY,CAAC,WAAW,CAAC,UAAU,IAAI,IAAI,CAAC;KAChG;IACO,uCAAU,GAAlB,UAAmB,aAAiE,EAAE,IAAW,EAAE,gBAAwB;QACzH,OAAO,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI;YACnB,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAuD,CAAC;YAC1G,OAAO,oBAAoB,CAAC,KAAK,KAAK,aAAa,CAAC,KAAK,GAAG,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;SAC3H,CAAC,CAAC;KACJ;IACO,4CAAe,GAAvB,UAAwB,aAAiE,EAAE,IAAW,EAAE,gBAAwB,EAAE,UAA2B;QAC3J,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;QAClE,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,OAAO,IAAI,EAAE;YACX,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC;YACtC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;SACxE;QACD,OAAO,GAAG,CAAC;KACZ;IACO,6CAAgB,GAAxB,UAAyB,MAAc,EAAE,gBAAwB;QAC/D,OAAO,MAAM,CAAC,gBAAgB,CAAC,CAAC;KACjC;;;;;;;;IAQO,wCAAW,GAAnB,UAAoB,UAAiC,EAAE,gBAAwB,EAAE,EAAU;QAA3F,iBAiBC;QAhBC,IAAM,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,gBAAgB,EAAE,EAAE,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,EAAE;YAClB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;QAClC,IAAM,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC;QAChC,IAAM,QAAQ,GAAa,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,UAAC,MAAc;YAChF,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;YACtE,IAAM,OAAO,GAAG,aAAa,CAAC,KAAK,KAAK,KAAK,GAAG,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACzF,IAAI,OAAO,EAAE;gBACX,OAAO,MAAM,CAAC;aACf;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF,CAAC,CAAC;QACH,OAAO,QAAQ,CAAC;KACjB;IACH,yBAAC;CAAA,IAAA;;ACnYD;IAAA;KAcC;IAbU,iCAAW,GAAlB,UAAmB,QAAgB;QAC/B,IAAI,UAAU,GAAC,IAAI,CAAC;QACpB,QAAQ,QAAQ;YACZ,KAAK,MAAM;gBACP,UAAU,GAAG,IAAI,kBAAkB,EAAE,CAAC;gBACtC,MAAM;YACV,KAAK,QAAQ;gBACT,UAAU,GAAG,IAAI,oBAAoB,EAAE,CAAC;gBACxC,MAAM;YACV,SAAS,MAAM;SAClB;QACD,OAAO,UAAU,CAAC;KACrB;IACL,4BAAC;CAAA,IAAA;;ACAD;;;;AAKA;IAC8BL,mCAAe;;;;IAe3C,yBACE,YAA0B,EAClB,cAAkC,EAClC,cAAkC,EAClC,aAAgC,EAChC,YAA8B,EAClB,eAAgC;QANtD,YAQE,kBAAM,YAAY,CAAC,SAIpB;QAVS,oBAAc,GAAd,cAAc,CAAoB;QAClC,oBAAc,GAAd,cAAc,CAAoB;QAClC,mBAAa,GAAb,aAAa,CAAmB;QAChC,kBAAY,GAAZ,YAAY,CAAkB;QAClB,qBAAe,GAAf,eAAe,CAAiB;QAGpD,IAAI,CAAC,eAAe,EAAE;YACpB,KAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;;KACF;IAtBD,sBAAY,6CAAgB;;;;aAA5B;YACE,OAAO,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;SAClE;;;OAAA;IACD,sBAAY,oDAAuB;aAAnC;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;SACvD;;;OAAA;;;;IAsBM,8BAAI,GAAX,UAAY,OAAgB,EAAE,KAAc;QAA5C,iBA4BC;QA3BC,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QACnD,IAAM,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAM,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAE3E,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,EAAE,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACjF,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD;;YAGE,IAAI,mBAAmB,KAAK,IAAI,EAAE;gBAChC,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC9C,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;gBAChE,IAAI,YAAY,KAAK,IAAI,EAAE;oBACzB,YAAY,CAAC,mBAAmB,CAAC,KAAI,CAAC,WAAW,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC;iBAC3E;aACF;YAED,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACrE,CACF,CACF,CAAC;KACH;;;;IAKM,qCAAW,GAAlB,UAAmB,OAAgB,EAAE,KAAc,EAAE,gBAAmC;QAAxF,iBA0DC;QAzDC,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QACzC,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QACnD,IAAM,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;;QAE/C,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACtC,IAAM,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC3E,IAAI,gBAAgB,KAAK,SAAS,EAAE;YAClC,gBAAgB,GAAG,KAAK,CAAC;SAC1B;QACD,IAAI,OAAO,gBAAgB,KAAK,SAAS,EAAE;YACzC,gBAAgB,GAAG,gBAAgB,KAAK,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC;SAC/D;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAEpE,IAAI,UAAU,KAAK,IAAI,EAAE;YACvB,OAAO,KAAK,EAAE,CAAC;SAChB;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;;QAErE,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QACtD,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,KAAK,CAAC;QAC1E,IAAM,MAAM,GAAG,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,gBAAgB,EAAE,QAAQ,EAAE,YAAY,EAAE,UAAU,EAAE,gBAAgB,EAAE,UAAU,EAAE,IAAI,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;QAC9K,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD,UAAC,QAAkB;YACjB,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC;;YAErD,IAAI,mBAAmB,KAAK,IAAI,EAAE;gBAChC,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;gBAChE,IAAI,YAAY,KAAK,IAAI,EAAE;oBACzB,YAAY,CAAC,mBAAmB,CAAC,KAAI,CAAC,WAAW,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC;iBAC3E;aACF;YACD,IAAM,YAAY,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC;YACvE,IAAI,gBAAgB,EAAE;;gBAEpB,IAAM,kBAAkB,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,YAAY,KAAK,YAAY,GAAA,CAAC,CAAC;gBACrF,IAAI,kBAAkB,EAAE;oBACtB,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;iBACjC;;gBAED,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE;oBACjE,IAAM,YAAY,GAAG,QAAQ,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,IAAI,IAAI,CAAC;oBACpH,IAAI,YAAY,EAAE;wBAChB,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;qBACjC;iBACF;aACF;YACD,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACrE,CACF,CACF,CAAC;KACH;;;;;;;;;IASM,sCAAY,GAAnB,UAAoB,mBAA2B,EAAE,YAAoB,EAAE,QAAgB,EAAE,OAAe,EAAE,gBAAmC;QAA7I,iBAoEC;QAnEC,IAAI,OAAO,YAAY,KAAK,QAAQ,EAAE;YACpC,MAAM,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;SAC7D;QACD,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;YAChC,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;SACzD;QACD,IAAI,gBAAgB,KAAK,SAAS,EAAE;YAClC,gBAAgB,GAAG,KAAK,CAAC;SAC1B;QACD,IAAI,OAAO,gBAAgB,KAAK,SAAS,EAAE;YACzC,gBAAgB,GAAG,gBAAgB,KAAK,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC;SAC/D;QACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,uBAAuB,CAAC;;QAE7D,uBAAuB,CAAC,MAAM,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC;QAC9D,uBAAuB,CAAC,MAAM,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;QAC/D,uBAAuB,CAAC,OAAO,CAAC,gBAAgB,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;QAChF,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QACnD,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACtC,IAAM,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC3E,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAEpE,IAAI,UAAU,KAAK,IAAI,EAAE;YACvB,OAAO,KAAK,CAAC;SACd;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG;YACd,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,gBAAgB,kBAAA;SACjB,CAAC;;QAEF,IAAM,MAAM,GAAG,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,gBAAgB,EAAE,QAAQ,EAAE,mBAAmB,EAAE,YAAY,EAAE,QAAQ,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;QAC7J,OAAO,MAAM,CAAC,IAAI,CAChB,GAAG,CACD,UAAC,QAAkB;YACjB,IAAM,aAAa,GAAG,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;;YAElF,IAAI,mBAAmB,KAAK,IAAI,IAAI,CAAC,aAAa,EAAE;gBAClD,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;gBAChE,IAAI,YAAY,KAAK,IAAI,EAAE;oBACzB,YAAY,CAAC,mBAAmB,CAAC,KAAI,CAAC,WAAW,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC;iBAC3E;aACF;YACD,IAAM,YAAY,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC;YACvE,IAAI,gBAAgB,EAAE;;gBAEpB,IAAM,kBAAkB,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,YAAY,KAAK,YAAY,GAAA,CAAC,CAAC;gBACrF,IAAI,kBAAkB,EAAE;oBACtB,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;iBACjC;;gBAED,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;oBACpG,IAAM,YAAY,GAAG,QAAQ,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,IAAI,IAAI,CAAC;oBACpH,IAAI,YAAY,EAAE;wBAChB,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;qBACjC;iBACF;aACF;YACD,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACrE,CACF,CACF,CAAC;KACH;;;;IAIM,uCAAa,GAApB;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;QAC3F,IAAM,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;QACrC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;QAC9E,OAAO,UAAU,CAAC;KACnB;;;;IAKM,uCAAa,GAApB,UAAqB,UAAkB;QACrC,IAAM,WAAW,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;QAC3F,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC7B,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;KAC/E;;;;IAKM,yCAAe,GAAtB,UAAuB,UAAmB;QACxC,IAAM,gBAAgB,GAAG,CAAC,CAAC,UAAU,IAAI,UAAU,KAAK,EAAE,IAAI,IAAI,GAAG,UAAU,CAAC;QAChF,OAAO,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;KACrC;;;;IAKM,oCAAU,GAAjB,UAAkB,EAAU;QAA5B,iBAqCC;;;;QAhCC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;QAG/C,IAAI,CAAC,EAAE,IAAI,EAAE,KAAK,WAAW,EAAE;YAC7B,EAAE,GAAG,EAAE,CAAC;SACT;;QAGD,IAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;QAEvD,IAAM,aAAa,GAAW,IAAI,CAAC,gBAAgB,EAAE,CAAC;;QAEtD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,EAAE;;YAEf,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC;SAC5D;QACD,IAAM,OAAO,GAAG,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAC3D,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;YACE,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YACtD,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;YAC1E,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC3E,CACF,CACF,CAAC;KACH;;;;IAKM,kCAAQ,GAAf,UAAgB,EAAU;QAA1B,iBA6CC;;QA1CC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;QAG/C,IAAI,CAAC,EAAE,EAAE;;YAEP,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC7F,OAAO,KAAK,EAAE,CAAC;SAChB;;QAGD,IAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;QAEvD,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;;QAE9C,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;;QAGrE,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACvB,IAAM,YAAY,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QAE1C,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC;SAC5D;QACD,IAAM,SAAS,GAAG,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAC3D,IAAM,OAAO,GAAG,YAAY,CAAC,IAAI,CAC/B,SAAS,CAAC;YACR,OAAO,SAAS,CAAC;SAClB,CAAC,EACF,GAAG,CACD;YACE,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YACtD,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;YAC1E,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;SACzE,CACF,CACF,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;IAIM,8BAAI,GAAX;QAAA,iBAmBC;QAlBC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,MAAM,EAAE,CAAC,CAAC;SAChD;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC;QAC7C,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CACxB,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;SACnF,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;SAC1E,CACF,CACF,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;IAIM,gCAAM,GAAb,UAAc,EAAU,EAAE,UAAmB;QAA7C,iBA2DC;;QAxDC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;QAG/C,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC7F,OAAO,KAAK,EAAE,CAAC;SAChB;;QAGD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC;QAChE,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,OAAO,KAAK,EAAE,CAAC;SAChB;QACD,IAAI,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC,KAAK,IAAI,EAAE;YACjF,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC1F,OAAO,KAAK,EAAE,CAAC;SAChB;;QAGD,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QACnF,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,EAAE,CAAC;aAChB;;YAGD,IAAM,UAAU,GAAG,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,KAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC;;YAGxF,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;YAC5D,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;;gBAGF,YAAY,CAAC,YAAY,CAAC,KAAI,CAAC,WAAW,EAAE,KAAI,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;gBAE/E,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBAC7D;qBAAM;oBACL,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACrF;;aAEF,EACC,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aACvE,CACF,CACF,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;IAKM,gCAAM,GAAb;QAAA,iBAmBC;;;QAfC,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,cAAc,GAAG,iBAAiB,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;QAC1E,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC;SACvB;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CACjG,SAAS,CAAC,UAAC,QAAiB;YAC1B,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACtB,OAAO,KAAK,CAAC;aACd;YACD,OAAO,KAAI,CAAC,OAAO,EAAE,CAAC;SACvB,CAAC,CACH,CAAC;QACF,OAAO,cAAc,CAAC;KACvB;;;;;;IAMO,6CAAmB,GAA3B,UAA4B,QAAa;QACvC,IAAM,UAAU,GAAQ,EAAE,SAAS,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QACtD,IAAM,oBAAoB,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;QAClF,IAAI,CAAC,QAAQ,EAAE;;YAEb,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,QAAQ,IAAI,CAAC,CAAC;YAChE,IAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,IAAI,CAAC,CAAC;;YAElE,IAAI,QAAQ,KAAK,CAAC,EAAE;gBAClB,UAAU,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBAC/B,UAAU,CAAC,SAAS,GAAG,SAAS,CAAC;aAClC;SACF;aAAM;;YAEL,IAAI,oBAAoB,EAAE;gBACxB,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;gBACvE,IAAI,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,WAAS,QAAQ,iBAAc,CAAC,CAAC;gBAClF,IAAI,CAAC,aAAa,EAAE;oBAClB,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,WAAS,QAAQ,iBAAc,EAAE,CAAC,CAAC,CAAC;oBACjE,aAAa,GAAG,CAAC,CAAC;iBACnB;gBACD,UAAU,CAAC,SAAS,GAAG,aAAa,CAAC;gBACrC,UAAU,CAAC,QAAQ,GAAG,YAAY,CAAC;aACpC;SACF;QACD,OAAO,UAAU,CAAC;KACnB;;;;IAKO,iCAAO,GAAf;QAAA,iBAkCC;QAjCC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;QAChD,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC;YACR,IAAM,KAAK,GAAG,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YAC9D,IAAM,cAAc,GAAG,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;YACjF,IAAM,SAAS,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;YAElD,IAAI,KAAK,KAAK,IAAI,EAAE;gBAClB,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;;gBAG7D,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;gBACvD,IAAI,cAAc,EAAE;oBAClB,UAAU,CAAC;wBACT,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBAChE,EAAE,CAAC,CAAC,CAAC;iBACP;gBACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;iBAAM;gBACL,OAAO,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;aAC9C;SACF,CAAC,EACF,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACvE,CACF,CACF,CAAC;KACH;;;;IAKM,uCAAa,GAApB,UAAqB,EAAU,EAAE,aAAoB;QACnD,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAI,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC,KAAK,IAAI,EAAE;YACjF,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;KACd;;;;IAKM,oDAA0B,GAAjC,UAAkC,UAAkB,EAAE,aAAoB;QACxE,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAM,UAAU,GAAG,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QAChG,OAAO,UAAU,CAAC;KACnB;;;;IAKM,kDAAwB,GAA/B,UAAgC,UAAkB;QAChD,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;KAChF;;;;;IAKM,sCAAY,GAAnB,UAAoB,EAAU;QAC5B,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,OAAO,CAAC,uBAAuB,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC;QAChJ,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KACvE;;;;IAIM,wCAAc,GAArB;QACE,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;SAC3E;KACF;;;;IAIO,yCAAe,GAAvB;QACE,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,MAAM,IAAI,KAAK,CAAC,uBAAM,aAAa,mCAAO,CAAC,CAAC;SAC7C;QACD,OAAO,YAAY,CAAC;KACrB;;;;;IAQO,6CAAmB,GAA3B,UAA4B,OAAe,EAAE,KAAa;;QAGxD,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;QACjE,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;QACxE,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,qBAAqB,EAAE,KAAK,CAAC,CAAC;KACrE;;;;;IAMO,uCAAa,GAArB;QACE,IAAM,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;QACjF,IAAI,aAAa,KAAK,IAAI,EAAE;YAC1B,IAAM,OAAO,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC;YAC/E,IAAM,KAAK,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;YAC3E,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;SACzC;QACD,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;KACf;IAEO,0CAAgB,GAAxB;QACE,IAAM,SAAS,GAAG,iBAAiB,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAC7E,IAAM,yBAAyB,GAAG,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACnE,IAAI,aAAa,GAAG,MAAM,CAAC;QAC3B,IAAI,yBAAyB,CAAC,cAAc,CAAC,eAAe,CAAC,IAAI,yBAAyB,CAAC,eAAe,CAAC,IAAI,IAAI,EAAE;YACnH,aAAa,GAAG,yBAAyB,CAAC,eAAe,CAAW,CAAC;SACtE;QACD,IAAI,aAAa,IAAI,IAAI,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;;YAErD,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,0BAA0B,CAAC,CAAC,CAAC;SACnE;QACD,OAAO,aAAa,CAAC;KACtB;IAID,sBAAY,wCAAW;;;;aAAvB;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;gBACjE,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC;iBACvC;aACF;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;;gBAnmBF,UAAU;;;;gBAlBM,YAAY;gBAMpB,kBAAkB;gBAHlB,kBAAkB;gBAClB,iBAAiB;gBAGjB,gBAAgB;gBAFhB,eAAe,uBAmCnB,QAAQ;;IA8kBb,sBAAC;CAAA,CAnmB6B,eAAe;;;IChBzC,oCACY,SAAoB,EACpB,sBAA8C,EAC9C,cAA8B;QAF9B,cAAS,GAAT,SAAS,CAAW;QACpB,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,mBAAc,GAAd,cAAc,CAAgB;KACrC;;;;;;IAOE,2CAAM,GAAb,UAAc,WAAmB,EAAE,OAAe;QAC9C,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,EAAE,CAAC;QAC5F,IAAI,QAAQ,OAAO,CAAC,KAAK,QAAQ,EAAE;YAC/B,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SACjC;;QAED,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,GAAG,CAAC,CAAC;QACtE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,sBAAsB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;QACjH,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;KAC5D;;gBAvBJ,UAAU;;;;gBAJF,SAAS;gBACT,sBAAsB;gBACtB,cAAc;;IA0BvB,iCAAC;CAxBD;;ACMA;;;AAGA;;;;IA+BE,yBAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAC5C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;QACxE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;QACjD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QACnG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAC9F,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAmB,gBAAgB,EAAE,IAAI,CAAC,CAAC;KAC9F;;;;IAKM,8BAAI,GAAX,UAAY,EAAU;QAAtB,iBAsBC;QApBC,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAC3C,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,KAAK,CAAC;SACd;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;QACjD,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CACxB,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,aAAa,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;SACnD,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;SACvE,CACF,CACF,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;gBAhEF,UAAU;;;;gBAbmB,YAAY;;IA8E1C,sBAAC;CAjED;;ACAA;;;AAGA;;;;;IAyBE,2BAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAC5C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAChG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QACnG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAmB,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAC7F,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QAEnG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAC9F,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAiB,cAAc,EAAE,IAAI,CAAC,CAAC;QAC3F,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAC9F,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAC9F,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;KAC5E;;;;;;;;;;;;IAaM,sCAAU,GAAjB,UAAkB,EAAU,EAAE,MAAe,EAAE,mBAAmC,EAAE,UAAmB;QAAxD,oCAAA,EAAA,0BAAmC;QAChF,IAAM,GAAG,GAAG,UAAU,GAAG,UAAU,GAAG,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE,MAAM,EAAE,mBAAmB,EAAE,GAAG,CAAC,CAAC;KACnE;IAEM,uCAAW,GAAlB,UAAmB,GAAa;QAC9B,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;KACpC;;;;IAKM,6CAAiB,GAAxB,UAAyB,EAAU,EAAE,UAAmB;QACtD,IAAM,GAAG,GAAG,UAAU,GAAG,UAAU,GAAG,EAAE,CAAC;QACzC,OAAO,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;KAClD;;;;IAKM,oDAAwB,GAA/B,UAAgC,EAAU,EAAE,UAAmB;QAA/D,iBAyBC;QAxBC,IAAM,GAAG,GAAG,UAAU,GAAG,UAAU,GAAG,EAAE,CAAC;;QAEzC,IAAI,IAAI,CAAC,gBAAgB,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,EAAE;YACzC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC1F,OAAO,KAAK,CAAC;SACd;;QAGD,IAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC;QACnE,IAAI,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,KAAK,IAAI,EAAE;YAClE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;YACnE,OAAO,KAAK,CAAC;SACd;;QAGD,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;QAC1D,IAAM,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,0BAA0B,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;QACtF,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAC1B,GAAG,CAAC;YACF,KAAI,CAAC,eAAe,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;SAC3D,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;IAMM,8CAAkB,GAAzB;QACE,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;KACpC;;;;IAKM,gDAAoB,GAA3B,UAA4B,WAAmB,EAAE,cAAsB;QACrE,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,WAAW,IAAI,CAAC,cAAc,EAAE;YACzD,OAAO;SACR;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAiB,cAAc,EAAE,IAAI,CAAC,CAAC;QAC5F,OAAO,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;KAC5D;;;;;;;;;;;IAYO,2CAAe,GAAvB,UAAwB,EAAU,EAAE,MAAe,EAAE,mBAA4B,EAAE,UAAkB;QAArG,iBAgDC;;QA7CC,IAAI,IAAI,CAAC,gBAAgB,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,EAAE;YACzC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC1F,OAAO,KAAK,CAAC;SACd;QAED,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QACxC,IAAM,OAAO,GAAG,mBAAmB,IAAI,MAAM;YAC3C,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,EAAE,CAAC;YAC9C,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;QAE5C,IAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,CAC3B,SAAS,CAAC,UAAC,QAAiB;YAC1B,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACtB,OAAO,KAAK,CAAC;aACd;YACD,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACrE,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;gBACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBAC7D;qBAAM;oBACL,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACrF;;aAEF,EACD,UAAC,KAAU;gBACT,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aACvE,CACF,EACD,SAAS,CAAC;gBACR,IAAM,KAAK,GAAG,mBAAmB,IAAI,MAAM,CAAC;gBAC5C,IAAI,CAAC,KAAK,EAAE;oBACV,OAAO,KAAK,CAAC;iBACd;qBAAM;oBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF,CAAC,CACH,CAAC;SACH,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;IAKO,4CAAgB,GAAxB,UAAyB,GAAa;QACpC,IAAI,CAAC,GAAG,EAAE;YACR,OAAO,KAAK,CAAC;SACd;QACD,IAAM,WAAW,GAAG,GAAG,CAAC,MAAM,CAAC,UAAC,EAAU;YACxC,OAAO,CAAC,CAAC,EAAE,CAAC;SACb,CAAC,CAAC;QACH,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;YAC5B,OAAO,KAAK,CAAC;SACd;QAED,OAAO,IAAI,CAAC;KACb;;;;IAKO,2CAAe,GAAvB;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QACpF,IAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,CAC3B,SAAS,CAAC,UAAC,QAAiB;YAC1B,IAAI,QAAQ,KAAK,KAAK,EAAE;gBACtB,OAAO,KAAK,CAAC;aACd;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CACA,CAAC,CAAC;QACL,OAAO,OAAO,CAAC;KAChB;;gBA/MF,UAAU;;;;gBAdF,YAAY;;IA8NrB,wBAAC;CAhND;;ACRA;;;AAGA;;;;;IAmBE,yBAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAC5C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAChG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QACnG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QACnG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;QAC9F,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;KAC5E;;gBAzBF,UAAU;;;;gBAXF,YAAY;;IAqCrB,sBAAC;CA1BD;;ACIA;;;AAGA;IACiCA,sCAAe;;;;IAkB9C,4BACE,YAA0B,EAClB,SAAoB,EACpB,cAAkC,EAClC,cAAkC,EAClC,YAA8B,EAC9B,iBAAoC,EACxB,eAAgC;QAPtD,YASE,kBAAM,YAAY,CAAC,SAIpB;QAXS,eAAS,GAAT,SAAS,CAAW;QACpB,oBAAc,GAAd,cAAc,CAAoB;QAClC,oBAAc,GAAd,cAAc,CAAoB;QAClC,kBAAY,GAAZ,YAAY,CAAkB;QAC9B,uBAAiB,GAAjB,iBAAiB,CAAmB;QACxB,qBAAe,GAAf,eAAe,CAAiB;QAGpD,IAAI,CAAC,eAAe,EAAE;YACpB,KAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;;KACF;IA1BD,sBAAY,gDAAgB;;;;aAA5B;YACE,OAAO,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;SAClE;;;OAAA;IACD,sBAAY,kDAAkB;aAA9B;YACE,OAAO,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,GAAG,EAAE,CAAC;SAC9D;;;OAAA;IACD,sBAAY,uDAAuB;aAAnC;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;SACvD;;;OAAA;IAoBD,sBAAY,2CAAW;aAAvB;YACE,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;gBACjD,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;gBAC3E,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC;iBACvC;aACF;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;;;;IAKM,0CAAa,GAApB;QAAA,iBAyBC;QAxBC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,eAAe,EAAE,CAAC,CAAC;SACzD;QACD,IAAI,MAAM,GAA2C,IAAI,CAAC,SAAS,EAAE,CAAC;;QAEtE,IAAM,aAAa,GAAW,IAAI,CAAC,gBAAgB,EAAE,CAAC;;QAEtD,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QACrE,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,EAAE;;YAEf,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC;SAC5D;QACD,IAAM,OAAO,GAAG,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC;QACxF,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;SAC9E,CACF,CACF,CAAC;KACH;;;;IAKM,wCAAW,GAAlB;QAAA,iBAkCC;QAjCC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,aAAa,EAAE,CAAC,CAAC;SACvD;QACD,IAAI,MAAM,GAA2C,IAAI,CAAC,SAAS,EAAE,CAAC;;QAEtE,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAE9C,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;QAClH,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE;;YAE7B,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,CAAC;SACd;;QAED,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QAErE,IAAM,UAAU,GAAG,qBAAqB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QACpE,IAAI,CAAC,UAAU,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,CAAC,CAAC;SAC5D;QACD,IAAM,YAAY,GAAG,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC;QAC3F,IAAM,OAAO,GAAG,YAAY,CAAC,IAAI,CAC/B,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;SACtD,EACD,UAAA,KAAK;YACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;SAC5E,CACF,CACF,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;;IAKM,mCAAM,GAAb,UAAc,EAAU,EAAE,UAAmB;QAA7C,iBAqDC;;QAnDC,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,CAAC;SACd;;QAED,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;;QAE9C,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACvE,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;QAC5D,IAAM,YAAY,GAAG,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;QAChE,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,OAAO,KAAK,CAAC;SACd;QACD,IAAI,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,kBAAkB,EAAE,EAAE,CAAC,KAAK,IAAI,EAAE;YACnF,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC,CAAC;YACtE,OAAO,KAAK,CAAC;SACd;;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;QACnF,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC,UAAA,MAAM;YACd,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,KAAK,CAAC;aACd;;YAED,IAAM,UAAU,GAAG,YAAY,CAAC,aAAa,CAAC,aAAa,EAAE,KAAI,CAAC,kBAAkB,EAAE,EAAE,CAAC,CAAC;;YAG1F,IAAM,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;YAClD,IAAM,IAAI,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAM,OAAO,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YACpE,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC;;gBAEF,YAAY,CAAC,uBAAuB,CAAC,WAAW,EAAE,KAAI,CAAC,kBAAkB,EAAE,UAAU,CAAC,CAAC;gBACvF,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE;oBACnC,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACjE;qBAAM;oBACL,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;iBACzF;;aAEF,EACC,UAAA,KAAK;gBACH,KAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;gBACrD,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aACvE,CACF,CACF,CAAC;SACH,CAAC,CACH,CAAC;KACH;IAEO,6CAAgB,GAAxB;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QACpG,IAAI,aAAa,GAAG,QAAQ,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,IAAI,CAAC;QACnE,IAAI,aAAa,IAAI,IAAI,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;;YAErD,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,0BAA0B,CAAC,CAAC,CAAC;SACnE;QACD,OAAO,aAAa,CAAC;KACtB;;;;;;;IAQO,sCAAS,GAAjB;QACE,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAChE,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,IAAI,aAAa,GAAG,EAAE,CAAC;QACvB,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACtD,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACd,IAAI,OAAO,GAAQ,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QAC9C,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACxB,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ;gBACpB,OAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;gBAC5B,IAAI,OAAO,IAAI,OAAO,CAAC,SAAS,EAAE;oBAChC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;iBAC7B;;gBAED,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC1G,CAAC,CAAA;SACH;QACD,OAAO,EAAE,SAAS,EAAE,aAAa,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;KAC/C;;;;;IAKO,oCAAO,GAAf;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QAC/C,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACtD,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC;QAErB,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QACvD,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;;YAEvB,IAAI,OAAO,GAAQ,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC9C,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBACxD,IAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAChC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;gBAC3B,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBAClC,MAAM,KAAK,CAAC,yFAAiB,OAAO,2GAAmB,CAAC,CAAC;iBAC1D;gBACD,IAAI,IAAI,MAAI,OAAO,SAAI,OAAO,CAAC,SAAW,CAAC;aAC5C;SACF;QACD,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;KACb;;gBAvOF,UAAU;;;;gBAfW,YAAY;gBAAE,SAAS;gBAEpC,kBAAkB;gBAClB,kBAAkB;gBAClB,gBAAgB;gBAChB,iBAAiB;gBACjB,eAAe,uBAmCnB,QAAQ;;IA8Mb,yBAAC;CAAA,CAvOgC,eAAe;;ACRhD;;;;;AAMA;;;;IAME,yBACU,UAA2B,EAC3B,cAAkC,EAClC,UAA8B,EAC9B,aAAgC,EAChC,gBAAkC,EACtB,eAAgC;QAL5C,eAAU,GAAV,UAAU,CAAiB;QAC3B,mBAAc,GAAd,cAAc,CAAoB;QAClC,eAAU,GAAV,UAAU,CAAoB;QAC9B,kBAAa,GAAb,aAAa,CAAmB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAEpD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;IAKM,sCAAY,GAAnB,UACE,SAAiB,EAAE,UAAkB,EAAE,WAAiB,EAAE,WAAiB,EAAE,IAA0B;QAEvG,OAAO,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KAC5F;;;;;;;;IASM,uCAAa,GAApB,UACE,SAAiB,EAAE,UAAkB,EAAE,WAAiB,EAAE,WAAiB,EAAE,IAAU;;;;QAMvF,OAAO,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;KAC7F;;;;IAKM,0CAAgB,GAAvB,UAAwB,WAAmB;QACzC,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;YACnC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;SACvC;QAED,IAAI,iBAAiB,GAAG,EAAE,CAAC;QAC3B,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,UAAC,GAAW;YAC3C,iBAAiB,IAAO,GAAG,SAAI,WAAW,CAAC,GAAG,CAAG,CAAC;SACnD,CAAC,CAAC;QAEH,OAAO,iBAAiB,CAAC;KAC1B;;;;IAKM,wCAAc,GAArB;QACE,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,OAAO,aAAa,CAAC,WAAW,CAAC;KAClC;;;;IAMO,2CAAiB,GAAzB,UACE,SAAiB,EAAE,UAAkB,EAAE,WAAiB,EAAE,WAAiB,EAAE,IAAU,EAAE,cAAwB;QADnH,iBA2DC;QAxDC,IAAM,OAAO,GAAG,EAAE,CAAC;QACnB,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;;QAGpC,IAAI,aAAa,GAAM,OAAO,iBAAY,SAAW,CAAC;QACtD,IAAI,WAAW,IAAI,WAAW,KAAK,EAAE,EAAE;YACrC,IAAM,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;YAC7D,aAAa,IAAI,iBAAiB,CAAC;SACpC;;QAID,IAAI,IAAI,IAAI,IAAI,KAAK,EAAE,EAAE;YACvB,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBAC1E,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;aACzB;YACD,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;SACxB;;QAGD,IAAI,WAAW,IAAI,WAAW,KAAK,EAAE,EAAE;YACrC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;;YAGtC,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,EAAE;gBAChC,WAAW,CAAC,cAAc,CAAC,GAAG,kBAAkB,CAAC;aAClD;YACD,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,WAAW,CAAC,WAAW,CAAC,CAAC;SACnD;aAAM;YACL,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,WAAW,CAAC,EAAE,cAAc,EAAE,kBAAkB,EAAE,CAAC,CAAC;SAC9E;;QAGD,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;;;;;;;QAQ3B,IAAM,UAAU,GAAG,cAAc,GAAG,QAAQ,GAAG,SAAS,CAAC;QACzD,IAAM,OAAO,GAAG,WAAW,CAAC,UAAU,CAAC,CAAC,aAAa,EAAE,UAAU,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;QAClF,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CACD;YACE,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,EACD,UAAC,KAAU;YACT,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;YAC3B,IAAM,QAAQ,GAAG,aAAa,GAAG,KAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC;YACzE,KAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;SAClD,CACF,CACF,CAAC;KACH;;gBApIF,UAAU;;;;gBAdF,UAAU;gBAGV,kBAAkB;gBAClB,kBAAkB;gBAClB,iBAAiB;gBACjB,gBAAgB;gBAChB,eAAe,uBAmBnB,QAAQ;;IAyHb,sBAAC;CArID;;ACFA;;;;;AAKA;;;;IAWE,wBACU,kBAAsC,EACtC,eAAgC,EAChC,UAA8B,EAC9B,aAAgC,EACpB,eAAgC,EAC5C,gBAAkC,EAClC,YAA0B,EACd,SAA2B,EAC3B,gBAAoC,EACpC,oBAA0C;QATtD,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,eAAU,GAAV,UAAU,CAAoB;QAC9B,kBAAa,GAAb,aAAa,CAAmB;QACpB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,iBAAY,GAAZ,YAAY,CAAc;QACd,cAAS,GAAT,SAAS,CAAkB;QAC3B,qBAAgB,GAAhB,gBAAgB,CAAoB;QACpC,yBAAoB,GAApB,oBAAoB,CAAsB;QAE9D,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;YACxE,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;gBAC9B,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;aACxF;SACF;KACF;;;;IAKD,qDAA4B,GAA5B,UAA6B,SAAiB;QAC5C,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;KACtC;;;;;;;IAQD,sCAAa,GAAb,UAAc,SAAiB,EAAE,iBAAuC;QAAxE,iBAkFC;QAjFC,IAAI,CAAC,SAAS,EAAE;;YAEd,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACzF,OAAO,KAAK,EAAE,CAAC;SAChB;QAED,IAAM,SAAS,GAAG,yBAAyB,CAAC;QAE5C,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;QAE1D,IAAM,IAAI,GAAwB;YAChC,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;YAC3C,SAAS,EAAE,SAAS;YACpB,iBAAiB,EAAE,iBAAiB,GAAG;gBACrC,SAAS,EAAE,iBAAiB,CAAC,mBAAmB;aACjD,GAAG,EAAE;SACP,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;QAG/B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;;;;;QAMtF,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC,UAAC,MAAM;YACT,IAAI,MAAM,IAAI,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC,gBAAgB,EAAE;gBACvE,IAAI,UAAU,GAAqB,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC;gBACvE,OAAO,UAAU,CAAC;aACnB;SACF,CAAC,EACF,SAAS,CAAC,UAAC,QAA0B;YACnC,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;gBACnC,IAAI,KAAI,CAAC,UAAU,EAAE;oBACnB,IAAM,SAAS,GAAG,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;oBACxD,OAAO,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;wBACxB,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;wBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;qBAC3F,CAAC,EAAE,GAAG,CAAC;wBACN,OAAO,QAAQ,CAAC;qBACjB,CAAC,CAAC,CAAC;iBACL;qBAAM;oBACL,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;oBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;oBAC1F,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;iBACrB;aACF;iBAAM;gBACL,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;aACrB;SACF,CAAC,EACF,SAAS,CAAC,UAAC,QAA0B;YACnC,IAAI,QAAQ,CAAC,eAAe,EAAE;gBAC5B,OAAO,IAAI,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO;oBAC9B,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,EAAE,UAAC,mBAAwC;;wBAEvE,IAAI,CAAC,QAAQ,CAAC,UAAU,IAAI,mBAAmB,CAAC,mBAAmB,EAAE;4BACnE,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,mBAAmB,CAAC,CAAC,SAAS,CAAC;gCAC3D,OAAO,EAAE,CAAC;6BACX,CAAC,CAAC;yBACJ;6BAAM;4BACL,OAAO,EAAE,CAAC;yBACX;qBACF,CAAC,CAAC;iBACJ,CAAC,CAAC,CAAC;aACL;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC,EACF,UAAU,CACR,UAAA,KAAK;YACH,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;YAE/B,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;SAClB,CACF,CACF,CAAC;KACH;;;;;;;;IASM,mDAA0B,GAAjC,UAAkC,SAAiB,EAAE,SAAiB,EAAE,OAAa,EAAE,iBAAuC;QAA9H,iBAmGC;QAlGC,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACxF,OAAO,KAAK,CAAC;SACd;QACD,IAAI;YACF,IAAI,OAAO,IAAI,QAAQ,OAAO,CAAC,KAAK,QAAQ,EAAE;gBAC5C,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;aAC/B;SACF;QAAC,OAAO,CAAC,EAAE;YACV,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;SACnE;QAED,IAAM,SAAS,GAAG,4BAA4B,CAAC;QAE/C,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;QAE1D,IAAM,IAAI,GAAwB;YAChC,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;YAC3C,cAAc,EAAE;gBACd,mBAAmB,EAAE;oBACnB,SAAS,EAAE,SAAS;oBACpB,MAAM,EAAE,SAAS;oBACjB,IAAI,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,EAAE;oBACnC,SAAS,EAAE,OAAO,IAAI,OAAO,CAAC,SAAS,IAAI,EAAE;iBAC9C;aACF;SACF,CAAC;QACF,IAAI,iBAAiB,EAAE;YACrB,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,mBAAmB,GAAG,iBAAiB,CAAC,mBAAmB,CAAC;YACpG,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,oBAAoB,GAAG,iBAAiB,CAAC,sBAAsB,CAAC,CAAC;SAC1G;QACD,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;QAG/B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;;;;;QAMtF,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC,UAAC,MAAM;YACT,IAAI,MAAM,IAAI,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC,gBAAgB,EAAE;gBACvE,IAAM,UAAU,GAAqB,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC;gBACzE,OAAO,UAAU,CAAC;aACnB;SACF,CAAC,EACF,SAAS,CAAC,UAAC,QAA0B;YACnC,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;gBACnC,IAAI,KAAI,CAAC,UAAU,EAAE;oBACnB,IAAM,SAAS,GAAG,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;oBACxD,OAAO,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;wBACxB,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;wBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;qBAC3F,CAAC,EAAE,GAAG,CAAC;wBACN,OAAO,QAAQ,CAAC;qBACjB,CAAC,CAAC,CAAC;iBACL;qBAAM;oBACL,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;oBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;oBAC1F,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;iBACrB;aACF;iBAAM;gBACL,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;aACrB;SACF,CAAC,EACF,SAAS,CAAC,UAAC,QAA0B;YACnC,IAAI,QAAQ,CAAC,eAAe,EAAE;gBAC5B,OAAO,IAAI,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO;oBAC9B,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,EAAE,UAAC,mBAAwC;;wBAEvE,IAAI,CAAC,QAAQ,CAAC,UAAU,IAAI,mBAAmB,CAAC,mBAAmB,EAAE;4BACnE,KAAI,CAAC,0BAA0B,CAAC,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,mBAAmB,CAAC,CAAC,SAAS,CAAC;gCAC5F,OAAO,EAAE,CAAC;6BACX,CAAC,CAAC;yBACJ;6BAAM;4BACL,OAAO,EAAE,CAAC;yBACX;qBACF,CAAC,CAAC;iBACJ,CAAC,CAAC,CAAC;aACL;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC,EACF,UAAU,CACR,UAAA,KAAK;YACH,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;YAE/B,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;SAClB,CACF,CACF,CAAC;KACH;;;;;;;;IAQM,6DAAoC,GAA3C,UAA4C,SAAiB,EAAE,SAAiB,EAAE,OAAiB,EAAE,SAAe;QAAlC,wBAAA,EAAA,YAAiB;QACjG,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACxF,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC3C,OAAO,GAAG,EAAE,CAAC;SACd;QACD,IAAM,OAAO,cACX,MAAM,EAAE,SAAS,EACjB,SAAS,WAAA,IACN,OAAO,CACX,CAAC;;QAEF,IAAI,SAAS,EAAE;YACb,IAAI,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACxD,IAAI;oBACF,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;iBACnC;gBAAC,WAAM;oBACN,SAAS,GAAG,EAAE,CAAC;iBAChB;aACF;YACD,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;SAC/B;QACD,OAAO,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;KACrF;;;;;;;;;IASM,wDAA+B,GAAtC,UAAuC,SAAiB,EAAE,KAAa,EAAE,UAAkB,EAAE,OAAiB,EAAE,SAAe;QAAlC,wBAAA,EAAA,YAAiB;;QAE5G,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACxF,OAAO,KAAK,CAAC;SACd;;QAED,IAAI,CAAC,KAAK,EAAE;YACV,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,CAAC;SACd;;QAED,IAAI,CAAC,UAAU,EAAE;YACf,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,0BAA0B,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACjG,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC3C,OAAO,GAAG,EAAE,CAAC;SACd;QACD,IAAM,OAAO,cACX,MAAM,EAAK,KAAK,SAAI,UAAY,EAChC,SAAS,WAAA,IACN,OAAO,CACX,CAAC;;QAEF,IAAI,SAAS,EAAE;YACb,IAAI,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACxD,IAAI;oBACF,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;iBACnC;gBAAC,WAAM;oBACN,SAAS,GAAG,EAAE,CAAC;iBAChB;aACF;YACD,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;SAC/B;QACD,OAAO,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;KACrF;;;;;IAKM,sCAAa,GAApB,UAAqB,SAAiB;QAAtC,iBAwCC;QAvCC,IAAI,CAAC,SAAS,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,EAAE,CAAC;SAChB;QAED,IAAM,SAAS,GAAG,wBAAwB,CAAC;QAE3C,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;QAE1D,IAAM,IAAI,GAAG;YACX,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;YAC3C,SAAS,EAAE,SAAS;SACrB,CAAC;QAEF,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;QAE/B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACvF,OAAO,OAAO,CAAC,IAAI,CACjB,SAAS,CAAC;YACR,IAAI,KAAI,CAAC,UAAU,EAAE;gBACnB,IAAM,SAAS,GAAG,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;gBACxD,OAAO,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;oBACxB,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;oBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,CAAC;iBAClG,CAAC,CAAC,CAAC;aACL;iBAAM;gBACL,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;gBAE/B,yBAAyB,CAAC,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,CAAC;gBACjG,OAAO,EAAE,EAAE,CAAC;aACb;SACF,CACA,EACD,UAAU,CAAC,UAAA,KAAK;YACd,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;;YAE/B,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;SAClB,CAAC,CAAC,CAAC;KACP;;;;;IAKM,qCAAY,GAAnB,UAAoB,UAAkB;QACpC,IAAI,CAAC,UAAU,EAAE;YACf,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACxF,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;KACxG;;;;;IAKD,oCAAW,GAAX,UAAY,UAAkB;QAC5B,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,IAAI,CAAC,UAAU,EAAE;gBACf,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBAC1F,OAAO;aACR;YACD,OAAO,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;SACxD;KACF;;;;;;IAQO,2CAAkB,GAA1B,UAA2B,OAAY,EAAE,OAAgB;;QACvD,IAAI,QAAQ,OAAO,CAAC,KAAK,QAAQ,IAAI,CAAC,CAAC,OAAO,EAAE;YAC9C,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gBAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACvC,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;iBAC9C;aACF;iBAAM;;oBACL,KAAkB,IAAA,KAAAE,SAAA,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA,gBAAA,4BAAE;wBAAnC,IAAM,GAAG,WAAA;wBACZ,IAAI,MAAM,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,IAAI,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;wBAClH,OAAO,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;wBAC/B,IAAI,OAAO,OAAO,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;4BACpC,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,OAAO,CAAC,CAAC;yBAChD;wBACD,QAAQ,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;qBACvB;;;;;;;;;aACF;SACF;QACD,OAAO,OAAO,CAAC;KAChB;;gBA3ZF,UAAU;;;;gBAdF,kBAAkB;gBAJlB,eAAe;gBACf,kBAAkB;gBAClB,iBAAiB;gBACjB,eAAe,uBA+BnB,QAAQ;gBA7BJ,gBAAgB;gBAIR,YAAY;gBAHpB,gBAAgB,uBA+BpB,QAAQ;gBA3BJ,kBAAkB,uBA4BtB,QAAQ;gBA/BJ,oBAAoB,uBAgCxB,QAAQ;;IAuYb,qBAAC;CA5ZD;;ACbA;;;;;;AAMA;;;;IAUE,sBACU,UAA8B,EAC9B,eAAgC,EAChC,YAA+B,EACnB,iBAAoC;QAHhD,eAAU,GAAV,UAAU,CAAoB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAChC,iBAAY,GAAZ,YAAY,CAAmB;QACnB,sBAAiB,GAAjB,iBAAiB,CAAmB;KAEzD;;;;;;IAOM,kCAAW,GAAlB,UAAmB,QAAgB,EAAE,SAAiB;QACpD,IAAI,CAAC,SAAS,EAAE;;YAEd,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC;YAC7D,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;KAC/C;;;;;;IAMM,iCAAU,GAAjB,UAAkB,QAAgB,EAAE,GAAW;QAC7C,IAAI,CAAC,GAAG,EAAE;;YAER,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC;YAC7D,OAAO,KAAK,CAAC;SACd;QACD,IAAM,OAAO,GAAkB,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;QACnE,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;KAC3C;;;;;;;;;IASM,8CAAuB,GAA9B,UAA+B,QAAgB,EAAE,GAAW,EAAE,IAAY,EAAE,IAAY,EAAE,cAAuB;QAC/G,IAAI,CAAC,GAAG,EAAE;;YAER,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC;YAC7D,OAAO,KAAK,CAAC;SACd;QACD,IAAM,OAAO,GAAkB,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;QACnE,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC;KACvE;;;;;;;;;IASM,iCAAU,GAAjB,UAAkB,QAAgB,EAAE,OAAiB,EAAE,IAAU,EAAE,IAAU,EAAE,cAAuB;QACpG,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;;YAEpC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,CAAC;YAC7D,OAAO,KAAK,CAAC;SACd;QACD,IAAM,aAAa,GAAkB,IAAI,CAAC,kBAAkB,CAAC;YAC3D,OAAO,EAAE,OAAO;YAChB,QAAQ,EAAE,QAAQ;SACnB,CAAC,CAAC;QAEH,IAAM,aAAa,GAAkB,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAE/D,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC/B,aAAa,CAAC,iBAAiB,GAAG,IAAI,CAAC;SACxC;QACD,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC/B,aAAa,CAAC,kBAAkB,GAAG,IAAI,CAAC;SACzC;QACD,IAAI,OAAO,cAAc,KAAK,WAAW,EAAE;YACzC,aAAa,CAAC,cAAc,GAAG,cAAc,CAAC;SAC/C;QACD,OAAO,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,aAAa,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;KAC5E;;;;;;;;IASM,iCAAU,GAAjB,UAAkB,QAAgB,EAAE,eAAuB,EAAE,aAAqB,EAAE,gBAAgC;QAAhC,iCAAA,EAAA,uBAAgC;QAClH,IAAM,WAAW,GAAG,EAAE,iBAAiB,EAAE,KAAK,EAAE,kBAAkB,EAAE,EAAE,EAAE,gBAAgB,EAAE,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QACnH,IAAI,eAAe,EAAE;;YAEnB,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC5C,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;aAC1C;YACD,WAAW,CAAC,gBAAgB,GAAG,OAAO,CAAC;SACxC;QAED,IAAI,aAAa,EAAE;YACjB,WAAW,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;SACxD;;QAED,IAAM,mBAAmB,GAAwB,IAAI,CAAC,wBAAwB,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,WAAW,aAAA,EAAE,gBAAgB,kBAAA,EAAE,CAAC,CAAC;QACtI,IAAM,aAAa,GAAkB,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC/D,OAAO,IAAI,CAAC,YAAY,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;KAC5F;;;;;;;;;;;IAWM,8CAAuB,GAA9B,UAA+B,QAAgB,EAAE,eAAuB,EAAE,aAAqB,EAAE,IAAY,EAAE,IAAY,EAAE,cAAuB,EAAE,gBAAgC;QAAhC,iCAAA,EAAA,uBAAgC;QACpL,IAAM,WAAW,GAAG,EAAE,iBAAiB,EAAE,KAAK,EAAE,kBAAkB,EAAE,EAAE,EAAE,gBAAgB,EAAE,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QACnH,IAAI,eAAe,EAAE;;YAEnB,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;YAC5C,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;aAC1C;YACD,WAAW,CAAC,gBAAgB,GAAG,OAAO,CAAC;SACxC;QAED,IAAI,aAAa,EAAE;YACjB,WAAW,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;SACxD;QACD,IAAM,GAAG,GAAwB,IAAI,CAAC,wBAAwB,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,WAAW,aAAA,EAAE,gBAAgB,kBAAA,EAAE,CAAC,CAAC;QACtH,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC/B,GAAG,CAAC,iBAAiB,GAAG,IAAI,CAAC;SAC9B;QACD,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC/B,GAAG,CAAC,kBAAkB,GAAG,IAAI,CAAC;SAC/B;QACD,IAAI,OAAO,cAAc,KAAK,WAAW,EAAE;YACzC,GAAG,CAAC,cAAc,GAAG,cAAc,CAAC;SACrC;QACD,IAAM,aAAa,GAAkB,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC/D,OAAO,IAAI,CAAC,YAAY,CAAC,sBAAsB,CAAC,GAAG,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;KAC5E;;;;;IAKO,yCAAkB,GAA1B,UAA2B,OAAqE;QAC9F,IAAM,EAAE,GAAkB;YACxB,OAAO,EAAE,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI,SAAS;YAChD,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,SAAS;YAClD,iBAAiB,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,SAAS;YACvD,kBAAkB,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,SAAS;YACxD,aAAa,EAAE,OAAO,IAAI,OAAO,CAAC,aAAa,IAAI,SAAS;YAC5D,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,SAAS;YAClD,cAAc,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc,IAAI,SAAS;YAC9D,WAAW,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,SAAS;YACxD,WAAW,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,SAAS;YACxD,YAAY,EAAE,OAAO,IAAI,OAAO,CAAC,YAAY,IAAI,SAAS;YAC1D,SAAS,EAAE,OAAO,IAAI,OAAO,CAAC,SAAS,IAAI,SAAS;YACpD,cAAc,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc,IAAI,SAAS;YAC9D,UAAU,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,IAAI,SAAS;SACvD,CAAC;QACF,OAAO,EAAE,CAAC;KACX;;;;;IAKO,yCAAkB,GAA1B,UAA2B,OAAiC;QAC1D,IAAM,EAAE,GAAkB;YACxB,UAAU,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,IAAI,UAAU,CAAC,KAAK;YAC7D,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,QAAQ,CAAC,KAAK;YACvD,IAAI,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,SAAS;YAC1C,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,SAAS;YAClD,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,SAAS;YAClD,WAAW,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,SAAS;YACxD,YAAY,EAAE,OAAO,IAAI,OAAO,CAAC,YAAY,IAAI,SAAS;YAC1D,SAAS,EAAE,OAAO,IAAI,OAAO,CAAC,SAAS,IAAI,SAAS,CAAC,IAAI;SAC1D,CAAC;QACF,OAAO,EAAE,CAAC;KACX;;;;;IAKO,+CAAwB,GAAhC,UAAiC,OAAkD;QACjF,IAAM,WAAW,GAAG,EAAE,iBAAiB,EAAE,KAAK,EAAE,kBAAkB,EAAE,EAAE,EAAE,gBAAgB,EAAE,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QACnH,IAAM,GAAG,GAAkD;YACzD,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,YAAY,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,WAAW;YAC3D,iBAAiB,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,SAAS;YACvD,kBAAkB,EAAE,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,SAAS;YACxD,QAAQ,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,SAAS;YAClD,WAAW,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,SAAS;YACxD,cAAc,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc,IAAI,SAAS;YAC9D,WAAW,EAAE,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,SAAS;YACxD,YAAY,EAAE,OAAO,IAAI,OAAO,CAAC,YAAY,IAAI,SAAS;YAC1D,UAAU,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,IAAI,SAAS;YACtD,cAAc,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc,IAAI,SAAS;YAC9D,SAAS,EAAE,OAAO,IAAI,OAAO,CAAC,SAAS,IAAI,SAAS;YACpD,gBAAgB,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,GAAG,OAAO,CAAC,gBAAgB,GAAG,IAAI;SAC1G,CAAC;QACF,OAAO,GAAG,CAAC;KACZ;;;;;IAKO,kCAAW,GAAnB,UAAoB,OAAe;QACjC,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;SAC1D;aAAM,IAAI,IAAI,CAAC,UAAU,EAAE;YAC1B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAChC;KACF;IACD,sBAAY,uCAAa;aAAzB;YACE,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,OAAO,IAAI,CAAC,iBAAiB,CAAC;aAC/B;iBAAM,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACxB,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;aACtE;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;IACD,sBAAY,wCAAc;aAA1B;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC;SAChC;;;OAAA;IACD,sBAAY,sCAAY;aAAxB;YACE,OAAO,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,YAAY,IAAI,IAAI,CAAC;SACxE;;;OAAA;IACD,sBAAY,kCAAQ;aAApB;YACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,IAAI,IAAI,CAAC;SAChE;;;OAAA;;gBAvPF,UAAU;;;;gBAZF,kBAAkB;gBAClB,eAAe;gBAGf,iBAAiB;gBACjB,iBAAiB,uBAqBrB,QAAQ;;IA0Ob,mBAAC;CAxPD;;AC4BA;;;AAGA,IAAM,sBAAsB,GAAG,eAAe,CAAC;;AC1C/C;;;AAGA;IAAA;KAmDC;;;;IA9Ce,uCAAwB,GAAtC,UAAuC,SAA2B;QAAlE,iBAQC;QAPC,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,EAAE,CAAC;SACX;QACD,IAAM,eAAe,GAAqB,SAAS,CAAC,GAAG,CAAC,UAAC,QAAwB;YAC/E,OAAO,KAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,CAAC;SAC/C,CAAC,CAAC;QACH,OAAO,eAAe,CAAC;KACxB;;;;IAKa,sCAAuB,GAArC,UAAsC,QAAwB;QAC5D,IAAM,cAAc,GAAmB;YACrC,YAAY,EAAE,QAAQ,CAAC,UAAU;YACjC,QAAQ,EAAE,QAAQ,CAAC,QAAQ;SAC5B,CAAC;QACF,OAAO,cAAc,CAAC;KACvB;;;;IAKa,qCAAsB,GAApC,UAAqC,eAAiC;QACpE,IAAI,CAAC,eAAe,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;YACpD,OAAO;SACR;QACD,IAAM,mBAAmB,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;QAC/C,OAAO,mBAAmB,CAAC;KAC5B;;;;IAKa,gCAAiB,GAA/B,UAAgC,eAAiC;QAC/D,IAAI,CAAC,eAAe,EAAE;YACpB,eAAe,GAAG,EAAE,CAAC;SACtB;QACD,IAAM,aAAa,GAAG,eAAe,CAAC,GAAG,CAAC,UAAC,cAA8B;YACvE,OAAO,cAAc,CAAC,YAAY,CAAC;SACpC,CAAC,CAAC;QAEH,OAAO,aAAa,CAAC;KACtB;IAEH,qBAAC;CAAA,IAAA;;AChDD;;;AAGA;IAiBE,+BAAoB,YAA0B,EAAU,cAAkC;QAAtE,iBAAY,GAAZ,YAAY,CAAc;QAAU,mBAAc,GAAd,cAAc,CAAoB;KACzF;IAZD,sBAAY,6CAAU;;;;aAAtB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;SAC9D;;;OAAA;IAKD,sBAAY,8CAAW;;;;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;;;;IAQM,yCAAS,GAAhB,UAAiB,uBAA+B,EAAE,cAA8B;QAAhF,iBAqBC;QApBC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,SAAS,GAAM,OAAO,8BAA2B,CAAC;QACxD,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB,EAAE,cAAc,CAAC,CAAC;QAC9F,IAAM,IAAI,GAAG;YACX,gBAAgB,EAAE,gBAAgB;YAClC,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,SAAS,CAAC,UAAC,YAA0B;YACnC,OAAO,KAAI,CAAC,2BAA2B,EAAE,CAAC;SAC3C,CAAC,EACF,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;;;IAMM,yDAAyB,GAAhC,UAAiC,uBAA+B,EAAE,cAA8B;QAAhG,iBAuBC;QAtBC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,SAAS,GAAM,OAAO,4CAAyC,CAAC;QACtE,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB,EAAE,cAAc,CAAC,CAAC;QAC9F,IAAM,YAAY,GAAG,uBAAuB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,GAAG,EAAE,CAAC;QAC7E,IAAM,IAAI,GAAG;YACX,gBAAgB,EAAE,gBAAgB;YAClC,YAAY,cAAA;YACZ,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,SAAS,CAAC,UAAC,YAA0B;YACnC,OAAO,KAAI,CAAC,2BAA2B,EAAE,CAAC;SAC3C,CAAC,EACF,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;IAIM,0CAAU,GAAjB,UAAkB,uBAA+B,EAAE,eAAiC;QAApF,iBAsBC;QArBC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,SAAS,GAAM,OAAO,mCAAgC,CAAC;QAC7D,IAAM,gBAAgB,GAAG,IAAI,CAAC,2BAA2B,CAAC,uBAAuB,EAAE,eAAe,CAAC,CAAC;QACpG,IAAM,YAAY,GAAG,gBAAgB,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,CAAC;QAE7D,IAAM,IAAI,GAAG;YACX,eAAe,EAAE,gBAAgB;YACjC,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,SAAS,CAAC,UAAC,YAA0B;YACnC,OAAO,KAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;SACnF,CAAC,EACF,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;IAIM,qDAAqB,GAA5B,UAA6B,uBAA+B,EAAE,eAAiC,EAAE,OAAgC;QAAjI,iBAsBC;QArBC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,SAAS,GAAM,OAAO,mCAAgC,CAAC;QAC7D,IAAM,gBAAgB,GAAG,IAAI,CAAC,2BAA2B,CAAC,uBAAuB,EAAE,eAAe,CAAC,CAAC;;QAGpG,IAAM,IAAI,GAAG;YACX,eAAe,EAAE,gBAAgB;YACjC,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,SAAS,CAAC,UAAC,YAA0B;YACnC,OAAO,KAAI,CAAC,qBAAqB,CAAC,YAAY,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;SACtE,CAAC,EACF,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;IAIM,0DAA0B,GAAjC,UAAkC,uBAA+B,EAAE,eAAiC;QAApG,iBAwBC;QAvBC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACpC,IAAM,SAAS,GAAM,OAAO,iDAA8C,CAAC;QAC3E,IAAM,gBAAgB,GAAG,IAAI,CAAC,2BAA2B,CAAC,uBAAuB,EAAE,eAAe,CAAC,CAAC;QACpG,IAAM,YAAY,GAAG,gBAAgB,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,CAAC;QAC7D,IAAM,YAAY,GAAG,uBAAuB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,GAAG,EAAE,CAAC;QAE7E,IAAM,IAAI,GAAG;YACX,eAAe,EAAE,gBAAgB;YACjC,YAAY,cAAA;YACZ,WAAW,EAAE,WAAW,CAAC,gBAAgB,EAAE;SAC5C,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,OAAO,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAC7D,SAAS,CAAC,UAAC,YAA0B;YACnC,OAAO,KAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;SACnF,CAAC,EACF,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;IAKO,sDAAsB,GAA9B,UAA+B,uBAA+B,EAAE,cAA8B;QAE5F,IAAM,YAAY,GAAG,cAAc,CAAC,YAAY,CAAC;QACjD,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QAC7B,IAAM,SAAS,GAAG,eAAe,CAAC,oBAAoB,CAAC,sBAAsB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACjG,IAAM,UAAU,GAAG,eAAe,CAAC,yBAAyB,CAAC,sBAAsB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAEvG,IAAM,gBAAgB,GAAyB;YAC7C,SAAS,EAAE,SAAS;YACpB,UAAU,EAAE,UAAU;YACtB,aAAa,EAAE,CAAC,YAAY,CAAC;YAC7B,YAAY,EAAE,YAAY;SAC3B,CAAC;QAEF,OAAO,gBAAgB,CAAC;KACzB;;;;IAKO,2DAA2B,GAAnC,UAAoC,uBAA+B,EAAE,cAAgC;QACnG,IAAM,aAAa,GAAG,cAAc,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC;QAEvE,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QAC7B,IAAM,SAAS,GAAG,eAAe,CAAC,oBAAoB,CAAC,sBAAsB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACjG,IAAM,UAAU,GAAG,eAAe,CAAC,sBAAsB,CAAC,sBAAsB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAEpG,IAAM,gBAAgB,GAAG;YACvB,SAAS,EAAE,SAAS;YACpB,UAAU,EAAE,UAAU;YACtB,aAAa,EAAE,aAAa;YAC5B,YAAY,EAAE,IAAI;SACnB,CAAC;QAEF,OAAO,gBAAgB,CAAC;KACzB;;;;;;IAOM,2DAA2B,GAAlC;QACE,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACnD,OAAO,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;KACrD;;;;IAKM,6DAA6B,GAApC,UAAqC,QAAe,EAAE,YAAqB;QACzE,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACzD,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACvD,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;SACrB;aAAM;YACL,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;YACnD,OAAO,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,IAAI,CACtD,GAAG,CAAC,cAAM,OAAA,QAAQ,GAAA,CAAC,CACpB,CAAC;SACH;KACF;IACM,qDAAqB,GAA5B,UAA6B,QAAe,EAAE,SAAkC;QAC9E,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACzD,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;;QAEvD,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;QACzC,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAC;KACrB;IACO,8CAAc,GAAtB,UAAuB,QAAkB,EAAE,SAAkC;QAA7E,iBAIC;QAHC,QAAQ,CAAC,OAAO,CAAC,UAAC,MAAc;YAC9B,KAAI,CAAC,YAAY,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;SACtC,CAAC,CAAC;KACJ;IACO,4CAAY,GAApB,UAAqB,MAAc,EAAE,SAAkC;QAAvE,iBAIC;QAHC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,GAAW;YACzC,KAAI,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;SAClD,CAAC,CAAC;KACJ;IACO,8CAAc,GAAtB,UAAuB,MAAc,EAAE,IAAY,EAAE,KAAU;QAC7D,IAAI,MAAM,EAAE;YACV,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9B,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;gBACrB,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;aACtB;iBAAM;gBACL,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;oBACnC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;wBAC1E,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;qBACjB;oBACD,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;iBACnB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;aAC7C;SACF;KACF;;gBA7PF,UAAU;;;;gBATF,YAAY;gBAEZ,kBAAkB;;IAqQ3B,4BAAC;CA9PD;;ACCA;;;;AAIA;;;;IAwCE,2BACU,YAA0B,EAC1B,iBAAwC,EACxC,aAAgC,EAChC,mBAAwC,EAC5B,eAAgC;QAJ5C,iBAAY,GAAZ,YAAY,CAAc;QAC1B,sBAAiB,GAAjB,iBAAiB,CAAuB;QACxC,kBAAa,GAAb,aAAa,CAAmB;QAChC,wBAAmB,GAAnB,mBAAmB,CAAqB;QAC5B,oBAAe,GAAf,eAAe,CAAiB;;;;QAvC9C,qBAAgB,GAAG,EAAE,CAAC;QAyC5B,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;QAC1H,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAgB,aAAa,EAAE,IAAI,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;QAC9G,IAAI,CAAC,IAAI,CAAC,eAAe,IAAI,OAAO,eAAe,KAAK,WAAW,EAAE;YACnE,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,CAAC,CAAC;SAC/F;KACF;IA1CD,sBAAY,mDAAoB;;;;aAAhC;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;SACrD;;;OAAA;IAKD,sBAAY,0CAAW;;;;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SACtC;;;OAAA;;;;IAsCO,8CAAkB,GAA1B;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;QAC5C,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;QAClG,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;;;IAOM,8CAAkB,GAAzB,UAA0B,uBAA+B,EAAE,SAAkB,EAAE,aAAsB,EAAE,QAAiB,EAAE,EAAW;QAArI,iBA2DC;QA1DC,IAAM,MAAM,GAAG,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAC7D,IAAM,MAAM,GAAG,aAAa,GAAG,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACzE,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE;YACtB,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QAED,IAAM,WAAW,GAAgB,IAAI,WAAW,EAAE,CAAC;QACnD,WAAW,CAAC,SAAS,GAAG,CAAC,CAAC;QAC1B,IAAI,QAAQ,EAAE;YACZ,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;SACjC;;QAED,IAAM,gBAAgB,GAAG,EAAE,CAAC;QAC5B,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,IAAI,EAAE,EAAE;;YAEN,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;YACzE,IAAI,WAAW,CAAC,SAAS,KAAK,EAAE,EAAE;gBAChC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aAC1C;;YAED,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,uBAAuB,EAAE,EAAE,CAAC,CAAC;SAC/D;aAAM;;YAEL,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;SAC3D;QACD,IAAI,WAAW,IAAI,WAAW,CAAC,eAAe,EAAE;YAC9C,IAAM,aAAa,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC;YACpH,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7C,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,EAAE,aAAa,CAAC,CAAC;aAC9D;SACF;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC,CAAC;QAClH,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAC1B,SAAS,CAAC,UAAC,SAA2B;YACpC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,cAAc,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACrF,OAAO,KAAK,EAAE,CAAC;aAChB;;YAED,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,QAAwB;gBACpD,IAAI,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;oBACpC,OAAO,QAAQ,CAAC,KAAK,KAAK,SAAS,CAAC,GAAG,CAAC;iBACzC;gBACD,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;YACH,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;;YAED,IAAM,eAAe,GAAG,cAAc,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;YAC3E,IAAM,mBAAmB,GAAG,cAAc,CAAC,sBAAsB,CAAC,eAAe,CAAC,CAAC;YACnF,OAAO,KAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,uBAAuB,EAAE,mBAAmB,CAAC,CAAC;SACvF,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;;;;;IAQM,8DAAkC,GAAzC,UAA0C,uBAA+B,EAAE,SAAkB,EAAE,aAAsB,EAAE,QAAiB,EAAE,EAAW;QAArJ,iBA4DC;QA3DC,IAAM,MAAM,GAAG,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAC7D,IAAM,MAAM,GAAG,aAAa,GAAG,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACzE,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE;YACtB,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QAED,IAAM,WAAW,GAAgB,IAAI,WAAW,EAAE,CAAC;QACnD,WAAW,CAAC,SAAS,GAAG,CAAC,CAAC;QAC1B,IAAI,QAAQ,EAAE;YACZ,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;SACjC;;QAGD,IAAM,gBAAgB,GAAG,EAAE,CAAC;QAC5B,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,IAAI,EAAE,EAAE;;YAEN,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;YACzE,IAAI,WAAW,CAAC,SAAS,KAAK,EAAE,EAAE;gBAChC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aAC1C;;YAED,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,uBAAuB,EAAE,EAAE,CAAC,CAAC;SAC/D;aAAM;;YAEL,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;SAC3D;QACD,IAAI,WAAW,IAAI,WAAW,CAAC,eAAe,EAAE;YAC9C,IAAM,aAAa,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC;YACpH,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7C,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,EAAE,aAAa,CAAC,CAAC;aAC9D;SACF;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC,CAAC;QAClH,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAC1B,SAAS,CAAC,UAAC,SAA2B;YACpC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,cAAc,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACrF,OAAO,KAAK,CAAC;aACd;;YAED,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,QAAwB;gBACpD,IAAI,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;oBACpC,OAAO,QAAQ,CAAC,KAAK,KAAK,SAAS,CAAC,GAAG,CAAC;iBACzC;gBACD,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;YACH,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;;YAED,IAAM,eAAe,GAAG,cAAc,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;YAC3E,IAAM,mBAAmB,GAAG,cAAc,CAAC,sBAAsB,CAAC,eAAe,CAAC,CAAC;YACnF,OAAO,KAAI,CAAC,iBAAiB,CAAC,yBAAyB,CAAC,uBAAuB,EAAE,mBAAmB,CAAC,CAAC;SACvG,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;IAIM,iDAAqB,GAA5B,UAA6B,uBAA+B,EAAE,SAAkB,EAAE,aAAsB,EAAE,QAAiB;QAA3H,iBAiCC;QAhCC,IAAM,MAAM,GAAG,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAC7D,IAAM,MAAM,GAAG,aAAa,GAAG,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACzE,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE;YACtB,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QAED,IAAM,WAAW,GAAgB,IAAI,WAAW,EAAE,CAAC;QACnD,IAAI,QAAQ,EAAE;YACZ,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;SACjC;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,CAAC,CAAC,CAAC;QAChG,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAC1B,SAAS,CAAC,UAAC,SAA2B;YACpC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,cAAc,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACrF,OAAO,KAAK,CAAC;aACd;;YAED,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,QAAwB;gBACpD,IAAI,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;oBACpC,OAAO,QAAQ,CAAC,KAAK,KAAK,SAAS,CAAC,GAAG,CAAC;iBACzC;gBACD,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;YACH,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,IAAM,eAAe,GAAG,cAAc,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;YAC3E,OAAO,KAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,uBAAuB,EAAE,eAAe,CAAC,CAAC;SACpF,CAAC,CACH,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;IAIM,iEAAqC,GAA5C,UAA6C,uBAA+B,EAAE,SAAkB,EAAE,aAAsB,EAAE,QAAiB;QAA3I,iBAgCC;QA/BC,IAAM,MAAM,GAAG,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAC7D,IAAM,MAAM,GAAG,aAAa,GAAG,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACzE,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE;YACtB,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QACD,IAAM,WAAW,GAAgB,IAAI,WAAW,EAAE,CAAC;QACnD,IAAI,QAAQ,EAAE;YACZ,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;SACjC;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,CAAC,CAAC,CAAC;QAChG,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAC1B,SAAS,CAAC,UAAC,SAA2B;YACpC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,cAAc,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACrF,OAAO,KAAK,CAAC;aACd;;YAED,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,QAAwB;gBACpD,IAAI,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;oBACpC,OAAO,QAAQ,CAAC,KAAK,KAAK,SAAS,CAAC,GAAG,CAAC;iBACzC;gBACD,OAAO,IAAI,CAAC;aACb,CAAC,CAAC;YACH,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,IAAM,eAAe,GAAG,cAAc,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;YAC3E,OAAO,KAAI,CAAC,iBAAiB,CAAC,0BAA0B,CAAC,uBAAuB,EAAE,eAAe,CAAC,CAAC;SACpG,CAAC,CACH,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;;;;IAIM,oCAAQ,GAAf,UAAgB,QAAgB,EAAE,MAAe;QAC/C,IAAI,CAAC,QAAQ,EAAE;YACb,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC3F,OAAO,KAAK,CAAC;SACd;QACD,MAAM,GAAG,MAAM,IAAI,cAAc,CAAC;QAClC,IAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;;;;;;;QAOpD,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACjB,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;IAIM,yCAAa,GAApB,UAAqB,SAAmB,EAAE,MAAc;QACtD,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YACxC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC3F,OAAO,KAAK,CAAC;SACd;;QAED,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YAC1B,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;SAC5C;;;QAGD,IAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;QACnD,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACjB,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;;IAMO,0CAAc,GAAtB,UAAuB,cAA6B,EAAE,MAAc;QAClE,MAAM,GAAG,MAAM,IAAI,cAAc,CAAC;QAClC,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC/B,OAAO,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;aACvE;iBAAM;gBACL,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;gBACvD,OAAO,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;aAC7E;SACF;aAAM;YACL,OAAO,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAC;YAChD,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC/B,OAAO,0DAAwD,cAAc,CAAC,CAAC,CAAC,gBAAW,MAAQ,CAAC;aACrG;iBAAM;gBACL,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;gBACvD,OAAO,oEAAkE,eAAe,gBAAW,MAAQ,CAAC;aAC7G;SACF;KACF;;;;IAIM,4CAAgB,GAAvB,UAAwB,MAAc,EAAE,uBAA+B,EAAE,MAAc;QACrF,IAAI,CAAC,MAAM,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC3F,OAAO,KAAK,CAAC;SACd;QAED,IAAM,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC;QACzB,IAAM,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;QAC1F,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YAC1B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACpF,OAAO,KAAK,CAAC;SACd;QAED,IAAM,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;QAC9B,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;KAChC;;;;IAKM,kDAAsB,GAA7B,UAA8B,OAA0B,EAAE,uBAA+B,EAAE,MAAc;QACvG,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YAChE,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;SAC7C;QACD,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,KAAK,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;YACxE,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC3F,OAAO,KAAK,CAAC;SACd;QACD,IAAM,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC/B,IAAM,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,GAAG,CAAC,CAAC;QACtF,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YAC1B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACpF,OAAO,KAAK,CAAC;SACd;QAED,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;KAC9C;;;;;;;IAQM,4DAAgC,GAAvC,UAAwC,uBAA+B,EAAE,SAAiB,EAAE,GAAS;QACnG,IAAI,CAAC,uBAAuB,IAAI,CAAC,SAAS,EAAE;YAC1C,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;SAC9D;QACD,IAAI,SAAS,GAAG,EAAE,CAAC;QACnB,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,IAAI,QAAQ,GAAG,CAAC,KAAK,QAAQ,EAAE;gBAC7B,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACnB;iBAAM;gBACL,OAAO,GAAG,GAAG,CAAC;aACf;YACD,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;SACrF;aAAM;YACL,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;SAClF;QACD,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YACvC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;KAC1D;;;;;;IAMM,qEAAyC,GAAhD,UAAiD,uBAA+B,EAAE,SAAiB;QACjG,IAAI,CAAC,uBAAuB,IAAI,CAAC,SAAS,EAAE;YAC1C,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;SAC9D;QACD,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;QAC/D,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,IAAM,mBAAmB,GAAG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QACzD,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,CAAC,cAAc,CAAC,EAAE;YACxF,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;SACd;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;QACvF,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;YACvC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;SACd;QACD,IAAM,YAAY,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB,CAAC,CAAC;QAC1E,IAAI,CAAC,YAAY,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;SACpC;aAAM;YACL,OAAO,IAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;SAC1E;KACF;;;;;;IAMM,+CAAmB,GAA1B,UAA2B,UAAkB,EAAE,SAAiB;QAC9D,IAAI,CAAC,UAAU,IAAI,CAAC,SAAS,EAAE;YAC7B,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;SACjD;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,CAAC;QACnF,OAAO,OAAO,CAAC;KAChB;;;;;;;IAOM,wDAA4B,GAAnC,UAAoC,uBAA+B,EAAE,UAAkB,EAAE,SAAiB;QACxG,IAAI,CAAC,UAAU,IAAI,CAAC,SAAS,EAAE;YAC7B,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;SACjD;;QAED,IAAM,YAAY,GAAG,IAAI,CAAC,sBAAsB,CAAC,uBAAuB,CAAC,CAAC;QAC1E,IAAI,CAAC,YAAY,EAAE;YACjB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;SACd;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,UAAU,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC,CAAC;QAC1G,OAAO,OAAO,CAAC;KAChB;;;;;;IAMM,kDAAsB,GAA7B,UAA8B,aAAuB,EAAE,SAAiB;QACtE,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC,CAAC;QACtF,OAAO,OAAO,CAAC;KAChB;;;;;;;IAOM,oDAAwB,GAA/B,UAAgC,aAAuB,EAAE,SAAiB,EAAE,YAAoB;QAC9F,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,aAAa,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC,CAAC;QAC7G,OAAO,OAAO,CAAC;KAChB;;;;;;IAMM,sCAAU,GAAjB,UAAkB,QAAkB;QAClC,IAAI,CAAC,QAAQ,EAAE;YACb,QAAQ,GAAG,EAAE,CAAC;SACf;QACD,IAAM,QAAQ,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;QACrC,OAAO,MAAI,QAAQ,OAAI,CAAC;KACzB;;;;;;;IAOM,mDAAuB,GAA9B,UAA+B,YAAoB,EAAE,YAAoB,EAAE,mBAA2B;QAAtG,iBAiDC;;;;;;;;;;QAvCC,IAAM,YAAY,GAAG,mBAAmB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAEnE,IAAM,eAAe,GAAG,YAAY,CAAC,GAAG,EAAE,CAAC;;QAE3C,IAAM,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;QAClG,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAgC,CAAC;QACzE,IAAM,aAAa,GAAG,aAAa,CAAC,aAAa,CAAC;QAClD,IAAM,QAAQ,GAAG,eAAe,CAAC,yBAAyB,CAAC,YAAY,EAAE,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QACvH,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC,GAAG,CAAC,UAAC,IAAY;YAChD,IAAI,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;gBAChC,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC3B;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF,CAAC,CAAC;QACH,IAAI,qBAAqB,EAAE;YACzB,IAAM,aAAW,GAAG,qBAAqB,CAAC,MAAM,EAAE,CAAC;;YAEnD,IAAI,aAAW,EAAE;gBACf,IAAM,eAAe,GAAG,aAAW,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,IAAI,CAAC,YAAY,CAAC,GAAA,CAAC,CAAC;gBACxE,eAAe,CAAC,OAAO,CAAC,UAAA,IAAI;oBAC1B,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,UAAU,CAAC,CAAC;oBACnD,IAAM,aAAa,GAAG,aAAW,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,eAAe,CAAC,CAAC,UAAU,CAAC,KAAK,QAAQ,IAAI,GAAG,CAAC,YAAY,CAAC,GAAA,CAAC,CAAC;oBACpH,KAAK,CAAC,GAAG,EAAE,CAAC;oBACZ,KAAK,CAAC,IAAI,CAAC,YAAU,IAAI,CAAC,qBAAqB,CAAC,UAAU,CAAG,CAAC,CAAC;oBAC/D,IAAI,MAAM,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;oBAClF,IAAM,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;oBAC/C,MAAM,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC;oBAC/B,MAAM,CAAC,YAAY,CAAC,GAAG,KAAK,CAAC;;oBAE7B,aAAa,CAAC,OAAO,CAAC,UAAA,GAAG;wBACvB,KAAK,CAAC,GAAG,EAAE,CAAC;wBACZ,KAAK,CAAC,IAAI,CAAC,YAAU,GAAG,CAAC,qBAAqB,CAAC,UAAU,CAAG,CAAC,CAAC;wBAC9D,MAAM,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;wBAC9E,MAAM,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC;qBAC7B,CAAC,CAAC;iBACJ,CAAC,CAAC;aACJ;SACF;KACF;IACM,iDAAqB,GAA5B,UAA6B,YAAoB,EAAE,mBAA2B;QAC5E,IAAM,YAAY,GAAG,mBAAmB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAEnE,YAAY,CAAC,GAAG,EAAE,CAAC;QACnB,IAAM,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;QAClG,IAAM,aAAa,GAAG,qBAAqB,CAAC,WAAW,CAAC;QACxD,IAAI,aAAa,CAAC,YAAY,CAAC,KAAK,IAAI,EAAE;YACxC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACxF,OAAO,KAAK,CAAC;SACd;KACF;IACM,mDAAuB,GAA9B,UAA+B,YAAoB,EAAE,YAAoB,EAAE,mBAA2B;QAAtG,iBA2CC;QA1CC,IAAM,YAAY,GAAG,mBAAmB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAEnE,IAAM,eAAe,GAAG,YAAY,CAAC,GAAG,EAAE,CAAC;;QAE3C,IAAM,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;;;QAGlG,IAAI,qBAAqB,EAAE;YACzB,IAAM,WAAW,GAAG,qBAAqB,CAAC,MAAM,EAAE,CAAC;YACnD,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,YAAY,CAAC,GAAA,CAAC,CAAC;YACrE,IAAM,aAAW,GAAG,IAAI,GAAG,EAAsB,CAAC;YAClD,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAgC,CAAC;YACzE,IAAM,aAAa,GAAG,aAAa,CAAC,aAAa,CAAC;YAClD,IAAM,QAAQ,GAAG,eAAe,CAAC,yBAAyB,CAAC,YAAY,EAAE,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;YACvH,IAAM,OAAK,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC,GAAG,CAAC,UAAC,IAAY;gBAChD,IAAI,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;oBAChC,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC3B;qBAAM;oBACL,OAAO,IAAI,CAAC;iBACb;aACF,CAAC,CAAC;YACH,aAAa,CAAC,OAAO,CAAC,UAAA,IAAI;gBACxB,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,UAAU,CAAC,CAAC;gBACnD,IAAI,aAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;oBAC7B,aAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACtC;qBAAM;oBACL,aAAW,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;iBACnC;aACF,CAAC,CAAC;YACH,KAAK,CAAC,IAAI,CAAC,aAAW,CAAC,MAAM,EAAE,CAAC,CAAC,OAAO,CAAC,UAAC,KAAiB;gBACzD,KAAK,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;oBACd,IAAM,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;oBACtE,IAAM,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;oBACtE,OAAO,QAAQ,GAAG,QAAQ,CAAC;iBAC5B,CAAC,CAAC;gBACH,IAAM,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBACrB,OAAK,CAAC,GAAG,EAAE,CAAC;gBACZ,OAAK,CAAC,IAAI,CAAC,YAAU,GAAG,CAAC,qBAAqB,CAAC,UAAU,CAAG,CAAC,CAAC;gBAC9D,IAAM,MAAM,GAAG,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,eAAe,CAAC,OAAK,CAAC,CAAC;gBACpF,MAAM,CAAC,YAAY,CAAC,GAAG,KAAK,CAAC;aAC9B,CAAC,CAAC;SACJ;KACF;;;;;IAKO,kDAAsB,GAA9B,UAA+B,uBAA+B;QAC5D,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,IAAM,mBAAmB,GAAG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QACzD,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,sBAAsB,CAAgB,CAAC;QAC/G,IAAM,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QAC5C,IAAI,WAAW,IAAI,WAAW,CAAC,eAAe,EAAE;YAC9C,OAAO,WAAW,CAAC,mBAAmB,CAAC,IAAI,WAAW,CAAC,mBAAmB,CAAC,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC;SACrG;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;;;;;IAKO,yCAAa,GAArB,UAAsB,uBAA+B;QACnD,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QAC7B,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,sBAAsB,CAAgB,CAAC;QAC/G,IAAM,WAAW,GAAG,WAAW,IAAI,WAAW,CAAC,WAAW,CAAC;QAC3D,OAAO,WAAW,CAAC;KACpB;;;;;;;IAOO,yCAAa,GAArB,UAAsB,uBAA+B,EAAE,YAAoB;QACzE,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,sBAAsB,CAAC,GAAG,EAAE,CAAC;QAC7B,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,sBAAsB,CAAgB,CAAC;QAC/G,IAAM,WAAW,GAAG,WAAW,IAAI,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QACtE,OAAO,WAAW,CAAC;KACpB;;;;IAIO,4DAAgC,GAAxC,UAAyC,uBAA+B,EAAE,OAAkB;;QAG1F,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,IAAM,mBAAmB,GAAG,sBAAsB,CAAC,GAAG,EAAE,CAAC;;QAGzD,IAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,CAAC;QACpF,IAAI,sBAAsB,GAAG,EAAE,CAAC;QAChC,IAAI,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,IAAI,EAAE;YAC9C,sBAAsB,GAAG,cAAc,CAAC,MAAM,CAAC,UAAC,UAAe;gBAC7D,OAAO,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;aAC5C,CAAC,CAAC;SACJ;aAAM;YACL,sBAAsB,GAAG,cAAc,CAAC;SACzC;;QAGD,IAAM,aAAa,GAAG,EAAE,CAAC;QACzB,sBAAsB,CAAC,OAAO,CAAC,UAAC,UAAe;YAC7C,IAAI,UAAU,CAAC,mBAAmB,CAAC,EAAE;gBACnC,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,CAAC,cAAc,CAAC,CAAC;gBACrE,IAAI,YAAY,EAAE;oBAChB,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;iBAClC;aACF;SACF,CAAC,CAAC;QAEH,OAAO,aAAa,CAAC;KACtB;;gBAlqBF,UAAU;;;;gBAZF,YAAY;gBAGZ,qBAAqB;gBAFrB,iBAAiB;gBAHjB,mBAAmB;gBAA+B,eAAe,uBA2DrE,QAAQ;;IAsnBb,wBAAC;CAnqBD;;ACJA;;;;;;;AAOA;;;;IAOE,qBACU,YAA0B,EAC1B,iBAAwC,EACxC,aAA4B,EAC5B,kBAAsC,EACtC,aAAgC,EAChC,eAAgC,EAChC,eAAgC,EACpB,kBAAsC;QAR5D,iBAeC;QAdS,iBAAY,GAAZ,YAAY,CAAc;QAC1B,sBAAiB,GAAjB,iBAAiB,CAAuB;QACxC,kBAAa,GAAb,aAAa,CAAe;QAC5B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,kBAAa,GAAb,aAAa,CAAmB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QACpB,uBAAkB,GAAlB,kBAAkB,CAAoB;QAE1D,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,EAAkD,CAAC;QAC7E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,IAAoD;YAClG,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;SACpD,CAAC,CAAC;QACH,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;KAC3B;;;;;IAOM,iCAAW,GAAlB,UAAmB,iBAAyB;QAC1C,IAAM,eAAe,GAAG,IAAI,CAAC,kCAAkC,EAAE,CAAC;QAClE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;YAChC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACnC;QACD,OAAO,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,iBAAiB,EAAE,eAAe,CAAC,CAAC;KAC9E;;;;;;;IAOM,4CAAsB,GAA7B,UAA8B,iBAAyB,EAAE,OAAe;QACtE,IAAM,eAAe,GAAG,IAAI,CAAC,kCAAkC,EAAE,CAAC;QAClE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;YAChC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACnC;;;;;;;;;;;;;;;QAeD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;QACpE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,iBAAiB,mBAAA,EAAE,OAAO,SAAA,EAAE,CAAC,CAAC;;KAEnD;IACO,6BAAO,GAAf,UAAgB,iBAAyB,EAAE,OAAe;QAA1D,iBA2BC;QA1BC,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3D,IAAM,iBAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YACxD,IAAI,SAAS,GAAG,IAAI,CAAC;YACrB,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;;gBAE/B,OAAO,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC;aAC1B;YACD,IAAI,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACpD,IAAI;oBACF,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;iBACjC;gBAAC,WAAM;oBACN,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;iBAC1C;aACF;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;aAC1C;YACD,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,iBAAiB,EAAE,iBAAe,EAAE,SAAS,CAAC,CAAC,IAAI,CAC9F,GAAG,CAAC;gBACF,KAAI,CAAC,eAAe,GAAG,KAAI,CAAC,eAAe,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,iBAAe,CAAC,IAAI,CAAC,UAAA,cAAc,IAAI,OAAA,cAAc,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,GAAA,CAAC,GAAA,CAAC,CAAC;gBACvJ,IAAI,KAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;oBACnC,KAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;iBAC1C;aACF,CAAC,CACH,CAAC,SAAS,EAAE,CAAC;SACf;KAEF;;;;IAKO,wDAAkC,GAA1C;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;QACrD,IAAM,eAAe,GAAG,IAAI,CAAC,wBAAwB,CAAC,WAAW,CAAC,CAAC;QACnE,OAAO,eAAe,CAAC;KACxB;;;;IAKO,8CAAwB,GAAhC,UAAiC,WAAgC;QAC/D,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,EAAE,CAAC;SACX;QAED,IAAM,eAAe,GAAqB,EAAE,CAAC;QAC7C,WAAW,CAAC,OAAO,CAAC,UAAC,aAAgC;YACnD,IAAM,cAAc,GAAmB;gBACrC,YAAY,EAAE,aAAa,CAAC,MAAM,CAAC,UAAU;gBAC7C,QAAQ,EAAE,aAAa,CAAC,MAAM,CAAC,QAAQ;aACxC,CAAC;YACF,eAAe,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACtC,CAAC,CAAC;QACH,OAAO,eAAe,CAAC;KACxB;;;;;;IAUM,oCAAc,GAArB,UAAsB,iBAAyB;QAA/C,iBAiBC;QAhBC,IAAM,OAAO,GAAG,IAAI,CAAC,6BAA6B,CAAC,iBAAiB,CAAC,CAAC;QACtE,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;YACxB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SACtC;QACD,IAAM,SAAS,GAAG,iBAAiB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC;QAC1E,IAAM,iBAAiB,GAAsB,EAAE,CAAC;QAChD,IAAI,SAAS,EAAE;YACb,OAAO,CAAC,OAAO,CAAC,UAAC,MAAc;gBAC7B,IAAI,gBAAgB,CAAC;gBACrB,gBAAgB,GAAG,KAAI,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;gBACxE,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;aAC1C,CAAC,CAAC;YACH,OAAO,QAAQ,CAAC,iBAAiB,CAAC,CAAC;SACpC;aAAM;YACL,OAAO,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;SACrE;KACF;;;;IAKO,mDAA6B,GAArC,UAAsC,mBAA2B;QAAjE,iBAeC;;QAZC,IAAM,WAAW,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;;QAGrD,IAAM,OAAO,GAAa,EAAE,CAAC;QAC7B,WAAW,CAAC,OAAO,CAAC,UAAC,UAA6B;;YAGhD,IAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC;YAC5C,IAAM,MAAM,GAAG,KAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE,mBAAmB,CAAC,CAAC;YACvE,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACtB,CAAC,CAAC;QACH,OAAO,OAAO,CAAC;KAChB;;;;;IAMO,2CAAqB,GAA7B,UAA8B,MAAc,EAAE,mBAA2B;;QAGvE,IAAM,eAAe,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,CAAC;QACrF,IAAM,aAAa,GAAG,eAAe,CAAC,GAAG,EAAE,CAAC;QAC5C,IAAM,mBAAmB,GAAG,eAAe,CAAC;;QAG5C,IAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,CAAC;QACjF,IAAM,gBAAgB,GAAG,cAAc,CAAC,IAAI,CAAC,UAAC,UAAe;YAC3D,IAAI,UAAU,CAAC,aAAa,CAAC,EAAE;gBAC7B,IAAM,YAAY,GAAG,UAAU,CAAC,aAAa,CAAC,CAAC,cAAc,CAAC,CAAC;gBAC/D,IAAI,YAAY,KAAK,MAAM,EAAE;oBAC3B,OAAO,IAAI,CAAC;iBACb;aACF;SACF,CAAC,CAAC;QAEH,OAAO,gBAAgB,CAAC,EAAE,CAAC;KAC5B;;;;;;;;IASM,iCAAW,GAAlB,UAAmB,uBAA+B,EAAE,GAAa;QAC/D,IAAI,CAAC,uBAAuB,EAAE;YAC5B,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;SACpC;;QAED,IAAI,CAAC,GAAG,EAAE;;YAER,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAmB,CAAC;;YAEzD,GAAG,GAAG,cAAc,IAAI,cAAc,CAAC,UAAU,IAAI,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC;SACrF;;QAED,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAC/B,OAAO;SACR;;QAED,IAAM,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;;QAEzE,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1C,OAAO;SACR;;QAED,IAAM,sBAAsB,GAAG,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;QAChG,IAAM,eAAe,GAAG,sBAAsB,CAAC,GAAG,EAAE,CAAC;;QAErD,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;SACpE;QACD,IAAM,IAAI,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC;;QAElC,GAAG,CAAC,OAAO,CAAC,UAAC,EAAU,EAAE,KAAa;YACpC,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,eAAe,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,CAAC,cAAc,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;YAC9G,IAAM,eAAe,GAAG,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC;YACxC,IAAI,CAAC,eAAe,EAAE;gBACpB,OAAO;aACR;YACD,IAAM,aAAa,GAAG,WAAW,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;YAC5D,IAAI,aAAa,EAAE;;gBAEjB,IAAM,UAAU,GAAG,aAAa,CAAC,eAAe,CAAkB,CAAC;gBACnE,IAAI,UAAU,EAAE;;oBAEd,IAAM,KAAK,GAAG,UAAU,CAAC,QAAQ,CAAC,sBAAsB,CAAC,CAAC;oBAC1D,IAAI,KAAK,KAAK,KAAK,EAAE;;wBAEnB,UAAU,CAAC,QAAQ,CAAC,sBAAsB,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBAChE;iBACF;aACF;SACF,CAAC,CAAC;KACJ;;;;;;;;IAUO,+CAAyB,GAAjC;QAEE,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAmB,CAAC;QACzD,IAAM,UAAU,GAAG,cAAc,CAAC,UAAU,CAAC;QAC7C,IAAI,CAAC,UAAU,EAAE;YACf,OAAO,EAAE,CAAC;SACX;QAED,IAAI,WAAkB,CAAC;QACvB,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE;YACvC,WAAW,GAAG,CAAC,UAAU,CAAC,CAAC;SAC5B;aAAM;YACL,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACrC;QAED,OAAO,WAAkC,CAAC;KAC3C;;gBArRF,UAAU;;;;gBAjBF,YAAY;gBAGZ,qBAAqB;gBAErB,aAAa;gBACI,kBAAkB;gBALnC,iBAAiB;gBAGjB,eAAe;gBAEf,eAAe;gBACf,kBAAkB,uBAyBtB,QAAQ;;IAwQb,kBAAC;CAvRD;;ACZA;;;;AAIA;IASE,uBACU,YAA4B,EAC5B,iBAAoC,EACpC,yBAAmD,EACnD,YAA2B,EACf,QAAmB;QAJ/B,iBAAY,GAAZ,YAAY,CAAgB;QAC5B,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,8BAAyB,GAAzB,yBAAyB,CAA0B;QACnD,iBAAY,GAAZ,YAAY,CAAe;QACf,aAAQ,GAAR,QAAQ,CAAW;QAXjC,eAAU,GAAe,EAAE,CAAC;QAI5B,WAAM,GAAQ,EAAE,CAAC;QASvB,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;;;;IAKO,0CAAkB,GAA1B;;QAGE,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAI,YAAY,EAAE;YAChB,IAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;YAC5C,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC,GAAG,CAAkB,eAAe,EAAE,IAAI,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;SACnG;QAED,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;;;;IAKO,uCAAe,GAAvB;QACE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,OAAO,IAAI,CAAC,YAAY,CAAA;SACzB;QACD,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,EAAE;YACtD,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,CAAC;SACxC;QACD,OAAO,IAAI,CAAC;KACb;;;;IAIO,mDAA2B,GAAnC;QACE,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAI,wBAA6B,CAAC;QAClC,IAAI,YAAY,EAAE;YAChB,wBAAwB,GAAG,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;SAChF;QACD,OAAO,wBAAwB,CAAC;KACjC;;;;;IAMO,2CAAmB,GAA3B,UAA4B,MAAW;QACrC,IAAI,gBAAqB,CAAA;QACzB,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,IAAI,MAAM,CAAC,MAAM,EAAE;gBACjB,IAAI;oBACF,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;iBACvC;gBAAC,WAAM;oBACN,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,cAAc,CAAC,CAAC;iBAC1C;aACF;iBAAM;gBACL,gBAAgB,GAAG,EAAE,CAAC;aACvB;SACF;aAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YACrC,gBAAgB,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;SAC9C;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;SACnC;QACD,OAAO,gBAAgB,CAAC;KACzB;;;;;;;IAQO,+CAAuB,GAA/B,UAAgC,MAAW,EAAE,SAAc,EAAE,aAAkB;QAC7E,IAAI,YAAiB,CAAC;QACtB,IAAI,QAAa,CAAC;QAClB,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC5C,IAAM,wBAAwB,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;QACpE,IAAI,YAAY,IAAI,wBAAwB,EAAE;YAC5C,IAAM,kBAAkB,GAAG,wBAAwB,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;YACvF,IAAM,oBAAoB,GAAG,kBAAkB,CAAC,gBAAgB,UAAK,IAAI,CAAC,UAAU,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;YAC9G,YAAY,GAAG,kBAAkB,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC;YAC/D,IAAI,YAAY,IAAI,YAAY,CAAC,QAAQ,IAAI,YAAY,CAAC,QAAQ,CAAC,SAAS,IAAI,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,EAAE;gBACvH,IAAI,OAAO,aAAa,KAAK,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE;oBAC1E,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;wBACrC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;qBACrF,CAAC,CAAC;iBACJ;;gBAED,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;aACjF;YACD,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;SACzD;aAAM;YACL,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;SACtD;QACD,OAAO,QAAQ,CAAC;KACjB;;;;;;;IAOM,iCAAS,GAAhB,UAAiB,MAAgB,EAAE,OAAe,EAAE,aAAuB,EAAE,QAAiC;QAA9G,iBAwFC;QAxFgB,uBAAA,EAAA,WAAgB;QAAmB,8BAAA,EAAA,kBAAuB;QAEzE,IAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QACnD,IAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC,aAAa,CAAC,CAAC;QAC9D,IAAI,eAAe,GAAG,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAClE,IAAI,QAAa,CAAC;QAClB,IAAI,WAAW,GAAQ;YACrB,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,kBAAkB;YAC9C,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;YACX,WAAW,EAAE,KAAK;SACnB,CAAC;QACF,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;QACpD,IAAM,gBAAgB,GAAG,WAAW,CAAC,WAAW,CAAC;;QAEjD,IAAM,aAAa,GAAG,WAAW,CAAC,eAAe,CAAC,IAAI,KAAK,CAAC;QAC5D,WAAW,CAAC,WAAW,GAAG,UAAC,GAAG;;;;YAI5B,IAAI,CAAC,CAAC,gBAAgB,IAAI,OAAO,gBAAgB,KAAK,UAAU,EAAE;gBAChE,OAAO,gBAAgB,CAAC,GAAG,CAAC,CAAC,IAAI,CAC/B,SAAS,CAAC,UAAA,MAAM;oBACd,IAAI,MAAM,EAAE;wBACV,IAAI,aAAa,EAAE;4BACjB,OAAO,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;yBAChC;qBACF;oBACD,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;iBACnB,CAAC,CACH,CAAC;aACH;YACD,IAAI,aAAa,EAAE;gBACjB,OAAO,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;aAChC;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC;QACF,IAAM,MAAM,GAAG,WAAW,CAAC,MAAM,IAAI,KAAK,CAAC;QAC3C,IAAI,MAAM,EAAE;YACV,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC,SAAS,CACzD,UAAC,QAAa;gBACZ,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBACzB,IAAI,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,EAAE;oBAClC,QAAQ,CAAC,OAAO,CAAC,qBAAqB,GAAG,IAAI,CAAC;oBAC9C,QAAQ,CAAC,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;iBACvC;gBACD,QAAQ,CAAC,QAAQ,CAAC,CAAC;aACpB,CACF,CAAC;SACH;aAAM;YACL,IAAI,CAAC,eAAe,EAAE;gBACpB,OAAO,CAAC,KAAK,CAAC,uDAAkB,OAAS,CAAC,CAAC;gBAC3C,OAAO;aACR;YACD,IAAI,OAAO,eAAe,KAAK,QAAQ,EAAE;gBACvC,WAAW,CAAC,UAAU,GAAG,QAAQ,CAAC;gBAClC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;aACjE;iBAAM,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;gBAChD,QAAQ,GAAG,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,eAAe,EAAE,aAAa,CAAC,CAAC;aACtF;iBAAM,IAAI,OAAO,eAAe,KAAK,QAAQ,EAAE;;;gBAG9C,IAAI,eAAe,CAAC,YAAY,EAAE;oBAChC,IAAM,SAAS,GAAG;wBAChB,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,OAAO,EAAE,aAAa;wBACtB,YAAY,EAAE,IAAI,CAAC,YAAY;wBAC/B,qBAAqB,EAAE,IAAI;wBAC3B,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC,QAAQ;wBACjE,iBAAiB,EAAE,IAAI,CAAC,eAAe;wBACvC,qBAAqB,EAAE,IAAI,CAAC,qBAAqB;qBAClD,CAAC;;oBAEF,OAAO,eAAe,CAAC,eAAe,CAAC,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;iBAEjE;qBAAM;oBACL,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;iBACjE;aACF;YAED,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,IAAI,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,EAAE;gBAClC,QAAQ,CAAC,OAAO,CAAC,qBAAqB,GAAG,IAAI,CAAC;gBAC9C,QAAQ,CAAC,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;aACvC;YACD,OAAO,QAAQ,CAAC;SACjB;KACF;IAEO,uCAAe,GAAvB,UAAwB,MAAW,EAAE,SAEpC;QACC,IAAI,MAAM,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,SAAS,IAAI,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,EAAE;YAC/F,IAAI,SAAS,CAAC,OAAO,IAAI,OAAO,SAAS,CAAC,OAAO,KAAK,QAAQ,EAAE;gBAC9D,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aACnD;YACD,IAAI,OAAO,SAAS,CAAC,OAAO,KAAK,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE;gBAClF,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;oBACzC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;iBACnF,CAAC,CAAC;aACJ;;YAED,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;SAC3E;KACF;IAEO,6CAAqB,GAA7B,UAA8B,MAAW,EAAE,OAAY,EAAE,SAAc;QACrE,IAAI,SAAS,IAAI,SAAS,CAAC,YAAY,EAAE;YACvC,IAAM,QAAQ,GAAG,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;YAC9D,IAAI,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,EAAE;gBAClC,QAAQ,CAAC,OAAO,CAAC,qBAAqB,GAAG,IAAI,CAAC;gBAC9C,QAAQ,CAAC,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;aACvC;YACD,OAAO,QAAQ,CAAC;SACjB;KACF;;;;;;;;IASM,qCAAa,GAApB,UAAqB,OAAe,EAAE,MAAc,EAAE,OAAa;QAAnE,iBAiCC;QAhCC,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;;QAEnD,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC;QACrC,IAAM,OAAO,GAAG,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC;QAC/E,IAAM,OAAO,GAAG,MAAM,IAAI,MAAM,CAAC,OAAO,CAAC;QACzC,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;;QAE3B,IAAA,oBAAc,EAAd,mCAAc,CAAa;QACnC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,GAAG,IAAI,CAAC;SAChB;QACD,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACrD,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC/B;QACK,IAAA,kBAAgF,EAA9E,cAAc,EAAd,mCAAc,EAAE,kBAAkB,EAAlB,uCAAkB,EAAE,oBAAwB,EAAxB,6CAA0C,CAAC;;QAEvF,IAAI,YAAY,KAAK,SAAS,IAAI,OAAO,CAAC,YAAY,KAAK,SAAS,EAAE;YACpE,OAAO,CAAC,YAAY,GAAG,YAAY,CAAC;SACrC;QACD,IAAI,MAAM,EAAE;YACV,IAAM,WAAS,GAAG,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;YAC1C,OAAO,CAAC,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YACvD,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,UAAC,SAAc;;gBAEtD,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,SAAA,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,aAAA,EAAE,SAAS,WAAA,EAAE,UAAU,YAAA,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,SAAA,EAAE,CAAC;aAC/G,CAAC,CAAC;SACJ;aAAM;YACL,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;YAC3D,IAAM,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,SAAA,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,WAAA,EAAE,SAAS,WAAA,EAAE,UAAU,YAAA,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,SAAA,EAAE,CAAC;SAC/G;QACD,OAAO,OAAO,CAAC;KAChB;;;;;;;;IASM,6CAAqB,GAA5B,UAA6B,OAAe,EAAE,MAAe,EAAE,OAAa;QAA5E,iBA8EC;QA7EC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,GAAG,IAAI,CAAC;SAChB;QACD,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC/B,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC/B;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;QACtE,IAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;QAC/B,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC;QAC3B,OAAO,CAAC,OAAO,GAAG;YAChB;gBACE,IAAI,EAAE,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,GAAG,EAAE,iBAAiB,EAAE,MAAM,EAAE,UAAC,KAAU;oBACrE,IAAA,4BAAc,EAAd,mCAAc,CAAmB;oBACzC,IAAI,OAAO,EAAE;wBACX,IAAM,KAAK,GAAG,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;wBAC7B,IAAA,gBAAqG,EAAnG,eAAc,EAAd,qCAAc,EAAE,iBAAgB,EAAhB,qCAAgB,EAAE,eAAc,EAAd,qCAAc,EAAE,cAAa,EAAb,oCAAa,EAAE,kBAAkB,EAAlB,yCAAkC,CAAC;wBAC5G,IAAM,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;wBAClC,IAAI,CAAC,OAAO,EAAE;4BACZ,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;yBAC7B;wBACD,IAAI,aAAa,GAAG,EAAE,CAAC;wBACvB,IAAI,YAAU,KAAK,IAAI,EAAE;4BACvB,IAAI,YAAY,SAAc,CAAC;4BAC/B,IAAI,OAAO,CAAC,OAAO,EAAE;gCACnB,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,SAAO,CAAiB,CAAC;6BAC5G;iCAAM;gCACL,YAAY,GAAG,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,SAAO,CAAiB,CAAC;6BACpG;4BAED,IAAI,CAAC,YAAY,EAAE;gCACjB,MAAM,IAAI,KAAK,CAAC,oCAAc,SAAO,wEAAmB,CAAC,CAAC;6BAC3D;4BACD,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,OAAO,EAAiB,CAAC;4BACtE,IAAM,IAAI,GAAG,WAAW,IAAI,WAAW,CAAC,WAAW,IAAI,WAAW,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;4BACxF,aAAa,GAAG,CAAC,IAAI,CAAC,CAAC;yBACxB;6BAAM;4BACL,IAAI,IAAI,SAAkB,CAAC;;4BAE3B,IAAI,OAAO,CAAC,OAAO,EAAE;gCACnB,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,SAAO,CAAC,CAAC,OAAO,CAAC,IAAI,IAAI,IAAI,GAAG,EAAe,CAAC;6BAC3H;iCAAM;gCACL,IAAI,GAAG,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,SAAO,CAAC,CAAC,OAAO,CAAC,IAAI,IAAI,IAAI,GAAG,EAAe,CAAC;6BACnH;4BAED,aAAa,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;yBAC3C;wBACD,IAAI,OAAO,QAAM,KAAK,UAAU,EAAE;4BAChC,QAAM,CAAC,aAAa,CAAC,CAAC;yBACvB;wBACD,IAAI,SAAO,EAAE;4BACX,SAAO,CAAC,IAAI,EAAE,CAAC;yBAChB;wBACD,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;qBAC1B;iBACF;aACF;YACD,EAAE,IAAI,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,UAAC,KAAU,IAAK,OAAA,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAA,EAAE;SAChG,CAAC;QAEF,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;QAC3B,IAAA,oBAAc,EAAd,mCAAc,CAAa;QAC3B,IAAA,mBAAa,EAAb,kCAAa,EAAE,uBAAkB,EAAlB,uCAAkB,EAAE,yBAAwB,EAAxB,6CAAwB,CAAa;QAChF,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;;QAE9B,IAAI,YAAY,KAAK,SAAS,IAAI,OAAO,CAAC,YAAY,KAAK,SAAS,EAAE;YACpE,OAAO,CAAC,YAAY,GAAG,YAAY,CAAC;SACrC;QACD,IAAI,MAAM,EAAE;YACV,OAAO,CAAC,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YACvD,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,UAAC,SAAc;gBACtD,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,SAAA,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,WAAA,EAAE,MAAM,QAAA,EAAE,UAAU,YAAA,EAAE,KAAK,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC;aAC1G,CAAC,CAAC;SACJ;aAAM;YACL,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,SAAA,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,WAAA,EAAE,MAAM,QAAA,EAAE,UAAU,YAAA,EAAE,KAAK,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC;SAC1G;QACD,OAAO,OAAO,CAAC;KAChB;;;;;IAMM,+BAAO,GAAd;QAAA,iBAmEC;QAlEC,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;QAC9D,IAAA,2BAAc,EAAd,mCAAc,CAAkB;QACxC,IAAI,OAAO,EAAE;YACX,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAC7B,IAAA,gBAAoI,EAAlI,eAAc,EAAd,mCAAc,EAAE,iBAAgB,EAAhB,qCAAgB,EAAE,iBAAc,EAAd,qCAAc,EAAE,eAAc,EAAd,mCAAc,EAAE,kBAAkB,EAAlB,uCAAkB,EAAE,aAAY,EAAZ,mCAAY,EAAE,eAAc,EAAd,qCAA8B,CAAC;YAC3I,IAAM,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;YAClC,IAAI,CAAC,OAAO,EAAE;gBACZ,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;aAC7B;;YAGD,IAAI,eAAa,GAAG,EAAE,CAAC;YACvB,IAAI,UAAU,KAAK,IAAI,EAAE;gBACvB,IAAM,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAiB,CAAC;gBACjH,IAAI,CAAC,YAAY,EAAE;oBACjB,MAAM,IAAI,KAAK,CAAC,oCAAc,OAAO,wEAAmB,CAAC,CAAC;iBAC3D;gBACD,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,OAAO,EAAiB,CAAC;gBACtE,IAAM,IAAI,GAAG,WAAW,IAAI,WAAW,CAAC,WAAW,IAAI,WAAW,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;gBACxF,IAAI,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;oBACxC,eAAa,GAAG,CAAC,IAAI,CAAC,CAAC;iBACxB;aACF;iBAAM;gBACL,IAAM,IAAI,GAAqB,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,IAAI,IAAI,IAAI,GAAG,EAAe,CAAC;gBAClJ,eAAa,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;aAC3C;;;YAID,IAAI,WAAW,GAAG,SAAS,CAAC;YAC5B,IAAI,OAAK,IAAI,OAAK,CAAC,MAAM,IAAI,OAAK,CAAC,MAAM,CAAC,MAAM,EAAE;gBAChD,WAAW,GAAG,OAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC;aACzC;YACD,IAAI,eAAa,IAAI,WAAS,EAAE;gBAC9B,MAAM,CAAC,IAAI,CAAC,WAAS,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC;oBAC9B,IAAM,WAAW,GAAW,WAAS,CAAC,CAAC,CAAC,CAAC;oBACzC,IAAM,cAAc,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,IAAI,EAAE,CAAC;oBACzD,IAAM,WAAW,GAAG,eAAa,CAAC,GAAG,CAAC,UAAA,CAAC;wBACrC,OAAO,cAAc,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,GAAG;4BACvC,IAAI,MAAM,KAAK,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,EAAE;gCACrF,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC;6BACpB;iCAAM;gCACL,OAAO,EAAE,CAAC;6BACX;yBACF,EAAE,CAAC,CAAC,CAAC;qBACP,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBACb,IAAI,WAAW,EAAE;wBACf,IAAM,cAAY,GAAG,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBACvF,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBAC3D,YAAY,CAAC,OAAO,CAAC,UAAA,MAAM;4BACzB,IAAI,SAAO,EAAE;gCACX,KAAI,CAAC,cAAc,CAAC,SAAO,EAAE,MAAM,EAAE,WAAW,CAAC,CAAC;6BACnD;iCAAM;gCACL,IAAM,UAAU,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gCACrC,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAY,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,WAAW,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;6BAClG;yBAEF,CAAC,CAAC;qBACJ;iBACF,CAAC,CAAA;aACH;YACD,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,IAAI,EAAE,CAAC;aAChB;YACD,SAAS,CAAC,KAAK,EAAE,CAAC;SACnB;KACF;;;;;IAKM,8BAAM,GAAb,UAAc,KAAW;QACvB,IAAM,MAAM,GAAG,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;QACvE,IAAA,2BAAc,EAAd,mCAAc,CAAkB;QACxC,IAAI,OAAO,EAAE;YACX,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAC7B,IAAA,gBAAkD,EAAhD,eAAc,EAAd,mCAAc,EAAE,iBAAgB,EAAhB,qCAAgC,CAAC;YACzD,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,IAAI,EAAE,CAAC;aAChB;YACD,IAAI,SAAS,EAAE;gBACb,SAAS,CAAC,KAAK,EAAE,CAAC;aACnB;SACF;KACF;;;;IAIO,qCAAa,GAArB,UAAsB,GAAQ;QAC5B,IAAI,GAAG,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE;YAC/C,IAAM,SAAS,GAAmB,GAAG,CAAC,QAAQ,CAAC,OAAyB,CAAC;YACzE,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,EAAE;gBAClC,IAAM,UAAU,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC;gBACxD,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,cAAM,OAAA,EAAE,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC,CAAC;iBACnE;aACF;SACF;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;IAID,kCAAU,GAAV;QACE,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SACvB;KACF;;;;;;IAMO,wCAAgB,GAAxB,UAAyB,OAAY,EAAE,OAAY;QAAnD,iBAiCC;QAhCC,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,KAAK,CAAC;QACvC,IAAM,OAAO,GAAG,IAAI,OAAO,EAAO,CAAC;QACnC,IAAI,MAAM,EAAE;YACV,IAAI,YAAU,GAAG,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC;YAC5C,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAC,MAAW;gBACrC,IAAI,CAAC,YAAU,EAAE;oBACf,YAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC;iBACxC;gBACD,IAAM,aAAa,GAAG,MAAM,CAAC,YAAU,CAAyB,CAAC;gBACjE,IAAM,SAAS,GAAG,aAAa,CAAC,MAAM,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAM,cAAc,GAAG,SAAS,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5D,IAAI,cAAc,EAAE;oBAClB,IAAM,WAAW,GAAG,SAAS,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,cAAc,CAAC,CAAC;oBAC/F,IAAM,cAAY,GAAsB,WAAW,CAAC,MAAM,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC;oBAE1E,IAAI,cAAY,IAAI,cAAY,CAAC,QAAQ,IAAI,cAAY,CAAC,QAAQ,CAAC,SAAS,IAAI,cAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,EAAE;wBACvH,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE;4BAC9D,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;gCAC/B,cAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;6BAC/E,CAAC,CAAC;yBACJ;;wBAED,cAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;qBACjF;oBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,cAAY,EAAE,OAAO,CAAC,CAAC;oBAC/D,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACxB;qBAAM;oBACL,MAAM,IAAI,KAAK,CAAC,wDAAW,CAAC,CAAC;iBAC9B;aACF,CAAC,CAAC;SACJ;QACD,OAAO,OAAO,CAAC;KAChB;IACO,sCAAc,GAAtB,UAAuB,MAAc,EAAE,IAAY,EAAE,KAAU;QAC7D,IAAI,MAAM,EAAE;YACV,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9B,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;gBACrB,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;aACtB;iBAAM;gBACL,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;oBACnC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;wBAC1E,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;qBACjB;oBACD,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;iBACnB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;aAC7C;SACF;KACF;;gBArhBF,UAAU;;;;gBAXF,cAAc;gBACd,iBAAiB;gBAFL,wBAAwB;gBAGpC,YAAY;gBAHoG,QAAQ,uBA0B5H,QAAQ;;IAwgBb,oBAAC;CAthBD;;ACFA;;;;AAIA;IAOE,wBACU,YAA0B,EAC1B,gBAAsC,EACtC,cAAkC,EACtB,eAAgC;QAH5C,iBAAY,GAAZ,YAAY,CAAc;QAC1B,qBAAgB,GAAhB,gBAAgB,CAAsB;QACtC,mBAAc,GAAd,cAAc,CAAoB;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAEpD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;IAbD,sBAAY,sCAAU;aAAtB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;SAC9D;;;OAAA;IAaD,oCAAW,GAAX;QACE,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;KACxC;IAED,qCAAY,GAAZ;QACE,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;KACzC;;;;IAKD,oDAA2B,GAA3B;;QAGE,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;QAC7E,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;;QAGD,IAAM,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC,CAAC;QACvF,IAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,CAC3B,SAAS,CAAC,UAAC,aAAsB;YAC/B,IAAI,aAAa,KAAK,KAAK,EAAE;gBAC3B,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;aAClB;iBAAM;gBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC,CACH,CAAC;QAEF,OAAO,OAAO,CAAC;KAChB;;;;IAKM,+CAAsB,GAA7B;QACE,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;IAKM,2CAAkB,GAAzB;QACE,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;KAClB;;gBAhEF,UAAU;;;;gBAVM,YAAY;gBADpB,oBAAoB;gBAGpB,kBAAkB;gBAClB,eAAe,uBAkBnB,QAAQ;;IAsDb,qBAAC;CAjED;;ACZA;;;;AAIA;IAAA;KA4BC;;;;;IArBQ,oDAA4B,GAAnC,UAAoC,OAAe,EAAE,aAAqB;QAA1E,iBAYC;QAXC,IAAI,CAAC,OAAO,IAAI,CAAC,aAAa,EAAE;YAC9B,OAAO,OAAO,CAAC;SAChB;QAED,IAAM,WAAW,GAAU,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QAC/C,IAAM,mBAAmB,GAAG,WAAW,CAAC,MAAM,CAAC,UAACG,SAAW;YACzD,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAACA,SAAM,CAAC,CAAC;YAChD,OAAO,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;SAClD,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;KAC5C;;;;;IAMO,sCAAc,GAAtB,UAAuBA,SAAW;QAChC,OAAOA,SAAM,CAAC,KAAK,IAAIA,SAAM,CAAC,KAAK,CAAC;KACrC;;gBA3BF,UAAU;;IA4BX,oBAAC;CA5BD;;ACLO,IAAMG,wBAAsB,GAAG,IAAI,cAAc,CAAyB,eAAe,CAAC,CAAC;;;;;AAMlG;IAAA;QAGU,aAAQ,GAA2B,EAAE,CAAC;KAsB/C;IApBC,+CAAa,GAAb,UAAc,GAAW,EAAE,MAAW;QACpC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;KAC7B;IAED,4CAAU,GAAV,UAAW,GAAW;QACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YACtB,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SAC3B;aAAM;YACL,OAAO,CAAC,IAAI,CAAC,gCAAU,GAAG,6BAAM,CAAC,CAAC;YAClC,OAAO,IAAI,CAAC;SACb;KACF;IACM,uCAAK,GAAZ,UAAa,GAAY;QACvB,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;YAC1B,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SAC3B;aAAM;YACL,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;SACpB;KACF;;gBAxBF,UAAU;;IAyBX,8BAAC;CAzBD;;;ICLA;KAgBC;IAfG,kDAAuB,GAAvB,UAAwB,YAA2B;QAC/C,IAAI,WAAW,GAAG,IAAI,GAAG,EAAmB,CAAC;QAC7C,IAAI,CAAC,GAAC,CAAC,CAAC;QACR,KAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACrC,WAAW,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,GAAC,CAAC,IAAE,CAAC,GAAE,IAAI,GAAC,KAAK,CAAC,CAAC;YACrD,CAAC,EAAE,CAAC;SACP;QAED,IAAI,WAAW,GAAG,IAAI,OAAO,EAAwB,CAAC;QACtD,UAAU,CAAC;YACP,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SACjC,EAAE,CAAC,CAAC,CAAC;QAEN,OAAO,WAAW,CAAC;KACtB;IACL,uBAAC;CAAA;;ACdD;;;AAGA;IAEI;QACI,IAAI,CAAC,iBAAiB,GAAG,IAAI,GAAG,EAAkB,CAAC;QACnD,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAmB,CAAC;KACjD;;;;;IAgBS,+BAAW,GAArB,UAAsB,QAAgB;QAAtC,iBAOC;QANG,KAAI,IAAI,CAAC,IAAI,QAAQ,EAAE;YACnB,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;SAC9C;QACD,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;YACvC,KAAI,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;SACvB,CAAC,CAAC;KACN;;;;IAKD,8BAAU,GAAV,UAAW,gBAAkC;QAA7C,iBAYC;QAXG,IAAG,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,iBAAiB,CAAC,IAAI,GAAC,CAAC,EAAE;YACxD,OAAO,gBAAgB,CAAC,uBAAuB,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAC7F,GAAG,CAAC,UAAC,aAAa;gBACd,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;oBACvC,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC;iBAC1F,CAAC,CAAC;aACN,CAAC,CACL,CAAC;SACL;aAAI;YACD,OAAO,KAAK,EAAE,CAAC;SAClB;KACJ;;;;;IAMD,gCAAY,GAAZ,UAAa,KAAY;QACrB,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACrE;IAIL,gBAAC;CAAA;;AChED;;;;;;AAMA,AAKA;;;;AAIA;IAGE,0BACU,gBAAkC,EACtB,eAAgC,EAC5C,kBAA8B;QAF9B,qBAAgB,GAAhB,gBAAgB,CAAkB;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAC5C,uBAAkB,GAAlB,kBAAkB,CAAY;QAJhC,eAAU,GAAe,IAAI,CAAC;QAMpC,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,EAAE;YAChC,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;KACF;IACM,qCAAU,GAAjB,UAAkB,kBAA8B;QAC9C,IAAI,CAAC,UAAU,GAAG,kBAAkB,CAAC;KACtC;IACM,iCAAM,GAAb,UAAc,KAAU;QACtB,IAAI,CAAC,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC3B,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACzE;KACF;;gBAnBF,UAAU;;;;gBAPF,gBAAgB;gBADhB,eAAe,uBAanB,QAAQ;gBAXe,UAAU;;IA0BtC,uBAAC;CApBD;;ACoCA;;;AAGA,IAAM,gCAAgC,GAAe;;IAGnD,kBAAkB;IAClB,kBAAkB;IAClB,iBAAiB;IACjB,gBAAgB;IAChB,YAAY;IACZ,gBAAgB;IAChB,YAAY;IACZ,aAAa;IACb,iBAAiB;IACjB,eAAe;IACf,YAAY;IACZ,gBAAgB;IAChB,kBAAkB;IAClB,uBAAuB;IACvB,sBAAsB;IACtB,iBAAiB;IACjB,aAAa;IACb,uBAAuB;;IAGvB,iBAAiB;IACjB,mBAAmB;IACnB,iBAAiB;IACjB,cAAc;IACd,mBAAmB;IACnB,kBAAkB;IAClB,cAAc;;IAGd,uBAAuB;IACvB,yBAAyB;IACzB,wBAAwB;IACxB,iBAAiB;IACjB,aAAa;IAEb,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,eAAe;IACf,kBAAkB;IAElB,eAAe;IACf,cAAc;IACd,YAAY;IACZ,qBAAqB;IACrB,iBAAiB;IACjB,2BAA2B;IAC3B,qBAAqB;IACrB,cAAc;IACd,iBAAiB;IACjB,aAAa;CACd;;;ICtGC,6BAAoB,QAAkB,EAAsB,qBAA4C;QAApF,aAAQ,GAAR,QAAQ,CAAU;QAAsB,0BAAqB,GAArB,qBAAqB,CAAuB;KAAK;IAK7G,sBAAW,yCAAQ;;;;aAAnB;YACE,OAAO,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,IAAI,CAAC;SAClD;;;OAAA;IAID,sBAAW,+CAAc;;;;aAAzB;YACE,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC;YACzD,IAAI,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,SAAS,EAAE;gBAC3C,OAAO,MAAM,CAAC;aACf;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF;;;OAAA;IAID,sBAAW,gDAAe;;;;aAA1B;YACE,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,eAAe,IAAI,IAAI,CAAC;SACrE;;;OAAA;IAKD,sBAAW,2CAAU;;;;;aAArB;YACE,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,IAAI,CAAC;SACpE;;;OAAA;IAKD,sBAAW,2CAAU;;;;;aAArB;YACE,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,IAAI,CAAC;SACpE;;;OAAA;IACD,sBAAW,+CAAc;aAAzB;YACE,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,YAAY,CAAC;YACvF,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,UAAU,CAAC;YACrF,OAAU,UAAU,SAAI,UAAY,CAAC;SACtC;;;OAAA;IAID,sBAAW,8CAAa;;;;aAAxB;YACE,OAAO,IAAI,CAAC;SACb;;;OAAA;IAID,sBAAW,6CAAY;;;;aAAvB;YACE,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE;gBACzD,IAAM,gBAAgB,GAAG,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAAC;gBAC3D,IAAM,YAAY,GAAiB;oBACjC,YAAY,EAAE,gBAAgB,CAAC,YAAY,IAAI,GAAG;oBAClD,mBAAmB,EAAE,gBAAgB,CAAC,mBAAmB,IAAI,CAAC;oBAC9D,sBAAsB,EAAE,gBAAgB,CAAC,sBAAsB,IAAI,GAAG;oBACtE,oBAAoB,EAAE,gBAAgB,CAAC,oBAAoB,IAAI,GAAG;iBACnE,CAAC;gBACF,OAAO,YAAY,CAAC;aACrB;YACD,OAAO,IAAI,CAAC;SACb;;;OAAA;IAID,sBAAW,2CAAU;;;;aAArB;YACE,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,IAAI,CAAC;SACpE;;;OAAA;IAID,sBAAY,6CAAY;;;;aAAxB;YACE,IAAM,YAAY,GAAG,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,CAAC,UAAU,EAAE,CAAC;YAC3F,OAAO,YAAY,CAAC;SACrB;;;OAAA;IACD,sBAAY,yCAAQ;aAApB;YACE,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;SACtD;;;OAAA;IACD,sBAAY,4CAAW;aAAvB;YACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;SAC3D;;;OAAA;;gBAtFF,UAAU;;;;gBAJU,QAAQ;gBAEpB,qBAAqB,uBAIa,QAAQ;;IAqFnD,0BAAC;CAvFD;;;ICGE;QACE,IAAI,CAAC,cAAc,GAAG,UAAC,QAAwC;YAC7D,OAAO,UAAC,KAAU;gBAChB,IAAI,OAAO,GAAG,KAAK,CAAC,IAAyB,CAAC;gBAC9C,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;iBAC/B;gBACD,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;oBAClC,QAAQ,CAAC,OAAO,CAAC,CAAC;iBACnB;aACF,CAAA;SACF,CAAA;KACF;;;;;IAKM,uCAAM,GAAb,UAAc,QAAwC;QACpD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC7C,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;KAClD;IACM,wCAAO,GAAd;QACE,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;SACrD;KAEF;;;;;IAKM,qCAAI,GAAX,UAAY,OAA0B;QACpC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO;SACR;QACD,IAAI,GAAG,GAAW,MAAM,CAAC;QACzB,IAAI,OAAO,CAAC,MAAM,EAAE;YAClB,GAAG,GAAG,OAAO,CAAC,MAAgB,IAAI,MAAM,CAAC;YACzC,OAAO,OAAO,CAAC,MAAM,CAAC;SACvB;QACD,IAAI,GAAG,EAAE;YACP,GAAG,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;SAC/B;KACF;;gBA/CF,UAAU;;;;IAgDX,6BAAC;CAhDD;;ACCA;;;;AAIA;IAGE,yBAAoB,QAAkB,EAAS,sBAA8C;QAAzE,aAAQ,GAAR,QAAQ,CAAU;QAAS,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC3F,IAAI,CAAC,SAAS,GAAG,IAAI,GAAG,EAAe,CAAC;KACzC;IACM,+BAAK,GAAZ;QAAA,iBAcC;QAbC,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE;YAChC,OAAO;SACR;QACD,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAC,OAA0B;YAC5D,IAAI,CAAC,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,SAAS,CAAC,IAAI,GAAG,CAAC,EAAE;gBAC9C,OAAO;aACR;YACD,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAa,EAAE,GAAW;gBAChD,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;oBAClC,QAAQ,CAAC,OAAO,CAAC,CAAC;iBACnB;aACF,CAAC,CAAA;SACH,CAAC,CAAC;KACJ;IACM,0CAAgB,GAAvB,UAAwB,QAAuC;QAC7D,IAAM,EAAE,GAAM,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAG,CAAC;QACpF,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QACjC,OAAO,EAAE,CAAC;KACX;IACM,6CAAmB,GAA1B,UAA2B,OAAe;QACxC,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,CAAC,EAAE;YAC9C,OAAO;SACR;QACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC/B,OAAO,GAAG,IAAI,CAAC;KAChB;;gBAhCF,UAAU;;;;gBARU,QAAQ;gBAEpB,sBAAsB;;IAuC/B,sBAAC;CAjCD;;;ICIE,gCAAoB,QAAkB,EAAU,YAA0B,EAAU,sBAA8C,EAAU,eAAgC;QAAxJ,aAAQ,GAAR,QAAQ,CAAU;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAAU,2BAAsB,GAAtB,sBAAsB,CAAwB;QAAU,oBAAe,GAAf,eAAe,CAAiB;KAE3K;IACM,gDAAe,GAAtB,UAAuB,YAA0B;QAAjD,iBAcC;QAbC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9E,IAAM,yBAAyB,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC;QAClE,IAAI,yBAAyB,EAAE;YAC7B,yBAAyB,CAAC,SAAS,CAAC;gBAClC,KAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;aACnD,CAAC,CAAC;SACJ;QACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,aAAa,CAAC;QAC3E,IAAI,uBAAuB,EAAE;YAC3B,uBAAuB,CAAC,SAAS,CAAC;gBAChC,KAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,OAAO,EAAE,CAAC;aACvD,CAAC,CAAC;SACJ;KACF;IACM,uCAAM,GAAb,UAAc,OAA0B;QAAxC,iBAqCC;QApCC,IAAM,MAAM,GAAG,OAAO,CAAC,MAAgB,CAAC;QACxC,IAAM,IAAI,GAAG,OAAO,CAAC,IAA6B,CAAC;QACnD,IAAM,WAAW,GAAG,IAAI,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC;QACjD,IAAI,UAAU,GAAoB,IAAI,CAAC;QACvC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACD,IAAI,WAAW,IAAI,0BAA0B,EAAE;;;YAG7C,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;YACtD,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC,IAAI,CACvC,SAAS,CAAC,UAAC,YAA0B;gBACnC,IAAI,UAAU,GAAG,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;gBACvF,IAAI,UAAU,EAAE;oBACd,OAAO,UAAU,CAAC,WAAW,EAAE,CAAC;iBACjC;gBACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB,CAAC,CACH,CAAC;SACH;aAAM;YACL,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YACvD,IAAI,OAAO,EAAE;gBACX,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACtC;SACF;QACD,IAAI,UAAU,EAAE;YACd,IAAM,SAAO,GAAsB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YACnF,UAAU,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC,SAAS,CAAC,UAAC,MAAM;;gBAE/C,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,SAAO,CAAC,CAAC;aAC3C,EAAE;gBACD,SAAO,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBAC5B,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,SAAO,CAAC,CAAC;aAC3C,CAAC,CAAC;SACJ;KACF;IACO,6CAAY,GAApB,UAAqB,MAAe,EAAE,MAAW,EAAE,WAAoB,EAAE,IAAwB;QAAxB,qBAAA,EAAA,gBAAwB;QAC/F,IAAM,OAAO,GAAsB;YACjC,IAAI,EAAE;gBACJ,MAAM,QAAA;gBACN,WAAW,aAAA;aACZ;YACD,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,MAAM;SACf,CAAC;QACF,OAAO,OAAO,CAAC;KAChB;IACO,qDAAoB,GAA5B;QACE,IAAM,iBAAiB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;QACxF,IAAM,iBAAiB,GAAG,EAAE,CAAC;QAC7B,IAAI,iBAAiB,EAAE;YACrB,IAAM,WAAW,GAAiB,iBAAiB,CAAC,cAAc,EAAE,CAAC;YACrE,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzC,WAAW,CAAC,OAAO,CAAC,UAAC,UAAsB;oBACzC,IAAM,aAAa,GAAmB,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;oBACxF,aAAa,CAAC,MAAM,CAAC,UAAC,QAAwB,EAAE,YAA0B;wBACxE,IAAM,SAAS,GAAG,YAAY,CAAC,SAAS,CAAC;wBACzC,IAAM,KAAK,GAAG,QAAQ,CAAC,SAAS,CAAC,UAAC,KAAmB,IAAK,OAAA,KAAK,CAAC,SAAS,KAAK,SAAS,GAAA,CAAC,CAAC;wBACzF,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;4BAChB,IAAM,IAAI,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;4BACvD,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;yBACrB;wBACD,OAAO,QAAQ,CAAC;qBACjB,EAAE,iBAAiB,CAAC,CAAC;iBACvB,CAAC,CAAC;aACJ;SACF;QACD,OAAO,iBAAiB,CAAC;KAC1B;IAID,sBAAY,6CAAS;;;;aAArB;YACE,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,UAAgC,CAAC;YACzE,OAAO,iBAAiB,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;SAC3D;;;OAAA;;gBAjGF,UAAU;;;;gBAVU,QAAQ;gBACW,YAAY;gBAO3C,sBAAsB;gBADtB,eAAe;;IAqGxB,6BAAC;CAlGD;;ACgBA;;;AAGA,IAAM,uCAAuC,GAAG;IAC9C,kBAAkB;IAClB,kBAAkB;IAClB,iBAAiB;IACjB,gBAAgB;IAChB,iBAAiB;IACjB,YAAY;IACZ,gBAAgB;IAChB,YAAY;IACZ,uBAAuB;IACvB,aAAa;IACb,iBAAiB;IACjB,eAAe;IACf,YAAY;IACZ,gBAAgB;IAChB,kBAAkB;IAClB,uBAAuB;IACvB,sBAAsB;IACtB,iBAAiB;IACjB,aAAa;IACb,uBAAuB;IACvB,sBAAsB;IACtB,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IAC7D,sBAAsB;IACtB,eAAe;CAChB;;ACtDD;;;AAGA,AAAA,IAAY,WAiBX;AAjBD,WAAY,WAAW;IACnB,+CAAS,CAAA;IACT,qDAAY,CAAA;IACZ,mDAAW,CAAA;IACX,iEAAkB,CAAA;IAClB,6CAAQ,CAAA;IACR,2DAAe,CAAA;IACf,6CAAQ,CAAA;IACR,+DAAiB,CAAA;IACjB,2DAAe,CAAA;IACf,mDAAW,CAAA;IACX,sEAAqB,CAAA;IACrB,kEAAmB,CAAA;IACnB,0CAAO,CAAA;IACP,gDAAU,CAAA;IACV,0CAAO,CAAA;IACP,gDAAU,CAAA;CACb,EAjBW,WAAW,KAAX,WAAW,QAiBtB;;ACpBD,IAAY,SAWX;AAXD,WAAY,SAAS;;;;IAKjB,2CAAS,CAAA;;;;IAKT,+CAAW,CAAA;CACd,EAXW,SAAS,KAAT,SAAS,QAWpB;;ACXD,IAAY,YAeX;AAfD,WAAY,YAAY;IAEpB,iDAAS,CAAA;;;;;IAMT,6CAAO,CAAA;;;;;IAMP,2CAAM,CAAA;CACT,EAfW,YAAY,KAAZ,YAAY,QAevB;;ACTD;IAAA;KAWC;IAVC,6BAAO,GAAP,UAAQ,EAAkB;QACxB,IAAM,EAAE,GAAI,EAAE,CAAC,KAAmB,CAAC;QACnC,OAAO,CAAC;gBACN,aAAa,EAAE,EAAE,CAAC,SAAS;gBAC3B,SAAS,EAAE,WAAW,CAAC,IAAI;gBAC3B,OAAO,EAAE,EAAE,CAAC,KAAK;gBACjB,UAAU,EAAE,YAAY,CAAC,GAAG;gBAC5B,aAAa,EAAE,SAAS,CAAC,KAAK;aAC/B,CAAC,CAAC;KACJ;IACH,kBAAC;CAAA,IAAA;;ACXD;IAAA;KAqBC;IApBG,kCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,IAAM,GAAG,GAAI,EAAE,CAAC,KAAwB,CAAC;QACzC,GAAG,CAAC,SAAS,IAAI,GAAG,CAAC,IAAI,CAAC;YACtB,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,cAAc;YACtC,OAAO,EAAG,GAAG,CAAC,SAAS;YACvB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QACH,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,IAAI,CAAC;YACpB,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,WAAW;YACnC,OAAO,EAAG,GAAG,CAAC,OAAO;YACrB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QAEH,OAAO,GAAG,CAAC;KACd;IACL,uBAAC;CAAA,IAAA;;ACrBD;IAAA;KAkBC;IAjBG,iCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAI,EAAE,CAAC,KAA2B,CAAC;QAC5C,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,UAAA,EAAE;YAChB,GAAG,CAAC,IAAI,CAAC;gBACL,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,EAAE,CAAC,KAAK;gBAClB,UAAU,EAAG,YAAY,CAAC,EAAE;gBAC5B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;SACN,CAAC,CAAC;QACH,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;QACzB,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;QACrC,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC;QAClD,OAAO,GAAG,CAAC;KACd;IACL,sBAAC;CAAA,IAAA;;AClBD;IAAA;KAqBC;IApBG,oCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,IAAM,GAAG,GAAI,EAAE,CAAC,KAA0B,CAAC;QAC3C,CAAC,GAAG,CAAC,UAAU,IAAI,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC;YACjC,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,cAAc;YACtC,OAAO,EAAG,GAAG,CAAC,UAAU;YACxB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QACH,CAAC,GAAG,CAAC,QAAQ,IAAI,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC;YAC/B,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,WAAW;YACnC,OAAO,EAAG,GAAG,CAAC,QAAQ;YACtB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QAEH,OAAO,GAAG,CAAC;KACd;IACL,yBAAC;CAAA,IAAA;;ACrBD;IAAA;KAmCC;IAlCG,kCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAI,EAAE,CAAC,KAAwB,CAAC;QACzC,IAAG,GAAG,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC;YAAE,OAAO,EAAE,CAAC;QAEpC,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,IAAG,GAAG,CAAC,WAAW,IAAI,GAAG,CAAC,UAAU,IAAI,IAAI,EAAC;YACzC,GAAG,CAAC,IAAI,CAAC;gBACL,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,IAAI;gBAC5B,OAAO,EAAG,GAAG,CAAC,SAAS;gBACvB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;YACH,OAAO,GAAG,CAAC;SACd;aAAI;YACD,GAAG,CAAC,gBAAgB,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,EAAE;gBACxC,EAAE,IAAI,GAAG,CAAC,IAAI,CAAC;oBACX,aAAa,EAAG,EAAE,CAAC,SAAS;oBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;oBAC7B,OAAO,EAAG,EAAE;oBACZ,UAAU,EAAG,YAAY,CAAC,EAAE;oBAC5B,aAAa,EAAC,SAAS,CAAC,KAAK;iBAChC,CAAC,CAAC;aACN,CAAC,CAAC;YACH,IAAG,GAAG,CAAC,MAAM,GAAG,CAAC,EAAC;gBACd,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACzB,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACrC,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC;gBAClD,OAAO,GAAG,CAAC;aACd;iBAAI;gBACD,OAAO,EAAE,CAAC;aACb;SACJ;KACJ;IACL,uBAAC;CAAA,IAAA;;ACnCD;IAAA;KAWC;IAVG,mCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,EAAE,GAAI,EAAE,CAAC,KAAyB,CAAC;QACzC,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,EAAE,CAAC,SAAS;gBACtB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,wBAAC;CAAA,IAAA;;ACXD;IAAA;KA0BC;IAzBG,iCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,IAAM,EAAE,GAAI,EAAE,CAAC,KAAuB,CAAC;QACvC,IAAG,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC;YACnB,OAAO,CAAC;oBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;oBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;oBAC7B,OAAO,EAAG,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;oBACrB,UAAU,EAAG,YAAY,CAAC,GAAG;oBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;iBAChC,CAAC,CAAC;QACP,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,UAAA,GAAG;YAChB,GAAG,CAAC,IAAI,CAAC;gBACL,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,GAAG;gBACb,UAAU,EAAG,YAAY,CAAC,EAAE;gBAC5B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;SACN,CAAC,CAAC;QACH,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;QACzB,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;QACrC,GAAG,CAAC,GAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC;QAClD,OAAO,GAAG,CAAC;KACd;IACL,sBAAC;CAAA,IAAA;;AC1BD;IAAA;KAWC;IAVG,oCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,EAAE,GAAI,EAAE,CAAC,KAA0B,CAAC;QAC1C,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,EAAE,CAAC,UAAU;gBACvB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,yBAAC;CAAA,IAAA;;ACXD;IAAA;KAqBC;IApBG,mCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAG,EAAE,CAAC;QACf,IAAM,GAAG,GAAI,EAAE,CAAC,KAAyB,CAAC;QAC1C,GAAG,CAAC,SAAS,IAAI,GAAG,CAAC,IAAI,CAAC;YACtB,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,cAAc;YACtC,OAAO,EAAG,GAAG,CAAC,SAAS;YACvB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QACH,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,IAAI,CAAC;YACpB,aAAa,EAAG,EAAE,CAAC,SAAS;YAC5B,SAAS,EAAG,WAAW,CAAC,WAAW;YACnC,OAAO,EAAG,GAAG,CAAC,OAAO;YACrB,UAAU,EAAG,YAAY,CAAC,GAAG;YAC7B,aAAa,EAAE,SAAS,CAAC,KAAK;SACjC,CAAC,CAAC;QAEH,OAAO,GAAG,CAAC;KACd;IACL,wBAAC;CAAA,IAAA;;ACrBD;IAAA;KAWC;IAVG,uCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAI,EAAE,CAAC,KAA6B,CAAC;QAC9C,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,GAAG,CAAC,aAAa;gBAC3B,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,4BAAC;CAAA,IAAA;;ACXD;IAAA;KAWC;IAVG,qCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAI,EAAE,CAAC,KAA2B,CAAC;QAC5C,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,GAAG,CAAC,QAAQ;gBACtB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,0BAAC;CAAA,IAAA;;ACXD;IAAA;KAWC;IAVG,mCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,GAAG,GAAI,EAAE,CAAC,KAAyB,CAAC;QAC1C,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,GAAG,CAAC,SAAS;gBACvB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,wBAAC;CAAA,IAAA;;ACXD;IAAA;KA0BC;IAzBG,oCAAO,GAAP,UAAQ,EAAkB;QACtB,IAAM,IAAI,GAAI,EAAE,CAAC,KAA0B,CAAC;QAC5C,IAAG,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAC;YAC1C,OAAO,EAAE,CAAC;SACb;aAAI;YACD,IAAM,KAAG,GAAG,EAAE,CAAC;YACf,IAAI,CAAC,gBAAgB,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,EAAE;gBACzC,EAAE,IAAI,KAAG,CAAC,IAAI,CAAC;oBACX,aAAa,EAAG,EAAE,CAAC,SAAS;oBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;oBAC7B,OAAO,EAAG,EAAE;oBACZ,UAAU,EAAG,YAAY,CAAC,EAAE;oBAC5B,aAAa,EAAC,SAAS,CAAC,KAAK;iBAChC,CAAC,CAAC;aACN,CAAC,CAAC;YACH,IAAG,KAAG,CAAC,MAAM,GAAG,CAAC,EAAC;gBACd,KAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACzB,KAAG,CAAC,KAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACrC,KAAG,CAAC,KAAG,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC;gBAClD,OAAO,KAAG,CAAC;aACd;iBAAI;gBACD,OAAO,EAAE,CAAC;aACb;SACJ;KACJ;IACL,yBAAC;CAAA,IAAA;;AC1BD;IAAA;KAYC;IAXG,8BAAO,GAAP,UAAQ,EAAkB;QAEtB,IAAM,EAAE,GAAI,EAAE,CAAC,KAAoB,CAAC;QACpC,OAAO,CAAC;gBACJ,aAAa,EAAG,EAAE,CAAC,SAAS;gBAC5B,SAAS,EAAG,WAAW,CAAC,KAAK;gBAC7B,OAAO,EAAG,EAAE,CAAC,KAAK;gBAClB,UAAU,EAAG,YAAY,CAAC,GAAG;gBAC7B,aAAa,EAAC,SAAS,CAAC,KAAK;aAChC,CAAC,CAAC;KACN;IACL,mBAAC;CAAA,IAAA;;ACZD;IAAA;KAmCC;IAlCC,mCAAO,GAAP,UAAQ,EAAkB;QACxB,IAAM,GAAG,GAAI,EAAE,CAAC,KAAyB,CAAC;QAC1C,IAAM,GAAG,GAAG,EAAE,CAAC;QAEf,IAAI,GAAG,CAAC,WAAW,IAAI,GAAG,CAAC,SAAS,IAAI,IAAI,EAAE;YAC5C,GAAG,CAAC,IAAI,CAAC;gBACP,aAAa,EAAE,EAAE,CAAC,SAAS;gBAC3B,SAAS,EAAE,WAAW,CAAC,IAAI;gBAC3B,OAAO,EAAE,GAAG,CAAC,SAAS;gBACtB,UAAU,EAAE,YAAY,CAAC,GAAG;gBAC5B,aAAa,EAAE,SAAS,CAAC,KAAK;aAC/B,CAAC,CAAC;YACH,OAAO,GAAG,CAAC;SACZ;aACI;YACH,GAAG,CAAC,gBAAgB,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,SAAS;gBACjD,SAAS,IAAI,GAAG,CAAC,IAAI,CAAC;oBACpB,aAAa,EAAE,EAAE,CAAC,SAAS;oBAC3B,SAAS,EAAE,WAAW,CAAC,KAAK;oBAC5B,OAAO,EAAE,SAAS;oBAClB,UAAU,EAAE,YAAY,CAAC,EAAE;oBAC3B,aAAa,EAAE,SAAS,CAAC,KAAK;iBAC/B,CAAC,CAAC;aACJ,CAAC,CAAC;YACH,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClB,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACzB,GAAG,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;gBACtC,GAAG,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC;gBACnD,OAAO,GAAG,CAAC;aACZ;iBAAM;gBACL,OAAO,EAAE,CAAC;aACX;SACF;KACF;IACH,wBAAC;CAAA,IAAA;;ACvBD;IAII;QADQ,iCAA4B,GAA6C,IAAI,GAAG,EAAuC,CAAC;QAE5H,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,WAAW,EAAE,CAAC,CAAC;QAC3E,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,iBAAiB,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,gBAAgB,EAAE,CAAC,CAAC;QACrF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,gBAAgB,EAAE,CAAC,CAAC;QACzF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,YAAY,EAAE,IAAI,eAAe,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,kBAAkB,EAAE,CAAC,CAAC;QACzF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,gBAAgB,EAAE,CAAC,CAAC;QACrF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,iBAAiB,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,eAAe,EAAE,CAAC,CAAC;QACpF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,kBAAkB,EAAE,CAAC,CAAC;QACzF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,iBAAiB,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,cAAc,EAAE,IAAI,qBAAqB,EAAE,CAAC,CAAC;QAC/F,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,YAAY,EAAE,IAAI,mBAAmB,EAAE,CAAC,CAAC;QAC3F,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,iBAAiB,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,kBAAkB,EAAE,CAAC,CAAC;QACzF,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,YAAY,EAAE,CAAC,CAAC;KAChF;IACa,wCAAW,GAAzB;QACI,IAAG,CAAC,4BAA4B,CAAC,SAAS,EAAC;YACvC,4BAA4B,CAAC,SAAS,GAAG,IAAI,4BAA4B,EAAE,CAAC;SAC/E;QACD,OAAO,4BAA4B,CAAC,SAAS,CAAC;KACjD;IAED,iDAAU,GAAV,UAAW,WAAwB;QAC/B,OAAO,IAAI,CAAC,4BAA4B,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;KAC7D;IA7Bc,sCAAS,GAAiC,IAAI,CAAC;IA8BlE,mCAAC;CAhCD,IAgCC;;;ICvCC,8BACU,YAA0B,EAC1B,uBAAgD;QADhD,iBAAY,GAAZ,YAAY,CAAc;QAC1B,4BAAuB,GAAvB,uBAAuB,CAAyB;KAGzD;IAED,+CAAgB,GAAhB;QACE,OAAO,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,EAAE,CAAC;KACxD;IAEM,kDAAmB,GAA1B,UAA2B,MAA6B;QACtD,IAAI,qBAA6C,CAAC;QAClD,IAAM,mBAAmB,GAAG,EAAE,CAAC;QAC/B,MAAM,CAAC,OAAO,CAAC,UAAA,EAAE;YACf,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE;gBACvB,qBAAqB,GAAG,4BAA4B,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC,CAAC;gBAC3G,qBAAqB,IAAI,mBAAmB,CAAC,IAAI,OAAxB,mBAAmB,WAAS,qBAAqB,CAAC,OAAO,CAAC,EAAE,CAAC,EAAC,CAAC;aACzF;SACF,CAAC,CAAC;;QAEH,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,qBAAqB,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;;QAEvF,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,6BAA6B,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;KAChG;IAEM,wDAAyB,GAAhC,UAAiC,UAA4B;QAC3D,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,wBAAwB,CAAC,GAAG,UAAU,CAAC;KAClE;;gBA/BF,UAAU;;;;gBAJF,YAAY;gBAEZ,uBAAuB;;IAuDhC,2BAAC;CArDD;;ACHA;;;AAGA;IAEE,wBAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;KAC7C;;;;IAIM,gCAAO,GAAd;QACE,IAAM,UAAU,GAAe,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;QAC1F,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAClB,GAAG,CAAC;YACF,IAAI,UAAU,EAAE;gBACd,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;aAClD;SACF,CAAC;;QAEF,KAAK,CAAC,CAAC,CAAC,CACT,CAAC;KACH;;gBAlBF,UAAU;;;;gBAPU,YAAY;;IA0BjC,qBAAC;CAnBD;;;ICDE,8BAAoB,SAAoB;QAApB,cAAS,GAAT,SAAS,CAAW;KAAK;;;;;;IAMtC,sCAAO,GAAd,UAAe,UAAkB,EAAE,OAAY;QAC7C,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAgC,IAAI,IAAI,CAAC;QACxF,IAAI,UAAU,EAAE;YACd,IAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;YAC/B,IAAI,KAAK,IAAI,OAAO,KAAK,CAAC,UAAU,CAAC,KAAK,UAAU,EAAE;gBACpD,OAAO,KAAK,CAAC,UAAU,CAAC,CAAC,OAAO,CAAoB,CAAC;aACtD;SACF;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;gBAjBF,UAAU;;;;gBAJF,SAAS;;IAsBlB,2BAAC;CAlBD;;ACOA;;;;AAIA;IAIE,0BACU,QAAkB,EAClB,uBAAgD,EAChD,SAAoB,EACpB,UAA2B,EAC3B,sBAA8C,EAC9C,WAAkC,EAClC,eAAgC,EAChC,iBAAoC;QAR9C,iBAsBC;QArBS,aAAQ,GAAR,QAAQ,CAAU;QAClB,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,cAAS,GAAT,SAAS,CAAW;QACpB,eAAU,GAAV,UAAU,CAAiB;QAC3B,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,gBAAW,GAAX,WAAW,CAAuB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QAChC,sBAAiB,GAAjB,iBAAiB,CAAmB;QAE5C,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAqB,kBAAkB,EAAE,IAAI,CAAC,CAAC;QAC1F,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,WAAW,EAAE,CAAC;SACtD;QACD,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAC3B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAoB,iBAAiB,EAAE,IAAI,CAAC,CAAC;SACxF;QACD,IAAI,CAAC,WAAW,GAAG,IAAI,OAAO,EAAO,CAAC;QACtC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAA,MAAM;YACzB,IAAA,iBAA0D,EAAxD,eAAY,EAAZ,iCAAY,EAAE,iBAAc,EAAd,mCAAc,EAAE,YAAS,EAAT,8BAA0B,CAAC;YACjE,KAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;SACnD,CAAC,CAAC;KACJ;;;;;IAMM,8CAAmB,GAA1B,UAA2B,OAAe;QAA1C,iBAsCC;QArCC,IAAI,CAAC,OAAO,EAAE;YACZ,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;SACzC;QACD,IAAI,IAAI,CAAC,sBAAsB,EAAE;YAC/B,IAAI,OAAO,GAAG,EAAE,CAAC;YACjB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAM,gBAAgB,GAAiB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBACpI,IAAM,aAAa,GAAG,gBAAgB,CAAC,SAAS,CAAC;gBACjD,IAAI,aAAa,IAAI,aAAa,CAAC,cAAc,CAAC,qBAAqB,CAAC,EAAE;;oBAExE,IAAM,mBAAmB,GAAG,aAAa,CAAC,qBAAqB,CAAC,CAAC;oBACjE,OAAO,GAAG,aAAa,CAAC,mBAAmB,CAAC,CAAC;iBAC9C;qBAAM,IAAI,aAAa,IAAI,aAAa,CAAC,cAAc,CAAC,iBAAiB,CAAC,EAAE;oBAC3E,OAAO,GAAG,aAAa,CAAC,iBAAiB,CAAC,CAAC;iBAC5C;gBACD,IAAM,KAAG,GAAa,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;gBACzD,IAAI,CAAC,KAAG,IAAI,KAAG,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC1B,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;oBAChG,OAAO,KAAK,CAAC;iBACd;gBACD,IAAM,WAAS,GAAQ,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,OAAO,EAAE;oBACpE,IAAI,EAAE,KAAG,CAAC,MAAM;oBAChB,SAAS,EAAE,UAAC,MAAkB;wBAC5B,IAAI,KAAK,CAAC,OAAO,CAAC,KAAG,CAAC,IAAI,KAAG,CAAC,MAAM,GAAG,CAAC,EAAE;;4BAExC,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC;4BAC1D,UAAU,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC;4BAC9C,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;gCAClB,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAG,CAAC,CAAC;6BACpC,CAAC,CAAC;4BACH,UAAU,CAAC,yBAAyB,CAAC,QAAQ,EAAE,CAAC;yBACjD;wBACD,WAAS,CAAC,KAAK,EAAE,CAAC;qBACnB;iBACF,CAAC,CAAC;aACJ;SACF;KACF;;;;;IAKM,yCAAc,GAArB,UAAsB,MAAc;QAClC,IAAI,CAAC,MAAM,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;SACzD;QACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,uBAAuB,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAChF,IAAI,uBAAuB,EAAE;YAC3B,uBAAuB,CAAC,UAAU,EAAE,CAAC;SACtC;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,+BAA6B,MAAM,qBAAkB,CAAC,CAAC;SACxE;KACF;;;;IAIM,8CAAmB,GAA1B;QACE,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,IAAI,IAAI,CAAC;QACxG,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,YAAY,GAAG,EAAE,CAAC;SAC/B;KACF;;;;;;;IAOM,0CAAe,GAAtB,UAAuB,OAAe,EAAE,SAAiB,EAAE,eAAuB;QAChF,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,IAAI,IAAI,CAAC;QACxG,IAAI,CAAC,eAAe,EAAE;YACpB,eAAe,GAAG,IAAI,CAAC;SACxB;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACvC,IAAI,WAAW,EAAE;YACf,OAAO,GAAG,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC;YACzD,IAAI,OAAO,EAAE;gBACX,IAAM,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBACvD,IAAI,YAAY,EAAE;oBAChB,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;oBACvD,IAAI,WAAW,EAAE;wBACf,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBAC3D,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;wBACnF,IAAM,UAAU,GAAG,WAAW,CAAC,WAAW,CAAC;wBAC3C,IAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,CAAC;wBACvC,IAAI,IAAI,EAAE;4BACR,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;4BACpD,WAAW,CAAC,YAAY,GAAG,KAAK,CAAC;yBAClC;qBACF;iBACF;aACF;SACF;KACF;;;;;;;IAOM,sCAAW,GAAlB,UAAmB,OAAe,EAAE,SAAiB;QAArD,iBAwCC;QAvCC,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;QAC7D,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;SAC9C;QACD,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACxD,IAAM,UAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;YAEvC,IAAI,WAAW,GAAG,GAAG,CAAC;YACtB,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;YACnE,IAAI,UAAU,EAAE;gBACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBACjF,IAAI,YAAY,EAAE;oBAChB,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;iBACzD;qBAAM;oBACL,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;iBACxC;aACF;YACD,IAAM,eAAa,GAAG,EAAE,CAAC;YACzB,MAAM,CAAC,OAAO,CAAC,UAAC,IAAI;gBAClB,IAAM,YAAY,GAAG,EAAE,CAAC;gBACxB,MAAM,CAAC,IAAI,CAAC,UAAQ,CAAC,CAAC,OAAO,CAAC,UAAC,IAAY;oBACzC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;oBAC9C,IAAM,MAAM,GAAG,UAAQ,CAAC,IAAI,CAAC,CAAC;oBAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;wBAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBAC9C,KAAI,CAAC,cAAc,CAAC,YAAY,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;qBAC3D,CAAC,CAAC;iBACJ,CAAC,CAAC;gBACH,eAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aAClC,CAAC,CAAC;YACH,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;YAC/B,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,eAAa,CAAC,CAAC,IAAI,CACpD,GAAG,CAAC,cAAM,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,GAAA,CAAC,EACzC,GAAG,CAAC,cAAM,OAAA,IAAI,GAAA,CAAC,CAChB,CAAC;SACH;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;;;IAOM,iEAAsC,GAA7C,UAA8C,OAAe,EAAE,SAAiB;QAAhF,iBAyCC;QAxCC,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;QAC7D,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;SAC9C;QACD,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACxD,IAAM,UAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;YAEvC,IAAI,WAAW,GAAG,GAAG,CAAC;YACtB,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;YACnE,IAAI,UAAU,EAAE;gBACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBACjF,IAAI,YAAY,EAAE;oBAChB,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;iBACzD;qBAAM;oBACL,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;iBACxC;aACF;YACD,IAAM,eAAa,GAAG,EAAE,CAAC;YACzB,MAAM,CAAC,OAAO,CAAC,UAAC,IAAI;gBAClB,IAAM,YAAY,GAAG,EAAE,CAAC;gBACxB,MAAM,CAAC,IAAI,CAAC,UAAQ,CAAC,CAAC,OAAO,CAAC,UAAC,IAAY;oBACzC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;oBAC9C,IAAM,MAAM,GAAG,UAAQ,CAAC,IAAI,CAAC,CAAC;oBAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;wBAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBAC9C,KAAI,CAAC,cAAc,CAAC,YAAY,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;qBAC3D,CAAC,CAAC;iBACJ,CAAC,CAAC;gBACH,eAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aAClC,CAAC,CAAC;YACH,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;YAC/B,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACpF,OAAO,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,EAAE,eAAa,CAAC,CAAC,IAAI,CAChE,GAAG,CAAC,cAAM,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,GAAA,CAAC,EACzC,GAAG,CAAC,cAAM,OAAA,IAAI,GAAA,CAAC,CAChB,CAAC;SACH;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;;;IAOM,8DAAmC,GAA1C,UAA2C,OAAe,EAAE,SAAiB;QAA7E,iBA8FC;QA7FC,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAI,MAAM,GAAU,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;QAClE,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACvC,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;YAC/C,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,OAAO,GAAG,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC;QACzD,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,IAAM,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QACvD,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,UAAU,CAAC;YACT,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC;gBACnC,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;oBACxD,IAAM,aAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;oBAC9D,IAAM,cAAY,GAAG,aAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oBAC3D,IAAM,eAAa,GAAG,EAAE,CAAC;;oBAEzB,IAAM,aAAW,GAAgB,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAY,CAAgB,CAAC;oBAChG,IAAM,UAAU,GAAG,aAAW,CAAC,WAAW,CAAC;oBAC3C,IAAM,YAAY,GAAG,aAAW,CAAC,SAAS,CAAC;oBAC3C,IAAM,aAAa,GAAG,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,cAAY,EAAE,YAAY,CAAC,CAAC;oBACrF,IAAM,QAAQ,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;;oBAE3B,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;wBACvB,KAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE,aAAW,CAAC,CAAC;wBAChE,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;qBACjB;yBAAM;wBACL,IAAM,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;wBAClC,IAAM,cAAY,GAAG,KAAI,CAAC,cAAc,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;;wBAEpE,IAAI,CAAC,cAAY,IAAI,MAAM,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,aAAW,CAAC,UAAU,CAAC,KAAK,cAAY,GAAA,CAAC,KAAK,CAAC,CAAC,EAAE;;4BAEnG,KAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE,aAAW,CAAC,CAAC;4BAChE,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;yBAC1B;6BAAM,IAAI,cAAY,EAAE;4BACvB,IAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,aAAW,CAAC,UAAU,CAAC,KAAK,cAAY,GAAA,CAAC,CAAC;;4BAEtF,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,aAAa,EAAE,aAAW,CAAC,CAAC;4BACrE,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;yBACzB;;;wBAGD,IAAM,WAAS,GAAG,aAAW,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,UAAA,aAAa;4BAC1D,IAAM,EAAE,GAAG,KAAI,CAAC,cAAc,CAAC,aAAa,EAAE,QAAQ,CAAC,aAAW,CAAC,UAAU,CAAC,CAAC,CAAC;4BAChF,OAAO,CAAC,EAAE,CAAC;yBACZ,CAAC,CAAC;wBACH,IAAI,WAAS,IAAI,WAAS,CAAC,MAAM,GAAG,CAAC,EAAE;4BACrC,IAAI,IAAI,GAAG,MAAM,CAAC;4BAClB,IAAI,MAAM,CAAC,MAAM,GAAG,WAAS,CAAC,MAAM,EAAE;gCACpC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,WAAS,CAAC,MAAM,CAAC,CAAC;gCACzC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,WAAS,CAAC,MAAM,CAAC,CAAC;6BACzC;iCAAM;gCACL,MAAM,GAAG,EAAE,CAAC;6BACb;4BACD,IAAI,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;gCACvB,IAAM,UAAU,GAAG,WAAS,CAAC,KAAK,CAAC,CAAC;gCACpC,IAAM,MAAM,GAAG,KAAI,CAAC,eAAe,CAAC,YAAY,EAAE,cAAY,EAAE,UAAU,CAAC,eAAe,CAAC,CAAC;gCAC5F,KAAI,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,aAAW,CAAC,CAAC;6BACtD,CAAC,CAAC;yBACJ;;wBAED,MAAM,CAAC,OAAO,CAAC,UAAC,IAAI;4BAClB,IAAM,YAAY,GAAG,EAAE,CAAC;4BACxB,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAC,IAAY;gCACzC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;gCAC9C,IAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;gCAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gCACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;oCAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;oCAC9C,KAAI,CAAC,cAAc,CAAC,YAAY,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;iCAC3D,CAAC,CAAC;6BACJ,CAAC,CAAC;4BACH,eAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;yBAClC,CAAC,CAAC;wBACH,IAAI,eAAa,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC5B,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;4BAC/B,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,aAAW,EAAE,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;4BACpF,KAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,EAAE,eAAa,CAAC,CAAC,IAAI,CACzD,GAAG,CAAC,cAAM,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,GAAA,CAAC,CAC1C,CAAC,SAAS,EAAE,CAAC;yBACf;qBACF;iBACF;aACF,CAAC,CAAC;SACJ,EAAE,GAAG,CAAC,CAAC;QACR,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;;;;IAQM,+BAAI,GAAX,UAAY,EAAU;QAAtB,iBA6BC;QA5BC,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,CAAC;SACd;QAED,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,OAAO,GAAG,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC;QAClD,IAAM,GAAG,GAAM,OAAO,iCAA8B,CAAC;QACrD,IAAM,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;QACjE,IAAM,IAAI,GAAG;YACX,WAAW,aAAA;YACX,MAAM,EAAE,EAAE;SACX,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;QAC/B,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAChE,GAAG,CAAC;YACF,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;SAChC,CAAC,EACF,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;YAC7C,IAAM,MAAM,GAAG,KAAI,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;YACxD,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YACnD,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;;;;IAOM,gCAAK,GAAZ,UAAa,EAAU,EAAE,IAAY;QAArC,iBA6CC;QA5CC,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAC5F,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,IAAI,EAAE;YACT,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YACzF,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;YACzB,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC;SACnB;QACD,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QAC1B,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QAC/C,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,OAAO,GAAG,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC;QAClD,IAAM,GAAG,GAAG,KAAG,OAAO,GAAG,IAAM,CAAC;QAChC,IAAM,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;QACjE,IAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QACvC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACb,IAAM,IAAI,GAAG;YACX,WAAW,aAAA;YACX,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC;SACtB,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;QAC/B,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAChE,GAAG,CAAC;YACF,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;SAChC,CAAC,EACF,GAAG,CAAC,UAAC,YAA0B;YAC7B,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;YAC7C,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;gBACtD,MAAM,GAAG,KAAI,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBAClD,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;aAC1D;iBAAM;gBACL,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBACrF,MAAM,GAAG,aAAa,CAAC,aAAa,CAAC,kBAAkB,CAAC,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC;aAChG;YACD,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;;;;;IAUM,kCAAO,GAAd,UAAe,OAAe,EAAE,YAAoB,EAAE,MAAkB;QAAxE,iBAgEC;QAhEqD,uBAAA,EAAA,UAAkB;QACtE,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;SAC/B;QACD,IAAI,MAAM,GAAG,CAAC,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;;QAED,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QAC7G,IAAM,YAAY,GAAG,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAC7D,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;QAC9D,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,IAAI,WAAW,GAAkB,IAAI,CAAC;QACtC,IAAI,WAAW,KAAK,GAAG,EAAE;;YAEvB,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC;SACzD;aAAM;;YAEL,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YACpD,WAAW,GAAI,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAiB,CAAC,WAAW,CAAC;SACrF;QACD,WAAW,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE;YAChC,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;aAC7F;YACD,OAAO,KAAK,CAAC;SACd;QACD,IAAM,iBAAiB,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;QAEvE,IAAM,OAAO,GAAG,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;QAClC,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CACvB,SAAS,CAAC;YACR,IAAI,OAAO,GAAG,IAAI,CAAC;YACnB,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvB,IAAM,QAAQ,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;gBAC3D,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;aAClD;iBAAM;gBACL,OAAO,GAAG,KAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;aACpC;YACD,OAAO,OAAO,CAAC,IAAI,CACjB,GAAG,CAAC,UAAC,MAAc;;gBAEjB,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC,YAAY,CAAC;;gBAErD,iBAAiB,CAAC,OAAO,CAAC,UAAC,KAAa;oBACtC,IAAM,eAAe,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;oBAC9D,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;wBAChC,OAAO,WAAW,CAAC,KAAK,CAAC,CAAC;qBAC3B;oBACD,IAAM,MAAM,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,OAAO,EAAE,KAAK;wBACtE,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC;qBACtB,EAAE,WAAW,CAAC,CAAC;oBAChB,OAAO,MAAM,CAAC,eAAe,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;iBAC5D,CAAC,CAAC;gBACH,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,MAAM,EAAE,EAAE,WAAW,CAAC,CAAC;gBAC9D,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;aAChD,CAAC,EACF,UAAU,CAAC;gBACT,OAAO,KAAK,CAAC;aACd,CAAC,CACH,CAAC;SACH,CAAC,CACH,CAAC;KACH;;;;;;;IAOM,0DAA+B,GAAtC,UAAuC,OAAe,EAAE,SAAiB,EAAE,eAAuB;QAAlG,iBAoGC;QAnGC,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;;;QAG7D,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC;SACrD;QACD,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;SAC9C;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACvC,IAAM,UAAU,GAAG,eAAe,CAAC;;QAEnC,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC;;QAE1D,IAAI,WAAW,GAAG,GAAG,CAAC;QACtB,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACjF,IAAI,YAAY,EAAE;gBAChB,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;aACzD;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;aACxC;SACF;;QAED,gBAAgB,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC;QAChD,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;;YAEnC,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;YACjE,IAAM,aAAW,GAAgB,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;YACnF,IAAM,kBAAgB,GAAG,aAAW,CAAC,OAAO,EAAE,CAAC;;YAE/C,IAAM,OAAO,GAAG,EAAE,CAAC;YACnB,MAAM,CAAC,MAAM,CAAC,UAAC,IAAgB,EAAE,IAAI;gBACnC,IAAM,MAAM,GAAG,IAAI,IAAI,IAAI,CAAC,aAAW,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC;gBAC5D,IAAM,OAAO,GAAG,kBAAgB,CAAC,IAAI,CAAC,UAAC,aAA4B,IAAK,OAAA,aAAa,CAAC,UAAU,CAAC,CAAC,UAAU,CAAC,KAAK,MAAM,GAAA,CAAC,CAAC;gBAC1H,IAAI,CAAC,OAAO,EAAE;oBACZ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACjB;gBACD,OAAO,IAAI,CAAC;aACb,EAAE,OAAO,CAAC,CAAC;;YAGZ,IAAM,OAAO,GAAG,EAAE,CAAC;YACnB,kBAAgB,CAAC,MAAM,CAAC,UAAC,OAAY,EAAE,IAAmB;gBACxD,IAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,CAAC,aAAW,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,CAAC,UAAU,CAAC,GAAA,CAAC,CAAC;gBAClH,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;oBAChB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;iBACpC;gBACD,OAAO,OAAO,CAAC;aAChB,EAAE,OAAO,CAAC,CAAC;;;YAIZ,IAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CACnC,SAAS,CAAC,UAAA,IAAI;gBACZ,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBACpF,OAAO,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,IAAI,CAC5C,GAAG,CAAC,UAAC,MAAc;oBACjB,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;wBAChC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;wBAC9C,IAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;wBAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;wBACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;4BAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;4BAC9C,KAAI,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;yBACrD,CAAC,CAAC;qBACJ,CAAC,CAAC;iBACJ,CAAC,EACF,UAAU,CAAC;oBACT,OAAO,KAAK,CAAC;iBACd,CAAC,CACH,CAAC;aACH,CAAC,CACH,CAAC;YAEF,IAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CACtC,SAAS,CAAC,UAAA,IAAI;gBACZ,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBACpF,OAAO,KAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,IAAI,CAClD,GAAG,CAAC;oBACF,IAAM,aAAa,GAAuB,KAAI,CAAC,UAAgC,CAAC;oBAChF,aAAa,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;iBAC5D,CAAC,EACF,UAAU,CAAC;oBACT,OAAO,KAAK,CAAC;iBACd,CAAC,CACH,CAAC;aACH,CAAC,CACH,CAAC;YACF,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC1F,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,OAAO,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC,IAAI,CAC3C,UAAU,CAAC,cAAM,OAAA,KAAK,GAAA,CAAC,CACxB,CAAC;SACH;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;IAKM,oDAAyB,GAAhC;QACE,OAAO,IAAI,CAAC,mBAAmB,EAAE,CAAC;KACnC;;;;;;;;;IASM,oDAAyB,GAAhC,UAAiC,OAAe,EAAE,SAAiB,EAAE,cAAuB,EAAE,WAAoB;QAChH,IAAM,IAAI,GAAQ,IAAI,CAAC;QACvB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC;QAC7D,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;;YAEnC,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBAChC,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,OAAO,SAAA,EAAE,SAAS,WAAA,EAAE,IAAI,EAAE,MAAM,EAAE,cAAc,gBAAA,EAAE,WAAW,aAAA,EAAE,CAAC,CAAC;YACzF,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;SACjB;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;;;;;;;IAOO,6CAAkB,GAA1B,UAA2B,OAAe,EAAE,SAAiB,EAAE,MAAa;QAA5E,iBAiGC;QAhGC,IAAI,CAAC,SAAS,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;SAC9C;QACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;QAEvC,IAAI,WAAW,GAAG,GAAG,CAAC;QACtB,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACjF,IAAI,YAAY,EAAE;gBAChB,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;aACzD;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;aACxC;SACF;;QAED,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC;QAC1D,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAE3D,gBAAgB,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC;QAChD,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YACnC,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAClC,SAAS,CAAC,UAAA,IAAI;gBACZ,IAAM,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;gBACjE,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,IAAM,MAAI,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACpF,OAAO,aAAa,CAAC,WAAW,CAAC,YAAY,CAAC,MAAI,EAAE,WAAW,CAAC,CAAC,IAAI,CACnE,GAAG,CAAC,UAAC,YAA0B;wBAC7B,IAAM,IAAI,GAAG,YAAY,CAAC,WAAW,CAAC;wBACtC,IAAM,SAAS,GAAG,aAAa,CAAC,aAAa,CAAC,kBAAkB,CAAC,MAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;wBACnF,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;4BAChC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;4BAC9C,IAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;4BAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;4BACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;gCAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gCAC9C,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;6BACxD,CAAC,CAAC;yBACJ,CAAC,CAAC;wBACH,OAAO,SAAS,CAAC;qBAClB,CAAC,CACH,CAAC;iBACH;qBAAM;oBACL,OAAO,aAAa,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,IAAI,CAC7D,GAAG,CAAC,UAAC,YAA0B;wBAC7B,IAAM,IAAI,GAAG,YAAY,CAAC,WAAW,CAAC;wBACtC,IAAM,SAAS,GAAG,KAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;wBACpD,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;4BAChC,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;4BAC9C,IAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;4BAC9B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;4BACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;gCAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gCAC9C,KAAI,CAAC,cAAc,CAAC,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;6BACxD,CAAC,CAAC;yBACJ,CAAC,CAAC;wBACH,KAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;wBACtD,OAAO,SAAS,CAAC;qBAClB,CAAC,CACH,CAAC;iBACH;aACF,CAAC,CACH,CAAC;;YAEF,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC,CAAC;gBACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;gBAC/B,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;aAC1C;YACD,OAAO,UAAU,CAAC,IAAI,CACpB,IAAI,EAAE,CACP,CAAC,IAAI,CACJ,SAAS,CAAC;gBACR,IAAM,YAAY,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;gBAC/D,IAAI,YAAY,EAAE;oBAChB,OAAO,aAAa,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;iBACtD;qBAAM;oBACL,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF,CAAC,CACH,CAAC,SAAS,CAAC;gBACV,IAAI,KAAI,CAAC,kBAAkB,EAAE;oBAC3B,KAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;oBACtC,KAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;oBAC1C,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;iBAChC;aACF,EAAE;gBACD,IAAI,KAAI,CAAC,kBAAkB,EAAE;oBAC3B,KAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;oBACtC,KAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;oBAC1C,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB;IACO,mDAAwB,GAAhC,UAAiC,OAAe;QAC9C,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACjF,YAAY,CAAC,OAAO,GAAG,IAAI,CAAC;SAC7B;KACF;IACO,kDAAuB,GAA/B,UAAgC,OAAe;QAC7C,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAM,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACjF,YAAY,CAAC,OAAO,GAAG,KAAK,CAAC;YAC7B,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACtD;KACF;;IAGO,yCAAc,GAAtB,UAAuB,MAAc,EAAE,IAAY,EAAE,KAAU;QAC7D,IAAI,MAAM,EAAE;YACV,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9B,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;gBACrB,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;aACtB;iBAAM;gBACL,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;oBACnC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;wBAC1E,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;qBACjB;oBACD,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;iBACnB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;aAC7C;SACF;KACF;IACO,yCAAc,GAAtB,UAAuB,MAAc,EAAE,IAAY;QACjD,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC9B,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACpB,OAAO;SACR;QACD,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;YACtB,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;SACrB;QACD,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;YACxB,IAAI,KAAK,KAAK,CAAC,EAAE;gBACf,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;aACzC;iBAAM;gBACL,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;aACzC;SACF,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;KACf;;;;;;IAMO,oCAAS,GAAjB,UAAkB,WAAmB,EAAE,EAAO;QAC5C,IAAI,IAAI,GAAG,GAAG,GAAG,EAAE,CAAC;QACpB,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;;;YAGvB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBACxD,IAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAChC,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACpD,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBAClC,MAAM,KAAK,CAAC,yFAAiB,OAAO,2GAAmB,CAAC,CAAC;iBAC1D;gBACD,IAAI,IAAI,MAAI,OAAO,SAAI,OAAO,CAAC,SAAW,CAAC;aAC5C;SACF;QACD,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;KACb;;;;;;IAMO,mCAAQ,GAAhB,UAAiB,WAAmB;QAApC,iBAkBC;QAjBC,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAC3D,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAC/D,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,IAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;;YAE1B,YAAY,CAAC,GAAG,EAAE,CAAC;YACnB,YAAY,CAAC,OAAO,CAAC,UAAC,IAAY;gBAChC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACjB,IAAM,WAAW,GAAG,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAgB,CAAC;gBAC9E,IAAI,WAAW,EAAE;oBACf,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;iBACpC;aACF,CAAC,CAAC;SACJ;QACD,OAAO,MAAM,CAAC;KACf;IACO,4CAAiB,GAAzB,UAA0B,KAAU,EAAE,GAAe;QAC7C,IAAA,gBAAiF,EAA/E,mBAAkB,EAAlB,uCAAkB,EAAE,aAAY,EAAZ,iCAAY,EAAE,eAAY,EAAZ,iCAAY,EAAE,gBAAe,CAAiB;QACxF,IAAI,WAAW,EAAE;;YAEf,IAAI,WAAW,KAAK,QAAQ,IAAI,WAAW,KAAK,cAAc,EAAE;gBAC9D,IAAM,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;gBACpC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;aAC/C;iBAAM;gBACL,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;aAC3C;SACF;KACF;IACO,4CAAiB,GAAzB,UAA0B,GAAe,EAAE,KAAU,EAAE,MAAW;QAAlE,iBAoBC;QAnBC,IAAI,CAAC,MAAM,EAAE;YACX,OAAO;SACR;QACD,IAAM,iBAAiB,GAAG,MAAM,CAAC,QAAQ,CAAC;;QAE1C,IAAI,MAAM,GAAG,KAAK,CAAC;QACnB,IAAI,iBAAiB,KAAK,MAAM,EAAE;YAChC,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;YAC7D,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,GAAG,qBAAqB,CAAC;aACjC;YACD,MAAM,GAAG,OAAO,CAAC;SAClB;aAAM,IAAI,iBAAiB,KAAK,QAAQ,EAAE;YACzC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAC7B;QACD,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;QAC3B,GAAG,CAAC,OAAO,CAAC,UAAA,EAAE;YACZ,KAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;SAC3C,CAAC,CAAC;KACJ;IACO,4CAAiB,GAAzB,UAA0B,GAAe,EAAE,QAAa,EAAE,SAAc;QAAxE,iBAyBC;QAxBC,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QACD,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACxC,IAAM,OAAO,GAAG,UAAU,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,KAAK,IAAI,GAAA,CAAC,CAAC;QAC5D,IAAI,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,OAAO,KAAK,CAAC,EAAE;YAC9C,UAAU,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;YAC9B,UAAU,aAAI,IAAI,GAAK,UAAU,CAAC,CAAC;SACpC;QACD,UAAU,CAAC,OAAO,CAAC,UAAC,SAAc;YAChC,IAAI,SAAS,GAAQ,EAAE,CAAC;YACxB,IAAI,QAAQ,EAAE;gBACZ,IAAI,QAAQ,YAAY,KAAK,EAAE;oBAC7B,SAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,IAAS;wBACjC,OAAO,KAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;qBACvC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACd;qBAAM;oBACL,SAAS,GAAG,KAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;iBAChD;aACF;YACD,GAAG,CAAC,OAAO,CAAC,UAAA,EAAE;gBACZ,KAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,SAAS,CAAC,SAAS,CAAC,EAAE,SAAS,CAAC,CAAC;aAC7D,CAAC,CAAC;SACJ,CAAC,CAAC;KACJ;IACO,4CAAiB,GAAzB,UAA0B,YAAiB,EAAE,YAAoB,EAAE,KAAU;QAC3E,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC;QACzC,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE;YAC/B,OAAO;SACR;;QAED,IAAM,aAAa,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;QACnE,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAE9D,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;YAC5B,aAAa,CAAC,QAAQ,CAAC,YAAY,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACzD;aAAM;YACL,IAAI,qBAAmB,GAAG,IAAI,CAAC;YAC/B,IAAM,MAAM,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAChE,IAAM,kBAAkB,GAAG,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACnE,MAAM,CAAC,OAAO,CAAC,UAAA,IAAI;gBACjB,qBAAmB,GAAG,qBAAmB,IAAI,qBAAmB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC;aAC/F,CAAC,CAAC;;YAEH,qBAAmB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;SACrE;KACF;IACO,8CAAmB,GAA3B;QACE,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QACxC,IAAI,IAAI,EAAE;YACR,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;SAC9C;QACD,OAAO,EAAE,CAAC;KACX;IACO,mCAAQ,GAAhB,UAAiB,CAAS,EAAE,IAAS;QACnC,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;YACzB,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;SACf;aAAM;YACL,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;gBAC7B,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;aACb,EAAE,IAAI,CAAC,CAAC;SACV;QAED,OAAO,GAAG,CAAC;KACZ;IACD,sBAAc,yCAAW;aAAzB;;YAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;gBACrE,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;aACxC;;YAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;YAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;gBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;aACpB,CAAC,CAAC;YACH,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;SAC3D;;;OAAA;;;;;;;IAOO,qCAAU,GAAlB,UAAmB,IAAS,EAAE,SAAc,EAAE,MAAc,EAAE,WAAmB;QAAjF,iBAUC;QATC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,IAAY;YAC1C,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YAC9C,IAAM,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;YAC/B,IAAM,MAAM,GAAU,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YACvD,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;gBAClB,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gBAC9C,KAAI,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;aACrD,CAAC,CAAC;SACJ,CAAC,CAAC;KACJ;;;;;;IAMO,8CAAmB,GAA3B,UAA4B,OAAe;QACzC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,IAAI,CAAC;SACb;QACD,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,YAAY,GAAiB,IAAI,CAAC;QACtC,IAAI,UAAU,EAAE;YACd,YAAY,GAAG,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;SAC5E;QACD,OAAO,YAAY,CAAC;KACrB;IACO,0CAAe,GAAvB,UAAwB,YAA0B,EAAE,YAAmB,EAAE,SAAiB;QACxF,YAAY,YAAO,YAAY,CAAC,CAAC;QACjC,IAAM,EAAE,GAAG,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACnD,IAAM,MAAM,GAAW,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,EAAE,CAAW,CAAC;QAC5F,IAAI,IAAI,GAAW,MAAM,CAAC;QAC1B,IAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAM,QAAQ,GAAG,YAAY,CAAC,GAAG,EAAE,CAAC;QACpC,IAAM,MAAM,GAAG,YAAY,CAAC,MAAM,CAAC,UAAC,MAAc,EAAE,IAAY;YAC9D,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACjB,IAAI,MAAM,KAAK,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;gBACvF,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;gBAC3B,IAAI,KAAK,IAAI,KAAK,YAAY,UAAU,EAAE;oBACxC,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAgB,CAAC;oBAC5E,IAAM,aAAa,GAAG,WAAW,CAAC,SAAS,CAAC;oBAC5C,OAAO,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;iBACjC;qBAAM;oBACL,OAAO,KAAK,CAAC;iBACd;aACF;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF,EAAE,IAAI,CAAC,CAAC;QACT,IAAI,MAAM,YAAY,MAAM,EAAE;YAC5B,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAoB,CAAC;YACjD,IAAI,IAAI,EAAE;gBACR,OAAO,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;aAC5B;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,gCAAiB,CAAC,CAAC;aACpC;SACF;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,gCAAiB,CAAC,CAAC;SACpC;KACF;IACO,kCAAO,GAAf,UAAgB,YAA0B;QACxC,IAAM,UAAU,GAAe,YAAY,IAAI,YAAY,CAAC,iBAAiB,EAAE,CAAC;QAChF,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAClB,GAAG,CAAC;YACF,IAAI,UAAU,EAAE;gBACd,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;aAClD;SACF,CAAC;;QAEF,KAAK,CAAC,CAAC,CAAC,CACT,CAAC;KACH;;gBAz/BF,UAAU;;;;gBAhBU,QAAQ;gBAOpB,uBAAuB;gBANV,SAAS;gBAAiB,UAAU;gBAIjD,sBAAsB;gBACtB,qBAAqB;gBAGrB,eAAe;gBACf,iBAAiB;;IAggC1B,uBAAC;CA1/BD;;ACTA;AACA;IAcE,gCAAoB,QAAkB,EAAU,YAA0B,EAAU,cAAkC,EAAU,uBAAgD;QAA5J,aAAQ,GAAR,QAAQ,CAAU;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAAU,mBAAc,GAAd,cAAc,CAAoB;QAAU,4BAAuB,GAAvB,uBAAuB,CAAyB;KAC/K;IAVD,sBAAY,8CAAU;;;;aAAtB;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,UAAmC,CAAC;SAC9D;;;OAAA;IAID,sBAAY,0CAAM;;;;aAAlB;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;SAC/D;;;OAAA;IAIM,2CAAU,GAAjB,UAAkB,EAAW,EAAE,OAAgB,EAAE,QAAiB,EAAE,IAAa,EAAE,UAAmB,EAAE,QAAiB;QAAzH,iBAqBC;QApBC,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC;QACrF,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,KAAK,CAAC;SACd;QACD,IAAM,MAAM,GAAG,IAAI,CAAC,oBAAoB,CAAC,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;QAC5F,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,GAAG,GAAG,gDAAgD,CAAC;QAC7D,IAAM,WAAW,GAAG,WAAW,CAAC,gBAAgB,EAAE,CAAC;QACnD,IAAM,OAAO,GAAG;YACd,IAAI,aACF,WAAW,aAAA,IACR,MAAM,CACV;SACF,CAAC;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CACxD,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;;IAKM,8CAAa,GAApB,UAAqB,EAAU,EAAE,QAAgB,EAAE,SAAyB,EAAE,QAAwB;QAAtG,iBAeC;QAdC,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC;QACrF,IAAI,CAAC,EAAE,EAAE;YACP,OAAO,KAAK,CAAC;SACd;QAED,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAEhD,IAAM,GAAG,GAAG,IAAI,CAAC,qBAAqB,CAAC,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC1E,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,IAAI,CACxC,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;IAIM,6CAAY,GAAnB;QAAA,iBASC;QARC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,GAAG,GAAG,mDAAmD,CAAC;QAChE,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,IAAI,CACxC,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;;;IAMM,qDAAoB,GAA3B,UAA4B,SAAyB,EAAE,QAAwB;QAA/E,iBASC;QARC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,GAAG,GAAG,IAAI,CAAC,4BAA4B,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QACnE,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,IAAI,CACxC,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;;;;IAOM,6CAAY,GAAnB,UAAoB,IAAa,EAAE,SAAyB,EAAE,QAAwB;QAAtF,iBASC;QARC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QAChD,IAAM,GAAG,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;QACjE,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,IAAI,CACxC,GAAG,CAAC;YACF,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;SAC5B,CAAC,CACH,CAAC;KACH;;;;;IAKO,sDAAqB,GAA7B,UAA8B,EAAU,EAAE,SAAwB,EAAE,QAAuB,EAAE,QAAgB;QAC3G,IAAI,OAAO,SAAS,KAAK,WAAW,IAAI,SAAS,KAAK,IAAI,EAAE;YAC1D,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,CAAC;SACxC;QACD,IAAI,OAAO,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK,IAAI,EAAE;YACxD,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,EAAE,CAAC;SACvC;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;;QAE5C,OAAO,oEAAkE,QAAQ,gBAAW,EAAE,kBAAa,QAAQ,mBAAc,SAAW,CAAC;KAC9I;;;;IAIO,qDAAoB,GAA5B,UAA6B,IAAa,EAAE,SAAyB,EAAE,QAAwB;QAC7F,IAAM,MAAM,GAAa,EAAE,CAAC;QAC5B,IAAI,OAAO,SAAS,KAAK,WAAW,IAAI,SAAS,KAAK,IAAI,EAAE;YAC1D,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,CAAC;SACxC;QACD,IAAI,OAAO,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK,IAAI,EAAE;YACxD,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,IAAI,CAAC;SACzC;QACD,IAAI,IAAI,EAAE;YACR,MAAM,CAAC,IAAI,CAAC,WAAS,IAAM,CAAC,CAAC;SAC9B;QACD,MAAM,CAAC,IAAI,CAAC,cAAY,QAAU,CAAC,CAAC;QACpC,MAAM,CAAC,IAAI,CAAC,eAAa,SAAW,CAAC,CAAC;QACtC,OAAO,mDAAiD,MAAM,CAAC,IAAI,CAAC,GAAG,CAAG,CAAC;KAC5E;IACO,6DAA4B,GAApC,UAAqC,SAAyB,EAAE,QAAwB;QACtF,IAAM,MAAM,GAAa,EAAE,CAAC;QAC5B,IAAI,OAAO,SAAS,KAAK,WAAW,IAAI,SAAS,KAAK,IAAI,EAAE;YAC1D,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,CAAC;SACxC;QACD,IAAI,OAAO,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK,IAAI,EAAE;YACxD,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,CAAC,CAAC;SACtC;QACD,MAAM,CAAC,IAAI,CAAC,cAAY,QAAU,CAAC,CAAC;QACpC,MAAM,CAAC,IAAI,CAAC,eAAa,SAAW,CAAC,CAAC;QACtC,OAAO,4DAA0D,MAAM,CAAC,IAAI,CAAC,GAAG,CAAG,CAAC;KACrF;IACO,qDAAoB,GAA5B,UAA6B,EAAU,EAAE,IAAY,EAAE,QAAgB,EAAE,OAAe,EAAE,UAAkB,EAAE,QAAgB;QAC5H,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAC/B,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;SACzB;QACD,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE;YACnC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;SACjC;QACD,IAAI,OAAO,UAAU,KAAK,WAAW,EAAE;YACrC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC;SACrC;QACD,OAAO;YACL,MAAM,EAAE;gBACN,QAAQ,EAAE,EAAE;gBACZ,UAAU,EAAE,QAAQ;gBACpB,SAAS,EAAE,OAAO;aACnB;YACD,SAAS,EAAE;gBACT,QAAQ,EAAE,EAAE;gBACZ,UAAU,EAAE,QAAQ;gBACpB,UAAU,EAAE,QAAQ,IAAI,IAAI;gBAC5B,MAAM,EAAE,IAAI;gBACZ,YAAY,EAAE,UAAU;aACzB;SACF,CAAA;KACF;;gBA5KF,UAAU;;;;gBARU,QAAQ;gBACpB,YAAY;gBAEZ,kBAAkB;gBAClB,uBAAuB;;IAiLhC,6BAAC;CA7KD;;;ICDI,qCAAoB,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;KAAK;IAE5C,gEAA0B,GAAjC,UAAkC,UAA4B;QAC1D,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,yBAAyB,CAAC,GAAG,UAAU,CAAC;KACrE;;gBAPJ,UAAU;;;;gBAHF,YAAY;;IAYrB,kCAAC;CATD;;;ICKE,6BACU,QAAkB,EACO,UAAU,EACnC,UAAsB;QAFtB,aAAQ,GAAR,QAAQ,CAAU;QACO,eAAU,GAAV,UAAU,CAAA;QACnC,eAAU,GAAV,UAAU,CAAY;KAC3B;IACE,kCAAI,GAAX;QACE,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YAClC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC5E;QACD,IAAM,gBAAgB,GAAM,IAAI,CAAC,UAAU,gDAA2C,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAI,CAAC;QACxH,IAAM,QAAQ,GAAG,mBAAmB,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACpE,IAAI,QAAQ,EAAE;YACZ,OAAO,QAAQ,CAAC;SACjB;aAAM;YACL,IAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAe,gBAAgB,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;YACzG,mBAAmB,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;YACzD,OAAO,IAAI,CAAC;SACb;KACF;IAnBc,6BAAS,GAAG,IAAI,GAAG,EAAoC,CAAC;;gBAFxE,UAAU;;;;gBALkB,QAAQ;gDAUhC,MAAM,SAAC,eAAe;gBAXlB,UAAU;;IA4BnB,0BAAC;CAtBD;;;ICGE,uCACU,QAAkB,EAClB,YAA0B,EAC1B,UAAsB,EACG,UAAU,EACE,mBAAyC;QAJ9E,aAAQ,GAAR,QAAQ,CAAU;QAClB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,eAAU,GAAV,UAAU,CAAY;QACG,eAAU,GAAV,UAAU,CAAA;QACE,wBAAmB,GAAnB,mBAAmB,CAAsB;KAAK;IAEtF,4CAAI,GAAX;QAAA,iBAyBC;QAxBC,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YAClC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC5E;QAED,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC,IAAI,CACzC,SAAS,CAAC,UAAC,YAA0B;YACnC,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;YAC7C,IAAM,kBAAkB,GAAG,WAAW,CAAC,IAAI,CAAC,UAAC,kBAA2C,IAAK,OAAA,kBAAkB,CAAC,EAAE,KAAK,KAAI,CAAC,YAAY,CAAC,SAAS,GAAA,CAAC,CAAC;YACpJ,IAAI,kBAAkB,EAAE;gBACtB,IAAM,cAAc,GAAM,KAAI,CAAC,UAAU,qBAAgB,kBAAkB,CAAC,IAAI,iBAAY,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAI,CAAC;gBAC9H,IAAM,GAAG,GAAM,KAAI,CAAC,UAAU,qBAAgB,kBAAkB,CAAC,IAAM,CAAC;gBACxE,IAAM,QAAQ,GAAG,6BAA6B,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBAClE,IAAI,QAAQ,EAAE;oBACZ,OAAO,QAAQ,CAAC;iBACjB;qBAAM;oBACL,IAAM,IAAI,GAAG,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,cAAc,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;oBACzF,6BAA6B,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;oBACvD,OAAO,IAAI,CAAC;iBACb;aACF;iBAAM;gBACL,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;aACf;SACF,CAAC,CACH,CAAC;KACH;IAjCc,uCAAS,GAAG,IAAI,GAAG,EAA2B,CAAC;;gBAF/D,UAAU;;;;gBALkB,QAAQ;gBAGX,YAAY;gBAJ7B,UAAU;gDAad,MAAM,SAAC,eAAe;gDACtB,MAAM,SAAC,2BAA2B;;IA4BvC,oCAAC;CApCD;;;ICCE,6BAAoB,QAAkB,EAAqC,YAA0B;QAAjF,aAAQ,GAAR,QAAQ,CAAU;QAAqC,iBAAY,GAAZ,YAAY,CAAc;KAAK;IAK1G,sBAAW,wCAAO;;;;aAAlB;YACQ,IAAA,4BAAkE,EAAhE,kBAAiB,EAAjB,sCAAiB,EAAE,kBAAiB,EAAjB,sCAA6C,CAAC;YACzE,IAAI,cAAc,GAAG,IAAI,CAAC;YAC1B,IAAI,UAAU,IAAI,UAAU,EAAE;gBAC5B,cAAc,GAAM,UAAU,SAAI,UAAY,CAAC;aAChD;YACD,IAAM,IAAI,GAAG;gBACX,UAAU,YAAA;gBACV,UAAU,YAAA;gBACV,cAAc,gBAAA;aACf,CAAC;YACI,IAAA,4BAAyI,EAAvI,oBAAmB,EAAnB,wCAAmB,EAAE,2BAA0B,EAA1B,+CAA0B,EAAE,8BAA6B,EAA7B,kDAA6B,EAAE,4BAA2B,EAA3B,gDAAuD,CAAC;YAChJ,IAAM,MAAM,GAAG;gBACb,YAAY,cAAA;gBACZ,mBAAmB,qBAAA;gBACnB,sBAAsB,wBAAA;gBACtB,oBAAoB,sBAAA;aACrB,CAAC;YACF,OAAO,EAAE,IAAI,MAAA,EAAE,MAAM,QAAA,EAAE,CAAC;SACzB;;;OAAA;;;;;;;IAOM,sCAAQ,GAAf,UAAgB,KAAU,EAAE,QAAgB;QAC1C,IAAI,QAAQ,IAAI,KAAK,EAAE;YACrB,QAAQ,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;YAClC,IAAI,QAAQ,KAAK,MAAM,EAAE;gBACvB,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aAClC;iBAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;gBAClC,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;aACtC;iBAAM,IAAI,QAAQ,KAAK,QAAQ,EAAE;gBAChC,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;aACpC;iBAAM;gBACL,OAAO,KAAK,CAAC;aACd;SACF;aAAM;YACL,OAAO,KAAK,CAAC;SACd;KACF;;;;;;IAMM,uCAAS,GAAhB,UAAiB,gBAAwB;QACvC,IAAI,gBAAgB,EAAE;YACpB,gBAAgB,GAAG,gBAAgB,CAAC,WAAW,EAAE,CAAC;SACnD;QACD,IAAI,gBAAgB,KAAK,MAAM,EAAE;YAC/B,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC;SACrC;aAAM,IAAI,gBAAgB,KAAK,UAAU,EAAE;YAC1C,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC;SACzC;aAAM;YACL,OAAO,EAAE,CAAC;SACX;KACF;;;;;IAKO,2CAAa,GAArB,UAAsB,KAAU;QAC9B,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC;QACnF,IAAI,CAAC,UAAU,IAAI,CAAC,KAAK,EAAE;YACzB,OAAO,KAAK,CAAC;SACd;QACD,IAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;QAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC/B,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,KAAK,CAAC;SACd;QACD,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QAC9C,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;KAChC;;;;;;IAMO,+CAAiB,GAAzB,UAA0B,KAAU;QAClC,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC;QACnF,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,UAAU,CAAC;QACjF,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,EAAE;YAC9B,OAAO,KAAK,CAAC;SACd;QACD,IAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;QAC/B,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC;QACnC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,KAAK,CAAC;SACd;QACD,IAAI,UAAU,EAAE;YACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;SAC/C;QACD,IAAI,UAAU,EAAE;YACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;SAC/C;QACD,IAAM,cAAc,GAAG,UAAU,GAAG,GAAG,GAAG,UAAU,CAAC;QACrD,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;KACxC;;;;;IAKO,6CAAe,GAAvB,UAAwB,KAAK;QAC3B,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,EAAE,EAAE;YACzD,OAAO,EAAE,CAAC;SACX;QACD,IAAM,SAAS,GAAG,IAAI,SAAS,CAAC,KAAK,CAAC,CAAC;;QAEvC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE;YACrC,OAAO,KAAK,CAAC;SACd;QACD,IAAM,UAAU,GAAG,SAAS,CAAC,UAAU,EAAE,CAAC;QAC1C,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAClC,IAAA,4BAA6E,EAA3E,oBAAmB,EAAnB,wCAAmB,EAAE,2BAA0B,EAA1B,+CAAsD,CAAC;QACpF,IAAI,UAAU,EAAE;YACd,IAAI,YAAY,KAAK,IAAI,EAAE;gBACzB,MAAM,CAAC,MAAM,GAAG,YAAY,CAAC;gBAC7B,OAAO,SAAS,CAAC,aAAa,EAAE,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;aAC9E;SACF;QACD,OAAO,SAAS,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KAC9D;;;;;IAKO,6CAAe,GAAvB,UAAwB,MAAc;QACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;KACrD;;;;;IAKO,6CAAe,GAAvB,UAAwB,MAAc;QACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;KAClC;;;;IAIO,+CAAiB,GAAzB;QACE,IAAI,IAAI,CAAC,YAAY,EAAE;YACf,IAAA,sBAAkF,EAAhF,8BAA6B,EAA7B,kDAA6B,EAAE,4BAA2B,EAA3B,gDAAiD,CAAC;YACzF,IAAM,MAAM,GAAQ;gBAClB,SAAS,EAAE,CAAC;aACb,CAAC;YACF,IAAI,sBAAsB,KAAK,IAAI,EAAE;gBACnC,MAAM,CAAC,gBAAgB,GAAG,sBAAsB,CAAC;aAClD;YACD,IAAI,oBAAoB,KAAK,IAAI,EAAE;gBACjC,MAAM,CAAC,cAAc,GAAG,oBAAoB,CAAC;aAC9C;YACD,OAAO,MAAM,CAAC;SACf;KACF;IACD,sBAAY,6CAAY;aAAxB;YACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,IAAI,IAAI,CAAC;SACpE;;;OAAA;;gBAtKF,UAAU;;;;gBALkB,QAAQ;gDAOM,MAAM,SAAC,iBAAiB;;IAqKnE,0BAAC;CAvKD;;;ICHA;KAQC;IAHC,sBAAW,+BAAU;;;;aAArB;YACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC;SACxD;;;OAAA;IACH,cAAC;CAAA;;;ICJoCR,mCAAO;IAD5C;;KAoIC;;;;;IA9HQ,qCAAW,GAAlB;;;;;QAKE,IAAM,cAAc,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAChE,IAAI,cAAc,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/C,cAAc,CAAC,OAAO,CAAC,UAAC,aAAgC;gBACtD,IAAI,eAAe,GAAG,IAAI,CAAC;gBAC3B,IAAI,aAAa,CAAC,cAAc,CAAC,gCAAgC,CAAC,EAAE;oBAClE,eAAe,GAAG,aAAa,CAAC,gCAAgC,CAAC,CAAC;iBACnE;gBACD,IAAI,eAAe,EAAE;oBACnB,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBACnC;aACF,CAAC,CAAC;SACJ;;;KAGF;;;;;;;IAOM,4CAAkB,GAAzB,UAA0B,GAAQ;QAChC,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;YAC3B,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC3B,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;aACrC;iBAAM;gBACL,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;aACb;SACF;QACD,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1B,OAAO;SACR;;QAED,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;QAC/C,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO;SACR;QACD,IAAM,UAAU,GAAG,YAAY,CAAC,UAAU,CAAC;QAC3C,IAAM,EAAE,GAAG,YAAY,CAAC,SAAS,CAAC;QAClC,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;QACjF,IAAI,CAAC,UAAU,EAAE;YACf,OAAO;SACR;;QAED,IAAM,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;QACrF,IAAM,iCAAiC,GAAG,aAAa,CAAC,MAAM,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,KAAK,WAAW,GAAA,CAAC,CAAC;;QAE7K,IAAM,kBAAkB,GAAG,IAAI,CAAC,+BAA+B,CAAC,iCAAiC,CAAC,CAAC;QACnG,IAAI,CAAC,kBAAkB,EAAE;YACvB,OAAO;SACR;;QAED,IAAM,IAAI,GAAsB,kBAAkB,CAAC,GAAG,EAAE,CAAC;;QAEzD,IAAG,IAAI,EAAC;YACN,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;SAC7B;;QAED,IAAM,qBAAqB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,SAAS,CAAC,WAAW,KAAK,WAAW,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,WAAW,CAAC,GAAA,CAAC,CAAC;QACrL,IAAM,sBAAsB,GAAG,IAAI,CAAC,+BAA+B,CAAC,qBAAqB,CAAC,CAAC;;QAE3F,IAAI,sBAAsB,IAAI,sBAAsB,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/D,sBAAsB,CAAC,OAAO,CAAC,UAAC,aAAgC;;gBAE9D,aAAa,CAAC,WAAW,GAAG,EAAE,CAAC;aAChC,CAAC,CAAC;SACJ;KACF;;;;;;IAMM,qCAAW,GAAlB,UAAmB,GAAQ;QACzB,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;YAC3B,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;SACb;QACD,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1B,OAAO;SACR;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAChE,IAAI,cAAc,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/C,cAAc,CAAC,OAAO,CAAC,UAAC,aAAgC;gBACtD,aAAa,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;aACtC,CAAC,CAAC;SACJ;KACF;;;;;;IAMO,+CAAqB,GAA7B,UAA8B,cAA8B;QAC1D,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,IAAM,YAAY,GAAG,cAAc,IAAI,cAAc,CAAC,YAAY,CAAC;QACnE,IAAM,UAAU,GAAG,YAAY,IAAI,YAAY,CAAC,UAAU,IAAI,IAAI,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAM,aAAa,GAAkC,UAAU,CAAC,aAAa,CAAC;YAC9E,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,CAAC;YACnD,OAAO,CAAC,OAAO,CAAC,UAAC,IAAsB;gBACrC,IAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;gBAE7C,IAAM,cAAc,GAAG,UAAU,CAAC,MAAM,CAAC,UAAC,SAAc,IAAK,OAAA,SAAS,YAAY,iBAAiB,GAAA,CAAC,CAAC;gBACrG,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;aACtC,CAAC,CAAC;SACJ;QACD,OAAO,KAAK,CAAC;KACd;IACO,yDAA+B,GAAvC,UAAwC,aAA6B;QACnE,OAAO,aAAa,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,YAAY;YAC/C,IAAM,UAAU,GAAG,YAAY,CAAC,UAAU,CAAC;YAC3C,IAAM,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC;;YAErC,IAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YAC5D,IAAM,KAAK,GAAG,aAAa,IAAI,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,UAAA,SAAS,IAAI,OAAA,SAAS,YAAY,iBAAiB,GAAA,CAAC,CAAC;YAC9H,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7B,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;aAC/B;YACD,OAAO,MAAM,CAAC;SACf,EAAE,EAAE,CAAC,CAAC;KACR;;gBAnIF,UAAU;;IAoIX,sBAAC;CAAA,CAnIoC,OAAO;;;ICE1C,8BAAoB,QAAkB,EAAU,YAA0B,EAAU,gBAAkC;QAAlG,aAAQ,GAAR,QAAQ,CAAU;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAAU,qBAAgB,GAAhB,gBAAgB,CAAkB;KAAK;;;;;;;IAOpH,oCAAK,GAAZ,UAAa,GAAsB,EAAE,QAAc;QACjD,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;YAC3B,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;SACrC;QACD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YACzC,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;YAChC,QAAQ,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC;SAC5B;QACD,IAAI,CAAC,QAAQ,EAAE;YACb,QAAQ,GAAG,GAAG,CAAC;SAChB;QACD,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC9B,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,QAAQ,IAAI,CAAC,EAAE;YACpC,QAAQ,GAAG,GAAG,CAAC;SAChB;QACD,IAAM,QAAQ,GAAuB,GAAG,CAAC,GAAG,CAAC,UAAC,IAAY;YACxD,OAAO;gBACL,MAAM,EAAE,IAAI;aAGb,CAAC;SACH,CAAC,CAAC;QACH,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KAC1D;;gBAlCF,UAAU;;;;gBANU,QAAQ;gBACpB,YAAY;gBAEZ,gBAAgB;;IAsCzB,2BAAC;CAnCD;;;ICGE,2BACU,QAAkB,EAClB,UAA2B;QAD3B,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAiB;KAChC;;;;;IAKE,mDAAuB,GAA9B,UAA+B,UAAkB;QAC/C,IAAM,GAAG,GAAG,mEAAmE,CAAC;QAChF,IAAM,IAAI,GAAG;YACX,UAAU,EAAE,UAAU;SACvB,CAAC;QACF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,IAAM,aAAa,GAAuB,IAAI,CAAC,UAAgC,CAAC;QAChF,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC/D;;;;;;;IAOM,uDAA2B,GAAlC,UAAmC,UAAkB,EAAE,QAAgB,EAAE,UAAgC;QAAhC,2BAAA,EAAA,wBAAgC;QACvG,IAAM,GAAG,GAAG,mEAAmE,CAAC;QAChF,IAAM,IAAI,GAAG,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE,QAAQ,UAAA,EAAE,CAAC;QAClE,IAAM,aAAa,GAAuB,IAAI,CAAC,UAAgC,CAAC;QAChF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC/D;;;;;;;;IAQM,yCAAa,GAApB,UAAqB,UAAkB,EAAE,YAAiB,EAAE,UAAgC;QAAhC,2BAAA,EAAA,wBAAgC;QAC1F,IAAM,IAAI,GAAG,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAE,YAAY,cAAA,EAAE,CAAC;QACtE,IAAM,aAAa,GAAuB,IAAI,CAAC,UAAgC,CAAC;QAChF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,mEAAmE,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC/H;;;;;;;;IAQM,uCAAW,GAAlB,UAAmB,MAAc,EAAEK,SAAc,EAAE,MAAW;QAC5D,IAAM,GAAG,GAAG,8DAA8D,CAAC;QAC3E,IAAM,UAAU,GAAQ,EAAE,CAAC;QAC3B,IAAI,MAAM,EAAE;YACV,IAAI,MAAM,CAAC,SAAS,EAAE;gBACpB,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;aAChE;YACD,IAAI,MAAM,CAAC,QAAQ,EAAE;gBACnB,UAAU,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;aAC9D;YACD,IAAI,MAAM,CAAC,SAAS,EAAE;gBACpB,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;aAC5D;YACD,IAAI,MAAM,CAAC,WAAW,EAAE;gBACtB,UAAU,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,WAAW,CAAC;aAC3C;SACF;QACD,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,MAAM;YACd,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;YACtC,SAAS,EAAEA,SAAM;SAClB,CAAC;QACF,IAAM,aAAa,GAAuB,IAAI,CAAC,UAAgC,CAAC;QAChF,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC/D;;gBArFF,UAAU;;;;gBAPU,QAAQ;gBAEpB,UAAU;;IA2FnB,wBAAC;CAtFD;;ICPiB,IAAI,CA+IpB;AA/ID,WAAiB,IAAI;IAwInB,IAAY,SAMX;IAND,WAAY,SAAS;QACnB,0BAAa,CAAA;QACb,8BAAiB,CAAA;QACjB,0BAAa,CAAA;QACb,8BAAiB,CAAA;QACjB,0BAAa,CAAA;KACd,EANW,SAAS,GAAT,cAAS,KAAT,cAAS,QAMpB;CACF,EA/IgB,IAAI,KAAJ,IAAI,QA+IpB;;;ICrIC,4BACU,QAAkB,EAClB,UAA6B,EACE,QAAiB;QAFhD,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAmB;QACE,aAAQ,GAAR,QAAQ,CAAS;QAExD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC;KAC3C;;;;;IAKM,oDAAuB,GAA9B,UAA+B,UAAkB;QAAjD,iBAmCC;QAlCC,OAAO,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,UAAU,CAAC,CAAC,IAAI,CAC7D,GAAG,CAAC,UAAC,QAAsB;YACzB,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;gBACtC,OAAO,IAAI,CAAC;aACb;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YACrD,IAAM,MAAM,GAAsB,EAAE,OAAO,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;YAC7D,IAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,IAAI,IAAI,CAAC;YAC7C,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,IAAI,IAAI,CAAC;YACxC,IAAI,QAAQ,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBACvC,QAAQ,CAAC,GAAG,CAAC,UAAC,OAAsB;oBAClC,OAAO,CAAC,IAAI,GAAG,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;oBAC3C,OAAO,OAAO,CAAC;iBAChB,CAAC,CAAC;gBACH,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC;aAC3B;YACD,IAAI,KAAK,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrD,KAAK,CAAC,GAAG,CAAC,UAAC,IAAgB;;oBAEzB,IAAI,CAAC,IAAI,GAAG,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;;oBAErC,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;wBAC3D,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;qBACvC;;oBAED,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,KAAK,GAAG,GAAG,IAAI,GAAG,KAAK,CAAC;oBACzD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,KAAK,GAAG,GAAG,IAAI,GAAG,KAAK,CAAC;oBACzD,OAAO,IAAI,CAAC;iBACb,CAAC,CAAC;gBACH,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;aACtB;YACD,OAAO,MAAM,CAAC;SACf,CAAC,CACH,CAAC;KACH;;;;;;;IAOM,wDAA2B,GAAlC,UAAmC,UAAkB,EAAE,QAAgB,EAAE,UAAgC;QAAhC,2BAAA,EAAA,wBAAgC;QACvG,OAAO,IAAI,CAAC,UAAU,CAAC,2BAA2B,CAAC,UAAU,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,MAAW;YACxG,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC3B,CAAC,CAAC,CAAC;KACL;;;;;;;;IAQM,0CAAa,GAApB,UAAqB,UAAkB,EAAE,YAAiB,EAAE,UAAgC;QAAhC,2BAAA,EAAA,wBAAgC;QAC1F,OAAO,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,UAAU,EAAE,YAAY,EAAE,UAAU,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,MAAW;YAC9F,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC3B,CAAC,CAAC,CAAC;KACL;;;;;;;;IAQM,wCAAW,GAAlB,UAAmB,MAAc,EAAEA,SAAc,EAAE,MAAW;QAC5D,IAAM,GAAG,GAAG,8DAA8D,CAAC;QAC3E,IAAM,UAAU,GAAQ,EAAE,CAAC;QAC3B,IAAI,MAAM,EAAE;YACV,IAAI,MAAM,CAAC,SAAS,EAAE;gBACpB,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;aAChE;YACD,IAAI,MAAM,CAAC,QAAQ,EAAE;gBACnB,UAAU,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;aAC9D;YACD,IAAI,MAAM,CAAC,SAAS,EAAE;gBACpB,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;aAC5D;YACD,IAAI,MAAM,CAAC,WAAW,EAAE;gBACtB,UAAU,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,WAAW,CAAC;aAC3C;SACF;QACD,IAAM,IAAI,GAAG;YACX,MAAM,EAAE,MAAM;YACd,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;YACtC,SAAS,EAAEA,SAAM;SAClB,CAAC;QACF,IAAM,aAAa,GAAuB,IAAI,CAAC;QAC/C,IAAM,OAAO,GAAG;YACd,IAAI,MAAA;SACL,CAAC;QACF,OAAO,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,IAAI,CAChE,GAAG,CAAC,UAAC,MAAW,IAAK,OAAA,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAA,CAAC,CACzC,CAAC;KACH;;;;;;IAMO,0CAAa,GAArB,UAAsB,MAAkC;QACtD,IAAI,CAAC,MAAM,EAAE;YACX,OAAO,IAAI,CAAC;SACb;QACD,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,QAAQ,IAAI,CAAC,QAAQ;YACnB,KAAK,IAAI;gBAAE;oBACT,IAAI,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;iBAC1B;gBAAC,MAAM;YACR,KAAK,QAAQ;gBAAE;oBACb,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC;iBAC3B;gBAAC,MAAM;YACR,KAAK,QAAQ;gBAAE;oBACb,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC;iBAC3B;gBAAC,MAAM;YACR,SAAS,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC;SACpC;QACD,OAAO,IAAI,CAAC;KACb;;gBApIF,UAAU;;;;gBARkB,QAAQ;gBAK5B,iBAAiB;6CAQrB,QAAQ,YAAI,MAAM,SAAC,SAAS;;IAgIjC,yBAAC;CArID;;;ICGE,4BACU,QAAkB,EAClB,oBAA0C,EAC1C,kBAAsC,EACtC,cAAkC,EAClC,aAAgC,EAChC,eAAgC;QALhC,aAAQ,GAAR,QAAQ,CAAU;QAClB,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,mBAAc,GAAd,cAAc,CAAoB;QAClC,kBAAa,GAAb,aAAa,CAAmB;QAChC,oBAAe,GAAf,eAAe,CAAiB;KACrC;IAEE,iCAAI,GAAX,UAAY,UAAkB,EAAE,iBAA0B,EAAE,OAAa;QAAzE,iBA6BC;QA5BC,IAAI,CAAC,UAAU,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;SAClD;QACD,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,GAAG,EAAE,CAAC;SACd;QACD,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;YACnF,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC/B;QACD,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC;QAC1D,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,OAAO,IAAI,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,UAAU,CAAC,CAAC,IAAI,CACrE,GAAG,CAAC,UAAC,MAAW;YACd,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;YAC3B,IAAM,WAAW,GAAG,MAAM,IAAI,IAAI,CAAC;YACnC,IAAI,WAAW,EAAE;gBACf,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;gBAC5C,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,IAAI,IAAI,CAAC;gBACxC,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC9B,KAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;oBAC9D,OAAO;iBACR;gBACD,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;aAChD;iBAAM;gBACL,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;aAC7D;SACF,CAAC,CACH,CAAC;KACH;IACO,0CAAa,GAArB,UAAsB,UAAkB,EAAE,iBAA0B;QAApE,iBAmBC;QAlBC,IAAM,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,UAAU,CAAC,CAAC;QAC9E,OAAO,SAAS,CAAC,IAAI,CACnB,SAAS,CAAC,UAAA,UAAU;YAClB,IAAI,iBAAiB,EAAE;gBACrB,IAAM,iBAAiB,GAAG,KAAI,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,iBAAiB,EAAE,iBAAiB,CAAC,CAAC;gBACpH,OAAO,iBAAiB,CAAC,IAAI,CAC3B,GAAG,CAAC,UAAA,cAAc;oBAChB,IAAM,eAAe,GAAG,UAAU,CAAC,KAAK,CAAC;oBACzC,IAAM,QAAQ,GAAG,KAAI,CAAC,aAAa,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC;oBACrE,OAAO,QAAQ,CAAC;iBACjB,CAAC,CACH,CAAC;aACH;iBAAM;gBACL,OAAO,EAAE,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;aAC7B;SACF,CAAC,CACH,CAAC;KAEH;IACO,0CAAa,GAArB,UAAsB,eAAoB,EAAE,cAAmB;QAC7D,OAAO,IAAI,CAAC;KACb;;gBA/DF,UAAU;;;;gBATU,QAAQ;gBACpB,oBAAoB;gBAIpB,kBAAkB;gBADlB,kBAAkB;gBAFlB,iBAAiB;gBAIjB,eAAe;;IAmExB,yBAAC;CAhED;;;ICFE,2BAAoB,QAAkB,EAAU,cAA8B,EAAU,YAA0B,EAAU,kBAAsC;QAA9I,aAAQ,GAAR,QAAQ,CAAU;QAAU,mBAAc,GAAd,cAAc,CAAgB;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAAU,uBAAkB,GAAlB,kBAAkB,CAAoB;KAAK;;;;;;;IAOhK,mCAAO,GAAd,UAAe,UAAkB,EAAE,aAAuC;;QACxE,IAAM,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;QACrD,IAAM,iBAAiB,GAAG,cAAc,CAAC,0BAA0B,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QAC7H,IAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;QACvE,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC9C,IAAM,OAAO,yBACV,IAAI,CAAC,sBAAsB,IAAG,aAAa,OACzC,YAAY,IACf,SAAS,WAAA,EACT,YAAY,EAAE,IAAI,CAAC,YAAY,EAC/B,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,EAC1C,UAAU,EAAE,IAAI,CAAC,YAAY,CAAC,UAAU,IACrC,aAAa,CACjB,CAAA;QACD,OAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;KAC1D;;;;;;;IAOM,wCAAY,GAAnB,UAAoB,UAAkB,EAAE,aAAuC;QAC7E,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC;QACvD,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;KACnB;;;;;;;;IAQO,8CAAkB,GAA1B,UAA2B,IAAc,EAAE,iBAA2B,EAAE,OAAiC;QAAzG,iBA6BC;QA5BC,IAAI,kBAAkB,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,OAAO,CAAC,UAAC,GAAW;YACvB,IAAM,kBAAkB,GAAG,KAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC;YACxD,IAAM,iBAAiB,GAAG,iBAAiB,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,KAAK,GAAG,GAAA,CAAC,KAAK,CAAC,CAAC,CAAC;;;YAGnF,IAAI,kBAAkB,EAAE;;gBAEtB,IAAI,iBAAiB,EAAE;oBACrB,IAAM,gBAAgB,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;oBAClE,IAAI,gBAAgB,KAAK,CAAC,EAAE;;wBAE1B,kBAAkB,GAAG,IAAI,CAAC;qBAC3B,AAEA;iBACF,AAEA;aACF;SACF,CAAC,CAAC;QACH,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC9B,IAAI,kBAAkB,EAAE;YACtB,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC;YAC1E,IAAI,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC;YAC1B,IAAI,CAAC,WAAW,CAAC,GAAG,UAAU,CAAC;SAChC;QACD,OAAO,IAAI,CAAC;KACb;;;;;;IAMO,8CAAkB,GAA1B,UAA2B,GAAW;QACpC,OAAO,GAAG,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC;KACxC;;;;;;IAMM,qCAAS,GAAhB;QACE,IAAM,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC;QACnE,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;QAClD,IAAM,mBAAmB,GAAG,EAAE,CAAC;QAC/B,cAAc,CAAC,sBAAsB,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC;QAC3E,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;QACvE,MAAM,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;QAC9B,IAAI,CAAC,mBAAmB,IAAI,mBAAmB,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1D,OAAO,MAAM,CAAC;SACf;;QAED,mBAAmB,CAAC,OAAO,CAAC,UAAC,KAAe;YAC1C,IAAM,GAAG,GAAG,cAAc,CAAC,oBAAoB,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;YACpE,IAAI,GAAG,EAAE;gBACP,IAAM,YAAY,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;gBACjC,IAAI,QAAM,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,MAAW,EAAE,IAAY;oBAClD,OAAO,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;iBACvC,EAAE,MAAM,CAAC,CAAC;gBACX,IAAM,IAAI,cAAK,SAAS,WAAM,QAAM,CAAC,YAAY,CAAC,KAAM,GAAG,IAAE,QAAQ,EAAE,MAAM,GAAE,CAAC;gBAChF,QAAM,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC;aAC7B;SACF,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;KACf;IAID,sBAAc,qDAAsB;;;;aAApC;YACE,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YACjD,OAAO,UAAU,IAAI,UAAU,CAAC,cAAc,IAAI,UAAU,CAAC,cAAc,CAAC,UAAU,IAAI,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,YAAY,IAAI,IAAI,CAAC;SACrJ;;;OAAA;;;;;;IAMM,6CAAiB,GAAxB;QACE,IAAM,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;QACvC,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAa,UAAU,EAAE,IAAI,CAAC,CAAC;QACnE,IAAM,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;QACrF,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7C,IAAM,qBAAqB,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;YAC/C,IAAM,gBAAgB,GAAG,qBAAqB,CAAC,0BAA0B,EAAE,CAAC;YAC5E,IAAI,gBAAgB,EAAE;gBACpB,IAAM,SAAO,GAAG,gBAAgB,CAAC,SAAS,CAAC,OAAO,CAAC;gBACnD,IAAM,aAAa,GAAG,MAAM,CAAC,mBAAmB,CAAC,SAAO,CAAC,IAAI,EAAE,CAAC;gBAChE,aAAa,CAAC,OAAO,CAAC,UAAC,IAAY;oBACjC,IAAI,IAAI,CAAC,KAAK,CAAC,oBAAoB,CAAC,KAAK,IAAI,EAAE;wBAC7C,MAAM,CAAC,IAAI,CAAC,GAAG,SAAO,CAAC,IAAI,CAAC,CAAC;qBAC9B;iBACF,CAAC,CAAC;aACJ;SACF;QACD,OAAO,MAAM,CAAC;KACf;;gBA5IF,UAAU;;;;gBALU,QAAQ;gBAEmC,cAAc;gBAAzD,YAAY;gBAA+D,kBAAkB;;IAgJlH,wBAAC;CA7ID;;ACHA;;;AAGA;IAEE,8BAAmB,QAAkB,EAAU,EAAqB,EAAU,MAAsB;QAAjF,aAAQ,GAAR,QAAQ,CAAU;QAAU,OAAE,GAAF,EAAE,CAAmB;QAAU,WAAM,GAAN,MAAM,CAAgB;KACnG;;;;;IAKM,4CAAa,GAApB,UAAqB,MAAyB;QAC5C,MAAM,GAAG,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC;QAC/D,IAAI,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE;YACzB,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;SACpB;aAAM,IAAI,IAAI,CAAC,EAAE,EAAE;YAClB,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;SACzB;KACF;;;;;;IAMM,iDAAkB,GAAzB,UAA0B,QAAgB,EAAE,MAAyB;QAArE,iBAcC;QAbC,MAAM,GAAG,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC;QAC/D,IAAI,KAAK,CAAC,QAAQ,CAAC,EAAE;YACnB,OAAO;SACR;QACD,IAAI,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE;YACzB,MAAM,CAAC,UAAU,CAAC;gBAChB,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;aACpB,EAAE,QAAQ,CAAC,CAAC;SACd;aAAM,IAAI,IAAI,CAAC,EAAE,EAAE;YAClB,MAAM,CAAC,UAAU,CAAC;gBAChB,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;aACzB,EAAE,QAAQ,CAAC,CAAC;SACd;KACF;;gBAnCF,UAAU;;;;gBAL6C,QAAQ;gBAAvC,iBAAiB;gBAAjC,cAAc;;IAyCvB,2BAAC;CApCD;;;ICKE,sBACU,QAAkB,EAClB,YAA0B,EAC1B,UAA2B,EAC3B,eAAgC,EAChC,cAAkC;QAJlC,aAAQ,GAAR,QAAQ,CAAU;QAClB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,eAAU,GAAV,UAAU,CAAiB;QAC3B,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAoB;KACvC;IACE,8BAAO,GAAd,eAAoB;;;;;;;IAOb,6BAAM,GAAb,UAAc,OAAe,EAAE,EAAW;QACxC,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QACnG,IAAI,CAAC,YAAY,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,mCAAiC,OAAS,CAAC,CAAC;SAC7D;QACD,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QAClE,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;QACvD,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAC3D,IAAI,CAAC,EAAE,EAAE;YACP,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,OAAO,EAAiB,CAAC;YAC3E,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC;SAC5B;QACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,SAAS,GAAI,eAAe,CAAC,yBAAyB,CAAC,YAAY,EAAE,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAc,CAAC,OAAO,EAAE,CAAC,GAAG,CAAC,UAAC,IAAY,IAAK,OAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;QACxM,IAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;QAE9C,eAAe,CAAC,GAAG,EAAE,CAAC;QACtB,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAChE,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;;YAE9B,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,EAAE,CAAW,CAAC;YAC5E,IAAM,YAAY,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;YAC5C,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;SACjD;aAAM;YACL,IAAM,YAAU,GAAG,aAAa,CAAC,aAAa,CAAC,mBAAmB,CAAC,eAAe,CAAoB,CAAC;YACvG,IAAI,YAAU,EAAE;gBACd,IAAM,YAAY,GAAU,YAAU,CAAC,cAAc,CAAC,CAAC;gBACvD,IAAM,MAAI,GAAG,YAAY,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,EAAE,GAAA,CAAC,CAAC;gBACvD,IAAI,MAAI,EAAE;;oBAER,IAAM,QAAM,GAAW,aAAa,CAAC,aAAa,CAAC,eAAe,CAAC,SAAS,CAAW,CAAC;oBACxF,IAAI,QAAM,CAAC,OAAO,IAAI,QAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;wBAC/C,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAC7E,GAAG,CAAC,UAAC,MAAe;4BAClB,IAAI,MAAM,EAAE;gCACV,QAAM,CAAC,IAAI,CAAC,MAAI,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;gCACxC,QAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,QAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;6BACjD;yBACF,CAAC,CACH,CAAC;qBACH;yBAAM;;wBAEL,IAAI,SAAS,EAAE;4BACb,SAAS,CAAC,KAAK,EAAE,CAAC;yBACnB;qBACF;iBACF;qBAAM;;oBAEL,IAAM,OAAK,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;oBACxD,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAC7E,SAAS,CAAC,UAAA,MAAM;wBACd,IAAI,MAAM,EAAE;4BACV,OAAO,aAAa,CAAC,kBAAkB,CAAC,OAAK,EAAE,EAAE,CAAC,CAAC,IAAI,CACrD,GAAG,CAAC;gCACF,aAAa,CAAC,aAAa,CAAC,kBAAkB,CAAC,OAAK,EAAE,EAAE,CAAC,CAAC;gCAE1D,IAAI,YAAU,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,SAAS,EAAE;oCACzC,SAAS,CAAC,KAAK,EAAE,CAAC;iCACnB;6BACF,CAAC,CACH,CAAC;yBACH;6BAAM;4BACL,OAAO,KAAK,CAAC;yBACd;qBACF,CAAC,CACH,CAAC;iBACH;aACF;SACF;QACD,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;KACf;;;;IAIM,uCAAgB,GAAvB,UAAwB,EAAW;QAAnC,iBAuBC;QAtBC,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;QAC5D,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAE3D,IAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,EAAE,CAAC;QACpF,IAAM,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;QACxD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;QACjE,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,IAAM,OAAK,GAAG,EAAE,CAAC;YACjB,YAAY,CAAC,OAAO,CAAC,UAAC,IAAY,EAAE,KAAa,EAAE,KAAK;gBACtD,OAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACjB,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAK,CAAgB,CAAC;gBACpE,IAAI,WAAW,EAAE;oBACf,IAAM,SAAS,GAAG,WAAW,CAAC,SAAS,CAAC;oBACxC,IAAM,gBAAgB,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAK,CAAgB,CAAC;oBACtF,IAAI,KAAK,KAAK,WAAW,CAAC,MAAM,GAAG,CAAC,IAAI,EAAE,EAAE;wBAC1C,gBAAgB,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;qBACnC;yBAAM,IAAI,gBAAgB,EAAE;wBAC3B,gBAAgB,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;qBAC1C;iBACF;aACF,CAAC,CAAC;SACJ;KACF;IACM,iCAAU,GAAjB;QACE,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QACvC,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;QACvD,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAC3D,IAAM,aAAa,GAAG,IAAI,CAAC,UAAgC,CAAC;QAC5D,IAAM,SAAS,GAAI,eAAe,CAAC,yBAAyB,CAAC,YAAY,EAAE,aAAa,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAc,CAAC,OAAO,EAAE,CAAC,GAAG,CAAC,UAAC,IAAY,IAAK,OAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;QACxM,IAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC9C,eAAe,CAAC,GAAG,EAAE,CAAC;QACtB,IAAM,UAAU,GAAG,aAAa,CAAC,aAAa,CAAC,mBAAmB,CAAC,eAAe,CAAoB,CAAC;QACvG,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAChE,IAAI,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,SAAS,EAAE;YACzC,SAAS,CAAC,KAAK,EAAE,CAAC;SACnB;KACF;;;;;;IAMO,gCAAS,GAAjB,UAAkB,WAAmB,EAAE,EAAO;QAC5C,IAAI,IAAI,GAAG,GAAG,GAAG,EAAE,CAAC;QACpB,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;;;YAGvB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBACxD,IAAM,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAChC,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACjE,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBAClC,MAAM,KAAK,CAAC,yFAAiB,OAAO,2GAAmB,CAAC,CAAC;iBAC1D;gBACD,IAAI,IAAI,MAAI,OAAO,SAAI,OAAO,CAAC,SAAW,CAAC;aAC5C;SACF;QACD,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;KACb;;gBAvJF,UAAU;;;;gBARU,QAAQ;gBAIpB,YAAY;gBAAmB,UAAU;gBACzC,eAAe;gBACf,kBAAkB;;IA0J3B,mBAAC;CAxJD;;;ICHE,qBACU,QAAkB,EAClB,UAAsB,EACtB,UAA8B;QAF9B,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAY;QACtB,eAAU,GAAV,UAAU,CAAoB;KAEvC;;;;;;;IAOM,8BAAQ,GAAf,UAAgB,MAAyD,EAAE,YAAoB;QAC7F,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YACzB,IAAM,OAAO,GAAU,MAAM,CAAC,MAAM,CAAC,UAAC,MAAa,EAAE,KAAY;gBAC/D,OAAO,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;aAC7B,EAAE,EAAE,CAAC,CAAC;YACP,OAAO,OAAO,CAAC,SAAS,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,KAAK,KAAK,YAAY,GAAA,CAAC,CAAC;SACtE;aAAM,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,iBAAiB,EAAE;YACvE,OAAO,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,UAAA,GAAG,IAAI,OAAA,MAAM,CAAC,GAAG,CAAC,CAAC,OAAO,KAAK,YAAY,GAAA,CAAC,CAAC;SACnF;KACF;;gBAvBF,UAAU;;;;gBAHU,QAAQ;gBACpB,UAAU;gBAAmE,UAAU;;IA2BhG,kBAAC;CAzBD;;;ICEE;KAAiB;IACV,yCAAc,GAArB,UAAsB,YAA0B;QAC9C,IAAM,mBAAmB,GAAG,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC;QAC5H,OAAO,mBAAmB,IAAI,YAAY,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;KACjF;;gBANF,UAAU;;;;IAOX,uBAAC;CAPD;;;ICEE,2BAAoB,QAAkB,EAAU,YAA0B;QAAtD,aAAQ,GAAR,QAAQ,CAAU;QAAU,iBAAY,GAAZ,YAAY,CAAc;KAAK;;;;IAIxE,mDAAuB,GAA9B;QACE,IAAM,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,cAAc,IAAI,EAAE,CAAC;QAC1F,IAAM,mBAAmB,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,mBAAmB,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QACtH,IAAI,cAAc,IAAI,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YAC5D,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YACzC,IAAI,CAAC,OAAO,CAAC,UAAC,GAAW;gBACvB,IAAM,KAAK,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC;gBAClC,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,iBAAiB,EAAE;oBAChE,OAAO;iBACR;gBACD,IAAM,aAAa,GAAG,mBAAmB,CAAC,IAAI,CAAC,UAAC,QAAgB;;oBAE9D,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;oBACjC,OAAO,GAAG,CAAC,UAAU,CAAI,QAAQ,MAAG,CAAC,CAAC;iBACvC,CAAC,CAAC;gBACH,IAAI,aAAa,EAAE;oBACjB,OAAO,cAAc,CAAC,GAAG,CAAC,CAAC;iBAC5B;qBAAM;oBACL,cAAc,CAAC,GAAG,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;oBAClC,OAAO,cAAc,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;oBACjC,OAAO,cAAc,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC;iBACtC;aACF,CAAC,CAAC;YACH,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,0BAA0B,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;SAC/F;KACF;;gBA/BF,UAAU;;;;gBAHU,QAAQ;gBACL,YAAY;;IAkCpC,wBAAC;CAhCD;;AC2DA;;;AAGA,IAAM,sCAAsC,GAAe;IACzD,iBAAiB;IACjB,mBAAmB;IACnB,iBAAiB;IACjB,cAAc;IACd,mBAAmB;IACnB,kBAAkB;IAClB,cAAc;;IAGd,uBAAuB;IACvB,yBAAyB;IACzB,wBAAwB;IACxB,iBAAiB;IACjB,aAAa;;IAGb,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,eAAe;IACf,kBAAkB;IAClB,iBAAiB;IACjB,eAAe;IACf,eAAe;IACf,0BAA0B;IAC1B,oBAAoB;IAEpB,eAAe;IACf,cAAc;IACd,YAAY;IACZ,qBAAqB;IACrB,iBAAiB;IACjB,WAAW;IACX,2BAA2B;IAC3B,qBAAqB;IACrB,cAAc;IACd,iBAAiB;IACjB,aAAa;IACb,sBAAsB;IACtB,iBAAiB;IACjB,aAAa;IACb,gBAAgB;IAChB;QACE,OAAO,EAAE,2BAA2B;QACpC,QAAQ,EAAE,oBAAoB;KAC/B;IACD;QACE,OAAO,EAAE,wBAAwB;QACjC,QAAQ,EAAE,2BAA2B;KACtC;IACD,cAAc;IACd,sBAAsB;IACtB,gBAAgB;IAChB,sBAAsB;IACtB,mBAAmB;IACnB,eAAe;IACf,oBAAoB;IACpB,oBAAoB;IACpB,kBAAkB;IAClB,kBAAkB;IAClB,iBAAiB;IACjB,YAAY;IACZ,oBAAoB;IACpB,WAAW;IACX,kBAAkB;IAClB,kBAAkB;IAClB,mBAAmB;IACnB,gBAAgB;IAChB,iBAAiB;;IAEjB,EAAE,OAAO,EAAE,2BAA2B,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IACvE,EAAE,OAAO,EAAE,sCAAsC,EAAE,QAAQ,EAAE,6BAA6B,EAAE;IAC5F,EAAE,OAAO,EAAE,qBAAqB,EAAE,QAAQ,EAAE,kBAAkB,EAAE;IAChE,EAAE,OAAO,EAAE,oBAAoB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC9D,EAAE,OAAO,EAAE,kCAAkC,EAAE,QAAQ,EAAE,sBAAsB,EAAE,KAAK,EAAE,IAAI,EAAE;CAC/F;;ACtFD;;;AAGA,IAAM,wCAAwC,GAAe;IACzD,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,qBAAqB,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IACjE,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,cAAc,EAAE;IACvD,EAAE,OAAO,EAAE,qBAAqB,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IACjE,EAAE,OAAO,EAAE,oBAAoB,EAAE,QAAQ,EAAE,kBAAkB,EAAE;IAC/D,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,cAAc,EAAE;;IAGvD,EAAE,OAAO,EAAE,yBAAyB,EAAE,QAAQ,EAAE,uBAAuB,EAAE;IACzE,EAAE,OAAO,EAAE,2BAA2B,EAAE,QAAQ,EAAE,yBAAyB,EAAE;IAC7E,EAAE,OAAO,EAAE,0BAA0B,EAAE,QAAQ,EAAE,wBAAwB,EAAE;IAC3E,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,aAAa,EAAE;;IAGrD,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,oBAAoB,EAAE,QAAQ,EAAE,kBAAkB,EAAE;IAC/D,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,oBAAoB,EAAE,QAAQ,EAAE,kBAAkB,EAAE;IAC/D,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,4BAA4B,EAAE,QAAQ,EAAE,0BAA0B,EAAE;IAC/E,EAAE,OAAO,EAAE,sBAAsB,EAAE,QAAQ,EAAE,oBAAoB,EAAE;IAEnE,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,cAAc,EAAE;IACvD,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,YAAY,EAAE;IACnD,EAAE,OAAO,EAAE,uBAAuB,EAAE,QAAQ,EAAE,qBAAqB,EAAE;IACrE,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,WAAW,EAAE;IACjD,EAAE,OAAO,EAAE,6BAA6B,EAAE,QAAQ,EAAE,2BAA2B,EAAE;IACjF,EAAE,OAAO,EAAE,uBAAuB,EAAE,QAAQ,EAAE,qBAAqB,EAAE;IACrE,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,cAAc,EAAE;IACvD,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,aAAa,EAAE;IACrD,EAAE,OAAO,EAAE,wBAAwB,EAAE,QAAQ,EAAE,sBAAsB,EAAE;IACvE,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,iBAAiB,EAAE;IAC7D,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,aAAa,EAAE;IACrD,EAAE,OAAO,EAAE,kBAAkB,EAAE,QAAQ,EAAE,gBAAgB,EAAE;IAC3D;QACI,OAAO,EAAE,2BAA2B;QACpC,QAAQ,EAAE,oBAAoB;KACjC;IACD;QACI,OAAO,EAAE,wBAAwB;QACjC,QAAQ,EAAE,2BAA2B;KACxC;IACD,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,cAAc,EAAE;IACvD,EAAE,OAAO,EAAE,wBAAwB,EAAE,QAAQ,EAAE,sBAAsB,EAAE;IACvE,EAAE,OAAO,EAAE,kBAAkB,EAAE,QAAQ,EAAE,gBAAgB,EAAE;IAC3D,EAAE,OAAO,EAAE,wBAAwB,EAAE,QAAQ,EAAE,sBAAsB,EAAE;IACvE,EAAE,OAAO,EAAE,qBAAqB,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IACjE,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE;IACzD,EAAE,OAAO,EAAE,sBAAsB,EAAE,QAAQ,EAAE,oBAAoB,EAAE;;IAEnE,EAAE,OAAO,EAAE,2BAA2B,EAAE,QAAQ,EAAE,mBAAmB,EAAE;IACvE,EAAE,OAAO,EAAE,sCAAsC,EAAE,QAAQ,EAAE,6BAA6B,EAAE;CAC/F;;;ICxGC,+BAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;QAClD,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;SAC9B;KACF;;gBAdF,QAAQ,SAAC;oBACR,SAAS,EAAE,uCAAuC;oBAClD,OAAO,EAAE;wBACP,mBAAmB;qBACpB;oBACD,OAAO,EAAE;wBACP,mBAAmB;qBACpB;iBACF;;;;gBAVQ,eAAe;;IAiBxB,4BAAC;CAfD;;;ICDI,qBAAmB,KAAa,EAAU,UAAmC;QAA1D,UAAK,GAAL,KAAK,CAAQ;QAAU,eAAU,GAAV,UAAU,CAAyB;KAAK;;;;;IAK3E,iCAAW,GAAlB,UAAmB,OAAY;QAC3B,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;QACnD,OAAO,IAAI,CAAC;KACf;;;;;IAKM,4BAAM,GAAb,UAAc,OAA4B;QAA1C,iBAOC;QANG,IAAM,aAAa,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;QACnC,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC;QACpE,IAAM,QAAQ,GAAG;YACb,KAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,KAAI,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;SAClE,CAAC;QACF,OAAO,QAAQ,CAAC;KACnB;;;;IAIM,6BAAO,GAAd;QACI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC7C;IACL,kBAAC;CAAA;;;IC1BD;KA+BC;;;;;IAxBe,sBAAG,GAAjB,UAAkB,KAAa;QAC7B,IAAM,IAAI,GAAG,IAAI,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACrD,OAAO,IAAI,CAAC;KACb;;;;;;;IAOa,yBAAM,GAApB,UAAqB,QAAgB,EAAE,cAAuB,EAAE,QAAuB;QACrF,IAAI,OAAO,GAAG,IAAI,CAAC;QACnB,IAAI,cAAc,EAAE;YAClB,IAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAC3D,IAAA,sBAAM,EAAE,oBAAK,EAAE,gCAAW,CAAY;YAC9C,OAAO,GAAG,EAAE,MAAM,QAAA,EAAE,KAAK,OAAA,EAAE,WAAW,aAAA,EAAE,CAAC;SAC1C;QACD,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;QAC3E,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,IAAI,CAAC;SACb;QACD,IAAM,IAAI,GAAG,IAAI,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACrD,OAAO,IAAI,CAAC;KACb;IA7Bc,6BAAU,GAA4B,IAAI,uBAAuB,EAAE,CAAC;IACpE,qCAAkB,GAAuB,IAAI,kBAAkB,EAAE,CAAC;IA6BnF,yBAAC;CA/BD;;ACHA;;;;;;;AAOA;IAEE,+BAAoB,QAAkB,EAAU,YAA0B,EAAkC,SAAoB;QAA5G,aAAQ,GAAR,QAAQ,CAAU;QAAU,iBAAY,GAAZ,YAAY,CAAc;QAAkC,cAAS,GAAT,SAAS,CAAW;KAAK;;;;;IAK9H,sCAAM,GAAb,UAAc,OAAgC,EAAE,OAAY;QAC1D,IAAM,WAAW,GAAG,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,KAAK,CAAC;QAC5D,IAAM,aAAa,GAAG,OAAO,IAAI,OAAO,CAAC,aAAa,IAAI,KAAK,CAAC;QAChE,IAAM,QAAQ,GAAG,OAAO,IAAI,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC;QACrD,IAAM,KAAK,GAAG,OAAO,IAAI,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC;QAC/C,IAAM,cAAc,GAAG,OAAO,IAAI,OAAO,CAAC,cAAc,IAAI,IAAI,CAAC;QACjE,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,WAAW,EAAE,aAAa,EAAE,QAAQ,EAAE,KAAK,EAAE,cAAc,CAAC,CAAC;QAClG,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YACnD,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,IAAkD;gBACrE,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,SAAS,CAAC,CAAC;aAClF,CAAC,CAAC;SACJ;aAAM;YACL,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;SACvE;QACD,IAAM,kBAAkB,GAAiB,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACxF,IAAI,MAAM,IAAI,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YACjD,kBAAkB,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SACnE;aAAM;YACL,IAAI,MAAM,KAAK,IAAI,EAAE;gBACnB,kBAAkB,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aAC3D;SACF;KACF;;;;;IAKO,uCAAO,GAAf,UAAgB,cAAuC,EAAE,WAA4B,EAAE,aAA8B,EAAE,QAAyB,EAAE,KAAiB,EAAE,cAAiC;QAAtM,iBA6GC;QA7GwD,4BAAA,EAAA,mBAA4B;QAAE,8BAAA,EAAA,qBAA8B;QAAE,yBAAA,EAAA,eAAyB;QAAE,sBAAA,EAAA,YAAiB;QAAE,+BAAA,EAAA,qBAAiC;;QACpM,IAAM,WAAW,GAAG,cAAc,IAAI,cAAc,CAAC,WAAW,IAAI,IAAI,CAAC;QACzE,IAAM,UAAU,GAAG,cAAc,IAAI,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC;QACvE,IAAM,EAAE,GAAG,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC;QACrC,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1C,OAAO,IAAI,CAAC;SACb;QACD,IAAM,MAAM,GAAG;YACb,IAAI,EAAE,EAAE;YACR,GAAG,EAAE,EAAE;SACR,CAAC;QACF,IAAI,gBAAgB,GAAG,KAAK,CAAC;gCACpB,UAAU;;YACjB,IAAM,OAAO,GAAG,UAAU,CAAC,OAAO,CAAC;YACnC,IAAM,UAAQ,GAAG,UAAU,CAAC,QAAQ,IAAI,IAAI,CAAC;YAC7C,IAAM,OAAO,GAAG,UAAQ,IAAI,UAAQ,CAAC,OAAO,IAAI,IAAI,CAAC;YACrD,IAAM,QAAQ,GAAG,UAAQ,IAAI,UAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC;YACvD,IAAM,IAAI,GAAG,UAAQ,IAAI,UAAQ,CAAC,IAAI,CAAC;YACvC,IAAM,WAAW,GAAG,OAAK,cAAc,CAAC,UAAU,EAAE,EAAE,EAAE,QAAQ,CAAC,CAAC;YAClE,IAAM,YAAY,GAAG,WAAW,IAAI,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;YAG1E,IAAI,CAAC,UAAQ,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;;aAEzF;oCAEQ,GAAG;;wCACD,MAAM;;oBAEb,IAAI,aAAa,GAAG,OAAK,0CAA0C,CAAC,UAAU,EAAE,EAAE,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;oBACzG,IAAI,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;;wBAE9C,gBAAgB,GAAG,IAAI,CAAC;;qBAEzB;;oBAED,aAAa,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B;wBAC9D,IAAM,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;wBAClF,IAAI,mBAAmB,EAAE;4BACvB,IAAM,kBAAkB,GAAG,KAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;4BAChF,IAAI,kBAAkB,EAAE;gCACtB,OAAO,KAAK,CAAC;6BACd;iCAAM;gCACL,OAAO,IAAI,CAAC;6BACb;yBACF;wBACD,OAAO,IAAI,CAAC;qBACb,CAAC,CAAC;;oBAEH,IAAM,YAAY,GAAG,OAAK,YAAY,CAAC,UAAU,EAAE,EAAE,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC;;oBAEzE,IAAI,YAAY,EAAE;;;wBAGhB,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC7C,aAAa,CAAC,OAAO,CAAC,UAAC,YAA0B;;gCAE/C,IAAM,YAAY,GAAG,KAAI,CAAC,0BAA0B,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;gCAC3E,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;oCAC3C,YAAY,CAAC,OAAO,CAAC,UAAC,EAA8B;4CAA9B,kBAA8B,EAA7B,uBAAe,EAAE,mBAAW;;wCAEjD,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,YAAY,EAAE,eAAe,EAAE,OAAO,CAAC,CAAC;qCACxE,CAAC,CAAC;iCACJ;;;6BAKF,CAAC,CAAC;yBACJ,AACA;qBACF;;oBAED,aAAa,CAAC,OAAO,CAAC,UAAC,YAA0B;wBAC/C,IAAM,aAAa,GAAG,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC;wBAChE,IAAM,YAAY,GAAG,KAAI,CAAC,0BAA0B,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;wBAC3E,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;4BACrC,IAAA;;;kCAA4H,EAA3H,uBAAe,EAAE,mBAA0G,CAAC;;4BAEnI,IAAM,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;4BAC7F,IAAI,KAAK,GAAG,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;4BAC1C,IAAM,SAAO,GAAM,GAAG,SAAI,MAAM,SAAI,OAAS,CAAC;;4BAE9C,IAAI,KAAK,IAAI,CAAC,IAAI,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,EAAE,KAAK,SAAO,GAAA,CAAC,KAAK,CAAC,CAAC,EAAE;;gCAEpE,IAAM,QAAQ,GAAG,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;gCAC5E,IAAM,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,aAAa,EAAE,WAAW,CAAC,IAAI,IAAI,WAAW,CAAC,gBAAgB,IAAI,eAAe,EAAE,QAAQ,CAAC,CAAC;gCAChI,IAAM,IAAI,GAAG;oCACX,EAAE,EAAE,SAAO;oCACX,KAAK,OAAA;oCACL,WAAW,EAAE,WAAW,CAAC,EAAE;oCAC3B,KAAK,OAAA;oCACL,GAAG,EAAE,OAAO;oCACZ,SAAS,EAAE,EAAE;oCACb,WAAW,aAAA;oCACX,IAAI,EAAE,OAAO;iCACd,CAAC;gCACF,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;6BACvB;yBACF;qBAEF,CAAC,CAAC;;;oBA1EL,KAAmB,IAAA,YAAAH,SAAA,OAAO,CAAA,gCAAA;wBAArB,IAAI,MAAM,oBAAA;gCAAN,MAAM;qBA2Ed;;;;;;;;;;;;gBA5EH,KAAgB,IAAA,SAAAA,SAAA,IAAI,CAAA,0BAAA;oBAAf,IAAI,GAAG,iBAAA;4BAAH,GAAG;iBA6EX;;;;;;;;;;;;YA3FH,KAAuB,IAAA,gBAAAA,SAAA,WAAW,CAAA,wCAAA;gBAA7B,IAAI,UAAU,wBAAA;wBAAV,UAAU;aA4FlB;;;;;;;;;QACD,IAAI,gBAAgB,IAAI,WAAW,IAAI,CAAC,aAAa,IAAI,QAAQ,EAAE;YACjE,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,cAAc,CAAC,CAAC;SACtE;QACD,OAAO,MAAM,CAAC;KACf;IACO,4CAAY,GAApB,UAAqB,SAA4I,EAAE,YAA0B,EAAE,eAAuB,EAAE,OAAe;;QACrO,IAAM,UAAU,GAAG,SAAS,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,YAAY,CAAC,OAAO,KAAK,YAAY,CAAC,OAAO,GAAA,CAAC,CAAC;QAC9F,IAAI,UAAU,EAAE;YACd,IAAM,eAAe,GAAG,UAAU,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;YACxG,IAAM,WAAW,GAAG,sBAAmB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAE,CAAC;YACpF,IAAI,eAAe,EAAE;gBACnB,UAAU,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;aAChF;iBAAM;gBACL,UAAU,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,EAAE,MAAM,YAAI,GAAC,WAAW,IAAG,EAAE,IAAI,EAAE,OAAO,EAAE,KAAE,EAAE,CAAC;aACxF;SACF;aAAM;YACL,SAAS,CAAC,IAAI,CAAC;gBACb,YAAY,EAAE,YAAY;gBAC1B,OAAO;oBACL,GAAC,eAAe,IAAG;wBACjB,MAAM,EAAE;4BACN,mBAAmB,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE;yBACvC;qBACF;uBACF;aACF,CAAC,CAAC;SACJ;KACF;IACO,8CAAc,GAAtB,UAAuB,aAAqB,EAAE,YAAoB,EAAE,KAAU;QAC5E,IAAM,QAAQ,GAAG;YACf,QAAQ,EAAE;gBACR,aAAa,EAAE,YAAY;gBAC3B,KAAK,EAAE,sBAAY;gBACnB,YAAY,EAAE,iBAAiB;aAChC;YACD,IAAI,EAAE;gBACJ,aAAa,EAAE,YAAY;gBAC3B,KAAK,EAAE,YAAY;gBACnB,YAAY,EAAE,iBAAiB;aAChC;YACD,QAAQ,EAAE;gBACR,aAAa,EAAE,YAAY;gBAC3B,KAAK,EAAE,sBAAY;gBACnB,YAAY,EAAE,iBAAiB;aAChC;SACF,CAAC;QACF,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,kBAAkB,EAAE,IAAI,QAAQ,CAAC;QACxE,IAAM,OAAO,GAAG,EAAE,CAAC;QACnB,IAAI,aAAa,EAAE;YACjB,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC,CAAC;SAC/F;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACb,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC;SAC3E;QACD,IAAI,YAAY,EAAE;YAChB,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,eAAe,EAAE,YAAY,CAAC,CAAC,CAAC;SAChG;QACD,OAAO,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAC1B;;;;;;;IAOO,8CAAc,GAAtB,UAAuB,UAAsB,EAAE,EAAU,EAAE,QAAgB;QACzE,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAC1D,OAAO,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,yBAAyB,CAAC,QAAQ,CAAC,CAAC;KACnF;;;;;;;;IAQO,0EAA0C,GAAlD,UAAmD,UAAsB,EAAE,EAAU,EAAE,WAAmB,EAAE,UAAkB;QAC5H,IAAI,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;QACtE,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;;YAE7C,aAAa,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,YAA0B;;gBAE9D,IAAI,mBAAmB,GAAG,YAAY,CAAC,SAAS,KAAK,EAAE,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,KAAK,WAAW,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;gBACrP,IAAI,CAAC,mBAAmB,EAAE;oBACxB,OAAO,KAAK,CAAC;iBACd;;gBAED,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gBAC3D,IAAM,YAAY,GAAG,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;gBAC5F,IAAI,YAAY,EAAE;oBAChB,IAAM,aAAa,GAAG,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;;oBAEpE,IAAM,kBAAkB,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,QAAsB,IAAK,OAAA,QAAQ,CAAC,YAAY,KAAK,QAAQ,CAAC,YAAY,CAAC,iBAAiB,KAAK,UAAU,IAAI,QAAQ,CAAC,YAAY,CAAC,SAAS,KAAK,UAAU,CAAC,GAAA,CAAC,CAAC;oBAC/M,IAAI,kBAAkB,EAAE;wBACtB,IAAM,oBAAkB,GAAG,kBAAkB,CAAC,IAAI,CAAC;wBACnD,IAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,OAAO,KAAK,oBAAkB,GAAA,CAAC,CAAC;wBAClI,IAAI,aAAa,EAAE;4BACjB,OAAO,IAAI,CAAC;yBACb;6BAAM;4BACL,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,KAAK,oBAAkB,GAAA,CAAC,CAAC;4BAC7G,OAAO,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC;yBAC5B;qBACF;yBAAM;wBACL,OAAO,KAAK,CAAC;qBACd;iBACF;qBAAM;oBACL,OAAO,KAAK,CAAC;iBACd;aACF,CAAC,CAAC;YACH,OAAO,aAAa,CAAC;SACtB;QACD,OAAO,IAAI,CAAC;KACb;;;;;IAKO,mDAAmB,GAA3B,UAA4B,cAA8B;QACxD,IAAM,WAAW,GAAG,cAAc,CAAC,OAAO,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC;QACpF,OAAO,WAAW,GAAG,IAAI,GAAG,KAAK,CAAC;KACnC;;;;;;IAMO,kDAAkB,GAA1B,UAA2B,cAA8B;QACvD,IAAM,YAAY,GAAG,cAAc,CAAC,OAAO,CAAC;QAC5C,IAAM,mBAAmB,GAAG,YAAY,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC;QAClF,IAAI,mBAAmB,EAAE;YACvB,IAAM,eAAe,GAAU,YAAY,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;YAC3E,OAAO,eAAe,CAAC,KAAK,CAAC,UAAC,KAAiB;gBAC7C,OAAO,KAAK,CAAC,KAAK,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,IAAI,CAAC,MAAM,GAAA,CAAC,CAAC;aAC1C,CAAC,CAAC;SACJ;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,0EAAc,CAAC,CAAC;SACjC;KACF;;;;;;;;IAQO,4CAAY,GAApB,UAAqB,UAAsB,EAAE,EAAU,EAAE,WAAmB,EAAE,EAAU;QACtF,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;QAC3D,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAC1D,IAAM,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;QAC7C,IAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAgB,CAAC;QACtE,OAAO,WAAW,CAAC,WAAW,CAAC,eAAe,KAAK,EAAE,CAAC;KACvD;;;;;;IAMO,+CAAe,GAAvB,UAAwB,UAAsB,EAAE,EAAU;QACxD,IAAM,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC;QACxE,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7C,IAAM,kBAAkB,GAAG,aAAa,CAAC,IAAI,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,SAAS,KAAK,EAAE,GAAA,CAAC,CAAC;YAC7F,IAAI,kBAAkB,EAAE;gBACtB,IAAM,uBAAuB,GAAG,kBAAkB,CAAC,0BAA0B,EAAE,CAAC;gBAChF,OAAO,uBAAuB,CAAC;aAChC;SACF;QACD,OAAO,IAAI,CAAC;KACb;;;;IAIO,0DAA0B,GAAlC,UAAmC,YAA0B,EAAE,UAAkB;QAC/E,IAAM,YAAY,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;;QAElF,IAAM,QAAQ,GAAG,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;QAExF,IAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;QAC5D,IAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,UAAC,QAAsB,IAAK,OAAA,QAAQ,CAAC,YAAY,KAAK,QAAQ,CAAC,YAAY,CAAC,iBAAiB,KAAK,UAAU,IAAI,QAAQ,CAAC,YAAY,CAAC,SAAS,KAAK,UAAU,CAAC,GAAA,CAAC,CAAC;QACjM,IAAI,QAAQ,EAAE;YACZ,IAAM,aAAW,GAAG,QAAQ,CAAC,IAAI,CAAC;YAClC,IAAM,YAAY,GAAmC,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,aAAW,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,aAAW,GAAA,CAAC,CAAC;;YAE7L,IAAI,YAAY,EAAE;gBAChB,OAAO,YAAY,CAAC;aACrB;SACF;QACD,OAAO,IAAI,CAAC;KACb;IACO,gDAAgB,GAAxB,UAAyB,UAAsB,EAAE,EAAU;QACzD,IAAM,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,CAAC,MAAM,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,SAAS,KAAK,EAAE,GAAA,CAAC,CAAC;QAC9H,aAAa,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,IAAI,YAAY,CAAC,SAAS,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,EAAE,GAAA,CAAC,CAAC;KACjK;;;;;IAKO,sDAAsB,GAA9B,UAA+B,YAA0B;QACvD,IAAM,uBAAuB,GAAG,YAAY,CAAC,0BAA0B,EAAE,CAAC;QAC1E,IAAM,oBAAoB,GAAG,uBAAuB,CAAC,cAAc,CAAC;QACpE,IAAM,iBAAiB,GAAG,oBAAoB,IAAI,oBAAoB,CAAC,uBAAuB,CAAC,IAAI,KAAK,CAAC;QACzG,IAAI,iBAAiB,EAAE;;YAErB,OAAO,uBAAuB,CAAC;SAChC;aAAM;;YAEL,IAAM,kBAAkB,GAAG,uBAAuB,CAAC,MAAM,CAAC;YAC1D,IAAI,kBAAkB,EAAE;gBACtB,OAAO,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;aACxD;iBAAM;gBACL,OAAO,uBAAuB,CAAC;aAChC;SACF;KACF;;gBA/VF,UAAU;;;;gBATkB,QAAQ;gBACqD,YAAY;gDAUvB,MAAM,SAAC,cAAc;;IA8VpG,4BAAC;CAhWD;;AC2LA;uCACuC;;ACrMvC;;GAEG;;;;"}
