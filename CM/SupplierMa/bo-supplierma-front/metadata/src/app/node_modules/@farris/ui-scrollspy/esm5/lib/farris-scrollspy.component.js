/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ElementRef, Directive, TemplateRef, ContentChild, ViewChild, ChangeDetectorRef } from '@angular/core';
import { FarrisScrollSpyService } from './farris-scrollspy.service';
import { getUuid } from './utils';
var ScrollspyItemTemplateDirective = /** @class */ (function () {
    function ScrollspyItemTemplateDirective(template) {
        this.template = template;
    }
    ScrollspyItemTemplateDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[scrollspyItem]'
                },] }
    ];
    /** @nocollapse */
    ScrollspyItemTemplateDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return ScrollspyItemTemplateDirective;
}());
export { ScrollspyItemTemplateDirective };
if (false) {
    /** @type {?} */
    ScrollspyItemTemplateDirective.prototype.template;
}
/**
 * @record
 */
export function scrollspyData() { }
if (false) {
    /** @type {?} */
    scrollspyData.prototype.id;
    /** @type {?} */
    scrollspyData.prototype.title;
    /** @type {?|undefined} */
    scrollspyData.prototype.visible;
}
/**
 * @record
 */
function SpyListFollowTypeChange() { }
if (false) {
    /** @type {?} */
    SpyListFollowTypeChange.prototype.prev;
    /** @type {?} */
    SpyListFollowTypeChange.prototype.next;
}
var ScrollspyComponent = /** @class */ (function () {
    function ScrollspyComponent(elementRef, scrollSpy, changeDetector) {
        this.elementRef = elementRef;
        this.scrollSpy = scrollSpy;
        this.changeDetector = changeDetector;
        /**
         * 当前滚动所有group
         */
        this.scrollGroupId = getUuid();
        /**
         * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
         */
        this._followType = 'side';
        // 记录状态改变
        this._emitFollowType = null;
        this.sidetabWidth = 145;
    }
    Object.defineProperty(ScrollspyComponent.prototype, "fFollowType", {
        get: /**
         * @return {?}
         */
        function () {
            return this._followType;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value !== this._followType) {
                this._emitFollowType = {
                    prev: this._followType,
                    next: value
                };
                this.changeFollowType();
                this._followType = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollspyComponent.prototype, "scrollspyData", {
        get: /**
         * @return {?}
         */
        function () {
            return this._scrollspyData;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value) {
                this._scrollspyData = value.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item.hasOwnProperty('visible') && !item.visible) {
                        return false;
                    }
                    else {
                        return true;
                    }
                }));
                if (this._scrollspyData && this._scrollspyData.length && !this.currentSectionId) {
                    this.currentSectionId = this._scrollspyData[0].id;
                }
                this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // if(this.scrollspyData && this.scrollspyData.length && !this.currentSectionId ){
        //   this.currentSectionId = this.scrollspyData[0].id;
        // }
        // this.scrollSpy.setCurrentSectionIdObj(this.scrollGroupId, this.currentSectionId);
        // console.log(this.scrollGroupId);
        this.scrollSpy.setGroupId(this.scrollGroupId);
        this.changeFollowType();
        // 获取当前Section的Id
        this.scrollSpy.getCurrentSectionId(this.scrollGroupId).subscribe((/**
         * @param {?} currentId
         * @return {?}
         */
        function (currentId) {
            _this.currentSectionId = currentId;
            _this.scrollSpy.updateScrollSpiesActiveClsName(_this.scrollGroupId, currentId);
        }));
        // 获取对应Container区域，在滚动时的当前Section的变化
        this.scrollSpy.updateScrollGroup(this.scrollGroupId).subscribe((/**
         * @param {?} currentSection
         * @return {?}
         */
        function (currentSection) {
            _this.scrollSpy.setCurrentSectionId(_this.scrollGroupId, currentSection);
        }));
    };
    // 改变FollowType时
    // 改变FollowType时
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.changeFollowType = 
    // 改变FollowType时
    /**
     * @return {?}
     */
    function () {
        if (this.scrollGroupId && this._emitFollowType) {
            this.scrollSpy.changeGroupIdFollowType(this.scrollGroupId, this._emitFollowType);
            this._emitFollowType = null;
        }
    };
    /**
     * @return {?}
     */
    ScrollspyComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /**
         * 当滚动位置为side时，该组件最近父节点添加relative定位
         * @type {?}
         */
        var parent = this.elementRef.nativeElement.parentElement;
        if (!parent.style.position && parent.style.position !== 'relative' && this.fFollowType === 'side') {
            parent.style.position = 'relative';
        }
        // if(this.scrollspyData && this.scrollspyData.length && this.currentSectionId){
        //   if(this.currentSectionId !== this.scrollspyData[0].id){
        //     console.log(222);
        //     const element = this.scrollyspyListEl.nativeElement.querySelector("#scrollspy-"+this.currentSectionId);
        //     const follow = {
        //       element: element,
        //       id: this.currentSectionId
        //     };
        //     const groupId = this.scrollGroupId ? this.scrollGroupId: 'default';
        //     this.scrollSpy.fScrollFollowClick(groupId,follow);
        //   }
        // }
    };
    ScrollspyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-scrollspy',
                    template: "<div class=\"f-scrollspy\" [ngClass]=\"{'f-scrollspy-sidetabs': fFollowType === 'side' && !scrollspyTemplate,'f-scrollspy-tabs': fFollowType === 'tab' ||fFollowType === 'fixedTab' && !scrollspyTemplate,'f-scrollspy-fixedTab':fFollowType === 'fixedTab'}\">\r\n    <ng-container *ngIf=\"fFollowType === 'side' && !scrollspyTemplate\">\r\n        <div class=\"f-scrollspy-sidetabs-inner\" [ngStyle]=\"{'width': (fFollowType === 'side' && !scrollspyTemplate)? sidetabWidth/16 + 'rem': '','transform': (fFollowType === 'side' && !scrollspyTemplate)? 'translateX('+(sidetabWidth/16 + 'rem') +')' : ''}\">\r\n            <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n        </div>\r\n        <div class=\"f-scrollspy-monitor-tip\">\r\n            <div class=\"f-scrollspy-monitor-tip-inner\">\r\n                <span class=\"f-icon f-icon-navigation\"></span>\r\n                <span class=\"f-scrollspy-monitor-tip-text\">{{ 'scrollspy.guide' | locale }}</span>\r\n                <span class=\"f-scrollspy-monitor-tip-img\">\r\n                </span>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"fFollowType === 'tab'||fFollowType === 'fixedTab' || scrollspyTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"scrollspyListTemplate\"></ng-container>\r\n    </ng-container>\r\n</div>\r\n\r\n\r\n<ng-template #scrollspyListTemplate>\r\n    <ul #scrollyspyList class=\"f-scrollspy-monitor-list\">\r\n        <li class=\"f-scrollspy-monitor-btn\" \r\n        *ngFor=\"let tab of scrollspyData;let i = index;let first = first;let last = last;\"\r\n        [class.active]=\"tab['id'] === currentSectionId\" \r\n        [fScrollFollowElement]=\"tab['id']\"\r\n        [fScrollElement]=\"scrollGroupId\"\r\n        [id]=\"'scrollspy-'+tab['id']\"\r\n        [title]=\"tab.title\">\r\n            <ng-container *ngIf=\"!scrollspyTemplate;else scrollElement\">\r\n                <span class=\"f-scrollspy-monitor-title\">{{tab.title}}</span>\r\n            </ng-container>\r\n            <ng-template #scrollElement>\r\n                <ng-container [ngTemplateOutlet]=\"scrollspyTemplate\" [ngTemplateOutletContext]=\"{scrollItem:tab,first:first,last:last,index:i}\"></ng-container>\r\n            </ng-template>\r\n        </li>\r\n    </ul>\r\n</ng-template>",
                    styles: [".f-scrollspy .f-scrollspy-monitor-btn{display:inline-block}.f-scrollspy-sidetabs{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;position:absolute;top:0;right:0;z-index:999;overflow:hidden;width:1.75rem;-webkit-transition:width .5s;transition:width .5s}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner{-webkit-transition:.5s;transition:.5s;min-height:115px;background:#fff;box-shadow:0 2px 6px 0 rgba(57,66,100,.14);border-radius:4px 0 0 4px;overflow:hidden}.f-scrollspy-sidetabs:hover{width:auto}.f-scrollspy-sidetabs:hover .f-scrollspy-sidetabs-inner{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}.f-scrollspy-sidetabs:hover .f-scrollspy-monitor-tip{border-radius:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn{position:relative;width:100%;height:1.3125rem;padding-left:1.1875rem;margin-bottom:.75rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::before{content:\"\";position:absolute;left:0;top:1rem;height:2rem;width:1px;border-left:1px dashed #e9e9e9;background-color:transparent;border-radius:.5px;z-index:8}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child{margin-bottom:0}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn:last-child::before{display:none}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:-.4375rem;top:.1875rem;width:.9375rem;height:.9375rem;border-radius:100%;z-index:9}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{display:inline-block;font-size:.875rem;color:rgba(0,0,0,.55);line-height:1.3125rem;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.f-scrollspy-sidetabs .f-scrollspy-monitor-btn.active .f-scrollspy-monitor-title{color:rgba(0,0,0,.65);font-weight:600}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip{position:absolute;right:0;top:0;bottom:0;width:1.75rem;border-radius:4px 0 0 4px}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner{position:relative;width:100%;height:100%;padding-top:.625rem}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-img{position:absolute;left:0;bottom:0;width:1.75rem;height:2.9375rem;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAABeCAYAAAB2K9dZAAAABGdBTUEAALGPC/xhBQAABC5JREFUeAHtm2tT1DAUhlnviooiIKDAAjri+NH//3tERERQRBTX99lpdnZLgZLTNOlOzsyZtKXJnidvm2uZGQwGs/JbM1Nqd8S1A5sgT5WcyH/Kj3q9HuedNwCdPdABPs8FAZ8pOZZ/xwX8T2nnbBywHPw9XXhR+LmAD3V8ID8W7EBpJ+wqwHGA2zpxsGeC3dP5vkDPx29K8binYD96BsYjuy/fE+hvzzKCZ6urYFUgtLxL8kVV0helnwT6t+rGmNcsgC7ung4AXRDortLPAk2mQWqy/6OsVfkHgc4pTcKaBHRAtL5vBLkpv+suxkpDADoW+lPUfOYuxEhDAsJD97ItyDV56N+qrL+2fpRG6J0g71dGEfBiW4AgPJK/F+STgDwXim4TkB/nkX0rSEZFrVjbgEDRb/YFSZcS3GIAOqgVQa65k1BpTECYlkJDxgZ0kOvTqqDjYsAe5J1MQUEHyTvZeOuaEiCgG4J86oibSFMDpAvZEmRjI57UABGNwQAzEWDNliIgULPy12Y6FZAqIGz0keaJc8qAQG4IkkfW21IHZEXglTedMqYOCBuDgMe+kF0AhG1dkF6talcAHwrSa5TTxLqo79Nz03yrUvGgzpqr7kO45/K5LgHS4LC2w+JypRVgC/rjsny4ZNklQKCWBcFeyMTKeQG2WIBNME2cUELiRp+IQuxuDU1wvJ9bcvY2L1hXGpnxwBnhDFtUpcDuyCvhyISCK3K2q38VqZKkjZnGvOCYVg13o6+KFkDGe27Mx84toPixPNV9+r5iq2XldxDpWaDF6XfY2PwmP5JPvNg674SVActB8zjQ5L6UA/lVzscJnbHrAB0IyrpHmQ8R2LruhKI+rSgv9nYBrCRt8wGEiP6I1rcvj77JqRguNV9AVyD9z6acJYYkzQoIFGWwx3Btn8TNbVsTgC5mBsLMvmmQkrEmAYFic7OR1bCmaqhpQOLifTStozQFRzkhACkXJRkgRLdQgIDx+QjvZVQLCQgYLav3ilgTNRMakBgZEJgWby2gbQC6UY8lTu+8bQASHI+pm3N6B+uTse5swqfsch6mXEyi68xCUJ2P+khdjHxdzPeo+B95LXOZa91svImnhUaHqVaVMa6le6EfvXSNpcgI5I/C+S+BS78hbxOQ2ABkPjmuIqtiLB7dZMBO3HRDOLBU2qH8grUNOK4ixwwGrHvyMFAOlbcrP5GPrK1GZvSDOiAQVOvLrXAqYmS8s+tyVB1ZDEB+c0NOQCEMNUfDxBiAIaDKZaLiELLtd7AcSMhzIE+nVUFXccvTDhhsPuhqMHqaFYwugTGArKCxAqNnzwpGl8AYQFbQWIHRs2cFo0tgDCAraKzA6NmzgtElMAaQFTRWYPTsWcHoEhgDyAoaKzB69qxgdAmMAWQFjRUYPXtWMLoExgCygsYKjJ596hX8D3/gzAAeM1fWAAAAAElFTkSuQmCC);background-size:100%}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-icon{display:block;margin:0 auto .625rem;font-size:.875rem;color:#fff}.f-scrollspy-sidetabs .f-scrollspy-monitor-tip-inner .f-scrollspy-monitor-tip-text{display:block;width:.75rem;margin:0 auto;font-size:.875rem;line-height:1.25rem;color:#fff;text-align:center;text-shadow:0 1px 4px rgba(0,0,0,.06);word-wrap:break-word}.f-scrollspy-sidetabs .f-scrollspy-sidetabs-inner .f-scrollspy-monitor-list{padding:.75rem 3rem .875rem 1.25rem;-webkit-transition:.5s;transition:.5s}.f-scrollspy-tabs{flex-shrink:0;background-color:#fff;box-shadow:0 1px 5px 0 rgba(0,28,64,.06);border-radius:2px;padding:0 .125rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn{position:relative;display:-webkit-inline-box;display:inline-flex;height:2.75rem;line-height:2.75rem;padding:0 .875rem;cursor:pointer;min-width:5.75rem;white-space:nowrap;-webkit-box-pack:center;justify-content:center}.f-scrollspy-tabs .f-scrollspy-monitor-btn .f-scrollspy-monitor-title{white-space:nowrap;font-size:1rem}.f-scrollspy-tabs .f-scrollspy-monitor-btn::after{content:\"\";position:absolute;left:50%;margin-left:-.625rem;bottom:.3125rem;width:1.25rem;height:.1875rem;border-radius:7.125rem}"]
                }] }
    ];
    /** @nocollapse */
    ScrollspyComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: FarrisScrollSpyService },
        { type: ChangeDetectorRef }
    ]; };
    ScrollspyComponent.propDecorators = {
        scrollspyTemplate: [{ type: ContentChild, args: [ScrollspyItemTemplateDirective, { read: TemplateRef },] }],
        currentSectionId: [{ type: Input }],
        scrollGroupId: [{ type: Input }],
        fFollowType: [{ type: Input }],
        sidetabWidth: [{ type: Input }],
        scrollyspyListEl: [{ type: ViewChild, args: ["scrollyspyList",] }],
        scrollspyData: [{ type: Input }]
    };
    return ScrollspyComponent;
}());
export { ScrollspyComponent };
if (false) {
    /** @type {?} */
    ScrollspyComponent.prototype.scrollspyTemplate;
    /**
     * 当前active部分id
     * @type {?}
     */
    ScrollspyComponent.prototype.currentSectionId;
    /**
     * 当前滚动所有group
     * @type {?}
     */
    ScrollspyComponent.prototype.scrollGroupId;
    /**
     * 当前滚动显示样式，默认 side 可选参数 tab、fixedTab
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._followType;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype._emitFollowType;
    /** @type {?} */
    ScrollspyComponent.prototype.sidetabWidth;
    /** @type {?} */
    ScrollspyComponent.prototype.scrollyspyListEl;
    /** @type {?} */
    ScrollspyComponent.prototype._scrollspyData;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.scrollSpy;
    /**
     * @type {?}
     * @private
     */
    ScrollspyComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLXNjcm9sbHNweS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNjcm9sbHNweS8iLCJzb3VyY2VzIjpbImxpYi9mYXJyaXMtc2Nyb2xsc3B5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsVUFBVSxFQUE0QixTQUFTLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbEssT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFcEUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUVsQztJQUlJLHdDQUFtQixRQUEwQjtRQUExQixhQUFRLEdBQVIsUUFBUSxDQUFrQjtJQUFHLENBQUM7O2dCQUpwRCxTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLGlCQUFpQjtpQkFDNUI7Ozs7Z0JBUGlGLFdBQVc7O0lBVTdGLHFDQUFDO0NBQUEsQUFMSCxJQUtHO1NBRlksOEJBQThCOzs7SUFDN0Isa0RBQWlDOzs7OztBQUdqRCxtQ0FJRzs7O0lBSEMsMkJBQWE7O0lBQ2IsOEJBQWdCOztJQUNoQixnQ0FBbUI7Ozs7O0FBR3ZCLHNDQUdDOzs7SUFGQyx1Q0FBWTs7SUFDWix1Q0FBVzs7QUFHYjtJQStESSw0QkFBcUIsVUFBc0IsRUFBVSxTQUFpQyxFQUFTLGNBQWlDO1FBQTNHLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxjQUFTLEdBQVQsU0FBUyxDQUF3QjtRQUFTLG1CQUFjLEdBQWQsY0FBYyxDQUFtQjs7OztRQWhEdkgsa0JBQWEsR0FBVSxPQUFPLEVBQUUsQ0FBQzs7OztRQUVsQyxnQkFBVyxHQUFDLE1BQU0sQ0FBQzs7UUFFbkIsb0JBQWUsR0FBeUIsSUFBSSxDQUFDO1FBZ0I1QyxpQkFBWSxHQUFVLEdBQUcsQ0FBQztJQTRCbUcs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ZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIERpcmVjdGl2ZSwgVGVtcGxhdGVSZWYsIENvbnRlbnRDaGlsZCwgVmlld0NoaWxkLCBDaGFuZ2VEZXRlY3RvclJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZhcnJpc1Njcm9sbFNweVNlcnZpY2UgfSBmcm9tICcuL2ZhcnJpcy1zY3JvbGxzcHkuc2VydmljZSc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZ2V0VXVpZCB9IGZyb20gJy4vdXRpbHMnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tzY3JvbGxzcHlJdGVtXSdcclxuICB9KVxyXG4gIGV4cG9ydCBjbGFzcyBTY3JvbGxzcHlJdGVtVGVtcGxhdGVEaXJlY3RpdmUge1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+KSB7fVxyXG4gIH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2Ugc2Nyb2xsc3B5RGF0YSB7XHJcbiAgICBcImlkXCI6IHN0cmluZyxcclxuICAgIFwidGl0bGVcIjogc3RyaW5nLFxyXG4gICAgXCJ2aXNpYmxlXCI/OiBib29sZWFuXHJcbiAgfVxyXG4vLyDmu5rliqjnm5HlkKzliJfooajvvIzmmL7npLrmqKHlvI/mlLnlj5jvvIzmipvlh7rkuovku7bnu5PmnoRcclxuaW50ZXJmYWNlIFNweUxpc3RGb2xsb3dUeXBlQ2hhbmdle1xyXG4gIHByZXY6c3RyaW5nLFxyXG4gIG5leHQ6c3RyaW5nXHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnZmFycmlzLXNjcm9sbHNweScsXHJcbiAgdGVtcGxhdGVVcmw6Jy4vZmFycmlzLXNjcm9sbHNweS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOltcclxuICAgICcuL2ZhcnJpcy1zY3JvbGxzcHkuY29tcG9uZW50LnNjc3MnXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2Nyb2xsc3B5Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LEFmdGVyVmlld0luaXQge1xyXG5cclxuICAgIEBDb250ZW50Q2hpbGQoU2Nyb2xsc3B5SXRlbVRlbXBsYXRlRGlyZWN0aXZlLCB7cmVhZDogVGVtcGxhdGVSZWZ9KSBzY3JvbGxzcHlUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIC8qKua7muWKqOaVsOaNruWIl+ihqCAqL1xyXG4gICAgLy8gQElucHV0KCkgc2Nyb2xsc3B5RGF0YTpzY3JvbGxzcHlEYXRhW107XHJcbiAgICAvKirlvZPliY1hY3RpdmXpg6jliIZpZCAqL1xyXG4gICAgQElucHV0KCkgY3VycmVudFNlY3Rpb25JZDpzdHJpbmc7XHJcbiAgICAvKirlvZPliY3mu5rliqjmiYDmnIlncm91cCAqL1xyXG4gICAgQElucHV0KCkgc2Nyb2xsR3JvdXBJZDpzdHJpbmcgPSBnZXRVdWlkKCk7XHJcbiAgICAvKirlvZPliY3mu5rliqjmmL7npLrmoLflvI/vvIzpu5jorqQgc2lkZSDlj6/pgInlj4LmlbAgdGFi44CBZml4ZWRUYWIgKi9cclxuICAgIHByaXZhdGUgX2ZvbGxvd1R5cGU9J3NpZGUnO1xyXG4gICAgLy8g6K6w5b2V54q25oCB5pS55Y+YXHJcbiAgICBwcml2YXRlIF9lbWl0Rm9sbG93VHlwZTpTcHlMaXN0Rm9sbG93VHlwZUNoYW5nZT1udWxsO1xyXG4gICAgQElucHV0KCkgXHJcbiAgICBzZXQgZkZvbGxvd1R5cGUodmFsdWU6c3RyaW5nKXtcclxuICAgICAgaWYodmFsdWUhPT10aGlzLl9mb2xsb3dUeXBlKXtcclxuICAgICAgICB0aGlzLl9lbWl0Rm9sbG93VHlwZT17XHJcbiAgICAgICAgICBwcmV2OnRoaXMuX2ZvbGxvd1R5cGUsXHJcbiAgICAgICAgICBuZXh0OnZhbHVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNoYW5nZUZvbGxvd1R5cGUoKTtcclxuICAgICAgICB0aGlzLl9mb2xsb3dUeXBlPXZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9ICAgIFxyXG4gICAgZ2V0IGZGb2xsb3dUeXBlKCk6c3RyaW5ne1xyXG4gICAgICByZXR1cm4gdGhpcy5fZm9sbG93VHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKSBzaWRldGFiV2lkdGg6bnVtYmVyID0gMTQ1O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoXCJzY3JvbGx5c3B5TGlzdFwiKSBzY3JvbGx5c3B5TGlzdEVsO1xyXG5cclxuICAgIF9zY3JvbGxzcHlEYXRhOnNjcm9sbHNweURhdGFbXTtcclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHNjcm9sbHNweURhdGEodmFsdWUpe1xyXG4gICAgICBpZih2YWx1ZSl7XHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsc3B5RGF0YSA9IHZhbHVlLmZpbHRlcigoaXRlbSkgPT57XHJcbiAgICAgICAgICBpZihpdGVtLmhhc093blByb3BlcnR5KCd2aXNpYmxlJykgJiYgIWl0ZW0udmlzaWJsZSl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYodGhpcy5fc2Nyb2xsc3B5RGF0YSAmJiB0aGlzLl9zY3JvbGxzcHlEYXRhLmxlbmd0aCAmJiAhdGhpcy5jdXJyZW50U2VjdGlvbklkICl7XHJcbiAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSWQgPSB0aGlzLl9zY3JvbGxzcHlEYXRhWzBdLmlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNjcm9sbFNweS5zZXRDdXJyZW50U2VjdGlvbklkT2JqKHRoaXMuc2Nyb2xsR3JvdXBJZCwgdGhpcy5jdXJyZW50U2VjdGlvbklkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHNjcm9sbHNweURhdGEoKXtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbHNweURhdGE7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgc2Nyb2xsU3B5OiBGYXJyaXNTY3JvbGxTcHlTZXJ2aWNlLHByaXZhdGUgY2hhbmdlRGV0ZWN0b3I6IENoYW5nZURldGVjdG9yUmVmLCApIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAvLyBpZih0aGlzLnNjcm9sbHNweURhdGEgJiYgdGhpcy5zY3JvbGxzcHlEYXRhLmxlbmd0aCAmJiAhdGhpcy5jdXJyZW50U2VjdGlvbklkICl7XHJcbiAgICAgIC8vICAgdGhpcy5jdXJyZW50U2VjdGlvbklkID0gdGhpcy5zY3JvbGxzcHlEYXRhWzBdLmlkO1xyXG4gICAgICAvLyB9XHJcbiAgICAgIC8vIHRoaXMuc2Nyb2xsU3B5LnNldEN1cnJlbnRTZWN0aW9uSWRPYmoodGhpcy5zY3JvbGxHcm91cElkLCB0aGlzLmN1cnJlbnRTZWN0aW9uSWQpO1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNjcm9sbEdyb3VwSWQpO1xyXG4gICAgICB0aGlzLnNjcm9sbFNweS5zZXRHcm91cElkKHRoaXMuc2Nyb2xsR3JvdXBJZCk7XHJcbiAgICAgIHRoaXMuY2hhbmdlRm9sbG93VHlwZSgpO1xyXG4gICAgICAvLyDojrflj5blvZPliY1TZWN0aW9u55qESWRcclxuICAgICAgdGhpcy5zY3JvbGxTcHkuZ2V0Q3VycmVudFNlY3Rpb25JZCh0aGlzLnNjcm9sbEdyb3VwSWQpLnN1YnNjcmliZSgoY3VycmVudElkKT0+e1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlY3Rpb25JZCA9IGN1cnJlbnRJZDtcclxuICAgICAgICB0aGlzLnNjcm9sbFNweS51cGRhdGVTY3JvbGxTcGllc0FjdGl2ZUNsc05hbWUodGhpcy5zY3JvbGxHcm91cElkLGN1cnJlbnRJZCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8g6I635Y+W5a+55bqUQ29udGFpbmVy5Yy65Z+f77yM5Zyo5rua5Yqo5pe255qE5b2T5YmNU2VjdGlvbueahOWPmOWMllxyXG4gICAgICB0aGlzLnNjcm9sbFNweS51cGRhdGVTY3JvbGxHcm91cCh0aGlzLnNjcm9sbEdyb3VwSWQpLnN1YnNjcmliZSgoY3VycmVudFNlY3Rpb246IHN0cmluZyk6IHZvaWQgPT4ge1xyXG5cclxuICAgICAgICAgIHRoaXMuc2Nyb2xsU3B5LnNldEN1cnJlbnRTZWN0aW9uSWQodGhpcy5zY3JvbGxHcm91cElkLGN1cnJlbnRTZWN0aW9uKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy8g5pS55Y+YRm9sbG93VHlwZeaXtlxyXG4gICAgY2hhbmdlRm9sbG93VHlwZSgpe1xyXG4gICAgICBpZih0aGlzLnNjcm9sbEdyb3VwSWQmJnRoaXMuX2VtaXRGb2xsb3dUeXBlKXtcclxuICAgICAgICB0aGlzLnNjcm9sbFNweS5jaGFuZ2VHcm91cElkRm9sbG93VHlwZSh0aGlzLnNjcm9sbEdyb3VwSWQsdGhpcy5fZW1pdEZvbGxvd1R5cGUpO1xyXG4gICAgICAgIHRoaXMuX2VtaXRGb2xsb3dUeXBlPW51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvKirlvZPmu5rliqjkvY3nva7kuLpzaWRl5pe277yM6K+l57uE5Lu25pyA6L+R54i26IqC54K55re75YqgcmVsYXRpdmXlrprkvY0gKi9cclxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIGlmKCFwYXJlbnQuc3R5bGUucG9zaXRpb24gJiYgcGFyZW50LnN0eWxlLnBvc2l0aW9uICE9PSAncmVsYXRpdmUnICYmIHRoaXMuZkZvbGxvd1R5cGUgPT09ICdzaWRlJyl7XHJcbiAgICAgICAgICAgIHBhcmVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmKHRoaXMuc2Nyb2xsc3B5RGF0YSAmJiB0aGlzLnNjcm9sbHNweURhdGEubGVuZ3RoICYmIHRoaXMuY3VycmVudFNlY3Rpb25JZCl7XHJcbiAgICAgICAgLy8gICBpZih0aGlzLmN1cnJlbnRTZWN0aW9uSWQgIT09IHRoaXMuc2Nyb2xsc3B5RGF0YVswXS5pZCl7XHJcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKDIyMik7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnNjcm9sbHlzcHlMaXN0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI3Njcm9sbHNweS1cIit0aGlzLmN1cnJlbnRTZWN0aW9uSWQpO1xyXG4gICAgICAgIC8vICAgICBjb25zdCBmb2xsb3cgPSB7XHJcbiAgICAgICAgLy8gICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgICAvLyAgICAgICBpZDogdGhpcy5jdXJyZW50U2VjdGlvbklkXHJcbiAgICAgICAgLy8gICAgIH07XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGdyb3VwSWQgPSB0aGlzLnNjcm9sbEdyb3VwSWQgPyB0aGlzLnNjcm9sbEdyb3VwSWQ6ICdkZWZhdWx0JztcclxuICAgICAgICAvLyAgICAgdGhpcy5zY3JvbGxTcHkuZlNjcm9sbEZvbGxvd0NsaWNrKGdyb3VwSWQsZm9sbG93KTtcclxuICAgICAgICAvLyAgIH1cclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG59Il19