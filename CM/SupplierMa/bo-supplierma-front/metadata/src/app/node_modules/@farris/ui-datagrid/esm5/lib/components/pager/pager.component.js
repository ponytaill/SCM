/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DatagridComponent } from './../../datagrid.component';
import { NotifyService } from '@farris/ui-notify';
import { ChangeDetectorRef, Injector, Optional, TemplateRef } from '@angular/core';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:07
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-10-17 20:20:21
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, Output, EventEmitter, ElementRef, ViewChild } from '@angular/core';
import { PaginationControlsComponent } from '@farris/ui-pagination';
var DatagridPagerComponent = /** @class */ (function () {
    function DatagridPagerComponent(el, cd, inject) {
        this.el = el;
        this.cd = cd;
        this.inject = inject;
        this.pagerPos = 'right';
        this.id = 'farris-datagrid-pager';
        /**
         * 显示页码的数量
         */
        this.maxSize = 7;
        /**
         * 是否显示页码
         */
        this.directionLinks = true;
        this.autoHide = false;
        this.responsive = false;
        /**
         * 上页标签
         */
        this.previousLabel = '上页';
        /**
         * 下页标签
         */
        this.nextLabel = '下页';
        this.showPageList = false;
        this.showPageInfo = true;
        this.showPageNumber = true;
        this.locked = false;
        this.selectedData = [];
        this.viewMode = 'default';
        this.showSelectedList = false;
        this.showGotoInput = false;
        /**
         * 分页条自定义内容区模板
         */
        this.contentTemplate = null;
        this.data = null;
        this.pageChange = new EventEmitter();
        this.pageSizeChange = new EventEmitter();
        this.removeSelectedItem = new EventEmitter();
        this.clearSelectedItem = new EventEmitter();
        this.styles = { opacity: 1 };
        this.mouseInSelectedList = false;
        this.openSelectedList = false;
        this.selectionDataChange$ = null;
        if (this.inject) {
            this.notifySer = this.inject.get(NotifyService, null);
        }
    }
    Object.defineProperty(DatagridPagerComponent.prototype, "pagination", {
        get: /**
         * @return {?}
         */
        function () {
            return this.pager.paginationDirective;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridPagerComponent.prototype, "pageSize", {
        get: /**
         * @return {?}
         */
        function () {
            return this.pagination.getPageSize();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridPagerComponent.prototype, "total", {
        get: /**
         * @return {?}
         */
        function () {
            return this.pagination.getTotalItems();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridPagerComponent.prototype, "outerHeight", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.pc) {
                return this.pc.nativeElement.offsetHeight;
            }
            return 40;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DatagridPagerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.listenCheckDataChanged();
    };
    /**
     * @return {?}
     */
    DatagridPagerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.lockedStyles();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DatagridPagerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.selectedData && !changes.selectedData.isFirstChange()) {
            if (!this.selectedData || !this.selectedData.length) {
                this.closeSelectedList();
            }
        }
        if (changes.showSelectedList && !changes.showSelectedList.isFirstChange()) {
            this.listenCheckDataChanged();
        }
        if (changes.locked && !changes.locked.isFirstChange()) {
            this.lockedStyles();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridPagerComponent.prototype.listenCheckDataChanged = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.showSelectedList) {
            /** @type {?} */
            var dg = this.inject.get(DatagridComponent, null);
            if (dg) {
                this.selectionDataChange$ = dg.checkedChange.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    _this.selectedData = data;
                    if (!_this.cd['destroyed']) {
                        _this.cd.detectChanges();
                    }
                }));
            }
        }
        else {
            if (this.selectionDataChange$) {
                this.selectionDataChange$.unsubscribe();
                this.selectionDataChange$ = null;
            }
        }
    };
    /**
     * @param {?} pageIndex
     * @return {?}
     */
    DatagridPagerComponent.prototype.onPageChange = /**
     * @param {?} pageIndex
     * @return {?}
     */
    function (pageIndex) {
        if (typeof pageIndex === 'object') {
            pageIndex = pageIndex.pageIndex || 1;
        }
        this.pageChange.emit(Number.parseInt(pageIndex, 10));
    };
    /**
     * @param {?} pageSize
     * @return {?}
     */
    DatagridPagerComponent.prototype.onPageSizeChange = /**
     * @param {?} pageSize
     * @return {?}
     */
    function (pageSize) {
        this.pageSizeChange.emit(Number.parseInt(pageSize, 10));
    };
    /**
     * @return {?}
     */
    DatagridPagerComponent.prototype.lock = /**
     * @return {?}
     */
    function () {
        this.locked = true;
        this.lockedStyles();
    };
    /**
     * @return {?}
     */
    DatagridPagerComponent.prototype.unlock = /**
     * @return {?}
     */
    function () {
        this.locked = false;
        this.lockedStyles();
    };
    /**
     * @private
     * @return {?}
     */
    DatagridPagerComponent.prototype.lockedStyles = /**
     * @private
     * @return {?}
     */
    function () {
        this.styles = { opacity: this.locked ? 0.5 : 1 };
        this.cd.detectChanges();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridPagerComponent.prototype.onMouseEnter = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if (this.locked) {
            return;
        }
        this.mouseInSelectedList = true;
        if (this.selectedData && this.selectedData.length) {
            this.openSelectedList = !this.openSelectedList;
        }
        else {
            this.openSelectedList = false;
        }
    };
    /**
     * @return {?}
     */
    DatagridPagerComponent.prototype.closeSelectedList = /**
     * @return {?}
     */
    function () {
        this.openSelectedList = false;
        this.mouseInSelectedList = false;
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    DatagridPagerComponent.prototype.onDelSelectedItem = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        this.removeSelectedItem.emit(id);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridPagerComponent.prototype.onClearSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.clearSelectedItem.emit();
        this.closeSelectedList();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridPagerComponent.prototype.onSelectListPanelClose = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.closeSelectedList();
    };
    DatagridPagerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'datagrid-pager',
                    template: "<div class=\"f-datagrid-pager\" #pagerContainer [ngStyle]=\"styles\">\r\n    <pagination-controls #pager [id]=\"id\" [maxSize]=\"maxSize\"\r\n        [directionLinks]=\"directionLinks\"\r\n        [showPageList]=\"showPageList\"\r\n        [showPageInfo]=\"showPageInfo\"\r\n        [showPageNumber]=\"showPageNumber\"\r\n        [autoHide]=\"autoHide\" [responsive]=\"responsive\"\r\n        [previousLabel]=\"previousLabel\" [nextLabel]=\"nextLabel\"\r\n        [showGotoInput]=\"showGotoInput\"\r\n        (pageChange)=\"onPageChange($event)\"\r\n        (pageSizeChange)=\"onPageSizeChange($event)\"\r\n        [position]=\"pagerPos\"\r\n        [viewMode]=\"viewMode\" [showSelectedList]=\"showSelectedList\">\r\n\r\n        <div  class=\"pager-overlay-container\"  style=\"position: absolute;bottom: 0;left: -10px;\">\r\n            <pager-selected-list *ngIf=\"openSelectedList\"\r\n                [data]=\"selectedData | selectedItem: listItemFormatter\"\r\n                (close)=\"onSelectListPanelClose($event)\"\r\n                (remove)=\"onDelSelectedItem($event)\"\r\n                (clear)=\"onClearSelected($event)\"\r\n            ></pager-selected-list>\r\n        </div>\r\n\r\n        <div class=\"flex-fill pager-pos-right\" style=\"left: 0\" [style.position]=\"pagerPos==='center'? 'absolute':'relative'\">\r\n            <div class=\"d-flex flex-row\" style=\"align-items: center;\">\r\n                <span class=\"badge badge-pill badge-light mr-2\" *ngIf=\"showSelectedList\"\r\n                    style=\"cursor:pointer\" [attr.title]=\"'datagrid.selectionData.tooltip' | locale\"\r\n                    [class.badge-primary]=\"mouseInSelectedList\"\r\n                    [innerHTML]=\"'datagrid.selectionData.currentLenth' | locale | replaceX: selectedData.length\"\r\n                    (click)=\"onMouseEnter($event)\">\r\n                </span>\r\n\r\n                <div class=\"f-utils-fill mr-2 content-template\" *ngIf=\"contentTemplate && pagerPos === 'right'\">\r\n                    <ng-container [ngTemplateOutlet]=\"contentTemplate\" [ngTemplateOutletContext]=\"{ footerData: data }\"></ng-container>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"flex-fill pager-pos-left\" *ngIf=\"pagerPos === 'left'\">\r\n            <div class=\"d-flex flex-row\" style=\"align-items: center;\">\r\n                \r\n                <div class=\"f-utils-fill mr-2 content-template\" *ngIf=\"contentTemplate\">\r\n                    <ng-container [ngTemplateOutlet]=\"contentTemplate\" [ngTemplateOutletContext]=\"{ footerData: data }\"></ng-container>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n    </pagination-controls>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    DatagridPagerComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ChangeDetectorRef },
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    DatagridPagerComponent.propDecorators = {
        pagerPos: [{ type: Input }],
        id: [{ type: Input }],
        maxSize: [{ type: Input }],
        directionLinks: [{ type: Input }],
        autoHide: [{ type: Input }],
        responsive: [{ type: Input }],
        previousLabel: [{ type: Input }],
        nextLabel: [{ type: Input }],
        showPageList: [{ type: Input }],
        showPageInfo: [{ type: Input }],
        showPageNumber: [{ type: Input }],
        locked: [{ type: Input }],
        selectedData: [{ type: Input }],
        viewMode: [{ type: Input }],
        listItemFormatter: [{ type: Input }],
        showSelectedList: [{ type: Input }],
        showGotoInput: [{ type: Input }],
        contentTemplate: [{ type: Input }],
        data: [{ type: Input }],
        pageChange: [{ type: Output }],
        pageSizeChange: [{ type: Output }],
        removeSelectedItem: [{ type: Output }],
        clearSelectedItem: [{ type: Output }],
        pc: [{ type: ViewChild, args: ['pagerContainer',] }],
        pager: [{ type: ViewChild, args: ['pager',] }]
    };
    return DatagridPagerComponent;
}());
export { DatagridPagerComponent };
if (false) {
    /** @type {?} */
    DatagridPagerComponent.prototype.pagerPos;
    /** @type {?} */
    DatagridPagerComponent.prototype.id;
    /**
     * 显示页码的数量
     * @type {?}
     */
    DatagridPagerComponent.prototype.maxSize;
    /**
     * 是否显示页码
     * @type {?}
     */
    DatagridPagerComponent.prototype.directionLinks;
    /** @type {?} */
    DatagridPagerComponent.prototype.autoHide;
    /** @type {?} */
    DatagridPagerComponent.prototype.responsive;
    /**
     * 上页标签
     * @type {?}
     */
    DatagridPagerComponent.prototype.previousLabel;
    /**
     * 下页标签
     * @type {?}
     */
    DatagridPagerComponent.prototype.nextLabel;
    /** @type {?} */
    DatagridPagerComponent.prototype.showPageList;
    /** @type {?} */
    DatagridPagerComponent.prototype.showPageInfo;
    /** @type {?} */
    DatagridPagerComponent.prototype.showPageNumber;
    /** @type {?} */
    DatagridPagerComponent.prototype.locked;
    /** @type {?} */
    DatagridPagerComponent.prototype.selectedData;
    /** @type {?} */
    DatagridPagerComponent.prototype.viewMode;
    /** @type {?} */
    DatagridPagerComponent.prototype.listItemFormatter;
    /** @type {?} */
    DatagridPagerComponent.prototype.showSelectedList;
    /** @type {?} */
    DatagridPagerComponent.prototype.showGotoInput;
    /**
     * 分页条自定义内容区模板
     * @type {?}
     */
    DatagridPagerComponent.prototype.contentTemplate;
    /** @type {?} */
    DatagridPagerComponent.prototype.data;
    /** @type {?} */
    DatagridPagerComponent.prototype.pageChange;
    /** @type {?} */
    DatagridPagerComponent.prototype.pageSizeChange;
    /** @type {?} */
    DatagridPagerComponent.prototype.removeSelectedItem;
    /** @type {?} */
    DatagridPagerComponent.prototype.clearSelectedItem;
    /** @type {?} */
    DatagridPagerComponent.prototype.pc;
    /** @type {?} */
    DatagridPagerComponent.prototype.pager;
    /** @type {?} */
    DatagridPagerComponent.prototype.styles;
    /** @type {?} */
    DatagridPagerComponent.prototype.mouseInSelectedList;
    /** @type {?} */
    DatagridPagerComponent.prototype.openSelectedList;
    /**
     * @type {?}
     * @private
     */
    DatagridPagerComponent.prototype.selectionDataChange$;
    /**
     * @type {?}
     * @private
     */
    DatagridPagerComponent.prototype.notifySer;
    /** @type {?} */
    DatagridPagerComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    DatagridPagerComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridPagerComponent.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhZ3JpZC8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3BhZ2VyL3BhZ2VyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDL0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUE0QixXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7Ozs7OztBQVM3RyxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBaUIsU0FBUyxFQUFlLE1BQU0sZUFBZSxDQUFDO0FBQ2xJLE9BQU8sRUFBRSwyQkFBMkIsRUFBK0IsTUFBTSx1QkFBdUIsQ0FBQztBQUVqRztJQXlFSSxnQ0FBbUIsRUFBYyxFQUFVLEVBQXFCLEVBQXNCLE1BQWdCO1FBQW5GLE9BQUUsR0FBRixFQUFFLENBQVk7UUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUFzQixXQUFNLEdBQU4sTUFBTSxDQUFVO1FBcEU3RixhQUFRLEdBQUcsT0FBTyxDQUFDO1FBQ25CLE9BQUUsR0FBRyx1QkFBdUIsQ0FBQzs7OztRQUU3QixZQUFPLEdBQUcsQ0FBQyxDQUFDOzs7O1FBRVosbUJBQWMsR0FBRyxJQUFJLENBQUM7UUFFdEIsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUVqQixlQUFVLEdBQUcsS0FBSyxDQUFDOzs7O1FBRW5CLGtCQUFhLEdBQUcsSUFBSSxDQUFDOzs7O1FBRXJCLGNBQVMsR0FBRyxJQUFJLENBQUM7UUFDakIsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFDckIsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFDcEIsbUJBQWMsR0FBRyxJQUFJLENBQUM7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QUE0Qzs7SUFDNUMsdUNBQXVEOztJQXFCdkQsd0NBQXdCOztJQUV4QixxREFBNEI7O0lBQzVCLGtEQUF5Qjs7Ozs7SUFFekIsc0RBQWtEOzs7OztJQUVsRCwyQ0FBaUM7O0lBRXJCLG9DQUFxQjs7Ozs7SUFBRSxvQ0FBNkI7Ozs7O0lBQUUsd0NBQW9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnLi8uLi8uLi9kYXRhZ3JpZC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3RvclJlZiwgSW5qZWN0b3IsIE9wdGlvbmFsLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIFRlbXBsYXRlUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMDYgMDc6NDM6MDdcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTAtMTcgMjA6MjA6MjFcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQsIFZpZXdDaGlsZCwgSG9zdEJpbmRpbmcgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUGFnaW5hdGlvbkNvbnRyb2xzQ29tcG9uZW50LCBQYWdpbmF0aW9uQ29udHJvbHNEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLXBhZ2luYXRpb24nO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLXBhZ2VyJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9wYWdlLmNvbXBvbmVudC5odG1sJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0YWdyaWRQYWdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzIHtcclxuICAgIEBJbnB1dCgpIHBhZ2VyUG9zID0gJ3JpZ2h0JztcclxuICAgIEBJbnB1dCgpIGlkID0gJ2ZhcnJpcy1kYXRhZ3JpZC1wYWdlcic7XHJcbiAgICAvKiog5pi+56S66aG156CB55qE5pWw6YePICovXHJcbiAgICBASW5wdXQoKSBtYXhTaXplID0gNztcclxuICAgIC8qKiDmmK/lkKbmmL7npLrpobXnoIEgKi9cclxuICAgIEBJbnB1dCgpIGRpcmVjdGlvbkxpbmtzID0gdHJ1ZTtcclxuXHJcbiAgICBASW5wdXQoKSBhdXRvSGlkZSA9IGZhbHNlO1xyXG5cclxuICAgIEBJbnB1dCgpIHJlc3BvbnNpdmUgPSBmYWxzZTtcclxuICAgIC8qKiDkuIrpobXmoIfnrb4gKi9cclxuICAgIEBJbnB1dCgpIHByZXZpb3VzTGFiZWwgPSAn5LiK6aG1JztcclxuICAgIC8qKiDkuIvpobXmoIfnrb4gKi9cclxuICAgIEBJbnB1dCgpIG5leHRMYWJlbCA9ICfkuIvpobUnO1xyXG4gICAgQElucHV0KCkgc2hvd1BhZ2VMaXN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzaG93UGFnZUluZm8gPSB0cnVlO1xyXG4gICAgQElucHV0KCkgc2hvd1BhZ2VOdW1iZXIgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgbG9ja2VkID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KCkgc2VsZWN0ZWREYXRhID0gW107XHJcbiAgICBASW5wdXQoKSB2aWV3TW9kZTogJ2RlZmF1bHQnIHwgJ3NpbXBsZScgPSAnZGVmYXVsdCc7XHJcbiAgICBASW5wdXQoKSBsaXN0SXRlbUZvcm1hdHRlcjogKGRhdGEpID0+IHN0cmluZztcclxuXHJcbiAgICBASW5wdXQoKSBzaG93U2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KCkgc2hvd0dvdG9JbnB1dCA9IGZhbHNlO1xyXG5cclxuICAgIC8qKiDliIbpobXmnaHoh6rlrprkuYnlhoXlrrnljLrmqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpIGNvbnRlbnRUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiA9IG51bGw7XHJcbiAgICBASW5wdXQoKSBkYXRhID0gbnVsbDtcclxuXHJcbiAgICBAT3V0cHV0KCkgcGFnZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBwYWdlU2l6ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCkgcmVtb3ZlU2VsZWN0ZWRJdGVtID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNsZWFyU2VsZWN0ZWRJdGVtID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3BhZ2VyQ29udGFpbmVyJykgcGM6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdwYWdlcicpIHBhZ2VyOiBQYWdpbmF0aW9uQ29udHJvbHNDb21wb25lbnQ7XHJcblxyXG4gICAgZ2V0IHBhZ2luYXRpb24oKTogUGFnaW5hdGlvbkNvbnRyb2xzRGlyZWN0aXZlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYWdlci5wYWdpbmF0aW9uRGlyZWN0aXZlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXQgcGFnZVNpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGFnaW5hdGlvbi5nZXRQYWdlU2l6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB0b3RhbCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYWdpbmF0aW9uLmdldFRvdGFsSXRlbXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgb3V0ZXJIZWlnaHQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGMubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiA0MDtcclxuICAgIH1cclxuICAgIHN0eWxlcyA9IHsgb3BhY2l0eTogMSB9O1xyXG5cclxuICAgIG1vdXNlSW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgIG9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdGlvbkRhdGFDaGFuZ2UkOiBTdWJzY3JpcHRpb24gPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgbm90aWZ5U2VyOiBOb3RpZnlTZXJ2aWNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBlbDogRWxlbWVudFJlZiwgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIEBPcHRpb25hbCgpIHByaXZhdGUgaW5qZWN0OiBJbmplY3Rvcikge1xyXG4gICAgICAgIGlmICh0aGlzLmluamVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeVNlciA9IHRoaXMuaW5qZWN0LmdldDxOb3RpZnlTZXJ2aWNlPihOb3RpZnlTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5DaGVja0RhdGFDaGFuZ2VkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIHRoaXMubG9ja2VkU3R5bGVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLnNlbGVjdGVkRGF0YSAmJiAhY2hhbmdlcy5zZWxlY3RlZERhdGEuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RlZERhdGEgfHwgIXRoaXMuc2VsZWN0ZWREYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZVNlbGVjdGVkTGlzdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zaG93U2VsZWN0ZWRMaXN0ICYmICFjaGFuZ2VzLnNob3dTZWxlY3RlZExpc3QuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuQ2hlY2tEYXRhQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMubG9ja2VkICYmICFjaGFuZ2VzLmxvY2tlZC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2NrZWRTdHlsZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsaXN0ZW5DaGVja0RhdGFDaGFuZ2VkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNob3dTZWxlY3RlZExpc3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZGcgPSB0aGlzLmluamVjdC5nZXQoRGF0YWdyaWRDb21wb25lbnQsIG51bGwpO1xyXG4gICAgICAgICAgICBpZiAoZGcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uRGF0YUNoYW5nZSQgPSBkZy5jaGVja2VkQ2hhbmdlLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25EYXRhQ2hhbmdlJCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25EYXRhQ2hhbmdlJC51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25EYXRhQ2hhbmdlJCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25QYWdlQ2hhbmdlKHBhZ2VJbmRleDogYW55KSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBwYWdlSW5kZXggPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHBhZ2VJbmRleCA9IHBhZ2VJbmRleC5wYWdlSW5kZXggfHwgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wYWdlQ2hhbmdlLmVtaXQoTnVtYmVyLnBhcnNlSW50KHBhZ2VJbmRleCwgMTApKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VTaXplQ2hhbmdlKHBhZ2VTaXplOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnBhZ2VTaXplQ2hhbmdlLmVtaXQoTnVtYmVyLnBhcnNlSW50KHBhZ2VTaXplLCAxMCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvY2soKSB7XHJcbiAgICAgICAgdGhpcy5sb2NrZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubG9ja2VkU3R5bGVzKCk7XHJcbiAgICB9XHJcbiAgICB1bmxvY2soKSB7XHJcbiAgICAgICAgdGhpcy5sb2NrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmxvY2tlZFN0eWxlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbG9ja2VkU3R5bGVzKCkge1xyXG4gICAgICAgIHRoaXMuc3R5bGVzID0geyBvcGFjaXR5OiB0aGlzLmxvY2tlZD8gMC41IDogMSB9O1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VFbnRlcigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmxvY2tlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm1vdXNlSW5TZWxlY3RlZExpc3QgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRGF0YSAmJiB0aGlzLnNlbGVjdGVkRGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuU2VsZWN0ZWRMaXN0ID0gIXRoaXMub3BlblNlbGVjdGVkTGlzdDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGNsb3NlU2VsZWN0ZWRMaXN0KCkge1xyXG4gICAgICAgIHRoaXMub3BlblNlbGVjdGVkTGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubW91c2VJblNlbGVjdGVkTGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uRGVsU2VsZWN0ZWRJdGVtKGlkOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdGVkSXRlbS5lbWl0KGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsZWFyU2VsZWN0ZWQoJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGVkSXRlbS5lbWl0KCk7XHJcbiAgICAgICAgdGhpcy5jbG9zZVNlbGVjdGVkTGlzdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VsZWN0TGlzdFBhbmVsQ2xvc2UoJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZVNlbGVjdGVkTGlzdCgpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==