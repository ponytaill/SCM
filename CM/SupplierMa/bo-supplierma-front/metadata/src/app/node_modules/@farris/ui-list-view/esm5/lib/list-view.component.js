/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ElementRef, TemplateRef, ContentChild, Output, EventEmitter, Input, Renderer2, ViewChild, HostBinding, ChangeDetectorRef } from '@angular/core';
import { ListViewHeaderTemplateDirective, ListViewTemplateDirective, ListViewFooterTemplateDirective, ListViewEmptyTemplateDirective, } from './template.directive';
import { PaginationControlsComponent } from '@farris/ui-pagination';
var ListViewComponent = /** @class */ (function () {
    function ListViewComponent(el, renderer, cdr) {
        this.el = el;
        this.renderer = renderer;
        this.cdr = cdr;
        // @Input() height:number;
        /**
         * 列表数据
         */
        this.data = [];
        /**
         * 数据为空是否展示默认
         */
        this.showEmpty = true;
        /**
         * 是否自定义空数据模板
         */
        this.emptyTemplate = false;
        /**
         * 是否支持多选 默认为false
         */
        this.multipleSelect = false;
        /**
         * 是否支持分页 默认false
         */
        this.supportPaging = false;
        // 默认分页
        this.pagerOnServer = true;
        this.pageSize = 10;
        this.pageIndex = 1;
        /**
         * 启用跨页多选
         */
        this.enableMorePageSelect = false;
        this.showSelectedList = false;
        this.selectedItemFormat = null;
        /**
         * 保持选中状态，默认为 true； 启用多选后有效。
         * 当设为false时，选中项再次点击将取消选中状态
         */
        this.keepSelect = true;
        // 是否平铺
        this.fill = false;
        // 是否横向排列
        this.cardLayout = false;
        /**
         * 勾选值
         */
        this.checkValues = [];
        this.checkValuesChange = new EventEmitter();
        this.checkItems = [];
        this.checkItemsChange = new EventEmitter();
        // @Input() borderBottom:boolean = true;
        this.showPageList = true;
        this.showPageInfo = true;
        this.showPageNumber = true;
        this.showGotoInput = false;
        this._pageList = [10, 20, 30, 50, 100];
        this._total = 0;
        /**
         * 作为唯一标识的数据key值 如果没传 唯一标识为index值
         */
        this.listidName = 'id';
        /**
         * 点击某一行后
         */
        this.listClick = new EventEmitter();
        /**
         * 多选框 选中状态变化
         */
        this.checkChange = new EventEmitter();
        // 分页事件
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        /**
         * 当前展示列表数据
         */
        this.currentData = [];
        /**
         * 选中的列表数组
         */
        this.selectDataList = [];
        /**
         * 跨页多选记录
         */
        this.selectDataListWithOtherPager = [];
        this.maxSize = 7;
        this.directionLinks = true;
        this.autoHide = false;
        this.responsive = true;
        this.paginationOptions = {};
        this.labels = {
            previousLabel: ' ',
            nextLabel: ' ',
            screenReaderPaginationLabel: 'Pagination',
            screenReaderPageLabel: 'page',
            screenReaderCurrentLabel: "You're on page"
        };
        this.mouseInSelectedList = false;
        this.openSelectedList = false;
        this.differenceBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        function (a, b, fn) {
            /** @type {?} */
            var s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            function (el) { return !s.has(el); }));
        });
        this.sameBy = (/**
         * @param {?} a
         * @param {?} b
         * @param {?} fn
         * @return {?}
         */
        function (a, b, fn) {
            /** @type {?} */
            var s = new Set(b.map(fn));
            return a.map(fn).filter((/**
             * @param {?} el
             * @return {?}
             */
            function (el) { return s.has(el); }));
        });
    }
    Object.defineProperty(ListViewComponent.prototype, "activeIndex", {
        get: /**
         * @return {?}
         */
        function () {
            return this._activeIndex;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._activeIndex = val;
            this.dataInit();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewComponent.prototype, "pageList", {
        get: /**
         * @return {?}
         */
        function () {
            return this._pageList;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._pageList = val;
            if (this.pager) {
                this.pager.setPageList(val);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewComponent.prototype, "total", {
        get: /**
         * @return {?}
         */
        function () {
            return this._total;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (this._total !== val) {
                this._total = val || 0;
                this.paginationOptions = Object.assign(this.paginationOptions || {}, { totalItems: val });
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewComponent.prototype, "listviewFill", {
        get: /**
         * @return {?}
         */
        function () { return this.fill; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.paginationOptions = {
            id: 'Farris-listView-Pagination_' + (this.id || new Date().getTime()),
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total,
            remote: this.pagerOnServer
        };
        this.currentData = this.data;
        this.dataInit();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    ListViewComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.data && !changes.data.isFirstChange()) {
            this.currentData = this.data;
            this.dataInit();
        }
        if (changes['total'] && !changes.total.isFirstChange()) {
            this.paginationOptions['totalItems'] = this.total;
            this.paginationOptions = tslib_1.__assign({}, this.paginationOptions);
        }
        if (changes['pageIndex'] && !changes.pageIndex.isFirstChange()) {
            this.paginationOptions['currentPage'] = this.pageIndex;
            this.paginationOptions = tslib_1.__assign({}, this.paginationOptions);
        }
        if (changes['pageSize'] && !changes.pageSize.isFirstChange()) {
            this.paginationOptions['itemsPerPage'] = this.pageSize;
            this.paginationOptions = tslib_1.__assign({}, this.paginationOptions);
        }
        if (changes.checkValues && !changes.checkValues.isFirstChange()) {
            /** @type {?} */
            var change = this.differenceBy(changes.checkValues.currentValue || [], changes.checkValues.previousValue || [], (/**
             * @param {?} v
             * @return {?}
             */
            function (v) {
                return v;
            }));
            if (change) {
                if (!this.enableMorePageSelect) {
                    this.checkRows(this.checkValues);
                }
            }
        }
        if (changes.checkItems && !changes.checkItems.isFirstChange()) {
            this.selectDataListWithOtherPager = tslib_1.__spread(this.checkItems);
            /** @type {?} */
            var ids = this.checkItems.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n[_this.listidName]; }));
            this.checkedItems(ids, false);
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
    };
    /** 默认搜索模板 点击搜索 */
    /**
     * 默认搜索模板 点击搜索
     * @param {?} searchField
     * @return {?}
     */
    ListViewComponent.prototype.searchList = /**
     * 默认搜索模板 点击搜索
     * @param {?} searchField
     * @return {?}
     */
    function (searchField) {
        if (searchField !== '' && this.data && this.data.length) {
            this.currentData = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                /** @type {?} */
                var result;
                /** @type {?} */
                var listValue = Object.values(list);
                for (var i = 0; i < listValue.length; i++) {
                    if (typeof listValue[i] == 'string') {
                        if (listValue[i].toString().includes(searchField)) {
                            result = listValue[i].toString().includes(searchField);
                            break;
                        }
                    }
                }
                return result;
            }));
        }
        else {
            this.currentData = this.data;
        }
        return { listdata: this.currentData, searchValue: searchField, length: this.currentData.length };
    };
    /** 点击某一列事件 */
    /**
     * 点击某一列事件
     * @param {?} event
     * @param {?} listItem
     * @param {?} index
     * @param {?=} checkChangeEvent
     * @return {?}
     */
    ListViewComponent.prototype.listSelect = /**
     * 点击某一列事件
     * @param {?} event
     * @param {?} listItem
     * @param {?} index
     * @param {?=} checkChangeEvent
     * @return {?}
     */
    function (event, listItem, index, checkChangeEvent) {
        var _this = this;
        if (checkChangeEvent === void 0) { checkChangeEvent = false; }
        /** @type {?} */
        var isClickCheckbox = typeof event === 'boolean';
        if (listItem['unClick'] || listItem['selectDisable']) {
            return;
        }
        else {
            this.checkChange.emit({ listdata: listItem, index: index });
            /** @type {?} */
            var selectItemIndex = this.selectDataList.findIndex((/**
             * @param {?} item
             * @param {?} i
             * @return {?}
             */
            function (item, i) {
                return _this.getKey(item, i) === _this.getKey(listItem, index);
            }));
            if (this.multipleSelect) {
                if (listItem['checked']) {
                    if (!this.keepSelect || isClickCheckbox) {
                        // 支持多选 删除该选中行
                        this.selectDataList.splice(selectItemIndex, 1);
                        this.updateDataListForMorePager('remove', listItem);
                        listItem['checked'] = false;
                    }
                    else {
                        this.selectDataList.splice(selectItemIndex, 1);
                        this.selectDataList.unshift(listItem);
                    }
                }
                else {
                    // 支持多选 插入该选中行
                    if (selectItemIndex === -1) {
                        this.selectDataList.unshift(listItem);
                        this.updateDataListForMorePager('append', listItem);
                    }
                    else {
                        this.selectDataList.splice(selectItemIndex, 1);
                        this.selectDataList.unshift(listItem);
                    }
                    listItem['checked'] = true;
                }
            }
            else {
                // 不支持多选 替换当前选中行
                this.selectDataList = [];
                this.selectDataList.push(listItem);
            }
            if (!checkChangeEvent) {
                this.clickItem = listItem;
            }
            this.listClick.emit({ data: this.selectDataList, index: index, checkChangeEvent: checkChangeEvent });
        }
        if (this.multipleSelect) {
            /** @type {?} */
            var ids = this.data.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return !!item.checked; })).map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item[_this.listidName]; }));
            if (this.enableMorePageSelect) {
                ids = this.selectDataListWithOtherPager.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this.listidName]; }));
            }
            this.onCheckValuesChange(ids);
        }
    };
    /** 获得每一行list 唯一标识 */
    /**
     * 获得每一行list 唯一标识
     * @param {?} list
     * @param {?} index
     * @return {?}
     */
    ListViewComponent.prototype.getKey = /**
     * 获得每一行list 唯一标识
     * @param {?} list
     * @param {?} index
     * @return {?}
     */
    function (list, index) {
        if (this.listidName && list.hasOwnProperty(this.listidName)) {
            return list[this.listidName];
        }
        else {
            return index;
        }
    };
    /** checkbox状态变化 */
    /**
     * checkbox状态变化
     * @param {?} event
     * @param {?} changeData
     * @param {?} i
     * @return {?}
     */
    ListViewComponent.prototype.getSelect = /**
     * checkbox状态变化
     * @param {?} event
     * @param {?} changeData
     * @param {?} i
     * @return {?}
     */
    function (event, changeData, i) {
        /** @type {?} */
        var state = event.checked;
        this.listSelect(state, changeData, i, true);
    };
    /** 排序事件 */
    /**
     * 排序事件
     * @param {?} sortkeyName
     * @param {?=} sortType
     * @return {?}
     */
    ListViewComponent.prototype.sort = /**
     * 排序事件
     * @param {?} sortkeyName
     * @param {?=} sortType
     * @return {?}
     */
    function (sortkeyName, sortType) {
        if (sortType === void 0) { sortType = 'asc'; }
        this.currentData.sort(this.compare(sortkeyName, sortType));
        return { sortResult: { listdata: this.currentData, sortkeyName: sortkeyName, sortType: sortType } };
    };
    /**
     * @param {?} primaryValue
     * @return {?}
     */
    ListViewComponent.prototype.selectRow = /**
     * @param {?} primaryValue
     * @return {?}
     */
    function (primaryValue) {
        var _this = this;
        if (this.currentData && this.currentData.length > 0) {
            /** @type {?} */
            var row = this.currentData.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item[_this.listidName] === primaryValue; }));
            if (row) {
                this.clickItem = row;
                this.cdr.markForCheck();
            }
        }
    };
    /**
     * @private
     * @param {?} KeyName
     * @param {?} type
     * @return {?}
     */
    ListViewComponent.prototype.compare = /**
     * @private
     * @param {?} KeyName
     * @param {?} type
     * @return {?}
     */
    function (KeyName, type) {
        if (type === 'desc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            function (obj1, obj2) {
                /** @type {?} */
                var val1 = obj1[KeyName];
                /** @type {?} */
                var val2 = obj2[KeyName];
                if (val2 < val1) {
                    return 1;
                }
                else if (val2 > val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
        if (type === 'asc') {
            return (/**
             * @param {?} obj1
             * @param {?} obj2
             * @return {?}
             */
            function (obj1, obj2) {
                /** @type {?} */
                var val1 = obj1[KeyName];
                /** @type {?} */
                var val2 = obj2[KeyName];
                if (val2 > val1) {
                    return 1;
                }
                else if (val2 < val1) {
                    return -1;
                }
                else {
                    return 0;
                }
            });
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    ListViewComponent.prototype.getItemActive = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        // 不管是否开启多选，当前行只有一行
        if (this.listidName && this.clickItem) {
            return item[this.listidName] === this.clickItem[this.listidName];
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} page
     * @return {?}
     */
    ListViewComponent.prototype.onPageChange = /**
     * @param {?} page
     * @return {?}
     */
    function (page) {
        if (this.pageIndex !== page.pageIndex) {
            this.pageIndex = page.pageIndex;
            this.paginationOptions.currentPage = page.pageIndex;
            // this.paginationOptions = {...this.paginationOptions};
            this.pageChanged.emit({ pageInfo: page });
        }
    };
    /**
     * @param {?} pageSize
     * @return {?}
     */
    ListViewComponent.prototype.onPageSizeChange = /**
     * @param {?} pageSize
     * @return {?}
     */
    function (pageSize) {
        // console.log(this.pageSize !== pageSize && this.total);
        if (this.pageSize !== pageSize && this.total) {
            this.paginationOptions.itemsPerPage = pageSize;
            this.pageSize = pageSize;
            /** @type {?} */
            var total = this.total;
            /** @type {?} */
            var pageLength = Math.floor(total / pageSize);
            if (total % pageSize > 0) {
                pageLength += 1;
            }
            if (pageLength && this.pageIndex > pageLength) {
                this.pageIndex = pageLength;
                this.paginationOptions.currentPage = this.pageIndex;
            }
            // this.paginationOptions = {...this.paginationOptions};
            this.pageSizeChanged.emit({ pageInfo: { pageIndex: this.pageIndex, pageSize: pageSize } });
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.getCurrentData = /**
     * @return {?}
     */
    function () {
        return this.currentData;
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.getSelectData = /**
     * @return {?}
     */
    function () {
        return this.selectDataList;
    };
    /** 支持重新设置listview数据 */
    /**
     * 支持重新设置listview数据
     * @param {?} listviewData
     * @return {?}
     */
    ListViewComponent.prototype.setData = /**
     * 支持重新设置listview数据
     * @param {?} listviewData
     * @return {?}
     */
    function (listviewData) {
        this.currentData = listviewData;
        this.data = listviewData;
        this.dataInit();
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.dataInit = /**
     * @return {?}
     */
    function () {
        if (this.data && this.data.length) {
            this.selectDataList = this.data.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                return list['checked'];
            }));
            if (this.activeIndex >= 0 && this.activeIndex <= (this.data.length - 1)) {
                /** @type {?} */
                var dataItem = this.data[this.activeIndex];
                if (dataItem) {
                    this.clickItem = dataItem;
                    this.selectDataList.push(this.clickItem);
                }
            }
            else if (this.activeIndex < 0) {
                return;
            }
            else {
                if (!this.selectDataList.length && !this.multipleSelect) {
                    this.selectDataList.push(this.data[0]);
                }
                this.clickItem = this.data[0];
            }
        }
        this.updateDataListForMorePager();
        if (this.cdr) {
            this.cdr.detectChanges();
        }
    };
    /**
     * @private
     * @param {?=} active
     * @param {?=} listItem
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.updateDataListForMorePager = /**
     * @private
     * @param {?=} active
     * @param {?=} listItem
     * @param {?=} emit
     * @return {?}
     */
    function (active, listItem, emit) {
        var _this = this;
        if (active === void 0) { active = ''; }
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect && this.enableMorePageSelect) {
            if (active === 'remove' && listItem) {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            if (typeof listItem === 'object') {
                                return n[_this.listidName] != listItem[_this.listidName];
                            }
                            else {
                                return n[_this.listidName] != listItem;
                            }
                        }));
                }
                else {
                    this.selectDataListWithOtherPager =
                        this.selectDataListWithOtherPager.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            return listItem.indexOf((/**
                             * @param {?} a
                             * @return {?}
                             */
                            function (a) { return a[_this.listidName] === n[_this.listidName]; })) === -1;
                        }));
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: tslib_1.__spread(this.selectDataListWithOtherPager), instance: this });
                }
            }
            else if (active === 'append') {
                if (!Array.isArray(listItem)) {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataListWithOtherPager, [listItem]);
                }
                else {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataListWithOtherPager, listItem);
                }
                if (emit) {
                    this.checkItemsChange.emit({ items: tslib_1.__spread(this.selectDataListWithOtherPager), instance: this });
                }
            }
            else {
                if (!this.selectDataListWithOtherPager.length) {
                    this.selectDataListWithOtherPager = tslib_1.__spread(this.selectDataList);
                }
                else {
                    /** @type {?} */
                    var newCheckeds_1 = this.sameBy(this.currentData, this.selectDataListWithOtherPager, (/**
                     * @param {?} v
                     * @return {?}
                     */
                    function (v) { return v[_this.listidName]; }));
                    if (newCheckeds_1 && newCheckeds_1.length) {
                        this.data.forEach((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            item.checked = newCheckeds_1.includes(item[_this.listidName]);
                        }));
                    }
                }
            }
        }
    };
    /** 全选 */
    /**
     * 全选
     * @return {?}
     */
    ListViewComponent.prototype.listCheckAll = /**
     * 全选
     * @return {?}
     */
    function () {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = true;
            }));
            this.selectDataList = this.currentData.filter((/**
             * @param {?} list
             * @return {?}
             */
            function (list) {
                return list['checked'];
            }));
            this.updateDataListForMorePager('append', this.currentData);
            this.cdr.markForCheck();
        }
    };
    /** 取消全选 */
    /**
     * 取消全选
     * @return {?}
     */
    ListViewComponent.prototype.listCheckAllCancel = /**
     * 取消全选
     * @return {?}
     */
    function () {
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = false;
            }));
            this.selectDataList = [];
            this.updateDataListForMorePager('remove', this.currentData);
            this.cdr.markForCheck();
        }
    };
    /**
     * 勾选行
     * @param ids ids
     */
    /**
     * 勾选行
     * @param {?} ids ids
     * @return {?}
     */
    ListViewComponent.prototype.checkRows = /**
     * 勾选行
     * @param {?} ids ids
     * @return {?}
     */
    function (ids) {
        var _this = this;
        if (this.multipleSelect) {
            if (!ids || ids.length < 1) {
                this.listCheckAllCancel();
                return;
            }
            this.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (ids.includes(item[_this.listidName])) {
                    item.checked = true;
                }
                else {
                    item.checked = false;
                }
            }));
            // this.onCheckValuesChange(ids);
            this.cdr.markForCheck();
        }
    };
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    ListViewComponent.prototype.onCheckValuesChange = /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        this.checkValuesChange.emit(ids);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onMouseEnter = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        this.mouseInSelectedList = true;
        if (this.selectDataListWithOtherPager && this.selectDataListWithOtherPager.length) {
            this.openSelectedList = !this.openSelectedList;
        }
        else {
            this.openSelectedList = false;
        }
    };
    /**
     * @return {?}
     */
    ListViewComponent.prototype.closeSelectedList = /**
     * @return {?}
     */
    function () {
        this.openSelectedList = false;
        this.mouseInSelectedList = false;
        if (!this.cdr['destroyed']) {
            this.cdr.detectChanges();
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    ListViewComponent.prototype.onDelSelectedItem = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        this.currentData.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item[_this.listidName] == id) {
                item.checked = false;
            }
        }));
        this.selectDataList = this.selectDataList.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n[_this.listidName] != id; }));
        this.updateDataListForMorePager('remove', id);
        this.updateCheckedValues();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onClearSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // this.clearSelectedItem.emit();
        this.closeSelectedList();
        this.listCheckAllCancel();
        this.selectDataListWithOtherPager = [];
        this.checkValues = [];
        this.onCheckValuesChange([]);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ListViewComponent.prototype.onSelectListPanelClose = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.closeSelectedList();
    };
    /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.updateCheckedValues = /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    function (emit) {
        var _this = this;
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect) {
            if (!this.enableMorePageSelect) {
                this.checkValues = this.selectDataList.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName]; }));
            }
            else {
                this.checkValues = this.selectDataListWithOtherPager.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName]; }));
            }
            if (emit) {
                this.onCheckValuesChange(this.checkValues);
                this.checkItemsChange.emit({ items: this.selectDataListWithOtherPager, instance: this });
            }
        }
    };
    /**
     * @param {?=} clearAll
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.clearCheckeds = /**
     * @param {?=} clearAll
     * @param {?=} emit
     * @return {?}
     */
    function (clearAll, emit) {
        if (clearAll === void 0) { clearAll = true; }
        if (emit === void 0) { emit = true; }
        if (this.multipleSelect) {
            this.currentData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.checked = false;
            }));
            this.selectDataList = [];
            if (clearAll) {
                this.selectDataListWithOtherPager = [];
            }
            else {
                this.updateDataListForMorePager('remove', this.currentData);
            }
            if (emit) {
                this.updateCheckedValues(emit);
            }
            this.cdr.markForCheck();
        }
    };
    /**
     * @private
     * @param {?} ids
     * @param {?} checked
     * @param {?} emit
     * @return {?}
     */
    ListViewComponent.prototype._setItemsCheckedStatus = /**
     * @private
     * @param {?} ids
     * @param {?} checked
     * @param {?} emit
     * @return {?}
     */
    function (ids, checked, emit) {
        var _this = this;
        if (ids && ids.length) {
            /** @type {?} */
            var action = checked ? 'append' : 'remove';
            ids.forEach((/**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                /** @type {?} */
                var id = i;
                if (typeof i === 'object') {
                    id = i[_this.listidName];
                }
                /** @type {?} */
                var item = _this.data.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.listidName] === id; }));
                if (item) {
                    item.checked = checked;
                }
                if (checked) {
                    _this.updateDataListForMorePager('append', i, false);
                }
                else {
                    _this.updateDataListForMorePager('remove', id, false);
                }
            }));
            this.updateCheckedValues(emit);
            this.cdr.markForCheck();
        }
    };
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.unCheckItems = /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    function (ids, emit) {
        if (emit === void 0) { emit = false; }
        this._setItemsCheckedStatus(ids, false, emit);
    };
    /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    ListViewComponent.prototype.checkedItems = /**
     * @param {?} ids
     * @param {?=} emit
     * @return {?}
     */
    function (ids, emit) {
        if (emit === void 0) { emit = false; }
        this._setItemsCheckedStatus(ids, true, emit);
    };
    ListViewComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-list-view',
                    template: "<div class=\"f-list-view\" [ngClass]=\"{'f-list-view-multiple': multipleSelect}\">\r\n    <div class=\"f-list-view-header\" *ngIf=\"headerTemplate\">\r\n        <ng-container [ngTemplateOutlet]=\"headerTemplate\"></ng-container>\r\n    </div>\r\n    <div class=\"f-list-view-content\">\r\n        <!-- bugNum:449874:\u589E\u52A0ngClass\u7684\u5224\u65AD\u6761\u4EF6 -->\r\n        <ul class=\"f-list-view-group\" [ngClass]=\"{'d-flex flex-wrap': cardLayout && currentData && currentData.length}\">\r\n            <ng-container *ngIf=\"currentData&&currentData.length;else emptyData\">\r\n                <li class=\"f-list-view-group-item {{listClassName}}\"\r\n                    *ngFor=\"let list of (supportPaging ? (currentData | paginate: paginationOptions) : currentData); let i = index;let first = first; let last = last\"\r\n                    [id]=\"getKey(list,i)\" (click)=\"listSelect($event,list,i)\"\r\n                    [ngClass]=\"{'f-un-click': list['unClick'],'f-un-select':list['selectDisable'],'f-listview-active':getItemActive(list)}\">\r\n                    <div class=\"f-list-select\" *ngIf=\"multipleSelect\" (click)=\"$event.stopPropagation()\">\r\n                        <list-view-checkout [id]=\"'list-'+getKey(list,i)\"\r\n                            [disabled]=\"list['selectDisable']||list['unClick']\" [checked]=\"list['checked']\"\r\n                            (checkedChange)=\"getSelect($event,list,i)\"></list-view-checkout>\r\n                    </div>\r\n                    <div class=\"f-list-content\">\r\n                        <ng-container [ngTemplateOutlet]=\"listTemplate\"\r\n                            [ngTemplateOutletContext]=\"{ item: list , index:i, selectedItem: clickItem, first:first,last:last }\">\r\n                        </ng-container>\r\n                    </div>\r\n                </li>\r\n            </ng-container>\r\n\r\n            <ng-template #emptyData>\r\n                <!-- \u7A7A\u6570\u636E\u9ED8\u8BA4\u6A21\u677F -->\r\n                <div class=\"f-list-view-emptydata\" *ngIf=\"showEmpty&&!emptyTemplate;else customEmpty\">\r\n                    <p class=\"f-empty-title\">{{ 'listview.emptyMessage' | locale }}</p>\r\n                </div>\r\n                <!-- \u81EA\u5B9A\u4E49\u7A7A\u6570\u636E\u6A21\u677F -->\r\n                <ng-template #customEmpty>\r\n                    <ng-container [ngTemplateOutlet]=\"emptyDataTemplate\"></ng-container>\r\n                </ng-template>\r\n\r\n            </ng-template>\r\n        </ul>\r\n    </div>\r\n    <div class=\"f-list-view-footer\" *ngIf=\"footerTemplate || supportPaging\">\r\n        <ng-container [ngTemplateOutlet]=\"footerTemplate\">\r\n            <div class=\"f-paging-wrapper\" *ngIf=\"supportPaging\">\r\n                <pagination-controls #pager [id]=\"paginationOptions.id\" [maxSize]=\"maxSize\"\r\n                    [directionLinks]=\"directionLinks\" [autoHide]=\"autoHide\" [responsive]=\"responsive\"\r\n                    [previousLabel]=\"labels.previousLabel\"\r\n                    [nextLabel]=\"labels.nextLabel\"\r\n                    [screenReaderPaginationLabel]=\"labels.screenReaderPaginationLabel\"\r\n                    [screenReaderPageLabel]=\"labels.screenReaderPageLabel\"\r\n                    [showPageList]=\"showPageList\"\r\n                    [showPageInfo]=\"showPageInfo\"\r\n                    [showPageNumber]=\"showPageNumber\"\r\n                    [showGotoInput]=\"showGotoInput\"\r\n                    [screenReaderCurrentLabel]=\"labels.screenReaderCurrentLabel\"\r\n                    (pageChange)=\"onPageChange($event)\"\r\n                    (pageSizeChange)=\"onPageSizeChange($event)\" \r\n                    [showSelectedList]=\"showSelectedList && enableMorePageSelect\">\r\n\r\n                    <div class=\"flex-fill\" >\r\n                        <div>\r\n                            <span class=\"badge badge-pill badge-light\" *ngIf=\"showSelectedList\"\r\n                                style=\"cursor:pointer;\" [attr.title]=\"'datagrid.selectionData.tooltip' | locale\"\r\n                                [class.badge-primary]=\"mouseInSelectedList\"\r\n                                [innerHTML]=\"'datagrid.selectionData.currentLenth' | locale | replaceX: selectDataListWithOtherPager.length\"\r\n                                (click)=\"onMouseEnter($event)\">\r\n                            </span>\r\n                            <pagination-selected-list *ngIf=\"openSelectedList\"\r\n                                [data]=\"selectDataListWithOtherPager | formatItems: selectedItemFormat\"\r\n                                (close)=\"onSelectListPanelClose($event)\"\r\n                                (remove)=\"onDelSelectedItem($event)\"\r\n                                (clear)=\"onClearSelected($event)\"\r\n                            ></pagination-selected-list>\r\n                        </div>\r\n                    </div>\r\n\r\n                </pagination-controls>\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</div>",
                    styles: [":host{height:100%}:host.f-listview-fill{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;overflow:hidden}:host.f-listview-fill .f-list-view{height:100%}:host.f-listview-fill .f-list-view .f-list-view-header{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-footer{flex-shrink:0}:host.f-listview-fill .f-list-view .f-list-view-content{overflow-y:auto;-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0}:host .f-list-view{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}:host .f-list-view .f-paging-wrapper{padding:14px 0}:host .f-list-view-group-item{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}:host .f-list-view-group-item.f-none-border{border-bottom:0}:host .f-list-view-group-item .f-list-content{-webkit-box-flex:1;flex:1 1 auto;width:100%}:host .f-list-select{padding:0 14px}:host .f-list-view-emptydata .f-empty-title{font-size:14px;line-height:22px;color:#999;padding:20px 0;text-align:center}"]
                }] }
    ];
    /** @nocollapse */
    ListViewComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: ChangeDetectorRef }
    ]; };
    ListViewComponent.propDecorators = {
        headerTemplate: [{ type: ContentChild, args: [ListViewHeaderTemplateDirective, { read: TemplateRef },] }],
        listTemplate: [{ type: ContentChild, args: [ListViewTemplateDirective, { read: TemplateRef },] }],
        footerTemplate: [{ type: ContentChild, args: [ListViewFooterTemplateDirective, { read: TemplateRef },] }],
        emptyDataTemplate: [{ type: ContentChild, args: [ListViewEmptyTemplateDirective, { read: TemplateRef },] }],
        listGroup: [{ type: ViewChild, args: ['listGroup',] }],
        pager: [{ type: ViewChild, args: ['pager',] }],
        data: [{ type: Input }],
        id: [{ type: Input }],
        showEmpty: [{ type: Input }],
        emptyTemplate: [{ type: Input }],
        multipleSelect: [{ type: Input }],
        supportPaging: [{ type: Input }],
        pagerOnServer: [{ type: Input }],
        pageSize: [{ type: Input }],
        pageIndex: [{ type: Input }],
        enableMorePageSelect: [{ type: Input }],
        showSelectedList: [{ type: Input }],
        selectedItemFormat: [{ type: Input }],
        keepSelect: [{ type: Input }],
        fill: [{ type: Input }],
        cardLayout: [{ type: Input }],
        activeIndex: [{ type: Input }],
        listClassName: [{ type: Input }],
        checkValues: [{ type: Input }],
        checkValuesChange: [{ type: Output }],
        checkItems: [{ type: Input }],
        checkItemsChange: [{ type: Input }],
        showPageList: [{ type: Input }],
        showPageInfo: [{ type: Input }],
        showPageNumber: [{ type: Input }],
        showGotoInput: [{ type: Input }],
        pageList: [{ type: Input }],
        total: [{ type: Input }],
        listidName: [{ type: Input }],
        listviewFill: [{ type: HostBinding, args: ['class.f-listview-fill',] }],
        listClick: [{ type: Output }],
        checkChange: [{ type: Output }],
        pageChanged: [{ type: Output }],
        pageSizeChanged: [{ type: Output }]
    };
    return ListViewComponent;
}());
export { ListViewComponent };
if (false) {
    /** @type {?} */
    ListViewComponent.prototype.headerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listTemplate;
    /** @type {?} */
    ListViewComponent.prototype.footerTemplate;
    /** @type {?} */
    ListViewComponent.prototype.emptyDataTemplate;
    /** @type {?} */
    ListViewComponent.prototype.listGroup;
    /** @type {?} */
    ListViewComponent.prototype.pager;
    /**
     * 列表数据
     * @type {?}
     */
    ListViewComponent.prototype.data;
    /** @type {?} */
    ListViewComponent.prototype.id;
    /**
     * 数据为空是否展示默认
     * @type {?}
     */
    ListViewComponent.prototype.showEmpty;
    /**
     * 是否自定义空数据模板
     * @type {?}
     */
    ListViewComponent.prototype.emptyTemplate;
    /**
     * 是否支持多选 默认为false
     * @type {?}
     */
    ListViewComponent.prototype.multipleSelect;
    /**
     * 是否支持分页 默认false
     * @type {?}
     */
    ListViewComponent.prototype.supportPaging;
    /** @type {?} */
    ListViewComponent.prototype.pagerOnServer;
    /** @type {?} */
    ListViewComponent.prototype.pageSize;
    /** @type {?} */
    ListViewComponent.prototype.pageIndex;
    /**
     * 启用跨页多选
     * @type {?}
     */
    ListViewComponent.prototype.enableMorePageSelect;
    /** @type {?} */
    ListViewComponent.prototype.showSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.selectedItemFormat;
    /**
     * 保持选中状态，默认为 true； 启用多选后有效。
     * 当设为false时，选中项再次点击将取消选中状态
     * @type {?}
     */
    ListViewComponent.prototype.keepSelect;
    /** @type {?} */
    ListViewComponent.prototype.fill;
    /** @type {?} */
    ListViewComponent.prototype.cardLayout;
    /** @type {?} */
    ListViewComponent.prototype._activeIndex;
    /** @type {?} */
    ListViewComponent.prototype.listClassName;
    /**
     * 勾选值
     * @type {?}
     */
    ListViewComponent.prototype.checkValues;
    /** @type {?} */
    ListViewComponent.prototype.checkValuesChange;
    /** @type {?} */
    ListViewComponent.prototype.checkItems;
    /** @type {?} */
    ListViewComponent.prototype.checkItemsChange;
    /** @type {?} */
    ListViewComponent.prototype.showPageList;
    /** @type {?} */
    ListViewComponent.prototype.showPageInfo;
    /** @type {?} */
    ListViewComponent.prototype.showPageNumber;
    /** @type {?} */
    ListViewComponent.prototype.showGotoInput;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype._pageList;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype._total;
    /**
     * 作为唯一标识的数据key值 如果没传 唯一标识为index值
     * @type {?}
     */
    ListViewComponent.prototype.listidName;
    /**
     * 点击某一行后
     * @type {?}
     */
    ListViewComponent.prototype.listClick;
    /**
     * 多选框 选中状态变化
     * @type {?}
     */
    ListViewComponent.prototype.checkChange;
    /** @type {?} */
    ListViewComponent.prototype.pageChanged;
    /** @type {?} */
    ListViewComponent.prototype.pageSizeChanged;
    /**
     * 当前展示列表数据
     * @type {?}
     */
    ListViewComponent.prototype.currentData;
    /**
     * 选中的列表数组
     * @type {?}
     */
    ListViewComponent.prototype.selectDataList;
    /**
     * 跨页多选记录
     * @type {?}
     */
    ListViewComponent.prototype.selectDataListWithOtherPager;
    /** @type {?} */
    ListViewComponent.prototype.clickItem;
    /** @type {?} */
    ListViewComponent.prototype.maxSize;
    /** @type {?} */
    ListViewComponent.prototype.directionLinks;
    /** @type {?} */
    ListViewComponent.prototype.autoHide;
    /** @type {?} */
    ListViewComponent.prototype.responsive;
    /** @type {?} */
    ListViewComponent.prototype.paginationOptions;
    /** @type {?} */
    ListViewComponent.prototype.labels;
    /** @type {?} */
    ListViewComponent.prototype.mouseInSelectedList;
    /** @type {?} */
    ListViewComponent.prototype.openSelectedList;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.differenceBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.sameBy;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    ListViewComponent.prototype.cdr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbGlzdC12aWV3LyIsInNvdXJjZXMiOlsibGliL2xpc3Qtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUE0QixVQUFVLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5RyxXQUFXLEVBQTRCLGlCQUFpQixFQUMxRSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0gsK0JBQStCLEVBQy9CLHlCQUF5QixFQUN6QiwrQkFBK0IsRUFDL0IsOEJBQThCLEdBQ2pDLE1BQU0sc0JBQXNCLENBQUM7QUFFOUIsT0FBTyxFQUFzQiwyQkFBMkIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBR3hGO0lBa0pJLDJCQUFvQixFQUFjLEVBQVUsUUFBbUIsRUFBVSxHQUFzQjtRQUEzRSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLFFBQUcsR0FBSCxHQUFHLENBQW1COzs7OztRQS9IdEYsU0FBSSxHQUFHLEVBQUUsQ0FBQzs7OztRQUtWLGNBQVMsR0FBRyxJQUFJLENBQUM7Ozs7UUFFakIsa0JBQWEsR0FBRyxLQUFLLENBQUM7Ozs7UUFFdEIsbUJBQWMsR0FBRyxLQUFLLENBQUM7Ozs7UUFHdkIsa0JBQWEsR0FBRyxLQUFLLENBQUM7O1FBR3RCLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFDZCxjQUFTLEdBQUcsQ0FBQyxDQUFDOzs7O1FBRWQseUJBQW9CLEdBQUcsS0FBSyxDQUFDO1FBQzdCLHFCQUFnQixHQUFHLEtBQUssQ0FBQztRQUN6Qix1QkFBa0IsR0FBMEIsSUFBSSxDQUFDOzs7OztRQU1qRCxlQUFVLEdBQUcsSUFBSSxDQUFD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Ozs7OztJQUUvQiwyQ0FBZ0M7Ozs7O0lBR2hDLDBDQUErQjs7SUFHL0IsMENBQThCOztJQUM5QixxQ0FBdUI7O0lBQ3ZCLHNDQUF1Qjs7Ozs7SUFFdkIsaURBQXNDOztJQUN0Qyw2Q0FBa0M7O0lBQ2xDLCtDQUEwRDs7Ozs7O0lBTTFELHVDQUEyQjs7SUFJM0IsaUNBQXNCOztJQUV0Qix1Q0FBNEI7O0lBRTVCLHlDQUFxQjs7SUFTckIsMENBQStCOzs7OztJQUkvQix3Q0FBaUM7O0lBQ2pDLDhDQUE2RTs7SUFFN0UsdUNBQXlCOztJQUN6Qiw2Q0FBd0g7O0lBR3hILHlDQUE2Qjs7SUFDN0IseUNBQTZCOztJQUM3QiwyQ0FBK0I7O0lBQy9CLDBDQUErQjs7Ozs7SUFFL0Isc0NBQTBDOzs7OztJQVkxQyxtQ0FBbUI7Ozs7O0lBY25CLHVDQUEyQjs7Ozs7SUFNM0Isc0NBQXlDOzs7OztJQUV6Qyx3Q0FBMkM7O0lBRzNDLHdDQUEyQzs7SUFDM0MsNENBQStDOzs7OztJQUcvQyx3Q0FBaUI7Ozs7O0lBR2pCLDJDQUFvQjs7Ozs7SUFFcEIseURBQWtDOztJQUdsQyxzQ0FBc0I7O0lBRXRCLG9DQUFtQjs7SUFDbkIsMkNBQTZCOztJQUM3QixxQ0FBd0I7O0lBQ3hCLHVDQUF5Qjs7SUFDekIsOENBQW1DOztJQUVuQyxtQ0FNRTs7SUFFRixnREFBNEI7O0lBQzVCLDZDQUF5Qjs7Ozs7SUEyWHpCLHlDQUdDOzs7OztJQUVELG1DQUdDOzs7OztJQWxZVywrQkFBc0I7Ozs7O0lBQUUscUNBQTJCOzs7OztJQUFFLGdDQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdCwgRWxlbWVudFJlZiwgVGVtcGxhdGVSZWYsIENvbnRlbnRDaGlsZCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIElucHV0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCxcclxuICAgIEFmdGVyVmlld0luaXQsIEhvc3RCaW5kaW5nLCBTaW1wbGVDaGFuZ2VzLCBPbkNoYW5nZXMsIENoYW5nZURldGVjdG9yUmVmLCBEb0NoZWNrXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgICBMaXN0Vmlld0hlYWRlclRlbXBsYXRlRGlyZWN0aXZlLFxyXG4gICAgTGlzdFZpZXdUZW1wbGF0ZURpcmVjdGl2ZSxcclxuICAgIExpc3RWaWV3Rm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsXHJcbiAgICBMaXN0Vmlld0VtcHR5VGVtcGxhdGVEaXJlY3RpdmUsXHJcbn0gZnJvbSAnLi90ZW1wbGF0ZS5kaXJlY3RpdmUnO1xyXG5cclxuaW1wb3J0IHsgUGFnaW5hdGlvbkluc3RhbmNlLCBQYWdpbmF0aW9uQ29udHJvbHNDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXBhZ2luYXRpb24nO1xyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtbGlzdC12aWV3JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9saXN0LXZpZXcuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vbGlzdC12aWV3LmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIExpc3RWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyQ29udGVudEluaXQsIEFmdGVyVmlld0luaXQge1xyXG5cclxuICAgIEBDb250ZW50Q2hpbGQoTGlzdFZpZXdIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBoZWFkZXJUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBDb250ZW50Q2hpbGQoTGlzdFZpZXdUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBsaXN0VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3Rm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgZm9vdGVyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKExpc3RWaWV3RW1wdHlUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBlbXB0eURhdGFUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdsaXN0R3JvdXAnKSBsaXN0R3JvdXA6IEVsZW1lbnRSZWY7XHJcblxyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3BhZ2VyJykgcGFnZXI6IFBhZ2luYXRpb25Db250cm9sc0NvbXBvbmVudDtcclxuXHJcbiAgICAvLyBASW5wdXQoKSBoZWlnaHQ6bnVtYmVyO1xyXG4gICAgLyoqIOWIl+ihqOaVsOaNriAqL1xyXG4gICAgQElucHV0KCkgZGF0YSA9IFtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGlkOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqIOaVsOaNruS4uuepuuaYr+WQpuWxleekuum7mOiupCAqL1xyXG4gICAgQElucHV0KCkgc2hvd0VtcHR5ID0gdHJ1ZTtcclxuICAgIC8qKiDmmK/lkKboh6rlrprkuYnnqbrmlbDmja7mqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpIGVtcHR5VGVtcGxhdGUgPSBmYWxzZTtcclxuICAgIC8qKiDmmK/lkKbmlK/mjIHlpJrpgIkg6buY6K6k5Li6ZmFsc2UgKi9cclxuICAgIEBJbnB1dCgpIG11bHRpcGxlU2VsZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgLyoqIOaYr+WQpuaUr+aMgeWIhumhtSDpu5jorqRmYWxzZSAqL1xyXG4gICAgQElucHV0KCkgc3VwcG9ydFBhZ2luZyA9IGZhbHNlO1xyXG5cclxuICAgIC8vIOm7mOiupOWIhumhtVxyXG4gICAgQElucHV0KCkgcGFnZXJPblNlcnZlciA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBwYWdlU2l6ZSA9IDEwO1xyXG4gICAgQElucHV0KCkgcGFnZUluZGV4ID0gMTtcclxuICAgIC8qKiDlkK/nlKjot6jpobXlpJrpgIkgKi9cclxuICAgIEBJbnB1dCgpIGVuYWJsZU1vcmVQYWdlU2VsZWN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzaG93U2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZEl0ZW1Gb3JtYXQ6IChpdGVtOiBhbnkpID0+IHN0cmluZyA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDkv53mjIHpgInkuK3nirbmgIHvvIzpu5jorqTkuLogdHJ1Ze+8myDlkK/nlKjlpJrpgInlkI7mnInmlYjjgIJcclxuICAgICAqIOW9k+iuvuS4umZhbHNl5pe277yM6YCJ5Lit6aG55YaN5qyh54K55Ye75bCG5Y+W5raI6YCJ5Lit54q25oCBXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGtlZXBTZWxlY3QgPSB0cnVlO1xyXG5cclxuXHJcbiAgICAvLyDmmK/lkKblubPpk7pcclxuICAgIEBJbnB1dCgpIGZpbGwgPSBmYWxzZTtcclxuICAgIC8vIOaYr+WQpuaoquWQkeaOkuWIl1xyXG4gICAgQElucHV0KCkgY2FyZExheW91dCA9IGZhbHNlO1xyXG5cclxuICAgIF9hY3RpdmVJbmRleDogbnVtYmVyO1xyXG4gICAgZ2V0IGFjdGl2ZUluZGV4KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hY3RpdmVJbmRleDtcclxuICAgIH1cclxuICAgIEBJbnB1dCgpIHNldCBhY3RpdmVJbmRleCh2YWwpIHtcclxuICAgICAgICB0aGlzLl9hY3RpdmVJbmRleCA9IHZhbDtcclxuICAgICAgICB0aGlzLmRhdGFJbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgbGlzdENsYXNzTmFtZTogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDli77pgInlgLxcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgY2hlY2tWYWx1ZXM6IGFueVtdID0gW107XHJcbiAgICBAT3V0cHV0KCkgY2hlY2tWYWx1ZXNDaGFuZ2U6IEV2ZW50RW1pdHRlcjxhbnlbXT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueVtdPigpO1xyXG5cclxuICAgIEBJbnB1dCgpIGNoZWNrSXRlbXMgPSBbXTtcclxuICAgIEBJbnB1dCgpIGNoZWNrSXRlbXNDaGFuZ2U6IEV2ZW50RW1pdHRlcjx7aXRlbXM6IGFueVtdLCBpbnN0YW5jZTogYW55fT4gPSBuZXcgRXZlbnRFbWl0dGVyPHtpdGVtczogW10sIGluc3RhbmNlOiBhbnl9PigpO1xyXG5cclxuICAgIC8vIEBJbnB1dCgpIGJvcmRlckJvdHRvbTpib29sZWFuID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHNob3dQYWdlTGlzdCA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBzaG93UGFnZUluZm8gPSB0cnVlO1xyXG4gICAgQElucHV0KCkgc2hvd1BhZ2VOdW1iZXIgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgc2hvd0dvdG9JbnB1dCA9IGZhbHNlO1xyXG5cclxuICAgIHByaXZhdGUgX3BhZ2VMaXN0ID0gWzEwLCAyMCwgMzAsIDUwLCAxMDBdO1xyXG5cclxuICAgIGdldCBwYWdlTGlzdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZUxpc3Q7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBzZXQgcGFnZUxpc3QodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fcGFnZUxpc3QgPSB2YWw7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlci5zZXRQYWdlTGlzdCh2YWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF90b3RhbCA9IDA7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHRvdGFsKHZhbCkge1xyXG4gICAgICAgIGlmICh0aGlzLl90b3RhbCAhPT0gdmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RvdGFsID0gdmFsIHx8IDA7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgfHwge30sIHsgdG90YWxJdGVtczogdmFsIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgdG90YWwoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RvdGFsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkvZzkuLrllK/kuIDmoIfor4bnmoTmlbDmja5rZXnlgLwg5aaC5p6c5rKh5LygIOWUr+S4gOagh+ivhuS4umluZGV45YC8ICovXHJcbiAgICBASW5wdXQoKSBsaXN0aWROYW1lID0gJ2lkJztcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtbGlzdHZpZXctZmlsbCcpIGdldCBsaXN0dmlld0ZpbGwoKSB7IHJldHVybiB0aGlzLmZpbGw7IH1cclxuXHJcblxyXG4gICAgLyoqIOeCueWHu+afkOS4gOihjOWQjiAqL1xyXG4gICAgQE91dHB1dCgpIGxpc3RDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDlpJrpgInmoYYg6YCJ5Lit54q25oCB5Y+Y5YyWICovXHJcbiAgICBAT3V0cHV0KCkgY2hlY2tDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgLy8g5YiG6aG15LqL5Lu2XHJcbiAgICBAT3V0cHV0KCkgcGFnZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgcGFnZVNpemVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIC8qKiDlvZPliY3lsZXnpLrliJfooajmlbDmja4gKi9cclxuICAgIGN1cnJlbnREYXRhID0gW107XHJcblxyXG4gICAgLyoqIOmAieS4reeahOWIl+ihqOaVsOe7hCAqL1xyXG4gICAgc2VsZWN0RGF0YUxpc3QgPSBbXTtcclxuICAgIC8qKiDot6jpobXlpJrpgInorrDlvZUgKi9cclxuICAgIHNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbXTtcclxuXHJcbiAgICAvLyDlvZPliY3ngrnlh7tcclxuICAgIHB1YmxpYyBjbGlja0l0ZW06IGFueTtcclxuXHJcbiAgICBwdWJsaWMgbWF4U2l6ZSA9IDc7XHJcbiAgICBwdWJsaWMgZGlyZWN0aW9uTGlua3MgPSB0cnVlO1xyXG4gICAgcHVibGljIGF1dG9IaWRlID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgcmVzcG9uc2l2ZSA9IHRydWU7XHJcbiAgICBwdWJsaWMgcGFnaW5hdGlvbk9wdGlvbnM6IGFueSA9IHt9O1xyXG5cclxuICAgIHB1YmxpYyBsYWJlbHM6IGFueSA9IHtcclxuICAgICAgICBwcmV2aW91c0xhYmVsOiAnICcsXHJcbiAgICAgICAgbmV4dExhYmVsOiAnICcsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnaW5hdGlvbkxhYmVsOiAnUGFnaW5hdGlvbicsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnZUxhYmVsOiAncGFnZScsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyQ3VycmVudExhYmVsOiBgWW91J3JlIG9uIHBhZ2VgXHJcbiAgICB9O1xyXG5cclxuICAgIG1vdXNlSW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgIG9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zID0ge1xyXG4gICAgICAgICAgICBpZDogJ0ZhcnJpcy1saXN0Vmlldy1QYWdpbmF0aW9uXycgKyAodGhpcy5pZCB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKSksXHJcbiAgICAgICAgICAgIGl0ZW1zUGVyUGFnZTogdGhpcy5wYWdlU2l6ZSxcclxuICAgICAgICAgICAgY3VycmVudFBhZ2U6IHRoaXMucGFnZUluZGV4LFxyXG4gICAgICAgICAgICBwYWdlTGlzdDogdGhpcy5wYWdlTGlzdCxcclxuICAgICAgICAgICAgdG90YWxJdGVtczogdGhpcy50b3RhbCxcclxuICAgICAgICAgICAgcmVtb3RlOiB0aGlzLnBhZ2VyT25TZXJ2ZXJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnREYXRhID0gdGhpcy5kYXRhO1xyXG4gICAgICAgIHRoaXMuZGF0YUluaXQoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RGF0YSA9IHRoaXMuZGF0YTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhSW5pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2hhbmdlc1sndG90YWwnXSAmJiAhY2hhbmdlcy50b3RhbC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9uc1sndG90YWxJdGVtcyddID0gdGhpcy50b3RhbDtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucyA9IHsuLi50aGlzLnBhZ2luYXRpb25PcHRpb25zfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoYW5nZXNbJ3BhZ2VJbmRleCddICYmICFjaGFuZ2VzLnBhZ2VJbmRleC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9uc1snY3VycmVudFBhZ2UnXSA9IHRoaXMucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zID0gey4uLnRoaXMucGFnaW5hdGlvbk9wdGlvbnN9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXNbJ3BhZ2VTaXplJ10gJiYgIWNoYW5nZXMucGFnZVNpemUuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnNbJ2l0ZW1zUGVyUGFnZSddID0gdGhpcy5wYWdlU2l6ZTtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucyA9IHsuLi50aGlzLnBhZ2luYXRpb25PcHRpb25zfTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5jaGVja1ZhbHVlcyAmJiAhY2hhbmdlcy5jaGVja1ZhbHVlcy5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gdGhpcy5kaWZmZXJlbmNlQnkoY2hhbmdlcy5jaGVja1ZhbHVlcy5jdXJyZW50VmFsdWUgfHwgW10sIGNoYW5nZXMuY2hlY2tWYWx1ZXMucHJldmlvdXNWYWx1ZSB8fCBbXSwgdiA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5lbmFibGVNb3JlUGFnZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tSb3dzKHRoaXMuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5jaGVja0l0ZW1zICYmICFjaGFuZ2VzLmNoZWNrSXRlbXMuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciA9IFsuLi50aGlzLmNoZWNrSXRlbXNdO1xyXG4gICAgICAgICAgICBjb25zdCBpZHMgPSB0aGlzLmNoZWNrSXRlbXMubWFwKG4gPT4gblt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkSXRlbXMoaWRzLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIH1cclxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOm7mOiupOaQnOe0ouaooeadvyDngrnlh7vmkJzntKIgKi9cclxuICAgIHNlYXJjaExpc3Qoc2VhcmNoRmllbGQpIHtcclxuICAgICAgICBpZiAoc2VhcmNoRmllbGQgIT09ICcnICYmIHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKChsaXN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdFZhbHVlID0gT2JqZWN0LnZhbHVlcyhsaXN0KTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdFZhbHVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsaXN0VmFsdWVbaV0gPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RWYWx1ZVtpXS50b1N0cmluZygpLmluY2x1ZGVzKHNlYXJjaEZpZWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbGlzdFZhbHVlW2ldLnRvU3RyaW5nKCkuaW5jbHVkZXMoc2VhcmNoRmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhID0gdGhpcy5kYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyBsaXN0ZGF0YTogdGhpcy5jdXJyZW50RGF0YSwgc2VhcmNoVmFsdWU6IHNlYXJjaEZpZWxkLCBsZW5ndGg6IHRoaXMuY3VycmVudERhdGEubGVuZ3RoIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog54K55Ye75p+Q5LiA5YiX5LqL5Lu2ICovXHJcbiAgICBsaXN0U2VsZWN0KGV2ZW50LCBsaXN0SXRlbSwgaW5kZXgsIGNoZWNrQ2hhbmdlRXZlbnQgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2xpY2tDaGVja2JveCA9IHR5cGVvZiBldmVudCA9PT0gJ2Jvb2xlYW4nO1xyXG5cclxuICAgICAgICBpZiAobGlzdEl0ZW1bJ3VuQ2xpY2snXSB8fCBsaXN0SXRlbVsnc2VsZWN0RGlzYWJsZSddKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrQ2hhbmdlLmVtaXQoeyBsaXN0ZGF0YTogbGlzdEl0ZW0sIGluZGV4IH0pO1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RJdGVtSW5kZXggPSB0aGlzLnNlbGVjdERhdGFMaXN0LmZpbmRJbmRleCgoaXRlbSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0S2V5KGl0ZW0sIGkpID09PSB0aGlzLmdldEtleShsaXN0SXRlbSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsaXN0SXRlbVsnY2hlY2tlZCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmtlZXBTZWxlY3QgfHwgaXNDbGlja0NoZWNrYm94KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaUr+aMgeWkmumAiSDliKDpmaTor6XpgInkuK3ooYxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5zcGxpY2Uoc2VsZWN0SXRlbUluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgbGlzdEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbVsnY2hlY2tlZCddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5zcGxpY2Uoc2VsZWN0SXRlbUluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC51bnNoaWZ0KGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaUr+aMgeWkmumAiSDmj5LlhaXor6XpgInkuK3ooYxcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0SXRlbUluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnVuc2hpZnQobGlzdEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdhcHBlbmQnLCBsaXN0SXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC5zcGxpY2Uoc2VsZWN0SXRlbUluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdC51bnNoaWZ0KGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdEl0ZW1bJ2NoZWNrZWQnXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDkuI3mlK/mjIHlpJrpgIkg5pu/5o2i5b2T5YmN6YCJ5Lit6KGMXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnB1c2gobGlzdEl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghY2hlY2tDaGFuZ2VFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSBsaXN0SXRlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxpc3RDbGljay5lbWl0KHsgZGF0YTogdGhpcy5zZWxlY3REYXRhTGlzdCwgaW5kZXgsIGNoZWNrQ2hhbmdlRXZlbnQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIGxldCBpZHMgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT4gISFpdGVtLmNoZWNrZWQpLm1hcChpdGVtID0+IGl0ZW1bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZU1vcmVQYWdlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZHMgPSB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubWFwKGl0ZW0gPT4gaXRlbVt0aGlzLmxpc3RpZE5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9uQ2hlY2tWYWx1ZXNDaGFuZ2UoaWRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOiOt+W+l+avj+S4gOihjGxpc3Qg5ZSv5LiA5qCH6K+GICovXHJcbiAgICBnZXRLZXkobGlzdCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAodGhpcy5saXN0aWROYW1lICYmIGxpc3QuaGFzT3duUHJvcGVydHkodGhpcy5saXN0aWROYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbGlzdFt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIGNoZWNrYm9454q25oCB5Y+Y5YyWICovXHJcbiAgICBnZXRTZWxlY3QoZXZlbnQsIGNoYW5nZURhdGEsIGkpIHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IGV2ZW50LmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5saXN0U2VsZWN0KHN0YXRlLCBjaGFuZ2VEYXRhLCBpLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5o6S5bqP5LqL5Lu2ICovXHJcbiAgICBzb3J0KHNvcnRrZXlOYW1lLCBzb3J0VHlwZSA9ICdhc2MnKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YS5zb3J0KHRoaXMuY29tcGFyZShzb3J0a2V5TmFtZSwgc29ydFR5cGUpKTtcclxuICAgICAgICByZXR1cm4geyBzb3J0UmVzdWx0OiB7IGxpc3RkYXRhOiB0aGlzLmN1cnJlbnREYXRhLCBzb3J0a2V5TmFtZSwgc29ydFR5cGUgfSB9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgc2VsZWN0Um93KHByaW1hcnlWYWx1ZTogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudERhdGEgJiYgdGhpcy5jdXJyZW50RGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuY3VycmVudERhdGEuZmluZChpdGVtID0+IGl0ZW1bdGhpcy5saXN0aWROYW1lXSA9PT0gcHJpbWFyeVZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHJvdykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0l0ZW0gPSByb3c7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGNvbXBhcmUoS2V5TmFtZSwgdHlwZSkge1xyXG4gICAgICAgIGlmICh0eXBlID09PSAnZGVzYycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChvYmoxLCBvYmoyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwxID0gb2JqMVtLZXlOYW1lXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbDIgPSBvYmoyW0tleU5hbWVdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbDIgPCB2YWwxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbDIgPiB2YWwxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdhc2MnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAob2JqMSwgb2JqMikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsMSA9IG9iajFbS2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwyID0gb2JqMltLZXlOYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwyID4gdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwyIDwgdmFsMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IHJldHVybiAwOyB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEl0ZW1BY3RpdmUoaXRlbSkge1xyXG4gICAgICAgIC8vIOS4jeeuoeaYr+WQpuW8gOWQr+WkmumAie+8jOW9k+WJjeihjOWPquacieS4gOihjFxyXG4gICAgICAgIGlmICh0aGlzLmxpc3RpZE5hbWUgJiYgdGhpcy5jbGlja0l0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGhpcy5saXN0aWROYW1lXSA9PT0gdGhpcy5jbGlja0l0ZW1bdGhpcy5saXN0aWROYW1lXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBvblBhZ2VDaGFuZ2UocGFnZTogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ICE9PSBwYWdlLnBhZ2VJbmRleCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2UucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gcGFnZS5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgIC8vIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSB7Li4udGhpcy5wYWdpbmF0aW9uT3B0aW9uc307XHJcbiAgICAgICAgICAgIHRoaXMucGFnZUNoYW5nZWQuZW1pdCh7IHBhZ2VJbmZvOiBwYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VTaXplQ2hhbmdlKHBhZ2VTaXplOiBudW1iZXIpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnBhZ2VTaXplICE9PSBwYWdlU2l6ZSAmJiB0aGlzLnRvdGFsKTtcclxuICAgICAgICBpZiAodGhpcy5wYWdlU2l6ZSAhPT0gcGFnZVNpemUgJiYgdGhpcy50b3RhbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLml0ZW1zUGVyUGFnZSA9IHBhZ2VTaXplO1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplID0gcGFnZVNpemU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0b3RhbCA9IHRoaXMudG90YWw7XHJcbiAgICAgICAgICAgIGxldCBwYWdlTGVuZ3RoID0gTWF0aC5mbG9vcih0b3RhbCAvIHBhZ2VTaXplKTtcclxuICAgICAgICAgICAgaWYgKHRvdGFsICUgcGFnZVNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBwYWdlTGVuZ3RoICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChwYWdlTGVuZ3RoICYmIHRoaXMucGFnZUluZGV4ID4gcGFnZUxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWdlSW5kZXggPSBwYWdlTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5jdXJyZW50UGFnZSA9IHRoaXMucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSB7Li4udGhpcy5wYWdpbmF0aW9uT3B0aW9uc307XHJcbiAgICAgICAgICAgIHRoaXMucGFnZVNpemVDaGFuZ2VkLmVtaXQoeyBwYWdlSW5mbzogeyBwYWdlSW5kZXg6IHRoaXMucGFnZUluZGV4LCBwYWdlU2l6ZSB9IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRDdXJyZW50RGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTZWxlY3REYXRhKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdERhdGFMaXN0O1xyXG4gICAgfVxyXG4gICAgLyoqIOaUr+aMgemHjeaWsOiuvue9rmxpc3R2aWV35pWw5o2uICovXHJcbiAgICBzZXREYXRhKGxpc3R2aWV3RGF0YSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudERhdGEgPSBsaXN0dmlld0RhdGE7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gbGlzdHZpZXdEYXRhO1xyXG4gICAgICAgIHRoaXMuZGF0YUluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBkYXRhSW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdCA9IHRoaXMuZGF0YS5maWx0ZXIoKGxpc3QpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0WydjaGVja2VkJ107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA+PSAwICYmIHRoaXMuYWN0aXZlSW5kZXggPD0gKHRoaXMuZGF0YS5sZW5ndGggLSAxKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSB0aGlzLmRhdGFbdGhpcy5hY3RpdmVJbmRleF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrSXRlbSA9IGRhdGFJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QucHVzaCh0aGlzLmNsaWNrSXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hY3RpdmVJbmRleCA8IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3REYXRhTGlzdC5sZW5ndGggJiYgIXRoaXMubXVsdGlwbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0LnB1c2godGhpcy5kYXRhWzBdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tJdGVtID0gdGhpcy5kYXRhWzBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCk7ICAgICAgICBcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2RyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcihhY3RpdmU6ICdyZW1vdmUnfCdhcHBlbmQnfCcnID0gJycsIGxpc3RJdGVtPzogYW55LCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0ICYmIHRoaXMuZW5hYmxlTW9yZVBhZ2VTZWxlY3QpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChhY3RpdmUgPT09ICdyZW1vdmUnICYmIGxpc3RJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkobGlzdEl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdEl0ZW0gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5bdGhpcy5saXN0aWROYW1lXSAhPSBsaXN0SXRlbVt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gblt0aGlzLmxpc3RpZE5hbWVdICE9IGxpc3RJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0SXRlbS5pbmRleE9mKGEgPT4gYVt0aGlzLmxpc3RpZE5hbWVdID09PSBuW3RoaXMubGlzdGlkTmFtZV0pID09PSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7aXRlbXM6IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXJdLCBpbnN0YW5jZTogdGhpc30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09ICdhcHBlbmQnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkobGlzdEl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciwgbGlzdEl0ZW1dO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbLi4udGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLCAuLi5saXN0SXRlbV07XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7aXRlbXM6IFsuLi50aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXJdLCBpbnN0YW5jZTogdGhpc30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyID0gWy4uLnRoaXMuc2VsZWN0RGF0YUxpc3RdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2hlY2tlZHMgPSB0aGlzLnNhbWVCeSh0aGlzLmN1cnJlbnREYXRhLCB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIsICh2KSA9PiB2W3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdDaGVja2VkcyAmJiBuZXdDaGVja2Vkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBuZXdDaGVja2Vkcy5pbmNsdWRlcyhpdGVtW3RoaXMubGlzdGlkTmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOWFqOmAiSAqL1xyXG4gICAgbGlzdENoZWNrQWxsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0ID0gdGhpcy5jdXJyZW50RGF0YS5maWx0ZXIoKGxpc3QpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0WydjaGVja2VkJ107XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcignYXBwZW5kJywgdGhpcy5jdXJyZW50RGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiDlj5bmtojlhajpgIkgKi9cclxuICAgIGxpc3RDaGVja0FsbENhbmNlbCgpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgdGhpcy5jdXJyZW50RGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yu+6YCJ6KGMXHJcbiAgICAgKiBAcGFyYW0gaWRzIGlkc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2hlY2tSb3dzKGlkczogYW55W10pOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoIWlkcyB8fCBpZHMubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0Q2hlY2tBbGxDYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpZHMuaW5jbHVkZXMoaXRlbVt0aGlzLmxpc3RpZE5hbWVdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHRoaXMub25DaGVja1ZhbHVlc0NoYW5nZShpZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBvbkNoZWNrVmFsdWVzQ2hhbmdlKGlkczogYW55W10pIHtcclxuICAgICAgICB0aGlzLmNoZWNrVmFsdWVzQ2hhbmdlLmVtaXQoaWRzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRpZmZlcmVuY2VCeSA9IChhLCBiLCBmbikgPT4ge1xyXG4gICAgICAgIGNvbnN0IHMgPSBuZXcgU2V0KGIubWFwKGZuKSk7XHJcbiAgICAgICAgcmV0dXJuIGEubWFwKGZuKS5maWx0ZXIoZWwgPT4gIXMuaGFzKGVsKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzYW1lQnkgPSAoYSwgYiwgZm4pID0+IHtcclxuICAgICAgICBjb25zdCBzID0gbmV3IFNldChiLm1hcChmbikpO1xyXG4gICAgICAgIHJldHVybiBhLm1hcChmbikuZmlsdGVyKGVsID0+IHMuaGFzKGVsKSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG9uTW91c2VFbnRlcigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIHRoaXMubW91c2VJblNlbGVjdGVkTGlzdCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0RGF0YUxpc3RXaXRoT3RoZXJQYWdlciAmJiB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlblNlbGVjdGVkTGlzdCA9ICF0aGlzLm9wZW5TZWxlY3RlZExpc3Q7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuU2VsZWN0ZWRMaXN0ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjbG9zZVNlbGVjdGVkTGlzdCgpIHtcclxuICAgICAgICB0aGlzLm9wZW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1vdXNlSW5TZWxlY3RlZExpc3QgPSBmYWxzZTtcclxuICAgICAgICBpZiAoIXRoaXMuY2RyWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uRGVsU2VsZWN0ZWRJdGVtKGlkOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnREYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtW3RoaXMubGlzdGlkTmFtZV0gPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0RGF0YUxpc3QgPSB0aGlzLnNlbGVjdERhdGFMaXN0LmZpbHRlcihuID0+IG5bdGhpcy5saXN0aWROYW1lXSAhPSBpZCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcigncmVtb3ZlJywgaWQpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrZWRWYWx1ZXMoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhclNlbGVjdGVkKCRldmVudCkge1xyXG4gICAgICAgIC8vIHRoaXMuY2xlYXJTZWxlY3RlZEl0ZW0uZW1pdCgpO1xyXG4gICAgICAgIHRoaXMuY2xvc2VTZWxlY3RlZExpc3QoKTtcclxuICAgICAgICB0aGlzLmxpc3RDaGVja0FsbENhbmNlbCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbXTtcclxuICAgICAgICB0aGlzLmNoZWNrVmFsdWVzID0gW107XHJcbiAgICAgICAgdGhpcy5vbkNoZWNrVmFsdWVzQ2hhbmdlKFtdKTtcclxuICAgIH1cclxuXHJcbiAgICBvblNlbGVjdExpc3RQYW5lbENsb3NlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VTZWxlY3RlZExpc3QoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNoZWNrZWRWYWx1ZXMoZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAodGhpcy5tdWx0aXBsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZW5hYmxlTW9yZVBhZ2VTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZXMgPSB0aGlzLnNlbGVjdERhdGFMaXN0Lm1hcChuID0+IG5bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVmFsdWVzID0gdGhpcy5zZWxlY3REYXRhTGlzdFdpdGhPdGhlclBhZ2VyLm1hcChuID0+IG5bdGhpcy5saXN0aWROYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hlY2tWYWx1ZXNDaGFuZ2UodGhpcy5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrSXRlbXNDaGFuZ2UuZW1pdCh7IGl0ZW1zOiB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIsIGluc3RhbmNlOiB0aGlzIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyQ2hlY2tlZHMoY2xlYXJBbGwgPSB0cnVlLCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3REYXRhTGlzdCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNsZWFyQWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERhdGFMaXN0V2l0aE90aGVyUGFnZXIgPSBbXTtcclxuICAgICAgICAgICAgfSBlbHNlICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdyZW1vdmUnLCB0aGlzLmN1cnJlbnREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hlY2tlZFZhbHVlcyhlbWl0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NldEl0ZW1zQ2hlY2tlZFN0YXR1cyggaWRzOiBhbnksIGNoZWNrZWQ6IGJvb2xlYW4sIGVtaXQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAoaWRzICYmIGlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gY2hlY2tlZCA/ICdhcHBlbmQnOiAncmVtb3ZlJztcclxuICAgICAgICAgICAgaWRzLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaWQgPSBpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gaVt0aGlzLmxpc3RpZE5hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmRhdGEuZmluZChuID0+IG5bdGhpcy5saXN0aWROYW1lXSA9PT0gaWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBjaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhTGlzdEZvck1vcmVQYWdlcignYXBwZW5kJywgaSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURhdGFMaXN0Rm9yTW9yZVBhZ2VyKCdyZW1vdmUnLCBpZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hlY2tlZFZhbHVlcyhlbWl0KTtcclxuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVuQ2hlY2tJdGVtcyhpZHM6IG51bWJlcltdIHwgc3RyaW5nW10gfCBvYmplY3RbXSwgZW1pdCA9IGZhbHNlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0SXRlbXNDaGVja2VkU3RhdHVzKGlkcywgZmFsc2UsIGVtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrZWRJdGVtcyhpZHM6IG9iamVjdFtdLCBlbWl0ID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLl9zZXRJdGVtc0NoZWNrZWRTdGF0dXMoaWRzLCB0cnVlLCBlbWl0KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG5cclxuIl19