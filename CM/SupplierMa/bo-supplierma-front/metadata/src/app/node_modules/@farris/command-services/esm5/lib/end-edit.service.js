import { Injectable } from '@angular/core';
import { FrameContext } from '@farris/devkit';
import { of } from 'rxjs';
import { tap, delay } from 'rxjs/operators';
/**
 * 结束表单编辑状态服务
 */
var EndEditService = /** @class */ (function () {
    function EndEditService(frameContext) {
        this.frameContext = frameContext;
    }
    /**
     * 结束编辑
     */
    EndEditService.prototype.endEdit = function () {
        var appContext = this.frameContext && this.frameContext.getFormAppContext();
        return of(null).pipe(tap(function () {
            if (appContext) {
                appContext.messagePipe.next({ type: 'endEdit' });
            }
        }), 
        // todo: 不应该使用delay，应该串流
        delay(5));
    };
    EndEditService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    EndEditService.ctorParameters = function () { return [
        { type: FrameContext }
    ]; };
    return EndEditService;
}());
export { EndEditService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5kLWVkaXQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tbWFuZC1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi9lbmQtZWRpdC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFjLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFELE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUIsT0FBTyxFQUFhLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2RDs7R0FFRztBQUNIO0lBRUUsd0JBQW9CLFlBQTBCO1FBQTFCLGlCQUFZLEdBQVosWUFBWSxDQUFjO0lBQzlDLENBQUM7SUFDRDs7T0FFRztJQUNJLGdDQUFPLEdBQWQ7UUFDRSxJQUFNLFVBQVUsR0FBZSxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUMxRixPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQ2xCLEdBQUcsQ0FBQztZQUNGLElBQUksVUFBVSxFQUFFO2dCQUNkLFVBQVUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUM7YUFDbEQ7UUFDSCxDQUFDLENBQUM7UUFDRix3QkFBd0I7UUFDeEIsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUNULENBQUM7SUFDSixDQUFDOztnQkFsQkYsVUFBVTs7OztnQkFQVSxZQUFZOztJQTBCakMscUJBQUM7Q0FBQSxBQW5CRCxJQW1CQztBQUNELE9BQU8sRUFBRSxjQUFjLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFwcENvbnRleHQsIEZyYW1lQ29udGV4dCB9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBjb25jYXRNYXAsIHRhcCwgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbi8qKlxuICog57uT5p2f6KGo5Y2V57yW6L6R54q25oCB5pyN5YqhXG4gKi9cbkBJbmplY3RhYmxlKClcbmNsYXNzIEVuZEVkaXRTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCkge1xuICB9XG4gIC8qKlxuICAgKiDnu5PmnZ/nvJbovpFcbiAgICovXG4gIHB1YmxpYyBlbmRFZGl0KCkge1xuICAgIGNvbnN0IGFwcENvbnRleHQ6IEFwcENvbnRleHQgPSB0aGlzLmZyYW1lQ29udGV4dCAmJiB0aGlzLmZyYW1lQ29udGV4dC5nZXRGb3JtQXBwQ29udGV4dCgpO1xuICAgIHJldHVybiBvZihudWxsKS5waXBlKFxuICAgICAgdGFwKCgpID0+IHtcbiAgICAgICAgaWYgKGFwcENvbnRleHQpIHtcbiAgICAgICAgICBhcHBDb250ZXh0Lm1lc3NhZ2VQaXBlLm5leHQoeyB0eXBlOiAnZW5kRWRpdCcgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgLy8gdG9kbzog5LiN5bqU6K+l5L2/55SoZGVsYXnvvIzlupTor6XkuLLmtYFcbiAgICAgIGRlbGF5KDUpXG4gICAgKTtcbiAgfVxufVxuZXhwb3J0IHsgRW5kRWRpdFNlcnZpY2UgfTtcbiJdfQ==