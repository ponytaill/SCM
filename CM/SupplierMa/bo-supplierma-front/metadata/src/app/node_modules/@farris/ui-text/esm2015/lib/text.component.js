/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, forwardRef, Input, HostBinding, Output, EventEmitter, Injector, ElementRef, ViewChild, NgZone, HostListener } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DateTimeHelperService } from '@farris/ui-common/date';
import { NumberHelperService } from '@farris/ui-common/number';
import { DebugService } from '@farris/ui-common';
import { LocaleService } from '@farris/ui-locale';
export class TextComponent {
    /**
     * @param {?} dtHelper
     * @param {?} numberHelper
     * @param {?} injector
     * @param {?} ngzone
     */
    constructor(dtHelper, numberHelper, injector, ngzone) {
        this.dtHelper = dtHelper;
        this.numberHelper = numberHelper;
        this.injector = injector;
        this.ngzone = ngzone;
        this.cls = true;
        this.textChange = new EventEmitter();
        /**
         * 是否为密码输入
         */
        this.isPassword = false;
        // 是否多行文本
        this.isTextArea = false;
        // 是否启用自动尺寸
        this.autoSize = false;
        // 设置高度
        this.height = 0;
        // 是否是日期范围
        this.dateRange = false;
        // 千分位符号
        this.thousand = ',';
        // 小数点处符号
        this.decimal = '.';
        // 货币符号及值展现形式
        this.expression = '%s%v';
        this.textField = 'name';
        this.valueField = 'value';
        this.returnFormat = ''; // 从服务器端取值是格式化后的
        // 日期范围模式下input的显示分割符合
        this.dateRangeDelimiter = '~';
        this.enumDelimiter = ',';
        this._tshowType = 0;
        // 货币符号，默认是RMB
        this.currencySymbol = '￥';
        // 十进制前面填充的符号
        this.filledSymbol = '0';
        // 标签
        this.staticTitle = "";
        // 处理中英文情况， 因为多语言暂时不通过这个属性控制
        this.showTitle = false;
        this.beforeWriteValue = null;
        this.controlChange = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.controlTouch = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.debugSer = null;
        this.localeService = this.injector.get(LocaleService);
        this.debugSer = this.injector.get(DebugService, null);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set showType(value) {
        this._tshowType = value;
        // 如果是周
        if (value == 4) {
            this.dateRange = true;
        }
    }
    /**
     * @return {?}
     */
    get showType() {
        return this._tshowType;
    }
    // 普通文本输入值
    /**
     * @param {?} value
     * @return {?}
     */
    set value(value) {
        this.text = this.formatValue(value);
        this.textChange.emit(this.text);
    }
    /**
     * @return {?}
     */
    get value() {
        return this.text;
    }
    /**
     * @param {?} ev
     * @return {?}
     */
    changeTitle(ev) {
        if (!this.isTextArea && !this.isPassword) {
            this.mouseEnterChangeTitle();
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set option(value) {
        this._option = value;
    }
    /**
     * @return {?}
     */
    get option() {
        return this._option;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (this.isTextArea) {
            /** @type {?} */
            const clsName = this.textInnerEl.nativeElement.parentElement.className;
            this.textInnerEl.nativeElement.parentElement.className = clsName + ' f-cmp-text-is-textarea';
        }
    }
    /**
     * @private
     * @return {?}
     */
    mouseEnterChangeTitle() {
        if (this.textInnerEl.nativeElement.scrollHeight > this.textInnerEl.nativeElement.clientHeight) {
            this.staticTitle = this.text && this.text.length > 0 ? this.text : this.control;
        }
        else {
            this.staticTitle = '';
        }
    }
    /**
     * 处理多语言，待定
     * @param {?} value
     * @return {?}
     */
    formatLang(value) {
        return value && value[this.currentLanguage] ? value[this.currentLanguage] : '';
    }
    /**
     * C货币
     * D十进制
     * F浮点数
     * N数字，带千分位
     * P百分比
     * @param {?} value
     * @return {?}
     */
    getFormatNumberValue(value) {
        if (!this.format && !this._option) {
            return value.toString();
        }
        if (this._option && this._option.type && this._option.type == 'number') {
            if (this._option.formatter) {
                return this._option.formatter(value);
            }
            else {
                if (this._option.useThousands) {
                    if (this._option.precision != undefined) {
                        this.format = 'n' + this._option.precision;
                    }
                    else {
                        this.format = 'n2';
                    }
                }
                else {
                    if (this._option.precision != undefined) {
                        this.format = 'f' + this._option.precision;
                    }
                    else {
                        this.format = 'f2';
                    }
                }
            }
        }
        /** @type {?} */
        const firstLetter = this.currencyToUpperCase(this.format.substring(0, 1));
        /** @type {?} */
        const precision = Number(this.format.substring(1));
        /** @type {?} */
        let config = {};
        /** @type {?} */
        let result;
        if (!/C|D|F|N|P/g.test(firstLetter)) {
            if (this.debugSer) {
                this.debugSer.warn(`不支持format为 ${this.format} 类型的数字格式化`);
            }
            return;
        }
        if (this.thousand) {
            Object.assign(config, { thousand: this.thousand });
        }
        if (this.decimal) {
            Object.assign(config, { decimal: this.decimal });
        }
        if (this.expression) {
            Object.assign(config, { format: this.expression });
        }
        switch (firstLetter) {
            case 'C':
                Object.assign(config, { prefix: this.currencySymbol, precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'D':
                result = this.toDecimal(value, precision);
                break;
            case 'F':
                Object.assign(config, { prefix: '', thousand: '', precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'N':
                Object.assign(config, { prefix: '', precision });
                result = this.numberHelper.formatMoney(value, config);
                break;
            case 'P':
                result = this.toPercent(value, precision);
                break;
        }
        return result;
    }
    /**
     * @param {?} value 转换成十进制的数字
     * @param {?} precision 十进制数字的长度
     * @return {?}
     */
    toDecimal(value, precision) {
        if (value.toString().indexOf('.') > -1) {
            if (this.debugSer) {
                this.debugSer.warn('十进制转换仅限整型类型');
            }
            return;
        }
        return (Array(precision).join(this.filledSymbol) + value).slice(-precision);
    }
    /**
     * @param {?} value 转换成百分数的数字
     * @param {?} precision
     * @return {?}
     */
    toPercent(value, precision) {
        return Number(value * 100).toFixed(Number(precision)) + '%';
    }
    /**
     * 将货币符号首字母转换成大写
     * @param {?} value
     * @return {?}
     */
    currencyToUpperCase(value) {
        return value.replace(/[a-z]+/g, (/**
         * @param {?} word
         * @return {?}
         */
        (word) => {
            return word.toUpperCase();
        }));
    }
    /**
     * 处理年，Y=>y, D=>d
     * @param {?} value
     * @return {?}
     */
    dateToUpperCase(value) {
        /** @type {?} */
        let newFormat;
        if (/Y/g.test(value) === true) {
            newFormat = value.replace(/Y/g, 'y');
        }
        else {
            newFormat = value;
        }
        if (/D/g.test(newFormat) === true) {
            newFormat = newFormat.replace(/D/g, 'd');
        }
        return newFormat;
    }
    /**
     * 枚举类型处理
     * @param {?} value
     * @return {?}
     */
    getFormatEnumValue(value) {
        if (value == undefined || value === null || value === '') {
            return '';
        }
        if (this.data && this.data.length) {
            // 可能存在多选枚举，作为分隔符  
            // let curVals = ('' + value).split(',');
            /** @type {?} */
            let curVals = ('' + value).split(this.enumDelimiter);
            /** @type {?} */
            let nameResult = [];
            for (let k = 0; k < curVals.length; k++) {
                /** @type {?} */
                let findObj = this.data.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    return item[this.valueField] == curVals[k];
                }));
                if (findObj) {
                    nameResult.push(findObj[this.textField]);
                }
                else {
                    nameResult.push(curVals[k]);
                }
            }
            if (nameResult.length > 0) {
                // return nameResult.join(',');
                return nameResult.join(this.enumDelimiter);
            }
            return '';
        }
        else {
            return value;
        }
    }
    /**
     * boolean值处理
     * @param {?} value
     * @return {?}
     */
    getFormatCheckBoxValue(value) {
        if (value === true) {
            return this.localeService.getValue('text.yes');
        }
        else if (value === false || value == null || typeof value === 'undefined') {
            return this.localeService.getValue('text.no');
        }
        else {
            return value;
        }
    }
    /**
     * @private
     * @param {?} value
     * @param {?} fmt
     * @param {?=} hourSystem
     * @return {?}
     */
    timeFormatTo(value, fmt, hourSystem = 12) {
    }
    /**
     * @private
     * @param {?} fmt
     * @return {?}
     */
    makeFormater(fmt) {
        return fmt;
    }
    /*
        * 日期格式化
        */
    /**
     * @param {?} value
     * @return {?}
     */
    dateformat(value) {
        /** @type {?} */
        let str;
        if (!this.format) {
            this.format = 'YYYY-MM-DD';
        }
        // 当前值是已经格式化后的日期字符串
        if (this.returnFormat && this.returnFormat != 'yyyy-MM-dd' && typeof value == 'string') {
            value = this.getDateFromFormatedString(value, this.returnFormat);
        }
        //
        if (this.format === 'hh:mm:ss' || this.format === 'HH:mm:ss') {
            // 格式化时间  临时处理
            str = value;
        }
        else {
            // if (this.showTime && value instanceof String) {
            //     str = value;
            // } else {
            //     const formArr = this.format.split(' ');
            //     if (this.showTime && formArr.length < 2) {
            //         formArr.push('HH:mm:ss');
            //         this.format = formArr.join(' ');
            //     }
            //     // 格式化日期
            //     str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
            // }
            str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
        }
        return str;
    }
    /**
     * @private
     * @param {?} dateString
     * @param {?} format
     * @return {?}
     */
    getDateFromFormatedString(dateString, format) {
        /** @type {?} */
        var result = { year: 0, month: 0, day: 0, hour: 0, minite: 0, second: 0 };
        if (dateString) {
            format.replace(/y+|Y+|M+|d+|D+|h+|H+|m+|s+/g, (/**
             * @param {?} m
             * @param {?} a
             * @param {?} b
             * @param {?} c
             * @return {?}
             */
            function (m, a, b, c) {
                dateString.substring(a).replace(/\d+/, (/**
                 * @param {?} d
                 * @return {?}
                 */
                function (d) { c = parseInt(d, 10); }));
                if (/y+/i.test(m) && !result.year)
                    result.year = c;
                if (/M+/.test(m) && !result.month)
                    result.month = c;
                if (/d+/i.test(m) && !result.day)
                    result.day = c;
                if (/h+/i.test(m) && !result.hour)
                    result.hour = c;
                if (/m+/.test(m) && !result.minite)
                    result.minite = c;
                if (/s+/.test(m) && !result.second)
                    result.second = c;
            }));
        }
        /** @type {?} */
        var resultDate = new Date(result.year + '/' + result.month + '/' + result.day + ' ' + result.hour + ':' + result.minite + ':' + result.second);
        return resultDate;
    }
    /**
     * 格式化处理
     * @param {?} value
     * @return {?}
     */
    formatValue(value) {
        /** @type {?} */
        let str;
        if (this.currentLanguage) {
            return this.formatLang(value);
        }
        // if (!value) {
        //     return '';
        // }
        if (this.type !== 'boolean' && (value == null || typeof value === 'undefined')) {
            return '';
        }
        switch (this.type) {
            case 'string':
                str = value;
                break;
            case 'date':
            case 'datetime':
                if (!this.dateRange) {
                    // if (!this.format) {
                    //     this.format = 'YYYY-MM-DD';
                    // }
                    // if (this.format === 'hh:mm:ss') {
                    //     // 格式化时间  临时处理
                    //     str = value;
                    // } else {
                    //     if (this.showTime) {
                    //         str = value;
                    //     } else {
                    //         // 格式化日期
                    //         str = this.dtHelper.formatTo(value, this.dateToUpperCase(this.format));
                    //     }
                    // }
                    str = this.dateformat(value);
                }
                else {
                    /** @type {?} */
                    const dateValues = value.split(this.dateRangeDelimiter);
                    /** @type {?} */
                    let dataStr = [];
                    if (dateValues && dateValues.length) {
                        dateValues.forEach((/**
                         * @param {?} date
                         * @return {?}
                         */
                        date => {
                            /** @type {?} */
                            let val = this.dateformat(date);
                            dataStr.push(val);
                        }));
                    }
                    str = dataStr.join(this.dateRangeDelimiter);
                }
                break;
            // case 'dateTime':
            //     str = this.timeFormatTo(value, this.makeFormater(this.format));
            //     break;
            case 'number':
                str = this.getFormatNumberValue(value);
                break;
            case 'enum':
                str = this.getFormatEnumValue(value);
                break;
            case 'boolean':
                str = this.getFormatCheckBoxValue(value);
                break;
            default:
                break; // throw new Error(`暂不支持 ${this.type} 类型`);
        }
        return str;
    }
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    setText2Star(value) {
        if (this.isPassword) {
            /** @type {?} */
            const star = value ? '******' : '';
            this.text = star;
            this.control = star;
            return true;
        }
        return false;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        // lucas 2021-08-27
        if (this.setText2Star(value)) {
            return;
        }
        // xia 2021-03-13
        if (this.beforeWriteValue) {
            /** @type {?} */
            const options = {
                localizationType: this.localizationType,
                showTime: this.showTime,
                ref: this
            };
            /** @type {?} */
            const text = this.beforeWriteValue(value, options);
            if (text !== undefined) {
                this.text = text;
                return;
            }
        }
        this.control = this.formatValue(value);
        this.controlChange(value);
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.controlChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.controlTouch = fn;
    }
}
TextComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-text',
                template: `
        <span #textInner
            [ngClass]="{'f-form-control-text':!isTextArea,'f-form-control-textarea':isTextArea,'f-component-text-auto-size': this.autoSize}"
            [title]="staticTitle" [style.text-align]="textAlign"
            [style.height]="!autoSize&&height>0?height+'px':null" [style.minHeight]="autoSize&&height>0?height+'px':null"
            [style.maxHeight]="autoSize&&maxHeight>0?maxHeight+'px':null">{{text && text.length > 0 ?  text : control}}</span>
    `,
                providers: [{
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => TextComponent)),
                        multi: true,
                    }]
            }] }
];
/** @nocollapse */
TextComponent.ctorParameters = () => [
    { type: DateTimeHelperService },
    { type: NumberHelperService },
    { type: Injector },
    { type: NgZone }
];
TextComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class.f-component-text',] }],
    textInnerEl: [{ type: ViewChild, args: ['textInner', { read: ElementRef },] }],
    textChange: [{ type: Output }],
    isPassword: [{ type: Input }],
    isTextArea: [{ type: Input }],
    autoSize: [{ type: Input }],
    maxHeight: [{ type: Input }],
    height: [{ type: Input }],
    type: [{ type: Input }],
    dateRange: [{ type: Input }],
    format: [{ type: Input }],
    lang: [{ type: Input }],
    data: [{ type: Input }],
    thousand: [{ type: Input }],
    decimal: [{ type: Input }],
    expression: [{ type: Input }],
    currentLanguage: [{ type: Input }],
    showTime: [{ type: Input }],
    textField: [{ type: Input }],
    valueField: [{ type: Input }],
    returnFormat: [{ type: Input }],
    textAlign: [{ type: Input }],
    dateRangeDelimiter: [{ type: Input }],
    enumDelimiter: [{ type: Input }],
    showType: [{ type: Input }],
    localizationType: [{ type: Input }],
    filledSymbol: [{ type: Input }],
    value: [{ type: Input }],
    changeTitle: [{ type: HostListener, args: ['mouseenter', ['$event'],] }],
    showTitle: [{ type: Input }],
    option: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TextComponent.prototype.cls;
    /** @type {?} */
    TextComponent.prototype.textInnerEl;
    /** @type {?} */
    TextComponent.prototype.textChange;
    /**
     * 是否为密码输入
     * @type {?}
     */
    TextComponent.prototype.isPassword;
    /** @type {?} */
    TextComponent.prototype.isTextArea;
    /** @type {?} */
    TextComponent.prototype.autoSize;
    /** @type {?} */
    TextComponent.prototype.maxHeight;
    /** @type {?} */
    TextComponent.prototype.height;
    /** @type {?} */
    TextComponent.prototype.type;
    /** @type {?} */
    TextComponent.prototype.dateRange;
    /** @type {?} */
    TextComponent.prototype.format;
    /** @type {?} */
    TextComponent.prototype.lang;
    /** @type {?} */
    TextComponent.prototype.data;
    /** @type {?} */
    TextComponent.prototype.thousand;
    /** @type {?} */
    TextComponent.prototype.decimal;
    /** @type {?} */
    TextComponent.prototype.expression;
    /** @type {?} */
    TextComponent.prototype.currentLanguage;
    /** @type {?} */
    TextComponent.prototype.showTime;
    /** @type {?} */
    TextComponent.prototype.textField;
    /** @type {?} */
    TextComponent.prototype.valueField;
    /** @type {?} */
    TextComponent.prototype.returnFormat;
    /** @type {?} */
    TextComponent.prototype.textAlign;
    /** @type {?} */
    TextComponent.prototype.dateRangeDelimiter;
    /** @type {?} */
    TextComponent.prototype.enumDelimiter;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype._tshowType;
    /**
     * 国际化类型
     * @type {?}
     */
    TextComponent.prototype.localizationType;
    /** @type {?} */
    TextComponent.prototype.control;
    /** @type {?} */
    TextComponent.prototype.text;
    /** @type {?} */
    TextComponent.prototype.currencySymbol;
    /** @type {?} */
    TextComponent.prototype.filledSymbol;
    /** @type {?} */
    TextComponent.prototype.staticTitle;
    /** @type {?} */
    TextComponent.prototype.showTitle;
    /** @type {?} */
    TextComponent.prototype._option;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.localeService;
    /** @type {?} */
    TextComponent.prototype.beforeWriteValue;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.controlChange;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.controlTouch;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.debugSer;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.dtHelper;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.numberHelper;
    /**
     * @type {?}
     * @private
     */
    TextComponent.prototype.injector;
    /** @type {?} */
    TextComponent.prototype.ngzone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXRleHQvIiwic291cmNlcyI6WyJsaWIvdGV4dC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQVUsVUFBVSxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQ2xFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFDN0QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGlCQUFpQixFQUF3QixNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFrQmxELE1BQU0sT0FBTyxhQUFhOzs7Ozs7O0lBb0d0QixZQUNZLFFBQStCLEVBQy9CLFlBQWlDLEVBQ2pDLFFBQWtCLEVBQ25CLE1BQWM7UUFIYixhQUFRLEdBQVIsUUFBUSxDQUF1QjtRQUMvQixpQkFBWSxHQUFaLFlBQVksQ0FBcUI7UUFDakMsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNuQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBdkdjLFFBQUcsR0FBRyxJQUFJLENBQUM7UUFFeEMsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7UUFFdEMsZUFBVSxHQUFHLEtBQUssQ0FBQzs7UUFFbkIsZUFBVSxHQUFHLEtBQUssQ0FBQzs7UUFFbkIsYUFBUSxHQUFHLEtBQUssQ0FBQzs7UUFJakIsV0FBTSxHQUFHLENBQUMsQ0FBQzs7UUFJWCxjQUFTLEdBQUcsS0FBSyxDQUFDOztRQVFsQixhQUFR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Ozs7O0lBRS9DLG1DQUE0Qjs7SUFFNUIsbUNBQTRCOztJQUU1QixpQ0FBMEI7O0lBRTFCLGtDQUEyQjs7SUFFM0IsK0JBQW9COztJQUVwQiw2QkFBc0I7O0lBRXRCLGtDQUEyQjs7SUFFM0IsK0JBQXFCOztJQUVyQiw2QkFBc0I7O0lBRXRCLDZCQUFtQjs7SUFFbkIsaUNBQXdCOztJQUV4QixnQ0FBdUI7O0lBRXZCLG1DQUE2Qjs7SUFDN0Isd0NBQWlDOztJQUVqQyxpQ0FBMkI7O0lBQzNCLGtDQUE0Qjs7SUFDNUIsbUNBQThCOztJQUM5QixxQ0FBMkI7O0lBRzNCLGtDQUFtQjs7SUFFbkIsMkNBQWtDOztJQUNsQyxzQ0FBNkI7Ozs7O0lBQzdCLG1DQUF1Qjs7Ozs7SUFldkIseUNBQWtDOztJQUNsQyxnQ0FBYTs7SUFFYiw2QkFBVTs7SUFFVix1Q0FBcUI7O0lBRXJCLHFDQUE0Qjs7SUFnQjVCLG9DQUFpQjs7SUFFakIsa0NBQTJCOztJQUUzQixnQ0FBUTs7Ozs7SUFTUixzQ0FBMkI7O0lBRTNCLHlDQUE0RDs7Ozs7SUFFNUQsc0NBQXFDOzs7OztJQUNyQyxxQ0FBb0M7Ozs7O0lBQ3BDLGlDQUFzQzs7Ozs7SUFFbEMsaUNBQXVDOzs7OztJQUN2QyxxQ0FBeUM7Ozs7O0lBQ3pDLGlDQUEwQjs7SUFDMUIsK0JBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBmb3J3YXJkUmVmLCBJbnB1dCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3RvcixcclxuICAgIFNpbXBsZUNoYW5nZXMsIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCwgTmdab25lLCBIb3N0TGlzdGVuZXJcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBEYXRlVGltZUhlbHBlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi9kYXRlJztcclxuaW1wb3J0IHsgTnVtYmVySGVscGVyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL251bWJlcic7XHJcbmltcG9ydCB7IERlYnVnU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtdGV4dCcsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICAgIDxzcGFuICN0ZXh0SW5uZXJcclxuICAgICAgICAgICAgW25nQ2xhc3NdPVwieydmLWZvcm0tY29udHJvbC10ZXh0JzohaXNUZXh0QXJlYSwnZi1mb3JtLWNvbnRyb2wtdGV4dGFyZWEnOmlzVGV4dEFyZWEsJ2YtY29tcG9uZW50LXRleHQtYXV0by1zaXplJzogdGhpcy5hdXRvU2l6ZX1cIlxyXG4gICAgICAgICAgICBbdGl0bGVdPVwic3RhdGljVGl0bGVcIiBbc3R5bGUudGV4dC1hbGlnbl09XCJ0ZXh0QWxpZ25cIlxyXG4gICAgICAgICAgICBbc3R5bGUuaGVpZ2h0XT1cIiFhdXRvU2l6ZSYmaGVpZ2h0PjA/aGVpZ2h0KydweCc6bnVsbFwiIFtzdHlsZS5taW5IZWlnaHRdPVwiYXV0b1NpemUmJmhlaWdodD4wP2hlaWdodCsncHgnOm51bGxcIlxyXG4gICAgICAgICAgICBbc3R5bGUubWF4SGVpZ2h0XT1cImF1dG9TaXplJiZtYXhIZWlnaHQ+MD9tYXhIZWlnaHQrJ3B4JzpudWxsXCI+e3t0ZXh0ICYmIHRleHQubGVuZ3RoID4gMCA/ICB0ZXh0IDogY29udHJvbH19PC9zcGFuPlxyXG4gICAgYCxcclxuICAgIHN0eWxlczogW10sXHJcbiAgICBwcm92aWRlcnM6IFt7XHJcbiAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVGV4dENvbXBvbmVudCksXHJcbiAgICAgICAgbXVsdGk6IHRydWUsXHJcbiAgICB9XVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGV4dENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQ29udHJvbFZhbHVlQWNjZXNzb3Ige1xyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mLWNvbXBvbmVudC10ZXh0JykgY2xzID0gdHJ1ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ3RleHRJbm5lcicsIHsgcmVhZDogRWxlbWVudFJlZiB9KSB0ZXh0SW5uZXJFbDogRWxlbWVudFJlZjtcclxuICAgIEBPdXRwdXQoKSB0ZXh0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICAvKiog5piv5ZCm5Li65a+G56CB6L6T5YWlICovXHJcbiAgICBASW5wdXQoKSBpc1Bhc3N3b3JkID0gZmFsc2U7XHJcbiAgICAvLyDmmK/lkKblpJrooYzmlofmnKxcclxuICAgIEBJbnB1dCgpIGlzVGV4dEFyZWEgPSBmYWxzZTtcclxuICAgIC8vIOaYr+WQpuWQr+eUqOiHquWKqOWwuuWvuFxyXG4gICAgQElucHV0KCkgYXV0b1NpemUgPSBmYWxzZTtcclxuICAgIC8vIOiuvue9ruacgOWkp+mrmOW6plxyXG4gICAgQElucHV0KCkgbWF4SGVpZ2h0OiBudW1iZXI7XHJcbiAgICAvLyDorr7nva7pq5jluqZcclxuICAgIEBJbnB1dCgpIGhlaWdodCA9IDA7XHJcbiAgICAvLyDmjqfku7bnsbvlnotcclxuICAgIEBJbnB1dCgpIHR5cGU6IHN0cmluZztcclxuICAgIC8vIOaYr+WQpuaYr+aXpeacn+iMg+WbtFxyXG4gICAgQElucHV0KCkgZGF0ZVJhbmdlID0gZmFsc2U7XHJcbiAgICAvLyDpnIDopoHovazljJbnsbvlnovmoLzlvI/nmoTooajovr7lvI9cclxuICAgIEBJbnB1dCgpIGZvcm1hdDogYW55O1xyXG4gICAgLy8g5aSa6K+t6KiAXHJcbiAgICBASW5wdXQoKSBsYW5nOiBzdHJpbmc7XHJcbiAgICAvLyDovazmjaLnsbvlnovnlKjliLDnmoTmlbDmja5cclxuICAgIEBJbnB1dCgpIGRhdGE6IGFueTtcclxuICAgIC8vIOWNg+WIhuS9jeespuWPt1xyXG4gICAgQElucHV0KCkgdGhvdXNhbmQgPSAnLCc7XHJcbiAgICAvLyDlsI/mlbDngrnlpITnrKblj7dcclxuICAgIEBJbnB1dCgpIGRlY2ltYWwgPSAnLic7XHJcbiAgICAvLyDotKfluIHnrKblj7flj4rlgLzlsZXnjrDlvaLlvI9cclxuICAgIEBJbnB1dCgpIGV4cHJlc3Npb24gPSAnJXMldic7XHJcbiAgICBASW5wdXQoKSBjdXJyZW50TGFuZ3VhZ2U6IHN0cmluZztcclxuICAgIC8vIGZvcm1Db250cm9s5pi+56S655qE5paH5pysXHJcbiAgICBASW5wdXQoKSBzaG93VGltZTogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHRleHRGaWVsZCA9ICduYW1lJztcclxuICAgIEBJbnB1dCgpIHZhbHVlRmllbGQgPSAndmFsdWUnO1xyXG4gICAgQElucHV0KCkgcmV0dXJuRm9ybWF0ID0gJyc7IC8vIOS7juacjeWKoeWZqOerr+WPluWAvOaYr+agvOW8j+WMluWQjueahFxyXG5cclxuICAgIC8vIOaWh+acrOaWueWQkVxyXG4gICAgQElucHV0KCkgdGV4dEFsaWduO1xyXG4gICAgLy8g5pel5pyf6IyD5Zu05qih5byP5LiLaW5wdXTnmoTmmL7npLrliIblibLnrKblkIhcclxuICAgIEBJbnB1dCgpIGRhdGVSYW5nZURlbGltaXRlciA9ICd+JztcclxuICAgIEBJbnB1dCgpIGVudW1EZWxpbWl0ZXIgPSAnLCc7XHJcbiAgICBwcml2YXRlIF90c2hvd1R5cGUgPSAwO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBzaG93VHlwZSh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fdHNob3dUeXBlID0gdmFsdWU7XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5ZGoXHJcbiAgICAgICAgaWYgKHZhbHVlID09IDQpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBzaG93VHlwZSgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90c2hvd1R5cGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWbvemZheWMluexu+Wei1xyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBsb2NhbGl6YXRpb25UeXBlOiBzdHJpbmc7XHJcbiAgICBjb250cm9sOiBhbnk7XHJcbiAgICAvLyDmma7pgJrmlofmnKxcclxuICAgIHRleHQ6IGFueTtcclxuICAgIC8vIOi0p+W4geespuWPt++8jOm7mOiupOaYr1JNQlxyXG4gICAgY3VycmVuY3lTeW1ib2wgPSAn77+lJztcclxuICAgIC8vIOWNgei/m+WItuWJjemdouWhq+WFheeahOespuWPt1xyXG4gICAgQElucHV0KCkgZmlsbGVkU3ltYm9sID0gJzAnO1xyXG4gICAgLy8g5pmu6YCa5paH5pys6L6T5YWl5YC8XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHZhbHVlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnRleHQgPSB0aGlzLmZvcm1hdFZhbHVlKHZhbHVlKTtcclxuICAgICAgICB0aGlzLnRleHRDaGFuZ2UuZW1pdCh0aGlzLnRleHQpO1xyXG4gICAgfVxyXG4gICAgZ2V0IHZhbHVlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRleHQ7XHJcbiAgICB9XHJcbiAgICBASG9zdExpc3RlbmVyKCdtb3VzZWVudGVyJywgWyckZXZlbnQnXSkgY2hhbmdlVGl0bGUoZXYpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNUZXh0QXJlYSAmJiAhdGhpcy5pc1Bhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VFbnRlckNoYW5nZVRpdGxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5qCH562+XHJcbiAgICBzdGF0aWNUaXRsZSA9IFwiXCI7XHJcbiAgICAvLyDlpITnkIbkuK3oi7Hmlofmg4XlhrXvvIwg5Zug5Li65aSa6K+t6KiA5pqC5pe25LiN6YCa6L+H6L+Z5Liq5bGe5oCn5o6n5Yi2XHJcbiAgICBASW5wdXQoKSBzaG93VGl0bGUgPSBmYWxzZTtcclxuICAgIC8v5pWw5YC85qC85byP5Y+C5pWwXHJcbiAgICBfb3B0aW9uO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBvcHRpb24odmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9vcHRpb24gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCBvcHRpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IGFueTtcclxuXHJcbiAgICBiZWZvcmVXcml0ZVZhbHVlOiAodmFsOiBhbnksIG9wdGlvbnM6IGFueSkgPT4gc3RyaW5nID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIGNvbnRyb2xDaGFuZ2UgPSAodmFsKSA9PiB7IH07XHJcbiAgICBwcml2YXRlIGNvbnRyb2xUb3VjaCA9ICh2YWwpID0+IHsgfTtcclxuICAgIHByaXZhdGUgZGVidWdTZXI6IERlYnVnU2VydmljZSA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGR0SGVscGVyOiBEYXRlVGltZUhlbHBlclNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBudW1iZXJIZWxwZXI6IE51bWJlckhlbHBlclNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHVibGljIG5nem9uZTogTmdab25lXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGVTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmRlYnVnU2VyID0gdGhpcy5pbmplY3Rvci5nZXQoRGVidWdTZXJ2aWNlLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgIH1cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgfVxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzVGV4dEFyZWEpIHtcclxuICAgICAgICAgICAgY29uc3QgY2xzTmFtZSA9IHRoaXMudGV4dElubmVyRWwubmF0aXZlRWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZTtcclxuICAgICAgICAgICAgdGhpcy50ZXh0SW5uZXJFbC5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lID0gY2xzTmFtZSArICcgZi1jbXAtdGV4dC1pcy10ZXh0YXJlYSc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBtb3VzZUVudGVyQ2hhbmdlVGl0bGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGV4dElubmVyRWwubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQgPiB0aGlzLnRleHRJbm5lckVsLm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGljVGl0bGUgPSB0aGlzLnRleHQgJiYgdGhpcy50ZXh0Lmxlbmd0aCA+IDAgPyB0aGlzLnRleHQgOiB0aGlzLmNvbnRyb2w7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNUaXRsZSA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWkhOeQhuWkmuivreiogO+8jOW+heWumlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRMYW5nKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgJiYgdmFsdWVbdGhpcy5jdXJyZW50TGFuZ3VhZ2VdID8gdmFsdWVbdGhpcy5jdXJyZW50TGFuZ3VhZ2VdIDogJyc7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEPotKfluIFcclxuICAgICAqIETljYHov5vliLZcclxuICAgICAqIEbmta7ngrnmlbBcclxuICAgICAqIE7mlbDlrZfvvIzluKbljYPliIbkvY1cclxuICAgICAqIFDnmb7liIbmr5RcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9ybWF0TnVtYmVyVmFsdWUodmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5mb3JtYXQgJiYgIXRoaXMuX29wdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbiAmJiB0aGlzLl9vcHRpb24udHlwZSAmJiB0aGlzLl9vcHRpb24udHlwZSA9PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fb3B0aW9uLmZvcm1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbi5mb3JtYXR0ZXIodmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29wdGlvbi51c2VUaG91c2FuZHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0aW9uLnByZWNpc2lvbiAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnbicgKyB0aGlzLl9vcHRpb24ucHJlY2lzaW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0ID0gJ24yJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRpb24ucHJlY2lzaW9uICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdCA9ICdmJyArIHRoaXMuX29wdGlvbi5wcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnZjInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBmaXJzdExldHRlciA9IHRoaXMuY3VycmVuY3lUb1VwcGVyQ2FzZSh0aGlzLmZvcm1hdC5zdWJzdHJpbmcoMCwgMSkpO1xyXG4gICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IE51bWJlcih0aGlzLmZvcm1hdC5zdWJzdHJpbmcoMSkpO1xyXG4gICAgICAgIGxldCBjb25maWcgPSB7fTtcclxuICAgICAgICBsZXQgcmVzdWx0OiBhbnk7XHJcbiAgICAgICAgaWYgKCEvQ3xEfEZ8TnxQL2cudGVzdChmaXJzdExldHRlcikpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVidWdTZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVidWdTZXIud2Fybihg5LiN5pSv5oyBZm9ybWF05Li6ICR7dGhpcy5mb3JtYXR9IOexu+Wei+eahOaVsOWtl+agvOW8j+WMlmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMudGhvdXNhbmQpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgdGhvdXNhbmQ6IHRoaXMudGhvdXNhbmQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRlY2ltYWwpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgZGVjaW1hbDogdGhpcy5kZWNpbWFsIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5leHByZXNzaW9uKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29uZmlnLCB7IGZvcm1hdDogdGhpcy5leHByZXNzaW9uIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2ggKGZpcnN0TGV0dGVyKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0MnOlxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgcHJlZml4OiB0aGlzLmN1cnJlbmN5U3ltYm9sLCBwcmVjaXNpb24gfSk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLm51bWJlckhlbHBlci5mb3JtYXRNb25leSh2YWx1ZSwgY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdEJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMudG9EZWNpbWFsKHZhbHVlLCBwcmVjaXNpb24pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ0YnOlxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb25maWcsIHsgcHJlZml4OiAnJywgdGhvdXNhbmQ6ICcnLCBwcmVjaXNpb24gfSk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLm51bWJlckhlbHBlci5mb3JtYXRNb25leSh2YWx1ZSwgY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdOJzpcclxuICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29uZmlnLCB7IHByZWZpeDogJycsIHByZWNpc2lvbiB9KTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMubnVtYmVySGVscGVyLmZvcm1hdE1vbmV5KHZhbHVlLCBjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ1AnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy50b1BlcmNlbnQodmFsdWUsIHByZWNpc2lvbik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB2YWx1ZSDovazmjaLmiJDljYHov5vliLbnmoTmlbDlrZdcclxuICAgICAqIEBwYXJhbSBwcmVjaXNpb24g5Y2B6L+b5Yi25pWw5a2X55qE6ZW/5bqmXHJcbiAgICAgKi9cclxuICAgIHRvRGVjaW1hbCh2YWx1ZTogYW55LCBwcmVjaXNpb246IGFueSkge1xyXG4gICAgICAgIGlmICh2YWx1ZS50b1N0cmluZygpLmluZGV4T2YoJy4nKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZGVidWdTZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVidWdTZXIud2Fybign5Y2B6L+b5Yi26L2s5o2i5LuF6ZmQ5pW05Z6L57G75Z6LJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKEFycmF5KHByZWNpc2lvbikuam9pbih0aGlzLmZpbGxlZFN5bWJvbCkgKyB2YWx1ZSkuc2xpY2UoLXByZWNpc2lvbik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB2YWx1ZSDovazmjaLmiJDnmb7liIbmlbDnmoTmlbDlrZdcclxuICAgICAqIEBwYXJhbSBkZWNpbWFsIOWwj+aVsOeCueS/neeVmeWHoOS9jVxyXG4gICAgICovXHJcbiAgICB0b1BlcmNlbnQodmFsdWU6IGFueSwgcHJlY2lzaW9uOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlICogMTAwKS50b0ZpeGVkKE51bWJlcihwcmVjaXNpb24pKSArICclJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhui0p+W4geespuWPt+mmluWtl+avjei9rOaNouaIkOWkp+WGmVxyXG4gICAgICovXHJcbiAgICBjdXJyZW5jeVRvVXBwZXJDYXNlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvW2Etel0rL2csICh3b3JkOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHdvcmQudG9VcHBlckNhc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWkhOeQhuW5tO+8jFk9PnksIEQ9PmRcclxuICAgICAqL1xyXG4gICAgZGF0ZVRvVXBwZXJDYXNlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBsZXQgbmV3Rm9ybWF0OiBhbnk7XHJcbiAgICAgICAgaWYgKC9ZL2cudGVzdCh2YWx1ZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgbmV3Rm9ybWF0ID0gdmFsdWUucmVwbGFjZSgvWS9nLCAneScpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5ld0Zvcm1hdCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoL0QvZy50ZXN0KG5ld0Zvcm1hdCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgbmV3Rm9ybWF0ID0gbmV3Rm9ybWF0LnJlcGxhY2UoL0QvZywgJ2QnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBuZXdGb3JtYXQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaemuS4vuexu+Wei+WkhOeQhlxyXG4gICAgICovXHJcbiAgICBnZXRGb3JtYXRFbnVtVmFsdWUodmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIOWPr+iDveWtmOWcqOWkmumAieaemuS4vu+8jOS9nOS4uuWIhumalOespiAgXHJcbiAgICAgICAgICAgIC8vIGxldCBjdXJWYWxzID0gKCcnICsgdmFsdWUpLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGxldCBjdXJWYWxzID0gKCcnICsgdmFsdWUpLnNwbGl0KHRoaXMuZW51bURlbGltaXRlcik7XHJcbiAgICAgICAgICAgIGxldCBuYW1lUmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY3VyVmFscy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpbmRPYmogPSB0aGlzLmRhdGEuZmluZChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVt0aGlzLnZhbHVlRmllbGRdID09IGN1clZhbHNba107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChmaW5kT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZVJlc3VsdC5wdXNoKGZpbmRPYmpbdGhpcy50ZXh0RmllbGRdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWVSZXN1bHQucHVzaChjdXJWYWxzW2tdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobmFtZVJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbmFtZVJlc3VsdC5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZVJlc3VsdC5qb2luKHRoaXMuZW51bURlbGltaXRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGJvb2xlYW7lgLzlpITnkIZcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9ybWF0Q2hlY2tCb3hWYWx1ZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd0ZXh0LnllcycpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IGZhbHNlIHx8IHZhbHVlID09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd0ZXh0Lm5vJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSB0aW1lRm9ybWF0VG8odmFsdWU6IGFueSwgZm10OiBzdHJpbmcsIGhvdXJTeXN0ZW0gPSAxMikge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG1ha2VGb3JtYXRlcihmbXQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAqIOaXpeacn+agvOW8j+WMllxyXG4gICAgKi9cclxuICAgIGRhdGVmb3JtYXQodmFsdWUpIHtcclxuICAgICAgICBsZXQgc3RyO1xyXG4gICAgICAgIGlmICghdGhpcy5mb3JtYXQpIHtcclxuICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnWVlZWS1NTS1ERCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOW9k+WJjeWAvOaYr+W3sue7j+agvOW8j+WMluWQjueahOaXpeacn+Wtl+espuS4slxyXG4gICAgICAgIGlmICh0aGlzLnJldHVybkZvcm1hdCAmJiB0aGlzLnJldHVybkZvcm1hdCAhPSAneXl5eS1NTS1kZCcgJiYgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy5nZXREYXRlRnJvbUZvcm1hdGVkU3RyaW5nKHZhbHVlLCB0aGlzLnJldHVybkZvcm1hdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybWF0ID09PSAnaGg6bW06c3MnIHx8IHRoaXMuZm9ybWF0ID09PSAnSEg6bW06c3MnKSB7XHJcbiAgICAgICAgICAgIC8vIOagvOW8j+WMluaXtumXtCAg5Li05pe25aSE55CGXHJcbiAgICAgICAgICAgIHN0ciA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLnNob3dUaW1lICYmIHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIGNvbnN0IGZvcm1BcnIgPSB0aGlzLmZvcm1hdC5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuc2hvd1RpbWUgJiYgZm9ybUFyci5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgZm9ybUFyci5wdXNoKCdISDptbTpzcycpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybUFyci5qb2luKCcgJyk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAvLyDmoLzlvI/ljJbml6XmnJ9cclxuICAgICAgICAgICAgLy8gICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGdldERhdGVGcm9tRm9ybWF0ZWRTdHJpbmcoZGF0ZVN0cmluZywgZm9ybWF0KSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsgeWVhcjogMCwgbW9udGg6IDAsIGRheTogMCwgaG91cjogMCwgbWluaXRlOiAwLCBzZWNvbmQ6IDAgfTsgLy8g5b2T54S26L+Z6YeM5Y+v5Lul6buY6K6kMTk3MC0xLTHml6VcclxuICAgICAgICBpZiAoZGF0ZVN0cmluZykge1xyXG4gICAgICAgICAgICBmb3JtYXQucmVwbGFjZSgveSt8WSt8TSt8ZCt8RCt8aCt8SCt8bSt8cysvZywgZnVuY3Rpb24gKG0sIGEsIGIsIGMpIHsvLyDov5nph4zlj6rlgZrkuoblubTmnIjml6UgIOWKoOaXtuWIhuenkuS5n+aYr+WPr+S7peeahFxyXG4gICAgICAgICAgICAgICAgZGF0ZVN0cmluZy5zdWJzdHJpbmcoYSkucmVwbGFjZSgvXFxkKy8sIGZ1bmN0aW9uIChkKSB7IGMgPSBwYXJzZUludChkLCAxMCkgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoL3krL2kudGVzdChtKSAmJiAhcmVzdWx0LnllYXIpIHJlc3VsdC55ZWFyID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvTSsvLnRlc3QobSkgJiYgIXJlc3VsdC5tb250aCkgcmVzdWx0Lm1vbnRoID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvZCsvaS50ZXN0KG0pICYmICFyZXN1bHQuZGF5KSByZXN1bHQuZGF5ID0gYztcclxuICAgICAgICAgICAgICAgIGlmICgvaCsvaS50ZXN0KG0pICYmICFyZXN1bHQuaG91cikgcmVzdWx0LmhvdXIgPSBjO1xyXG4gICAgICAgICAgICAgICAgaWYgKC9tKy8udGVzdChtKSAmJiAhcmVzdWx0Lm1pbml0ZSkgcmVzdWx0Lm1pbml0ZSA9IGM7XHJcbiAgICAgICAgICAgICAgICBpZiAoL3MrLy50ZXN0KG0pICYmICFyZXN1bHQuc2Vjb25kKSByZXN1bHQuc2Vjb25kID0gYztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bHREYXRlID0gbmV3IERhdGUocmVzdWx0LnllYXIgKyAnLycgKyByZXN1bHQubW9udGggKyAnLycgKyByZXN1bHQuZGF5ICsgJyAnICsgcmVzdWx0LmhvdXIgKyAnOicgKyByZXN1bHQubWluaXRlICsgJzonICsgcmVzdWx0LnNlY29uZCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdERhdGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOagvOW8j+WMluWkhOeQhlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRWYWx1ZSh2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHN0cjogYW55O1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMYW5ndWFnZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRMYW5nKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGlmICh0aGlzLnR5cGUgIT09ICdib29sZWFuJyAmJiAodmFsdWUgPT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICAgICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICghdGhpcy5mb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5mb3JtYXQgPSAnWVlZWS1NTS1ERCc7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICh0aGlzLmZvcm1hdCA9PT0gJ2hoOm1tOnNzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyDmoLzlvI/ljJbml7bpl7QgIOS4tOaXtuWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBzdHIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBpZiAodGhpcy5zaG93VGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgc3RyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyDmoLzlvI/ljJbml6XmnJ9cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHN0ciA9IHRoaXMuZHRIZWxwZXIuZm9ybWF0VG8odmFsdWUsIHRoaXMuZGF0ZVRvVXBwZXJDYXNlKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHRoaXMuZGF0ZWZvcm1hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVWYWx1ZXMgPSB2YWx1ZS5zcGxpdCh0aGlzLmRhdGVSYW5nZURlbGltaXRlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhU3RyID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVWYWx1ZXMgJiYgZGF0ZVZhbHVlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVZhbHVlcy5mb3JFYWNoKGRhdGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbCA9IHRoaXMuZGF0ZWZvcm1hdChkYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTdHIucHVzaCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gZGF0YVN0ci5qb2luKHRoaXMuZGF0ZVJhbmdlRGVsaW1pdGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgLy8gY2FzZSAnZGF0ZVRpbWUnOlxyXG4gICAgICAgICAgICAvLyAgICAgc3RyID0gdGhpcy50aW1lRm9ybWF0VG8odmFsdWUsIHRoaXMubWFrZUZvcm1hdGVyKHRoaXMuZm9ybWF0KSk7XHJcbiAgICAgICAgICAgIC8vICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgICAgICAgIHN0ciA9IHRoaXMuZ2V0Rm9ybWF0TnVtYmVyVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VudW0nOlxyXG4gICAgICAgICAgICAgICAgc3RyID0gdGhpcy5nZXRGb3JtYXRFbnVtVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxyXG4gICAgICAgICAgICAgICAgc3RyID0gdGhpcy5nZXRGb3JtYXRDaGVja0JveFZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7IC8vIHRocm93IG5ldyBFcnJvcihg5pqC5LiN5pSv5oyBICR7dGhpcy50eXBlfSDnsbvlnotgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRUZXh0MlN0YXIodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1Bhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXIgPSB2YWx1ZSA/ICcqKioqKionIDogJyc7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IHN0YXI7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbCA9IHN0YXI7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIC8vIGx1Y2FzIDIwMjEtMDgtMjdcclxuICAgICAgICBpZiAodGhpcy5zZXRUZXh0MlN0YXIodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHhpYSAyMDIxLTAzLTEzXHJcbiAgICAgICAgaWYgKHRoaXMuYmVmb3JlV3JpdGVWYWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxpemF0aW9uVHlwZTogdGhpcy5sb2NhbGl6YXRpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgc2hvd1RpbWU6IHRoaXMuc2hvd1RpbWUsXHJcbiAgICAgICAgICAgICAgICByZWY6IHRoaXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMuYmVmb3JlV3JpdGVWYWx1ZSh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGlmICh0ZXh0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250cm9sID0gdGhpcy5mb3JtYXRWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5jb250cm9sQ2hhbmdlKHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuOiAoKSA9PiB7fSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY29udHJvbENoYW5nZSA9IGZuO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZ2lzdGVyT25Ub3VjaGVkKGZuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jb250cm9sVG91Y2ggPSBmbjtcclxuICAgIH1cclxuXHJcbn1cclxuIl19