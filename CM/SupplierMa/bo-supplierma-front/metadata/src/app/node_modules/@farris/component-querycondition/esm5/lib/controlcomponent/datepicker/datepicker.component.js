/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/datepicker/datepicker.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Injector, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { ControlType } from '../../entity/controltype';
import { ShowType } from '@farris/ui-datepicker';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { QueryConditionComponent } from '../../querycondition.component';
var DatePickerComponent = /** @class */ (function () {
    function DatePickerComponent(injector) {
        this.injector = injector;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        // true显示时间 false不显示
        this.showType = ShowType.all; // 显示类型，默认显示全部1；不显示日期，用于选择年月模式2；不显示日期及月份，用于选择年模式3；用于周选择4。
        // 显示类型，默认显示全部1；不显示日期，用于选择年月模式2；不显示日期及月份，用于选择年模式3；用于周选择4。
        this.maxDate = '';
        this.minDate = '';
        this.editable = false;
        this.dateRangeDatesDelimiter = '~';
        this.solutionService = this.injector.get(SolutionService);
        /** @type {?} */
        var queryconditionComponent = this.injector.get(QueryConditionComponent, null);
        if (queryconditionComponent) {
            this.destroy$ = queryconditionComponent.destroy$;
        }
        else {
            this.destroy$ = new Subject();
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    DatePickerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            var isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            function (field) { return field == _this.item.fieldCode; }));
            if (isChange) {
                if (this.dateRange) {
                    this.beginValue = this.item.value && this.item.value.startTime ? this.item.value.startTime.toString().trim() : '';
                    this.endValue = this.item.value && this.item.value.endTime ? this.item.value.endTime.toString().trim() : '';
                    this.bindValue = this.item.value.getOriginalValue();
                }
                else {
                    this.bindValue = this.item.value.getOriginalValue();
                }
            }
        }
    };
    /**
     * @return {?}
     */
    DatePickerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.testId = this.solutionService.getGuid();
        // const controlType = this.item.control.getControlType();
        switch (this.controlType) {
            case ControlType.DateRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                this.dateRange = true;
                break;
            case ControlType.SingleDate:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                this.dateRange = false;
                break;
            case ControlType.SingleYear:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy';
                this.showType = ShowType.noDateAndMonth;
                this.dateRange = false;
                break;
            case ControlType.DateTimeRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd HH:mm:ss';
                if (this.item.control.enableCustomFormat) {
                    // 使用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd HH:mm:ss';
                }
                else {
                    // 未启用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                    this.dateFormat = this.dateFormat + ' HH:mm:ss';
                }
                this.showTime = true;
                this.dateRange = true;
                break;
            case ControlType.SingleMonth:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM';
                this.showType = ShowType.noDate;
                this.dateRange = false;
                break;
            case ControlType.MonthRange:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM';
                this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM';
                this.showType = ShowType.noDate;
                this.dateRange = true;
                break;
            case ControlType.SingleDateTime:
                this.returnFormat = this.item.control.returnFormat ? this.item.control.returnFormat : 'yyyy-MM-dd HH:mm:ss';
                if (this.item.control.enableCustomFormat) {
                    // 使用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd HH:mm:ss';
                }
                else {
                    // 未启用自定义格式
                    this.dateFormat = this.item.control.format ? this.item.control.format : 'yyyy-MM-dd';
                    this.dateFormat = this.dateFormat + ' HH:mm:ss';
                }
                this.showTime = true;
                this.dateRange = false;
                break;
        }
        // 更新条件
        this.updateParamsByCondition();
        this.placeholder = this.item.placeHolder ? this.item.placeHolder : this.item.control.placeholder;
        if (this.dateRange) {
            this.beginValue = this.item.value && this.item.value.startTime ? this.item.value.startTime.toString().trim() : '';
            this.endValue = this.item.value && this.item.value.endTime ? this.item.value.endTime.toString().trim() : '';
            this.beginPlaceHolder = this.item.beginPlaceHolder ? this.item.beginPlaceHolder : this.placeholder;
            this.endPlaceHolder = this.item.endPlaceHolder ? this.item.endPlaceHolder : this.placeholder;
            this.bindValue = this.item.value.getOriginalValue();
        }
        else {
            this.bindValue = this.item.value.getOriginalValue();
        }
        if (this.item.control.weekSelect && this.controlType == ControlType.DateRange) {
            this.showType = ShowType.selectWeek;
        }
        // 
        this.solutionService.getControlConfigState().pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} simpleConditions
         * @return {?}
         */
        function (simpleConditions) {
            //简单条件
            /** @type {?} */
            var findSimpleCondition = simpleConditions.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item['fieldCode'] == _this.item['fieldCode']; }));
            if (findSimpleCondition) {
                _this.updateParamsByCondition(findSimpleCondition);
            }
        }));
    };
    /**
     * @return {?}
     */
    DatePickerComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?=} condition
     * @return {?}
     */
    DatePickerComponent.prototype.updateParamsByCondition = /**
     * @private
     * @param {?=} condition
     * @return {?}
     */
    function (condition) {
        if (condition === void 0) { condition = null; }
        /** @type {?} */
        var conditionControl = null;
        conditionControl = condition ? condition.control : this.item.control;
        switch (this.controlType) {
            case ControlType.SingleYear:
                this.maxDate = conditionControl.hasOwnProperty('maxDate') ? conditionControl['maxDate'] : this.maxDate;
                this.minDate = conditionControl.hasOwnProperty('minDate') ? conditionControl['minDate'] : this.minDate;
                break;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DatePickerComponent.prototype.onDateChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.item.value.setOriginalValue({
            formatted: event.returnFormatted,
            delimiter: this.dateRangeDatesDelimiter
        });
        this.conditionChange.emit();
    };
    /**
     * @param {?} field
     * @return {?}
     */
    DatePickerComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatePickerComponent.prototype.beginValueChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // this.beginValue = $event;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatePickerComponent.prototype.endValueChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // this.endValue = $event;
    };
    DatePickerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-solution-datepicker',
                    template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly,'datepicker-range-group':dateRange}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-datepicker *ngIf=\"!dateRange\"\r\n                [(ngModel)]=\"bindValue\"\r\n                [dateRange]=\"dateRange\"\r\n                [placeholder]=\"placeholder\"\r\n                [returnFormat]=\"returnFormat\"\r\n                [dateFormat]=\"dateFormat\"\r\n                [editable]=\"editable\"\r\n                [showType]=\"showType\"\r\n                [showTime]=\"showTime\"\r\n                [readonly]=\"item.readonly\"\r\n                (valueChange)=\"onDateChange($event)\"\r\n                [maxDate]=\"maxDate\"\r\n                [minDate]=\"minDate\"\r\n                id=\"{{testId}}\"\r\n            >\r\n            </farris-datepicker>\r\n            <farris-datepicker *ngIf=\"dateRange\"\r\n                [dateRange]=\"dateRange\"\r\n                [placeholder]=\"placeholder\"      \r\n                [beginPlaceholder]=\"beginPlaceHolder\"\r\n                [endPlaceholder]=\"endPlaceHolder\"\r\n                [returnFormat]=\"returnFormat\"\r\n                [dateFormat]=\"dateFormat\"\r\n                [editable]=\"editable\"\r\n                [showType]=\"showType\"\r\n                [showTime]=\"showTime\"\r\n                [readonly]=\"item.readonly\"\r\n                [(ngModel)]=\"bindValue\"\r\n                (valueChange)=\"onDateChange($event)\"\r\n                id=\"{{testId}}\"\r\n            >\r\n            </farris-datepicker>\r\n        </div>\r\n    </div>\r\n</div>\r\n"
                }] }
    ];
    /** @nocollapse */
    DatePickerComponent.ctorParameters = function () { return [
        { type: Injector }
    ]; };
    DatePickerComponent.propDecorators = {
        item: [{ type: Input }],
        controlType: [{ type: Input }],
        changeFields: [{ type: Input }],
        conditionChange: [{ type: Output, args: ['conditionChange',] }]
    };
    return DatePickerComponent;
}());
export { DatePickerComponent };
if (false) {
    /** @type {?} */
    DatePickerComponent.prototype.item;
    /** @type {?} */
    DatePickerComponent.prototype.controlType;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    DatePickerComponent.prototype.changeFields;
    /** @type {?} */
    DatePickerComponent.prototype.conditionChange;
    /** @type {?} */
    DatePickerComponent.prototype.solutionService;
    /** @type {?} */
    DatePickerComponent.prototype.dateRange;
    /** @type {?} */
    DatePickerComponent.prototype.showTime;
    /** @type {?} */
    DatePickerComponent.prototype.showType;
    /** @type {?} */
    DatePickerComponent.prototype.maxDate;
    /** @type {?} */
    DatePickerComponent.prototype.minDate;
    /** @type {?} */
    DatePickerComponent.prototype.disableDates;
    /** @type {?} */
    DatePickerComponent.prototype.placeholder;
    /** @type {?} */
    DatePickerComponent.prototype.dateFormat;
    /** @type {?} */
    DatePickerComponent.prototype.returnFormat;
    /** @type {?} */
    DatePickerComponent.prototype.returnType;
    /** @type {?} */
    DatePickerComponent.prototype.disabled;
    /** @type {?} */
    DatePickerComponent.prototype.readonly;
    /** @type {?} */
    DatePickerComponent.prototype.editable;
    /** @type {?} */
    DatePickerComponent.prototype.dateRangeDatesDelimiter;
    /** @type {?} */
    DatePickerComponent.prototype.bindValue;
    /** @type {?} */
    DatePickerComponent.prototype.beginValue;
    /** @type {?} */
    DatePickerComponent.prototype.endValue;
    /** @type {?} */
    DatePickerComponent.prototype.testId;
    /** @type {?} */
    DatePickerComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    DatePickerComponent.prototype.endPlaceHolder;
    /** @type {?} */
    DatePickerComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatePickerComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sY29tcG9uZW50L2RhdGVwaWNrZXIvZGF0ZXBpY2tlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsUUFBUSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBRTlILE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUVqRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2pELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNDLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRXpFO0lBd0NFLDZCQUFvQixRQUFrQjtRQUFsQixhQUFRLEdBQVIsUUFBUSxDQUFVOzs7O1FBM0I3QixpQkFBWSxHQUFrQixFQUFFLENBQUM7UUFFZixvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7O1FBS2hFLGFBQVEsR0FBVyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMseURBQXlEOztRQUMxRixZQUFPLEdBQXlCLEVBQUUsQ0FBQztRQUNuQyxZQUFPLEdBQXlCLEVBQUUsQ0FBQztRQVFuQyxhQUFRLEdBQVksS0FBSyxDQUFDO1FBQzFCLDRCQUF1QixHQUFXLEdBQUcsQ0FBQztRQVVwQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDOztZQUNwRCx1QkFBdUIs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QUEsQUExTEQsSUEwTEM7U0F0TFksbUJBQW1COzs7SUFFOUIsbUNBQW1COztJQUVuQiwwQ0FBNkI7Ozs7O0lBSzdCLDJDQUEwQzs7SUFFMUMsOENBQWdFOztJQUVoRSw4Q0FBaUM7O0lBQ2pDLHdDQUFtQjs7SUFDbkIsdUNBQWtCOztJQUNsQix1Q0FBZ0M7O0lBQ2hDLHNDQUFtQzs7SUFDbkMsc0NBQW1DOztJQUNuQywyQ0FBNkQ7O0lBQzdELDBDQUFvQjs7SUFDcEIseUNBQW1COztJQUNuQiwyQ0FBcUI7O0lBQ3JCLHlDQUFtQjs7SUFDbkIsdUNBQWtCOztJQUNsQix1Q0FBa0I7O0lBQ2xCLHVDQUEwQjs7SUFDMUIsc0RBQXNDOztJQUN0Qyx3Q0FBa0I7O0lBQ2xCLHlDQUFnQjs7SUFDaEIsdUNBQWM7O0lBQ2QscUNBQWU7O0lBQ2YsK0NBQXdCOztJQUN4Qiw2Q0FBc0I7O0lBQ3RCLHVDQUF1Qjs7Ozs7SUFFWCx1Q0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIE9uQ2hhbmdlcywgSW5qZWN0b3IsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBTaW1wbGVDaGFuZ2VzLCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5cclxuaW1wb3J0IHsgQ29udHJvbFR5cGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUnO1xyXG5pbXBvcnQgeyBTaG93VHlwZSB9IGZyb20gJ0BmYXJyaXMvdWktZGF0ZXBpY2tlcic7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBRdWVyeUNvbmRpdGlvbkNvbXBvbmVudCB9IGZyb20gJy4uLy4uL3F1ZXJ5Y29uZGl0aW9uLmNvbXBvbmVudCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FwcC1zb2x1dGlvbi1kYXRlcGlja2VyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZGF0ZXBpY2tlci5jb21wb25lbnQuaHRtbCcsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRlUGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcbiAgLy8g6L+H5ruk5p2h5Lu2XHJcbiAgQElucHV0KCkgaXRlbTogYW55O1xyXG4gIC8vIFxyXG4gIEBJbnB1dCgpIGNvbnRyb2xUeXBlOiBudW1iZXI7XHJcblxyXG4gIC8qKlxyXG4gICAqIOafkOS4quWtl+auteWPkeeUn+WAvOWPmOWMluS6i+S7tuaXtu+8jOmcgOimgeWQjOatpea4heepuueahOWtl+aute+8jOWPr+iDveS4jeaYr+W9k+WJjeWtl+autVxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGNoYW5nZUZpZWxkczogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG5cclxuICBAT3V0cHV0KCdjb25kaXRpb25DaGFuZ2UnKSBjb25kaXRpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIHNvbHV0aW9uU2VydmljZTogU29sdXRpb25TZXJ2aWNlO1xyXG4gIGRhdGVSYW5nZTogYm9vbGVhbjsgLy8gdHJ1ZeWMuumXtCBmYWxzZeWNlVxyXG4gIHNob3dUaW1lOiBib29sZWFuOyAvLyB0cnVl5pi+56S65pe26Ze0IGZhbHNl5LiN5pi+56S6XHJcbiAgc2hvd1R5cGU6IG51bWJlciA9IFNob3dUeXBlLmFsbDsgLy8g5pi+56S657G75Z6L77yM6buY6K6k5pi+56S65YWo6YOoMe+8m+S4jeaYvuekuuaXpeacn++8jOeUqOS6jumAieaLqeW5tOaciOaooeW8jzLvvJvkuI3mmL7npLrml6XmnJ/lj4rmnIjku73vvIznlKjkuo7pgInmi6nlubTmqKHlvI8z77yb55So5LqO5ZGo6YCJ5oupNOOAglxyXG4gIG1heERhdGU6IHN0cmluZyB8IERhdGUgfCBudWxsID0gJyc7XHJcbiAgbWluRGF0ZTogc3RyaW5nIHwgRGF0ZSB8IG51bGwgPSAnJztcclxuICBkaXNhYmxlRGF0ZXM6IHsgeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyLCBkYXk6IG51bWJlciB9W107XHJcbiAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICBkYXRlRm9ybWF0OiBzdHJpbmc7IC8vIOaYvuekuuWAvOaXpeacn+agvOW8j+WMllxyXG4gIHJldHVybkZvcm1hdDogc3RyaW5nOyAvLyDov5Tlm57lgLzml6XmnJ/moLzlvI/ljJZcclxuICByZXR1cm5UeXBlOiBzdHJpbmc7IC8vIOi/lOWbnuWAvOexu+Wei++8jOi/lOWbnuWAvOexu+Wei+m7mOiupOaDheWGteS4i+aYr+WSjOi+k+WFpeWAvOexu+Wei+ebuOWQjO+8jOS9huaYr+WmguaenOi+k+WFpeWAvOS4um51bGznrYnpnZ7ms5XlgLzvvIzpu5jorqTkuLpTdHJpbmfvvIzlpoLmnpzmg7PmlLnkuLpEYXRl77yM5a6a5LmJ6K+l5a2X5q6144CCXHJcbiAgZGlzYWJsZWQ6IGJvb2xlYW47XHJcbiAgcmVhZG9ubHk6IGJvb2xlYW47XHJcbiAgZWRpdGFibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBkYXRlUmFuZ2VEYXRlc0RlbGltaXRlcjogc3RyaW5nID0gJ34nO1xyXG4gIGJpbmRWYWx1ZTogc3RyaW5nO1xyXG4gIGJlZ2luVmFsdWU6IGFueTtcclxuICBlbmRWYWx1ZTogYW55O1xyXG4gIHRlc3RJZDogc3RyaW5nO1xyXG4gIGJlZ2luUGxhY2VIb2xkZXI6c3RyaW5nO1xyXG4gIGVuZFBsYWNlSG9sZGVyOnN0cmluZztcclxuICBkZXN0cm95JDogU3ViamVjdDxhbnk+O1xyXG4gIFxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgICB0aGlzLnNvbHV0aW9uU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KFNvbHV0aW9uU2VydmljZSk7XHJcbiAgICBjb25zdCBxdWVyeWNvbmRpdGlvbkNvbXBvbmVudCA9IHRoaXMuaW5qZWN0b3IuZ2V0KFF1ZXJ5Q29uZGl0aW9uQ29tcG9uZW50LCBudWxsKTtcclxuICAgIGlmKHF1ZXJ5Y29uZGl0aW9uQ29tcG9uZW50KSB7XHJcbiAgICAgIHRoaXMuZGVzdHJveSQgPSBxdWVyeWNvbmRpdGlvbkNvbXBvbmVudC5kZXN0cm95JDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGVzdHJveSQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgaWYgKGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddICYmIGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZSAmJiAhY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uZmlyc3RDaGFuZ2UpIHtcclxuICAgICAgY29uc3QgaXNDaGFuZ2UgPSBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUuc29tZShmaWVsZCA9PiBmaWVsZCA9PSB0aGlzLml0ZW0uZmllbGRDb2RlKTtcclxuICAgICAgaWYgKGlzQ2hhbmdlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0ZVJhbmdlKSB7XHJcbiAgICAgICAgICB0aGlzLmJlZ2luVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUgJiYgdGhpcy5pdGVtLnZhbHVlLnN0YXJ0VGltZSA/IHRoaXMuaXRlbS52YWx1ZS5zdGFydFRpbWUudG9TdHJpbmcoKS50cmltKCkgOiAnJztcclxuICAgICAgICAgIHRoaXMuZW5kVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUgJiYgdGhpcy5pdGVtLnZhbHVlLmVuZFRpbWUgPyB0aGlzLml0ZW0udmFsdWUuZW5kVGltZS50b1N0cmluZygpLnRyaW0oKSA6ICcnO1xyXG4gICAgICAgICAgdGhpcy5iaW5kVmFsdWUgPSB0aGlzLml0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmJpbmRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZS5nZXRPcmlnaW5hbFZhbHVlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMudGVzdElkID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0R3VpZCgpO1xyXG4gICAgLy8gY29uc3QgY29udHJvbFR5cGUgPSB0aGlzLml0ZW0uY29udHJvbC5nZXRDb250cm9sVHlwZSgpO1xyXG4gICAgc3dpdGNoICh0aGlzLmNvbnRyb2xUeXBlKSB7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuRGF0ZVJhbmdlOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0tZGQnO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5TaW5nbGVEYXRlOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0tZGQnO1xyXG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgQ29udHJvbFR5cGUuU2luZ2xlWWVhcjpcclxuICAgICAgICB0aGlzLnJldHVybkZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdD90aGlzLml0ZW0uY29udHJvbC5yZXR1cm5Gb3JtYXQ6J3l5eXknO1xyXG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5JztcclxuICAgICAgICB0aGlzLnNob3dUeXBlID0gU2hvd1R5cGUubm9EYXRlQW5kTW9udGg7XHJcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5EYXRlVGltZVJhbmdlOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTS1kZCBISDptbTpzcyc7XHJcbiAgICAgICAgaWYodGhpcy5pdGVtLmNvbnRyb2wuZW5hYmxlQ3VzdG9tRm9ybWF0KXtcclxuICAgICAgICAgIC8vIOS9v+eUqOiHquWumuS5ieagvOW8j1xyXG4gICAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0tZGQgSEg6bW06c3MnO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgIC8vIOacquWQr+eUqOiHquWumuS5ieagvOW8j1xyXG4gICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkJztcclxuICAgICAgICAgICB0aGlzLmRhdGVGb3JtYXQgPSB0aGlzLmRhdGVGb3JtYXQgKyAnIEhIOm1tOnNzJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93VGltZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSB0cnVlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIENvbnRyb2xUeXBlLlNpbmdsZU1vbnRoOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTSc7XHJcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0nO1xyXG4gICAgICAgIHRoaXMuc2hvd1R5cGUgPSBTaG93VHlwZS5ub0RhdGU7XHJcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5Nb250aFJhbmdlOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTSc7XHJcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0nO1xyXG4gICAgICAgIHRoaXMuc2hvd1R5cGUgPSBTaG93VHlwZS5ub0RhdGU7XHJcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSB0cnVlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIENvbnRyb2xUeXBlLlNpbmdsZURhdGVUaW1lOlxyXG4gICAgICAgIHRoaXMucmV0dXJuRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wucmV0dXJuRm9ybWF0P3RoaXMuaXRlbS5jb250cm9sLnJldHVybkZvcm1hdDoneXl5eS1NTS1kZCBISDptbTpzcyc7XHJcbiAgICAgICAgaWYodGhpcy5pdGVtLmNvbnRyb2wuZW5hYmxlQ3VzdG9tRm9ybWF0KXtcclxuICAgICAgICAgIC8vIOS9v+eUqOiHquWumuS5ieagvOW8j1xyXG4gICAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0ID8gdGhpcy5pdGVtLmNvbnRyb2wuZm9ybWF0IDogJ3l5eXktTU0tZGQgSEg6bW06c3MnO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgIC8vIOacquWQr+eUqOiHquWumuS5ieagvOW8j1xyXG4gICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA/IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCA6ICd5eXl5LU1NLWRkJztcclxuICAgICAgICAgICB0aGlzLmRhdGVGb3JtYXQgPSB0aGlzLmRhdGVGb3JtYXQgKyAnIEhIOm1tOnNzJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93VGltZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2UgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIC8vIOabtOaWsOadoeS7tlxyXG4gICAgdGhpcy51cGRhdGVQYXJhbXNCeUNvbmRpdGlvbigpO1xyXG4gICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMuaXRlbS5wbGFjZUhvbGRlciA/IHRoaXMuaXRlbS5wbGFjZUhvbGRlciA6IHRoaXMuaXRlbS5jb250cm9sLnBsYWNlaG9sZGVyO1xyXG4gICAgaWYgKHRoaXMuZGF0ZVJhbmdlKSB7XHJcbiAgICAgIHRoaXMuYmVnaW5WYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZSAmJiB0aGlzLml0ZW0udmFsdWUuc3RhcnRUaW1lID8gdGhpcy5pdGVtLnZhbHVlLnN0YXJ0VGltZS50b1N0cmluZygpLnRyaW0oKSA6ICcnO1xyXG4gICAgICB0aGlzLmVuZFZhbHVlID0gdGhpcy5pdGVtLnZhbHVlICYmIHRoaXMuaXRlbS52YWx1ZS5lbmRUaW1lID8gdGhpcy5pdGVtLnZhbHVlLmVuZFRpbWUudG9TdHJpbmcoKS50cmltKCkgOiAnJztcclxuICAgICAgdGhpcy5iZWdpblBsYWNlSG9sZGVyID0gdGhpcy5pdGVtLmJlZ2luUGxhY2VIb2xkZXIgPyB0aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlciA6IHRoaXMucGxhY2Vob2xkZXI7XHJcbiAgICAgIHRoaXMuZW5kUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uZW5kUGxhY2VIb2xkZXIgPyB0aGlzLml0ZW0uZW5kUGxhY2VIb2xkZXIgOiB0aGlzLnBsYWNlaG9sZGVyO1xyXG4gICAgICB0aGlzLmJpbmRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZS5nZXRPcmlnaW5hbFZhbHVlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmJpbmRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZS5nZXRPcmlnaW5hbFZhbHVlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICh0aGlzLml0ZW0uY29udHJvbC53ZWVrU2VsZWN0ICYmIHRoaXMuY29udHJvbFR5cGUgPT0gQ29udHJvbFR5cGUuRGF0ZVJhbmdlKSB7XHJcbiAgICAgIHRoaXMuc2hvd1R5cGUgPSBTaG93VHlwZS5zZWxlY3RXZWVrO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBcclxuICAgIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbnRyb2xDb25maWdTdGF0ZSgpLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoKHNpbXBsZUNvbmRpdGlvbnMpID0+IHtcclxuICAgICAgLy/nroDljZXmnaHku7ZcclxuICAgICAgbGV0IGZpbmRTaW1wbGVDb25kaXRpb24gPSBzaW1wbGVDb25kaXRpb25zLmZpbmQoaXRlbSA9PiBpdGVtWydmaWVsZENvZGUnXSA9PSB0aGlzLml0ZW1bJ2ZpZWxkQ29kZSddKTtcclxuICAgICAgaWYgKGZpbmRTaW1wbGVDb25kaXRpb24pIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVBhcmFtc0J5Q29uZGl0aW9uKGZpbmRTaW1wbGVDb25kaXRpb24pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG5cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlUGFyYW1zQnlDb25kaXRpb24oY29uZGl0aW9uID0gbnVsbCkge1xyXG4gICAgbGV0IGNvbmRpdGlvbkNvbnRyb2wgPSBudWxsO1xyXG4gICAgY29uZGl0aW9uQ29udHJvbCA9IGNvbmRpdGlvbiA/IGNvbmRpdGlvbi5jb250cm9sIDogdGhpcy5pdGVtLmNvbnRyb2w7XHJcbiAgICBzd2l0Y2ggKHRoaXMuY29udHJvbFR5cGUpIHtcclxuICAgICAgY2FzZSBDb250cm9sVHlwZS5TaW5nbGVZZWFyOlxyXG4gICAgICAgIHRoaXMubWF4RGF0ZSA9IGNvbmRpdGlvbkNvbnRyb2wuaGFzT3duUHJvcGVydHkoJ21heERhdGUnKSA/IGNvbmRpdGlvbkNvbnRyb2xbJ21heERhdGUnXSA6IHRoaXMubWF4RGF0ZTtcclxuICAgICAgICB0aGlzLm1pbkRhdGUgPSBjb25kaXRpb25Db250cm9sLmhhc093blByb3BlcnR5KCdtaW5EYXRlJykgPyBjb25kaXRpb25Db250cm9sWydtaW5EYXRlJ10gOiB0aGlzLm1pbkRhdGU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIG9uRGF0ZUNoYW5nZShldmVudDogYW55KSB7XHJcbiAgICB0aGlzLml0ZW0udmFsdWUuc2V0T3JpZ2luYWxWYWx1ZSh7XHJcbiAgICAgIGZvcm1hdHRlZDogZXZlbnQucmV0dXJuRm9ybWF0dGVkLFxyXG4gICAgICBkZWxpbWl0ZXI6IHRoaXMuZGF0ZVJhbmdlRGF0ZXNEZWxpbWl0ZXJcclxuICAgIH0pO1xyXG4gICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkOiBRdWVyeUNvbmRpdGlvbikge1xyXG4gICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgfVxyXG5cclxuICBiZWdpblZhbHVlQ2hhbmdlKCRldmVudCkge1xyXG4gICAvLyB0aGlzLmJlZ2luVmFsdWUgPSAkZXZlbnQ7XHJcbiAgfVxyXG5cclxuICBlbmRWYWx1ZUNoYW5nZSgkZXZlbnQpIHtcclxuICAgLy8gdGhpcy5lbmRWYWx1ZSA9ICRldmVudDtcclxuICB9XHJcbn1cclxuIl19