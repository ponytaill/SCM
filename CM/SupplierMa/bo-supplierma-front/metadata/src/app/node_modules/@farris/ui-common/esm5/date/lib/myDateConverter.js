/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MyDateConverter = /** @class */ (function () {
    function MyDateConverter() {
        var _this = this;
        this.MONTHNAMES = 'January February March April May June July August September October November December'.split(' ');
        this.MONTHNAMES_LOOKUP = { 'jan': 1, 'feb': 2, 'mar': 3, 'apr': 4, 'may': 5, 'jun': 6, 'jul': 7, 'aug': 8, 'sep': 9, 'oct': 10, 'nov': 11, 'dec': 12 };
        /**
         * \@var {Array}  Abbreviated names for the months of the year
         */
        this.ABBR_MONTHNAMES = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' ');
        /**
         * \@var {Array}  Names for the days of the week from Sunday to Saturday
         */
        this.DAYNAMES = 'Sunday Monday Tuesday Wednesday Thursday Friday Saturday'.split(' ');
        this.DAYNAMES_LOOKUP = { 'sun': 0, 'mon': 1, 'tue': 2, 'wed': 3, 'thu': 4, 'fri': 5, 'sat': 6 };
        /**
         * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
         */
        this.ABBR_DAYNAMES = 'Sun Mon Tue Wed Thu Fri Sat'.split(' ');
        this.regexes = {
            YEAR: '[1-9]\\d{3}',
            MONTH: '1[0-2]|0?[1-9]',
            MONTH2: '1[0-2]|0[1-9]',
            MONTHNAME: 'jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december',
            DAYNAME: 'mon|monday|tue|tuesday|wed|wednesday|thu|thursday|fri|friday|sat|saturday|sun|sunday',
            DAY: '3[01]|[12]\\d|0?[1-9]',
            DAY2: '3[01]|[12]\\d|0[1-9]',
            TIMEZONE: '[+-][01]\\d\\:?[0-5]\\d',
            H24: '[01]\\d|2[0-3]',
            MIN: '[0-5]\\d',
            SEC: '[0-5]\\d',
            MS: '\\d{3,}',
            H12: '0?[1-9]|1[012]',
            AMPM: 'am|pm',
            UNIT: 'year|month|week|day|hour|minute|second|millisecond'
        };
        this.patterns = [
            // 2010-03-15
            [
                'iso_8601',
                this.makePattern('^(_YEAR_)-(_MONTH_)-(_DAY_)$'),
                '$2/$3/$1'
            ],
            // 3-15-2010
            [
                'us',
                this.makePattern('^(_MONTH_)([\\/-])(_DAY_)\\2(_YEAR_)$'),
                '$1/$3/$4'
            ],
            // 15.03.2010
            [
                'world',
                this.makePattern('^(_DAY_)([\\/\\.])(_MONTH_)\\2(_YEAR_)$'),
                '$3/$1/$4'
            ],
            // 15-Mar-2010, 8 Dec 2011, "Thu, 8 Dec 2011"
            [
                'chicago',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_DAY_)([ -])(_MONTHNAME_)\\2(_YEAR_)$'),
                '$3 $1, $4'
            ],
            // "March 4, 2012", "Mar 4 2012", "Sun Mar 4 2012"
            [
                'conversational',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_MONTHNAME_) (_DAY_),? (_YEAR_)$'),
                '$1 $2, $3'
            ],
            // Tue Jun 22 17:47:27 +0000 2010
            [
                'month_day_time_year',
                this.makePattern('^(?:_DAYNAME_) (_MONTHNAME_) (_DAY_) ((?:_H24_)\\:(?:_MIN_)(?:\\:_SEC_)?) (_TIMEZONE_) (_YEAR_)$'),
                (/**
                 * @param {?} m
                 * @return {?}
                 */
                function (m) {
                    /** @type {?} */
                    var month = _this.zeroPad(_this.getMonthByName(m[1]), 2);
                    /** @type {?} */
                    var day = _this.zeroPad(m[2], 2);
                    /** @type {?} */
                    var date = _this.create(m[5] + '-' + month + '-' + day + 'T' + m[3] + m[4]);
                    if (isNaN(date)) {
                        return false;
                    }
                    return date;
                })
            ],
            // @123456789
            [
                'unix',
                /^@(-?\d+)$/,
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    return _this.create(parseInt(match[1], 10) * 1000);
                })
            ],
            // 24-hour time (This will help catch Date objects that are casted to a string)
            [
                '24_hour',
                this.makePattern('^(?:(.+?)(?: |T))?(_H24_)\\:(_MIN_)(?:\\:(_SEC_)(?:\\.(_MS_))?)? ?(?:GMT)?(_TIMEZONE_)?(?: \\([A-Z]+\\))?$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    /** @type {?} */
                    var d;
                    if (match[1]) {
                        d = _this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = Date.now();
                        d.setMilliseconds(0);
                    }
                    d.setHours(parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4] || 0));
                    if (match[5]) {
                        d.setMilliseconds(+String(match[5]).slice(0, 3));
                    }
                    if (match[6]) {
                        d.setUTCOffsetString(match[6]);
                    }
                    return d;
                })
            ],
            // 12-hour time
            [
                '12_hour',
                this.makePattern('^(?:(.+) )?(_H12_)(?:\\:(_MIN_)(?:\\:(_SEC_))?)? ?(_AMPM_)$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    /** @type {?} */
                    var d;
                    if (match[1]) {
                        d = _this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = Date.now();
                        d.setMilliseconds(0);
                    }
                    /** @type {?} */
                    var hour = parseFloat(match[2]);
                    hour = match[5].toLowerCase() == 'am' ? (hour == 12 ? 0 : hour) : (hour == 12 ? 12 : hour + 12);
                    d.setHours(hour, parseFloat(match[3] || 0), parseFloat(match[4] || 0));
                    return d;
                })
            ]
        ];
    }
    /**
     * @param {?} code
     * @return {?}
     */
    MyDateConverter.prototype.makePattern = /**
     * @param {?} code
     * @return {?}
     */
    function (code) {
        var _this = this;
        code = code.replace(/_([A-Z][A-Z0-9]+)_/g, (/**
         * @param {?} $0
         * @param {?} $1
         * @return {?}
         */
        function ($0, $1) {
            return _this.regexes[$1];
        }));
        return new RegExp(code, 'i');
    };
    /**
     * @param {?} monthname
     * @return {?}
     */
    MyDateConverter.prototype.getMonthByName = /**
     * @param {?} monthname
     * @return {?}
     */
    function (monthname) {
        return this.MONTHNAMES_LOOKUP[String(monthname).slice(0, 3).toLowerCase()];
    };
    /**
     * @param {?} dayname
     * @return {?}
     */
    MyDateConverter.prototype.getWeekdayByName = /**
     * @param {?} dayname
     * @return {?}
     */
    function (dayname) {
        return this.DAYNAMES_LOOKUP[String(dayname).slice(0, 3).toLowerCase()];
    };
    /**
     * @private
     * @param {?} num
     * @param {?} digits
     * @return {?}
     */
    MyDateConverter.prototype.zeroPad = /**
     * @private
     * @param {?} num
     * @param {?} digits
     * @return {?}
     */
    function (num, digits) {
        switch (digits - String(num).length) {
            case 2: return '00' + num;
            case 1: return '0' + num;
        }
        return num;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    MyDateConverter.prototype.create = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        // 0 arguments or date is undefined
        if (typeof date == 'undefined') {
            return Date.now();
        }
        // If the passed value is already a date object, return it
        if (date instanceof Date) {
            return date;
        }
        /** @type {?} */
        var a = arguments;
        switch (a.length) {
            case 1:
                // If the passed value is an integer, interpret it as ms past epoch
                if (Object.prototype.toString.call(date) == '[object Number]') {
                    return new Date(date);
                }
                // trim the date
                date = String(date).replace(/^\s*(.*)\s*$/, '$1');
                // normalize whitespace
                date = date.replace(/\s{2,}/g, ' ');
                if (date === '') {
                    return Date.now();
                }
                /** @type {?} */
                var i = 0;
                /** @type {?} */
                var pattern;
                /** @type {?} */
                var ms;
                /** @type {?} */
                var obj;
                /** @type {?} */
                var match;
                /** @type {?} */
                var regex;
                /** @type {?} */
                var fn;
                // try each of our patterns
                while ((pattern = this.patterns[i++])) {
                    if (typeof pattern[0] == 'string') {
                        // pattern[0] is the name of the pattern
                        regex = pattern[1];
                        fn = pattern[2];
                    }
                    else {
                        // backwards compatibility with version 3.1
                        regex = pattern[0];
                        fn = pattern[1];
                    }
                    if (!(match = date.match(regex))) {
                        continue;
                    }
                    if (typeof fn == 'function') {
                        obj = fn(match, date);
                        if (obj instanceof Date) {
                            return obj;
                        }
                    }
                    else {
                        // fn is not a function but a string replace command
                        ms = Date.parse(date.replace(regex, fn));
                        if (!isNaN(ms)) {
                            return new Date(ms);
                        }
                    }
                }
                return NaN;
            case 2: return new Date(a[0], a[1], 1);
            case 3: return new Date(a[0], a[1], a[2]);
            case 4: return new Date(a[0], a[1], a[2], a[3]);
            case 5: return new Date(a[0], a[1], a[2], a[3], a[4]);
            case 6: return new Date(a[0], a[1], a[2], a[3], a[4], a[5]);
            default: return new Date(a[0], a[1], a[2], a[3], a[4], a[5], a[6]);
        }
    };
    return MyDateConverter;
}());
export { MyDateConverter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the months of the year
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_MONTHNAMES;
    /**
     * \@var {Array}  Names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_DAYNAMES;
    /** @type {?} */
    MyDateConverter.prototype.regexes;
    /** @type {?} */
    MyDateConverter.prototype.patterns;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlEYXRlQ29udmVydGVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jb21tb24vZGF0ZS8iLCJzb3VyY2VzIjpbImxpYi9teURhdGVDb252ZXJ0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0lBQUE7UUFBQSxpQkFtT0M7UUFsT1csZUFBVSxHQUFHLHVGQUF1RixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNoSCxzQkFBaUIsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7Ozs7UUFJbEosb0JBQWUsR0FBRyxpREFBaUQsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7Ozs7UUFJL0UsYUFBUSxHQUFHLDBEQUEwRCxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRixvQkFBZSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDOzs7O1FBSTNGLGtCQUFhLEdBQUcsNkJBQTZCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pFLFlBQU8sR0FBRztZQUNOLElBQUksRUFBRSxhQUFhO1lBQ25CLEtBQUssRUFBRSxnQkFBZ0I7WUFDdkIsTUFBTSxF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QUFDLENBQUM7eUJBQ3ZCO3FCQUNKO2lCQUNKO2dCQUNELE9BQU8sR0FBRyxDQUFDO1lBQ2YsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hELEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEQsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUQsT0FBTyxDQUFDLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN0RTtJQUNMLENBQUM7SUFDTCxzQkFBQztBQUFELENBQUMsQUFuT0QsSUFtT0M7Ozs7Ozs7SUFsT0cscUNBQXdIOzs7OztJQUN4SCw0Q0FBMEo7Ozs7OztJQUkxSiwwQ0FBdUY7Ozs7OztJQUl2RixtQ0FBeUY7Ozs7O0lBQ3pGLDBDQUFtRzs7Ozs7O0lBSW5HLHdDQUFpRTs7SUFDakUsa0NBZ0JFOztJQUVGLG1DQTRHRSIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBNeURhdGVDb252ZXJ0ZXIge1xyXG4gICAgcHJpdmF0ZSBNT05USE5BTUVTID0gJ0phbnVhcnkgRmVicnVhcnkgTWFyY2ggQXByaWwgTWF5IEp1bmUgSnVseSBBdWd1c3QgU2VwdGVtYmVyIE9jdG9iZXIgTm92ZW1iZXIgRGVjZW1iZXInLnNwbGl0KCcgJyk7XHJcbiAgICBwcml2YXRlIE1PTlRITkFNRVNfTE9PS1VQID0geyAnamFuJzogMSwgJ2ZlYic6IDIsICdtYXInOiAzLCAnYXByJzogNCwgJ21heSc6IDUsICdqdW4nOiA2LCAnanVsJzogNywgJ2F1Zyc6IDgsICdzZXAnOiA5LCAnb2N0JzogMTAsICdub3YnOiAxMSwgJ2RlYyc6IDEyIH07XHJcbiAgICAvKipcclxuICAgICAqIEB2YXIge0FycmF5fSAgQWJicmV2aWF0ZWQgbmFtZXMgZm9yIHRoZSBtb250aHMgb2YgdGhlIHllYXJcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBBQkJSX01PTlRITkFNRVMgPSAnSmFuIEZlYiBNYXIgQXByIE1heSBKdW4gSnVsIEF1ZyBTZXAgT2N0IE5vdiBEZWMnLnNwbGl0KCcgJyk7XHJcbiAgICAvKipcclxuICAgICAqIEB2YXIge0FycmF5fSAgTmFtZXMgZm9yIHRoZSBkYXlzIG9mIHRoZSB3ZWVrIGZyb20gU3VuZGF5IHRvIFNhdHVyZGF5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgREFZTkFNRVMgPSAnU3VuZGF5IE1vbmRheSBUdWVzZGF5IFdlZG5lc2RheSBUaHVyc2RheSBGcmlkYXkgU2F0dXJkYXknLnNwbGl0KCcgJyk7XHJcbiAgICBwcml2YXRlIERBWU5BTUVTX0xPT0tVUCA9IHsgJ3N1bic6IDAsICdtb24nOiAxLCAndHVlJzogMiwgJ3dlZCc6IDMsICd0aHUnOiA0LCAnZnJpJzogNSwgJ3NhdCc6IDYgfTtcclxuICAgIC8qKlxyXG4gICAgICogQHZhciB7QXJyYXl9ICBBYmJyZXZpYXRlZCBuYW1lcyBmb3IgdGhlIGRheXMgb2YgdGhlIHdlZWsgZnJvbSBTdW5kYXkgdG8gU2F0dXJkYXlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBBQkJSX0RBWU5BTUVTID0gJ1N1biBNb24gVHVlIFdlZCBUaHUgRnJpIFNhdCcuc3BsaXQoJyAnKTtcclxuICAgIHJlZ2V4ZXMgPSB7XHJcbiAgICAgICAgWUVBUjogJ1sxLTldXFxcXGR7M30nLFxyXG4gICAgICAgIE1PTlRIOiAnMVswLTJdfDA/WzEtOV0nLFxyXG4gICAgICAgIE1PTlRIMjogJzFbMC0yXXwwWzEtOV0nLFxyXG4gICAgICAgIE1PTlRITkFNRTogJ2phbnxqYW51YXJ5fGZlYnxmZWJydWFyeXxtYXJ8bWFyY2h8YXByfGFwcmlsfG1heXxqdW58anVuZXxqdWx8anVseXxhdWd8YXVndXN0fHNlcHxzZXB0ZW1iZXJ8b2N0fG9jdG9iZXJ8bm92fG5vdmVtYmVyfGRlY3xkZWNlbWJlcicsXHJcbiAgICAgICAgREFZTkFNRTogJ21vbnxtb25kYXl8dHVlfHR1ZXNkYXl8d2VkfHdlZG5lc2RheXx0aHV8dGh1cnNkYXl8ZnJpfGZyaWRheXxzYXR8c2F0dXJkYXl8c3VufHN1bmRheScsXHJcbiAgICAgICAgREFZOiAnM1swMV18WzEyXVxcXFxkfDA/WzEtOV0nLFxyXG4gICAgICAgIERBWTI6ICczWzAxXXxbMTJdXFxcXGR8MFsxLTldJyxcclxuICAgICAgICBUSU1FWk9ORTogJ1srLV1bMDFdXFxcXGRcXFxcOj9bMC01XVxcXFxkJyxcclxuICAgICAgICBIMjQ6ICdbMDFdXFxcXGR8MlswLTNdJyxcclxuICAgICAgICBNSU46ICdbMC01XVxcXFxkJyxcclxuICAgICAgICBTRUM6ICdbMC01XVxcXFxkJyxcclxuICAgICAgICBNUzogJ1xcXFxkezMsfScsXHJcbiAgICAgICAgSDEyOiAnMD9bMS05XXwxWzAxMl0nLFxyXG4gICAgICAgIEFNUE06ICdhbXxwbScsXHJcbiAgICAgICAgVU5JVDogJ3llYXJ8bW9udGh8d2Vla3xkYXl8aG91cnxtaW51dGV8c2Vjb25kfG1pbGxpc2Vjb25kJ1xyXG4gICAgfTtcclxuXHJcbiAgICBwYXR0ZXJucyA9IFtcclxuICAgICAgICAvLyAyMDEwLTAzLTE1XHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnaXNvXzg2MDEnLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKF9ZRUFSXyktKF9NT05USF8pLShfREFZXykkJyksXHJcbiAgICAgICAgICAgICckMi8kMy8kMSdcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyAzLTE1LTIwMTBcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICd1cycsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oX01PTlRIXykoW1xcXFwvLV0pKF9EQVlfKVxcXFwyKF9ZRUFSXykkJyksXHJcbiAgICAgICAgICAgICckMS8kMy8kNCdcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyAxNS4wMy4yMDEwXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnd29ybGQnLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKF9EQVlfKShbXFxcXC9cXFxcLl0pKF9NT05USF8pXFxcXDIoX1lFQVJfKSQnKSxcclxuICAgICAgICAgICAgJyQzLyQxLyQ0J1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIDE1LU1hci0yMDEwLCA4IERlYyAyMDExLCBcIlRodSwgOCBEZWMgMjAxMVwiXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnY2hpY2FnbycsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oPzooPzpfREFZTkFNRV8pLD8gKT8oX0RBWV8pKFsgLV0pKF9NT05USE5BTUVfKVxcXFwyKF9ZRUFSXykkJyksXHJcbiAgICAgICAgICAgICckMyAkMSwgJDQnXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gXCJNYXJjaCA0LCAyMDEyXCIsIFwiTWFyIDQgMjAxMlwiLCBcIlN1biBNYXIgNCAyMDEyXCJcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICdjb252ZXJzYXRpb25hbCcsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oPzooPzpfREFZTkFNRV8pLD8gKT8oX01PTlRITkFNRV8pIChfREFZXyksPyAoX1lFQVJfKSQnKSxcclxuICAgICAgICAgICAgJyQxICQyLCAkMydcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyBUdWUgSnVuIDIyIDE3OjQ3OjI3ICswMDAwIDIwMTBcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICdtb250aF9kYXlfdGltZV95ZWFyJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXig/Ol9EQVlOQU1FXykgKF9NT05USE5BTUVfKSAoX0RBWV8pICgoPzpfSDI0XylcXFxcOig/Ol9NSU5fKSg/OlxcXFw6X1NFQ18pPykgKF9USU1FWk9ORV8pIChfWUVBUl8pJCcpLFxyXG4gICAgICAgICAgICAobSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSB0aGlzLnplcm9QYWQodGhpcy5nZXRNb250aEJ5TmFtZShtWzFdKSwgMik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXkgPSB0aGlzLnplcm9QYWQobVsyXSwgMik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRlOiBhbnkgPSB0aGlzLmNyZWF0ZShtWzVdICsgJy0nICsgbW9udGggKyAnLScgKyBkYXkgKyAnVCcgKyBtWzNdICsgbVs0XSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIEAxMjM0NTY3ODlcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICd1bml4JyxcclxuICAgICAgICAgICAgL15AKC0/XFxkKykkLyxcclxuICAgICAgICAgICAgKG1hdGNoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGUocGFyc2VJbnQobWF0Y2hbMV0sIDEwKSAqIDEwMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gMjQtaG91ciB0aW1lIChUaGlzIHdpbGwgaGVscCBjYXRjaCBEYXRlIG9iamVjdHMgdGhhdCBhcmUgY2FzdGVkIHRvIGEgc3RyaW5nKVxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJzI0X2hvdXInLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKD86KC4rPykoPzogfFQpKT8oX0gyNF8pXFxcXDooX01JTl8pKD86XFxcXDooX1NFQ18pKD86XFxcXC4oX01TXykpPyk/ID8oPzpHTVQpPyhfVElNRVpPTkVfKT8oPzogXFxcXChbQS1aXStcXFxcKSk/JCcpLFxyXG4gICAgICAgICAgICAobWF0Y2gpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuY3JlYXRlKG1hdGNoWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5zZXRNaWxsaXNlY29uZHMoMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkLnNldEhvdXJzKHBhcnNlRmxvYXQobWF0Y2hbMl0pLCBwYXJzZUZsb2F0KG1hdGNoWzNdKSwgcGFyc2VGbG9hdChtYXRjaFs0XSB8fCAwKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbNV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygrU3RyaW5nKG1hdGNoWzVdKS5zbGljZSgwLCAzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbNl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBkLnNldFVUQ09mZnNldFN0cmluZyhtYXRjaFs2XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIDEyLWhvdXIgdGltZVxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJzEyX2hvdXInLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKD86KC4rKSApPyhfSDEyXykoPzpcXFxcOihfTUlOXykoPzpcXFxcOihfU0VDXykpPyk/ID8oX0FNUE1fKSQnKSxcclxuICAgICAgICAgICAgKG1hdGNoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZDtcclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaFsxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLmNyZWF0ZShtYXRjaFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuc2V0TWlsbGlzZWNvbmRzKDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGhvdXIgPSBwYXJzZUZsb2F0KG1hdGNoWzJdKTtcclxuICAgICAgICAgICAgICAgIGhvdXIgPSBtYXRjaFs1XS50b0xvd2VyQ2FzZSgpID09ICdhbScgPyAoaG91ciA9PSAxMiA/IDAgOiBob3VyKSA6IChob3VyID09IDEyID8gMTIgOiBob3VyICsgMTIpO1xyXG4gICAgICAgICAgICAgICAgZC5zZXRIb3Vycyhob3VyLCBwYXJzZUZsb2F0KG1hdGNoWzNdIHx8IDApLCBwYXJzZUZsb2F0KG1hdGNoWzRdIHx8IDApKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG5cclxuICAgIF07XHJcblxyXG4gICAgbWFrZVBhdHRlcm4oY29kZSkge1xyXG4gICAgICAgIGNvZGUgPSBjb2RlLnJlcGxhY2UoL18oW0EtWl1bQS1aMC05XSspXy9nLCAoJDAsICQxKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZ2V4ZXNbJDFdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVnRXhwKGNvZGUsICdpJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TW9udGhCeU5hbWUobW9udGhuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuTU9OVEhOQU1FU19MT09LVVBbU3RyaW5nKG1vbnRobmFtZSkuc2xpY2UoMCwgMykudG9Mb3dlckNhc2UoKV07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2Vla2RheUJ5TmFtZShkYXluYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuREFZTkFNRVNfTE9PS1VQW1N0cmluZyhkYXluYW1lKS5zbGljZSgwLCAzKS50b0xvd2VyQ2FzZSgpXTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHplcm9QYWQobnVtLCBkaWdpdHMpIHtcclxuICAgICAgICBzd2l0Y2ggKGRpZ2l0cyAtIFN0cmluZyhudW0pLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjYXNlIDI6IHJldHVybiAnMDAnICsgbnVtO1xyXG4gICAgICAgICAgICBjYXNlIDE6IHJldHVybiAnMCcgKyBudW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudW07XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlKGRhdGUpIHtcclxuICAgICAgICAvLyAwIGFyZ3VtZW50cyBvciBkYXRlIGlzIHVuZGVmaW5lZFxyXG4gICAgICAgIGlmICh0eXBlb2YgZGF0ZSA9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgdGhlIHBhc3NlZCB2YWx1ZSBpcyBhbHJlYWR5IGEgZGF0ZSBvYmplY3QsIHJldHVybiBpdFxyXG4gICAgICAgIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYSA9IGFyZ3VtZW50cztcclxuICAgICAgICBzd2l0Y2ggKGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBwYXNzZWQgdmFsdWUgaXMgYW4gaW50ZWdlciwgaW50ZXJwcmV0IGl0IGFzIG1zIHBhc3QgZXBvY2hcclxuICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0ZSkgPT0gJ1tvYmplY3QgTnVtYmVyXScpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB0cmltIHRoZSBkYXRlXHJcbiAgICAgICAgICAgICAgICBkYXRlID0gU3RyaW5nKGRhdGUpLnJlcGxhY2UoL15cXHMqKC4qKVxccyokLywgJyQxJyk7XHJcbiAgICAgICAgICAgICAgICAvLyBub3JtYWxpemUgd2hpdGVzcGFjZVxyXG4gICAgICAgICAgICAgICAgZGF0ZSA9IGRhdGUucmVwbGFjZSgvXFxzezIsfS9nLCAnICcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERhdGUubm93KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDAsIHBhdHRlcm4sIG1zLCBvYmosIG1hdGNoLCByZWdleCwgZm47XHJcbiAgICAgICAgICAgICAgICAvLyB0cnkgZWFjaCBvZiBvdXIgcGF0dGVybnNcclxuICAgICAgICAgICAgICAgIHdoaWxlICgocGF0dGVybiA9IHRoaXMucGF0dGVybnNbaSsrXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBhdHRlcm5bMF0gPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVyblswXSBpcyB0aGUgbmFtZSBvZiB0aGUgcGF0dGVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleCA9IHBhdHRlcm5bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuID0gcGF0dGVyblsyXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIHZlcnNpb24gMy4xXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4ID0gcGF0dGVyblswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm4gPSBwYXR0ZXJuWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShtYXRjaCA9IGRhdGUubWF0Y2gocmVnZXgpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IGZuKG1hdGNoLCBkYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmbiBpcyBub3QgYSBmdW5jdGlvbiBidXQgYSBzdHJpbmcgcmVwbGFjZSBjb21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zID0gRGF0ZS5wYXJzZShkYXRlLnJlcGxhY2UocmVnZXgsIGZuKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUobXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5hTjtcclxuICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgMSk7XHJcbiAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIGFbMl0pO1xyXG4gICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdKTtcclxuICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgYVsyXSwgYVszXSwgYVs0XSk7XHJcbiAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0sIGFbNV0pO1xyXG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgYVsyXSwgYVszXSwgYVs0XSwgYVs1XSwgYVs2XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==