/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { InputGroupComponent } from '@farris/ui-input-group';
import { ChangeDetectorRef } from '@angular/core';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-07-10 11:44:49
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-05 11:44:18
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, ViewChild, ElementRef, Input, ContentChild, TemplateRef, QueryList, ContentChildren, Output, EventEmitter, ViewEncapsulation, NgZone } from '@angular/core';
import { of, fromEvent } from 'rxjs';
import { PerfectScrollbarComponent } from '@farris/ui-perfect-scrollbar';
import { PaginationControlsComponent } from '@farris/ui-pagination';
import { IdService } from '@farris/ui-common';
import { deepCopy } from './datatable-column';
import { ColumnDirective } from './datatable-column.component';
import { DataTableService } from './datatable.service';
import { DataTableHeaderComponent } from './table/datatable-header.component';
import { delay } from 'rxjs/operators';
export class DataTableComponent {
    /**
     * @param {?} dataService
     * @param {?} idService
     * @param {?} el
     * @param {?} cd
     * @param {?} ngZone
     */
    constructor(dataService, idService, el, cd, ngZone) {
        this.dataService = dataService;
        this.idService = idService;
        this.el = el;
        this.cd = cd;
        this.ngZone = ngZone;
        this.searchButtonText = '<i class="f-icon f-icon-search"></i>';
        this.keydownEnterEdit = false;
        this.allColumnsTitle = '所有列';
        // 数据表高度
        // 是否填充
        this.fill = false;
        // 默认分页
        this.pagination = true;
        this.pagerOnServer = true;
        this.pageSize = 10;
        this.pageIndex = 1;
        this.showPageInfo = true;
        this.showPageNumber = true;
        this.showPageList = true;
        this.pagerViewMode = 'default';
        /**
         * 显示表头
         */
        this.showHeader = true;
        this._pageList = [10, 20, 30, 50, 100];
        this.total = 0;
        // 可筛选
        this.showFilterBar = false;
        // table  数据
        this._data = [];
        this.remote = 'client';
        /**
         * 启用远端排序
         */
        this.remoteSort = true;
        /**
         * 允许多列排序
         */
        this.multiSort = false;
        // 多选  单选
        this.singleSelect = true;
        this.idField = 'id';
        // 显示鼠标悬停高亮
        this.hover = true;
        // 分页事件
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        this.search = new EventEmitter();
        this.columnSorted = new EventEmitter();
        this.rowDblClick = new EventEmitter();
        this.selectedRow = new EventEmitter();
        // 兼容
        this.selectRows = new EventEmitter();
        this.unSelectRow = new EventEmitter();
        this.cellClick = new EventEmitter();
        this.clearSearchValue = new EventEmitter();
        this.checkAll = new EventEmitter();
        this.sortChange = new EventEmitter();
        // 是否可拖拽  默认可以
        this.resizableColumns = true;
        /**
         * 针对同一条记录，单选时，多次单击后不取消选中。
         */
        this.keepSelect = true;
        // 是否有行模板
        this.hasRowTepml = false;
        // 设置拖拽停止器
        this.moveable = false;
        this.searchData = { field: '*', value: '' };
        // 事件订阅存储  便于销毁
        this.subscription = [];
        // 原数据
        this.filter = '';
        this.maxSize = 7;
        this.directionLinks = true;
        this.autoHide = false;
        this.responsive = true;
        this.paginationOptions = {
            id: 'Farris-DataTable-Pagination',
            itemsPerPage: this.pageSize,
            currentPage: this.pageIndex,
            pageList: this.pageList,
            totalItems: this.total,
            remote: this.pagerOnServer
        };
        this.labels = {
            previousLabel: ' ',
            nextLabel: ' ',
            screenReaderPaginationLabel: 'Pagination',
            screenReaderPageLabel: 'page',
            screenReaderCurrentLabel: `You're on page`
        };
        this._currentRowIndex = -1;
        this._currentRow = undefined;
        this.isCheckAll = (/**
         * @return {?}
         */
        () => {
            if (!this.selections || !this.selections.length) {
                return false;
            }
            if (!this.data || !this.data.length) {
                return false;
            }
            /** @type {?} */
            let total = 0;
            this.selections.forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                if (this.data.find((/**
                 * @param {?} d
                 * @return {?}
                 */
                d => d[this.idField] === n[this.idField]))) {
                    total += 1;
                }
            }));
            return this.data.length === total;
        });
        this.scrollWidth = 0;
        this.mouseEnterOnPager = null;
        this.mouseLeaveOnPager = null;
        this.mouseWheelOnPager = null;
        this.pgScrollLeft = 0;
        this.trackByRows = (/**
         * @param {?} index
         * @param {?} row
         * @return {?}
         */
        (index, row) => {
            return row[this.idField];
        });
        this.dataService.selectedRow.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (this.singleSelect) {
                this._currentRowIndex = e.rowIndex;
                this._currentRow = e.rowData;
            }
            else {
                if (this.selections) {
                    this.dtHeader.isCheckAll = this.isCheckAll();
                }
            }
        }));
        this.dataService.unSelectedRow.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (this.singleSelect) {
                this._currentRow = undefined;
                this._currentRowIndex = -1;
            }
            else {
                this.dtHeader.isCheckAll = false;
            }
        }));
    }
    /**
     * @return {?}
     */
    get pageList() {
        return this._pageList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set pageList(val) {
        this._pageList = val;
        if (this.pager) {
            this.pager.setPageList(val);
        }
    }
    /**
     * @return {?}
     */
    get data() {
        return this._data;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set data(data) {
        this._data = data;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set selections(v) {
        this.dtBody.selections = v ? v : {};
    }
    /**
     * @return {?}
     */
    get selections() {
        return this.dtBody.selections;
    }
    /**
     * @return {?}
     */
    get currentRowIndex() {
        return this._currentRowIndex;
    }
    /**
     * @return {?}
     */
    get currentRow() {
        return this._currentRow;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.setBodyHeight();
            this.ps = this.perfectScrollbar.directiveRef.ps();
        }));
        if (!this.id) {
            this.id = `datatable_${this.idService.generate()}`;
        }
        this.paginationOptions.id = this.paginationOptions.id + this.id;
        this.copyData = deepCopy(this.data);
        if (!this.beforeSortColumn) {
            this.beforeSortColumn = (/**
             * @return {?}
             */
            () => of(true));
        }
    }
    /**
     * @private
     * @return {?}
     */
    setBodyHeight() {
        this.tableHeight = this.height;
        if (this.showFilterBar) {
            this.tableHeight = this.height - 46;
        }
        if (this.showHeader) {
            this.scorllableBodyHeight = this.tableHeight - this.tableHeader.nativeElement.clientHeight;
        }
        if (this.pagination) {
            this.scorllableBodyHeight = this.scorllableBodyHeight - 50;
        }
        if (this.tablePager) {
            this.scrollWidth = this.tablePager.nativeElement.scrollWidth;
        }
        this.pgScrollLeft = 0;
        if (this.cd && !this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    }
    /**
     * @return {?}
     */
    onClearSearchValue() {
        this.searchData.value = '';
        this.cd.detectChanges();
        this.clearSearchValue.emit();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.height && !changes.height.isFirstChange()) {
            this.setBodyHeight();
        }
        if (changes.total && !changes.total.isFirstChange()) {
            this.paginationOptions.totalItems = changes.total.currentValue;
        }
        if (changes.pageSize) {
            this.paginationOptions.itemsPerPage = changes.pageSize.currentValue;
        }
        if (changes.pageIndex && !changes.pageIndex.isFirstChange()) {
            this.paginationOptions.currentPage = changes.pageIndex.currentValue;
        }
        if (changes.data && !changes.data.isFirstChange()) {
            /** @type {?} */
            const rows = changes.data.currentValue;
            this.updateCheckboxState(rows);
            this.paginationOptions = Object.assign({}, this.paginationOptions);
            this.dataService.loadSuccess.next(changes.data.currentValue);
        }
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        // 支持列组件写入
        if (!this.columns) {
            if (this.columnsRef && this.columnsRef.length) {
                this.columns = this.columnsRef.map((/**
                 * @param {?} col
                 * @return {?}
                 */
                col => {
                    return {
                        width: col.width,
                        title: col.title,
                        field: col.field,
                        align: col.align,
                        fixed: col.fixed,
                        className: col.className,
                        multipleFilter: col.multipleFilter,
                        filter: col.filter,
                        media: col.media,
                        sortable: col.sortable,
                        edit: col.edit
                    };
                }));
            }
        }
        if (this.tablePager) {
            this.tablePager.nativeElement.addEventListener('mouseenter', this.mouseEnterOnPager = (/**
             * @return {?}
             */
            () => {
                this.pgScrollbar.nativeElement.style.display = "block";
            }));
            this.tablePager.nativeElement.addEventListener('mouseleave', this.mouseLeaveOnPager = (/**
             * @return {?}
             */
            () => {
                this.pgScrollbar.nativeElement.style.display = "none";
            }));
            this.tablePager.nativeElement.addEventListener('wheel', this.mouseWheelOnPager = (/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                /** @type {?} */
                const box = this.tablePager.nativeElement;
                /** @type {?} */
                const sw = this.scrollWidth;
                /** @type {?} */
                const ow = box.offsetWidth;
                if (sw > ow) {
                    /** @type {?} */
                    const right = sw - ow;
                    /** @type {?} */
                    const sl = Math.abs(this.pgScrollLeft);
                    if (sl < right && e.deltaY > 0) {
                        e.preventDefault();
                        // this.pgScrollLeft = -(sl + 50);
                        this.pgScrollbar.nativeElement.scrollLeft = sl + 50;
                    }
                    if (sl > 0 && e.deltaY < 0) {
                        e.preventDefault();
                        // this.pgScrollLeft = -(sl - 50);
                        this.pgScrollbar.nativeElement.scrollLeft = sl - 50;
                    }
                }
            }));
        }
        if (this.pgScrollbar) {
            fromEvent(this.pgScrollbar.nativeElement, 'scroll').pipe(delay(50)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                // console.log(e)
                this.pgScrollLeft = -e.target.scrollLeft;
            }));
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.subscription.forEach((/**
         * @param {?} sub
         * @return {?}
         */
        sub => {
            sub.unsubscribe();
        }));
        this.subscription = [];
        this.pager = null;
        if (this.tablePager && this.tablePager.nativeElement) {
            this.tablePager.nativeElement.removeEventListener('mouseenter', this.mouseEnterOnPager);
            this.tablePager.nativeElement.removeEventListener('mouseleave', this.mouseLeaveOnPager);
            this.tablePager.nativeElement.removeEventListener('wheel', this.mouseWheelOnPager);
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // 获取表格容器  即表格
        this.datatableContainer = this.el.nativeElement.querySelector('.farris-datatable');
        // this.headerTr = this.tableHeader.nativeElement.querySelectorAll('tr');
    }
    /**
     * @param {?} rows
     * @return {?}
     */
    updateCheckboxState(rows) {
        /** @type {?} */
        const updateCheckAllStatus = (/**
         * @param {?} f
         * @return {?}
         */
        (f) => {
            if (this.showHeader && this.dtHeader) {
                this.dtHeader.isCheckAll = f;
            }
        });
        if (rows && rows.length) {
            if (this.selections) {
                /** @type {?} */
                const keys = Object.keys(this.dtBody._selections);
                if (keys.length) {
                    /** @type {?} */
                    let count = 0;
                    /** @type {?} */
                    const ids = rows.map((/**
                     * @param {?} row
                     * @return {?}
                     */
                    (row) => {
                        return row[this.idField].toString();
                    }));
                    keys.forEach((/**
                     * @param {?} id
                     * @return {?}
                     */
                    id => {
                        if (ids.indexOf(id) > -1) {
                            count++;
                        }
                    }));
                    updateCheckAllStatus(ids.length === count);
                }
                else {
                    updateCheckAllStatus(false);
                }
            }
            else {
                updateCheckAllStatus(false);
            }
        }
        else {
            updateCheckAllStatus(false);
        }
    }
    /**
     * 获取表格容器的位置  距离左边视口和上边视口的距离  如果页面有滚动条  需要加上滚动条滚动的数值
     * @return {?}
     */
    getContainerOffset() {
        /** @type {?} */
        const rect = this.datatableContainer.getBoundingClientRect();
        return {
            left: rect.left + document.body.scrollLeft,
            top: rect.top + document.body.scrollTop,
            right: rect.right,
            bottom: rect.bottom,
        };
    }
    /**
     *  鼠标按下  开始记录拖拽线的位置  拖拽线到达当前鼠标位置
     * @param {?} e 鼠标对象
     * @return {?}
     */
    beginDrag(e) {
        this.dragLineX = e.pageX;
        event.preventDefault();
    }
    /**
     * 鼠标移动 移动拖拽线位置变动
     * @param {?} e 鼠标对象
     * @return {?}
     */
    moveDrag(e) {
        // 获取表格的左边距离
        /** @type {?} */
        const containerLeft = this.getContainerOffset().left;
        // 设置拖拽线的高度  即获取表头+表内容+表尾的高度  此表格结构包含了分页  因此要去掉分页的高度
        if (this.tablePager) {
            this.dragLine.nativeElement.style.height = this.datatableContainer.offsetHeight -
                this.tablePager.nativeElement.offsetHeight + 'px';
        }
        else {
            // const headerHeight = this.el.nativeElement.querySelector('.farris-table-header');
            // const bodyHeight = this.el.nativeElement.querySelector('.ps-content');
            this.dragLine.nativeElement.style.height = this.datatableContainer.offsetHeight + 'px';
        }
        // 设置拖拽线的高度 拖拽线相对于表格relative定位是absolute，因此是0
        this.dragLine.nativeElement.style.top = 0 + 'px';
        // 鼠标移动时，拖拽线相对于表格的位置
        this.dragLine.nativeElement.style.left = (e.pageX - containerLeft) + 'px';
        // 鼠标移动  设置拖拽线总是可见
        this.dragLine.nativeElement.style.display = 'block';
    }
    // 重新计算表格宽度
    /**
     * 鼠标抬起 重新计算单元格宽度
     * 鼠标对象
     * @param {?} e
     * @param {?} column
     * @return {?}
     */
    stopDrag(e, column) {
        this.resizeColumn(e, column);
    }
    /**
     * @param {?} e
     * @param {?} column
     * @return {?}
     */
    resizeColumn(e, column) {
        if (this.isCheckBox(column, 'dt-checkbox-cell')) {
            this.dragLine.nativeElement.style.display = 'none';
            return;
        }
        // 偏移量
        /** @type {?} */
        const delta = e.pageX - this.dragLineX;
        // 拖拽前列宽
        /** @type {?} */
        const columnWidth = column.offsetWidth;
        // 拖拽后列宽
        /** @type {?} */
        let newColumnWidth = columnWidth + delta;
        // 最小宽度
        /** @type {?} */
        const minWidth = column.style.minWidth || 30;
        // 新宽度大于或等于最小宽度时
        newColumnWidth = newColumnWidth > minWidth ? newColumnWidth : minWidth;
        // 重新设置宽度
        /** @type {?} */
        let colIndex = -1;
        /** @type {?} */
        const othersCol = [];
        /** @type {?} */
        const cols = this.tableHeader.nativeElement.querySelectorAll('th');
        // 父节点宽度
        /** @type {?} */
        const parentWidth = column.parentElement.offsetWidth;
        // 判断是不是有checkbox
        /** @type {?} */
        const firstElement = column.parentElement.firstElementChild;
        /** @type {?} */
        const checkBoxWidth = this.isCheckBox(firstElement, 'dt-checkbox-cell') ? firstElement.offsetWidth : 0;
        // 其他列宽度
        /** @type {?} */
        let othersWidth = parentWidth - columnWidth - checkBoxWidth;
        /** @type {?} */
        let newOthersWidth = parentWidth - newColumnWidth - checkBoxWidth;
        for (let i = 0; i < cols.length; i++) {
            if (cols[i] === column) {
                colIndex = i;
            }
            else {
                if (this.isCheckBox(cols[i], 'dt-checkbox-cell')) {
                    continue;
                }
                /** @type {?} */
                const rate = cols[i].offsetWidth / othersWidth;
                if (rate > 1) {
                    // console.log(cols[i]);
                }
                /** @type {?} */
                let colWidth = newOthersWidth * rate;
                if (newOthersWidth * rate > 15) {
                    colWidth = newOthersWidth * rate;
                }
                else {
                    colWidth = 15;
                    othersWidth = othersWidth - colWidth;
                    newOthersWidth = newOthersWidth - colWidth;
                    newColumnWidth = newColumnWidth - 15 + newOthersWidth * rate;
                }
                othersCol.push({ colIndex: i, colWidth });
            }
        }
        this.resizeColGroup(this.dtHeader.el.nativeElement, colIndex, newColumnWidth, othersCol);
        this.resizeColGroup(this.dtBody.el.nativeElement, colIndex, newColumnWidth, othersCol);
        // 计算宽度完毕  设置拖拽线隐藏
        this.dragLine.nativeElement.style.display = 'none';
    }
    /**
     * @param {?} elements
     * @param {?} cName
     * @return {?}
     */
    isCheckBox(elements, cName) {
        return !!elements.className.match(new RegExp('(\\s|^)' + cName + '(\\s|$)'));
    }
    /**
     * @param {?} table
     * @param {?} resizeColumnIndex
     * @param {?} newColumnWidth
     * @param {?} othersColumn
     * @return {?}
     */
    resizeColGroup(table, resizeColumnIndex, newColumnWidth, othersColumn) {
        if (table) {
            // 此处要视不同的表格结构来确定 本组件中  header和body结构相同
            /** @type {?} */
            const colGroup = table.childNodes[0].children[0].nodeName === 'COLGROUP' ?
                table.childNodes[0].children[0] : null;
            if (colGroup) {
                /** @type {?} */
                const col = colGroup.children[resizeColumnIndex];
                col.style.width = newColumnWidth + 'px';
                for (let i = 0; i < othersColumn.length; i++) {
                    /** @type {?} */
                    const otherCol = colGroup.children[othersColumn[i].colIndex];
                    if (otherCol && othersColumn[i].colWidth) {
                        otherCol.style.width = othersColumn[i].colWidth + 'px';
                    }
                }
            }
            else {
                throw new Error('Scrollable tables require a colgroup to support resizable columns');
            }
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onScrollX(e) {
        // 横向滚动 非固定表头滚动
        /** @type {?} */
        const x = e.srcElement.scrollLeft;
        this.tableHeader.nativeElement.scrollTo(x, 0);
    }
    /**
     * 滚动条纵向滚动
     * @param {?} e
     * @return {?}
     */
    onScrollY(e) {
        if (!this.hasFixed) {
            return;
        }
        /** @type {?} */
        const y = e.srcElement.scrollTop;
        this.dtLeftFixed.nativeElement.style.top = -y + 'px';
        this.dtRightFixed.nativeElement.style.top = -y + 'px';
    }
    /**
     * @param {?} page
     * @return {?}
     */
    onPageChange(page) {
        if (this.pageIndex !== page.pageIndex) {
            this.pageIndex = page.pageIndex;
            this.paginationOptions.currentPage = page.pageIndex;
            this.pageChanged.emit({ pageInfo: page, search: this.searchData, sortName: this.sortName, sortOrder: this.sortOrder });
        }
    }
    /**
     * @param {?} pageSize
     * @return {?}
     */
    onPageSizeChange(pageSize) {
        if (this.pageSize !== pageSize && this.total) {
            this.paginationOptions.itemsPerPage = pageSize;
            this.pageSize = pageSize;
            /** @type {?} */
            const total = this.total;
            /** @type {?} */
            let pageLength = Math.floor(total / pageSize);
            if (total % pageSize > 0) {
                pageLength += 1;
            }
            if (pageLength && this.pageIndex > pageLength) {
                this.pageIndex = pageLength;
                this.paginationOptions.currentPage = this.pageIndex;
            }
            this.pageSizeChanged.emit({
                pageInfo: { pageIndex: this.pageIndex, pageSize },
                search: this.searchData, sortName: this.sortName, sortOrder: this.sortOrder
            });
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (this.tablePager) {
                    this.scrollWidth = this.tablePager.nativeElement.scrollWidth;
                }
                this.pgScrollLeft = 0;
            }));
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onSearch($event) {
        if ($event.originalEvent) {
            $event.originalEvent.stopPropagation();
        }
        this.search.emit(this.searchData);
    }
    /**
     * @param {?} state
     * @return {?}
     */
    onCheckAll(state) {
        this.dataService.selectedAll.next(state);
        this.checkAll.emit(state);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onSelectedRow(e) {
        this.selectedRow.emit({ data: e.rowData, index: e.rowIndex });
        // 兼容
        this.selectRows.emit({ data: e.rowData, index: e.rowIndex });
    }
    // tslint:disable-next-line:no-shadowed-variable
    /**
     * @param {?} size
     * @return {?}
     */
    resize(size) {
        this.width = size.width;
        this.height = size.height;
        this.setBodyHeight();
    }
    /**
     * @param {?} e
     * @return {?}
     */
    loadData(e) {
        this.data = e.data;
        if (this.pagination) {
            const { total = 0, pageSize = 20, pageIndex = 1 } = Object.assign({}, e);
            this.paginationOptions.totalItems = total;
            this.paginationOptions.itemsPerPage = pageSize;
            this.paginationOptions.currentPage = pageIndex;
            this.paginationOptions.pageList = this.pageList;
            this.paginationOptions = Object.assign({}, this.paginationOptions);
            this.total = total;
            this.pageSize = pageSize;
            this.pageIndex = pageIndex;
        }
        this.cd.detectChanges();
        this.updateCheckboxState(this.data);
    }
    /*
         */
    /**
     * @param {?} e
     * @return {?}
     */
    onCellClick(e) {
        this.cellClick.emit(e);
    }
    /* 添加行 */
    /**
     * @param {?} dataItem
     * @return {?}
     */
    addRows(dataItem) {
        this.data = this.data.concat(dataItem);
    }
    /* 删除行 */
    /**
     * @return {?}
     */
    removeRows() {
        /** @type {?} */
        const SELECTIONS = this.selections;
        if (this.singleSelect) {
            for (let i = 0; i < this.data.length; i++) {
                if (this.data[i] === SELECTIONS) {
                    this.data.splice(i, 1);
                }
            }
        }
        else {
            for (let i = 0; i < SELECTIONS.length; i++) {
                for (let j = 0; j < this.data.length; j++) {
                    if (SELECTIONS[i][this.idField] === this.data[j][this.idField]) {
                        this.data.splice(j, 1);
                    }
                }
            }
        }
    }
    /**
     * @param {?} rid
     * @param {?=} emit
     * @return {?}
     */
    checkRow(rid, emit = false) {
        /** @type {?} */
        let rowIndex = -1;
        /** @type {?} */
        const rowData = this.data.find((/**
         * @param {?} n
         * @param {?} i
         * @return {?}
         */
        (n, i) => {
            if (n[this.idField] == rid) {
                rowIndex = i;
                return true;
            }
        }));
        if (!rowData) {
            return;
        }
        if (!this.selections) {
            this.selections = { [rid]: rowData };
        }
        else {
            this.selections = Object.assign({ [rid]: rowData }, this.selections.reduce((/**
             * @param {?} r
             * @param {?} n
             * @return {?}
             */
            (r, n) => {
                r[n[this.idField]] = n;
                return r;
            }), {}));
        }
        this.dataService.selectedRow.next({
            rowIndex,
            rowData
        });
        if (emit) {
            /** @type {?} */
            const p = { data: rowData, index: rowIndex };
            this.selectedRow.emit(p);
            // 兼容
            this.selectRows.emit(p);
        }
    }
    /**
     * @param {?} rid
     * @param {?=} emit
     * @return {?}
     */
    unCheckRow(rid, emit = false) {
        /** @type {?} */
        let rowIndex = -1;
        /** @type {?} */
        const rowData = this.data.find((/**
         * @param {?} n
         * @param {?} i
         * @return {?}
         */
        (n, i) => {
            if (n[this.idField] == rid) {
                rowIndex = i;
                return true;
            }
        }));
        if (this.selections) {
            this.selections = this.selections.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n[this.idField] != rid)).reduce((/**
             * @param {?} r
             * @param {?} n
             * @return {?}
             */
            (r, n) => {
                r[n[this.idField]] = n;
                return r;
            }), {});
            this.dataService.unSelectedRow.next({
                rowIndex,
                rowData
            });
            if (emit) {
                this.unSelectRow.emit({ data: rowData, index: rowIndex });
            }
        }
    }
    /**
     * @return {?}
     */
    clearSelections() {
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onKeydownEvent($event) {
        if (!$event || !this.singleSelect || !this.data || !this.data.length) {
            return;
        }
        if (!['ArrowDown', 'ArrowUp'].includes($event.code)) {
            return;
        }
        /** @type {?} */
        let newIdx;
        if ($event.code === 'ArrowDown') {
            newIdx = this._currentRowIndex + 1;
            if (newIdx >= this.data.length) {
                newIdx = 0;
            }
        }
        else if ($event.code === 'ArrowUp') {
            if (this._currentRowIndex !== -1) {
                newIdx = this._currentRowIndex - 1;
            }
        }
        if (newIdx >= 0) {
            this.dtBody.selectedRow($event, newIdx, this.data[newIdx]);
        }
        setTimeout((/**
         * @return {?}
         */
        () => {
            // scroll intoView
            /** @type {?} */
            const trDoms = this.dtBody.el.nativeElement.querySelectorAll('.ui-table-tbody tr');
            if (trDoms && trDoms[this._currentRowIndex]) {
                trDoms[this._currentRowIndex].scrollIntoView({ block: 'nearest' });
            }
        }));
    }
}
DataTableComponent.decorators = [
    { type: Component, args: [{
                selector: 'farrisui-datatable,farris-datatable',
                template: "<div class=\"filter-row\" [style.width]=\"width + 'px'\" *ngIf=\"showFilterBar\">\r\n    <form style=\"display: flex; width: 100%;\">\r\n        <div class=\"search-fields\">\r\n            <select class=\"custom-select\" [(ngModel)]=\"searchData.field\" name=\"field\">\r\n                <option value=\"*\">{{allColumnsTitle}}</option>\r\n                <option *ngFor=\"let col of searchFields\" value=\"{{col.value}}\">{{ col.label }}</option>\r\n            </select>\r\n        </div>\r\n        <div class=\"search-text flex-fill\">\r\n            <input-group [groupText]=\"searchButtonText\" name=\"searchValue\" (clear)=\"onClearSearchValue()\" #inputgroup\r\n                [(ngModel)]=\"searchData.value\" (clickHandle)=\"onSearch($event)\" (enterHandle)=\"onSearch($event)\"\r\n                (keydownHandle)=\"onKeydownEvent($event)\"></input-group>\r\n        </div>\r\n    </form>\r\n</div>\r\n<div [ngStyle]=\"{'height': tableHeight +'px', 'width': width +'px' }\" class=\"farris-datatable-container\">\r\n    <div class=\"farris-datatable\">\r\n        <div #tableHeader class=\"farris-table-header\" [style.display]=\"showHeader? '': 'none'\">\r\n            <datatable-header #dtHeader [size]=\"size\" [columns]=\"columns\" [singleSelect]=\"singleSelect\" [data]=\"data\"\r\n                (loadData)=\"loadData\" (checkedAll)=\"onCheckAll($event)\">\r\n                <ng-content select=\"data-columns\"></ng-content>\r\n            </datatable-header>\r\n        </div>\r\n        <div #scorllableBody class=\"farris-table-scorllable-body\" [style.height]=\"scorllableBodyHeight + 'px'\">\r\n            <perfect-scrollbar #perfectScrollbar [config]=\"{}\" (psScrollX)=\"onScrollX($event)\" (psScrollY)=\"onScrollY($event)\">\r\n                <ng-container [style.display]=\"data && data.length ? 'block': 'none'\">\r\n                    <datatable-body #dtBody [rows]=\"pagination ? (data | paginate: paginationOptions) : data\" [size]=\"size\" [columns]=\"columns\" [striped]=\"striped\"\r\n                        [bordered]=\"bordered\" [rowClassName]=\"rowClassName\" [cellClassName]=\"cellClassName\" (cellClick)=\"onCellClick($event)\">\r\n                    </datatable-body>\r\n                </ng-container>\r\n                <!-- <ng-container *ngIf=\"!(data && data.length)\">\r\n                    <h1 style=\"text-align:center;color:#ccc; margin-top: 50px;\"></h1>\r\n                </ng-container> -->\r\n            </perfect-scrollbar>\r\n        </div>\r\n        <div class=\"farris-table-header\" *ngIf=\"footer\">\r\n            <ng-template [ngTemplateOutlet]=\"footer\">\r\n            </ng-template>\r\n        </div>\r\n        <div *ngIf=\"pagination\" #tablePager class=\"farris-table-pager\" >\r\n            <pagination-controls #pager [id]=\"paginationOptions.id\" [maxSize]=\"maxSize\" [directionLinks]=\"directionLinks\"\r\n                [autoHide]=\"autoHide\" [responsive]=\"responsive\" [previousLabel]=\"labels.previousLabel\" [nextLabel]=\"labels.nextLabel\"\r\n                [screenReaderPaginationLabel]=\"labels.screenReaderPaginationLabel\" [screenReaderPageLabel]=\"labels.screenReaderPageLabel\"\r\n                [screenReaderCurrentLabel]=\"labels.screenReaderCurrentLabel\" (pageChange)=\"onPageChange($event)\"\r\n                (pageSizeChange)=\"onPageSizeChange($event)\" [viewMode]=\"pagerViewMode\" [showGoToFirst]=\"true\" [showGoToLast]=\"true\"\r\n                [showPageInfo]=\"showPageInfo\" [showPageNumber]=\"showPageNumber\" [showPageList]=\"showPageList\" style=\"position: relative;\"\r\n                [style.left.px]=\"pgScrollLeft\">\r\n            </pagination-controls>\r\n            <div #pgScrollbar style=\"width: 100%;position: absolute;height: 8px;overflow-x: auto;z-index: 1111;\">\r\n                <div style=\"height: 1px;visibility: hidden;\" [style.width.px]=\"scrollWidth\"></div>\r\n            </div>\r\n        </div>\r\n        <div #dragLine *ngIf=\"resizableColumns\" class=\"column-resizer-helper\"></div>\r\n    </div>\r\n</div>",
                encapsulation: ViewEncapsulation.None,
                providers: [
                    DataTableService
                ],
                styles: [".farris-ui-datatable{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;height:100%;font-size:13px}.farris-ui-datatable table{border-collapse:collapse;width:100%;table-layout:fixed}.farris-ui-datatable .farris-table-footer,.farris-ui-datatable .farris-table-header{position:relative;min-height:34px}.farris-ui-datatable .farris-table-footer thead>tr>th,.farris-ui-datatable .farris-table-header thead>tr>th{padding:.571em .857em;border:1px solid #c8c8c8;font-weight:700;color:#333;background-color:#fff;border-top:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.farris-ui-datatable .farris-table-footer thead>tr>th .tt-checkbox,.farris-ui-datatable .farris-table-header thead>tr>th .tt-checkbox{margin-right:0;vertical-align:top;min-height:1rem}.farris-ui-datatable .farris-table-footer thead>tr>th:first-child,.farris-ui-datatable .farris-table-header thead>tr>th:first-child{border-left:0}.farris-ui-datatable .farris-table-footer thead>tr>th:last-child,.farris-ui-datatable .farris-table-header thead>tr>th:last-child{border-right:0}.farris-ui-datatable .farris-table-footer .checkbox-cell,.farris-ui-datatable .farris-table-header .checkbox-cell{width:40px}.farris-ui-datatable .farris-table-scorllable-body{overflow:hidden}.farris-ui-datatable .farris-table-scorllable-body .ui-table-tbody tr>td{background:inherit;border:1px solid #c8c8c8;padding:6px 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.farris-ui-datatable .farris-table-scorllable-body .ui-table-tbody .tt-checkbox{margin-right:0;vertical-align:top}.farris-ui-datatable .farris-table-scorllable-body .ui-table-tbody .checkbox-cell{width:40px}.farris-ui-datatable .farris-table-scorllable-body .row-hight-light{background-color:#b7d7ff;color:#000}.farris-ui-datatable .farris-table-scorllable-body .ui-table-tbody tr:not(.row-hight-light):hover{cursor:pointer;background-color:#e7f2ff}.farris-ui-datatable .farris-table-scorllable-body .ui-table-tbody>tr:first-child>td{border-top:0}.farris-ui-datatable .farris-table-scorllable-body table>.ui-table-tbody>tr>td:last-child{border-right:0}.farris-ui-datatable .farris-table-scorllable-body table>.ui-table-tbody>tr>td:first-child{border-left:0}.farris-ui-datatable .farris-table-pager{background-color:#f3f3f3;height:50px;min-height:50px;width:100%;border-top:1px solid #c8c8c8}.filter-row{display:-webkit-box;display:flex;margin:10px 0}.filter-row .search-fields{min-width:140px}.filter-row .search-text{-webkit-box-flex:1;flex:1;margin-left:10px}.filter-row .search-text .btn-outline-secondary{border-color:#ced4da}.filter-row .search-text .btn-outline-secondary:active,.filter-row .search-text .btn-outline-secondary:focus{box-shadow:none}.filter-row .form-control:focus{border-color:#ced4da;box-shadow:none}.filter-row .custom-select:focus{box-shadow:none}.farris-datatable{position:relative}.resizable-column{background-clip:padding-box;position:relative}.column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5em;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.column-resizer-helper{width:1px;position:absolute;z-index:10;display:none;background-color:#6c757d;opacity:.6}.farris-table-fixed-body,.farris-table-fixed-header{position:absolute;top:0;left:0;overflow:hidden;box-shadow:2px 0 6px -2px rgba(0,0,0,.2)}.farris-table-fixed-right-body,.farris-table-fixed-right-header{position:absolute;top:0;right:0;overflow:hidden;box-shadow:-2px 0 6px -2px rgba(0,0,0,.2)}.td-hidden{visibility:hidden}@media (min-width:576px){.td-sm-hidden{visibility:hidden!important}.td-sm-visible{visibility:visible!important}}@media (min-width:768px){.td-md-hidden{visibility:hidden!important}.td-md-visible{visibility:visible!important}}@media (min-width:992px){.td-lg-hidden{visibility:hidden!important}.td-lg-visible{visibility:visible!important}}@media (min-width:1200px){.td-xl-hidden{visibility:hidden!important}.td-xl-visible{visibility:visible!important}}"]
            }] }
];
/** @nocollapse */
DataTableComponent.ctorParameters = () => [
    { type: DataTableService },
    { type: IdService },
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: NgZone }
];
DataTableComponent.propDecorators = {
    keydownEnterEdit: [{ type: Input }],
    id: [{ type: Input }],
    size: [{ type: Input }],
    allColumnsTitle: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    fill: [{ type: Input }],
    pagination: [{ type: Input }],
    pagerOnServer: [{ type: Input }],
    pageSize: [{ type: Input }],
    pageIndex: [{ type: Input }],
    showPageInfo: [{ type: Input }],
    showPageNumber: [{ type: Input }],
    showPageList: [{ type: Input }],
    pagerViewMode: [{ type: Input }],
    showHeader: [{ type: Input }],
    pageList: [{ type: Input }],
    total: [{ type: Input }],
    columns: [{ type: Input }],
    searchFields: [{ type: Input }],
    showFilterBar: [{ type: Input }],
    data: [{ type: Input }],
    remote: [{ type: Input }],
    remoteSort: [{ type: Input }],
    sortName: [{ type: Input }],
    sortOrder: [{ type: Input }],
    multiSort: [{ type: Input }],
    beforeSortColumn: [{ type: Input }],
    singleSelect: [{ type: Input }],
    idField: [{ type: Input }],
    hover: [{ type: Input }],
    striped: [{ type: Input }],
    bordered: [{ type: Input }],
    rowClassName: [{ type: Input }],
    cellClassName: [{ type: Input }],
    rowStyler: [{ type: Input }],
    cellStyler: [{ type: Input }],
    selections: [{ type: Input }],
    scorllableBody: [{ type: ViewChild, args: ['scorllableBody',] }],
    tableHeader: [{ type: ViewChild, args: ['tableHeader',] }],
    tablePager: [{ type: ViewChild, args: ['tablePager',] }],
    dtHeader: [{ type: ViewChild, args: ['dtHeader',] }],
    dtBody: [{ type: ViewChild, args: ['dtBody',] }],
    dtLeftBody: [{ type: ViewChild, args: ['dtLeftBody',] }],
    dtRightBody: [{ type: ViewChild, args: ['dtRightBody',] }],
    dtLeftFixed: [{ type: ViewChild, args: ['dtLeftFixed',] }],
    dtRightFixed: [{ type: ViewChild, args: ['dtRightFixed',] }],
    pager: [{ type: ViewChild, args: ['pager',] }],
    inputGroup: [{ type: ViewChild, args: ['inputgroup',] }],
    pgScrollbar: [{ type: ViewChild, args: ['pgScrollbar',] }],
    pageChanged: [{ type: Output }],
    pageSizeChanged: [{ type: Output }],
    search: [{ type: Output }],
    columnSorted: [{ type: Output }],
    rowDblClick: [{ type: Output }],
    selectedRow: [{ type: Output }],
    selectRows: [{ type: Output }],
    unSelectRow: [{ type: Output }],
    cellClick: [{ type: Output }],
    clearSearchValue: [{ type: Output }],
    checkAll: [{ type: Output }],
    sortChange: [{ type: Output }],
    columnsRef: [{ type: ContentChildren, args: [ColumnDirective,] }],
    footer: [{ type: ContentChild, args: ['footer',] }],
    dragLine: [{ type: ViewChild, args: ['dragLine',] }],
    resizableColumns: [{ type: Input }],
    keepSelect: [{ type: Input }],
    perfectScrollbar: [{ type: ViewChild, args: ['perfectScrollbar',] }]
};
if (false) {
    /** @type {?} */
    DataTableComponent.prototype.searchButtonText;
    /** @type {?} */
    DataTableComponent.prototype.keydownEnterEdit;
    /** @type {?} */
    DataTableComponent.prototype.id;
    /** @type {?} */
    DataTableComponent.prototype.size;
    /** @type {?} */
    DataTableComponent.prototype.allColumnsTitle;
    /** @type {?} */
    DataTableComponent.prototype.width;
    /** @type {?} */
    DataTableComponent.prototype.height;
    /** @type {?} */
    DataTableComponent.prototype.tableHeight;
    /** @type {?} */
    DataTableComponent.prototype.fill;
    /** @type {?} */
    DataTableComponent.prototype.pagination;
    /** @type {?} */
    DataTableComponent.prototype.pagerOnServer;
    /** @type {?} */
    DataTableComponent.prototype.pageSize;
    /** @type {?} */
    DataTableComponent.prototype.pageIndex;
    /** @type {?} */
    DataTableComponent.prototype.showPageInfo;
    /** @type {?} */
    DataTableComponent.prototype.showPageNumber;
    /** @type {?} */
    DataTableComponent.prototype.showPageList;
    /** @type {?} */
    DataTableComponent.prototype.pagerViewMode;
    /**
     * 显示表头
     * @type {?}
     */
    DataTableComponent.prototype.showHeader;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype._pageList;
    /** @type {?} */
    DataTableComponent.prototype.total;
    /** @type {?} */
    DataTableComponent.prototype.columns;
    /** @type {?} */
    DataTableComponent.prototype.searchFields;
    /** @type {?} */
    DataTableComponent.prototype.showFilterBar;
    /** @type {?} */
    DataTableComponent.prototype._data;
    /** @type {?} */
    DataTableComponent.prototype.copyData;
    /** @type {?} */
    DataTableComponent.prototype.remote;
    /**
     * 启用远端排序
     * @type {?}
     */
    DataTableComponent.prototype.remoteSort;
    /**
     * 排序字段
     * @type {?}
     */
    DataTableComponent.prototype.sortName;
    /**
     * 排序方式 asc | desc
     * @type {?}
     */
    DataTableComponent.prototype.sortOrder;
    /**
     * 允许多列排序
     * @type {?}
     */
    DataTableComponent.prototype.multiSort;
    /** @type {?} */
    DataTableComponent.prototype.beforeSortColumn;
    /** @type {?} */
    DataTableComponent.prototype.singleSelect;
    /** @type {?} */
    DataTableComponent.prototype.idField;
    /** @type {?} */
    DataTableComponent.prototype.hover;
    /** @type {?} */
    DataTableComponent.prototype.striped;
    /** @type {?} */
    DataTableComponent.prototype.bordered;
    /** @type {?} */
    DataTableComponent.prototype.rowClassName;
    /** @type {?} */
    DataTableComponent.prototype.cellClassName;
    /** @type {?} */
    DataTableComponent.prototype.rowStyler;
    /** @type {?} */
    DataTableComponent.prototype.cellStyler;
    /** @type {?} */
    DataTableComponent.prototype.scorllableBody;
    /** @type {?} */
    DataTableComponent.prototype.tableHeader;
    /** @type {?} */
    DataTableComponent.prototype.tablePager;
    /** @type {?} */
    DataTableComponent.prototype.dtHeader;
    /** @type {?} */
    DataTableComponent.prototype.dtBody;
    /** @type {?} */
    DataTableComponent.prototype.dtLeftBody;
    /** @type {?} */
    DataTableComponent.prototype.dtRightBody;
    /** @type {?} */
    DataTableComponent.prototype.dtLeftFixed;
    /** @type {?} */
    DataTableComponent.prototype.dtRightFixed;
    /** @type {?} */
    DataTableComponent.prototype.pager;
    /** @type {?} */
    DataTableComponent.prototype.inputGroup;
    /** @type {?} */
    DataTableComponent.prototype.pgScrollbar;
    /** @type {?} */
    DataTableComponent.prototype.pageChanged;
    /** @type {?} */
    DataTableComponent.prototype.pageSizeChanged;
    /** @type {?} */
    DataTableComponent.prototype.search;
    /** @type {?} */
    DataTableComponent.prototype.columnSorted;
    /** @type {?} */
    DataTableComponent.prototype.rowDblClick;
    /** @type {?} */
    DataTableComponent.prototype.selectedRow;
    /** @type {?} */
    DataTableComponent.prototype.selectRows;
    /** @type {?} */
    DataTableComponent.prototype.unSelectRow;
    /** @type {?} */
    DataTableComponent.prototype.cellClick;
    /** @type {?} */
    DataTableComponent.prototype.clearSearchValue;
    /** @type {?} */
    DataTableComponent.prototype.checkAll;
    /** @type {?} */
    DataTableComponent.prototype.sortChange;
    /** @type {?} */
    DataTableComponent.prototype.columnsRef;
    /** @type {?} */
    DataTableComponent.prototype.footer;
    /** @type {?} */
    DataTableComponent.prototype.dragLine;
    /** @type {?} */
    DataTableComponent.prototype.resizableColumns;
    /**
     * 针对同一条记录，单选时，多次单击后不取消选中。
     * @type {?}
     */
    DataTableComponent.prototype.keepSelect;
    /** @type {?} */
    DataTableComponent.prototype.hasRowTepml;
    /** @type {?} */
    DataTableComponent.prototype.datatableContainer;
    /** @type {?} */
    DataTableComponent.prototype.dragLineX;
    /** @type {?} */
    DataTableComponent.prototype.moveable;
    /** @type {?} */
    DataTableComponent.prototype.currentColumn;
    /** @type {?} */
    DataTableComponent.prototype.hasFixed;
    /** @type {?} */
    DataTableComponent.prototype.fixedLeftWidth;
    /** @type {?} */
    DataTableComponent.prototype.fixedRightWidth;
    /** @type {?} */
    DataTableComponent.prototype.searchData;
    /** @type {?} */
    DataTableComponent.prototype.subscription;
    /** @type {?} */
    DataTableComponent.prototype.headerTr;
    /** @type {?} */
    DataTableComponent.prototype.leftFixedHeaderTr;
    /** @type {?} */
    DataTableComponent.prototype.rightFixedHeaderTr;
    /** @type {?} */
    DataTableComponent.prototype.filter;
    /** @type {?} */
    DataTableComponent.prototype.maxSize;
    /** @type {?} */
    DataTableComponent.prototype.directionLinks;
    /** @type {?} */
    DataTableComponent.prototype.autoHide;
    /** @type {?} */
    DataTableComponent.prototype.responsive;
    /** @type {?} */
    DataTableComponent.prototype.paginationOptions;
    /** @type {?} */
    DataTableComponent.prototype.labels;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype._currentRowIndex;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype._currentRow;
    /** @type {?} */
    DataTableComponent.prototype.perfectScrollbar;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.isCheckAll;
    /** @type {?} */
    DataTableComponent.prototype.scorllableBodyHeight;
    /** @type {?} */
    DataTableComponent.prototype.scrollWidth;
    /** @type {?} */
    DataTableComponent.prototype.mouseEnterOnPager;
    /** @type {?} */
    DataTableComponent.prototype.mouseLeaveOnPager;
    /** @type {?} */
    DataTableComponent.prototype.mouseWheelOnPager;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.ps;
    /** @type {?} */
    DataTableComponent.prototype.pgScrollLeft;
    /** @type {?} */
    DataTableComponent.prototype.trackByRows;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.dataService;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.idService;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.el;
    /** @type {?} */
    DataTableComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DataTableComponent.prototype.ngZone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YXRhYmxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YXRhYmxlLyIsInNvdXJjZXMiOlsibGliL2RhdGF0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7Ozs7Ozs7O0FBVWxELE9BQU8sRUFDSCxTQUFTLEVBQVUsU0FBUyxFQUFFLFVBQVUsRUFBYSxLQUFLLEVBQWlCLFlBQVksRUFBRSxXQUFXLEVBQ3BHLFNBQVMsRUFBbUMsZUFBZSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsaUJBQWlCLEVBQXFCLE1BQU0sRUFDbEksTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUE0QixFQUFFLEVBQUUsU0FBUyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRS9ELE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ3pFLE9BQU8sRUFBc0IsMkJBQTJCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUN4RixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFHOUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM5RSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFjdkMsTUFBTSxPQUFPLGtCQUFrQjs7Ozs7Ozs7SUEwTjNCLFlBQW9CLFdBQTZCLEVBQVUsU0FBb0IsRUFBVSxFQUFjLEVBQzVGLEVBQXFCLEVBQVUs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Q0FBd0U7O0lBQ3hFLDBDQUFpRDs7SUFDakQseUNBQWdEOztJQUNoRCx5Q0FBZ0Q7O0lBRWhELHdDQUErQzs7SUFDL0MseUNBQWdEOztJQUNoRCx1Q0FBOEM7O0lBQzlDLDhDQUFnRDs7SUFDaEQsc0NBQTZDOztJQUc3Qyx3Q0FBMEM7O0lBRTFDLHdDQUF5RTs7SUFFekUsb0NBQWlEOztJQUdqRCxzQ0FBNEM7O0lBRTVDLDhDQUFpQzs7Ozs7SUFHakMsd0NBQTJCOztJQUczQix5Q0FBb0I7O0lBRXBCLGdEQUFtQzs7SUFFbkMsdUNBQWtCOztJQUVsQixzQ0FBaUI7O0lBRWpCLDJDQUFtQjs7SUFFbkIsc0NBQWtCOztJQUNsQiw0Q0FBdUI7O0lBRXZCLDZDQUF3Qjs7SUFDeEIsd0NBQXVDOztJQUV2QywwQ0FBa0M7O0lBRWxDLHNDQUFjOztJQUNkLCtDQUF1Qjs7SUFDdkIsZ0RBQXdCOztJQUd4QixvQ0FBbUI7O0lBQ25CLHFDQUFtQjs7SUFDbkIsNENBQTZCOztJQUM3QixzQ0FBd0I7O0lBQ3hCLHdDQUF5Qjs7SUFDekIsK0NBT0U7O0lBQ0Ysb0NBTUU7Ozs7O0lBRUYsOENBQThCOzs7OztJQUs5Qix5Q0FBZ0M7O0lBS2hDLDhDQUEyRTs7Ozs7SUFFM0Usd0NBaUJDOztJQUVELGtEQUE2Qjs7SUFDN0IseUNBQWdCOztJQUVoQiwrQ0FBeUI7O0lBQ3pCLCtDQUF5Qjs7SUFDekIsK0NBQXlCOzs7OztJQTBCekIsZ0NBQTZCOztJQUM3QiwwQ0FBaUI7O0lBbURqQix5Q0FFQzs7Ozs7SUE5RVcseUNBQXFDOzs7OztJQUFFLHVDQUE0Qjs7Ozs7SUFBRSxnQ0FBc0I7O0lBQ25HLGdDQUE0Qjs7Ozs7SUFBRSxvQ0FBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnB1dEdyb3VwQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1pbnB1dC1ncm91cCc7XHJcbmltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDctMTAgMTE6NDQ6NDlcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMDUgMTE6NDQ6MThcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcblxyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgT25DaGFuZ2VzLCBJbnB1dCwgU2ltcGxlQ2hhbmdlcywgQ29udGVudENoaWxkLCBUZW1wbGF0ZVJlZixcclxuICAgIFF1ZXJ5TGlzdCwgQWZ0ZXJDb250ZW50SW5pdCwgQWZ0ZXJWaWV3SW5pdCwgQ29udGVudENoaWxkcmVuLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0VuY2Fwc3VsYXRpb24sIE9uRGVzdHJveSwgSW5qZWN0LCBOZ1pvbmVcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgT2JzZXJ2YWJsZSwgb2YsIGZyb21FdmVudCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgUGVyZmVjdFNjcm9sbGJhciBmcm9tICdwZXJmZWN0LXNjcm9sbGJhcic7XHJcbmltcG9ydCB7IFBlcmZlY3RTY3JvbGxiYXJDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXBlcmZlY3Qtc2Nyb2xsYmFyJztcclxuaW1wb3J0IHsgUGFnaW5hdGlvbkluc3RhbmNlLCBQYWdpbmF0aW9uQ29udHJvbHNDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXBhZ2luYXRpb24nO1xyXG5pbXBvcnQgeyBJZFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4gfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi9jb2x1bW4nO1xyXG5cclxuaW1wb3J0IHsgZGVlcENvcHkgfSBmcm9tICcuL2RhdGF0YWJsZS1jb2x1bW4nO1xyXG5pbXBvcnQgeyBDb2x1bW5EaXJlY3RpdmUgfSBmcm9tICcuL2RhdGF0YWJsZS1jb2x1bW4uY29tcG9uZW50JztcclxuaW1wb3J0IHsgRGF0YVRhYmxlU2VydmljZSB9IGZyb20gJy4vZGF0YXRhYmxlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhVGFibGVIZWFkZXJDb21wb25lbnQgfSBmcm9tICcuL3RhYmxlL2RhdGF0YWJsZS1oZWFkZXIuY29tcG9uZW50JztcclxuaW1wb3J0IHsgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcblxyXG5cclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzdWktZGF0YXRhYmxlLGZhcnJpcy1kYXRhdGFibGUnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2RhdGF0YWJsZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9kYXRhdGFibGUuc2NzcyddLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgIERhdGFUYWJsZVNlcnZpY2VcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFUYWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIEFmdGVyQ29udGVudEluaXQsIEFmdGVyVmlld0luaXQge1xyXG4gICAgc2VhcmNoQnV0dG9uVGV4dCA9ICc8aSBjbGFzcz1cImYtaWNvbiBmLWljb24tc2VhcmNoXCI+PC9pPic7XHJcbiAgICBASW5wdXQoKSBrZXlkb3duRW50ZXJFZGl0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBpZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgc2l6ZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgYWxsQ29sdW1uc1RpdGxlID0gJ+aJgOacieWIlyc7XHJcbiAgICAvLyB0YWJsZSDlsLrlr7hcclxuICAgIEBJbnB1dCgpIHdpZHRoO1xyXG4gICAgLy8g57uE5Lu257qn6auY5bqm5YyF5ous6L+H5ruk5p2h6auY5bqmXHJcbiAgICBASW5wdXQoKSBoZWlnaHQ7XHJcblxyXG4gICAgdGFibGVIZWlnaHQ6IG51bWJlcjsgLy8g5pWw5o2u6KGo6auY5bqmXHJcbiAgICAvLyDmmK/lkKbloavlhYVcclxuICAgIEBJbnB1dCgpIGZpbGwgPSBmYWxzZTtcclxuICAgIC8vIOm7mOiupOWIhumhtVxyXG4gICAgQElucHV0KCkgcGFnaW5hdGlvbiA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBwYWdlck9uU2VydmVyID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHBhZ2VTaXplID0gMTA7XHJcbiAgICBASW5wdXQoKSBwYWdlSW5kZXggPSAxO1xyXG4gICAgQElucHV0KCkgc2hvd1BhZ2VJbmZvID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHNob3dQYWdlTnVtYmVyID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHNob3dQYWdlTGlzdCA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBwYWdlclZpZXdNb2RlID0gJ2RlZmF1bHQnO1xyXG4gICAgLyoqIOaYvuekuuihqOWktCAqL1xyXG4gICAgQElucHV0KCkgc2hvd0hlYWRlciA9IHRydWU7XHJcblxyXG4gICAgcHJpdmF0ZSBfcGFnZUxpc3QgPSBbMTAsIDIwLCAzMCwgNTAsIDEwMF07XHJcblxyXG4gICAgZ2V0IHBhZ2VMaXN0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYWdlTGlzdDtcclxuICAgIH1cclxuICAgIEBJbnB1dCgpIHNldCBwYWdlTGlzdCh2YWwpIHtcclxuICAgICAgICB0aGlzLl9wYWdlTGlzdCA9IHZhbDtcclxuICAgICAgICBpZiAodGhpcy5wYWdlcikge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VyLnNldFBhZ2VMaXN0KHZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIHRvdGFsID0gMDtcclxuICAgIC8vIOWIlyDmlbDmja5cclxuICAgIEBJbnB1dCgpIGNvbHVtbnM6IERhdGFDb2x1bW5bXTtcclxuICAgIEBJbnB1dCgpIHNlYXJjaEZpZWxkczogeyBsYWJlbDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIH1bXTtcclxuICAgIC8vIOWPr+etm+mAiVxyXG4gICAgQElucHV0KCkgc2hvd0ZpbHRlckJhciA9IGZhbHNlO1xyXG4gICAgLy8gdGFibGUgIOaVsOaNrlxyXG4gICAgX2RhdGEgPSBbXTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgZGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcclxuICAgIH1cclxuICAgIHNldCBkYXRhKGRhdGE6IEFycmF5PGFueT4pIHtcclxuICAgICAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIH1cclxuICAgIC8vIOa3seaLt+i0nWRhdGEg5pWw5o2uXHJcbiAgICBjb3B5RGF0YTogYW55O1xyXG5cclxuICAgIEBJbnB1dCgpIHJlbW90ZSA9ICdjbGllbnQnO1xyXG5cclxuICAgIC8qKiDlkK/nlKjov5znq6/mjpLluo8gKi9cclxuICAgIEBJbnB1dCgpIHJlbW90ZVNvcnQgPSB0cnVlO1xyXG4gICAgLyoqIOaOkuW6j+Wtl+autSAqL1xyXG4gICAgQElucHV0KCkgc29ydE5hbWU6IHN0cmluZztcclxuICAgIC8qKiDmjpLluo/mlrnlvI8gYXNjIHwgZGVzYyAqL1xyXG4gICAgQElucHV0KCkgc29ydE9yZGVyOiBzdHJpbmc7XHJcbiAgICAvKiog5YWB6K645aSa5YiX5o6S5bqPICovXHJcbiAgICBASW5wdXQoKSBtdWx0aVNvcnQgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGJlZm9yZVNvcnRDb2x1bW46IChmaWVsZDogc3RyaW5nLCBvcmRlcjogc3RyaW5nKSA9PiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG5cclxuICAgIC8vIOWkmumAiSAg5Y2V6YCJXHJcbiAgICBASW5wdXQoKSBzaW5nbGVTZWxlY3QgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgaWRGaWVsZCA9ICdpZCc7XHJcbiAgICAvLyDmmL7npLrpvKDmoIfmgqzlgZzpq5jkuq5cclxuICAgIEBJbnB1dCgpIGhvdmVyID0gdHJ1ZTtcclxuICAgIC8vIOaWkemprOe6v1xyXG4gICAgQElucHV0KCkgc3RyaXBlZDogYm9vbGVhbjtcclxuICAgIC8vIOi+ueahhlxyXG4gICAgQElucHV0KCkgYm9yZGVyZWQ6IGJvb2xlYW47XHJcbiAgICAvLyDmlK/mjIHmt7vliqDooYwg5Y2V5YWD5qC8IOexu+agt+W8j1xyXG4gICAgQElucHV0KCkgcm93Q2xhc3NOYW1lOiAocm93OiBhbnksIGluZGV4OiBudW1iZXIpID0+IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGNlbGxDbGFzc05hbWU6ICh2YWx1ZTogYW55LCBjb2w6IGFueSkgPT4gc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpIHJvd1N0eWxlcjogKGFyZ3M6IGFueSkgPT4gYW55O1xyXG4gICAgQElucHV0KCkgY2VsbFN0eWxlcjogKHZhbDogYW55KSA9PiBhbnk7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBzZWxlY3Rpb25zKHYpIHtcclxuICAgICAgICB0aGlzLmR0Qm9keS5zZWxlY3Rpb25zID0gdiA/IHYgOiB7fTtcclxuICAgIH1cclxuICAgIGdldCBzZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmR0Qm9keS5zZWxlY3Rpb25zO1xyXG4gICAgfVxyXG4gICAgLy8g5rua5Yqo5p2h5byV55SoXHJcbiAgICBAVmlld0NoaWxkKCdzY29ybGxhYmxlQm9keScpIHNjb3JsbGFibGVCb2R5OiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgndGFibGVIZWFkZXInKSB0YWJsZUhlYWRlcjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3RhYmxlUGFnZXInKSB0YWJsZVBhZ2VyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZHRIZWFkZXInKSBkdEhlYWRlcjogRGF0YVRhYmxlSGVhZGVyQ29tcG9uZW50O1xyXG4gICAgQFZpZXdDaGlsZCgnZHRCb2R5JykgZHRCb2R5OiBhbnk7XHJcbiAgICBAVmlld0NoaWxkKCdkdExlZnRCb2R5JykgZHRMZWZ0Qm9keTogYW55O1xyXG4gICAgQFZpZXdDaGlsZCgnZHRSaWdodEJvZHknKSBkdFJpZ2h0Qm9keTogYW55O1xyXG4gICAgQFZpZXdDaGlsZCgnZHRMZWZ0Rml4ZWQnKSBkdExlZnRGaXhlZDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2R0UmlnaHRGaXhlZCcpIGR0UmlnaHRGaXhlZDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3BhZ2VyJykgcGFnZXI6IFBhZ2luYXRpb25Db250cm9sc0NvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0Z3JvdXAnKSBpbnB1dEdyb3VwOiBJbnB1dEdyb3VwQ29tcG9uZW50O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3BnU2Nyb2xsYmFyJykgcGdTY3JvbGxiYXI6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgLy8g5YiG6aG15LqL5Lu2XHJcbiAgICBAT3V0cHV0KCkgcGFnZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgcGFnZVNpemVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNlYXJjaCA9IG5ldyBFdmVudEVtaXR0ZXI8eyBmaWVsZDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIH0+KCk7XHJcbiAgICBAT3V0cHV0KCkgY29sdW1uU29ydGVkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgcm93RGJsQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZFJvdyA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLy8g5YW85a65XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0Um93cyA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIHVuU2VsZWN0Um93ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2VsbENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2xlYXJTZWFyY2hWYWx1ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBjaGVja0FsbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuXHJcbiAgICBAT3V0cHV0KCkgc29ydENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAQ29udGVudENoaWxkcmVuKENvbHVtbkRpcmVjdGl2ZSkgY29sdW1uc1JlZjogUXVlcnlMaXN0PENvbHVtbkRpcmVjdGl2ZT47XHJcbiAgICAvLyDooajlsL5cclxuICAgIEBDb250ZW50Q2hpbGQoJ2Zvb3RlcicpIGZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIC8vIOihqOagvOWPr+aLluaLveWuveW6puezu+WIl1xyXG4gICAgLy8g5ouW5ou957q/XHJcbiAgICBAVmlld0NoaWxkKCdkcmFnTGluZScpIGRyYWdMaW5lOiBFbGVtZW50UmVmO1xyXG4gICAgLy8g5piv5ZCm5Y+v5ouW5ou9ICDpu5jorqTlj6/ku6VcclxuICAgIEBJbnB1dCgpIHJlc2l6YWJsZUNvbHVtbnMgPSB0cnVlO1xyXG5cclxuICAgIC8qKiDpkojlr7nlkIzkuIDmnaHorrDlvZXvvIzljZXpgInml7bvvIzlpJrmrKHljZXlh7vlkI7kuI3lj5bmtojpgInkuK3jgIIgKi9cclxuICAgIEBJbnB1dCgpIGtlZXBTZWxlY3QgPSB0cnVlO1xyXG5cclxuICAgIC8vIOaYr+WQpuacieihjOaooeadv1xyXG4gICAgaGFzUm93VGVwbWwgPSBmYWxzZTtcclxuICAgIC8vIOeUqOaIt+iOt+WPluihqOWktCvooajmoLzlhoXlrrnnmoTpq5jluqYgIOWuveW6piAg562JXHJcbiAgICBkYXRhdGFibGVDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgLy8g5ouW5ou957q/5Yid5aeL5YyW5L2N572uXHJcbiAgICBkcmFnTGluZVg6IG51bWJlcjtcclxuICAgIC8vIOiuvue9ruaLluaLveWBnOatouWZqFxyXG4gICAgbW92ZWFibGUgPSBmYWxzZTtcclxuICAgIC8vXHJcbiAgICBjdXJyZW50Q29sdW1uOiBhbnk7XHJcbiAgICAvLyDorr7nva7lt6blm7rlrprliJdcclxuICAgIGhhc0ZpeGVkOiBib29sZWFuO1xyXG4gICAgZml4ZWRMZWZ0V2lkdGg6IHN0cmluZztcclxuICAgIC8vIOiuvue9ruWPs+WbuuWumuWIl1xyXG4gICAgZml4ZWRSaWdodFdpZHRoOiBzdHJpbmc7XHJcbiAgICBzZWFyY2hEYXRhID0geyBmaWVsZDogJyonLCB2YWx1ZTogJycgfTtcclxuICAgIC8vIOS6i+S7tuiuoumYheWtmOWCqCAg5L6/5LqO6ZSA5q+BXHJcbiAgICBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbltdID0gW107XHJcbiAgICAvLyDlm7rlrprliJfml7YgIOWQjOS4gOihjOeahHRyIGhvdmVy5LqL5Lu2XHJcbiAgICBoZWFkZXJUcjogYW55O1xyXG4gICAgbGVmdEZpeGVkSGVhZGVyVHI6IGFueTtcclxuICAgIHJpZ2h0Rml4ZWRIZWFkZXJUcjogYW55O1xyXG5cclxuICAgIC8vIOWOn+aVsOaNrlxyXG4gICAgcHVibGljIGZpbHRlciA9ICcnO1xyXG4gICAgcHVibGljIG1heFNpemUgPSA3O1xyXG4gICAgcHVibGljIGRpcmVjdGlvbkxpbmtzID0gdHJ1ZTtcclxuICAgIHB1YmxpYyBhdXRvSGlkZSA9IGZhbHNlO1xyXG4gICAgcHVibGljIHJlc3BvbnNpdmUgPSB0cnVlO1xyXG4gICAgcHVibGljIHBhZ2luYXRpb25PcHRpb25zOiBQYWdpbmF0aW9uSW5zdGFuY2UgPSB7XHJcbiAgICAgICAgaWQ6ICdGYXJyaXMtRGF0YVRhYmxlLVBhZ2luYXRpb24nLFxyXG4gICAgICAgIGl0ZW1zUGVyUGFnZTogdGhpcy5wYWdlU2l6ZSxcclxuICAgICAgICBjdXJyZW50UGFnZTogdGhpcy5wYWdlSW5kZXgsXHJcbiAgICAgICAgcGFnZUxpc3Q6IHRoaXMucGFnZUxpc3QsXHJcbiAgICAgICAgdG90YWxJdGVtczogdGhpcy50b3RhbCxcclxuICAgICAgICByZW1vdGU6IHRoaXMucGFnZXJPblNlcnZlclxyXG4gICAgfTtcclxuICAgIHB1YmxpYyBsYWJlbHM6IGFueSA9IHtcclxuICAgICAgICBwcmV2aW91c0xhYmVsOiAnICcsXHJcbiAgICAgICAgbmV4dExhYmVsOiAnICcsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnaW5hdGlvbkxhYmVsOiAnUGFnaW5hdGlvbicsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyUGFnZUxhYmVsOiAncGFnZScsXHJcbiAgICAgICAgc2NyZWVuUmVhZGVyQ3VycmVudExhYmVsOiBgWW91J3JlIG9uIHBhZ2VgXHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgX2N1cnJlbnRSb3dJbmRleCA9IC0xO1xyXG4gICAgZ2V0IGN1cnJlbnRSb3dJbmRleCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50Um93SW5kZXg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfY3VycmVudFJvdyA9IHVuZGVmaW5lZDtcclxuICAgIGdldCBjdXJyZW50Um93KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50Um93O1xyXG4gICAgfVxyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3BlcmZlY3RTY3JvbGxiYXInKSBwZXJmZWN0U2Nyb2xsYmFyOiBQZXJmZWN0U2Nyb2xsYmFyQ29tcG9uZW50O1xyXG5cclxuICAgIHByaXZhdGUgaXNDaGVja0FsbCA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuc2VsZWN0aW9ucyB8fCAhdGhpcy5zZWxlY3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGF0YSB8fCAhdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdG90YWwgPSAwO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhLmZpbmQoZCA9PiBkW3RoaXMuaWRGaWVsZF0gPT09IG5bdGhpcy5pZEZpZWxkXSkpIHtcclxuICAgICAgICAgICAgICAgIHRvdGFsICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5sZW5ndGggPT09IHRvdGFsO1xyXG4gICAgfVxyXG5cclxuICAgIHNjb3JsbGFibGVCb2R5SGVpZ2h0OiBudW1iZXI7XHJcbiAgICBzY3JvbGxXaWR0aCA9IDA7XHJcblxyXG4gICAgbW91c2VFbnRlck9uUGFnZXIgPSBudWxsO1xyXG4gICAgbW91c2VMZWF2ZU9uUGFnZXIgPSBudWxsO1xyXG4gICAgbW91c2VXaGVlbE9uUGFnZXIgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVNlcnZpY2U6IERhdGFUYWJsZVNlcnZpY2UsIHByaXZhdGUgaWRTZXJ2aWNlOiBJZFNlcnZpY2UsIHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHVibGljIGNkOiBDaGFuZ2VEZXRlY3RvclJlZiwgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSkge1xyXG5cclxuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLnNlbGVjdGVkUm93LnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbmdsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJvd0luZGV4ID0gZS5yb3dJbmRleDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSb3cgPSBlLnJvd0RhdGE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kdEhlYWRlci5pc0NoZWNrQWxsID0gdGhpcy5pc0NoZWNrQWxsKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS51blNlbGVjdGVkUm93LnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbmdsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJvdyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSb3dJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kdEhlYWRlci5pc0NoZWNrQWxsID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHBzOiBQZXJmZWN0U2Nyb2xsYmFyO1xyXG4gICAgcGdTY3JvbGxMZWZ0ID0gMDtcclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldEJvZHlIZWlnaHQoKTtcclxuICAgICAgICAgICAgdGhpcy5wcyA9IHRoaXMucGVyZmVjdFNjcm9sbGJhci5kaXJlY3RpdmVSZWYucHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWQgPSBgZGF0YXRhYmxlXyR7dGhpcy5pZFNlcnZpY2UuZ2VuZXJhdGUoKX1gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5pZCA9IHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuaWQgKyB0aGlzLmlkO1xyXG5cclxuICAgICAgICB0aGlzLmNvcHlEYXRhID0gZGVlcENvcHkodGhpcy5kYXRhKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmJlZm9yZVNvcnRDb2x1bW4pIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVTb3J0Q29sdW1uID0gKCkgPT4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0Qm9keUhlaWdodCgpIHtcclxuICAgICAgICB0aGlzLnRhYmxlSGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICB0aGlzLnRhYmxlSGVpZ2h0ID0gdGhpcy5oZWlnaHQgLSA0NjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnNob3dIZWFkZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5zY29ybGxhYmxlQm9keUhlaWdodCA9IHRoaXMudGFibGVIZWlnaHQgLSB0aGlzLnRhYmxlSGVhZGVyLm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGFnaW5hdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLnNjb3JsbGFibGVCb2R5SGVpZ2h0ID0gdGhpcy5zY29ybGxhYmxlQm9keUhlaWdodCAtIDUwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMudGFibGVQYWdlcikge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFdpZHRoID0gdGhpcy50YWJsZVBhZ2VyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBnU2Nyb2xsTGVmdCA9IDA7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNkICYmICF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhclNlYXJjaFZhbHVlKCkge1xyXG4gICAgICAgIHRoaXMuc2VhcmNoRGF0YS52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuY2xlYXJTZWFyY2hWYWx1ZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJhY2tCeVJvd3MgPSAoaW5kZXg6IG51bWJlciwgcm93OiBhbnkpID0+IHtcclxuICAgICAgICByZXR1cm4gcm93W3RoaXMuaWRGaWVsZF07XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmhlaWdodCAmJiAhY2hhbmdlcy5oZWlnaHQuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Qm9keUhlaWdodCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMudG90YWwgJiYgIWNoYW5nZXMudG90YWwuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMudG90YWxJdGVtcyA9IGNoYW5nZXMudG90YWwuY3VycmVudFZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMucGFnZVNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0aW9uT3B0aW9ucy5pdGVtc1BlclBhZ2UgPSBjaGFuZ2VzLnBhZ2VTaXplLmN1cnJlbnRWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLnBhZ2VJbmRleCAmJiAhY2hhbmdlcy5wYWdlSW5kZXguaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuY3VycmVudFBhZ2UgPSBjaGFuZ2VzLnBhZ2VJbmRleC5jdXJyZW50VmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5kYXRhICYmICFjaGFuZ2VzLmRhdGEuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvd3MgPSBjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrYm94U3RhdGUocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSB7IC4uLnRoaXMucGFnaW5hdGlvbk9wdGlvbnMgfTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5sb2FkU3VjY2Vzcy5uZXh0KGNoYW5nZXMuZGF0YS5jdXJyZW50VmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XHJcbiAgICAgICAgLy8g5pSv5oyB5YiX57uE5Lu25YaZ5YWlXHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbHVtbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29sdW1uc1JlZiAmJiB0aGlzLmNvbHVtbnNSZWYubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbnMgPSB0aGlzLmNvbHVtbnNSZWYubWFwKGNvbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGNvbC53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGNvbC50aXRsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6IGNvbC5maWVsZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ246IGNvbC5hbGlnbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWQ6IGNvbC5maXhlZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBjb2wuY2xhc3NOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZUZpbHRlcjogY29sLm11bHRpcGxlRmlsdGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IGNvbC5maWx0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhOiBjb2wubWVkaWEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlOiBjb2wuc29ydGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IGNvbC5lZGl0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy50YWJsZVBhZ2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVQYWdlci5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLm1vdXNlRW50ZXJPblBhZ2VyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZ1Njcm9sbGJhci5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50YWJsZVBhZ2VyLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMubW91c2VMZWF2ZU9uUGFnZXIgPSgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGdTY3JvbGxiYXIubmF0aXZlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50YWJsZVBhZ2VyLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB0aGlzLm1vdXNlV2hlZWxPblBhZ2VyID0gKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJveCA9IHRoaXMudGFibGVQYWdlci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3cgPSB0aGlzLnNjcm9sbFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3cgPSBib3gub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoc3cgPiBvdykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0ID0gc3cgLSBvdztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbCA9IE1hdGguYWJzKHRoaXMucGdTY3JvbGxMZWZ0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2wgPCByaWdodCAmJiBlLmRlbHRhWSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnBnU2Nyb2xsTGVmdCA9IC0oc2wgKyA1MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGdTY3JvbGxiYXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gc2wgKyA1MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNsID4gMCAmJiBlLmRlbHRhWSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnBnU2Nyb2xsTGVmdCA9IC0oc2wgLSA1MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGdTY3JvbGxiYXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gc2wgLSA1MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5wZ1Njcm9sbGJhcikge1xyXG4gICAgICAgICAgICBmcm9tRXZlbnQodGhpcy5wZ1Njcm9sbGJhci5uYXRpdmVFbGVtZW50LCAnc2Nyb2xsJykucGlwZShcclxuICAgICAgICAgICAgICAgIGRlbGF5KDUwKVxyXG4gICAgICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5wZ1Njcm9sbExlZnQgPSAtZS50YXJnZXQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24uZm9yRWFjaChzdWIgPT4ge1xyXG4gICAgICAgICAgICBzdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLnBhZ2VyID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudGFibGVQYWdlciAmJiB0aGlzLnRhYmxlUGFnZXIubmF0aXZlRWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnRhYmxlUGFnZXIubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5tb3VzZUVudGVyT25QYWdlcik7XHJcbiAgICAgICAgICAgIHRoaXMudGFibGVQYWdlci5uYXRpdmVFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLm1vdXNlTGVhdmVPblBhZ2VyKTtcclxuICAgICAgICAgICAgdGhpcy50YWJsZVBhZ2VyLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2hlZWwnLCB0aGlzLm1vdXNlV2hlZWxPblBhZ2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgLy8g6I635Y+W6KGo5qC85a655ZmoICDljbPooajmoLxcclxuICAgICAgICB0aGlzLmRhdGF0YWJsZUNvbnRhaW5lciA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZmFycmlzLWRhdGF0YWJsZScpO1xyXG4gICAgICAgIC8vIHRoaXMuaGVhZGVyVHIgPSB0aGlzLnRhYmxlSGVhZGVyLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHInKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVDaGVja2JveFN0YXRlKHJvd3M6IGFueVtdKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IHVwZGF0ZUNoZWNrQWxsU3RhdHVzID0gKGYpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0hlYWRlciAmJiB0aGlzLmR0SGVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmR0SGVhZGVyLmlzQ2hlY2tBbGwgPSBmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHJvd3MgJiYgcm93cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZHRCb2R5Ll9zZWxlY3Rpb25zKTtcclxuICAgICAgICAgICAgICAgIGlmIChrZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRzID0gcm93cy5tYXAoKHJvdzogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb3dbdGhpcy5pZEZpZWxkXS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGtleXMuZm9yRWFjaChpZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMuaW5kZXhPZihpZCkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDaGVja0FsbFN0YXR1cyhpZHMubGVuZ3RoID09PSBjb3VudCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNoZWNrQWxsU3RhdHVzKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZUNoZWNrQWxsU3RhdHVzKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZUNoZWNrQWxsU3RhdHVzKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W6KGo5qC85a655Zmo55qE5L2N572uICDot53nprvlt6bovrnop4blj6PlkozkuIrovrnop4blj6PnmoTot53nprsgIOWmguaenOmhtemdouaciea7muWKqOadoSAg6ZyA6KaB5Yqg5LiK5rua5Yqo5p2h5rua5Yqo55qE5pWw5YC8XHJcbiAgICAgKi9cclxuICAgIGdldENvbnRhaW5lck9mZnNldCgpIHtcclxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5kYXRhdGFibGVDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0LFxyXG4gICAgICAgICAgICB0b3A6IHJlY3QudG9wICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsXHJcbiAgICAgICAgICAgIHJpZ2h0OiByZWN0LnJpZ2h0LFxyXG4gICAgICAgICAgICBib3R0b206IHJlY3QuYm90dG9tLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqICDpvKDmoIfmjInkuIsgIOW8gOWni+iusOW9leaLluaLvee6v+eahOS9jee9riAg5ouW5ou957q/5Yiw6L6+5b2T5YmN6byg5qCH5L2N572uXHJcbiAgICAgKiBAcGFyYW0gZSDpvKDmoIflr7nosaFcclxuICAgICAqL1xyXG4gICAgYmVnaW5EcmFnKGUpIHtcclxuICAgICAgICB0aGlzLmRyYWdMaW5lWCA9IGUucGFnZVg7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6byg5qCH56e75YqoIOenu+WKqOaLluaLvee6v+S9jee9ruWPmOWKqFxyXG4gICAgICogQHBhcmFtIGUg6byg5qCH5a+56LGhXHJcbiAgICAgKi9cclxuICAgIG1vdmVEcmFnKGUpIHtcclxuICAgICAgICAvLyDojrflj5booajmoLznmoTlt6bovrnot53nprtcclxuICAgICAgICBjb25zdCBjb250YWluZXJMZWZ0ID0gdGhpcy5nZXRDb250YWluZXJPZmZzZXQoKS5sZWZ0O1xyXG4gICAgICAgIC8vIOiuvue9ruaLluaLvee6v+eahOmrmOW6piAg5Y2z6I635Y+W6KGo5aS0K+ihqOWGheWuuSvooajlsL7nmoTpq5jluqYgIOatpOihqOagvOe7k+aehOWMheWQq+S6huWIhumhtSAg5Zug5q2k6KaB5Y675o6J5YiG6aG155qE6auY5bqmXHJcbiAgICAgICAgaWYgKHRoaXMudGFibGVQYWdlcikge1xyXG4gICAgICAgICAgICB0aGlzLmRyYWdMaW5lLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5kYXRhdGFibGVDb250YWluZXIub2Zmc2V0SGVpZ2h0IC1cclxuICAgICAgICAgICAgICAgIHRoaXMudGFibGVQYWdlci5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCArICdweCc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY29uc3QgaGVhZGVySGVpZ2h0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXJyaXMtdGFibGUtaGVhZGVyJyk7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IGJvZHlIZWlnaHQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBzLWNvbnRlbnQnKTtcclxuICAgICAgICAgICAgdGhpcy5kcmFnTGluZS5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuZGF0YXRhYmxlQ29udGFpbmVyLm9mZnNldEhlaWdodCArICdweCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiuvue9ruaLluaLvee6v+eahOmrmOW6piDmi5bmi73nur/nm7jlr7nkuo7ooajmoLxyZWxhdGl2ZeWumuS9jeaYr2Fic29sdXRl77yM5Zug5q2k5pivMFxyXG4gICAgICAgIHRoaXMuZHJhZ0xpbmUubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSAwICsgJ3B4JztcclxuICAgICAgICAvLyDpvKDmoIfnp7vliqjml7bvvIzmi5bmi73nur/nm7jlr7nkuo7ooajmoLznmoTkvY3nva5cclxuICAgICAgICB0aGlzLmRyYWdMaW5lLm5hdGl2ZUVsZW1lbnQuc3R5bGUubGVmdCA9IChlLnBhZ2VYIC0gY29udGFpbmVyTGVmdCkgKyAncHgnO1xyXG4gICAgICAgIC8vIOm8oOagh+enu+WKqCAg6K6+572u5ouW5ou957q/5oC75piv5Y+v6KeBXHJcbiAgICAgICAgdGhpcy5kcmFnTGluZS5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgfVxyXG4gICAgLy8g6YeN5paw6K6h566X6KGo5qC85a695bqmXHJcbiAgICAvKipcclxuICAgICAqIOm8oOagh+aKrOi1tyDph43mlrDorqHnrpfljZXlhYPmoLzlrr3luqZcclxuICAgICAqIOm8oOagh+WvueixoVxyXG4gICAgICovXHJcbiAgICBzdG9wRHJhZyhlLCBjb2x1bW4pIHtcclxuICAgICAgICB0aGlzLnJlc2l6ZUNvbHVtbihlLCBjb2x1bW4pO1xyXG4gICAgfVxyXG4gICAgcmVzaXplQ29sdW1uKGUsIGNvbHVtbikge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2hlY2tCb3goY29sdW1uLCAnZHQtY2hlY2tib3gtY2VsbCcpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ0xpbmUubmF0aXZlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWBj+enu+mHj1xyXG4gICAgICAgIGNvbnN0IGRlbHRhID0gZS5wYWdlWCAtIHRoaXMuZHJhZ0xpbmVYO1xyXG4gICAgICAgIC8vIOaLluaLveWJjeWIl+WuvVxyXG4gICAgICAgIGNvbnN0IGNvbHVtbldpZHRoID0gY29sdW1uLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIC8vIOaLluaLveWQjuWIl+WuvVxyXG4gICAgICAgIGxldCBuZXdDb2x1bW5XaWR0aCA9IGNvbHVtbldpZHRoICsgZGVsdGE7XHJcbiAgICAgICAgLy8g5pyA5bCP5a695bqmXHJcbiAgICAgICAgY29uc3QgbWluV2lkdGggPSBjb2x1bW4uc3R5bGUubWluV2lkdGggfHwgMzA7XHJcbiAgICAgICAgLy8g5paw5a695bqm5aSn5LqO5oiW562J5LqO5pyA5bCP5a695bqm5pe2XHJcbiAgICAgICAgbmV3Q29sdW1uV2lkdGggPSBuZXdDb2x1bW5XaWR0aCA+IG1pbldpZHRoID8gbmV3Q29sdW1uV2lkdGggOiBtaW5XaWR0aDtcclxuICAgICAgICAvLyDph43mlrDorr7nva7lrr3luqZcclxuICAgICAgICBsZXQgY29sSW5kZXggPSAtMTtcclxuICAgICAgICBjb25zdCBvdGhlcnNDb2wgPSBbXTtcclxuICAgICAgICBjb25zdCBjb2xzID0gdGhpcy50YWJsZUhlYWRlci5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoJyk7XHJcblxyXG4gICAgICAgIC8vIOeItuiKgueCueWuveW6plxyXG4gICAgICAgIGNvbnN0IHBhcmVudFdpZHRoID0gY29sdW1uLnBhcmVudEVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5LiN5piv5pyJY2hlY2tib3hcclxuICAgICAgICBjb25zdCBmaXJzdEVsZW1lbnQgPSBjb2x1bW4ucGFyZW50RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuICAgICAgICBjb25zdCBjaGVja0JveFdpZHRoID0gdGhpcy5pc0NoZWNrQm94KGZpcnN0RWxlbWVudCwgJ2R0LWNoZWNrYm94LWNlbGwnKSA/IGZpcnN0RWxlbWVudC5vZmZzZXRXaWR0aCA6IDA7XHJcbiAgICAgICAgLy8g5YW25LuW5YiX5a695bqmXHJcbiAgICAgICAgbGV0IG90aGVyc1dpZHRoID0gcGFyZW50V2lkdGggLSBjb2x1bW5XaWR0aCAtIGNoZWNrQm94V2lkdGg7XHJcbiAgICAgICAgbGV0IG5ld090aGVyc1dpZHRoID0gcGFyZW50V2lkdGggLSBuZXdDb2x1bW5XaWR0aCAtIGNoZWNrQm94V2lkdGg7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChjb2xzW2ldID09PSBjb2x1bW4pIHtcclxuICAgICAgICAgICAgICAgIGNvbEluZGV4ID0gaTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQ2hlY2tCb3goY29sc1tpXSwgJ2R0LWNoZWNrYm94LWNlbGwnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcmF0ZSA9IGNvbHNbaV0ub2Zmc2V0V2lkdGggLyBvdGhlcnNXaWR0aDtcclxuICAgICAgICAgICAgICAgIGlmIChyYXRlID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNvbHNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGNvbFdpZHRoID0gbmV3T3RoZXJzV2lkdGggKiByYXRlO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld090aGVyc1dpZHRoICogcmF0ZSA+IDE1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sV2lkdGggPSBuZXdPdGhlcnNXaWR0aCAqIHJhdGU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbFdpZHRoID0gMTU7XHJcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJzV2lkdGggPSBvdGhlcnNXaWR0aCAtIGNvbFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld090aGVyc1dpZHRoID0gbmV3T3RoZXJzV2lkdGggLSBjb2xXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBuZXdDb2x1bW5XaWR0aCA9IG5ld0NvbHVtbldpZHRoIC0gMTUgKyBuZXdPdGhlcnNXaWR0aCAqIHJhdGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvdGhlcnNDb2wucHVzaCh7IGNvbEluZGV4OiBpLCBjb2xXaWR0aCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc2l6ZUNvbEdyb3VwKHRoaXMuZHRIZWFkZXIuZWwubmF0aXZlRWxlbWVudCwgY29sSW5kZXgsIG5ld0NvbHVtbldpZHRoLCBvdGhlcnNDb2wpO1xyXG4gICAgICAgIHRoaXMucmVzaXplQ29sR3JvdXAodGhpcy5kdEJvZHkuZWwubmF0aXZlRWxlbWVudCwgY29sSW5kZXgsIG5ld0NvbHVtbldpZHRoLCBvdGhlcnNDb2wpO1xyXG4gICAgICAgIC8vIOiuoeeul+WuveW6puWujOavlSAg6K6+572u5ouW5ou957q/6ZqQ6JePXHJcbiAgICAgICAgdGhpcy5kcmFnTGluZS5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICB9XHJcbiAgICBpc0NoZWNrQm94KGVsZW1lbnRzLCBjTmFtZSkge1xyXG4gICAgICAgIHJldHVybiAhIWVsZW1lbnRzLmNsYXNzTmFtZS5tYXRjaChuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY05hbWUgKyAnKFxcXFxzfCQpJykpO1xyXG4gICAgfVxyXG4gICAgcmVzaXplQ29sR3JvdXAodGFibGUsIHJlc2l6ZUNvbHVtbkluZGV4LCBuZXdDb2x1bW5XaWR0aCwgb3RoZXJzQ29sdW1uKSB7XHJcbiAgICAgICAgaWYgKHRhYmxlKSB7XHJcbiAgICAgICAgICAgIC8vIOatpOWkhOimgeinhuS4jeWQjOeahOihqOagvOe7k+aehOadpeehruWumiDmnKznu4Tku7bkuK0gIGhlYWRlcuWSjGJvZHnnu5PmnoTnm7jlkIxcclxuICAgICAgICAgICAgY29uc3QgY29sR3JvdXAgPSB0YWJsZS5jaGlsZE5vZGVzWzBdLmNoaWxkcmVuWzBdLm5vZGVOYW1lID09PSAnQ09MR1JPVVAnID9cclxuICAgICAgICAgICAgICAgIHRhYmxlLmNoaWxkTm9kZXNbMF0uY2hpbGRyZW5bMF0gOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAoY29sR3JvdXApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IGNvbEdyb3VwLmNoaWxkcmVuW3Jlc2l6ZUNvbHVtbkluZGV4XTtcclxuICAgICAgICAgICAgICAgIGNvbC5zdHlsZS53aWR0aCA9IG5ld0NvbHVtbldpZHRoICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3RoZXJzQ29sdW1uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3RoZXJDb2wgPSBjb2xHcm91cC5jaGlsZHJlbltvdGhlcnNDb2x1bW5baV0uY29sSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdGhlckNvbCAmJiBvdGhlcnNDb2x1bW5baV0uY29sV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXJDb2wuc3R5bGUud2lkdGggPSBvdGhlcnNDb2x1bW5baV0uY29sV2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2Nyb2xsYWJsZSB0YWJsZXMgcmVxdWlyZSBhIGNvbGdyb3VwIHRvIHN1cHBvcnQgcmVzaXphYmxlIGNvbHVtbnMnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uU2Nyb2xsWChlOiBhbnkpIHtcclxuICAgICAgICAvLyDmqKrlkJHmu5rliqgg6Z2e5Zu65a6a6KGo5aS05rua5YqoXHJcbiAgICAgICAgY29uc3QgeCA9IGUuc3JjRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIHRoaXMudGFibGVIZWFkZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUbyh4LCAwKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5rua5Yqo5p2h57q15ZCR5rua5YqoXHJcbiAgICAgKi9cclxuICAgIG9uU2Nyb2xsWShlOiBhbnkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaGFzRml4ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB5ID0gZS5zcmNFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgICB0aGlzLmR0TGVmdEZpeGVkLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gLXkgKyAncHgnO1xyXG4gICAgICAgIHRoaXMuZHRSaWdodEZpeGVkLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gLXkgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VDaGFuZ2UocGFnZTogeyBwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlciB9KSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ICE9PSBwYWdlLnBhZ2VJbmRleCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2UucGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gcGFnZS5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZUNoYW5nZWQuZW1pdCh7IHBhZ2VJbmZvOiBwYWdlLCBzZWFyY2g6IHRoaXMuc2VhcmNoRGF0YSwgc29ydE5hbWU6IHRoaXMuc29ydE5hbWUsIHNvcnRPcmRlcjogdGhpcy5zb3J0T3JkZXIgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uUGFnZVNpemVDaGFuZ2UocGFnZVNpemU6IG51bWJlcikge1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VTaXplICE9PSBwYWdlU2l6ZSAmJiB0aGlzLnRvdGFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuaXRlbXNQZXJQYWdlID0gcGFnZVNpemU7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZVNpemUgPSBwYWdlU2l6ZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsID0gdGhpcy50b3RhbDtcclxuICAgICAgICAgICAgbGV0IHBhZ2VMZW5ndGggPSBNYXRoLmZsb29yKHRvdGFsIC8gcGFnZVNpemUpO1xyXG4gICAgICAgICAgICBpZiAodG90YWwgJSBwYWdlU2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHBhZ2VMZW5ndGggKz0gMTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHBhZ2VMZW5ndGggJiYgdGhpcy5wYWdlSW5kZXggPiBwYWdlTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2VMZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gdGhpcy5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucGFnZVNpemVDaGFuZ2VkLmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgcGFnZUluZm86IHsgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwgcGFnZVNpemUgfSxcclxuICAgICAgICAgICAgICAgIHNlYXJjaDogdGhpcy5zZWFyY2hEYXRhLCBzb3J0TmFtZTogdGhpcy5zb3J0TmFtZSwgc29ydE9yZGVyOiB0aGlzLnNvcnRPcmRlclxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGFibGVQYWdlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsV2lkdGggPSB0aGlzLnRhYmxlUGFnZXIubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMucGdTY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWFyY2goJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudC5vcmlnaW5hbEV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5vcmlnaW5hbEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlYXJjaC5lbWl0KHRoaXMuc2VhcmNoRGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DaGVja0FsbChzdGF0ZTogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2VsZWN0ZWRBbGwubmV4dChzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5jaGVja0FsbC5lbWl0KHN0YXRlKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgb25TZWxlY3RlZFJvdyhlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkUm93LmVtaXQoeyBkYXRhOiBlLnJvd0RhdGEsIGluZGV4OiBlLnJvd0luZGV4IH0pO1xyXG4gICAgICAgIC8vIOWFvOWuuVxyXG4gICAgICAgIHRoaXMuc2VsZWN0Um93cy5lbWl0KHsgZGF0YTogZS5yb3dEYXRhLCBpbmRleDogZS5yb3dJbmRleCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tc2hhZG93ZWQtdmFyaWFibGVcclxuICAgIHJlc2l6ZShzaXplOiB7IHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyIH0pIHtcclxuICAgICAgICB0aGlzLndpZHRoID0gc2l6ZS53aWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IHNpemUuaGVpZ2h0O1xyXG5cclxuICAgICAgICB0aGlzLnNldEJvZHlIZWlnaHQoKTsgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbG9hZERhdGEoZTogeyBwYWdlU2l6ZTogbnVtYmVyLCB0b3RhbDogbnVtYmVyLCBkYXRhOiBhbnksIHBhZ2VJbmRleDogbnVtYmVyIH0pIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBlLmRhdGE7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnaW5hdGlvbikge1xyXG4gICAgICAgICAgICBjb25zdCB7IHRvdGFsID0gMCwgcGFnZVNpemUgPSAyMCwgcGFnZUluZGV4ID0gMSB9ID0geyAuLi5lIH07XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMudG90YWxJdGVtcyA9IHRvdGFsO1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLml0ZW1zUGVyUGFnZSA9IHBhZ2VTaXplO1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gcGFnZUluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLnBhZ2VMaXN0ID0gdGhpcy5wYWdlTGlzdDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMgPSB7Li4udGhpcy5wYWdpbmF0aW9uT3B0aW9uc307XHJcbiAgICAgICAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcclxuICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHBhZ2VTaXplO1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2VJbmRleDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVDaGVja2JveFN0YXRlKHRoaXMuZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqL1xyXG4gICAgb25DZWxsQ2xpY2soZSkge1xyXG4gICAgICAgIHRoaXMuY2VsbENsaWNrLmVtaXQoZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyog5re75Yqg6KGMICovXHJcbiAgICBhZGRSb3dzKGRhdGFJdGVtKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5kYXRhLmNvbmNhdChkYXRhSXRlbSk7XHJcbiAgICB9XHJcbiAgICAvKiDliKDpmaTooYwgKi9cclxuICAgIHJlbW92ZVJvd3MoKSB7XHJcbiAgICAgICAgY29uc3QgU0VMRUNUSU9OUyA9IHRoaXMuc2VsZWN0aW9ucztcclxuICAgICAgICBpZiAodGhpcy5zaW5nbGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGFbaV0gPT09IFNFTEVDVElPTlMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTRUxFQ1RJT05TLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZGF0YS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChTRUxFQ1RJT05TW2ldW3RoaXMuaWRGaWVsZF0gPT09IHRoaXMuZGF0YVtqXVt0aGlzLmlkRmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5zcGxpY2UoaiwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrUm93KHJpZDogYW55LCBlbWl0ID0gZmFsc2UpIHtcclxuICAgICAgICBsZXQgcm93SW5kZXggPSAtMTtcclxuICAgICAgICBjb25zdCByb3dEYXRhID0gdGhpcy5kYXRhLmZpbmQoKG4sIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKG5bdGhpcy5pZEZpZWxkXSA9PSByaWQpIHtcclxuICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICBpZiAoIXJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGlvbnMpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0geyBbcmlkXTogcm93RGF0YSB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIFtyaWRdOiByb3dEYXRhLCAuLi50aGlzLnNlbGVjdGlvbnMucmVkdWNlKChyLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcltuW3RoaXMuaWRGaWVsZF1dID0gbjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcclxuICAgICAgICAgICAgICAgIH0sIHt9KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5zZWxlY3RlZFJvdy5uZXh0KHtcclxuICAgICAgICAgICAgcm93SW5kZXgsXHJcbiAgICAgICAgICAgIHJvd0RhdGFcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGVtaXQpIHtcclxuICAgICAgICAgICAgY29uc3QgcCA9IHsgZGF0YTogcm93RGF0YSwgaW5kZXg6IHJvd0luZGV4IH07XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3cuZW1pdChwKTtcclxuICAgICAgICAgICAgLy8g5YW85a65XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93cy5lbWl0KHApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1bkNoZWNrUm93KHJpZDogYW55LCBlbWl0ID0gZmFsc2UpIHtcclxuICAgICAgICBsZXQgcm93SW5kZXggPSAtMTtcclxuICAgICAgICBjb25zdCByb3dEYXRhID0gdGhpcy5kYXRhLmZpbmQoKG4sIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKG5bdGhpcy5pZEZpZWxkXSA9PSByaWQpIHtcclxuICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9ucykge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSB0aGlzLnNlbGVjdGlvbnMuZmlsdGVyKG4gPT4gblt0aGlzLmlkRmllbGRdICE9IHJpZCkucmVkdWNlKChyLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByW25bdGhpcy5pZEZpZWxkXV0gPSBuO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XHJcbiAgICAgICAgICAgIH0sIHt9KTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS51blNlbGVjdGVkUm93Lm5leHQoe1xyXG4gICAgICAgICAgICAgICAgcm93SW5kZXgsXHJcbiAgICAgICAgICAgICAgICByb3dEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoZW1pdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdFJvdy5lbWl0KHsgZGF0YTogcm93RGF0YSwgaW5kZXg6IHJvd0luZGV4IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyU2VsZWN0aW9ucygpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25LZXlkb3duRXZlbnQoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCEkZXZlbnQgfHwgIXRoaXMuc2luZ2xlU2VsZWN0IHx8ICF0aGlzLmRhdGEgfHwgIXRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFbJ0Fycm93RG93bicsICdBcnJvd1VwJ10uaW5jbHVkZXMoJGV2ZW50LmNvZGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsZXQgbmV3SWR4O1xyXG4gICAgICAgIGlmICgkZXZlbnQuY29kZSA9PT0gJ0Fycm93RG93bicpIHtcclxuICAgICAgICAgICAgbmV3SWR4ID0gdGhpcy5fY3VycmVudFJvd0luZGV4ICsgMTtcclxuICAgICAgICAgICAgaWYgKG5ld0lkeCA+PSB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdJZHggPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICgkZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50Um93SW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdJZHggPSB0aGlzLl9jdXJyZW50Um93SW5kZXggLSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobmV3SWR4ID49IDApIHtcclxuICAgICAgICAgICAgdGhpcy5kdEJvZHkuc2VsZWN0ZWRSb3coJGV2ZW50LCBuZXdJZHgsIHRoaXMuZGF0YVtuZXdJZHhdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBzY3JvbGwgaW50b1ZpZXdcclxuICAgICAgICAgICAgY29uc3QgdHJEb21zID0gdGhpcy5kdEJvZHkuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudWktdGFibGUtdGJvZHkgdHInKTtcclxuICAgICAgICAgICAgaWYgKHRyRG9tcyAmJiB0ckRvbXNbdGhpcy5fY3VycmVudFJvd0luZGV4XSkge1xyXG4gICAgICAgICAgICAgICAgdHJEb21zW3RoaXMuX2N1cnJlbnRSb3dJbmRleF0uc2Nyb2xsSW50b1ZpZXcoeyBibG9jazogJ25lYXJlc3QnIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdfQ==