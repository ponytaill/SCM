/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, Renderer2, ElementRef, ViewChild, ViewEncapsulation, HostListener } from '@angular/core';
import { QuerySolutionService } from '@farris/ui-filter-condition';
import { deepCopy } from './utils';
// 用于显示点击 简单筛选 项的下拉面板
var FilterPanelComponent = /** @class */ (function () {
    function FilterPanelComponent(renderer, elementRef, filterConditionSer) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.filterConditionSer = filterConditionSer;
        this._hide = false;
        this.hidePanel = new EventEmitter();
        this.submit = new EventEmitter();
        this.filterSubmit = new EventEmitter();
        this.clearFilter = new EventEmitter();
        this.canSubmit = false;
        this.fiexedLeft = true;
        // 全局标识，初始化标识元素没有发生mousemove
        this.hasMove = false;
        this._documentMouseUpEvent = null;
        this.el = this.elementRef.nativeElement;
    }
    Object.defineProperty(FilterPanelComponent.prototype, "hide", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hide;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._hide = val;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var self = this;
        this._documentMouseUpEvent = this.renderer.listen(document, 'mouseup', (/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            if (event.target.closest('#mainContainerTabset')) {
                self.hidePanel.emit(event);
                return;
            }
            if (_this.hasMove) {
                return;
            }
            if (!event.target.closest('.f-filter-panel')
                && !event.target.closest('.modal')
                && !event.target.closest('.overlay-container') && !event.target.closest('.overlay-pane')) {
                self.hidePanel.emit(event);
            }
            _this.hasMove = false;
        }));
        if (this.option.item && (this.option.item.control.controltype == 'dropdown' || this.option.item.control.controltype == 'radio')) {
            this.canSubmit = true;
        }
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var _panel = this.el.querySelector('.f-filter-panel');
        if (_panel && this.option.target) {
            /** @type {?} */
            var h = _panel.offsetHeight;
            /** @type {?} */
            var rect = this.option.target.getBoundingClientRect();
            if (window['innerHeight'] - this.option.top < h) {
                if (rect.top > h) {
                    this.option.top = rect.top - h - 14;
                }
                else {
                    this.option.top = 32;
                }
                /** @type {?} */
                var arrow = this.el.querySelector('.f-filter-panel-arrow');
                if (arrow) {
                    arrow.style.display = 'none';
                }
            }
        }
        if (_panel && this.option.right) {
            if (this.option.left + _panel.offsetWidth > window['innerWidth']) {
                // 超出显示在做
                this.fiexedLeft = false;
                this.option.left = this.option.right - _panel.offsetWidth;
            }
            else {
                this.fiexedLeft = true;
            }
        }
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._documentMouseUpEvent) {
            this._documentMouseUpEvent();
            this._documentMouseUpEvent = null;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.onMouseDown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.hasMove = false;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.onMouseMove = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.hasMove = true;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FilterPanelComponent.prototype.onSearch = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.option.item.control.controltype == 'radio') {
            this.panelFilterSubmit();
        }
        else if (this.option.item.control.controltype == 'text' && event['type'] && event['type'] === 'enter') {
            this.panelFilterSubmit();
        }
        // this.filterItem = event;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterCancel = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.hidePanel.emit($event);
    };
    /**
     * @param {?=} clear
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterSubmit = /**
     * @param {?=} clear
     * @return {?}
     */
    function (clear) {
        if (clear === void 0) { clear = false; }
        if (!clear && !this.canSubmit) {
            return;
        }
        if (this.option.item.control.controltype === 'text') {
            /** @type {?} */
            var farrisSearchRecord = this.option.item.valueText;
            /** @type {?} */
            var farrisSearchRecordArray = [];
            /** @type {?} */
            var storagelabelCode = this.option.item.labelCode;
            /** @type {?} */
            var filterPanelArray = JSON.parse(localStorage.getItem(this.option.localStorageKey));
            if (Array.isArray(filterPanelArray)) {
                filterPanelArray = null;
            }
            if (!filterPanelArray || !filterPanelArray[storagelabelCode] || !filterPanelArray[storagelabelCode].length
                && farrisSearchRecord && farrisSearchRecord.length) {
                farrisSearchRecordArray.push(farrisSearchRecord);
            }
            else {
                farrisSearchRecordArray = filterPanelArray[storagelabelCode];
                /** @type {?} */
                var index = filterPanelArray[storagelabelCode].indexOf(farrisSearchRecord);
                if (index < 0 && farrisSearchRecord && farrisSearchRecord.length) {
                    farrisSearchRecordArray.unshift(farrisSearchRecord);
                }
                farrisSearchRecordArray = farrisSearchRecordArray.slice(0, 6);
            }
            if (filterPanelArray == null) {
                filterPanelArray = {};
            }
            filterPanelArray[storagelabelCode] = farrisSearchRecordArray;
            localStorage.setItem(this.option.localStorageKey, JSON.stringify(filterPanelArray));
        }
        /** @type {?} */
        var conditions = this.filterConditionSer.setFilterConditions(this.option.item);
        if (!clear) {
            this.filterSubmit.emit({
                item: this.option.item,
                filter: conditions
            });
        }
        this.submit.emit(this.option.item);
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterClear = /**
     * @return {?}
     */
    function () {
        this.panelFilterempty();
        this.panelFilterSubmit(true);
        this.clearFilter.emit(this.option.item);
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterempty = /**
     * @return {?}
     */
    function () {
        this.filterClearValue(this.option.item);
        this.option.item.valueText = '';
        this.option.item.filled = false;
        this.option.item = deepCopy(this.option.item);
        this.canSubmit = false;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    FilterPanelComponent.prototype.filterClearValue = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        switch (item.control.controltype) {
            case 'text':
            case 'search':
            case 'singleDate':
            case 'year':
            case 'month':
            case 'dropdown':
            case 'singlenumber':
            case 'radio':
                item.value.value = null;
                break;
            case 'date':
            case 'datetime':
            case 'monthRange':
            case 'yearRange':
                item.value.startTime = null;
                item.value.endTime = null;
                break;
            case 'number':
                item.value.startValue = null;
                item.value.endValue = null;
                break;
            case 'help':
                item.value.value = [];
                item.value.valueField = null;
                item.value.textValue = null;
                break;
            case 'checkboxgroup':
            case 'bool-check':
                item.value.value = [];
                break;
            case 'input-group':
                item.value.value = [];
                item.value.textValue = null;
                item.value.textField = null;
                item.value.isInputText = null;
                break;
            case 'flexibleNumber':
            case 'flexibleDate':
                item.value.startValue = null;
                item.value.endValue = null;
                item.value.value = null;
                break;
            default:
                item.value.value = null;
                break;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FilterPanelComponent.prototype.onSubmitChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.canSubmit = event;
    };
    FilterPanelComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-filter-panel',
                    template: "<div class=\"f-filter-panel-wrapper\" #filterPanel [ngClass]=\"{'d-none': hide}\">\r\n    <div  [class]=\"'f-filter-panel f-filter-panel-'+(option.item && option.item.control.controltype)\"\r\n        [ngStyle]=\"{\r\n            'left': option.left > 0 ? option.left+'px' : '0px',\r\n            'top': option.top > 0 ? option.top+'px' : '0px',\r\n            'width': (option.width && option.width > 0) ? option.width+'px':'',\r\n            'height': (option.height && option.height > 0) ? option.height+'px':'',\r\n            'max-width': (option.maxWidth && option.maxWidth > 0) ? option.maxWidth+'px':'',\r\n            'max-height': (option.maxHeight && option.maxHeight > 0) ? option.maxHeight+'px':''\r\n        }\">\r\n        <div class=\"f-filter-panel-inner\" [ngClass]=\"{'f-filter-panel-inner-xs': option.item && option.item.control.controltype == 'radio','f-filter-panel-inner-auto': !option.item}\">\r\n            <div class=\"f-filter-panel-arrow\" [ngStyle]=\"{'left':fiexedLeft?'26px':'auto','right':fiexedLeft?'auto':'26px'}\"></div>\r\n            <div class=\"f-filter-panel-extend\" *ngIf=\"option.panelExtendTemplate\">\r\n                <ng-container [ngTemplateOutlet]=\"option.panelExtendTemplate\"></ng-container>\r\n            </div>\r\n            <div class=\"f-filter-panel-header\" *ngIf=\"option.showLable && option.item && option.item.control.controltype != 'radio'\">\r\n                <div class=\"panel-header-title\">\r\n                    {{ 'filterPanel.filter' | locale }}\r\n                </div>\r\n                <!-- <div class=\"panel-header-toolbar\"></div> -->\r\n            </div>\r\n            <div class=\"f-filter-panel-content\" *ngIf=\"option.item\">\r\n                <div class=\"f-filter-panel-form\">\r\n                    <ng-container [ngSwitch]=\"option.item.control.controltype\">\r\n                        <div class=\"filter-input-item filter-type-input position-relative\" *ngSwitchCase=\"'text'\">\r\n                            <panel-filter-input [item]=\"option.item\" [localStorageKey]=\"option.localStorageKey\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-input>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-search\" *ngSwitchCase=\"'search'\">\r\n                            <panel-filter-search [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-search>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'singleDate'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'year'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'3'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'month'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'2'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'date'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'datetime'\">\r\n                            <panel-filter-daterange [item]=\"option.item\" [showTime]=\"true\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'monthRange'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'2'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'yearRange'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'3'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-dropdown\" *ngSwitchCase=\"'dropdown'\">\r\n                            <panel-filter-dropdown [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"  (submitChange)=\"onSubmitChange($event)\"></panel-filter-dropdown>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-number\" *ngSwitchCase=\"'number'\">\r\n                            <panel-filter-number [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-number>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-single-number\" *ngSwitchCase=\"'singlenumber'\">\r\n                            <panel-filter-single-number [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-single-number>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-help\" *ngSwitchCase=\"'help'\">\r\n                            <panel-filter-help [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-help>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-checkboxgroup\" *ngSwitchCase=\"'checkboxgroup'\">\r\n                            <panel-filter-checkbox [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-checkbox>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-radio\" *ngSwitchCase=\"'radio'\">\r\n                            <panel-filter-radio [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\"></panel-filter-radio>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-radio\" *ngSwitchCase=\"'input-group'\">\r\n                            <panel-filter-inputgroup [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\"  (submitChange)=\"onSubmitChange($event)\"></panel-filter-inputgroup>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-flexiblenumber\" *ngSwitchCase=\"'flexibleNumber'\">\r\n                            <panel-filter-flexiblenumber [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-flexiblenumber>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-flexibledate\" *ngSwitchCase=\"'flexibleDate'\">\r\n                            <panel-filter-flexibledate [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-flexibledate>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-boolcheck\" *ngSwitchCase=\"'bool-check'\">\r\n                            <panel-filter-checkbox [item]=\"option.item\" [boolcheck]=\"true\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-checkbox>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-default\" *ngSwitchDefault>\r\n                            <panel-filter-input [item]=\"option.item\" [localStorageKey]=\"option.localStorageKey\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-input>\r\n                        </div>\r\n                    </ng-container>\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"f-filter-panel-footer\" *ngIf=\"option.item && option.item.control.controltype != 'radio'\">\r\n                <div class=\"filer-panel-clear\">\r\n                    <button class=\"btn btn-link\" (click)=\"panelFilterClear()\">{{ 'filterPanel.reset' | locale }}</button>\r\n                    <button class=\"btn btn-link btn-empty\" (click)=\"panelFilterempty()\">{{ 'filterPanel.empty' | locale }}</button>\r\n                </div>\r\n                <div class=\"filter-panel-btns\">\r\n                    <button class=\"btn btn-secondary\" (click)=\"panelFilterCancel($event)\">{{ 'filterPanel.cancel' | locale }}</button>\r\n                    <button class=\"filter-panel-submit btn btn-primary\" (click)=\"panelFilterSubmit()\" [disabled]=\"!canSubmit\">{{ 'filterPanel.confirm' | locale }}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",
                    encapsulation: ViewEncapsulation.None
                }] }
    ];
    /** @nocollapse */
    FilterPanelComponent.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: ElementRef },
        { type: QuerySolutionService }
    ]; };
    FilterPanelComponent.propDecorators = {
        option: [{ type: Input }],
        hide: [{ type: Input }],
        hidePanel: [{ type: Output }],
        submit: [{ type: Output }],
        filterSubmit: [{ type: Output }],
        clearFilter: [{ type: Output }],
        filterPanel: [{ type: ViewChild, args: ['filterPanel',] }],
        onMouseDown: [{ type: HostListener, args: ['mousedown', ['$event'],] }],
        onMouseMove: [{ type: HostListener, args: ['mousemove', ['$event'],] }]
    };
    return FilterPanelComponent;
}());
export { FilterPanelComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.el;
    /** @type {?} */
    FilterPanelComponent.prototype.option;
    /** @type {?} */
    FilterPanelComponent.prototype._hide;
    /** @type {?} */
    FilterPanelComponent.prototype.hidePanel;
    /** @type {?} */
    FilterPanelComponent.prototype.submit;
    /** @type {?} */
    FilterPanelComponent.prototype.filterSubmit;
    /** @type {?} */
    FilterPanelComponent.prototype.clearFilter;
    /** @type {?} */
    FilterPanelComponent.prototype.filterPanel;
    /** @type {?} */
    FilterPanelComponent.prototype.canSubmit;
    /** @type {?} */
    FilterPanelComponent.prototype.fiexedLeft;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.hasMove;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype._documentMouseUpEvent;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.filterConditionSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZmlsdGVyLXBhbmVsLyIsInNvdXJjZXMiOlsibGliL2ZpbHRlci1wYW5lbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUMxRCxVQUFVLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFFaEgsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDbkUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLFNBQVMsQ0FBQzs7QUFFbkM7SUEwQkksOEJBQW9CLFFBQW1CLEVBQVUsVUFBc0IsRUFBVSxrQkFBd0M7UUFBckcsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQXNCO1FBbEJ6SCxVQUFLLEdBQUcsS0FBSyxDQUFDO1FBUUosY0FBUyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDL0IsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDNUIsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2xDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUUzQyxjQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ2xCLGVBQVUsR0FBQyxJQUFJLENBQUM7O1FBRVIsWUFBTyxHQUFHLEtBQUssQ0FBQztRQUNoQiwwQkFBcUIsR0FBRyxJQUFJLENBQUM7UUFFakMsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQztJQUM1QyxDQUFDO0lBbkJELHNCQUNJLHNDQUFJOzs7O1FBR1I7WUFDSSxPQUFPLElBQUksQ0FBQyxLQUFL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LE1BQU07K0JBQ04sTUFBTTs4QkFDTixNQUFNOzhCQUNOLFNBQVMsU0FBQyxhQUFhOzhCQXVFdkIsWUFBWSxTQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQzs4QkFLcEMsWUFBWSxTQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQzs7SUEySHpDLDJCQUFDO0NBQUEsQUEzTkQsSUEyTkM7U0F0Tlksb0JBQW9COzs7Ozs7SUFDN0Isa0NBQXdCOztJQUN4QixzQ0FBbUM7O0lBQ25DLHFDQUFjOztJQVFkLHlDQUF5Qzs7SUFDekMsc0NBQXNDOztJQUN0Qyw0Q0FBNEM7O0lBQzVDLDJDQUEyQzs7SUFDM0MsMkNBQWtEOztJQUNsRCx5Q0FBa0I7O0lBQ2xCLDBDQUFnQjs7Ozs7SUFFaEIsdUNBQXdCOzs7OztJQUN4QixxREFBcUM7Ozs7O0lBQ3pCLHdDQUEyQjs7Ozs7SUFBRSwwQ0FBOEI7Ozs7O0lBQUUsa0RBQWdEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgUmVuZGVyZXIyLFxyXG4gICAgICAgIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb24sIEhvc3RMaXN0ZW5lciwgT25EZXN0cm95LCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZpbHRlclBhbmVsT3B0aW9uIH0gZnJvbSAnLi9maWx0ZXItcGFuZWwuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvblNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWZpbHRlci1jb25kaXRpb24nO1xyXG5pbXBvcnQgeyBkZWVwQ29weSB9IGZyb20gJy4vdXRpbHMnO1xyXG4vLyDnlKjkuo7mmL7npLrngrnlh7sg566A5Y2V562b6YCJIOmhueeahOS4i+aLiemdouadv1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLWZpbHRlci1wYW5lbCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZmlsdGVyLXBhbmVsLmNvbXBvbmVudC5odG1sJyxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcclxufSlcclxuZXhwb3J0IGNsYXNzIEZpbHRlclBhbmVsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQge1xyXG4gICAgcHJpdmF0ZSBlbDogSFRNTEVsZW1lbnQ7XHJcbiAgICBASW5wdXQoKSBvcHRpb246IEZpbHRlclBhbmVsT3B0aW9uO1xyXG4gICAgX2hpZGUgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgaGlkZSh2YWwpIHtcclxuICAgICAgICB0aGlzLl9oaWRlID0gdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IGhpZGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hpZGU7XHJcbiAgICB9XHJcbiAgICBAT3V0cHV0KCkgaGlkZVBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHN1Ym1pdCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBmaWx0ZXJTdWJtaXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgY2xlYXJGaWx0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAVmlld0NoaWxkKCdmaWx0ZXJQYW5lbCcpIGZpbHRlclBhbmVsOiBFbGVtZW50UmVmO1xyXG4gICAgY2FuU3VibWl0ID0gZmFsc2U7XHJcbiAgICBmaWV4ZWRMZWZ0PXRydWU7XHJcbiAgICAvLyDlhajlsYDmoIfor4bvvIzliJ3lp4vljJbmoIfor4blhYPntKDmsqHmnInlj5HnlJ9tb3VzZW1vdmVcclxuICAgIHByaXZhdGUgaGFzTW92ZSA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBfZG9jdW1lbnRNb3VzZVVwRXZlbnQgPSBudWxsO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLCBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgZmlsdGVyQ29uZGl0aW9uU2VyOiBRdWVyeVNvbHV0aW9uU2VydmljZSkge1xyXG4gICAgICAgIHRoaXMuZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICAgIH1cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2RvY3VtZW50TW91c2VVcEV2ZW50ID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oZG9jdW1lbnQsICdtb3VzZXVwJywgKGV2ZW50KSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJyNtYWluQ29udGFpbmVyVGFic2V0JykpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZVBhbmVsLmVtaXQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNNb3ZlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5mLWZpbHRlci1wYW5lbCcpXHJcbiAgICAgICAgICAgICAgICAmJiAhZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5tb2RhbCcpXHJcbiAgICAgICAgICAgICAgICAmJiAhZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5vdmVybGF5LWNvbnRhaW5lcicpICYmICFldmVudC50YXJnZXQuY2xvc2VzdCgnLm92ZXJsYXktcGFuZScpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmhpZGVQYW5lbC5lbWl0KGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5oYXNNb3ZlID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLml0ZW0gJiYgKHRoaXMub3B0aW9uLml0ZW0uY29udHJvbC5jb250cm9sdHlwZSA9PSAnZHJvcGRvd24nIHx8IHRoaXMub3B0aW9uLml0ZW0uY29udHJvbC5jb250cm9sdHlwZSA9PSAncmFkaW8nKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhblN1Ym1pdCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBjb25zdCBfcGFuZWw6IGFueSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmYtZmlsdGVyLXBhbmVsJyk7XHJcbiAgICAgICAgaWYgKF9wYW5lbCAmJiB0aGlzLm9wdGlvbi50YXJnZXQpIHtcclxuICAgICAgICAgICAgY29uc3QgaCA9IF9wYW5lbC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLm9wdGlvbi50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3dbJ2lubmVySGVpZ2h0J10gLSB0aGlzLm9wdGlvbi50b3AgPCBoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVjdC50b3AgPiBoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb24udG9wID0gcmVjdC50b3AgLSBoIC0gMTQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uLnRvcCA9IDMyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYXJyb3c6IGFueSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmYtZmlsdGVyLXBhbmVsLWFycm93Jyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJyb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcnJvdy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKF9wYW5lbCYmdGhpcy5vcHRpb24ucmlnaHQpe1xyXG4gICAgICAgICAgICBpZih0aGlzLm9wdGlvbi5sZWZ0K19wYW5lbC5vZmZzZXRXaWR0aD53aW5kb3dbJ2lubmVyV2lkdGgnXSl7XHJcbiAgICAgICAgICAgICAgICAvLyDotoXlh7rmmL7npLrlnKjlgZpcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlleGVkTGVmdD1mYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uLmxlZnQ9dGhpcy5vcHRpb24ucmlnaHQtX3BhbmVsLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlleGVkTGVmdD10cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudE1vdXNlVXBFdmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kb2N1bWVudE1vdXNlVXBFdmVudCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9kb2N1bWVudE1vdXNlVXBFdmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdtb3VzZWRvd24nLCBbJyRldmVudCddKVxyXG4gICAgb25Nb3VzZURvd24oJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5oYXNNb3ZlID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2Vtb3ZlJywgWyckZXZlbnQnXSlcclxuICAgIG9uTW91c2VNb3ZlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuaGFzTW92ZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG9uU2VhcmNoKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLml0ZW0uY29udHJvbC5jb250cm9sdHlwZSA9PSAncmFkaW8nKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFuZWxGaWx0ZXJTdWJtaXQoKTtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT0gJ3RleHQnICYmICBldmVudFsndHlwZSddICYmIGV2ZW50Wyd0eXBlJ10gPT09ICdlbnRlcicpe1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsRmlsdGVyU3VibWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMuZmlsdGVySXRlbSA9IGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHBhbmVsRmlsdGVyQ2FuY2VsKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuaGlkZVBhbmVsLmVtaXQoJGV2ZW50KTtcclxuICAgIH1cclxuICAgIHBhbmVsRmlsdGVyU3VibWl0KGNsZWFyOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIWNsZWFyICYmICF0aGlzLmNhblN1Ym1pdCkge3JldHVybjsgfVxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICBjb25zdCBmYXJyaXNTZWFyY2hSZWNvcmQgPSB0aGlzLm9wdGlvbi5pdGVtLnZhbHVlVGV4dDtcclxuICAgICAgICAgICAgbGV0IGZhcnJpc1NlYXJjaFJlY29yZEFycmF5ID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JhZ2VsYWJlbENvZGUgPSB0aGlzLm9wdGlvbi5pdGVtLmxhYmVsQ29kZTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlclBhbmVsQXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMub3B0aW9uLmxvY2FsU3RvcmFnZUtleSkpO1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXJQYW5lbEFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyUGFuZWxBcnJheSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFmaWx0ZXJQYW5lbEFycmF5IHx8ICFmaWx0ZXJQYW5lbEFycmF5W3N0b3JhZ2VsYWJlbENvZGVdIHx8ICFmaWx0ZXJQYW5lbEFycmF5W3N0b3JhZ2VsYWJlbENvZGVdLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgICAgICYmIGZhcnJpc1NlYXJjaFJlY29yZCAmJiBmYXJyaXNTZWFyY2hSZWNvcmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBmYXJyaXNTZWFyY2hSZWNvcmRBcnJheS5wdXNoKGZhcnJpc1NlYXJjaFJlY29yZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmYXJyaXNTZWFyY2hSZWNvcmRBcnJheSA9IGZpbHRlclBhbmVsQXJyYXlbc3RvcmFnZWxhYmVsQ29kZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGZpbHRlclBhbmVsQXJyYXlbc3RvcmFnZWxhYmVsQ29kZV0uaW5kZXhPZihmYXJyaXNTZWFyY2hSZWNvcmQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCAmJiBmYXJyaXNTZWFyY2hSZWNvcmQgJiYgZmFycmlzU2VhcmNoUmVjb3JkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhcnJpc1NlYXJjaFJlY29yZEFycmF5LnVuc2hpZnQoZmFycmlzU2VhcmNoUmVjb3JkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZhcnJpc1NlYXJjaFJlY29yZEFycmF5ID0gZmFycmlzU2VhcmNoUmVjb3JkQXJyYXkuc2xpY2UoMCwgNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbHRlclBhbmVsQXJyYXkgPT0gbnVsbCkgeyBmaWx0ZXJQYW5lbEFycmF5ID0ge307IH1cclxuICAgICAgICAgICAgZmlsdGVyUGFuZWxBcnJheVtzdG9yYWdlbGFiZWxDb2RlXSA9IGZhcnJpc1NlYXJjaFJlY29yZEFycmF5O1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm9wdGlvbi5sb2NhbFN0b3JhZ2VLZXksIEpTT04uc3RyaW5naWZ5KGZpbHRlclBhbmVsQXJyYXkpKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjb25kaXRpb25zID0gdGhpcy5maWx0ZXJDb25kaXRpb25TZXIuc2V0RmlsdGVyQ29uZGl0aW9ucyh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgICAgICBpZiAoIWNsZWFyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyU3VibWl0LmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5vcHRpb24uaXRlbSxcclxuICAgICAgICAgICAgICAgIGZpbHRlcjogY29uZGl0aW9uc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdWJtaXQuZW1pdCh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBwYW5lbEZpbHRlckNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMucGFuZWxGaWx0ZXJlbXB0eSgpO1xyXG4gICAgICAgIHRoaXMucGFuZWxGaWx0ZXJTdWJtaXQodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5jbGVhckZpbHRlci5lbWl0KHRoaXMub3B0aW9uLml0ZW0pO1xyXG4gICAgfVxyXG4gICAgcGFuZWxGaWx0ZXJlbXB0eSgpIHtcclxuICAgICAgICB0aGlzLmZpbHRlckNsZWFyVmFsdWUodGhpcy5vcHRpb24uaXRlbSk7XHJcbiAgICAgICAgdGhpcy5vcHRpb24uaXRlbS52YWx1ZVRleHQgPSAnJztcclxuICAgICAgICB0aGlzLm9wdGlvbi5pdGVtLmZpbGxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3B0aW9uLml0ZW0gPSBkZWVwQ29weSh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgICAgICB0aGlzLmNhblN1Ym1pdCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbHRlckNsZWFyVmFsdWUoaXRlbSkge1xyXG4gICAgICAgIHN3aXRjaCAoaXRlbS5jb250cm9sLmNvbnRyb2x0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgICAgICBjYXNlICdzZWFyY2gnOlxyXG4gICAgICAgICAgICBjYXNlICdzaW5nbGVEYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAneWVhcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ21vbnRoJzpcclxuICAgICAgICAgICAgY2FzZSAnZHJvcGRvd24nOlxyXG4gICAgICAgICAgICBjYXNlICdzaW5nbGVudW1iZXInOlxyXG4gICAgICAgICAgICBjYXNlICdyYWRpbyc6XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLnZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICBjYXNlICdtb250aFJhbmdlJzpcclxuICAgICAgICAgICAgY2FzZSAneWVhclJhbmdlJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRUaW1lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuZW5kVGltZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLmVuZFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdoZWxwJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWVGaWVsZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLnRleHRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2hlY2tib3hncm91cCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2Jvb2wtY2hlY2snOlxyXG4gICAgICAgICAgICAgICAgaXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2lucHV0LWdyb3VwJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudGV4dFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudGV4dEZpZWxkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ZsZXhpYmxlTnVtYmVyJzpcclxuICAgICAgICAgICAgY2FzZSAnZmxleGlibGVEYXRlJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLmVuZFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgaXRlbS52YWx1ZS52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TdWJtaXRDaGFuZ2UoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNhblN1Ym1pdCA9IGV2ZW50O1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=