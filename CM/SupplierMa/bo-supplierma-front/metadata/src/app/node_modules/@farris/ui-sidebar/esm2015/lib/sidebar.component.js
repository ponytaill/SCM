/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ContentChild, EventEmitter, Output, Renderer2, ElementRef, ViewChild } from '@angular/core';
import { FarrisSidebarIconDirective } from './directive/sidebar-icon.directive';
import { FarrisSidebarService } from './sidebar.service';
import { FarrisSidebarTitleDirective } from './directive/sidebar-title.directive';
import { FarrisSidebarHeaderDirective } from './directive/sidebar-header.directive';
import { FarrisSidebarHcontentDirective } from './directive/sidebar-hcontent.directive';
import { FarrisSidebarToolbarDirective } from './directive/sidebar-toolbar.directive';
import { FarrisSidebarContentDirective } from './directive/sidebar-content.directive';
import { FarrisSidebarFooterDirective } from './directive/sidebar-footer.directive';
export class FarrisSidebarComponent {
    /**
     * @param {?} sidebarService
     * @param {?} renderer
     * @param {?} elementRef
     */
    constructor(sidebarService, renderer, elementRef) {
        this.sidebarService = sidebarService;
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.showClose = false;
        this.showHeader = true;
        this.showEntry = true;
        this.title = "";
        this.showFooter = false;
        this._width = '350px';
        this.height = '100%';
        /* 侧边栏显示 */
        this.isOpen = false;
        /* 侧边栏显示位置 */
        this.showPos = 'right';
        this.enableScroll = true;
        /* 点击遮罩是否关闭侧边栏 */
        this.maskClosable = true;
        /* 是否显示遮罩 */
        this.maskable = true;
        //展开效果
        // @Input() openWay = 'float'
        //是否可拖拽，有点问题（然后没这个特性）
        this.resizeable = false;
        this.changeState = new EventEmitter();
        this.canRemoveInitNoAnimateCls = true;
        this.sidebarService.getIsOpen().subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data === false) {
                this.closeSideBar();
            }
            else {
                this.openSideBar();
            }
        }));
        this.el = this.elementRef.nativeElement;
    }
    /* 侧边栏大小 */
    /**
     * @return {?}
     */
    get width() {
        return this._width;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set width(value) {
        this._width = this._resolveSize(value);
    }
    ;
    /**
     * @return {?}
     */
    ngOnInit() {
        // const mainEl = this.el.querySelector('.f-sidebar-main');
        // this.renderer.setStyle(mainEl, 'width', this._width);
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        this.entryTemplate = this.entryDirective && this.entryDirective.templateRef;
        this.parentEl = this.el.parentElement;
        this.renderer.addClass(this.parentEl, 'f-sidebar-parent');
        if (this.parentCls) {
            this.renderer.addClass(this.parentEl, this.parentCls);
        }
    }
    /*宽高类型是 string或者number 解析宽高  尺寸 */
    /**
     * @param {?} size
     * @return {?}
     */
    _resolveSize(size) {
        /** @type {?} */
        const regex = /px|em|rem|pt|%/;
        // 说明是字符串
        return regex.test(size) ? `${parseInt(size, 10)}${size.match(regex)[0]}` : `${size}px`;
    }
    /**
     * @return {?}
     */
    toggle() {
        this.isOpen = !this.isOpen;
        this.changeState.emit(this.isOpen);
        if (this.isOpen === true) {
            this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-collapse');
            this.renderer.addClass(this.parentEl, 'f-sidebar-parent-expand');
        }
        if (this.isOpen === false) {
            this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-expand');
            this.renderer.addClass(this.parentEl, 'f-sidebar-parent-collapse');
        }
        // const prevEl = this.el.previousElementSibling;
        // if(this.isOpen === true && this.openWay !== 'float'){
        //   this.renderer.setStyle(prevEl, `${this.showPos}`, this.width + 'px');
        //   this.renderer.addClass(this.parentEl, 'f-sidebar-parent-show');
        //   this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-collapse');
        //   this.maskable = false;
        // }
        // if(this.isOpen === false && this.openWay !== 'float'){
        //   this.renderer.addClass(this.parentEl, 'f-sidebar-parent');
        //   this.renderer.addClass(this.parentEl, 'f-sidebar-parent-collapse');
        //   this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-show');
        //   this.renderer.setStyle(prevEl, `${this.showPos}`, 0);
        // }   
        // if(this.isOpen === true && this.openWay !== 'fold'){
        //   this.maskable = true;
        // }
    }
    /**
     * @return {?}
     */
    closeSideBar() {
        this.removeNoneAnimateCls();
        if (this.beforeClose) {
            this.beforeClose().subscribe((/**
             * @param {?} isOpen
             * @return {?}
             */
            (isOpen) => {
                this.isOpen = !isOpen;
            }));
        }
        else {
            this.isOpen = false;
        }
        this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-expand');
        this.renderer.addClass(this.parentEl, 'f-sidebar-parent-collapse');
    }
    /**
     * @return {?}
     */
    closeSideBarByMask() {
        if (!this.maskClosable) {
            return;
        }
        this.closeSideBar();
    }
    /**
     * @return {?}
     */
    openSideBar() {
        this.removeNoneAnimateCls();
        this.isOpen = true;
        this.renderer.removeClass(this.parentEl, 'f-sidebar-parent-collapse');
        this.renderer.addClass(this.parentEl, 'f-sidebar-parent-expand');
    }
    /*侧边栏初始因为动画收起时，会被看到, 移除 */
    /**
     * @private
     * @return {?}
     */
    removeNoneAnimateCls() {
        if (!this.canRemoveInitNoAnimateCls) {
            return;
        }
        if (this.sidebarMainEl) {
            this.renderer.removeClass(this.sidebarMainEl.nativeElement, 'f-sidebar-slideinit');
            this.canRemoveInitNoAnimateCls = false;
        }
    }
}
FarrisSidebarComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-sidebar',
                template: `
  <div class="f-cmp-sidebar f-sidebar-slide" [class.f-sidebar-pos-left]="showPos === 'left'"
  [class.f-sidebar-pos-right]="showPos === 'right'"
  [ngClass]="{'f-sidebar-show': isOpen, 'f-sidebar-collapse': !isOpen }">
    <div class="f-sidebar-main f-sidebar-slideinit" [ngClass]="mainCls" #sidebarMain [ngStyle]="{width:width}">
      <div class="f-sidebar-header" *ngIf="showHeader" [ngClass]="headerDirective && headerDirective.headerCls">
        <ng-template [ngTemplateOutlet]="headerDirective.templateRef" *ngIf="headerDirective && headerDirective.templateRef"></ng-template>
        <ng-template [ngIf]="!headerDirective">
          <div class="f-title f-tmpl-for-title-withline" [ngClass]="headerTitleDirective && headerTitleDirective.titleCls">
            <ng-template [ngTemplateOutlet]="headerTitleDirective.templateRef" *ngIf="headerTitleDirective && headerTitleDirective.templateRef"></ng-template>
            <ng-template [ngIf]="!headerTitleDirective">
              <h5 class="f-title-text">{{title ?title: ('sidebar.sidebar'|locale)}}</h5>
            </ng-template>
          </div>
          <div class="f-content" *ngIf="headerContentDirective && headerContentDirective.templateRef" [ngClass]="headerContentDirective && headerContentDirective.hcontentCls">
            <ng-template [ngTemplateOutlet]="headerContentDirective.templateRef"></ng-template>
          </div>
          <div class="f-toolbar" [ngClass]="headerToolbarDirective && headerToolbarDirective.toolbarCls">
            <ng-template [ngTemplateOutlet]="headerToolbarDirective.templateRef" *ngIf="headerToolbarDirective && headerToolbarDirective.templateRef"></ng-template>
            <ng-template [ngIf]="!headerToolbarDirective||showClose">
              <span class="f-icon f-sidebar-close" (click)="closeSideBar()"></span>
            </ng-template>
          </div>
        </ng-template>
      </div>
      <div class="f-sidebar-content" [ngClass]="contentDirective && contentDirective.contentCls" *ngIf="contentDirective && contentDirective.templateRef">
        <ng-template [ngTemplateOutlet]="contentDirective.templateRef"></ng-template>
      </div>
      <div class="f-sidebar-footer"  *ngIf="showFooter" [ngClass]="footerDirective && footerDirective.footerCls">
        <ng-template [ngTemplateOutlet]="footerDirective.templateRef" *ngIf="footerDirective && footerDirective.templateRef"></ng-template>
      </div>
    </div>
    <div class="f-sidebar-entry-ctr" [ngClass]="entryDirective && entryDirective.iconCls" (click)="openSideBar()" *ngIf="showEntry">
      <ng-template [ngTemplateOutlet]="entryTemplate" *ngIf="entryTemplate"></ng-template>
      <div class="f-sidebar-entry-icon" *ngIf="!entryTemplate">
        <span class="f-icon f-sidebar-entry"></span>
      </div>
    </div>
  </div>
  <div class="f-sidebar-overlay f-sidebar-collapse" [class.d-none]="!maskable" [ngClass]="{ 'f-sidebar-show': isOpen, 'f-sidebar-collapse': !isOpen }" (click)="closeSideBarByMask()">
  </div>
  `,
                providers: [],
                styles: [":host .f-sidebar-slideinit{-webkit-transition:none!important;transition:none!important}"]
            }] }
];
/** @nocollapse */
FarrisSidebarComponent.ctorParameters = () => [
    { type: FarrisSidebarService },
    { type: Renderer2 },
    { type: ElementRef }
];
FarrisSidebarComponent.propDecorators = {
    showClose: [{ type: Input }],
    showHeader: [{ type: Input }],
    showEntry: [{ type: Input }],
    title: [{ type: Input }],
    showFooter: [{ type: Input }],
    mainCls: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    isOpen: [{ type: Input }],
    showPos: [{ type: Input }],
    enableScroll: [{ type: Input }],
    maskClosable: [{ type: Input }],
    maskable: [{ type: Input }],
    beforeClose: [{ type: Input }],
    parentCls: [{ type: Input }],
    resizeable: [{ type: Input }],
    entryDirective: [{ type: ContentChild, args: [FarrisSidebarIconDirective,] }],
    headerDirective: [{ type: ContentChild, args: [FarrisSidebarHeaderDirective,] }],
    headerTitleDirective: [{ type: ContentChild, args: [FarrisSidebarTitleDirective,] }],
    headerContentDirective: [{ type: ContentChild, args: [FarrisSidebarHcontentDirective,] }],
    headerToolbarDirective: [{ type: ContentChild, args: [FarrisSidebarToolbarDirective,] }],
    contentDirective: [{ type: ContentChild, args: [FarrisSidebarContentDirective,] }],
    footerDirective: [{ type: ContentChild, args: [FarrisSidebarFooterDirective,] }],
    sidebarMainEl: [{ type: ViewChild, args: ['sidebarMain',] }],
    changeState: [{ type: Output }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.parentEl;
    /** @type {?} */
    FarrisSidebarComponent.prototype.showClose;
    /** @type {?} */
    FarrisSidebarComponent.prototype.showHeader;
    /** @type {?} */
    FarrisSidebarComponent.prototype.showEntry;
    /** @type {?} */
    FarrisSidebarComponent.prototype.title;
    /** @type {?} */
    FarrisSidebarComponent.prototype.showFooter;
    /** @type {?} */
    FarrisSidebarComponent.prototype.mainCls;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype._width;
    /** @type {?} */
    FarrisSidebarComponent.prototype.height;
    /** @type {?} */
    FarrisSidebarComponent.prototype.isOpen;
    /** @type {?} */
    FarrisSidebarComponent.prototype.showPos;
    /** @type {?} */
    FarrisSidebarComponent.prototype.enableScroll;
    /** @type {?} */
    FarrisSidebarComponent.prototype.maskClosable;
    /** @type {?} */
    FarrisSidebarComponent.prototype.maskable;
    /** @type {?} */
    FarrisSidebarComponent.prototype.beforeClose;
    /** @type {?} */
    FarrisSidebarComponent.prototype.parentCls;
    /** @type {?} */
    FarrisSidebarComponent.prototype.resizeable;
    /** @type {?} */
    FarrisSidebarComponent.prototype.entryTemplate;
    /** @type {?} */
    FarrisSidebarComponent.prototype.entryDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.headerDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.headerTitleDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.headerContentDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.headerToolbarDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.contentDirective;
    /** @type {?} */
    FarrisSidebarComponent.prototype.footerDirective;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.sidebarMainEl;
    /** @type {?} */
    FarrisSidebarComponent.prototype.changeState;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.canRemoveInitNoAnimateCls;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.sidebarService;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FarrisSidebarComponent.prototype.elementRef;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lkZWJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNpZGViYXIvIiwic291cmNlcyI6WyJsaWIvc2lkZWJhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQW1DLFNBQVMsRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFFMUwsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sb0NBQW9DLENBQUE7QUFDL0UsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDekQsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDbEYsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDcEYsT0FBTyxFQUFFLDhCQUE4QixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDeEYsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDdEYsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDdEYsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFpRHBGLE1BQU0sT0FBTyxzQkFBc0I7Ozs7OztJQWtFakMsWUFDVSxjQUFvQyxFQUNwQyxRQUFtQixFQUNuQixVQUFzQjtRQUZ0QixtQkFBYyxHQUFkLGNBQWMsQ0FBc0I7UUFDcEMsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUNuQixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBakV2QixjQUFTLEdBQVksS0FBSyxDQUFDO1FBQzNCLGVBQVUsR0FBWSxJQUFJLENBQUM7UUFDM0IsY0FBUyxHQUFHLElBQUksQ0FBQztRQUNqQixVQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ1gsZUFBVSxHQUFZLEtBQUssQ0FB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QUN6QyxTQUFTLFNBQUMsYUFBYTswQkFFdkIsTUFBTTs7Ozs7OztJQTVEUCxvQ0FBd0I7Ozs7O0lBQ3hCLDBDQUE4Qjs7SUFDOUIsMkNBQW9DOztJQUNwQyw0Q0FBb0M7O0lBQ3BDLDJDQUEwQjs7SUFDMUIsdUNBQW9COztJQUNwQiw0Q0FBcUM7O0lBRXJDLHlDQUF5Qjs7Ozs7SUFDekIsd0NBQXlCOztJQVV6Qix3Q0FBeUI7O0lBR3pCLHdDQUF3Qjs7SUFHeEIseUNBQTBCOztJQUMxQiw4Q0FBNkI7O0lBRzdCLDhDQUE2Qjs7SUFHN0IsMENBQXlCOztJQUV6Qiw2Q0FBZ0Q7O0lBRWhELDJDQUEyQjs7SUFLM0IsNENBQXFDOztJQUVyQywrQ0FBbUI7O0lBRW5CLGdEQUE4RDs7SUFFOUQsaURBQWlFOztJQUVqRSxzREFBcUU7O0lBRXJFLHdEQUEwRTs7SUFFMUUsd0RBQXlFOztJQUV6RSxrREFBbUU7O0lBRW5FLGlEQUFpRTs7Ozs7SUFDakUsK0NBQTREOztJQUU1RCw2Q0FBbUU7Ozs7O0lBQ25FLDJEQUF5Qzs7Ozs7SUFJdkMsZ0RBQTRDOzs7OztJQUM1QywwQ0FBMkI7Ozs7O0lBQzNCLDRDQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgQ29udGVudENoaWxkLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgUmVuZGVyZXIyLCBFbGVtZW50UmVmLCBBZnRlckNvbnRlbnRJbml0LCBBZnRlclZpZXdJbml0LCBWaWV3Q2hpbGQsIFNpbXBsZUNoYW5nZXMsIE9uQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEZhcnJpc1NpZGViYXJJY29uRGlyZWN0aXZlIH0gZnJvbSAnLi9kaXJlY3RpdmUvc2lkZWJhci1pY29uLmRpcmVjdGl2ZSdcclxuaW1wb3J0IHsgRmFycmlzU2lkZWJhclNlcnZpY2UgfSBmcm9tICcuL3NpZGViYXIuc2VydmljZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NpZGViYXJUaXRsZURpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NpZGViYXItdGl0bGUuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2lkZWJhckhlYWRlckRpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NpZGViYXItaGVhZGVyLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NpZGViYXJIY29udGVudERpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NpZGViYXItaGNvbnRlbnQuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2lkZWJhclRvb2xiYXJEaXJlY3RpdmUgfSBmcm9tICcuL2RpcmVjdGl2ZS9zaWRlYmFyLXRvb2xiYXIuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2lkZWJhckNvbnRlbnREaXJlY3RpdmUgfSBmcm9tICcuL2RpcmVjdGl2ZS9zaWRlYmFyLWNvbnRlbnQuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2lkZWJhckZvb3RlckRpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NpZGViYXItZm9vdGVyLmRpcmVjdGl2ZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhcnJpcy1zaWRlYmFyJyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gIDxkaXYgY2xhc3M9XCJmLWNtcC1zaWRlYmFyIGYtc2lkZWJhci1zbGlkZVwiIFtjbGFzcy5mLXNpZGViYXItcG9zLWxlZnRdPVwic2hvd1BvcyA9PT0gJ2xlZnQnXCJcclxuICBbY2xhc3MuZi1zaWRlYmFyLXBvcy1yaWdodF09XCJzaG93UG9zID09PSAncmlnaHQnXCJcclxuICBbbmdDbGFzc109XCJ7J2Ytc2lkZWJhci1zaG93JzogaXNPcGVuLCAnZi1zaWRlYmFyLWNvbGxhcHNlJzogIWlzT3BlbiB9XCI+XHJcbiAgICA8ZGl2IGNsYXNzPVwiZi1zaWRlYmFyLW1haW4gZi1zaWRlYmFyLXNsaWRlaW5pdFwiIFtuZ0NsYXNzXT1cIm1haW5DbHNcIiAjc2lkZWJhck1haW4gW25nU3R5bGVdPVwie3dpZHRoOndpZHRofVwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiZi1zaWRlYmFyLWhlYWRlclwiICpuZ0lmPVwic2hvd0hlYWRlclwiIFtuZ0NsYXNzXT1cImhlYWRlckRpcmVjdGl2ZSAmJiBoZWFkZXJEaXJlY3RpdmUuaGVhZGVyQ2xzXCI+XHJcbiAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImhlYWRlckRpcmVjdGl2ZS50ZW1wbGF0ZVJlZlwiICpuZ0lmPVwiaGVhZGVyRGlyZWN0aXZlICYmIGhlYWRlckRpcmVjdGl2ZS50ZW1wbGF0ZVJlZlwiPjwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIiFoZWFkZXJEaXJlY3RpdmVcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJmLXRpdGxlIGYtdG1wbC1mb3ItdGl0bGUtd2l0aGxpbmVcIiBbbmdDbGFzc109XCJoZWFkZXJUaXRsZURpcmVjdGl2ZSAmJiBoZWFkZXJUaXRsZURpcmVjdGl2ZS50aXRsZUNsc1wiPlxyXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nVGVtcGxhdGVPdXRsZXRdPVwiaGVhZGVyVGl0bGVEaXJlY3RpdmUudGVtcGxhdGVSZWZcIiAqbmdJZj1cImhlYWRlclRpdGxlRGlyZWN0aXZlICYmIGhlYWRlclRpdGxlRGlyZWN0aXZlLnRlbXBsYXRlUmVmXCI+PC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIiFoZWFkZXJUaXRsZURpcmVjdGl2ZVwiPlxyXG4gICAgICAgICAgICAgIDxoNSBjbGFzcz1cImYtdGl0bGUtdGV4dFwiPnt7dGl0bGUgP3RpdGxlOiAoJ3NpZGViYXIuc2lkZWJhcid8bG9jYWxlKX19PC9oNT5cclxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImYtY29udGVudFwiICpuZ0lmPVwiaGVhZGVyQ29udGVudERpcmVjdGl2ZSAmJiBoZWFkZXJDb250ZW50RGlyZWN0aXZlLnRlbXBsYXRlUmVmXCIgW25nQ2xhc3NdPVwiaGVhZGVyQ29udGVudERpcmVjdGl2ZSAmJiBoZWFkZXJDb250ZW50RGlyZWN0aXZlLmhjb250ZW50Q2xzXCI+XHJcbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdUZW1wbGF0ZU91dGxldF09XCJoZWFkZXJDb250ZW50RGlyZWN0aXZlLnRlbXBsYXRlUmVmXCI+PC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImYtdG9vbGJhclwiIFtuZ0NsYXNzXT1cImhlYWRlclRvb2xiYXJEaXJlY3RpdmUgJiYgaGVhZGVyVG9vbGJhckRpcmVjdGl2ZS50b29sYmFyQ2xzXCI+XHJcbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdUZW1wbGF0ZU91dGxldF09XCJoZWFkZXJUb29sYmFyRGlyZWN0aXZlLnRlbXBsYXRlUmVmXCIgKm5nSWY9XCJoZWFkZXJUb29sYmFyRGlyZWN0aXZlICYmIGhlYWRlclRvb2xiYXJEaXJlY3RpdmUudGVtcGxhdGVSZWZcIj48L25nLXRlbXBsYXRlPlxyXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIWhlYWRlclRvb2xiYXJEaXJlY3RpdmV8fHNob3dDbG9zZVwiPlxyXG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIGYtc2lkZWJhci1jbG9zZVwiIChjbGljayk9XCJjbG9zZVNpZGVCYXIoKVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiZi1zaWRlYmFyLWNvbnRlbnRcIiBbbmdDbGFzc109XCJjb250ZW50RGlyZWN0aXZlICYmIGNvbnRlbnREaXJlY3RpdmUuY29udGVudENsc1wiICpuZ0lmPVwiY29udGVudERpcmVjdGl2ZSAmJiBjb250ZW50RGlyZWN0aXZlLnRlbXBsYXRlUmVmXCI+XHJcbiAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImNvbnRlbnREaXJlY3RpdmUudGVtcGxhdGVSZWZcIj48L25nLXRlbXBsYXRlPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzcz1cImYtc2lkZWJhci1mb290ZXJcIiAgKm5nSWY9XCJzaG93Rm9vdGVyXCIgW25nQ2xhc3NdPVwiZm9vdGVyRGlyZWN0aXZlICYmIGZvb3RlckRpcmVjdGl2ZS5mb290ZXJDbHNcIj5cclxuICAgICAgICA8bmctdGVtcGxhdGUgW25nVGVtcGxhdGVPdXRsZXRdPVwiZm9vdGVyRGlyZWN0aXZlLnRlbXBsYXRlUmVmXCIgKm5nSWY9XCJmb290ZXJEaXJlY3RpdmUgJiYgZm9vdGVyRGlyZWN0aXZlLnRlbXBsYXRlUmVmXCI+PC9uZy10ZW1wbGF0ZT5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJmLXNpZGViYXItZW50cnktY3RyXCIgW25nQ2xhc3NdPVwiZW50cnlEaXJlY3RpdmUgJiYgZW50cnlEaXJlY3RpdmUuaWNvbkNsc1wiIChjbGljayk9XCJvcGVuU2lkZUJhcigpXCIgKm5nSWY9XCJzaG93RW50cnlcIj5cclxuICAgICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImVudHJ5VGVtcGxhdGVcIiAqbmdJZj1cImVudHJ5VGVtcGxhdGVcIj48L25nLXRlbXBsYXRlPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiZi1zaWRlYmFyLWVudHJ5LWljb25cIiAqbmdJZj1cIiFlbnRyeVRlbXBsYXRlXCI+XHJcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmLWljb24gZi1zaWRlYmFyLWVudHJ5XCI+PC9zcGFuPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIDwvZGl2PlxyXG4gIDxkaXYgY2xhc3M9XCJmLXNpZGViYXItb3ZlcmxheSBmLXNpZGViYXItY29sbGFwc2VcIiBbY2xhc3MuZC1ub25lXT1cIiFtYXNrYWJsZVwiIFtuZ0NsYXNzXT1cInsgJ2Ytc2lkZWJhci1zaG93JzogaXNPcGVuLCAnZi1zaWRlYmFyLWNvbGxhcHNlJzogIWlzT3BlbiB9XCIgKGNsaWNrKT1cImNsb3NlU2lkZUJhckJ5TWFzaygpXCI+XHJcbiAgPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZVVybHM6IFsnLi9zaWRlYmFyLmNvbXBvbmVudC5jc3MnXSxcclxuICBwcm92aWRlcnM6IFtdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGYXJyaXNTaWRlYmFyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlckNvbnRlbnRJbml0IHtcclxuXHJcbiAgcHJpdmF0ZSBlbDogSFRNTEVsZW1lbnQ7XHJcbiAgcHJpdmF0ZSBwYXJlbnRFbDogSFRNTEVsZW1lbnQ7XHJcbiAgQElucHV0KCkgc2hvd0Nsb3NlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgc2hvd0hlYWRlcjogYm9vbGVhbiA9IHRydWU7XHJcbiAgQElucHV0KCkgc2hvd0VudHJ5ID0gdHJ1ZTtcclxuICBASW5wdXQoKSB0aXRsZSA9IFwiXCI7XHJcbiAgQElucHV0KCkgc2hvd0Zvb3RlcjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIC8v5L6n6L655qCP5pSv5oyBY2xhc3PmoLflvI/mianlsZVcclxuICBASW5wdXQoKSBtYWluQ2xzOiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBfd2lkdGggPSAnMzUwcHgnO1xyXG4gIC8qIOS+p+i+ueagj+Wkp+WwjyAqL1xyXG4gIEBJbnB1dCgpXHJcbiAgZ2V0IHdpZHRoKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xyXG4gIH1cclxuICBzZXQgd2lkdGgodmFsdWUpIHtcclxuICAgIHRoaXMuX3dpZHRoID0gdGhpcy5fcmVzb2x2ZVNpemUodmFsdWUpO1xyXG4gIH07XHJcblxyXG4gIEBJbnB1dCgpIGhlaWdodCA9ICcxMDAlJztcclxuXHJcbiAgLyog5L6n6L655qCP5pi+56S6ICovXHJcbiAgQElucHV0KCkgaXNPcGVuID0gZmFsc2U7XHJcblxyXG4gIC8qIOS+p+i+ueagj+aYvuekuuS9jee9riAqL1xyXG4gIEBJbnB1dCgpIHNob3dQb3MgPSAncmlnaHQnXHJcbiAgQElucHV0KCkgZW5hYmxlU2Nyb2xsID0gdHJ1ZTtcclxuXHJcbiAgLyog54K55Ye76YGu572p5piv5ZCm5YWz6Zet5L6n6L655qCPICovXHJcbiAgQElucHV0KCkgbWFza0Nsb3NhYmxlID0gdHJ1ZTtcclxuXHJcbiAgLyog5piv5ZCm5pi+56S66YGu572pICovXHJcbiAgQElucHV0KCkgbWFza2FibGUgPSB0cnVlO1xyXG5cclxuICBASW5wdXQoKSBiZWZvcmVDbG9zZTogKCkgPT4gT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuXHJcbiAgQElucHV0KCkgcGFyZW50Q2xzOiBzdHJpbmc7XHJcblxyXG4gIC8v5bGV5byA5pWI5p6cXHJcbiAgLy8gQElucHV0KCkgb3BlbldheSA9ICdmbG9hdCdcclxuICAvL+aYr+WQpuWPr+aLluaLve+8jOacieeCuemXrumimO+8iOeEtuWQjuayoei/meS4queJueaAp++8iVxyXG4gIEBJbnB1dCgpIHJlc2l6ZWFibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgZW50cnlUZW1wbGF0ZTogYW55O1xyXG4gIC8v5L6n6L655qCP5YWl5Y+j5Yy65Z+f5pSv5oyB6Ieq5a6a5LmJXHJcbiAgQENvbnRlbnRDaGlsZChGYXJyaXNTaWRlYmFySWNvbkRpcmVjdGl2ZSkgZW50cnlEaXJlY3RpdmU6IGFueTtcclxuICAvL+S+p+i+ueagj2hlYWRlcuWMuuWfn+aUr+aMgeiHquWumuS5iVxyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2lkZWJhckhlYWRlckRpcmVjdGl2ZSkgaGVhZGVyRGlyZWN0aXZlOiBhbnk7XHJcbiAgLy/kvqfovrnmoI9oZWFkZXLmoIfpopjljLrln5/mlK/mjIHoh6rlrprkuYlcclxuICBAQ29udGVudENoaWxkKEZhcnJpc1NpZGViYXJUaXRsZURpcmVjdGl2ZSkgaGVhZGVyVGl0bGVEaXJlY3RpdmU6IGFueTtcclxuICAvL+S+p+i+ueagj2hlYWRlcuS4remXtOWMuuWfn+aUr+aMgeiHquWumuS5iVxyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2lkZWJhckhjb250ZW50RGlyZWN0aXZlKSBoZWFkZXJDb250ZW50RGlyZWN0aXZlOiBhbnk7XHJcbiAgLy/kvqfovrnmoI9oZWFkZXLlt6XlhbfmoI/ljLrln5/mlK/mjIHoh6rlrprkuYlcclxuICBAQ29udGVudENoaWxkKEZhcnJpc1NpZGViYXJUb29sYmFyRGlyZWN0aXZlKSBoZWFkZXJUb29sYmFyRGlyZWN0aXZlOiBhbnk7XHJcbiAgLy8g5L6n6L655qCPY29udGVudOaUr+aMgeiHquWumuS5iVxyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2lkZWJhckNvbnRlbnREaXJlY3RpdmUpIGNvbnRlbnREaXJlY3RpdmU6IGFueTtcclxuICAvLyDkvqfovrnmoI9mb290ZXLmlK/mjIHoh6rlrprkuYlcclxuICBAQ29udGVudENoaWxkKEZhcnJpc1NpZGViYXJGb290ZXJEaXJlY3RpdmUpIGZvb3RlckRpcmVjdGl2ZTogYW55O1xyXG4gIEBWaWV3Q2hpbGQoJ3NpZGViYXJNYWluJykgcHJpdmF0ZSBzaWRlYmFyTWFpbkVsOiBFbGVtZW50UmVmO1xyXG5cclxuICBAT3V0cHV0KCkgY2hhbmdlU3RhdGU6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgcHJpdmF0ZSBjYW5SZW1vdmVJbml0Tm9BbmltYXRlQ2xzID0gdHJ1ZTtcclxuXHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBzaWRlYmFyU2VydmljZTogRmFycmlzU2lkZWJhclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWZcclxuICApIHtcclxuICAgIHRoaXMuc2lkZWJhclNlcnZpY2UuZ2V0SXNPcGVuKCkuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICBpZiAoZGF0YSA9PT0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmNsb3NlU2lkZUJhcigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMub3BlblNpZGVCYXIoKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIHRoaXMuZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgLy8gY29uc3QgbWFpbkVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuZi1zaWRlYmFyLW1haW4nKTtcclxuICAgIC8vIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUobWFpbkVsLCAnd2lkdGgnLCB0aGlzLl93aWR0aCk7XHJcbiAgfVxyXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcclxuICAgIHRoaXMuZW50cnlUZW1wbGF0ZSA9IHRoaXMuZW50cnlEaXJlY3RpdmUgJiYgdGhpcy5lbnRyeURpcmVjdGl2ZS50ZW1wbGF0ZVJlZjtcclxuICAgIHRoaXMucGFyZW50RWwgPSB0aGlzLmVsLnBhcmVudEVsZW1lbnQ7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMucGFyZW50RWwsICdmLXNpZGViYXItcGFyZW50Jyk7XHJcbiAgICBpZiAodGhpcy5wYXJlbnRDbHMpIHtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnBhcmVudEVsLCB0aGlzLnBhcmVudENscyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKuWuvemrmOexu+Wei+aYryBzdHJpbmfmiJbogIVudW1iZXIg6Kej5p6Q5a696auYICDlsLrlr7ggKi9cclxuICBfcmVzb2x2ZVNpemUoc2l6ZSkge1xyXG4gICAgY29uc3QgcmVnZXggPSAvcHh8ZW18cmVtfHB0fCUvO1xyXG4gICAgLy8g6K+05piO5piv5a2X56ym5LiyXHJcbiAgICByZXR1cm4gcmVnZXgudGVzdChzaXplKSA/IGAke3BhcnNlSW50KHNpemUsIDEwKX0ke3NpemUubWF0Y2gocmVnZXgpWzBdfWAgOiBgJHtzaXplfXB4YDtcclxuICB9XHJcblxyXG4gIHRvZ2dsZSgpIHtcclxuICAgIHRoaXMuaXNPcGVuID0gIXRoaXMuaXNPcGVuO1xyXG4gICAgdGhpcy5jaGFuZ2VTdGF0ZS5lbWl0KHRoaXMuaXNPcGVuKTtcclxuICAgIGlmICh0aGlzLmlzT3BlbiA9PT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMucGFyZW50RWwsICdmLXNpZGViYXItcGFyZW50LWNvbGxhcHNlJyk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQtZXhwYW5kJyk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5pc09wZW4gPT09IGZhbHNlKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQtZXhwYW5kJyk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQtY29sbGFwc2UnKTtcclxuICAgIH1cclxuICAgIC8vIGNvbnN0IHByZXZFbCA9IHRoaXMuZWwucHJldmlvdXNFbGVtZW50U2libGluZztcclxuXHJcbiAgICAvLyBpZih0aGlzLmlzT3BlbiA9PT0gdHJ1ZSAmJiB0aGlzLm9wZW5XYXkgIT09ICdmbG9hdCcpe1xyXG4gICAgLy8gICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHByZXZFbCwgYCR7dGhpcy5zaG93UG9zfWAsIHRoaXMud2lkdGggKyAncHgnKTtcclxuICAgIC8vICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnBhcmVudEVsLCAnZi1zaWRlYmFyLXBhcmVudC1zaG93Jyk7XHJcbiAgICAvLyAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQtY29sbGFwc2UnKTtcclxuICAgIC8vICAgdGhpcy5tYXNrYWJsZSA9IGZhbHNlO1xyXG4gICAgLy8gfVxyXG4gICAgLy8gaWYodGhpcy5pc09wZW4gPT09IGZhbHNlICYmIHRoaXMub3BlbldheSAhPT0gJ2Zsb2F0Jyl7XHJcbiAgICAvLyAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQnKTtcclxuICAgIC8vICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnBhcmVudEVsLCAnZi1zaWRlYmFyLXBhcmVudC1jb2xsYXBzZScpO1xyXG4gICAgLy8gICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMucGFyZW50RWwsICdmLXNpZGViYXItcGFyZW50LXNob3cnKTtcclxuICAgIC8vICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShwcmV2RWwsIGAke3RoaXMuc2hvd1Bvc31gLCAwKTtcclxuICAgIC8vIH0gICBcclxuICAgIC8vIGlmKHRoaXMuaXNPcGVuID09PSB0cnVlICYmIHRoaXMub3BlbldheSAhPT0gJ2ZvbGQnKXtcclxuICAgIC8vICAgdGhpcy5tYXNrYWJsZSA9IHRydWU7XHJcbiAgICAvLyB9XHJcbiAgfVxyXG5cclxuICBjbG9zZVNpZGVCYXIoKSB7XHJcbiAgICB0aGlzLnJlbW92ZU5vbmVBbmltYXRlQ2xzKCk7XHJcbiAgICBpZiAodGhpcy5iZWZvcmVDbG9zZSkge1xyXG4gICAgICB0aGlzLmJlZm9yZUNsb3NlKCkuc3Vic2NyaWJlKChpc09wZW46IGJvb2xlYW4pID0+IHtcclxuICAgICAgICB0aGlzLmlzT3BlbiA9ICFpc09wZW47XHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLnBhcmVudEVsLCAnZi1zaWRlYmFyLXBhcmVudC1leHBhbmQnKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5wYXJlbnRFbCwgJ2Ytc2lkZWJhci1wYXJlbnQtY29sbGFwc2UnKTtcclxuICB9XHJcblxyXG4gIGNsb3NlU2lkZUJhckJ5TWFzaygpIHtcclxuICAgIGlmICghdGhpcy5tYXNrQ2xvc2FibGUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jbG9zZVNpZGVCYXIoKTtcclxuICB9XHJcblxyXG4gIG9wZW5TaWRlQmFyKCkge1xyXG4gICAgdGhpcy5yZW1vdmVOb25lQW5pbWF0ZUNscygpO1xyXG4gICAgdGhpcy5pc09wZW4gPSB0cnVlO1xyXG4gICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLnBhcmVudEVsLCAnZi1zaWRlYmFyLXBhcmVudC1jb2xsYXBzZScpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnBhcmVudEVsLCAnZi1zaWRlYmFyLXBhcmVudC1leHBhbmQnKTtcclxuICB9XHJcbiAgLyrkvqfovrnmoI/liJ3lp4vlm6DkuLrliqjnlLvmlLbotbfml7bvvIzkvJrooqvnnIvliLAsIOenu+mZpCAqL1xyXG4gIHByaXZhdGUgcmVtb3ZlTm9uZUFuaW1hdGVDbHMoKSB7XHJcbiAgICBpZiAoIXRoaXMuY2FuUmVtb3ZlSW5pdE5vQW5pbWF0ZUNscykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5zaWRlYmFyTWFpbkVsKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5zaWRlYmFyTWFpbkVsLm5hdGl2ZUVsZW1lbnQsICdmLXNpZGViYXItc2xpZGVpbml0Jyk7XHJcbiAgICAgIHRoaXMuY2FuUmVtb3ZlSW5pdE5vQW5pbWF0ZUNscyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuIl19