{"version":3,"file":"farris-ui-lookup.js.map","sources":["ng://@farris/ui-lookup/lib/lookup-displaytype.ts","ng://@farris/ui-lookup/lib/lookup.component.ts","ng://@farris/ui-lookup/lib/lookup-grid-options.ts","ng://@farris/ui-lookup/lib/http/ILookupHttpService.ts","ng://@farris/ui-lookup/lib/lookup-defaut-mapping.ts","ng://@farris/ui-lookup/lib/utils.ts","ng://@farris/ui-lookup/lib/lookup-presonalConfig.service.ts","ng://@farris/ui-lookup/lib/services/util.service.ts","ng://@farris/ui-lookup/lib/services/treenode.helper.ts","ng://@farris/ui-lookup/lib/services/favorite-helper.ts","ng://@farris/ui-lookup/lib/services/selection-manager.ts","ng://@farris/ui-lookup/lib/services/bind-datatable-event.ts","ng://@farris/ui-lookup/lib/services/on-text-change.ts","ng://@farris/ui-lookup/lib/services/bind-treetable-event.ts","ng://@farris/ui-lookup/lib/services/multi-selection.manager.ts","ng://@farris/ui-lookup/lib/services/http-manager.ts","ng://@farris/ui-lookup/lib/lookup-left.component.ts","ng://@farris/ui-lookup/lib/services/lookup-component.manager.ts","ng://@farris/ui-lookup/lib/services/dialog-mangager.ts","ng://@farris/ui-lookup/lib/services/lookup-selection.service.ts","ng://@farris/ui-lookup/lib/lookup-grid.component.ts","ng://@farris/ui-lookup/lib/lookup-tabs.component.ts","ng://@farris/ui-lookup/lib/lookup-tip.directive.ts","ng://@farris/ui-lookup/lib/quick-select/quick-select-panel.component.ts","ng://@farris/ui-lookup/lib/quick-select/lookup-quick-select.directive.ts","ng://@farris/ui-lookup/lib/lookup.module.ts"],"sourcesContent":["import { TemplateRef } from \"@angular/core\";\r\n\r\n/** æ¶èåå­æ®µåç§° */\r\nexport const FAVORITE_FIELD_NAME = '__favorite__';\r\nexport const INPUT_GROUP_ICON = '<i class=\"f-icon f-icon-lookup\"></i>';\r\n\r\n// è·åç»ä»¶å®ä¾çç±»å\r\nexport type ComponentInstanceType = 'datatable'| 'treetable' | 'fav' | 'selected' | 'leftTree' | 'leftDataTable';\r\n\r\nexport enum LookupGridDisplayType {\r\n    List = 'LIST',\r\n    TreeList = 'TREELIST',\r\n    NavList = 'NAVLIST',\r\n    NavTreeList = 'NAVTREELIST'\r\n}\r\n\r\n/** æ¶èç¸å³å¾æ  */\r\nexport enum FavoriteIcon {\r\n    /** å·²æ¶è */\r\n    yes = '<span class=\"f-icon f-icon-star f-lookup-favorite\" style=\"line-height: 29px;\"></span>',\r\n    /** æªæ¶è */\r\n    no = '<span class=\"f-icon f-icon-star-outline f-lookup-favorite\" style=\"line-height: 29px;\"></span>',\r\n    /** ç§»é¤æ¶è */\r\n    delete = '<span class=\"f-icon f-icon-apply-format f-lookup-unfavorite\" style=\"line-height: 29px;\"></span>',\r\n    /** ç§»é¤å·²éè®°å½ */\r\n    remove = '<span class=\"f-icon f-icon-apply-format f-lookup-unfavorite\" style=\"line-height: 29px;\"></span>'\r\n}\r\n\r\n/** æ¶èç¸å³å¨ä½ */\r\nexport enum FavoriteAction {\r\n    /** æ·»å æ¶è */\r\n    add = 'append item to favorite.',\r\n    /** ç§»é¤æ¶è */\r\n    delete = 'remove favorite.'\r\n}\r\n\r\nexport interface ExtInfoFormatterParam {\r\n    [key: string]: any;\r\n    bindingData?: any;\r\n    instance?: any;\r\n}\r\n\r\nexport type ExtInfoFormatterFn = (param: ExtInfoFormatterParam) => string;\r\nexport type ExtInfoFormatter = string | ExtInfoFormatterFn;\r\n\r\nexport interface CustomDataFormatter {\r\n    [fieldName: string]: any ;\r\n    rowStyler?: any;\r\n    cellStyler?: any;\r\n}\r\n\r\nexport interface QuickSelectOption {\r\n    /** æ¯å¦å¯ç¨ */\r\n    enable?: boolean;\r\n    /** æ¾ç¤ºtop è®°å½æ°ï¼é»è®¤ 10 */\r\n    showItemsCount?: number;\r\n    /** æ¾ç¤ºææ¬å­æ®µ */\r\n    textField?: string;\r\n    /** èªå®ä¹æ ¼å¼å */\r\n    formatter?: (data: any) => string;\r\n    \r\n    footerHeight?: number;\r\n    /** æ¾ç¤ºæç´¢æ´æ° æé® */\r\n    showMore?: boolean;\r\n}\r\n\r\nexport const QuickSelectDefaultOptions: QuickSelectOption = {\r\n    enable: false,\r\n    showMore: true,\r\n    showItemsCount: 10,\r\n    footerHeight: 0\r\n}","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-08-15 15:24:24\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-11-30 14:01:34\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { Subscription, Observable, of, Subject } from 'rxjs';\r\nimport {\r\n    Component, Input, Output, EventEmitter, TemplateRef,\r\n    ViewChild, Injector, forwardRef, OnInit, ElementRef, ChangeDetectorRef,\r\n    AfterViewChecked, HostBinding, NgZone, OnDestroy\r\n} from '@angular/core';\r\nimport {\r\n    NG_VALUE_ACCESSOR,\r\n    ControlValueAccessor,\r\n    NgControl\r\n} from '@angular/forms';\r\n\r\nimport { DialogComponent } from '@farris/ui-dialog';\r\nimport { IResizeEvent } from '@farris/ui-draggable';\r\n\r\nimport { PickingResult, PickedResult } from './lookup-grid-options';\r\n\r\nexport const LOOKUPINPUT_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => LookupComponent),\r\n    multi: true\r\n};\r\n\r\n@Component({\r\n    selector: 'farris-lookup',\r\n    template: `\r\n        <div\r\n            class=\"lookupbox input-group\"\r\n            [ngClass]=\"{\r\n                'f-state-disabled': disabled,\r\n                'f-state-readonly': readonly,\r\n                'f-state-editable': !editable\r\n            }\"\r\n        >\r\n            <input\r\n                class=\"form-control\"\r\n                [value]=\"displayText\"\r\n                [disabled]=\"disabled\"\r\n                [readonly]=\"!editable || readonly\"\r\n            />\r\n            <div class=\"input-group-append\">\r\n                <span class=\"f-select input-group-text\" (click)=\"showDialog()\">\r\n                    <i class=\"f-icon f-icon-lookup\"></i>\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <farris-dialog\r\n            #dialog\r\n            *ngIf=\"isShow\"\r\n            [title]=\"title\"\r\n            [beforeOpen]=\"beforeOpen\"\r\n            [beforeClose]=\"beforeClose\"\r\n            [width]=\"dialogWidth\"\r\n            [height]=\"dialogHeight\"\r\n            [showButtons]=\"showButtons\"\r\n            [showMaxButton]=\"showMaxButton\"\r\n            [buttons]=\"buttonsRef || defaultButtonRef\"\r\n            [buttonAlign]=\"buttonAlign\"\r\n            (maxed)=\"onMaxDialog($event)\"\r\n            (resized)=\"onResized($event)\"\r\n            (resizing)=\"onResizing($event)\"\r\n        >\r\n            <ng-content></ng-content>\r\n\r\n            <ng-template #defaultButtonRef>\r\n                <div style=\"width: 100%;\">\r\n                    <button\r\n                        class=\"btn btn-secondary btn-lg\"\r\n                        (click)=\"closeDialog()\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button class=\"btn btn-primary btn-lg\">Ok</button>\r\n                </div>\r\n            </ng-template>\r\n        </farris-dialog>\r\n    `,\r\n    styles: [\r\n        `\r\n            .input-group {\r\n                flex-wrap: nowrap;\r\n            }\r\n            :host-context(.ng-invalid) .form-control {\r\n                border-color: #ff0303;\r\n            }\r\n        `\r\n    ],\r\n    providers: [LOOKUPINPUT_VALUE_ACCESSOR]\r\n})\r\nexport class LookupComponent\r\n    implements OnInit, ControlValueAccessor, AfterViewChecked, OnDestroy {\r\n    @HostBinding('class') hostCls = 'f-cmp-inputgroup';\r\n\r\n    /** çªå£å®½åº¦ */\r\n    @Input() dialogWidth: number;\r\n    /** çªå£é«åº¦ */\r\n    @Input() dialogHeight: number;\r\n    /** çªå£æ é¢ãé»è®¤å¼ï¼æ­¤å¤æ¾ç¤ºå¸®å©æ é¢ */\r\n    @Input() title = '';\r\n    /** æé®å¯¹é½æ¹å¼ */\r\n    @Input() buttonAlign = 'right';\r\n    /** æé®æ¨¡æ¿ */\r\n    @Input() buttonsRef: TemplateRef<any>;\r\n    /** æ¯å¦æ¾ç¤ºæé® */\r\n    @Input() showButtons = true;\r\n    /** æ¾ç¤ºå³é­æé® */\r\n    @Input() showCloseButton = true;\r\n    /** æ¾ç¤ºæå¤§åæé® */\r\n    @Input() showMaxButton = true;\r\n    /** åè®¸ææ½å°ºå¯¸ */\r\n    @Input() resizable = true;\r\n    /** åè®¸æå¨çªå£ */\r\n    @Input() draggable = true;\r\n    /** ç¦ç¨ */\r\n    @Input() disabled = false;\r\n    /** åè®¸ç¼è¾ææ¬æ¡ */\r\n    @Input() editable = true;\r\n    /** åªè¯» */\r\n    @Input() readonly = false;\r\n    /** å­æ®µæ å°, { å¸®å©æ°æ®å­æ®µï¼è¡¨åå­æ®µ } */\r\n    @Input() mapFields: { [sourceField: string]: string };\r\n    /** å¼å­æ®µ */\r\n    @Input() valueField: string;\r\n    /** ææ¬å­æ®µ */\r\n    @Input() textField: string;\r\n    @Input() displayText = '';\r\n\r\n    /** è¿è¡æ¶ä¸ä¸æèªå®ä¹å¯¹è±¡ */\r\n    @Input() context: any;\r\n\r\n    /** çªå£æå¼åäºä»¶ */\r\n    @Input() beforeOpen: () => Observable<boolean>;\r\n    /** çªå£å³é­åäºä»¶ */\r\n    @Input() beforeClose: () => Observable<boolean>;\r\n    /** å¸®å©åäºä»¶ */\r\n    @Input() dictPicking: (emptyObj?: {}) => Observable<PickingResult>;\r\n    dictPickingSubscription: Subscription;\r\n    /** å¸®å©åäºä»¶ */\r\n    @Input() dictPicked: (rowData: any) => Observable<PickedResult>;\r\n    dictPickedSubscription: Subscription;\r\n\r\n    /** çªå£æå¼å */\r\n    @Output() dialogOpened = new EventEmitter();\r\n    /** çªå£å³é­å */\r\n    @Output() dialogClosed = new EventEmitter();\r\n    /** çªå£æå¤§å */\r\n    @Output() dialogMaxed = new EventEmitter();\r\n    /** ææ½æ¹åçªå£å°ºå¯¸è¿è¡æ¶ */\r\n    @Output() resizing = new EventEmitter();\r\n    /** ææ½æ¹åçªå£å°ºå¯¸ç»æ */\r\n    @Output() resized = new EventEmitter();\r\n    /** å¸®å©çªå£é»è®¤å°ºå¯¸ */\r\n    private defaultDialogSize = { width: 550, height: 570 };\r\n\r\n    dialogCreated = new Subject<DialogComponent>();\r\n    dialogCreatedSubscription: Subscription;\r\n    dialog: DialogComponent;\r\n    @ViewChild('dialog') set content(content: DialogComponent) {\r\n        this.dialog = content;\r\n        if (content) {\r\n            this.dialogCreated.next(this.dialog);\r\n        }\r\n    }\r\n\r\n    private _isShow = false;\r\n    get isShow() {\r\n        return this._isShow;\r\n    }\r\n    set isShow(val) {\r\n        this._isShow = val;\r\n        if (!this.changeDetector['destroyed']) {\r\n            this.changeDetector.detectChanges();\r\n        }\r\n    }\r\n\r\n    ngControl: any;\r\n\r\n    displayValue = '';\r\n    originalText = '';\r\n\r\n    get invalid() {\r\n        return this.ngControl.valid;\r\n    }\r\n\r\n    private ngZone: NgZone;\r\n\r\n    onModelChange = (obj: any) => { };\r\n    onModelTouched = (val: any) => { };\r\n    constructor(\r\n        public injector: Injector,\r\n        public el: ElementRef,\r\n        public changeDetector?: ChangeDetectorRef\r\n    ) {\r\n        this.ngZone = this.injector.get(NgZone);\r\n        // if (!this.personalConfigService) {\r\n        //     const idServ = this.injector.get(IdService);\r\n        //     this.personalConfigService = new PersonalConfigService(idServ);\r\n        // }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.initEvents();\r\n        this.ngControl = this.injector.get(NgControl, null);\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.lookupUnsubscribe();\r\n    }\r\n\r\n    ngAfterViewChecked() {\r\n        if (this.dialog) {\r\n            this.dialog.closed.subscribe(() => {\r\n                this.isShow = false;\r\n                this.dialog = null;\r\n            });\r\n        }\r\n    }\r\n\r\n    initEvents() {\r\n        if (!this.dictPicking) {\r\n            this.dictPicking = () => of({ showDialog: true });\r\n        }\r\n        if (!this.dictPicked) {\r\n            this.dictPicked = () => of({ closeDialog: true });\r\n        }\r\n        if (!this.beforeOpen) {\r\n            this.beforeOpen = () => of(true);\r\n        }\r\n        if (!this.beforeClose) {\r\n            this.beforeClose = () => of(true);\r\n        }\r\n\r\n        if (!this.dialogHeight) {\r\n            this.dialogHeight = this.defaultDialogSize.height;\r\n        }\r\n\r\n        if (!this.dialogWidth) {\r\n            this.dialogWidth = this.defaultDialogSize.width;\r\n        }\r\n    }\r\n\r\n    showDialog(): any {\r\n        if (this.disabled || this.readonly) {\r\n            return false;\r\n        }\r\n        this.dictPicking().subscribe((val: PickingResult) => {\r\n            if (val.showDialog === false) {\r\n                return;\r\n            }\r\n\r\n            this.isShow = true;\r\n            // this.changeDetector.detectChanges();\r\n            this.ngZone.runOutsideAngular(() => {\r\n                setTimeout(() => this.dialog.show());\r\n            });\r\n        });\r\n\r\n        return false;\r\n    }\r\n\r\n    closeDialog() {\r\n        this.isShow = false;\r\n        if (this.dialog) {\r\n            this.dialog.close();\r\n        }\r\n    }\r\n\r\n\r\n    private lookupUnsubscribe() {\r\n        if (this.dictPickedSubscription) {\r\n            this.dictPickedSubscription.unsubscribe();\r\n        }\r\n        if (this.dictPickingSubscription) {\r\n            this.dictPickingSubscription.unsubscribe();\r\n        }\r\n        if (this.dialogCreatedSubscription) {\r\n            this.dialogCreatedSubscription.unsubscribe();\r\n        }\r\n    }\r\n\r\n    onResizing(pos: IResizeEvent) {\r\n        this.resizing.emit(pos.size);\r\n    }\r\n    onResized(pos: IResizeEvent) {\r\n        this.resized.emit(pos.size);\r\n    }\r\n    onMaxDialog(pos: IResizeEvent) {\r\n        this.dialogMaxed.emit(pos.size);\r\n    }\r\n\r\n    writeValue(obj: any): void {\r\n        if (obj) {\r\n            this.displayText = obj;\r\n            this.displayValue = obj;\r\n            this.originalText = this.displayText;\r\n        } else {\r\n            this.displayText = '';\r\n            this.displayValue = '';\r\n            this.originalText = '';\r\n        }\r\n    }\r\n    registerOnChange(fn: any): void {\r\n        this.onModelChange = fn;\r\n    }\r\n    registerOnTouched(fn: any): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n    setDisabledState?(isDisabled: boolean): void {\r\n        this.disabled = isDisabled;\r\n    }\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-07-10 11:44:49\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-25 18:10:54\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { DataColumn } from '@farris/ui-common/column';\r\n\r\nexport type ONLY_SELECT_LEAF = 'default' | 'yes' | 'no';\r\nexport type LOAD_DATA_TYPE = 'all' | 'fav' | 'list' | 'nav' | 'search' | 'children'\r\n                            | 'textchange' | 'sort' | 'navsearch' | 'selected' | 'allChildren';\r\n\r\nexport interface TreeInfo {\r\n    /** æ°æ®å è½½æ¹å¼ï¼ all, async */\r\n    loadDataType?: 'all' | 'async';\r\n    /** åå±æ¹å¼ï¼ pathcode, parentId */\r\n    layerType?: string;\r\n    /** æ°æ®ä¸­å¸¦æåçº§ä¿¡æ¯çå­æ®µ */\r\n    dataField?: string;\r\n    /** ç¶IDå­æ®µ */\r\n    parentField?: string;\r\n    /** åçº§ç å­æ®µ */\r\n    pathField?: string;\r\n    /** çº§æ°å­æ®µ */\r\n    layerField?: string;\r\n    /** æ¯å¦æç»å­æ®µ */\r\n    isDetailField?: string;\r\n    /**\r\n     * åªåè®¸éæ©å¶å­èç¹\r\n     * - default: åºç¨æå¡å¨ç«¯è®¾ç½®ï¼å¦æå¡å¨æªè®¾ç½®ï¼åè½å  `no`\r\n     * - `yes`: æå¡å¨ç«¯è®¾ç½®å¤±æãä»åè®¸éæ©å¶å­èç¹ã\r\n     * - `no`:  æå¡å¨ç«¯è®¾ç½®å¤±æãææèç¹åå¯éæ©ã\r\n     */\r\n    onlySelectLeaf?: boolean | ONLY_SELECT_LEAF;\r\n    /** æ ç»ææ°æ®æ¯å¦å·²åå§åå®æ */\r\n    treeDataIsInit?: boolean;\r\n}\r\n\r\nexport interface LookupGridResult {\r\n    /** åä¿¡æ¯ */\r\n    columns?: DataColumn[];\r\n    /** æ°æ®åè¡¨ */\r\n    items?: any[];\r\n    /** æ¥è¯¢å­æ®µ */\r\n    searchFields?: { label: string, value: string }[];\r\n    /** åé¡µä¿¡æ¯ */\r\n    pageInfo?: { pageIndex: number, pageSize: number, pageList?: number[], enablePager: boolean };\r\n    /** æ»è®°å½æ° */\r\n    total?: number;\r\n    /** åºå¼ */\r\n    mapFields?: { desgine: string, runtime: string }[];\r\n    /** æ åçº§ä¿¡æ¯ */\r\n    treeInfo?: TreeInfo;\r\n    displayType?: string;\r\n    displayInfo?: DisplayInfo;\r\n    title?: string;\r\n    navigation?: NavigationOptions;\r\n    valueField?: string;\r\n    textField?: string;\r\n    idField?: string;\r\n    /** å·²éæ©æ°æ®åè¡¨ */\r\n    selectedItems?: any;\r\n    /** æ¶èæ°æ® */\r\n    favoriteItems?: any[];\r\n}\r\n\r\n/** ä¸ªæ§åæ°æ® */\r\nexport interface PersonalConfig {\r\n    tabIndex?: string;\r\n    favorite?: {\r\n        [lang: string]: any[];\r\n    };\r\n    quickSelected?: {\r\n        [lang: string]: any[];\r\n    };\r\n    size?: any;\r\n    selections?: any;\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface NavigationOptions extends LookupGridResult {\r\n    [key: string]: any;\r\n    displayType: 'List' | 'TreeList';\r\n    width: number;\r\n    idField?: string;\r\n    relations?: { groupField: string, helpField: string }[];\r\n    hover?: boolean;\r\n}\r\n\r\nexport interface LookupGridOptions extends LookupGridResult {\r\n    singleSelect?: boolean;\r\n    idField?: string;\r\n    uri?: string; // å¯ä»¥ä¸ºåæ°æ®IDãwebapi å°å\r\n    showFilterBar?: boolean;\r\n    pagination?: boolean;\r\n    pageIndex?: number;\r\n    pageSize?: number;\r\n    pageList?: number[];\r\n    total?: number;\r\n    width?: number;\r\n    height?: number;\r\n    hover?: boolean;\r\n}\r\n\r\nexport class DisplayInfo {\r\n    title?: string;\r\n    favorites?: string;\r\n    okText?: string;\r\n    cancelText?: string;\r\n    allColumns?: string;\r\n}\r\n\r\nexport const lookupGridDefaults: LookupGridOptions = {\r\n    singleSelect: true,\r\n    showFilterBar: true,\r\n    pagination: true,\r\n    pageIndex: 1,\r\n    pageSize: 10,\r\n    pageList: [10, 20, 30, 50, 100]\r\n};\r\n\r\nexport const displayInfoDefault = {\r\n    title: 'æ­¤å¤æ¾ç¤ºæ é¢',\r\n    favorites: 'æ¶èå¤¹',\r\n    okText: 'ç¡®å®',\r\n    cancelText: 'åæ¶',\r\n    allColumns: 'ææå'\r\n};\r\n\r\n/** å¸®å©åäºä»¶è¿åç±»å */\r\nexport interface PickingResult {\r\n    /** true: ç»§ç»­æå¼å¸®å©ï¼false: ä¸æå¼å¸®å©çªå£ */\r\n    showDialog: boolean;\r\n    /** æºå¸¦çä¸äºèªå®ä¹æ°æ®ï¼ç±ä¸å¡å¨æå¡å¨ç«¯å¸®å©åäºä»¶ä¸­å¤ç */\r\n    data?: any;\r\n    message?: any;\r\n}\r\n\r\nexport interface PickedResult {\r\n    closeDialog: boolean;\r\n    message?: any;\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-05-23 10:27:07\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-08-15 14:11:43\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { InjectionToken } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { LOOKUP_HTTP_PARAMS } from './RemoteParams';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\n\r\nexport interface ILookupHttpService {\r\n    context?: any;\r\n    /**\r\n     * æ ¹æ®æå®çå¸®å©åæ°æ®IDåç¸å³åæ°è·åæ°æ®\r\n     * @param uri å¸®å©åæ°æ®ID or Rest API\r\n     * @param data æå¡å¨ç«¯æ¥æ¶åæ° key/value\r\n     */\r\n    getData(uri: string, params?: LOOKUP_HTTP_PARAMS): Observable<LookupGridResult>;\r\n}\r\nexport const ServerSideToken = new InjectionToken<ILookupHttpService>('Lookup Grid HTTP service');\r\n","import { Injectable } from '@angular/core';\r\nimport { trim } from 'lodash-es';\r\nimport { CommonUtils } from '@farris/ui-common';\r\n\r\n@Injectable()\r\nexport class LookupDefaultMapping {\r\n\r\n    constructor(private utils: CommonUtils) {}\r\n\r\n    lookupFieldMap = (helpData, mapFields, dataObj) => {\r\n        if (mapFields) {\r\n            const helpFields = Object.keys(mapFields);\r\n            helpFields.forEach( (f: any) => {\r\n                let val = '';\r\n                if (helpData) {\r\n                    if (helpData instanceof Array) {\r\n                        val = helpData.map( (h: any) => {\r\n                            return this.utils.getValue(f, h);\r\n                        }).join(',');\r\n                    } else {\r\n                        val = this.utils.getValue(f, helpData);\r\n                    }\r\n\r\n                }\r\n\r\n                mapFields[f].split(',').forEach( (ff: any) => {\r\n                    const field = trim(ff);\r\n                    this.utils.setValue(dataObj, field, val);\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n}\r\n","import { Injectable, NgZone } from '@angular/core';\r\nimport { CommonUtils, RuntimeStateService } from '@farris/ui-common';\r\nimport { FilterRelation, FilterCondition, Compare, EntityFilter } from '@farris/ui-common/types';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { TreeInfo } from './lookup-grid-options';\r\n\r\n@Injectable()\r\nexport class LookupUtils {\r\n\r\n    constructor(private utils: CommonUtils, private rts: RuntimeStateService, private ngZone: NgZone) { }\r\n\r\n    setActiveLookupInstance(lookupIns: any) {\r\n        if (this.rts) {\r\n            this.rts.setLookupInstance(lookupIns);\r\n        }\r\n    }\r\n\r\n\r\n    destroy() {\r\n        this.rts.destroy();\r\n    }\r\n\r\n    pendingStart() {\r\n        if (this.rts) {\r\n            this.rts.updateFormState({\r\n                lookup: {\r\n                    pending: true\r\n                }\r\n            });\r\n\r\n            // ç¦ç¨é¡µé¢çææé¼ æ äºä»¶\r\n            document.body.style['pointer-events'] = 'none';\r\n        }\r\n    }\r\n\r\n    pendingEnd() {\r\n        if (this.rts) {\r\n            this.rts.updateFormState({\r\n                lookup: {\r\n                    pending: false\r\n                }\r\n            });\r\n\r\n            // æ¿æ´»é¼ æ äºä»¶\r\n            document.body.style['pointer-events'] = '';\r\n        }\r\n    }\r\n\r\n\r\n    private createFilterCondition(field: string, value: string) {\r\n        return {\r\n            filterField: field,\r\n            value,\r\n            lbracket: '',\r\n            rbracket: '',\r\n            relation: FilterRelation.Or,\r\n            compare: Compare.Like\r\n        };\r\n    }\r\n\r\n    mergeCondition(condition: EntityFilter, fields: string[], searchData: { field: string, value: string }) {\r\n        if (!condition) {\r\n            condition = {\r\n                pagination: {\r\n                    pageIndex: 1,\r\n                    pageSize: 20\r\n                },\r\n                filterConditions: [],\r\n                sortConditions: []\r\n            };\r\n        } else {\r\n            condition = cloneDeep(condition);\r\n        }\r\n\r\n        const { field = '*', value = '' } = { ...searchData };\r\n\r\n        if (value) {\r\n            if (field === '*') {\r\n                if (fields && fields.length) {\r\n                    const searchConditions: FilterCondition[] = fields.map((f: string) => {\r\n                        return this.createFilterCondition(f, value);\r\n                    });\r\n\r\n                    if (searchConditions.length) {\r\n                        searchConditions[0].lbracket = '(';\r\n                        const lastSearchConditions = searchConditions[searchConditions.length - 1];\r\n                        lastSearchConditions.rbracket = ')';\r\n                        lastSearchConditions.relation = FilterRelation.Empty;\r\n                    }\r\n\r\n                    if (condition.filterConditions && condition.filterConditions.length) {\r\n                        condition.filterConditions[condition.filterConditions.length - 1].relation = FilterRelation.And;\r\n                        condition.filterConditions = condition.filterConditions.concat(searchConditions);\r\n                    } else {\r\n                        condition.filterConditions = searchConditions;\r\n                    }\r\n                }\r\n            } else {\r\n                const searchCondition = this.createFilterCondition(field, value);\r\n                searchCondition.relation = FilterRelation.Empty;\r\n                if (condition.filterConditions && condition.filterConditions.length) {\r\n                    condition.filterConditions[condition.filterConditions.length - 1].relation = FilterRelation.And;\r\n                    condition.filterConditions.push(searchCondition);\r\n                } else {\r\n                    condition.filterConditions = [searchCondition];\r\n                }\r\n            }\r\n        }\r\n\r\n        return condition;\r\n    }\r\n\r\n    private canSelectable(n: any) {\r\n        if (n.hasOwnProperty('farris_selectable')) {\r\n            return !!n['farris_selectable'];\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /** å°æ°æ®è½¬æ å½¢ç»æ */\r\n    makeTreeWithParentID(data: any[], parentId, parentIdField = 'parentId', idField = 'id') {\r\n        const nodes = new Map<string, any>();\r\n        const result = [];\r\n        const unattached = [];\r\n        data.forEach(t => {\r\n            const node = {\r\n                data: t,\r\n                children: [],\r\n                selectable: this.canSelectable(t),\r\n                parent: null,\r\n                parents: []\r\n            };\r\n            const id = t[idField];\r\n            nodes.set(id, node);\r\n            const PID = this.utils.getValue(parentIdField, t);\r\n            if (PID === parentId) {\r\n                result.push(node);\r\n            } else {\r\n                const parent = nodes.get(PID);\r\n                if (parent) {\r\n                    node.parent = PID;\r\n                    node.parents = [...parent.parents, PID];\r\n                    parent.children.push(node);\r\n                } else {\r\n                    unattached.push(node);\r\n                }\r\n            }\r\n        });\r\n\r\n        unattached.forEach(n => {\r\n            const pid = this.utils.getValue(parentIdField, n.data);\r\n            const parent = nodes.get(pid);\r\n            if (parent) {\r\n                n.parent = pid;\r\n                n.parents = [...parent.parents, pid];\r\n                parent.children.push(n);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    makeTree(data, treeInfo: TreeInfo) {\r\n        const treeInfoField = treeInfo.dataField;\r\n        const layerField = treeInfo.layerField;\r\n        const pathField = treeInfo.pathField;\r\n\r\n        const nodes = new Map<string, any>();\r\n        const result = [];\r\n        const unattached = [];\r\n        data.forEach(t => {\r\n            const node = {\r\n                data: t,\r\n                children: [],\r\n                selectable: this.canSelectable(t)\r\n            };\r\n            const pathCode = t[treeInfoField][pathField];\r\n            nodes.set(pathCode, node);\r\n\r\n            if (t[treeInfoField][layerField] === 1) {\r\n                result.push(node);\r\n            } else {\r\n                const parentPathCode = pathCode.substr(0, pathCode.length - 4);\r\n                const parent = nodes.get(parentPathCode);\r\n                if (parent) {\r\n                    parent.children.push(node);\r\n                } else {\r\n                    unattached.push(node);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        unattached.forEach(n => {\r\n            const pathCode = n.data[treeInfoField][pathField];\r\n            const parent = nodes.get(pathCode.substr(0, pathCode.length - 4));\r\n            if (parent) {\r\n                parent.children.push(n);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { IdService } from '@farris/ui-common';\r\nimport { Subject } from 'rxjs';\r\nimport { PersonalConfig } from './lookup-grid-options';\r\n\r\n\r\n@Injectable()\r\nexport class PersonalConfigService {\r\n    // ä¸ªæ§åéç½®\r\n    personalConf: PersonalConfig;\r\n\r\n    selectItemObser$ = new Subject();\r\n\r\n    displayType = 'LIST';\r\n\r\n    singleSelect = true;\r\n    idField: string;\r\n    textField: string;\r\n    mapFields: any;\r\n\r\n    // ä¸ªæ§åéç½®KEY\r\n    private _key = '';\r\n    _newKey = '';\r\n    get personalConfigKey() {\r\n        return this._key;\r\n    }\r\n    set personalConfigKey(val) {\r\n        if (val) {\r\n            this._key = this.buildKey(val);\r\n            if (this.controlID) {\r\n                this._newKey = this.buildKey(this.controlID + '_' + val);\r\n            } else {\r\n                this._newKey = this._key;\r\n            }\r\n        } else {\r\n            this._newKey = this.buildKey(this.controlID);\r\n        }\r\n    }\r\n\r\n    // ç»ä»¶ID\r\n    controlID = '';\r\n\r\n    constructor(private idService: IdService) {}\r\n\r\n    private buildKey(str) {\r\n        let prefix = '';\r\n        if (location.hash) {\r\n            const pathArr = location.hash.split('?');\r\n            prefix = pathArr ? pathArr[0] : '';\r\n        } else {\r\n            const pathArr  = location.pathname.split('/');\r\n            prefix = pathArr ? pathArr[pathArr.length - 1] : '';\r\n        }\r\n        return this.idService.encrypt(prefix + str);\r\n    }\r\n\r\n    initPersonalConf(obj) {\r\n        Object.assign(this, obj);\r\n    }\r\n\r\n    getPersonalData(key?: string): PersonalConfig {\r\n        if (key) {\r\n            this._key = key;\r\n        }\r\n\r\n        if (this.personalConfigKey) {\r\n            const conf = localStorage.getItem(this.personalConfigKey);\r\n\r\n            if (conf && conf !== 'undefined' && conf !== 'null') {\r\n                this.personalConf = conf ? JSON.parse(conf) : {};\r\n                this._updatePersonalConfig(this.personalConf);\r\n\r\n                if (this.controlID) {\r\n                    if (this._key !== this._newKey) {\r\n                        localStorage.removeItem(this._key);\r\n                    }\r\n                    this.savePersonalConfig(this.personalConf);\r\n                }\r\n\r\n                return this.personalConf;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getQuickSelected(localeId?: string): any {\r\n        const d = this.getPersonalData();\r\n        const qs =  d ? d.quickSelected : null;\r\n\r\n        if (localeId) {\r\n            if (qs) {\r\n                const items = qs[localeId];\r\n                if (items && items.length) {\r\n                    return items;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        return qs;\r\n    }\r\n\r\n    getDialogSize() {\r\n        const d = this.getPersonalData();\r\n        return d ? d.size : null;\r\n    }\r\n\r\n    updatePersonalConfig(cfg: Partial<PersonalConfig>) {\r\n        const data = Object.assign(this.personalConf || {}, cfg);\r\n        this.savePersonalConfig(data);\r\n    }\r\n\r\n    savePersonalConfig(data: PersonalConfig) {\r\n        if (this._newKey) {\r\n            localStorage.setItem(this._newKey, JSON.stringify(data));\r\n            this.personalConf = data;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    getActiveTabIndex(tabName?: string) {\r\n        const d = this.getPersonalData();\r\n        if (!tabName) {\r\n            return d && d.tabIndex ? d.tabIndex  : 'datalist';\r\n        }\r\n        return tabName;\r\n    }\r\n\r\n    updateQueckSelected(selectedRow: any, localeId: string) {\r\n        const quickItems = this.getQuickSelected(localeId);\r\n\r\n        if (quickItems && quickItems.length) {\r\n            const selectedIndex = [];\r\n            quickItems.forEach((element, index) => {\r\n                if (this.singleSelect) {\r\n                    if (element && selectedRow && element[this.idField] === selectedRow[this.idField]) {\r\n                        selectedIndex.push(index);\r\n                    }\r\n                } else {\r\n                    if (selectedRow) {\r\n                        selectedRow.forEach(item => {\r\n                            if (element && element[this.idField] === item[this.idField]) {\r\n                                selectedIndex.push(index);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            selectedIndex.forEach(index => {\r\n                quickItems[index] = null;\r\n            });\r\n\r\n            this.personalConf.quickSelected[localeId] =\r\n                this.personalConf.quickSelected[localeId].filter(v => v !== null);\r\n            if (this.singleSelect) {\r\n                this.personalConf.quickSelected[localeId].unshift(selectedRow);\r\n            } else {\r\n                if (selectedRow) {\r\n                    selectedRow.forEach(element => {\r\n                        this.personalConf.quickSelected[localeId].unshift(element);\r\n                    });\r\n                }\r\n            }\r\n            this.personalConf.quickSelected[localeId].length =\r\n                this.personalConf.quickSelected[localeId].length > 5 ?\r\n                    5 : this.personalConf.quickSelected[localeId].length;\r\n        } else {\r\n            const _qs = this.personalConf.quickSelected || {};\r\n            let newData;\r\n            if (this.singleSelect) {\r\n                newData = Object.assign(_qs, { [localeId]: [selectedRow] });\r\n            } else {\r\n                selectedRow.length = selectedRow.length > 5 ? 5 : selectedRow.length;\r\n                newData = Object.assign(_qs, { [localeId]: selectedRow });\r\n            }\r\n            this.personalConf.quickSelected = newData;\r\n        }\r\n\r\n        this.savePersonalConfig(this.personalConf);\r\n    }\r\n\r\n    /**\r\n     *  æ´æ°æ°æ®ç»æï¼ç°æä¸ªæ§åæ°æ®åè½¬ä¸º ä¸­æç¯å¢ä¸æ°æ®ï¼\r\n     */\r\n    _updatePersonalConfig(per: PersonalConfig) {\r\n        if (per) {\r\n            let flag = false;\r\n            // æ´æ°æ¶èæ°æ®\r\n            if (per.favorite && Array.isArray(per.favorite)) {\r\n                per.favorite = { 'zh-CHS': [...per.favorite] };\r\n                delete per.favorite;\r\n\r\n                flag = true;\r\n            }\r\n            // æ´æ°å¿«æ·å½å¥æ°æ®\r\n            if (per.selected) {\r\n                if (Array.isArray(per.selected)) {\r\n                    per.quickSelected = { 'zh-CHS': [...per.selected] };\r\n                }\r\n                delete per.selected;\r\n                flag = true;\r\n            }\r\n\r\n            if (flag) {\r\n                this.savePersonalConfig(per);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { TreeTableComponent, TreeNode } from '@farris/ui-treetable';\r\n\r\nexport class UtilService {\r\n\r\n    constructor(public instance: LookupGridComponent) { }\r\n\r\n\r\n}\r\n","import { TreeNode } from '@farris/ui-treetable';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { TreeInfo } from '../lookup-grid-options';\r\n\r\nexport class TreeNodeHelper {\r\n    treeInfo: TreeInfo;\r\n    flatAllNodes = [];\r\n    constructor(private instance: LookupGridComponent) { }\r\n\r\n    getTreeInfo(treeNode: TreeNode) {\r\n        if (treeNode.data[this.treeInfo.dataField]) {\r\n            return treeNode.data[this.treeInfo.dataField];\r\n        }\r\n\r\n        const data = treeNode.data;\r\n        if (data && this.treeInfo.dataField) {\r\n\r\n            const treeInfoDataField = this.treeInfo.dataField.toLowerCase();\r\n            const dataField = Object.keys(treeNode.data).find(n => {\r\n                return n.toLowerCase() === treeInfoDataField;\r\n            });\r\n            if (dataField) {\r\n                return data[dataField];\r\n            } else {\r\n                this.instance.writeConsole(`æªæ¾å°æ å½¢ä¿¡æ¯æ°æ®å­æ®µã${this.treeInfo.dataField}ã`, 'error');\r\n            }\r\n        } else {\r\n            this.instance.writeConsole(`æªæ¾å°æ å½¢ä¿¡æ¯æ°æ®å­æ®µã${this.treeInfo.dataField}ã`, 'error');\r\n        }\r\n    }\r\n\r\n    getTreeNodeLayer(treeNode: TreeNode) {\r\n        return this.getTreeInfo(treeNode)[this.treeInfo.layerField];\r\n    }\r\n    /** æ´æ°èç¹çå±å¼ç¶æã æ ¹æ®ç»ä»¶ä¸­ expandLevel çå¼å³å®\r\n     * -1ï¼ä¸å±å¼ï¼0ï¼å¨é¨å±å¼ï¼>0 å±å¼å°æå®çº§æ°\r\n     */\r\n    updateTreeNodeExpanded(treeNodes: TreeNode[], treeInfo: TreeInfo = null) {\r\n        if (treeInfo) {\r\n            this.treeInfo = treeInfo;\r\n        } else {\r\n            this.treeInfo = this.instance.treeInfo;\r\n        }\r\n        const expandLevel = this.instance.expandLevel;\r\n        if (expandLevel === -1) {\r\n            return;\r\n        }\r\n        if (!this.flatAllNodes.length) {\r\n            this.flatAllNodes = this.treeData2Flat(null, treeNodes, 0, []);\r\n        }\r\n\r\n        treeNodes.forEach((tn: TreeNode) => {\r\n            tn.expanded = this.shoudExpand(expandLevel, this.getTreeNodeLayer(tn));\r\n            if (this.isSelectNodeParent(tn)) {\r\n                tn.expanded = true;\r\n            }\r\n            if (tn.children && tn.children.length) {\r\n                this.updateTreeNodeExpanded(tn.children, treeInfo);\r\n            } else {\r\n                tn.leaf = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    private treeData2Flat(parent, nodes, level, parentIds) {\r\n        const idField = this.instance.idField;\r\n        let arr = [];\r\n        if (nodes && nodes.length) {\r\n\r\n            nodes.forEach((node, index) => {\r\n                // node.parent = parent;\r\n\r\n                let parents = [];\r\n                if (parent) {\r\n                    const parentID = parent.data[idField];\r\n                    const _parents = parentIds || [];\r\n                    parents = parents.concat(_parents.map(n => n));\r\n                    parents.push(parentID);\r\n                }\r\n                const rowNode = {\r\n                    id: node.data[idField],\r\n                    node,\r\n                    level,\r\n                    parents,\r\n                };\r\n                arr.push(rowNode);\r\n                arr = arr.concat(this.treeData2Flat(node, node.children, level + 1, parents));\r\n            });\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    private shoudExpand(expandLevel: number, nodeLayer: number) {\r\n        if (expandLevel === -1) {\r\n            // -1 ä¸ºä¸å±å¼\r\n            return false;\r\n        } else if (expandLevel === 0) {\r\n            // 0 ä¸ºå¨é¨å±å¼\r\n            return true;\r\n        } else {\r\n            // æ²¡æå¯ç¨åå±å è½½ï¼éè¿å±å¼å±çº§ç¡®å®æ¯å¦å±å¼è¯¥èç¹\r\n            return nodeLayer <= expandLevel;\r\n        }\r\n    }\r\n\r\n    private isSelectNodeParent(treeNode) {\r\n        if (this.instance.navSelectedIds) {\r\n            const allParentIds: string[] = this.flatAllNodes.find(f => f.id === this.instance.navSelectedIds).parents;\r\n            if (allParentIds && allParentIds.length) {\r\n                return allParentIds.includes(treeNode.id);\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getLeafNode(treeNode: TreeNode) {\r\n        if (treeNode && (!treeNode.children || !treeNode.children.length)) {\r\n            return treeNode;\r\n        } else {\r\n            if (treeNode.children.length === 1) {\r\n                return this.getLeafNode(treeNode.children[0]);\r\n            } else {\r\n                return treeNode.children;\r\n            }\r\n        }\r\n    }\r\n\r\n    flatTreeNodes(items, result = []) {\r\n        items = items || [];\r\n        return  items.reduce((c, n) => {\r\n            c.push(n);\r\n            if (n.children && n.children.length) {\r\n                this.flatTreeNodes(n.children, c);\r\n            }\r\n            return c;\r\n        }, result);\r\n    }\r\n}\r\n","import { ComponentRef } from '@angular/core';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { UserFavoriteData } from '../http/RemoteParams';\r\nimport { FavoriteAction, FavoriteIcon, FAVORITE_FIELD_NAME, LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\n\r\nexport class FavoriteHelper {\r\n\r\n    private lookupSelectionSer: LookupSelectionService;\r\n\r\n    constructor(private instance: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.instance.lookupSelectionSer;\r\n    }\r\n\r\n    getFavoriteColumns(): any[] {\r\n        const columns = this.instance.gridOptions.columns.map(item => {\r\n            const rtn = Object.assign({}, item);\r\n            if (item.field === FAVORITE_FIELD_NAME) {\r\n                rtn.formatter = () => FavoriteIcon.delete;\r\n            }\r\n            return rtn;\r\n        });\r\n        return columns;\r\n    }\r\n\r\n    favoriteColumnFormatter = (v: any, data: any  ) => {\r\n        const f =  v ? FavoriteIcon.yes : FavoriteIcon.no;\r\n        if (this.instance.isTree()) {\r\n            const id = data[this.instance.idField];\r\n            if (id) {\r\n                const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                const rn = tt.findRowNode(id);\r\n                if (rn) {\r\n                    if (rn.node.selectable) {\r\n                        return f;\r\n                    } else {\r\n                        return '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return f;\r\n    }\r\n\r\n    initPersonalInfo() {\r\n        if (this.instance.personalConfigService) {\r\n            const controlID = this.instance.el.nativeElement.id || this.instance.controlId;\r\n            if (!controlID) {\r\n                this.instance.writeConsole('LookupGrid - æªè®¾ç½®ç»ä»¶id, æ¶èåè½å°ä¸è½æ­£å¸¸ï¼è¯·è®¾ç½®ç»ä»¶id.');\r\n            }\r\n            const pcstr = this.getPersonalConfigKey(controlID);\r\n            this.instance.personalConfigService.controlID = controlID;\r\n            this.instance.personalConfigService.personalConfigKey = pcstr;\r\n\r\n            const conf = {\r\n                displayType: this.instance.displayType,\r\n                singleSelect: this.instance.singleSelect,\r\n                idField: this.instance.idField,\r\n                textField: this.instance.textField,\r\n                mapFields: Object.assign({}, this.instance.mapFields || {})\r\n            };\r\n\r\n            this.instance.personalConfigService.initPersonalConf(conf);\r\n\r\n            // ä¸ªæ§åéç½®çè®¢éäºä»¶å¤ç\r\n            this.listenPersonalConfigHandler();\r\n        }\r\n    }\r\n\r\n    private getPersonalConfigKey(controlID) {\r\n        // return this.instance.ngControl && this.instance.ngControl.name ? this.instance.ngControl.name : this.instance.mapFields\r\n        //     ? this.instance.mapFields[this.instance.textField]\r\n        //     : '';\r\n\r\n        if (this.instance.ngControl) {\r\n            if (this.instance.ngControl.name) {\r\n                return this.instance.ngControl.name;\r\n            } else {\r\n                if (this.instance.mapFields && this.instance.mapFields.length) {\r\n                    return Object.keys(this.instance.mapFields).map(k => {\r\n                        return this.instance.mapFields[k];\r\n                    }).join('_');\r\n                } else {\r\n                    return this.instance.textField;\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * çå¬æ¶èTABé¡µä¸­ç¸å³äºä»¶ï¼\r\n     * æ°æ®éä¸­ï¼åæ¶éä¸­ï¼ç§»é¤æ¶èï¼åå»äºä»¶\r\n     */\r\n    initFavoriteComponentEvent(cmpRef: ComponentRef<any>) {\r\n        switch (this.instance.displayType) {\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n            case LookupGridDisplayType.List: {\r\n                const fdt = cmpRef.instance as DataTableComponent;\r\n                fdt.remoteSort = false;\r\n                fdt.selectedRow.subscribe(e => {\r\n                    if (this.instance.singleSelect) {\r\n                        this.lookupSelectionSer.clearSelections();\r\n                    }\r\n                    this.lookupSelectionSer.updateSelections(e.data);\r\n                });\r\n                fdt.unSelectRow.subscribe(e => {\r\n                    this.lookupSelectionSer.unSelect(e.data[this.instance.idField]);\r\n                });\r\n\r\n                if (!fdt.singleSelect) {\r\n                    fdt.checkAll.subscribe(e => {\r\n                        this.lookupSelectionSer.updateSelections(fdt.data, e);\r\n                    });\r\n                }\r\n\r\n                fdt.cellClick.subscribe((e: any) => {\r\n                    if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                        e.event.stopPropagation();\r\n                        // tslint:disable-next-line: no-string-literal\r\n                        const classList = e.event.target['classList'];\r\n                        if (classList.contains('f-lookup-unfavorite')) {\r\n                            if (this.instance.items) {\r\n                                this.instance.items.forEach(item => {\r\n                                    if (item[this.instance.idField] === e.row[this.instance.idField]) {\r\n                                        item[FAVORITE_FIELD_NAME] = false;\r\n                                    }\r\n                                });\r\n\r\n                                const dt = this.instance.componentRef.instance as DataTableComponent;\r\n                                if (dt) {\r\n                                    dt.loadData({\r\n                                        pageSize: this.instance.gridOptions.pageSize,\r\n                                        pageIndex: this.instance.gridOptions.pageIndex,\r\n                                        total: this.instance.gridOptions.total,\r\n                                        data: this.instance.gridOptions.items\r\n                                    });\r\n                                }\r\n                            }\r\n\r\n                            this.instance.favoriteItems =\r\n                                this.instance.favoriteItems.filter(n => n[this.instance.idField] !== e.row[this.instance.idField]);\r\n\r\n                            this.lookupSelectionSer.updateFavoriteData(e.row, FavoriteAction.delete);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // åå»äºä»¶\r\n                fdt.rowDblClick.subscribe((rowData: any) => {\r\n                    if (this.instance.gridOptions.singleSelect) {\r\n                        this.instance.selectItem(rowData);\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n            case LookupGridDisplayType.TreeList: {\r\n                if (cmpRef) {\r\n                    const ftt = cmpRef.instance as TreeTableComponent;\r\n                    ftt.remoteSort = false;\r\n                    ftt.nodeSelected.subscribe(e => {\r\n                        if (this.instance.singleSelect) {\r\n                            this.lookupSelectionSer.clearSelections();\r\n                        }\r\n                        this.lookupSelectionSer.updateSelections(e.node.data);\r\n                    });\r\n                    ftt.nodeUnChecked.subscribe(e => {\r\n                        if (e.nodes && e.nodes.length) {\r\n                            this.instance.multiSelMgr.remove(e.nodes.map(n => n.id));\r\n                        } else if (e && e.node && e.node.data && e.node.data.id) {\r\n                            // const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                            // tt.unSelectNode(e.node.data.id);\r\n                            this.lookupSelectionSer.unSelect(e.node.data.id);\r\n                        }\r\n                    });\r\n\r\n                    ftt.nodeChecked.subscribe( e => {\r\n                        if (!this.instance.singleSelect) {\r\n                            if (e.nodes && e.nodes.length) {\r\n                                this.instance.multiSelMgr.updateSelections(e.nodes.map(n => n.data));\r\n                            } else {\r\n                                if (Array.isArray(e.node)) {\r\n                                    this.instance.multiSelMgr.updateSelections(e.node.map(n => n.data));\r\n                                } else {\r\n                                    this.instance.multiSelMgr.updateSelections([e.node.data]);\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    ftt.cellClick.subscribe(row => {\r\n                        if (row.col.field === FAVORITE_FIELD_NAME) {\r\n                            row.event.stopPropagation();\r\n                            const classList = row.event.target['classList'];\r\n                            if (classList.contains('f-lookup-unfavorite')) {\r\n                                const _this = this.instance;\r\n                                (function every(items) {\r\n                                    if (!items) {\r\n                                        return;\r\n                                    }\r\n                                    let hasFinish = false;\r\n                                    items.forEach(item => {\r\n                                        if (hasFinish) {\r\n                                            return;\r\n                                        }\r\n                                        if (item.data[_this.idField] === row.node[_this.idField]) {\r\n                                            item.data[FAVORITE_FIELD_NAME] = false;\r\n                                            hasFinish = true;\r\n                                        } else if (item.children && item.children.length > 0) {\r\n                                            every(item.children);\r\n                                        }\r\n                                    });\r\n                                })(this.instance.items);\r\n                                const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                                tt.loadData(this.instance.items);\r\n\r\n                                this.lookupSelectionSer.updateFavoriteData(row.node.data, FavoriteAction.delete);\r\n                            }\r\n                        }\r\n                    });\r\n                    ftt.dblClick.subscribe((treeNode: TreeNode) => {\r\n                        if (this.instance.gridOptions.singleSelect && treeNode.selectable) {\r\n                            if (this.instance.okButton) {\r\n                                this.instance.okButton.nativeElement.click();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    ftt.checkAll.subscribe( e => {\r\n                        const data = e.instance.checkeds.map(n => n.data);\r\n                        this.instance.multiSelMgr.updateSelections(data);\r\n                        this.instance.checkedChange.emit({ data, isCheck: true  });\r\n                    });\r\n                    ftt.unCheckAll.subscribe(() => {\r\n                        this.instance.multiSelMgr.clear();\r\n                        this.instance.checkedChange.emit({ data: [], isCheck: false  });\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private getFavoritData() {\r\n        if (this.instance.personalConf) {\r\n            const favData = this.instance.personalConf.favorite;\r\n            const _data = (favData && favData[this.instance.localService.localeId]) ? favData[this.instance.localService.localeId] : [];\r\n            return _data;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    getFavoritIds() {\r\n        return this.getFavoritData();\r\n    }\r\n\r\n    _loadFavoriteData(data = null) {\r\n        const fdt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n        this.loadFavoriteDatatable(fdt, data);\r\n        fdt.cd.markForCheck();\r\n        this.instance.closeLoading();\r\n    }\r\n\r\n    // å è½½æ¶ègridæ°æ®\r\n    loadFavoritesData(res = null) {\r\n        const favIds = this.getFavoritIds();\r\n        switch (this.instance.displayType) {\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n            case LookupGridDisplayType.List: {\r\n                const fdt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n                if (this.instance.favoriteDataFrom === 'locale') {\r\n                    if (res) {\r\n                        this._loadFavoriteData(res.items);\r\n                    } else {\r\n                        // this.instance.httpMgr.getFavoriteData(favIds).subscribe(resData => {\r\n                        //     if (resData) {\r\n                        //         this._loadFavoriteData(resData.items);\r\n                        //     }\r\n                        //     this.instance.closeLoading();\r\n                        // });\r\n                    }\r\n                } else {\r\n                    const favData = this.getFavoritData();\r\n                    this.loadFavoriteDatatable(fdt, res ? res.items : favData);\r\n                }\r\n                break;\r\n            }\r\n            case LookupGridDisplayType.TreeList: {\r\n                if (this.instance.favoritesComponentRef && this.instance.favoritesComponentRef.instance instanceof TreeTableComponent) {\r\n                    const ftt = this.instance.favoritesComponentRef.instance as TreeTableComponent;\r\n                    this.bindFavTreetable(ftt);\r\n\r\n                    if (this.instance.favoriteDataFrom === 'locale') {\r\n                        if (res) {\r\n                            this.loadFavoriteForTreeTable(res.items || [], ftt);\r\n                        } else {\r\n                            // this.instance.httpMgr.getFavoriteData(favIds).subscribe(resData => {\r\n                            //     if (resData) {\r\n                            //         const items = resData.items;\r\n                            //         this.loadFavoriteForTreeTable(items, ftt);\r\n                            //     }\r\n                            //     this.instance.closeLoading();\r\n                            // });\r\n                        }\r\n                    } else {\r\n                        if (res) {\r\n                            this.loadFavoriteForTreeTable(res.items, ftt);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private loadFavoriteDatatable(fdt: DataTableComponent, data?: any) {\r\n        if (data !== undefined) {\r\n            this.instance.favoriteItems = data;\r\n        }\r\n\r\n        if (fdt.columns && !fdt.columns.length) {\r\n            fdt.columns = this.instance.favoriteColumns;\r\n        }\r\n\r\n        fdt.loadData({\r\n            total: 0,\r\n            pageSize: 20,\r\n            pageIndex: 1,\r\n            data: this.instance.favoriteItems\r\n        });\r\n\r\n\r\n        this.instance.selectionMgr.selectCurrentValue();\r\n        fdt.cd.detectChanges();\r\n    }\r\n\r\n\r\n    private bindFavTreetable(ftt: TreeTableComponent) {\r\n        ftt.allColumnsTitle = this.instance.allColumnsTitle;\r\n        ftt.idField = this.instance.idField;\r\n\r\n        const columns = this.instance.gridOptions.columns.map(item => {\r\n            const rtn: any = { ...item };\r\n            if (item.field === FAVORITE_FIELD_NAME) {\r\n                rtn.formatter = (v: any, data: any): any => {\r\n                    const favids = this.getFavoritIds();\r\n                    if (favids && favids.length) {\r\n                        const index = favids.findIndex(el => el === data[this.instance.idField]);\r\n                        if (index >= 0) {\r\n                            return FavoriteIcon.delete;\r\n                        }\r\n                    }\r\n                    return '';\r\n                };\r\n            }\r\n            return rtn;\r\n        });\r\n        this.instance.favoriteColumns = columns;\r\n        ftt.columns = columns;\r\n\r\n\r\n        if (this.instance.gridOptions.treeInfo) {\r\n            ftt.onlySelectLeaf = this.instance.gridOptions.treeInfo.onlySelectLeaf;\r\n        }\r\n\r\n        if (!ftt.singleSelect) {\r\n            ftt.checkOnSelect = true;\r\n            ftt.selectOnCheck = true;\r\n            ftt.showCheckbox = true;\r\n\r\n            // å¯ç¨å¤éåï¼åæ¶å¯ç¨çº§èéæ©\r\n            // å¯ç¨å¤éåï¼åæ¶å¯ç¨çº§èéæ©\r\n            if (this.instance.enableCascade) {\r\n                this.instance.ttEventMgr.cascadeValueChanged(this.instance.cascadeStatus);\r\n            } else {\r\n                ftt.cascadeCheck = false;\r\n                ftt.cascadeDown = false;\r\n                ftt.cascadeUp = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private checkNodeIsLeaf(nodes: any ) {\r\n        if (nodes && nodes.length) {\r\n            return nodes.map((node: TreeNode) => {\r\n                if (node.hasOwnProperty(\"addtional\")) {\r\n                    node.selectable = !node[\"addtional\"];\r\n                }\r\n    \r\n                if (node.children && node.children.length) {\r\n                    this.checkNodeIsLeaf(node.children);\r\n                } else {\r\n                    node.leaf = true;\r\n                }\r\n    \r\n                return node;\r\n            });\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    initFavoriteTreeData(items) {\r\n        const treeInfo = this.instance.gridOptions.treeInfo;\r\n\r\n        if (treeInfo && !treeInfo['treeDataIsInit']) {\r\n            if (treeInfo.layerType.toLowerCase() === 'pathcode') {\r\n                items = this.instance.lookupUtils.makeTree(items, treeInfo);\r\n            } else {\r\n                items = this.instance.lookupUtils.makeTreeWithParentID(\r\n                    items,\r\n                    '',\r\n                    `${treeInfo.dataField}.${treeInfo.parentField}`,\r\n                    this.instance.idField\r\n                );\r\n            }\r\n        }\r\n\r\n        // return this.instance.checkNodeCanBeSelect(items, true);\r\n        return this.checkNodeIsLeaf(items);\r\n    }\r\n\r\n    loadFavoriteForTreeTable(items, ftt: any) {\r\n        items = this.initFavoriteTreeData(items);\r\n        this.instance.favoriteItems = items;\r\n        ftt.loadData(items);\r\n        ftt.expandAll();\r\n        this.instance.selectionMgr.selectCurrentValue();\r\n\r\n        return items;\r\n    }\r\n\r\n    // æ´æ°åè¡¨ä¸­çæ¶èæ°æ®æ è¯\r\n    updateFavoritesStatus(data: any[]) {\r\n\r\n        if (!data || !this.instance.useFavorite) {\r\n            return;\r\n        }\r\n\r\n        const favIds = this.getFavoritIds();\r\n\r\n        if (favIds && favIds.length) {\r\n            // å¤çæ°æ®åè¡¨ä¸­çæ¶èæ°æ®æ è¯\r\n            if (this.instance.displayType !== LookupGridDisplayType.TreeList) {\r\n                data.map(item => {\r\n                    if (favIds && favIds.length && favIds.find(v => v === item[this.instance.idField])) {\r\n                        item[FAVORITE_FIELD_NAME] = true;\r\n                    }\r\n                });\r\n            } else {\r\n                const _this = this.instance;\r\n                (function each(_data) {\r\n                    _data.forEach(item => {\r\n                        if (favIds && favIds.length && favIds.find(v => v === item.data[_this.idField])) {\r\n                            item.data[FAVORITE_FIELD_NAME] = true;\r\n                        }\r\n                        if (item.children && item.children.length > 0) {\r\n                            each(item.children);\r\n                        }\r\n                    });\r\n                })(data);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private _updateFavorites(value: any, action) {\r\n        const localeID = this.instance.localService.localeId;\r\n        this.instance.personalConf.favorite = this.instance.personalConf.favorite || {};\r\n        const items = value.filter(n => !n['_addtional_']);\r\n        const newVal = items.map(n => n[this.instance.idField]).filter(n => n !== null && n !== undefined);\r\n        // const favIds = this.instance.personalConf.favorite[localeID] || [];\r\n        this.instance.personalConf.favorite[localeID] = newVal;\r\n        return newVal;\r\n    }\r\n\r\n    // æ¶èæ°æ®ç®¡ç\r\n    private listenPersonalConfigHandler() {\r\n        this.lookupSelectionSer.favoriteItems$.subscribe(n => {\r\n            if (!this.instance.favoritesComponentRef) {\r\n                return;\r\n            }\r\n\r\n            const { items, action } = n;\r\n            const favids = this._updateFavorites(items, action);\r\n\r\n            this.instance.httpMgr.submitFavoriteData(action);\r\n\r\n            if (this.instance.displayType === LookupGridDisplayType.List || this.instance.displayType.includes('NAV')) {\r\n                const dt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n                this.loadFavoriteDatatable(dt, items);\r\n            } else if (this.instance.displayType === LookupGridDisplayType.TreeList) {\r\n                const ftt = this.instance.favoritesComponentRef.instance as TreeTableComponent;\r\n                // const favids = items.map(d => d.id);\r\n                this.instance.showLoading();\r\n                this.instance.httpMgr.getData({ favoriteIds: favids }, 'fav').subscribe(resData => {\r\n                    if (resData) {\r\n                        const _items = resData.items;\r\n                        this.loadFavoriteForTreeTable(_items, ftt);\r\n                    } else {\r\n                        this.instance.favoriteItems = [];\r\n                        ftt.loadData([]);\r\n                    }\r\n                    this.instance.closeLoading();\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n","import { TreeTableComponent } from '@farris/ui-treetable';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\n\r\nexport class SelectionManager {\r\n    constructor(private ins: LookupGridComponent) {\r\n\r\n    }\r\n\r\n    destroy() {\r\n    }\r\n\r\n    getBindingData() {\r\n        let jsonData = this.ins.bindingData;\r\n        if (\r\n            this.ins.ngControl &&\r\n            this.ins.ngControl.formDirective &&\r\n            this.ins.ngControl.formDirective.form &&\r\n            this.ins.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ins.ngControl.formDirective.form.bindingData;\r\n            jsonData = bindingData;\r\n\r\n            if (bindingData.getObject) {\r\n                jsonData = bindingData.getObject().toJSON();\r\n            }\r\n        }\r\n        return jsonData;\r\n    }\r\n\r\n    initDisplayValue() {\r\n        const jsonData = this.getBindingData();\r\n        if (jsonData && this.ins.mapFields) {\r\n            const idField = this.ins.idField;\r\n            let targetField = this.ins.mapFields[idField];\r\n\r\n            if (targetField) {\r\n                if (targetField.indexOf(',') > -1 ) {\r\n                    targetField = targetField.split(',')[0];\r\n                }\r\n\r\n                const val = this.ins.utils.getValue(targetField, jsonData);\r\n                if (val) {\r\n                    this.ins.displayValue = val;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _clearSelections() {\r\n        const { cmpRefInstance: t } = this.getDataCmpInstance();\r\n        if (t) {\r\n            if (this.ins.isTree()) {\r\n                // æ è¡¨\r\n                t.clearAll(false);\r\n                if (!t.cdRef.destroyed) {\r\n                    t.cdRef.detectChanges();\r\n                }\r\n            } else {\r\n                // åè¡¨\r\n                t.dtBody.selectedRowIndex = -1;\r\n                t.dtBody.selections = undefined;\r\n                if (!t.cd.destroyed) {\r\n                    t.cd.detectChanges();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¸®å©çªå£æå¼åï¼æ ¹æ® displayValue éä¸­æ°æ®\r\n     */\r\n    selectCurrentValue(selectedIds = []) {\r\n\r\n        if (!this.ins.enableToSelect) {\r\n            return;\r\n        }\r\n\r\n\r\n        const { cmpRefInstance: t, items } = this.getDataCmpInstance();\r\n        if (!t || !items || !items.length) {\r\n            return;\r\n        }\r\n\r\n        this._clearSelections();\r\n\r\n        if (!selectedIds || !selectedIds.length) {\r\n            const selectedRows = this.ins.lookupSelectionSer.getSelections();\r\n            if (selectedRows.length) {\r\n                selectedIds = selectedRows.map(n => n[this.ins.idField]);\r\n            }\r\n        }\r\n\r\n        // const _ids = this.getSelectedIds();\r\n        // selectedIds = selectedIds.concat(_ids);\r\n        // selectedIds = Array.from(new Set(selectedIds));\r\n\r\n        if (selectedIds && selectedIds.length) {\r\n            if (this.ins.isTree()) {\r\n                // æ è¡¨\r\n                this.selected4Treetable(t, selectedIds);\r\n                if (!t.cdRef.destroyed) {\r\n                    t.cdRef.detectChanges();\r\n                }\r\n            } else {\r\n                // åè¡¨\r\n                this.selected4Datatable(t, items, selectedIds);\r\n                if (!t.cd.destroyed) {\r\n                    t.cd.detectChanges();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getDataCmpInstance() {\r\n        let ref = null;\r\n        let items = null;\r\n        if (this.ins.activeTab === 'datalist') {\r\n            if (this.ins.isTree()) {\r\n                ref = this.ins.lookupCmpMgr.getComponentInstance('treetable');\r\n                items = (ref as TreeTableComponent).serializedValue;\r\n            } else {\r\n                items = this.ins.items;\r\n                ref = this.ins.lookupCmpMgr.getComponentInstance();\r\n            }\r\n        } else if (this.ins.activeTab === 'favorite') {\r\n            ref = this.ins.lookupCmpMgr.getComponentInstance('fav');\r\n            items = this.ins.favoriteItems;\r\n        }\r\n        return { cmpRefInstance: ref, items };\r\n    }\r\n\r\n    private selected4Datatable(t: any, items: any, values: any) {\r\n        if (this.ins.singleSelect) {\r\n            items.forEach((item, index) => {\r\n                if (item[this.ins.idField] === values[0]) {\r\n                    if (!t.dtBody.isSelected(item)) {\r\n                        t.dtBody.selectedRowIndex = -1;\r\n                        t.dtBody.selectedRow('', index, item);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // const values = this.getSelectedIds();\r\n            values.forEach(id => {\r\n                const r = items.find(n => n[this.ins.idField] == id);\r\n                if (r) {\r\n                    t.checkRow(id);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private selected4Treetable(t: any, valueArr: any) {\r\n        if (this.ins.singleSelect) {\r\n            t.selectNode(valueArr[0], false, false);\r\n        } else {\r\n            // const valueArr = this.getSelectedIds();\r\n            t.checkedNodes(valueArr, false, false, true);\r\n            t.selectNodes(valueArr);\r\n        }\r\n    }\r\n\r\n    getSelectedIds() {\r\n        let values = [];\r\n        const s = this.ins.multipleChoiceSeparator; // å¤éåéç¬¦\r\n        if (!this.ins.singleSelect && this.ins.displayValue && ('' + this.ins.displayValue).indexOf(s) > -1) {\r\n            values = this.ins.displayValue.split(s);\r\n        } else {\r\n            if (this.ins.displayValue !== null && this.ins.displayValue !== '' && this.ins.displayValue !== undefined) {\r\n                values = [this.ins.displayValue];\r\n            }\r\n        }\r\n\r\n        // å¯ç¨æ¾ç¤ºå¤éåè¡¨\r\n        if (this.ins.showSelected) {\r\n            const rows = this.ins.lookupSelectionSer.getSelections();\r\n            if (rows && rows.length) {\r\n                values = rows.map(n => n[this.ins.idField]);\r\n            } else {\r\n                values = [];\r\n            }\r\n        }\r\n\r\n        return values;\r\n    }\r\n}\r\n\r\n\r\n\r\n","import { DataTableComponent } from '@farris/ui-datatable';\r\nimport { of } from 'rxjs';\r\nimport { catchError, take, tap } from 'rxjs/operators';\r\nimport { FavoriteAction, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\n\r\nexport class DataTableEventManager {\r\n\r\n    private lookupSelectionSer: LookupSelectionService;\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.ins.lookupSelectionSer;\r\n    }\r\n\r\n    onSearch($event: { field: string; value: string } = { field: '*', value: '' }) {\r\n        if ($event && $event.field !== '*' && !$event.value) {\r\n            this.ins.messagerService.warning(this.ins.mustWriteSomething);\r\n            return;\r\n        }\r\n\r\n        const p = {\r\n            pageInfo: { pageIndex: 1, pageSize: this.ins.gridOptions.pageSize },\r\n            search: $event\r\n        };\r\n        if (this.ins.uri) {\r\n            if (!this.ins.searching) {\r\n                this.ins.searching = true;\r\n                this.ins.httpMgr.getData(p, 'list').pipe(\r\n                    catchError(err => {\r\n                        this.ins.searching = false;\r\n                        return of({ \"_ERROR_\": err });\r\n                    }),\r\n                    tap(() => {\r\n                        this.ins.searching = false;\r\n                    })\r\n                ).subscribe(\r\n                    data => {\r\n                        this.ins.searching = false;\r\n                        this.ins.closeLoading();\r\n                        if (!data['_ERROR_']) {\r\n                            this._loadData(data);\r\n                        } else {\r\n                            throw new Error(data['_ERROR_']);\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n        } else {\r\n            this.ins.search.emit(p);\r\n        }\r\n    }\r\n\r\n    private _loadData(data: LookupGridResult) {\r\n        const self = this.ins;\r\n        self.closeLoading();\r\n        self.favHelper.updateFavoritesStatus(data.items);\r\n        self.loadDataTableData(data);\r\n        // éä¸­æ°æ®\r\n        this.ins.selectionMgr.selectCurrentValue();\r\n    }\r\n\r\n    bindDataTableEvent() {\r\n        const self = this.ins;\r\n        const dt = self.componentRef.instance as DataTableComponent;\r\n\r\n        dt.selectedRow.subscribe((e: any) => {\r\n            if (this.ins.singleSelect) {\r\n                this.lookupSelectionSer.clearSelections();\r\n            }\r\n            this.ins.checkedChange.emit({ data: [e.data], isCheck: true });\r\n            this.lookupSelectionSer.updateSelections([e.data]);\r\n            dt.cd.detectChanges();\r\n        });\r\n\r\n        dt.unSelectRow.subscribe(e => {\r\n            this.lookupSelectionSer.unSelect(e.data[self.idField]);\r\n            this.ins.checkedChange.emit({ data: [e.data], isCheck: false });\r\n        });\r\n\r\n        dt.checkAll.subscribe((e: boolean) => {\r\n            this.lookupSelectionSer.updateSelections(dt.data, e);\r\n            this.ins.checkedChange.emit({ data: dt.data, isCheck: e });\r\n        });\r\n\r\n        dt.pageChanged.subscribe((e: any) => {\r\n            if (self.uri) {\r\n                self.httpMgr.getData(e, 'list').subscribe((data: LookupGridResult) => {\r\n                    this._loadData(data);\r\n                });\r\n            } else {\r\n                self.pagerChanged.emit(self.httpMgr.buildQueryParams(e, 'list'));\r\n            }\r\n        });\r\n\r\n        dt.pageSizeChanged.subscribe(e => {\r\n            if (self.uri) {\r\n                self.httpMgr.getData(e, 'list').subscribe(\r\n                    data => {\r\n                        this._loadData(data);\r\n                    },\r\n                    err => {\r\n                        self.closeLoading();\r\n                    }\r\n                );\r\n            } else {\r\n                self.pagerChanged.emit(self.httpMgr.buildQueryParams(e, 'list'));\r\n            }\r\n        });\r\n\r\n        dt.search.subscribe((e: any) => {\r\n            self._searchState = e;\r\n            this.onSearch(e);\r\n        });\r\n        // åå»äºä»¶\r\n        dt.rowDblClick.subscribe((rowData: any) => {\r\n            if (self.gridOptions.singleSelect) {\r\n                // this.lookupSelectionSer.updateSelections([rowData]);\r\n                self.selectItem(rowData);\r\n            }\r\n        });\r\n\r\n        // æ¶èäºä»¶\r\n        dt.cellClick.subscribe((e: any) => {\r\n            if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                e.event.stopPropagation();\r\n                const classList = e.event.target['classList'];\r\n                if (classList.contains('f-lookup-favorite')) {\r\n                    self.items.forEach(item => {\r\n                        const id = self.utils.getValue(self.idField, item);\r\n                        if (id === self.utils.getValue(self.idField, e.row)) {\r\n                            item[FAVORITE_FIELD_NAME] = !item[FAVORITE_FIELD_NAME];\r\n                        }\r\n                    });\r\n                    dt.loadData({\r\n                        pageSize: self.gridOptions.pageSize,\r\n                        pageIndex: self.gridOptions.pageIndex,\r\n                        total: self.gridOptions.total,\r\n                        data: self.gridOptions.items\r\n                    });\r\n\r\n                    // æ´æ°æ¶èæ°æ®\r\n                    const faction = e.row[FAVORITE_FIELD_NAME] ? FavoriteAction.add : FavoriteAction.delete;\r\n\r\n                    if (faction ===  FavoriteAction.add) {\r\n                        this.ins.favoriteItems = [...this.ins.favoriteItems, e.row];\r\n                    } else {\r\n                        this.ins.favoriteItems = this.ins.favoriteItems.filter(n => {\r\n                            return self.utils.getValue(self.idField, n) !== self.utils.getValue(self.idField, e.row);\r\n                        });\r\n                    }\r\n\r\n                    this.lookupSelectionSer.updateFavoriteData(e.row, faction);\r\n                }\r\n            }\r\n        });\r\n\r\n        dt.columnSorted.subscribe((sort: { sortName: string; sortOrder: any }) => {\r\n\r\n            if (!this.ins.remoteSort) {\r\n                return;\r\n            }\r\n\r\n            const { sortName, sortOrder } = { ...sort };\r\n\r\n            const col = this.ins.columns.find(n => n.field === sortName);\r\n\r\n            const _sortName = col ? col.fieldPath ? col.fieldPath : col.field : sortName;\r\n\r\n            const param = {\r\n                sortName: _sortName,\r\n                sortOrder,\r\n                search: self._searchState,\r\n                pageInfo: {\r\n                    pageSize: self.pageSize,\r\n                    pageIndex: 1\r\n                }\r\n            };\r\n\r\n            self.httpMgr.getData(param, 'search').subscribe(d => {\r\n                self.loadDataTableData(d);\r\n                self.closeLoading();\r\n            });\r\n        });\r\n\r\n        dt.clearSearchValue.subscribe(() => {\r\n            self._searchState = null;\r\n            this.onSearch();\r\n        });\r\n    }\r\n}\r\n\r\n","import { EMPTY, of } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { LookupGridResult, PickingResult } from '../lookup-grid-options';\r\n\r\n\r\n\r\n /** æ£æ¥å¸®å©è¾å¥æ¡å¼åååè¿åçæ¥è¯¢ç»æ */\r\nfunction checkSearchResult(data = null) {\r\n    if (this.searchOnServer) {\r\n        // this._searchResult = data;\r\n        // this.showDialog();\r\n        this.isShow = true;\r\n    } else {\r\n        if (data === false) {\r\n            this.cancelSelect();\r\n        } else {\r\n            this.setModelValue(this.displayText);\r\n            this.runDictPickedEvent(null);\r\n        }\r\n    }\r\n}\r\n\r\nexport function onTextChanged() {\r\n\r\n    const self = this;\r\n\r\n    const isPending = () => {\r\n        return this.lookupUtils.rts.getFormState('lookup.pending');\r\n    };\r\n\r\n    const searchData = (e) => {\r\n\r\n        if (this.isShow) {\r\n            return;\r\n        }\r\n\r\n        if (this.isTextChange && this.displayText && (!this.nosearch || e.originalEvent) && !isPending()) {\r\n            this.lookupUtils.pendingStart();\r\n\r\n            this.dictPickingSubscription = this.dictPicking({\r\n                instance: this\r\n            }).pipe(\r\n                switchMap((pr: PickingResult) => {\r\n                    let o = true;\r\n                    if (pr === undefined || pr === null) {\r\n                        o = true;\r\n                    }\r\n\r\n                    if (typeof pr === 'boolean') {\r\n                        o = pr;\r\n                    }\r\n\r\n                    if (typeof pr === 'object') {\r\n                        if (pr.showDialog === undefined) {\r\n                            o = true;\r\n                        } else {\r\n                            o = pr.showDialog;\r\n                        }\r\n\r\n                        if (pr.data) {\r\n                            /** ä¿å­å¸®å©åä¼ éçæ°æ® */\r\n                            this.customData = pr.data;\r\n                        }\r\n                    }\r\n\r\n                    if (o) {\r\n                        return this.httpMgr.getData(\r\n                            {\r\n                                search: {\r\n                                    field: '*',\r\n                                    value: this.displayText,\r\n                                    type: 'equal'\r\n                                }\r\n                            },\r\n                            'search'\r\n                        );\r\n                    } else {\r\n                        return of({ SHOWDIALOG: o, MESSAGE:  pr.message || '' });\r\n                    }\r\n                })\r\n            ).subscribe(\r\n                (data: any) => {\r\n                    this.closeLoading();\r\n                    this.lookupUtils.pendingEnd();\r\n                    if (data.hasOwnProperty('SHOWDIALOG')) {\r\n                        if (data.SHOWDIALOG && data.MESSAGE) {\r\n                            this.notifyService.warning(data.MESSAGE);\r\n                        }\r\n\r\n                        return;\r\n                    }\r\n\r\n                    if (data.items && data.items.length === 1 && (!data.items[0].children || !data.items[0].children.length)) {\r\n                        let rowdata = data.items[0];\r\n                        if (this.isTree()) {\r\n                            const leafNode = this.treeNodeHelper.getLeafNode(rowdata);\r\n\r\n                            let isOnlySelectLeaf = false;\r\n\r\n                            if (!this.treeInfo) {\r\n                                this.setTreeInfo(data);\r\n                            }\r\n\r\n                            if (typeof this.treeInfo.onlySelectLeaf === 'boolean' ) {\r\n                                isOnlySelectLeaf = this.treeInfo.onlySelectLeaf;\r\n                            } else if (typeof this.treeInfo.onlySelectLeaf === 'string') {\r\n                                if (this.treeInfo.onlySelectLeaf === 'yes') {\r\n                                    isOnlySelectLeaf = true;\r\n                                } else if (this.treeInfo.onlySelectLeaf === 'no') {\r\n                                    isOnlySelectLeaf = false;\r\n                                } else {\r\n                                    if (this.treeInfo.onlySelectLeaf === 'default') {\r\n                                        isOnlySelectLeaf = data.treeInfo.onlySelectLeaf;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (isOnlySelectLeaf && !leafNode.leaf) {\r\n                                // this.displayText = '';\r\n                                checkSearchResult.bind(self, data)();\r\n                                return;\r\n                            }\r\n                            \r\n\r\n                            if (Array.isArray(leafNode)) {\r\n                                checkSearchResult.bind(self, data)();\r\n                                return;\r\n                            } else {\r\n                                rowdata = leafNode.data;\r\n                            }\r\n                        }\r\n                        if (!this.singleSelect) {\r\n                            rowdata = [ rowdata ];\r\n                        }\r\n                        this.selectItem(rowdata);\r\n\r\n                        this.dialogClosed.emit();\r\n                    } else {\r\n                        checkSearchResult.bind(self, data)();\r\n                    }\r\n                }, (err: any) => {\r\n                    this.closeLoading();\r\n                    this.lookupUtils.pendingEnd();\r\n                    this.messagerService.error(err ? err.Message : err);\r\n                }\r\n            );\r\n        }\r\n    };\r\n\r\n    let inputBlurHandler = null;\r\n\r\n    if (this.inputGroup && this.inputGroup.textbox && !this.nosearch) {\r\n        this.lookupUtils.setActiveLookupInstance(this);\r\n        inputBlurHandler = this.render2.listen(this.inputGroup.textbox.nativeElement, 'blur', searchData );\r\n    }\r\n\r\n    if (this.inputGroup) {\r\n        this.inputGroup.enterHandle.subscribe( searchData);\r\n\r\n        this.inputGroup.keydownHandle.subscribe((e: any) => {\r\n            let canOpen = false;\r\n            if (e.code === 'ArrowRight') {\r\n                if (this.editable) {\r\n                    canOpen = !e.target.value || e.target.selectionStart === e.target.value.length;\r\n                } else {\r\n                    canOpen = true;\r\n                }\r\n            } else {\r\n                canOpen = e.code === this.shortcutKey.open;\r\n            }\r\n            if (canOpen) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                this.showDialog();\r\n            }\r\n        });\r\n    }\r\n\r\n    return inputBlurHandler;\r\n\r\n}\r\n","import { TreeTableComponent, TreeNode } from '@farris/ui-treetable';\r\nimport { FavoriteAction, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { Observable, of, Subject } from 'rxjs';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { take, tap, catchError } from 'rxjs/operators';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\n\r\n\r\nexport class TreeTableEventManager {\r\n    private lookupSelectionSer: LookupSelectionService;\r\n\r\n    /**\r\n     * æ è¯å½åæ°æ®æ¯å¦æ¥è¯¢ç»æ\r\n     */\r\n    private IS_SEARCH_RESULT = false;\r\n\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.ins.lookupSelectionSer;\r\n    }\r\n\r\n    searchTreeData(search: { field: string; value: string }) {\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        // å¤æ­uri ååºsearch.emit();\r\n        if (this.ins.searching) {\r\n            return;\r\n        } else {\r\n            this.ins.searching = true;\r\n        }\r\n\r\n        this.ins.showLoading();\r\n        return this.ins.httpMgr.getData({ search, sortName: tt.sortName, sortOrder: tt.sortOrder }, 'search').pipe(\r\n            tap(() => {\r\n                this.ins.searching = false;\r\n            }),\r\n            catchError((err) => {\r\n                this.ins.searching = false;\r\n                return of(err);\r\n            })\r\n        ).subscribe(resData => {\r\n            this.ins.closeLoading();\r\n            if (resData) {\r\n                // this.ins.items = resData.items;\r\n                tt.clearAll();\r\n\r\n                const treeInfo = this.ins.gridOptions.treeInfo;\r\n                if (!treeInfo['treeDataIsInit']) {\r\n                    if (treeInfo.layerType.toLowerCase() === 'pathcode') {\r\n                        this.ins.items = this.ins.lookupUtils.makeTree(this.ins.items, treeInfo);\r\n                    } else {\r\n                        this.ins.items = this.ins.lookupUtils.makeTreeWithParentID(\r\n                            this.ins.items,\r\n                            '',\r\n                            `${treeInfo.dataField}.${treeInfo.parentField}`,\r\n                            this.ins.idField\r\n                        );\r\n                    }\r\n                }\r\n\r\n\r\n                const checkNodes = (nodes): TreeNode[] => {\r\n                    if (nodes && nodes.length) {\r\n                        return nodes.map((node: TreeNode) => {\r\n                            if (node.hasOwnProperty('addtional')) {\r\n                                node.selectable = !node['addtional'];\r\n                            }\r\n\r\n                            if (node.children && node.children.length) {\r\n                                checkNodes(node.children);\r\n                            }\r\n                            return node;\r\n                        });\r\n                    }\r\n                    return nodes;\r\n                };\r\n\r\n                const expandFirstNode = (nodes): TreeNode[] => {\r\n                    if (nodes && nodes.length) {\r\n                        return nodes.map((node: TreeNode) => {\r\n                            if (node.children && node.children.length) {\r\n                                node.expanded = true;\r\n                                expandFirstNode(node.children);\r\n                            }\r\n                            return node;\r\n                        });\r\n                    }\r\n                    return nodes;\r\n                };\r\n\r\n                const _nodes = checkNodes(resData.items);\r\n                if (_nodes && _nodes.length && _nodes[0].children && _nodes[0].children.length) {\r\n                    _nodes[0].expanded = true;\r\n                    _nodes[0].children = expandFirstNode(_nodes[0].children);\r\n                }\r\n                this.ins.items = _nodes;\r\n\r\n\r\n                // å è½½æ¶èæ°æ®\r\n                if (this.ins.useFavorite) {\r\n                    // æ´æ°æ°æ®çæ¶èç¶æ\r\n                    this.ins.favHelper.updateFavoritesStatus(this.ins.items);\r\n                }\r\n\r\n                tt.loadData(this.ins.items);\r\n                // // å±å¼æ¥è¯¢ç»æã\r\n                // if (search.value && this.ins.items.length) {\r\n                //     tt.toggleExpand(this.ins.items[0], true);\r\n                // }\r\n                tt.resize();\r\n\r\n                this.IS_SEARCH_RESULT = true;\r\n\r\n                this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n\r\n            this.ins.search.emit(search);\r\n        });\r\n    }\r\n\r\n    private getChildren(\r\n        parentPath,\r\n        parentLayer,\r\n        searchData: { searchField: string; searchValue: string }\r\n    ): Observable<any> {\r\n        const uri = this.ins.gridOptions.uri;\r\n        const search = { parentLayer, category: 'children', ...searchData };\r\n        if (this.ins.treeInfo.layerType === 'parentId') {\r\n            search['parentId'] = parentPath;\r\n        } else {\r\n            search['parentPath'] = parentPath;\r\n        }\r\n\r\n        const param = {\r\n            searchValue: JSON.stringify(search),\r\n            customData: this.ins.customData,\r\n            enableFullTree: this.ins.enableFullTree,\r\n            loadTreeDataType: this.ins.loadTreeDataType\r\n        };\r\n\r\n        if (this.IS_SEARCH_RESULT) {\r\n            param.enableFullTree = false;\r\n            param.loadTreeDataType = 'layerload';\r\n\r\n            if (this.ins.treeInfo.layerType === 'parentId') {\r\n                // æ å½¢å¸®å©æ¥è¯¢åï¼å±å¼èç¹æ¶å°ç¸å³æ¥è¯¢åæ°ä¼ éå°åç«¯ 2022-09-13\r\n                search.searchValue = '';\r\n                search.searchField = '*';\r\n            }\r\n            param.searchValue = JSON.stringify(search);\r\n        }\r\n\r\n        if (this.ins.helpId) {\r\n            param['helpId'] = this.ins.helpId;\r\n        }\r\n\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        if (tt && tt.sortName) {\r\n            Object.assign(param, {\r\n                sortName: tt.sortName,\r\n                sortOrder: tt.sortOrder\r\n            });\r\n        }\r\n\r\n        return this.ins.http.getData(uri, param);\r\n    }\r\n\r\n\r\n    bindTreetableEvent() {\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const _searchTreeData = (searchparam: any) => {\r\n            if (this.ins.remoteSearch) {\r\n                this.ins._searchState = searchparam;\r\n                this.searchTreeData(searchparam);\r\n            } else {\r\n                // TODO: å¨é¨å è½½ï¼åç«¯æç´¢ éè¦å®å\r\n                // if (this.ins.loadTreeDataType === 'loadall' && tt.searchHandle) {\r\n                //     tt.searchHandle.search(searchparam.field, searchparam.value, 'client');\r\n                // }\r\n                this.ins.search.emit(searchparam);\r\n            }\r\n        };\r\n\r\n        const isLoadAllTreeData = () => {\r\n            if (this.ins.loadTreeDataType === 'default') {\r\n                return tt.loadDataType === 'all';\r\n            } else {\r\n                return this.ins.loadTreeDataType === 'loadall';\r\n            }\r\n        };\r\n\r\n        const isAsyncLoadTreeData = () => {\r\n            if (this.ins.loadTreeDataType === 'default') {\r\n                return tt.loadDataType === 'async';\r\n            } else {\r\n                return this.ins.loadTreeDataType === 'layerload';\r\n            }\r\n        };\r\n\r\n\r\n        tt.dblClickExpand = !this.ins.singleSelect; // ç¦ç¨åå»å±å¼èç¹\r\n\r\n        tt.allColumnsTitle = this.ins.allColumnsTitle; // this.displayInfo.allColumns;\r\n        tt.idField = this.ins.idField;\r\n        tt.columns = this.ins.columns;\r\n        tt.searchFields = this.ins.gridOptions.searchFields;\r\n        if (this.ins.treeInfo) {\r\n            tt.loadDataType = this.ins.treeInfo.loadDataType;\r\n            tt.virtualized = true;\r\n            if (!this.ins.isTextChange) {\r\n                this.ins.allData = cloneDeep(this.ins.items);\r\n            } else {\r\n                this.ins.allData = [];\r\n            }\r\n        }\r\n\r\n        if (this.ins.gridOptions.treeInfo) {\r\n            tt.onlySelectLeaf = this.ins.gridOptions.treeInfo.onlySelectLeaf;\r\n            tt.loadDataType = this.ins.gridOptions.treeInfo.loadDataType;\r\n        }\r\n\r\n        if (!tt.singleSelect) {\r\n            tt.checkOnSelect = true;\r\n            tt.selectOnCheck = true;\r\n            tt.showCheckbox = true;\r\n            tt.showCheckAll =  this.ins.showCheckAll;\r\n            // å¯ç¨å¤éåï¼åæ¶å¯ç¨çº§èéæ©\r\n            if (this.ins.enableCascade) {\r\n                this.cascadeValueChanged(this.ins.cascadeStatus);\r\n            } else {\r\n                tt.cascadeCheck = false;\r\n                tt.cascadeDown = false;\r\n                tt.cascadeUp = false;\r\n            }\r\n        }\r\n\r\n        tt.enableFindText = this.ins.enableFindText;\r\n        // tt.findField = this.textField;\r\n        tt.nodeSelected.subscribe((e: any) => {\r\n            // if (this.ins.favoritesComponentRef && this.ins.singleSelect) {\r\n            //     const ftt = this.ins.favoritesComponentRef.instance as TreeTableComponent;\r\n            //     ftt.clearSelections();\r\n            // }\r\n            if (this.ins.singleSelect) {\r\n                this.lookupSelectionSer.clearSelections();\r\n            }\r\n            this.lookupSelectionSer.updateSelections([e.node.data]);\r\n            this.ins.checkedChange.emit({ data: [e.node.data] , isCheck: true  });\r\n        });\r\n\r\n        tt.nodeChecked.subscribe( e => {\r\n            if (!this.ins.singleSelect) {\r\n                let data = null;\r\n                if (e.nodes && e.nodes.length) {\r\n                    data = e.nodes.map(n => n.data);\r\n                    // this.ins.multiSelMgr.updateSelections(e.nodes.map(n => n.data));\r\n                } else {\r\n                    if (Array.isArray(e.node)) {\r\n                        data = e.node.map(n => n.data);\r\n                        // this.ins.multiSelMgr.updateSelections(e.node.map(n => n.data));\r\n                    } else {\r\n                        data = [e.node.data];\r\n                        // this.ins.multiSelMgr.updateSelections([e.node.data]);\r\n                    }\r\n                }\r\n                this.ins.multiSelMgr.updateSelections(data);\r\n                this.ins.checkedChange.emit({ data, isCheck: true  });\r\n            }\r\n        });\r\n\r\n        tt.nodeUnChecked.subscribe((e: any) => {\r\n            if (e && e.node) {\r\n                if (!this.ins.singleSelect) {\r\n                    this.ins.multiSelMgr.remove(e.node.id);\r\n\r\n                    // åå±å è½½ï¼å¤éï¼åå«ä¸çº§æ¶ï¼åæ¶å¾é éè¦å°å½åèç¹çææå­çº§æ°æ®ä¹è¦åæ¶éæ©ï¼å³ä»å·²éè®°å½ä¸­ç§»é¤\r\n                    if (tt.loadDataType !== 'all' && this.ins.treeInfo.layerType === 'pathcode' &&\r\n                        (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down')) {\r\n                        if (e.node.children && e.node.children.length) {\r\n                            const nodes = e.node.children.map(n => n.data);\r\n                            this.ins.lookupSelectionSer.updateSelections(nodes, false);\r\n                        } else {\r\n                            const pathcode = e.node.data[this.ins.treeInfo.dataField][this.ins.treeInfo.pathField];\r\n                            this.ins.lookupSelectionSer.unselectByPathcode(pathcode);\r\n                        }\r\n                    }\r\n\r\n                    if (e.nodes && e.nodes.length) {\r\n                        this.ins.multiSelMgr.remove(e.nodes.map(n => n.id));\r\n                        this.ins.checkedChange.emit({ data: e.nodes.map(n => n.data), isCheck: false });\r\n                    } else {\r\n                        this.ins.checkedChange.emit({ data: [e.node.data], isCheck: false });\r\n                    }\r\n                } else {\r\n                    const ftt = this.ins.favoritesComponentRef && (this.ins.favoritesComponentRef.instance as TreeTableComponent);\r\n                    if (ftt && ftt.findRowNode(e.node.id)) {\r\n                        ftt.unSelectNode(e.node.id);\r\n                    }\r\n\r\n                    this.ins.checkedChange.emit({ data: [e.node.data], isCheck: false });\r\n                }\r\n            }\r\n        });\r\n\r\n        tt.checkAll.subscribe( e => {\r\n            const data = e.instance.checkeds.map(n => n.data);\r\n            this.ins.multiSelMgr.updateSelections(data);\r\n            this.ins.checkedChange.emit({ data, isCheck: true  });\r\n        });\r\n        tt.unCheckAll.subscribe(() => {\r\n            this.ins.multiSelMgr.clear();\r\n            this.ins.checkedChange.emit({ data: [], isCheck: false  });\r\n        });\r\n\r\n        tt.search.subscribe(searchparam => {\r\n            if (searchparam.field !== '*' && !searchparam.value) {\r\n                this.ins.messagerService.warning(this.ins.mustWriteSomething);\r\n            } else {\r\n                searchparam.value = searchparam.value.trim();\r\n                _searchTreeData(searchparam);\r\n            }\r\n        });\r\n\r\n        tt.cellClick.subscribe((e: any) => {\r\n            if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                e.event.stopPropagation();\r\n                // tslint:disable-next-line: no-string-literal\r\n                const classList = e.event.target['classList'];\r\n                if (classList.contains('f-lookup-favorite')) {\r\n                    // classList.toggle('f-icon-star');\r\n                    // classList.toggle('f-icon-star-outline');\r\n                    const _this = this.ins;\r\n\r\n                    (function each(arr) {\r\n                        if (arr) {\r\n                            arr.forEach(item => {\r\n                                const id = _this.utils.getValue(_this.idField, item.data);\r\n                                if (id === e.node.id) {\r\n                                    item.data[FAVORITE_FIELD_NAME] = !item.data[FAVORITE_FIELD_NAME];\r\n                                    return true;\r\n                                } else if (item.children && item.children.length > 0) {\r\n                                    return each(item.children);\r\n                                } else {\r\n                                    return false;\r\n                                }\r\n                            });\r\n                        }\r\n                    })(this.ins.items);\r\n                    tt.loadData(this.ins.items);\r\n\r\n                    // æ´æ°æ¶èæ°æ®\r\n                    this.lookupSelectionSer.updateFavoriteData( e.node.data,\r\n                        e.node.data[FAVORITE_FIELD_NAME] ? FavoriteAction.add : FavoriteAction.delete);\r\n                }\r\n            }\r\n        });\r\n\r\n        tt.dblClick.subscribe((treeNode: TreeNode) => {\r\n            if (this.ins.gridOptions.singleSelect && treeNode.selectable) {\r\n                if (this.ins.okButton) {\r\n                    // this.lookupSelectionSer.select(treeNode.data);\r\n                    // this.ins.okButton.nativeElement.click();\r\n                    this.ins.selectItem(treeNode.data);\r\n                }\r\n            }\r\n        });\r\n        const loadAllData = isLoadAllTreeData();\r\n        tt.columnSorted.subscribe((sort: { sortName: string; sortOrder: any; }) => {\r\n            if (isLoadAllTreeData()) {\r\n                tt.clientSort();\r\n            } else {\r\n                const { sortName, sortOrder } = { ...sort };\r\n\r\n                const col = this.ins.columns.find(n => n.field === sortName);\r\n                const _sortName = col ? col.fieldPath ? col.fieldPath : col.field : sortName;\r\n\r\n                const param = Object.assign({ sortName: _sortName, sortOrder }, { search: this.ins._searchState });\r\n                this.ins.httpMgr.getData(param, 'search').subscribe(d => {\r\n                    this.ins.items = d.items;\r\n                    this.ins.closeLoading();\r\n                    tt.clearAll();\r\n                    const items = this.ins.checkNodeCanBeSelect(d.items, false);\r\n                    tt.loadData(items);\r\n                    tt.resize();\r\n                });\r\n            }\r\n        });\r\n\r\n        tt.clearSearchValue.subscribe(() => {\r\n            this.ins._searchState = null;\r\n            this.IS_SEARCH_RESULT = false;\r\n            let _items = [];\r\n            if (this.ins.allData && this.ins.allData.length) {\r\n                _items = this.ins.checkNodeCanBeSelect(this.ins.allData, loadAllData);\r\n            }\r\n            if (!_items || !_items.length) {\r\n                _searchTreeData({ field: '*', value: '' });\r\n            } else {\r\n                this.ins.items = _items;\r\n                this.ins.favHelper.updateFavoritesStatus(this.ins.items);\r\n                tt.loadData(_items);\r\n                this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n        });\r\n\r\n        tt.expand.subscribe((tn: TreeNode) => {\r\n            if (tn.leaf ||  tn['showLoading']) {\r\n                return;\r\n            }\r\n            if (!tn.children || !tn.children.length) {\r\n                const treeInfo = this.ins.gridOptions.treeInfo;\r\n                if (isAsyncLoadTreeData() || this.IS_SEARCH_RESULT ) {\r\n                    let parentPath = '';\r\n                    let parentLayer = -1;\r\n                    const { field = '*', value = '' } = {\r\n                        ...tt.searchData\r\n                    };\r\n\r\n                    tn['showLoading'] = true;\r\n                    tt.detectChanges();\r\n                    if (treeInfo.layerType === 'parentId') {\r\n                        // ç¶IDå è½½æ¹å¼\r\n                        parentPath = tn['id'];\r\n                    } else {\r\n                        const treeInfoField = treeInfo.dataField;\r\n                        if (treeInfoField) {\r\n                            parentPath = tn.data[treeInfoField][treeInfo.pathField];\r\n                            parentLayer = tn.data[treeInfoField][treeInfo.layerField];\r\n                        } else {\r\n                            this.ins.writeConsole('æªæ¾å°åçº§ä¿¡æ¯ã');\r\n                        }\r\n                    }\r\n\r\n                    if (!this.ins.uri) {\r\n                        this.ins.expandTreeNode.emit({\r\n                            instance: tt, node: tn,\r\n                            parentIdOrPath: parentPath, parentLayer, search: { value, field }\r\n                        });\r\n\r\n                        return;\r\n                    }\r\n\r\n                    this.ins.showLoading();\r\n\r\n                    this.getChildren(parentPath, parentLayer, {\r\n                        searchField: field === '*' ? '*' : field,\r\n                        searchValue: value\r\n                    }).subscribe(data => {\r\n                        this.ins.closeLoading();\r\n                        if (tt) {\r\n                            if (tn && data.items && data.items.length) {\r\n                                if (this.ins.useFavorite) {\r\n                                    // æ´æ°å­èç¹æ¶èç¶æ\r\n                                    this.ins.favHelper.updateFavoritesStatus(data.items);\r\n                                }\r\n\r\n                                const nodes = this.ins.checkNodeCanBeSelect(data.items, false);\r\n\r\n                                tt.appendChildren(nodes, tn);\r\n\r\n                                if (tt.loadDataType !== 'all' && !this.ins.singleSelect && this.ins.isGetAllChidlNodes &&\r\n                                    (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down') ) {\r\n                                    const rn = tt.findRowNode(tn.id);\r\n                                    tt.propagateSelectionDown(rn, rn.isChecked);\r\n\r\n                                    // æ´æ°éä¸­è®°å½ç¼å­\r\n                                    const _items = data.items.filter(n => !n.addtional);\r\n                                    if (_items && _items.length) {\r\n                                        this.ins.lookupSelectionSer.updateSelections(_items.map(n => n.data), rn.isChecked);\r\n                                    }\r\n                                }\r\n                            }\r\n                            tn['showLoading'] = false;\r\n                            tt.detectChanges();\r\n                            tt.psRef.directiveRef.update();\r\n                            this.ins.selectionMgr.selectCurrentValue();\r\n                        }\r\n                    });\r\n                }\r\n            } else {\r\n                if (!this.ins.singleSelect && this.ins.enableCascade &&\r\n                        (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down') && this.ins.isGetAllChidlNodes ) {\r\n                    const rn = tt.findRowNode(tn.id);\r\n                    tt.propagateSelectionDown(rn, rn.isChecked);\r\n                    const selectItems = tn.children.filter(n => n.selectable).map(n => n.data);\r\n                    this.ins.lookupSelectionSer.updateSelections(selectItems, rn.isChecked);\r\n                }\r\n                // this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n        });\r\n\r\n        if (loadAllData && this.ins.items) {\r\n            this.ins.treeNodeHelper.updateTreeNodeExpanded(this.ins.items);\r\n        }\r\n        return loadAllData;\r\n    }\r\n\r\n    cascadeValueChanged($event) {\r\n        const val = $event;\r\n        // const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const instanceTyp = this.ins.activeTab === 'datalist' ? 'treetable' : 'fav';\r\n        const tt = this.ins.lookupCmpMgr.getComponentInstance(instanceTyp) as TreeTableComponent;\r\n\r\n        if (!tt) {\r\n            return;\r\n        }\r\n\r\n        switch (val) {\r\n            case 'enable':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = true;\r\n                break;\r\n            case 'disable':\r\n                tt.cascadeCheck = false;\r\n                tt.cascadeDown = false;\r\n                tt.cascadeUp = false;\r\n                break;\r\n            case 'up':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeUp = true;\r\n                tt.cascadeDown = false;\r\n                break;\r\n            case 'down':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = false;\r\n                break;\r\n            default:\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = true;\r\n                break;\r\n        }\r\n\r\n        this.ins.cascadeStatus = val || 'enable';\r\n    }\r\n\r\n}\r\n","import { TreeTableComponent } from '@farris/ui-treetable';\r\nimport { FavoriteIcon, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\n\r\nexport class MultiSelectionManager {\r\n    constructor(private ins: LookupGridComponent) {}\r\n\r\n    onSelectedTableCellClick(e: any) {\r\n        if (e.col.field === FAVORITE_FIELD_NAME) {\r\n            e.event.stopPropagation();\r\n            const classList = e.event.target['classList'];\r\n            if (classList.contains('f-lookup-unfavorite')) {\r\n                const rid =  e.row[this.ins.idField];\r\n                this.ins.lookupSelectionSer.unSelect(rid);\r\n                // åæ¶éä¸­ ä¸»åè¡¨ æ¶èåè¡¨ ä¸­çæ°æ®\r\n                if (this.ins.isTree()) {\r\n                    const tt = this.ins.lookupCmpMgr.getComponentInstance('treetable') as TreeTableComponent;\r\n                    tt.unCheckedNode(rid);\r\n                    tt.unSelectNode(rid);\r\n\r\n                    if (this.ins.useFavorite) {\r\n                        const _tt = this.ins.lookupCmpMgr.getComponentInstance('fav') as TreeTableComponent;\r\n                        if (_tt.data && _tt.data.length && _tt.findRowNode(rid)) {\r\n                            _tt.unCheckedNode(rid);\r\n                            _tt.unSelectNode(rid);\r\n                        }\r\n                    }\r\n\r\n                } else {\r\n                    const dt = this.ins.lookupCmpMgr.getComponentInstance() as DataTableComponent;\r\n                    dt.unCheckRow(rid);\r\n                    if (this.ins.useFavorite) {\r\n                        const _dt = this.ins.lookupCmpMgr.getComponentInstance('fav') as DataTableComponent;\r\n                        if (_dt.data && _dt.data.length) {\r\n                            _dt.unCheckRow(rid);\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    // åå§åå·²éæ°æ®åä¿¡æ¯\r\n    initSelectedColumns() {\r\n        let selectedColumns = [];\r\n        if (this.ins.showSelected && !this.ins.singleSelect) {\r\n            selectedColumns = cloneDeep(this.ins.gridOptions.columns);\r\n            const favcol = selectedColumns.find(n => n.field === FAVORITE_FIELD_NAME);\r\n            if (favcol) {\r\n                favcol.formatter = () => {\r\n                    return FavoriteIcon.remove;\r\n                };\r\n            } else {\r\n                selectedColumns = selectedColumns.concat([\r\n                    { field: FAVORITE_FIELD_NAME, width: 80, formatter: () => {\r\n                            return FavoriteIcon.remove;\r\n                        }\r\n                    }\r\n                ]);\r\n            }\r\n        }\r\n\r\n        return selectedColumns;\r\n    }\r\n\r\n    updateSelections(data) {\r\n        if (Array.isArray(data)) {\r\n            this.ins.lookupSelectionSer.updateSelections(data, true);\r\n        } else {\r\n            this.ins.lookupSelectionSer.select(data);\r\n        }\r\n    }\r\n\r\n    remove(id: any) {\r\n        if (id) {\r\n            this.ins.lookupSelectionSer.unSelect(id);\r\n        }\r\n    }\r\n\r\n\r\n    clear() {\r\n        this.ins.lookupSelectionSer.clearSelections();\r\n    }\r\n\r\n    save(rows: any) {\r\n        if (this.ins.showSelected) {\r\n            this.ins.personalConf.selections = rows;\r\n            this.ins.personalConfigService.savePersonalConfig(this.ins.personalConf);\r\n        }\r\n    }\r\n\r\n    loadData() {\r\n        let items = this.ins.personalConf ? (this.ins.personalConf.selections || []) : [];\r\n        if (!items.length) {\r\n            items = this.ins.lookupSelectionSer.getSelections();\r\n        }\r\n        this.ins.lookupSelectionSer.loadSelections(items);\r\n    }\r\n}\r\n","import { RemoteParams, SearchParam, UserFavoriteData } from '../http/RemoteParams';\r\nimport { LOAD_DATA_TYPE } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { FavoriteAction, LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { Observable, of, forkJoin } from 'rxjs';\r\nimport { map, switchMap, tap, debounceTime } from 'rxjs/operators';\r\n\r\n// å¸®å©é»è®¤ä¸ªæ§åæ°æ®\r\nconst DefaultUserConfig = {\r\n    tabIndex: 'datalist',\r\n    favorite: null,\r\n    size: null\r\n};\r\nexport class LookupHttpManager {\r\n    // æ¯æ¬¡å¸®å©æå¼åï¼æ´æ°æ­¤å¼ï¼åä¸ºä¸ªæ§åæ°æ®çåå§å¼ï¼\r\n    // å³é­çªå£æ¶ï¼ä¸æ­¤è¿è¡å¯¹æ¯ãå¦æä¸æ ·ï¼åä¸ä¿å­ï¼\r\n    private _originalPersonalConfig = DefaultUserConfig;\r\n\r\n    constructor(private ins: LookupGridComponent) { }\r\n\r\n    private disablePagination() {\r\n        return {\r\n            pageIndex: 1,\r\n            pageSize: 500\r\n        };\r\n    }\r\n\r\n    /** æé æ¥è¯¢åæ° */\r\n    buildQueryParams(event?: any, type: LOAD_DATA_TYPE = 'all') {\r\n        const params: RemoteParams = {};\r\n\r\n        if (this.ins.condition) {\r\n            params.condition = cloneDeep(this.ins.condition);\r\n        }\r\n\r\n        const searchParam: SearchParam = { category: type };\r\n\r\n        if (type !== 'fav') {\r\n            if (this.ins.isDoublleList() && this.ins.navigationFilter && type !== 'all') {\r\n                if (this.ins.navigationFilter.idValue && type !== 'textchange') {\r\n                    params.relationFilter = [...this.ins.navigationFilter.idValue];\r\n                }\r\n            }\r\n        }\r\n        if (event) {\r\n\r\n            if (type === 'fav' || type === 'selected') {\r\n                event.pageInfo = this.disablePagination();\r\n            }\r\n\r\n\r\n            if (event.pageInfo) {\r\n                params.pageIndex = event.pageInfo.pageIndex;\r\n                params.pageSize = event.pageInfo.pageSize;\r\n            }\r\n\r\n            if (event.search) {\r\n                let sfield = event.search.field;\r\n                if (sfield && sfield === '*') {\r\n                    sfield = '*';\r\n                }\r\n\r\n                if (event.search.value) {\r\n                    event.search.value = event.search.value.trim();\r\n                }\r\n\r\n                searchParam.searchField = sfield;\r\n                searchParam.searchValue = event.search.value;\r\n                searchParam.searchType =  event.search.type || 'like';\r\n\r\n                if (event.search.value === '' &&  searchParam.category === 'search') {\r\n                    searchParam.category = 'all';\r\n                }\r\n            }\r\n\r\n            if (event.sortName) {\r\n                searchParam.sortName = event.sortName;\r\n            }\r\n            if (event.sortOrder) {\r\n                searchParam.sortOrder = event.sortOrder;\r\n            }\r\n        }\r\n\r\n        if (type === 'fav' && event.favoriteIds) {\r\n            searchParam.favoriteIds = event.favoriteIds;\r\n        }\r\n\r\n        if (this.ins.isTree() || this.ins.displayType === LookupGridDisplayType.NavTreeList) {\r\n            params.enableFullTree = this.ins.enableFullTree;\r\n        }\r\n\r\n        // æ¥è¯¢æ¶ä¸æé å®æ´æ \r\n        if (type === 'textchange') {\r\n            params.enableFullTree = false;\r\n        }\r\n\r\n        if (type === 'selected') {\r\n            searchParam.category = 'fav';\r\n            params.enableFullTree = false;\r\n            searchParam.favoriteIds = event.favoriteIds;\r\n        }\r\n\r\n        params.searchValue = JSON.stringify(searchParam);\r\n        params.loadTreeDataType = this.ins.loadTreeDataType;\r\n\r\n        params.customData = this.ins.customData;\r\n\r\n        if (this.ins.helpId) {\r\n            params.helpId = this.ins.helpId;\r\n        }\r\n\r\n        if (event.selectedInfo) {\r\n            params.selectedInfo = event.selectedInfo;\r\n        }\r\n\r\n\r\n        return params;\r\n    }\r\n\r\n\r\n    getData(event?: any, type: LOAD_DATA_TYPE = 'all'): Observable<any> {\r\n        const uri = this.ins.gridOptions.uri;\r\n\r\n        if (this.ins.isDoublleList() &&  this.ins.navigationFilter && this.ins.navigationFilter.idValue && type !== 'fav') {\r\n            type = 'list';\r\n        }\r\n\r\n        const params = this.buildQueryParams(event, type);\r\n\r\n        if (uri || this.ins.beUri) {\r\n            if (this.ins.beUri && this.ins.columns && this.ins.columns.length) {\r\n                const allSearchFields = this.ins.columns.map(col => col.searchField).filter(f => f);\r\n                if (!params.condition) {\r\n                    params.condition = {};\r\n                }\r\n\r\n                if (!this.ins.isTree() && this.ins.pagination) {\r\n                    const { pageSize = this.ins.pageSize || 20, pageIndex } = { ...params };\r\n                    params.condition.pagination = { pageSize, pageIndex };\r\n                } else {\r\n                    params.condition.pagination = { isUsePagination: false };\r\n                }\r\n                const searchParam = JSON.parse(params.searchValue);\r\n                if (searchParam.searchValue) {\r\n                    params.condition = this.ins.lookupUtils.mergeCondition(params.condition, allSearchFields, {\r\n                        field: searchParam.searchField,\r\n                        value: searchParam.searchValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            const _uri = this.ins.beUri || uri;\r\n\r\n            if (this.ins.http) {\r\n                this.ins.http.context = this.ins.context;\r\n            }\r\n            if (this.ins._searchResult) {\r\n                return of(this.ins._searchResult);\r\n            }\r\n\r\n            if (type !== 'allChildren') {\r\n                return this.ins.http.getData(_uri, params);\r\n            } else {\r\n                const params1 = {\r\n                    searchValue: JSON.stringify({ category: type }),\r\n                    parentsIds: event.parentsIds,\r\n                    customData: params.customData,\r\n                    helpId: params.helpId\r\n                };\r\n                return this.ins.http.getData(_uri, params1);\r\n            }\r\n        } else {\r\n            return of(false);\r\n        }\r\n    }\r\n\r\n    // getFavoriteData(params) {\r\n    //     return this.getData(params, 'fav');\r\n    // }\r\n\r\n    getSelecedItems(selIds: any[]) {\r\n        return this.getData({ favoriteIds: selIds }, 'selected');\r\n    }\r\n\r\n    getPersonalConfig() {\r\n        const defaultConf = cloneDeep(DefaultUserConfig);\r\n        const key = this.ins.personalConfigService._newKey;\r\n        let _conf = this.ins.personalConfigService.getPersonalData(key);\r\n\r\n        if (!_conf || !Object.keys(_conf).length) {\r\n            _conf = defaultConf;\r\n        }\r\n        const req = of(_conf);\r\n\r\n        if (this.ins.favoriteDataFrom === 'locale' || this.ins.isTabChanged) {\r\n            return req;\r\n        }\r\n\r\n        if (this.ins.http && this.ins.http['getUserSettings']) {\r\n            return this.ins.http['getUserSettings'](key).pipe(\r\n                map((ucs: any) => {\r\n                    if (ucs) {\r\n                        return ucs.textValue ? JSON.parse(ucs.textValue) : defaultConf;\r\n                    }\r\n                    return defaultConf;\r\n                })\r\n            );\r\n        } else {\r\n            return req;\r\n        }\r\n    }\r\n\r\n    lookupRequest(event?: any, type: LOAD_DATA_TYPE = 'all') {\r\n        if (!this.ins.usePersionalConf) {\r\n            return this.getData(event, type);\r\n        }\r\n\r\n        const req = this.getPersonalConfig();\r\n\r\n        return req.pipe(\r\n            tap((c: any) => {\r\n                this.ins.personalConf = c;\r\n                this.ins.personalConfigService.savePersonalConfig(c);\r\n                if (!this.ins.isTabChanged) {\r\n                    this._originalPersonalConfig = cloneDeep(c);\r\n                }\r\n            }),\r\n            switchMap((c: any) => {\r\n                const { tabIndex, favorite, size } = c;\r\n\r\n                if (!this.ins.isTabChanged) {\r\n                    this.ins.activeTab = tabIndex || 'datalist';\r\n                }\r\n\r\n                if (size) {\r\n                    this.ins.dialogWidth = size.width;\r\n                    this.ins.dialogHeight = size.height;\r\n                    this.ins.dialog.reSize({ width: size.width, height: size.height });\r\n                }\r\n\r\n                if (this.ins.activeTab === 'datalist') {\r\n                    return this.getData(event, type);\r\n                } else if (this.ins.activeTab === 'favorite') {\r\n                    const favIds = favorite ? favorite[this.ins.localService.localeId] : [];\r\n                    if ((!favIds || !favIds.length) && !this.ins.isTabChanged) {\r\n                        return this.getData(event, 'all').pipe(\r\n                            map(r => {\r\n                                if (r && !r.items) {\r\n                                    r.items = [];\r\n                                }\r\n\r\n                                r.activeTab = 'datalist';\r\n                                return r;\r\n                            })\r\n                        );\r\n                    }\r\n\r\n                    // const _fids = favIds.filter(n => n);\r\n                    event.favoriteIds = favIds;\r\n                    return this.getData(event, 'fav').pipe(\r\n                        switchMap(r => {\r\n                            if (r && !r.items) {\r\n                                r.items = [];\r\n                            }\r\n\r\n                            if (!r.items.length) {\r\n                                return this.getData(event, 'all').pipe(\r\n                                    map(a => {\r\n                                        if (a && !a.items) {\r\n                                            a.items = [];\r\n                                        }\r\n        \r\n                                        a.activeTab = 'datalist';\r\n                                        return a;\r\n                                    })\r\n                                );\r\n                            } else {\r\n                                return of(r);\r\n                            }\r\n                        })\r\n                    );\r\n                } else if (this.ins.activeTab === 'selected') {\r\n                    const selIds = this.ins.displayValue ? this.ins.displayValue.split(',') : [];\r\n                    const _sids = selIds.filter(n => n);\r\n                    return this.getSelecedItems(_sids);\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    // ä¿å­ä¸ªæ§åæ°æ®\r\n    submitFavoriteData(action: any | FavoriteAction) {\r\n        // å¦ææ°æ®ä¸é»è®¤çæ°æ®ä¸è³åä¸ä¿å­ã\r\n        if (JSON.stringify(this.ins.personalConf) === JSON.stringify(this._originalPersonalConfig)) {\r\n            return;\r\n        }\r\n\r\n        let msg = '';\r\n        if (action === FavoriteAction.add) {\r\n            msg = this.ins.addFavoriteSuccess;\r\n        } else if (action === FavoriteAction.delete) {\r\n            msg = this.ins.delFavoriteSuccess;\r\n        }\r\n\r\n        this.ins.personalConfigService.savePersonalConfig(this.ins.personalConf || {});\r\n\r\n        if (this.ins.favoriteDataFrom !== 'locale') {\r\n            this._originalPersonalConfig = cloneDeep(this.ins.personalConf);\r\n\r\n            const configData: UserFavoriteData = {\r\n                configkey1: this.ins.personalConfigService.personalConfigKey,\r\n                configkey2: '',\r\n                configkey3: '',\r\n                textvalue: JSON.stringify(this.ins.personalConf)\r\n            };\r\n\r\n            if (this.ins.http && this.ins.http['saveUserSettings']) {\r\n                this.ins.savingFaoriteData = true;\r\n                this.ins.showLoading();\r\n                return this.ins.http['saveUserSettings'](configData).subscribe((r) => {\r\n                    this.ins.savingFaoriteData = false;\r\n                    this.ins.closeLoading();\r\n                    if (msg) {\r\n                        this.ins.notifyService.success(msg);\r\n                    }\r\n                });\r\n            } else {\r\n                if (msg) {\r\n                    this.ins.notifyService.success(msg);\r\n                }\r\n            }\r\n        } else {\r\n            if (msg) {\r\n                this.ins.notifyService.success(msg);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","/*\r\n* @Author: ç¯çç§æ(Lucas Huang)\r\n* @Date: 2018-12-14 14:40:48\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-25 18:10:29\r\n* @Company: Inspur\r\n* @Version: v0.0.1\r\n*/\r\n\r\nimport { Component, OnInit, ViewChild, ViewContainerRef, EventEmitter, Output,\r\n    ComponentFactoryResolver, ComponentRef, ChangeDetectorRef, Injector, ReflectiveInjector\r\n} from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\n\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeTableComponent } from '@farris/ui-treetable';\r\n\r\nimport { LookupGridOptions, LookupGridResult } from './lookup-grid-options';\r\nimport { LookupGridComponent } from './lookup-grid.component';\r\n\r\n@Component({\r\n    selector: 'lookup-left',\r\n    templateUrl: './lookup-left.component.html'\r\n})\r\n\r\nexport class LookupLeftComponent implements OnInit {\r\n\r\n    cmpRef: ComponentRef<any>;\r\n    navOptions: LookupGridOptions;\r\n    lookupCmp: LookupGridComponent;\r\n\r\n\r\n    @ViewChild('container', {read: ViewContainerRef}) cmpContainer: ViewContainerRef;\r\n    @Output() selected = new EventEmitter<{ data: any}>();\r\n    @Output() unselected = new EventEmitter();\r\n    @Output() search = new EventEmitter<{ field: string, value: string }>();\r\n    @Output() pageChanged = new EventEmitter<{ pageInfo: {pageIndex: number, pageSize: number}, search: {field: string, value: string} }>();\r\n\r\n    private _searchState = null;\r\n    private allData = null;\r\n\r\n    constructor(private cfr: ComponentFactoryResolver, private cd: ChangeDetectorRef) { }\r\n\r\n    ngOnInit() {\r\n    }\r\n\r\n    createComponent(): Observable<any> {\r\n        let dtFac = null;\r\n        if (!this.isTreeList()) {\r\n            dtFac = this.cfr.resolveComponentFactory(DataTableComponent);\r\n        } else {\r\n            dtFac = this.cfr.resolveComponentFactory(TreeTableComponent);\r\n        }\r\n        this.navOptions['keepSelect'] = false;\r\n        // å·¦ä¾§æ¥è¯¢è¿æ»¤æ¡ï¼éèæï¼\r\n        this.navOptions['showFilterBar'] = true;\r\n        // if (this.navOptions.width) {\r\n        //     this.navOptions.width = this.navOptions.width - 2;\r\n        // }\r\n\r\n        this.navOptions.width = this.lookupCmp.leftPanelWidth - 2;\r\n\r\n        // const injector: Injector = ReflectiveInjector.resolveAndCreate([\r\n        //     { provide: DataTableService, useFactory: () => { new DataTableService()}}\r\n        // ]);\r\n\r\n        this.cmpRef = this.cmpContainer.createComponent(dtFac);\r\n\r\n        if (!this.isTreeList()) {\r\n            this.navOptions['fill'] = true;\r\n            this.cmpRef.instance.maxSize = 5;\r\n            this.cmpRef.instance.fill = true;\r\n        } else {\r\n            this.navOptions['fit'] = true;\r\n        }\r\n        // this.cmpRef.instance.fit = true;\r\n\r\n        if (this.navOptions.pageInfo) {\r\n            if (this.navOptions.pageInfo.pageList) {\r\n                this.navOptions.pageList = this.navOptions.pageInfo.pageList;\r\n            }\r\n            this.navOptions.pagination = this.navOptions.pageInfo.enablePager;\r\n            this.navOptions.pageIndex = this.navOptions.pageInfo.pageIndex;\r\n            this.navOptions.pageSize = this.navOptions.pageInfo.pageSize;\r\n        } else {\r\n            this.navOptions.pagination = false;\r\n        }\r\n\r\n        Object.assign(this.cmpRef.instance, this.navOptions);\r\n\r\n        this.loadData();\r\n        return of(this.cmpRef);\r\n    }\r\n\r\n    update() {\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    resize(size?: {width: number, height: number}) {\r\n        if (size) {\r\n            size.width = size.width - 2;\r\n            // if (this.cmpRef.instance instanceof TreeTableComponent) {\r\n            //     size.height += 46;\r\n            // }\r\n            this.cmpRef.instance.resize(size);\r\n        }\r\n    }\r\n\r\n    isTreeList() {\r\n        return this.navOptions.displayType.toLowerCase() === 'treelist';\r\n    }\r\n\r\n    private selectLeftDataTableRow(items: any, dt: DataTableComponent) {\r\n        if (items && items.length) {\r\n            let item = null;\r\n            if (this.lookupCmp.navSelectedIds) {\r\n                item = items.find(n => n[dt.idField] == this.lookupCmp.navSelectedIds);\r\n            } else {\r\n                if (this.lookupCmp.selectFirstInNav) {\r\n                    item = items[0];\r\n                }\r\n            }\r\n\r\n            if (item) {\r\n                dt.dtBody.selectedRowIndex = -1;\r\n                dt.dtBody.selectedRow('', 0, item);\r\n            }\r\n        }\r\n    }\r\n\r\n    private closeLoading() {\r\n        this.lookupCmp.closeLoading();\r\n    }\r\n\r\n    private initDataTable(dt: DataTableComponent) {\r\n        dt.loadData({\r\n            pageSize: this.navOptions.pageSize,\r\n            pageIndex: this.navOptions.pageIndex,\r\n            total: this.navOptions.total,\r\n            data: this.navOptions.items,\r\n        });\r\n\r\n        dt.resize({ width: 320, height: this.navOptions.height});\r\n        // è¡éä¸­\r\n        dt.selectedRow.subscribe(d => {\r\n            this.selected.emit({ data: d.data });\r\n        });\r\n\r\n        dt.unSelectRow.subscribe(d => {\r\n            this.selected.emit(null);\r\n        });\r\n\r\n        const p = { pageInfo: { pageIndex: 1, pageSize: this.navOptions.pageSize }, search: '' };\r\n\r\n\r\n        const loadTableData = {\r\n            next: (data: LookupGridResult) => {\r\n                this.closeLoading();\r\n                dataTableReLoad(data);\r\n            },\r\n            error: (err) => {\r\n                this.closeLoading();\r\n            }\r\n        };\r\n\r\n        // æ¥è¯¢\r\n        dt.search.subscribe( searchData => {\r\n            this._searchState = searchData;\r\n            this.search.emit(searchData);\r\n            p.search = searchData;\r\n            p.pageInfo.pageSize = dt.pageSize;\r\n            this.lookupCmp.navigationFilter = null;\r\n            this.lookupCmp.httpMgr.getData(p, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        const dataTableReLoad = (data) => {\r\n            dt.loadData({\r\n                pageSize: data.pageInfo.pageSize,\r\n                pageIndex: data.pageInfo.pageIndex,\r\n                total: data.total,\r\n                data: data.items,\r\n            });\r\n\r\n            this.selectLeftDataTableRow(data.items, dt);\r\n            dt.cd.markForCheck();\r\n        };\r\n\r\n        // åé¡µ\r\n        dt.pageChanged.subscribe(d => {\r\n            this.pageChanged.emit(d);\r\n            this.lookupCmp.navigationFilter = null;\r\n            this.lookupCmp.httpMgr.getData(d, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.pageSizeChanged.subscribe((e) => {\r\n            this.lookupCmp.navigationFilter = null;\r\n            this.lookupCmp.httpMgr.getData(e, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.columnSorted.subscribe( (sort: {sortName: string, sortOrder: any}) => {\r\n            const { sortName, sortOrder } = {...sort};\r\n            this.lookupCmp.navigationFilter = null;\r\n            const param = Object.assign({ sortName, sortOrder }, this._searchState);\r\n            this.lookupCmp.httpMgr.getData(param, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.clearSearchValue.subscribe( () => {\r\n            this._searchState = null;\r\n        });\r\n\r\n        this.selectLeftDataTableRow(this.navOptions.items, dt);\r\n    }\r\n\r\n    private initTreeTable(tt: TreeTableComponent) {\r\n        tt.virtualized = true;\r\n        tt.nodeSelected.subscribe(d => {\r\n            this.selected.emit({data: d.node.data});\r\n        });\r\n\r\n        tt.nodeUnSelect.subscribe(d => {\r\n            this.selected.emit(null);\r\n        });\r\n\r\n        tt.fixedHeader = true;\r\n\r\n        // tt.fit = true;\r\n        this.lookupCmp.treeNodeHelper.updateTreeNodeExpanded(this.navOptions.items, this.navOptions.treeInfo);\r\n\r\n        tt.loadDataType = this.navOptions.treeInfo.loadDataType;\r\n        // æ£æ¥å®æ´æ è¿æ»¤æ¡ä»¶ By Lucas 20200302\r\n        this.navOptions.items = this.lookupCmp.checkNodeCanBeSelect(this.navOptions.items, this.navOptions.treeInfo.loadDataType === 'all');\r\n        tt.loadData(this.navOptions.items);\r\n\r\n        if (this.lookupCmp.navSelectedIds) {\r\n            tt.selectNode(this.lookupCmp.navSelectedIds);\r\n        } else if (this.lookupCmp.selectFirstInNav) {\r\n            tt.selectFirstNode();\r\n        }\r\n\r\n        this.allData = this.navOptions.items;\r\n\r\n        const loadTreeData = {\r\n            next: (resData: any) => {\r\n                this.closeLoading();\r\n                tt.clearAll();\r\n                const items = this.lookupCmp.checkNodeCanBeSelect(resData.items, this.navOptions.treeInfo.loadDataType === 'all');\r\n                tt.loadData(items);\r\n                tt.resize();\r\n            },\r\n            error: (err) => {\r\n                this.closeLoading();\r\n            }\r\n        };\r\n\r\n\r\n        tt.search.subscribe(search => {\r\n            this._searchState = search;\r\n            this.lookupCmp.navigationFilter = null;\r\n            this.lookupCmp.httpMgr.getData({ search }, 'navsearch').subscribe(loadTreeData);\r\n        });\r\n\r\n        tt.columnSorted.subscribe( (sort: {sortName: string, sortOrder: any}) => {\r\n            this.lookupCmp.navigationFilter = null;\r\n            if (tt.loadDataType === 'all') {\r\n                tt.clientSort();\r\n            } else {\r\n                const { sortName, sortOrder } = {...sort};\r\n\r\n                const param = Object.assign({ sortName, sortOrder }, this._searchState);\r\n                this.lookupCmp.httpMgr.getData(param, 'nav').subscribe(loadTreeData);\r\n            }\r\n        });\r\n\r\n        tt.clearSearchValue.subscribe( () => {\r\n            this._searchState = null;\r\n            tt.loadData(this.allData);\r\n        });\r\n\r\n\r\n        tt.expand.subscribe((tn: any) => {\r\n            this.onNodeExpanded(tn, tt);\r\n        });\r\n    }\r\n\r\n\r\n    private onNodeExpanded(tn: any, tt) {\r\n        if (tn.leaf) {\r\n            return;\r\n        }\r\n        if (!tn.children || !tn.children.length) {\r\n            const treeInfo = this.navOptions.treeInfo;\r\n            if (this.navOptions.treeInfo.loadDataType === 'async') {\r\n                let parentPath = '';\r\n                let parentLayer = -1;\r\n                const { field = '*', value = '' } = {\r\n                    ...tt.searchData\r\n                };\r\n\r\n                tn['showLoading'] = true;\r\n                tt.detectChanges();\r\n                if (treeInfo.layerType === 'parentId') {\r\n                    // ç¶IDå è½½æ¹å¼\r\n                    parentPath = tn['id'];\r\n                } else {\r\n                    const treeInfoField = treeInfo.dataField;\r\n                    if (treeInfoField) {\r\n                        parentPath = tn.data[treeInfoField][treeInfo.pathField];\r\n                        parentLayer = tn.data[treeInfoField][treeInfo.layerField];\r\n                    } else {\r\n                        console.log('æªæ¾å°åçº§ä¿¡æ¯ã');\r\n                    }\r\n                }\r\n\r\n                if (!this.lookupCmp.uri) {\r\n                    this.lookupCmp.expandTreeNode.emit({\r\n                        instance: tt, node: tn,\r\n                        parentIdOrPath: parentPath, parentLayer, search: { value, field }\r\n                    });\r\n\r\n                    return;\r\n                }\r\n                this.getChildren(\r\n                    parentPath, parentLayer, {searchField: field === '*' ? '*' : field, searchValue: value}, tt\r\n                ).subscribe(data => {\r\n                    if (tt) {\r\n                        if (tn && data.items && data.items.length) {\r\n                            tt.appendChildren(data.items, tn);\r\n                        }\r\n                        tn['showLoading'] = false;\r\n                        tt.detectChanges();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private getChildren( parentPath, parentLayer, searchData: { searchField: string; searchValue: string }, tt ): Observable<any> {\r\n        const uri = this.lookupCmp.gridOptions.uri;\r\n        const search = { parentLayer, category: 'nav', ...searchData };\r\n        if (this.navOptions.treeInfo.layerType === 'parentId') {\r\n            search['parentId'] = parentPath;\r\n        } else {\r\n            search['parentPath'] = parentPath;\r\n        }\r\n\r\n        const param = {\r\n            searchValue: JSON.stringify(search),\r\n            customData: this.lookupCmp.customData,\r\n            enableFullTree: false,\r\n            loadTreeDataType: 'layerload'\r\n        };\r\n\r\n        if (this.lookupCmp.helpId) {\r\n            param['helpId'] = this.lookupCmp.helpId;\r\n        }\r\n\r\n        if (tt && tt.sortName) {\r\n            Object.assign(param, {\r\n                sortName: tt.sortName,\r\n                sortOrder: tt.sortOrder\r\n            });\r\n        }\r\n\r\n        return this.lookupCmp.http.getData(uri , param);\r\n    }\r\n\r\n\r\n    loadData() {\r\n        this.cmpRef.instance.allColumnsTitle = this.lookupCmp.allColumnsTitle;\r\n        if (!this.isTreeList()) {\r\n            const dt = this.cmpRef.instance as DataTableComponent;\r\n            this.initDataTable(dt);\r\n        } else {\r\n            const tt = this.cmpRef.instance as TreeTableComponent;\r\n            this.initTreeTable(tt);\r\n        }\r\n    }\r\n}\r\n","import { ComponentRef } from '@angular/core';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { of } from 'rxjs';\r\nimport { debounceTime, switchMap } from 'rxjs/operators';\r\nimport { ComponentInstanceType } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupLeftComponent } from '../lookup-left.component';\r\n\r\n\r\nexport class LookupComponentManager {\r\n    constructor(private ins: LookupGridComponent) {}\r\n\r\n    getComponentInstance(type: ComponentInstanceType = 'datatable') {\r\n        if (!this.ins.componentRef || !this.ins.componentRef.instance) {\r\n            return null;\r\n        }\r\n\r\n        if (type === 'selected') {\r\n            return this.ins.multiSelectDT;\r\n        }\r\n\r\n        let ins = this.ins.componentRef.instance;\r\n\r\n        if (type === 'leftDataTable' || type === 'leftTree') {\r\n            const leftRef = this.ins.leftComponentRef;\r\n            if (!leftRef || !leftRef.instance || !leftRef.instance.cmpRef || !leftRef.instance.cmpRef.instance) {\r\n                return null;\r\n            }\r\n            ins = this.ins.leftComponentRef.instance.cmpRef.instance;\r\n        }\r\n\r\n        if (type === 'fav') {\r\n            ins = this.ins.favoritesComponentRef.instance;\r\n        }\r\n\r\n        switch (type) {\r\n            case 'leftDataTable':\r\n            case 'fav':\r\n            case 'datatable':\r\n                return ins as DataTableComponent;\r\n            case 'leftTree':\r\n            case 'treetable':\r\n                return ins as TreeTableComponent;\r\n            default:\r\n                if (this.ins.isTree()) {\r\n                    return ins as TreeTableComponent;\r\n                }\r\n                return ins as DataTableComponent;\r\n        }\r\n    }\r\n\r\n    createComponentWithServerData(data: any) {\r\n        if (this.ins.componentRef) {\r\n            return;\r\n        }\r\n        this.ins.idField = data.idField || this.ins.idField;\r\n        this.ins.textField = data.textField || this.ins.textField;\r\n        this.ins.valueField = data.valueField || this.ins.valueField;\r\n\r\n        this.ins.displayType = (data && data.displayType) || this.ins.displayType || 'LIST';\r\n        this.ins.componentRef = this.createContent(this.ins.gridOptions);\r\n        this.createFavoriteComponent();\r\n\r\n        this.resizeComponent();\r\n    }\r\n\r\n\r\n    createFavoriteComponent() {\r\n        if (this.ins.useFavorite && !this.ins.favoritesComponentRef) {\r\n            this.ins.favoriteColumns = this.ins.favHelper.getFavoriteColumns();\r\n            const favoritesOptions = Object.assign({}, this.ins.gridOptions, {\r\n                showFilterBar: false,\r\n                pagination: false,\r\n                columns: this.ins.favoriteColumns || []\r\n            });\r\n            this.ins.favoritesComponentRef = this.createFavoritesContent(favoritesOptions);\r\n\r\n            this.resizeComponent('fav');\r\n        }\r\n    }\r\n\r\n\r\n    private reloadTreeDataForExpand(expandLevel) {\r\n        const uri = this.ins.gridOptions.uri;\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const { field = '*', value = '' } = {\r\n            ...tt.searchData\r\n        };\r\n        const search = { category: 'all', searchValue: value, searchField: field, layerNum: expandLevel };\r\n\r\n\r\n        const param = {\r\n            searchValue: JSON.stringify(search),\r\n            customData: this.ins.customData,\r\n            enableFullTree: this.ins.enableFullTree,\r\n            loadTreeDataType: this.ins.loadTreeDataType\r\n        };\r\n\r\n\r\n        if (this.ins.helpId) {\r\n            param['helpId'] = this.ins.helpId;\r\n        }\r\n\r\n        if (tt && tt.sortName) {\r\n            Object.assign(param, {\r\n                sortName: tt.sortName,\r\n                sortOrder: tt.sortOrder\r\n            });\r\n        }\r\n        this.ins.showLoading();\r\n        return this.ins.http.getData(uri, param).subscribe((data: any) => {\r\n            this.ins.closeLoading();\r\n            const nodes = this.ins.checkNodeCanBeSelect(data.items, expandLevel === -1);\r\n            this.ins.items = nodes;\r\n            tt.loadData(nodes);\r\n        });\r\n    }\r\n\r\n    private setTreeNodeExpandBy(nodes: TreeNode[], level) {\r\n        if (!nodes || !nodes.length) {\r\n            return;\r\n        }\r\n        nodes.forEach((n: TreeNode) => {\r\n            const layer = n.data[this.ins.treeInfo.dataField].layer;\r\n\r\n            const expandLayer = layer + level - 1;\r\n\r\n            n.expanded = layer <= expandLayer ? true : n.expanded;\r\n            if (n.children && n.children.length && layer + 1 <= expandLayer) {\r\n                this.setTreeNodeExpandBy(n.children, level);\r\n            }\r\n        });\r\n    }\r\n\r\n    // å¯ç¨æ å¸®å©å³é®èååè½\r\n    private useContextMenuForTree(cmpRef: ComponentRef<any>) {\r\n        const { maxLevel, enableContextMenu, language } = this.ins.treeTableOptions;\r\n        if (enableContextMenu && maxLevel) {\r\n            const levelMenus = [];\r\n            for (let i = 1; i <= maxLevel; i++) {\r\n                const title = language['expand' + i];\r\n                levelMenus.push({ id: 30 + 1, code: i, title, handle: (t) => {\r\n                    // åéè¯·æ±è·åæ°æ®\r\n                    const level = t.menu.code;\r\n                    if (isLoadAllTreeData() ) {\r\n                        this.setTreeNodeExpandBy(this.ins.items, level);\r\n                        cmpRef.instance.updateSerializedValue();\r\n                    } else {\r\n                        const { dataField, layerField } = this.ins.treeInfo;\r\n                        const firstNodeData = (this.ins.items || [])[0];\r\n                        if (firstNodeData && firstNodeData.data) {\r\n                            const minLayer = this.ins.utils.getValue(`${dataField}.${layerField}`, firstNodeData.data);\r\n                            let _level = minLayer + level - 1;\r\n                            this.reloadTreeDataForExpand(_level);\r\n                        }\r\n                    }\r\n                } });\r\n            }\r\n\r\n            const isLoadAllTreeData = () => {\r\n                if (this.ins.loadTreeDataType === 'default') {\r\n                    return cmpRef.instance.loadDataType === 'all';\r\n                } else {\r\n                    return this.ins.loadTreeDataType === 'loadall';\r\n                }\r\n            };\r\n\r\n            const contextMenus = [\r\n                {\r\n                    id: 1, code: 'expandall', title: language.expandall, handle: (t) => {\r\n                        if (cmpRef && isLoadAllTreeData()) {\r\n                            cmpRef.instance.expandAll();\r\n                        } else {\r\n                            // åéè¯·æ±è·åæ°æ®\r\n                            this.reloadTreeDataForExpand(-1);\r\n                        }\r\n                    }\r\n                },\r\n                { id: 2, code: 'collapseall', title: language.collapseall, handle: (t) => {\r\n                    if (cmpRef) {\r\n                        cmpRef.instance.collapseAll();\r\n                    }\r\n                } },\r\n                '-',\r\n                {\r\n                    id: 3, title: language.expandByLayer,\r\n                    children: levelMenus\r\n                }\r\n            ];\r\n            this.ins.treeTableOptions.contextMenuItems = contextMenus;\r\n\r\n            cmpRef.instance.beforeShowContextMenu = () => {\r\n                return of({show: !cmpRef.instance.state.searched});\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    createContent(opts: any): ComponentRef<any> {\r\n\r\n        if (this.ins.componentRef) {\r\n            return;\r\n        }\r\n\r\n        const type = this.ins.getComponentType();\r\n\r\n        const dtFac = this.ins.cfr.resolveComponentFactory(type);\r\n        let cmpRef: ComponentRef<any> = null;\r\n        if (this.ins.isDoublleList()) {\r\n            cmpRef = this.ins.centerContainer.createComponent(dtFac);\r\n        } else {\r\n            cmpRef = this.ins.contentContainer.createComponent(dtFac);\r\n        }\r\n\r\n        if (this.ins.isTree()) {\r\n            opts.fit = true;\r\n            opts.pagination = false;\r\n            if (this.ins.useFavorite) {\r\n                opts.fitColumns = false;\r\n                opts.autoFitColumns = true;\r\n            }\r\n\r\n            this.useContextMenuForTree(cmpRef);\r\n        } else {\r\n            opts.fill = true;\r\n        }\r\n\r\n        const ttOpts = this.ins.treeTableOptions || {};\r\n        Object.assign(cmpRef.instance, opts, { allColumnsTitle: this.ins.allColumnsTitle, ...ttOpts });\r\n\r\n        this.ins.componentRef = cmpRef;\r\n        this.resizeComponent();\r\n        return cmpRef;\r\n    }\r\n\r\n    // åå»ºæ¶èCMP\r\n    createFavoritesContent(opts: any): ComponentRef<any> {\r\n\r\n        const type = this.ins.getComponentType();\r\n\r\n        const dtFac = this.ins.cfr.resolveComponentFactory(type);\r\n        let cmpRef = null;\r\n        cmpRef = this.ins.favoritesContainer.createComponent(dtFac);\r\n\r\n        if (this.ins.isTree()) {\r\n            opts.fit = true;\r\n            opts.pagination = false;\r\n        } else {\r\n            opts.fill = true;\r\n        }\r\n\r\n        Object.assign(cmpRef.instance, opts, {\r\n            width: this.ins.dialog.size.width - 20,\r\n            height: this.ins.dialogMgr.getHeight()\r\n        });\r\n\r\n\r\n        // è®¢éæ¶èå¤¹åè¡¨ä¸­ç»ä»¶çç¸å³äºä»¶\r\n        this.ins.favHelper.initFavoriteComponentEvent(cmpRef);\r\n\r\n        return cmpRef;\r\n    }\r\n\r\n    resizeComponent(type: ComponentInstanceType = 'datatable') {\r\n        const size = {\r\n            width: this.ins.dialog.size.width - 20,\r\n            height: this.ins.dialogMgr.getHeight()\r\n        };\r\n\r\n        if (this.ins.isDoublleList() && (type === 'datatable' || type === 'treetable')) {\r\n            size.width = this.ins.dialog.size.width - this.ins.leftPanelWidth - 27;\r\n        }\r\n\r\n        this.getComponentInstance(type).resize(size);\r\n    }\r\n\r\n    /** åå»ºå·¦ä¾§ç»ä»¶ */\r\n    createLeftComponent(ops: any) {\r\n        let dtFac = null;\r\n        if (this.ins.isDoublleList()) {\r\n            dtFac = this.ins.cfr.resolveComponentFactory(LookupLeftComponent);\r\n        }\r\n        this.ins.leftComponentRef = this.ins.leftContainer.createComponent(dtFac);\r\n        ops.height = this.ins.dialogMgr.getHeight();\r\n\r\n        if (this.ins.dialogWidth < this.ins.navLookupDialogMinWidth) {\r\n            this.ins.dialogWidth = this.ins.navLookupDialogMinWidth;\r\n            this.ins.dialog.reSize({ width: this.ins.dialogWidth });\r\n            this.ins.resizeCmp({ width: this.ins.dialog.size.width });\r\n        }\r\n\r\n        if (ops.width !== this.ins.leftPanel.width) {\r\n            // é»è®¤ 1 : 2\r\n            this.ins.leftPanel.resize({\r\n                width: this.ins.leftPanel.width,\r\n                height: ops.height\r\n            });\r\n            this.ins.resizeCmp({ width: this.ins.dialog.size.width });\r\n        }\r\n\r\n        // this.resizeComponent();\r\n\r\n        this.ins.leftComponentRef.instance.lookupCmp = this.ins;\r\n        this.ins.leftComponentRef.instance.navOptions = ops;\r\n\r\n\r\n        this.ins.leftComponentRef.instance.selected\r\n            .pipe(\r\n                debounceTime(100),\r\n                switchMap((d: any) => {\r\n                    if (d && d.data) {\r\n                        this.ins.navigationFilter = {\r\n                            selected: d.data,\r\n                            idValue: this.getNavigationFilter(d.data),\r\n                            searchField: '',\r\n                            searchValue: ''\r\n                        };\r\n                    } else {\r\n                        this.ins.navigationFilter = undefined;\r\n                    }\r\n                    // å è½½å³ä¾§æ°æ®\r\n                    const p = {\r\n                        pageInfo: {\r\n                            pageIndex: this.ins.gridOptions.pageIndex,\r\n                            pageSize: this.ins.gridOptions.pageSize\r\n                        }\r\n                    };\r\n                    Object.assign(p, { search: this.ins._searchState });\r\n                    return this.ins.httpMgr.getData(p, 'list');\r\n                })\r\n            )\r\n            .subscribe(res => {\r\n                this.ins.closeLoading();\r\n                this.ins.loadDataWhenOpen = true;\r\n\r\n                if (this.ins.useFavorite && !this.ins.isTree()) {\r\n                    this.ins.favHelper.updateFavoritesStatus(res.items);\r\n                }\r\n\r\n                this.ins.loadDataTableData(res);\r\n                setTimeout(() => {\r\n                    // éä¸­æ°æ®\r\n                    this.ins.selectionMgr.selectCurrentValue();\r\n                    this.ins.changeDetector.detectChanges();\r\n                });\r\n            });\r\n\r\n        return this.ins.leftComponentRef.instance.createComponent();\r\n    }\r\n\r\n    // è·åå³èæ°æ®, å³ä¾§æ°æ®ä¸­ å³èåå­æ®µçå¼\r\n    private getNavigationFilter(navRow: any) {\r\n        if (this.ins.navigationOptions.relations && this.ins.navigationOptions.relations.length) {\r\n            const result = [];\r\n            this.ins.navigationOptions.relations.forEach(r => {\r\n                const k = r.groupField;\r\n                const dField = r.helpField;\r\n                const rf = { fieldName: dField, fieldValue: '' };\r\n                rf.fieldValue = k.split('.').reduce((o, c) => {\r\n                    return o[c];\r\n                }, navRow);\r\n\r\n                result.push(rf);\r\n            });\r\n            return result;\r\n        }\r\n\r\n        return '';\r\n    }\r\n}\r\n","import { Subscription } from 'rxjs';\r\nimport { PickingResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\nexport class LookupDialogManager {\r\n\r\n    private lookupInit: Subscription = null;\r\n    private _loadDataWhenOpen = true;\r\n    private _navSelectedId = '';\r\n    private _selectFirstInNav = false;\r\n\r\n    private keyDownHandler = null;\r\n\r\n    constructor(private ins: LookupGridComponent) { }\r\n    // å¸®å©çªå£å³é­ååä¸äºæ¸çå·¥ä½\r\n    dialogClosed() {\r\n        if (this.ins.displayText !== this.ins.originalText && !this.ins.nosearch) {\r\n            this.ins.displayText = this.ins.originalText;\r\n            this.ins.setModelValue(this.ins.displayText);\r\n        }\r\n\r\n        if (this.ins.componentRef) {\r\n            this.ins.componentRef.destroy();\r\n            this.ins.componentRef = null;\r\n        }\r\n\r\n        if (this.ins.favoritesComponentRef) {\r\n            this.ins.favoritesComponentRef.destroy();\r\n            this.ins.favoritesComponentRef = null;\r\n        }\r\n\r\n        if (this.ins.contentContainer) {\r\n            this.ins.contentContainer.clear();\r\n        }\r\n\r\n        if (this.ins.centerContainer) {\r\n            this.ins.centerContainer.clear();\r\n        }\r\n\r\n        if (this.ins.leftComponentRef) {\r\n            this.ins.leftComponentRef.destroy();\r\n            this.ins.leftComponentRef = null;\r\n        }\r\n\r\n        if (this.ins.leftContainer) {\r\n            this.ins.leftContainer.clear();\r\n        }\r\n\r\n\r\n        this.ins.isShow = false;\r\n        this.ins.isTextChange = false;\r\n        if (this.ins.dialog) {\r\n            this.ins.content = null;\r\n        }\r\n\r\n        this.ins.navigationFilter = null;\r\n\r\n        this.ins.lookupUtils.pendingEnd();\r\n\r\n        if (this.ins.helpId) {\r\n            this.ins.displayType = '';\r\n        }\r\n\r\n        if (this.lookupInit) {\r\n            this.lookupInit.unsubscribe();\r\n            this.lookupInit = null;\r\n        }\r\n\r\n        // this.ins.items = [];\r\n        this.ins.favoriteItems = [];\r\n        this.ins.isTabChanged = false;\r\n\r\n        if (this.ins.uri) {\r\n            this.ins.items = [];\r\n        }\r\n        this.ins._searchState = null;\r\n\r\n\r\n        this.ins.pageIndex = 1;\r\n\r\n        this.ins.loadDataWhenOpen = this._loadDataWhenOpen;\r\n        this.ins.navSelectedIds = this._navSelectedId;\r\n        this.ins.selectFirstInNav = this._selectFirstInNav;\r\n\r\n        this.ins.isGetAllChidlNodes = false;\r\n\r\n        this.ins.enableGetAllChildNodes = true;\r\n\r\n        // ä¿å­ä¸ªæ§åæ°æ®\r\n        if (this.ins.usePersionalConf && this.ins.favoriteDataFrom !== 'locale') {\r\n            this.ins.httpMgr.submitFavoriteData('dialog closed event.');\r\n        }\r\n\r\n        if (this.keyDownHandler) {\r\n            this.keyDownHandler();\r\n            this.keyDownHandler = null;\r\n        }\r\n        if (this.ins.inputGroup) {\r\n            this.ins.inputGroup.focus();\r\n        }\r\n\r\n        this.ins.userInitialConfig.reset();\r\n\r\n        this.ins.treeInfo = this.ins._treeInfo_;\r\n\r\n        this.ins.lookupUtils.destroy();\r\n        this.ins.dialogClosed.emit();\r\n    }\r\n\r\n    onDialogCreated() {\r\n        this._loadDataWhenOpen = this.ins.loadDataWhenOpen;\r\n        this._navSelectedId = this.ins.navSelectedIds;\r\n        this._selectFirstInNav = this.ins.selectFirstInNav;\r\n\r\n        this.ins.dialogCreatedSubscription = this.ins.dialogCreated.subscribe(dlg => {\r\n            if (dlg) {\r\n                if (this.ins.dialogOpenedSubscription) {\r\n                    this.ins.dialogOpenedSubscription.unsubscribe();\r\n                }\r\n                if (this.ins.dialogClosedSubscription) {\r\n                    this.ins.dialogClosedSubscription.unsubscribe();\r\n                }\r\n                this.registerDialogEvent();\r\n                if (this.ins.isRecordSize) {\r\n                    const dlgSize = this.ins.personalConfigService.getDialogSize();\r\n                    if (dlgSize) {\r\n                        const { width, height } = dlgSize;\r\n                        this.ins.dialogWidth = width ? width : this.ins.dialogWidth;\r\n                        this.ins.dialogHeight = height ? height : this.ins.dialogHeight;\r\n\r\n                        // 20200908 æ´æ°ç°çªå£çå°ºå¯¸ by Lucas\r\n                        dlg.width = this.ins.dialogWidth;\r\n                        dlg.height = this.ins.dialogHeight;\r\n                    }\r\n                }\r\n                dlg.show();\r\n            }\r\n        });\r\n    }\r\n\r\n    checkDictPickingResult(pr: PickingResult | any) {\r\n        let o = true;\r\n        if (pr === undefined || pr === null || pr === '') {\r\n            o = true;\r\n        }\r\n\r\n        if (typeof pr === 'boolean') {\r\n            o = pr;\r\n        }\r\n\r\n        let customData, selectedIds, message;\r\n\r\n        if (typeof pr === 'object') {\r\n            if (pr.showDialog === undefined) {\r\n                o = true;\r\n            } else {\r\n                o = pr.showDialog;\r\n            }\r\n\r\n            if (pr.hasOwnProperty('data')) {\r\n                /** ä¿å­å¸®å©åä¼ éçæ°æ® */\r\n                customData = pr.data;\r\n            }\r\n            selectedIds = pr.selectedIds || null;\r\n\r\n            if (pr.message) {\r\n                message = pr.message;\r\n            }\r\n        }\r\n\r\n        return { show: o, customData, selectedIds, message };\r\n    }\r\n\r\n    canOpenDialog(pr: PickingResult | any) {\r\n        const {show, customData, selectedIds, message} = this.checkDictPickingResult(pr);\r\n        this.ins.customData = customData;\r\n        this.ins.selectedIds = selectedIds || null;\r\n        if (message) {\r\n            this.ins.notifyService.warning(message);\r\n        }\r\n\r\n        this.ins.isReady = false;\r\n        this.ins.isShow = show;\r\n    }\r\n\r\n    getHeight() {\r\n        return this.ins.dialog.size.contentHeight -\r\n                this.ins.containerMargin.bottom -\r\n                this.ins.containerMargin.top -\r\n                (this.ins.useFavorite ? 40 : 0);\r\n    }\r\n\r\n\r\n    private getMainGridSize() {\r\n        if (this.ins.isDoublleList()) {\r\n            return {\r\n                width: this.ins.dialog.size.width - this.ins.leftPanel.width - 27,\r\n                height: this.getHeight()\r\n            };\r\n        }\r\n\r\n        return {\r\n            width: this.ins.dialog.size.width - this.ins.containerMargin.left - this.ins.containerMargin.right,\r\n            height: this.getHeight()\r\n        };\r\n    }\r\n\r\n    resetDialogContentHeight() {\r\n        const { header: hHeight, footer: fHeight } = this.ins.dialog.size;\r\n        return this.ins.dialogHeight - hHeight - fHeight -  this.ins.containerMargin.bottom - this.ins.containerMargin.top;\r\n    }\r\n\r\n    /** æ³¨åå¼¹åºçªå£çäºä»¶ */\r\n    private registerDialogEvent() {\r\n        this.ins.dialogOpenedSubscription = this.ins.dialog.opened.subscribe(() => {\r\n            \r\n            this.ins.dialogContentHeight = this.resetDialogContentHeight();\r\n\r\n            this.ins.gridOptions = Object.assign(this.ins.gridOptions, this.getMainGridSize());\r\n            this.ins.dialog.el.nativeElement.querySelector('.ps-content').style.height = '100%';\r\n\r\n            if (this.ins.displayType && this.ins.customDisplayType) {\r\n                this.ins.componentRef = this.ins.lookupCmpMgr.createContent(this.ins.gridOptions);\r\n                this.ins.lookupCmpMgr.createFavoriteComponent();\r\n            }\r\n\r\n            this.ins.initData();\r\n\r\n            // ä¿®æ¹å¸®å©çªå£çç¶æ\r\n            this.ins.lookupUtils.pendingEnd();\r\n            this.ins.dialogOpened.emit();\r\n        });\r\n\r\n        this.ins.subscriptions.push(this.ins.dialogOpenedSubscription);\r\n\r\n        this.lookupInit = this.ins.lookupinitializationSubject.subscribe(() => {\r\n            this.ins.loadDataWhenOpen = true;\r\n            // æ³¨åå¿«æ·é®\r\n            this.registerShortcutKey();\r\n            // çå¬å·¦ä¾§å°ºå¯¸ååäºä»¶\r\n            if (this.ins.leftPanel) {\r\n                const leftPanelResize$ = this.ins.leftPanel.resizing.subscribe((s: any) => {\r\n                    this.ins.componentRef.instance.resize({\r\n                        width: this.ins.dialog.size.width - s.size.width - 27,\r\n                        height: this.getHeight()\r\n                    });\r\n                    this.ins.leftComponentRef.instance.resize(s.size);\r\n                });\r\n\r\n                this.ins.subscriptions.push(leftPanelResize$);\r\n            }\r\n        });\r\n\r\n        this.ins.dialogClosedSubscription = this.ins.dialog.closed.subscribe(() => {\r\n            // è¾å¥æ¡åååï¼å¼¹åºçªå£æªéæ©æ°æ®å³é­çªå£æ¶ï¼è¿ååå§å¼\r\n            this.ins.dialogMgr.dialogClosed();\r\n        });\r\n\r\n        this.ins.subscriptions.push(this.ins.dialogClosedSubscription);\r\n    }\r\n\r\n    private registerShortcutKey() {\r\n        // åè½¦ï¼ä¸ç¡®å®æé®å¤çé»è¾ä¸è³ã\r\n        const dlgContainerDom = this.ins.dialog.el.nativeElement.querySelector('.farris-modal');\r\n\r\n        if (dlgContainerDom && this.ins.shortcutKey && !this.keyDownHandler) {\r\n            this.keyDownHandler = this.ins.eventManager.addEventListener(dlgContainerDom, 'keydown', (e: KeyboardEvent) => {\r\n                e.stopPropagation();\r\n                const { moveUp, moveDown, searchFocus, confirm, nextPager, prevPager, expand, collapse } = this.ins.shortcutKey;\r\n                const arrowKey = [moveUp, moveDown, expand, collapse];\r\n                if (arrowKey.includes(e.code)) {\r\n                    this.ins.componentRef.instance.onKeydownEvent(e);\r\n                } else if (e.key === confirm) {\r\n                    if (e.target['nodeName'] === 'INPUT' && !e.ctrlKey) {\r\n                        return;\r\n                    }\r\n                    this.ins.okButton.nativeElement.click();\r\n                } else if (e.code === searchFocus) { // å¸®å©çªå£æ¥è¯¢è¾å¥æ¡ç¦ç¹\r\n                    e.preventDefault();\r\n                    this.ins.componentRef.instance.inputGroup.focus();\r\n                } else if (!this.ins.isTree() && (e.code === nextPager || e.code === prevPager )) {  // åé¡µ\r\n                    const isNextPager = e.code === nextPager;\r\n                    this.paginationKeyDownHandler(isNextPager);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private paginationKeyDownHandler(next = true) {\r\n        const datatableRef = this.ins.componentRef.instance;\r\n        const {pageIndex, pageSize, total} = datatableRef;\r\n        const pagerCount = Math.ceil(total / pageSize);\r\n\r\n        let newPageNum = pageIndex;\r\n        if (next) {\r\n            newPageNum = newPageNum + 1;\r\n        } else {\r\n            newPageNum = newPageNum - 1;\r\n        }\r\n\r\n        if (newPageNum > pagerCount || newPageNum < 1) {\r\n            newPageNum = pageIndex;\r\n        }\r\n\r\n        this.ins.componentRef.instance.onPageChange({ pageSize, pageIndex: newPageNum });\r\n    }\r\n\r\n}\r\n\r\n","import { Observable, of, BehaviorSubject } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { FavoriteAction } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\nexport interface SelectionState {\r\n    selecteditems: any[];\r\n    favoriteItems: any[];\r\n    quickItems: any[];\r\n}\r\n\r\nexport class LookupSelectionService {\r\n\r\n    private state: SelectionState = {\r\n        selecteditems: [],\r\n        favoriteItems: [],\r\n        quickItems: []\r\n    };\r\n\r\n    state$: BehaviorSubject<SelectionState> = new BehaviorSubject(this.state);\r\n\r\n    selected$: Observable<any[]> = this.state$.pipe(\r\n        switchMap(n => of(n.selecteditems))\r\n    );\r\n\r\n    favoriteItems$: BehaviorSubject<any> = new BehaviorSubject({items: this.state.favoriteItems, action: null });\r\n\r\n    quickItems$: Observable<any[]> = this.state$.pipe(\r\n        switchMap(n => of(n.quickItems))\r\n    );\r\n\r\n    private get idField() {\r\n        return this.ins.idField;\r\n    }\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n    }\r\n\r\n    initFavoriteItems(items: any[]) {\r\n        this.state.favoriteItems = items || [];\r\n    }\r\n\r\n\r\n    //#region æ¶èæ°æ®\r\n\r\n    updateFavoriteData(data: any, action: FavoriteAction) {\r\n\r\n        if (this.ins.savingFaoriteData) {\r\n            return;\r\n        }\r\n\r\n        if (action === FavoriteAction.add) {\r\n            this.state.favoriteItems = this.state.favoriteItems.concat([data]);\r\n        } else {\r\n            this.state.favoriteItems = this.state.favoriteItems.filter(n => n[this.idField] !== data[this.idField]);\r\n        }\r\n\r\n        this.favoriteItems$.next({ items: this.state.favoriteItems, action });\r\n    }\r\n\r\n    //#endregion\r\n\r\n    //#region å¤éæ°æ®\r\n\r\n    loadSelections( data: []) {\r\n        this.state.selecteditems = [...data];\r\n        this.state$.next(this.state);\r\n    }\r\n\r\n    getSelections() {\r\n        return [...this.state.selecteditems];\r\n    }\r\n\r\n    select(item: any) {\r\n        if (item) {\r\n            this.state.selecteditems = [...this.state.selecteditems, item];\r\n            this.state$.next(this.state);\r\n        }\r\n    }\r\n\r\n    unselectByPathcode(pathcode: string) {\r\n        const { dataField, pathField } = this.ins.treeInfo;\r\n        this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n            return n[dataField][pathField] && n[dataField][pathField].indexOf(pathcode) !== 0;\r\n        });\r\n    }\r\n\r\n    updateSelections(data: any, checked = true) {\r\n\r\n        if (!Array.isArray(data)) {\r\n            data = [data];\r\n        }\r\n\r\n        const items = [ ...data ];\r\n        const idField = this.idField;\r\n        if (checked) {\r\n            if (this.state.selecteditems && !this.state.selecteditems.length) {\r\n                this.state.selecteditems = items;\r\n            } else {\r\n                const ids = items.map(n => n[idField]);\r\n                ids.forEach((n, i) => {\r\n                    if (!this.state.selecteditems.find(r => r[idField] == n)) {\r\n                        this.state.selecteditems.push(items[i]);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            if (data) {\r\n                const ids2 = data.map(n => n[idField]);\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n                    return ids2.indexOf(n[idField]) === -1;\r\n                });\r\n            }\r\n        }\r\n\r\n        this.state$.next(this.state);\r\n    }\r\n\r\n    unSelect(id: any) {\r\n        if (id) {\r\n            if (Array.isArray(id)) {\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n                    return id.indexOf(n[this.idField]) === -1;\r\n                });\r\n            } else {\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => n[this.idField] != id);\r\n            }\r\n\r\n            this.state$.next(this.state);\r\n        }\r\n    }\r\n\r\n    clearSelections() {\r\n        this.state.selecteditems = [];\r\n        this.state$.next(this.state);\r\n    }\r\n\r\n    //#endregion\r\n\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(lucas huang)\r\n * @Date: 2018-11-23 11:23:12\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2020-10-20 20:18:26\r\n * @Company: Inspur\r\n * @Version: v0.3.x\r\n */\r\n\r\nimport {\r\n    Component,\r\n    Input,\r\n    ViewChild,\r\n    OnChanges,\r\n    SimpleChanges,\r\n    EventEmitter,\r\n    OnInit,\r\n    Injector,\r\n    ComponentFactoryResolver,\r\n    Output,\r\n    ChangeDetectorRef,\r\n    ViewEncapsulation,\r\n    AfterViewInit,\r\n    ViewContainerRef,\r\n    forwardRef,\r\n    ComponentRef,\r\n    Type,\r\n    ElementRef,\r\n    NgZone,\r\n    Renderer2,\r\n    OnDestroy,\r\n    HostListener,\r\n} from \"@angular/core\";\r\n\r\nimport { NG_VALUE_ACCESSOR } from \"@angular/forms\";\r\nimport { Observable, Subscription, of, Subject, BehaviorSubject } from \"rxjs\";\r\n\r\nimport { LocaleService } from \"@farris/ui-locale\";\r\nimport { IResizeEvent } from \"@farris/ui-draggable\";\r\nimport { MessagerService } from \"@farris/ui-messager\";\r\nimport { LoadingService, LoadingComponent } from \"@farris/ui-loading\";\r\nimport { DataTableComponent } from \"@farris/ui-datatable\";\r\nimport { TreeTableComponent, TreeNode } from \"@farris/ui-treetable\";\r\nimport { LayoutPanelComponent } from \"@farris/ui-layout\";\r\nimport { CommonUtils, DebugService, FarrisComponentInstanceService, OverLayHiddenService } from \"@farris/ui-common\";\r\nimport { EntityFilter } from \"@farris/ui-common/types\";\r\nimport { ShortcutsService } from \"@farris/ui-shortcuts\";\r\nimport { InputGroupComponent } from \"@farris/ui-input-group\";\r\nimport { NotifyService } from \"@farris/ui-notify\";\r\n\r\nimport {\r\n    FAVORITE_FIELD_NAME,\r\n    INPUT_GROUP_ICON,\r\n    LookupGridDisplayType,\r\n    ExtInfoFormatter,\r\n    CustomDataFormatter,\r\n    QuickSelectOption,\r\n    QuickSelectDefaultOptions,\r\n} from \"./lookup-displaytype\";\r\nimport { LookupComponent } from \"./lookup.component\";\r\nimport {\r\n    LookupGridOptions,\r\n    lookupGridDefaults,\r\n    LookupGridResult,\r\n    NavigationOptions,\r\n    DisplayInfo,\r\n    displayInfoDefault,\r\n    PickingResult,\r\n    TreeInfo,\r\n    LOAD_DATA_TYPE,\r\n    ONLY_SELECT_LEAF,\r\n    PersonalConfig,\r\n} from \"./lookup-grid-options\";\r\nimport { ILookupHttpService, ServerSideToken } from \"./http/ILookupHttpService\";\r\nimport { NavigationFilter } from \"./http/RemoteParams\";\r\nimport { LookupLeftComponent } from \"./lookup-left.component\";\r\nimport { LookupDefaultMapping } from \"./lookup-defaut-mapping\";\r\nimport { LookupUtils } from \"./utils\";\r\nimport { PersonalConfigService } from \"./lookup-presonalConfig.service\";\r\nimport {\r\n    UtilService,\r\n    TreeNodeHelper,\r\n    FavoriteHelper,\r\n    SelectionManager,\r\n    DataTableEventManager,\r\n    TreeTableEventManager,\r\n    MultiSelectionManager,\r\n    LookupHttpManager,\r\n    LookupComponentManager,\r\n    LookupDialogManager,\r\n    onTextChanged,\r\n    LookupSelectionService,\r\n} from \"./services\";\r\nimport { catchError, map, switchMap } from \"rxjs/operators\";\r\n\r\nimport { EventManager } from \"@angular/platform-browser\";\r\nimport { cloneDeep } from \"lodash-es\";\r\n\r\n\r\nexport const LOOKUPGRID_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => LookupGridComponent),\r\n    multi: true,\r\n};\r\n\r\n@Component({\r\n    selector: \"farris-lookup-grid\",\r\n    templateUrl: \"./lookup-grid.component.html\",\r\n    styleUrls: [\"./lookup-grid.component.scss\"],\r\n    providers: [\r\n        LOOKUPGRID_VALUE_ACCESSOR,\r\n        ShortcutsService,\r\n        LookupDefaultMapping,\r\n        LookupUtils,\r\n        PersonalConfigService,\r\n    ],\r\n    encapsulation: ViewEncapsulation.None,\r\n    exportAs: \"lookup\",\r\n})\r\nexport class LookupGridComponent\r\n    extends LookupComponent\r\n    implements OnInit, AfterViewInit, OnChanges, OnDestroy\r\n{\r\n    groupIcon = INPUT_GROUP_ICON;\r\n    _displayType = \"\";\r\n\r\n    /** ä½¿ç¨è¡¨åè®¾è®¡å¨ä¸­çæ¾ç¤ºç±»åãå¦åä½¿ç¨åæ°æ®è®¾ç½®çæ¾ç¤ºç±»åã é»è®¤ï¼false */\r\n    @Input() customDisplayType = false;\r\n    @Input() viewType: \"text\" | \"tag\" = \"text\";\r\n    @Input()\r\n    get displayType() {\r\n        return this._displayType;\r\n    }\r\n    set displayType(val: string) {\r\n        if (val) {\r\n            const types = Object.values(LookupGridDisplayType);\r\n            const i = types.findIndex((n) => n === val.toUpperCase());\r\n            if (i > -1) {\r\n                const keys = Object.keys(LookupGridDisplayType);\r\n                this._displayType = LookupGridDisplayType[keys[i]];\r\n            }\r\n        } else {\r\n            this._displayType = val;\r\n        }\r\n    }\r\n    /** å¯ç¨æ¸ç©ºæé® */\r\n    @Input() enableClear = true;\r\n    /** æå¡å¨ç«¯æåº */\r\n    @Input() remoteSort = true;\r\n\r\n    @Input() condition: EntityFilter;\r\n\r\n    /** æ è¡¨æ¾ç¤ºå¨éå¤éæ¡ã é»è®¤ä¸æ¾ç¤º */\r\n    @Input() showCheckAll = false;\r\n\r\n    /** æ¯å¦å¯ç¨å¤é */\r\n    @Input() singleSelect = true;\r\n    /** å¤éåéç¬¦ */\r\n    @Input() multipleChoiceSeparator = \",\";\r\n    /** ä¸»é®å­æ®µ */\r\n    @Input() idField?: string;\r\n    /** å¯ä»¥ä¸ºåæ°æ®IDãwebapiURL */\r\n    @Input() uri?: string;\r\n    /**\r\n     * BE REST RUI\r\n     * - æ­¤å¤è®¾ç½®å uri å¤±æ\r\n     */\r\n    @Input() beUri = \"\";\r\n    /**\r\n     * æ¾ç¤ºè¿æ»¤å·¥å·æ¡\r\n     */\r\n    @Input() showFilterBar = true;\r\n    /** æ¯å¦å¯ç¨åé¡µ */\r\n    @Input() pagination = true;\r\n    /** å½åé¡µç´¢å¼ï¼ä» 0å¼å§ */\r\n    @Input() pageIndex = 1;\r\n    /** æ¯é¡µè®°å½æ° */\r\n    @Input() pageSize = 20;\r\n    /** å¯ç¨åé¡µè®°å½æ°åè¡¨ */\r\n    @Input() pageList = [10, 20, 30, 50, 100];\r\n    /** æ»è®°å½æ° */\r\n    @Input() total = 0;\r\n    /** å¯æå¨å */\r\n    // @Input() resizableColumns = true;\r\n    /** æ¾ç¤ºåä¿¡æ¯, é»è®¤ä¸º [] */\r\n    @Input() columns: any[] = [];\r\n\r\n    /** å¸®å©æ¥è¯¢æ¯å¦ä¸ºè¿ç«¯æ¥è¯¢ */\r\n    @Input() remoteSearch = true;\r\n\r\n    /** ææ¬åååï¼è¿è¡æå¡å¨ç«¯æ¥è¯¢ */\r\n    @Input() searchOnServer = true;\r\n    /** ä¸è¿è¡æå¡å¨æ¥è¯¢ï¼æå¥ç®å¥ */\r\n    @Input() nosearch = false;\r\n\r\n    /**\r\n     * å¯ç¨ä»»æè¾å¥åï¼å¼éè¿è¾å¥æ¶è§¦å\r\n     */\r\n    @Output() clearMappings = new EventEmitter();\r\n\r\n    /**\r\n     * åè®¸è¾å¥çå­ç¬¦æå¤§é¿åº¦ã\r\n     * ä»»æè¾å¥æ¶ï¼æ­¤å±æ§ææ\r\n     */\r\n    @Input() maxLength;\r\n\r\n    @Input() mappingFn: (rowData, mapFields, bindingData?: any) => void;\r\n    /** æ°æ®åè¡¨ */\r\n    @Input() items: any;\r\n    // æ¶èåè¡¨\r\n    @Input() favoriteItems: any[] = [];\r\n    /** èªå®ä¹æ°æ® */\r\n    @Input() customData: any;\r\n\r\n    /** ç»å®å¼æå¨çå¯¹è±¡ */\r\n    @Input() bindingData: {};\r\n\r\n    @Input() treeInfo: TreeInfo;\r\n    /** æ¯å¦å¯ç¨çº§èéæ©æ§å¶éé¡¹ */\r\n    @Input() enableCascade = false;\r\n    /** çº§èæ§å¶é»è®¤å¼ï¼ enable, up, down, disable */\r\n    @Input() cascadeStatus: \"enable\" | \"up\" | \"down\" | \"disable\" = \"enable\";\r\n\r\n    @Input() placeholder = \"\";\r\n\r\n    /** æ¾ç¤ºå·²éè®°å½åè¡¨ã é»è®¤ä¸º false ä¸æ¾ç¤º */\r\n    @Input() showSelected = false;\r\n\r\n    /** åºç¨æ¶èå¤¹ */\r\n    @Input() useFavorite = false;\r\n    /** æ¶èæ°æ®æ¥èªäºï¼ locale: æ¬å°å­å¨ï¼ remote: æå¡å¨ç«¯å­å¨ */\r\n    @Input() favoriteDataFrom: \"locale\" | \"remote\" = \"remote\";\r\n    /** ä½¿ç¨æç¤º,å¿«æ·éæ© */\r\n    @Input() useTip = false;\r\n    /** è®°å½çªå£å¤§å° */\r\n    @Input() isRecordSize = false;\r\n\r\n    /** å¿«ééæ© */\r\n    @Input() userId: string;\r\n\r\n    /** æ¯å¦å¯ç¨éä¸­valueå¼å¯¹åºçè¡æ°æ®ï¼é»è®¤ true */\r\n    @Input() enableToSelect = true;\r\n\r\n    @Input() enableFindText = false;\r\n    /** -1: ä¸å±å¼ï¼ 0: å¨é¨å±å¼ï¼>0: å±å¼å°æå®çº§æ° */\r\n    @Input() expandLevel = -1;\r\n\r\n    @Input() navTreeTableOptions: any = {};\r\n    @Input() treeTableOptions: any = {};\r\n    @Input() dataTableOptions: any = {};\r\n\r\n    defaultTreeTableOptions = {\r\n        maxLevel: 9,\r\n        enableContextMenu: false,\r\n        contextMenuItems: [],\r\n    };\r\n\r\n    /** æ å½¢å¸®å©æ°æ®å è½½æ¹å¼ï¼ default: åç½®åæ°ï¼ loadall: å è½½ææ layerloadï¼åå±å è½½ */\r\n    @Input() loadTreeDataType: \"default\" | \"loadall\" | \"layerload\" = \"default\";\r\n\r\n    /** çªå£æå¼åç«å³å è½½æ°æ®ï¼é»è®¤ä¸º true */\r\n    @Input() loadDataWhenOpen = true;\r\n\r\n    /**\r\n     * å¯¼èªåè¡¨ï¼æ åè¡¨å¨å¸®å©æå¼åéä¸­çæ°æ®;\r\n     * è®¾ç½®åï¼`selectFirstInNav` å¤±æï¼\r\n     */\r\n    @Input() navSelectedIds = \"\";\r\n\r\n    /**\r\n     * å¯¼èªå¸®å©ï¼éä¸­ç¬¬1æ¡æ°æ®ï¼é»è®¤ä¸º false;\r\n     * æ³¨æï¼å½`navSelectedIds`ä¸ä¸ºç©ºæ¶ï¼æ­¤å±æ§å¤±æã\r\n     */\r\n    @Input() selectFirstInNav = false;\r\n\r\n    /** å¯ç¨æé å®æ´æ è¿æ»¤ */\r\n    @Input() enableFullTree = true;\r\n\r\n    /** æ¾ç¤ºææ¬èªå®ä¹å½æ° */\r\n    @Input() displayFormatter: (\r\n        value: string,\r\n        data: any,\r\n        instance: any\r\n    ) => string = undefined;\r\n    /** æ¾ç¤ºææ¬å­æ®µéåï¼ä»¥ è±æ éå·éå¼ */\r\n    @Input() displayFields = \"\";\r\n    @Input() displayTextSeparator = \"_\";\r\n\r\n    /**\r\n     * å¸®å©åæ°æ®IDï¼ä¸ä¸ºç©ºæ¶è°ç¨æå®çURI\r\n     * /api/runtime/bcc/v1.0/help/data/{helpId}\r\n     */\r\n    @Input() helpId = \"\";\r\n    /** ææ¬å¯¹é½æ¹å¼ï¼ left | center | right; é»è®¤ left */\r\n    @Input() textAlign = \"left\";\r\n\r\n    /** é¼ æ æ»è¿è¾å¥æ¡æ¶æ¾ç¤ºè¾å¥æ¡åçææ¬ä¿¡æ¯ */\r\n    @Input() enableTitle = true;\r\n    @Input() useExtendInfo = false;\r\n    @Input() extInfoFields = \"\";\r\n    @Input() extInfoFormatter: ExtInfoFormatter;\r\n    @Input() extendInfo = \"\";\r\n    /** IDE è®¾è®¡å¨èªå®ä¹æ ¼å¼å 2103 */\r\n    @Input() customFormatter: CustomDataFormatter = null;\r\n    @Input() customNavFormatter: CustomDataFormatter = null;\r\n\r\n    /** èªå®ä¹ç¡®å®äºä»¶ */\r\n    @Input() okHandler = null;\r\n    /** èªå®ä¹åæ¶äºä»¶ */\r\n    @Input() cancelHandler = null;\r\n\r\n    @Input() tagboxHeight = \"auto\";\r\n    @Input() maxTagboxHeight;\r\n\r\n    /** å¯ç¨è·åææå­çº§æ°æ®çåè½ */\r\n    @Input() enableGetAllChildNodes = true;\r\n\r\n    @Input() shortcutKey = {\r\n        /** æå¼å¸®å©çªå£ */\r\n        open: \"ArrowRight\",\r\n        /** ç¡®è®¤éæ©æ°æ® */\r\n        confirm: \"Enter\",\r\n        /** æç´¢æ¡ç¦ç¹ */\r\n        searchFocus: \"F3\",\r\n        /** éä¸­ä¸ä¸æ¡ */\r\n        moveUp: \"ArrowUp\",\r\n        /** éä¸­ä¸ä¸æ¡ */\r\n        moveDown: \"ArrowDown\",\r\n        /** å±å¼èç¹ */\r\n        expand: \"ArrowRight\",\r\n        /** æå èç¹ */\r\n        collapse: \"ArrowLeft\",\r\n        /** ä¸ä¸é¡µ */\r\n        nextPager: \"PageDown\",\r\n        /** ä¸ä¸é¡µ */\r\n        prevPager: \"PageUp\",\r\n    };\r\n    /** å¿«æ·éæ©ç¸å³éç½®é¡¹ï¼é»è®¤ä¸º null, å³ä¸å¯ç¨æ­¤åè½ */\r\n    @Input() quickSelect: QuickSelectOption = null;\r\n\r\n    /** æ°æ®éæ©åï¼å¼æ å°åè§¦å\r\n     * è¿å Observable\r\n     *      canSelect: <boolean>  æ¯å¦åè®¸éæ©\r\n     *      message: <string> ä¸åè®¸éæ©æ¶çæç¤ºä¿¡æ¯\r\n     */\r\n    @Input() beforeSelectData: (p: {\r\n        instance: any;\r\n        data: any;\r\n    }) => Observable<{ canSelect: boolean; message: string } | boolean>;\r\n\r\n    @Output() selectedData = new EventEmitter();\r\n    @Output() clear = new EventEmitter();\r\n    @Output() search = new EventEmitter();\r\n    // å¸®å©ææ¬æ¡ä¸­å¼ååäºä»¶\r\n    @Output() valueChanged = new EventEmitter();\r\n    @Output() loadSuccess = new EventEmitter();\r\n\r\n    @Output() pagerChanged = new EventEmitter();\r\n\r\n    @Output() expandTreeNode = new EventEmitter();\r\n    @Output() textChanged = new EventEmitter();\r\n\r\n    @Output() checkedChange = new EventEmitter<{\r\n        data: any;\r\n        isCheck: boolean;\r\n    }>();\r\n\r\n    @Output() tagRemoved = new EventEmitter();\r\n\r\n    /** åå®¹ä¸­çç½è¾¹è· */\r\n    containerMargin = { top: 0, bottom: 5, left: 10, right: 10 };\r\n\r\n    containerStyle = {\r\n        marginLeft: this.containerMargin.left + \"px\",\r\n        marginRight: this.containerMargin.right + \"px\",\r\n        marginTop: this.containerMargin.top + \"px\",\r\n        marginBottom: this.containerMargin.bottom + \"px\",\r\n    };\r\n\r\n    _gridOptions: LookupGridOptions = lookupGridDefaults;\r\n\r\n    get gridOptions() {\r\n        if (\r\n            this.useFavorite &&\r\n            this.columns &&\r\n            this.columns.length > 0 &&\r\n            !this.columns.find((item) => item.field === FAVORITE_FIELD_NAME)\r\n        ) {\r\n            this.columns.push({\r\n                field: FAVORITE_FIELD_NAME,\r\n                title: \"\",\r\n                width: 40,\r\n                align: \"center\",\r\n                fixed: 'right',\r\n                // fixedWidth: true,\r\n                formatter: this.favHelper.favoriteColumnFormatter,\r\n            });\r\n        }\r\n        this._gridOptions = Object.assign(this._gridOptions, {\r\n            singleSelect: this.singleSelect,\r\n            idField: this.idField,\r\n            uri: this.uri,\r\n            showFilterBar: this.showFilterBar,\r\n            pagination: this.pagination,\r\n            pageIndex: this.pageIndex,\r\n            pageSize: this.pageSize,\r\n            pageList: this.pageList,\r\n            total: this.total,\r\n            items: this.items,\r\n            columns: this.columns,\r\n            resizableColumns: true,\r\n            fixedHeader: true,\r\n            hover: true,\r\n            treeInfo: this.treeInfo,\r\n        });\r\n\r\n        return this._gridOptions;\r\n    }\r\n    @Input() set gridOptions(opts) {\r\n        this._gridOptions = Object.assign({}, this._gridOptions, opts);\r\n        this.selectedColumns = this.multiSelMgr.initSelectedColumns();\r\n    }\r\n\r\n    @ViewChild(\"contentContainer\", { read: ViewContainerRef })\r\n    contentContainer: ViewContainerRef;\r\n    @ViewChild(\"favoritesContainer\", { read: ViewContainerRef })\r\n    favoritesContainer: ViewContainerRef;\r\n    @ViewChild(\"leftContainer\", { read: ViewContainerRef })\r\n    leftContainer: ViewContainerRef;\r\n    @ViewChild(\"centerContainer\", { read: ViewContainerRef })\r\n    centerContainer: ViewContainerRef;\r\n    @ViewChild(\"multiSelectDT\") multiSelectDT: DataTableComponent;\r\n    @ViewChild(\"inputgroup\") inputGroup: InputGroupComponent;\r\n    @ViewChild(\"leftPanel\") leftPanel: LayoutPanelComponent;\r\n    @ViewChild(\"tagbox\") tagbox: ElementRef;\r\n\r\n    @ViewChild(\"okbtn\") okButton: ElementRef;\r\n\r\n    componentRef: ComponentRef<any>;\r\n    leftComponentRef: ComponentRef<LookupLeftComponent>;\r\n    favoritesComponentRef: ComponentRef<any>;\r\n\r\n    public http: ILookupHttpService;\r\n    public messagerService: MessagerService;\r\n    public loadingService: LoadingService;\r\n    loading: LoadingComponent;\r\n    // dataFieldMaps: any;\r\n    navigationOptions: NavigationOptions;\r\n\r\n    // å¯¼èªå¸®å©å·¦åå®½åº¦\r\n    leftPanelWidth = 320;\r\n    // å¯¼èªå¸®å©çªå£æå°å®½åº¦\r\n    navLookupDialogMinWidth = 960;\r\n\r\n    navigationFilter: NavigationFilter = null;\r\n\r\n    subscriptions: Subscription[] = [];\r\n    dialogOpenedSubscription: Subscription;\r\n    dialogClosedSubscription: Subscription;\r\n\r\n    isTextChange = false;\r\n    isTabChanged = false;\r\n\r\n    displayInfo: DisplayInfo = Object.assign({}, displayInfoDefault);\r\n\r\n    tabChangeSubscription = null;\r\n    // æå­è¡ç¹å»æ°æ®  ç¨äºæ¶è\r\n    personalConf: PersonalConfig = {};\r\n    favoriteColumns: any[] = [];\r\n    /** ä¸´æ¶æ¥è¯¢åæ° */\r\n    _searchState = null;\r\n    allData: any = [];\r\n    get selections() {\r\n        const selectItems = this.lookupSelectionSer.getSelections();\r\n        if (this.singleSelect) {\r\n            return selectItems[0];\r\n        } else {\r\n            return selectItems;\r\n        }\r\n    }\r\n    get usePersionalConf() {\r\n        return this.useFavorite || this.useTip || this.isRecordSize;\r\n    }\r\n\r\n    get displayTextList() {\r\n        if (this.displayText) {\r\n            return this.displayText.split(this.multipleChoiceSeparator);\r\n        }\r\n        return [];\r\n    }\r\n\r\n    public personalConfigService: PersonalConfigService;\r\n    public utilService: UtilService;\r\n    public treeNodeHelper: TreeNodeHelper;\r\n    public localService: LocaleService;\r\n    public notifyService: NotifyService;\r\n    allColumnsTitle = \"ææå\";\r\n    mustWriteSomething = \"è¯·è¾å¥å³é®å­åæ¥è¯¢ã\";\r\n    mustChoosAdatarow = \"è¯·éæ©ä¸æ¡è®°å½ï¼\";\r\n    addFavoriteSuccess = \"æ¶èæåã\";\r\n    delFavoriteSuccess = \"ç§»é¤æ¶èæåã\";\r\n\r\n    searching = false;\r\n    /** ä¸´æ¶å­å¨æ¥è¯¢ç»æé */\r\n    _searchResult = null;\r\n\r\n    lookupinitializationSubject = new Subject();\r\n\r\n    /** å¤éæ¶ï¼éä¸­çæ°æ® */\r\n    currentSelectedItems: Observable<any> = of([]);\r\n    /** å·²éæ°æ®åä¿¡æ¯ */\r\n    selectedColumns = [];\r\n    activeTab: string | \"datalist\" | \"favorite\" | \"selected\" = \"datalist\";\r\n\r\n    favHelper: FavoriteHelper = null;\r\n    ttEventMgr: TreeTableEventManager = null;\r\n    multiSelMgr: MultiSelectionManager = null;\r\n    httpMgr: LookupHttpManager = null;\r\n    lookupCmpMgr: LookupComponentManager = null;\r\n    dialogMgr: LookupDialogManager = null;\r\n    selectionMgr: SelectionManager = null;\r\n    dtEventMgr: DataTableEventManager = null;\r\n\r\n    lookupSelectionSer: LookupSelectionService = null;\r\n\r\n    controlId = \"\";\r\n    savingFaoriteData = false;\r\n    isReady = false;\r\n    showTagboxClearButton = false;\r\n    hasError = false;\r\n\r\n    isGetAllChidlNodes = false;\r\n    eventManager: EventManager;\r\n    /** éä¸­è®°å½IDï¼èªå®ä¹å¸®å©åæ°æ¶ä½¿ç¨ */\r\n    selectedIds = [];\r\n    private lookupSearchInputEvent = null;\r\n    private farrisInstances: FarrisComponentInstanceService = null;\r\n    /** ç¨æ·åå§è®¾ç½® */\r\n    private _userSettings: any = {};\r\n\r\n    get userInitialConfig() {\r\n        return this._userSettings;\r\n    }\r\n\r\n    _treeInfo_ = null;\r\n\r\n    /** dialog åå®¹åºåé«åº¦ã å¼¹çªæ»é«åº¦ - å¤´é¨é«åº¦ - èé¨é«åº¦ - ï¼å¯ç¨æ¶è TABå¤´é«åº¦ï¼ */\r\n    dialogContentHeight = 0;\r\n\r\n    overLayService: OverLayHiddenService;\r\n    private debugSer: DebugService = null;\r\n    constructor(\r\n        public injector: Injector,\r\n        public cfr: ComponentFactoryResolver,\r\n        public el: ElementRef,\r\n        public utils: CommonUtils,\r\n        private defaultMapping: LookupDefaultMapping,\r\n        public changeDetector: ChangeDetectorRef,\r\n        public shortcuts: ShortcutsService,\r\n        public lookupUtils: LookupUtils,\r\n        private zone: NgZone,\r\n        private render2: Renderer2\r\n    ) {\r\n        super(injector, el, changeDetector);\r\n        this.createInstance();\r\n        this.currentSelectedItems = this.lookupSelectionSer.selected$;\r\n        this.eventManager = this.injector.get(EventManager);\r\n        this.farrisInstances = this.injector.get(\r\n            FarrisComponentInstanceService,\r\n            null\r\n        );\r\n\r\n        this.overLayService = new OverLayHiddenService();\r\n\r\n        this.debugSer = this.injector.get(DebugService, null);\r\n        if (this.debugSer) {\r\n            this.debugSer.useDebugMode();\r\n        }\r\n    }\r\n\r\n    writeConsole(msg, type: 'info'|'log'|'warn'|'error' = 'warn') {\r\n        if (this.debugSer) {\r\n            this.debugSer[type](msg);\r\n        }\r\n    }\r\n\r\n    private cacheUserConfig() {\r\n        this._userSettings._title = this.title;\r\n        this.displayInfo.title = this.title;\r\n        this._userSettings._columns = this.deepClone(this.columns || []);\r\n        this._userSettings.getColumns = () => {\r\n            return this._userSettings._columns;\r\n        };\r\n\r\n        this._userSettings.reset = () => {\r\n            this.title = this._userSettings._title;\r\n            this.displayInfo.title = this.title;\r\n            this.columns = this._userSettings.getColumns();\r\n        };\r\n    }\r\n\r\n    private deepClone(obj) {\r\n        if (obj === null) {\r\n            return null;\r\n        }\r\n        const clone = Object.assign({}, obj);\r\n        Object.keys(clone).forEach(\r\n            (key) =>\r\n                (clone[key] =\r\n                    typeof obj[key] === \"object\"\r\n                        ? this.deepClone(obj[key])\r\n                        : obj[key])\r\n        );\r\n        if (Array.isArray(obj)) {\r\n            clone.length = obj.length;\r\n            return Array.from(clone);\r\n        }\r\n        return clone;\r\n    }\r\n\r\n    ngOnInit() {\r\n        super.ngOnInit();\r\n        this.cacheUserConfig();\r\n        if (!this.loadTreeDataType) {\r\n            this.loadTreeDataType = \"default\";\r\n        }\r\n\r\n        this.checkGridOptions();\r\n        this.displayInfo.title = this.title;\r\n        /** ä¼ éä¸ä¸æ */\r\n        if (this.http) {\r\n            this.http.context = this.context;\r\n        }\r\n\r\n        this.allColumnsTitle = this.localService.getValue(\"lookup.allColumns\");\r\n        this.mustWriteSomething = this.localService.getValue(\r\n            \"lookup.mustWriteSomething\"\r\n        );\r\n        this.mustChoosAdatarow = this.localService.getValue(\r\n            \"lookup.mustChoosAdatarow\"\r\n        );\r\n        this.addFavoriteSuccess =\r\n            this.localService.getValue(\"lookup.favoriteInfo.addFav\") ||\r\n            this.addFavoriteSuccess;\r\n        this.delFavoriteSuccess =\r\n            this.localService.getValue(\"lookup.favoriteInfo.cancelFav\") ||\r\n            this.delFavoriteSuccess;\r\n\r\n        this.dialogMgr.onDialogCreated();\r\n\r\n        this._treeInfo_ = this.treeInfo ? cloneDeep(this.treeInfo) : null;\r\n\r\n        if (this.quickSelect) {\r\n            this.quickSelect = Object.assign(QuickSelectDefaultOptions, this.quickSelect || {});\r\n            \r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        super.ngOnDestroy();\r\n        this.subscriptions.forEach((n) => {\r\n            if (n) {\r\n                n.unsubscribe();\r\n                n = null;\r\n            }\r\n        });\r\n\r\n        if (this.selectionMgr) {\r\n            this.selectionMgr.destroy();\r\n        }\r\n\r\n        this.subscriptions = [];\r\n\r\n        if (this.farrisInstances) {\r\n            this.farrisInstances.destroy(this.el.nativeElement);\r\n        }\r\n\r\n        if (this.lookupSearchInputEvent) {\r\n            this.lookupSearchInputEvent();\r\n        }\r\n        this.lookupUtils.destroy();\r\n\r\n        this.overLayService.destory(this.el.nativeElement);\r\n        this.overLayService = null;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (changes.columns && !changes.columns.isFirstChange()) {\r\n            this.cacheUserConfig();\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this.lookupSearchInputEvent = onTextChanged.bind(this)();\r\n\r\n        // åå§åä¸ªæ§åéç½®\r\n        if (this.usePersionalConf) {\r\n            this.favHelper.initPersonalInfo();\r\n        }\r\n\r\n        if (this.useExtendInfo) {\r\n            const jsonData = this.selectionMgr.getBindingData();\r\n            this.updateExtendInfo(jsonData, false);\r\n        }\r\n\r\n        if (this.viewType === \"text\") {\r\n            // this.shortcuts.add({\r\n            //     key: 'F2',\r\n            //     target: this.inputGroup.textbox.nativeElement,\r\n            //     command: () => {\r\n            //         this.showDialog();\r\n            //     }\r\n            // });\r\n            this.render2.listen(\r\n                this.inputGroup.textbox.nativeElement,\r\n                \"keydown.F2\",\r\n                this.showDialog.bind(this)\r\n            );\r\n        } else {\r\n            this.registerMouseEventForTagView();\r\n\r\n            if (this.tagboxHeight) {\r\n                const el =\r\n                    this.tagbox.nativeElement.querySelector(\".multi-more\");\r\n                let tbh = this.tagboxHeight;\r\n                if (tbh !== \"auto\") {\r\n                    tbh += \"px\";\r\n\r\n                    if (this.maxTagboxHeight) {\r\n                        this.render2.setStyle(\r\n                            el,\r\n                            \"maxHeight\",\r\n                            `${this.maxTagboxHeight}px`\r\n                        );\r\n                    }\r\n                }\r\n\r\n                this.render2.setStyle(el, \"height\", tbh);\r\n            }\r\n        }\r\n\r\n        if (this.el && this.farrisInstances) {\r\n            this.farrisInstances.add(this.el.nativeElement, this);\r\n        }\r\n    }\r\n\r\n    private createInstance() {\r\n        this.http = this.injector.get(ServerSideToken, null);\r\n        this.messagerService = this.injector.get(MessagerService);\r\n        this.loadingService = this.injector.get(LoadingService);\r\n        this.notifyService = this.injector.get(NotifyService, null);\r\n\r\n        this.personalConfigService = this.injector.get(\r\n            PersonalConfigService,\r\n            null\r\n        );\r\n\r\n        this.lookupSelectionSer = new LookupSelectionService(this);\r\n\r\n        this.utilService = new UtilService(this);\r\n        this.localService = this.injector.get(LocaleService);\r\n        this.treeNodeHelper = new TreeNodeHelper(this);\r\n\r\n        this.favHelper = new FavoriteHelper(this);\r\n        this.ttEventMgr = new TreeTableEventManager(this);\r\n        this.multiSelMgr = new MultiSelectionManager(this);\r\n        this.httpMgr = new LookupHttpManager(this);\r\n        this.lookupCmpMgr = new LookupComponentManager(this);\r\n        this.dialogMgr = new LookupDialogManager(this);\r\n        this.selectionMgr = new SelectionManager(this);\r\n        this.dtEventMgr = new DataTableEventManager(this);\r\n    }\r\n\r\n    showDialog(): any {\r\n        if (this.disabled || this.readonly) {\r\n            return false;\r\n        }\r\n\r\n        this.selectionMgr.initDisplayValue();\r\n        this.dictPickingSubscription = this.dictPicking({\r\n            instance: this,\r\n        }).subscribe((pr: PickingResult) => {\r\n            this.dialogMgr.canOpenDialog(pr);\r\n        });\r\n\r\n        return false;\r\n    }\r\n\r\n    /** å¤æ­æ¯å¦ä¸ºååè¡¨å¸®å© */\r\n    isDoublleList() {\r\n        return (\r\n            this.displayType === LookupGridDisplayType.NavList ||\r\n            this.displayType === LookupGridDisplayType.NavTreeList\r\n        );\r\n    }\r\n    /** å¤æ­æ¯å¦æ¾ç¤ºä¸ºæ å¸®å© */\r\n    isTree() {\r\n        return (\r\n            this.displayType.toUpperCase() === LookupGridDisplayType.TreeList\r\n        );\r\n    }\r\n\r\n    onResized(e: any) {\r\n        this.resizeCmp(e.size);\r\n        this.resized.emit(e.size);\r\n    }\r\n\r\n    onResizing(pos: IResizeEvent) {\r\n        this.resizing.emit(pos.size);\r\n        this.resizeCmp(pos.size);\r\n        if (this.isDoublleList() && this.leftComponentRef) {\r\n            this.leftComponentRef.instance.resize({\r\n                width: this.leftPanel.width,\r\n                height: this.dialogMgr.getHeight(),\r\n            });\r\n        }\r\n    }\r\n\r\n    onMaxDialog(pos: IResizeEvent) {\r\n        this.resizeCmp(pos.size);\r\n        if (this.leftPanel) {\r\n            this.leftComponentRef.instance.resize({\r\n                width: this.leftPanel.width,\r\n                height: this.dialogMgr.getHeight(),\r\n            });\r\n        }\r\n        this.dialogHeight = pos.size.height;\r\n        this.dialogContentHeight = this.dialogMgr.resetDialogContentHeight();\r\n        this.dialogMaxed.emit(pos.size);\r\n    }\r\n\r\n    resizeCmp(size?: any) {\r\n        if (!this.componentRef || !this.componentRef.instance) {\r\n            return;\r\n        }\r\n\r\n        if (!size) {\r\n            size = this.dialog.size;\r\n        }\r\n        const _size = {\r\n            width:\r\n                size.width -\r\n                this.containerMargin.left -\r\n                this.containerMargin.right,\r\n            height: this.dialogMgr.getHeight(),\r\n        };\r\n\r\n        if (this.useFavorite && this.favoritesComponentRef) {\r\n            this.favoritesComponentRef.instance.resize(_size);\r\n        }\r\n        if (this.isRecordSize) {\r\n            this.personalConf.size = this.dialog.size;\r\n            this.personalConfigService.updatePersonalConfig({\r\n                size: this.dialog.size,\r\n            });\r\n        }\r\n        if (this.isDoublleList()) {\r\n            _size.width = size.width - this.leftPanel.width - 27;\r\n        }\r\n\r\n        this.componentRef.instance.resize(_size);\r\n    }\r\n\r\n    private checkGridOptions() {\r\n        if (!this.gridOptions.idField) {\r\n            this.writeConsole(\"æªè®¾ç½®ä¸»é®å­æ®µ idField\");\r\n        }\r\n\r\n        if (!this.beforeSelectData) {\r\n            this.beforeSelectData = () => {\r\n                return of(true);\r\n            };\r\n        }\r\n\r\n        const ctxMenuLanguages =\r\n            this.localService.getValue(\"lookup.contextMenu\");\r\n\r\n        this.treeTableOptions = Object.assign(\r\n            { language: ctxMenuLanguages },\r\n            this.defaultTreeTableOptions,\r\n            this.treeTableOptions || {}\r\n        );\r\n        // this.dataTableOptions = Object.assign({}, this.defaultTreeTableOptions, this.dataTableOptions);\r\n        // this.navTreeTableOptions = Object.assign({}, this.defaultTreeTableOptions, this.navTreeTableOptions);\r\n    }\r\n\r\n    getComponentType(): Type<any> {\r\n        if (!this.displayType) {\r\n            this.displayType = \"LIST\";\r\n        }\r\n        switch (this.displayType) {\r\n            case LookupGridDisplayType.List:\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n                return DataTableComponent;\r\n            case LookupGridDisplayType.TreeList:\r\n                return TreeTableComponent;\r\n        }\r\n    }\r\n\r\n    showLoading(msg = \"\") {\r\n        if (this.dialog && this.dialog.modalContent && !this.loading) {\r\n            const opts = {\r\n                container: this.dialog.modalContent,\r\n                delay: 200,\r\n            };\r\n\r\n            if (msg) {\r\n                opts[\"message\"] = msg;\r\n            }\r\n\r\n            this.loading = this.loadingService.show(opts);\r\n        } else {\r\n            this.loading = this.loadingService.show();\r\n        }\r\n    }\r\n\r\n    closeLoading() {\r\n        if (this.loading) {\r\n            this.loading.close();\r\n            this.loading = null;\r\n        }\r\n\r\n        this.loadingService.clearAll();\r\n    }\r\n\r\n    getSearchColumns(resdata: any) {\r\n        const cols = resdata.columns || this.columns;\r\n        if (resdata.searchFields) {\r\n            return resdata.searchFields.map((sf) => {\r\n                const c = cols.find(\r\n                    (col) => col.field.toLowerCase() === sf.value.toLowerCase()\r\n                );\r\n                if (c) {\r\n                    sf.label = c.title;\r\n                }\r\n                return sf;\r\n            });\r\n        } else if (cols) {\r\n            return cols\r\n                .filter((c) => c.searchField)\r\n                .map((col) => {\r\n                    return {\r\n                        label: col.title,\r\n                        value: col.field,\r\n                    };\r\n                });\r\n        }\r\n        return [];\r\n    }\r\n\r\n    private initOptions(resData: LookupGridResult) {\r\n        let obser = of(true);\r\n        this.gridOptions.searchFields = this.getSearchColumns(resData);\r\n        if (resData) {\r\n            // å¦æç»ä»¶ä¸­æªè®¾ç½®æ¾ç¤ºåï¼åä½¿ç¨æå¡å¨ç«¯è¿åçè®¾ç½®ï¼ å¦åå°ä½¿ç¨ç»ä»¶ä¸­éç½®çå±ç¤ºå\r\n            if (\r\n                (!this.columns || !this.columns.length) &&\r\n                resData.columns &&\r\n                resData.columns.length\r\n            ) {\r\n                this.columns = resData.columns;\r\n            }\r\n\r\n            this.setLookupTitleText(resData);\r\n\r\n            if (\r\n                this.isDoublleList() &&\r\n                this.dialogWidth < this.navLookupDialogMinWidth &&\r\n                !this.isRecordSize\r\n            ) {\r\n                this.dialogWidth = this.navLookupDialogMinWidth;\r\n                this.dialog.reSize({ width: this.dialogWidth });\r\n            }\r\n\r\n            if (!this.customDisplayType) {\r\n                this.displayType =\r\n                    resData.displayType || this.displayType || \"LIST\";\r\n                this.changeDetector.detectChanges();\r\n                this.lookupCmpMgr.createComponentWithServerData(resData);\r\n            }\r\n\r\n            if (\r\n                this.isDoublleList() &&\r\n                resData.navigation &&\r\n                !this.leftComponentRef\r\n            ) {\r\n                this.navigationOptions = resData.navigation;\r\n                this.navigationOptions.hover = true;\r\n                this.navigationOptions.searchFields = this.getSearchColumns(\r\n                    this.navigationOptions\r\n                );\r\n                // update columns formatter\r\n                if (this.customNavFormatter) {\r\n                    this.navigationOptions.columns.forEach((col) => {\r\n                        if (this.customNavFormatter[col.field]) {\r\n                            col.formatter = this.customNavFormatter[col.field];\r\n                        }\r\n                    });\r\n\r\n                    this.navigationOptions[\"rowStyler\"] =\r\n                        this.customNavFormatter.rowStyler;\r\n                    this.navigationOptions[\"cellStyler\"] =\r\n                        this.customNavFormatter.cellStyler;\r\n                }\r\n                // 20210926 æ å¯¼èªå¸®å©ä¸­ å·¦ä¾§æ æ¯æåå±å è½½\r\n                if (this.displayType === LookupGridDisplayType.NavTreeList) {\r\n                    let _nav_treeinfo_loadtype =\r\n                        this.navigationOptions.treeInfo.loadDataType;\r\n                    if (this.loadTreeDataType !== \"default\") {\r\n                        _nav_treeinfo_loadtype =\r\n                            this.loadTreeDataType === \"loadall\"\r\n                                ? \"all\"\r\n                                : \"async\";\r\n                    }\r\n                    this.navigationOptions.treeInfo.loadDataType =\r\n                        _nav_treeinfo_loadtype;\r\n                }\r\n\r\n                obser = this.lookupCmpMgr.createLeftComponent(this.navigationOptions);\r\n            }\r\n        } else {\r\n            this.lookupCmpMgr.createContent(this.gridOptions);\r\n            this.lookupCmpMgr.createFavoriteComponent();\r\n        }\r\n\r\n        if (this.isTextChange) {\r\n            this.componentRef.instance.searchData.value = this.displayText;\r\n        }\r\n\r\n        // update columns formatter\r\n        if (this.customFormatter) {\r\n            this.columns.forEach((col) => {\r\n                if (this.customFormatter[col.field]) {\r\n                    col.formatter = this.customFormatter[col.field];\r\n                }\r\n            });\r\n\r\n            if (this.customFormatter.rowStyler) {\r\n                this.componentRef.instance.rowStyler =\r\n                    this.customFormatter.rowStyler;\r\n            }\r\n\r\n            if (this.customFormatter.cellStyler) {\r\n                this.componentRef.instance.cellStyler =\r\n                    this.customFormatter.cellStyler;\r\n            }\r\n        }\r\n\r\n        this.changeDetector.detectChanges();\r\n        return obser;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®å¸®å©çªå£æ é¢\r\n     */\r\n    private setLookupTitleText(resData: LookupGridResult) {\r\n        if (resData.displayInfo) {\r\n            this.displayInfo = resData.displayInfo;\r\n        }\r\n\r\n        // å¦æèªå®ä¹æ é¢ï¼å°ä»¥æ­¤æ é¢ä¸ºåãå¦åå è½½æå¡å¨ç«¯è¿åçæ°æ®\r\n        if (this.title && this.title !== \"æ­¤å¤æ¾ç¤ºå¸®å©æ é¢\") {\r\n            this.displayInfo.title = this.title;\r\n        }\r\n\r\n        if (this.displayInfo && resData.title) {\r\n            if (!this.displayInfo.title) {\r\n                this.displayInfo.title = resData.title;\r\n            }\r\n        }\r\n    }\r\n\r\n    private showGetAllChildrenCheckbox() {\r\n        if (this.isTree() && this.treeInfo) {\r\n            this.enableGetAllChildNodes =\r\n                this.treeInfo.loadDataType !== \"all\" && this.treeInfo.layerType === \"pathcode\";\r\n        } else {\r\n            this.enableGetAllChildNodes = false;\r\n        }\r\n    }\r\n\r\n    initData() {\r\n        const observer = {\r\n            next: (data: LookupGridResult) => {\r\n                // æå¡å¨ç«¯åçéè¯¯ï¼è¿åNULL æ¶ï¼ç´æ¥å³é­çªå£\r\n                if (data === null) {\r\n                    this.isShow = false;\r\n                    if (this.dialog) {\r\n                        this.dialog.close();\r\n                    }\r\n                    return;\r\n                }\r\n                this.initOptions(data).subscribe(() => {\r\n                    this.selectedColumns =\r\n                        this.multiSelMgr.initSelectedColumns();\r\n                    this.favoriteColumns = this.favHelper.getFavoriteColumns();\r\n\r\n                    if (this.usePersionalConf) {\r\n                        if (!this.personalConfigService.getPersonalData()) {\r\n                            this.personalConfigService.savePersonalConfig(\r\n                                this.personalConf\r\n                            );\r\n                        }\r\n                    }\r\n                    if (!this.isTabChanged) {\r\n                        this.lookupSelectionSer.loadSelections(\r\n                            data.selectedItems || []\r\n                        );\r\n                    }\r\n\r\n                    if (this.isDoublleList()) {\r\n                        // å¯¼èªå¸®å©æ¶ï¼è®¾ç½®å·¦ä¾§éä¸­æ°æ®æ¶ï¼ä¸å è½½ä¸»æ°æ®åè¡¨ã\r\n                        if (this.navSelectedIds || this.selectFirstInNav) {\r\n                            this.loadDataWhenOpen = false;\r\n                        }\r\n                    }\r\n\r\n                    if (data['activeTab'] && !this.isTabChanged) {\r\n                        this.activeTab = 'datalist';\r\n                    }\r\n\r\n                    this.loadData(data);\r\n\r\n                    if (this.isTree()) {\r\n                        if (this.activeTab === \"datalist\") {\r\n                            const tt = this.componentRef.instance as TreeTableComponent;\r\n                            if (tt.searchData.value && this.items && this.items.length) {\r\n                                if (this.items[0].children && this.items[0].children.length) {\r\n                                    tt.toggleExpand(this.items[0], true, false);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        this.showGetAllChildrenCheckbox();\r\n                    }\r\n                    this.isTextChange = false;\r\n                    this._searchResult = null; // æ¸ç©ºä¸´æ¶æ¥è¯¢ ç»æ\r\n                    this.closeLoading();\r\n                    // this.isReady$.next(true);\r\n                    this.isReady = true;\r\n                    this.changeDetector.detectChanges();\r\n                    this.lookupinitializationSubject.next();\r\n                });\r\n            },\r\n            error: (err: any) => {\r\n                // this.isReady$.next(true);\r\n                this.closeLoading();\r\n                this._searchResult = null; // æ¸ç©ºä¸´æ¶æ¥è¯¢ ç»æ\r\n                this.isTextChange = false;\r\n\r\n                this.hasError = true;\r\n                this.changeDetector.detectChanges();\r\n                if (typeof err === \"string\") {\r\n                    this.messagerService.error(err);\r\n                } else {\r\n                    if (err) {\r\n                        if (err.Message) {\r\n                            this.messagerService.error(err.Message);\r\n                        } else {\r\n                            if (err.error) {\r\n                                this.messagerService.error(err.error.Message);\r\n                            } else {\r\n                                this.messagerService.error(\r\n                                    \"åºç¨æå¡å¨éè¯¯,è¯·èç³»ç³»ç»ç®¡çåï¼\"\r\n                                );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n        };\r\n\r\n        let p: any = {\r\n            pageInfo: {\r\n                pageSize: this.pageSize || 20,\r\n                pageIndex: 1,\r\n            },\r\n        };\r\n        let t: LOAD_DATA_TYPE = \"all\";\r\n        if (this.isTextChange) {\r\n            this._searchState = { \r\n                field: \"*\",\r\n                value: this.displayText\r\n            }\r\n            p = {\r\n                search: this._searchState\r\n            };\r\n            \r\n            t = 'search';\r\n        }\r\n\r\n        if (!this.isTabChanged && this.enableToSelect) {\r\n            const vals = this.selectionMgr.getSelectedIds();\r\n            if (vals && vals.length) {\r\n                p[\"selectedInfo\"] = {\r\n                    selected: true,\r\n                    selectedIds: vals,\r\n                };\r\n            } else {\r\n                if (this[\"selectedIds\"]) {\r\n                    p[\"selectedInfo\"] = {\r\n                        selected: true,\r\n                        selectedIds: this[\"selectedIds\"],\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        this.showLoading();\r\n        this.hasError = false;\r\n        this.httpMgr.lookupRequest(p, t).pipe(\r\n            map((restData: LookupGridResult) => {\r\n                if (restData) {\r\n                    restData.selectedItems = restData[\"selectedData\"] || [];\r\n                } else {\r\n                    if (restData && typeof restData === \"object\") {\r\n                        restData.selectedItems = [];\r\n                    }\r\n                }\r\n                return restData === null ? false : restData;\r\n            })\r\n        ).subscribe(observer);\r\n    }\r\n\r\n    loadData(resData?: LookupGridResult, rebindEvent = true) {\r\n        if (this.activeTab === \"datalist\") {\r\n            if (this.useFavorite && !this.isTree()) {\r\n                this.favHelper.updateFavoritesStatus(resData.items);\r\n            }\r\n\r\n            switch (this.displayType) {\r\n                case LookupGridDisplayType.NavList:\r\n                case LookupGridDisplayType.NavTreeList:\r\n                case LookupGridDisplayType.List:\r\n                    this.loadDataTableData(resData);\r\n                    if (rebindEvent) {\r\n                        this.dtEventMgr.bindDataTableEvent();\r\n                    }\r\n                    break;\r\n                case LookupGridDisplayType.TreeList:\r\n                    this.loadTreeTableData(resData, rebindEvent);\r\n                    break;\r\n            }\r\n        } else if (this.activeTab === \"favorite\") {\r\n            this.loadFavData(resData);\r\n        }\r\n\r\n        // éä¸­æ°æ®\r\n        this.selectionMgr.selectCurrentValue();\r\n    }\r\n\r\n    private loadFavData(result: LookupGridResult) {\r\n        // å è½½æ¶èæ°æ®\r\n        if (this.useFavorite) {\r\n            if (this.isTree()) {\r\n                this.setTreeInfo(result);\r\n                const treeNodes = this.favHelper.initFavoriteTreeData(\r\n                    result.items\r\n                );\r\n                const treeData = this.treeNodeHelper\r\n                    .flatTreeNodes(treeNodes)\r\n                    .map((n) => {\r\n                        n.data[\"_addtional_\"] = n[\"addtional\"];\r\n                        return n.data;\r\n                    });\r\n                this.lookupSelectionSer.initFavoriteItems(treeData);\r\n\r\n                setTimeout(() => {\r\n                    this.favoritesComponentRef.instance.scrollToY(1);\r\n                });\r\n            } else {\r\n                this.lookupSelectionSer.initFavoriteItems(result.items);\r\n            }\r\n\r\n            this.favHelper.loadFavoritesData(result);\r\n        }\r\n    }\r\n\r\n    loadDataTableData(resData?: LookupGridResult) {\r\n        if (resData) {\r\n            if (this.gridOptions) {\r\n                if (resData && resData.columns && resData.columns.length) {\r\n                    if (\r\n                        !this.gridOptions.columns ||\r\n                        !this.gridOptions.columns.length\r\n                    ) {\r\n                        this.columns = resData.columns;\r\n                    }\r\n                }\r\n\r\n                this.items = resData.items;\r\n                this.total = resData.total || resData.items.length;\r\n                if ( resData.searchFields ) {\r\n                    this.gridOptions.searchFields = this.getSearchColumns(resData);\r\n                }\r\n                if (resData.pageInfo) {\r\n                    if (\r\n                        resData.pageInfo.pageList &&\r\n                        (!this.pageList || !this.pageList.length)\r\n                    ) {\r\n                        this.pageList = resData.pageInfo.pageList;\r\n                    }\r\n                    this.pagination = resData.pageInfo.enablePager;\r\n                    this.pageIndex = resData.pageInfo.pageIndex;\r\n                    this.pageSize = resData.pageInfo.pageSize;\r\n                } else {\r\n                    this.pagination = false;\r\n                }\r\n            } else {\r\n                this.gridOptions = resData as LookupGridOptions;\r\n            }\r\n        }\r\n\r\n        this.updateDataTable(this.gridOptions);\r\n    }\r\n\r\n    private updateDataTable(opts: any) {\r\n        if (opts) {\r\n            const dt = this.componentRef.instance as DataTableComponent;\r\n\r\n            if (!dt.columns || dt.columns.length === 0) {\r\n                dt.columns = this.gridOptions.columns;\r\n            }\r\n\r\n            dt.allColumnsTitle = this.allColumnsTitle;\r\n            dt.searchFields = opts.searchFields;\r\n            dt.pagination = opts.pagination;\r\n            dt.pageList = this.pageList;\r\n            dt.remoteSort = this.remoteSort;\r\n\r\n            if (this.loadDataWhenOpen) {\r\n                dt.loadData({\r\n                    pageSize: opts.pageSize,\r\n                    pageIndex: this.gridOptions.pageIndex,\r\n                    total: this.gridOptions.total,\r\n                    data: this.gridOptions.items,\r\n                });\r\n                dt.cd.markForCheck();\r\n            }\r\n            this.loadSuccess.emit();\r\n        }\r\n    }\r\n\r\n    private setTreeInfo(resData) {\r\n        if (!resData) {\r\n            return;\r\n        }\r\n\r\n        let _treeInfo = null;\r\n        if (resData.treeInfo) {\r\n            const onlySelectLeaf = resData.treeInfo.onlySelectLeaf;\r\n            let _osl: ONLY_SELECT_LEAF = \"no\";\r\n            if (onlySelectLeaf !== undefined) {\r\n                _osl = onlySelectLeaf ? \"yes\" : \"no\";\r\n            }\r\n            _treeInfo = { ...resData.treeInfo, onlySelectLeaf: _osl };\r\n        }\r\n\r\n        if (this.gridOptions.treeInfo) {\r\n            const treeInfo = this.gridOptions.treeInfo;\r\n            if (treeInfo) {\r\n                if (\r\n                    treeInfo.onlySelectLeaf === undefined ||\r\n                    treeInfo.onlySelectLeaf === null\r\n                ) {\r\n                    treeInfo.onlySelectLeaf = \"no\";\r\n                }\r\n\r\n                if (typeof treeInfo.onlySelectLeaf === \"boolean\") {\r\n                    treeInfo.onlySelectLeaf = treeInfo.onlySelectLeaf ? \"yes\" : \"no\";\r\n                }\r\n\r\n                // 20210902\r\n                if (this.loadTreeDataType === \"default\") {\r\n                    treeInfo.loadDataType = _treeInfo.loadDataType;\r\n                } else {\r\n                    treeInfo.loadDataType =\r\n                        this.loadTreeDataType === \"loadall\" ? \"all\" : \"async\";\r\n                }\r\n\r\n                if (treeInfo.onlySelectLeaf !== \"default\") {\r\n                    _treeInfo = Object.assign(_treeInfo, treeInfo);\r\n                }\r\n            }\r\n        }\r\n\r\n        this.treeInfo = _treeInfo;\r\n    }\r\n\r\n    private loadTreeTableData(resData?: LookupGridResult, rebindEvent = true) {\r\n        const items = resData ? resData.items : this.gridOptions.items;\r\n        this.items = items;\r\n\r\n        if (resData) {\r\n            this.setTreeInfo(resData);\r\n\r\n            const treeInfo = this.gridOptions.treeInfo;\r\n            if (!treeInfo[\"treeDataIsInit\"]) {\r\n                if (treeInfo.layerType.toLowerCase() === \"pathcode\") {\r\n                    this.items = this.lookupUtils.makeTree(\r\n                        this.items,\r\n                        treeInfo\r\n                    );\r\n                } else {\r\n                    this.items = this.lookupUtils.makeTreeWithParentID(\r\n                        this.items,\r\n                        \"\",\r\n                        `${treeInfo.dataField}.${treeInfo.parentField}`,\r\n                        this.idField\r\n                    );\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.componentRef.instance instanceof TreeTableComponent) {\r\n            const tt = this.componentRef.instance as TreeTableComponent;\r\n            if (this.treeInfo) {\r\n                tt.loadDataType = this.treeInfo.loadDataType;\r\n            }\r\n\r\n            if (!this.columns || !this.columns.length) {\r\n                tt.columns = resData.columns || [];\r\n                this.gridOptions.columns = tt.columns;\r\n            }\r\n\r\n            const isLoadAllTreeData = () => {\r\n                if (this.loadTreeDataType === \"default\") {\r\n                    return tt.loadDataType === \"all\";\r\n                } else {\r\n                    return this.loadTreeDataType === \"loadall\";\r\n                }\r\n            };\r\n\r\n            if (rebindEvent) {\r\n                this.ttEventMgr.bindTreetableEvent();\r\n            }\r\n            const isLoadAll = isLoadAllTreeData();\r\n\r\n            /** å®æ´æ èç¹æ£æ¥ By Lucas 20200302 */\r\n            \r\n            this.items = this.checkNodeCanBeSelect(this.items, isLoadAll);\r\n            tt.keepSelect = true;\r\n\r\n            if (this.useFavorite) {\r\n                this.favHelper.updateFavoritesStatus(this.items);\r\n            }\r\n\r\n            if (this.loadDataWhenOpen) {\r\n                tt.loadData(this.items);\r\n            }\r\n            tt.resize();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¨æå®æ´æ ä¸­ï¼æé¨åèç¹å ä¸ºæ¡ä»¶è¢«è¿æ»¤ï¼ä¸ºæ¾ç¤ºå®æ´æ ï¼\r\n     * è¿äºèç¹å¨è¿è¡æ¶æ¯ä¸åè®¸è¢«éä¸­ç, è¿åæ°çèç¹æ°ç»\r\n     * By Lucas 20200302\r\n     */\r\n    checkNodeCanBeSelect(nodes, isAllTreeData = false): TreeNode[] {\r\n        if (nodes && nodes.length) {\r\n            return nodes.map((node: TreeNode) => {\r\n                if (node.hasOwnProperty(\"addtional\")) {\r\n                    node.selectable = !node[\"addtional\"];\r\n                }\r\n\r\n                if (node.children && node.children.length) {\r\n                    this.checkNodeCanBeSelect(node.children, isAllTreeData);\r\n                } else {\r\n                    if (isAllTreeData && (!this._searchState || !this._searchState.value)) {\r\n                        node.leaf = true;\r\n                    }\r\n                }\r\n\r\n                return node;\r\n            });\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    onChanges(val) {\r\n        if (!val) {\r\n            this.onClear();\r\n        } else {\r\n            this.displayText = val;\r\n            this.isTextChange = this.originalText !== this.displayText;\r\n            if (this.nosearch) {\r\n                this.setModelValue(val);\r\n                this.clearMappings.emit({ instance: this, value: val, });\r\n            }\r\n\r\n            this.onModelTouched(val);\r\n            this.valueChanged.emit(val);\r\n            this.textChanged.emit(val);\r\n        }\r\n    }\r\n\r\n    onClear(emit = true) {\r\n        this.isTextChange = false;\r\n        this.displayText = \"\";\r\n        this.displayValue = \"\";\r\n        this.originalText = \"\";\r\n        this.extendInfo = \"\";\r\n        this.setModelValue(\"\");\r\n        if (this.mappingFn) {\r\n            this.mappingFn(null, this.mapFields);\r\n        } else {\r\n            if (this.mapFields) {\r\n                const bindingData = this.selectionMgr.getBindingData();\r\n                if (bindingData) {\r\n                    this.defaultMapping.lookupFieldMap(\r\n                        null,\r\n                        this.mapFields,\r\n                        bindingData\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        this.multiSelMgr.clear();\r\n        if (emit) {\r\n            this.clear.emit();\r\n        }\r\n    }\r\n\r\n    clearValue(emit = true) {\r\n        this.onClear(emit);\r\n    }\r\n\r\n    selectItem(rowData?: any) {\r\n        let selectedRow = null;\r\n        if (rowData) {\r\n            selectedRow = rowData;\r\n        } else {\r\n            selectedRow = this.selections;\r\n\r\n            if (!selectedRow) {\r\n                selectedRow = null;\r\n            } else {\r\n                if (Array.isArray(selectedRow) && !selectedRow.length) {\r\n                    selectedRow = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // å¦æå®ä¹èªå®ä¹å¤çç¡®å®äºä»¶ï¼åç±èªå®ä¹äºä»¶å¤çåé¢çé»è¾\r\n        if (this.okHandler) {\r\n            this.okHandler({ data: selectedRow, instance: this });\r\n        } else {\r\n            if (this.beforeSelectData) {\r\n                const bsdResult = this.beforeSelectData({\r\n                    instance: this,\r\n                    data: selectedRow,\r\n                });\r\n                if (bsdResult && bsdResult.subscribe) {\r\n                    bsdResult.subscribe((e: any) => {\r\n                        this._beforeSelectDataCallBack(e, selectedRow);\r\n                    });\r\n                } else {\r\n                    this.writeConsole('å¸®å©æ°æ®éä¸­åäºä»¶æªè¿åå¼æè¿åç±»åéObservable, è¯·æ£æ¥', 'error');\r\n                }\r\n            } else {\r\n                this._beforeSelectDataCallBack(true, selectedRow);\r\n            }\r\n        }\r\n    }\r\n\r\n    private getParentPathCode(rows) {\r\n        const maxBy = (arr, fn) =>\r\n            Math.max(\r\n                ...arr.map(typeof fn === \"function\" ? fn : (val) => val[fn])\r\n            );\r\n\r\n        const { dataField, pathField, layerField } = this.treeInfo;\r\n        const maxLayer = maxBy(rows, (x) => x[dataField][layerField]);\r\n\r\n        for (let i = 1; i <= maxLayer; i++) {\r\n            const _rows = rows.filter((n) => n[dataField][layerField] === i);\r\n            if (_rows && _rows.length && _rows.length < rows.length) {\r\n                _rows.forEach((r) => {\r\n                    const patchCode = r[dataField][pathField];\r\n                    const _rows2 = rows.filter(\r\n                        (n) =>\r\n                            n[dataField][pathField] !== patchCode &&\r\n                            n[dataField][pathField].indexOf(patchCode) === 0\r\n                    );\r\n                    if (_rows2 && _rows2.length) {\r\n                        rows = rows.filter(\r\n                            (n) => n[dataField][pathField] !== patchCode\r\n                        );\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        return rows;\r\n    }\r\n\r\n    private _beforeSelectDataCallBack(e, selectedRow) {\r\n        let canSelect = e;\r\n        let message = \"\";\r\n        if (typeof e === \"boolean\") {\r\n            canSelect = e;\r\n        } else {\r\n            if (typeof e === \"object\") {\r\n                canSelect = e.canSelect;\r\n                message = e.message;\r\n            } else {\r\n                canSelect = false;\r\n            }\r\n        }\r\n\r\n        if (!selectedRow) {\r\n            message = this.mustChoosAdatarow;\r\n            canSelect = false;\r\n        }\r\n\r\n        if (canSelect) {\r\n            let selectedRows$ = of(selectedRow);\r\n            // å¤é æ å¸®å© å¼æ­¥å è½½ åçº§ç  å¼å¯åæ­¥éæ© æåå«ä¸çº§\r\n            if (!this.singleSelect && this.enableCascade && this.isTree() ) {\r\n                if (this.treeInfo.loadDataType !== \"all\" && this.treeInfo.layerType === \"pathcode\" && this.isGetAllChidlNodes) {\r\n                    let parentsIds = this.getParentPathCode(selectedRow);\r\n                    if (parentsIds && parentsIds.length) {\r\n                        parentsIds = parentsIds.map(\r\n                            (n) =>\r\n                                n[this.treeInfo.dataField][this.treeInfo.pathField]\r\n                        );\r\n                        this.showLoading();\r\n                        selectedRows$ = this.httpMgr\r\n                            .getData({ parentsIds }, \"allChildren\")\r\n                            .pipe(\r\n                                map((r: LookupGridResult) => {\r\n                                    const items = r.items\r\n                                        ? r.items.map((d) => d.data)\r\n                                        : [];\r\n                                    const allitems = [...selectedRow, ...items];\r\n                                    let ids = allitems.map((n) => n[this.idField]);\r\n                                    ids = Array.from(new Set(ids));\r\n                                    return ids.map((n) =>\r\n                                        allitems.find((a) => a[this.idField] === n)\r\n                                    );\r\n                                })\r\n                            );\r\n                    }\r\n                }\r\n            }\r\n\r\n            selectedRows$.subscribe((rows) => {\r\n                this.closeLoading();\r\n                this.updateControlValue(rows);\r\n                if (!this.useTip || !rows) {\r\n                    return;\r\n                }\r\n                if (this.useTip) {\r\n                    this.personalConfigService.updateQueckSelected(\r\n                        rows,\r\n                        this.localService.localeId\r\n                    );\r\n                }\r\n            });\r\n        } else {\r\n            if (message) {\r\n                if (this.notifyService) {\r\n                    this.notifyService.warning(message);\r\n                } else {\r\n                    this.messagerService.warning(message, \"\", true, () => {\r\n                        this.dialog.el.nativeElement.click();\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private updateControlValue(selectedRow) {\r\n        if (selectedRow) {\r\n            this.setDisplayText(selectedRow);\r\n            if (this.mappingFn) {\r\n                this.mappingFn(selectedRow, this.mapFields, this.bindingData);\r\n            } else {\r\n                if (this.mapFields && this.bindingData) {\r\n                    this.defaultMapping.lookupFieldMap(\r\n                        selectedRow,\r\n                        this.mapFields,\r\n                        this.bindingData\r\n                    );\r\n                }\r\n            }\r\n            this.setModelValue(this.displayText);\r\n            if (this[\"inDatagrid\"] && selectedRow) {\r\n                const selectItems = Array.isArray(selectedRow)\r\n                    ? selectedRow\r\n                    : [selectedRow];\r\n                this.updateBindData(selectItems);\r\n            }\r\n            this.selectedData.emit(selectedRow);\r\n            this.runDictPickedEvent(selectedRow);\r\n            this.isTextChange = false;\r\n        } else {\r\n            if (document.activeElement) {\r\n                (document.activeElement as HTMLButtonElement).blur();\r\n            }\r\n            this.messagerService.warning(this.mustChoosAdatarow);\r\n        }\r\n    }\r\n\r\n    private updateBindData(selectedRow) {\r\n        if (!this.mapFields) {\r\n            return;\r\n        }\r\n\r\n        const helpFields = Object.keys(this.mapFields);\r\n        if (\r\n            this.ngControl &&\r\n            this.ngControl.formDirective &&\r\n            this.ngControl.formDirective.form &&\r\n            this.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ngControl.formDirective.form.bindingData;\r\n\r\n            if (bindingData) {\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const val = selectedRow\r\n                                .map((r) => {\r\n                                    return this.utils.getValue(helpField, r);\r\n                                })\r\n                                .join(this.multipleChoiceSeparator);\r\n                            this.utils.setValue(bindingData, formField, val);\r\n                        });\r\n                });\r\n            }\r\n\r\n            // if (bindingData.setValue) {\r\n            //     const bindingPath = this.ngControl.formDirective.form.bindingPath;\r\n            //     let pathArr: string[] = [];\r\n            //     if (bindingPath) {\r\n            //         pathArr = bindingPath.split('/').filter(n => n !== '');\r\n            //     }\r\n\r\n            //     helpFields.forEach((helpField: any) => {\r\n            //         this.mapFields[helpField].split(',').forEach((formField: any) => {\r\n            //             const fieldPaths = pathArr.concat(formField.split('.'));\r\n            //             const val = selectedRow.map(r => {\r\n            //                 return this.utils.getValue(formField, r);\r\n            //             }).join(this.multipleChoiceSeparator);\r\n            //             bindingData.setValue(pathArr.concat(fieldPaths), val, true, true);\r\n            //         });\r\n            //     });\r\n            // }\r\n        } else {\r\n            // if (this.bindingData) {\r\n            //     helpFields.forEach((helpField: any) => {\r\n            //         this.mapFields[helpField].split(',').forEach((formField: any) => {\r\n            //             const val = selectedRow.map(r => {\r\n            //                 return this.utils.getValue(formField, r);\r\n            //             }).join(this.multipleChoiceSeparator);\r\n            //             this.utils.setValue(this.bindingData, formField, val);\r\n            //         });\r\n            //     });\r\n            // }\r\n        }\r\n    }\r\n\r\n    private getExtendInfoFields(isHelpData = true) {\r\n        if (!this.extInfoFields) {\r\n            this.writeConsole(`æªè®¾ç½®æ©å±å­æ®µã`);\r\n            return [];\r\n        }\r\n        const tipFieldArr = this.extInfoFields.split(\",\");\r\n\r\n        if (isHelpData) {\r\n            let extendInfoFields = [];\r\n            extendInfoFields = tipFieldArr.map((tf) => {\r\n                const mapKey = Object.keys(this.mapFields).find((k) => {\r\n                    return this.mapFields[k] === tf;\r\n                });\r\n\r\n                if (mapKey) {\r\n                    return mapKey;\r\n                } else {\r\n                    this.writeConsole(`å¨å¸®å©æ å°å­æ®µä¸­æªæ¾å°${tf}`);\r\n                    return \"\";\r\n                }\r\n            });\r\n            return extendInfoFields;\r\n        }\r\n\r\n        return tipFieldArr;\r\n    }\r\n\r\n    onUpdateExtendInfo() {\r\n        const jsonData = this.selectionMgr.getBindingData();\r\n        this.updateExtendInfo(jsonData, false);\r\n    }\r\n\r\n    // éä¸­å¸®å©æ°æ®åï¼æ´æ°æ©å±ä¿¡æ¯\r\n    private updateExtendInfo(data: any, isHelpData = true) {\r\n        if (data) {\r\n            if (this.extInfoFormatter) {\r\n                if (Array.isArray(data)) {\r\n                    const tipString = data.map((n) => {\r\n                        return this.getExtendInfoText(n);\r\n                    });\r\n                    this.extendInfo = tipString.join(\"ï¼\");\r\n                } else {\r\n                    this.extendInfo = this.getExtendInfoText(data);\r\n                }\r\n            } else {\r\n                const extendInfoFields = this.getExtendInfoFields(isHelpData);\r\n                if (extendInfoFields && extendInfoFields.length) {\r\n                    if (Array.isArray(data)) {\r\n                        const tipString = data.map((n) => {\r\n                            return this.getExtendInfoText(n, extendInfoFields);\r\n                        });\r\n                        this.extendInfo = tipString.join(\"ï¼\");\r\n                    } else {\r\n                        this.extendInfo = this.getExtendInfoText(\r\n                            data,\r\n                            extendInfoFields\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getExtendInfoText(itemData, fields = null) {\r\n        if (typeof this.extInfoFormatter === \"function\") {\r\n            return this.extInfoFormatter({\r\n                bindingData: itemData,\r\n                instance: this,\r\n            });\r\n        } else {\r\n            const tipString = [];\r\n            const tipValues = fields.map((t) => {\r\n                const tfv = this.utils.getValue(t, itemData);\r\n                tipString.push(tfv);\r\n                return { [t]: tfv };\r\n            });\r\n            return tipString.join(\" \");\r\n        }\r\n    }\r\n\r\n    private getDisplayText(rows: any) {\r\n        const df = this.displayFields\r\n            ? this.displayFields.split(\",\")\r\n            : [this.textField];\r\n        const txtArr = rows.map((r) => {\r\n            const t = [];\r\n            df.forEach((n) => {\r\n                t.push(this.utils.getValue(n, r));\r\n            });\r\n            return t.join(this.displayTextSeparator);\r\n        });\r\n\r\n        if (this.gridOptions.singleSelect) {\r\n            return txtArr.join(\"\");\r\n        } else {\r\n            if (this.displayFields) {\r\n                return txtArr.map((t) => \"[\" + t + \"]\").join(\",\");\r\n            } else {\r\n                return txtArr.join(\",\");\r\n            }\r\n        }\r\n    }\r\n\r\n    private setDisplayText(selectedRow: any) {\r\n        this.originalText = this.displayText;\r\n\r\n        if (this.gridOptions.singleSelect) {\r\n            if (this.displayFormatter) {\r\n                this.displayText = this.utils.getValue(\r\n                    this.textField,\r\n                    selectedRow\r\n                );\r\n                if (!this.isTree()) {\r\n                    this.displayText = this.displayFormatter(\r\n                        this.displayText,\r\n                        [selectedRow],\r\n                        {\r\n                            lookup: this,\r\n                            datatable: this.componentRef\r\n                                .instance as DataTableComponent,\r\n                        }\r\n                    );\r\n                } else {\r\n                    const tt = this.componentRef.instance as TreeTableComponent;\r\n                    this.displayText = this.displayFormatter(\r\n                        this.displayText,\r\n                        [selectedRow],\r\n                        { lookup: this, tree: tt }\r\n                    );\r\n                }\r\n            } else {\r\n                this.displayText = this.getDisplayText([selectedRow]);\r\n            }\r\n            this.displayValue = selectedRow[this.valueField];\r\n        } else {\r\n            if (selectedRow.length) {\r\n                if (this.displayFormatter) {\r\n                    this.displayText = selectedRow\r\n                        .map((r) => {\r\n                            return this.utils.getValue(this.textField, r);\r\n                        })\r\n                        .join(this.multipleChoiceSeparator);\r\n                    if (!this.isTree()) {\r\n                        this.displayText = this.displayFormatter(\r\n                            this.displayText,\r\n                            selectedRow,\r\n                            {\r\n                                lookup: this,\r\n                                datatable: this.componentRef\r\n                                    .instance as DataTableComponent,\r\n                            }\r\n                        );\r\n                    } else {\r\n                        const tt = this.componentRef\r\n                            .instance as TreeTableComponent;\r\n                        this.displayText = this.displayFormatter(\r\n                            this.displayText,\r\n                            selectedRow,\r\n                            { lookup: this, tree: tt }\r\n                        );\r\n                    }\r\n                } else {\r\n                    this.displayText = this.getDisplayText(selectedRow);\r\n                }\r\n\r\n                this.displayValue = selectedRow\r\n                    .map((r) => {\r\n                        return this.utils.getValue(this.valueField, r);\r\n                    })\r\n                    .join(this.multipleChoiceSeparator);\r\n            }\r\n        }\r\n        this.originalText = this.displayText;\r\n    }\r\n\r\n    runDictPickedEvent(rowData: any) {\r\n        if (this.dictPicked) {\r\n            if (this.okButton) {\r\n                this.okButton.nativeElement.disabled = true;\r\n            }\r\n            this.dictPickedSubscription = this.dictPicked(rowData).subscribe(\r\n                (v: any) => {\r\n                    if (this.okButton) {\r\n                        this.okButton.nativeElement.disabled = false;\r\n                    }\r\n                    if (typeof v === \"boolean\") {\r\n                        if (v) {\r\n                            this.closeDialog(rowData);\r\n                        }\r\n                    } else if (\r\n                        typeof v === \"object\" &&\r\n                        v.closeDialog !== undefined &&\r\n                        !v.closeDialog\r\n                    ) {\r\n                        if (v.message) {\r\n                            this.messagerService.warning(v.message);\r\n                        } else {\r\n                            this.closeDialog(rowData);\r\n                        }\r\n                    } else {\r\n                        this.closeDialog(rowData);\r\n                    }\r\n                }\r\n            );\r\n        } else {\r\n            this.closeDialog(rowData);\r\n        }\r\n    }\r\n\r\n    private focusToInput(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            setTimeout(() => {\r\n                if (this.inputGroup && this.inputGroup.textbox) {\r\n                    this.inputGroup.textbox.nativeElement.focus();\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    closeDialog(rowData = null) {\r\n        this.isShow = false;\r\n        if (this.dialog) {\r\n            this.dialog.close();\r\n        }\r\n\r\n        if (rowData) {\r\n            this.multiSelMgr.save(rowData);\r\n        }\r\n\r\n        this.focusToInput();\r\n    }\r\n\r\n    cancelSelect() {\r\n        this.closeDialog();\r\n        this.isTextChange = false;\r\n        if (!this.nosearch) {\r\n            this.displayText = this.originalText;\r\n            this.setModelValue(this.displayText);\r\n        }\r\n\r\n        if (this.cancelHandler) {\r\n            this.cancelHandler(this);\r\n        }\r\n    }\r\n\r\n    setModelValue(v) {\r\n        if (this.onModelChange) {\r\n            this.onModelChange(v);\r\n            this.valueChanged.emit(v);\r\n        }\r\n    }\r\n\r\n    // æ°æ®åè¡¨ï¼æ¶èï¼ å·²éæ°æ® tab é¡µåæ¢\r\n    onTabChange(e: any) {\r\n        this.activeTab = e.tabIndex;\r\n        this.personalConf.tabIndex = this.activeTab;\r\n        const _firstChange = this.isTabChanged;\r\n        this.isTabChanged = true;\r\n        this.personalConfigService.updatePersonalConfig({\r\n            tabIndex: e.tabIndex,\r\n        });\r\n\r\n        if (this.activeTab === \"datalist\") {\r\n            if (this.isDoublleList() && !this.leftComponentRef) {\r\n                if (this.navigationOptions) {\r\n                    this.lookupCmpMgr.createLeftComponent(\r\n                        this.navigationOptions\r\n                    );\r\n                } else {\r\n                    this.initData();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if ((!this.items || !this.items.length) && (!this._searchState || !this._searchState.value) ) {\r\n                this.initData();\r\n            } else {\r\n                if (!_firstChange) {\r\n                    if (this.isTree()) {\r\n                        this.loadTreeTableData();\r\n                    } else {\r\n                        this.loadDataTableData();\r\n                        this.dtEventMgr.bindDataTableEvent();\r\n                    }\r\n                }\r\n                // this.selectionMgr.selectCurrentValue();\r\n            }\r\n            this.showGetAllChildrenCheckbox();\r\n        } else {\r\n            if (this.activeTab === \"favorite\") {\r\n                if (this.isTree()) {\r\n                    this.initData();\r\n                } else {\r\n                    if (\r\n                        !this.favoriteItems ||\r\n                        !this.favoriteItems.length ||\r\n                        this.favoriteItems.length !== this.favHelper.getFavoritIds().length\r\n                    ) {\r\n                        this.initData();\r\n                    } else if (!_firstChange) {\r\n                        this.favHelper._loadFavoriteData(this.favoriteItems);\r\n                        // this.selectionMgr.selectCurrentValue();\r\n                    }\r\n                    //  else {\r\n                    //     this.selectionMgr.selectCurrentValue();\r\n                    // }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.changeDetector.detectChanges();\r\n        setTimeout(() => {\r\n            this.resizeCmp();\r\n            if (this.isTree()) {\r\n                const y = this.componentRef.instance.state.scrollY;\r\n                this.componentRef.instance.scrollToY(y, 0);\r\n\r\n                if (this.enableCascade) {\r\n                    this.ttEventMgr.cascadeValueChanged(this.cascadeStatus);\r\n                }\r\n            }\r\n            this.selectionMgr.selectCurrentValue();\r\n        });\r\n    }\r\n\r\n    //#region  Tag View ----------------------------------------------------------------------\r\n    private registerMouseEventForTagView() {\r\n        if (this.enableClear) {\r\n            this.tagbox.nativeElement.addEventListener(\r\n                \"mouseenter\",\r\n                this.onTagboxMouseEnter.bind(this)\r\n            );\r\n            this.tagbox.nativeElement.addEventListener(\r\n                \"mouseleave\",\r\n                this.onTagboxMouseLeave.bind(this)\r\n            );\r\n        }\r\n    }\r\n\r\n    private toggleClearIcon(event: any, isShow = false) {\r\n        const str = isShow ? \"\" : \"none\";\r\n        const clearIcon = event.target.querySelector(\".input-group-clear\");\r\n        if (clearIcon) {\r\n            clearIcon.style.display = str;\r\n        }\r\n    }\r\n\r\n    private onTagboxMouseEnter(event) {\r\n        if (this.displayText && this.enableClear) {\r\n            if (!this.readonly && !this.disabled) {\r\n                this.showTagboxClearButton = true;\r\n            }\r\n        }\r\n        if (this.showTagboxClearButton) {\r\n            this.toggleClearIcon(event, true);\r\n        }\r\n    }\r\n\r\n    private onTagboxMouseLeave(event) {\r\n        this.toggleClearIcon(event);\r\n    }\r\n\r\n    onRemoveSelectItem($event, txt) {\r\n        $event.stopPropagation();\r\n        const textArray = Array.from(this.displayTextList);\r\n        const removedIndex = this.displayTextList.indexOf(txt);\r\n        textArray.splice(removedIndex, 1);\r\n        this.displayText = textArray.join(this.multipleChoiceSeparator);\r\n        this.originalText = this.displayText;\r\n        this.setModelValue(this.displayText);\r\n\r\n\r\n        if (this.displayValue) {\r\n            const vals = this.displayValue.split(this.multipleChoiceSeparator);\r\n            vals.splice(removedIndex, 1);\r\n            this.displayValue = vals.join(this.multipleChoiceSeparator);\r\n        }\r\n\r\n        if (this.mapFields) {\r\n            this.updateOtherFieldDataWhenTagremoved(removedIndex);\r\n        }\r\n\r\n        this.tagRemoved.emit({ removedIndex, instance: this });\r\n    }\r\n\r\n    private updateOtherFieldDataWhenTagremoved(removedIndex) {\r\n        const helpFields = Object.keys(this.mapFields);\r\n        const textFieldIndex = helpFields.indexOf(this.textField);\r\n\r\n        if (\r\n            this.ngControl &&\r\n            this.ngControl.formDirective &&\r\n            this.ngControl.formDirective.form &&\r\n            this.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ngControl.formDirective.form.bindingData;\r\n            if (bindingData.setValue) {\r\n                const bindingPath =\r\n                    this.ngControl.formDirective.form.bindingPath;\r\n                let pathArr: string[] = [];\r\n                if (bindingPath) {\r\n                    pathArr = bindingPath.split(\"/\").filter((n) => n !== \"\");\r\n                }\r\n\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const fieldPaths = pathArr.concat(\r\n                                formField.split(\".\")\r\n                            );\r\n                            const val = bindingData.getValue(fieldPaths);\r\n                            const valArr = val.split(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            valArr.splice(removedIndex, 1);\r\n                            const newVal = valArr.join(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            bindingData.setValue(\r\n                                pathArr.concat(fieldPaths),\r\n                                newVal,\r\n                                true,\r\n                                true\r\n                            );\r\n                        });\r\n                });\r\n            }\r\n        } else {\r\n            if (this.bindingData) {\r\n                if (textFieldIndex > -1) {\r\n                    helpFields.splice(textFieldIndex, 1);\r\n                }\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const val = this.utils.getValue(\r\n                                formField,\r\n                                this.bindingData\r\n                            );\r\n                            const valArr = val.split(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            valArr.splice(removedIndex, 1);\r\n                            const newVal = valArr.join(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            this.utils.setValue(\r\n                                this.bindingData,\r\n                                formField,\r\n                                newVal\r\n                            );\r\n                        });\r\n                });\r\n            }\r\n        }\r\n    }\r\n    //#endregion\r\n\r\n    onAllChildNodesClick($event: any) {\r\n        this.isGetAllChidlNodes = !this.isGetAllChidlNodes;\r\n    }\r\n}\r\n","import {\r\n    Component, OnInit, ElementRef, AfterViewInit, OnChanges,\r\n    Output, EventEmitter, ViewChild, Injector, Renderer2, Input, SimpleChanges\r\n} from '@angular/core';\r\nimport { trigger, state, style, transition, animate } from '@angular/animations';\r\nimport { PersonalConfigService } from './lookup-presonalConfig.service';\r\n\r\n@Component({\r\n    selector: 'lookup-tabs',\r\n    templateUrl: './lookup-tabs.component.html',\r\n    styleUrls: ['./lookup-tabs.component.scss'],\r\n    animations: [\r\n        trigger('flyInOut', [\r\n            transition(':enter', [style({ opacity: 0 }), animate('.3s', style({ opacity: 1 }))]),\r\n            transition(':leave', [animate('.3s', style({ opacity: 0 }))])\r\n        ])\r\n    ]\r\n})\r\nexport class LookupTabsComponent implements OnInit, OnChanges, AfterViewInit {\r\n\r\n    @Input() enableFav = false;\r\n    @Input() enableSelected = false;\r\n    @Input() selectedTotal = 0;\r\n    @Input() activeTab = 'datalist';\r\n\r\n    @Output() tabChange = new EventEmitter<any>();\r\n\r\n    @ViewChild('inkBar') inkBarRef: ElementRef;\r\n    @ViewChild('dataListNav') dataListNavRef: ElementRef;\r\n    @ViewChild('favoriteNav') favoriteNavRef: ElementRef;\r\n    @ViewChild('selectedNav') selectedNavRef: ElementRef;\r\n\r\n    public personalConfigService: PersonalConfigService;\r\n\r\n    private render: Renderer2 = null;\r\n    private el: ElementRef = null;\r\n    constructor(public injector: Injector) {\r\n        this.personalConfigService = this.injector.get(PersonalConfigService, null);\r\n        this.render = this.injector.get(Renderer2);\r\n        this.el = this.injector.get(ElementRef);\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (changes.activeTab && !changes.activeTab.isFirstChange()) {\r\n            this.initInkBarPos(changes.activeTab.currentValue);\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        setTimeout(() => {\r\n            this.initInkBarPos(this.activeTab);\r\n        }, 300);\r\n    }\r\n\r\n    navClickHandle(e: Event, v: string) {\r\n        e.stopPropagation();\r\n        this.activeTab = v;\r\n        // this.personalConfigService.personalConfObser$.next({tabIndex: v});\r\n        this.tabChange.emit({ event: e, tabIndex: v });\r\n        this.initInkBarPos(v);\r\n    }\r\n\r\n    initInkBarPos(which: string) {\r\n        if (!this.enableFav && !this.enableSelected) {\r\n            return;\r\n        }\r\n\r\n        let width = this.dataListNavRef.nativeElement.offsetWidth;\r\n        let left = 0;\r\n        if (which !== 'datalist') {\r\n            left = this.dataListNavRef.nativeElement.offsetWidth;\r\n        }\r\n        if (which === 'favorite') {\r\n            width = this.favoriteNavRef.nativeElement.offsetWidth;\r\n        } else if (which === 'selected') {\r\n            if (this.favoriteNavRef) {\r\n                left += this.favoriteNavRef.nativeElement.offsetWidth;\r\n            }\r\n\r\n            if (this.selectedNavRef) {\r\n                width = this.selectedNavRef.nativeElement.offsetWidth;\r\n            } else {\r\n                this.activeTab = 'datalist';\r\n            }\r\n        }\r\n\r\n        this.inkBarRef.nativeElement.style = `width: ${width}px; transform: translate3d(${left}px, 0px, 0px);`;\r\n    }\r\n    ngOnInit(): void {\r\n        // this.showWhich = this.personalConfigService.getActiveTabIndex();\r\n    }\r\n\r\n}\r\n","import { Directive, OnInit, AfterViewInit, Renderer2, Injector, Input} from '@angular/core';\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { PersonalConfigService } from './lookup-presonalConfig.service';\r\nimport { delay } from 'rxjs/operators';\r\nimport { LocaleService } from '@farris/ui-locale';\r\n@Directive({\r\n    selector: '[lookup-tip]'\r\n})\r\nexport class LookupTipDirective implements OnInit, AfterViewInit {\r\n    @Input('lookup-tip') enableTip = false;\r\n    private tipPanel: Element;\r\n    private leaveEvent: any;\r\n    private enterEvent: any;\r\n    private clickEvent: any;\r\n    private isInTipPanel = false;\r\n    private selected: any[];\r\n    private personalConfigService: PersonalConfigService;\r\n    public localService: LocaleService;\r\n    private tipText = 'æ¨è¦æ¾çæ¯ä¸æ¯è¿äºï¼';\r\n    constructor(\r\n        private inputRef: InputGroupComponent,\r\n        private renderer: Renderer2,\r\n        public injector: Injector\r\n    ) {\r\n        this.personalConfigService = this.injector.get(PersonalConfigService, null);\r\n        this.localService = this.injector.get(LocaleService);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.tipText = this.localService.getValue('lookup.tipText');\r\n        this.enableTip = false; // å æ°æ®æéé®é¢ï¼æ­¤åè½æå±è½ tfs: 403924\r\n        if (this.enableTip) {\r\n            this.inputRef.iconMouseEnter.subscribe(e => {\r\n                this.creatPanel();\r\n            });\r\n            this.inputRef.iconMouseLeave.pipe(delay(200)).subscribe(e => {\r\n                if (!this.isInTipPanel) {\r\n                    this.removePanel();\r\n                }\r\n            });\r\n            this.inputRef.clickHandle.subscribe(e => {\r\n                this.removePanel();\r\n            });\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void { }\r\n\r\n    // è·åå¿«æ·è¾å¥æ°æ®\r\n    private getQuickSelectedByLocaleId() {\r\n        const localeid = this.localService.localeId;\r\n        const personalConf = this.personalConfigService.getPersonalData();\r\n        if (personalConf && personalConf.quickSelected) {\r\n            const items = personalConf.quickSelected[localeid];\r\n            if (items && items.length) {\r\n                return items;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    creatPanel() {\r\n        this.selected = this.getQuickSelectedByLocaleId();\r\n        if (this.tipPanel || !this.selected || (this.selected && this.selected.length === 0)) {\r\n            return;\r\n        }\r\n        const pos = this.setPosition();\r\n        const ul = this.renderer.createElement('ul');\r\n        const path = this.personalConfigService.textField.split('.');\r\n        this.selected.forEach((item, index) => {\r\n            const li = this.renderer.createElement('li');\r\n            li.innerHTML = this.find(item, this.personalConfigService.textField);\r\n            this.renderer.setProperty(li, 'id', index);\r\n            this.renderer.appendChild(ul, li);\r\n        });\r\n        const header = this.renderer.createElement('div');\r\n        this.renderer.addClass(header, 'lookup-tip-header');\r\n        header.innerHTML = this.tipText;\r\n        this.tipPanel = this.renderer.createElement('div');\r\n        this.renderer.appendChild(this.tipPanel, header);\r\n        this.renderer.appendChild(this.tipPanel, ul);\r\n        this.renderer.addClass(this.tipPanel, 'lookup-tip');\r\n        this.renderer.setStyle(this.tipPanel, 'top', pos.top);\r\n        this.renderer.setStyle(this.tipPanel, 'left', pos.left);\r\n        this.renderer.setStyle(this.tipPanel, 'width', pos.width);\r\n        this.renderer.appendChild(document.body, this.tipPanel);\r\n        this.leaveEvent = this.renderer.listen(this.tipPanel, 'mouseleave', () => {\r\n            this.removePanel();\r\n        });\r\n        this.enterEvent = this.renderer.listen(this.tipPanel, 'mouseenter', () => {\r\n            this.isInTipPanel = true;\r\n        });\r\n        this.clickEvent = this.renderer.listen(this.tipPanel, 'click', (e) => {\r\n            if (e.target.nodeName === 'LI') {\r\n                this.selectItem(e.target.id);\r\n            }\r\n        });\r\n    }\r\n\r\n    removePanel() {\r\n        if (document.body.contains(this.tipPanel)) {\r\n            this.renderer.removeChild(document.body, this.tipPanel);\r\n            this.tipPanel = null;\r\n            this.isInTipPanel = false;\r\n            this.leaveEvent();\r\n            this.enterEvent();\r\n            this.clickEvent();\r\n        }\r\n    }\r\n\r\n    setPosition() {\r\n        const { left, top, width, height } = this.inputRef.inputGroup.nativeElement.getBoundingClientRect();\r\n        return {\r\n            left: left + 'px',\r\n            top: top + height + 'px',\r\n            width: width + 'px'\r\n        };\r\n    }\r\n\r\n    selectItem(val) {\r\n        const item = this.selected.find((el, index) => Number(val) === index);\r\n        this.removePanel();\r\n        if (this.personalConfigService.singleSelect) {\r\n            this.personalConfigService.selectItemObser$.next(item);\r\n        } else {\r\n            this.personalConfigService.selectItemObser$.next([item]);\r\n        }\r\n    }\r\n\r\n    find(obj, keys) {\r\n        const keyArr = keys.split('.');\r\n        const key = keyArr[0];\r\n        const target = obj[key];\r\n        if (target instanceof Object) {\r\n            keyArr.shift();\r\n            return this.find(target, keyArr.join('.'));\r\n        } else {\r\n            return target;\r\n        }\r\n    }\r\n}\r\n","import { ChangeDetectorRef, Component, EventEmitter, HostBinding, HostListener, Injector, Input, OnInit, Output } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'lookup-quick-select-panel',\r\n    templateUrl: './quick-select-panel.component.html'\r\n})\r\n\r\nexport class LookupQuickSelectPanelComponent implements OnInit {\r\n\r\n    @Input() showMore = true;\r\n    @Input() data: Array<any> = [];\r\n    @Input() textField: string = '';\r\n    @Input() formatter: (rowObj: any) => string;\r\n\r\n    @Output() moreClcik = new EventEmitter();\r\n    @Output() itemClick = new EventEmitter();\r\n\r\n    activeIndex = -1;\r\n\r\n    constructor(private injector: Injector, private cdr: ChangeDetectorRef) { }\r\n\r\n    @HostListener('mousedown', ['$event'])\r\n    onClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n    }\r\n\r\n    ngOnInit() { }\r\n\r\n    loadData(items: any) {\r\n        this.data = items;\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n\r\n    onMoreClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        this.moreClcik.emit($event);\r\n    }\r\n\r\n    formatData(rowObj: any) {\r\n        return this.formatter(rowObj);\r\n    }\r\n\r\n    onItemClick($event, item) {\r\n        this.itemClick.emit({data: item, evnet: $event});\r\n    }\r\n\r\n    setActiveItem(index: number) {\r\n        this.activeIndex = index;\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n}","import { AfterViewInit, ComponentFactoryResolver, ComponentRef, Directive, ElementRef, HostListener, Injector, Input, NgZone, OnDestroy, OnInit, Renderer2 } from '@angular/core';\r\nimport { reqAnimFrame } from '@farris/ui-common';\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { Observable } from 'rxjs';\r\nimport { debounceTime, filter, map } from 'rxjs/operators';\r\n\r\nimport { LookupGridDisplayType, QuickSelectOption } from '../lookup-displaytype';\r\nimport { DisplayInfo, LOAD_DATA_TYPE, LookupGridResult, PickingResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupQuickSelectPanelComponent } from './quick-select-panel.component';\r\n\r\n@Directive({ selector: '[quick-select]'})\r\nexport class LookupQuickSelectDirective implements OnInit, AfterViewInit, OnDestroy {\r\n    @Input('quick-select') options: QuickSelectOption;\r\n\r\n    private panelElement: HTMLElement;\r\n    private cmpRef: ComponentRef<LookupQuickSelectPanelComponent>;\r\n    constructor(private injector: Injector, private ngzone: NgZone, private render: Renderer2,  private inputRef: InputGroupComponent, private lookupRef: LookupGridComponent,\r\n        private cfr: ComponentFactoryResolver) {\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        \r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if (this.options && this.options.enable) {\r\n            this.inputRef.inputClick.subscribe((e: MouseEvent) => {\r\n                e.stopPropagation();\r\n                if (!this.panelElement) {\r\n                    // æ§è¡å¸®å©å\r\n                    this.lookupRef.dictPicking({\r\n                        instance: this,\r\n                    }).subscribe((pr: PickingResult) => {\r\n                        if (this.lookupRef.displayType === LookupGridDisplayType.TreeList || !this.lookupRef.singleSelect) {\r\n                            return;\r\n                        }\r\n                        const { show, customData, message } = this.lookupRef.dialogMgr.checkDictPickingResult(pr);\r\n                        this.lookupRef.customData = customData;\r\n                        if (show) {\r\n                            this.createDataPanel();\r\n                        } else {\r\n                            if (message) {\r\n                                this.lookupRef.notifyService.warning(message);\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n\r\n            this.inputRef.valueChange.pipe(\r\n                debounceTime(200)\r\n            ).subscribe((val: string) => {\r\n                this.lookupRef.dictPicking({instance: this}).subscribe((pr: PickingResult) => {\r\n                    if (this.lookupRef.displayType === LookupGridDisplayType.TreeList || !this.lookupRef.singleSelect) {\r\n                        return;\r\n                    }\r\n                    const { show, customData, message } = this.lookupRef.dialogMgr.checkDictPickingResult(pr);\r\n                    this.lookupRef.customData = customData;\r\n                    if (!this.panelElement) {\r\n                        this.createDataPanel();\r\n                    } else {\r\n                        this.loadData();\r\n                    }\r\n                })\r\n            });\r\n\r\n            this.inputRef.keydownHandle.pipe(\r\n                filter((event: KeyboardEvent) => {\r\n                    return event.key === 'Escape' || event.key === 'Tab' || event.key === 'ArrowRight' || event.key === 'F2';\r\n                })\r\n            ).subscribe(() => {\r\n                this.hide();\r\n            });\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.lookupRef.overLayService.destory(this.lookupRef.el.nativeElement);\r\n    }\r\n\r\n    private removePanelElement() {\r\n        document.body.removeChild(this.panelElement);\r\n        this.panelElement = null;\r\n    }\r\n\r\n\r\n    hide(e?: any) {\r\n        reqAnimFrame(() => {\r\n            if (this.panelElement) {\r\n                if (e && ( e.type === 'mousewheel' || e.type === 'wheel')) {\r\n                    this.removePanelElement();\r\n                } else {\r\n                    this.panelElement.classList.remove('f-area-show');\r\n                    setTimeout(() => {\r\n                        this.removePanelElement();\r\n                    },120);\r\n                }\r\n                \r\n                this.lookupRef.overLayService.destory(this.lookupRef.el.nativeElement);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private createDataPanel() {\r\n        this.panelElement = document.createElement('div');\r\n        this.panelElement.classList.add('overlay-pane', 'f-lookup_quick-panel', 'f-area-hide');\r\n\r\n        document.body.appendChild(this.panelElement);\r\n        const { width, left, top, height } = this.getPanelSize();\r\n        this.panelElement.style.width = `${width}px`;\r\n        this.panelElement.style.height = `${height}px`;\r\n        this.panelElement.style.top = `${top}px`;\r\n        this.panelElement.style.left = `${left}px`;\r\n        this.panelElement.style.zIndex = '10001';\r\n        \r\n        // åå»ºæ°æ®å±ç¤ºç»ä»¶\r\n        const cmpFact = this.cfr.resolveComponentFactory(LookupQuickSelectPanelComponent);\r\n        this.cmpRef = cmpFact.create(this.injector);\r\n        \r\n        this.cmpRef.instance.showMore = this.options.showMore;\r\n        this.cmpRef.instance.textField = this.lookupRef.textField;\r\n        this.cmpRef.instance.formatter = this.options.formatter;\r\n\r\n        // cmpRef.location.nativeElement.classList.add('farris-main-area');\r\n        this.panelElement.appendChild(this.cmpRef.location.nativeElement);\r\n\r\n        this.cmpRef.changeDetectorRef.detectChanges();\r\n\r\n        // more clicked æå¼å¸®å©çªå£\r\n        this.cmpRef.instance.moreClcik.subscribe((e) => {\r\n            this.hide(e);\r\n            this.lookupRef.showDialog();\r\n        });\r\n\r\n        this.cmpRef.instance.itemClick.subscribe((e: any) => {\r\n            const { data } = e;\r\n            this.lookupRef.selectItem(data);\r\n            this.hide();\r\n        });\r\n\r\n\r\n        // æ³¨åé¼ æ æ»è½®ï¼ç¹å»äºä»¶ï¼ç¨äºéèPanel\r\n        this.lookupRef.overLayService.registerMouseEvent(this.lookupRef.el.nativeElement, (e: MouseEvent) => {\r\n            if (!this.panelElement || e.target['closest']('.f-lookup_quick-panel')) {\r\n                return;\r\n            }\r\n\r\n            if (this.cmpRef) {\r\n                this.cmpRef.destroy();\r\n                this.cmpRef = null;\r\n            }\r\n\r\n            this.hide(e);\r\n\r\n            if(this.lookupRef.inputGroup.textbox.nativeElement === e.target) {\r\n                return false;\r\n            }\r\n        });\r\n\r\n        this.panelElement.classList.add('f-area-show');\r\n\r\n        this.loadData();\r\n    }\r\n\r\n\r\n\r\n    private calculationPanelHeight() {\r\n        return this.options.showItemsCount * 30 + (this.options.showMore ? 50: 0) + this.options.footerHeight + 5;\r\n    }\r\n\r\n    private getInputSizeInfo() {\r\n        const el: any = this.lookupRef.viewType === 'text' ? this.inputRef.inputGroup : this.lookupRef.tagbox;\r\n        return el.nativeElement.getBoundingClientRect();\r\n    }\r\n\r\n    private getPanelSize() {\r\n        let { width, height, top, left } = this.getInputSizeInfo();\r\n        const bottom = window.innerHeight - height - top;\r\n        let panelHeight = this.calculationPanelHeight();\r\n\r\n        const h = top > bottom ? top : bottom;\r\n        if (bottom > panelHeight) {\r\n            top = top + height;\r\n            // é¢æ¿ç±ä¸åä¸å±å¼\r\n            this.panelElement.style.transformOrigin = '100% top';\r\n        } else {\r\n            if (top > bottom) {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                    top = 10;\r\n                } else {\r\n                    top = top - parseInt('' + panelHeight, 10) - 5;\r\n                }\r\n\r\n                // é¢æ¿ç±ä¸åä¸å±å¼\r\n                this.panelElement.style.transformOrigin = '100% bottom';\r\n\r\n            } else {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                }\r\n                top = top + height;\r\n            }\r\n        }\r\n\r\n        return { width, top, height: panelHeight, left };\r\n    }\r\n\r\n    private getData(): Observable<Array<any>> {\r\n        let p: any = {\r\n            pageInfo: {\r\n                pageSize: this.options.showItemsCount,\r\n                pageIndex: 1,\r\n            },\r\n        };\r\n        let t: LOAD_DATA_TYPE = \"all\";\r\n        if (this.lookupRef.isTextChange) {\r\n            this.lookupRef._searchState = { \r\n                field: this.lookupRef.textField, //\"*\",\r\n                value: this.lookupRef.displayText\r\n            }\r\n            p = {\r\n                search: this.lookupRef._searchState\r\n            };\r\n            \r\n            t = 'search';\r\n        }\r\n        return this.lookupRef.httpMgr.lookupRequest(p, t).pipe(\r\n            map((restData: LookupGridResult) => {\r\n                if (restData) {\r\n                    return restData.items || [];\r\n                }\r\n\r\n                if (this.lookupRef.displayText && this.lookupRef.isTextChange) {\r\n                    return this.lookupRef.items.filter(n => {\r\n                        return n[this.lookupRef.textField].indexOf(this.lookupRef.displayText) > -1;\r\n                    }).slice(0, this.options.showItemsCount)\r\n\r\n                }\r\n                return this.lookupRef.items.slice(0, this.options.showItemsCount);\r\n            })\r\n        );\r\n    }\r\n\r\n    private loadData() {\r\n        const loadingRef = this.lookupRef.loadingService.show({container: this.panelElement});\r\n        this.getData().subscribe((data: any) => {\r\n            this.cmpRef.instance.loadData(data);\r\n            loadingRef.close();\r\n        });\r\n    }\r\n\r\n\r\n    @HostListener('keydown', ['$event'])\r\n    registerKeyboardEvent($event: KeyboardEvent) {\r\n\r\n        if (!this.lookupRef.singleSelect)  {\r\n            return;\r\n        }\r\n\r\n        let rows= [];\r\n        if (this.cmpRef) {\r\n            rows = this.cmpRef.instance.data;\r\n        }\r\n\r\n        if (!rows || !rows.length) {\r\n            return;\r\n        }\r\n\r\n        if ($event.code === 'ArrowUp' || $event.code === 'ArrowDown') {\r\n            $event.preventDefault();\r\n            $event.stopPropagation();\r\n        }\r\n\r\n        const idx = this.cmpRef.instance.activeIndex;\r\n        let activeIndex = idx;\r\n\r\n        const selectItem = (index) => {\r\n            activeIndex = index;\r\n            this.cmpRef.instance.setActiveItem(index);\r\n        };\r\n\r\n        if ($event.code === 'ArrowUp') {  // up\r\n            if (idx > -1) {\r\n                let prevIdx = idx - 1;\r\n                if (prevIdx < 0) {\r\n                    prevIdx = rows.length - 1;\r\n                }\r\n                selectItem(prevIdx);\r\n            } else {\r\n                selectItem(rows.length - 1);\r\n            }\r\n        }\r\n        if ($event.code === 'ArrowDown') { // down\r\n            let nextIdx = idx + 1;\r\n            if (nextIdx >= rows.length) {\r\n                nextIdx = 0;\r\n            }\r\n\r\n            selectItem(nextIdx);\r\n        }\r\n\r\n        if($event.key === 'Enter') {\r\n            if (rows && rows.length) {\r\n                const data = rows[idx];\r\n                this.lookupRef.selectItem(data);\r\n                this.hide();\r\n            }\r\n        }\r\n    }\r\n}","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2018-12-04 10:43:42\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-26 13:33:30\r\n * @Company: Inspur\r\n * @Version: v0.0.1\r\n */\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\nimport { InputGroupModule } from '@farris/ui-input-group';\r\nimport { LayoutModule } from '@farris/ui-layout';\r\nimport { LocaleModule} from '@farris/ui-locale';\r\nimport { FarrisDialogModule } from '@farris/ui-dialog';\r\nimport { MessagerModule } from '@farris/ui-messager';\r\nimport { DataTableModule, DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeTableModule, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { LoadingModule } from '@farris/ui-loading';\r\n\r\nimport { LookupGridComponent } from './lookup-grid.component';\r\nimport { LookupComponent } from './lookup.component';\r\nimport { LookupLeftComponent } from './lookup-left.component';\r\nimport { LookupTabsComponent } from './lookup-tabs.component';\r\nimport { LookupTipDirective } from './lookup-tip.directive';\r\nimport { NotifyModule } from '@farris/ui-notify';\r\nimport { FarrisContextMenuModule } from '@farris/ui-context-menu';\r\nimport { LookupQuickSelectPanelComponent } from './quick-select/quick-select-panel.component';\r\nimport { LookupQuickSelectDirective } from './quick-select/lookup-quick-select.directive';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        FarrisCommonModule.forRoot(),\r\n        FarrisDialogModule.forRoot(),\r\n        MessagerModule.forRoot(),\r\n        NotifyModule.forRoot(),\r\n        LoadingModule.forRoot({delay: 1000}),\r\n        InputGroupModule,\r\n        LayoutModule,\r\n        DataTableModule,\r\n        TreeTableModule,\r\n        FarrisContextMenuModule,\r\n        LocaleModule.forRoot()\r\n    ],\r\n    exports: [\r\n        LookupGridComponent, LookupComponent\r\n    ],\r\n    declarations: [\r\n        LookupGridComponent,\r\n        LookupComponent,\r\n        LookupLeftComponent,\r\n        LookupTabsComponent,\r\n        LookupTipDirective,\r\n        LookupQuickSelectPanelComponent,\r\n        LookupQuickSelectDirective\r\n    ],\r\n    providers: [],\r\n    entryComponents: [DataTableComponent, TreeTableComponent, LookupLeftComponent, LookupTabsComponent, LookupQuickSelectPanelComponent]\r\n})\r\nexport class LookupModule {}\r\n"],"names":[],"mappings":"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"}
