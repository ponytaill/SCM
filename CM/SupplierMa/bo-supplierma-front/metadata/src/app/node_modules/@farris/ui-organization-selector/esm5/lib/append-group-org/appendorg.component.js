/**
 * @fileoverview added by tsickle
 * Generated from: lib/append-group-org/appendorg.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
var AppendGroupOrgComponent = /** @class */ (function () {
    function AppendGroupOrgComponent(apiService, cdr, injector, ngZone, msgService) {
        var _this = this;
        this.apiService = apiService;
        this.cdr = cdr;
        this.injector = injector;
        this.ngZone = ngZone;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.originalTreeData = [];
        this.treeListData = [];
        this.treeTableCols = [];
        this.initLoad = true;
        this.loadingService = null;
        this.localeService = null;
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.enableHierarchicalLoading) {
                return of(true);
            }
            /*
                    if (!this.multiSelect) {
                        if (e.rowNode.isSelected) {
                            this.currentOrgs = [];
                        } else {
                            this.currentOrgs = new Array(e.rowNode.node.data);
                        }
                        return of(false);
                    }
                    */
            /** @type {?} */
            var param = {
                absOrgType: _this.absOrgType,
                notGetStopOrg: _this.notGetStopOrg,
                getCurUser: false,
                parentID: e.rowNode.id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return _this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                // if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
                //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                //     return of(false)
                // }
                // if (!e.rowNode.isChecked) {
                //     data.data.forEach(item => {
                //         if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.currentOrgs) === -1) {
                //             this.currentOrgs.push(item);
                //         }
                //     })
                // } else {
                //     this.currentOrgs.forEach((org, index) => {
                //         data.data.forEach(item => {
                //             if (org[this.primaryField] === item[this.primaryField]) {
                //                 this.currentOrgs.splice(index, 1);
                //             }
                //         });
                //     });
                // }
                // this.cdr.detectChanges();
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.loadingService = this.injector.get(LoadingService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.treeTableCols = [
            { field: 'name', title: this.localeService.getValue("organizationSelector.organization.orgName"), template: this.orgName },
            { field: 'code', title: this.localeService.getValue("organizationSelector.organization.orgCode") }
        ];
        if (this.initLoad) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
    };
    /**
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @param {?} e
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.changeSelections = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        //this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        this.toggleChecked(e);
    };
    /**
     * @param {?} e
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.toggleChecked = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            checkeds.push(item.data);
        }));
        this.currentOrgs = _.cloneDeep(checkeds);
        if (this.currentOrgs.length == 0) {
            this.orgTree.clearCheckeds();
            this.orgTree.clearSelections();
            this.orgTree.detectChanges();
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.toggleSelected = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            selected.push(item.data);
        }));
        this.currentOrgs = _.cloneDeep(selected);
        if (this.currentOrgs.length == 0) {
            this.orgTree.clearCheckeds();
            this.orgTree.clearSelections();
            this.orgTree.detectChanges();
        }
    };
    // 分层加载组织树
    // 分层加载组织树
    /**
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.hlAssembleData = 
    // 分层加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        /** @type {?} */
        var layerList = [];
        /** @type {?} */
        var layer = this.layer;
        while (layer > 0) {
            layerList.push(layer);
            layer -= 1;
        }
        param.layerList = layerList;
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.data) {
                return;
            }
            _this.originalTreeData = res.data;
            if (res && res.curAbsUser && res.curAbsUser.orgAllPathInfo) {
                /** @type {?} */
                var curUserOrgPath = ((/** @type {?} */ (res.curAbsUser.orgAllPathInfo))).filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    return !res.data.find((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) { return data[_this.primaryField] == item[_this.primaryField]; }));
                }));
                res.data = res.data.concat(curUserOrgPath || []);
            }
            _this.treeListData = _this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            _this.orgTree.loadData(_this.treeListData);
            //this.tickCheckedNodes();
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 全加载组织树
    // 全加载组织树
    /**
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.assembleData = 
    // 全加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.data) {
                return;
            }
            _this.originalTreeData = res.data;
            _this.treeListData = _this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            _this.orgTree.loadData(_this.treeListData);
            // this.tickCheckedNodes();
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 确定组织是否在当前组织树内
    // 确定组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.inTreeList = 
    // 确定组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    function (treeListData, item) {
        for (var i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item[this.primaryField]) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    };
    // 在当前组织树内勾选所有已在群组内的组织
    // 在当前组织树内勾选所有已在群组内的组织
    /**
     * @private
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.tickCheckedNodes = 
    // 在当前组织树内勾选所有已在群组内的组织
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var ids = [];
        this.currentOrgs.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.inTreeList(_this.treeListData, item);
            if (!!item.inTreeList) {
                ids.push(item[_this.primaryField]);
            }
        }));
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (!ids.length) {
                    return;
                }
                if (_this.multiSelect) {
                    _this.orgTree.checkedNodes(ids, true, true);
                }
                else {
                    if (ids.length > 1) {
                        _this.msgService.show('warning', _this.localeService.getValue("organizationSelector.errorMessage.multiSelect"), true);
                        return;
                    }
                    _this.orgTree.clearSelections();
                    _this.orgTree.detectChanges();
                    _this.orgTree.selectNode(ids.join());
                }
            }));
        }));
    };
    /**
    * 组织数据转换
    * @param plainSource 接口原始数据
    * @param layer 层级
    * @returns 返回树形接口的数据
    */
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    AppendGroupOrgComponent.prototype.dataToTree = /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    function (plainSource, layer, expandedPath) {
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var treeSource = this.dealData(plainSource, expandedPath);
        // const parents = treeSource.filter(item => {
        //     return item.data.layer === layer;
        // });
        // this.treeData(parents, treeSource, 1);
        return treeSource;
    };
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.dealDataWhenExpandTreeNode = /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    function (data, expandedPath) {
        var _this = this;
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            var maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (var a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        var newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var newsDataObj = {
                    data: {
                        orgId: item[_this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: []
                };
                // let expanded = [];
                // if (this.enableHierarchicalLoading) {
                //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     newsDataObj.expanded = false;
                //     if (this.enableHierarchicalLoading && item.isDetail === '0') {
                //         newsDataObj.leaf = false;
                //     }
                // }
                if (Number(item.layer) >= _this.layer) {
                    newsDataObj.expanded = false;
                }
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                    newsDataObj.expanded = true;
                }
                if (_this.enableHierarchicalLoading && item.isDetail === '0') {
                    newsDataObj.leaf = false;
                }
                newDatas.push(newsDataObj);
            }));
        }
        return newDatas;
    };
    // 预处理组织数据
    // 预处理组织数据
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.dealData = 
    // 预处理组织数据
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    function (data, expandedPath) {
        var _this = this;
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            var maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (var a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        var nodes = new Map();
        /** @type {?} */
        var newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                // const newsDataObj: any = {
                //     data: {
                //         orgId: item[this.primaryField],
                //         name: item.name,
                //         path: item.path,
                //         code: item.code,
                //         layer: Number(item.layer),
                //         orgAllPath: item.orgAllPath,
                //         inFavorites: item.inFavorites
                //     },
                //     expanded: true,
                //     children: []
                // };
                // // let expanded = [];
                // // if (this.enableHierarchicalLoading) {
                // //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     newsDataObj.expanded = false;
                //     if (this.enableHierarchicalLoading && item.isDetail === '0') {
                //         newsDataObj.leaf = false;
                //     }
                // }
                // // todo 分层加载需要
                // //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //     //newsDataObj.leaf = false;
                //    // newsDataObj.expanded = false;
                // //}
                // newDatas.push(newsDataObj);
                /** @type {?} */
                var path = item['path'];
                /** @type {?} */
                var parentPath = Number(item['layer']) > 1 ? ((/** @type {?} */ (item['path']))).slice(0, 4 * (Number(item['layer']) - 1)) : 'top';
                if (!nodes[path]) {
                    nodes[path] = { children: [] };
                }
                nodes[path] = {
                    data: {
                        orgId: item[_this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: nodes[path]['children']
                };
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1 || Number(item.layer) < _this.layer) {
                    nodes[path]['expanded'] = true;
                }
                else {
                    nodes[path]['expanded'] = false;
                    if (_this.enableHierarchicalLoading && item.isDetail === '0') {
                        nodes[path]['leaf'] = false;
                    }
                }
                // todo 分层加载需要
                //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //newsDataObj.leaf = false;
                // newsDataObj.expanded = false;
                //}
                if (parentPath == 'top') {
                    newDatas.push(nodes[path]);
                }
                else {
                    if (!nodes[parentPath]) {
                        nodes[parentPath] = { children: [] };
                    }
                    ((/** @type {?} */ (nodes[parentPath]['children']))).push(nodes[path]);
                }
            }));
        }
        return newDatas;
    };
    /**
     * 数据转换
     * @param parents 父级节点信息
     * @param treeSource 原始数据信息
     * @param layer 层级
     */
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.treeData = /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    function (parents, treeSource, layer) {
        var _this = this;
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        function (parent) {
            /** @type {?} */
            var parentPath = parent['data']['path'];
            /** @type {?} */
            var parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    var itemPath = item['data']['path'];
                    /** @type {?} */
                    var itemLayer = item['data']['layer'];
                    /** @type {?} */
                    var targetPath = void 0;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        _this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    };
    // 监听组织树展开事件
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.listenTreeExpand = 
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        // 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    };
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.getOrganizationByParentNode = 
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    function (parentNode) {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            parentID: parentNode.id,
            notGetStopOrg: this.notGetStopOrg,
            getCurUser: false,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.data) {
                /** @type {?} */
                var newDatas_1 = [];
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.originalTreeData) === -1) {
                        item.selectable = true;
                        _this.originalTreeData.push(item);
                    }
                    newDatas_1.push(item);
                }));
                /** @type {?} */
                var nodes = _this.dealDataWhenExpandTreeNode(newDatas_1);
                _this.orgTree.appendChildren(nodes, parentNode);
                _this.orgTree.detectChanges();
                //this.tickCheckedNodes();
                if (_this.loadingService) {
                    _this.loadingService.close();
                }
            }
        }));
    };
    // 返回已经该节点是否展开过
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.nodeExpanded = 
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    function (item, arr, expanded) {
        for (var i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    };
    // 展开节点
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    AppendGroupOrgComponent.prototype.expandTreeNode = 
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    function (treeData, path, layer) {
        var _this = this;
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (path.includes(node.data.path)) {
                _this.orgTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                _this.expandTreeNode(node.children, path, layer);
            }
        }));
    };
    AppendGroupOrgComponent.decorators = [
        { type: Component, args: [{
                    selector: 'append-group-org',
                    template: "<!--\r\n<div style=\"background: #f9f9fc; display: flex; justify-content: space-between; border-bottom: 1px solid #EAEDF3\">\r\n    <span style=\"line-height: 22px;margin-left: 10px;font-weight: 600;color: #2a87ff;border-bottom: 2px solid #2a87ff;\r\n    padding: 8px 0;\">\u7EC4\u7EC7\u67B6\u6784</span>\r\n    <input-group style=\"width: 240px; margin: 6px 10px 6px 0;\"\r\n        [placeholder]=\"searchPlaceholder\" [(value)]=\"searchText\" [groupText]=\"groupIcon\" (enterHandle)=\"onSearch({pageIndex: 1})\"\r\n        (clickHahndle)=\"onSearch({pageIndex: 1})\" (keyup)=\"listenSearchText($event)\" (clear)=\"searchClear()\">\r\n    </input-group>\r\n</div>\r\n-->\r\n<farris-treetable #orgTree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"primaryField\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"false\" [showBorder]=\"false\" [showCheckbox]=\"true\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\" [virtualized]=\"true\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\" [beforeClickNode]=\"beforeClickNode\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgName let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>",
                    styles: [":host{height:100%;overflow:hidden;display:-webkit-box;display:flex;background:#fff;width:100%;border-radius:10px;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;border:1px solid #dee1ea}"]
                }] }
    ];
    /** @nocollapse */
    AppendGroupOrgComponent.ctorParameters = function () { return [
        { type: ApiService },
        { type: ChangeDetectorRef },
        { type: Injector },
        { type: NgZone },
        { type: MessagerService }
    ]; };
    AppendGroupOrgComponent.propDecorators = {
        baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
        orgTree: [{ type: ViewChild, args: ['orgTree',] }],
        orgName: [{ type: ViewChild, args: ['orgName',] }],
        primaryField: [{ type: Input }],
        enableHierarchicalLoading: [{ type: Input }],
        notGetStopOrg: [{ type: Input }],
        layer: [{ type: Input }],
        multiSelect: [{ type: Input }],
        absOrgType: [{ type: Input }],
        cascadeCheck: [{ type: Input }],
        cascadeDown: [{ type: Input }],
        cascadeUp: [{ type: Input }],
        keepSelect: [{ type: Input }],
        showCheckAll: [{ type: Input }],
        selectedLimit: [{ type: Input }],
        pathLength: [{ type: Input }],
        virtualizedLoad: [{ type: Input }]
    };
    return AppendGroupOrgComponent;
}());
export { AppendGroupOrgComponent };
if (false) {
    /** @type {?} */
    AppendGroupOrgComponent.prototype.baseCls;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.orgTree;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.orgName;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.primaryField;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.notGetStopOrg;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.layer;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.multiSelect;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.absOrgType;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeCheck;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeDown;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeUp;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.keepSelect;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.showCheckAll;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.selectedLimit;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.pathLength;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.virtualizedLoad;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.originalTreeData;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.treeListData;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.treeTableCols;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.currentOrgs;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.initLoad;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.localeService;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.beforeClickNode;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwZW5kb3JnLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktb3JnYW5pemF0aW9uLXNlbGVjdG9yLyIsInNvdXJjZXMiOlsibGliL2FwcGVuZC1ncm91cC1vcmcvYXBwZW5kb3JnLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUF5RSxpQkFBaUIsRUFBWSxRQUFRLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUM5SyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFFL0IsT0FBTyxFQUFZLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUVwQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFZLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFcEUsT0FBTyxFQUFFLFNBQVMsRUFBTyxNQUFNLGdCQUFnQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRWxFO0lBb0ZJLGlDQUNZLFVBQXNCLEVBQ3RCLEdBQXNCLEVBQ3RCLFFBQWtCLEVBQ2xCLE1BQWMsRUFDZCxVQUEyQjtRQUx2QyxpQkFhQztRQVpXLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFDdEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixXQUFNLEdBQU4s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b250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIElucHV0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgT25Jbml0LCBBZnRlclZpZXdJbml0LCBTaW1wbGVDaGFuZ2VzLCBPbkNoYW5nZXMsIENoYW5nZURldGVjdG9yUmVmLCBPcHRpb25hbCwgSW5qZWN0b3IsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIEhvc3RCaW5kaW5nLCBOZ1pvbmUsIE9uRGVzdHJveVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBBcGlTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vdXRpbHMvYXBpLnNlcnZpY2UnO1xyXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaC1lcyc7XHJcbmltcG9ydCB7IG5vRGF0YUltZyB9IGZyb20gJy4uLy4uL2Fzc2V0cy9yZXNvdXJjZSc7XHJcbmltcG9ydCB7IGZvcmtKb2luLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBDaGFuZ2VUeXBlLCBPcmdSZXF1ZXN0UGFyYW0gfSBmcm9tICcuLi8uLi91dGlscy9pbmRleC50eXBlJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbW1vbi50b29sJztcclxuaW1wb3J0IHsgVHJlZU5vZGUsIFRyZWVUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktdHJlZXRhYmxlJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9jYWxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdhcHBlbmQtZ3JvdXAtb3JnJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9hcHBlbmRvcmcuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vYXBwZW5kb3JnLmNvbXBvbmVudC5jc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIEFwcGVuZEdyb3VwT3JnQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZi11dGlscy1maWxsLWZsZXgtY29sdW1uJykgYmFzZUNscyA9IHRydWU7XHJcbiAgICBAVmlld0NoaWxkKCdvcmdUcmVlJykgb3JnVHJlZTogVHJlZVRhYmxlQ29tcG9uZW50O1xyXG4gICAgQFZpZXdDaGlsZCgnb3JnTmFtZScpIG9yZ05hbWU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBASW5wdXQoKSBwcmltYXJ5RmllbGQgPSAnb3JnSWQnO1xyXG4gICAgQElucHV0KCkgZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIG5vdEdldFN0b3BPcmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBsYXllcjogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgbXVsdGlTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBhYnNPcmdUeXBlOiBhbnk7XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlQ2hlY2s6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlRG93bjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVVcDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGtlZXBTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBzaG93Q2hlY2tBbGw6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZExpbWl0OiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBwYXRoTGVuZ3RoID0gNDtcclxuICAgIEBJbnB1dCgpIHZpcnR1YWxpemVkTG9hZDogYm9vbGVhbjtcclxuICAgIFxyXG4gICAgb3JpZ2luYWxUcmVlRGF0YSA9IFtdO1xyXG4gICAgdHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdID0gW107XHJcbiAgICB0cmVlVGFibGVDb2xzID0gW107XHJcbiAgICBjdXJyZW50T3JnczogYW55W107XHJcbiAgICBpbml0TG9hZCA9IHRydWU7XHJcbiAgICBwcml2YXRlIGxvYWRpbmdTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSA9IG51bGw7XHJcbiAgICBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2UgPSBudWxsO1xyXG5cclxuICAgIGJlZm9yZUNsaWNrTm9kZSA9IChlKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKlxyXG4gICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoZS5yb3dOb2RlLmlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE9yZ3MgPSBbXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE9yZ3MgPSBuZXcgQXJyYXkoZS5yb3dOb2RlLm5vZGUuZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG9mKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKi9cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgZ2V0Q3VyVXNlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIHBhcmVudElEOiBlLnJvd05vZGUuaWQsXHJcbiAgICAgICAgICAgIHdpdGhBbGxTdWI6IHRydWUsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgICAgICAgICAoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKGRhdGFbJ2RhdGEnXS5sZW5ndGggPiB0aGlzLnNlbGVjdGVkTGltaXQgJiYgIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5tc2dTZXJ2aWNlLnNob3coJ3dhcm5pbmcnLCBg5Lqy77yM5LiA5qyh5oCn6YCJ5oup5LqG6LaF6L+HJHt0aGlzLnNlbGVjdGVkTGltaXR95p2h5pWw5o2ufmAsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm4gb2YoZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICghZS5yb3dOb2RlLmlzQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBkYXRhLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuY3VycmVudE9yZ3MpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuY3VycmVudE9yZ3MucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmN1cnJlbnRPcmdzLmZvckVhY2goKG9yZywgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGRhdGEuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChvcmdbdGhpcy5wcmltYXJ5RmllbGRdID09PSBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRPcmdzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcGlTZXJ2aWNlOiBBcGlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgICAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxyXG4gICAgICAgIHByaXZhdGUgbXNnU2VydmljZTogTWVzc2FnZXJTZXJ2aWNlXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmNkciA9IHRoaXMuaW5qZWN0b3IuZ2V0KENoYW5nZURldGVjdG9yUmVmKTtcclxuICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9hZGluZ1NlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9jYWxlU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UpO1xyXG4gICAgICAgIGlmKCF0aGlzLmxvY2FsZVNlcnZpY2UubGFuZ0RhdGFbJ29yZ2FuaXphdGlvblNlbGVjdG9yJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlLnNldExvY2FsZURhdGEoT1JHQU5JWkFUSU9OX1NFTEVDVE9SX0xPQ0FMRSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudHJlZVRhYmxlQ29scyA9IFtcclxuICAgICAgICAgICAgeyBmaWVsZDogJ25hbWUnLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iub3JnYW5pemF0aW9uLm9yZ05hbWVcIiksIHRlbXBsYXRlOiB0aGlzLm9yZ05hbWUgfSxcclxuICAgICAgICAgICAgeyBmaWVsZDogJ2NvZGUnLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iub3JnYW5pemF0aW9uLm9yZ0NvZGVcIikgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgaWYgKHRoaXMuaW5pdExvYWQpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhsQXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VtYmxlRGF0YSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdExvYWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVNlbGVjdGlvbnMoZTogYW55KSB7XHJcbiAgICAgICAgLy90aGlzLm11bHRpU2VsZWN0ID8gdGhpcy50b2dnbGVDaGVja2VkKGUpIDogdGhpcy50b2dnbGVTZWxlY3RlZChlKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQ2hlY2tlZChlOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBjaGVja2VkcyA9IFtdO1xyXG4gICAgICAgIGUgJiYgZS5pbnN0YW5jZSAmJiBlLmluc3RhbmNlLmNoZWNrZWRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGNoZWNrZWRzLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRPcmdzID0gXy5jbG9uZURlZXAoY2hlY2tlZHMpO1xyXG4gICAgICAgIGlmKHRoaXMuY3VycmVudE9yZ3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICB0aGlzLm9yZ1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVTZWxlY3RlZChlOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IFtdO1xyXG4gICAgICAgIGUgJiYgZS5pbnN0YW5jZSAmJiBlLmluc3RhbmNlLnNlbGVjdGlvbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgc2VsZWN0ZWQucHVzaChpdGVtLmRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE9yZ3MgPSBfLmNsb25lRGVlcChzZWxlY3RlZCk7XHJcbiAgICAgICAgaWYodGhpcy5jdXJyZW50T3Jncy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLm9yZ1RyZWUuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgICAgICB0aGlzLm9yZ1RyZWUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgICAgIHRoaXMub3JnVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIhuWxguWKoOi9vee7hOe7h+agkVxyXG4gICAgaGxBc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGxheWVyTGlzdCA9IFtdO1xyXG4gICAgICAgIGxldCBsYXllciA9IHRoaXMubGF5ZXI7XHJcbiAgICAgICAgd2hpbGUgKGxheWVyID4gMCkge1xyXG4gICAgICAgICAgICBsYXllckxpc3QucHVzaChsYXllcik7XHJcbiAgICAgICAgICAgIGxheWVyIC09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmFtLmxheWVyTGlzdCA9IGxheWVyTGlzdDtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzIHx8ICFyZXMuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5jdXJBYnNVc2VyICYmIHJlcy5jdXJBYnNVc2VyLm9yZ0FsbFBhdGhJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJVc2VyT3JnUGF0aCA9IChyZXMuY3VyQWJzVXNlci5vcmdBbGxQYXRoSW5mbyBhcyBBcnJheTxhbnk+KS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFyZXMuZGF0YS5maW5kKGRhdGEgPT4gZGF0YVt0aGlzLnByaW1hcnlGaWVsZF0gPT0gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YSA9IHJlcy5kYXRhLmNvbmNhdChjdXJVc2VyT3JnUGF0aCB8fCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLmRhdGEsIDEsIHJlcy5jdXJBYnNVc2VyLmRlZmF1bHRPcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgLy90aGlzLnRpY2tDaGVja2VkTm9kZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlhajliqDovb3nu4Tnu4fmoJFcclxuICAgIGFzc2VtYmxlRGF0YSgpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLmRhdGEsIDEsIHJlcy5jdXJBYnNVc2VyLmRlZmF1bHRPcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgLy8gdGhpcy50aWNrQ2hlY2tlZE5vZGVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56Gu5a6a57uE57uH5piv5ZCm5Zyo5b2T5YmN57uE57uH5qCR5YaFXHJcbiAgICBwcml2YXRlIGluVHJlZUxpc3QodHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdLCBpdGVtOiBhbnkpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWVMaXN0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmlkID09PSBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5pblRyZWVMaXN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0cmVlTGlzdERhdGFbaV0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLCBpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlnKjlvZPliY3nu4Tnu4fmoJHlhoXli77pgInmiYDmnInlt7LlnKjnvqTnu4TlhoXnmoTnu4Tnu4dcclxuICAgIHByaXZhdGUgdGlja0NoZWNrZWROb2RlcygpIHtcclxuICAgICAgICBjb25zdCBpZHMgPSBbXTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRPcmdzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5UcmVlTGlzdCh0aGlzLnRyZWVMaXN0RGF0YSwgaXRlbSk7XHJcbiAgICAgICAgICAgIGlmICghIWl0ZW0uaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgaWRzLnB1c2goaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghaWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmNoZWNrZWROb2RlcyhpZHMsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLnNob3coJ3dhcm5pbmcnLCB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5lcnJvck1lc3NhZ2UubXVsdGlTZWxlY3RcIiksIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JnVHJlZS5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yZ1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JnVHJlZS5zZWxlY3ROb2RlKGlkcy5qb2luKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIOe7hOe7h+aVsOaNrui9rOaNolxyXG4gICAgKiBAcGFyYW0gcGxhaW5Tb3VyY2Ug5o6l5Y+j5Y6f5aeL5pWw5o2uXHJcbiAgICAqIEBwYXJhbSBsYXllciDlsYLnuqdcclxuICAgICogQHJldHVybnMg6L+U5Zue5qCR5b2i5o6l5Y+j55qE5pWw5o2uXHJcbiAgICAqL1xyXG4gICAgcHJpdmF0ZSBkYXRhVG9UcmVlKHBsYWluU291cmNlOiBhbnksIGxheWVyOiBudW1iZXIsIGV4cGFuZGVkUGF0aDogc3RyaW5nID0gJycpIHtcclxuICAgICAgICBjb25zdCB0cmVlU291cmNlID0gdGhpcy5kZWFsRGF0YShwbGFpblNvdXJjZSwgZXhwYW5kZWRQYXRoKTtcclxuICAgICAgICAvLyBjb25zdCBwYXJlbnRzID0gdHJlZVNvdXJjZS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBpdGVtLmRhdGEubGF5ZXIgPT09IGxheWVyO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIC8vIHRoaXMudHJlZURhdGEocGFyZW50cywgdHJlZVNvdXJjZSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIHRyZWVTb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZWFsRGF0YVdoZW5FeHBhbmRUcmVlTm9kZShkYXRhOiBhbnlbXSwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgaWYoZXhwYW5kZWRQYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSBleHBhbmRlZFBhdGgubGVuZ3RoIC8gdGhpcy5wYXRoTGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGggLT0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBhID0gMDsgYSA8IG1heExlbmd0aDsgYSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKHsgcGF0aDogZXhwYW5kZWRQYXRoLnN1YnN0cmluZygwLCA0ICogKGEgKyAxKSkgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3c0RhdGFPYmo6IGFueSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ0lkOiBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBpdGVtLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IE51bWJlcihpdGVtLmxheWVyKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnQWxsUGF0aDogaXRlbS5vcmdBbGxQYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZhdm9yaXRlczogaXRlbS5pbkZhdm9yaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXhwYW5kZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy8gbGV0IGV4cGFuZGVkID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5ub2RlRXhwYW5kZWQobmV3c0RhdGFPYmosIHRoaXMudHJlZUxpc3REYXRhLCBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIGlmKE51bWJlcihpdGVtLmxheWVyKSA+PSB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtLnBhdGgsICdwYXRoJywgcGF0aExpc3QpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdzRGF0YU9iai5sZWFmID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuZXdEYXRhcy5wdXNoKG5ld3NEYXRhT2JqKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdEYXRhcztcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8g6aKE5aSE55CG57uE57uH5pWw5o2uXHJcbiAgICBwcml2YXRlIGRlYWxEYXRhKGRhdGE6IGFueVtdLCBleHBhbmRlZFBhdGg6IHN0cmluZyA9ICcnKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aExpc3QgPSBbXTtcclxuICAgICAgICBpZihleHBhbmRlZFBhdGggIT0gJycpIHtcclxuICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IGV4cGFuZGVkUGF0aC5sZW5ndGggLyB0aGlzLnBhdGhMZW5ndGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIG1heExlbmd0aCAtPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgbWF4TGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgIHBhdGhMaXN0LnB1c2goeyBwYXRoOiBleHBhbmRlZFBhdGguc3Vic3RyaW5nKDAsIDQgKiAoYSArIDEpKSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBub2RlcyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc3QgbmV3c0RhdGFPYmo6IGFueSA9IHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG9yZ0lkOiBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBwYXRoOiBpdGVtLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgbGF5ZXI6IE51bWJlcihpdGVtLmxheWVyKSxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgb3JnQWxsUGF0aDogaXRlbS5vcmdBbGxQYXRoLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBpbkZhdm9yaXRlczogaXRlbS5pbkZhdm9yaXRlc1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZXhwYW5kZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgICAgICAvLyB9O1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gbGV0IGV4cGFuZGVkID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyAvLyBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAvLyAgICAgdGhpcy5ub2RlRXhwYW5kZWQobmV3c0RhdGFPYmosIHRoaXMudHJlZUxpc3REYXRhLCBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAvLyAvLyB9XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIC8vIC8vIHRvZG8g5YiG5bGC5Yqg6L296ZyA6KaBXHJcbiAgICAgICAgICAgICAgICAvLyAvL2lmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnICYmIE51bWJlcihpdGVtLmxheWVyKSA+PSB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgLy9uZXdzRGF0YU9iai5sZWFmID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAvLyBuZXdzRGF0YU9iai5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gLy99XHJcbiAgICAgICAgICAgICAgICAvLyBuZXdEYXRhcy5wdXNoKG5ld3NEYXRhT2JqKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSBpdGVtWydwYXRoJ107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gTnVtYmVyKGl0ZW1bJ2xheWVyJ10pID4gMSA/IChpdGVtWydwYXRoJ10gYXMgc3RyaW5nKS5zbGljZSgwLCA0ICogKE51bWJlcihpdGVtWydsYXllciddKSAtIDEpKSA6ICd0b3AnO1xyXG4gICAgICAgICAgICAgICAgaWYoIW5vZGVzW3BhdGhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF0gPSB7IGNoaWxkcmVuOiBbXSB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBub2Rlc1twYXRoXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhIDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdJZDogaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogaXRlbS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyOiBOdW1iZXIoaXRlbS5sYXllciksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ0FsbFBhdGg6IGl0ZW0ub3JnQWxsUGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5GYXZvcml0ZXM6IGl0ZW0uaW5GYXZvcml0ZXNcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBub2Rlc1twYXRoXVsnY2hpbGRyZW4nXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW0ucGF0aCwgJ3BhdGgnLCBwYXRoTGlzdCkgIT09IC0xIHx8IE51bWJlcihpdGVtLmxheWVyKSA8IHRoaXMubGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnZXhwYW5kZWQnXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydleHBhbmRlZCddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF1bJ2xlYWYnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRvZG8g5YiG5bGC5Yqg6L296ZyA6KaBXHJcbiAgICAgICAgICAgICAgICAvL2lmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnICYmIE51bWJlcihpdGVtLmxheWVyKSA+PSB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9uZXdzRGF0YU9iai5sZWFmID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAvLyBuZXdzRGF0YU9iai5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICBpZihwYXJlbnRQYXRoID09ICd0b3AnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YXMucHVzaChub2Rlc1twYXRoXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFub2Rlc1twYXJlbnRQYXRoXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXJlbnRQYXRoXSA9IHsgY2hpbGRyZW46IFtdIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKG5vZGVzW3BhcmVudFBhdGhdWydjaGlsZHJlbiddIGFzIEFycmF5PGFueT4pLnB1c2gobm9kZXNbcGF0aF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ld0RhdGFzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pWw5o2u6L2s5o2iXHJcbiAgICAgKiBAcGFyYW0gcGFyZW50cyDniLbnuqfoioLngrnkv6Hmga9cclxuICAgICAqIEBwYXJhbSB0cmVlU291cmNlIOWOn+Wni+aVsOaNruS/oeaBr1xyXG4gICAgICogQHBhcmFtIGxheWVyIOWxgue6p1xyXG4gICAgICovXHJcbiAgICB0cmVlRGF0YShwYXJlbnRzOiBhbnksIHRyZWVTb3VyY2U6IGFueSwgbGF5ZXI6IG51bWJlcikge1xyXG4gICAgICAgIHBhcmVudHMuZm9yRWFjaChwYXJlbnQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gcGFyZW50WydkYXRhJ11bJ3BhdGgnXTtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50TGF5ZXIgPSBwYXJlbnRbJ2RhdGEnXVsnbGF5ZXInXTtcclxuICAgICAgICAgICAgdHJlZVNvdXJjZS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbVsnZGF0YSddICYmIGl0ZW1bJ2RhdGEnXVsncGF0aCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbVBhdGggPSBpdGVtWydkYXRhJ11bJ3BhdGgnXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtTGF5ZXIgPSBpdGVtWydkYXRhJ11bJ2xheWVyJ107XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldFBhdGg6IHN0cmluZztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbVBhdGggJiYgaXRlbVBhdGgubGVuZ3RoID4gcGFyZW50UGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UGF0aCA9IGl0ZW1QYXRoLnN1YnN0cigwLCBOdW1iZXIobGF5ZXIpICogNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSB0YXJnZXRQYXRoICYmIHBhcmVudExheWVyID09PSBpdGVtTGF5ZXIgLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFsnY2hpbGRyZW4nXS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gdGFyZ2V0UGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVEYXRhKFtpdGVtXSwgdHJlZVNvdXJjZSwgTnVtYmVyKGxheWVyKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDnm5HlkKznu4Tnu4fmoJHlsZXlvIDkuovku7ZcclxuICAgIGxpc3RlblRyZWVFeHBhbmQob2JqOiBhbnkpIHtcclxuICAgICAgICAvLyDliIblsYLliqDovb1cclxuICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIG9iai5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRPcmdhbml6YXRpb25CeVBhcmVudE5vZGUob2JqKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YiG5bGC5Yqg6L295pe277yM6I635Y+W5LiL57qn57uE57uH5pWw5o2u5bm25Li65b2T5YmN57uE57uH5qCR5re75Yqg5a2Q6IqC54K5XHJcbiAgICBnZXRPcmdhbml6YXRpb25CeVBhcmVudE5vZGUocGFyZW50Tm9kZTogYW55KSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBwYXJlbnRJRDogcGFyZW50Tm9kZS5pZCxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdEYXRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLm9yaWdpbmFsVHJlZURhdGEpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YXMucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmRlYWxEYXRhV2hlbkV4cGFuZFRyZWVOb2RlKG5ld0RhdGFzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3JnVHJlZS5hcHBlbmRDaGlsZHJlbihub2RlcywgcGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yZ1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnRpY2tDaGVja2VkTm9kZXMoKTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDov5Tlm57lt7Lnu4/or6XoioLngrnmmK/lkKblsZXlvIDov4dcclxuICAgIHByaXZhdGUgbm9kZUV4cGFuZGVkKGl0ZW06IGFueSwgYXJyOiBUcmVlTm9kZVtdLCBleHBhbmRlZDogYm9vbGVhbltdKTogdm9pZCB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZGF0YS5pZCA9PT0gYXJyW2ldLmRhdGEuaWQpIHtcclxuICAgICAgICAgICAgICAgIGV4cGFuZGVkWzBdID0gYXJyW2ldLmV4cGFuZGVkO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFycltpXS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZUV4cGFuZGVkKGl0ZW0sIGFycltpXS5jaGlsZHJlbiwgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWxleW8gOiKgueCuVxyXG4gICAgcHJpdmF0ZSBleHBhbmRUcmVlTm9kZSh0cmVlRGF0YTogYW55LCBwYXRoOiBhbnlbXSwgbGF5ZXI6IG51bWJlcikge1xyXG4gICAgICAgIHRyZWVEYXRhLmZvckVhY2gobm9kZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwYXRoLmluY2x1ZGVzKG5vZGUuZGF0YS5wYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmV4cGFuZE5vZGUobm9kZS5kYXRhLmlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhLmxheWVyIDwgbGF5ZXIgJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kVHJlZU5vZGUobm9kZS5jaGlsZHJlbiwgcGF0aCwgbGF5ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==