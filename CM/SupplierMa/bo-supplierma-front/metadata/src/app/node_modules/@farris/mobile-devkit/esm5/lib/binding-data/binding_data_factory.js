import { PropertyUtil as BindingPropertyUtil } from './property_util';
import { EntityUtil as EntityLoadUtil } from './entity_util';
import { BindingListFactory } from './binding_list_factory';
import { BindingData } from './binding_data';
var BindingDataFactory = /** @class */ (function () {
    function BindingDataFactory() {
    }
    /**
     * 根据Repository创建一个BindingData
     */
    BindingDataFactory.createFromRepository = function (repository, bindingPath) {
        var bindingData = new BindingData();
        var bindingProperties = BindingPropertyUtil.getProperties(repository.entityType);
        var bindingList = BindingListFactory.create(bindingProperties);
        bindingData.initByBindingList(bindingList, null);
        EntityLoadUtil.loadRepository(repository, bindingList);
        // 从repository初始化bindingData
        bindingData.pagingInfo = repository.entityCollection.paginationInfo;
        return bindingData;
    };
    /**
     * 根据EntityManager创建BindingData，并建立双向关联（请勿使用）
     * @internal
     * @summary
     * 1、该方法暂时仅供内部单元测试使用；
     * 2、该方法暂时只创建BindingData，不建立双向关联
     */
    BindingDataFactory.createFromEntityManager = function (entityManager, bindingPath) {
        var bindingData = new BindingData();
        var bindingProperties = BindingPropertyUtil.getProperties(entityManager.entityType);
        var bindingList = BindingListFactory.create(bindingProperties);
        bindingData.initByBindingList(bindingList, null);
        // 初始化数据
        var entities = entityManager.getEntitiesByPath([]);
        EntityLoadUtil.loadEntities(entities, bindingList);
        return bindingData;
    };
    /**
     * 根据已经存在的BindingData创建一个新的BindingData
     */
    BindingDataFactory.createFromExistingBindingData = function (existingBindingData, bindingPath) {
        var bindingData = new BindingData();
        bindingData.initByBindingList(existingBindingData.list, null);
        return bindingData;
    };
    return BindingDataFactory;
}());
export { BindingDataFactory };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZ19kYXRhX2ZhY3RvcnkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1kZXZraXQvIiwic291cmNlcyI6WyJsaWIvYmluZGluZy1kYXRhL2JpbmRpbmdfZGF0YV9mYWN0b3J5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxZQUFZLElBQUksbUJBQW1CLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN0RSxPQUFPLEVBQUUsVUFBVSxJQUFJLGNBQWMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM1RCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHN0M7SUFBQTtJQTZDQSxDQUFDO0lBM0NDOztPQUVHO0lBQ1csdUNBQW9CLEdBQWxDLFVBQW1DLFVBQThCLEVBQUUsV0FBbUI7UUFDcEYsSUFBTSxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQUN0QyxJQUFNLGlCQUFpQixHQUFHLG1CQUFtQixDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbkYsSUFBTSxXQUFXLEdBQUcsa0JBQWtCLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDakUsV0FBVyxDQUFDLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNqRCxjQUFjLENBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUV2RCw0QkFBNEI7UUFDNUIsV0FBVyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDO1FBQ3BFLE9BQU8sV0FBVyxDQUFDO0lBQ3JCLENBQUM7SUFFRDs7Ozs7O09BTUc7SUFDVywwQ0FBdUIsR0FBckMsVUFBc0MsYUFBb0MsRUFBRSxXQUFtQjtRQUM3RixJQUFNLFdBQVcsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO1FBQ3RDLElBQU0saUJBQWlCLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RixJQUFNLFdBQVcsR0FBRyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUNqRSxXQUFXLENBQUMsaUJBQWlCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRWpELFFBQVE7UUFDUixJQUFNLFFBQVEsR0FBYSxhQUFhLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDL0QsY0FBYyxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFFbkQsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQztJQUVEOztPQUVHO0lBQ1csZ0RBQTZCLEdBQTNDLFVBQTRDLG1CQUFnQyxFQUFFLFdBQW1CO1FBQy9GLElBQU0sV0FBVyxHQUFHLElBQUksV0FBVyxFQUFFLENBQUM7UUFDdEMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLG1CQUFtQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM5RCxPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDO0lBQ0gseUJBQUM7QUFBRCxDQUFDLEFBN0NELElBNkNDO0FBRUQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbnRpdHkgfSBmcm9tICcuLi9lbnRpdHkvaW5kZXgnO1xyXG5pbXBvcnQgeyBSZXBvc2l0b3J5LCBFbnRpdHlNYW5hZ2VyIH0gZnJvbSAnLi4vcmVwb3NpdG9yeS9pbmRleCc7XHJcbmltcG9ydCB7IFByb3BlcnR5VXRpbCBhcyBCaW5kaW5nUHJvcGVydHlVdGlsIH0gZnJvbSAnLi9wcm9wZXJ0eV91dGlsJztcclxuaW1wb3J0IHsgRW50aXR5VXRpbCBhcyBFbnRpdHlMb2FkVXRpbCB9IGZyb20gJy4vZW50aXR5X3V0aWwnO1xyXG5pbXBvcnQgeyBCaW5kaW5nTGlzdEZhY3RvcnkgfSBmcm9tICcuL2JpbmRpbmdfbGlzdF9mYWN0b3J5JztcclxuaW1wb3J0IHsgQmluZGluZ0RhdGEgfSBmcm9tICcuL2JpbmRpbmdfZGF0YSc7XHJcblxyXG5cclxuY2xhc3MgQmluZGluZ0RhdGFGYWN0b3J5IHtcclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2uUmVwb3NpdG9yeeWIm+W7uuS4gOS4qkJpbmRpbmdEYXRhXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBjcmVhdGVGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5OiBSZXBvc2l0b3J5PEVudGl0eT4sIGJpbmRpbmdQYXRoOiBzdHJpbmcpOiBCaW5kaW5nRGF0YSB7XHJcbiAgICBjb25zdCBiaW5kaW5nRGF0YSA9IG5ldyBCaW5kaW5nRGF0YSgpO1xyXG4gICAgY29uc3QgYmluZGluZ1Byb3BlcnRpZXMgPSBCaW5kaW5nUHJvcGVydHlVdGlsLmdldFByb3BlcnRpZXMocmVwb3NpdG9yeS5lbnRpdHlUeXBlKTtcclxuICAgIGNvbnN0IGJpbmRpbmdMaXN0ID0gQmluZGluZ0xpc3RGYWN0b3J5LmNyZWF0ZShiaW5kaW5nUHJvcGVydGllcyk7XHJcbiAgICBiaW5kaW5nRGF0YS5pbml0QnlCaW5kaW5nTGlzdChiaW5kaW5nTGlzdCwgbnVsbCk7XHJcbiAgICBFbnRpdHlMb2FkVXRpbC5sb2FkUmVwb3NpdG9yeShyZXBvc2l0b3J5LCBiaW5kaW5nTGlzdCk7XHJcblxyXG4gICAgLy8g5LuOcmVwb3NpdG9yeeWIneWni+WMlmJpbmRpbmdEYXRhXHJcbiAgICBiaW5kaW5nRGF0YS5wYWdpbmdJbmZvID0gcmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLnBhZ2luYXRpb25JbmZvO1xyXG4gICAgcmV0dXJuIGJpbmRpbmdEYXRhO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2uRW50aXR5TWFuYWdlcuWIm+W7ukJpbmRpbmdEYXRh77yM5bm25bu656uL5Y+M5ZCR5YWz6IGU77yI6K+35Yu/5L2/55So77yJXHJcbiAgICogQGludGVybmFsXHJcbiAgICogQHN1bW1hcnlcclxuICAgKiAx44CB6K+l5pa55rOV5pqC5pe25LuF5L6b5YaF6YOo5Y2V5YWD5rWL6K+V5L2/55So77ybXHJcbiAgICogMuOAgeivpeaWueazleaaguaXtuWPquWIm+W7ukJpbmRpbmdEYXRh77yM5LiN5bu656uL5Y+M5ZCR5YWz6IGUXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBjcmVhdGVGcm9tRW50aXR5TWFuYWdlcihlbnRpdHlNYW5hZ2VyOiBFbnRpdHlNYW5hZ2VyPEVudGl0eT4sIGJpbmRpbmdQYXRoOiBzdHJpbmcpOiBCaW5kaW5nRGF0YSB7XHJcbiAgICBjb25zdCBiaW5kaW5nRGF0YSA9IG5ldyBCaW5kaW5nRGF0YSgpO1xyXG4gICAgY29uc3QgYmluZGluZ1Byb3BlcnRpZXMgPSBCaW5kaW5nUHJvcGVydHlVdGlsLmdldFByb3BlcnRpZXMoZW50aXR5TWFuYWdlci5lbnRpdHlUeXBlKTtcclxuICAgIGNvbnN0IGJpbmRpbmdMaXN0ID0gQmluZGluZ0xpc3RGYWN0b3J5LmNyZWF0ZShiaW5kaW5nUHJvcGVydGllcyk7XHJcbiAgICBiaW5kaW5nRGF0YS5pbml0QnlCaW5kaW5nTGlzdChiaW5kaW5nTGlzdCwgbnVsbCk7XHJcblxyXG4gICAgLy8g5Yid5aeL5YyW5pWw5o2uXHJcbiAgICBjb25zdCBlbnRpdGllczogRW50aXR5W10gPSBlbnRpdHlNYW5hZ2VyLmdldEVudGl0aWVzQnlQYXRoKFtdKTtcclxuICAgIEVudGl0eUxvYWRVdGlsLmxvYWRFbnRpdGllcyhlbnRpdGllcywgYmluZGluZ0xpc3QpO1xyXG5cclxuICAgIHJldHVybiBiaW5kaW5nRGF0YTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOagueaNruW3sue7j+WtmOWcqOeahEJpbmRpbmdEYXRh5Yib5bu65LiA5Liq5paw55qEQmluZGluZ0RhdGFcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZUZyb21FeGlzdGluZ0JpbmRpbmdEYXRhKGV4aXN0aW5nQmluZGluZ0RhdGE6IEJpbmRpbmdEYXRhLCBiaW5kaW5nUGF0aDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBiaW5kaW5nRGF0YSA9IG5ldyBCaW5kaW5nRGF0YSgpO1xyXG4gICAgYmluZGluZ0RhdGEuaW5pdEJ5QmluZGluZ0xpc3QoZXhpc3RpbmdCaW5kaW5nRGF0YS5saXN0LCBudWxsKTtcclxuICAgIHJldHVybiBiaW5kaW5nRGF0YTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEJpbmRpbmdEYXRhRmFjdG9yeSB9O1xyXG4iXX0=