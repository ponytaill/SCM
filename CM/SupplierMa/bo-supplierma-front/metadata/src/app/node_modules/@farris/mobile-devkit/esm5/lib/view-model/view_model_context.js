import { Injector, InjectFlags } from '../core/index';
import { AppContext } from '../app/index';
/**
 * 视图模型上下文
 */
var ViewModelContext = /** @class */ (function () {
    function ViewModelContext() {
    }
    ViewModelContext.prototype.init = function (viewModel) {
        this.innerViewModel = viewModel;
        this.id = this.innerViewModel.id;
        this.appContext = viewModel.injector.get(AppContext);
        this.regToTree();
        this.regToAppContext();
    };
    ViewModelContext.prototype.regToTree = function () {
        var parentInjector = this.innerViewModel.injector.get(Injector, null, InjectFlags.SkipSelf);
        if (parentInjector) {
            this.parent = parentInjector.get(ViewModelContext, null);
            this.root = this.parent ? this.parent.root : this;
        }
        else {
            this.parent = null;
            this.root = this;
        }
    };
    ViewModelContext.prototype.regToAppContext = function () {
        this.appContext.regViewModelContext(this);
    };
    Object.defineProperty(ViewModelContext.prototype, "viewModel", {
        get: function () {
            return this.innerViewModel;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "injector", {
        get: function () {
            return this.innerViewModel.injector;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "repository", {
        get: function () {
            return this.innerViewModel.repository;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "bindingData", {
        get: function () {
            return this.innerViewModel.bindingData;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "uiState", {
        get: function () {
            return this.innerViewModel.uiState;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "stateMachine", {
        get: function () {
            return this.innerViewModel.stateMachine;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "form", {
        get: function () {
            return this.innerViewModel.form;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewModelContext.prototype, "commandBus", {
        get: function () {
            return this.innerViewModel.commandBus;
        },
        enumerable: true,
        configurable: true
    });
    return ViewModelContext;
}());
export { ViewModelContext };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlld19tb2RlbF9jb250ZXh0LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL3ZpZXctbW9kZWwvdmlld19tb2RlbF9jb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXRELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFVMUM7O0dBRUc7QUFDSDtJQVlFO0lBQ0EsQ0FBQztJQUVNLCtCQUFJLEdBQVgsVUFBWSxTQUFTO1FBQ25CLElBQUksQ0FBQyxjQUFjLEdBQUcsU0FBUyxDQUFDO1FBQ2hDLElBQUksQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUM7UUFDakMsSUFBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNyRCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFTSxvQ0FBUyxHQUFoQjtRQUNFLElBQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBVyxRQUFRLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN4RyxJQUFJLGNBQWMsRUFBRztZQUNuQixJQUFJLENBQUMsTUFBTSxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDekQsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1NBQ25EO2FBQU07WUFDTCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztZQUNuQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUNsQjtJQUNILENBQUM7SUFFTSwwQ0FBZSxHQUF0QjtRQUNFLElBQUksQ0FBQyxVQUFVLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELHNCQUFXLHVDQUFTO2FBQXBCO1lBQ0UsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO1FBQzdCLENBQUM7OztPQUFBO0lBRUQsc0JBQVcsc0NBQVE7YUFBbkI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDO1FBQ3RDLENBQUM7OztPQUFBO0lBRUQsc0JBQVcsd0NBQVU7YUFBckI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDO1FBQ3hDLENBQUM7OztPQUFBO0lBRUQsc0JBQVcseUNBQVc7YUFBdEI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDO1FBQ3pDLENBQUM7OztPQUFBO0lBRUQsc0JBQVcscUNBQU87YUFBbEI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDO1FBQ3JDLENBQUM7OztPQUFBO0lBRUQsc0JBQVcsMENBQVk7YUFBdkI7WUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDO1FBQzFDLENBQUM7OztPQUFBO0lBRUQsc0JBQVcsa0NBQUk7YUFBZjtZQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUM7UUFDbEMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBVyx3Q0FBVTthQUFyQjtZQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUM7UUFDeEMsQ0FBQzs7O09BQUE7SUFFSCx1QkFBQztBQUFELENBQUMsQUF0RUQsSUFzRUM7QUFFRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdG9yLCBJbmplY3RGbGFncyB9IGZyb20gJy4uL2NvcmUvaW5kZXgnO1xyXG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSAnLi4vY29udGV4dC9pbmRleCc7XHJcbmltcG9ydCB7IEFwcENvbnRleHQgfSBmcm9tICcuLi9hcHAvaW5kZXgnO1xyXG5pbXBvcnQgeyBFbnRpdHkgfSBmcm9tICcuLi9lbnRpdHkvaW5kZXgnO1xyXG5pbXBvcnQgeyBSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yeS9pbmRleCc7XHJcbmltcG9ydCB7IEJpbmRpbmdEYXRhIH0gZnJvbSAnLi4vYmluZGluZy1kYXRhL2luZGV4JztcclxuaW1wb3J0IHsgVUlTdGF0ZSB9IGZyb20gJy4uL3VpLXN0YXRlL2luZGV4JztcclxuaW1wb3J0IHsgU3RhdGVNYWNoaW5lIH0gZnJvbSAnLi4vc3RhdGUtbWFjaGluZS9pbmRleCc7XHJcbmltcG9ydCB7IEZvcm0gfSBmcm9tICcuLi9mb3JtL2luZGV4JztcclxuaW1wb3J0IHsgVmlld01vZGVsIH0gZnJvbSAnLi4vdmlldy1tb2RlbC9pbmRleCc7XHJcbmltcG9ydCB7IENvbW1hbmRCdXMgfSBmcm9tICcuLi9jb21tYW5kL2luZGV4JztcclxuXHJcbi8qKlxyXG4gKiDop4blm77mqKHlnovkuIrkuIvmlodcclxuICovXHJcbmNsYXNzIFZpZXdNb2RlbENvbnRleHQge1xyXG5cclxuICBwcml2YXRlIGlubmVyVmlld01vZGVsOiBWaWV3TW9kZWw7XHJcblxyXG4gIHB1YmxpYyBhcHBDb250ZXh0OiBBcHBDb250ZXh0O1xyXG5cclxuICBwdWJsaWMgcm9vdDogVmlld01vZGVsQ29udGV4dDtcclxuXHJcbiAgcHVibGljIHBhcmVudDogVmlld01vZGVsQ29udGV4dDtcclxuXHJcbiAgcHVibGljIGlkOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGluaXQodmlld01vZGVsKTogdm9pZCB7XHJcbiAgICB0aGlzLmlubmVyVmlld01vZGVsID0gdmlld01vZGVsO1xyXG4gICAgdGhpcy5pZCA9IHRoaXMuaW5uZXJWaWV3TW9kZWwuaWQ7XHJcbiAgICB0aGlzLmFwcENvbnRleHQgPSB2aWV3TW9kZWwuaW5qZWN0b3IuZ2V0KEFwcENvbnRleHQpO1xyXG4gICAgdGhpcy5yZWdUb1RyZWUoKTtcclxuICAgIHRoaXMucmVnVG9BcHBDb250ZXh0KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVnVG9UcmVlKCkge1xyXG4gICAgY29uc3QgcGFyZW50SW5qZWN0b3IgPSB0aGlzLmlubmVyVmlld01vZGVsLmluamVjdG9yLmdldDxJbmplY3Rvcj4oSW5qZWN0b3IsIG51bGwsIEluamVjdEZsYWdzLlNraXBTZWxmKTtcclxuICAgIGlmIChwYXJlbnRJbmplY3RvcikgIHtcclxuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRJbmplY3Rvci5nZXQoVmlld01vZGVsQ29udGV4dCwgbnVsbCk7XHJcbiAgICAgIHRoaXMucm9vdCA9IHRoaXMucGFyZW50ID8gdGhpcy5wYXJlbnQucm9vdCA6IHRoaXM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgIHRoaXMucm9vdCA9IHRoaXM7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVnVG9BcHBDb250ZXh0KCkge1xyXG4gICAgdGhpcy5hcHBDb250ZXh0LnJlZ1ZpZXdNb2RlbENvbnRleHQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHZpZXdNb2RlbCgpOiBWaWV3TW9kZWwge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5uZXJWaWV3TW9kZWw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGluamVjdG9yKCk6IEluamVjdG9yIHtcclxuICAgIHJldHVybiB0aGlzLmlubmVyVmlld01vZGVsLmluamVjdG9yO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCByZXBvc2l0b3J5KCk6IFJlcG9zaXRvcnk8RW50aXR5PiB7XHJcbiAgICByZXR1cm4gdGhpcy5pbm5lclZpZXdNb2RlbC5yZXBvc2l0b3J5O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBiaW5kaW5nRGF0YSgpOiBCaW5kaW5nRGF0YSB7XHJcbiAgICByZXR1cm4gdGhpcy5pbm5lclZpZXdNb2RlbC5iaW5kaW5nRGF0YTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgdWlTdGF0ZSgpOiBVSVN0YXRlIHtcclxuICAgIHJldHVybiB0aGlzLmlubmVyVmlld01vZGVsLnVpU3RhdGU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHN0YXRlTWFjaGluZSgpOiBTdGF0ZU1hY2hpbmUge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5uZXJWaWV3TW9kZWwuc3RhdGVNYWNoaW5lO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBmb3JtKCk6IEZvcm0ge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5uZXJWaWV3TW9kZWwuZm9ybTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgY29tbWFuZEJ1cygpOiBDb21tYW5kQnVzIHtcclxuICAgIHJldHVybiB0aGlzLmlubmVyVmlld01vZGVsLmNvbW1hbmRCdXM7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IHsgVmlld01vZGVsQ29udGV4dCB9O1xyXG4iXX0=