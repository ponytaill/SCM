/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { delay, debounceTime, takeUntil } from 'rxjs/operators';
import { of, Subject } from 'rxjs';
import ResizeObserver from 'resize-observer-polyfill';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 07:47:12
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-26 10:21:25
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, ChangeDetectorRef, ChangeDetectionStrategy, NgZone, Injector, Optional, ApplicationRef, Output, EventEmitter } from '@angular/core';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { ScrollbarDirective } from '../../scrollbar/scrollbar.directive';
import { SCROLL_X_ACTION, SCROLL_Y_ACTION, SCROLL_X_REACH_START_ACTION, TR_PREFIX } from '../../types/constant';
import { DatagridService } from '../../services/datagrid.service';
import { DatagridComponent } from '../../datagrid.component';
import { FormatCellDataPipe } from '../../utils/format-cell-data.pipe';
import { ColumnFormatService } from '@farris/ui-common/column';
var DatagridBodyComponent = /** @class */ (function () {
    function DatagridBodyComponent(injector, app, dg, cd, el) {
        var _this = this;
        this.injector = injector;
        this.app = app;
        this.dg = dg;
        this.cd = cd;
        this.el = el;
        // 自动高度时，禁用纵向滚动条
        this.psConfig = { swipeEasing: false, minScrollbarLength: 15, handlers: ['click-rail', 'drag-thumb', 'wheel', 'touch'], suppressScrollY: this.dg.autoHeight };
        this.scrollTop = 0;
        this.scrollLeft = 0;
        this.deltaTopHeight = 0;
        // wheelHeight = 0;
        this.wheelWidth = 0;
        this._fixedRightScrollLeft = 0;
        this.maxScrollLeft = 0;
        this.showRightShadow = false;
        this.footerHeight = 0;
        // 虚拟加载
        this.topHideHeight = 0;
        this.bottomHideHeight = 0;
        this.startRowIndex = 0;
        this.dataChange = new EventEmitter();
        this.scrollBarMode = 'auto';
        this.checkedRows = [];
        /**
         * 性能优化版，默认为 false
         */
        this.fast = false;
        this.visibleContextMenus = [];
        this.currentRowId = undefined;
        this._hoverRowIndex = -1;
        this.subscriptions = [];
        this.minRowBuffer = 3;
        this.vScrollDir = 1;
        this.rowsCache = {};
        this.lastRenderedScrollTop = 0;
        this.lastRenderedScrollLeft = 0;
        this.prevScrollTop = 0;
        this.prevScrollLeft = 0;
        this.rows = [];
        this.blankTopHeight = 0;
        this.blankBottomHeight = 0;
        this.cellContentFormatter = null;
        // 当启用多选且允许多选中，列表不能编辑时，取选中后禁止触发body 的click 事件
        this.__triggerBodyClickEvent = true;
        this.destroy$ = new Subject();
        this._onMouseClick = null;
        this._scrollTimer = 0;
        this._scrollXTimer = 0;
        this.ro = null;
        this.resizeObserverTimer = 0;
        this.onBeforeShowContextMenu = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            // row_1_fixedleft  row_1  row_1_fixedright
            var contextMenuDom = e.contextMenuDom, event = e.event;
            if (event.target.closest('.datagrid-editor')) {
                return of({ show: false });
            }
            /** @type {?} */
            var rowID = event.target.id;
            if (contextMenuDom) {
                // 排除分组行、分组合计行
                if (contextMenuDom.className.indexOf('f-datagrid-group-row') === -1 && contextMenuDom.className.indexOf('f-datagrid-group-footer') === -1) {
                    rowID = contextMenuDom.id.replace('row_', '').replace('_fixedleft', '').replace('_fixedright', '');
                    /** @type {?} */
                    var rowData = _this.dfs.findRow(rowID);
                    /** @type {?} */
                    var focusTargetWidth = _this.viewportW > _this.totalWidth ? _this.totalWidth : _this.viewportW;
                    return of({ show: true, data: { data: rowData.data, grid: _this.dg }, focusTargetWidth: focusTargetWidth });
                }
            }
            return of({ show: false });
        });
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        this.ngZone = this.injector.get(NgZone);
        this.render = this.injector.get(Renderer2);
        /** @type {?} */
        var columnFormatService = this.injector.get(ColumnFormatService);
        this.cellContentFormatter = new FormatCellDataPipe(columnFormatService, this.injector);
    }
    Object.defineProperty(DatagridBodyComponent.prototype, "fixedRightScrollLeft", {
        get: /**
         * @return {?}
         */
        function () {
            return this._fixedRightScrollLeft;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._fixedRightScrollLeft = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "hoverRowIndex", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hoverRowIndex;
        },
        set: /**
         * @param {?} rowIdx
         * @return {?}
         */
        function (rowIdx) {
            this._hoverRowIndex = rowIdx;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "selectedRows", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dg.selections;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarXHeight", {
        //////////////////////////////////////////////////////////////////////////
        get: 
        //////////////////////////////////////////////////////////////////////////
        /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                /** @type {?} */
                var h = this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 22 : 0;
                if (this.ps.instance['scrollbarYActive'] && h) {
                    return h + 18; // + (this.dg.showScrollArrow && this.ps.instance['scrollbarYActive'] ? 18 : 0);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarYWidth", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                return this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarYActive'] && this.showRightShadow ? 18 : 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.listenSubjects();
        this.dg.scrollInstance = this.ps;
        /** @type {?} */
        var s1 = this.dgs.showGridHeader.subscribe((/**
         * @param {?} headerHeight
         * @return {?}
         */
        function (headerHeight) {
            _this.updateContainerSize(headerHeight);
        }));
        this.subscriptions.push(s1);
        /** @type {?} */
        var s10 = this.dgs.footerPositionChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.updateContainerSize();
        }));
        this.subscriptions.push(s10);
        /** @type {?} */
        var s2 = this.dgs.rowHeightChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(s2);
        /** @type {?} */
        var s3 = this.dfs.clientSort$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition(true);
            _this.cd.detectChanges();
            // this.dg.columnSorted.emit();
        }));
        this.subscriptions.push(s3);
        /** @type {?} */
        var s5 = this.dg.dgs.columnsChanged.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e && e.scrollToLeft) {
                _this.ps.elementRef.nativeElement.scrollTo(0, 0);
                _this.ps.scrollToLeft(0, 100);
            }
        }));
        this.subscriptions.push(s5);
        this.viewScrollContainer.nativeElement.addEventListener('click', this._onMouseClick = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.onMouseClick(e);
        }));
    };
    /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateContainerSize = /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        /** @type {?} */
        var hh = headerHeight || this.dg.realHeaderHeight;
        this.setPositionTop(hh);
        this.height = this.dg.height - this.top;
        this.bodyStyle = this.getBodyStyle();
        this.cd.detectChanges();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.data && !changes.data.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
            this.dfs.setCurrentPageData(changes.data.currentValue);
            /** @type {?} */
            var isDiffrentDataSource = !!changes.data.currentValue.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.id; })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return !changes.data.previousValue.find((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === n; }));
            })).length;
            this.onDataChanged(isDiffrentDataSource);
            if (!changes.data.currentValue || !changes.data.currentValue.length) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.setPositionTop(_this.dg.realHeaderHeight);
                }));
            }
        }
        if (changes.footerHeight !== undefined && !changes.footerHeight.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
        }
        if (changes.scrollBarMode !== undefined && !changes.scrollBarMode.isFirstChange()) {
            if (this.ps && this.ps.instance && this.scrollBarMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            else {
                this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            }
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
        }
        if (changes.showScrollArrow && !changes.showScrollArrow.isFirstChange()) {
            this.ps && this.ps.update();
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroy$.next();
        this.destroy$.complete();
        this.cellContentFormatter = null;
        this.dg.scrollInstance = null;
        this.destroySubscriptions();
        this.viewScrollContainer.nativeElement.removeEventListener('click', this._onMouseClick);
        if (this.ro) {
            this.ro.unobserve(this.viewScrollContainer.nativeElement);
            this.ro.disconnect();
        }
        if (this.resizeObserverTimer) {
            clearTimeout(this.resizeObserverTimer);
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ro = new ResizeObserver((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (_this.viewScrollContainer.nativeElement.offsetParent) {
                if (_this.resizeObserverTimer) {
                    clearTimeout(_this.resizeObserverTimer);
                }
                _this.resizeObserverTimer = setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.updateCanvasHeight();
                    if (_this.scrollBarMode === 'allways') {
                        _this.ps.update();
                    }
                    _this.cd.detectChanges();
                    _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth });
                }), 100);
            }
        }));
        this.ro.observe(this.viewScrollContainer.nativeElement);
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.setPositionTop = /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        this.top = headerHeight;
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            this.top += this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            this.top += this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && (this.dg.footerPosition === 'top' || this.dg.footerPosition === 'both')) {
            this.top += this.dg.footerHeight;
        }
    };
    /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkScrollbarPosition = /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    function (toTop) {
        if (toTop === void 0) { toTop = false; }
        if (!this.dg.data || !this.dg.data.length) {
            return;
        }
        /** @type {?} */
        var scrollBar = this.ps.instance;
        /** @type {?} */
        var scrollElRef = this.ps.elementRef.nativeElement;
        // scrollBar.update();
        /** @type {?} */
        var lastScrollLeft = scrollBar ? scrollBar.lastScrollLeft : 0;
        /** @type {?} */
        var lastScrollTop = scrollBar ? scrollBar.lastScrollTop : 0;
        // const lastScrollLeft = this.scrollLeft;
        // const lastScrollTop = this.scrollTop;
        /** @type {?} */
        var scrollTop = scrollElRef.scrollTop;
        /** @type {?} */
        var scrollLeft = scrollElRef.scrollLeft;
        if (!toTop) {
            if (scrollTop != lastScrollTop) {
                this.ps.scrollToTop(lastScrollTop);
                this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
            }
        }
        else {
            this.ps.scrollToTop();
            this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
        }
        this.scrollLeft = lastScrollLeft;
        if (scrollLeft != lastScrollLeft) {
            this.ps.scrollToX(lastScrollLeft);
            this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
        }
        else {
            if (lastScrollLeft) {
                this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
            }
        }
    };
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     */
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    DatagridBodyComponent.prototype.onDataChanged = /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    function (isDiffrentDataSource) {
        var _this = this;
        if (isDiffrentDataSource === void 0) { isDiffrentDataSource = true; }
        this.dg.setPagerHeight();
        this.viewportH = this.getViewPortHeight();
        this.bodyStyle = this.getBodyStyle();
        /**
         * update:
         * node_modules\perfect-scrollbar\types\perfect-scrollbar.d.ts
         * lastScrollTop: number
         */
        if (this.ps && this.ps.instance && !this.dg.isEditing() && !this.dg.clientFilterChanged && !this.dg.autoHeight) {
            this.scrollTop = 0;
            this.lastRenderedScrollTop = 0;
            this.ps.scrollToTop();
            this.scrollLeft = 0;
            this.ps.scrollToLeft();
        }
        this.rowsCache = {};
        /** @type {?} */
        var keepscrollPos = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var scrollInfo = _this.dg.dfs.getState().scrollInfo;
            if (scrollInfo) {
                if (scrollInfo.y) {
                    _this.scrollTop = scrollInfo.y;
                    _this.dg.scrollInstance.scrollToY(scrollInfo.y);
                    _this.dgs.onScrollMove(scrollInfo.y, SCROLL_Y_ACTION);
                }
                if (scrollInfo.x) {
                    _this.scrollLeft = scrollInfo.x;
                    _this.dg.scrollInstance.scrollToX(scrollInfo.x);
                    _this.dg.dgs.onScrollMove(scrollInfo.x, SCROLL_X_ACTION);
                }
            }
        });
        if (!this.dg.nowrap || this.dg.autoHeight) {
            this.renderData(false);
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.updateRowHeight();
            }), 100);
        }
        else {
            keepscrollPos();
            this.renderData(false);
            this.ps.update();
        }
        if (isDiffrentDataSource) {
            this.dg.initSelectOrChecked();
        }
        else {
            this.dg.refreshSelectedData();
        }
        this.dg.clientFilterChanged = false;
        this.dataChange.emit(this.data);
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.destroySubscriptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.subscriptions && this.subscriptions.length) {
            this.subscriptions.forEach((/**
             * @param {?} sub
             * @return {?}
             */
            function (sub) {
                if (sub) {
                    sub.unsubscribe();
                    sub = null;
                }
            }));
            this.subscriptions = [];
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.listenSubjects = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.destroySubscriptions();
        this.gridSizeSubscribe = this.dfs.gridSize$.pipe(takeUntil(this.destroy$)).pipe(debounceTime(50)).subscribe((/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            if (state) {
                _this.dg.setPagerHeight();
                /** @type {?} */
                var hh = _this.dg.setHeaderHeight();
                _this.setPositionTop(hh);
                _this.height = state.height - _this.top;
                /** @type {?} */
                var oldWidth_1 = _this.width;
                _this.width = Math.floor(state.width);
                _this.rowHeight = state.rowHeight;
                if (_this.dg.showBorder) {
                    _this.width -= 2;
                }
                _this.viewportW = _this.width;
                _this.viewportH = _this.getViewPortHeight();
                _this.canvasHeight = _this.getCanvasHeight();
                _this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                function () {
                    _this.columnsGroup = state.columnsGroup;
                    _this.checkScrollbarPosition();
                    // this.setFixedRightPosition();
                    _this.updateColumnSize(state.columnsGroup);
                    _this.dgs.showFixedShadow.emit({ showRightShadow: _this.showRightShadow, x: _this.fixedRightScrollLeft });
                    _this.renderData(false);
                    if (_this._scrollXTimer) {
                        clearTimeout(_this._scrollXTimer);
                    }
                    if (!_this.dg.nowrap || _this.dg.autoHeight) {
                        _this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            _this.updateRowHeight();
                            _this.keepScrollbarPosition(oldWidth_1);
                        }), 100);
                    }
                    else {
                        _this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            _this.keepScrollbarPosition(oldWidth_1);
                        }), 100);
                    }
                    // this.ps.update();
                }));
                if (_this.scrollBarMode === 'allways') {
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        if (!_this.dg.showScrollArrow) {
                            _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth });
                        }
                        _this.keepScrollbarPosition(oldWidth_1);
                    }), 100);
                }
            }
        }));
        this.subscriptions.push(this.gridSizeSubscribe);
        this.columnResizeSubscribe = this.dfs.columnResize$.subscribe((/**
         * @param {?} cg
         * @return {?}
         */
        function (cg) {
            _this.updateColumnSize(cg);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.columnResizeSubscribe);
        this.dgs.setSelecedRow.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            if (r && r.selected) {
                _this.currentRowId = r.id;
            }
            else {
                _this.currentRowId = undefined;
            }
        }));
        this.selectRowSubscribe = this.dfs.selectRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row) {
                _this.currentRowId = row.id;
                // 20210817 方向键移动后刷新视图状态
                _this.cd.detectChanges();
            }
        }));
        this.subscriptions.push(this.selectRowSubscribe);
        this.unselectRowSubscribe = this.dfs.unSelectRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            if (prevRow && prevRow.id === _this.currentRowId) {
                _this.currentRowId = undefined;
                _this.dg.selectedRow = null;
            }
            if (!_this.dg.editable && _this.dg.multiSelect) {
                _this.__triggerBodyClickEvent = _this.dg.selectionMode === 'default';
            }
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.unselectRowSubscribe);
        this.selectAllSubscribe = this.dfs.selectAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.selectAll.emit(rows);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.selectAllSubscribe);
        this.checkRowSubscribe = this.dfs.checkRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            _this.dg.checked.emit(row);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkRowSubscribe);
        this.clearSelectionsSubscribe = this.dfs.clearSelections$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.currentRowId = undefined;
            if (_this.dg.checkOnSelect) {
                _this.checkedRowsChanged();
            }
            _this.dg.unSelectAll.emit();
        }));
        this.subscriptions.push(this.clearSelectionsSubscribe);
        this.uncheckRowSubscribe = this.dfs.unCheckRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            _this.dg.unChecked.emit(prevRow);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.uncheckRowSubscribe);
        this.checkAllSubscribe = this.dfs.checkAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.checkAll.emit(rows);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkAllSubscribe);
        this.clearCheckedsSubscribe = this.dfs.clearCheckeds$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            if (_this.dg.selectOnCheck) {
                _this.currentRowId = undefined;
            }
            _this.dg.unCheckAll.emit(rows);
            _this.checkedRowsChanged();
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.clearCheckedsSubscribe);
        this.subscriptions.push(this.dgs.setScrollbarPosition.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition();
            _this.updateScrollPosition(_this.scrollLeft);
        })));
        this.dgs.columnResized.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.dg.nowrap ||
                (_this.dg.currentCell && _this.dg.currentCell.isEditing && _this.dg.currentCell.column &&
                    _this.dg.currentCell.column.editor && _this.dg.currentCell.column.editor.type === 'textarea')) {
                /** @type {?} */
                var trdoms = _this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
                trdoms.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.style.height = 'auto'; }));
                /** @type {?} */
                var trID = '';
                if (e) {
                    /** @type {?} */
                    var rowId = e.id;
                    trID = TR_PREFIX + rowId;
                }
                _this.updateRowHeight(trID);
                // trdoms.forEach(n => n.style.height = '');
            }
            if (_this.dg.headerWrap) {
                _this.dg.setHeaderHeight();
                _this.dfs.columnResizeEnd();
            }
        }));
        this.dgs.cellContentWrapChanged.pipe(delay(100)).subscribe((/**
         * @return {?}
         */
        function () {
            _this.updateRowHeight();
        }));
        this.dg.dfs.rowUpdate$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row && row.data) {
                _this.buildCustomCellStyle(row);
            }
        }));
    };
    /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    DatagridBodyComponent.prototype.keepScrollbarPosition = /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    function (oldWidth) {
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
        this.ps.update();
        if (!this.ps.instance) {
            return;
        }
        /** @type {?} */
        var scrollReach = this.ps.instance.reach;
        /** @type {?} */
        var t = this.width - oldWidth;
        /** @type {?} */
        var scrollLeft = t;
        if (scrollReach.x === 'start' || !this.ps.instance.lastScrollLeft) {
            scrollLeft = 0;
            this.ps.scrollToX(0);
        }
        else if (scrollReach.x === 'end') {
            this.ps.scrollToRight(0);
            scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        }
        else {
            scrollLeft = this.ps.instance.lastScrollLeft - t;
            this.ps.elementRef.nativeElement.scrollLeft = scrollLeft;
        }
        this.updateScrollPosition(scrollLeft);
    };
    /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateColumnSize = /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    function (cg) {
        if (cg) {
            this.columnsGroup = cg;
            this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
            this.colsWidth = this.columnsGroup.normalWidth;
            this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
            this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
            this.fixedRightScrollLeft = this.maxScrollLeft;
            // grid 容器宽度
            /** @type {?} */
            var dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
            // 所有列宽之和
            /** @type {?} */
            var allColsWidth = Math.floor(this.columnsGroup.totalWidth);
            this.bodyStyle = this.getBodyStyle();
            if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
                this.showRightShadow = false;
            }
            else {
                this.showRightShadow = true;
                // 右侧固定列的位置
                this.fixedRightScrollLeft = this.width + this.scrollLeft;
            }
            if (this.ps && this.ps.instance && this.dg.scrollBarShowMode === 'allways' && this.ps.instance.scrollbarYActive) {
                if (this.showRightShadow) {
                    this.rightFixedWidth += 18;
                    this.fixedRightScrollLeft = this.fixedRightScrollLeft - this.rightFixedWidth;
                }
                else {
                    if (this.canvasWidth > this.totalWidth && this.canvasWidth - this.totalWidth < 18) {
                        this.rightFixedWidth += 18;
                    }
                }
            }
            this.totalWidth = this.columnsGroup.totalWidth;
            if (this.scrollBarMode === 'allways' && !this.rightRowsCmp && !this.dg.useControlPanel) {
                this.totalWidth += 18;
            }
        }
    };
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.buildCustomCellStyle = 
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        var _this = this;
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        /** @type {?} */
        var trs = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        /** @type {?} */
        var updateCellStyle = (/**
         * @param {?} arr
         * @param {?} col
         * @param {?} style
         * @return {?}
         */
        function (arr, col, style) {
            if (arr.length) {
                /** @type {?} */
                var td = arr[row.index].querySelector("[field=\"" + col.field + "\"]");
                if (td) {
                    _this.dg.renderCustomStyle(style, td);
                }
            }
        });
        this.dg.flatColumns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        function (col) {
            if (col.styler) {
                /** @type {?} */
                var _rd = row.data;
                /** @type {?} */
                var cs = col.styler(_rd[col.field], _rd, row.index);
                if (cs && Object.keys(cs).length) {
                    updateCellStyle(leftTrs, col, cs);
                    updateCellStyle(rightTrs, col, cs);
                    updateCellStyle(trs, col, cs);
                }
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkedRowsChanged = /**
     * @private
     * @return {?}
     */
    function () {
        this.dgs.onCheckedRowsCountChange();
        /** @type {?} */
        var checkedRows = this.dg.checkeds;
        this.dg.checkValues = checkedRows.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.id; }));
        this.dg.checkValuesChange.emit(this.dg.checkValues);
        this.dg.checkedChange.emit(checkedRows);
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getTrDomHeight = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        /** @type {?} */
        var trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        function (tr, i) {
            /** @type {?} */
            var t1 = 0;
            /** @type {?} */
            var t2 = Math.ceil(tr.offsetHeight);
            /** @type {?} */
            var t3 = 0;
            if (leftTrs && leftTrs.length) {
                t1 = Math.ceil(leftTrs[i].offsetHeight);
            }
            if (rightTrs && rightTrs.length) {
                t3 = Math.ceil(rightTrs[i].offsetHeight);
            }
            /** @type {?} */
            var _h = Math.max(t1, t2, t3, _this.dg.rowHeight);
            list.push(_h);
        }));
        return list;
    };
    /** 允许数据折行时，计算行号的行高 */
    /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateRowHeight = /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    function (trDomId) {
        var _this = this;
        if (trDomId === void 0) { trDomId = null; }
        if (this.fast) {
            return;
        }
        if (!this.mainArea) {
            return;
        }
        /** @type {?} */
        var dgBody = this.el.nativeElement.querySelector('div.f-datagrid-body');
        if (dgBody) {
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(dgBody, 'data-wrap');
            }
            else {
                this.render.removeClass(dgBody, 'data-wrap');
            }
        }
        /** @type {?} */
        var cssTextArr = [];
        if (!trDomId) {
            this.rows.forEach((/**
             * @param {?} r
             * @param {?} i
             * @return {?}
             */
            function (r, i) {
                /** @type {?} */
                var rowId = _this.dfs.primaryId(r);
                /** @type {?} */
                var trID = TR_PREFIX + rowId;
                /** @type {?} */
                var leftTrId = trID + '_fixedleft';
                /** @type {?} */
                var rightTrId = trID + '_fixedright';
                if (!_this.dg.nowrap || _this.dg.autoHeight) {
                    /** @type {?} */
                    var list = _this.getTrDomHeight();
                    /** @type {?} */
                    var h = list[i];
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + leftTrId + "{ height: " + h + "px }");
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + trID + "{ height: " + h + "px }");
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + rightTrId + "{ height: " + h + "px }");
                }
                else {
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trID}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${list[i]}px }`);
                    /** @type {?} */
                    var key1 = _this.dg.customStyleKey() + " .f-datagrid-body #" + leftTrId;
                    /** @type {?} */
                    var key2 = _this.dg.customStyleKey() + " .f-datagrid-body #" + trID;
                    /** @type {?} */
                    var key3 = _this.dg.customStyleKey() + " .f-datagrid-body #" + rightTrId;
                    _this.dgs.removeCssRule(key1);
                    _this.dgs.removeCssRule(key2);
                    _this.dgs.removeCssRule(key3);
                }
            }));
            this.dgs.appendCssRules(cssTextArr);
        }
        else {
            cssTextArr = [];
            /** @type {?} */
            var domSel = '#' + trDomId;
            /** @type {?} */
            var _arr = [];
            if (this.fixedRightEl) {
                /** @type {?} */
                var rtr = this.fixedRightEl.nativeElement.querySelector(domSel);
                if (rtr) {
                    _arr.push(Math.ceil(rtr.offsetHeight));
                }
            }
            if (this.fixedLeftEl) {
                /** @type {?} */
                var ltr = this.fixedLeftEl.nativeElement.querySelector(domSel);
                if (ltr) {
                    _arr.push(Math.ceil(ltr.offsetHeight));
                }
            }
            if (this.mainArea) {
                /** @type {?} */
                var tr = this.mainArea.nativeElement.querySelector(domSel);
                if (tr) {
                    _arr.push(Math.ceil(tr.offsetHeight));
                }
            }
            /** @type {?} */
            var _h = Math.max.apply(Math, tslib_1.__spread(_arr));
            /** @type {?} */
            var leftTrId = trDomId + '_fixedleft';
            /** @type {?} */
            var rightTrId = trDomId + '_fixedright';
            if (!this.dg.nowrap || this.dg.autoHeight) {
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + leftTrId + "{ height: " + _h + "px;}");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + trDomId + "{ height: " + _h + "px;}");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + rightTrId + "{ height: " + _h + "px;}");
            }
            else {
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + leftTrId + "{ height: " + _h + "px }");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + trDomId + "{ height: " + _h + "px }");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + rightTrId + "{ height: " + _h + "px }");
            }
            this.dgs.appendCssRules(cssTextArr);
        }
        this.updateCanvasHeight();
        // 移除height: auto
        /** @type {?} */
        var trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
        trdoms.forEach((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.style.height = ''; }));
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getBodyStyle = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var h = this.getViewPortHeight();
        if (!this.data.length) {
            if (this.dg.autoHeight) {
                h = this.dg.emptyDataHeight;
            }
            if (this.dg.footerData && this.dg.showFooter) {
                /** @type {?} */
                var fd = this.dg.footerData;
                if (this.dg.footerData.subscribe) {
                    fd = this.dg.footerData['value'];
                }
                if (fd && Array.isArray(fd) && fd.length) {
                    h = h - this.dg.footerHeight;
                    if (this.dg.footerPosition === 'both') {
                        h = h - this.dg.footerHeight;
                    }
                }
            }
        }
        else {
            if (this.dg.showFooter && this.dg.footerPosition === 'both') {
                h = h - this.dg.footerHeight;
            }
        }
        return {
            height: Math.floor(h) + "px"
        };
    };
    /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateScrollPosition = /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    function (scrollLeft) {
        this.scrollLeft = scrollLeft;
        this.fixedRightScrollLeft = this.scrollLeft + this.width - this.rightFixedWidth;
        if (this.fixedRightScrollLeft === this.maxScrollLeft || this.fixedRightScrollLeft > this.maxScrollLeft) {
            this.fixedRightScrollLeft = this.maxScrollLeft;
            this.showRightShadow = false;
        }
        else {
            this.showRightShadow = true;
        }
        if (this.fixedLeftEl) {
            this.render.setStyle(this.fixedLeftEl.nativeElement, 'transform', "translate3d(" + this.scrollLeft + "px, 0px, 0px)");
        }
        if (this.fixedRightEl) {
            this.render.setStyle(this.fixedRightEl.nativeElement, 'transform', "translate3d(" + this.fixedRightScrollLeft + "px, 0px, 0px)");
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToX = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        // this.cd.detectChanges();
        this.dgs.onScrollMove(x, SCROLL_X_ACTION);
        this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToY = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if (this._scrollTimer) {
            clearTimeout(this._scrollTimer);
        }
        this._scrollTimer = setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var y = $event.target.scrollTop;
            if (_this.dg.virtualized) {
                _this.handleScroll();
            }
            _this.scrollTop = y;
            _this.dg.scrollY.emit(y);
            _this.dgs.onScrollMove(y, SCROLL_Y_ACTION);
        }), 100);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachStart = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        this.dgs.onScrollMove(x, SCROLL_X_REACH_START_ACTION);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachEnd = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.showRightShadow = false;
        // const x = $event.target.scrollLeft;
        // this.updateScrollPosition(x);
        // this.cd.detectChanges();
        // // this.dgs.onShowFixedShadow(this.showRightShadow);
        // this.dgs.onScrollMove(x, SCROLL_X_REACH_END_ACTION);
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isChecked = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowChecked(rowData[this.dg.idField]);
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isSelected = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowSelected(rowData[this.dg.idField]);
        }
        return false;
    };
    /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    DatagridBodyComponent.prototype.toggleGroupRow = /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    function (row, open) {
        if (open === void 0) { open = true; }
        row.expanded = open;
        this.ps.update();
    };
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /** 获取可视区域高度 */
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getViewPortHeight = /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewPortHeight = this.dg.height;
        if (this.dg.showHeader) {
            viewPortHeight = viewPortHeight - this.dg.realHeaderHeight;
        }
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            viewPortHeight -= this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            viewPortHeight -= this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && this.data.length) {
            viewPortHeight = viewPortHeight - this.dg.footerHeight;
        }
        if (this.dg.pagination) {
            viewPortHeight = viewPortHeight - this.dg.pagerHeight - 2;
        }
        if (this.dg.showBorder) {
            viewPortHeight -= 2;
        }
        this.viewportH = viewPortHeight;
        return viewPortHeight;
    };
    // 不折行时，所有数据的高度
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.allRowsHeight = 
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rowHeightpatch = 1;
        // this.dg.autoHeight ? 2 : 1;
        /** @type {?} */
        var rowHeight = this.dg.rowHeight + rowHeightpatch;
        /** @type {?} */
        var itemsCount = 0;
        if (this.dg.groupSummaryPosition === 'inGroupRow') {
            itemsCount = this.data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group_footer__']; })).length;
        }
        else {
            itemsCount = this.data.length;
        }
        /** @type {?} */
        var h = itemsCount * rowHeight;
        if (this.dg.autoHeight) {
            h += itemsCount;
        }
        else {
            h += 2;
        }
        return h;
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getCanvasHeight = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var canvasHeight = 0;
        if (!this.data || !this.data.length) {
            this.canvasHeight = 0;
            return 0;
        }
        if (this.dg.nowrap) {
            canvasHeight = this.allRowsHeight();
        }
        else {
            canvasHeight = this.getTrDomHeight().reduce((/**
             * @param {?} r
             * @param {?} c
             * @return {?}
             */
            function (r, c) { return r + c; }), 0);
        }
        if (!canvasHeight) {
            canvasHeight = this.viewportH;
        }
        canvasHeight = canvasHeight + (this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 18 : 0);
        this.canvasHeight = canvasHeight;
        return canvasHeight;
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateCanvasHeight = /**
     * @return {?}
     */
    function () {
        this.canvasHeight = this.getCanvasHeight();
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRowFromPosition = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        return Math.floor(y / (this.dg.rowHeight + 1));
    };
    /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getVisibleRange = /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        if (viewportTop == null) {
            viewportTop = this.scrollTop;
        }
        if (viewportLeft == null) {
            viewportLeft = this.scrollLeft;
        }
        return {
            top: this.getRowFromPosition(viewportTop),
            bottom: this.getRowFromPosition(viewportTop + this.viewportH) + 1,
            leftPx: viewportLeft,
            rightPx: viewportLeft + this.viewportW
        };
    };
    /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRenderedRange = /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        /** @type {?} */
        var range = this.getVisibleRange(viewportTop, viewportLeft);
        /** @type {?} */
        var buffer = Math.round(this.viewportH / (this.dg.rowHeight + 1));
        /** @type {?} */
        var minBuffer = this.minRowBuffer;
        if (this.vScrollDir == -1) {
            range.top -= buffer;
            range.bottom += minBuffer;
        }
        else if (this.vScrollDir == 1) {
            range.top -= minBuffer;
            range.bottom += buffer;
        }
        else {
            range.top -= minBuffer;
            range.bottom += minBuffer;
        }
        range.top = Math.max(0, range.top);
        range.bottom = Math.min(this.data.length - 1, range.bottom);
        range.leftPx -= this.viewportW;
        range.rightPx += this.viewportW;
        range.leftPx = Math.max(0, range.leftPx);
        range.rightPx = Math.min(this.canvasWidth, range.rightPx);
        return range;
    };
    /**
     * @private
     * @param {?} range
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderRows = /**
     * @private
     * @param {?} range
     * @return {?}
     */
    function (range) {
        var _this = this;
        /** @type {?} */
        var rows = [];
        /** @type {?} */
        var dataLength = this.data.length;
        for (var i = range.top; i <= range.bottom; i++) {
            if (this.rowsCache[i] || (i == dataLength)) {
                continue;
            }
            rows.push(i);
            // Create an entry right away so that appendRowHtml() can
            // start populatating it.
            this.rowsCache[i] = {
                rowNode: null,
                // ColSpans of rendered cells (by column idx).
                // Can also be used for checking whether a cell has been rendered.
                cellColSpans: [],
                // Cell nodes (by column idx).  Lazy-populated by ensureCellNodesInRowsCache().
                cellNodesByColumnIdx: [],
                // Column indices of cell nodes that have been rendered, but not yet indexed in
                // cellNodesByColumnIdx.  These are in the same order as cell nodes added at the
                // end of the row.
                cellRenderQueue: []
            };
        }
        for (var i = 0, ii = rows.length; i < ii; i++) {
            this.rowsCache[rows[i]].rowNode = this.data[rows[i]];
        }
        return Object.keys(this.rowsCache).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return _this.rowsCache[n].rowNode; }));
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.removeRowFromCache = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        /** @type {?} */
        var cacheEntry = this.rowsCache[row];
        if (!cacheEntry) {
            return;
        }
        delete this.rowsCache[row];
    };
    /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    DatagridBodyComponent.prototype.cleanupRows = /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    function (rangeToKeep) {
        for (var i in this.rowsCache) {
            if (i < rangeToKeep.top || i > rangeToKeep.bottom) {
                this.removeRowFromCache(i);
            }
        }
    };
    /**
     * @param {?} showYscrollbar
     * @return {?}
     */
    DatagridBodyComponent.prototype.hasYScrollbar = /**
     * @param {?} showYscrollbar
     * @return {?}
     */
    function (showYscrollbar) {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.updateColumnSize(_this.columnsGroup);
            if (_this.ps) {
                _this.ps.update();
                _this.cd.detectChanges();
            }
            _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance });
        }), 60);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onClickScrollArrow = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var dir = $event.dir, event = $event.event;
        if (this.ps && this.ps.instance) {
            var _a = this.ps.instance.reach, x = _a.x, y = _a.y;
            switch (dir) {
                case 'left':
                    if (x !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft - 40;
                    }
                    break;
                case 'right':
                    if (x !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft + 40;
                    }
                    break;
                case 'top':
                    if (y !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop - 40;
                    }
                    break;
                case 'bottom':
                    if (y !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop + 40;
                    }
                    break;
            }
            this.ps.update();
        }
    };
    /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderData = /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    function (detectchanges) {
        if (detectchanges === void 0) { detectchanges = true; }
        this.canvasHeight = this.getCanvasHeight();
        if (!this.dg.virtualized || this.dg.autoHeight) {
            this.rows = this.data;
        }
        else {
            /** @type {?} */
            var visible = this.getVisibleRange();
            /** @type {?} */
            var rendered = this.getRenderedRange();
            // remove rows no longer in the viewport
            this.cleanupRows(rendered);
            // render missing rows
            this.rows = this.renderRows(rendered);
            this.startRowIndex = rendered.top;
            this.lastRenderedScrollTop = this.scrollTop;
            this.lastRenderedScrollLeft = this.scrollLeft;
            this.blankTopHeight = this.startRowIndex * (this.dg.rowHeight + 1);
            this.blankBottomHeight = this.canvasHeight - this.blankTopHeight - (this.rows.length * (this.dg.rowHeight + 1));
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
            if (detectchanges) {
                this.cd.detectChanges();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        this.scrollTop = this.ps.elementRef.nativeElement.scrollTop;
        this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        return this._handleScroll();
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype._handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewportContainer = this.viewScrollContainer.nativeElement;
        /** @type {?} */
        var maxScrollDistanceY = viewportContainer.scrollHeight - viewportContainer.clientHeight;
        /** @type {?} */
        var maxScrollDistanceX = viewportContainer.scrollWidth - viewportContainer.clientWidth;
        // Protect against erroneous clientHeight/Width greater than scrollHeight/Width.
        // Sometimes seen in Chrome.
        maxScrollDistanceY = Math.max(0, maxScrollDistanceY);
        maxScrollDistanceX = Math.max(0, maxScrollDistanceX);
        // Ceiling the max scroll values
        if (this.scrollTop > maxScrollDistanceY) {
            this.scrollTop = maxScrollDistanceY;
        }
        if (this.scrollLeft > maxScrollDistanceX) {
            this.scrollLeft = maxScrollDistanceX;
        }
        /** @type {?} */
        var vScrollDist = Math.abs(this.scrollTop - this.prevScrollTop);
        /** @type {?} */
        var hScrollDist = Math.abs(this.scrollLeft - this.prevScrollLeft);
        if (hScrollDist) {
            this.prevScrollLeft = this.scrollLeft;
            // $viewportScrollContainerX[0].scrollLeft = scrollLeft;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows) {
            //         $viewportTopR[0].scrollLeft = scrollLeft;
            //     }
            // } else {
            //     if (hasFrozenRows) {
            //         $viewportTopL[0].scrollLeft = scrollLeft;
            //     }
            // }
        }
        /** @type {?} */
        var lastScrollTop = this.lastRenderedScrollTop;
        if (vScrollDist) {
            this.vScrollDir = this.prevScrollTop < this.scrollTop ? 1 : -1;
            this.prevScrollTop = this.scrollTop;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows && !options.frozenBottom) {
            //         $viewportBottomL[0].scrollTop = scrollTop;
            //     } else {
            //         $viewportTopL[0].scrollTop = scrollTop;
            //     }
            // }
            // switch virtual pages if needed
            if (vScrollDist < this.viewportH) {
                this._scrollTo(this.scrollTop);
            }
        }
        if (hScrollDist || vScrollDist) {
            /** @type {?} */
            var dx = Math.abs(this.lastRenderedScrollLeft - this.scrollLeft);
            /** @type {?} */
            var dy = Math.abs(lastScrollTop - this.scrollTop);
            if (dx > 20 || dy > 20) {
                // if rendering is forced or scrolling is small enough to be "easy", just render
                if (dy < this.viewportH && dx < this.viewportW) {
                    this.renderData();
                }
                else {
                    this.renderData();
                }
            }
        }
        if (hScrollDist || vScrollDist) {
            return true;
        }
        return false;
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype._scrollTo = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        /** @type {?} */
        var $viewportScrollContainerY = this.viewScrollContainer.nativeElement;
        y = Math.max(y, 0);
        y = Math.min(y, this.canvasHeight - this.viewportH);
        /** @type {?} */
        var newScrollTop = y;
        if (this.prevScrollTop != newScrollTop) {
            this.vScrollDir = (this.prevScrollTop < newScrollTop) ? 1 : -1;
            this.lastRenderedScrollTop = (this.scrollTop = this.prevScrollTop = newScrollTop);
            // if (hasFrozenColumns()) {
            //     $viewportTopL[0].scrollTop = newScrollTop;
            // }
            // if (hasFrozenRows) {
            //     $viewportBottomL[0].scrollTop = $viewportBottomR[0].scrollTop = newScrollTop;
            // }
            // $viewportScrollContainerY.scrollTop = newScrollTop;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onMouseClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // document.body.click();
        /** @type {?} */
        var target = (/** @type {?} */ ($event.target));
        if (target.nodeName === 'TEXTAREA' || target.nodeName === 'INPUT') {
            return;
        }
        /** @type {?} */
        var td = target;
        if (target.nodeName !== 'TD') {
            td = target.closest('TD');
        }
        if (!this.dg.editable && this.__triggerBodyClickEvent) {
            // 解决超链点击事件，要先执行选中行
            if (td && td.selectCell) {
                $event.stopPropagation();
                td.selectCell($event, td); // 按理说可以删除的，但不敢动哦o(≧口≦)o
            }
            return;
        }
        if (this.dg.editMode === 'row') {
            return;
        }
        if (!td && this.dg.currentCell) {
            td = this.dg.currentCell.cellElement;
            if (td && td.closeEdit) {
                $event.stopPropagation();
                td.closeEdit();
                return;
            }
        }
        if (td) {
            // 行禁用时
            if (this.dg.disableRow && td.gridCellData) {
                var _a = td.gridCellData, rowData = _a.rowData, rowIndex = _a.rowIndex;
                if (this.dg.disableRow(rowData, rowIndex)) {
                    return;
                }
            }
            $event.stopPropagation();
            if (this.dg.editable && this.dg.editMode === 'cell' && td.edit) {
                td.edit($event);
            }
            else {
                if (td.selectCell) {
                    if (this.dg.selectionMode === 'default' && this.dg.multiSelect) {
                        this.dg.clearCheckeds();
                    }
                    td.selectCell($event, td);
                }
                else {
                    this.dg.endCellEdit();
                }
            }
        }
    };
    DatagridBodyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'datagrid-body',
                    template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-06 07:43:07\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-11-26 08:20:46\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n<ng-container  *ngIf=\"!data || !data.length\">\r\n    <div *ngIf=\"!dg.emptyTemplate\" class=\"d-flex flex-column f-datagrid-norecords\"\r\n        style=\"position:absolute; margin:0;left: 0; z-index: 1;justify-content: center; align-items: center;pointer-events: none;\" \r\n        [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" >\r\n        <div class=\"f-datagrid-norecords-content\" style=\"margin: 0;width: 100%;position: relative; top: 0\">\r\n            {{ 'datagrid.emptyMessage' | locale }}\r\n        </div>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyTemplate\">\r\n        <ng-container #emptyTemplate [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container>\r\n    </div>\r\n</ng-container>\r\n<div  class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" \r\n[farris-context-menus]=\"contextMenuItems\" [disabled]=\"!dg.enableContextMenu\" [activeDomName]=\"'tr'\" [beforeShowContextMenu]=\"onBeforeShowContextMenu\"\r\n[menuClass]=\"'f-datagrid-context-menu'\">\r\n\r\n    <div #viewScrollContainer [scrollbar]=\"psConfig\" #ps=\"ngxScrollbar\"\r\n        class=\"ps f-datagrid-body-wheel-area\" \r\n        style=\"width: 100%;\"\r\n        [ngStyle]=\"bodyStyle\"\r\n        (psXReachEnd)=\"onPsXReachEnd($event)\"\r\n        (psScrollY)=\"onScrollToY($event)\"\r\n        (psScrollX)=\"onScrollToX($event)\" (psXReachStart)=\"onPsXReachStart($event)\"\r\n\r\n        [style.paddingRight.px]=\"scrollbarYWidth\">\r\n       \r\n        <div class=\"f-datagrid-norecords\"  [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"dg.emptyDataHeight || 240\" style=\"height: 100%\" [style.width.px]=\"canvasWidth - 2\"  *ngIf=\"!data || !data.length\">\r\n            <!-- <div *ngIf=\"!dg.emptyTemplate\" class=\"f-datagrid-norecords-content\" style=\"width: 100%\" >{{ 'datagrid.emptyMessage' | locale }}</div>\r\n            <ng-container #emptyTemplate *ngIf=\"dg.emptyTemplate\" [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container> -->\r\n        </div>\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && !fast\"\r\n            class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n            [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n            \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n                \r\n                <div #fixedLeft class=\"f-datagrid-table f-datagrid-body-fixed-left\"  [class.f-datagrid-fixed-left-shadow]=\"!!scrollLeft && !dg.groupRows\"\r\n                    *ngIf=\"dg.showLineNumber || dg.showCheckbox || (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length)\"  [style.width.px]=\"leftFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ scrollLeft +'px, 0px, 0px)'\">\r\n\r\n                    <fixed-left-rows [columns]=\"columnsGroup?.leftFixed\" [checkedRows]=\"checkedRows\" [selectedRows]=\"selectedRows\" [data]=\"rows\"></fixed-left-rows>\r\n                </div>\r\n\r\n                <div #fixedRight class=\"f-datagrid-table f-datagrid-body-fixed-right\" [style.width.px]=\"rightFixedWidth\" \r\n                    *ngIf=\"columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\"\r\n                    [class.f-datagrid-fixed-right-shadow]=\"showRightShadow\" \r\n                    style=\"border: 0\"\r\n                    [style.transform]=\"'translate3d('+ fixedRightScrollLeft +'px, 0px, 0px)'\">\r\n                    \r\n                    <datagrid-rows #rightRows [fixedRight]=\"true\" [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.rightFixed\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div #main [style.width.px]=\"colsWidth\" style=\"position: relative;\" [style.left.px]=\"leftFixedWidth\" class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.normalColumns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && fast\"\r\n        class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n        [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n        \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n\r\n                <div #main style=\"position: relative;\"  class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows [hasFixedColumns]=\"columnsGroup?.leftFixed && columnsGroup?.leftFixed?.length\"  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.columns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <scrollbar-arrows [scrollbarXActive]=\"ps.instance && ps.instance.scrollbarXActive\" [scrollbarYActive]=\"ps.instance && ps.instance.scrollbarYActive\" \r\n    *ngIf=\"dg.scrollBarShowMode === 'allways' && dg.showScrollArrow\" (hasYScrollbar)=\"hasYScrollbar($event)\" (scrollMoveTo)=\"onClickScrollArrow($event)\"\r\n    [reachX]=\"ps.instance && ps.instance.reach.x\" [reachY]=\"ps.instance && ps.instance.reach.y\"></scrollbar-arrows>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n",
                    changeDetection: ChangeDetectionStrategy.OnPush
                }] }
    ];
    /** @nocollapse */
    DatagridBodyComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ApplicationRef },
        { type: DatagridComponent, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef },
        { type: ElementRef }
    ]; };
    DatagridBodyComponent.propDecorators = {
        footerHeight: [{ type: Input }],
        canvasWidth: [{ type: Input }],
        columnsGroup: [{ type: Input }],
        topHideHeight: [{ type: Input }],
        bottomHideHeight: [{ type: Input }],
        startRowIndex: [{ type: Input }],
        data: [{ type: Input }],
        dataChange: [{ type: Output }],
        scrollBarMode: [{ type: Input }],
        contextMenuItems: [{ type: Input }],
        checkedRows: [{ type: Input }],
        fast: [{ type: Input }],
        ps: [{ type: ViewChild, args: ['ps',] }],
        tableRowsCmp: [{ type: ViewChild, args: ['mainRows',] }],
        rightRowsCmp: [{ type: ViewChild, args: ['rightRows',] }],
        fixedLeftEl: [{ type: ViewChild, args: ['fixedLeft',] }],
        fixedRightEl: [{ type: ViewChild, args: ['fixedRight',] }],
        mainArea: [{ type: ViewChild, args: ['main',] }],
        viewScrollContainer: [{ type: ViewChild, args: ['viewScrollContainer',] }]
    };
    return DatagridBodyComponent;
}());
export { DatagridBodyComponent };
if (false) {
    /** @type {?} */
    DatagridBodyComponent.prototype.psConfig;
    /** @type {?} */
    DatagridBodyComponent.prototype.top;
    /** @type {?} */
    DatagridBodyComponent.prototype.height;
    /** @type {?} */
    DatagridBodyComponent.prototype.width;
    /** @type {?} */
    DatagridBodyComponent.prototype.colsWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.totalWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.leftFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rowHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bodyStyle;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.deltaTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.wheelWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._fixedRightScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.maxScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.showRightShadow;
    /** @type {?} */
    DatagridBodyComponent.prototype.footerHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.columnsGroup;
    /** @type {?} */
    DatagridBodyComponent.prototype.topHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bottomHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.startRowIndex;
    /** @type {?} */
    DatagridBodyComponent.prototype.data;
    /** @type {?} */
    DatagridBodyComponent.prototype.dataChange;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollBarMode;
    /** @type {?} */
    DatagridBodyComponent.prototype.contextMenuItems;
    /** @type {?} */
    DatagridBodyComponent.prototype.checkedRows;
    /**
     * 性能优化版，默认为 false
     * @type {?}
     */
    DatagridBodyComponent.prototype.fast;
    /** @type {?} */
    DatagridBodyComponent.prototype.ps;
    /** @type {?} */
    DatagridBodyComponent.prototype.tableRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedLeftEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedRightEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.mainArea;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewScrollContainer;
    /** @type {?} */
    DatagridBodyComponent.prototype.visibleContextMenus;
    /** @type {?} */
    DatagridBodyComponent.prototype.currentRowId;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._hoverRowIndex;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.gridSizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.columnResizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.onDataSourceChangeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.unselectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearSelectionsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.uncheckRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearCheckedsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.subscriptions;
    /** @type {?} */
    DatagridBodyComponent.prototype.dfs;
    /** @type {?} */
    DatagridBodyComponent.prototype.dgs;
    /** @type {?} */
    DatagridBodyComponent.prototype.ngZone;
    /** @type {?} */
    DatagridBodyComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.viewportH;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewportW;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasHeight;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.minRowBuffer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.vScrollDir;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.rowsCache;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollTop;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.rows;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankBottomHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.cellContentFormatter;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.__triggerBodyClickEvent;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._onMouseClick;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollXTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.resizeObserverTimer;
    /** @type {?} */
    DatagridBodyComponent.prototype.onBeforeShowContextMenu;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.app;
    /** @type {?} */
    DatagridBodyComponent.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtYm9keS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1ib2R5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBb0IsS0FBSyxFQUFFLFlBQVksRUFBTyxTQUFTLEVBQVUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMvRixPQUFPLEVBQTBCLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDM0QsT0FBTyxjQUFjLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7OztBQVN0RCxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5QyxVQUFVLEVBQWEsaUJBQWlCLEVBQ2QsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBc0IsUUFBUSxFQUFFLGNBQWMsRUFBZ0IsTUFBTSxFQUFFLFlBQVksRUFDeEosTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFHekUsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsMkJBQTJCLEVBQTZCLFNBQVMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzNJLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNsRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN2RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUcvRDtJQTZJSSwrQkFDWSxRQUFrQixFQUNsQixHQUFtQixFQUNSLEVBQXFCLEVBQ2hD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Ozs7OztJQUN6QyxvREFBcUM7O0lBeXdDckMsd0RBcUJDOzs7OztJQTV4Q0cseUNBQTBCOzs7OztJQUMxQixvQ0FBMkI7O0lBQzNCLG1DQUF3Qzs7Ozs7SUFDeEMsbUNBQTZCOzs7OztJQUFFLG1DQUFzQiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBmaXJzdCwgc3dpdGNoTWFwLCBkZWxheSwgZGVib3VuY2VUaW1lLCB0YXAsIHRha2VVbnRpbCwgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIGludGVydmFsLCBvZiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgUmVzaXplT2JzZXJ2ZXIgZnJvbSAncmVzaXplLW9ic2VydmVyLXBvbHlmaWxsJztcclxuLypcclxuICogQEF1dGhvcjog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBARGF0ZTogMjAxOS0wOC0xMiAwNzo0NzoxMlxyXG4gKiBATGFzdEVkaXRvcnM6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0VGltZTogMjAxOS0xMS0yNiAxMDoyMToyNVxyXG4gKiBAUVE6IDEwNTU4MTgyMzlcclxuICogQFZlcnNpb246IHYwLjAuMVxyXG4gKi9cclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBSZW5kZXJlcjIsXHJcbiAgICBFbGVtZW50UmVmLCBPbkRlc3Ryb3ksIENoYW5nZURldGVjdG9yUmVmLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLFxyXG4gICAgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgTmdab25lLCBJbmplY3RvciwgZm9yd2FyZFJlZiwgSW5qZWN0LCBPcHRpb25hbCwgQXBwbGljYXRpb25SZWYsIEhvc3RMaXN0ZW5lciwgT3V0cHV0LCBFdmVudEVtaXR0ZXJcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7IERhdGFncmlkRmFjYWRlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2RhdGFncmlkLWZhY2FkZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU2Nyb2xsYmFyRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vc2Nyb2xsYmFyL3Njcm9sbGJhci5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBDb2x1bW5Hcm91cCB9IGZyb20gJy4uLy4uL3R5cGVzJztcclxuaW1wb3J0IHsgU2VsZWN0ZWRSb3csIERhdGFSZXN1bHQsIFJPV19JTkRFWF9GSUVMRCwgSVNfR1JPVVBfUk9XX0ZJRUxELCBHUk9VUF9ST1dfRklFTEQsIElTX0dST1VQX0ZPT1RFUl9ST1dfRklFTEQgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zdGF0ZSc7XHJcbmltcG9ydCB7IFNDUk9MTF9YX0FDVElPTiwgU0NST0xMX1lfQUNUSU9OLCBTQ1JPTExfWF9SRUFDSF9TVEFSVF9BQ1RJT04sIFNDUk9MTF9YX1JFQUNIX0VORF9BQ1RJT04sIFRSX1BSRUZJWCB9IGZyb20gJy4uLy4uL3R5cGVzL2NvbnN0YW50JztcclxuaW1wb3J0IHsgRGF0YWdyaWRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZGF0YWdyaWQuc2VydmljZSc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZGF0YWdyaWQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgRm9ybWF0Q2VsbERhdGFQaXBlIH0gZnJvbSAnLi4vLi4vdXRpbHMvZm9ybWF0LWNlbGwtZGF0YS5waXBlJztcclxuaW1wb3J0IHsgQ29sdW1uRm9ybWF0U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL2NvbHVtbic7XHJcbmltcG9ydCB7IENvbnRleHRNZW51SXRlbSB9IGZyb20gJ0BmYXJyaXMvdWktY29udGV4dC1tZW51JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdkYXRhZ3JpZC1ib2R5JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9ib2R5LmNvbXBvbmVudC5odG1sJyxcclxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhZ3JpZEJvZHlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkIHtcclxuICAgIC8vIOiHquWKqOmrmOW6puaXtu+8jOemgeeUqOe6teWQkea7muWKqOadoVxyXG4gICAgcHNDb25maWcgPSB7IHN3aXBlRWFzaW5nOiBmYWxzZSwgbWluU2Nyb2xsYmFyTGVuZ3RoOiAxNSwgaGFuZGxlcnM6IFsnY2xpY2stcmFpbCcsICdkcmFnLXRodW1iJywgJ3doZWVsJywgJ3RvdWNoJ10sIHN1cHByZXNzU2Nyb2xsWTogdGhpcy5kZy5hdXRvSGVpZ2h0IH07XHJcblxyXG4gICAgdG9wOiBudW1iZXI7XHJcbiAgICBoZWlnaHQ6IG51bWJlcjtcclxuICAgIHdpZHRoOiBudW1iZXI7XHJcbiAgICBjb2xzV2lkdGg6IG51bWJlcjtcclxuICAgIHRvdGFsV2lkdGg6IG51bWJlcjtcclxuICAgIGxlZnRGaXhlZFdpZHRoOiBudW1iZXI7XHJcbiAgICByaWdodEZpeGVkV2lkdGg6IG51bWJlcjtcclxuICAgIHJvd0hlaWdodDogbnVtYmVyO1xyXG4gICAgYm9keVN0eWxlOiBhbnk7XHJcbiAgICBzY3JvbGxUb3AgPSAwO1xyXG4gICAgc2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBkZWx0YVRvcEhlaWdodCA9IDA7XHJcbiAgICAvLyB3aGVlbEhlaWdodCA9IDA7XHJcbiAgICB3aGVlbFdpZHRoID0gMDtcclxuICAgIHByaXZhdGUgX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gMDtcclxuICAgIGdldCBmaXhlZFJpZ2h0U2Nyb2xsTGVmdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQ7XHJcbiAgICB9XHJcbiAgICBzZXQgZml4ZWRSaWdodFNjcm9sbExlZnQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQgPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgbWF4U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBzaG93UmlnaHRTaGFkb3cgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGZvb3RlckhlaWdodCA9IDA7XHJcbiAgICBASW5wdXQoKSBjYW52YXNXaWR0aDtcclxuICAgIEBJbnB1dCgpIGNvbHVtbnNHcm91cDogQ29sdW1uR3JvdXA7XHJcbiAgICAvLyDomZrmi5/liqDovb1cclxuICAgIEBJbnB1dCgpIHRvcEhpZGVIZWlnaHQgPSAwO1xyXG4gICAgQElucHV0KCkgYm90dG9tSGlkZUhlaWdodCA9IDA7XHJcblxyXG4gICAgQElucHV0KCkgc3RhcnRSb3dJbmRleCA9IDA7XHJcbiAgICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcblxyXG4gICAgQE91dHB1dCgpIGRhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQElucHV0KCkgc2Nyb2xsQmFyTW9kZSA9ICdhdXRvJztcclxuICAgIEBJbnB1dCgpIGNvbnRleHRNZW51SXRlbXM6IENvbnRleHRNZW51SXRlbVtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGNoZWNrZWRSb3dzID0gW107XHJcblxyXG4gICAgLyoqIOaAp+iDveS8mOWMlueJiO+8jOm7mOiupOS4uiBmYWxzZSAqL1xyXG4gICAgQElucHV0KCkgZmFzdCA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICBAVmlld0NoaWxkKCdwcycpIHBzPzogU2Nyb2xsYmFyRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpblJvd3MnKSB0YWJsZVJvd3NDbXA6IGFueTtcclxuICAgIEBWaWV3Q2hpbGQoJ3JpZ2h0Um93cycpIHJpZ2h0Um93c0NtcDogYW55O1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRMZWZ0JykgZml4ZWRMZWZ0RWw6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdmaXhlZFJpZ2h0JykgZml4ZWRSaWdodEVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpbicpIG1haW5BcmVhOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgndmlld1Njcm9sbENvbnRhaW5lcicpIHZpZXdTY3JvbGxDb250YWluZXI6IEVsZW1lbnRSZWY7XHJcblxyXG5cclxuICAgIHZpc2libGVDb250ZXh0TWVudXMgPSBbXTtcclxuXHJcbiAgICBjdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgcHJpdmF0ZSBfaG92ZXJSb3dJbmRleCA9IC0xO1xyXG4gICAgZ2V0IGhvdmVyUm93SW5kZXgoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faG92ZXJSb3dJbmRleDtcclxuICAgIH1cclxuICAgIHNldCBob3ZlclJvd0luZGV4KHJvd0lkeDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5faG92ZXJSb3dJbmRleCA9IHJvd0lkeDtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgc2VsZWN0ZWRSb3dzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRnLnNlbGVjdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBncmlkU2l6ZVN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjb2x1bW5SZXNpemVTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgb25EYXRhU291cmNlQ2hhbmdlU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHNlbGVjdFJvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSB1bnNlbGVjdFJvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RBbGxTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2hlY2tSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb25zU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNoZWNrQWxsU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHVuY2hlY2tSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2xlYXJDaGVja2Vkc1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAgIHByaXZhdGUgc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG5cclxuICAgIHB1YmxpYyBkZnM6IERhdGFncmlkRmFjYWRlU2VydmljZTtcclxuICAgIHB1YmxpYyBkZ3M6IERhdGFncmlkU2VydmljZTtcclxuICAgIHB1YmxpYyBuZ1pvbmU6IE5nWm9uZTtcclxuICAgIHB1YmxpYyByZW5kZXI6IFJlbmRlcmVyMjtcclxuXHJcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIHByaXZhdGUgdmlld3BvcnRIO1xyXG4gICAgdmlld3BvcnRXO1xyXG4gICAgY2FudmFzSGVpZ2h0O1xyXG4gICAgcHJpdmF0ZSBtaW5Sb3dCdWZmZXIgPSAzO1xyXG4gICAgcHJpdmF0ZSB2U2Nyb2xsRGlyID0gMTtcclxuICAgIHByaXZhdGUgcm93c0NhY2hlID0ge307XHJcbiAgICBwcml2YXRlIGxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICBwcml2YXRlIGxhc3RSZW5kZXJlZFNjcm9sbExlZnQgPSAwO1xyXG4gICAgcHJldlNjcm9sbFRvcCA9IDA7XHJcbiAgICBwcmV2U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICByb3dzID0gW107XHJcbiAgICBibGFua1RvcEhlaWdodCA9IDA7XHJcbiAgICBibGFua0JvdHRvbUhlaWdodCA9IDA7XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICBnZXQgc2Nyb2xsYmFyWEhlaWdodCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kZyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaCA9IHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10gPyAyMiA6IDA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJZQWN0aXZlJ10gJiYgaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGggKyAxODsgLy8gKyAodGhpcy5kZy5zaG93U2Nyb2xsQXJyb3cgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWUFjdGl2ZSddID8gMTggOiAwKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgc2Nyb2xsYmFyWVdpZHRoKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRnICYmIHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMuaW5zdGFuY2VbJ3Njcm9sbGJhcllBY3RpdmUnXSAmJiB0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2VsbENvbnRlbnRGb3JtYXR0ZXI6IEZvcm1hdENlbGxEYXRhUGlwZSA9IG51bGw7XHJcblxyXG4gICAgLy8g5b2T5ZCv55So5aSa6YCJ5LiU5YWB6K645aSa6YCJ5Lit77yM5YiX6KGo5LiN6IO957yW6L6R5pe277yM5Y+W6YCJ5Lit5ZCO56aB5q2i6Kem5Y+RYm9keSDnmoRjbGljayDkuovku7ZcclxuICAgIHByaXZhdGUgX190cmlnZ2VyQm9keUNsaWNrRXZlbnQgPSB0cnVlO1xyXG4gICAgcHJpdmF0ZSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIF9vbk1vdXNlQ2xpY2sgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBfc2Nyb2xsVGltZXI6IGFueSA9IDA7XHJcbiAgICBwcml2YXRlIF9zY3JvbGxYVGltZXI6IGFueSA9IDA7XHJcbiAgICBwcml2YXRlIHJvOiBSZXNpemVPYnNlcnZlciB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSByZXNpemVPYnNlcnZlclRpbWVyOiBhbnkgPSAwO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnQsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZWw6IEVsZW1lbnRSZWZcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZGZzID0gdGhpcy5pbmplY3Rvci5nZXQoRGF0YWdyaWRGYWNhZGVTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmRncyA9IHRoaXMuaW5qZWN0b3IuZ2V0KERhdGFncmlkU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1uRm9ybWF0U2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KENvbHVtbkZvcm1hdFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuY2VsbENvbnRlbnRGb3JtYXR0ZXIgPSBuZXcgRm9ybWF0Q2VsbERhdGFQaXBlKGNvbHVtbkZvcm1hdFNlcnZpY2UsIHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RlblN1YmplY3RzKCk7XHJcbiAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZSA9IHRoaXMucHM7XHJcbiAgICAgICAgY29uc3QgczEgPSB0aGlzLmRncy5zaG93R3JpZEhlYWRlci5zdWJzY3JpYmUoaGVhZGVySGVpZ2h0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKGhlYWRlckhlaWdodCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEpO1xyXG5cclxuICAgICAgICBjb25zdCBzMTAgPSB0aGlzLmRncy5mb290ZXJQb3NpdGlvbkNoYW5nZWQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEwKTtcclxuXHJcbiAgICAgICAgY29uc3QgczIgPSB0aGlzLmRncy5yb3dIZWlnaHRDaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMyKTtcclxuXHJcbiAgICAgICAgY29uc3QgczMgPSB0aGlzLmRmcy5jbGllbnRTb3J0JC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmRnLmNvbHVtblNvcnRlZC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczMpO1xyXG5cclxuICAgICAgICBjb25zdCBzNSA9IHRoaXMuZGcuZGdzLmNvbHVtbnNDaGFuZ2VkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlbGF5KDEwMClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUuc2Nyb2xsVG9MZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxUbygwLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9MZWZ0KDAsIDEwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzNSk7XHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbk1vdXNlQ2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uTW91c2VDbGljayhlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRhaW5lclNpemUoaGVhZGVySGVpZ2h0PzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaGggPSBoZWFkZXJIZWlnaHQgfHwgdGhpcy5kZy5yZWFsSGVhZGVySGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5kZy5oZWlnaHQgLSB0aGlzLnRvcDtcclxuICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRmcy5zZXRDdXJyZW50UGFnZURhdGEoY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpc0RpZmZyZW50RGF0YVNvdXJjZSA9ICEhY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZS5tYXAobiA9PiBuLmlkKS5maWx0ZXIobiA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWNoYW5nZXMuZGF0YS5wcmV2aW91c1ZhbHVlLmZpbmQocCA9PiBwLmlkID09PSBuKVxyXG4gICAgICAgICAgICB9KS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm9uRGF0YUNoYW5nZWQoaXNEaWZmcmVudERhdGFTb3VyY2UpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlIHx8ICFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcCh0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLmZvb3RlckhlaWdodCAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLmZvb3RlckhlaWdodC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMuc2Nyb2xsQmFyTW9kZSAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLnNjcm9sbEJhck1vZGUuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJZQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSB0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ICs9IDIyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zaG93U2Nyb2xsQXJyb3cgJiYgIWNoYW5nZXMuc2hvd1Njcm9sbEFycm93LmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnBzICYmIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICAgICAgICB0aGlzLmNlbGxDb250ZW50Rm9ybWF0dGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lTdWJzY3JpcHRpb25zKCk7XHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbk1vdXNlQ2xpY2spO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5ybykge1xyXG4gICAgICAgICAgICB0aGlzLnJvLnVub2JzZXJ2ZSh0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMucm8uZGlzY29ubmVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIHRoaXMucm8gPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZU9ic2VydmVyVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlclRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UsIHJpZ2h0V2lkdGg6IHRoaXMucmlnaHRGaXhlZFdpZHRoIH0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnJvLm9ic2VydmUodGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFBvc2l0aW9uVG9wKGhlYWRlckhlaWdodDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy50b3AgPSBoZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgaWYgKCh0aGlzLmRnLmVuYWJsZUZpbHRlclJvdyB8fCB0aGlzLmRnLmVuYWJsZVNtYXJ0RmlsdGVyKSAmJiB0aGlzLmRnLnNob3dGaWx0ZXJCYXIpIHtcclxuICAgICAgICAgICAgdGhpcy50b3AgKz0gdGhpcy5kZy5maWx0ZXJCYXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Um93R3JvdXBQYW5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvcCArPSB0aGlzLmRnLnJvd0dyb3VwUGFuZWxIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Rm9vdGVyICYmICh0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAndG9wJyB8fCB0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9wICs9IHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrU2Nyb2xsYmFyUG9zaXRpb24odG9Ub3AgPSBmYWxzZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5kZy5kYXRhIHx8ICF0aGlzLmRnLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsQmFyOiBhbnkgPSB0aGlzLnBzLmluc3RhbmNlO1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbEVsUmVmID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgLy8gc2Nyb2xsQmFyLnVwZGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGxhc3RTY3JvbGxMZWZ0ID0gc2Nyb2xsQmFyID8gc2Nyb2xsQmFyLmxhc3RTY3JvbGxMZWZ0IDogMDtcclxuICAgICAgICBjb25zdCBsYXN0U2Nyb2xsVG9wID0gc2Nyb2xsQmFyID8gc2Nyb2xsQmFyLmxhc3RTY3JvbGxUb3AgOiAwO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBsYXN0U2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICAvLyBjb25zdCBsYXN0U2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbEVsUmVmLnNjcm9sbFRvcDtcclxuICAgICAgICBjb25zdCBzY3JvbGxMZWZ0ID0gc2Nyb2xsRWxSZWYuc2Nyb2xsTGVmdDtcclxuXHJcbiAgICAgICAgaWYgKCF0b1RvcCkge1xyXG4gICAgICAgICAgICBpZiAoc2Nyb2xsVG9wICE9IGxhc3RTY3JvbGxUb3ApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AobGFzdFNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbFRvcCwgU0NST0xMX1lfQUNUSU9OKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxUb3AsIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBsYXN0U2Nyb2xsTGVmdDtcclxuICAgICAgICBpZiAoc2Nyb2xsTGVmdCAhPSBsYXN0U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvWChsYXN0U2Nyb2xsTGVmdCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsTGVmdCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAobGFzdFNjcm9sbExlZnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsTGVmdCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaVsOaNruWPkeeUn+WPmOWMlu+8jOmHjeaWsOWKoOi9veaVsOaNruaXtuaJp+ihjFxyXG4gICAgICog6YeN572u5rua5Yqo5p2h5L2N572uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25EYXRhQ2hhbmdlZChpc0RpZmZyZW50RGF0YVNvdXJjZSA9IHRydWUpIHtcclxuICAgICAgICB0aGlzLmRnLnNldFBhZ2VySGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy52aWV3cG9ydEggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB1cGRhdGU6XHJcbiAgICAgICAgICogbm9kZV9tb2R1bGVzXFxwZXJmZWN0LXNjcm9sbGJhclxcdHlwZXNcXHBlcmZlY3Qtc2Nyb2xsYmFyLmQudHNcclxuICAgICAgICAgKiBsYXN0U2Nyb2xsVG9wOiBudW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmICF0aGlzLmRnLmlzRWRpdGluZygpICYmICF0aGlzLmRnLmNsaWVudEZpbHRlckNoYW5nZWQgJiYgIXRoaXMuZGcuYXV0b0hlaWdodCApIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb0xlZnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucm93c0NhY2hlID0ge307XHJcbiAgICAgICAgY29uc3Qga2VlcHNjcm9sbFBvcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsSW5mbyA9IHRoaXMuZGcuZGZzLmdldFN0YXRlKCkuc2Nyb2xsSW5mbztcclxuICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxJbmZvLnkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHNjcm9sbEluZm8ueTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWShzY3JvbGxJbmZvLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLnksIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8ueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHNjcm9sbEluZm8ueDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWChzY3JvbGxJbmZvLngpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLngsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAga2VlcHNjcm9sbFBvcygpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpOyAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNEaWZmcmVudERhdGFTb3VyY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5pbml0U2VsZWN0T3JDaGVja2VkKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5yZWZyZXNoU2VsZWN0ZWREYXRhKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGcuY2xpZW50RmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZS5lbWl0KHRoaXMuZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZXN0cm95U3Vic2NyaXB0aW9ucygpIHtcclxuICAgICAgICBpZiAodGhpcy5zdWJzY3JpcHRpb25zICYmIHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goKHN1YjogU3Vic2NyaXB0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ViKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsaXN0ZW5TdWJqZWN0cygpIHtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lTdWJzY3JpcHRpb25zKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZ3JpZFNpemVTdWJzY3JpYmUgPSB0aGlzLmRmcy5ncmlkU2l6ZSQucGlwZShcclxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXHJcbiAgICAgICAgKS5waXBlKFxyXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUoNTApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoc3RhdGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2V0UGFnZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhoID0gdGhpcy5kZy5zZXRIZWFkZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gc3RhdGUuaGVpZ2h0IC0gdGhpcy50b3A7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkV2lkdGggPSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IE1hdGguZmxvb3Ioc3RhdGUud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb3dIZWlnaHQgPSBzdGF0ZS5yb3dIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggLT0gMjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0VyA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0SCA9IHRoaXMuZ2V0Vmlld1BvcnRIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zR3JvdXAgPSBzdGF0ZS5jb2x1bW5zR3JvdXA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZXRGaXhlZFJpZ2h0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUoc3RhdGUuY29sdW1uc0dyb3VwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2hvd0ZpeGVkU2hhZG93LmVtaXQoeyBzaG93UmlnaHRTaGFkb3c6IHRoaXMuc2hvd1JpZ2h0U2hhZG93LCB4OiB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Njcm9sbFhUaW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fc2Nyb2xsWFRpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsWFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rZWVwU2Nyb2xsYmFyUG9zaXRpb24ob2xkV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Njcm9sbFhUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rZWVwU2Nyb2xsYmFyUG9zaXRpb24ob2xkV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsQmFyTW9kZSA9PT0gJ2FsbHdheXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kZy5zaG93U2Nyb2xsQXJyb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnNjcm9sbGJhclVwZGF0ZS5lbWl0KHsgc2Nyb2xsYmFyUmVmOiB0aGlzLnBzLmluc3RhbmNlLCByaWdodFdpZHRoOiB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmdyaWRTaXplU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb2x1bW5SZXNpemVTdWJzY3JpYmUgPSB0aGlzLmRmcy5jb2x1bW5SZXNpemUkLnN1YnNjcmliZSgoY2c6IENvbHVtbkdyb3VwKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uU2l6ZShjZyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY29sdW1uUmVzaXplU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3Muc2V0U2VsZWNlZFJvdy5zdWJzY3JpYmUoKHI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHIuaWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0Um93U3Vic2NyaWJlID0gdGhpcy5kZnMuc2VsZWN0Um93JC5zdWJzY3JpYmUoKHJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJvdykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSByb3cuaWQ7XHJcbiAgICAgICAgICAgICAgICAvLyAyMDIxMDgxNyDmlrnlkJHplK7np7vliqjlkI7liLfmlrDop4blm77nirbmgIFcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5zZWxlY3RSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2VsZWN0Um93U3Vic2NyaWJlID0gdGhpcy5kZnMudW5TZWxlY3RSb3ckLnN1YnNjcmliZSgocHJldlJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgaWYgKHByZXZSb3cgJiYgcHJldlJvdy5pZCA9PT0gdGhpcy5jdXJyZW50Um93SWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RlZFJvdyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5lZGl0YWJsZSAmJiB0aGlzLmRnLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9fdHJpZ2dlckJvZHlDbGlja0V2ZW50ID0gdGhpcy5kZy5zZWxlY3Rpb25Nb2RlID09PSAnZGVmYXVsdCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMudW5zZWxlY3RSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdEFsbFN1YnNjcmliZSA9IHRoaXMuZGZzLnNlbGVjdEFsbCQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuc2VsZWN0QWxsLmVtaXQocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuc2VsZWN0QWxsU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja1Jvd1N1YnNjcmliZSA9IHRoaXMuZGZzLmNoZWNrUm93JC5zdWJzY3JpYmUoKHJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy5jaGVja2VkLmVtaXQocm93KTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jaGVja1Jvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb25zU3Vic2NyaWJlID0gdGhpcy5kZnMuY2xlYXJTZWxlY3Rpb25zJC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuY2hlY2tPblNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRnLnVuU2VsZWN0QWxsLmVtaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMudW5jaGVja1Jvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnVuQ2hlY2tSb3ckLnN1YnNjcmliZSgocHJldlJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy51bkNoZWNrZWQuZW1pdChwcmV2Um93KTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy51bmNoZWNrUm93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja0FsbFN1YnNjcmliZSA9IHRoaXMuZGZzLmNoZWNrQWxsJC5zdWJzY3JpYmUoKHJvd3M6IFNlbGVjdGVkUm93W10pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy5jaGVja0FsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNoZWNrQWxsU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jbGVhckNoZWNrZWRzU3Vic2NyaWJlID0gdGhpcy5kZnMuY2xlYXJDaGVja2VkcyQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNlbGVjdE9uQ2hlY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZGcudW5DaGVja0FsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNsZWFyQ2hlY2tlZHNTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmRncy5zZXRTY3JvbGxiYXJQb3NpdGlvbi5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih0aGlzLnNjcm9sbExlZnQpO1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3MuY29sdW1uUmVzaXplZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8XHJcbiAgICAgICAgICAgICAgICAodGhpcy5kZy5jdXJyZW50Q2VsbCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmlzRWRpdGluZyAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY3VycmVudENlbGwuY29sdW1uLmVkaXRvciAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbi5lZGl0b3IudHlwZSA9PT0gJ3RleHRhcmVhJykpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyZG9tcyA9IHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZi1kYXRhZ3JpZC1ib2R5LXJvdzpub3QoZi1kYXRhZ3JpZC1mb290ZXItcm93KScpO1xyXG4gICAgICAgICAgICAgICAgdHJkb21zLmZvckVhY2gobiA9PiBuLnN0eWxlLmhlaWdodCA9ICdhdXRvJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHRySUQgPSAnJztcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93SWQgPSBlLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIHRySUQgPSBUUl9QUkVGSVggKyByb3dJZDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCh0cklEKTtcclxuICAgICAgICAgICAgICAgIC8vIHRyZG9tcy5mb3JFYWNoKG4gPT4gbi5zdHlsZS5oZWlnaHQgPSAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmhlYWRlcldyYXApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2V0SGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRmcy5jb2x1bW5SZXNpemVFbmQoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3MuY2VsbENvbnRlbnRXcmFwQ2hhbmdlZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5kZy5kZnMucm93VXBkYXRlJC5zdWJzY3JpYmUoKHJvdzogeyBpbmRleDogbnVtYmVyLCBkYXRhOiBhbnkgfSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocm93ICYmIHJvdy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkQ3VzdG9tQ2VsbFN0eWxlKHJvdyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm47ICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzY3JvbGxSZWFjaCA9IHRoaXMucHMuaW5zdGFuY2UucmVhY2g7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLndpZHRoIC0gb2xkV2lkdGg7XHJcbiAgICAgICAgbGV0IHNjcm9sbExlZnQgPSB0O1xyXG4gICAgICAgIGlmIChzY3JvbGxSZWFjaC54ID09PSAnc3RhcnQnIHx8ICF0aGlzLnBzLmluc3RhbmNlLmxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHNjcm9sbExlZnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvWCgwKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNjcm9sbFJlYWNoLnggPT09ICdlbmQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9SaWdodCgwKTtcclxuICAgICAgICAgICAgc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2Nyb2xsTGVmdCA9IHRoaXMucHMuaW5zdGFuY2UubGFzdFNjcm9sbExlZnQgLSB0O1xyXG4gICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oc2Nyb2xsTGVmdCk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbHVtblNpemUoY2c6IENvbHVtbkdyb3VwKSB7XHJcbiAgICAgICAgaWYgKGNnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1uc0dyb3VwID0gY2c7XHJcbiAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmxlZnRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMuY29sc1dpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGg7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLm1heFNjcm9sbExlZnQgPSB0aGlzLmNvbHNXaWR0aCArIHRoaXMubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vIGdyaWQg5a655Zmo5a695bqmXHJcbiAgICAgICAgICAgIGNvbnN0IGRnQ29udGFpbmVyV2lkdGggPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIC8vIOaJgOacieWIl+WuveS5i+WSjFxyXG4gICAgICAgICAgICBjb25zdCBhbGxDb2xzV2lkdGggPSBNYXRoLmZsb29yKHRoaXMuY29sdW1uc0dyb3VwLnRvdGFsV2lkdGgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICBpZiAoZGdDb250YWluZXJXaWR0aCA+IGFsbENvbHNXaWR0aCB8fCBkZ0NvbnRhaW5lcldpZHRoID09PSBhbGxDb2xzV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyDlj7Pkvqflm7rlrprliJfnmoTkvY3nva5cclxuICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLndpZHRoICArIHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWUFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvd1JpZ2h0U2hhZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggKz0gMTg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgLSB0aGlzLnJpZ2h0Rml4ZWRXaWR0aDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FudmFzV2lkdGggPiB0aGlzLnRvdGFsV2lkdGggJiYgdGhpcy5jYW52YXNXaWR0aCAtIHRoaXMudG90YWxXaWR0aCAgPCAxOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSAxODtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudG90YWxXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLnRvdGFsV2lkdGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJyAmJiAhdGhpcy5yaWdodFJvd3NDbXAgJiYgIXRoaXMuZGcudXNlQ29udHJvbFBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsV2lkdGggKz0gMTg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBwcml2YXRlIHNldEZpeGVkUmlnaHRQb3NpdGlvbigpIHtcclxuICAgIC8vICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLnJpZ2h0Rml4ZWRXaWR0aDtcclxuICAgIC8vICAgICB0aGlzLmxlZnRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAvLyAgICAgdGhpcy5jb2xzV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5ub3JtYWxXaWR0aDtcclxuXHJcbiAgICAvLyAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgIC8vICAgICB0aGlzLm1heFNjcm9sbExlZnQgPSB0aGlzLmNvbHNXaWR0aCArIHRoaXMubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAvLyAgICAgLy8gZ3JpZCDlrrnlmajlrr3luqZcclxuICAgIC8vICAgICBjb25zdCBkZ0NvbnRhaW5lcldpZHRoID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgLy8gICAgIC8vIOaJgOacieWIl+WuveS5i+WSjFxyXG4gICAgLy8gICAgIGNvbnN0IGFsbENvbHNXaWR0aCA9IE1hdGguZmxvb3IodGhpcy5jb2x1bW5zR3JvdXAudG90YWxXaWR0aCk7XHJcblxyXG5cclxuICAgIC8vICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAvLyAgICAgaWYgKGRnQ29udGFpbmVyV2lkdGggPiBhbGxDb2xzV2lkdGggfHwgZGdDb250YWluZXJXaWR0aCA9PT0gYWxsQ29sc1dpZHRoKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgIC8vICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgLy8gICAgICAgICAvLyDlj7Pkvqflm7rlrprliJfnmoTkvY3nva5cclxuICAgIC8vICAgICAgICAgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IHRoaXMud2lkdGggLSB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArIHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyB9XHJcblxyXG4gICAgcHJpdmF0ZSBidWlsZEN1c3RvbUNlbGxTdHlsZShyb3c6IHsgaW5kZXg6IG51bWJlciwgZGF0YTogYW55IH0pIHtcclxuXHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgcmlnaHRUcnMgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICBsZWZ0VHJzID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC1sZWZ0LXJvdycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHJzID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmYtZGF0YWdyaWQtYm9keS1yb3cnKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlQ2VsbFN0eWxlID0gKGFyciwgY29sLCBzdHlsZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGQgPSBhcnJbcm93LmluZGV4XS5xdWVyeVNlbGVjdG9yKGBbZmllbGQ9XCIke2NvbC5maWVsZH1cIl1gKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUoc3R5bGUsIHRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuZGcuZmxhdENvbHVtbnMuZm9yRWFjaChjb2wgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY29sLnN0eWxlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3JkID0gcm93LmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjcyA9IGNvbC5zdHlsZXIoX3JkW2NvbC5maWVsZF0sIF9yZCwgcm93LmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGlmIChjcyAmJiBPYmplY3Qua2V5cyhjcykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKGxlZnRUcnMsIGNvbCwgY3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdHlsZShyaWdodFRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKHRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrZWRSb3dzQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLmRncy5vbkNoZWNrZWRSb3dzQ291bnRDaGFuZ2UoKTtcclxuICAgICAgICBjb25zdCBjaGVja2VkUm93cyA9IHRoaXMuZGcuY2hlY2tlZHM7XHJcbiAgICAgICAgdGhpcy5kZy5jaGVja1ZhbHVlcyA9IGNoZWNrZWRSb3dzLm1hcChyID0+IHIuaWQpO1xyXG4gICAgICAgIHRoaXMuZGcuY2hlY2tWYWx1ZXNDaGFuZ2UuZW1pdCh0aGlzLmRnLmNoZWNrVmFsdWVzKTtcclxuICAgICAgICB0aGlzLmRnLmNoZWNrZWRDaGFuZ2UuZW1pdChjaGVja2VkUm93cyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRUckRvbUhlaWdodCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgdHJkb21zID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodEVsKSB7XHJcbiAgICAgICAgICAgIHJpZ2h0VHJzID0gdGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0cicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgbGVmdFRycyA9IHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZml4ZWQtbGVmdC1yb3cnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgIHRyZG9tcyA9IHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0ci5mLWRhdGFncmlkLWJvZHktcm93Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKCh0ciwgaSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdDEgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCB0MiA9IE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICBsZXQgdDMgPSAwO1xyXG4gICAgICAgICAgICBpZiAobGVmdFRycyAmJiBsZWZ0VHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdDEgPSBNYXRoLmNlaWwobGVmdFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocmlnaHRUcnMgJiYgcmlnaHRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0MyA9IE1hdGguY2VpbChyaWdodFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBfaCA9IE1hdGgubWF4KHQxLCB0MiwgdDMsIHRoaXMuZGcucm93SGVpZ2h0KTtcclxuICAgICAgICAgICAgbGlzdC5wdXNoKF9oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuICAgIC8qKiDlhYHorrjmlbDmja7mipjooYzml7bvvIzorqHnrpfooYzlj7fnmoTooYzpq5ggKi9cclxuICAgIHVwZGF0ZVJvd0hlaWdodCh0ckRvbUlkID0gbnVsbCkge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5mYXN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoIXRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZGdCb2R5ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5mLWRhdGFncmlkLWJvZHknKTtcclxuICAgICAgICBpZiAoZGdCb2R5KSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5ub3dyYXAgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhkZ0JvZHksICdkYXRhLXdyYXAnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKGRnQm9keSwgJ2RhdGEtd3JhcCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY3NzVGV4dEFyciA9IFtdO1xyXG5cclxuICAgICAgICBpZiAoIXRyRG9tSWQpIHtcclxuICAgICAgICAgICAgdGhpcy5yb3dzLmZvckVhY2goKHIsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJvd0lkID0gdGhpcy5kZnMucHJpbWFyeUlkKHIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJJRCA9IFRSX1BSRUZJWCArIHJvd0lkO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVmdFRySWQgPSB0cklEICsgJ19maXhlZGxlZnQnO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmlnaHRUcklkID0gdHJJRCArICdfZml4ZWRyaWdodCc7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5nZXRUckRvbUhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGggPSBsaXN0W2ldO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHtsZWZ0VHJJZH17IGhlaWdodDogJHtofXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHt0cklEfXsgaGVpZ2h0OiAke2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke3JpZ2h0VHJJZH17IGhlaWdodDogJHtofXB4IH1gKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtsZWZ0VHJJZH17IGhlaWdodDogJHtsaXN0W2ldfXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3RySUR9eyBoZWlnaHQ6ICR7bGlzdFtpXX1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7bGlzdFtpXX1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5MSA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtsZWZ0VHJJZH1gO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleTIgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7dHJJRH1gO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleTMgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7cmlnaHRUcklkfWA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnJlbW92ZUNzc1J1bGUoa2V5MSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MucmVtb3ZlQ3NzUnVsZShrZXkyKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5yZW1vdmVDc3NSdWxlKGtleTMpO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRncy5hcHBlbmRDc3NSdWxlcyhjc3NUZXh0QXJyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjc3NUZXh0QXJyID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IGRvbVNlbCA9ICcjJyArIHRyRG9tSWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IF9hcnIgPSBbXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodEVsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBydHIgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tU2VsKTtcclxuICAgICAgICAgICAgICAgIGlmIChydHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfYXJyLnB1c2goTWF0aC5jZWlsKHJ0ci5vZmZzZXRIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGx0ciA9IHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKGRvbVNlbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobHRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fyci5wdXNoKE1hdGguY2VpbChsdHIub2Zmc2V0SGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ciA9IHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKGRvbVNlbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfYXJyLnB1c2goTWF0aC5jZWlsKHRyLm9mZnNldEhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBfaCA9IE1hdGgubWF4KC4uLl9hcnIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbGVmdFRySWQgPSB0ckRvbUlkICsgJ19maXhlZGxlZnQnO1xyXG4gICAgICAgICAgICBjb25zdCByaWdodFRySWQgPSB0ckRvbUlkICsgJ19maXhlZHJpZ2h0JztcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke19ofXB4O31gKTtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke3RyRG9tSWR9eyBoZWlnaHQ6ICR7X2h9cHg7fWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7cmlnaHRUcklkfXsgaGVpZ2h0OiAke19ofXB4O31gKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7bGVmdFRySWR9eyBoZWlnaHQ6ICR7X2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHt0ckRvbUlkfXsgaGVpZ2h0OiAke19ofXB4IH1gKTtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7cmlnaHRUcklkfXsgaGVpZ2h0OiAke19ofXB4IH1gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5kZ3MuYXBwZW5kQ3NzUnVsZXMoY3NzVGV4dEFycik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xyXG5cclxuICAgICAgICAvLyDnp7vpmaRoZWlnaHQ6IGF1dG9cclxuICAgICAgICBjb25zdCB0cmRvbXMgPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmYtZGF0YWdyaWQtYm9keS1yb3c6bm90KGYtZGF0YWdyaWQtZm9vdGVyLXJvdyknKTtcclxuICAgICAgICB0cmRvbXMuZm9yRWFjaChuID0+IG4uc3R5bGUuaGVpZ2h0ID0gJycpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuY2RbJ2Rlc3Ryb3llZCddKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2V0Qm9keVN0eWxlKCkge1xyXG4gICAgICAgIGxldCBoID0gdGhpcy5nZXRWaWV3UG9ydEhlaWdodCgpO1xyXG4gICAgICAgIGlmICghdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBoID0gdGhpcy5kZy5lbXB0eURhdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmZvb3RlckRhdGEgJiYgdGhpcy5kZy5zaG93Rm9vdGVyKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZmQgPSB0aGlzLmRnLmZvb3RlckRhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJEYXRhLnN1YnNjcmliZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZkID0gdGhpcy5kZy5mb290ZXJEYXRhWyd2YWx1ZSddO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmZCAmJiBBcnJheS5pc0FycmF5KGZkKSAmJiBmZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ2JvdGgnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSBoIC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0Zvb3RlciAmJiB0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpIHtcclxuICAgICAgICAgICAgICAgIGggPSBoIC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaGVpZ2h0OiBgJHtNYXRoLmZsb29yKGgpfXB4YFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVTY3JvbGxQb3NpdGlvbihzY3JvbGxMZWZ0OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy53aWR0aCAtIHRoaXMucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID09PSB0aGlzLm1heFNjcm9sbExlZnQgfHwgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA+IHRoaXMubWF4U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuc2Nyb2xsTGVmdH1weCwgMHB4LCAwcHgpYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuZml4ZWRSaWdodFNjcm9sbExlZnR9cHgsIDBweCwgMHB4KWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNjcm9sbFRvWCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICB0aGlzLmRncy5zaG93Rml4ZWRTaGFkb3cuZW1pdCh7IHNob3dSaWdodFNoYWRvdzogdGhpcy5zaG93UmlnaHRTaGFkb3csIHg6IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TY3JvbGxUb1koJGV2ZW50OiBhbnkpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbFRpbWVyKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9zY3JvbGxUaW1lcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zY3JvbGxUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB5ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy52aXJ0dWFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTY3JvbGwoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSB5O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kZy5zY3JvbGxZLmVtaXQoeSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh5LCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Qc1hSZWFjaFN0YXJ0KCRldmVudDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgeCA9ICRldmVudC50YXJnZXQuc2Nyb2xsTGVmdDtcclxuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHgpO1xyXG4gICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh4LCBTQ1JPTExfWF9SRUFDSF9TVEFSVF9BQ1RJT04pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUHNYUmVhY2hFbmQoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgLy8gdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAvLyAvLyB0aGlzLmRncy5vblNob3dGaXhlZFNoYWRvdyh0aGlzLnNob3dSaWdodFNoYWRvdyk7XHJcbiAgICAgICAgLy8gdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKHgsIFNDUk9MTF9YX1JFQUNIX0VORF9BQ1RJT04pO1xyXG4gICAgfVxyXG5cclxuICAgIGlzQ2hlY2tlZChyb3dEYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAocm93RGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZnMuaXNSb3dDaGVja2VkKHJvd0RhdGFbdGhpcy5kZy5pZEZpZWxkXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpc1NlbGVjdGVkKHJvd0RhdGE6IGFueSkge1xyXG4gICAgICAgIGlmIChyb3dEYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRmcy5pc1Jvd1NlbGVjdGVkKHJvd0RhdGFbdGhpcy5kZy5pZEZpZWxkXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVHcm91cFJvdyhyb3csIG9wZW4gPSB0cnVlKSB7XHJcbiAgICAgICAgcm93LmV4cGFuZGVkID0gb3BlbjtcclxuICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgLyoqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IOWIhiA9PT09PT0g6ZqUID09PT09PSDnur8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuXHJcbiAgICAvKiog6I635Y+W5Y+v6KeG5Yy65Z+f6auY5bqmICovXHJcbiAgICBwcml2YXRlIGdldFZpZXdQb3J0SGVpZ2h0KCkge1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEhlaWdodCA9IHRoaXMuZGcuaGVpZ2h0O1xyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dIZWFkZXIpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgPSB2aWV3UG9ydEhlaWdodCAtIHRoaXMuZGcucmVhbEhlYWRlckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgodGhpcy5kZy5lbmFibGVGaWx0ZXJSb3cgfHwgdGhpcy5kZy5lbmFibGVTbWFydEZpbHRlcikgJiYgdGhpcy5kZy5zaG93RmlsdGVyQmFyKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0IC09IHRoaXMuZGcuZmlsdGVyQmFySGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd1Jvd0dyb3VwUGFuZWwpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgLT0gdGhpcy5kZy5yb3dHcm91cFBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0Zvb3RlciAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnBhZ2luYXRpb24pIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgPSB2aWV3UG9ydEhlaWdodCAtIHRoaXMuZGcucGFnZXJIZWlnaHQgLSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCAtPSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy52aWV3cG9ydEggPSB2aWV3UG9ydEhlaWdodDtcclxuICAgICAgICByZXR1cm4gdmlld1BvcnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5LiN5oqY6KGM5pe277yM5omA5pyJ5pWw5o2u55qE6auY5bqmXHJcbiAgICBwcml2YXRlIGFsbFJvd3NIZWlnaHQoKSB7XHJcbiAgICAgICAgY29uc3Qgcm93SGVpZ2h0cGF0Y2ggPSAxOyAgLy8gdGhpcy5kZy5hdXRvSGVpZ2h0ID8gMiA6IDE7XHJcbiAgICAgICAgY29uc3Qgcm93SGVpZ2h0ID0gdGhpcy5kZy5yb3dIZWlnaHQgKyByb3dIZWlnaHRwYXRjaDtcclxuXHJcbiAgICAgICAgbGV0IGl0ZW1zQ291bnQgPSAwO1xyXG4gICAgICAgIGlmICh0aGlzLmRnLmdyb3VwU3VtbWFyeVBvc2l0aW9uID09PSAnaW5Hcm91cFJvdycpIHtcclxuICAgICAgICAgICAgaXRlbXNDb3VudCA9IHRoaXMuZGF0YS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9mb290ZXJfXyddKS5sZW5ndGg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaXRlbXNDb3VudCA9IHRoaXMuZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaCA9IGl0ZW1zQ291bnQgKiByb3dIZWlnaHQ7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgaCArPSBpdGVtc0NvdW50O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGggKz0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBoO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q2FudmFzSGVpZ2h0KCkge1xyXG4gICAgICAgIGxldCBjYW52YXNIZWlnaHQgPSAwO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGF0YSB8fCAhdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IDA7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcubm93cmFwKSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuYWxsUm93c0hlaWdodCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0VHJEb21IZWlnaHQoKS5yZWR1Y2UoKHIsIGMpID0+IHIgKyBjLCAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghY2FudmFzSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMudmlld3BvcnRIO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FudmFzSGVpZ2h0ID0gY2FudmFzSGVpZ2h0ICsgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10gPyAxOCA6IDApO1xyXG5cclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IGNhbnZhc0hlaWdodDtcclxuICAgICAgICByZXR1cm4gY2FudmFzSGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUNhbnZhc0hlaWdodCgpIHtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2V0Um93RnJvbVBvc2l0aW9uKHkpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih5IC8gKHRoaXMuZGcucm93SGVpZ2h0ICsgMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFZpc2libGVSYW5nZSh2aWV3cG9ydFRvcD86IG51bWJlciwgdmlld3BvcnRMZWZ0PzogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0VG9wID09IG51bGwpIHtcclxuICAgICAgICAgICAgdmlld3BvcnRUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0TGVmdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZpZXdwb3J0TGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRvcDogdGhpcy5nZXRSb3dGcm9tUG9zaXRpb24odmlld3BvcnRUb3ApLFxyXG4gICAgICAgICAgICBib3R0b206IHRoaXMuZ2V0Um93RnJvbVBvc2l0aW9uKHZpZXdwb3J0VG9wICsgdGhpcy52aWV3cG9ydEgpICsgMSxcclxuICAgICAgICAgICAgbGVmdFB4OiB2aWV3cG9ydExlZnQsXHJcbiAgICAgICAgICAgIHJpZ2h0UHg6IHZpZXdwb3J0TGVmdCArIHRoaXMudmlld3BvcnRXXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJlbmRlcmVkUmFuZ2Uodmlld3BvcnRUb3A/OiBudW1iZXIsIHZpZXdwb3J0TGVmdD86IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2Uodmlld3BvcnRUb3AsIHZpZXdwb3J0TGVmdCk7XHJcbiAgICAgICAgY29uc3QgYnVmZmVyID0gTWF0aC5yb3VuZCh0aGlzLnZpZXdwb3J0SCAvICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgICAgICBjb25zdCBtaW5CdWZmZXIgPSB0aGlzLm1pblJvd0J1ZmZlcjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudlNjcm9sbERpciA9PSAtMSkge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gYnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy52U2Nyb2xsRGlyID09IDEpIHtcclxuICAgICAgICAgICAgcmFuZ2UudG9wIC09IG1pbkJ1ZmZlcjtcclxuICAgICAgICAgICAgcmFuZ2UuYm90dG9tICs9IGJ1ZmZlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gbWluQnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmFuZ2UudG9wID0gTWF0aC5tYXgoMCwgcmFuZ2UudG9wKTtcclxuICAgICAgICByYW5nZS5ib3R0b20gPSBNYXRoLm1pbih0aGlzLmRhdGEubGVuZ3RoIC0gMSwgcmFuZ2UuYm90dG9tKTtcclxuXHJcbiAgICAgICAgcmFuZ2UubGVmdFB4IC09IHRoaXMudmlld3BvcnRXO1xyXG4gICAgICAgIHJhbmdlLnJpZ2h0UHggKz0gdGhpcy52aWV3cG9ydFc7XHJcblxyXG4gICAgICAgIHJhbmdlLmxlZnRQeCA9IE1hdGgubWF4KDAsIHJhbmdlLmxlZnRQeCk7XHJcbiAgICAgICAgcmFuZ2UucmlnaHRQeCA9IE1hdGgubWluKHRoaXMuY2FudmFzV2lkdGgsIHJhbmdlLnJpZ2h0UHgpO1xyXG5cclxuICAgICAgICByZXR1cm4gcmFuZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJSb3dzKHJhbmdlKSB7XHJcbiAgICAgICAgY29uc3Qgcm93cyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGRhdGFMZW5ndGggPSB0aGlzLmRhdGEubGVuZ3RoO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gcmFuZ2UudG9wOyBpIDw9IHJhbmdlLmJvdHRvbTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJvd3NDYWNoZVtpXSB8fCAoaSA9PSBkYXRhTGVuZ3RoKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcm93cy5wdXNoKGkpO1xyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRlIGFuIGVudHJ5IHJpZ2h0IGF3YXkgc28gdGhhdCBhcHBlbmRSb3dIdG1sKCkgY2FuXHJcbiAgICAgICAgICAgIC8vIHN0YXJ0IHBvcHVsYXRhdGluZyBpdC5cclxuICAgICAgICAgICAgdGhpcy5yb3dzQ2FjaGVbaV0gPSB7XHJcbiAgICAgICAgICAgICAgICByb3dOb2RlOiBudWxsLFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENvbFNwYW5zIG9mIHJlbmRlcmVkIGNlbGxzIChieSBjb2x1bW4gaWR4KS5cclxuICAgICAgICAgICAgICAgIC8vIENhbiBhbHNvIGJlIHVzZWQgZm9yIGNoZWNraW5nIHdoZXRoZXIgYSBjZWxsIGhhcyBiZWVuIHJlbmRlcmVkLlxyXG4gICAgICAgICAgICAgICAgY2VsbENvbFNwYW5zOiBbXSxcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDZWxsIG5vZGVzIChieSBjb2x1bW4gaWR4KS4gIExhenktcG9wdWxhdGVkIGJ5IGVuc3VyZUNlbGxOb2Rlc0luUm93c0NhY2hlKCkuXHJcbiAgICAgICAgICAgICAgICBjZWxsTm9kZXNCeUNvbHVtbklkeDogW10sXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ29sdW1uIGluZGljZXMgb2YgY2VsbCBub2RlcyB0aGF0IGhhdmUgYmVlbiByZW5kZXJlZCwgYnV0IG5vdCB5ZXQgaW5kZXhlZCBpblxyXG4gICAgICAgICAgICAgICAgLy8gY2VsbE5vZGVzQnlDb2x1bW5JZHguICBUaGVzZSBhcmUgaW4gdGhlIHNhbWUgb3JkZXIgYXMgY2VsbCBub2RlcyBhZGRlZCBhdCB0aGVcclxuICAgICAgICAgICAgICAgIC8vIGVuZCBvZiB0aGUgcm93LlxyXG4gICAgICAgICAgICAgICAgY2VsbFJlbmRlclF1ZXVlOiBbXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcm93cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93c0NhY2hlW3Jvd3NbaV1dLnJvd05vZGUgPSB0aGlzLmRhdGFbcm93c1tpXV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5yb3dzQ2FjaGUpLm1hcChuID0+IHRoaXMucm93c0NhY2hlW25dLnJvd05vZGUpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZVJvd0Zyb21DYWNoZShyb3cpIHtcclxuICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gdGhpcy5yb3dzQ2FjaGVbcm93XTtcclxuICAgICAgICBpZiAoIWNhY2hlRW50cnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGVsZXRlIHRoaXMucm93c0NhY2hlW3Jvd107XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhbnVwUm93cyhyYW5nZVRvS2VlcCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnJvd3NDYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAoaSA8IHJhbmdlVG9LZWVwLnRvcCB8fCBpID4gcmFuZ2VUb0tlZXAuYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0Zyb21DYWNoZShpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYXNZU2Nyb2xsYmFyKHNob3dZc2Nyb2xsYmFyOiBib29sZWFuKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uU2l6ZSh0aGlzLmNvbHVtbnNHcm91cCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UgfSk7XHJcbiAgICAgICAgfSwgNjApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xpY2tTY3JvbGxBcnJvdygkZXZlbnQpIHtcclxuICAgICAgICBjb25zdCB7IGRpciwgZXZlbnQgfSA9ICRldmVudDtcclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdGhpcy5wcy5pbnN0YW5jZS5yZWFjaDtcclxuICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2goZGlyKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeCE9PSAnc3RhcnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0IC0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh4IT09ICdlbmQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ICsgNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndG9wJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeSAhPT0gJ3N0YXJ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgLSA0MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5ICE9PSAnZW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgKyA0MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyRGF0YShkZXRlY3RjaGFuZ2VzID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICBpZiAoIXRoaXMuZGcudmlydHVhbGl6ZWQgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMuZGF0YTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aXNpYmxlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWQgPSB0aGlzLmdldFJlbmRlcmVkUmFuZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSByb3dzIG5vIGxvbmdlciBpbiB0aGUgdmlld3BvcnRcclxuICAgICAgICAgICAgdGhpcy5jbGVhbnVwUm93cyhyZW5kZXJlZCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW5kZXIgbWlzc2luZyByb3dzXHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMucmVuZGVyUm93cyhyZW5kZXJlZCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRSb3dJbmRleCA9IHJlbmRlcmVkLnRvcDtcclxuICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG5cclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmJsYW5rVG9wSGVpZ2h0ID0gdGhpcy5zdGFydFJvd0luZGV4ICogKHRoaXMuZGcucm93SGVpZ2h0ICsgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuYmxhbmtCb3R0b21IZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCAtIHRoaXMuYmxhbmtUb3BIZWlnaHQgLSAodGhpcy5yb3dzLmxlbmd0aCAqICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ICs9IDIyO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgaWYgKGRldGVjdGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGFuZGxlU2Nyb2xsKCkge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVNjcm9sbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2hhbmRsZVNjcm9sbCgpIHtcclxuICAgICAgICBjb25zdCB2aWV3cG9ydENvbnRhaW5lciA9IHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIGxldCBtYXhTY3JvbGxEaXN0YW5jZVkgPSB2aWV3cG9ydENvbnRhaW5lci5zY3JvbGxIZWlnaHQgLSB2aWV3cG9ydENvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgbGV0IG1heFNjcm9sbERpc3RhbmNlWCA9IHZpZXdwb3J0Q29udGFpbmVyLnNjcm9sbFdpZHRoIC0gdmlld3BvcnRDb250YWluZXIuY2xpZW50V2lkdGg7XHJcblxyXG4gICAgICAgIC8vIFByb3RlY3QgYWdhaW5zdCBlcnJvbmVvdXMgY2xpZW50SGVpZ2h0L1dpZHRoIGdyZWF0ZXIgdGhhbiBzY3JvbGxIZWlnaHQvV2lkdGguXHJcbiAgICAgICAgLy8gU29tZXRpbWVzIHNlZW4gaW4gQ2hyb21lLlxyXG4gICAgICAgIG1heFNjcm9sbERpc3RhbmNlWSA9IE1hdGgubWF4KDAsIG1heFNjcm9sbERpc3RhbmNlWSk7XHJcbiAgICAgICAgbWF4U2Nyb2xsRGlzdGFuY2VYID0gTWF0aC5tYXgoMCwgbWF4U2Nyb2xsRGlzdGFuY2VYKTtcclxuXHJcbiAgICAgICAgLy8gQ2VpbGluZyB0aGUgbWF4IHNjcm9sbCB2YWx1ZXNcclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxUb3AgPiBtYXhTY3JvbGxEaXN0YW5jZVkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSBtYXhTY3JvbGxEaXN0YW5jZVk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNjcm9sbExlZnQgPiBtYXhTY3JvbGxEaXN0YW5jZVgpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gbWF4U2Nyb2xsRGlzdGFuY2VYO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdlNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbFRvcCAtIHRoaXMucHJldlNjcm9sbFRvcCk7XHJcbiAgICAgICAgY29uc3QgaFNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbExlZnQgLSB0aGlzLnByZXZTY3JvbGxMZWZ0KTtcclxuXHJcbiAgICAgICAgaWYgKGhTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgICAgICAvLyAkdmlld3BvcnRTY3JvbGxDb250YWluZXJYWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcFJbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcExbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgaWYgKHZTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMudlNjcm9sbERpciA9IHRoaXMucHJldlNjcm9sbFRvcCA8IHRoaXMuc2Nyb2xsVG9wID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Db2x1bW5zKCkpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChoYXNGcm96ZW5Sb3dzICYmICFvcHRpb25zLmZyb3plbkJvdHRvbSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydEJvdHRvbUxbMF0uc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BMWzBdLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gc3dpdGNoIHZpcnR1YWwgcGFnZXMgaWYgbmVlZGVkXHJcbiAgICAgICAgICAgIGlmICh2U2Nyb2xsRGlzdCA8IHRoaXMudmlld3BvcnRIKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0aGlzLnNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCB8fCB2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICBjb25zdCBkeCA9IE1hdGguYWJzKHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCAtIHRoaXMuc2Nyb2xsTGVmdCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGR5ID0gTWF0aC5hYnMobGFzdFNjcm9sbFRvcCAtIHRoaXMuc2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgaWYgKGR4ID4gMjAgfHwgZHkgPiAyMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgcmVuZGVyaW5nIGlzIGZvcmNlZCBvciBzY3JvbGxpbmcgaXMgc21hbGwgZW5vdWdoIHRvIGJlIFwiZWFzeVwiLCBqdXN0IHJlbmRlclxyXG4gICAgICAgICAgICAgICAgaWYgKGR5IDwgdGhpcy52aWV3cG9ydEggJiYgZHggPCB0aGlzLnZpZXdwb3J0Vykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhTY3JvbGxEaXN0IHx8IHZTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfc2Nyb2xsVG8oeSkge1xyXG4gICAgICAgIGNvbnN0ICR2aWV3cG9ydFNjcm9sbENvbnRhaW5lclkgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB5ID0gTWF0aC5tYXgoeSwgMCk7XHJcbiAgICAgICAgeSA9IE1hdGgubWluKHksIHRoaXMuY2FudmFzSGVpZ2h0IC0gdGhpcy52aWV3cG9ydEgpO1xyXG5cclxuICAgICAgICBjb25zdCBuZXdTY3JvbGxUb3AgPSB5O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wcmV2U2Nyb2xsVG9wICE9IG5ld1Njcm9sbFRvcCkge1xyXG4gICAgICAgICAgICB0aGlzLnZTY3JvbGxEaXIgPSAodGhpcy5wcmV2U2Nyb2xsVG9wIDwgbmV3U2Nyb2xsVG9wKSA/IDEgOiAtMTtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSAodGhpcy5zY3JvbGxUb3AgPSB0aGlzLnByZXZTY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3ApO1xyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGhhc0Zyb3plbkNvbHVtbnMoKSkge1xyXG4gICAgICAgICAgICAvLyAgICAgJHZpZXdwb3J0VG9wTFswXS5zY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Sb3dzKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAkdmlld3BvcnRCb3R0b21MWzBdLnNjcm9sbFRvcCA9ICR2aWV3cG9ydEJvdHRvbVJbMF0uc2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAvLyAkdmlld3BvcnRTY3JvbGxDb250YWluZXJZLnNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZUNsaWNrKCRldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgIC8vIGRvY3VtZW50LmJvZHkuY2xpY2soKTtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSAkZXZlbnQudGFyZ2V0IGFzIGFueTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyB8fCB0YXJnZXQubm9kZU5hbWUgPT09ICdJTlBVVCcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsZXQgdGQgPSB0YXJnZXQ7XHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSAhPT0gJ1REJykge1xyXG4gICAgICAgICAgICB0ZCA9IHRhcmdldC5jbG9zZXN0KCdURCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuX190cmlnZ2VyQm9keUNsaWNrRXZlbnQpIHtcclxuICAgICAgICAgICAgLy8g6Kej5Yaz6LaF6ZO+54K55Ye75LqL5Lu277yM6KaB5YWI5omn6KGM6YCJ5Lit6KGMXHJcbiAgICAgICAgICAgIGlmICh0ZCAmJiB0ZC5zZWxlY3RDZWxsICkge1xyXG4gICAgICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGQuc2VsZWN0Q2VsbCgkZXZlbnQsIHRkKTsgIC8vIOaMieeQhuivtOWPr+S7peWIoOmZpOeahO+8jOS9huS4jeaVouWKqOWTpm8o4omn5Y+j4ommKW9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5lZGl0TW9kZSA9PT0gJ3JvdycpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRkICYmIHRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgdGQgPSB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50O1xyXG4gICAgICAgICAgICBpZiAodGQgJiYgdGQuY2xvc2VFZGl0KSB7XHJcbiAgICAgICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5jbG9zZUVkaXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAvLyDooYznpoHnlKjml7ZcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZVJvdyAmJiB0ZC5ncmlkQ2VsbERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcm93RGF0YSwgcm93SW5kZXggfSA9IHRkLmdyaWRDZWxsRGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cocm93RGF0YSwgcm93SW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5kZy5lZGl0TW9kZSA9PT0gJ2NlbGwnICYmIHRkLmVkaXQpIHtcclxuICAgICAgICAgICAgICAgIHRkLmVkaXQoJGV2ZW50KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ZC5zZWxlY3RDZWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnICYmIHRoaXMuZGcubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRkLnNlbGVjdENlbGwoJGV2ZW50LCB0ZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kQ2VsbEVkaXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25CZWZvcmVTaG93Q29udGV4dE1lbnUgPSAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gcm93XzFfZml4ZWRsZWZ0ICByb3dfMSAgcm93XzFfZml4ZWRyaWdodFxyXG4gICAgICAgIGNvbnN0IHsgY29udGV4dE1lbnVEb20sIGV2ZW50IH0gPSBlO1xyXG5cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5kYXRhZ3JpZC1lZGl0b3InKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gb2Yoe3Nob3c6IGZhbHNlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgbGV0IHJvd0lEID0gZXZlbnQudGFyZ2V0LmlkO1xyXG5cclxuICAgICAgICBpZiAoY29udGV4dE1lbnVEb20pIHtcclxuICAgICAgICAgICAgLy8g5o6S6Zmk5YiG57uE6KGM44CB5YiG57uE5ZCI6K6h6KGMXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0TWVudURvbS5jbGFzc05hbWUuaW5kZXhPZignZi1kYXRhZ3JpZC1ncm91cC1yb3cnKSA9PT0gLTEgJiYgY29udGV4dE1lbnVEb20uY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZ3JvdXAtZm9vdGVyJykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByb3dJRCA9IGNvbnRleHRNZW51RG9tLmlkLnJlcGxhY2UoJ3Jvd18nLCAnJykucmVwbGFjZSgnX2ZpeGVkbGVmdCcsICcnKS5yZXBsYWNlKCdfZml4ZWRyaWdodCcsICcnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJvd0RhdGEgPSB0aGlzLmRmcy5maW5kUm93KHJvd0lEKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvY3VzVGFyZ2V0V2lkdGggPSB0aGlzLnZpZXdwb3J0VyA+IHRoaXMudG90YWxXaWR0aCA/IHRoaXMudG90YWxXaWR0aCA6IHRoaXMudmlld3BvcnRXO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9mKHsgc2hvdzogdHJ1ZSwgZGF0YTogeyBkYXRhOiByb3dEYXRhLmRhdGEsIGdyaWQ6IHRoaXMuZGd9LCBmb2N1c1RhcmdldFdpZHRoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvZih7IHNob3c6IGZhbHNlIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==