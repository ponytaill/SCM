/**
 * @fileoverview added by tsickle
 * Generated from: lib/webcmp/bif-manual-creation-source.webcmp.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable, Optional } from '@angular/core';
import { MessagerService } from "@farris/ui-messager";
import { Entity, BindingData, ViewModel, FrameContext } from "@farris/devkit";
import { PushCreationMode } from "@edp-aif/common-api";
import { FormBillCreationProcessExecutorArgs } from '../entity/form-rest/FormBillCreationProcessExecutorArgs';
import { BifDataService } from '../bif-manual-creation/service/bif-data.service';
import { BifSourceUiService } from '../bif-manual-creation/service/bif-source-ui.service';
import { LocalePipe } from '../bif-manual-creation/pipe/locale.pipe';
import { PushTaskArgs } from '../bif-manual-creation/args/PushTaskArgs';
import { ManualCreationMode } from '../entity/form-rest/ManualCreationMode';
/**
 * 手工生单来源端服务类
 */
var BifManualCreationSourceWebCmpService = /** @class */ (function () {
    function BifManualCreationSourceWebCmpService(sourceUiService, dataService, bindingData, messagerService, viewModel, frameContext) {
        this.sourceUiService = sourceUiService;
        this.dataService = dataService;
        this.bindingData = bindingData;
        this.messagerService = messagerService;
        this.viewModel = viewModel;
        this.frameContext = frameContext;
        this.localePipe = new LocalePipe(this.sourceUiService && this.sourceUiService.localeId || 'zh-CHS');
    }
    /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param sourceVoId 单据流来源视图对象 Id
     * @param entities 参与生单的来源单据列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 弹窗配置
     * @param customSelectorModuleUrl 自定义选择器url
     * @param extParams1 打开生单流程选择器弹窗扩展参数
     * @param extParams2 打开目标单据制单界面扩展参数
     */
    /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushBySourceVoId = /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (sourceVoId, entities, targetCommand, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1, extParams2) {
        var _this = this;
        if (entities == null) {
            throw "entities is null.";
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        if (targetCommand == null || targetCommand == "") {
            targetCommand = "rootviewmodelbifLoad1";
        }
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams1 = extParams1 === "" || extParams1 == null ? undefined : extParams1;
        extParams2 = extParams2 === "" || extParams2 == null ? undefined : extParams2;
        //打开生单流程选择器
        this.sourceUiService.openBillCreationProcessSelector4Push(sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = entities.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item instanceof Entity) {
                        // 如果是Entity
                        return JSON.stringify(item.toJSON(false, true));
                    }
                    else if (item["__type__"] == "BindingObject") {
                        //如果来自BindingData
                        /** @type {?} */
                        var bindingObject = (/** @type {?} */ (item));
                        return JSON.stringify(bindingObject.toJSON({ useFullMultiLangProperty: true }));
                    }
                    else {
                        /** @type {?} */
                        var e = (/** @type {?} */ (item));
                        return JSON.stringify(e.toJSON(false, true));
                    }
                }));
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.Push;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams2));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }));
        }));
    };
    /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param sourceVoId 单据流来源视图对象 Id
     * @param targetVoId 单据流目标视图对象 Id
     * @param entities 参与生单的来源单据列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 弹窗配置
     * @param customSelectorModuleUrl 自定义选择器url
     * @param extParams1 打开生单流程选择器弹窗扩展参数
     * @param extParams2 打开目标单据制单界面扩展参数
     */
    /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} targetVoId 单据流目标视图对象 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushBySourceVoIdAndTargetVoId = /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} targetVoId 单据流目标视图对象 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (sourceVoId, targetVoId, entities, targetCommand, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1, extParams2) {
        var _this = this;
        if (entities == null) {
            throw "entities is null.";
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        if (targetCommand == null || targetCommand == "") {
            targetCommand = "rootviewmodelbifLoad1";
        }
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams1 = extParams1 === "" || extParams1 == null ? undefined : extParams1;
        extParams2 = extParams2 === "" || extParams2 == null ? undefined : extParams2;
        //打开生单流程选择器
        this.sourceUiService.openBillCreationProcessSelector4SpecificPush(sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = entities.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item instanceof Entity) {
                        // 如果是Entity
                        return JSON.stringify(item.toJSON(false, true));
                    }
                    else if (item["__type__"] == "BindingObject") {
                        //如果来自BindingData
                        /** @type {?} */
                        var bindingObject = (/** @type {?} */ (item));
                        return JSON.stringify(bindingObject.toJSON({ useFullMultiLangProperty: true }));
                    }
                    else {
                        /** @type {?} */
                        var e = (/** @type {?} */ (item));
                        return JSON.stringify(e.toJSON(false, true));
                    }
                }));
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.SpecificPush;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams2));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }));
        }));
    };
    /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param processId 单据流生单流程 Id
     * @param entities 参与生单的来源单据列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param extParams 打开目标单据制单界面扩展参数
     */
    /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param {?} processId 单据流生单流程 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} extParams 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushByCreationProcessId = /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param {?} processId 单据流生单流程 Id
     * @param {?} entities 参与生单的来源单据列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} extParams 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (processId, entities, targetCommand, extParams) {
        var _this = this;
        if (entities == null) {
            throw "entities is null.";
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        if (targetCommand == null || targetCommand == "") {
            targetCommand = "rootviewmodelbifLoad1";
        }
        //查找生单流程
        this.dataService.getSlimBillCreationProcessEntityExById(processId).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = entities.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item instanceof Entity) {
                        // 如果是Entity
                        return JSON.stringify(item.toJSON(false, true));
                    }
                    else if (item["__type__"] == "BindingObject") {
                        //如果来自BindingData
                        /** @type {?} */
                        var bindingObject = (/** @type {?} */ (item));
                        return JSON.stringify(bindingObject.toJSON({ useFullMultiLangProperty: true }));
                    }
                    else {
                        /** @type {?} */
                        var e = (/** @type {?} */ (item));
                        return JSON.stringify(e.toJSON(false, true));
                    }
                }));
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.SpecificPush;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }));
        }));
    };
    /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param sourceVoId 来源VO Id
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 模态框配置
     * @param customSelectorModuleUrl 自定义选择器Url
     * @param extParams 扩展参数
     * @returns creationProcess 生单流程 @type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    BifManualCreationSourceWebCmpService.prototype.openBillCreationProcessSelector4Push = /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    function (sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams) {
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        return this.sourceUiService.openBillCreationProcessSelector4Push(sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams);
    };
    /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param sourceVoId 来源VO Id
     * @param targetVoId 目标VO Id
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 模态框配置
     * @param customSelectorModuleUrl 自定义选择器Url
     * @param extParams 扩展参数
     * @returns creationProcess 生单流程 @type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?} targetVoId 目标VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    BifManualCreationSourceWebCmpService.prototype.openBillCreationProcessSelector4SpecificPush = /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?} targetVoId 目标VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    function (sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams) {
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        //打开生单流程选择器
        return this.sourceUiService.openBillCreationProcessSelector4SpecificPush(sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams);
    };
    /**
     * @Deprecated 已弃用，请使用 {@link openTargetApp }
     * 打开目标单据制单界面
     * @param formSettings 表单配置
     * @param result 生单流程执行结果
     * @param targetCommand 目标表单命令
     * @param extParams 扩展参数
     */
    /**
     * \@Deprecated 已弃用，请使用 {\@link openTargetApp }
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} result 生单流程执行结果
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.openTargetForm = /**
     * \@Deprecated 已弃用，请使用 {\@link openTargetApp }
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} result 生单流程执行结果
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    function (formSettings, result, targetCommand, extParams) {
        if (targetCommand == null || targetCommand == "") {
            targetCommand = "rootviewmodelbifLoad1";
        }
        this.sourceUiService.openTargetForm(formSettings, result, tslib_1.__assign({ action: targetCommand }, extParams));
    };
    /**
     * 打开目标单据制单界面
     * @param formSettings 表单配置
     * @param conditionResult 执行条件计算结果
     * @param targetCommand 目标表单命令
     * @param extParams 扩展参数
     */
    /**
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} conditionResult 执行条件计算结果
     * @param {?} textIdWithDataIds
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.openTargetApp = /**
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} conditionResult 执行条件计算结果
     * @param {?} textIdWithDataIds
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    function (formSettings, conditionResult, textIdWithDataIds, targetCommand, extParams) {
        if (targetCommand == null || targetCommand == "") {
            targetCommand = "rootviewmodelbifLoad1";
        }
        this.sourceUiService.openTargetApp(formSettings, conditionResult, textIdWithDataIds, tslib_1.__assign({ action: targetCommand }, extParams));
    };
    BifManualCreationSourceWebCmpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BifManualCreationSourceWebCmpService.ctorParameters = function () { return [
        { type: BifSourceUiService },
        { type: BifDataService },
        { type: BindingData },
        { type: MessagerService },
        { type: ViewModel, decorators: [{ type: Optional }] },
        { type: FrameContext, decorators: [{ type: Optional }] }
    ]; };
    return BifManualCreationSourceWebCmpService;
}());
export { BifManualCreationSourceWebCmpService };
if (false) {
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.localePipe;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.sourceUiService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.dataService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.bindingData;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.messagerService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.viewModel;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.frameContext;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlmLW1hbnVhbC1jcmVhdGlvbi1zb3VyY2Uud2ViY21wLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZWRwLWJpZi9ydW50aW1lLWFwaS8iLCJzb3VyY2VzIjpbImxpYi93ZWJjbXAvYmlmLW1hbnVhbC1jcmVhdGlvbi1zb3VyY2Uud2ViY21wLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHckQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBR3RELE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQWlCLE1BQU0sZ0JBQWdCLENBQUM7QUFFN0YsT0FBTyxFQUFnQixnQkFBZ0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXJFLE9BQU8sRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLHlEQUF5RCxDQUFDO0FBRTlHLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQUNqRixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUMxRixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDckUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBRXhFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDOzs7O0FBSzVFO0lBSUksOENBQ1csZUFBbUMsRUFDbkMsV0FBMkIsRUFDM0IsV0FBd0IsRUFDeEIsZUFBZ0MsRUFDcEIsU0FBb0IsRUFDcEIsWUFBMEI7UUFMdEMsb0JBQWUsR0FBZixlQUFlLENBQW9CO1FBQ25DLGdCQUFXLEdBQVgsV0FBVyxDQUFnQjtRQUMzQixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QixvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDcEIsY0FBUyxHQUFULFNB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Ozs7T0FPRzs7Ozs7Ozs7OztJQUNJLDZEQUFjOzs7Ozs7Ozs7SUFBckIsVUFBc0IsWUFBMEIsRUFBRSxNQUE2QyxFQUFFLGFBQXNCLEVBQUUsU0FBYztRQUNuSSxJQUFJLGFBQWEsSUFBSSxJQUFJLElBQUksYUFBYSxJQUFJLEVBQUUsRUFBRTtZQUM5QyxhQUFhLEdBQUcsdUJBQXVCLENBQUM7U0FDM0M7UUFDRCxJQUFJLENBQUMsZUFBZSxDQUFDLGNBQWMsQ0FBQyxZQUFZLEVBQUUsTUFBTSxxQkFBSSxNQUFNLEVBQUUsYUFBYSxJQUFLLFNBQVMsRUFBRyxDQUFDO0lBQ3ZHLENBQUM7SUFFRDs7Ozs7O09BTUc7Ozs7Ozs7Ozs7SUFDSSw0REFBYTs7Ozs7Ozs7O0lBQXBCLFVBQXFCLFlBQTBCLEVBQUUsZUFBZ0MsRUFBRSxpQkFBNEMsRUFBRSxhQUFzQixFQUFFLFNBQWM7UUFDbkssSUFBSSxhQUFhLElBQUksSUFBSSxJQUFJLGFBQWEsSUFBSSxFQUFFLEVBQUU7WUFDOUMsYUFBYSxHQUFHLHVCQUF1QixDQUFDO1NBQzNDO1FBQ0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxhQUFhLENBQUMsWUFBWSxFQUFFLGVBQWUsRUFBRSxpQkFBaUIscUJBQUksTUFBTSxFQUFFLGFBQWEsSUFBSyxTQUFTLEVBQUcsQ0FBQztJQUNsSSxDQUFDOztnQkF6WEosVUFBVTs7OztnQkFURixrQkFBa0I7Z0JBRGxCLGNBQWM7Z0JBTk4sV0FBVztnQkFIbkIsZUFBZTtnQkFHTSxTQUFTLHVCQXlCOUIsUUFBUTtnQkF6QndCLFlBQVksdUJBMEI1QyxRQUFROztJQWdYakIsMkNBQUM7Q0FBQSxBQTFYRCxJQTBYQztTQXpYWSxvQ0FBb0M7OztJQUM3QywwREFBOEI7O0lBRzFCLCtEQUEwQzs7SUFDMUMsMkRBQWtDOztJQUNsQywyREFBK0I7O0lBQy9CLCtEQUF1Qzs7SUFDdkMseURBQXVDOztJQUN2Qyw0REFBNkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1tZXNzYWdlclwiO1xyXG5pbXBvcnQgeyBNb2RhbE9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuXHJcbmltcG9ydCB7IEVudGl0eSwgQmluZGluZ0RhdGEsIFZpZXdNb2RlbCwgRnJhbWVDb250ZXh0LCBCaW5kaW5nT2JqZWN0IH0gZnJvbSBcIkBmYXJyaXMvZGV2a2l0XCI7XHJcblxyXG5pbXBvcnQgeyBGb3JtU2V0dGluZ3MsIFB1c2hDcmVhdGlvbk1vZGUgfSBmcm9tIFwiQGVkcC1haWYvY29tbW9uLWFwaVwiO1xyXG5pbXBvcnQgeyBJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4IH0gZnJvbSBcIkBlZHAtYmlmL2NvbW1vbi1hcGlcIjtcclxuaW1wb3J0IHsgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvckFyZ3MgfSBmcm9tICcuLi9lbnRpdHkvZm9ybS1yZXN0L0Zvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JBcmdzJztcclxuaW1wb3J0IHsgQ29uZGl0aW9uUmVzdWx0LCBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yUmVzdWx0IH0gZnJvbSAnQGVkcC1haWYvcnVudGltZS1hcGknO1xyXG5pbXBvcnQgeyBCaWZEYXRhU2VydmljZSB9IGZyb20gJy4uL2JpZi1tYW51YWwtY3JlYXRpb24vc2VydmljZS9iaWYtZGF0YS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQmlmU291cmNlVWlTZXJ2aWNlIH0gZnJvbSAnLi4vYmlmLW1hbnVhbC1jcmVhdGlvbi9zZXJ2aWNlL2JpZi1zb3VyY2UtdWkuc2VydmljZSc7XHJcbmltcG9ydCB7IExvY2FsZVBpcGUgfSBmcm9tICcuLi9iaWYtbWFudWFsLWNyZWF0aW9uL3BpcGUvbG9jYWxlLnBpcGUnO1xyXG5pbXBvcnQgeyBQdXNoVGFza0FyZ3MgfSBmcm9tICcuLi9iaWYtbWFudWFsLWNyZWF0aW9uL2FyZ3MvUHVzaFRhc2tBcmdzJztcclxuaW1wb3J0IHsgR2VuZXJhbFRleHRJZFdpdGhEYXRhSWQgfSBmcm9tICcuLi9lbnRpdHkvZm9ybS1yZXN0L0dlbmVyYWxUZXh0SWRXaXRoRGF0YUlkJztcclxuaW1wb3J0IHsgTWFudWFsQ3JlYXRpb25Nb2RlIH0gZnJvbSAnLi4vZW50aXR5L2Zvcm0tcmVzdC9NYW51YWxDcmVhdGlvbk1vZGUnO1xyXG5cclxuLyoqXHJcbiAqIOaJi+W3peeUn+WNleadpea6kOerr+acjeWKoeexu1xyXG4gKi9cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQmlmTWFudWFsQ3JlYXRpb25Tb3VyY2VXZWJDbXBTZXJ2aWNlIHtcclxuICAgIHB1YmxpYyBsb2NhbGVQaXBlOiBMb2NhbGVQaXBlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBzb3VyY2VVaVNlcnZpY2U6IEJpZlNvdXJjZVVpU2VydmljZSxcclxuICAgICAgICBwdWJsaWMgZGF0YVNlcnZpY2U6IEJpZkRhdGFTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBiaW5kaW5nRGF0YTogQmluZGluZ0RhdGEsXHJcbiAgICAgICAgcHVibGljIG1lc3NhZ2VyU2VydmljZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyB2aWV3TW9kZWw6IFZpZXdNb2RlbCxcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmxvY2FsZVBpcGUgPSBuZXcgTG9jYWxlUGlwZSh0aGlzLnNvdXJjZVVpU2VydmljZSAmJiB0aGlzLnNvdXJjZVVpU2VydmljZS5sb2NhbGVJZCB8fCAnemgtQ0hTJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDkuIvmjqjvvIzmoLnmja7mnaXmupBWTyBJZOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOW5tuaJp+ihjOmAieS4reeahOeUn+WNlea1geeoi1xyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gc291cmNlVm9JZCDljZXmja7mtYHmnaXmupDop4blm77lr7nosaEgSWRcclxuICAgICAqIEBwYXJhbSBlbnRpdGllcyDlj4LkuI7nlJ/ljZXnmoTmnaXmupDljZXmja7liJfooahcclxuICAgICAqIEBwYXJhbSB0YXJnZXRDb21tYW5kIOebruagh+WNleaNrifljZXmja7mtYHliqDovb0n5ZG95Luk55qE57yW5Y+3XHJcbiAgICAgKiBAcGFyYW0gYml6Rmxvd2NoYXJ0SWQg5Lia5Yqh5Zy65pmv5Zu+SWRcclxuICAgICAqIEBwYXJhbSBtb2RhbE9wdGlvbnMg5by556qX6YWN572uXHJcbiAgICAgKiBAcGFyYW0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwg6Ieq5a6a5LmJ6YCJ5oup5ZmodXJsXHJcbiAgICAgKiBAcGFyYW0gZXh0UGFyYW1zMSDmiZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmajlvLnnqpfmianlsZXlj4LmlbBcclxuICAgICAqIEBwYXJhbSBleHRQYXJhbXMyIOaJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdouaJqeWxleWPguaVsFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcHVzaEJ5U291cmNlVm9JZChzb3VyY2VWb0lkOiBzdHJpbmcsIGVudGl0aWVzOiBhbnlbXSwgdGFyZ2V0Q29tbWFuZD86IHN0cmluZywgYml6Rmxvd2NoYXJ0SWQ/OiBzdHJpbmcsIG1vZGFsT3B0aW9ucz86IE1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw/OiBzdHJpbmcsIGV4dFBhcmFtczE/OiB7fSwgZXh0UGFyYW1zMj86IHt9KSB7XHJcbiAgICAgICAgaWYgKGVudGl0aWVzID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgXCJlbnRpdGllcyBpcyBudWxsLlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZW50aXRpZXMgaW5zdGFuY2VvZiBNYXApIHtcclxuICAgICAgICAgICAgZW50aXRpZXMgPSBBcnJheS5mcm9tKGVudGl0aWVzLnZhbHVlcygpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZW50aXRpZXMgPSBBcnJheS5pc0FycmF5KGVudGl0aWVzKSA/IGVudGl0aWVzIDogW2VudGl0aWVzXTtcclxuICAgICAgICBpZiAodGFyZ2V0Q29tbWFuZCA9PSBudWxsIHx8IHRhcmdldENvbW1hbmQgPT0gXCJcIikge1xyXG4gICAgICAgICAgICB0YXJnZXRDb21tYW5kID0gXCJyb290dmlld21vZGVsYmlmTG9hZDFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgYml6Rmxvd2NoYXJ0SWQgPSBiaXpGbG93Y2hhcnRJZCA9PT0gXCJcIiB8fCBiaXpGbG93Y2hhcnRJZCA9PSBudWxsID8gdW5kZWZpbmVkIDogYml6Rmxvd2NoYXJ0SWQ7XHJcbiAgICAgICAgbW9kYWxPcHRpb25zID0gbW9kYWxPcHRpb25zIGFzIGFueSA9PT0gXCJcIiB8fCBtb2RhbE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG1vZGFsT3B0aW9ucztcclxuICAgICAgICBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID09PSBcIlwiIHx8IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID09IG51bGwgPyB1bmRlZmluZWQgOiBjdXN0b21TZWxlY3Rvck1vZHVsZVVybDtcclxuICAgICAgICBleHRQYXJhbXMxID0gZXh0UGFyYW1zMSA9PT0gXCJcIiB8fCBleHRQYXJhbXMxID09IG51bGwgPyB1bmRlZmluZWQgOiBleHRQYXJhbXMxO1xyXG4gICAgICAgIGV4dFBhcmFtczIgPSBleHRQYXJhbXMyID09PSBcIlwiIHx8IGV4dFBhcmFtczIgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGV4dFBhcmFtczI7XHJcbiAgICAgICAgLy/miZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmahcclxuICAgICAgICB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuQmlsbENyZWF0aW9uUHJvY2Vzc1NlbGVjdG9yNFB1c2goc291cmNlVm9JZCwgYml6Rmxvd2NoYXJ0SWQsIG1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwsIGV4dFBhcmFtczEpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgKGNwOiBJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvL+afpeivouihqOWNlemFjee9rlxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5nZXRGb3JtU2V0dGluZ3NCeUlkKGNwLmZvcm1TZXR0aW5nc0lkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAgICAgKGZvcm1TZXR0aW5nczogRm9ybVNldHRpbmdzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yib5bu65omn6KGM55Sf5Y2V5rWB56iL5Y+C5pWw5a+56LGhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvckFyZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5iaWxsQ3JlYXRpb25Qcm9jZXNzSWQgPSBjcC5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5jcmVhdGlvblJ1bGVJZCA9IGNwLmNyZWF0aW9uUnVsZUlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0Zvcm1DcmVhdGlvblJ1bGVFeGVjdXRvckFyZ3PnmoRzb3VyY2VWb0VudGl0eURhdGFz5bGe5oCn5Li65YmN56uv5a6e5L2T5bqP5YiX5YyW5ZCO55qE5a2X56ym5Liy5YiX6KGoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc291cmNlVm9FbnRpdHlEYXRhc+WIl+ihqOS4reeahOavj+S4quWtl+espuS4su+8jOWcqOe7k+aehOS4iuW6lOS4juWNleaNrua1geWumuS5ieS4reaJgOmAieS4reeahOS4iua4uOinhuWbvuWvueixoeS4gOiHtOOAglxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnNvdXJjZVZvRW50aXR5RGF0YXMgPSBlbnRpdGllcy5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEVudGl0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOaYr0VudGl0eVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpdGVtLnRvSlNPTihmYWxzZSwgdHJ1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtW1wiX190eXBlX19cIl0gPT0gXCJCaW5kaW5nT2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WmguaenOadpeiHqkJpbmRpbmdEYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluZGluZ09iamVjdCA9IGl0ZW0gYXMgQmluZGluZ09iamVjdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYmluZGluZ09iamVjdC50b0pTT04oeyB1c2VGdWxsTXVsdGlMYW5nUHJvcGVydHk6IHRydWUgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaXRlbSBhcyBFbnRpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGUudG9KU09OKGZhbHNlLCB0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+S4i+aOqOi/h+eoi+S4reS4jeWtmOWcqOebruagh+S4u+ihqOWNleaNrklk77yM5omA5LuldGFyZ2V0Vm9EYXRhSWRz5Li656m65YiX6KGo44CCXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MudGFyZ2V0Vm9EYXRhSWRzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MubWFudWFsQ3JlYXRpb25Nb2RlID0gTWFudWFsQ3JlYXRpb25Nb2RlLlB1c2g7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5omn6KGM55Sf5Y2V5rWB56iLXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZXhlY3V0ZUJpbGxDcmVhdGlvblByb2Nlc3MoYXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vTWFwcGluZ+aJp+ihjOadoeS7tuWIpOaWree7k+aenOS4unRydWXml7bmiY3kvJrmiafooYznlJ/ljZXmtYHnqIvlvpfliLDnlJ/ljZXnu5PmnpxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvbmRpdGlvblJlc3VsdC5jb25kaXRpb25FeGVjdXRpb25SZXN1bHQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+eUn+WNlee7k+aenOS4jeS4uuepulxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0ICYmIHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdC5tYXBwaW5nUmVzdWx0cyAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5wdXNoQ3JlYXRpb25Nb2RlID09IG51bGwgfHwgcmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5DUkVBVElPTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuYWRkRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdChyZXN1bHQpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/miZPlvIDnm67moIfljZXmja7liLbljZXnlYzpnaJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5UYXJnZXRBcHAoZm9ybVNldHRpbmdzLCByZXN1bHQuY29uZGl0aW9uUmVzdWx0LCByZXMsIHsgYWN0aW9uOiB0YXJnZXRDb21tYW5kLCAuLi5leHRQYXJhbXMyIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5UQVNLQ0VOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqjpgIHku7vliqHkuK3lv4NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdXNoVGFza0FyZ3MgPSBuZXcgUHVzaFRhc2tBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLnN1Q29kZSA9IHJlc3VsdC5kb3duQmlsbFN1Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoVGFza0FyZ3MuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQgPSByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5wdXNoVGFza0NlbnRlcihwdXNoVGFza0FyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2Uuc3VjY2Vzcyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHVzaFRhc2tDZW50ZXJTdWNjZXNzXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLmlubmVyTWVzc2FnZSB8fCBlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpIHx8IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwdXNoVGFza0NlbnRlckZhaWxlZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUmVzdWx0RW1wdHlcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuLpmYWxzZeaXtuWPr+W+l+WIsOmFjee9rueahOmUmeivr+aPkOekuuS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihyZXN1bHQuY29uZGl0aW9uUmVzdWx0Lm1lc3NhZ2UgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uRXhlY3V0aW9uRXJyb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog54m55a6a5LiL5o6o77yM5qC55o2u5p2l5rqQVk8gSWTlkoznm67moIdWTyBJZOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOW5tuaJp+ihjOmAieS4reeahOeUn+WNlea1geeoi1xyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gc291cmNlVm9JZCDljZXmja7mtYHmnaXmupDop4blm77lr7nosaEgSWRcclxuICAgICAqIEBwYXJhbSB0YXJnZXRWb0lkIOWNleaNrua1geebruagh+inhuWbvuWvueixoSBJZFxyXG4gICAgICogQHBhcmFtIGVudGl0aWVzIOWPguS4jueUn+WNleeahOadpea6kOWNleaNruWIl+ihqFxyXG4gICAgICogQHBhcmFtIHRhcmdldENvbW1hbmQg55uu5qCH5Y2V5o2uJ+WNleaNrua1geWKoOi9vSflkb3ku6TnmoTnvJblj7dcclxuICAgICAqIEBwYXJhbSBiaXpGbG93Y2hhcnRJZCDkuJrliqHlnLrmma/lm75JZFxyXG4gICAgICogQHBhcmFtIG1vZGFsT3B0aW9ucyDlvLnnqpfphY3nva5cclxuICAgICAqIEBwYXJhbSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCDoh6rlrprkuYnpgInmi6nlmah1cmxcclxuICAgICAqIEBwYXJhbSBleHRQYXJhbXMxIOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOW8ueeql+aJqeWxleWPguaVsFxyXG4gICAgICogQHBhcmFtIGV4dFBhcmFtczIg5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2i5omp5bGV5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBwdXNoQnlTb3VyY2VWb0lkQW5kVGFyZ2V0Vm9JZChzb3VyY2VWb0lkOiBzdHJpbmcsIHRhcmdldFZvSWQ6IHN0cmluZywgZW50aXRpZXM6IEVudGl0eVtdLCB0YXJnZXRDb21tYW5kPzogc3RyaW5nLCBiaXpGbG93Y2hhcnRJZD86IHN0cmluZywgbW9kYWxPcHRpb25zPzogTW9kYWxPcHRpb25zLCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybD86IHN0cmluZywgZXh0UGFyYW1zMT86IHt9LCBleHRQYXJhbXMyPzoge30pIHtcclxuICAgICAgICBpZiAoZW50aXRpZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBcImVudGl0aWVzIGlzIG51bGwuXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbnRpdGllcyBpbnN0YW5jZW9mIE1hcCkge1xyXG4gICAgICAgICAgICBlbnRpdGllcyA9IEFycmF5LmZyb20oZW50aXRpZXMudmFsdWVzKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbnRpdGllcyA9IEFycmF5LmlzQXJyYXkoZW50aXRpZXMpID8gZW50aXRpZXMgOiBbZW50aXRpZXNdO1xyXG4gICAgICAgIGlmICh0YXJnZXRDb21tYW5kID09IG51bGwgfHwgdGFyZ2V0Q29tbWFuZCA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHRhcmdldENvbW1hbmQgPSBcInJvb3R2aWV3bW9kZWxiaWZMb2FkMVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBiaXpGbG93Y2hhcnRJZCA9IGJpekZsb3djaGFydElkID09PSBcIlwiIHx8IGJpekZsb3djaGFydElkID09IG51bGwgPyB1bmRlZmluZWQgOiBiaXpGbG93Y2hhcnRJZDtcclxuICAgICAgICBtb2RhbE9wdGlvbnMgPSBtb2RhbE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IG1vZGFsT3B0aW9ucyA9PSBudWxsID8gdW5kZWZpbmVkIDogbW9kYWxPcHRpb25zO1xyXG4gICAgICAgIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT09IFwiXCIgfHwgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsO1xyXG4gICAgICAgIGV4dFBhcmFtczEgPSBleHRQYXJhbXMxID09PSBcIlwiIHx8IGV4dFBhcmFtczEgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGV4dFBhcmFtczE7XHJcbiAgICAgICAgZXh0UGFyYW1zMiA9IGV4dFBhcmFtczIgPT09IFwiXCIgfHwgZXh0UGFyYW1zMiA9PSBudWxsID8gdW5kZWZpbmVkIDogZXh0UGFyYW1zMjtcclxuICAgICAgICAvL+aJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqFxyXG4gICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5CaWxsQ3JlYXRpb25Qcm9jZXNzU2VsZWN0b3I0U3BlY2lmaWNQdXNoKHNvdXJjZVZvSWQsIHRhcmdldFZvSWQsIGJpekZsb3djaGFydElkLCBtb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsLCBleHRQYXJhbXMxKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgIChjcDogSVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy/mn6Xor6LooajljZXphY3nva5cclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZ2V0Rm9ybVNldHRpbmdzQnlJZChjcC5mb3JtU2V0dGluZ3NJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAgICAgICAgIChmb3JtU2V0dGluZ3M6IEZvcm1TZXR0aW5ncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuaJp+ihjOeUn+WNlea1geeoi+WPguaVsOWvueixoVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcmdzID0gbmV3IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MuYmlsbENyZWF0aW9uUHJvY2Vzc0lkID0gY3AuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MuY3JlYXRpb25SdWxlSWQgPSBjcC5jcmVhdGlvblJ1bGVJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9Gb3JtQ3JlYXRpb25SdWxlRXhlY3V0b3JBcmdz55qEc291cmNlVm9FbnRpdHlEYXRhc+WxnuaAp+S4uuWJjeerr+WunuS9k+W6j+WIl+WMluWQjueahOWtl+espuS4suWIl+ihqFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvdXJjZVZvRW50aXR5RGF0YXPliJfooajkuK3nmoTmr4/kuKrlrZfnrKbkuLLvvIzlnKjnu5PmnoTkuIrlupTkuI7ljZXmja7mtYHlrprkuYnkuK3miYDpgInkuK3nmoTkuIrmuLjop4blm77lr7nosaHkuIDoh7TjgIJcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5zb3VyY2VWb0VudGl0eURhdGFzID0gZW50aXRpZXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBFbnRpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzmmK9FbnRpdHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaXRlbS50b0pTT04oZmFsc2UsIHRydWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbVtcIl9fdHlwZV9fXCJdID09IFwiQmluZGluZ09iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzmnaXoh6pCaW5kaW5nRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJpbmRpbmdPYmplY3QgPSBpdGVtIGFzIEJpbmRpbmdPYmplY3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGJpbmRpbmdPYmplY3QudG9KU09OKHsgdXNlRnVsbE11bHRpTGFuZ1Byb3BlcnR5OiB0cnVlIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGl0ZW0gYXMgRW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShlLnRvSlNPTihmYWxzZSwgdHJ1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/kuIvmjqjov4fnqIvkuK3kuI3lrZjlnKjnm67moIfkuLvooajljZXmja5JZO+8jOaJgOS7pXRhcmdldFZvRGF0YUlkc+S4uuepuuWIl+ihqOOAglxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnRhcmdldFZvRGF0YUlkcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9IE1hbnVhbENyZWF0aW9uTW9kZS5TcGVjaWZpY1B1c2g7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5omn6KGM55Sf5Y2V5rWB56iLXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZXhlY3V0ZUJpbGxDcmVhdGlvblByb2Nlc3MoYXJncykuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vTWFwcGluZ+aJp+ihjOadoeS7tuWIpOaWree7k+aenOS4unRydWXml7bmiY3kvJrmiafooYznlJ/ljZXmtYHnqIvlvpfliLDnlJ/ljZXnu5PmnpxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvbmRpdGlvblJlc3VsdC5jb25kaXRpb25FeGVjdXRpb25SZXN1bHQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+eUn+WNlee7k+aenOS4jeS4uuepulxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0ICYmIHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdC5tYXBwaW5nUmVzdWx0cyAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5wdXNoQ3JlYXRpb25Nb2RlID09IG51bGwgfHwgcmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5DUkVBVElPTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuYWRkRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdChyZXN1bHQpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/miZPlvIDnm67moIfljZXmja7liLbljZXnlYzpnaJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5UYXJnZXRBcHAoZm9ybVNldHRpbmdzLCByZXN1bHQuY29uZGl0aW9uUmVzdWx0LCByZXMsIHsgYWN0aW9uOiB0YXJnZXRDb21tYW5kLCAuLi5leHRQYXJhbXMyIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5UQVNLQ0VOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqjpgIHku7vliqHkuK3lv4NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdXNoVGFza0FyZ3MgPSBuZXcgUHVzaFRhc2tBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLnN1Q29kZSA9IHJlc3VsdC5kb3duQmlsbFN1Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoVGFza0FyZ3MuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQgPSByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5wdXNoVGFza0NlbnRlcihwdXNoVGFza0FyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2Uuc3VjY2Vzcyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHVzaFRhc2tDZW50ZXJTdWNjZXNzXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLmlubmVyTWVzc2FnZSB8fCBlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpIHx8IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwdXNoVGFza0NlbnRlckZhaWxlZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUmVzdWx0RW1wdHlcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuLpmYWxzZeaXtuWPr+W+l+WIsOmFjee9rueahOmUmeivr+aPkOekuuS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihyZXN1bHQuY29uZGl0aW9uUmVzdWx0Lm1lc3NhZ2UgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uRXhlY3V0aW9uRXJyb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog54m55a6a5LiL5o6o77yM5qC55o2u55Sf5Y2V5rWB56iLSUTmiafooYzpgInkuK3nmoTnlJ/ljZXmtYHnqItcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHByb2Nlc3NJZCDljZXmja7mtYHnlJ/ljZXmtYHnqIsgSWRcclxuICAgICAqIEBwYXJhbSBlbnRpdGllcyDlj4LkuI7nlJ/ljZXnmoTmnaXmupDljZXmja7liJfooahcclxuICAgICAqIEBwYXJhbSB0YXJnZXRDb21tYW5kIOebruagh+WNleaNrifljZXmja7mtYHliqDovb0n5ZG95Luk55qE57yW5Y+3XHJcbiAgICAgKiBAcGFyYW0gZXh0UGFyYW1zIOaJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdouaJqeWxleWPguaVsFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcHVzaEJ5Q3JlYXRpb25Qcm9jZXNzSWQocHJvY2Vzc0lkOiBzdHJpbmcsIGVudGl0aWVzOiBFbnRpdHlbXSwgdGFyZ2V0Q29tbWFuZD86IHN0cmluZywgZXh0UGFyYW1zPzoge30pIHtcclxuICAgICAgICBpZiAoZW50aXRpZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBcImVudGl0aWVzIGlzIG51bGwuXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbnRpdGllcyBpbnN0YW5jZW9mIE1hcCkge1xyXG4gICAgICAgICAgICBlbnRpdGllcyA9IEFycmF5LmZyb20oZW50aXRpZXMudmFsdWVzKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbnRpdGllcyA9IEFycmF5LmlzQXJyYXkoZW50aXRpZXMpID8gZW50aXRpZXMgOiBbZW50aXRpZXNdO1xyXG4gICAgICAgIGV4dFBhcmFtcyA9IGV4dFBhcmFtcyA9PT0gXCJcIiB8fCBleHRQYXJhbXMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGV4dFBhcmFtcztcclxuICAgICAgICBpZiAodGFyZ2V0Q29tbWFuZCA9PSBudWxsIHx8IHRhcmdldENvbW1hbmQgPT0gXCJcIikge1xyXG4gICAgICAgICAgICB0YXJnZXRDb21tYW5kID0gXCJyb290dmlld21vZGVsYmlmTG9hZDFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/mn6Xmib7nlJ/ljZXmtYHnqItcclxuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmdldFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhCeUlkKHByb2Nlc3NJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgICAoY3A6IElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8v5p+l6K+i6KGo5Y2V6YWN572uXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmdldEZvcm1TZXR0aW5nc0J5SWQoY3AuZm9ybVNldHRpbmdzSWQpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAoZm9ybVNldHRpbmdzOiBGb3JtU2V0dGluZ3MpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/liJvlu7rmiafooYznlJ/ljZXmtYHnqIvlj4LmlbDlr7nosaFcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJncyA9IG5ldyBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yQXJncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLmJpbGxDcmVhdGlvblByb2Nlc3NJZCA9IGNwLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLmNyZWF0aW9uUnVsZUlkID0gY3AuY3JlYXRpb25SdWxlSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vRm9ybUNyZWF0aW9uUnVsZUV4ZWN1dG9yQXJnc+eahHNvdXJjZVZvRW50aXR5RGF0YXPlsZ7mgKfkuLrliY3nq6/lrp7kvZPluo/liJfljJblkI7nmoTlrZfnrKbkuLLliJfooahcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb3VyY2VWb0VudGl0eURhdGFz5YiX6KGo5Lit55qE5q+P5Liq5a2X56ym5Liy77yM5Zyo57uT5p6E5LiK5bqU5LiO5Y2V5o2u5rWB5a6a5LmJ5Lit5omA6YCJ5Lit55qE5LiK5ri46KeG5Zu+5a+56LGh5LiA6Ie044CCXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3Muc291cmNlVm9FbnRpdHlEYXRhcyA9IGVudGl0aWVzLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgRW50aXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5pivRW50aXR5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGl0ZW0udG9KU09OKGZhbHNlLCB0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW1bXCJfX3R5cGVfX1wiXSA9PSBcIkJpbmRpbmdPYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5p2l6IeqQmluZGluZ0RhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5kaW5nT2JqZWN0ID0gaXRlbSBhcyBCaW5kaW5nT2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShiaW5kaW5nT2JqZWN0LnRvSlNPTih7IHVzZUZ1bGxNdWx0aUxhbmdQcm9wZXJ0eTogdHJ1ZSB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBpdGVtIGFzIEVudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZS50b0pTT04oZmFsc2UsIHRydWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5LiL5o6o6L+H56iL5Lit5LiN5a2Y5Zyo55uu5qCH5Li76KGo5Y2V5o2uSWTvvIzmiYDku6V0YXJnZXRWb0RhdGFJZHPkuLrnqbrliJfooajjgIJcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy50YXJnZXRWb0RhdGFJZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5tYW51YWxDcmVhdGlvbk1vZGUgPSBNYW51YWxDcmVhdGlvbk1vZGUuU3BlY2lmaWNQdXNoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+aJp+ihjOeUn+WNlea1geeoi1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmV4ZWN1dGVCaWxsQ3JlYXRpb25Qcm9jZXNzKGFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL01hcHBpbmfmiafooYzmnaHku7bliKTmlq3nu5PmnpzkuLp0cnVl5pe25omN5Lya5omn6KGM55Sf5Y2V5rWB56iL5b6X5Yiw55Sf5Y2V57uT5p6cXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb25kaXRpb25SZXN1bHQuY29uZGl0aW9uRXhlY3V0aW9uUmVzdWx0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/nlJ/ljZXnu5PmnpzkuI3kuLrnqbpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdCAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMgJiYgcmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0Lm1hcHBpbmdSZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBudWxsIHx8IHJlc3VsdC5wdXNoQ3JlYXRpb25Nb2RlID09IFB1c2hDcmVhdGlvbk1vZGUuQ1JFQVRJT04pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmFkZEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQocmVzdWx0KS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2iXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuVGFyZ2V0QXBwKGZvcm1TZXR0aW5ncywgcmVzdWx0LmNvbmRpdGlvblJlc3VsdCwgcmVzLCB7IGFjdGlvbjogdGFyZ2V0Q29tbWFuZCwgLi4uZXh0UGFyYW1zIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5UQVNLQ0VOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqjpgIHku7vliqHkuK3lv4NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdXNoVGFza0FyZ3MgPSBuZXcgUHVzaFRhc2tBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLnN1Q29kZSA9IHJlc3VsdC5kb3duQmlsbFN1Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoVGFza0FyZ3MuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQgPSByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5wdXNoVGFza0NlbnRlcihwdXNoVGFza0FyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2Uuc3VjY2Vzcyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHVzaFRhc2tDZW50ZXJTdWNjZXNzXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLmlubmVyTWVzc2FnZSB8fCBlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpIHx8IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwdXNoVGFza0NlbnRlckZhaWxlZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUmVzdWx0RW1wdHlcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuLpmYWxzZeaXtuWPr+W+l+WIsOmFjee9rueahOmUmeivr+aPkOekuuS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihyZXN1bHQuY29uZGl0aW9uUmVzdWx0Lm1lc3NhZ2UgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uRXhlY3V0aW9uRXJyb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u5p2l5rqQVk8gSWTmiZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmajpgInmi6nnlJ/ljZXmtYHnqItcclxuICAgICAqIEBwYXJhbSBzb3VyY2VWb0lkIOadpea6kFZPIElkXHJcbiAgICAgKiBAcGFyYW0gYml6Rmxvd2NoYXJ0SWQg5Lia5Yqh5Zy65pmv5Zu+SWRcclxuICAgICAqIEBwYXJhbSBtb2RhbE9wdGlvbnMg5qih5oCB5qGG6YWN572uXHJcbiAgICAgKiBAcGFyYW0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwg6Ieq5a6a5LmJ6YCJ5oup5ZmoVXJsXHJcbiAgICAgKiBAcGFyYW0gZXh0UGFyYW1zIOaJqeWxleWPguaVsCBcclxuICAgICAqIEByZXR1cm5zIGNyZWF0aW9uUHJvY2VzcyDnlJ/ljZXmtYHnqIsgQHR5cGUgeyBPYnNlcnZhYmxlPElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXg+IH1cclxuICAgICAqL1xyXG4gICAgcHVibGljIG9wZW5CaWxsQ3JlYXRpb25Qcm9jZXNzU2VsZWN0b3I0UHVzaChzb3VyY2VWb0lkOiBzdHJpbmcsIGJpekZsb3djaGFydElkPzogc3RyaW5nLCBtb2RhbE9wdGlvbnM/OiBNb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsPzogc3RyaW5nLCBleHRQYXJhbXM/OiB7fSk6IE9ic2VydmFibGU8SVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeD4ge1xyXG4gICAgICAgIGJpekZsb3djaGFydElkID0gYml6Rmxvd2NoYXJ0SWQgPT09IFwiXCIgfHwgYml6Rmxvd2NoYXJ0SWQgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGJpekZsb3djaGFydElkO1xyXG4gICAgICAgIG1vZGFsT3B0aW9ucyA9IG1vZGFsT3B0aW9ucyBhcyBhbnkgPT09IFwiXCIgfHwgbW9kYWxPcHRpb25zID09IG51bGwgPyB1bmRlZmluZWQgOiBtb2RhbE9wdGlvbnM7XHJcbiAgICAgICAgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PT0gXCJcIiB8fCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PSBudWxsID8gdW5kZWZpbmVkIDogY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw7XHJcbiAgICAgICAgZXh0UGFyYW1zID0gZXh0UGFyYW1zID09PSBcIlwiIHx8IGV4dFBhcmFtcyA9PSBudWxsID8gdW5kZWZpbmVkIDogZXh0UGFyYW1zO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuQmlsbENyZWF0aW9uUHJvY2Vzc1NlbGVjdG9yNFB1c2goc291cmNlVm9JZCwgYml6Rmxvd2NoYXJ0SWQsIG1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwsIGV4dFBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7mnaXmupBWTyBJZOWSjOebruagh1ZPIElk5omT5byA55Sf5Y2V5rWB56iL6YCJ5oup5Zmo6YCJ5oup55Sf5Y2V5rWB56iLXHJcbiAgICAgKiBAcGFyYW0gc291cmNlVm9JZCDmnaXmupBWTyBJZFxyXG4gICAgICogQHBhcmFtIHRhcmdldFZvSWQg55uu5qCHVk8gSWRcclxuICAgICAqIEBwYXJhbSBiaXpGbG93Y2hhcnRJZCDkuJrliqHlnLrmma/lm75JZFxyXG4gICAgICogQHBhcmFtIG1vZGFsT3B0aW9ucyDmqKHmgIHmoYbphY3nva5cclxuICAgICAqIEBwYXJhbSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCDoh6rlrprkuYnpgInmi6nlmahVcmxcclxuICAgICAqIEBwYXJhbSBleHRQYXJhbXMg5omp5bGV5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyBjcmVhdGlvblByb2Nlc3Mg55Sf5Y2V5rWB56iLIEB0eXBlIHsgT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4PiB9XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvcGVuQmlsbENyZWF0aW9uUHJvY2Vzc1NlbGVjdG9yNFNwZWNpZmljUHVzaChzb3VyY2VWb0lkOiBzdHJpbmcsIHRhcmdldFZvSWQ6IHN0cmluZywgYml6Rmxvd2NoYXJ0SWQ/OiBzdHJpbmcsIG1vZGFsT3B0aW9ucz86IE1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw/OiBzdHJpbmcsIGV4dFBhcmFtcz86IHt9KTogT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4PiB7XHJcbiAgICAgICAgYml6Rmxvd2NoYXJ0SWQgPSBiaXpGbG93Y2hhcnRJZCA9PT0gXCJcIiB8fCBiaXpGbG93Y2hhcnRJZCA9PSBudWxsID8gdW5kZWZpbmVkIDogYml6Rmxvd2NoYXJ0SWQ7XHJcbiAgICAgICAgbW9kYWxPcHRpb25zID0gbW9kYWxPcHRpb25zIGFzIGFueSA9PT0gXCJcIiB8fCBtb2RhbE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG1vZGFsT3B0aW9ucztcclxuICAgICAgICBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID09PSBcIlwiIHx8IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID09IG51bGwgPyB1bmRlZmluZWQgOiBjdXN0b21TZWxlY3Rvck1vZHVsZVVybDtcclxuICAgICAgICBleHRQYXJhbXMgPSBleHRQYXJhbXMgPT09IFwiXCIgfHwgZXh0UGFyYW1zID09IG51bGwgPyB1bmRlZmluZWQgOiBleHRQYXJhbXM7XHJcbiAgICAgICAgLy/miZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmahcclxuICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2VVaVNlcnZpY2Uub3BlbkJpbGxDcmVhdGlvblByb2Nlc3NTZWxlY3RvcjRTcGVjaWZpY1B1c2goc291cmNlVm9JZCwgdGFyZ2V0Vm9JZCwgYml6Rmxvd2NoYXJ0SWQsIG1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwsIGV4dFBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBARGVwcmVjYXRlZCDlt7LlvIPnlKjvvIzor7fkvb/nlKgge0BsaW5rIG9wZW5UYXJnZXRBcHAgfVxyXG4gICAgICog5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2iXHJcbiAgICAgKiBAcGFyYW0gZm9ybVNldHRpbmdzIOihqOWNlemFjee9rlxyXG4gICAgICogQHBhcmFtIHJlc3VsdCDnlJ/ljZXmtYHnqIvmiafooYznu5PmnpxcclxuICAgICAqIEBwYXJhbSB0YXJnZXRDb21tYW5kIOebruagh+ihqOWNleWRveS7pFxyXG4gICAgICogQHBhcmFtIGV4dFBhcmFtcyDmianlsZXlj4LmlbBcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9wZW5UYXJnZXRGb3JtKGZvcm1TZXR0aW5nczogRm9ybVNldHRpbmdzLCByZXN1bHQ6IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQsIHRhcmdldENvbW1hbmQ/OiBzdHJpbmcsIGV4dFBhcmFtcz86IHt9KSB7XHJcbiAgICAgICAgaWYgKHRhcmdldENvbW1hbmQgPT0gbnVsbCB8fCB0YXJnZXRDb21tYW5kID09IFwiXCIpIHtcclxuICAgICAgICAgICAgdGFyZ2V0Q29tbWFuZCA9IFwicm9vdHZpZXdtb2RlbGJpZkxvYWQxXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5UYXJnZXRGb3JtKGZvcm1TZXR0aW5ncywgcmVzdWx0LCB7IGFjdGlvbjogdGFyZ2V0Q29tbWFuZCwgLi4uZXh0UGFyYW1zIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2iXHJcbiAgICAgKiBAcGFyYW0gZm9ybVNldHRpbmdzIOihqOWNlemFjee9rlxyXG4gICAgICogQHBhcmFtIGNvbmRpdGlvblJlc3VsdCDmiafooYzmnaHku7borqHnrpfnu5PmnpxcclxuICAgICAqIEBwYXJhbSB0YXJnZXRDb21tYW5kIOebruagh+ihqOWNleWRveS7pFxyXG4gICAgICogQHBhcmFtIGV4dFBhcmFtcyDmianlsZXlj4LmlbBcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9wZW5UYXJnZXRBcHAoZm9ybVNldHRpbmdzOiBGb3JtU2V0dGluZ3MsIGNvbmRpdGlvblJlc3VsdDogQ29uZGl0aW9uUmVzdWx0LCB0ZXh0SWRXaXRoRGF0YUlkczogR2VuZXJhbFRleHRJZFdpdGhEYXRhSWRbXSwgdGFyZ2V0Q29tbWFuZD86IHN0cmluZywgZXh0UGFyYW1zPzoge30pIHtcclxuICAgICAgICBpZiAodGFyZ2V0Q29tbWFuZCA9PSBudWxsIHx8IHRhcmdldENvbW1hbmQgPT0gXCJcIikge1xyXG4gICAgICAgICAgICB0YXJnZXRDb21tYW5kID0gXCJyb290dmlld21vZGVsYmlmTG9hZDFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zb3VyY2VVaVNlcnZpY2Uub3BlblRhcmdldEFwcChmb3JtU2V0dGluZ3MsIGNvbmRpdGlvblJlc3VsdCwgdGV4dElkV2l0aERhdGFJZHMsIHsgYWN0aW9uOiB0YXJnZXRDb21tYW5kLCAuLi5leHRQYXJhbXMgfSk7XHJcbiAgICB9XHJcbn0iXX0=