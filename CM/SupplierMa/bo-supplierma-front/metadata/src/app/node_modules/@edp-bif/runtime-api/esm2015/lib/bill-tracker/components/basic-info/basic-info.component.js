/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/components/basic-info/basic-info.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ComponentFactoryResolver, Inject, Injector, Input, LOCALE_ID, Optional, ReflectiveInjector, ViewContainerRef } from "@angular/core";
import { BillDataTable, BillSchemaTable, DataType } from "@edp-aif/common-api";
import { JointQueryMode } from "@edp-bif/common-api";
import { LoadingService } from "@farris/ui-loading";
import { MessagerService } from "@farris/ui-messager";
import { BsModalService } from "@farris/ui-modal";
import { NotifyService } from "@farris/ui-notify";
import { FrameworkService } from "@gsp-sys/rtf-common";
import { BillDataInfo } from "../../../entity/tracking/BillDataInfo";
import { BillInfo } from "../../../entity/tracking/BillInfo";
import { BillTrackerLocalePipe } from "../../pipe/bill-tracker-locale.pipe";
import { BillTrackerDataInfoService } from "../../services/bill-tracker-data-info.service";
import { BillTrackerInternalUiService } from "../../services/bill-tracker-internal-ui.service";
export class BasicInfoComponent {
    /**
     * @param {?} framework
     * @param {?} dataInfoService
     * @param {?} notify
     * @param {?} messager
     * @param {?} loading
     * @param {?} modal
     * @param {?} localePipe
     * @param {?} vcr
     * @param {?} inj
     * @param {?} cfr
     * @param {?} cdr
     * @param {?} localeId
     */
    constructor(framework, dataInfoService, notify, messager, loading, modal, localePipe, vcr, inj, cfr, cdr, localeId) {
        this.framework = framework;
        this.dataInfoService = dataInfoService;
        this.notify = notify;
        this.messager = messager;
        this.loading = loading;
        this.modal = modal;
        this.localePipe = localePipe;
        this.vcr = vcr;
        this.inj = inj;
        this.cfr = cfr;
        this.cdr = cdr;
        this.localeId = localeId;
        this.fieldsWithValue = [];
        this.childSchemaTables = [];
        this.childDataTableMap = {};
        this.dateType = DataType;
        this.secTitle = "";
        this.localeId = localeId || this.inj.get(LOCALE_ID);
        /** @type {?} */
        const inject = ReflectiveInjector.resolveAndCreate([
            BillTrackerInternalUiService
        ], this.inj);
        this.internalUiService = inject.get(BillTrackerInternalUiService, null);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // 设置section标题
        this.secTitle = this.localePipe.transform("basicInfo");
        // 表名解析
        this.secTitle = this.dataInfoService.getTableLabel(this.billInfo, this.schemaTable, this.localeId);
        // 获取带值的字段信息
        this.fieldsWithValue = this.dataInfoService.getBasicInfoFieldsWithValue(this.billInfo, this.schemaTable, this.dataTable);
        // 按order排序
        this.fieldsWithValue = this.dataInfoService.sortFieldsByOrder(this.fieldsWithValue);
        //主表数据
        /** @type {?} */
        const r = this.dataTable.GetRowList()[0];
        // 子表列表
        this.childSchemaTables = this.dataInfoService.getChildTables(this.billInfo, this.schemaTable);
        this.childDataTableMap = r.GetChildTableMap();
        if (this.billInfo.jointQueryParameters != null) {
            /** @type {?} */
            const jointQueryParameters = JSON.parse(this.billInfo.jointQueryParameters);
            this.hasLink = (this.billInfo.jointQueryMode == JointQueryMode.APP && jointQueryParameters.funcId != null)
                || (this.billInfo.jointQueryMode == JointQueryMode.URL && jointQueryParameters.url != null);
        }
        else {
            this.hasLink = false;
        }
    }
    /**
     * @return {?}
     */
    clickLink() {
        this.internalUiService.openBillDetailWithFields(this.billInfo, this.billDataInfo, this.fieldsWithValue);
        event.stopPropagation();
        return false;
    }
}
BasicInfoComponent.decorators = [
    { type: Component, args: [{
                selector: "lib-bill-tracker-main-table",
                template: "<farris-section class=\"f-section-form f-section-in-mainsubcard\" [mainTitle]=\"secTitle\">\r\n    <div class=\"f-form-layout farris-form farris-form-controls-inline\">\r\n        <ng-container *ngFor=\"let field of fieldsWithValue; let i = index\">\r\n            <div class=\"col-12 col-md-6 col-xl-3 col-el-2\" *ngIf=\"field.show\">\r\n                <!-- \u4EC5\u663E\u793Ashow\u5C5E\u6027\u4E3Atrue\u7684\u5B57\u6BB5 -->\r\n                <!-- <div class=\"farris-group-wrap\" *ngIf=\"!(hasLink && i==0); else linkTemp\"> -->\r\n                <div class=\"farris-group-wrap\">\r\n                    <!-- \u975E\u5E03\u5C14\u503C\u4F7F\u7528\u6587\u672C\u6846 -->\r\n                    <div class=\"form-group farris-form-group\" *ngIf=\"field.dataType!=dateType.Boolean\">\r\n                        <label class=\"col-form-label\">\r\n                            <span class=\"farris-label-text\" title=\"{{field | billTrackerFieldLabel}}\">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class=\"farris-input-wrap\">\r\n                            <div class=\"f-component-text\" *ngIf=\"field.dataType!=dateType.Boolean\">\r\n                                <span class=\"f-form-control-text\" title=\"{{field.fieldValue}}\">\r\n                                    {{field.fieldValue}}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- \u5E03\u5C14\u503C\u4F7F\u7528\u590D\u9009\u6846 -->\r\n                    <div class=\"form-group farris-form-group\" *ngIf=\"field.dataType==dateType.Boolean\">\r\n                        <label class=\"col-form-label\">\r\n                            <span class=\"farris-label-text\" title=\"{{field | billTrackerFieldLabel}}\">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class=\"farris-input-wrap\">\r\n                            <div class=\"custom-control custom-checkbox\">\r\n                                <input class=\"custom-control-input\" type=\"checkbox\" readonly\r\n                                    [checked]=\"field.fieldValue\" />\r\n                                <label class=\"custom-control-label\"></label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- \u6709\u8054\u67E5\u914D\u7F6E\u65F6\uFF0C\u9ED8\u8BA4\u53D6\u7B2C\u4E00\u4E2A\u5B57\u6BB5\u4F5C\u4E3A\u8D85\u94FE\u63A5 -->\r\n                <!-- <ng-template #linkTemp> -->\r\n                <!-- <div class=\"farris-group-wrap\"> -->\r\n                <!-- \u975E\u5E03\u5C14\u503C\u94FE\u63A5\u5728value\u4E0A -->\r\n                <!-- <div class=\"form-group farris-form-group\" *ngIf=\"field.dataType!=dateType.Boolean\">\r\n                            <label class=\"col-form-label\">\r\n                                <span class=\"farris-label-text\" title=\"{{field | billTrackerFieldLabel}}\">\r\n                                    {{field | billTrackerFieldLabel}}\r\n                                </span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                                <div class=\"f-component-text\">\r\n                                    <span class=\"f-form-control-text\" title=\"{{field.fieldValue}}\">\r\n                                        <a href=\"javascript:void(0);\" (click)=\"clickLink()\">{{field.fieldValue}}</a>\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div> -->\r\n\r\n                <!-- \u5E03\u5C14\u503C\u94FE\u63A5\u5728label\u4E0A -->\r\n                <!-- <div class=\"form-group farris-form-group\" *ngIf=\"field.dataType==dateType.Boolean\">\r\n                            <label class=\"col-form-label\">\r\n                                <span class=\"farris-label-text\" title=\"{{field | billTrackerFieldLabel}}\">\r\n                                    <a href=\"javascript:void(0);\" (click)=\"clickLink()\">\r\n                                        {{field | billTrackerFieldLabel}}\r\n                                    </a>\r\n                                </span>\r\n                            </label>\r\n                            <div class=\"farris-input-wrap\">\r\n                                <div class=\"farris-input-wrap\">\r\n                                    <div class=\"custom-control custom-checkbox\">\r\n                                        <input class=\"custom-control-input\" type=\"checkbox\" readonly\r\n                                            [checked]=\"field.fieldValue\" />\r\n                                        <label class=\"custom-control-label\"></label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div> -->\r\n                <!-- </div> -->\r\n                <!-- </ng-template> -->\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</farris-section>\r\n<lib-bill-tracker-child-info-list [childSchemaTables]=\"childSchemaTables\" [childDataTableMap]=\"childDataTableMap\"\r\n    [billInfo]=\"billInfo\">\r\n</lib-bill-tracker-child-info-list>"
            }] }
];
/** @nocollapse */
BasicInfoComponent.ctorParameters = () => [
    { type: FrameworkService },
    { type: BillTrackerDataInfoService },
    { type: NotifyService },
    { type: MessagerService },
    { type: LoadingService },
    { type: BsModalService },
    { type: BillTrackerLocalePipe },
    { type: ViewContainerRef },
    { type: Injector },
    { type: ComponentFactoryResolver },
    { type: ChangeDetectorRef },
    { type: String, decorators: [{ type: Optional }, { type: Inject, args: [LOCALE_ID,] }] }
];
BasicInfoComponent.propDecorators = {
    schemaTable: [{ type: Input, args: ["schemaTable",] }],
    dataTable: [{ type: Input, args: ["dataTable",] }],
    billInfo: [{ type: Input, args: ["billInfo",] }],
    billDataInfo: [{ type: Input, args: ["billDataInfo",] }]
};
if (false) {
    /** @type {?} */
    BasicInfoComponent.prototype.schemaTable;
    /** @type {?} */
    BasicInfoComponent.prototype.dataTable;
    /** @type {?} */
    BasicInfoComponent.prototype.billInfo;
    /** @type {?} */
    BasicInfoComponent.prototype.billDataInfo;
    /** @type {?} */
    BasicInfoComponent.prototype.fieldsWithValue;
    /** @type {?} */
    BasicInfoComponent.prototype.childSchemaTables;
    /** @type {?} */
    BasicInfoComponent.prototype.childDataTableMap;
    /** @type {?} */
    BasicInfoComponent.prototype.hasLink;
    /** @type {?} */
    BasicInfoComponent.prototype.dateType;
    /** @type {?} */
    BasicInfoComponent.prototype.secTitle;
    /** @type {?} */
    BasicInfoComponent.prototype.internalUiService;
    /** @type {?} */
    BasicInfoComponent.prototype.framework;
    /** @type {?} */
    BasicInfoComponent.prototype.dataInfoService;
    /** @type {?} */
    BasicInfoComponent.prototype.notify;
    /** @type {?} */
    BasicInfoComponent.prototype.messager;
    /** @type {?} */
    BasicInfoComponent.prototype.loading;
    /** @type {?} */
    BasicInfoComponent.prototype.modal;
    /** @type {?} */
    BasicInfoComponent.prototype.localePipe;
    /** @type {?} */
    BasicInfoComponent.prototype.vcr;
    /** @type {?} */
    BasicInfoComponent.prototype.inj;
    /** @type {?} */
    BasicInfoComponent.prototype.cfr;
    /** @type {?} */
    BasicInfoComponent.prototype.cdr;
    /** @type {?} */
    BasicInfoComponent.prototype.localeId;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWMtaW5mby5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZWRwLWJpZi9ydW50aW1lLWFwaS8iLCJzb3VyY2VzIjpbImxpYi9iaWxsLXRyYWNrZXIvY29tcG9uZW50cy9iYXNpYy1pbmZvL2Jhc2ljLWluZm8uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSx3QkFBd0IsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQVUsUUFBUSxFQUFFLGtCQUFrQixFQUFFLGdCQUFnQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ25MLE9BQU8sRUFBMkIsYUFBYSxFQUF3RSxlQUFlLEVBQXVCLFFBQVEsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ25NLE9BQU8sRUFBa0csY0FBYyxFQUFpRCxNQUFNLHFCQUFxQixDQUFDO0FBQ3BNLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQXVCLGdCQUFnQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDNUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUU3RCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUM1RSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQztBQUMzRixPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQXdCL0YsTUFBTSxPQUFPLGtC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d0NBQXdDOztJQUN4QyxpQ0FBNEI7O0lBQzVCLGlDQUFvQjs7SUFDcEIsaUNBQW9DOztJQUNwQyxpQ0FBNkI7O0lBQzdCLHNDQUFzRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0LCBJbmplY3RvciwgSW5wdXQsIExPQ0FMRV9JRCwgT25Jbml0LCBPcHRpb25hbCwgUmVmbGVjdGl2ZUluamVjdG9yLCBWaWV3Q29udGFpbmVyUmVmIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgQmlsbERhdGEsIEJpbGxEYXRhRmllbGQsIEJpbGxEYXRhVGFibGUsIEJpbGxTY2hlbWEsIEJpbGxTY2hlbWFGaWVsZCwgQmlsbFNjaGVtYUZpZWxkQmFzZSwgQmlsbFNjaGVtYVN1YkZpZWxkLCBCaWxsU2NoZW1hVGFibGUsIEJwbW5Nb2RlbEpzb25IZWxwZXIsIERhdGFUeXBlIH0gZnJvbSBcIkBlZHAtYWlmL2NvbW1vbi1hcGlcIjtcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJTY2hlbWFGaWVsZENvbnRlbnQsIEJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUsIEJpbGxUcmFja2luZ1NldHRpbmdzLCBmdWxsUGF0aFByZWZpeCwgSm9pbnRRdWVyeU1vZGUsIEpvaW50UXVlcnlQYXJhbWV0ZXJzLCBKb2ludFF1ZXJ5UGFyYW1ldGVyVHlwZSB9IGZyb20gXCJAZWRwLWJpZi9jb21tb24tYXBpXCI7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSBcIkBmYXJyaXMvdWktbG9hZGluZ1wiO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1tZXNzYWdlclwiO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLW1vZGFsXCI7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1ub3RpZnlcIjtcclxuaW1wb3J0IHsgQXBwT3B0aW9ucywgQXBwVHlwZSwgRnJhbWV3b3JrU2VydmljZSB9IGZyb20gXCJAZ3NwLXN5cy9ydGYtY29tbW9uXCI7XHJcbmltcG9ydCB7IEJpbGxEYXRhSW5mbyB9IGZyb20gXCIuLi8uLi8uLi9lbnRpdHkvdHJhY2tpbmcvQmlsbERhdGFJbmZvXCI7XHJcbmltcG9ydCB7IEJpbGxJbmZvIH0gZnJvbSBcIi4uLy4uLy4uL2VudGl0eS90cmFja2luZy9CaWxsSW5mb1wiO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckNvbnN0YW50IH0gZnJvbSBcIi4uLy4uL2NvbmZpZy9iaWxsLXRyYWNrZXItY29uc3RhbnRcIjtcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJMb2NhbGVQaXBlIH0gZnJvbSBcIi4uLy4uL3BpcGUvYmlsbC10cmFja2VyLWxvY2FsZS5waXBlXCI7XHJcbmltcG9ydCB7IEJpbGxUcmFja2VyRGF0YUluZm9TZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL2JpbGwtdHJhY2tlci1kYXRhLWluZm8uc2VydmljZVwiO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckludGVybmFsVWlTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL2JpbGwtdHJhY2tlci1pbnRlcm5hbC11aS5zZXJ2aWNlXCI7XHJcblxyXG5kZWNsYXJlIG1vZHVsZSAnQGVkcC1haWYvY29tbW9uLWFwaS9saWIvYmlsbGtpdCcge1xyXG4gICAgZXhwb3J0IGludGVyZmFjZSBLaXRGaWVsZCB7XHJcbiAgICAgICAgZmllbGRWYWx1ZT86IGFueTtcclxuICAgICAgICBjYXB0aW9uUGF0aD86IHN0cmluZztcclxuICAgICAgICBmaWVsZFBhdGg/OiBzdHJpbmc7XHJcbiAgICAgICAgZGlzcGxheU5hbWU/OiBzdHJpbmc7XHJcbiAgICAgICAgb3JkZXI/OiBudW1iZXI7XHJcbiAgICAgICAgc2hvdz86IGJvb2xlYW47XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGludGVyZmFjZSBCaWxsU2NoZW1hVGFibGUge1xyXG4gICAgICAgIGZ1bGxQYXRoPzogc3RyaW5nO1xyXG4gICAgICAgIHNob3c/OiBib29sZWFuO1xyXG4gICAgICAgIG9yZGVyPzogbnVtYmVyO1xyXG4gICAgfVxyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcImxpYi1iaWxsLXRyYWNrZXItbWFpbi10YWJsZVwiLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2Jhc2ljLWluZm8uY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQmFzaWNJbmZvQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIEBJbnB1dChcInNjaGVtYVRhYmxlXCIpXHJcbiAgICBwdWJsaWMgc2NoZW1hVGFibGU6IEJpbGxTY2hlbWFUYWJsZTtcclxuXHJcbiAgICBASW5wdXQoXCJkYXRhVGFibGVcIilcclxuICAgIHB1YmxpYyBkYXRhVGFibGU6IEJpbGxEYXRhVGFibGU7XHJcblxyXG4gICAgQElucHV0KFwiYmlsbEluZm9cIilcclxuICAgIHB1YmxpYyBiaWxsSW5mbzogQmlsbEluZm87XHJcblxyXG4gICAgQElucHV0KFwiYmlsbERhdGFJbmZvXCIpXHJcbiAgICBwdWJsaWMgYmlsbERhdGFJbmZvOiBCaWxsRGF0YUluZm87XHJcblxyXG4gICAgZmllbGRzV2l0aFZhbHVlOiAoQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKVtdID0gW107XHJcbiAgICBjaGlsZFNjaGVtYVRhYmxlczogQmlsbFNjaGVtYVRhYmxlW10gPSBbXTtcclxuICAgIGNoaWxkRGF0YVRhYmxlTWFwOiB7XHJcbiAgICAgICAgW2tleTogc3RyaW5nXTogQmlsbERhdGFUYWJsZTtcclxuICAgIH0gPSB7fTtcclxuICAgIGhhc0xpbms6IGJvb2xlYW47XHJcbiAgICBkYXRlVHlwZSA9IERhdGFUeXBlO1xyXG4gICAgc2VjVGl0bGU6IHN0cmluZyA9IFwiXCI7XHJcblxyXG4gICAgaW50ZXJuYWxVaVNlcnZpY2U6IEJpbGxUcmFja2VySW50ZXJuYWxVaVNlcnZpY2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGZyYW1ld29yazogRnJhbWV3b3JrU2VydmljZSxcclxuICAgICAgICBwdWJsaWMgZGF0YUluZm9TZXJ2aWNlOiBCaWxsVHJhY2tlckRhdGFJbmZvU2VydmljZSxcclxuICAgICAgICBwdWJsaWMgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBtZXNzYWdlcjogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBsb2FkaW5nOiBMb2FkaW5nU2VydmljZSxcclxuICAgICAgICBwdWJsaWMgbW9kYWw6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBsb2NhbGVQaXBlOiBCaWxsVHJhY2tlckxvY2FsZVBpcGUsXHJcbiAgICAgICAgcHVibGljIHZjcjogVmlld0NvbnRhaW5lclJlZixcclxuICAgICAgICBwdWJsaWMgaW5qOiBJbmplY3RvcixcclxuICAgICAgICBwdWJsaWMgY2ZyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICAgICAgcHVibGljIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgQEluamVjdChMT0NBTEVfSUQpIHB1YmxpYyBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVJZCA9IGxvY2FsZUlkIHx8IHRoaXMuaW5qLmdldChMT0NBTEVfSUQpO1xyXG5cclxuICAgICAgICBjb25zdCBpbmplY3QgPSBSZWZsZWN0aXZlSW5qZWN0b3IucmVzb2x2ZUFuZENyZWF0ZShbXHJcbiAgICAgICAgICAgIEJpbGxUcmFja2VySW50ZXJuYWxVaVNlcnZpY2VcclxuICAgICAgICBdLCB0aGlzLmluaik7XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbFVpU2VydmljZSA9IGluamVjdC5nZXQoQmlsbFRyYWNrZXJJbnRlcm5hbFVpU2VydmljZSwgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgLy8g6K6+572uc2VjdGlvbuagh+mimFxyXG4gICAgICAgIHRoaXMuc2VjVGl0bGUgPSB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiYmFzaWNJbmZvXCIpO1xyXG4gICAgICAgIC8vIOihqOWQjeino+aekFxyXG4gICAgICAgIHRoaXMuc2VjVGl0bGUgPSB0aGlzLmRhdGFJbmZvU2VydmljZS5nZXRUYWJsZUxhYmVsKHRoaXMuYmlsbEluZm8sIHRoaXMuc2NoZW1hVGFibGUsIHRoaXMubG9jYWxlSWQpO1xyXG5cclxuICAgICAgICAvLyDojrflj5bluKblgLznmoTlrZfmrrXkv6Hmga9cclxuICAgICAgICB0aGlzLmZpZWxkc1dpdGhWYWx1ZSA9IHRoaXMuZGF0YUluZm9TZXJ2aWNlLmdldEJhc2ljSW5mb0ZpZWxkc1dpdGhWYWx1ZSh0aGlzLmJpbGxJbmZvLCB0aGlzLnNjaGVtYVRhYmxlLCB0aGlzLmRhdGFUYWJsZSk7XHJcbiAgICAgICAgLy8g5oyJb3JkZXLmjpLluo9cclxuICAgICAgICB0aGlzLmZpZWxkc1dpdGhWYWx1ZSA9IHRoaXMuZGF0YUluZm9TZXJ2aWNlLnNvcnRGaWVsZHNCeU9yZGVyKHRoaXMuZmllbGRzV2l0aFZhbHVlKTtcclxuXHJcbiAgICAgICAgLy/kuLvooajmlbDmja5cclxuICAgICAgICBjb25zdCByID0gdGhpcy5kYXRhVGFibGUuR2V0Um93TGlzdCgpWzBdO1xyXG4gICAgICAgIC8vIOWtkOihqOWIl+ihqFxyXG4gICAgICAgIHRoaXMuY2hpbGRTY2hlbWFUYWJsZXMgPSB0aGlzLmRhdGFJbmZvU2VydmljZS5nZXRDaGlsZFRhYmxlcyh0aGlzLmJpbGxJbmZvLCB0aGlzLnNjaGVtYVRhYmxlKTtcclxuICAgICAgICB0aGlzLmNoaWxkRGF0YVRhYmxlTWFwID0gci5HZXRDaGlsZFRhYmxlTWFwKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJpbGxJbmZvLmpvaW50UXVlcnlQYXJhbWV0ZXJzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3Qgam9pbnRRdWVyeVBhcmFtZXRlcnM6IEpvaW50UXVlcnlQYXJhbWV0ZXJzID0gSlNPTi5wYXJzZSh0aGlzLmJpbGxJbmZvLmpvaW50UXVlcnlQYXJhbWV0ZXJzKTtcclxuICAgICAgICAgICAgdGhpcy5oYXNMaW5rID0gKHRoaXMuYmlsbEluZm8uam9pbnRRdWVyeU1vZGUgPT0gSm9pbnRRdWVyeU1vZGUuQVBQICYmIGpvaW50UXVlcnlQYXJhbWV0ZXJzLmZ1bmNJZCAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgfHwgKHRoaXMuYmlsbEluZm8uam9pbnRRdWVyeU1vZGUgPT0gSm9pbnRRdWVyeU1vZGUuVVJMICYmIGpvaW50UXVlcnlQYXJhbWV0ZXJzLnVybCAhPSBudWxsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhhc0xpbmsgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xpY2tMaW5rKCkge1xyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxVaVNlcnZpY2Uub3BlbkJpbGxEZXRhaWxXaXRoRmllbGRzKHRoaXMuYmlsbEluZm8sIHRoaXMuYmlsbERhdGFJbmZvLCB0aGlzLmZpZWxkc1dpdGhWYWx1ZSk7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59Il19