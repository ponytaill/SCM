/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/services/bill-tracker-data.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { BpmnModelJsonHelper } from '@edp-aif/common-api';
import { GetDownBillsInfoArgs } from '../../entity/tracking/GetDownBillsInfoArgs';
import { GetUpBillsInfoArgs } from '../../entity/tracking/GetUpBillsInfoArgs';
import { GetMainEntityDataArgs } from '../args/GetMainEntityDataArgs';
import { CanTrackingResult } from '../args/CanTrackingResult';
import { DownBillInfoResult } from '../args/DownBillInfoResult';
import { UpBillInfoResult } from '../args/UpBillInfoResult';
import { EntityDataResult } from '../args/EntityDataResult';
import { BillDataInfo } from '../../entity/tracking/BillDataInfo';
import { GetBillsInfoArgs } from '../../entity/tracking/GetBillsInfoArgs';
import { JointQueryParameterType } from '@edp-bif/common-api';
import { GetJointQueryParametersArgs } from '../args';
import { JointQueryParameterResult } from '../../entity/tracking/JointQueryParameterResult';
import { JointQueryParametersContent } from '../../entity/tracking/JointQueryParametersContent';
import { ExpressionJointQueryParameterContent } from '../../entity/tracking/ExpressionJointQueryParameterContent';
import { FieldJointQueryParameterContent } from "../../entity/tracking/FieldJointQueryParameterContent";
import { JointQueryParameterMode } from '../../entity/tracking/JointQueryParameterMode';
export class BillTrackerDataService {
    /**
     * @param {?} httpService
     * @param {?} httpClient
     */
    constructor(httpService, httpClient) {
        this.httpService = httpService;
        this.httpClient = httpClient;
        this.baseUrl = "/api/runtime/aif/v1.0/billtracking";
        this.canTrackingUrl = this.baseUrl + "/cantracking";
        this.canTrackingMethod = "POST";
        this.getDownBillsInfoUrl = this.baseUrl + "/getdownbillsinfo";
        this.getDownBillsInfoMethod = "POST";
        this.getUpBillsInfoUrl = this.baseUrl + "/getupbillsinfo";
        this.getUpBillsInfoMethod = "POST";
        this.getEntityDataUrl = this.baseUrl + "/getentitydata";
        this.getEntityDataMethod = "POST";
        this.jointQueryParserUrl = "/api/runtime/aif/v1.0/jointquery";
        this.jointQueryParserMethod = "POST";
    }
    /**
     * @param {?} args
     * @return {?}
     */
    getJointQueryParameters(args) {
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const opt = this.httpService.setHeader({ body: body });
        return this.httpService.request(this.jointQueryParserMethod, this.jointQueryParserUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            let obj = res;
            /** @type {?} */
            const results = (/** @type {?} */ (BpmnModelJsonHelper.FromJson(obj.value, JointQueryParameterResult)));
            return of(results);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * @param {?} args
     * @return {?}
     */
    canTracking(args) {
        /** @type {?} */
        const opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.canTrackingMethod, this.canTrackingUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            let result = new CanTrackingResult();
            result.LoadFromJson(res);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * @param {?} args
     * @return {?}
     */
    getDownBillsInfo(args) {
        /** @type {?} */
        const opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getDownBillsInfoMethod, this.getDownBillsInfoUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            let result = BpmnModelJsonHelper.FromJson(res, DownBillInfoResult);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * @param {?} args
     * @return {?}
     */
    getUpBillsInfo(args) {
        /** @type {?} */
        const opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getUpBillsInfoMethod, this.getUpBillsInfoUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            let result = BpmnModelJsonHelper.FromJson(res, UpBillInfoResult);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * @param {?} args
     * @return {?}
     */
    getEntityData(args) {
        /** @type {?} */
        const opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getEntityDataMethod, this.getEntityDataUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            const result = new EntityDataResult();
            result.LoadFromJson(res);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * @param {?} canTrackingResult
     * @return {?}
     */
    buildEntryBillInfo(canTrackingResult) {
        /** @type {?} */
        const info = new DownBillInfoResult();
        info.schemaId = canTrackingResult.schemaId;
        info.suCode = canTrackingResult.suCode;
        info.voName = canTrackingResult.voName;
        info.billTrackingSettings = canTrackingResult.billTrackingSettings;
        info.bizKind = canTrackingResult.bizKind;
        info.bizType = canTrackingResult.bizType;
        info.jointQueryMode = canTrackingResult.jointQueryMode;
        info.jointQueryParameters = canTrackingResult.jointQueryParameters;
        info.trackingSourceType = canTrackingResult.trackingSourceType;
        /** @type {?} */
        const dataInfo = new BillDataInfo();
        dataInfo.caption = canTrackingResult.caption;
        dataInfo.dataId = canTrackingResult.dataId;
        dataInfo.summary = canTrackingResult.summary;
        dataInfo.trackingMappingAssociations = [];
        dataInfo.billChildInfos = canTrackingResult.billChildInfos;
        dataInfo.curYear = canTrackingResult.curYear;
        info.billDataInfos = [dataInfo];
        info.documentTypeId = canTrackingResult.documentTypeId;
        return info;
    }
    /**
     * @param {?} cell
     * @return {?}
     */
    buildGetBillsInfoArgs(cell) {
        /** @type {?} */
        const args = new GetBillsInfoArgs();
        args.billDataId = cell.billDataInfo.dataId;
        args.documentTypeId = cell.billInfo.documentTypeId;
        args.bizKind = cell.billInfo.bizKind;
        args.bizType = cell.billInfo.bizType;
        args.billChildInfos = cell.billDataInfo.billChildInfos;
        args.curYear = cell.billDataInfo.curYear;
        return args;
    }
    /**
     * @param {?} cell
     * @return {?}
     */
    buildGetUpBillsInfoArgs(cell) {
        /** @type {?} */
        const args = new GetUpBillsInfoArgs();
        args.LoadFromJsonObject(this.buildGetBillsInfoArgs(cell).ConvertToJsonObject());
        return args;
    }
    /**
     * @param {?} cell
     * @return {?}
     */
    buildGetDownBillsInfoArgs(cell) {
        /** @type {?} */
        const args = new GetDownBillsInfoArgs();
        args.LoadFromJsonObject(this.buildGetBillsInfoArgs(cell).ConvertToJsonObject());
        return args;
    }
    /**
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    buildGetMainEntityDataArgs(billInfo, billDataInfo) {
        /** @type {?} */
        const args = new GetMainEntityDataArgs();
        args.dataId = billDataInfo.dataId;
        args.suCode = billInfo.suCode;
        args.schemaId = billInfo.schemaId;
        args.trackingSourceType = billInfo.trackingSourceType;
        args.billChildInfos = billDataInfo.billChildInfos;
        args.curYear = billDataInfo.curYear;
        return args;
    }
    /**
     * @param {?} jointQueryParameters
     * @return {?}
     */
    hasDynamicParams(jointQueryParameters) {
        if (!jointQueryParameters.params) {
            return false;
        }
        // 添加自定义参数
        if (Array.isArray(jointQueryParameters.params)) {
            return jointQueryParameters.params.find((/**
             * @param {?} p
             * @return {?}
             */
            (p) => p.type != JointQueryParameterType.Constant)) != null;
        }
        else {
            return false;
        }
    }
    /**
     * 构造联查参数解析器参数
     * @param {?} jointQueryParameters
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    buildGetJointQueryParametersArgs(jointQueryParameters, billInfo, billDataInfo) {
        /** @type {?} */
        const args = new GetJointQueryParametersArgs();
        args.dataId = billDataInfo.dataId;
        args.suCode = billInfo.suCode;
        args.schemaId = billInfo.schemaId;
        args.trackingSourceType = billInfo.trackingSourceType;
        args.contents = [];
        if (Array.isArray(jointQueryParameters.params)) {
            jointQueryParameters.params.forEach((/**
             * @param {?} it
             * @return {?}
             */
            it => {
                if (it.type == JointQueryParameterType.Constant) {
                    return;
                }
                /** @type {?} */
                const jointQueryParametersContent = new JointQueryParametersContent();
                if (it.type == JointQueryParameterType.Field) {
                    jointQueryParametersContent.jointQueryParameterMode = JointQueryParameterMode.FIELD;
                    /** @type {?} */
                    const content = new FieldJointQueryParameterContent();
                    content.parameterCode = it.code;
                    content.fieldContent = it.value;
                    jointQueryParametersContent.content = content.ConvertToJson();
                }
                else if (it.type == JointQueryParameterType.Expression) {
                    jointQueryParametersContent.jointQueryParameterMode = JointQueryParameterMode.EXPRESSION;
                    /** @type {?} */
                    const content = new ExpressionJointQueryParameterContent();
                    content.parameterCode = it.code;
                    content.expressionContent = it.value;
                    jointQueryParametersContent.content = content.ConvertToJson();
                }
                args.contents.push(jointQueryParametersContent);
            }));
        }
        return args;
    }
}
BillTrackerDataService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
BillTrackerDataService.ctorParameters = () => [
    { type: HttpService },
    { type: HttpClient }
];
if (false) {
    /** @type {?} */
    BillTrackerDataService.prototype.baseUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.canTrackingUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.canTrackingMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getDownBillsInfoUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getDownBillsInfoMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getUpBillsInfoUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getUpBillsInfoMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getEntityDataUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getEntityDataMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.jointQueryParserUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.jointQueryParserMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.httpService;
    /** @type {?} */
    BillTrackerDataService.prototype.httpClient;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC10cmFja2VyLWRhdGEuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYmlmL3J1bnRpbWUtYXBpLyIsInNvdXJjZXMiOlsibGliL2JpbGwtdHJhY2tlci9zZXJ2aWNlcy9iaWxsLXRyYWNrZXItZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDbEQsT0FBTyxFQUFjLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN0QyxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUNsRixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUM5RSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUN0RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM1RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUU1RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFFbEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFFMUUsT0FBTyxFQUE2Qyx1QkFBdUIsRUFBRSxNQUFNLHFCQUFxQixD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XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgQnBtbk1vZGVsSnNvbkhlbHBlciB9IGZyb20gJ0BlZHAtYWlmL2NvbW1vbi1hcGknO1xyXG5pbXBvcnQgeyBHZXREb3duQmlsbHNJbmZvQXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9HZXREb3duQmlsbHNJbmZvQXJncyc7XHJcbmltcG9ydCB7IEdldFVwQmlsbHNJbmZvQXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9HZXRVcEJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBHZXRNYWluRW50aXR5RGF0YUFyZ3MgfSBmcm9tICcuLi9hcmdzL0dldE1haW5FbnRpdHlEYXRhQXJncyc7XHJcbmltcG9ydCB7IENhblRyYWNraW5nUmVzdWx0IH0gZnJvbSAnLi4vYXJncy9DYW5UcmFja2luZ1Jlc3VsdCc7XHJcbmltcG9ydCB7IERvd25CaWxsSW5mb1Jlc3VsdCB9IGZyb20gJy4uL2FyZ3MvRG93bkJpbGxJbmZvUmVzdWx0JztcclxuaW1wb3J0IHsgVXBCaWxsSW5mb1Jlc3VsdCB9IGZyb20gJy4uL2FyZ3MvVXBCaWxsSW5mb1Jlc3VsdCc7XHJcbmltcG9ydCB7IEVudGl0eURhdGFSZXN1bHQgfSBmcm9tICcuLi9hcmdzL0VudGl0eURhdGFSZXN1bHQnO1xyXG5pbXBvcnQgeyBJQmlsbFRyYWNrZXJEYXRhU2VydmljZSB9IGZyb20gJy4uL2Jhc2UvSUJpbGxUcmFja2VyRGF0YVNlcnZpY2UnO1xyXG5pbXBvcnQgeyBCaWxsRGF0YUluZm8gfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvQmlsbERhdGFJbmZvJztcclxuaW1wb3J0IHsgQmlsbENlbGwgfSBmcm9tICcuLi9teGdyYXBoLWV4dC9CaWxsQ2VsbCc7XHJcbmltcG9ydCB7IEdldEJpbGxzSW5mb0FyZ3MgfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvR2V0QmlsbHNJbmZvQXJncyc7XHJcbmltcG9ydCB7IEJpbGxJbmZvIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0JpbGxJbmZvJztcclxuaW1wb3J0IHsgSm9pbnRRdWVyeVBhcmFtZXRlciwgSm9pbnRRdWVyeVBhcmFtZXRlcnMsIEpvaW50UXVlcnlQYXJhbWV0ZXJUeXBlIH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IEdldEpvaW50UXVlcnlQYXJhbWV0ZXJzQXJncyB9IGZyb20gJy4uL2FyZ3MnO1xyXG5pbXBvcnQgeyBKb2ludFF1ZXJ5UGFyYW1ldGVyUmVzdWx0IH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0pvaW50UXVlcnlQYXJhbWV0ZXJSZXN1bHQnO1xyXG5pbXBvcnQgeyBKb2ludFF1ZXJ5UGFyYW1ldGVyc0NvbnRlbnQgfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvSm9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50JztcclxuaW1wb3J0IHsgRXhwcmVzc2lvbkpvaW50UXVlcnlQYXJhbWV0ZXJDb250ZW50IH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0V4cHJlc3Npb25Kb2ludFF1ZXJ5UGFyYW1ldGVyQ29udGVudCc7XHJcbmltcG9ydCB7IEZpZWxkSm9pbnRRdWVyeVBhcmFtZXRlckNvbnRlbnQgfSBmcm9tIFwiLi4vLi4vZW50aXR5L3RyYWNraW5nL0ZpZWxkSm9pbnRRdWVyeVBhcmFtZXRlckNvbnRlbnRcIjtcclxuaW1wb3J0IHsgSm9pbnRRdWVyeVBhcmFtZXRlck1vZGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvSm9pbnRRdWVyeVBhcmFtZXRlck1vZGUnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQmlsbFRyYWNrZXJEYXRhU2VydmljZSBpbXBsZW1lbnRzIElCaWxsVHJhY2tlckRhdGFTZXJ2aWNlIHtcclxuICAgIHJlYWRvbmx5IGJhc2VVcmwgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9iaWxsdHJhY2tpbmdcIjtcclxuXHJcbiAgICByZWFkb25seSBjYW5UcmFja2luZ1VybCA9IHRoaXMuYmFzZVVybCArIFwiL2NhbnRyYWNraW5nXCI7XHJcbiAgICByZWFkb25seSBjYW5UcmFja2luZ01ldGhvZCA9IFwiUE9TVFwiO1xyXG5cclxuICAgIHJlYWRvbmx5IGdldERvd25CaWxsc0luZm9VcmwgPSB0aGlzLmJhc2VVcmwgKyBcIi9nZXRkb3duYmlsbHNpbmZvXCI7XHJcbiAgICByZWFkb25seSBnZXREb3duQmlsbHNJbmZvTWV0aG9kID0gXCJQT1NUXCI7XHJcblxyXG4gICAgcmVhZG9ubHkgZ2V0VXBCaWxsc0luZm9VcmwgPSB0aGlzLmJhc2VVcmwgKyBcIi9nZXR1cGJpbGxzaW5mb1wiO1xyXG4gICAgcmVhZG9ubHkgZ2V0VXBCaWxsc0luZm9NZXRob2QgPSBcIlBPU1RcIjtcclxuXHJcbiAgICByZWFkb25seSBnZXRFbnRpdHlEYXRhVXJsID0gdGhpcy5iYXNlVXJsICsgXCIvZ2V0ZW50aXR5ZGF0YVwiO1xyXG4gICAgcmVhZG9ubHkgZ2V0RW50aXR5RGF0YU1ldGhvZCA9IFwiUE9TVFwiO1xyXG5cclxuICAgIHJlYWRvbmx5IGpvaW50UXVlcnlQYXJzZXJVcmwgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9qb2ludHF1ZXJ5XCI7XHJcbiAgICByZWFkb25seSBqb2ludFF1ZXJ5UGFyc2VyTWV0aG9kID0gXCJQT1NUXCI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGh0dHBTZXJ2aWNlOiBIdHRwU2VydmljZSxcclxuICAgICAgICBwdWJsaWMgaHR0cENsaWVudDogSHR0cENsaWVudCxcclxuICAgICkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Sm9pbnRRdWVyeVBhcmFtZXRlcnMoYXJnczogR2V0Sm9pbnRRdWVyeVBhcmFtZXRlcnNBcmdzKTogT2JzZXJ2YWJsZTxKb2ludFF1ZXJ5UGFyYW1ldGVyUmVzdWx0W10+IHtcclxuICAgICAgICBjb25zdCBib2R5ID0gYXJncy5Db252ZXJ0VG9Kc29uKCk7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0gdGhpcy5odHRwU2VydmljZS5zZXRIZWFkZXIoeyBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5qb2ludFF1ZXJ5UGFyc2VyTWV0aG9kLCB0aGlzLmpvaW50UXVlcnlQYXJzZXJVcmwsIG9wdCkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG9iajogeyB2YWx1ZTogc3RyaW5nIH0gPSByZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IEJwbW5Nb2RlbEpzb25IZWxwZXIuRnJvbUpzb24ob2JqLnZhbHVlLCBKb2ludFF1ZXJ5UGFyYW1ldGVyUmVzdWx0KSBhcyBKb2ludFF1ZXJ5UGFyYW1ldGVyUmVzdWx0W107XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2FuVHJhY2tpbmcoYXJnczogR2V0RG93bkJpbGxzSW5mb0FyZ3MpOiBPYnNlcnZhYmxlPENhblRyYWNraW5nUmVzdWx0PiB7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0gdGhpcy5odHRwU2VydmljZS5zZXRIZWFkZXIoeyBib2R5OiBhcmdzLkNvbnZlcnRUb0pzb24oKSwgcmVzcG9uc2VUeXBlOiBcInRleHRcIiB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5yZXF1ZXN0KHRoaXMuY2FuVHJhY2tpbmdNZXRob2QsIHRoaXMuY2FuVHJhY2tpbmdVcmwsIG9wdCkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogQ2FuVHJhY2tpbmdSZXN1bHQgPSBuZXcgQ2FuVHJhY2tpbmdSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuTG9hZEZyb21Kc29uKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXREb3duQmlsbHNJbmZvKGFyZ3M6IEdldERvd25CaWxsc0luZm9BcmdzKTogT2JzZXJ2YWJsZTxEb3duQmlsbEluZm9SZXN1bHRbXT4ge1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHRoaXMuaHR0cFNlcnZpY2Uuc2V0SGVhZGVyKHsgYm9keTogYXJncy5Db252ZXJ0VG9Kc29uKCksIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucmVxdWVzdCh0aGlzLmdldERvd25CaWxsc0luZm9NZXRob2QsIHRoaXMuZ2V0RG93bkJpbGxzSW5mb1VybCwgb3B0KS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgICAgICAgICAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBEb3duQmlsbEluZm9SZXN1bHRbXSA9IEJwbW5Nb2RlbEpzb25IZWxwZXIuRnJvbUpzb24ocmVzLCBEb3duQmlsbEluZm9SZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0VXBCaWxsc0luZm8oYXJnczogR2V0VXBCaWxsc0luZm9BcmdzKTogT2JzZXJ2YWJsZTxVcEJpbGxJbmZvUmVzdWx0W10+IHtcclxuICAgICAgICBjb25zdCBvcHQgPSB0aGlzLmh0dHBTZXJ2aWNlLnNldEhlYWRlcih7IGJvZHk6IGFyZ3MuQ29udmVydFRvSnNvbigpLCByZXNwb25zZVR5cGU6IFwidGV4dFwiIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZXRVcEJpbGxzSW5mb01ldGhvZCwgdGhpcy5nZXRVcEJpbGxzSW5mb1VybCwgb3B0KS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgICAgICAgICAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBVcEJpbGxJbmZvUmVzdWx0W10gPSBCcG1uTW9kZWxKc29uSGVscGVyLkZyb21Kc29uKHJlcywgVXBCaWxsSW5mb1Jlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRFbnRpdHlEYXRhKGFyZ3M6IEdldE1haW5FbnRpdHlEYXRhQXJncyk6IE9ic2VydmFibGU8RW50aXR5RGF0YVJlc3VsdD4ge1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHRoaXMuaHR0cFNlcnZpY2Uuc2V0SGVhZGVyKHsgYm9keTogYXJncy5Db252ZXJ0VG9Kc29uKCksIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucmVxdWVzdCh0aGlzLmdldEVudGl0eURhdGFNZXRob2QsIHRoaXMuZ2V0RW50aXR5RGF0YVVybCwgb3B0KS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgICAgICAgICAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgRW50aXR5RGF0YVJlc3VsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5Mb2FkRnJvbUpzb24ocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2YocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGJ1aWxkRW50cnlCaWxsSW5mbyhjYW5UcmFja2luZ1Jlc3VsdDogQ2FuVHJhY2tpbmdSZXN1bHQpIHtcclxuICAgICAgICBjb25zdCBpbmZvID0gbmV3IERvd25CaWxsSW5mb1Jlc3VsdCgpO1xyXG4gICAgICAgIGluZm8uc2NoZW1hSWQgPSBjYW5UcmFja2luZ1Jlc3VsdC5zY2hlbWFJZDtcclxuICAgICAgICBpbmZvLnN1Q29kZSA9IGNhblRyYWNraW5nUmVzdWx0LnN1Q29kZTtcclxuICAgICAgICBpbmZvLnZvTmFtZSA9IGNhblRyYWNraW5nUmVzdWx0LnZvTmFtZTtcclxuICAgICAgICBpbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzID0gY2FuVHJhY2tpbmdSZXN1bHQuYmlsbFRyYWNraW5nU2V0dGluZ3M7XHJcbiAgICAgICAgaW5mby5iaXpLaW5kID0gY2FuVHJhY2tpbmdSZXN1bHQuYml6S2luZDtcclxuICAgICAgICBpbmZvLmJpelR5cGUgPSBjYW5UcmFja2luZ1Jlc3VsdC5iaXpUeXBlO1xyXG4gICAgICAgIGluZm8uam9pbnRRdWVyeU1vZGUgPSBjYW5UcmFja2luZ1Jlc3VsdC5qb2ludFF1ZXJ5TW9kZTtcclxuICAgICAgICBpbmZvLmpvaW50UXVlcnlQYXJhbWV0ZXJzID0gY2FuVHJhY2tpbmdSZXN1bHQuam9pbnRRdWVyeVBhcmFtZXRlcnM7XHJcbiAgICAgICAgaW5mby50cmFja2luZ1NvdXJjZVR5cGUgPSBjYW5UcmFja2luZ1Jlc3VsdC50cmFja2luZ1NvdXJjZVR5cGU7XHJcbiAgICAgICAgY29uc3QgZGF0YUluZm8gPSBuZXcgQmlsbERhdGFJbmZvKCk7XHJcbiAgICAgICAgZGF0YUluZm8uY2FwdGlvbiA9IGNhblRyYWNraW5nUmVzdWx0LmNhcHRpb247XHJcbiAgICAgICAgZGF0YUluZm8uZGF0YUlkID0gY2FuVHJhY2tpbmdSZXN1bHQuZGF0YUlkO1xyXG4gICAgICAgIGRhdGFJbmZvLnN1bW1hcnkgPSBjYW5UcmFja2luZ1Jlc3VsdC5zdW1tYXJ5O1xyXG4gICAgICAgIGRhdGFJbmZvLnRyYWNraW5nTWFwcGluZ0Fzc29jaWF0aW9ucyA9IFtdO1xyXG4gICAgICAgIGRhdGFJbmZvLmJpbGxDaGlsZEluZm9zID0gY2FuVHJhY2tpbmdSZXN1bHQuYmlsbENoaWxkSW5mb3M7XHJcbiAgICAgICAgZGF0YUluZm8uY3VyWWVhciA9IGNhblRyYWNraW5nUmVzdWx0LmN1clllYXI7XHJcbiAgICAgICAgaW5mby5iaWxsRGF0YUluZm9zID0gW2RhdGFJbmZvXTtcclxuICAgICAgICBpbmZvLmRvY3VtZW50VHlwZUlkID0gY2FuVHJhY2tpbmdSZXN1bHQuZG9jdW1lbnRUeXBlSWQ7XHJcblxyXG4gICAgICAgIHJldHVybiBpbmZvO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBidWlsZEdldEJpbGxzSW5mb0FyZ3MoY2VsbDogQmlsbENlbGwpIHtcclxuICAgICAgICBjb25zdCBhcmdzID0gbmV3IEdldEJpbGxzSW5mb0FyZ3MoKTtcclxuICAgICAgICBhcmdzLmJpbGxEYXRhSWQgPSBjZWxsLmJpbGxEYXRhSW5mby5kYXRhSWQ7XHJcbiAgICAgICAgYXJncy5kb2N1bWVudFR5cGVJZCA9IGNlbGwuYmlsbEluZm8uZG9jdW1lbnRUeXBlSWQ7XHJcbiAgICAgICAgYXJncy5iaXpLaW5kID0gY2VsbC5iaWxsSW5mby5iaXpLaW5kO1xyXG4gICAgICAgIGFyZ3MuYml6VHlwZSA9IGNlbGwuYmlsbEluZm8uYml6VHlwZTtcclxuICAgICAgICBhcmdzLmJpbGxDaGlsZEluZm9zID0gY2VsbC5iaWxsRGF0YUluZm8uYmlsbENoaWxkSW5mb3M7XHJcbiAgICAgICAgYXJncy5jdXJZZWFyID0gY2VsbC5iaWxsRGF0YUluZm8uY3VyWWVhcjtcclxuICAgICAgICByZXR1cm4gYXJncztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYnVpbGRHZXRVcEJpbGxzSW5mb0FyZ3MoY2VsbDogQmlsbENlbGwpIHtcclxuICAgICAgICBjb25zdCBhcmdzID0gbmV3IEdldFVwQmlsbHNJbmZvQXJncygpO1xyXG4gICAgICAgIGFyZ3MuTG9hZEZyb21Kc29uT2JqZWN0KHRoaXMuYnVpbGRHZXRCaWxsc0luZm9BcmdzKGNlbGwpLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGJ1aWxkR2V0RG93bkJpbGxzSW5mb0FyZ3MoY2VsbDogQmlsbENlbGwpIHtcclxuICAgICAgICBjb25zdCBhcmdzID0gbmV3IEdldERvd25CaWxsc0luZm9BcmdzKCk7XHJcbiAgICAgICAgYXJncy5Mb2FkRnJvbUpzb25PYmplY3QodGhpcy5idWlsZEdldEJpbGxzSW5mb0FyZ3MoY2VsbCkuQ29udmVydFRvSnNvbk9iamVjdCgpKTtcclxuICAgICAgICByZXR1cm4gYXJncztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYnVpbGRHZXRNYWluRW50aXR5RGF0YUFyZ3MoYmlsbEluZm86IEJpbGxJbmZvLCBiaWxsRGF0YUluZm86IEJpbGxEYXRhSW5mbyk6IEdldE1haW5FbnRpdHlEYXRhQXJncyB7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IG5ldyBHZXRNYWluRW50aXR5RGF0YUFyZ3MoKTtcclxuICAgICAgICBhcmdzLmRhdGFJZCA9IGJpbGxEYXRhSW5mby5kYXRhSWQ7XHJcbiAgICAgICAgYXJncy5zdUNvZGUgPSBiaWxsSW5mby5zdUNvZGU7XHJcbiAgICAgICAgYXJncy5zY2hlbWFJZCA9IGJpbGxJbmZvLnNjaGVtYUlkO1xyXG4gICAgICAgIGFyZ3MudHJhY2tpbmdTb3VyY2VUeXBlID0gYmlsbEluZm8udHJhY2tpbmdTb3VyY2VUeXBlO1xyXG4gICAgICAgIGFyZ3MuYmlsbENoaWxkSW5mb3MgPSBiaWxsRGF0YUluZm8uYmlsbENoaWxkSW5mb3M7XHJcbiAgICAgICAgYXJncy5jdXJZZWFyID0gYmlsbERhdGFJbmZvLmN1clllYXI7XHJcblxyXG4gICAgICAgIHJldHVybiBhcmdzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBoYXNEeW5hbWljUGFyYW1zKGpvaW50UXVlcnlQYXJhbWV0ZXJzOiBKb2ludFF1ZXJ5UGFyYW1ldGVycykge1xyXG4gICAgICAgIGlmICgham9pbnRRdWVyeVBhcmFtZXRlcnMucGFyYW1zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5re75Yqg6Ieq5a6a5LmJ5Y+C5pWwXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoam9pbnRRdWVyeVBhcmFtZXRlcnMucGFyYW1zKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gam9pbnRRdWVyeVBhcmFtZXRlcnMucGFyYW1zLmZpbmQoKHApID0+IHAudHlwZSAhPSBKb2ludFF1ZXJ5UGFyYW1ldGVyVHlwZS5Db25zdGFudCkgIT0gbnVsbDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p6E6YCg6IGU5p+l5Y+C5pWw6Kej5p6Q5Zmo5Y+C5pWwXHJcbiAgICAgKiBAcGFyYW0gam9pbnRRdWVyeVBhcmFtZXRlcnMgXHJcbiAgICAgKiBAcGFyYW0gYmlsbEluZm8gXHJcbiAgICAgKiBAcGFyYW0gYmlsbERhdGFJbmZvIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBidWlsZEdldEpvaW50UXVlcnlQYXJhbWV0ZXJzQXJncyhqb2ludFF1ZXJ5UGFyYW1ldGVyczogSm9pbnRRdWVyeVBhcmFtZXRlcnMsIGJpbGxJbmZvOiBCaWxsSW5mbywgYmlsbERhdGFJbmZvOiBCaWxsRGF0YUluZm8pOiBHZXRKb2ludFF1ZXJ5UGFyYW1ldGVyc0FyZ3Mge1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgR2V0Sm9pbnRRdWVyeVBhcmFtZXRlcnNBcmdzKCk7XHJcblxyXG4gICAgICAgIGFyZ3MuZGF0YUlkID0gYmlsbERhdGFJbmZvLmRhdGFJZDtcclxuICAgICAgICBhcmdzLnN1Q29kZSA9IGJpbGxJbmZvLnN1Q29kZTtcclxuICAgICAgICBhcmdzLnNjaGVtYUlkID0gYmlsbEluZm8uc2NoZW1hSWQ7XHJcbiAgICAgICAgYXJncy50cmFja2luZ1NvdXJjZVR5cGUgPSBiaWxsSW5mby50cmFja2luZ1NvdXJjZVR5cGU7XHJcblxyXG4gICAgICAgIGFyZ3MuY29udGVudHMgPSBbXTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShqb2ludFF1ZXJ5UGFyYW1ldGVycy5wYXJhbXMpKSB7XHJcbiAgICAgICAgICAgIGpvaW50UXVlcnlQYXJhbWV0ZXJzLnBhcmFtcy5mb3JFYWNoKGl0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdC50eXBlID09IEpvaW50UXVlcnlQYXJhbWV0ZXJUeXBlLkNvbnN0YW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgam9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50ID0gbmV3IEpvaW50UXVlcnlQYXJhbWV0ZXJzQ29udGVudCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0LnR5cGUgPT0gSm9pbnRRdWVyeVBhcmFtZXRlclR5cGUuRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBqb2ludFF1ZXJ5UGFyYW1ldGVyc0NvbnRlbnQuam9pbnRRdWVyeVBhcmFtZXRlck1vZGUgPSBKb2ludFF1ZXJ5UGFyYW1ldGVyTW9kZS5GSUVMRDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbmV3IEZpZWxkSm9pbnRRdWVyeVBhcmFtZXRlckNvbnRlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LnBhcmFtZXRlckNvZGUgPSBpdC5jb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuZmllbGRDb250ZW50ID0gaXQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgam9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50LmNvbnRlbnQgPSBjb250ZW50LkNvbnZlcnRUb0pzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXQudHlwZSA9PSBKb2ludFF1ZXJ5UGFyYW1ldGVyVHlwZS5FeHByZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgam9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50LmpvaW50UXVlcnlQYXJhbWV0ZXJNb2RlID0gSm9pbnRRdWVyeVBhcmFtZXRlck1vZGUuRVhQUkVTU0lPTjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbmV3IEV4cHJlc3Npb25Kb2ludFF1ZXJ5UGFyYW1ldGVyQ29udGVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQucGFyYW1ldGVyQ29kZSA9IGl0LmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5leHByZXNzaW9uQ29udGVudCA9IGl0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGpvaW50UXVlcnlQYXJhbWV0ZXJzQ29udGVudC5jb250ZW50ID0gY29udGVudC5Db252ZXJ0VG9Kc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYXJncy5jb250ZW50cy5wdXNoKGpvaW50UXVlcnlQYXJhbWV0ZXJzQ29udGVudCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJncztcclxuICAgIH1cclxufSJdfQ==