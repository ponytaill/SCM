/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { DialogComponent } from '@farris/ui-dialog';
import { ApprovalItemEntity } from './entities/approval-item.entity';
import { HttpService } from '@ecp-caf/caf-common';
import { MessagerService } from '@farris/ui-messager';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { DatagridComponent } from '@farris/ui-datagrid';
import { ProcessDeUtil } from '../../domain/process-de-util';
var ApprovelItemsComponent = /** @class */ (function () {
    function ApprovelItemsComponent(formBuilder, message, util, http, uiState) {
        this.formBuilder = formBuilder;
        this.message = message;
        this.util = util;
        this.http = http;
        this.uiState = uiState;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.modalConfig = {
            title: '审批选项',
            width: 880,
            height: 515,
            showButtons: true
        };
        this.workFlowActions = [
            { text: '正向', value: 'Forward' },
            { text: '反向', value: 'Backward' },
            { text: '终止', value: 'Abort' }
        ];
        this.columns = [
            {
                field: 'value', width: 80, title: '编号',
            },
            { field: 'text', width: 80, title: '名称' },
            {
                field: 'workFlowAction', width: 80, title: '流转方向',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.workFlowActions }
                },
                editor: {
                    type: EditorTypes.COMBOLIST,
                    options: { valueField: 'value', textField: 'text', data: this.workFlowActions, idField: 'value', panelHeight: 'auto' }
                },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'isDefault', width: 60, title: '默认',
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: '是', falseText: '否' } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'commentNecessary', width: 60, title: '意见必填',
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: '是', falseText: '否' } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'attachmentNecessary', width: 60, title: '附件上传',
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: '是', falseText: '否' } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            },
            {
                field: 'certification', width: 60, title: '数字签名',
                editor: {
                    type: EditorTypes.SWITCH,
                    options: {}
                },
                formatter: { type: 'boolean', options: { trueText: '是', falseText: '否' } },
                validators: [
                    { type: 'required', messager: '必填' }
                ]
            }
        ];
        this.data = [];
        this.actionsCols = [
            { title: '编号', field: 'code', width: 80 },
            { title: '名称', field: 'name', width: 90 }
        ];
    }
    Object.defineProperty(ApprovelItemsComponent.prototype, "value", {
        set: /**
         * @param {?} items
         * @return {?}
         */
        function (items) {
            var e_1, _a;
            if (items && items.length > 0) {
                try {
                    for (var items_1 = tslib_1.__values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {
                        var item = items_1_1.value;
                        /** @type {?} */
                        var approval = new ApprovalItemEntity();
                        approval.value = item.Value;
                        approval.text = item.Text;
                        approval.workFlowAction = item.WorkFlowAction;
                        approval.isDefault = item.IsDefault;
                        if (item.commentNecessary === null || item.commentNecessary === undefined) {
                            approval.commentNecessary = (item.Value === 'Back' ? true : false);
                        }
                        else {
                            approval.commentNecessary = item.commentNecessary;
                        }
                        approval.certification = item.certification ? item.certification : false;
                        approval.attachmentNecessary = item.attachmentNecessary ? item.attachmentNecessary : false;
                        this.data.push(approval);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.getActionsList();
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        if (this.validator()) {
            /** @type {?} */
            var object = { value: this.data, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @private
     * @return {?}
     */
    ApprovelItemsComponent.prototype.validator = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.data.findIndex((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return !d.workFlowAction; })) > -1) {
            this.message.warning('审批项流转方向不允许为空，请修改！');
            return false;
        }
        return true;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    ApprovelItemsComponent.prototype.selectChanged = /**
     * @param {?} data
     * @return {?}
     */
    function (data) { };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.deleteRow = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.grid.endCellEdit();
        if (this.grid.selectedRow && this.grid.selectedRow.data) {
            /** @type {?} */
            var i = this.data.findIndex((/**
             * @param {?} d
             * @return {?}
             */
            function (d) { return d.value === _this.grid.selectedRow.data.value; }));
            this.data.splice(i, 1);
            this.grid.loadData(this.data);
        }
        else {
            this.message.info('请首先选中一条选项！');
        }
    };
    /**
     * @private
     * @return {?}
     */
    ApprovelItemsComponent.prototype.getActionsList = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var url = this.util.getApprovalActionWebApi() + '?';
        if (this.uiState.bizActivityId) {
            url += "bizActivityId=" + this.uiState.bizActivityId;
        }
        else {
            url += "bizActivityId=";
        }
        this.http.get(url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            data = data.filter((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return _this.actionValidate(a); }));
            _this.actions = data;
        }));
    };
    /**
     * @return {?}
     */
    ApprovelItemsComponent.prototype.actionsSelect = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var selections = this.actionsTable.checkeds;
        if (selections && selections.length > 0) {
            selections.forEach((/**
             * @param {?} action
             * @return {?}
             */
            function (action) {
                /** @type {?} */
                var item = new ApprovalItemEntity(action.data.code, action.data.name, action.data.workFlowAction);
                /** @type {?} */
                var index = _this.data.findIndex((/**
                 * @param {?} act
                 * @return {?}
                 */
                function (act) { return act.value === action.data.code; }));
                if (index > -1) {
                    _this.data.splice(index, 1);
                }
                _this.data.push(item);
            }));
            this.grid.loadData(this.data);
        }
        this.actionsDialog.close();
    };
    /**
     * @private
     * @param {?} action
     * @return {?}
     */
    ApprovelItemsComponent.prototype.actionValidate = /**
     * @private
     * @param {?} action
     * @return {?}
     */
    function (action) {
        /** @type {?} */
        var arr = ['ViewBizLog', 'ViewFlowChart', 'AssignUser', 'Claim', 'Unclaim', 'Retrieve', 'Resubmit', 'Obsolete', 'Transfer', 'AddSignFront', 'ViewExecuteForm'];
        return arr.indexOf(action.code.trim()) === -1;
    };
    ApprovelItemsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-approvel-items',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 class=\"f-title-text\">\u5BA1\u6279\u9879\u5217\u8868</h4>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n      <button class=\"btn btn-primary mr-2\" (click)=\"actionsDialog.show()\">\u65B0\u589E</button>\r\n      <button class=\"btn btn-secondary\" (click)=\"deleteRow()\">\u5220\u9664</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'value'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" (selectChanged)=\"selectChanged($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"actionsSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"actionsDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n<farris-dialog #actionsDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" [title]=\"'\u5BA1\u6279\u52A8\u4F5C'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n    <farris-datagrid #actionsTable [columns]=\"actionsCols\" [data]=\"actions\"\r\n      [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\" [pagination]='false'\r\n      [showCheckbox]=\"true\" [multiSelect]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\" [showAllCheckbox]=\"true\"\r\n      [showLineNumber]=\"true\" [lineNumberTitle]=\"'\u5E8F\u53F7'\" [lineNumberWidth]=\"50\" [striped]=\"true\">\r\n    </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ApprovelItemsComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: MessagerService },
        { type: ProcessDeUtil },
        { type: HttpService },
        { type: ProcessDesignerUIState }
    ]; };
    ApprovelItemsComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        actionsTable: [{ type: ViewChild, args: ['actionsTable',] }],
        actionsDialog: [{ type: ViewChild, args: ['actionsDialog',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return ApprovelItemsComponent;
}());
export { ApprovelItemsComponent };
if (false) {
    /** @type {?} */
    ApprovelItemsComponent.prototype.cls;
    /** @type {?} */
    ApprovelItemsComponent.prototype.closeModal;
    /** @type {?} */
    ApprovelItemsComponent.prototype.submitModal;
    /** @type {?} */
    ApprovelItemsComponent.prototype.modalFooter;
    /** @type {?} */
    ApprovelItemsComponent.prototype.actionsTable;
    /** @type {?} */
    ApprovelItemsComponent.prototype.actionsDialog;
    /** @type {?} */
    ApprovelItemsComponent.prototype.grid;
    /** @type {?} */
    ApprovelItemsComponent.prototype.modalConfig;
    /** @type {?} */
    ApprovelItemsComponent.prototype.workFlowActions;
    /** @type {?} */
    ApprovelItemsComponent.prototype.columns;
    /** @type {?} */
    ApprovelItemsComponent.prototype.data;
    /** @type {?} */
    ApprovelItemsComponent.prototype.actions;
    /** @type {?} */
    ApprovelItemsComponent.prototype.actionsCols;
    /**
     * @type {?}
     * @private
     */
    ApprovelItemsComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    ApprovelItemsComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    ApprovelItemsComponent.prototype.util;
    /**
     * @type {?}
     * @private
     */
    ApprovelItemsComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    ApprovelItemsComponent.prototype.uiState;
}
var ApprovelItemsConverter = /** @class */ (function () {
    function ApprovelItemsConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    ApprovelItemsConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return '（已设置）';
        }
        else {
            return '（未设置）';
        }
    };
    return ApprovelItemsConverter;
}());
export { ApprovelItemsConverter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwcm92ZWwtaXRlbXMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9hcHByb3ZlbC1pdGVtcy9hcHByb3ZlbC1pdGVtcy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBILE9BQU8sRUFBRSxXQUFXLEVBQWEsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDckUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV0RCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBRTdEO0lBNkhFLGdDQUNVLFdBQXdCLEVBQ3hCLE9BQXdCLEVBQ3hCLElBQW1CLEVBQ25CLElBQWlCLEVBQ2pCLE9BQStCO1FBSi9CLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ3hCLFlBQU8sR0FBUCxPQUFPLENBQWlCO1FBQ3hCLFNBQUksR0FBSixJQUFJLENBQWU7UUFDbkIsU0FBSSxHQUFKLElBQUksQ0FBYTtRQUNqQixZQUFPLEdBQVAsT0FBTyxDQUF3QjtRQTNIekMsUUFB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LFNBQVMsU0FBQyxjQUFjO2dDQUN4QixTQUFTLFNBQUMsZUFBZTt1QkFDekIsU0FBUyxTQUFDLE1BQU07O0lBc0tuQiw2QkFBQztDQUFBLEFBNU1ELElBNE1DO1NBdk1ZLHNCQUFzQjs7O0lBQ2pDLHFDQUNxQzs7SUFFckMsNENBQStDOztJQUMvQyw2Q0FBZ0Q7O0lBeUJoRCw2Q0FBNkQ7O0lBQzdELDhDQUEyRDs7SUFDM0QsK0NBQTJEOztJQUMzRCxzQ0FBMkM7O0lBRTNDLDZDQUtFOztJQUVGLGlEQUdrQzs7SUFFbEMseUNBK0RFOztJQUVGLHNDQUFnQzs7SUFHaEMseUNBQWU7O0lBQ2YsNkNBRTZDOzs7OztJQUczQyw2Q0FBZ0M7Ozs7O0lBQ2hDLHlDQUFnQzs7Ozs7SUFDaEMsc0NBQTJCOzs7OztJQUMzQixzQ0FBeUI7Ozs7O0lBQ3pCLHlDQUF1Qzs7QUE0RTNDO0lBQ0U7SUFBZ0IsQ0FBQzs7Ozs7SUFFakIsMENBQVM7Ozs7SUFBVCxVQUFVLElBQVc7UUFDbkIsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDM0IsT0FBTyxPQUFPLENBQUM7U0FDaEI7YUFBTTtZQUNMLE9BQU8sT0FBTyxDQUFDO1NBQ2hCO0lBQ0gsQ0FBQztJQUNILDZCQUFDO0FBQUQsQ0FBQyxBQVZELElBVUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy91aS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtR3JvdXAgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IERhdGFUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YXRhYmxlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBBcHByb3ZhbEl0ZW1FbnRpdHkgfSBmcm9tICcuL2VudGl0aWVzL2FwcHJvdmFsLWl0ZW0uZW50aXR5JztcclxuaW1wb3J0IHsgSHR0cFNlcnZpY2UgfSBmcm9tICdAZWNwLWNhZi9jYWYtY29tbW9uJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4uLy4uL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBFZGl0b3JUeXBlcyB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQtZWRpdG9ycyc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLWFwcHJvdmVsLWl0ZW1zJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vYXBwcm92ZWwtaXRlbXMuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2FwcHJvdmVsLWl0ZW1zLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQXBwcm92ZWxJdGVtc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShpdGVtczogYW55W10pIHtcclxuICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xyXG4gICAgICAgIGNvbnN0IGFwcHJvdmFsID0gbmV3IEFwcHJvdmFsSXRlbUVudGl0eSgpO1xyXG4gICAgICAgIGFwcHJvdmFsLnZhbHVlID0gaXRlbS5WYWx1ZTtcclxuICAgICAgICBhcHByb3ZhbC50ZXh0ID0gaXRlbS5UZXh0O1xyXG4gICAgICAgIGFwcHJvdmFsLndvcmtGbG93QWN0aW9uID0gaXRlbS5Xb3JrRmxvd0FjdGlvbjtcclxuICAgICAgICBhcHByb3ZhbC5pc0RlZmF1bHQgPSBpdGVtLklzRGVmYXVsdDtcclxuXHJcbiAgICAgICAgaWYgKGl0ZW0uY29tbWVudE5lY2Vzc2FyeSA9PT0gbnVsbCB8fCBpdGVtLmNvbW1lbnROZWNlc3NhcnkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgYXBwcm92YWwuY29tbWVudE5lY2Vzc2FyeSA9IChpdGVtLlZhbHVlID09PSAnQmFjaycgPyB0cnVlIDogZmFsc2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhcHByb3ZhbC5jb21tZW50TmVjZXNzYXJ5ID0gaXRlbS5jb21tZW50TmVjZXNzYXJ5O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXBwcm92YWwuY2VydGlmaWNhdGlvbiA9IGl0ZW0uY2VydGlmaWNhdGlvbiA/IGl0ZW0uY2VydGlmaWNhdGlvbiA6IGZhbHNlO1xyXG4gICAgICAgIGFwcHJvdmFsLmF0dGFjaG1lbnROZWNlc3NhcnkgPSBpdGVtLmF0dGFjaG1lbnROZWNlc3NhcnkgPyBpdGVtLmF0dGFjaG1lbnROZWNlc3NhcnkgOiBmYWxzZTtcclxuICAgICAgICB0aGlzLmRhdGEucHVzaChhcHByb3ZhbCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdhY3Rpb25zVGFibGUnKSBhY3Rpb25zVGFibGU6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ2FjdGlvbnNEaWFsb2cnKSBhY3Rpb25zRGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnZ3JpZCcpIGdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG5cclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn5a6h5om56YCJ6aG5JyxcclxuICAgIHdpZHRoOiA4ODAsXHJcbiAgICBoZWlnaHQ6IDUxNSxcclxuICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgd29ya0Zsb3dBY3Rpb25zOiBhbnlbXSA9IFtcclxuICAgIHsgdGV4dDogJ+ato+WQkScsIHZhbHVlOiAnRm9yd2FyZCcgfSxcclxuICAgIHsgdGV4dDogJ+WPjeWQkScsIHZhbHVlOiAnQmFja3dhcmQnIH0sXHJcbiAgICB7IHRleHQ6ICfnu4jmraInLCB2YWx1ZTogJ0Fib3J0JyB9XTtcclxuXHJcbiAgY29sdW1ucyA9IFtcclxuICAgIHtcclxuICAgICAgZmllbGQ6ICd2YWx1ZScsIHdpZHRoOiA4MCwgdGl0bGU6ICfnvJblj7cnLFxyXG4gICAgfSxcclxuICAgIHsgZmllbGQ6ICd0ZXh0Jywgd2lkdGg6IDgwLCB0aXRsZTogJ+WQjeensCcgfSxcclxuICAgIHtcclxuICAgICAgZmllbGQ6ICd3b3JrRmxvd0FjdGlvbicsIHdpZHRoOiA4MCwgdGl0bGU6ICfmtYHovazmlrnlkJEnLFxyXG4gICAgICBmb3JtYXR0ZXI6IHtcclxuICAgICAgICB0eXBlOiAnZW51bScsXHJcbiAgICAgICAgb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICd0ZXh0JywgZGF0YTogdGhpcy53b3JrRmxvd0FjdGlvbnN9XHJcbiAgICAgIH0sXHJcbiAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgIHR5cGU6IEVkaXRvclR5cGVzLkNPTUJPTElTVCxcclxuICAgICAgICBvcHRpb25zOiB7IHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ3RleHQnLCBkYXRhOiB0aGlzLndvcmtGbG93QWN0aW9ucywgaWRGaWVsZDogJ3ZhbHVlJywgcGFuZWxIZWlnaHQ6ICdhdXRvJyB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgIF1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGZpZWxkOiAnaXNEZWZhdWx0Jywgd2lkdGg6IDYwLCB0aXRsZTogJ+m7mOiupCcsXHJcbiAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgIHR5cGU6IEVkaXRvclR5cGVzLlNXSVRDSCxcclxuICAgICAgICBvcHRpb25zOiB7fVxyXG4gICAgICB9LFxyXG4gICAgICBmb3JtYXR0ZXI6IHsgdHlwZTogJ2Jvb2xlYW4nLCBvcHRpb25zOiB7IHRydWVUZXh0OiAn5pivJywgZmFsc2VUZXh0OiAn5ZCmJyB9IH0sXHJcbiAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgIF1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGZpZWxkOiAnY29tbWVudE5lY2Vzc2FyeScsIHdpZHRoOiA2MCwgdGl0bGU6ICfmhI/op4Hlv4XloasnLFxyXG4gICAgICBlZGl0b3I6IHtcclxuICAgICAgICB0eXBlOiBFZGl0b3JUeXBlcy5TV0lUQ0gsXHJcbiAgICAgICAgb3B0aW9uczoge31cclxuICAgICAgfSxcclxuICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdib29sZWFuJywgb3B0aW9uczogeyB0cnVlVGV4dDogJ+aYrycsIGZhbHNlVGV4dDogJ+WQpicgfSB9LFxyXG4gICAgICB2YWxpZGF0b3JzOiBbXHJcbiAgICAgICAgeyB0eXBlOiAncmVxdWlyZWQnLCBtZXNzYWdlcjogJ+W/heWhqycgfVxyXG4gICAgICBdXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBmaWVsZDogJ2F0dGFjaG1lbnROZWNlc3NhcnknLCB3aWR0aDogNjAsIHRpdGxlOiAn6ZmE5Lu25LiK5LygJyxcclxuICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgdHlwZTogRWRpdG9yVHlwZXMuU1dJVENILFxyXG4gICAgICAgIG9wdGlvbnM6IHt9XHJcbiAgICAgIH0sXHJcbiAgICAgIGZvcm1hdHRlcjogeyB0eXBlOiAnYm9vbGVhbicsIG9wdGlvbnM6IHsgdHJ1ZVRleHQ6ICfmmK8nLCBmYWxzZVRleHQ6ICflkKYnIH0gfSxcclxuICAgICAgdmFsaWRhdG9yczogW1xyXG4gICAgICAgIHsgdHlwZTogJ3JlcXVpcmVkJywgbWVzc2FnZXI6ICflv4XloasnIH1cclxuICAgICAgXVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgZmllbGQ6ICdjZXJ0aWZpY2F0aW9uJywgd2lkdGg6IDYwLCB0aXRsZTogJ+aVsOWtl+etvuWQjScsXHJcbiAgICAgIGVkaXRvcjoge1xyXG4gICAgICAgIHR5cGU6IEVkaXRvclR5cGVzLlNXSVRDSCxcclxuICAgICAgICBvcHRpb25zOiB7fVxyXG4gICAgICB9LFxyXG4gICAgICBmb3JtYXR0ZXI6IHsgdHlwZTogJ2Jvb2xlYW4nLCBvcHRpb25zOiB7IHRydWVUZXh0OiAn5pivJywgZmFsc2VUZXh0OiAn5ZCmJyB9IH0sXHJcbiAgICAgIHZhbGlkYXRvcnM6IFtcclxuICAgICAgICB7IHR5cGU6ICdyZXF1aXJlZCcsIG1lc3NhZ2VyOiAn5b+F5aGrJyB9XHJcbiAgICAgIF1cclxuICAgIH1cclxuICBdO1xyXG5cclxuICBkYXRhOiBBcHByb3ZhbEl0ZW1FbnRpdHlbXSA9IFtdO1xyXG5cclxuICAvLyDlrqHmibnliqjkvZxcclxuICBhY3Rpb25zOiBhbnlbXTtcclxuICBhY3Rpb25zQ29scyA9IFtcclxuICAgIHsgdGl0bGU6ICfnvJblj7cnLCBmaWVsZDogJ2NvZGUnLCB3aWR0aDogODAgfSxcclxuICAgIHsgdGl0bGU6ICflkI3np7AnLCBmaWVsZDogJ25hbWUnLCB3aWR0aDogOTAgfV07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgdXRpbDogUHJvY2Vzc0RlVXRpbCxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHVpU3RhdGU6IFByb2Nlc3NEZXNpZ25lclVJU3RhdGVcclxuICApIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuZ2V0QWN0aW9uc0xpc3QoKTtcclxuICB9XHJcblxyXG4gIGNsaWNrT0soKSB7XHJcbiAgICB0aGlzLmdyaWQuZW5kQ2VsbEVkaXQoKTtcclxuICAgIGlmICh0aGlzLnZhbGlkYXRvcigpKSB7XHJcbiAgICAgIGNvbnN0IG9iamVjdCA9IHsgdmFsdWU6IHRoaXMuZGF0YSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5jbG9zZU1vZGFsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdmFsaWRhdG9yKCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuZGF0YS5maW5kSW5kZXgoZCA9PiAhZC53b3JrRmxvd0FjdGlvbikgPiAtMSkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZygn5a6h5om56aG55rWB6L2s5pa55ZCR5LiN5YWB6K645Li656m677yM6K+35L+u5pS577yBJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgc2VsZWN0Q2hhbmdlZChkYXRhOiBhbnkpIHsgfVxyXG5cclxuICBkZWxldGVSb3coKSB7XHJcbiAgICB0aGlzLmdyaWQuZW5kQ2VsbEVkaXQoKTtcclxuICAgIGlmICh0aGlzLmdyaWQuc2VsZWN0ZWRSb3cgJiYgdGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEpIHtcclxuICAgICAgY29uc3QgaSA9IHRoaXMuZGF0YS5maW5kSW5kZXgoZCA9PiBkLnZhbHVlID09PSB0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS52YWx1ZSk7XHJcbiAgICAgIHRoaXMuZGF0YS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgIHRoaXMuZ3JpZC5sb2FkRGF0YSh0aGlzLmRhdGEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+ivt+mmluWFiOmAieS4reS4gOadoemAiemhue+8gScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRBY3Rpb25zTGlzdCgpIHtcclxuICAgIGxldCB1cmwgPSB0aGlzLnV0aWwuZ2V0QXBwcm92YWxBY3Rpb25XZWJBcGkoKSArICc/JztcclxuICAgIGlmICh0aGlzLnVpU3RhdGUuYml6QWN0aXZpdHlJZCkge1xyXG4gICAgICB1cmwgKz0gYGJpekFjdGl2aXR5SWQ9JHt0aGlzLnVpU3RhdGUuYml6QWN0aXZpdHlJZH1gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdXJsICs9IGBiaXpBY3Rpdml0eUlkPWA7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5odHRwLmdldCh1cmwpLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgZGF0YSA9IGRhdGEuZmlsdGVyKGEgPT4gdGhpcy5hY3Rpb25WYWxpZGF0ZShhKSk7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gZGF0YTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhY3Rpb25zU2VsZWN0KCkge1xyXG4gICAgY29uc3Qgc2VsZWN0aW9uczogYW55W10gPSB0aGlzLmFjdGlvbnNUYWJsZS5jaGVja2VkcztcclxuICAgIGlmIChzZWxlY3Rpb25zICYmIHNlbGVjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBzZWxlY3Rpb25zLmZvckVhY2goYWN0aW9uID0+IHtcclxuICAgICAgICBjb25zdCBpdGVtID0gbmV3IEFwcHJvdmFsSXRlbUVudGl0eShhY3Rpb24uZGF0YS5jb2RlLCBhY3Rpb24uZGF0YS5uYW1lLCBhY3Rpb24uZGF0YS53b3JrRmxvd0FjdGlvbik7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmRhdGEuZmluZEluZGV4KGFjdCA9PiBhY3QudmFsdWUgPT09IGFjdGlvbi5kYXRhLmNvZGUpO1xyXG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICB0aGlzLmRhdGEuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmdyaWQubG9hZERhdGEodGhpcy5kYXRhKTtcclxuICAgIH1cclxuICAgIHRoaXMuYWN0aW9uc0RpYWxvZy5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhY3Rpb25WYWxpZGF0ZShhY3Rpb246IGFueSkge1xyXG4gICAgY29uc3QgYXJyID0gWydWaWV3Qml6TG9nJywgJ1ZpZXdGbG93Q2hhcnQnLCAnQXNzaWduVXNlcicsICdDbGFpbScsICdVbmNsYWltJywgJ1JldHJpZXZlJywgJ1Jlc3VibWl0JywgJ09ic29sZXRlJywgJ1RyYW5zZmVyJywgJ0FkZFNpZ25Gcm9udCcsICdWaWV3RXhlY3V0ZUZvcm0nXTtcclxuICAgIHJldHVybiBhcnIuaW5kZXhPZihhY3Rpb24uY29kZS50cmltKCkpID09PSAtMTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBcHByb3ZlbEl0ZW1zQ29udmVydGVyIGltcGxlbWVudHMgVHlwZUNvbnZlcnRlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgY29udmVydFRvKGRhdGE6IGFueVtdKTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gJ++8iOW3suiuvue9ru+8iSc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gJ++8iOacquiuvue9ru+8iSc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==