/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, Input, Injector } from '@angular/core';
import { TaskService } from '../../service/task.service';
import { StartProcessPayload, FlowNodeInfo } from '../../entity/start-process-payload';
import { LoadingService } from '@farris/ui-loading';
import { Subject } from 'rxjs';
import { NotifyService } from '@farris/ui-notify';
import { I18nService } from '../../service/i18n/i18n.service';
import { ComboListComponent } from '@farris/ui-combo-list';
import { MessageType } from '../../entity/postMessage';
import { MessagerService } from '@farris/ui-messager';
import { WfTaskHandlerService } from '../../wf-task-handler.service';
import { ConfigCode } from '../../entity/task-center-config';
import { WfContext } from '../../entity/wfContext';
import { TaskEntity } from '../../entity/task-entity';
import { TaskAction } from '../../entity/task-action';
import { SelectedProcessItem, StartProcessCache } from '../../entity/process-cache';
var ProcessSelectorComponent = /** @class */ (function () {
    // task center-ui中start-process-menu使用了此选择器，构造方法改动时，需重新编译
    function ProcessSelectorComponent(taskService, loadingService, notify, i18nService, messager, injector, handlerService) {
        this.taskService = taskService;
        this.loadingService = loadingService;
        this.notify = notify;
        this.i18nService = i18nService;
        this.messager = messager;
        this.injector = injector;
        this.handlerService = handlerService;
        this.destProcesses = []; //候选流程
        //候选流程
        this.destNodes = []; //候选下一环节
        //保存模拟流程后返回的内容，选择节点时使用
        this.assignInfos = [{
                selectedAssignees: [],
                assigneeInfo: null,
                assignees: [],
                activityName: '',
                dependency: '',
                anonymous: false,
                anonymousText: null,
                resolved: false,
            }]; //节点返回的指派信息（多个）
        //选择的下一环节ID，后续环节id的拼接
        this.payload = new StartProcessPayload; //保存表单上传来的payload
        //保存表单上传来的payload
        this.subject = new Subject(); //返回bool
        //返回bool
        this.subjectWithResponse = new Subject(); //返回流程上下文
        //返回流程上下文
        this.subjectCancel = new Subject(); //点击取消后的subject
        //点击取消后的subject
        this.submitDisable = false; //提交按钮是否禁用
        this.showButtons = false;
        this.curLanguage = localStorage.getItem('languageCode') || 'zh-CHS'; //系统当前语言
        //选择流程的placeholder
        this.wfContext = new WfContext(); //工作流上下文
        //确认取消按钮
        this.openFromIframe = false; //是否从iframe打开，应用IDP提交审批集成
    }
    /**
     * @return {?}
     */
    ProcessSelectorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    Object.defineProperty(ProcessSelectorComponent.prototype, "dataId", {
        set: 
        //是否从iframe打开，应用IDP提交审批集成
        /**
         * @param {?} dataId
         * @return {?}
         */
        function (dataId) {
            if (!dataId) {
                throw new Error("dataId为空");
            }
            this._dataId = dataId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProcessSelectorComponent.prototype, "bizDefKey", {
        set: /**
         * @param {?} bizDefKey
         * @return {?}
         */
        function (bizDefKey) {
            if (!bizDefKey) {
                throw new Error("流程分类id为空");
            }
            this.showButtons = true;
            this._bizDefKey = bizDefKey;
            /** @type {?} */
            var payload = new StartProcessPayload();
            payload.dataId = this._dataId;
            payload.bizDefKey = this._bizDefKey;
            this.setParam(payload);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} param
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setParam = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        /** @type {?} */
        var subject = new Subject();
        if (!param) {
            return;
        }
        this.payload.id = param.id;
        this.payload.processDefinitionId = param.processDefinitionId;
        this.payload.processDefinitionKey = param.processDefinitionKey;
        this.payload.bizDefKey = param.bizDefKey;
        this.payload.dataModelId = param.dataModelId;
        this.payload.dataId = param.dataId;
        this.payload.name = param.name;
        this.payload.startUserId = param.startUserId;
        this.payload.nextFlowNodes = [];
        this.wfContext.processCategoryId = param.bizDefKey;
        this.startProcessSimulate(this.payload, subject);
        return subject.asObservable();
    };
    /**
     * @param {?} payload
     * @param {?} subject
     * @return {?}
     */
    ProcessSelectorComponent.prototype.startProcessSimulate = /**
     * @param {?} payload
     * @param {?} subject
     * @return {?}
     */
    function (payload, subject) {
        var _this = this;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcessSimulate(payload).subscribe(function (response) {
            load.close();
            subject.next(true);
            _this.response = response;
            _this.destProcesses = response.procDefs.map(function (process) { return ({ id: process.procDefId, name: process.procDefName + ("(v" + process.version + ".0)") }); }); //增加流程的版本信息
            if (_this.destProcesses.length === 1) { //只有一个候选流程时
                _this.selectedProcessId = _this.destProcesses[0].id;
                _this.setNextNode(response);
                _this.processPlaceholder = _this.destProcesses[0].name;
            }
            else { //多个流程时，取上一次选择的
                //多个流程时，取上一次选择的
                /** @type {?} */
                var selectedProcessId_1 = _this.getSelectedProcessCache(_this.payload.bizDefKey);
                if (selectedProcessId_1 && _this.destProcesses.findIndex(function (p) { return p.id === selectedProcessId_1.processDefinitionId; }) > -1) {
                    _this.getDestNodes(selectedProcessId_1.processDefinitionId);
                    _this.processPlaceholder = selectedProcessId_1.processDefinitionName;
                }
                else {
                    _this.processPlaceholder = _this.i18nService.getValue('task.selectPlaceholder');
                }
            }
        }, function (error) {
            load.close();
            subject.error(error);
            _this.taskService.error(error);
        });
    };
    /**
     * 选择某个流程后
     * @param data
     */
    /**
     * 选择某个流程后
     * @param {?} data
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectProcessChange = /**
     * 选择某个流程后
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.nodeCombo.onClear();
        this.getDestNodes(data.data.id);
    };
    /**
     * 根据选择的流程定义id获取下一环节信息
     * @param selectedProcessId
     */
    /**
     * 根据选择的流程定义id获取下一环节信息
     * @private
     * @param {?} selectedProcessId
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getDestNodes = /**
     * 根据选择的流程定义id获取下一环节信息
     * @private
     * @param {?} selectedProcessId
     * @return {?}
     */
    function (selectedProcessId) {
        var _this = this;
        this.selectedProcessId = selectedProcessId;
        this.destNodes = [];
        this.nodePlaceholder = '';
        this.clearAssignInfos();
        /** @type {?} */
        var payload = new StartProcessPayload();
        payload.processDefinitionId = this.selectedProcessId;
        payload.dataId = this.payload.dataId;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcessSimulate(payload).subscribe(function (response) {
            load.close();
            _this.response = response;
            _this.setNextNode(response);
        }, function (error) {
            load.close();
            _this.taskService.error(error);
        });
    };
    /**
     * 选择节点后事件
     */
    /**
     * 选择节点后事件
     * @param {?} data
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectNodeChange = /**
     * 选择节点后事件
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        this.clearAssignInfos();
        this.selectedNodeId = data.data.id;
        /** @type {?} */
        var nodeNames = data.data.name.split('，');
        if (this.response.simulationPaths[data.index].nodeInfoList.every(function (node) { return node.resolved === true; })) { //已预解析参与者
            this.setAssignInfo(this.response.simulationPaths[data.index]);
        }
        else { //未预解析参与者
            //未预解析参与者
            /** @type {?} */
            var payload_1 = new StartProcessPayload();
            payload_1.processDefinitionId = this.selectedProcessId;
            payload_1.dataId = this.payload.dataId;
            payload_1.nextFlowNodes = [];
            this.selectedNodeId.split('，').forEach(function (nodeId, index) {
                /** @type {?} */
                var nextFlowNode = new FlowNodeInfo();
                nextFlowNode.activityDefinitionId = nodeId;
                nextFlowNode.activityDefinitionName = nodeNames[index];
                payload_1.nextFlowNodes.push(nextFlowNode);
            });
            /** @type {?} */
            var load_1 = this.loadingService.show();
            this.taskService.startProcessSimulate(payload_1).subscribe(function (response) {
                load_1.close();
                _this.setAssignInfo(response.simulationPaths[0]); //选择的下一环节应该在同一条路径上，故取simulationPaths[0]
            }, function (error) {
                load_1.close();
                _this.taskService.error(error);
            });
        }
    };
    /**
   * 实现真正的提交
   */
    /**
     * 实现真正的提交
     * @return {?}
     */
    ProcessSelectorComponent.prototype.startProcessSubmit = /**
     * 实现真正的提交
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.selectedProcessId) {
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('startProcess.selectProcess')) :
                this.notify.warning(this.i18nService.getValue('startProcess.selectProcess'));
            return;
        }
        if (!this.selectedNodeId) {
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('startProcess.selectNode')) :
                this.notify.warning(this.i18nService.getValue('startProcess.selectNode'));
            return;
        }
        if (this.assignInfos.filter(function (info) { return (info.assigneeInfo || info.selectedAssignees.length) && !info.assignees.length; }).length) { //空参与者策略时，不提示选人
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('task.selectProcessor')) :
                this.notify.warning(this.i18nService.getValue('task.selectProcessor'));
            return;
        }
        /** @type {?} */
        var nodes = this.selectedNodeId.split('，');
        for (var i = 0; i < nodes.length; i++) {
            /** @type {?} */
            var nextFlowNode = {
                activityDefinitionId: nodes[i],
                activityDefinitionName: this.assignInfos[i].activityName,
                dependency: this.assignInfos[i].dependency,
                selectedAssignees: this.assignInfos[i].assigneeInfo ? this.assignInfos[i].assignees : [],
                assigneeInfo: null,
                resolved: false,
                anonymous: false,
                anonymousText: ''
            }
            //节点找不到人，且异常提示，前端控制住，不允许走提交请求（构件事务问题）。并行场景下暂不处理
            ;
            //节点找不到人，且异常提示，前端控制住，不允许走提交请求（构件事务问题）。并行场景下暂不处理
            if (this.response && this.response.simulationPaths.length && !this.response.simulationPaths[0].id.startsWith('ParallelGateway')) {
                if (nodes.length == 1 && nodes[i].startsWith('UserActivity') && this.assignInfos[i].resolved && !this.assignInfos[i].assigneeInfo && !this.assignInfos[i].selectedAssignees.length) {
                    /** @type {?} */
                    var str = this.assignInfos[i].activityName + this.i18nService.getValue('startProcess.node') + this.i18nService.getValue('startProcess.noUser');
                    this.openFromIframe ? this.messager.warning(str) : this.notify.warning(str);
                    return;
                }
            }
            this.payload.nextFlowNodes.push(nextFlowNode);
        }
        this.payload.processDefinitionId = this.selectedProcessId;
        this.submitDisable = true;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcess(this.payload).subscribe(function (response) {
            load.close();
            _this.submitDisable = false;
            _this.subject.next(true);
            _this.subjectWithResponse.next(response);
            /** @type {?} */
            var messageAfterSubmit = _this.i18nService.getValue('startProcess.submitSuccess');
            if (_this.openFromIframe) {
                ((/** @type {?} */ (window.parent))).gspWfService.eventHandler({ data: { type: MessageType.SubmitSuccess, message: messageAfterSubmit } });
            }
            else {
                _this.handlerService.handleSubmitMessage(ConfigCode.Info_After_Submit, _this.payload.bizDefKey);
            }
            if (!_this.openFromIframe && response.needInteraction) { //提交审批后需要指派场景
                _this.notify.info(_this.i18nService.getValue('cueWords.select')
                    + response.nextFlowNodes[0].activityDefinitionName
                    + _this.i18nService.getValue('cueWords.processor'));
                /** @type {?} */
                var task = new TaskEntity();
                /** @type {?} */
                var action = new TaskAction();
                task.sourceId = response.nextFlowNodes[0].assigneeInfo.workItemId;
                action.code = 'AssignUser';
                action.name = _this.i18nService.getValue('cueWords.assignUser');
                _this.handlerService.execute(task, action).subscribe(function (re) { });
            }
            _this.setSelectedProcessCache();
        }, function (error) {
            load.close();
            _this.payload.nextFlowNodes = [];
            _this.submitDisable = false;
            _this.subject.next(false); //已经有人用了这个subject，提交失败的话返回false by fangpengfei@20210324
            _this.taskService.error(error);
        });
    };
    /**
     * 选择流程清空
     */
    /**
     * 选择流程清空
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectProcessClear = /**
     * 选择流程清空
     * @return {?}
     */
    function () {
        this.selectedProcessId = '';
        this.destNodes = [];
        this.nodePlaceholder = '';
        this.selectedNodeId = '';
        this.clearAssignInfos();
        this.response = null;
    };
    /**
     * 选择节点清空
     */
    /**
     * 选择节点清空
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectNodeClear = /**
     * 选择节点清空
     * @return {?}
     */
    function () {
        this.selectedNodeId = '';
        this.clearAssignInfos();
    };
    /**
     * 用户帮助选人
     */
    /**
     * 用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    ProcessSelectorComponent.prototype.afterConfirm = /**
     * 用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    function (data, index) {
        this.assignInfos[index].assignees = data;
    };
    /**
     * 弹框点击取消
     */
    /**
     * 弹框点击取消
     * @return {?}
     */
    ProcessSelectorComponent.prototype.cancel = /**
     * 弹框点击取消
     * @return {?}
     */
    function () {
        if (this.openFromIframe) {
            ((/** @type {?} */ (window.parent))).gspWfService.eventHandler({ data: { type: MessageType.Cancel, message: '' } });
        }
        else {
            this.subjectCancel.next(false);
        }
    };
    /**
     * 获取提交审批后返回值（bool型，兼容历史）
     */
    /**
     * 获取提交审批后返回值（bool型，兼容历史）
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubject = /**
     * 获取提交审批后返回值（bool型，兼容历史）
     * @return {?}
     */
    function () {
        return this.subject.asObservable();
    };
    /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     */
    /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubjectWithResponse = /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     * @return {?}
     */
    function () {
        return this.subjectWithResponse.asObservable();
    };
    /**
     * 点击取消后的subject，关闭窗口使用
     * @returns
     */
    /**
     * 点击取消后的subject，关闭窗口使用
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubjectCancel = /**
     * 点击取消后的subject，关闭窗口使用
     * @return {?}
     */
    function () {
        return this.subjectCancel.asObservable();
    };
    /**
     * 设置下一环节
     */
    /**
     * 设置下一环节
     * @private
     * @param {?} response
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setNextNode = /**
     * 设置下一环节
     * @private
     * @param {?} response
     * @return {?}
     */
    function (response) {
        this.destNodes = response.simulationPaths && response.simulationPaths.map(function (path) { return ({
            id: path.nodeInfoList.map(function (node) { return node.activityDefinitionId; }).join('，'),
            name: path.nodeInfoList.map(function (node) { return node.activityDefinitionName; }).join('，')
        }); });
        //处理默认分支，无默认分支返回-1
        /** @type {?} */
        var defaultIndex = response.simulationPaths.findIndex(function (a) { return a.default; });
        if (defaultIndex > -1) {
            this.selectedNodeId = this.destNodes[defaultIndex].id;
            this.nodePlaceholder = this.destNodes[defaultIndex].name.indexOf('，') > -1 ? response.simulationPaths[defaultIndex].name : this.destNodes[defaultIndex].name;
            this.setAssignInfo(response.simulationPaths[defaultIndex]);
        }
        else {
            this.nodePlaceholder = this.i18nService.getValue('task.selectPlaceholder');
        }
    };
    /**
     * 设置当前指派信息帮助参数
     */
    /**
     * 设置当前指派信息帮助参数
     * @private
     * @param {?} simulationPaths
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setAssignInfo = /**
     * 设置当前指派信息帮助参数
     * @private
     * @param {?} simulationPaths
     * @return {?}
     */
    function (simulationPaths) {
        var _this = this;
        this.assignInfos = [];
        this.selectedNodeId.split('，').forEach(function (nodeId) {
            /** @type {?} */
            var node = simulationPaths.nodeInfoList.find(function (node) { return node.activityDefinitionId === nodeId; });
            if (node) {
                _this.assignInfos.push({
                    selectedAssignees: node.selectedAssignees,
                    assigneeInfo: node.assigneeInfo,
                    assignees: node.selectedAssignees.map(function (user) { return { id: user.id, name: user.name }; }),
                    activityName: node.activityDefinitionName,
                    dependency: node.dependency,
                    anonymous: node.anonymous,
                    anonymousText: node.anonymousText,
                    resolved: node.resolved
                });
            }
            else {
                _this.assignInfos.push({
                    selectedAssignees: [],
                    assigneeInfo: null,
                    assignees: [],
                    activityName: '',
                    dependency: '',
                    anonymous: false,
                    anonymousText: '',
                    resolved: false,
                });
            }
        });
    };
    /**
     * 清空当前指派信息帮助参数
     */
    /**
     * 清空当前指派信息帮助参数
     * @private
     * @return {?}
     */
    ProcessSelectorComponent.prototype.clearAssignInfos = /**
     * 清空当前指派信息帮助参数
     * @private
     * @return {?}
     */
    function () {
        this.assignInfos = [{
                selectedAssignees: [],
                assigneeInfo: null,
                assignees: [],
                activityName: '',
                dependency: '',
                anonymous: false,
                anonymousText: '',
                resolved: false,
            }];
    };
    /**
     * 获取浏览器缓存，上次流程选择的结果
     */
    /**
     * 获取浏览器缓存，上次流程选择的结果
     * @private
     * @param {?} processCategoryId
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSelectedProcessCache = /**
     * 获取浏览器缓存，上次流程选择的结果
     * @private
     * @param {?} processCategoryId
     * @return {?}
     */
    function (processCategoryId) {
        /** @type {?} */
        var browserCache = (/** @type {?} */ (JSON.parse(localStorage.getItem("gspWfStartProcess"))));
        if (browserCache && browserCache.selectedProcessList) {
            return browserCache.selectedProcessList.find(function (a) { return a.processCategory == processCategoryId; });
        }
        return undefined;
    };
    /**
     * 浏览器缓存记下流程选择的结果
     */
    /**
     * 浏览器缓存记下流程选择的结果
     * @private
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setSelectedProcessCache = /**
     * 浏览器缓存记下流程选择的结果
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var processCategoryId = this.payload.bizDefKey;
        /** @type {?} */
        var processDefinitionId = this.payload.processDefinitionId;
        /** @type {?} */
        var process = this.destProcesses.find(function (a) { return a.id == processDefinitionId; });
        /** @type {?} */
        var processDefinitionName = process && process.name;
        /** @type {?} */
        var browserCache = (/** @type {?} */ (JSON.parse(localStorage.getItem("gspWfStartProcess"))));
        if (browserCache && browserCache.selectedProcessList) {
            /** @type {?} */
            var selectedProcessList = browserCache.selectedProcessList;
            if (selectedProcessList.findIndex(function (a) { return a.processCategory == processCategoryId; }) > -1) {
                selectedProcessList.map(function (item) {
                    if (item.processCategory == processCategoryId) {
                        item.processDefinitionId = processDefinitionId;
                        item.processDefinitionName = processDefinitionName;
                        item.logTime = new Date();
                    }
                });
                browserCache.selectedProcessList = selectedProcessList;
                localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache));
            }
            else {
                /** @type {?} */
                var item = new SelectedProcessItem(processCategoryId, processDefinitionId, processDefinitionName);
                selectedProcessList.push(item);
                browserCache.selectedProcessList = selectedProcessList;
                localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache));
            }
        }
        else {
            /** @type {?} */
            var browserCache_1 = new StartProcessCache();
            /** @type {?} */
            var selectedProcessList = [];
            /** @type {?} */
            var item = new SelectedProcessItem(processCategoryId, processDefinitionId, processDefinitionName);
            selectedProcessList.push(item);
            browserCache_1.selectedProcessList = selectedProcessList;
            localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache_1));
        }
    };
    ProcessSelectorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-process-selector',
                    template: "<div style=\"padding: 10px 20px; overflow: hidden; background-color: white;\">\r\n  <!-- \u9009\u62E9\u6D41\u7A0B\u5B9A\u4E49\uFF0C\u4E0B\u62C9 -->\r\n  <div class=\"wf-task-handler-help-div wf-task-handler-help-div-submit\">\r\n    <div class=\"wf-task-handler-help-text\">\r\n      {{ \"startProcess.title\" | translate }}\r\n    </div>\r\n    <div class=\"d-flex\" style=\"flex: 1;\">\r\n      <farris-combo-list style=\"flex: 1;\"\r\n        [data]=\"destProcesses\"\r\n        [editable]=\"false\"\r\n        [textField]=\"'name'\"\r\n        [valueField]=\"'id'\"\r\n        [idField]=\"'id'\"\r\n        [readonly]=\"destProcesses.length > 1 ? false : true\"\r\n        (selectChange)=\"selectProcessChange($event)\"\r\n        (clear)=\"selectProcessClear()\"\r\n        [placeholder]=\"processPlaceholder\"\r\n        [forcePlaceholder]=\"true\"\r\n      >\r\n      </farris-combo-list>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- \u4E0B\u4E00\u8282\u70B9\uFF0C\u4E0B\u62C9 -->\r\n  <div class=\"wf-task-handler-help-div wf-task-handler-help-div-submit\">\r\n    <div class=\"wf-task-handler-help-text\">{{ \"task.nextNodeText\" | translate }}</div>\r\n    <div class=\"d-flex\" style=\"flex: 1;\">\r\n      <farris-combo-list style=\"flex: 1;\"\r\n        #nodeCombo\r\n        [data]=\"destNodes\"\r\n        [editable]=\"false\"\r\n        [textField]=\"'name'\"\r\n        [valueField]=\"'id'\"\r\n        [idField]=\"'id'\"\r\n        [readonly]=\"destNodes.length > 1 ? false : true\"\r\n        (selectChange)=\"selectNodeChange($event)\"\r\n        (clear)=\"selectNodeClear()\"\r\n        [placeholder]=\"nodePlaceholder\"\r\n        [forcePlaceholder]=\"true\"\r\n      >\r\n      </farris-combo-list>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- \u529E\u7406\u4EBA\u5458 -->\r\n  <lib-assignee-info *ngFor=\"let assignInfo of assignInfos; let i = index\"\r\n    [assigneeInfo]=\"assignInfo.assigneeInfo\"\r\n    [setAnonymous]=\"assignInfo.anonymous\"\r\n    [setAnonymousText]=\"assignInfo.anonymousText\"\r\n    [selectedAssignees]=\"assignInfo.selectedAssignees\"\r\n    [activityName]=\"assignInfos.length > 1 ? assignInfo.activityName : ''\"\r\n    [ifShowBlank]=\"assignInfos.length > 1 ? false : true\"\r\n    [openFromIframe]=\"openFromIframe\"\r\n    [wfContext]=\"wfContext\"\r\n    (afterConfirm)=\"afterConfirm($event, i)\"\r\n  ></lib-assignee-info>\r\n</div>\r\n\r\n\r\n<!-- \u5F39\u6846\u663E\u793A\u65F6\uFF0C\u663E\u793A\u6309\u94AE -->\r\n<div *ngIf=\"showButtons\" class=\"modal-footer\" style=\"float: right; width: 100%;\">\r\n  <div *ngIf=\"showButtons; then buttons\"></div>\r\n</div>\r\n\r\n<!-- \u6309\u94AE -->\r\n<ng-template #buttons>\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"cancel()\">\r\n    {{ \"static.footCancel\" | translate }}\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary\" [disabled]=\"submitDisable\" directive-throttle (throttleClick)=\"startProcessSubmit()\">\r\n    {{ \"static.footOk\" | translate }}\r\n  </button>\r\n</ng-template>\r\n",
                    styles: [".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:20px}.wf-task-handler-help-div-submit{margin-bottom:20px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]
                }] }
    ];
    /** @nocollapse */
    ProcessSelectorComponent.ctorParameters = function () { return [
        { type: TaskService },
        { type: LoadingService },
        { type: NotifyService },
        { type: I18nService },
        { type: MessagerService },
        { type: Injector },
        { type: WfTaskHandlerService }
    ]; };
    ProcessSelectorComponent.propDecorators = {
        nodeCombo: [{ type: ViewChild, args: ['nodeCombo',] }],
        buttons: [{ type: ViewChild, args: ['buttons',] }],
        openFromIframe: [{ type: Input }],
        dataId: [{ type: Input }],
        bizDefKey: [{ type: Input }]
    };
    return ProcessSelectorComponent;
}());
export { ProcessSelectorComponent };
if (false) {
    /** @type {?} */
    ProcessSelectorComponent.prototype.destProcesses;
    /** @type {?} */
    ProcessSelectorComponent.prototype.destNodes;
    /** @type {?} */
    ProcessSelectorComponent.prototype.response;
    /** @type {?} */
    ProcessSelectorComponent.prototype.assignInfos;
    /** @type {?} */
    ProcessSelectorComponent.prototype.selectedProcessId;
    /** @type {?} */
    ProcessSelectorComponent.prototype.selectedNodeId;
    /** @type {?} */
    ProcessSelectorComponent.prototype.payload;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subject;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subjectWithResponse;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subjectCancel;
    /** @type {?} */
    ProcessSelectorComponent.prototype.submitDisable;
    /** @type {?} */
    ProcessSelectorComponent.prototype._dataId;
    /** @type {?} */
    ProcessSelectorComponent.prototype._bizDefKey;
    /** @type {?} */
    ProcessSelectorComponent.prototype.showButtons;
    /** @type {?} */
    ProcessSelectorComponent.prototype.curLanguage;
    /** @type {?} */
    ProcessSelectorComponent.prototype.nodePlaceholder;
    /** @type {?} */
    ProcessSelectorComponent.prototype.processPlaceholder;
    /** @type {?} */
    ProcessSelectorComponent.prototype.wfContext;
    /** @type {?} */
    ProcessSelectorComponent.prototype.nodeCombo;
    /** @type {?} */
    ProcessSelectorComponent.prototype.buttons;
    /** @type {?} */
    ProcessSelectorComponent.prototype.openFromIframe;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.taskService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.i18nService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.handlerService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1zZWxlY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXRhc2staGFuZGxlci8iLCJzb3VyY2VzIjpbImxpYi9zdWJtaXQvcHJvY2Vzcy1zZWxlY3Rvci9wcm9jZXNzLXNlbGVjdG9yLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0YsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3pELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxZQUFZLEVBQVksTUFBTSxvQ0FBb0MsQ0FBQztBQUVqRyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFDbkQsT0FBTyxFQUFjLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMzQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQzlELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzNELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUE7QUFHckQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDckUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQzdELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3RELE9B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Z0Q7O2lCQUVqRDs7OztnQkF2QlEsV0FBVztnQkFHWCxjQUFjO2dCQUVkLGFBQWE7Z0JBQ2IsV0FBVztnQkFHWCxlQUFlO2dCQVZtQyxRQUFRO2dCQWExRCxvQkFBb0I7Ozs0QkEyRDFCLFNBQVMsU0FBQyxXQUFXOzBCQUNyQixTQUFTLFNBQUMsU0FBUztpQ0FDbkIsS0FBSzt5QkFFTCxLQUFLOzRCQVFMLEtBQUs7O0lBMlhSLCtCQUFDO0NBQUEsQUEzYkQsSUEyYkM7U0F0Ylksd0JBQXdCOzs7SUFpQm5DLGlEQUFtRDs7SUFDbkQsNkNBQStDOztJQUMvQyw0Q0FBMkI7O0lBQzNCLCtDQVVLOztJQUVMLHFEQUEwQjs7SUFDMUIsa0RBQXVCOztJQUN2QiwyQ0FBa0M7O0lBQ2xDLDJDQUF3Qjs7SUFDeEIsdURBQXlDOztJQUN6QyxpREFBOEI7O0lBQzlCLGlEQUErQjs7SUFDL0IsMkNBQWdCOztJQUNoQiw4Q0FBbUI7O0lBQ25CLCtDQUE2Qjs7SUFDN0IsK0NBQXVFOztJQUN2RSxtREFBd0I7O0lBQ3hCLHNEQUEyQjs7SUFDM0IsNkNBQTRCOztJQUU1Qiw2Q0FBcUQ7O0lBQ3JELDJDQUFnRDs7SUFDaEQsa0RBQXlDOzs7OztJQTdDdkMsK0NBQWdDOzs7OztJQUNoQyxrREFBc0M7Ozs7O0lBQ3RDLDBDQUE2Qjs7Ozs7SUFDN0IsK0NBQWdDOzs7OztJQUNoQyw0Q0FBaUM7Ozs7O0lBQ2pDLDRDQUEwQjs7Ozs7SUFDMUIsa0RBQTRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIElucHV0LCBJbmplY3RvciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUYXNrU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2UvdGFzay5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3RhcnRQcm9jZXNzUGF5bG9hZCwgRmxvd05vZGVJbmZvLCBBc3NpZ25lZSB9IGZyb20gJy4uLy4uL2VudGl0eS9zdGFydC1wcm9jZXNzLXBheWxvYWQnO1xyXG5pbXBvcnQgeyBFeGVjdXRpb25SZXNwb25zZSB9IGZyb20gJy4uLy4uL2VudGl0eS9leGVjdXRpb24tcmVzcG9uc2UnO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZydcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBJMThuU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2UvaTE4bi9pMThuLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21ib0xpc3RDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWNvbWJvLWxpc3QnO1xyXG5pbXBvcnQgeyBNZXNzYWdlVHlwZSB9IGZyb20gJy4uLy4uL2VudGl0eS9wb3N0TWVzc2FnZSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInXHJcbmltcG9ydCB7IFNpbXVsYXRlUmVzcG9uc2UsIFNpbXVsYXRpb25QYXRoIH0gZnJvbSAnLi4vLi4vZW50aXR5L3NpbXVsYXRlLXJlc3BvbnNlJztcclxuaW1wb3J0IHsgQXNzaWduSW5mb0hlbHBFbnRpdHkgfSBmcm9tICcuLi8uLi9lbnRpdHkvYXNzaWduSW5mb0hlbHAnO1xyXG5pbXBvcnQgeyBXZlRhc2tIYW5kbGVyU2VydmljZSB9IGZyb20gJy4uLy4uL3dmLXRhc2staGFuZGxlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29uZmlnQ29kZSB9IGZyb20gJy4uLy4uL2VudGl0eS90YXNrLWNlbnRlci1jb25maWcnO1xyXG5pbXBvcnQgeyBXZkNvbnRleHQgfSBmcm9tICcuLi8uLi9lbnRpdHkvd2ZDb250ZXh0JztcclxuaW1wb3J0IHsgVGFza0VudGl0eSB9IGZyb20gJy4uLy4uL2VudGl0eS90YXNrLWVudGl0eSc7XHJcbmltcG9ydCB7IFRhc2tBY3Rpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvdGFzay1hY3Rpb24nO1xyXG5pbXBvcnQgeyBTZWxlY3RlZFByb2Nlc3NJdGVtLCBTdGFydFByb2Nlc3NDYWNoZSB9IGZyb20gJy4uLy4uL2VudGl0eS9wcm9jZXNzLWNhY2hlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbGliLXByb2Nlc3Mtc2VsZWN0b3InLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wcm9jZXNzLXNlbGVjdG9yLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi4vLi4vY29tcG9uZW50cy90YXNrLWV4ZWN1dGUvdGFzay1leGVjdXRlLmNvbXBvbmVudC5jc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIFByb2Nlc3NTZWxlY3RvckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIC8vIHRhc2sgY2VudGVyLXVp5Litc3RhcnQtcHJvY2Vzcy1tZW515L2/55So5LqG5q2k6YCJ5oup5Zmo77yM5p6E6YCg5pa55rOV5pS55Yqo5pe277yM6ZyA6YeN5paw57yW6K+RXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHRhc2tTZXJ2aWNlOiBUYXNrU2VydmljZSxcclxuICAgIHByaXZhdGUgbG9hZGluZ1NlcnZpY2U6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGkxOG5TZXJ2aWNlOiBJMThuU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBoYW5kbGVyU2VydmljZTogV2ZUYXNrSGFuZGxlclNlcnZpY2VcclxuICApIHtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgZGVzdFByb2Nlc3NlczogeyBpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcgfVtdID0gW107Ly/lgJnpgInmtYHnqItcclxuICBkZXN0Tm9kZXM6IHsgaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nIH1bXSA9IFtdOy8v5YCZ6YCJ5LiL5LiA546v6IqCXHJcbiAgcmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2U7Ly/kv53lrZjmqKHmi5/mtYHnqIvlkI7ov5Tlm57nmoTlhoXlrrnvvIzpgInmi6noioLngrnml7bkvb/nlKhcclxuICBhc3NpZ25JbmZvczogQXNzaWduSW5mb0hlbHBFbnRpdHlbXSA9XHJcbiAgICBbe1xyXG4gICAgICBzZWxlY3RlZEFzc2lnbmVlczogW10sXHJcbiAgICAgIGFzc2lnbmVlSW5mbzogbnVsbCxcclxuICAgICAgYXNzaWduZWVzOiBbXSxcclxuICAgICAgYWN0aXZpdHlOYW1lOiAnJyxcclxuICAgICAgZGVwZW5kZW5jeTogJycsXHJcbiAgICAgIGFub255bW91czogZmFsc2UsXHJcbiAgICAgIGFub255bW91c1RleHQ6IG51bGwsXHJcbiAgICAgIHJlc29sdmVkOiBmYWxzZSxcclxuICAgIH1dOy8v6IqC54K56L+U5Zue55qE5oyH5rS+5L+h5oGv77yI5aSa5Liq77yJXHJcblxyXG4gIHNlbGVjdGVkUHJvY2Vzc0lkOiBzdHJpbmc7Ly/pgInmi6nnmoTmtYHnqIvlrprkuYlJRFxyXG4gIHNlbGVjdGVkTm9kZUlkOiBzdHJpbmc7IC8v6YCJ5oup55qE5LiL5LiA546v6IqCSUTvvIzlkI7nu63njq/oioJpZOeahOaLvOaOpVxyXG4gIHBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZDsvL+S/neWtmOihqOWNleS4iuS8oOadpeeahHBheWxvYWRcclxuICBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTsvL+i/lOWbnmJvb2xcclxuICBzdWJqZWN0V2l0aFJlc3BvbnNlID0gbmV3IFN1YmplY3Q8YW55PigpOy8v6L+U5Zue5rWB56iL5LiK5LiL5paHXHJcbiAgc3ViamVjdENhbmNlbCA9IG5ldyBTdWJqZWN0KCk7Ly/ngrnlh7vlj5bmtojlkI7nmoRzdWJqZWN0XHJcbiAgc3VibWl0RGlzYWJsZTogYm9vbGVhbiA9IGZhbHNlOy8v5o+Q5Lqk5oyJ6ZKu5piv5ZCm56aB55SoXHJcbiAgX2RhdGFJZDogc3RyaW5nO1xyXG4gIF9iaXpEZWZLZXk6IHN0cmluZztcclxuICBzaG93QnV0dG9uczogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIGN1ckxhbmd1YWdlOiBzdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2VDb2RlJykgfHwgJ3poLUNIUyc7Ly/ns7vnu5/lvZPliY3or63oqIBcclxuICBub2RlUGxhY2Vob2xkZXI6IHN0cmluZzsvL+S4i+S4gOeOr+iKgueahHBsYWNlaG9sZGVyXHJcbiAgcHJvY2Vzc1BsYWNlaG9sZGVyOiBzdHJpbmc7Ly/pgInmi6nmtYHnqIvnmoRwbGFjZWhvbGRlclxyXG4gIHdmQ29udGV4dCA9IG5ldyBXZkNvbnRleHQoKTsvL+W3peS9nOa1geS4iuS4i+aWh1xyXG5cclxuICBAVmlld0NoaWxkKCdub2RlQ29tYm8nKSBub2RlQ29tYm86IENvbWJvTGlzdENvbXBvbmVudFxyXG4gIEBWaWV3Q2hpbGQoJ2J1dHRvbnMnKSBidXR0b25zOiBUZW1wbGF0ZVJlZjxhbnk+Oy8v56Gu6K6k5Y+W5raI5oyJ6ZKuXHJcbiAgQElucHV0KCkgb3BlbkZyb21JZnJhbWU6IGJvb2xlYW4gPSBmYWxzZTsvL+aYr+WQpuS7jmlmcmFtZeaJk+W8gO+8jOW6lOeUqElEUOaPkOS6pOWuoeaJuembhuaIkFxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBkYXRhSWQoZGF0YUlkOiBzdHJpbmcpIHtcclxuICAgIGlmICghZGF0YUlkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGFJZOS4uuepulwiKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2RhdGFJZCA9IGRhdGFJZDtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IGJpekRlZktleShiaXpEZWZLZXk6IHN0cmluZykge1xyXG4gICAgaWYgKCFiaXpEZWZLZXkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwi5rWB56iL5YiG57G7aWTkuLrnqbpcIik7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNob3dCdXR0b25zID0gdHJ1ZTtcclxuICAgIHRoaXMuX2JpekRlZktleSA9IGJpekRlZktleTtcclxuICAgIHZhciBwYXlsb2FkID0gbmV3IFN0YXJ0UHJvY2Vzc1BheWxvYWQoKTtcclxuICAgIHBheWxvYWQuZGF0YUlkID0gdGhpcy5fZGF0YUlkO1xyXG4gICAgcGF5bG9hZC5iaXpEZWZLZXkgPSB0aGlzLl9iaXpEZWZLZXk7XHJcbiAgICB0aGlzLnNldFBhcmFtKHBheWxvYWQpO1xyXG4gIH1cclxuXHJcbiAgc2V0UGFyYW0ocGFyYW06IFN0YXJ0UHJvY2Vzc1BheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgICBpZiAoIXBhcmFtKSB7IHJldHVybjsgfVxyXG4gICAgdGhpcy5wYXlsb2FkLmlkID0gcGFyYW0uaWQ7XHJcbiAgICB0aGlzLnBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25JZCA9IHBhcmFtLnByb2Nlc3NEZWZpbml0aW9uSWQ7XHJcbiAgICB0aGlzLnBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25LZXkgPSBwYXJhbS5wcm9jZXNzRGVmaW5pdGlvbktleTtcclxuICAgIHRoaXMucGF5bG9hZC5iaXpEZWZLZXkgPSBwYXJhbS5iaXpEZWZLZXk7XHJcbiAgICB0aGlzLnBheWxvYWQuZGF0YU1vZGVsSWQgPSBwYXJhbS5kYXRhTW9kZWxJZDtcclxuICAgIHRoaXMucGF5bG9hZC5kYXRhSWQgPSBwYXJhbS5kYXRhSWQ7XHJcbiAgICB0aGlzLnBheWxvYWQubmFtZSA9IHBhcmFtLm5hbWU7XHJcbiAgICB0aGlzLnBheWxvYWQuc3RhcnRVc2VySWQgPSBwYXJhbS5zdGFydFVzZXJJZDtcclxuICAgIHRoaXMucGF5bG9hZC5uZXh0Rmxvd05vZGVzID0gW107XHJcbiAgICB0aGlzLndmQ29udGV4dC5wcm9jZXNzQ2F0ZWdvcnlJZCA9IHBhcmFtLmJpekRlZktleTtcclxuICAgIHRoaXMuc3RhcnRQcm9jZXNzU2ltdWxhdGUodGhpcy5wYXlsb2FkLCBzdWJqZWN0KTtcclxuICAgIHJldHVybiBzdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuXHJcbiAgc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZDogU3RhcnRQcm9jZXNzUGF5bG9hZCwgc3ViamVjdDogU3ViamVjdDxhbnk+KSB7XHJcbiAgICBjb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICB0aGlzLnRhc2tTZXJ2aWNlLnN0YXJ0UHJvY2Vzc1NpbXVsYXRlKHBheWxvYWQpLnN1YnNjcmliZSgocmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2UpID0+IHtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICBzdWJqZWN0Lm5leHQodHJ1ZSk7XHJcbiAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgdGhpcy5kZXN0UHJvY2Vzc2VzID0gcmVzcG9uc2UucHJvY0RlZnMubWFwKHByb2Nlc3MgPT4gKHsgaWQ6IHByb2Nlc3MucHJvY0RlZklkLCBuYW1lOiBwcm9jZXNzLnByb2NEZWZOYW1lICsgYCh2JHtwcm9jZXNzLnZlcnNpb259LjApYCB9KSk7Ly/lop7liqDmtYHnqIvnmoTniYjmnKzkv6Hmga9cclxuICAgICAgaWYgKHRoaXMuZGVzdFByb2Nlc3Nlcy5sZW5ndGggPT09IDEpIHsvL+WPquacieS4gOS4quWAmemAiea1geeoi+aXtlxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQgPSB0aGlzLmRlc3RQcm9jZXNzZXNbMF0uaWQ7XHJcbiAgICAgICAgdGhpcy5zZXROZXh0Tm9kZShyZXNwb25zZSk7XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzUGxhY2Vob2xkZXIgPSB0aGlzLmRlc3RQcm9jZXNzZXNbMF0ubmFtZTtcclxuICAgICAgfSBlbHNlIHsvL+WkmuS4qua1geeoi+aXtu+8jOWPluS4iuS4gOasoemAieaLqeeahFxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkUHJvY2Vzc0lkID0gdGhpcy5nZXRTZWxlY3RlZFByb2Nlc3NDYWNoZSh0aGlzLnBheWxvYWQuYml6RGVmS2V5KTtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRQcm9jZXNzSWQgJiYgdGhpcy5kZXN0UHJvY2Vzc2VzLmZpbmRJbmRleChwID0+IHAuaWQgPT09IHNlbGVjdGVkUHJvY2Vzc0lkLnByb2Nlc3NEZWZpbml0aW9uSWQpID4gLTEpIHtcclxuICAgICAgICAgIHRoaXMuZ2V0RGVzdE5vZGVzKHNlbGVjdGVkUHJvY2Vzc0lkLnByb2Nlc3NEZWZpbml0aW9uSWQpO1xyXG4gICAgICAgICAgdGhpcy5wcm9jZXNzUGxhY2Vob2xkZXIgPSBzZWxlY3RlZFByb2Nlc3NJZC5wcm9jZXNzRGVmaW5pdGlvbk5hbWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMucHJvY2Vzc1BsYWNlaG9sZGVyID0gdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgndGFzay5zZWxlY3RQbGFjZWhvbGRlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHN1YmplY3QuZXJyb3IoZXJyb3IpO1xyXG4gICAgICB0aGlzLnRhc2tTZXJ2aWNlLmVycm9yKGVycm9yKTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDpgInmi6nmn5DkuKrmtYHnqIvlkI5cclxuICAgKiBAcGFyYW0gZGF0YVxyXG4gICAqL1xyXG4gIHNlbGVjdFByb2Nlc3NDaGFuZ2UoZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLm5vZGVDb21iby5vbkNsZWFyKCk7XHJcbiAgICB0aGlzLmdldERlc3ROb2RlcyhkYXRhLmRhdGEuaWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2u6YCJ5oup55qE5rWB56iL5a6a5LmJaWTojrflj5bkuIvkuIDnjq/oioLkv6Hmga9cclxuICAgKiBAcGFyYW0gc2VsZWN0ZWRQcm9jZXNzSWQgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXREZXN0Tm9kZXMoc2VsZWN0ZWRQcm9jZXNzSWQ6IHN0cmluZykge1xyXG4gICAgdGhpcy5zZWxlY3RlZFByb2Nlc3NJZCA9IHNlbGVjdGVkUHJvY2Vzc0lkO1xyXG4gICAgdGhpcy5kZXN0Tm9kZXMgPSBbXTtcclxuICAgIHRoaXMubm9kZVBsYWNlaG9sZGVyID0gJyc7XHJcbiAgICB0aGlzLmNsZWFyQXNzaWduSW5mb3MoKTtcclxuXHJcbiAgICB2YXIgcGF5bG9hZCA9IG5ldyBTdGFydFByb2Nlc3NQYXlsb2FkKCk7XHJcbiAgICBwYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkO1xyXG4gICAgcGF5bG9hZC5kYXRhSWQgPSB0aGlzLnBheWxvYWQuZGF0YUlkO1xyXG5cclxuICAgIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMudGFza1NlcnZpY2Uuc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZCkuc3Vic2NyaWJlKChyZXNwb25zZTogU2ltdWxhdGVSZXNwb25zZSkgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgdGhpcy5zZXROZXh0Tm9kZShyZXNwb25zZSk7XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5lcnJvcihlcnJvcik7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5oup6IqC54K55ZCO5LqL5Lu2XHJcbiAgICovXHJcbiAgc2VsZWN0Tm9kZUNoYW5nZShkYXRhOiBhbnkpIHtcclxuICAgIHRoaXMuY2xlYXJBc3NpZ25JbmZvcygpO1xyXG4gICAgdGhpcy5zZWxlY3RlZE5vZGVJZCA9IGRhdGEuZGF0YS5pZDtcclxuICAgIGNvbnN0IG5vZGVOYW1lcyA9IGRhdGEuZGF0YS5uYW1lLnNwbGl0KCfvvIwnKTtcclxuXHJcbiAgICBpZiAodGhpcy5yZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbZGF0YS5pbmRleF0ubm9kZUluZm9MaXN0LmV2ZXJ5KG5vZGUgPT4gbm9kZS5yZXNvbHZlZCA9PT0gdHJ1ZSkpIHsvL+W3sumihOino+aekOWPguS4juiAhVxyXG4gICAgICB0aGlzLnNldEFzc2lnbkluZm8odGhpcy5yZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbZGF0YS5pbmRleF0pO1xyXG4gICAgfSBlbHNlIHsvL+acqumihOino+aekOWPguS4juiAhVxyXG4gICAgICBsZXQgcGF5bG9hZCA9IG5ldyBTdGFydFByb2Nlc3NQYXlsb2FkKCk7XHJcbiAgICAgIHBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25JZCA9IHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQ7XHJcbiAgICAgIHBheWxvYWQuZGF0YUlkID0gdGhpcy5wYXlsb2FkLmRhdGFJZDtcclxuICAgICAgcGF5bG9hZC5uZXh0Rmxvd05vZGVzID0gW107XHJcblxyXG4gICAgICB0aGlzLnNlbGVjdGVkTm9kZUlkLnNwbGl0KCfvvIwnKS5mb3JFYWNoKChub2RlSWQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgbGV0IG5leHRGbG93Tm9kZSA9IG5ldyBGbG93Tm9kZUluZm8oKTtcclxuICAgICAgICBuZXh0Rmxvd05vZGUuYWN0aXZpdHlEZWZpbml0aW9uSWQgPSBub2RlSWQ7XHJcbiAgICAgICAgbmV4dEZsb3dOb2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUgPSBub2RlTmFtZXNbaW5kZXhdO1xyXG4gICAgICAgIHBheWxvYWQubmV4dEZsb3dOb2Rlcy5wdXNoKG5leHRGbG93Tm9kZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICB0aGlzLnRhc2tTZXJ2aWNlLnN0YXJ0UHJvY2Vzc1NpbXVsYXRlKHBheWxvYWQpLnN1YnNjcmliZSgocmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2UpID0+IHtcclxuICAgICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy5zZXRBc3NpZ25JbmZvKHJlc3BvbnNlLnNpbXVsYXRpb25QYXRoc1swXSk7Ly/pgInmi6nnmoTkuIvkuIDnjq/oioLlupTor6XlnKjlkIzkuIDmnaHot6/lvoTkuIrvvIzmlYXlj5ZzaW11bGF0aW9uUGF0aHNbMF1cclxuICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLnRhc2tTZXJ2aWNlLmVycm9yKGVycm9yKTtcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiDlrp7njrDnnJ/mraPnmoTmj5DkuqRcclxuICovXHJcbiAgc3RhcnRQcm9jZXNzU3VibWl0KCkge1xyXG4gICAgaWYgKCF0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkKSB7XHJcbiAgICAgIHRoaXMub3BlbkZyb21JZnJhbWUgPyB0aGlzLm1lc3NhZ2VyLndhcm5pbmcodGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhcnRQcm9jZXNzLnNlbGVjdFByb2Nlc3MnKSkgOlxyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhcnRQcm9jZXNzLnNlbGVjdFByb2Nlc3MnKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghdGhpcy5zZWxlY3RlZE5vZGVJZCkge1xyXG4gICAgICB0aGlzLm9wZW5Gcm9tSWZyYW1lID8gdGhpcy5tZXNzYWdlci53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXJ0UHJvY2Vzcy5zZWxlY3ROb2RlJykpIDpcclxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXJ0UHJvY2Vzcy5zZWxlY3ROb2RlJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5hc3NpZ25JbmZvcy5maWx0ZXIoaW5mbyA9PiAoaW5mby5hc3NpZ25lZUluZm8gfHwgaW5mby5zZWxlY3RlZEFzc2lnbmVlcy5sZW5ndGgpICYmICFpbmZvLmFzc2lnbmVlcy5sZW5ndGgpLmxlbmd0aCkgey8v56m65Y+C5LiO6ICF562W55Wl5pe277yM5LiN5o+Q56S66YCJ5Lq6XHJcbiAgICAgIHRoaXMub3BlbkZyb21JZnJhbWUgPyB0aGlzLm1lc3NhZ2VyLndhcm5pbmcodGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgndGFzay5zZWxlY3RQcm9jZXNzb3InKSkgOlxyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgndGFzay5zZWxlY3RQcm9jZXNzb3InKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub2Rlczogc3RyaW5nW10gPSB0aGlzLnNlbGVjdGVkTm9kZUlkLnNwbGl0KCfvvIwnKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgbGV0IG5leHRGbG93Tm9kZTogRmxvd05vZGVJbmZvID0ge1xyXG4gICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbklkOiBub2Rlc1tpXSxcclxuICAgICAgICBhY3Rpdml0eURlZmluaXRpb25OYW1lOiB0aGlzLmFzc2lnbkluZm9zW2ldLmFjdGl2aXR5TmFtZSxcclxuICAgICAgICBkZXBlbmRlbmN5OiB0aGlzLmFzc2lnbkluZm9zW2ldLmRlcGVuZGVuY3ksXHJcbiAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IHRoaXMuYXNzaWduSW5mb3NbaV0uYXNzaWduZWVJbmZvID8gdGhpcy5hc3NpZ25JbmZvc1tpXS5hc3NpZ25lZXMgOiBbXSxcclxuICAgICAgICBhc3NpZ25lZUluZm86IG51bGwsXHJcbiAgICAgICAgcmVzb2x2ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGFub255bW91czogZmFsc2UsXHJcbiAgICAgICAgYW5vbnltb3VzVGV4dDogJydcclxuICAgICAgfVxyXG4gICAgICAvL+iKgueCueaJvuS4jeWIsOS6uu+8jOS4lOW8guW4uOaPkOekuu+8jOWJjeerr+aOp+WItuS9j++8jOS4jeWFgeiuuOi1sOaPkOS6pOivt+axgu+8iOaehOS7tuS6i+WKoemXrumimO+8ieOAguW5tuihjOWcuuaZr+S4i+aaguS4jeWkhOeQhlxyXG4gICAgICBpZiAodGhpcy5yZXNwb25zZSAmJiB0aGlzLnJlc3BvbnNlLnNpbXVsYXRpb25QYXRocy5sZW5ndGggJiYgIXRoaXMucmVzcG9uc2Uuc2ltdWxhdGlvblBhdGhzWzBdLmlkLnN0YXJ0c1dpdGgoJ1BhcmFsbGVsR2F0ZXdheScpKSB7XHJcbiAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA9PSAxICYmIG5vZGVzW2ldLnN0YXJ0c1dpdGgoJ1VzZXJBY3Rpdml0eScpICYmIHRoaXMuYXNzaWduSW5mb3NbaV0ucmVzb2x2ZWQgJiYgIXRoaXMuYXNzaWduSW5mb3NbaV0uYXNzaWduZWVJbmZvICYmICF0aGlzLmFzc2lnbkluZm9zW2ldLnNlbGVjdGVkQXNzaWduZWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgY29uc3Qgc3RyID0gdGhpcy5hc3NpZ25JbmZvc1tpXS5hY3Rpdml0eU5hbWUgKyB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdzdGFydFByb2Nlc3Mubm9kZScpICsgdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhcnRQcm9jZXNzLm5vVXNlcicpO1xyXG4gICAgICAgICAgdGhpcy5vcGVuRnJvbUlmcmFtZSA/IHRoaXMubWVzc2FnZXIud2FybmluZyhzdHIpIDogdGhpcy5ub3RpZnkud2FybmluZyhzdHIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLnBheWxvYWQubmV4dEZsb3dOb2Rlcy5wdXNoKG5leHRGbG93Tm9kZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25JZCA9IHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQ7XHJcbiAgICB0aGlzLnN1Ym1pdERpc2FibGUgPSB0cnVlO1xyXG4gICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5zdGFydFByb2Nlc3ModGhpcy5wYXlsb2FkKS5zdWJzY3JpYmUoKHJlc3BvbnNlOiBFeGVjdXRpb25SZXNwb25zZSkgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgdGhpcy5zdWJqZWN0V2l0aFJlc3BvbnNlLm5leHQocmVzcG9uc2UpO1xyXG4gICAgICBsZXQgbWVzc2FnZUFmdGVyU3VibWl0ID0gdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhcnRQcm9jZXNzLnN1Ym1pdFN1Y2Nlc3MnKTtcclxuICAgICAgaWYgKHRoaXMub3BlbkZyb21JZnJhbWUpIHtcclxuICAgICAgICAod2luZG93LnBhcmVudCBhcyBhbnkpLmdzcFdmU2VydmljZS5ldmVudEhhbmRsZXIoeyBkYXRhOiB7IHR5cGU6IE1lc3NhZ2VUeXBlLlN1Ym1pdFN1Y2Nlc3MsIG1lc3NhZ2U6IG1lc3NhZ2VBZnRlclN1Ym1pdCB9IH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlclNlcnZpY2UuaGFuZGxlU3VibWl0TWVzc2FnZShDb25maWdDb2RlLkluZm9fQWZ0ZXJfU3VibWl0LCB0aGlzLnBheWxvYWQuYml6RGVmS2V5KTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXRoaXMub3BlbkZyb21JZnJhbWUgJiYgcmVzcG9uc2UubmVlZEludGVyYWN0aW9uKSB7Ly/mj5DkuqTlrqHmibnlkI7pnIDopoHmjIfmtL7lnLrmma9cclxuICAgICAgICB0aGlzLm5vdGlmeS5pbmZvKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ2N1ZVdvcmRzLnNlbGVjdCcpXHJcbiAgICAgICAgICArIHJlc3BvbnNlLm5leHRGbG93Tm9kZXNbMF0uYWN0aXZpdHlEZWZpbml0aW9uTmFtZVxyXG4gICAgICAgICAgKyB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdjdWVXb3Jkcy5wcm9jZXNzb3InKSk7XHJcbiAgICAgICAgbGV0IHRhc2sgPSBuZXcgVGFza0VudGl0eSgpO1xyXG4gICAgICAgIGxldCBhY3Rpb24gPSBuZXcgVGFza0FjdGlvbigpO1xyXG4gICAgICAgIHRhc2suc291cmNlSWQgPSByZXNwb25zZS5uZXh0Rmxvd05vZGVzWzBdLmFzc2lnbmVlSW5mby53b3JrSXRlbUlkO1xyXG4gICAgICAgIGFjdGlvbi5jb2RlID0gJ0Fzc2lnblVzZXInO1xyXG4gICAgICAgIGFjdGlvbi5uYW1lID0gdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnY3VlV29yZHMuYXNzaWduVXNlcicpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlclNlcnZpY2UuZXhlY3V0ZSh0YXNrLCBhY3Rpb24pLnN1YnNjcmliZShyZSA9PiB7IH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2V0U2VsZWN0ZWRQcm9jZXNzQ2FjaGUoKTtcclxuICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMucGF5bG9hZC5uZXh0Rmxvd05vZGVzID0gW107XHJcbiAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnN1YmplY3QubmV4dChmYWxzZSk7Ly/lt7Lnu4/mnInkurrnlKjkuobov5nkuKpzdWJqZWN077yM5o+Q5Lqk5aSx6LSl55qE6K+d6L+U5ZueZmFsc2UgYnkgZmFuZ3BlbmdmZWlAMjAyMTAzMjRcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5lcnJvcihlcnJvcik7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5oup5rWB56iL5riF56m6XHJcbiAgICovXHJcbiAgc2VsZWN0UHJvY2Vzc0NsZWFyKCkge1xyXG4gICAgdGhpcy5zZWxlY3RlZFByb2Nlc3NJZCA9ICcnO1xyXG4gICAgdGhpcy5kZXN0Tm9kZXMgPSBbXTtcclxuICAgIHRoaXMubm9kZVBsYWNlaG9sZGVyID0gJyc7XHJcbiAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gJyc7XHJcbiAgICB0aGlzLmNsZWFyQXNzaWduSW5mb3MoKTtcclxuICAgIHRoaXMucmVzcG9uc2UgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5oup6IqC54K55riF56m6XHJcbiAgICovXHJcbiAgc2VsZWN0Tm9kZUNsZWFyKCkge1xyXG4gICAgdGhpcy5zZWxlY3RlZE5vZGVJZCA9ICcnO1xyXG4gICAgdGhpcy5jbGVhckFzc2lnbkluZm9zKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDnlKjmiLfluK7liqnpgInkurpcclxuICAgKi9cclxuICBhZnRlckNvbmZpcm0oZGF0YTogQXNzaWduZWVbXSwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgdGhpcy5hc3NpZ25JbmZvc1tpbmRleF0uYXNzaWduZWVzID0gZGF0YTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOW8ueahhueCueWHu+WPlua2iFxyXG4gICAqL1xyXG4gIGNhbmNlbCgpIHtcclxuICAgIGlmICh0aGlzLm9wZW5Gcm9tSWZyYW1lKSB7XHJcbiAgICAgICh3aW5kb3cucGFyZW50IGFzIGFueSkuZ3NwV2ZTZXJ2aWNlLmV2ZW50SGFuZGxlcih7IGRhdGE6IHsgdHlwZTogTWVzc2FnZVR5cGUuQ2FuY2VsLCBtZXNzYWdlOiAnJyB9IH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdWJqZWN0Q2FuY2VsLm5leHQoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5o+Q5Lqk5a6h5om55ZCO6L+U5Zue5YC877yIYm9vbOWei++8jOWFvOWuueWOhuWPsu+8iVxyXG4gICAqL1xyXG4gIGdldFN1YmplY3QoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5bmj5DkuqTlrqHmibnlkI7ov5Tlm57lgLzvvIjlrp7kvZPlnovvvIzluKbmtYHnqIvkuIrkuIvmlofvvIlcclxuICAgKi9cclxuICBnZXRTdWJqZWN0V2l0aFJlc3BvbnNlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc3ViamVjdFdpdGhSZXNwb25zZS5hc09ic2VydmFibGUoKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog54K55Ye75Y+W5raI5ZCO55qEc3ViamVjdO+8jOWFs+mXreeql+WPo+S9v+eUqFxyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgZ2V0U3ViamVjdENhbmNlbCgpIHtcclxuICAgIHJldHVybiB0aGlzLnN1YmplY3RDYW5jZWwuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDorr7nva7kuIvkuIDnjq/oioJcclxuICAgKi9cclxuICBwcml2YXRlIHNldE5leHROb2RlKHJlc3BvbnNlOiBTaW11bGF0ZVJlc3BvbnNlKSB7XHJcbiAgICB0aGlzLmRlc3ROb2RlcyA9IHJlc3BvbnNlLnNpbXVsYXRpb25QYXRocyAmJiByZXNwb25zZS5zaW11bGF0aW9uUGF0aHMubWFwKHBhdGggPT4gKHtcclxuICAgICAgaWQ6IHBhdGgubm9kZUluZm9MaXN0Lm1hcChub2RlID0+IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uSWQpLmpvaW4oJ++8jCcpLFxyXG4gICAgICBuYW1lOiBwYXRoLm5vZGVJbmZvTGlzdC5tYXAobm9kZSA9PiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUpLmpvaW4oJ++8jCcpXHJcbiAgICB9KSk7XHJcbiAgICAvL+WkhOeQhum7mOiupOWIhuaUr++8jOaXoOm7mOiupOWIhuaUr+i/lOWbni0xXHJcbiAgICBjb25zdCBkZWZhdWx0SW5kZXggPSByZXNwb25zZS5zaW11bGF0aW9uUGF0aHMuZmluZEluZGV4KGEgPT4gYS5kZWZhdWx0KTtcclxuICAgIGlmIChkZWZhdWx0SW5kZXggPiAtMSkge1xyXG4gICAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gdGhpcy5kZXN0Tm9kZXNbZGVmYXVsdEluZGV4XS5pZDtcclxuICAgICAgdGhpcy5ub2RlUGxhY2Vob2xkZXIgPSB0aGlzLmRlc3ROb2Rlc1tkZWZhdWx0SW5kZXhdLm5hbWUuaW5kZXhPZign77yMJykgPiAtMSA/IHJlc3BvbnNlLnNpbXVsYXRpb25QYXRoc1tkZWZhdWx0SW5kZXhdLm5hbWUgOiB0aGlzLmRlc3ROb2Rlc1tkZWZhdWx0SW5kZXhdLm5hbWU7XHJcbiAgICAgIHRoaXMuc2V0QXNzaWduSW5mbyhyZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbZGVmYXVsdEluZGV4XSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm5vZGVQbGFjZWhvbGRlciA9IHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3Rhc2suc2VsZWN0UGxhY2Vob2xkZXInKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuvue9ruW9k+WJjeaMh+a0vuS/oeaBr+W4ruWKqeWPguaVsFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0QXNzaWduSW5mbyhzaW11bGF0aW9uUGF0aHM6IFNpbXVsYXRpb25QYXRoKSB7XHJcbiAgICB0aGlzLmFzc2lnbkluZm9zID0gW107XHJcbiAgICB0aGlzLnNlbGVjdGVkTm9kZUlkLnNwbGl0KCfvvIwnKS5mb3JFYWNoKG5vZGVJZCA9PiB7XHJcbiAgICAgIGNvbnN0IG5vZGUgPSBzaW11bGF0aW9uUGF0aHMubm9kZUluZm9MaXN0LmZpbmQobm9kZSA9PiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbklkID09PSBub2RlSWQpO1xyXG4gICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgIHRoaXMuYXNzaWduSW5mb3MucHVzaCh7XHJcbiAgICAgICAgICBzZWxlY3RlZEFzc2lnbmVlczogbm9kZS5zZWxlY3RlZEFzc2lnbmVlcyxcclxuICAgICAgICAgIGFzc2lnbmVlSW5mbzogbm9kZS5hc3NpZ25lZUluZm8sXHJcbiAgICAgICAgICBhc3NpZ25lZXM6IG5vZGUuc2VsZWN0ZWRBc3NpZ25lZXMubWFwKHVzZXIgPT4geyByZXR1cm4geyBpZDogdXNlci5pZCwgbmFtZTogdXNlci5uYW1lIH0gfSksXHJcbiAgICAgICAgICBhY3Rpdml0eU5hbWU6IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uTmFtZSxcclxuICAgICAgICAgIGRlcGVuZGVuY3k6IG5vZGUuZGVwZW5kZW5jeSxcclxuICAgICAgICAgIGFub255bW91czogbm9kZS5hbm9ueW1vdXMsXHJcbiAgICAgICAgICBhbm9ueW1vdXNUZXh0OiBub2RlLmFub255bW91c1RleHQsXHJcbiAgICAgICAgICByZXNvbHZlZDogbm9kZS5yZXNvbHZlZFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5hc3NpZ25JbmZvcy5wdXNoKHtcclxuICAgICAgICAgIHNlbGVjdGVkQXNzaWduZWVzOiBbXSxcclxuICAgICAgICAgIGFzc2lnbmVlSW5mbzogbnVsbCxcclxuICAgICAgICAgIGFzc2lnbmVlczogW10sXHJcbiAgICAgICAgICBhY3Rpdml0eU5hbWU6ICcnLFxyXG4gICAgICAgICAgZGVwZW5kZW5jeTogJycsXHJcbiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLFxyXG4gICAgICAgICAgYW5vbnltb3VzVGV4dDogJycsXHJcbiAgICAgICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOa4heepuuW9k+WJjeaMh+a0vuS/oeaBr+W4ruWKqeWPguaVsFxyXG4gICAqL1xyXG4gIHByaXZhdGUgY2xlYXJBc3NpZ25JbmZvcygpIHtcclxuICAgIHRoaXMuYXNzaWduSW5mb3MgPSBbe1xyXG4gICAgICBzZWxlY3RlZEFzc2lnbmVlczogW10sXHJcbiAgICAgIGFzc2lnbmVlSW5mbzogbnVsbCxcclxuICAgICAgYXNzaWduZWVzOiBbXSxcclxuICAgICAgYWN0aXZpdHlOYW1lOiAnJyxcclxuICAgICAgZGVwZW5kZW5jeTogJycsXHJcbiAgICAgIGFub255bW91czogZmFsc2UsXHJcbiAgICAgIGFub255bW91c1RleHQ6ICcnLFxyXG4gICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICB9XTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlua1j+iniOWZqOe8k+WtmO+8jOS4iuasoea1geeoi+mAieaLqeeahOe7k+aenFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0U2VsZWN0ZWRQcm9jZXNzQ2FjaGUocHJvY2Vzc0NhdGVnb3J5SWQ6IHN0cmluZykge1xyXG4gICAgbGV0IGJyb3dzZXJDYWNoZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJnc3BXZlN0YXJ0UHJvY2Vzc1wiKSkgYXMgU3RhcnRQcm9jZXNzQ2FjaGU7XHJcbiAgICBpZiAoYnJvd3NlckNhY2hlICYmIGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0KSB7XHJcbiAgICAgIHJldHVybiBicm93c2VyQ2FjaGUuc2VsZWN0ZWRQcm9jZXNzTGlzdC5maW5kKGEgPT4gYS5wcm9jZXNzQ2F0ZWdvcnkgPT0gcHJvY2Vzc0NhdGVnb3J5SWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOa1j+iniOWZqOe8k+WtmOiusOS4i+a1geeoi+mAieaLqeeahOe7k+aenFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0U2VsZWN0ZWRQcm9jZXNzQ2FjaGUoKSB7XHJcbiAgICBjb25zdCBwcm9jZXNzQ2F0ZWdvcnlJZCA9IHRoaXMucGF5bG9hZC5iaXpEZWZLZXk7XHJcbiAgICBjb25zdCBwcm9jZXNzRGVmaW5pdGlvbklkID0gdGhpcy5wYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQ7XHJcbiAgICBsZXQgcHJvY2VzcyA9IHRoaXMuZGVzdFByb2Nlc3Nlcy5maW5kKGEgPT4gYS5pZCA9PSBwcm9jZXNzRGVmaW5pdGlvbklkKTtcclxuICAgIGNvbnN0IHByb2Nlc3NEZWZpbml0aW9uTmFtZSA9IHByb2Nlc3MgJiYgcHJvY2Vzcy5uYW1lO1xyXG5cclxuICAgIGxldCBicm93c2VyQ2FjaGUgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiZ3NwV2ZTdGFydFByb2Nlc3NcIikpIGFzIFN0YXJ0UHJvY2Vzc0NhY2hlO1xyXG4gICAgaWYgKGJyb3dzZXJDYWNoZSAmJiBicm93c2VyQ2FjaGUuc2VsZWN0ZWRQcm9jZXNzTGlzdCkge1xyXG4gICAgICBsZXQgc2VsZWN0ZWRQcm9jZXNzTGlzdCA9IGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0O1xyXG4gICAgICBpZiAoc2VsZWN0ZWRQcm9jZXNzTGlzdC5maW5kSW5kZXgoYSA9PiBhLnByb2Nlc3NDYXRlZ29yeSA9PSBwcm9jZXNzQ2F0ZWdvcnlJZCkgPiAtMSkge1xyXG4gICAgICAgIHNlbGVjdGVkUHJvY2Vzc0xpc3QubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgaWYgKGl0ZW0ucHJvY2Vzc0NhdGVnb3J5ID09IHByb2Nlc3NDYXRlZ29yeUlkKSB7XHJcbiAgICAgICAgICAgIGl0ZW0ucHJvY2Vzc0RlZmluaXRpb25JZCA9IHByb2Nlc3NEZWZpbml0aW9uSWQ7XHJcbiAgICAgICAgICAgIGl0ZW0ucHJvY2Vzc0RlZmluaXRpb25OYW1lID0gcHJvY2Vzc0RlZmluaXRpb25OYW1lO1xyXG4gICAgICAgICAgICBpdGVtLmxvZ1RpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0ID0gc2VsZWN0ZWRQcm9jZXNzTGlzdDtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImdzcFdmU3RhcnRQcm9jZXNzXCIsIEpTT04uc3RyaW5naWZ5KGJyb3dzZXJDYWNoZSkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBpdGVtID0gbmV3IFNlbGVjdGVkUHJvY2Vzc0l0ZW0ocHJvY2Vzc0NhdGVnb3J5SWQsIHByb2Nlc3NEZWZpbml0aW9uSWQsIHByb2Nlc3NEZWZpbml0aW9uTmFtZSk7XHJcbiAgICAgICAgc2VsZWN0ZWRQcm9jZXNzTGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0ID0gc2VsZWN0ZWRQcm9jZXNzTGlzdDtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImdzcFdmU3RhcnRQcm9jZXNzXCIsIEpTT04uc3RyaW5naWZ5KGJyb3dzZXJDYWNoZSkpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgYnJvd3NlckNhY2hlID0gbmV3IFN0YXJ0UHJvY2Vzc0NhY2hlKCk7XHJcbiAgICAgIGxldCBzZWxlY3RlZFByb2Nlc3NMaXN0ID0gW107XHJcbiAgICAgIGxldCBpdGVtID0gbmV3IFNlbGVjdGVkUHJvY2Vzc0l0ZW0ocHJvY2Vzc0NhdGVnb3J5SWQsIHByb2Nlc3NEZWZpbml0aW9uSWQsIHByb2Nlc3NEZWZpbml0aW9uTmFtZSk7XHJcbiAgICAgIHNlbGVjdGVkUHJvY2Vzc0xpc3QucHVzaChpdGVtKTtcclxuICAgICAgYnJvd3NlckNhY2hlLnNlbGVjdGVkUHJvY2Vzc0xpc3QgPSBzZWxlY3RlZFByb2Nlc3NMaXN0O1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImdzcFdmU3RhcnRQcm9jZXNzXCIsIEpTT04uc3RyaW5naWZ5KGJyb3dzZXJDYWNoZSkpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufVxyXG4iXX0=