/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, ElementRef, ComponentFactoryResolver, Injector } from '@angular/core';
import { of } from 'rxjs/observable/of';
import { FormBuilder } from '@angular/forms';
import { ExecuteFormsUIState } from './execute-forms.uistate';
import { ExecuteFormsViewModel } from './execute-forms.viewmodel';
import { ExecuteFormsRepository } from './execute-forms.repository';
import { ExecuteFormModel, ActualParameter } from './entities/execute-form.entity';
import { BsModalService } from '@farris/ui-modal';
import { AddExecuteFormComponent } from './add-execute-form/add-execute-form.component';
import { FormConfigContainerComponent } from './form-config-container/form-config-container.component';
import { ParameterSettingComponent } from './parameter-setting/parameter-setting.component';
import { switchMap } from 'rxjs/operators';
export class ExecuteFormsComponent {
    // *******************************************************
    /**
     * @param {?} formBuilder
     * @param {?} uistate
     * @param {?} viewmodel
     * @param {?} resolver
     * @param {?} injector
     * @param {?} modalService
     */
    constructor(formBuilder, uistate, viewmodel, resolver, injector, modalService) {
        this.formBuilder = formBuilder;
        this.uistate = uistate;
        this.viewmodel = viewmodel;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.modalConfig = {
            title: '表单定义',
            width: 794,
            height: 505,
            showButtons: true
        };
        this.cls = 'farris-main-area flex-column';
        this.style = '#FFF';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.tab = 'web';
        this.groupIcon = '<i class="f-icon f-icon-lookup"></i>';
        this.cols = [];
        this.showMethodTab = true;
        this.form = new ExecuteFormModel();
    }
    /**
     * @param {?} item
     * @return {?}
     */
    set value(item) {
        if (item) {
            /** @type {?} */
            const paramArray = new Array();
            item.ActualParameters.forEach((/**
             * @param {?} a
             * @return {?}
             */
            a => {
                /** @type {?} */
                const para = new ActualParameter();
                para.Name = a.Name;
                para.Value = a.Value;
                paramArray.push(para);
            }));
            this.form.ActualParameters = paramArray;
            this.form.Id = item.Id;
            this.form.Name = item.Name;
            this.form.ComponentId = item.ComponentId;
            this.form.formFormatId = item.formFormatId;
            this.form.formatConfigId = item.formatConfigId;
            this.form.FormType = item.FormType;
            this.form.TerminalType = item.TerminalType;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // this.editCSS();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.location = this.editorParams.location;
        this.tab = this.editorParams.tab;
        if (this.location === 'userActivity') {
            this.showMethodTab = true;
        }
        else {
            this.showMethodTab = false;
        }
    }
    /**
     * @return {?}
     */
    clickOK() {
        /** @type {?} */
        let data = new ExecuteFormModel();
        this.getForm().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            if (!re.result) {
                return;
            }
            data = re.form;
            /** @type {?} */
            const object = { value: data, parameters: null };
            this.submitModal.emit(object);
        }));
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    // tabChange(data) {
    //   this.tab = data.nextId;
    // }
    // editCSS() {
    //   this.configSection.nativeElement.querySelector('div.f-section-header').classList.add('mb-0');
    // }
    /**
     * @private
     * @return {?}
     */
    getForm() {
        if (this.form.ComponentId) {
            return of({ result: true, form: this.form });
        }
        else if (this.form.formFormatId) {
            return this.configContainer.submit().pipe(switchMap((/**
             * @param {?} re
             * @return {?}
             */
            (re) => {
                if (re.result) {
                    this.form.formatConfigId = re.configId;
                    return of({ result: true, form: this.form });
                }
                else {
                    return of({ result: false, form: this.form });
                }
            })));
        }
        else {
            return of({ result: true, form: null });
        }
    }
    /**
     * 参数设置
     * @return {?}
     */
    parametersSet() {
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(ParameterSettingComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        compRef.instance.mode = 'bpmn';
        if (this.tab === 'web') {
            if (this.form.ComponentId) {
                compRef.instance.showFormType = true;
                compRef.instance.formType = this.form.FormType;
            }
            compRef.instance.parameters = [...this.form.ActualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => Object.assign({}, p)))];
        }
        else {
            compRef.instance.parameters = [...this.form.ActualParameters.map((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => Object.assign({}, p)))];
        }
        /** @type {?} */
        const modalConfig = {
            title: '参数设置',
            width: 620,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        /** @type {?} */
        const dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            if (this.tab === 'web') {
                this.form.ActualParameters = re.parameters;
                this.form.FormType = re.formType;
            }
            else {
                this.form.ActualParameters = re.parameters;
            }
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            dialog.close();
        }));
    }
    /**
     * 选择表单定义
     * @return {?}
     */
    selectExecuteForm() {
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(AddExecuteFormComponent);
        /** @type {?} */
        const compRef = compFactory.create(this.injector);
        compRef.instance.tab = this.tab;
        /** @type {?} */
        const modalConfig = {
            title: '表单定义列表',
            width: 650,
            height: 400,
            showButtons: true,
            buttons: compRef.instance.modalFooter
        };
        /** @type {?} */
        const dialog = this.modalService.show(compRef, modalConfig);
        compRef.instance.submit.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            this.form = re;
            dialog.close();
        }));
        compRef.instance.cancel.subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            dialog.close();
        }));
    }
    /**
     * @return {?}
     */
    clear() {
        this.form = new ExecuteFormModel();
    }
}
ExecuteFormsComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-execute-forms',
                template: "  <!-- <div class=\"h-100 farris-split-section m-2\">\r\n    <farris-tabs #tabs [value]=\"'web'\" [fill]=\"true\" (tabChange)=\"tabChange($event)\" [contentFill]=\"true\" class=\"f-utils-fill h-100\">\r\n      <farris-tab title=\"Web\u8868\u5355\" [show]=\"true\" [id]=\"'web'\" class=\"h-100\">\r\n        <ng-template #content>\r\n          <farris-section class=\"f-section-form f-section-in-mainsubcard pt-0\" [enableAccordion]=\"'default'\" [mainTitle]=\"'\u8868\u5355\u5B9A\u4E49'\"\r\n            [subTitle]=\"''\" [enableMaximize]=\"false\">\r\n            <div class=\"farris-form farris-form-controls-inline farris-form-auto f-form-lable-auto\">\r\n              <div class=\"f-section-formgroup-inputs\">\r\n                <div class=\"col-12 col-md-10\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group mb-0\">\r\n                      <div class=\"farris-input-wrap pl-4\">\r\n                        <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"true\"\r\n                          [showButtonWhenDisabled]=\"false\" [(ngModel)]=\"webForm.Name\" name=\"webForm\" [placeholder]=\"'\u8BF7\u9009\u62E9'\"\r\n                          [editable]=\"false\" (clickHandle)=\"selectExecuteForm()\" (clear)=\"clear()\" [groupText]=\"groupIcon\">\r\n                        </input-group>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 col-md-2\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group mb-0\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <button [disabled]=\"!webForm.ComponentId && !webForm.formFormatId\" class=\"btn-sm btn-secondary btn\" \r\n                          (click)=\"parametersSet()\">\r\n                          \u8868\u5355\u53C2\u6570\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </farris-section>\r\n          <farris-section #webConfigSection class=\"f-section-tabs f-section-in-mainsubcard pb-0 pt-1\" [enableAccordion]=\"''\" [mainTitle]=\"'\u8868\u5355\u683C\u5F0F\u8BBE\u7F6E'\"\r\n            [subTitle]=\"''\" [enableMaximize]=\"false\" [fill]=\"true\">\r\n            <lib-form-config-container #webConfigContainer *ngIf=\"webForm.formFormatId; else empty\" \r\n            [formFormatId]=\"webForm.formFormatId\" [formatConfigId]=\"webForm.formatConfigId\" [showMethodTab]=\"showMethodTab\" class=\"h-100\"></lib-form-config-container>\r\n          </farris-section>\r\n        </ng-template>\r\n      </farris-tab>\r\n      <farris-tab title=\"\u79FB\u52A8\u8868\u5355\" [id]=\"'mobile'\" class=\"h-100\">\r\n        <ng-template #content>\r\n          <farris-section class=\"f-section-form f-section-in-mainsubcard pt-0\" [enableAccordion]=\"'default'\" [mainTitle]=\"'\u8868\u5355\u5B9A\u4E49'\"\r\n            [subTitle]=\"''\" [enableMaximize]=\"false\">\r\n            <div class=\"farris-form farris-form-controls-inline farris-form-auto f-form-lable-auto\">\r\n              <div class=\"f-section-formgroup-inputs\">\r\n                <div class=\"col-12 col-md-10\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group mb-0\">\r\n                      <div class=\"farris-input-wrap pl-4\">\r\n                        <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"true\"\r\n                          [showButtonWhenDisabled]=\"false\" [(ngModel)]=\"mobileForm.Name\" name=\"mobileForm\" [placeholder]=\"'\u8BF7\u9009\u62E9'\"\r\n                          [editable]=\"false\" (clickHandle)=\"selectExecuteForm()\" (clear)=\"clear()\" [groupText]=\"groupIcon\">\r\n                        </input-group>\r\n                        <div class=\"farris-feedback valid-feedback\"></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 col-md-2\">\r\n                  <div class=\"farris-group-wrap\">\r\n                    <div class=\"form-group farris-form-group mb-0\">\r\n                      <div class=\"farris-input-wrap\">\r\n                        <button [disabled]=\"!mobileForm.ComponentId && !mobileForm.formFormatId\" class=\"btn-sm btn-secondary btn\"\r\n                          (click)=\"parametersSet()\">\r\n                          \u8868\u5355\u53C2\u6570\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </farris-section>\r\n          <farris-section #appConfigSection class=\"f-section-tabs f-section-in-mainsubcard pb-0 pt-1\" [enableAccordion]=\"''\"\r\n            [mainTitle]=\"'\u8868\u5355\u683C\u5F0F\u8BBE\u7F6E'\" [subTitle]=\"''\" [enableMaximize]=\"false\" [fill]=\"true\">\r\n            <lib-form-config-container #appConfigContainer *ngIf=\"mobileForm.formFormatId; else empty\"\r\n              [formFormatId]=\"mobileForm.formFormatId\" [formatConfigId]=\"mobileForm.formatConfigId\" [showMethodTab]=\"showMethodTab\" class=\"h-100\">\r\n            </lib-form-config-container>\r\n          </farris-section>\r\n        </ng-template>\r\n      </farris-tab>\r\n    </farris-tabs>\r\n  </div> -->\r\n  \r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<ng-template #empty>\r\n  <div class=\"f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-datagrid-norecords\" style=\"height: 100%;\">\r\n      <div class=\"f-datagrid-norecords-content w-100\">\u6682\u65E0\u8868\u5355\u683C\u5F0F</div>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"f-page f-page-is-managelist\">\r\n  <div class=\"f-page-main mx-3\">\r\n    <div class=\"farris-form farris-form-controls-inline farris-form-auto f-form-lable-auto\">\r\n      <div class=\"f-section-formgroup-inputs\">\r\n        <div class=\"col-12 col-md-5 px-0 my-2\">\r\n          <div class=\"farris-group-wrap\">\r\n            <div class=\"form-group farris-form-group mb-0\">\r\n              <div class=\"farris-input-wrap\">\r\n                <input-group class=\"form-control\" style=\"width: 100%;padding:0;border:0;\" [enableClear]=\"true\"\r\n                  [showButtonWhenDisabled]=\"false\" [(ngModel)]=\"form.Name\" name=\"form\" [placeholder]=\"'\u8BF7\u9009\u62E9'\"\r\n                  [editable]=\"false\" (clickHandle)=\"selectExecuteForm()\" (clear)=\"clear()\" [groupText]=\"groupIcon\">\r\n                </input-group>\r\n                <div class=\"farris-feedback valid-feedback\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-12 col-md-2 my-2 px-0\">\r\n          <div class=\"farris-group-wrap\" style=\"padding-top: 2px;\">\r\n            <div class=\"form-group farris-form-group mb-0\">\r\n              <div class=\"farris-input-wrap\">\r\n                <farris-button [disabled]=\"!form.ComponentId && !form.formFormatId\" [type]=\"'link'\" (click)=\"parametersSet()\">\r\n                  \u53C2\u6570\r\n                </farris-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <lib-form-config-container #configContainer\r\n      [formFormatId]=\"form.formFormatId\" [formatConfigId]=\"form.formatConfigId\" [showMethodTab]=\"showMethodTab\"\r\n      class=\"h-100\"></lib-form-config-container>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n",
                providers: [ExecuteFormsUIState, ExecuteFormsViewModel, ExecuteFormsRepository],
                styles: [""]
            }] }
];
/** @nocollapse */
ExecuteFormsComponent.ctorParameters = () => [
    { type: FormBuilder },
    { type: ExecuteFormsUIState },
    { type: ExecuteFormsViewModel },
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: BsModalService }
];
ExecuteFormsComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    style: [{ type: HostBinding, args: ['style.background',] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    editorParams: [{ type: Input }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    configContainer: [{ type: ViewChild, args: ['configContainer',] }],
    configSection: [{ type: ViewChild, args: ['configSection', { read: ElementRef },] }]
};
if (false) {
    /** @type {?} */
    ExecuteFormsComponent.prototype.modalConfig;
    /** @type {?} */
    ExecuteFormsComponent.prototype.cls;
    /** @type {?} */
    ExecuteFormsComponent.prototype.style;
    /** @type {?} */
    ExecuteFormsComponent.prototype.closeModal;
    /** @type {?} */
    ExecuteFormsComponent.prototype.submitModal;
    /** @type {?} */
    ExecuteFormsComponent.prototype.editorParams;
    /** @type {?} */
    ExecuteFormsComponent.prototype.modalFooter;
    /** @type {?} */
    ExecuteFormsComponent.prototype.configContainer;
    /** @type {?} */
    ExecuteFormsComponent.prototype.configSection;
    /** @type {?} */
    ExecuteFormsComponent.prototype.form;
    /** @type {?} */
    ExecuteFormsComponent.prototype.tab;
    /** @type {?} */
    ExecuteFormsComponent.prototype.groupIcon;
    /** @type {?} */
    ExecuteFormsComponent.prototype.cols;
    /** @type {?} */
    ExecuteFormsComponent.prototype.location;
    /** @type {?} */
    ExecuteFormsComponent.prototype.showMethodTab;
    /**
     * @type {?}
     * @private
     */
    ExecuteFormsComponent.prototype.formBuilder;
    /** @type {?} */
    ExecuteFormsComponent.prototype.uistate;
    /** @type {?} */
    ExecuteFormsComponent.prototype.viewmodel;
    /**
     * @type {?}
     * @private
     */
    ExecuteFormsComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    ExecuteFormsComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ExecuteFormsComponent.prototype.modalService;
}
export class ExecuteFormsConverter {
    constructor() { }
    /**
     * @param {?} data
     * @return {?}
     */
    convertTo(data) {
        if (data) {
            return data.Name;
        }
        else {
            return '（未设置）';
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhlY3V0ZS1mb3Jtcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXByb2Nlc3MtZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL3ZpZXdzL2V4ZWN1dGUtZm9ybXMvZXhlY3V0ZS1mb3Jtcy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBbUMsTUFBTSxlQUFlLENBQUM7QUFFck0sT0FBTyxFQUFFLEVBQUUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3hDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM3QyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUM5RCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNsRSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNwRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQWdCLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ2pHLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQztBQUN4RixPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSx5REFBeUQsQ0FBQztBQUN2RyxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQUU1RixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFRM0MsTUFBTSxPQUFPLHFCQUFxQjs7Ozs7Ozs7OztJQXFEaEMsWUFDVSxXQUF3QixFQUN6QixPQUE0QixFQUM1QixTQUFnQyxFQUMvQixRQUFrQyxFQUNsQyxRQUFrQixFQUNsQixZQUE0QjtRQUw1QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN6QixZQUFPLEdBQVAsT0FBTyxDQUFxQjtRQUM1QixjQUFTLEdBQVQsU0FBUyxDQUF1QjtRQUMvQixhQUFRLEdBQVIsUUFBUSxDQUEwQjtRQUNsQyxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLGlCQUFZLEdBQVosWUFBWSxDQUFnQjtRQTFEdEMsZ0JBQVcsR0FBRztZQUNaLEtBQUssRUFBRSxNQUFNO1lBQ2IsS0FBSyxFQUFFLEdBQUc7WUFDVixNQUFNLEVBQUUsR0FBRztZQUNYLFdBQVcsRUFBRSxJQUFJO1NBQ2xCLENBQUM7UUFHRixRQUFHLEdBQUcsOEJBQThCLENBQUM7UUFDSixVQUFLLEdBQUcsTUFBTSxDQUFDO1FBQ3RDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3JDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQXNCdkMsaUJBQVksR0FBUSxFQUFFLENBQUM7UUFRaEMsUUFBRyxHQUFxQixLQUFLLENBQUM7UUFFOUIsY0FBUyxHQUFHLHNDQUFzQyxDQUFDO1FBRW5ELFNBQUksR0FBRyxFQUFFLENBQUM7UUFJVixrQkFBYSxHQUFHLElBQUksQ0FBQztRQVduQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksZ0JBQWdCLEVBQUUsQ0FBQztJQUNyQyxDQUFDOzs7OztJQWhERCxJQUNJLEtBQUssQ0FBQyxJQUFzQjtRQUM5QixJQUFJLElBQUksRUFBRTs7a0JBQ0YsVUFBVSxHQUFHLElBQUksS0FBSyxFQUFtQjtZQUMvQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTzs7OztZQUFDLENBQUMsQ0FBQyxFQUFFOztzQkFDMUIsSUFBSSxHQUFHLElBQUksZUFBZSxFQUFFO2dCQUNsQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQ25CLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQztnQkFDckIsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN4QixDQUFDLEVBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsVUFBVSxDQUFDO1lBQ3hDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7WUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQztZQUMvQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQ25DLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7U0FDNUM7SUFDSCxDQUFDOzs7O0lBOEJELGVBQWU7UUFDYixrQkFBa0I7SUFDcEIsQ0FBQzs7OztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDO1FBQzNDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUM7UUFDakMsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLGNBQWMsRUFBRTtZQUNwQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztTQUMzQjthQUFNO1lBQ0wsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7U0FDNUI7SUFDSCxDQUFDOzs7O0lBQ0QsT0FBTzs7WUFDRCxJQUFJLEdBQUcsSUFBSSxnQkFBZ0IsRUFBRTtRQUNqQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsU0FBUzs7OztRQUFDLENBQUMsRUFBTyxFQUFFLEVBQUU7WUFDbkMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUU7Z0JBQ2QsT0FBTzthQUNSO1lBQ0QsSUFBSSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUM7O2tCQUNULE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRTtZQUNoRCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNoQyxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7Ozs7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN6QixDQUFDOzs7Ozs7Ozs7OztJQVNPLE9BQU87UUFDYixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3pCLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7U0FDOUM7YUFBTSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ2pDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQ3ZDLFNBQVM7Ozs7WUFBQyxDQUFDLEVBQU8sRUFBRSxFQUFFO2dCQUNwQixJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUU7b0JBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQztvQkFDdkMsT0FBTyxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztpQkFDOUM7cUJBQU07b0JBQ0wsT0FBTyxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztpQkFDL0M7WUFDSCxDQUFDLEVBQUMsQ0FDSCxDQUFDO1NBQ0g7YUFBTTtZQUNMLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztTQUN6QztJQUNILENBQUM7Ozs7O0lBS0QsYUFBYTs7Y0FDTCxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyx5QkFBeUIsQ0FBQzs7Y0FDOUUsT0FBTyxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztRQUNqRCxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUM7UUFDL0IsSUFBSSxJQUFJLENBQUMsR0FBRyxLQUFLLEtBQUssRUFBRTtZQUN0QixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUN6QixPQUFPLENBQUMsUUFBUSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7Z0JBQ3JDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO2FBQ2hEO1lBQ0QsT0FBTyxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRzs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztTQUM5RjthQUFNO1lBQ0wsT0FBTyxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRzs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztTQUM5Rjs7Y0FFSyxXQUFXLEdBQUc7WUFDbEIsS0FBSyxFQUFFLE1BQU07WUFDYixLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsV0FBVyxFQUFFLElBQUk7WUFDakIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsV0FBVztTQUN0Qzs7Y0FDSyxNQUFNLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQztRQUUzRCxPQUFPLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTOzs7O1FBQUMsRUFBRSxDQUFDLEVBQUU7WUFDckMsSUFBSSxJQUFJLENBQUMsR0FBRyxLQUFLLEtBQUssRUFBRTtnQkFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUMsVUFBVSxDQUFDO2dCQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDO2FBQ2xDO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQzthQUM1QztZQUNELE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQixDQUFDLEVBQUMsQ0FBQztRQUNILE9BQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFNBQVM7Ozs7UUFBQyxFQUFFLENBQUMsRUFBRTtZQUNyQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDakIsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDOzs7OztJQUlELGlCQUFpQjs7Y0FDVCxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyx1QkFBdUIsQ0FBQzs7Y0FDNUUsT0FBTyxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztRQUNqRCxPQUFPLENBQUMsUUFBUSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDOztjQUUxQixXQUFXLEdBQUc7WUFDbEIsS0FBSyxFQUFFLFFBQVE7WUFDZixLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsV0FBVyxFQUFFLElBQUk7WUFDakIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsV0FBVztTQUN0Qzs7Y0FDSyxNQUFNLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQztRQUMzRCxPQUFPLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxFQUFvQixFQUFFLEVBQUU7WUFDekQsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7WUFDZixNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDakIsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTOzs7O1FBQUMsRUFBRSxDQUFDLEVBQUU7WUFDckMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pCLENBQUMsRUFBQyxDQUFDO0lBQ0wsQ0FBQzs7OztJQUNELEtBQUs7UUFDSCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksZ0JBQWdCLEVBQUUsQ0FBQztJQUNyQyxDQUFDOzs7WUE3TEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxtQkFBbUI7Z0JBQzdCLHdoUUFBNkM7Z0JBRTdDLFNBQVMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLHFCQUFxQixFQUFFLHNCQUFzQixDQUFDOzthQUNoRjs7OztZQWpCUSxXQUFXO1lBQ1gsbUJBQW1CO1lBQ25CLHFCQUFxQjtZQUw0RSx3QkFBd0I7WUFBRSxRQUFRO1lBUW5JLGNBQWM7OztrQkFxQnBCLFdBQVcsU0FBQyxPQUFPO29CQUVuQixXQUFXLFNBQUMsa0JBQWtCO3lCQUM5QixNQUFNOzBCQUNOLE1BQU07b0JBRU4sS0FBSzsyQkFvQkwsS0FBSzswQkFDTCxTQUFTLFNBQUMsa0JBQWtCOzhCQUM1QixTQUFTLFNBQUMsaUJBQWlCOzRCQUUzQixTQUFTLFNBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTs7OztJQXJDaEQsNENBS0U7O0lBRUYsb0NBQ3FDOztJQUNyQyxzQ0FBZ0Q7O0lBQ2hELDJDQUErQzs7SUFDL0MsNENBQWdEOztJQXNCaEQsNkNBQWdDOztJQUNoQyw0Q0FBNkQ7O0lBQzdELGdEQUE0RTs7SUFFNUUsOENBQWlGOztJQUVqRixxQ0FBdUI7O0lBRXZCLG9DQUE4Qjs7SUFFOUIsMENBQW1EOztJQUVuRCxxQ0FBVTs7SUFFVix5Q0FBdUQ7O0lBRXZELDhDQUFxQjs7Ozs7SUFJbkIsNENBQWdDOztJQUNoQyx3Q0FBbUM7O0lBQ25DLDBDQUF1Qzs7Ozs7SUFDdkMseUNBQTBDOzs7OztJQUMxQyx5Q0FBMEI7Ozs7O0lBQzFCLDZDQUFvQzs7QUE4SHhDLE1BQU0sT0FBTyxxQkFBcUI7SUFDaEMsZ0JBQWdCLENBQUM7Ozs7O0lBRWpCLFNBQVMsQ0FBQyxJQUFJO1FBQ1osSUFBSSxJQUFJLEVBQUU7WUFDUixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7U0FDbEI7YUFBTTtZQUNMLE9BQU8sT0FBTyxDQUFDO1NBQ2hCO0lBQ0gsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIEVsZW1lbnRSZWYsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IsIEFmdGVyVmlld0luaXQsIEFmdGVyQ29udGVudEluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZUNvbnZlcnRlciB9IGZyb20gJ0BmYXJyaXMvdWktcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMvb2JzZXJ2YWJsZS9vZic7XHJcbmltcG9ydCB7IEZvcm1CdWlsZGVyIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBFeGVjdXRlRm9ybXNVSVN0YXRlIH0gZnJvbSAnLi9leGVjdXRlLWZvcm1zLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBFeGVjdXRlRm9ybXNWaWV3TW9kZWwgfSBmcm9tICcuL2V4ZWN1dGUtZm9ybXMudmlld21vZGVsJztcclxuaW1wb3J0IHsgRXhlY3V0ZUZvcm1zUmVwb3NpdG9yeSB9IGZyb20gJy4vZXhlY3V0ZS1mb3Jtcy5yZXBvc2l0b3J5JztcclxuaW1wb3J0IHsgRXhlY3V0ZUZvcm1Nb2RlbCwgVGVybWluYWxUeXBlLCBBY3R1YWxQYXJhbWV0ZXIgfSBmcm9tICcuL2VudGl0aWVzL2V4ZWN1dGUtZm9ybS5lbnRpdHknO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBBZGRFeGVjdXRlRm9ybUNvbXBvbmVudCB9IGZyb20gJy4vYWRkLWV4ZWN1dGUtZm9ybS9hZGQtZXhlY3V0ZS1mb3JtLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEZvcm1Db25maWdDb250YWluZXJDb21wb25lbnQgfSBmcm9tICcuL2Zvcm0tY29uZmlnLWNvbnRhaW5lci9mb3JtLWNvbmZpZy1jb250YWluZXIuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUGFyYW1ldGVyU2V0dGluZ0NvbXBvbmVudCB9IGZyb20gJy4vcGFyYW1ldGVyLXNldHRpbmcvcGFyYW1ldGVyLXNldHRpbmcuY29tcG9uZW50JztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgZm9ya0pvaW4gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgc3dpdGNoTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtZXhlY3V0ZS1mb3JtcycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2V4ZWN1dGUtZm9ybXMuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2V4ZWN1dGUtZm9ybXMuY29tcG9uZW50LmNzcyddLFxyXG4gIHByb3ZpZGVyczogW0V4ZWN1dGVGb3Jtc1VJU3RhdGUsIEV4ZWN1dGVGb3Jtc1ZpZXdNb2RlbCwgRXhlY3V0ZUZvcm1zUmVwb3NpdG9yeV1cclxufSlcclxuZXhwb3J0IGNsYXNzIEV4ZWN1dGVGb3Jtc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgbW9kYWxDb25maWcgPSB7XHJcbiAgICB0aXRsZTogJ+ihqOWNleWumuS5iScsXHJcbiAgICB3aWR0aDogNzk0LFxyXG4gICAgaGVpZ2h0OiA1MDUsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKVxyXG4gIGNscyA9ICdmYXJyaXMtbWFpbi1hcmVhIGZsZXgtY29sdW1uJztcclxuICBASG9zdEJpbmRpbmcoJ3N0eWxlLmJhY2tncm91bmQnKSBzdHlsZSA9ICcjRkZGJztcclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShpdGVtOiBFeGVjdXRlRm9ybU1vZGVsKSB7XHJcbiAgICBpZiAoaXRlbSkge1xyXG4gICAgICBjb25zdCBwYXJhbUFycmF5ID0gbmV3IEFycmF5PEFjdHVhbFBhcmFtZXRlcj4oKTtcclxuICAgICAgaXRlbS5BY3R1YWxQYXJhbWV0ZXJzLmZvckVhY2goYSA9PiB7XHJcbiAgICAgICAgY29uc3QgcGFyYSA9IG5ldyBBY3R1YWxQYXJhbWV0ZXIoKTtcclxuICAgICAgICBwYXJhLk5hbWUgPSBhLk5hbWU7XHJcbiAgICAgICAgcGFyYS5WYWx1ZSA9IGEuVmFsdWU7XHJcbiAgICAgICAgcGFyYW1BcnJheS5wdXNoKHBhcmEpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5mb3JtLkFjdHVhbFBhcmFtZXRlcnMgPSBwYXJhbUFycmF5O1xyXG4gICAgICB0aGlzLmZvcm0uSWQgPSBpdGVtLklkO1xyXG4gICAgICB0aGlzLmZvcm0uTmFtZSA9IGl0ZW0uTmFtZTtcclxuICAgICAgdGhpcy5mb3JtLkNvbXBvbmVudElkID0gaXRlbS5Db21wb25lbnRJZDtcclxuICAgICAgdGhpcy5mb3JtLmZvcm1Gb3JtYXRJZCA9IGl0ZW0uZm9ybUZvcm1hdElkO1xyXG4gICAgICB0aGlzLmZvcm0uZm9ybWF0Q29uZmlnSWQgPSBpdGVtLmZvcm1hdENvbmZpZ0lkO1xyXG4gICAgICB0aGlzLmZvcm0uRm9ybVR5cGUgPSBpdGVtLkZvcm1UeXBlO1xyXG4gICAgICB0aGlzLmZvcm0uVGVybWluYWxUeXBlID0gaXRlbS5UZXJtaW5hbFR5cGU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIEBJbnB1dCgpIGVkaXRvclBhcmFtczogYW55ID0ge307XHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2NvbmZpZ0NvbnRhaW5lcicpIGNvbmZpZ0NvbnRhaW5lcjogRm9ybUNvbmZpZ0NvbnRhaW5lckNvbXBvbmVudDtcclxuXHJcbiAgQFZpZXdDaGlsZCgnY29uZmlnU2VjdGlvbicsIHsgcmVhZDogRWxlbWVudFJlZiB9KSBjb25maWdTZWN0aW9uOiBFbGVtZW50UmVmPGFueT47XHJcblxyXG4gIGZvcm06IEV4ZWN1dGVGb3JtTW9kZWw7XHJcblxyXG4gIHRhYjogJ3dlYicgfCAnbW9iaWxlJyA9ICd3ZWInO1xyXG5cclxuICBncm91cEljb24gPSAnPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT4nO1xyXG5cclxuICBjb2xzID0gW107XHJcblxyXG4gIGxvY2F0aW9uOiAndXNlckFjdGl2aXR5JyB8ICdwcm9jZXNzJyB8ICdzdGFydEFjdGl2aXR5JztcclxuXHJcbiAgc2hvd01ldGhvZFRhYiA9IHRydWU7XHJcblxyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyLFxyXG4gICAgcHVibGljIHVpc3RhdGU6IEV4ZWN1dGVGb3Jtc1VJU3RhdGUsXHJcbiAgICBwdWJsaWMgdmlld21vZGVsOiBFeGVjdXRlRm9ybXNWaWV3TW9kZWwsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZVxyXG4gICkge1xyXG4gICAgdGhpcy5mb3JtID0gbmV3IEV4ZWN1dGVGb3JtTW9kZWwoKTtcclxuICB9XHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgLy8gdGhpcy5lZGl0Q1NTKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMubG9jYXRpb24gPSB0aGlzLmVkaXRvclBhcmFtcy5sb2NhdGlvbjtcclxuICAgIHRoaXMudGFiID0gdGhpcy5lZGl0b3JQYXJhbXMudGFiO1xyXG4gICAgaWYgKHRoaXMubG9jYXRpb24gPT09ICd1c2VyQWN0aXZpdHknKSB7XHJcbiAgICAgIHRoaXMuc2hvd01ldGhvZFRhYiA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnNob3dNZXRob2RUYWIgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgY2xpY2tPSygpIHtcclxuICAgIGxldCBkYXRhID0gbmV3IEV4ZWN1dGVGb3JtTW9kZWwoKTtcclxuICAgIHRoaXMuZ2V0Rm9ybSgpLnN1YnNjcmliZSgocmU6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoIXJlLnJlc3VsdCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBkYXRhID0gcmUuZm9ybTtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogZGF0YSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgICB0aGlzLnN1Ym1pdE1vZGFsLmVtaXQob2JqZWN0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuICAvLyB0YWJDaGFuZ2UoZGF0YSkge1xyXG4gIC8vICAgdGhpcy50YWIgPSBkYXRhLm5leHRJZDtcclxuICAvLyB9XHJcblxyXG4gIC8vIGVkaXRDU1MoKSB7XHJcbiAgLy8gICB0aGlzLmNvbmZpZ1NlY3Rpb24ubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZi1zZWN0aW9uLWhlYWRlcicpLmNsYXNzTGlzdC5hZGQoJ21iLTAnKTtcclxuICAvLyB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Rm9ybSgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKHRoaXMuZm9ybS5Db21wb25lbnRJZCkge1xyXG4gICAgICByZXR1cm4gb2YoeyByZXN1bHQ6IHRydWUsIGZvcm06IHRoaXMuZm9ybSB9KTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5mb3JtLmZvcm1Gb3JtYXRJZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5jb25maWdDb250YWluZXIuc3VibWl0KCkucGlwZShcclxuICAgICAgICBzd2l0Y2hNYXAoKHJlOiBhbnkpID0+IHtcclxuICAgICAgICAgIGlmIChyZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgdGhpcy5mb3JtLmZvcm1hdENvbmZpZ0lkID0gcmUuY29uZmlnSWQ7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7IHJlc3VsdDogdHJ1ZSwgZm9ybTogdGhpcy5mb3JtIH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHsgcmVzdWx0OiBmYWxzZSwgZm9ybTogdGhpcy5mb3JtIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gb2YoeyByZXN1bHQ6IHRydWUsIGZvcm06IG51bGwgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlj4LmlbDorr7nva5cclxuICAgKi9cclxuICBwYXJhbWV0ZXJzU2V0KCkge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KFBhcmFtZXRlclNldHRpbmdDb21wb25lbnQpO1xyXG4gICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UubW9kZSA9ICdicG1uJztcclxuICAgIGlmICh0aGlzLnRhYiA9PT0gJ3dlYicpIHtcclxuICAgICAgaWYgKHRoaXMuZm9ybS5Db21wb25lbnRJZCkge1xyXG4gICAgICAgIGNvbXBSZWYuaW5zdGFuY2Uuc2hvd0Zvcm1UeXBlID0gdHJ1ZTtcclxuICAgICAgICBjb21wUmVmLmluc3RhbmNlLmZvcm1UeXBlID0gdGhpcy5mb3JtLkZvcm1UeXBlO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbXBSZWYuaW5zdGFuY2UucGFyYW1ldGVycyA9IFsuLi50aGlzLmZvcm0uQWN0dWFsUGFyYW1ldGVycy5tYXAocCA9PiBPYmplY3QuYXNzaWduKHt9LCBwKSldO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29tcFJlZi5pbnN0YW5jZS5wYXJhbWV0ZXJzID0gWy4uLnRoaXMuZm9ybS5BY3R1YWxQYXJhbWV0ZXJzLm1hcChwID0+IE9iamVjdC5hc3NpZ24oe30sIHApKV07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgIHRpdGxlOiAn5Y+C5pWw6K6+572uJyxcclxuICAgICAgd2lkdGg6IDYyMCxcclxuICAgICAgaGVpZ2h0OiA0MDAsXHJcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICBidXR0b25zOiBjb21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjb21wUmVmLCBtb2RhbENvbmZpZyk7XHJcblxyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5zdWJtaXQuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgaWYgKHRoaXMudGFiID09PSAnd2ViJykge1xyXG4gICAgICAgIHRoaXMuZm9ybS5BY3R1YWxQYXJhbWV0ZXJzID0gcmUucGFyYW1ldGVycztcclxuICAgICAgICB0aGlzLmZvcm0uRm9ybVR5cGUgPSByZS5mb3JtVHlwZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmZvcm0uQWN0dWFsUGFyYW1ldGVycyA9IHJlLnBhcmFtZXRlcnM7XHJcbiAgICAgIH1cclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2FuY2VsLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOmAieaLqeihqOWNleWumuS5iVxyXG4gICAqL1xyXG4gIHNlbGVjdEV4ZWN1dGVGb3JtKCkge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEFkZEV4ZWN1dGVGb3JtQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICBjb21wUmVmLmluc3RhbmNlLnRhYiA9IHRoaXMudGFiO1xyXG5cclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogJ+ihqOWNleWumuS5ieWIl+ihqCcsXHJcbiAgICAgIHdpZHRoOiA2NTAsXHJcbiAgICAgIGhlaWdodDogNDAwLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgYnV0dG9uczogY29tcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlclxyXG4gICAgfTtcclxuICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgY29tcFJlZi5pbnN0YW5jZS5zdWJtaXQuc3Vic2NyaWJlKChyZTogRXhlY3V0ZUZvcm1Nb2RlbCkgPT4ge1xyXG4gICAgICB0aGlzLmZvcm0gPSByZTtcclxuICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UuY2FuY2VsLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGNsZWFyKCkge1xyXG4gICAgdGhpcy5mb3JtID0gbmV3IEV4ZWN1dGVGb3JtTW9kZWwoKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGNsYXNzIEV4ZWN1dGVGb3Jtc0NvbnZlcnRlciBpbXBsZW1lbnRzIFR5cGVDb252ZXJ0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gIGNvbnZlcnRUbyhkYXRhKTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHJldHVybiBkYXRhLk5hbWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gJ++8iOacquiuvue9ru+8iSc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==