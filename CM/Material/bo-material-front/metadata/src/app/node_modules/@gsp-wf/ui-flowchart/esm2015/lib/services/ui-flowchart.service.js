/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { from } from 'rxjs';
import { HttpService } from '@ecp-caf/caf-common';
import { translate } from './i18n/index';
import { map } from 'rxjs/operators';
export class UiFlowchartService {
    /**
     * @param {?} httpSvc
     */
    constructor(httpSvc) {
        this.httpSvc = httpSvc;
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    getForecastProcessListByPayload(payload) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/processInstances/startProcess-simulation';
        return this.httpSvc.post(url, payload).pipe(map((re) => re.procDefs));
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getRuntimeProcInstsByDataId(dataId) {
        if (dataId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/runtimeProcInstList?dataId=${dataId}`;
            return this.httpSvc.get(url);
        }
        else {
            return from(new Array());
        }
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getHistoricProcInstsByDataId(dataId) {
        if (dataId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/historicProcInstList?dataId=${dataId}`;
            return this.httpSvc.get(url);
        }
        else {
            return from(new Array());
        }
    }
    /**
     * 基于流程实例ID获取流程实例
     * @param {?} procInstId 流程实例id
     * @return {?}
     */
    getProcInstanceById(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例ID获取bpmnModel
     * @param {?} procInstId
     * @return {?}
     */
    getBpmnModelbyProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/bpmnModel`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程定义ID获取bpmnModel
     * @param {?} procDefId
     * @return {?}
     */
    getBpmnModelbyProcDefId(procDefId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/procDefs/${procDefId}/bpmnModel`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} superActInstId
     * @param {?} superProcInstId
     * @return {?}
     */
    getSubProcessInstance(superActInstId, superProcInstId) {
        if (superActInstId) {
            /** @type {?} */
            const url = `/api/runtime/wf/v1.0/processInstances/subProcInst?superActInstId=${superActInstId}&superProcInstId=${superProcInstId}`;
            return this.httpSvc.get(url);
        }
    }
    /**
     * 获取所有包含预解析的流程实例信息
     * @param {?} procInstId
     * @return {?}
     */
    getForecastProcessByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/forecastProcess`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取流程预测数据
     * @param {?} payload
     * @return {?}
     */
    getForecastProcessByPayload(payload) {
        /** @type {?} */
        const url = '/api/runtime/wf/v1.0/processInstances/forecastProcess';
        return this.httpSvc.post(url, payload);
    }
    /**
     * @param {?} procInstId
     * @return {?}
     */
    getCompleteProcessInfoByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/flowChartInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例Id获取所有活动实例
     * @param {?} procInstId procInstId
     * @return {?}
     */
    getAllActiInstsbyProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/activityInstanceSlims`;
        return this.httpSvc.get(url);
    }
    /**
     * 基于流程实例ID获取所有的流转实例
     * @param {?} procInstId procInstId
     * @return {?}
     */
    getTransitionInstanceSlimsByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/transitionInstanceSlims`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @return {?}
     */
    getFormInfoByProcInstId(procInstId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/formInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @param {?} actInstId
     * @return {?}
     */
    getFormInfoByActInstId(procInstId, actInstId) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/${procInstId}/formInfo`;
        if (actInstId) {
            url += `?actInstId=${actInstId}`;
        }
        return this.httpSvc.get(url);
    }
    /**
     * 获取审批日志信息
     * @param {?} procInstId
     * @param {?=} activityDefinitionId
     * @return {?}
     */
    getWorkItemLogs(procInstId, activityDefinitionId) {
        /** @type {?} */
        const logUrl = activityDefinitionId ?
            `/api/runtime/wf/v1.0/processInstances/${procInstId}/logs?activityDefinitionId=${activityDefinitionId}` :
            `/api/runtime/wf/v1.0/processInstances/${procInstId}/logs`;
        return this.httpSvc.get(logUrl);
    }
    /**
     * @param {?} name
     * @return {?}
     */
    getI18nValue(name) {
        if (!name) {
            return '';
        }
        /** @type {?} */
        const defaultLang = localStorage.getItem('languageCode');
        /** @type {?} */
        const langData = defaultLang ? translate[defaultLang] : translate['zh-CHS'];
        /** @type {?} */
        let resultVal = '';
        if (name.indexOf('.') === -1) {
            resultVal = langData[name];
        }
        else {
            resultVal = name.split('.').reduce((obj, key) => {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }, langData);
        }
        return resultVal;
    }
    /**
     * @param {?} processId
     * @return {?}
     */
    getProcessInstanceById(processId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/${processId}`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} dataId
     * @return {?}
     */
    getProcInstIdByDataId(dataId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/procInstId?bizInstId=${dataId}`;
        return this.httpSvc.get(url);
    }
    /**
     * @param {?} procInstId
     * @param {?} actInstId
     * @param {?} bizInstId
     * @return {?}
     */
    retryAifCreation(procInstId, actInstId, bizInstId) {
        return this.httpSvc.post("/api/runtime/wf/v1.0/aifactivityinstance/retry", actInstId);
    }
}
UiFlowchartService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
UiFlowchartService.ctorParameters = () => [
    { type: HttpService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    UiFlowchartService.prototype.httpSvc;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWktZmxvd2NoYXJ0LnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3VpLWZsb3djaGFydC8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy91aS1mbG93Y2hhcnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQWMsSUFBSSxFQUFNLE1BQU0sTUFBTSxDQUFDO0FBQzVDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRXpDLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdyQyxNQUFNLE9BQU8sa0JBQWtCOzs7O0lBRTdCLFlBQW9CLE9BQW9CO1FBQXBCLFlBQU8sR0FBUCxPQUFPLENBQWE7SUFBSSxDQUFDOzs7OztJQUU3QywrQkFBK0IsQ0FBQyxPQUErQjs7Y0FDdkQsR0FBRyxHQUFHLCtEQUErRDtRQUMzRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQ3pDLEdBQUcsQ0FBQyxDQUFDLEVBQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUM5QixDQUFDO0lBQ0osQ0FBQzs7Ozs7SUFFRCwyQkFBMkIsQ0FBQyxNQUFjO1FBQ3hDLElBQUksTUFBTSxFQUFFOztrQkFDSixHQUFHLEdBQUcsb0VBQW9FLE1BQU0sRUFBRTtZQUN4RixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzlCO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUM7U0FDMUI7SUFDSCxDQUFDOzs7OztJQUVELDRCQUE0QixDQUFDLE1BQWM7UUFDekMs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LEdBQUcsOERBQThELE1BQU0sRUFBRTtRQUNsRixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQy9CLENBQUM7Ozs7Ozs7SUFFRCxnQkFBZ0IsQ0FBQyxVQUFrQixFQUFFLFNBQWlCLEVBQUUsU0FBaUI7UUFDdkUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxnREFBZ0QsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUN4RixDQUFDOzs7WUE1SkYsVUFBVTs7OztZQUxGLFdBQVc7Ozs7Ozs7SUFRTixxQ0FBNEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIGZyb20sIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IHRyYW5zbGF0ZSB9IGZyb20gJy4vaTE4bi9pbmRleCc7XHJcbmltcG9ydCB7IEZvcmVjYXN0UHJvY2Vzc1BheWxvYWQgfSBmcm9tICcuLi9lbnRpdHkvZm9yZWNhc3QtcHJvY2Vzcy1wYXlsb2FkJztcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgVWlGbG93Y2hhcnRTZXJ2aWNlIHtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwU3ZjOiBIdHRwU2VydmljZSkgeyB9XHJcblxyXG4gIGdldEZvcmVjYXN0UHJvY2Vzc0xpc3RCeVBheWxvYWQocGF5bG9hZDogRm9yZWNhc3RQcm9jZXNzUGF5bG9hZCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy9zdGFydFByb2Nlc3Mtc2ltdWxhdGlvbic7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBwYXlsb2FkKS5waXBlKFxyXG4gICAgICBtYXAoKHJlOiBhbnkpID0+IHJlLnByb2NEZWZzKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldFJ1bnRpbWVQcm9jSW5zdHNCeURhdGFJZChkYXRhSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoZGF0YUlkKSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3J1bnRpbWVQcm9jSW5zdExpc3Q/ZGF0YUlkPSR7ZGF0YUlkfWA7XHJcbiAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gZnJvbShuZXcgQXJyYXkoKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRIaXN0b3JpY1Byb2NJbnN0c0J5RGF0YUlkKGRhdGFJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmIChkYXRhSWQpIHtcclxuICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvaGlzdG9yaWNQcm9jSW5zdExpc3Q/ZGF0YUlkPSR7ZGF0YUlkfWA7XHJcbiAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gZnJvbShuZXcgQXJyYXkoKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDln7rkuo7mtYHnqIvlrp7kvotJROiOt+WPlua1geeoi+WunuS+i1xyXG4gICAqIEBwYXJhbSBwcm9jSW5zdElkIOa1geeoi+WunuS+i2lkXHJcbiAgICovXHJcbiAgZ2V0UHJvY0luc3RhbmNlQnlJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDln7rkuo7mtYHnqIvlrp7kvotJROiOt+WPlmJwbW5Nb2RlbFxyXG4gICAqL1xyXG4gIGdldEJwbW5Nb2RlbGJ5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9icG1uTW9kZWxgO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWfuuS6jua1geeoi+WumuS5iUlE6I635Y+WYnBtbk1vZGVsXHJcbiAgICovXHJcbiAgZ2V0QnBtbk1vZGVsYnlQcm9jRGVmSWQocHJvY0RlZklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2NEZWZzLyR7cHJvY0RlZklkfS9icG1uTW9kZWxgO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIGdldFN1YlByb2Nlc3NJbnN0YW5jZShzdXBlckFjdEluc3RJZDogc3RyaW5nLCBzdXBlclByb2NJbnN0SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoc3VwZXJBY3RJbnN0SWQpIHtcclxuICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvc3ViUHJvY0luc3Q/c3VwZXJBY3RJbnN0SWQ9JHtzdXBlckFjdEluc3RJZH0mc3VwZXJQcm9jSW5zdElkPSR7c3VwZXJQcm9jSW5zdElkfWA7XHJcbiAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmiYDmnInljIXlkKvpooTop6PmnpDnmoTmtYHnqIvlrp7kvovkv6Hmga9cclxuICAgKi9cclxuICBnZXRGb3JlY2FzdFByb2Nlc3NCeVByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vZm9yZWNhc3RQcm9jZXNzYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmtYHnqIvpooTmtYvmlbDmja5cclxuICAgKi9cclxuICBnZXRGb3JlY2FzdFByb2Nlc3NCeVBheWxvYWQocGF5bG9hZDogYW55KSB7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy9mb3JlY2FzdFByb2Nlc3MnO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgfVxyXG5cclxuICBnZXRDb21wbGV0ZVByb2Nlc3NJbmZvQnlQcm9jSW5zdElkKHByb2NJbnN0SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy8ke3Byb2NJbnN0SWR9L2Zsb3dDaGFydEluZm9gO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWfuuS6jua1geeoi+WunuS+i0lk6I635Y+W5omA5pyJ5rS75Yqo5a6e5L6LXHJcbiAgICogQHBhcmFtIHByb2NJbnN0SWQgcHJvY0luc3RJZFxyXG4gICAqL1xyXG4gIGdldEFsbEFjdGlJbnN0c2J5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9hY3Rpdml0eUluc3RhbmNlU2xpbXNgO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWfuuS6jua1geeoi+WunuS+i0lE6I635Y+W5omA5pyJ55qE5rWB6L2s5a6e5L6LXHJcbiAgICogQHBhcmFtIHByb2NJbnN0SWQgcHJvY0luc3RJZFxyXG4gICAqL1xyXG4gIGdldFRyYW5zaXRpb25JbnN0YW5jZVNsaW1zQnlQcm9jSW5zdElkKHByb2NJbnN0SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy8ke3Byb2NJbnN0SWR9L3RyYW5zaXRpb25JbnN0YW5jZVNsaW1zYDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICBnZXRGb3JtSW5mb0J5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9mb3JtSW5mb2A7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Rm9ybUluZm9CeUFjdEluc3RJZChwcm9jSW5zdElkOiBzdHJpbmcsIGFjdEluc3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy8ke3Byb2NJbnN0SWR9L2Zvcm1JbmZvYDtcclxuICAgIGlmIChhY3RJbnN0SWQpIHtcclxuICAgICAgdXJsICs9IGA/YWN0SW5zdElkPSR7YWN0SW5zdElkfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a6h5om55pel5b+X5L+h5oGvXHJcbiAgICogQHBhcmFtIFByb2NJbnN0SWQgUHJvY0luc3RJZFxyXG4gICAqIOaWsOaUuemAoOeahOaOpeWPo1xyXG4gICAqL1xyXG4gIGdldFdvcmtJdGVtTG9ncyhwcm9jSW5zdElkOiBzdHJpbmcsIGFjdGl2aXR5RGVmaW5pdGlvbklkPzogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGxvZ1VybCA9IGFjdGl2aXR5RGVmaW5pdGlvbklkID9cclxuICAgICAgYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jSW5zdElkfS9sb2dzP2FjdGl2aXR5RGVmaW5pdGlvbklkPSR7YWN0aXZpdHlEZWZpbml0aW9uSWR9YCA6XHJcbiAgICAgIGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzLyR7cHJvY0luc3RJZH0vbG9nc2A7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldChsb2dVcmwpO1xyXG4gIH1cclxuXHJcbiAgZ2V0STE4blZhbHVlKG5hbWU6IHN0cmluZykge1xyXG4gICAgaWYgKCFuYW1lKSB7IHJldHVybiAnJzsgfVxyXG4gICAgY29uc3QgZGVmYXVsdExhbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2VDb2RlJyk7XHJcbiAgICBjb25zdCBsYW5nRGF0YSA9IGRlZmF1bHRMYW5nID8gdHJhbnNsYXRlW2RlZmF1bHRMYW5nXSA6IHRyYW5zbGF0ZVsnemgtQ0hTJ107XHJcbiAgICBsZXQgcmVzdWx0VmFsID0gJyc7XHJcbiAgICBpZiAobmFtZS5pbmRleE9mKCcuJykgPT09IC0xKSB7XHJcbiAgICAgIHJlc3VsdFZhbCA9IGxhbmdEYXRhW25hbWVdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0VmFsID0gbmFtZS5zcGxpdCgnLicpLnJlZHVjZSgob2JqLCBrZXkpID0+IHtcclxuICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgbGFuZ0RhdGEpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdFZhbDtcclxuICB9XHJcblxyXG4gIGdldFByb2Nlc3NJbnN0YW5jZUJ5SWQocHJvY2Vzc0lkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvJHtwcm9jZXNzSWR9YDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICBnZXRQcm9jSW5zdElkQnlEYXRhSWQoZGF0YUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvcHJvY0luc3RJZD9iaXpJbnN0SWQ9JHtkYXRhSWR9YDtcclxuICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgfVxyXG5cclxuICByZXRyeUFpZkNyZWF0aW9uKHByb2NJbnN0SWQ6IHN0cmluZywgYWN0SW5zdElkOiBzdHJpbmcsIGJpekluc3RJZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QoXCIvYXBpL3J1bnRpbWUvd2YvdjEuMC9haWZhY3Rpdml0eWluc3RhbmNlL3JldHJ5XCIsIGFjdEluc3RJZCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==