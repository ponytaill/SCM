/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-recent-contacts/trc.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector } from '@angular/core';
import * as _ from 'lodash-es';
import { noDataImg } from '../../assets/resource';
import { NotifyService } from '@farris/ui-notify';
import { FavoritesTool } from '../../utils/favorites.tool';
var RecentContactsComponent = /** @class */ (function () {
    function RecentContactsComponent(notifyService, favoritesTool, injector) {
        this.notifyService = notifyService;
        this.favoritesTool = favoritesTool;
        this.injector = injector;
        this.orgId = '';
        this.userIds = '';
        this.selectionsChange = new EventEmitter();
        this.recentContactsChange = new EventEmitter();
        this.allChecked = false;
        this.selections = [];
        // 是否显示用户编号
        this.showUserCode = true;
        this.cloneUserIds = '';
        this.cloneSelections = [];
        this.allIndexId = 'allIndexId';
        this.noDataImg = noDataImg;
        this.items = [];
        this.recentContactsList = [];
        this.favoritesList = [];
        this.allIndexId = Math.random().toString(16).substring(3, 12);
        this.cdRef = this.injector.get(ChangeDetectorRef);
    }
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.favoritesTool.favoritesSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.favoritesList = data;
            if (_this.enableFavorites) {
                _this.loadRecentContactsList();
            }
        }));
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.assembleData = /**
     * @return {?}
     */
    function () {
        if (this.searchPage) {
            this.searchByCodeOrName();
        }
        else {
            this.getRecentContactsList();
        }
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.searchByCodeOrName = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.items = this.items.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item.code.indexOf(_this.searchText) !== -1 || item.name.indexOf(_this.searchText) !== -1;
        }));
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.restoreSelections = /**
     * @return {?}
     */
    function () {
        this.selections = _.cloneDeep(this.cloneSelections);
        this.toggleChecked();
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.toggleAll = /**
     * @return {?}
     */
    function () {
        if (!this.allChecked) {
            this.checkAll();
        }
        else {
            this.unCheckAll();
        }
        this.cdRef.detectChanges();
        this.emitSelections();
    };
    /**
     * @param {?} data
     * @return {?}
     */
    RecentContactsComponent.prototype.toggleOne = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data.checked) {
            this.unSelectLine(data);
        }
        else {
            this.selectLine(data);
        }
        this.emitSelections();
    };
    /**
     * 用于数据展示
     */
    /**
     * 用于数据展示
     * @return {?}
     */
    RecentContactsComponent.prototype.loadRecentContactsList = /**
     * 用于数据展示
     * @return {?}
     */
    function () {
        var _this = this;
        this.items = [];
        this.recentContactsList.forEach((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            // const indexId = Math.random().toString(16).substring(3, 10);
            // const item = {
            //     abbreviation: res.abbreviation,
            //     code: res.code,
            //     defaultOrgId: res.defaultOrgId,
            //     defaultOrgPath: res.defaultOrgPath,
            //     ext1: res.ext1,
            //     ext2: res.ext2,
            //     fullPathName: res.fullPathName,
            //     name: res.name,
            //     orgTypeId: res.orgTypeId,
            //     secLevel: res.secLevel,
            //     sortOrder: res.sortOrder,
            //     state: res.state,
            //     su: res.su,
            //     userId: res.userId,
            //     orgAllPath: res.orgAllPath,
            //     type: 'people',
            //     checked: false,
            //     inFavorites: false,
            //     indexId
            // };
            /** @type {?} */
            var item = _.cloneDeep(res);
            item.checked = false;
            item.inFavorites = false;
            item.indexId = Math.random().toString(16).substring(2);
            if (_this._isInArray(res[_this.idField], _this.idField, _this.selections) !== -1) {
                item.checked = true;
            }
            if (_this._isInArray(res[_this.idField], _this.idField, _this.favoritesList) !== -1) {
                item.inFavorites = true;
            }
            item.displayName = !!_this.showUserCode ? ('[' + item.code + ']' + item.name) : item.name;
            _this.items.push(item);
        }));
        this.toggleChecked();
        this.cdRef.detectChanges();
    };
    /**
     * 全选后处理
     * @param dataArr 全选的值
     */
    /**
     * 全选后处理
     * @return {?}
     */
    RecentContactsComponent.prototype.checkAll = /**
     * 全选后处理
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this._insertOneIntoSelections(item);
            item.checked = true;
        }));
    };
    /**
     * 全部取消
     * @param dataArr 取消的数据
     * @returns void
     */
    /**
     * 全部取消
     * @return {?} void
     */
    RecentContactsComponent.prototype.unCheckAll = /**
     * 全部取消
     * @return {?} void
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @param {?} index
             * @return {?}
             */
            function (selection, index) {
                if (item[_this.idField] === selection[_this.idField]) {
                    _this.selections.splice(index, 1);
                }
            }));
            item.checked = false;
        }));
    };
    /**
     * 当前行选中
     * @param data 当前行的数据（）
     */
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    RecentContactsComponent.prototype.selectLine = /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    function (data) {
        if (this.multiSelect) {
            this._insertOneIntoSelections(data);
        }
        else {
            this.userIds = '';
            this.selections = [];
            this.items.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item.checked) {
                    item.checked = false;
                }
            }));
            this._insertOneIntoSelections(data);
        }
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
    };
    /**
     * 单选取消选中
     * @param data 取消选中行
     */
    /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    RecentContactsComponent.prototype.unSelectLine = /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var index = this._isInArray(data[this.idField], this.idField, this.selections);
        if (index > -1) {
            this.selections.splice(index, 1);
        }
        if (this.allChecked) {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @return {?}
     */
    RecentContactsComponent.prototype.emitSelections = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var emitObj = {
            selections: this.selections,
            token: 'recent'
        };
        this.selectionsChange.emit(emitObj);
    };
    /**
     * 获取最近联系人列表
     */
    /**
     * 获取最近联系人列表
     * @return {?}
     */
    RecentContactsComponent.prototype.getRecentContactsList = /**
     * 获取最近联系人列表
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            bizId: this.busNum,
            objectValue: 'RecentContacts'
        };
        this.favoritesTool.curdRecentContactsOrFavorites('query', param).subscribe((/**
         * @param {?} rcRes
         * @return {?}
         */
        function (rcRes) {
            /** @type {?} */
            var rcResData = rcRes ? rcRes.data : [];
            _this.recentContactsList = rcResData;
            _this.loadRecentContactsList();
            /** @type {?} */
            var ids = [];
            _this.recentContactsList.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                ids.push(item[_this.idField]);
            }));
            _this.recentContactsChange.emit({
                recentContactsList: ids
            });
        }));
    };
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    RecentContactsComponent.prototype.toggleFavorites = /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    };
    /**
     * 清空最近联系人
     */
    /**
     * 清空最近联系人
     * @return {?}
     */
    RecentContactsComponent.prototype.clearRecentContactsList = /**
     * 清空最近联系人
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.items.length) {
            return;
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            bizId: this.busNum,
            objectValue: 'RecentContacts',
            addList: []
        };
        this.favoritesTool.curdRecentContactsOrFavorites('modify', param).subscribe((/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            _this.items = [];
            _this.cdRef.detectChanges();
            _this.recentContactsChange.emit({
                recentContactsList: []
            });
            // this.notifyService.info('已清空最近联系人！');
        }));
    };
    /**
     *  取消选中
     * @param $event 取消勾选的数据
     */
    /**
     *  取消选中
     * @param {?} $event 取消勾选的数据
     * @return {?}
     */
    RecentContactsComponent.prototype.cancelSelections = /**
     *  取消选中
     * @param {?} $event 取消勾选的数据
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if (this.items.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item[_this.idField] === $event.id; })) === -1) {
            return;
        }
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item[_this.idField] === $event.id) {
                item.checked = false;
            }
        }));
        this.selections.forEach((/**
         * @param {?} selection
         * @param {?} index
         * @return {?}
         */
        function (selection, index) {
            if ($event.id === selection[_this.idField]) {
                _this.selections.splice(index, 1);
            }
        }));
        this.allChecked = false;
    };
    /**
     * 全部取消勾选
     */
    /**
     * 全部取消勾选
     * @return {?}
     */
    RecentContactsComponent.prototype.clearCheckeds = /**
     * 全部取消勾选
     * @return {?}
     */
    function () {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item.checked = false;
        }));
        this.allChecked = false;
        this.selections = [];
    };
    /**
     * @return {?}
     */
    RecentContactsComponent.prototype.clearUserIds = /**
     * @return {?}
     */
    function () {
        this.userIds = '';
    };
    /**
     * 选中并插入当前行数据到右侧
     * @param data 当前行的数据
     * @param collection 暂存当前数据的集合
     */
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    RecentContactsComponent.prototype._insertOneIntoSelections = /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    function (data) {
        // 如果当前数据已经移入右侧数据，则返回。
        if (this._isInArray(data[this.idField], this.idField, this.selections) > -1) {
            return;
        }
        this.selections.push(data);
        this.selections = this.selections.slice();
    };
    /**
     * 判断是否在内
     * @param value value
     * @param field field
     * @param array array
     * @returns 位置索引
     */
    /**
     * 判断是否在内
     * @param {?} value value
     * @param {?} field field
     * @param {?} array array
     * @return {?} 位置索引
     */
    RecentContactsComponent.prototype._isInArray = /**
     * 判断是否在内
     * @param {?} value value
     * @param {?} field field
     * @param {?} array array
     * @return {?} 位置索引
     */
    function (value, field, array) {
        if (!field || !value) {
            throw new Error(this.validElementsInfo);
        }
        return array.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return value === item[field]; }));
    };
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     */
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    RecentContactsComponent.prototype.toggleChecked = /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (_this._isInArray(item[_this.idField], _this.idField, _this.selections) > -1) {
                item.checked = true;
            }
            else {
                item.checked = false;
            }
        }));
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @return {?}
     */
    RecentContactsComponent.prototype.isAllChecked = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var count = 0;
        /** @type {?} */
        var allChecked = false;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @return {?}
             */
            function (selection) {
                if (item[_this.idField] === selection[_this.idField]) {
                    count += 1;
                }
            }));
        }));
        if (this.items.length === count && count > 0) {
            allChecked = true;
        }
        return allChecked;
    };
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    RecentContactsComponent.prototype.trackByFn = /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    function (index, item) {
        return index;
    };
    RecentContactsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-recent-contacts',
                    template: "<div class=\"candidate\">\r\n    <div class=\"candidate-title\">\r\n        <span *ngIf=\"!multiSelect\"></span>\r\n        <div class=\"custom-control custom-checkbox mb-2\" *ngIf=\"multiSelect && items.length > 0\">\r\n            <input class=\"custom-control-input\" [id]=\"allIndexId\" type=\"checkbox\" [(ngModel)]=\"allChecked\">\r\n            <label class=\"custom-control-label\" [for]=\"allIndexId\" (click)=\"toggleAll()\">{{'personnelSelector.tabCommon.checkAll' | locale}}</label>\r\n        </div>\r\n        <a *ngIf=\"items.length > 0\" (click)=\"clearRecentContactsList()\" class=\"title-clearall\">{{'personnelSelector.tabCommon.clearAll' | locale}}</a>\r\n    </div>\r\n    <div class=\"candidate-content\">\r\n        <div *ngFor=\"let data of items; let i = index;trackBy: trackByFn\" class=\"s-selectedPerson\">\r\n            <div class=\"custom-control custom-checkbox mb-2\">\r\n                <input class=\"custom-control-input\" [id]=\"data.indexId\" type=\"checkbox\" [(ngModel)]=\"data.checked\">\r\n                <label class=\"custom-control-label\" [for]=\"data.indexId\" (click)=\"toggleOne(data)\">\r\n                    <div style=\"display: flex; height: 32px; margin: -21px 0 0 24px;\">\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"data.ext1\" [readonly]=\"true\">\r\n                        </farris-avatar>\r\n                        <div style=\"margin-left: 11px;  margin-top: -2px;  padding-right: 10px; overflow: hidden;\">\r\n                            <p class=\"candidate-content-title\" title=\"{{data.displayName}}\">\r\n                                {{data.displayName}}</p>\r\n                            <p class=\"candidate-content-orgpath\" title=\"{{data.orgAllPath}}\">\r\n                                {{data.orgAllPath}}</p>\r\n                        </div>\r\n                    </div>\r\n                </label>\r\n            </div>\r\n            <!-- <input type=\"checkbox\" class=\"k-checkbox\" [(ngModel)]=\"data.checked\" [id]=\"data.indexId\" />\r\n            <label class=\"k-checkbox-label s-checkbox-lab\" [for]=\"data.indexId\" (click)=\"toggleOne(data)\">\r\n                <div style=\"display: flex; height: 35px;\">\r\n                    <farris-avatar [avatarWidth]=\"35\" [avatarHeight]=\"35\" [cover]=\"data.ext1\" [readonly]=\"true\"\r\n                        style=\"margin-left: 6px;\"></farris-avatar>\r\n                    <div style=\"margin-left: 11px;\">\r\n                        <p class=\"candidate-content-title\" [ngStyle]=\"{'width': enableFavorites ? '162px' : '192px'}\"\r\n                            title=\"{{data.displayName}}\">\r\n                            {{data.displayName}}</p>\r\n                        <p class=\"candidate-content-orgpath\" title=\"{{data.orgAllPath}}\"\r\n                            [ngStyle]=\"{'width': enableFavorites ? '162px' : '192px'}\">\r\n                            {{data.orgAllPath}}</p>\r\n                    </div>\r\n                </div>\r\n            </label> -->\r\n            <span class=\"f-icon f-icon-star\" *ngIf=\"enableFavorites\" [class.default-light-color]=\"data.inFavorites\"\r\n                [class.default-dark-color]=\"!data.inFavorites\" (click)=\"toggleFavorites($event, data)\"></span>\r\n        </div>\r\n        <div *ngIf=\"items.length===0\" [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n            {{'personnelSelector.tabCommon.noUserData' | locale}}</div>\r\n    </div>\r\n</div>",
                    styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-flex:1;flex:1;overflow:hidden;position:static;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.candidate{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-flex:1;flex:1}.candidate .s-selectedPerson:hover{background:#eef5ff;border-radius:5px}.candidate .candidate-content{margin-top:3px;clear:both}.candidate .s-selectedPerson{min-width:240px;float:left;width:calc(50% - 6px);position:relative;height:40px;padding:5px 12px;margin:0 3px 1px}.candidate .s-selectedPerson .f-icon-star{position:absolute;top:13px;right:15px;font-size:14px}.candidate .s-selectedPerson .default-light-color{color:#f7b500}.candidate .s-selectedPerson .default-dark-color{color:#d8dce6}.candidate .k-checkbox-label::after,.candidate .k-checkbox-label::before{top:10px;font-size:16px;width:14px;height:14px}.candidate .fp-candidate-nodata{width:100px;height:100px;text-align:center;background-repeat:no-repeat;background-size:contain;margin:80px auto 0;color:#b4bccc;padding-top:110px}.candidate .candidate-content-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:13px}.candidate .candidate-content-orgpath{margin:0;font-size:12px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#c7ccd7}.candidate .candidate-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.candidate .candidate-title .custom-control{margin:10px 0 0 15px;line-height:35px}.candidate .candidate-title .title-clearall{margin:10px 15px 0 0;color:#2a87ff;cursor:pointer;line-height:35px}.candidate .s-selectedPerson .custom-control-label::before{top:8px}"]
                }] }
    ];
    /** @nocollapse */
    RecentContactsComponent.ctorParameters = function () { return [
        { type: NotifyService },
        { type: FavoritesTool },
        { type: Injector }
    ]; };
    RecentContactsComponent.propDecorators = {
        idField: [{ type: Input }],
        absOrgType: [{ type: Input }],
        absUserOrgUrl: [{ type: Input }],
        busNum: [{ type: Input }],
        searchText: [{ type: Input }],
        searchPage: [{ type: Input }],
        includeStopUser: [{ type: Input }],
        includeCurrentUser: [{ type: Input }],
        enableFavorites: [{ type: Input }],
        validElementsInfo: [{ type: Input }],
        multiSelect: [{ type: Input }],
        orgId: [{ type: Input }],
        userIds: [{ type: Input }],
        selectionsChange: [{ type: Output }],
        recentContactsChange: [{ type: Output }]
    };
    return RecentContactsComponent;
}());
export { RecentContactsComponent };
if (false) {
    /** @type {?} */
    RecentContactsComponent.prototype.idField;
    /**
     * 数据源类型，默认为'System_organization'，即设置为系统数据源，可获取系统组织、系统人员
     * 设置为'Administrative_organization'就是扩展数据源 ，可获取行政组织、行政人员
     * @type {?}
     */
    RecentContactsComponent.prototype.absOrgType;
    /** @type {?} */
    RecentContactsComponent.prototype.absUserOrgUrl;
    /** @type {?} */
    RecentContactsComponent.prototype.busNum;
    /** @type {?} */
    RecentContactsComponent.prototype.searchText;
    /** @type {?} */
    RecentContactsComponent.prototype.searchPage;
    /** @type {?} */
    RecentContactsComponent.prototype.includeStopUser;
    /** @type {?} */
    RecentContactsComponent.prototype.includeCurrentUser;
    /** @type {?} */
    RecentContactsComponent.prototype.enableFavorites;
    /** @type {?} */
    RecentContactsComponent.prototype.validElementsInfo;
    /** @type {?} */
    RecentContactsComponent.prototype.multiSelect;
    /** @type {?} */
    RecentContactsComponent.prototype.orgId;
    /** @type {?} */
    RecentContactsComponent.prototype.userIds;
    /** @type {?} */
    RecentContactsComponent.prototype.selectionsChange;
    /** @type {?} */
    RecentContactsComponent.prototype.recentContactsChange;
    /**
     * @type {?}
     * @private
     */
    RecentContactsComponent.prototype.cdRef;
    /** @type {?} */
    RecentContactsComponent.prototype.allChecked;
    /** @type {?} */
    RecentContactsComponent.prototype.columns;
    /** @type {?} */
    RecentContactsComponent.prototype.selections;
    /** @type {?} */
    RecentContactsComponent.prototype.showUserCode;
    /** @type {?} */
    RecentContactsComponent.prototype.cloneUserIds;
    /** @type {?} */
    RecentContactsComponent.prototype.cloneSelections;
    /** @type {?} */
    RecentContactsComponent.prototype.allIndexId;
    /** @type {?} */
    RecentContactsComponent.prototype.noDataImg;
    /** @type {?} */
    RecentContactsComponent.prototype.items;
    /** @type {?} */
    RecentContactsComponent.prototype.recentContactsList;
    /** @type {?} */
    RecentContactsComponent.prototype.favoritesList;
    /**
     * @type {?}
     * @private
     */
    RecentContactsComponent.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    RecentContactsComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    RecentContactsComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJjLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktcGVyc29ubmVsLXNlbGVjdG9yLyIsInNvdXJjZXMiOlsibGliL3RhYi1yZWNlbnQtY29udGFjdHMvdHJjLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQXlCLGlCQUFpQixFQUFFLFFBQVEsRUFDN0YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFHM0Q7SUFvREksaUNBQ1ksYUFBNEIsRUFDNUIsYUFBNEIsRUFDNUIsUUFBa0I7UUFGbEIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQXZCckIsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLFlBQU8sR0FBRyxFQUFFLENBQUM7UUFFWixxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQzNDLHlCQUFvQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFHekQsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUVuQixlQUFVLEdBQVUsRUFBRSxDQUFDOztRQUV2QixpQkFBWSxHQUFHLElBQUksQ0FBQztRQUNwQixpQkFBWSxHQUFHLEVBQUUsQ0FBQztRQUNsQixvQkFBZSxHQUFHLEVBQUUsQ0FBQztRQUNyQixlQUFVLEdBQUcsWUFBWSxDQUFDO1FBQzFCLGNBQVMsR0FBRyxTQUFTLENBQUM7UUFDdEIsVUFBSyxHQUFHLEVBQUUsQ0FBQztR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QVMsU0FBQztvQkFDUCxRQUFRLEVBQUUscUJBQXFCO29CQUMvQixxL0dBQW1DOztpQkFFdEM7Ozs7Z0JBUlEsYUFBYTtnQkFDYixhQUFhO2dCQUxnRSxRQUFROzs7MEJBZ0J6RixLQUFLOzZCQUtMLEtBQUs7Z0NBRUwsS0FBSzt5QkFFTCxLQUFLOzZCQUVMLEtBQUs7NkJBRUwsS0FBSztrQ0FFTCxLQUFLO3FDQUVMLEtBQUs7a0NBRUwsS0FBSztvQ0FFTCxLQUFLOzhCQUVMLEtBQUs7d0JBQ0wsS0FBSzswQkFDTCxLQUFLO21DQUVMLE1BQU07dUNBQ04sTUFBTTs7SUE2VlgsOEJBQUM7Q0FBQSxBQWpZRCxJQWlZQztTQTVYWSx1QkFBdUI7OztJQUdoQywwQ0FBeUI7Ozs7OztJQUt6Qiw2Q0FBNEI7O0lBRTVCLGdEQUErQjs7SUFFL0IseUNBQXdCOztJQUV4Qiw2Q0FBeUI7O0lBRXpCLDZDQUE2Qjs7SUFFN0Isa0RBQWtDOztJQUVsQyxxREFBcUM7O0lBRXJDLGtEQUFrQzs7SUFFbEMsb0RBQW1DOztJQUVuQyw4Q0FBMEI7O0lBQzFCLHdDQUFvQjs7SUFDcEIsMENBQXNCOztJQUV0QixtREFBcUQ7O0lBQ3JELHVEQUF5RDs7Ozs7SUFFekQsd0NBQWlDOztJQUNqQyw2Q0FBbUI7O0lBQ25CLDBDQUFhOztJQUNiLDZDQUF1Qjs7SUFFdkIsK0NBQW9COztJQUNwQiwrQ0FBa0I7O0lBQ2xCLGtEQUFxQjs7SUFDckIsNkNBQTBCOztJQUMxQiw0Q0FBc0I7O0lBQ3RCLHdDQUFXOztJQUNYLHFEQUF3Qjs7SUFDeEIsZ0RBQW1COzs7OztJQUdmLGdEQUFvQzs7Ozs7SUFDcEMsZ0RBQW9DOzs7OztJQUNwQywyQ0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdG9yXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgbm9EYXRhSW1nIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3Jlc291cmNlJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgUmZSZXF1ZXN0UGFyYW0gfSBmcm9tICcuLi8uLi91dGlscy91c2VyLnR5cGUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2xpYi1yZWNlbnQtY29udGFjdHMnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3RyYy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi90cmMuY29tcG9uZW50LmNzcyddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgUmVjZW50Q29udGFjdHNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xyXG5cclxuICAgIC8vIOaTjeS9nOWIl+ihqOaIluiAheWIhue7hOaJgOmcgOimgeeahOS4u+mUruWtl+aute+8jOm7mOiupOS4uid1c2VySWQnXHJcbiAgICBASW5wdXQoKSBpZEZpZWxkOiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOaVsOaNrua6kOexu+Wei++8jOm7mOiupOS4uidTeXN0ZW1fb3JnYW5pemF0aW9uJ++8jOWNs+iuvue9ruS4uuezu+e7n+aVsOaNrua6kO+8jOWPr+iOt+WPluezu+e7n+e7hOe7h+OAgeezu+e7n+S6uuWRmFxyXG4gICAgICog6K6+572u5Li6J0FkbWluaXN0cmF0aXZlX29yZ2FuaXphdGlvbiflsLHmmK/mianlsZXmlbDmja7mupAg77yM5Y+v6I635Y+W6KGM5pS/57uE57uH44CB6KGM5pS/5Lq65ZGYXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGFic09yZ1R5cGU6IHN0cmluZztcclxuICAgIC8vIOS8oOWFpeeahHVybO+8jOW9k+WJjeS4uum7mOiupOWAvCcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvYWJzVXNlck9yZydcclxuICAgIEBJbnB1dCgpIGFic1VzZXJPcmdVcmw6IHN0cmluZztcclxuICAgIC8vIOS4muWKoeagh+ivhu+8jOm7mOiupOS4uidjb21tb24nXHJcbiAgICBASW5wdXQoKSBidXNOdW06IHN0cmluZztcclxuICAgIC8vIOaQnOe0ouahhueahOi+k+WFpeWAvFxyXG4gICAgQElucHV0KCkgc2VhcmNoVGV4dDogYW55O1xyXG4gICAgLy8g5pCc57Si5pe257+76aG177yM5pqC5LiN5riF5qWa55So6YCUXHJcbiAgICBASW5wdXQoKSBzZWFyY2hQYWdlOiBib29sZWFuO1xyXG4gICAgLy8g5piv5ZCm5YyF5ZCr5YGc55So55So5oi377yM6buY6K6k5Li6ZmFsc2VcclxuICAgIEBJbnB1dCgpIGluY2x1ZGVTdG9wVXNlcjogYm9vbGVhbjtcclxuICAgIC8vIOaYr+WQpuWMheWQq+acrOS6uu+8jOm7mOiupOS4unRydWVcclxuICAgIEBJbnB1dCgpIGluY2x1ZGVDdXJyZW50VXNlcjogYm9vbGVhbjtcclxuICAgIC8vIOaYr+WQpuWFgeiuuOaUtuiXj+S6uuWRmO+8jOm7mOiupOS4unRydWXvvIzlvZPkuI3lsZXnpLrigJzmiJHnmoTmlLbol4/igJ10YWLpobXml7bkuLpmYWxzZVxyXG4gICAgQElucHV0KCkgZW5hYmxlRmF2b3JpdGVzOiBib29sZWFuO1xyXG4gICAgLy8g5aSa6K+t55u45YWzXHJcbiAgICBASW5wdXQoKSB2YWxpZEVsZW1lbnRzSW5mbzogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpIG11bHRpU2VsZWN0OiBhbnk7XHJcbiAgICBASW5wdXQoKSBvcmdJZCA9ICcnO1xyXG4gICAgQElucHV0KCkgdXNlcklkcyA9ICcnO1xyXG5cclxuICAgIEBPdXRwdXQoKSBzZWxlY3Rpb25zQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgcmVjZW50Q29udGFjdHNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICBwcml2YXRlIGNkUmVmOiBDaGFuZ2VEZXRlY3RvclJlZjtcclxuICAgIGFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgIGNvbHVtbnM6IGFueTtcclxuICAgIHNlbGVjdGlvbnM6IGFueVtdID0gW107XHJcbiAgICAvLyDmmK/lkKbmmL7npLrnlKjmiLfnvJblj7dcclxuICAgIHNob3dVc2VyQ29kZSA9IHRydWU7XHJcbiAgICBjbG9uZVVzZXJJZHMgPSAnJztcclxuICAgIGNsb25lU2VsZWN0aW9ucyA9IFtdO1xyXG4gICAgYWxsSW5kZXhJZCA9ICdhbGxJbmRleElkJztcclxuICAgIG5vRGF0YUltZyA9IG5vRGF0YUltZztcclxuICAgIGl0ZW1zID0gW107XHJcbiAgICByZWNlbnRDb250YWN0c0xpc3QgPSBbXTtcclxuICAgIGZhdm9yaXRlc0xpc3QgPSBbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIG5vdGlmeVNlcnZpY2U6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBmYXZvcml0ZXNUb29sOiBGYXZvcml0ZXNUb29sLFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmFsbEluZGV4SWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMywgMTIpO1xyXG4gICAgICAgIHRoaXMuY2RSZWYgPSB0aGlzLmluamVjdG9yLmdldChDaGFuZ2VEZXRlY3RvclJlZik7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLmZhdm9yaXRlc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmZhdm9yaXRlc0xpc3QgPSBkYXRhO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZFJlY2VudENvbnRhY3RzTGlzdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgfVxyXG5cclxuICAgIGFzc2VtYmxlRGF0YSgpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWFyY2hQYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQnlDb2RlT3JOYW1lKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRSZWNlbnRDb250YWN0c0xpc3QoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2VhcmNoQnlDb2RlT3JOYW1lKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLmZpbHRlcihpdGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uY29kZS5pbmRleE9mKHRoaXMuc2VhcmNoVGV4dCkgIT09IC0xIHx8IGl0ZW0ubmFtZS5pbmRleE9mKHRoaXMuc2VhcmNoVGV4dCkgIT09IC0xO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc3RvcmVTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF8uY2xvbmVEZWVwKHRoaXMuY2xvbmVTZWxlY3Rpb25zKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICBpZiAodGhpcy5pc0FsbENoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVBbGwoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsbENoZWNrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja0FsbCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5DaGVja0FsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNkUmVmLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmVtaXRTZWxlY3Rpb25zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlT25lKGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5TZWxlY3RMaW5lKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0TGluZShkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucygpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDnlKjkuo7mlbDmja7lsZXnpLpcclxuICAgICAqL1xyXG4gICAgbG9hZFJlY2VudENvbnRhY3RzTGlzdCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zID0gW107XHJcbiAgICAgICAgdGhpcy5yZWNlbnRDb250YWN0c0xpc3QuZm9yRWFjaChyZXMgPT4ge1xyXG4gICAgICAgICAgICAvLyBjb25zdCBpbmRleElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDMsIDEwKTtcclxuICAgICAgICAgICAgLy8gY29uc3QgaXRlbSA9IHtcclxuICAgICAgICAgICAgLy8gICAgIGFiYnJldmlhdGlvbjogcmVzLmFiYnJldmlhdGlvbixcclxuICAgICAgICAgICAgLy8gICAgIGNvZGU6IHJlcy5jb2RlLFxyXG4gICAgICAgICAgICAvLyAgICAgZGVmYXVsdE9yZ0lkOiByZXMuZGVmYXVsdE9yZ0lkLFxyXG4gICAgICAgICAgICAvLyAgICAgZGVmYXVsdE9yZ1BhdGg6IHJlcy5kZWZhdWx0T3JnUGF0aCxcclxuICAgICAgICAgICAgLy8gICAgIGV4dDE6IHJlcy5leHQxLFxyXG4gICAgICAgICAgICAvLyAgICAgZXh0MjogcmVzLmV4dDIsXHJcbiAgICAgICAgICAgIC8vICAgICBmdWxsUGF0aE5hbWU6IHJlcy5mdWxsUGF0aE5hbWUsXHJcbiAgICAgICAgICAgIC8vICAgICBuYW1lOiByZXMubmFtZSxcclxuICAgICAgICAgICAgLy8gICAgIG9yZ1R5cGVJZDogcmVzLm9yZ1R5cGVJZCxcclxuICAgICAgICAgICAgLy8gICAgIHNlY0xldmVsOiByZXMuc2VjTGV2ZWwsXHJcbiAgICAgICAgICAgIC8vICAgICBzb3J0T3JkZXI6IHJlcy5zb3J0T3JkZXIsXHJcbiAgICAgICAgICAgIC8vICAgICBzdGF0ZTogcmVzLnN0YXRlLFxyXG4gICAgICAgICAgICAvLyAgICAgc3U6IHJlcy5zdSxcclxuICAgICAgICAgICAgLy8gICAgIHVzZXJJZDogcmVzLnVzZXJJZCxcclxuICAgICAgICAgICAgLy8gICAgIG9yZ0FsbFBhdGg6IHJlcy5vcmdBbGxQYXRoLFxyXG4gICAgICAgICAgICAvLyAgICAgdHlwZTogJ3Blb3BsZScsXHJcbiAgICAgICAgICAgIC8vICAgICBjaGVja2VkOiBmYWxzZSxcclxuICAgICAgICAgICAgLy8gICAgIGluRmF2b3JpdGVzOiBmYWxzZSxcclxuICAgICAgICAgICAgLy8gICAgIGluZGV4SWRcclxuICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IF8uY2xvbmVEZWVwKHJlcyk7XHJcbiAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGl0ZW0uaW5kZXhJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygyKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5BcnJheShyZXNbdGhpcy5pZEZpZWxkXSwgdGhpcy5pZEZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5faXNJbkFycmF5KHJlc1t0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuZmF2b3JpdGVzTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVtLmRpc3BsYXlOYW1lID0gISF0aGlzLnNob3dVc2VyQ29kZSA/ICgnWycgKyBpdGVtLmNvZGUgKyAnXScgKyBpdGVtLm5hbWUpIDogaXRlbS5uYW1lO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVDaGVja2VkKCk7XHJcbiAgICAgICAgdGhpcy5jZFJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlhajpgInlkI7lpITnkIZcclxuICAgICAqIEBwYXJhbSBkYXRhQXJyIOWFqOmAieeahOWAvFxyXG4gICAgICovXHJcbiAgICBjaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGl0ZW0pO1xyXG4gICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWo6YOo5Y+W5raIXHJcbiAgICAgKiBAcGFyYW0gZGF0YUFyciDlj5bmtojnmoTmlbDmja5cclxuICAgICAqIEByZXR1cm5zIHZvaWRcclxuICAgICAqL1xyXG4gICAgdW5DaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKChzZWxlY3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmlkRmllbGRdID09PSBzZWxlY3Rpb25bdGhpcy5pZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPliY3ooYzpgInkuK1cclxuICAgICAqIEBwYXJhbSBkYXRhIOW9k+WJjeihjOeahOaVsOaNru+8iO+8iVxyXG4gICAgICovXHJcbiAgICBzZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXNlcklkcyA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlzQWxsQ2hlY2tlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y2V6YCJ5Y+W5raI6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDlj5bmtojpgInkuK3ooYxcclxuICAgICAqL1xyXG4gICAgdW5TZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5faXNJbkFycmF5KGRhdGFbdGhpcy5pZEZpZWxkXSwgdGhpcy5pZEZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpO1xyXG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hbGxDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIGNvbnN0IGVtaXRPYmogPSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvbnM6IHRoaXMuc2VsZWN0aW9ucyxcclxuICAgICAgICAgICAgdG9rZW46ICdyZWNlbnQnXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UuZW1pdChlbWl0T2JqKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluacgOi/keiBlOezu+S6uuWIl+ihqFxyXG4gICAgICovXHJcbiAgICBnZXRSZWNlbnRDb250YWN0c0xpc3QoKSB7XHJcbiAgICAgICAgY29uc3QgcGFyYW06IFJmUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIGJpeklkOiB0aGlzLmJ1c051bSxcclxuICAgICAgICAgICAgb2JqZWN0VmFsdWU6ICdSZWNlbnRDb250YWN0cydcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzVG9vbC5jdXJkUmVjZW50Q29udGFjdHNPckZhdm9yaXRlcygncXVlcnknLCBwYXJhbSkuc3Vic2NyaWJlKChyY1JlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJjUmVzRGF0YSA9IHJjUmVzID8gcmNSZXMuZGF0YSA6IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnJlY2VudENvbnRhY3RzTGlzdCA9IHJjUmVzRGF0YTtcclxuICAgICAgICAgICAgdGhpcy5sb2FkUmVjZW50Q29udGFjdHNMaXN0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnJlY2VudENvbnRhY3RzTGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWRzLnB1c2goaXRlbVt0aGlzLmlkRmllbGRdKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVjZW50Q29udGFjdHNDaGFuZ2UuZW1pdCh7XHJcbiAgICAgICAgICAgICAgICByZWNlbnRDb250YWN0c0xpc3Q6IGlkc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVGYXZvcml0ZXMoZTogYW55LCBpdGVtOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1Rvb2wudG9nZ2xlRmF2b3JpdGVzKGUsIGl0ZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5riF56m65pyA6L+R6IGU57O75Lq6XHJcbiAgICAgKi9cclxuICAgIGNsZWFyUmVjZW50Q29udGFjdHNMaXN0KCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogUmZSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgYml6SWQ6IHRoaXMuYnVzTnVtLFxyXG4gICAgICAgICAgICBvYmplY3RWYWx1ZTogJ1JlY2VudENvbnRhY3RzJyxcclxuICAgICAgICAgICAgYWRkTGlzdDogW11cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1Rvb2wuY3VyZFJlY2VudENvbnRhY3RzT3JGYXZvcml0ZXMoJ21vZGlmeScsIHBhcmFtKS5zdWJzY3JpYmUoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY2RSZWYuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB0aGlzLnJlY2VudENvbnRhY3RzQ2hhbmdlLmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgcmVjZW50Q29udGFjdHNMaXN0OiBbXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8oJ+W3sua4heepuuacgOi/keiBlOezu+S6uu+8gScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqICDlj5bmtojpgInkuK1cclxuICAgICAqIEBwYXJhbSAkZXZlbnQg5Y+W5raI5Yu+6YCJ55qE5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGNhbmNlbFNlbGVjdGlvbnMoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbVt0aGlzLmlkRmllbGRdID09PSAkZXZlbnQuaWQpID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5pZEZpZWxkXSA9PT0gJGV2ZW50LmlkKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKChzZWxlY3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgkZXZlbnQuaWQgPT09IHNlbGVjdGlvblt0aGlzLmlkRmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWo6YOo5Y+W5raI5Yu+6YCJXHJcbiAgICAgKi9cclxuICAgIGNsZWFyQ2hlY2tlZHMoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhclVzZXJJZHMoKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWRzID0gJyc7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmAieS4reW5tuaPkuWFpeW9k+WJjeihjOaVsOaNruWIsOWPs+S+p1xyXG4gICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvbiDmmoLlrZjlvZPliY3mlbDmja7nmoTpm4blkIhcclxuICAgICAqL1xyXG4gICAgX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGE6IGFueSkge1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeaVsOaNruW3sue7j+enu+WFpeWPs+S+p+aVsOaNru+8jOWImei/lOWbnuOAglxyXG4gICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoZGF0YVt0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKGRhdGEpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHRoaXMuc2VsZWN0aW9ucy5zbGljZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5ZCm5Zyo5YaFXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgdmFsdWVcclxuICAgICAqIEBwYXJhbSBmaWVsZCBmaWVsZFxyXG4gICAgICogQHBhcmFtIGFycmF5IGFycmF5XHJcbiAgICAgKiBAcmV0dXJucyDkvY3nva7ntKLlvJVcclxuICAgICAqL1xyXG4gICAgX2lzSW5BcnJheSh2YWx1ZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCBhcnJheTogYW55W10pOiBudW1iZXIge1xyXG4gICAgICAgIGlmICghZmllbGQgfHwgIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLnZhbGlkRWxlbWVudHNJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbmRJbmRleChpdGVtID0+IHZhbHVlID09PSBpdGVtW2ZpZWxkXSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnv7vpobXmo4Dmn6XvvJrkurrlkZjlsZXnpLrljLrnmoTli77pgInnirbmgIHkuI7lt7LpgInkurrlkZjljLrmmK/lkKblr7nlupRcclxuICAgICAqL1xyXG4gICAgdG9nZ2xlQ2hlY2tlZCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoaXRlbVt0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbGxDaGVja2VkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc0FsbENoZWNrZWQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBsZXQgYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKHNlbGVjdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmlkRmllbGRdID09PSBzZWxlY3Rpb25bdGhpcy5pZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA9PT0gY291bnQgJiYgY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ2hlY2tlZDtcclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5Rm4oaW5kZXgsIGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==