/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-15 15:24:24
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-30 14:01:34
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { of, Subject } from 'rxjs';
import { Component, Input, Output, EventEmitter, TemplateRef, ViewChild, Injector, forwardRef, ElementRef, ChangeDetectorRef, HostBinding, NgZone } from '@angular/core';
import { NG_VALUE_ACCESSOR, NgControl } from '@angular/forms';
import { DialogComponent } from '@farris/ui-dialog';
/** @type {?} */
export const LOOKUPINPUT_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    () => LookupComponent)),
    multi: true
};
export class LookupComponent {
    /**
     * @param {?} injector
     * @param {?} el
     * @param {?=} changeDetector
     */
    constructor(injector, el, changeDetector) {
        this.injector = injector;
        this.el = el;
        this.changeDetector = changeDetector;
        this.hostCls = 'f-cmp-inputgroup';
        /**
         * 窗口标题。默认值：此处显示帮助标题
         */
        this.title = '';
        /**
         * 按钮对齐方式
         */
        this.buttonAlign = 'right';
        /**
         * 是否显示按钮
         */
        this.showButtons = true;
        /**
         * 显示关闭按钮
         */
        this.showCloseButton = true;
        /**
         * 显示最大化按钮
         */
        this.showMaxButton = true;
        /**
         * 允许拖拽尺寸
         */
        this.resizable = true;
        /**
         * 允许拖动窗口
         */
        this.draggable = true;
        /**
         * 禁用
         */
        this.disabled = false;
        /**
         * 允许编辑文本框
         */
        this.editable = true;
        /**
         * 只读
         */
        this.readonly = false;
        this.displayText = '';
        /**
         * 窗口打开后
         */
        this.dialogOpened = new EventEmitter();
        /**
         * 窗口关闭后
         */
        this.dialogClosed = new EventEmitter();
        /**
         * 窗口最大化
         */
        this.dialogMaxed = new EventEmitter();
        /**
         * 拖拽改变窗口尺寸进行时
         */
        this.resizing = new EventEmitter();
        /**
         * 拖拽改变窗口尺寸结束
         */
        this.resized = new EventEmitter();
        /**
         * 帮助窗口默认尺寸
         */
        this.defaultDialogSize = { width: 550, height: 570 };
        this.dialogCreated = new Subject();
        this._isShow = false;
        this.displayValue = '';
        this.originalText = '';
        this.onModelChange = (/**
         * @param {?} obj
         * @return {?}
         */
        (obj) => { });
        this.onModelTouched = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.ngZone = this.injector.get(NgZone);
        // if (!this.personalConfigService) {
        //     const idServ = this.injector.get(IdService);
        //     this.personalConfigService = new PersonalConfigService(idServ);
        // }
    }
    /**
     * @param {?} content
     * @return {?}
     */
    set content(content) {
        this.dialog = content;
        if (content) {
            this.dialogCreated.next(this.dialog);
        }
    }
    /**
     * @return {?}
     */
    get isShow() {
        return this._isShow;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set isShow(val) {
        this._isShow = val;
        if (!this.changeDetector['destroyed']) {
            this.changeDetector.detectChanges();
        }
    }
    /**
     * @return {?}
     */
    get invalid() {
        return this.ngControl.valid;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initEvents();
        this.ngControl = this.injector.get(NgControl, null);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.lookupUnsubscribe();
    }
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
        if (this.dialog) {
            this.dialog.closed.subscribe((/**
             * @return {?}
             */
            () => {
                this.isShow = false;
                this.dialog = null;
            }));
        }
    }
    /**
     * @return {?}
     */
    initEvents() {
        if (!this.dictPicking) {
            this.dictPicking = (/**
             * @return {?}
             */
            () => of({ showDialog: true }));
        }
        if (!this.dictPicked) {
            this.dictPicked = (/**
             * @return {?}
             */
            () => of({ closeDialog: true }));
        }
        if (!this.beforeOpen) {
            this.beforeOpen = (/**
             * @return {?}
             */
            () => of(true));
        }
        if (!this.beforeClose) {
            this.beforeClose = (/**
             * @return {?}
             */
            () => of(true));
        }
        if (!this.dialogHeight) {
            this.dialogHeight = this.defaultDialogSize.height;
        }
        if (!this.dialogWidth) {
            this.dialogWidth = this.defaultDialogSize.width;
        }
    }
    /**
     * @return {?}
     */
    showDialog() {
        if (this.disabled || this.readonly) {
            return false;
        }
        this.dictPicking().subscribe((/**
         * @param {?} val
         * @return {?}
         */
        (val) => {
            if (val.showDialog === false) {
                return;
            }
            this.isShow = true;
            // this.changeDetector.detectChanges();
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            () => {
                setTimeout((/**
                 * @return {?}
                 */
                () => this.dialog.show()));
            }));
        }));
        return false;
    }
    /**
     * @return {?}
     */
    closeDialog() {
        this.isShow = false;
        if (this.dialog) {
            this.dialog.close();
        }
    }
    /**
     * @private
     * @return {?}
     */
    lookupUnsubscribe() {
        if (this.dictPickedSubscription) {
            this.dictPickedSubscription.unsubscribe();
        }
        if (this.dictPickingSubscription) {
            this.dictPickingSubscription.unsubscribe();
        }
        if (this.dialogCreatedSubscription) {
            this.dialogCreatedSubscription.unsubscribe();
        }
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onResizing(pos) {
        this.resizing.emit(pos.size);
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onResized(pos) {
        this.resized.emit(pos.size);
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onMaxDialog(pos) {
        this.dialogMaxed.emit(pos.size);
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    writeValue(obj) {
        if (obj) {
            this.displayText = obj;
            this.displayValue = obj;
            this.originalText = this.displayText;
        }
        else {
            this.displayText = '';
            this.displayValue = '';
            this.originalText = '';
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onModelChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onModelTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
}
LookupComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-lookup',
                template: `
        <div
            class="lookupbox input-group"
            [ngClass]="{
                'f-state-disabled': disabled,
                'f-state-readonly': readonly,
                'f-state-editable': !editable
            }"
        >
            <input
                class="form-control"
                [value]="displayText"
                [disabled]="disabled"
                [readonly]="!editable || readonly"
            />
            <div class="input-group-append">
                <span class="f-select input-group-text" (click)="showDialog()">
                    <i class="f-icon f-icon-lookup"></i>
                </span>
            </div>
        </div>
        <farris-dialog
            #dialog
            *ngIf="isShow"
            [title]="title"
            [beforeOpen]="beforeOpen"
            [beforeClose]="beforeClose"
            [width]="dialogWidth"
            [height]="dialogHeight"
            [showButtons]="showButtons"
            [showMaxButton]="showMaxButton"
            [buttons]="buttonsRef || defaultButtonRef"
            [buttonAlign]="buttonAlign"
            (maxed)="onMaxDialog($event)"
            (resized)="onResized($event)"
            (resizing)="onResizing($event)"
        >
            <ng-content></ng-content>

            <ng-template #defaultButtonRef>
                <div style="width: 100%;">
                    <button
                        class="btn btn-secondary btn-lg"
                        (click)="closeDialog()"
                    >
                        Cancel
                    </button>
                    <button class="btn btn-primary btn-lg">Ok</button>
                </div>
            </ng-template>
        </farris-dialog>
    `,
                providers: [LOOKUPINPUT_VALUE_ACCESSOR],
                styles: [`
            .input-group {
                flex-wrap: nowrap;
            }
            :host-context(.ng-invalid) .form-control {
                border-color: #ff0303;
            }
        `]
            }] }
];
/** @nocollapse */
LookupComponent.ctorParameters = () => [
    { type: Injector },
    { type: ElementRef },
    { type: ChangeDetectorRef }
];
LookupComponent.propDecorators = {
    hostCls: [{ type: HostBinding, args: ['class',] }],
    dialogWidth: [{ type: Input }],
    dialogHeight: [{ type: Input }],
    title: [{ type: Input }],
    buttonAlign: [{ type: Input }],
    buttonsRef: [{ type: Input }],
    showButtons: [{ type: Input }],
    showCloseButton: [{ type: Input }],
    showMaxButton: [{ type: Input }],
    resizable: [{ type: Input }],
    draggable: [{ type: Input }],
    disabled: [{ type: Input }],
    editable: [{ type: Input }],
    readonly: [{ type: Input }],
    mapFields: [{ type: Input }],
    valueField: [{ type: Input }],
    textField: [{ type: Input }],
    displayText: [{ type: Input }],
    context: [{ type: Input }],
    beforeOpen: [{ type: Input }],
    beforeClose: [{ type: Input }],
    dictPicking: [{ type: Input }],
    dictPicked: [{ type: Input }],
    dialogOpened: [{ type: Output }],
    dialogClosed: [{ type: Output }],
    dialogMaxed: [{ type: Output }],
    resizing: [{ type: Output }],
    resized: [{ type: Output }],
    content: [{ type: ViewChild, args: ['dialog',] }]
};
if (false) {
    /** @type {?} */
    LookupComponent.prototype.hostCls;
    /**
     * 窗口宽度
     * @type {?}
     */
    LookupComponent.prototype.dialogWidth;
    /**
     * 窗口高度
     * @type {?}
     */
    LookupComponent.prototype.dialogHeight;
    /**
     * 窗口标题。默认值：此处显示帮助标题
     * @type {?}
     */
    LookupComponent.prototype.title;
    /**
     * 按钮对齐方式
     * @type {?}
     */
    LookupComponent.prototype.buttonAlign;
    /**
     * 按钮模板
     * @type {?}
     */
    LookupComponent.prototype.buttonsRef;
    /**
     * 是否显示按钮
     * @type {?}
     */
    LookupComponent.prototype.showButtons;
    /**
     * 显示关闭按钮
     * @type {?}
     */
    LookupComponent.prototype.showCloseButton;
    /**
     * 显示最大化按钮
     * @type {?}
     */
    LookupComponent.prototype.showMaxButton;
    /**
     * 允许拖拽尺寸
     * @type {?}
     */
    LookupComponent.prototype.resizable;
    /**
     * 允许拖动窗口
     * @type {?}
     */
    LookupComponent.prototype.draggable;
    /**
     * 禁用
     * @type {?}
     */
    LookupComponent.prototype.disabled;
    /**
     * 允许编辑文本框
     * @type {?}
     */
    LookupComponent.prototype.editable;
    /**
     * 只读
     * @type {?}
     */
    LookupComponent.prototype.readonly;
    /**
     * 字段映射, { 帮助数据字段：表单字段 }
     * @type {?}
     */
    LookupComponent.prototype.mapFields;
    /**
     * 值字段
     * @type {?}
     */
    LookupComponent.prototype.valueField;
    /**
     * 文本字段
     * @type {?}
     */
    LookupComponent.prototype.textField;
    /** @type {?} */
    LookupComponent.prototype.displayText;
    /**
     * 运行时上下文自定义对象
     * @type {?}
     */
    LookupComponent.prototype.context;
    /**
     * 窗口打开前事件
     * @type {?}
     */
    LookupComponent.prototype.beforeOpen;
    /**
     * 窗口关闭前事件
     * @type {?}
     */
    LookupComponent.prototype.beforeClose;
    /**
     * 帮助前事件
     * @type {?}
     */
    LookupComponent.prototype.dictPicking;
    /** @type {?} */
    LookupComponent.prototype.dictPickingSubscription;
    /**
     * 帮助后事件
     * @type {?}
     */
    LookupComponent.prototype.dictPicked;
    /** @type {?} */
    LookupComponent.prototype.dictPickedSubscription;
    /**
     * 窗口打开后
     * @type {?}
     */
    LookupComponent.prototype.dialogOpened;
    /**
     * 窗口关闭后
     * @type {?}
     */
    LookupComponent.prototype.dialogClosed;
    /**
     * 窗口最大化
     * @type {?}
     */
    LookupComponent.prototype.dialogMaxed;
    /**
     * 拖拽改变窗口尺寸进行时
     * @type {?}
     */
    LookupComponent.prototype.resizing;
    /**
     * 拖拽改变窗口尺寸结束
     * @type {?}
     */
    LookupComponent.prototype.resized;
    /**
     * 帮助窗口默认尺寸
     * @type {?}
     * @private
     */
    LookupComponent.prototype.defaultDialogSize;
    /** @type {?} */
    LookupComponent.prototype.dialogCreated;
    /** @type {?} */
    LookupComponent.prototype.dialogCreatedSubscription;
    /** @type {?} */
    LookupComponent.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    LookupComponent.prototype._isShow;
    /** @type {?} */
    LookupComponent.prototype.ngControl;
    /** @type {?} */
    LookupComponent.prototype.displayValue;
    /** @type {?} */
    LookupComponent.prototype.originalText;
    /**
     * @type {?}
     * @private
     */
    LookupComponent.prototype.ngZone;
    /** @type {?} */
    LookupComponent.prototype.onModelChange;
    /** @type {?} */
    LookupComponent.prototype.onModelTouched;
    /** @type {?} */
    LookupComponent.prototype.injector;
    /** @type {?} */
    LookupComponent.prototype.el;
    /** @type {?} */
    LookupComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbG9va3VwLyIsInNvdXJjZXMiOlsibGliL2xvb2t1cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBUUEsT0FBTyxFQUE0QixFQUFFLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzdELE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUNuRCxTQUFTLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBVSxVQUFVLEVBQUUsaUJBQWlCLEVBQ3BELFdBQVcsRUFBRSxNQUFNLEVBQ3hDLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCxpQkFBaUIsRUFFakIsU0FBUyxFQUNaLE1BQU0sZ0JBQWdCLENBQUM7QUFFeEIsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDOztBQUtwRCxNQUFNLE9BQU8sMEJBQTBCLEdBQVE7SUFDM0MsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixXQUFXLEVBQUUsVUFBVTs7O0lBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFDO0lBQzlDLEtBQUssRUFBRSxJQUFJO0NBQ2Q7QUFvRUQsTUFBTSxPQUFPLGVBQWU7Ozs7OztJQW1HeEIsWUFDVyxRQUFrQixFQUNsQixFQUFjLEVBQ2QsY0FBa0M7UUFGbEMsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQ2QsbUJBQWMsR0FBZCxjQUFjLENBQW9CO1FBcEd2QixZQUFPLEdBQUcsa0JBQWtCLENBQUM7Ozs7UUFPMUMsVUFBSyxHQUFHLEVBQUUsQ0FBQzs7OztRQUVYLGdCQUFXLEdBQUcsT0FBTyxDQUFDOzs7O1FBSXRCLGdCQUFXLEdBQUcsSUFBSSxDQUFDOzs7O1FBRW5CLG9CQUFlLEdBQUcsSUFBSSxDQUFDOzs7O1FBRXZCLGtCQUFhLEdB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R0wsS0FBSzswQkFFTCxLQUFLOzBCQUVMLEtBQUs7eUJBR0wsS0FBSzsyQkFJTCxNQUFNOzJCQUVOLE1BQU07MEJBRU4sTUFBTTt1QkFFTixNQUFNO3NCQUVOLE1BQU07c0JBT04sU0FBUyxTQUFDLFFBQVE7Ozs7SUFsRW5CLGtDQUFtRDs7Ozs7SUFHbkQsc0NBQTZCOzs7OztJQUU3Qix1Q0FBOEI7Ozs7O0lBRTlCLGdDQUFvQjs7Ozs7SUFFcEIsc0NBQStCOzs7OztJQUUvQixxQ0FBc0M7Ozs7O0lBRXRDLHNDQUE0Qjs7Ozs7SUFFNUIsMENBQWdDOzs7OztJQUVoQyx3Q0FBOEI7Ozs7O0lBRTlCLG9DQUEwQjs7Ozs7SUFFMUIsb0NBQTBCOzs7OztJQUUxQixtQ0FBMEI7Ozs7O0lBRTFCLG1DQUF5Qjs7Ozs7SUFFekIsbUNBQTBCOzs7OztJQUUxQixvQ0FBc0Q7Ozs7O0lBRXRELHFDQUE0Qjs7Ozs7SUFFNUIsb0NBQTJCOztJQUMzQixzQ0FBMEI7Ozs7O0lBRzFCLGtDQUFzQjs7Ozs7SUFHdEIscUNBQStDOzs7OztJQUUvQyxzQ0FBZ0Q7Ozs7O0lBRWhELHNDQUFtRTs7SUFDbkUsa0RBQXNDOzs7OztJQUV0QyxxQ0FBZ0U7O0lBQ2hFLGlEQUFxQzs7Ozs7SUFHckMsdUNBQTRDOzs7OztJQUU1Qyx1Q0FBNEM7Ozs7O0lBRTVDLHNDQUEyQzs7Ozs7SUFFM0MsbUNBQXdDOzs7OztJQUV4QyxrQ0FBdUM7Ozs7OztJQUV2Qyw0Q0FBd0Q7O0lBRXhELHdDQUErQzs7SUFDL0Msb0RBQXdDOztJQUN4QyxpQ0FBd0I7Ozs7O0lBUXhCLGtDQUF3Qjs7SUFXeEIsb0NBQWU7O0lBRWYsdUNBQWtCOztJQUNsQix1Q0FBa0I7Ozs7O0lBTWxCLGlDQUF1Qjs7SUFFdkIsd0NBQWtDOztJQUNsQyx5Q0FBbUM7O0lBRS9CLG1DQUF5Qjs7SUFDekIsNkJBQXFCOztJQUNyQix5Q0FBeUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA4LTE1IDE1OjI0OjI0XHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTExLTMwIDE0OjAxOjM0XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIE9ic2VydmFibGUsIG9mLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVGVtcGxhdGVSZWYsXHJcbiAgICBWaWV3Q2hpbGQsIEluamVjdG9yLCBmb3J3YXJkUmVmLCBPbkluaXQsIEVsZW1lbnRSZWYsIENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgQWZ0ZXJWaWV3Q2hlY2tlZCwgSG9zdEJpbmRpbmcsIE5nWm9uZSwgT25EZXN0cm95XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgICBOR19WQUxVRV9BQ0NFU1NPUixcclxuICAgIENvbnRyb2xWYWx1ZUFjY2Vzc29yLFxyXG4gICAgTmdDb250cm9sXHJcbn0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5cclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBJUmVzaXplRXZlbnQgfSBmcm9tICdAZmFycmlzL3VpLWRyYWdnYWJsZSc7XHJcblxyXG5pbXBvcnQgeyBQaWNraW5nUmVzdWx0LCBQaWNrZWRSZXN1bHQgfSBmcm9tICcuL2xvb2t1cC1ncmlkLW9wdGlvbnMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IExPT0tVUElOUFVUX1ZBTFVFX0FDQ0VTU09SOiBhbnkgPSB7XHJcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcclxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IExvb2t1cENvbXBvbmVudCksXHJcbiAgICBtdWx0aTogdHJ1ZVxyXG59O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy1sb29rdXAnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgIGNsYXNzPVwibG9va3VwYm94IGlucHV0LWdyb3VwXCJcclxuICAgICAgICAgICAgW25nQ2xhc3NdPVwie1xyXG4gICAgICAgICAgICAgICAgJ2Ytc3RhdGUtZGlzYWJsZWQnOiBkaXNhYmxlZCxcclxuICAgICAgICAgICAgICAgICdmLXN0YXRlLXJlYWRvbmx5JzogcmVhZG9ubHksXHJcbiAgICAgICAgICAgICAgICAnZi1zdGF0ZS1lZGl0YWJsZSc6ICFlZGl0YWJsZVxyXG4gICAgICAgICAgICB9XCJcclxuICAgICAgICA+XHJcbiAgICAgICAgICAgIDxpbnB1dFxyXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxyXG4gICAgICAgICAgICAgICAgW3ZhbHVlXT1cImRpc3BsYXlUZXh0XCJcclxuICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXHJcbiAgICAgICAgICAgICAgICBbcmVhZG9ubHldPVwiIWVkaXRhYmxlIHx8IHJlYWRvbmx5XCJcclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwLWFwcGVuZFwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmLXNlbGVjdCBpbnB1dC1ncm91cC10ZXh0XCIgKGNsaWNrKT1cInNob3dEaWFsb2coKVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1sb29rdXBcIj48L2k+XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxmYXJyaXMtZGlhbG9nXHJcbiAgICAgICAgICAgICNkaWFsb2dcclxuICAgICAgICAgICAgKm5nSWY9XCJpc1Nob3dcIlxyXG4gICAgICAgICAgICBbdGl0bGVdPVwidGl0bGVcIlxyXG4gICAgICAgICAgICBbYmVmb3JlT3Blbl09XCJiZWZvcmVPcGVuXCJcclxuICAgICAgICAgICAgW2JlZm9yZUNsb3NlXT1cImJlZm9yZUNsb3NlXCJcclxuICAgICAgICAgICAgW3dpZHRoXT1cImRpYWxvZ1dpZHRoXCJcclxuICAgICAgICAgICAgW2hlaWdodF09XCJkaWFsb2dIZWlnaHRcIlxyXG4gICAgICAgICAgICBbc2hvd0J1dHRvbnNdPVwic2hvd0J1dHRvbnNcIlxyXG4gICAgICAgICAgICBbc2hvd01heEJ1dHRvbl09XCJzaG93TWF4QnV0dG9uXCJcclxuICAgICAgICAgICAgW2J1dHRvbnNdPVwiYnV0dG9uc1JlZiB8fCBkZWZhdWx0QnV0dG9uUmVmXCJcclxuICAgICAgICAgICAgW2J1dHRvbkFsaWduXT1cImJ1dHRvbkFsaWduXCJcclxuICAgICAgICAgICAgKG1heGVkKT1cIm9uTWF4RGlhbG9nKCRldmVudClcIlxyXG4gICAgICAgICAgICAocmVzaXplZCk9XCJvblJlc2l6ZWQoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgIChyZXNpemluZyk9XCJvblJlc2l6aW5nKCRldmVudClcIlxyXG4gICAgICAgID5cclxuICAgICAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxyXG5cclxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlICNkZWZhdWx0QnV0dG9uUmVmPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cIndpZHRoOiAxMDAlO1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLXNlY29uZGFyeSBidG4tbGdcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwiY2xvc2VEaWFsb2coKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDYW5jZWxcclxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1sZ1wiPk9rPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cclxuICAgICAgICA8L2ZhcnJpcy1kaWFsb2c+XHJcbiAgICBgLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgYFxyXG4gICAgICAgICAgICAuaW5wdXQtZ3JvdXAge1xyXG4gICAgICAgICAgICAgICAgZmxleC13cmFwOiBub3dyYXA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgOmhvc3QtY29udGV4dCgubmctaW52YWxpZCkgLmZvcm0tY29udHJvbCB7XHJcbiAgICAgICAgICAgICAgICBib3JkZXItY29sb3I6ICNmZjAzMDM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBgXHJcbiAgICBdLFxyXG4gICAgcHJvdmlkZXJzOiBbTE9PS1VQSU5QVVRfVkFMVUVfQUNDRVNTT1JdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBMb29rdXBDb21wb25lbnRcclxuICAgIGltcGxlbWVudHMgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95IHtcclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MnKSBob3N0Q2xzID0gJ2YtY21wLWlucHV0Z3JvdXAnO1xyXG5cclxuICAgIC8qKiDnqpflj6Plrr3luqYgKi9cclxuICAgIEBJbnB1dCgpIGRpYWxvZ1dpZHRoOiBudW1iZXI7XHJcbiAgICAvKiog56qX5Y+j6auY5bqmICovXHJcbiAgICBASW5wdXQoKSBkaWFsb2dIZWlnaHQ6IG51bWJlcjtcclxuICAgIC8qKiDnqpflj6PmoIfpopjjgILpu5jorqTlgLzvvJrmraTlpITmmL7npLrluK7liqnmoIfpopggKi9cclxuICAgIEBJbnB1dCgpIHRpdGxlID0gJyc7XHJcbiAgICAvKiog5oyJ6ZKu5a+56b2Q5pa55byPICovXHJcbiAgICBASW5wdXQoKSBidXR0b25BbGlnbiA9ICdyaWdodCc7XHJcbiAgICAvKiog5oyJ6ZKu5qih5p2/ICovXHJcbiAgICBASW5wdXQoKSBidXR0b25zUmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqIOaYr+WQpuaYvuekuuaMiemSriAqL1xyXG4gICAgQElucHV0KCkgc2hvd0J1dHRvbnMgPSB0cnVlO1xyXG4gICAgLyoqIOaYvuekuuWFs+mXreaMiemSriAqL1xyXG4gICAgQElucHV0KCkgc2hvd0Nsb3NlQnV0dG9uID0gdHJ1ZTtcclxuICAgIC8qKiDmmL7npLrmnIDlpKfljJbmjInpkq4gKi9cclxuICAgIEBJbnB1dCgpIHNob3dNYXhCdXR0b24gPSB0cnVlO1xyXG4gICAgLyoqIOWFgeiuuOaLluaLveWwuuWvuCAqL1xyXG4gICAgQElucHV0KCkgcmVzaXphYmxlID0gdHJ1ZTtcclxuICAgIC8qKiDlhYHorrjmi5bliqjnqpflj6MgKi9cclxuICAgIEBJbnB1dCgpIGRyYWdnYWJsZSA9IHRydWU7XHJcbiAgICAvKiog56aB55SoICovXHJcbiAgICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgLyoqIOWFgeiuuOe8lui+keaWh+acrOahhiAqL1xyXG4gICAgQElucHV0KCkgZWRpdGFibGUgPSB0cnVlO1xyXG4gICAgLyoqIOWPquivuyAqL1xyXG4gICAgQElucHV0KCkgcmVhZG9ubHkgPSBmYWxzZTtcclxuICAgIC8qKiDlrZfmrrXmmKDlsIQsIHsg5biu5Yqp5pWw5o2u5a2X5q6177ya6KGo5Y2V5a2X5q61IH0gKi9cclxuICAgIEBJbnB1dCgpIG1hcEZpZWxkczogeyBbc291cmNlRmllbGQ6IHN0cmluZ106IHN0cmluZyB9O1xyXG4gICAgLyoqIOWAvOWtl+autSAqL1xyXG4gICAgQElucHV0KCkgdmFsdWVGaWVsZDogc3RyaW5nO1xyXG4gICAgLyoqIOaWh+acrOWtl+autSAqL1xyXG4gICAgQElucHV0KCkgdGV4dEZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBkaXNwbGF5VGV4dCA9ICcnO1xyXG5cclxuICAgIC8qKiDov5DooYzml7bkuIrkuIvmlofoh6rlrprkuYnlr7nosaEgKi9cclxuICAgIEBJbnB1dCgpIGNvbnRleHQ6IGFueTtcclxuXHJcbiAgICAvKiog56qX5Y+j5omT5byA5YmN5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSBiZWZvcmVPcGVuOiAoKSA9PiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xyXG4gICAgLyoqIOeql+WPo+WFs+mXreWJjeS6i+S7tiAqL1xyXG4gICAgQElucHV0KCkgYmVmb3JlQ2xvc2U6ICgpID0+IE9ic2VydmFibGU8Ym9vbGVhbj47XHJcbiAgICAvKiog5biu5Yqp5YmN5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSBkaWN0UGlja2luZzogKGVtcHR5T2JqPzoge30pID0+IE9ic2VydmFibGU8UGlja2luZ1Jlc3VsdD47XHJcbiAgICBkaWN0UGlja2luZ1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG4gICAgLyoqIOW4ruWKqeWQjuS6i+S7tiAqL1xyXG4gICAgQElucHV0KCkgZGljdFBpY2tlZDogKHJvd0RhdGE6IGFueSkgPT4gT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+O1xyXG4gICAgZGljdFBpY2tlZFN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAgIC8qKiDnqpflj6PmiZPlvIDlkI4gKi9cclxuICAgIEBPdXRwdXQoKSBkaWFsb2dPcGVuZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog56qX5Y+j5YWz6Zet5ZCOICovXHJcbiAgICBAT3V0cHV0KCkgZGlhbG9nQ2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOeql+WPo+acgOWkp+WMliAqL1xyXG4gICAgQE91dHB1dCgpIGRpYWxvZ01heGVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOaLluaLveaUueWPmOeql+WPo+WwuuWvuOi/m+ihjOaXtiAqL1xyXG4gICAgQE91dHB1dCgpIHJlc2l6aW5nID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOaLluaLveaUueWPmOeql+WPo+WwuuWvuOe7k+adnyAqL1xyXG4gICAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5biu5Yqp56qX5Y+j6buY6K6k5bC65a+4ICovXHJcbiAgICBwcml2YXRlIGRlZmF1bHREaWFsb2dTaXplID0geyB3aWR0aDogNTUwLCBoZWlnaHQ6IDU3MCB9O1xyXG5cclxuICAgIGRpYWxvZ0NyZWF0ZWQgPSBuZXcgU3ViamVjdDxEaWFsb2dDb21wb25lbnQ+KCk7XHJcbiAgICBkaWFsb2dDcmVhdGVkU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcbiAgICBkaWFsb2c6IERpYWxvZ0NvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ2RpYWxvZycpIHNldCBjb250ZW50KGNvbnRlbnQ6IERpYWxvZ0NvbXBvbmVudCkge1xyXG4gICAgICAgIHRoaXMuZGlhbG9nID0gY29udGVudDtcclxuICAgICAgICBpZiAoY29udGVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmRpYWxvZ0NyZWF0ZWQubmV4dCh0aGlzLmRpYWxvZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2lzU2hvdyA9IGZhbHNlO1xyXG4gICAgZ2V0IGlzU2hvdygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNTaG93O1xyXG4gICAgfVxyXG4gICAgc2V0IGlzU2hvdyh2YWwpIHtcclxuICAgICAgICB0aGlzLl9pc1Nob3cgPSB2YWw7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNoYW5nZURldGVjdG9yWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdDb250cm9sOiBhbnk7XHJcblxyXG4gICAgZGlzcGxheVZhbHVlID0gJyc7XHJcbiAgICBvcmlnaW5hbFRleHQgPSAnJztcclxuXHJcbiAgICBnZXQgaW52YWxpZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uZ0NvbnRyb2wudmFsaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZTtcclxuXHJcbiAgICBvbk1vZGVsQ2hhbmdlID0gKG9iajogYW55KSA9PiB7IH07XHJcbiAgICBvbk1vZGVsVG91Y2hlZCA9ICh2YWw6IGFueSkgPT4geyB9O1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgICAgICBwdWJsaWMgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHVibGljIGNoYW5nZURldGVjdG9yPzogQ2hhbmdlRGV0ZWN0b3JSZWZcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMubmdab25lID0gdGhpcy5pbmplY3Rvci5nZXQoTmdab25lKTtcclxuICAgICAgICAvLyBpZiAoIXRoaXMucGVyc29uYWxDb25maWdTZXJ2aWNlKSB7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGlkU2VydiA9IHRoaXMuaW5qZWN0b3IuZ2V0KElkU2VydmljZSk7XHJcbiAgICAgICAgLy8gICAgIHRoaXMucGVyc29uYWxDb25maWdTZXJ2aWNlID0gbmV3IFBlcnNvbmFsQ29uZmlnU2VydmljZShpZFNlcnYpO1xyXG4gICAgICAgIC8vIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmluaXRFdmVudHMoKTtcclxuICAgICAgICB0aGlzLm5nQ29udHJvbCA9IHRoaXMuaW5qZWN0b3IuZ2V0KE5nQ29udHJvbCwgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5sb29rdXBVbnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kaWFsb2cpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2cuY2xvc2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaWFsb2cgPSBudWxsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdEV2ZW50cygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGljdFBpY2tpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWN0UGlja2luZyA9ICgpID0+IG9mKHsgc2hvd0RpYWxvZzogdHJ1ZSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpY3RQaWNrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWN0UGlja2VkID0gKCkgPT4gb2YoeyBjbG9zZURpYWxvZzogdHJ1ZSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmJlZm9yZU9wZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVPcGVuID0gKCkgPT4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5iZWZvcmVDbG9zZSkge1xyXG4gICAgICAgICAgICB0aGlzLmJlZm9yZUNsb3NlID0gKCkgPT4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGlhbG9nSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nSGVpZ2h0ID0gdGhpcy5kZWZhdWx0RGlhbG9nU2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGlhbG9nV2lkdGgpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dXaWR0aCA9IHRoaXMuZGVmYXVsdERpYWxvZ1NpemUud2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNob3dEaWFsb2coKTogYW55IHtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCB8fCB0aGlzLnJlYWRvbmx5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kaWN0UGlja2luZygpLnN1YnNjcmliZSgodmFsOiBQaWNraW5nUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2YWwuc2hvd0RpYWxvZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pc1Nob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmRpYWxvZy5zaG93KCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlRGlhbG9nKCkge1xyXG4gICAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGxvb2t1cFVuc3Vic2NyaWJlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRpY3RQaWNrZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5kaWN0UGlja2VkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRpY3RQaWNraW5nU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGljdFBpY2tpbmdTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZGlhbG9nQ3JlYXRlZFN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmRpYWxvZ0NyZWF0ZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemluZyhwb3M6IElSZXNpemVFdmVudCkge1xyXG4gICAgICAgIHRoaXMucmVzaXppbmcuZW1pdChwb3Muc2l6ZSk7XHJcbiAgICB9XHJcbiAgICBvblJlc2l6ZWQocG9zOiBJUmVzaXplRXZlbnQpIHtcclxuICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdChwb3Muc2l6ZSk7XHJcbiAgICB9XHJcbiAgICBvbk1heERpYWxvZyhwb3M6IElSZXNpemVFdmVudCkge1xyXG4gICAgICAgIHRoaXMuZGlhbG9nTWF4ZWQuZW1pdChwb3Muc2l6ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgd3JpdGVWYWx1ZShvYmo6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9IG9iajtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VmFsdWUgPSBvYmo7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUZXh0ID0gdGhpcy5kaXNwbGF5VGV4dDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUZXh0ID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlID0gZm47XHJcbiAgICB9XHJcbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsVG91Y2hlZCA9IGZuO1xyXG4gICAgfVxyXG4gICAgc2V0RGlzYWJsZWRTdGF0ZT8oaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==