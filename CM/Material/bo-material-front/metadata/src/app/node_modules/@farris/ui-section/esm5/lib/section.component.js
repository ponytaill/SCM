/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-14 15:22:21
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-08-15 16:44:15
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ContentChild, HostBinding, ViewChild, Optional, NgZone, Injector, Renderer2 } from '@angular/core';
import { FarrisSectionTitleDirective } from './directive/section-title.directive';
import { FarrisSectionHeaderDirective } from './directive/section-header.directive';
import { FarrisSectionHcontentDirective } from './directive/section-hcontent.directive';
import { FarrisSectionToolbarDirective, FarrisSectionViewChangeDirective } from './directive/section-toolbar.directive';
import { FarrisSectionExtendDirective } from './directive/section-extend.directive';
import { FarrisSectionContentDirective } from './directive/section-content.directive';
import { Observable, Subject, of } from 'rxjs';
import ResizeObserver from 'resize-observer-polyfill';
import { map, debounceTime, } from 'rxjs/operators';
var FarrisSectionComponent = /** @class */ (function () {
    function FarrisSectionComponent(inject) {
        this.inject = inject;
        this.contentCls = '';
        this.baseCls = true;
        this.maxStatus = false;
        // 是否显示header
        this.showHeader = true;
        // 是否支持最大化
        this.enableMaximize = false;
        /**
         * 是否启用収折功能
         * 默认不启用収折,值为''
         * 启用默认収折,值为'default'
         * 启用自定义収折,值为 'custom'
         *
         */
        this.enableAccordion = '';
        // section是否铺满
        this.fill = false;
        // 默认是是否展开
        this.expandStatus = true;
        // 就来按钮位置
        this.toolbarPosition = '';
        //
        this.toolbarBtns = [];
        // 工具栏按钮
        this._toolbar = null;
        //标记按钮工具栏是否隐藏[更多]按钮
        this.toolbarDpHidden = true;
        // 参照Tab中这样的处理方式有问题----延后修改
        // 是否被禁用的状态
        // 按照之前的逻辑，如果没有找到key，就说明被禁用
        this._disableDatas = new Subject();
        // 按照之前的逻辑，如果没有找到key，就说明可见
        this._visibleDatas = new Subject();
        this.clickThrottleTime = 350;
        this.clickItems = new Subject();
        // 用于计算响应时
        this.ro = null;
        this.resizeEl = null;
        this.inMoreButtonContents = [];
        if (this.inject) {
            this.ngZone = this.inject.get(NgZone, null);
            this.renderer = this.inject.get(Renderer2, null);
        }
    }
    Object.defineProperty(FarrisSectionComponent.prototype, "fillCls", {
        get: /**
         * @return {?}
         */
        function () {
            return this.fill;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "enableAccordionCls", {
        get: /**
         * @return {?}
         */
        function () {
            return this.enableAccordion == 'default';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "enableCollapseCls", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.enableAccordion === 'default' ||
                this.enableAccordion === 'custom') {
                return !this.expandStatus;
            }
            else {
                return false;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "enableCustomAccordionCls", {
        get: /**
         * @return {?}
         */
        function () {
            return this.enableAccordion == 'custom';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "toolbar", {
        get: /**
         * @return {?}
         */
        function () {
            return this._toolbar;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value) {
                this._toolbar = value;
                // 计算位置
                this.toolbarPosition = this.getToolbarPosition();
                //
                this.toolbarBtns = tslib_1.__spread(this.toolbar.contents);
                this.inMoreButtonContents = [];
                // 绑定事件
                this.bindResizeEvent();
                // 调整界面
                this.afterBindToolbarData();
            }
            else {
                this._toolbar = null;
                // 有位置
                this.toolbarPosition = '';
                this.toolbarBtns = [];
                this.inMoreButtonContents = [];
                // 移除绑定事件
                this.unBindResizeEvent();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "btnStates", {
        set: /**
         * @param {?} values
         * @return {?}
         */
        function (values) {
            if (values) {
                if (this._disableDatas && this._disableDatas.hasOwnProperty('unsubscribe')) {
                    this._disableDatas['unsubscribe']();
                }
                this._disableDatas = values;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FarrisSectionComponent.prototype, "btnVisible", {
        // 是否可见的状态
        set: 
        // 是否可见的状态
        /**
         * @param {?} values
         * @return {?}
         */
        function (values) {
            if (values) {
                if (this._visibleDatas && this._visibleDatas.hasOwnProperty('unsubscribe')) {
                    this._visibleDatas['unsubscribe']();
                }
                this._visibleDatas = values;
            }
        },
        enumerable: true,
        configurable: true
    });
    // 用于提供循环效率
    // 用于提供循环效率
    /**
     * @param {?} index
     * @param {?} btn
     * @return {?}
     */
    FarrisSectionComponent.prototype.trackByButton = 
    // 用于提供循环效率
    /**
     * @param {?} index
     * @param {?} btn
     * @return {?}
     */
    function (index, btn) { return btn.id; };
    /**
     * @return {?}
     */
    FarrisSectionComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 标记点击事件
        this.clickSubscription = this.clickItems.pipe(debounceTime(this.clickThrottleTime))
            .subscribe((/**
         * @param {?} btnInfo
         * @return {?}
         */
        function (btnInfo) {
            if (btnInfo.click && typeof btnInfo.click == 'function') {
                btnInfo.click({ context: _this.context });
            }
        }));
        // 绑定状态
        this._disableDatas.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            // 调整按钮可用状态
            _this.changeState(data, 'disable');
        }));
        this._visibleDatas.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            // 调整按钮可见状态
            _this.changeState(data, 'visible');
        }));
    };
    /**
     * 获取按钮配置中，禁用、可见的属性
     * @param id
     * @param stateProp
     */
    /**
     * 获取按钮配置中，禁用、可见的属性
     * @param {?} btnItem
     * @param {?} stateProp
     * @return {?}
     */
    FarrisSectionComponent.prototype.getState = /**
     * 获取按钮配置中，禁用、可见的属性
     * @param {?} btnItem
     * @param {?} stateProp
     * @return {?}
     */
    function (btnItem, stateProp) {
        if (btnItem.hasOwnProperty(stateProp)) {
            return btnItem[stateProp];
        }
        // 不存在属性
        if (stateProp == 'visible') {
            return true;
        }
        return false;
    };
    /**
     * 改变可用状态
     * @param values
     */
    /**
     * 改变可用状态
     * @private
     * @param {?} values
     * @param {?} stateProp
     * @return {?}
     */
    FarrisSectionComponent.prototype.changeState = /**
     * 改变可用状态
     * @private
     * @param {?} values
     * @param {?} stateProp
     * @return {?}
     */
    function (values, stateProp) {
        var _this = this;
        /** @type {?} */
        var idArray = Object.keys(values);
        idArray.forEach((/**
         * @param {?} id
         * @return {?}
         */
        function (id) {
            /** @type {?} */
            var state = values[id];
            /** @type {?} */
            var item = _this._findItemByID(id, _this.toolbarBtns);
            if (item) {
                item[stateProp] = state;
            }
        }));
        this.inMoreButtonContents.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var findId = idArray.find((/**
             * @param {?} id
             * @return {?}
             */
            function (id) { return id == item.id; }));
            if (findId) {
                item[stateProp] = values[findId];
            }
        }));
    };
    /**
     * 查找
     * @param id
     * @param datas
     */
    /**
     * 查找
     * @private
     * @param {?} id
     * @param {?} datas
     * @return {?}
     */
    FarrisSectionComponent.prototype._findItemByID = /**
     * 查找
     * @private
     * @param {?} id
     * @param {?} datas
     * @return {?}
     */
    function (id, datas) {
        return datas.find((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.id == id; }));
    };
    /**
     * @return {?}
     */
    FarrisSectionComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.clickSubscription) {
            this.clickSubscription.unsubscribe();
            this.clickSubscription = null;
        }
        if (this._visibleDatas && this._visibleDatas.hasOwnProperty('unsubscribe')) {
            this._visibleDatas['unsubscribe']();
            this._visibleDatas = null;
        }
        if (this._disableDatas && this._disableDatas.hasOwnProperty('unsubscribe')) {
            this._disableDatas['unsubscribe']();
            this._disableDatas = null;
        }
        this.unBindResizeEvent();
    };
    /**
     * 绑定限制
     */
    /**
     * 绑定限制
     * @private
     * @return {?}
     */
    FarrisSectionComponent.prototype.bindResizeEvent = /**
     * 绑定限制
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // 标记响应时
        if (this.ngZone && this.toolbar && this.toolbar.contents.length > 0) {
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            function () {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    if (!_this.toolbarContainer) {
                        return;
                    }
                    if (_this.ro) {
                        if (_this.toolbarContainer.nativeElement.parentElement == _this.resizeEl) {
                            // 已绑定过
                            return;
                        }
                        else {
                            _this.unBindResizeEvent();
                        }
                    }
                    if (_this.ro === null) {
                        _this.ro = new ResizeObserver((/**
                         * @param {?} el
                         * @return {?}
                         */
                        function (el) {
                            _this._calculateToolbarDropdownIsShow();
                            _this._calculateButtonsShow();
                        }));
                        _this.resizeEl = _this.toolbarContainer.nativeElement.parentElement;
                        _this.ro.observe(_this.resizeEl);
                    }
                }), 0);
            }));
        }
        else {
            this.unBindResizeEvent();
        }
    };
    /**
     * 按钮数据变更后触发检查
     */
    /**
     * 按钮数据变更后触发检查
     * @private
     * @return {?}
     */
    FarrisSectionComponent.prototype.afterBindToolbarData = /**
     * 按钮数据变更后触发检查
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.ngZone && this.toolbar && this.toolbar.contents.length > 0) {
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            function () {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this._calculateToolbarDropdownIsShow();
                    _this._calculateButtonsShow();
                }), 0);
            }));
        }
    };
    /**
     * 判断下拉按钮是否显示
     */
    /**
     * 判断下拉按钮是否显示
     * @private
     * @return {?}
     */
    FarrisSectionComponent.prototype._calculateToolbarDropdownIsShow = /**
     * 判断下拉按钮是否显示
     * @private
     * @return {?}
     */
    function () {
        if (!this.toolbarContainer || !this.toolbar || !this.toolbarPosition) {
            // 容器未显示，没有数据，没有按钮位置
            this.toolbarDpHidden = true;
            return;
        }
        /** @type {?} */
        var btnParentsContainer = this.toolbarContainer.nativeElement.parentElement;
        if (this.btnPlaceHolder.nativeElement.scrollWidth > btnParentsContainer.offsetWidth) {
            this.toolbarDpHidden = false;
        }
        else {
            this.toolbarDpHidden = true;
        }
    };
    /**
     * 计算显示的按钮个数及更多中显示的按钮个数
     */
    /**
     * 计算显示的按钮个数及更多中显示的按钮个数
     * @private
     * @return {?}
     */
    FarrisSectionComponent.prototype._calculateButtonsShow = /**
     * 计算显示的按钮个数及更多中显示的按钮个数
     * @private
     * @return {?}
     */
    function () {
        if (!this.toolbarContainer || !this.toolbar || !this.toolbarPosition) {
            // 容器未显示，没有数据，没有按钮位置
            return;
        }
        if (this.toolbarDpHidden) {
            this.toolbarBtns = tslib_1.__spread(this.toolbar.contents);
            this.inMoreButtonContents = [];
            return;
        }
        /** @type {?} */
        var toolbarParentContainerEl = this.toolbarContainer.nativeElement.parentElement;
        /** @type {?} */
        var divEl = this.toolbarContainer.nativeElement;
        /** @type {?} */
        var btnPlaceHolderEl = this.btnPlaceHolder.nativeElement;
        /** @type {?} */
        var btnPlaceHolderBtns = btnPlaceHolderEl.querySelectorAll('button');
        // 更多按钮
        /** @type {?} */
        var moreButton = toolbarParentContainerEl.querySelector('.morebtn');
        // 计算按钮的宽度      
        /** @type {?} */
        var basicStart = parseInt(btnPlaceHolderEl.getBoundingClientRect().left);
        /** @type {?} */
        var basicWidth = toolbarParentContainerEl.offsetWidth - moreButton.offsetWidth - 12;
        /** @type {?} */
        var toolbarDropdownHidden = true;
        /** @type {?} */
        var k = 0
        // 只有一个按钮
        ;
        // 只有一个按钮
        if (btnPlaceHolderBtns.length == 1) {
            if (btnPlaceHolderEl.offsetWidth > basicWidth) {
                toolbarDropdownHidden = false;
            }
            else {
                k = 1;
            }
        }
        else {
            for (k = 1; k <= btnPlaceHolderBtns.length - 1; k++) {
                // 如果内容超出,考虑到按钮之间的间距
                if (k == btnPlaceHolderBtns.length - 1) {
                    if (btnPlaceHolderEl.offsetWidth > basicWidth) {
                        toolbarDropdownHidden = false;
                        k = k - 1;
                        break;
                    }
                }
                else if (parseInt(btnPlaceHolderBtns[k].getBoundingClientRect().left) - basicStart > basicWidth) {
                    toolbarDropdownHidden = false;
                    k = k - 1;
                    break;
                }
            }
        }
        this.toolbarDpHidden = toolbarDropdownHidden;
        /** @type {?} */
        var showBtns = divEl.querySelectorAll('button');
        /** @type {?} */
        var resultBtns = this.toolbar.contents.filter((/**
         * @param {?} item
         * @param {?} index
         * @return {?}
         */
        function (item, index) {
            return index < k;
        }));
        this.toolbarBtns = resultBtns ? tslib_1.__spread(resultBtns) : [];
        // for (let m = k; m < showBtns.length; m++) {
        //     this.renderer.setStyle(showBtns[m], 'display', 'none');
        // }
        if (this.toolbar.contents && this.toolbar.contents.length) {
            this.inMoreButtonContents = this.toolbar.contents.filter((/**
             * @param {?} item
             * @param {?} index
             * @return {?}
             */
            function (item, index) {
                return index >= k;
            }));
        }
    };
    /**
     * 在按钮状态变化时解除限制
     */
    /**
     * 在按钮状态变化时解除限制
     * @private
     * @return {?}
     */
    FarrisSectionComponent.prototype.unBindResizeEvent = /**
     * 在按钮状态变化时解除限制
     * @private
     * @return {?}
     */
    function () {
        if (this.ro) {
            if (this.resizeEl) {
                this.ro.unobserve(this.resizeEl);
            }
            this.ro = null;
        }
    };
    /**
     * @return string
     * '' 不存在按钮，无所谓位置
     * 'inHead' 按钮在头部
     * 'inContent' 按钮在内容位置
     */
    /**
     * @private
     * @return {?} string
     * '' 不存在按钮，无所谓位置
     * 'inHead' 按钮在头部
     * 'inContent' 按钮在内容位置
     */
    FarrisSectionComponent.prototype.getToolbarPosition = /**
     * @private
     * @return {?} string
     * '' 不存在按钮，无所谓位置
     * 'inHead' 按钮在头部
     * 'inContent' 按钮在内容位置
     */
    function () {
        if (this.toolbar && this.toolbar.hasOwnProperty('position') && this.toolbar.hasOwnProperty('contents') && this.toolbar.contents.length > 0) {
            // 如果有属性，且按钮有值
            if (this.toolbar.position === 'inHead') {
                return 'inHead';
            }
            else {
                return 'inContent';
            }
        }
        return '';
    };
    /**
     * 判断是否显示、隐藏
     * @param id
     * @param state
     */
    /**
     * 判断是否显示、隐藏
     * @param {?} id
     * @param {?=} state
     * @param {?=} defaultValue
     * @return {?}
     */
    FarrisSectionComponent.prototype.getToolbarState = /**
     * 判断是否显示、隐藏
     * @param {?} id
     * @param {?=} state
     * @param {?=} defaultValue
     * @return {?}
     */
    function (id, state, defaultValue) {
        if (state === void 0) { state = this.btnStates; }
        if (defaultValue === void 0) { defaultValue = false; }
        if (state) {
            return state.pipe(map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                if (n[id] === undefined) {
                    // console.warn(`未找ID为：${id} 相关状态设置！`);
                    return defaultValue;
                }
                return n[id];
            })));
        }
        else {
            return of(defaultValue);
        }
    };
    /**
     * @param {?} btnInfo
     * @return {?}
     */
    FarrisSectionComponent.prototype.clickHandler = /**
     * @param {?} btnInfo
     * @return {?}
     */
    function (btnInfo) {
        if (!btnInfo) {
            return;
        }
        this.clickItems.next(btnInfo);
    };
    FarrisSectionComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-section',
                    template: "<div class=\"f-section-header\" [ngClass]=\"headerDirective && headerDirective.headerCls\" *ngIf=\"showHeader\">\r\n    <ng-template [ngTemplateOutlet]=\"headerDirective.templateRef\"\r\n        *ngIf=\"headerDirective && headerDirective.templateRef\"></ng-template>\r\n    <ng-template [ngIf]=\"!headerDirective\">\r\n        <ng-template [ngTemplateOutlet]=\"headerTitleDirective.templateRef\"\r\n            *ngIf=\"headerTitleDirective && headerTitleDirective.templateRef\" [ngTemplateOutletContext]=\"{context:this.context,index:this.index }\"></ng-template>\r\n        <div *ngIf=\"!headerTitleDirective || !headerTitleDirective.templateRef\" class=\"f-title\"\r\n            (click)=\"this.expandStatus = !this.expandStatus\">\r\n            <h4 class=\"f-title-text\">{{ mainTitle }}</h4>\r\n            <span *ngIf=\"subTitle && subTitle.length\">{{\r\n            subTitle\r\n        }}</span>\r\n        </div>\r\n        <div class=\"f-content\" [ngClass]=\"\r\n            headerContentDirective &&\r\n            headerContentDirective.hcontentCls\r\n        \" *ngIf=\"\r\n            headerContentDirective &&\r\n            headerContentDirective.templateRef\r\n        \">\r\n            <ng-template [ngTemplateOutlet]=\"headerContentDirective.templateRef\"></ng-template>\r\n        </div>\r\n        <div class=\"f-toolbar\" [ngClass]=\"\r\n            headerToolbarDirective &&\r\n            headerToolbarDirective.toolbarCls\" *ngIf=\" headerToolbarDirective &&headerToolbarDirective.templateRef \">\r\n            <ng-template [ngTemplateOutlet]=\"headerToolbarDirective.templateRef\" *ngIf=\"\r\n                headerToolbarDirective &&\r\n                headerToolbarDirective.templateRef\r\n            \"></ng-template>\r\n        </div>\r\n        <div #toolbarHeaderContainer class=\"f-section-toolbar f-section-header--toolbar\"\r\n            *ngIf=\"!headerToolbarDirective&&toolbarPosition=='inHead'\">\r\n            <ng-container [ngTemplateOutlet]=\"toolbarBtnTmpl\"\r\n                [ngTemplateOutletContext]=\"{ datas: toolbarBtns, dpHidden:toolbarDpHidden,dpDatas:inMoreButtonContents}\">\r\n            </ng-container>\r\n        </div>\r\n        <div class=\"f-viewchange\" [ngClass]=\"viewChangeDirective && viewChangeDirective.viewChangeCls\"\r\n            *ngIf=\" viewChangeDirective &&viewChangeDirective.templateRef \">\r\n            <ng-template [ngTemplateOutlet]=\"viewChangeDirective.templateRef\"></ng-template>\r\n        </div>\r\n        <div class=\"f-max-accordion\" *ngIf=\"enableMaximize||enableAccordion!=''\">\r\n            <span class=\"f-icon\" *ngIf=\"enableMaximize\" [class.f-icon-maximize]=\"!maxStatus\"\r\n                [class.f-icon-minimize]=\"maxStatus\" (click)=\"this.maxStatus = !this.maxStatus\"> </span>\r\n            <button class=\"btn f-btn-collapse-expand f-btn-mx\" *ngIf=\"enableAccordion\"\r\n                [ngClass]=\"{ 'f-state-expand': expandStatus }\" (click)=\"this.expandStatus = !this.expandStatus\">\r\n                <span *ngIf=\"!expandStatus\">{{'section.expandLabel'|locale}}</span>\r\n                <span *ngIf=\"expandStatus\">{{'section.collapseLabel'|locale}}</span>\r\n            </button>\r\n        </div>\r\n    </ng-template>\r\n\r\n    <div class=\"f-section-header--btn-placeholder\" #btnPlaceholder *ngIf=\"!headerToolbarDirective&&toolbarPosition\">\r\n        <ng-container *ngFor=\"let btn of toolbar.contents\">\r\n            <button [ngClass]=\"btn.appearance.class\"\r\n                *ngIf=\"getToolbarState(btn.id, btnVisible,true) | async\">{{btn.title}}</button>\r\n        </ng-container>\r\n    </div>\r\n</div>\r\n<div class=\"f-section-header--btn-placeholder\" #btnPlaceholder *ngIf=\"!showHeader&&toolbarPosition=='inContent'\">\r\n    <ng-container *ngFor=\"let btn of toolbar.contents\">\r\n        <button [ngClass]=\"btn.appearance.class\"\r\n            *ngIf=\"getToolbarState(btn.id, btnVisible,true) | async\">{{btn.title}}</button>\r\n    </ng-container>\r\n</div>\r\n<div class=\"f-section-extend\" [ngClass]=\"extendDirective && extendDirective.extendCls\" \r\n    *ngIf=\"extendDirective && extendDirective.templateRef\">\r\n    <ng-template  [ngTemplateOutlet]=\"extendDirective.templateRef\"></ng-template>\r\n</div>\r\n\r\n<div class=\"f-section-content\" [ngClass]=\"contentCls\">\r\n    <div class=\"f-section-toolbar f-section-content--toolbar\"\r\n        *ngIf=\"!headerToolbarDirective&&toolbarPosition=='inContent'\">\r\n        <ng-container [ngTemplateOutlet]=\"toolbarBtnTmpl\"\r\n            [ngTemplateOutletContext]=\"{ datas: toolbarBtns, dpHidden:toolbarDpHidden,dpDatas:inMoreButtonContents}\">\r\n        </ng-container>\r\n    </div>\r\n    <ng-content></ng-content>\r\n</div>\r\n<ng-template #toolbarBtnTmpl let-datas=\"datas\" let-dpHidden=\"dpHidden\" let-dpDatas=\"dpDatas\">\r\n    <div class=\"toolbar-btn-inline-flex\" #toolbarContainer>\r\n        <ng-container *ngFor=\"let btn of datas;trackBy:trackByButton\">\r\n            <button [attr.id]=\"btn.id\" [ngClass]=\"btn.appearance.class\"\r\n                *ngIf=\"getState(btn,'visible')\"\r\n                [disabled]=\"getState(btn,'disable')\"\r\n                (click)=\"clickHandler(btn)\">{{btn.title}}</button>\r\n        </ng-container>\r\n    </div>\r\n    <div class=\"btn-group sc-nav-btn\" ngbDropdown [hidden]=\"dpHidden\">\r\n        <button class=\"btn btn-link morebtn\" ngbDropdownToggle>{{'tabs.more' | locale}}</button>\r\n        <ul class=\"dropdown-menu\" ngbDropdownMenu *ngIf=\"dpDatas.length>0\">\r\n            <ng-container *ngFor=\"let dpBtn of dpDatas;trackBy:trackByButton\">\r\n                <li class=\"dropdown-item text-truncate px-2\"   *ngIf=\"getState(dpBtn,'visible')\">\r\n                    <button style=\"width:100%;\" [attr.id]=\"dpBtn.id\" class=\"btn btn-link text-left\"\r\n                        [class.disabled]=\"getState(dpBtn,'disable')\"\r\n                        (click)=\"clickHandler(dpBtn)\">{{dpBtn.title}}</button>\r\n                </li>\r\n            </ng-container>\r\n        </ul>\r\n    </div>\r\n</ng-template>",
                    styles: [".f-section-header--btn-placeholder{position:absolute;display:-webkit-inline-box;display:inline-flex;top:-30px;left:0;opacity:0;overflow:hidden;z-index:-90}.f-section-content .toolbar-btn-inline-flex,.f-section-header .toolbar-btn-inline-flex{display:-webkit-inline-box;display:inline-flex;overflow:hidden}.f-section-header--toolbar{-webkit-box-flex:1;flex:1;-webkit-box-align:center;align-items:center;width:30%;display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;margin-left:.875rem}.f-section-content--toolbar{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}"]
                }] }
    ];
    /** @nocollapse */
    FarrisSectionComponent.ctorParameters = function () { return [
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    FarrisSectionComponent.propDecorators = {
        contentCls: [{ type: Input }],
        baseCls: [{ type: HostBinding, args: ['class.f-section',] }],
        maxStatus: [{ type: HostBinding, args: ['class.f-section-maximize',] }],
        fillCls: [{ type: HostBinding, args: ['class.f-section-fill',] }],
        enableAccordionCls: [{ type: HostBinding, args: ['class.f-section-accordion',] }],
        enableCollapseCls: [{ type: HostBinding, args: ['class.f-state-collapse',] }],
        enableCustomAccordionCls: [{ type: HostBinding, args: ['class.f-section-custom-accordion',] }],
        mainTitle: [{ type: Input }],
        subTitle: [{ type: Input }],
        showHeader: [{ type: Input }],
        enableMaximize: [{ type: Input }],
        enableAccordion: [{ type: Input }],
        fill: [{ type: Input }],
        expandStatus: [{ type: Input }],
        context: [{ type: Input }],
        index: [{ type: Input }],
        toolbar: [{ type: Input }],
        headerDirective: [{ type: ContentChild, args: [FarrisSectionHeaderDirective,] }],
        headerTitleDirective: [{ type: ContentChild, args: [FarrisSectionTitleDirective,] }],
        headerContentDirective: [{ type: ContentChild, args: [FarrisSectionHcontentDirective,] }],
        headerToolbarDirective: [{ type: ContentChild, args: [FarrisSectionToolbarDirective,] }],
        extendDirective: [{ type: ContentChild, args: [FarrisSectionExtendDirective,] }],
        contentDirective: [{ type: ContentChild, args: [FarrisSectionContentDirective,] }],
        viewChangeDirective: [{ type: ContentChild, args: [FarrisSectionViewChangeDirective,] }],
        btnStates: [{ type: Input }],
        btnVisible: [{ type: Input }],
        clickThrottleTime: [{ type: Input }],
        toolbarContainer: [{ type: ViewChild, args: ['toolbarContainer',] }],
        btnPlaceHolder: [{ type: ViewChild, args: ['btnPlaceholder',] }]
    };
    return FarrisSectionComponent;
}());
export { FarrisSectionComponent };
if (false) {
    /** @type {?} */
    FarrisSectionComponent.prototype.contentCls;
    /** @type {?} */
    FarrisSectionComponent.prototype.baseCls;
    /** @type {?} */
    FarrisSectionComponent.prototype.maxStatus;
    /** @type {?} */
    FarrisSectionComponent.prototype.mainTitle;
    /** @type {?} */
    FarrisSectionComponent.prototype.subTitle;
    /** @type {?} */
    FarrisSectionComponent.prototype.showHeader;
    /** @type {?} */
    FarrisSectionComponent.prototype.enableMaximize;
    /**
     * 是否启用収折功能
     * 默认不启用収折,值为''
     * 启用默认収折,值为'default'
     * 启用自定义収折,值为 'custom'
     *
     * @type {?}
     */
    FarrisSectionComponent.prototype.enableAccordion;
    /** @type {?} */
    FarrisSectionComponent.prototype.fill;
    /** @type {?} */
    FarrisSectionComponent.prototype.expandStatus;
    /**
     * 事件上下文，解决按钮点击时没有上下文的问题
     * @type {?}
     */
    FarrisSectionComponent.prototype.context;
    /** @type {?} */
    FarrisSectionComponent.prototype.index;
    /** @type {?} */
    FarrisSectionComponent.prototype.toolbarPosition;
    /** @type {?} */
    FarrisSectionComponent.prototype.toolbarBtns;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype._toolbar;
    /** @type {?} */
    FarrisSectionComponent.prototype.toolbarDpHidden;
    /** @type {?} */
    FarrisSectionComponent.prototype.headerDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.headerTitleDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.headerContentDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.headerToolbarDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.extendDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.contentDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype.viewChangeDirective;
    /** @type {?} */
    FarrisSectionComponent.prototype._disableDatas;
    /** @type {?} */
    FarrisSectionComponent.prototype._visibleDatas;
    /** @type {?} */
    FarrisSectionComponent.prototype.clickThrottleTime;
    /** @type {?} */
    FarrisSectionComponent.prototype.toolbarContainer;
    /** @type {?} */
    FarrisSectionComponent.prototype.btnPlaceHolder;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.clickItems;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.clickSubscription;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.resizeEl;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.renderer;
    /** @type {?} */
    FarrisSectionComponent.prototype.inMoreButtonContents;
    /**
     * @type {?}
     * @private
     */
    FarrisSectionComponent.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VjdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNlY3Rpb24vIiwic291cmNlcyI6WyJsaWIvc2VjdGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQVFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsS0FBSyxFQUNMLFlBQVksRUFDWixXQUFXLEVBRVgsU0FBUyxFQUNULFFBQVEsRUFDUixNQUFNLEVBQ04sUUFBUSxFQUVSLFNBQVMsRUFDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUNsRixPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUNwRixPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUN4RixPQUFPLEVBQUUsNkJBQTZCLEVBQUUsZ0NBQWdDLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUN4SCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUNwRixPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUN0RixPQUFPLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBZ0IsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRTdELE9BQU8sY0FBYyxNQUFNLDBCQUEwQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxHQUFHLEVBQUUsWUFBWSxHQUFHLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEQ7SUFxSkUsZ0NBQWdDLE1BQWdCO1FBQWhCLFdBQU0sR0FBTixNQUFNLENBQVU7UUEvSXZDLGVBQVUsR0FBRyxFQUFFLENBQUM7UUFDTyxZQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ04sY0FBUyxHQUFZLEtBQUssQ0FBQzs7UUE0QjNELGVBQVUsR0FBRyxJQUFJLENBQUM7O1FBRWxCLG1CQUFjLEdBQUcsS0FBSyxDQUFDOzs7Ozs7OztR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NENBQXlCOztJQUN6Qix5Q0FBK0M7O0lBQy9DLDJDQUFvRTs7SUF3QnBFLDJDQUEyQjs7SUFFM0IsMENBQTBCOztJQUUxQiw0Q0FBMkI7O0lBRTNCLGdEQUFnQzs7Ozs7Ozs7O0lBT2hDLGlEQUE4Qjs7SUFFOUIsc0NBQXNCOztJQUV0Qiw4Q0FBNkI7Ozs7O0lBSTdCLHlDQUFzQjs7SUFDdEIsdUNBQW9COztJQUVwQixpREFBcUI7O0lBRXJCLDZDQUFpQjs7Ozs7SUFFakIsMENBQThDOztJQTRCOUMsaURBQXVCOztJQUV2QixpREFBaUU7O0lBRWpFLHNEQUFxRTs7SUFFckUsd0RBQTBFOztJQUUxRSx3REFBeUU7O0lBRXpFLGlEQUFpRTs7SUFFakUsa0RBQW1FOztJQUVuRSxxREFBeUU7O0lBS3pFLCtDQUE2RTs7SUFXN0UsK0NBQTZFOztJQVc3RSxtREFBaUM7O0lBR2pDLGtEQUFnRDs7SUFFaEQsZ0RBQTRDOzs7OztJQUU1Qyw0Q0FBd0M7Ozs7O0lBQ3hDLG1EQUF3Qzs7Ozs7SUFJeEMsb0NBQWtDOzs7OztJQUNsQywwQ0FBd0I7Ozs7O0lBRXhCLHdDQUFlOzs7OztJQUVmLDBDQUFpQjs7SUFDakIsc0RBQTBDOzs7OztJQUU5Qix3Q0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA4LTE0IDE1OjIyOjIxXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTA4LTE1IDE2OjQ0OjE1XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5pbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBPbkluaXQsXHJcbiAgSW5wdXQsXHJcbiAgQ29udGVudENoaWxkLFxyXG4gIEhvc3RCaW5kaW5nLFxyXG4gIE9uRGVzdHJveSxcclxuICBWaWV3Q2hpbGQsXHJcbiAgT3B0aW9uYWwsXHJcbiAgTmdab25lLFxyXG4gIEluamVjdG9yLFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgUmVuZGVyZXIyXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NlY3Rpb25UaXRsZURpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NlY3Rpb24tdGl0bGUuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2VjdGlvbkhlYWRlckRpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NlY3Rpb24taGVhZGVyLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NlY3Rpb25IY29udGVudERpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NlY3Rpb24taGNvbnRlbnQuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgRmFycmlzU2VjdGlvblRvb2xiYXJEaXJlY3RpdmUsIEZhcnJpc1NlY3Rpb25WaWV3Q2hhbmdlRGlyZWN0aXZlIH0gZnJvbSAnLi9kaXJlY3RpdmUvc2VjdGlvbi10b29sYmFyLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NlY3Rpb25FeHRlbmREaXJlY3RpdmUgfSBmcm9tICcuL2RpcmVjdGl2ZS9zZWN0aW9uLWV4dGVuZC5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBGYXJyaXNTZWN0aW9uQ29udGVudERpcmVjdGl2ZSB9IGZyb20gJy4vZGlyZWN0aXZlL3NlY3Rpb24tY29udGVudC5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBTdWJzY3JpcHRpb24sIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFRvb2xiYXJDb25maWcsIEJ1dHRvbkNvbmZpZyB9IGZyb20gJy4vdG9vbGJhci5jb25maWcnO1xyXG5pbXBvcnQgUmVzaXplT2JzZXJ2ZXIgZnJvbSAncmVzaXplLW9ic2VydmVyLXBvbHlmaWxsJztcclxuaW1wb3J0IHsgbWFwLCBkZWJvdW5jZVRpbWUsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhcnJpcy1zZWN0aW9uJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vc2VjdGlvbi5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vc2VjdGlvbi5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc1NlY3Rpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XHJcbiAgQElucHV0KCkgY29udGVudENscyA9ICcnO1xyXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZi1zZWN0aW9uJykgYmFzZUNscyA9IHRydWU7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mLXNlY3Rpb24tbWF4aW1pemUnKSBtYXhTdGF0dXM6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtc2VjdGlvbi1maWxsJykgZ2V0IGZpbGxDbHMoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5maWxsO1xyXG4gIH1cclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtc2VjdGlvbi1hY2NvcmRpb24nKVxyXG4gIGdldCBlbmFibGVBY2NvcmRpb25DbHMoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5lbmFibGVBY2NvcmRpb24gPT0gJ2RlZmF1bHQnO1xyXG4gIH1cclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtc3RhdGUtY29sbGFwc2UnKSBnZXQgZW5hYmxlQ29sbGFwc2VDbHMoKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuZW5hYmxlQWNjb3JkaW9uID09PSAnZGVmYXVsdCcgfHxcclxuICAgICAgdGhpcy5lbmFibGVBY2NvcmRpb24gPT09ICdjdXN0b20nXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuICF0aGlzLmV4cGFuZFN0YXR1cztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZi1zZWN0aW9uLWN1c3RvbS1hY2NvcmRpb24nKVxyXG4gIGdldCBlbmFibGVDdXN0b21BY2NvcmRpb25DbHMoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5lbmFibGVBY2NvcmRpb24gPT0gJ2N1c3RvbSc7XHJcbiAgfVxyXG4gIC8vIOS4u+agh+mimFxyXG4gIEBJbnB1dCgpIG1haW5UaXRsZTogc3RyaW5nO1xyXG4gIC8vIOWJr+agh+mimFxyXG4gIEBJbnB1dCgpIHN1YlRpdGxlOiBzdHJpbmc7XHJcbiAgLy8g5piv5ZCm5pi+56S6aGVhZGVyXHJcbiAgQElucHV0KCkgc2hvd0hlYWRlciA9IHRydWU7XHJcbiAgLy8g5piv5ZCm5pSv5oyB5pyA5aSn5YyWXHJcbiAgQElucHV0KCkgZW5hYmxlTWF4aW1pemUgPSBmYWxzZTtcclxuICAvKipcclxuICAgKiDmmK/lkKblkK/nlKjlj47mipjlip/og71cclxuICAgKiDpu5jorqTkuI3lkK/nlKjlj47mipgs5YC85Li6JydcclxuICAgKiDlkK/nlKjpu5jorqTlj47mipgs5YC85Li6J2RlZmF1bHQnXHJcbiAgICog5ZCv55So6Ieq5a6a5LmJ5Y+O5oqYLOWAvOS4uiAnY3VzdG9tJ1xyXG4gICAqKi9cclxuICBASW5wdXQoKSBlbmFibGVBY2NvcmRpb24gPSAnJztcclxuICAvLyBzZWN0aW9u5piv5ZCm6ZO65ruhXHJcbiAgQElucHV0KCkgZmlsbCA9IGZhbHNlO1xyXG4gIC8vIOm7mOiupOaYr+aYr+WQpuWxleW8gFxyXG4gIEBJbnB1dCgpIGV4cGFuZFN0YXR1cyA9IHRydWU7XHJcbiAgLyoqXHJcbiAgICog5LqL5Lu25LiK5LiL5paH77yM6Kej5Yaz5oyJ6ZKu54K55Ye75pe25rKh5pyJ5LiK5LiL5paH55qE6Zeu6aKYXHJcbiAgICovXHJcbiAgQElucHV0KCkgY29udGV4dDogYW55O1xyXG4gIEBJbnB1dCgpIGluZGV4OiBhbnk7XHJcbiAgLy8g5bCx5p2l5oyJ6ZKu5L2N572uXHJcbiAgdG9vbGJhclBvc2l0aW9uID0gJyc7XHJcbiAgLy9cclxuICB0b29sYmFyQnRucyA9IFtdO1xyXG4gIC8vIOW3peWFt+agj+aMiemSrlxyXG4gIHByaXZhdGUgX3Rvb2xiYXI6IFRvb2xiYXJDb25maWcgfCBudWxsID0gbnVsbDtcclxuICBASW5wdXQoKVxyXG4gIHNldCB0b29sYmFyKHZhbHVlOiBUb29sYmFyQ29uZmlnIHwgbnVsbCkge1xyXG4gICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgIHRoaXMuX3Rvb2xiYXIgPSB2YWx1ZTtcclxuICAgICAgLy8g6K6h566X5L2N572uXHJcbiAgICAgIHRoaXMudG9vbGJhclBvc2l0aW9uID0gdGhpcy5nZXRUb29sYmFyUG9zaXRpb24oKTtcclxuICAgICAgLy9cclxuICAgICAgdGhpcy50b29sYmFyQnRucyA9IFsuLi50aGlzLnRvb2xiYXIuY29udGVudHNdO1xyXG4gICAgICB0aGlzLmluTW9yZUJ1dHRvbkNvbnRlbnRzID0gW107XHJcbiAgICAgIC8vIOe7keWumuS6i+S7tlxyXG4gICAgICB0aGlzLmJpbmRSZXNpemVFdmVudCgpO1xyXG4gICAgICAvLyDosIPmlbTnlYzpnaJcclxuICAgICAgdGhpcy5hZnRlckJpbmRUb29sYmFyRGF0YSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fdG9vbGJhciA9IG51bGw7XHJcbiAgICAgIC8vIOacieS9jee9rlxyXG4gICAgICB0aGlzLnRvb2xiYXJQb3NpdGlvbiA9ICcnO1xyXG4gICAgICB0aGlzLnRvb2xiYXJCdG5zID0gW107XHJcbiAgICAgIHRoaXMuaW5Nb3JlQnV0dG9uQ29udGVudHMgPSBbXTtcclxuICAgICAgLy8g56e76Zmk57uR5a6a5LqL5Lu2XHJcbiAgICAgIHRoaXMudW5CaW5kUmVzaXplRXZlbnQoKTtcclxuICAgIH1cclxuICB9XHJcbiAgZ2V0IHRvb2xiYXIoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdG9vbGJhcjtcclxuICB9XHJcbiAgLy/moIforrDmjInpkq7lt6XlhbfmoI/mmK/lkKbpmpDol49b5pu05aSaXeaMiemSrlxyXG4gIHRvb2xiYXJEcEhpZGRlbiA9IHRydWU7XHJcbiAgLy8gc2VjdGlvbuWktOmDqOaooeadv1xyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2VjdGlvbkhlYWRlckRpcmVjdGl2ZSkgaGVhZGVyRGlyZWN0aXZlOiBhbnk7XHJcbiAgLy8gc2VjdGlvbuWktOmDqOagh+mimOWMuuaooeadv1xyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2VjdGlvblRpdGxlRGlyZWN0aXZlKSBoZWFkZXJUaXRsZURpcmVjdGl2ZTogYW55O1xyXG4gIC8vc2VjdGlvbuWktOmDqOWPr+aJqeWxleWMuuWfn+aooeadv1xyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2VjdGlvbkhjb250ZW50RGlyZWN0aXZlKSBoZWFkZXJDb250ZW50RGlyZWN0aXZlOiBhbnk7XHJcbiAgLy9zZWN0aW9u5aS06YOo5bel5YW35qCP5Yy65Z+f5qih5p2/XHJcbiAgQENvbnRlbnRDaGlsZChGYXJyaXNTZWN0aW9uVG9vbGJhckRpcmVjdGl2ZSkgaGVhZGVyVG9vbGJhckRpcmVjdGl2ZTogYW55O1xyXG4gIC8vc2VjdGlvbuWPr+aJqeWxleWMuuWfn+aooeadv+KAlOKAlOWGheWuueWMuuS4iumdoueahOaJqeWxle+8jOagh+mimOS4i+mdolxyXG4gIEBDb250ZW50Q2hpbGQoRmFycmlzU2VjdGlvbkV4dGVuZERpcmVjdGl2ZSkgZXh0ZW5kRGlyZWN0aXZlOiBhbnk7XHJcbiAgLy9zZWN0aW9u5YaF5a655Yy65Z+f5qih5p2/XHJcbiAgQENvbnRlbnRDaGlsZChGYXJyaXNTZWN0aW9uQ29udGVudERpcmVjdGl2ZSkgY29udGVudERpcmVjdGl2ZTogYW55O1xyXG4gIC8vc2VjdGlvbuWktOmDqFZpZXdDaGFuZ2XljLrln5/mqKHmnb9cclxuICBAQ29udGVudENoaWxkKEZhcnJpc1NlY3Rpb25WaWV3Q2hhbmdlRGlyZWN0aXZlKSB2aWV3Q2hhbmdlRGlyZWN0aXZlOiBhbnk7XHJcblxyXG4gIC8vIOWPgueFp1RhYuS4rei/meagt+eahOWkhOeQhuaWueW8j+aciemXrumimC0tLS3lu7blkI7kv67mlLlcclxuICAvLyDmmK/lkKbooqvnpoHnlKjnmoTnirbmgIFcclxuICAvLyDmjInnhafkuYvliY3nmoTpgLvovpHvvIzlpoLmnpzmsqHmnInmib7liLBrZXnvvIzlsLHor7TmmI7ooqvnpoHnlKhcclxuICBfZGlzYWJsZURhdGFzOiBPYnNlcnZhYmxlPEFycmF5PHsgW2tleTogc3RyaW5nXTogYm9vbGVhbiB9Pj4gPSBuZXcgU3ViamVjdCgpO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IGJ0blN0YXRlcyh2YWx1ZXM6IE9ic2VydmFibGU8QXJyYXk8eyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0+Pikge1xyXG4gICAgaWYgKHZhbHVlcykge1xyXG4gICAgICBpZiAodGhpcy5fZGlzYWJsZURhdGFzJiZ0aGlzLl9kaXNhYmxlRGF0YXMuaGFzT3duUHJvcGVydHkoJ3Vuc3Vic2NyaWJlJykpIHtcclxuICAgICAgICB0aGlzLl9kaXNhYmxlRGF0YXNbJ3Vuc3Vic2NyaWJlJ10oKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLl9kaXNhYmxlRGF0YXMgPSB2YWx1ZXM7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIOaMieeFp+S5i+WJjeeahOmAu+i+ke+8jOWmguaenOayoeacieaJvuWIsGtlee+8jOWwseivtOaYjuWPr+ingVxyXG4gIF92aXNpYmxlRGF0YXM6IE9ic2VydmFibGU8QXJyYXk8eyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0+PiA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgLy8g5piv5ZCm5Y+v6KeB55qE54q25oCBXHJcbiAgQElucHV0KClcclxuICBzZXQgYnRuVmlzaWJsZSh2YWx1ZXM6IE9ic2VydmFibGU8QXJyYXk8eyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0+Pikge1xyXG4gICAgaWYgKHZhbHVlcykge1xyXG4gICAgICBpZiAodGhpcy5fdmlzaWJsZURhdGFzJiZ0aGlzLl92aXNpYmxlRGF0YXMuaGFzT3duUHJvcGVydHkoJ3Vuc3Vic2NyaWJlJykpIHtcclxuICAgICAgICB0aGlzLl92aXNpYmxlRGF0YXNbJ3Vuc3Vic2NyaWJlJ10oKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLl92aXNpYmxlRGF0YXMgPSB2YWx1ZXM7XHJcbiAgICB9XHJcbiAgfVxyXG4gIEBJbnB1dCgpIGNsaWNrVGhyb3R0bGVUaW1lID0gMzUwO1xyXG5cclxuICAvLyDpgJrov4fmjInpkq7mlbDnu4TmmL7npLrlt6XlhbfmoI9cclxuICBAVmlld0NoaWxkKCd0b29sYmFyQ29udGFpbmVyJykgdG9vbGJhckNvbnRhaW5lcjtcclxuICAvLyDorqHnrpflt6XlhbfmoI/mjInpkq7lrr3luqbnmoTovoXliqnljLrln59cclxuICBAVmlld0NoaWxkKCdidG5QbGFjZWhvbGRlcicpIGJ0blBsYWNlSG9sZGVyO1xyXG5cclxuICBwcml2YXRlIGNsaWNrSXRlbXMgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgcHJpdmF0ZSBjbGlja1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG4gIC8vIOeUqOS6juaPkOS+m+W+queOr+aViOeOh1xyXG4gIHRyYWNrQnlCdXR0b24oaW5kZXg6IG51bWJlciwgYnRuOiBhbnkpOiBudW1iZXIgeyByZXR1cm4gYnRuLmlkOyB9XHJcbiAgLy8g55So5LqO6K6h566X5ZON5bqU5pe2XHJcbiAgcHJpdmF0ZSBybzogUmVzaXplT2JzZXJ2ZXIgPSBudWxsO1xyXG4gIHByaXZhdGUgcmVzaXplRWwgPSBudWxsO1xyXG4gIC8vIOWkhOeQhuWPmOWMllxyXG4gIHByaXZhdGUgbmdab25lO1xyXG4gIC8vXHJcbiAgcHJpdmF0ZSByZW5kZXJlcjtcclxuICBpbk1vcmVCdXR0b25Db250ZW50czogQnV0dG9uQ29uZmlnW10gPSBbXTtcclxuXHJcbiAgY29uc3RydWN0b3IoQE9wdGlvbmFsKCkgcHJpdmF0ZSBpbmplY3Q6IEluamVjdG9yKSB7XHJcbiAgICBpZiAodGhpcy5pbmplY3QpIHtcclxuICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdC5nZXQoTmdab25lLCBudWxsKTtcclxuICAgICAgdGhpcy5yZW5kZXJlciA9IHRoaXMuaW5qZWN0LmdldChSZW5kZXJlcjIsIG51bGwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICAvLyDmoIforrDngrnlh7vkuovku7ZcclxuICAgIHRoaXMuY2xpY2tTdWJzY3JpcHRpb24gPSB0aGlzLmNsaWNrSXRlbXMucGlwZShkZWJvdW5jZVRpbWUodGhpcy5jbGlja1Rocm90dGxlVGltZSkpXHJcbiAgICAgIC5zdWJzY3JpYmUoKGJ0bkluZm86IEJ1dHRvbkNvbmZpZykgPT4ge1xyXG4gICAgICAgIGlmIChidG5JbmZvLmNsaWNrICYmIHR5cGVvZiBidG5JbmZvLmNsaWNrID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgIGJ0bkluZm8uY2xpY2soeyBjb250ZXh0OiB0aGlzLmNvbnRleHQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIC8vIOe7keWumueKtuaAgVxyXG4gICAgdGhpcy5fZGlzYWJsZURhdGFzLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgLy8g6LCD5pW05oyJ6ZKu5Y+v55So54q25oCBXHJcbiAgICAgIHRoaXMuY2hhbmdlU3RhdGUoZGF0YSwnZGlzYWJsZScpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl92aXNpYmxlRGF0YXMuc3Vic2NyaWJlKGRhdGE9PntcclxuICAgICAgICAvLyDosIPmlbTmjInpkq7lj6/op4HnirbmgIFcclxuICAgICAgICB0aGlzLmNoYW5nZVN0YXRlKGRhdGEsJ3Zpc2libGUnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5bmjInpkq7phY3nva7kuK3vvIznpoHnlKjjgIHlj6/op4HnmoTlsZ7mgKdcclxuICAgKiBAcGFyYW0gaWQgXHJcbiAgICogQHBhcmFtIHN0YXRlUHJvcCBcclxuICAgKi9cclxuICBnZXRTdGF0ZShidG5JdGVtLHN0YXRlUHJvcCl7XHJcbiAgICBpZihidG5JdGVtLmhhc093blByb3BlcnR5KHN0YXRlUHJvcCkpe1xyXG4gICAgICByZXR1cm4gYnRuSXRlbVtzdGF0ZVByb3BdO1xyXG4gICAgfVxyXG4gICAgLy8g5LiN5a2Y5Zyo5bGe5oCnXHJcbiAgICBpZihzdGF0ZVByb3A9PSd2aXNpYmxlJyl7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmlLnlj5jlj6/nlKjnirbmgIFcclxuICAgKiBAcGFyYW0gdmFsdWVzIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgY2hhbmdlU3RhdGUodmFsdWVzLHN0YXRlUHJvcCl7XHJcbiAgICBjb25zdCBpZEFycmF5ID0gT2JqZWN0LmtleXModmFsdWVzKTtcclxuICAgIGlkQXJyYXkuZm9yRWFjaChpZCA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB2YWx1ZXNbaWRdO1xyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLl9maW5kSXRlbUJ5SUQoaWQsIHRoaXMudG9vbGJhckJ0bnMpO1xyXG4gICAgICAgIGlmKGl0ZW0pe1xyXG4gICAgICAgICAgICAgaXRlbVtzdGF0ZVByb3BdID0gc3RhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLmluTW9yZUJ1dHRvbkNvbnRlbnRzLmZvckVhY2goaXRlbT0+e1xyXG4gICAgICAgIGNvbnN0IGZpbmRJZD1pZEFycmF5LmZpbmQoaWQ9PmlkPT1pdGVtLmlkKTtcclxuICAgICAgICBpZihmaW5kSWQpe1xyXG4gICAgICAgICAgaXRlbVtzdGF0ZVByb3BdPXZhbHVlc1tmaW5kSWRdO1xyXG4gICAgICAgIH1cclxuICAgIH0pOyAgICBcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOafpeaJvlxyXG4gICAqIEBwYXJhbSBpZCBcclxuICAgKiBAcGFyYW0gZGF0YXMgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBfZmluZEl0ZW1CeUlEKGlkOnN0cmluZyxkYXRhczpCdXR0b25Db25maWdbXSl7XHJcbiAgICByZXR1cm4gIGRhdGFzLmZpbmQoKGl0ZW0pID0+IGl0ZW0uaWQ9PWlkKTtcclxuICB9XHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICBpZiAodGhpcy5jbGlja1N1YnNjcmlwdGlvbikge1xyXG4gICAgICB0aGlzLmNsaWNrU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIHRoaXMuY2xpY2tTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuX3Zpc2libGVEYXRhcyYmdGhpcy5fdmlzaWJsZURhdGFzLmhhc093blByb3BlcnR5KCd1bnN1YnNjcmliZScpKSB7XHJcbiAgICAgIHRoaXMuX3Zpc2libGVEYXRhc1sndW5zdWJzY3JpYmUnXSgpO1xyXG4gICAgICB0aGlzLl92aXNpYmxlRGF0YXM9bnVsbDtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLl9kaXNhYmxlRGF0YXMmJnRoaXMuX2Rpc2FibGVEYXRhcy5oYXNPd25Qcm9wZXJ0eSgndW5zdWJzY3JpYmUnKSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlRGF0YXNbJ3Vuc3Vic2NyaWJlJ10oKTtcclxuICAgICAgdGhpcy5fZGlzYWJsZURhdGFzPW51bGw7XHJcbiAgICB9XHJcbiAgICB0aGlzLnVuQmluZFJlc2l6ZUV2ZW50KCk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOe7keWumumZkOWItlxyXG4gICAqL1xyXG4gIHByaXZhdGUgYmluZFJlc2l6ZUV2ZW50KCkge1xyXG4gICAgLy8g5qCH6K6w5ZON5bqU5pe2XHJcbiAgICBpZiAodGhpcy5uZ1pvbmUgJiYgdGhpcy50b29sYmFyICYmIHRoaXMudG9vbGJhci5jb250ZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIGlmICghdGhpcy50b29sYmFyQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICh0aGlzLnJvKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRvb2xiYXJDb250YWluZXIubmF0aXZlRWxlbWVudC5wYXJlbnRFbGVtZW50ID09IHRoaXMucmVzaXplRWwpIHtcclxuICAgICAgICAgICAgICAvLyDlt7Lnu5Hlrprov4dcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy51bkJpbmRSZXNpemVFdmVudCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAodGhpcy5ybyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlbCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZVRvb2xiYXJEcm9wZG93bklzU2hvdygpO1xyXG4gICAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZUJ1dHRvbnNTaG93KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZUVsID0gdGhpcy50b29sYmFyQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgdGhpcy5yby5vYnNlcnZlKHRoaXMucmVzaXplRWwpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudW5CaW5kUmVzaXplRXZlbnQoKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog5oyJ6ZKu5pWw5o2u5Y+Y5pu05ZCO6Kem5Y+R5qOA5p+lXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhZnRlckJpbmRUb29sYmFyRGF0YSgpIHtcclxuICAgIGlmICh0aGlzLm5nWm9uZSAmJiB0aGlzLnRvb2xiYXIgJiYgdGhpcy50b29sYmFyLmNvbnRlbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fY2FsY3VsYXRlVG9vbGJhckRyb3Bkb3duSXNTaG93KCk7XHJcbiAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVCdXR0b25zU2hvdygpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiDliKTmlq3kuIvmi4nmjInpkq7mmK/lkKbmmL7npLpcclxuICAgKi9cclxuICBwcml2YXRlIF9jYWxjdWxhdGVUb29sYmFyRHJvcGRvd25Jc1Nob3coKSB7XHJcbiAgICBpZiAoIXRoaXMudG9vbGJhckNvbnRhaW5lciB8fCAhdGhpcy50b29sYmFyIHx8ICF0aGlzLnRvb2xiYXJQb3NpdGlvbikge1xyXG4gICAgICAvLyDlrrnlmajmnKrmmL7npLrvvIzmsqHmnInmlbDmja7vvIzmsqHmnInmjInpkq7kvY3nva5cclxuICAgICAgdGhpcy50b29sYmFyRHBIaWRkZW4gPSB0cnVlO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBidG5QYXJlbnRzQ29udGFpbmVyID0gdGhpcy50b29sYmFyQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgIGlmICh0aGlzLmJ0blBsYWNlSG9sZGVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggPiBidG5QYXJlbnRzQ29udGFpbmVyLm9mZnNldFdpZHRoKSB7XHJcbiAgICAgIHRoaXMudG9vbGJhckRwSGlkZGVuID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnRvb2xiYXJEcEhpZGRlbiA9IHRydWU7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiDorqHnrpfmmL7npLrnmoTmjInpkq7kuKrmlbDlj4rmm7TlpJrkuK3mmL7npLrnmoTmjInpkq7kuKrmlbBcclxuICAgKi9cclxuICBwcml2YXRlIF9jYWxjdWxhdGVCdXR0b25zU2hvdygpIHtcclxuXHJcbiAgICBpZiAoIXRoaXMudG9vbGJhckNvbnRhaW5lciB8fCAhdGhpcy50b29sYmFyIHx8ICF0aGlzLnRvb2xiYXJQb3NpdGlvbikge1xyXG4gICAgICAvLyDlrrnlmajmnKrmmL7npLrvvIzmsqHmnInmlbDmja7vvIzmsqHmnInmjInpkq7kvY3nva5cclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudG9vbGJhckRwSGlkZGVuKSB7XHJcbiAgICAgIHRoaXMudG9vbGJhckJ0bnMgPSBbLi4udGhpcy50b29sYmFyLmNvbnRlbnRzXTtcclxuICAgICAgdGhpcy5pbk1vcmVCdXR0b25Db250ZW50cyA9IFtdO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgdG9vbGJhclBhcmVudENvbnRhaW5lckVsID0gdGhpcy50b29sYmFyQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgIGxldCBkaXZFbCA9IHRoaXMudG9vbGJhckNvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgbGV0IGJ0blBsYWNlSG9sZGVyRWwgPSB0aGlzLmJ0blBsYWNlSG9sZGVyLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICBsZXQgYnRuUGxhY2VIb2xkZXJCdG5zID0gYnRuUGxhY2VIb2xkZXJFbC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKTtcclxuXHJcbiAgICAvLyDmm7TlpJrmjInpkq5cclxuICAgIGNvbnN0IG1vcmVCdXR0b24gPSB0b29sYmFyUGFyZW50Q29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1vcmVidG4nKTtcclxuICAgIC8vIOiuoeeul+aMiemSrueahOWuveW6piAgICAgIFxyXG4gICAgbGV0IGJhc2ljU3RhcnQgPSBwYXJzZUludChidG5QbGFjZUhvbGRlckVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQpO1xyXG4gICAgbGV0IGJhc2ljV2lkdGggPSB0b29sYmFyUGFyZW50Q29udGFpbmVyRWwub2Zmc2V0V2lkdGggLSBtb3JlQnV0dG9uLm9mZnNldFdpZHRoIC0gMTI7XHJcbiAgICBsZXQgdG9vbGJhckRyb3Bkb3duSGlkZGVuID0gdHJ1ZTtcclxuICAgIGxldCBrID0gMFxyXG4gICAgLy8g5Y+q5pyJ5LiA5Liq5oyJ6ZKuXHJcbiAgICBpZiAoYnRuUGxhY2VIb2xkZXJCdG5zLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgIGlmIChidG5QbGFjZUhvbGRlckVsLm9mZnNldFdpZHRoID4gYmFzaWNXaWR0aCkge1xyXG4gICAgICAgIHRvb2xiYXJEcm9wZG93bkhpZGRlbiA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGsgPSAxO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmb3IgKGsgPSAxOyBrIDw9IGJ0blBsYWNlSG9sZGVyQnRucy5sZW5ndGggLSAxOyBrKyspIHtcclxuICAgICAgICAvLyDlpoLmnpzlhoXlrrnotoXlh7os6ICD6JmR5Yiw5oyJ6ZKu5LmL6Ze055qE6Ze06LedXHJcbiAgICAgICAgaWYgKGsgPT0gYnRuUGxhY2VIb2xkZXJCdG5zLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgIGlmIChidG5QbGFjZUhvbGRlckVsLm9mZnNldFdpZHRoID4gYmFzaWNXaWR0aCkge1xyXG4gICAgICAgICAgICB0b29sYmFyRHJvcGRvd25IaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgayA9IGsgLSAxO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHBhcnNlSW50KGJ0blBsYWNlSG9sZGVyQnRuc1trXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0KSAtIGJhc2ljU3RhcnQgPiBiYXNpY1dpZHRoKSB7XHJcbiAgICAgICAgICB0b29sYmFyRHJvcGRvd25IaWRkZW4gPSBmYWxzZTtcclxuICAgICAgICAgIGsgPSBrIC0gMTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudG9vbGJhckRwSGlkZGVuID0gdG9vbGJhckRyb3Bkb3duSGlkZGVuO1xyXG4gICAgbGV0IHNob3dCdG5zID0gZGl2RWwucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJyk7XHJcbiAgICBsZXQgcmVzdWx0QnRucyA9IHRoaXMudG9vbGJhci5jb250ZW50cy5maWx0ZXIoXHJcbiAgICAgIChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBpbmRleCA8IGs7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgICB0aGlzLnRvb2xiYXJCdG5zID0gcmVzdWx0QnRucyA/IFsuLi5yZXN1bHRCdG5zXSA6IFtdO1xyXG4gICAgLy8gZm9yIChsZXQgbSA9IGs7IG0gPCBzaG93QnRucy5sZW5ndGg7IG0rKykge1xyXG4gICAgLy8gICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoc2hvd0J0bnNbbV0sICdkaXNwbGF5JywgJ25vbmUnKTtcclxuICAgIC8vIH1cclxuICAgIGlmICh0aGlzLnRvb2xiYXIuY29udGVudHMgJiYgdGhpcy50b29sYmFyLmNvbnRlbnRzLmxlbmd0aCkge1xyXG4gICAgICB0aGlzLmluTW9yZUJ1dHRvbkNvbnRlbnRzID0gdGhpcy50b29sYmFyLmNvbnRlbnRzLmZpbHRlcihcclxuICAgICAgICAoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBpbmRleCA+PSBrO1xyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Zyo5oyJ6ZKu54q25oCB5Y+Y5YyW5pe26Kej6Zmk6ZmQ5Yi2XHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1bkJpbmRSZXNpemVFdmVudCgpIHtcclxuICAgIGlmICh0aGlzLnJvKSB7XHJcbiAgICAgIGlmICh0aGlzLnJlc2l6ZUVsKSB7XHJcbiAgICAgICAgdGhpcy5yby51bm9ic2VydmUodGhpcy5yZXNpemVFbCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5ybyA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4gc3RyaW5nIFxyXG4gICAqICcnIOS4jeWtmOWcqOaMiemSru+8jOaXoOaJgOiwk+S9jee9rlxyXG4gICAqICdpbkhlYWQnIOaMiemSruWcqOWktOmDqFxyXG4gICAqICdpbkNvbnRlbnQnIOaMiemSruWcqOWGheWuueS9jee9rlxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0VG9vbGJhclBvc2l0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMudG9vbGJhciAmJiB0aGlzLnRvb2xiYXIuaGFzT3duUHJvcGVydHkoJ3Bvc2l0aW9uJykgJiYgdGhpcy50b29sYmFyLmhhc093blByb3BlcnR5KCdjb250ZW50cycpICYmIHRoaXMudG9vbGJhci5jb250ZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIC8vIOWmguaenOacieWxnuaAp++8jOS4lOaMiemSruacieWAvFxyXG4gICAgICBpZiAodGhpcy50b29sYmFyLnBvc2l0aW9uID09PSAnaW5IZWFkJykge1xyXG4gICAgICAgIHJldHVybiAnaW5IZWFkJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJ2luQ29udGVudCc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Yik5pat5piv5ZCm5pi+56S644CB6ZqQ6JePXHJcbiAgICogQHBhcmFtIGlkIFxyXG4gICAqIEBwYXJhbSBzdGF0ZSBcclxuICAgKi9cclxuICBnZXRUb29sYmFyU3RhdGUoaWQ6IHN0cmluZywgc3RhdGU6IE9ic2VydmFibGU8YW55PiA9IHRoaXMuYnRuU3RhdGVzLCBkZWZhdWx0VmFsdWU6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG4gICAgaWYgKHN0YXRlKSB7XHJcbiAgICAgIHJldHVybiBzdGF0ZS5waXBlKFxyXG4gICAgICAgIG1hcCgobjogYW55KSA9PiB7XHJcbiAgICAgICAgICBpZiAobltpZF0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLndhcm4oYOacquaJvklE5Li677yaJHtpZH0g55u45YWz54q25oCB6K6+572u77yBYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gbltpZF07XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBvZihkZWZhdWx0VmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuICBjbGlja0hhbmRsZXIoYnRuSW5mbykge1xyXG4gICAgaWYgKCFidG5JbmZvKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuY2xpY2tJdGVtcy5uZXh0KGJ0bkluZm8pO1xyXG5cclxuICB9XHJcbn1cclxuIl19