import { Injectable, Injector } from "@angular/core";
import { AppContext, Repository } from "@farris/devkit";
var FormService = /** @class */ (function () {
    function FormService(injector, appContext, repository) {
        this.injector = injector;
        this.appContext = appContext;
        this.repository = repository;
    }
    /**
     * 根据字段路径获取该字段在卡片或表格中的索引
     * @param source ngFormControls或any[][]
     * @param propertyPath 字段除bindingPath之外的完整路径
     * @returns
     */
    FormService.prototype.getIndex = function (source, propertyPath) {
        if (Array.isArray(source)) {
            var combine = source.reduce(function (result, group) {
                return result.concat(group);
            }, []);
            return combine.findIndex(function (item) { return item.field === propertyPath; });
        }
        else if (Object.prototype.toString.call(source) === '[object Object]') {
            return Object.keys(source).findIndex(function (key) { return source[key].binding === propertyPath; });
        }
    };
    FormService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FormService.ctorParameters = function () { return [
        { type: Injector },
        { type: AppContext },
        { type: Repository }
    ]; };
    return FormService;
}());
export { FormService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL2Zvcm0uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQUUsVUFBVSxFQUFtRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV6SDtJQUVFLHFCQUNVLFFBQWtCLEVBQ2xCLFVBQXNCLEVBQ3RCLFVBQThCO1FBRjlCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtJQUV4QyxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSw4QkFBUSxHQUFmLFVBQWdCLE1BQXlELEVBQUUsWUFBb0I7UUFDN0YsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ3pCLElBQU0sT0FBTyxHQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBQyxNQUFhLEVBQUUsS0FBWTtnQkFDL0QsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNQLE9BQU8sT0FBTyxDQUFDLFNBQVMsQ0FBQyxVQUFDLElBQVMsSUFBSyxPQUFBLElBQUksQ0FBQyxLQUFLLEtBQUssWUFBWSxFQUEzQixDQUEyQixDQUFDLENBQUM7U0FDdEU7YUFBTSxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxpQkFBaUIsRUFBRTtZQUN2RSxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sS0FBSyxZQUFZLEVBQXBDLENBQW9DLENBQUMsQ0FBQztTQUNuRjtJQUNILENBQUM7O2dCQXZCRixVQUFVOzs7O2dCQUhVLFFBQVE7Z0JBQ3BCLFVBQVU7Z0JBQW1FLFVBQVU7O0lBMkJoRyxrQkFBQztDQUFBLEFBekJELElBeUJDO1NBeEJZLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3RvciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBBcHBDb250ZXh0LCBEYXRhUHJvcEluZm8sIERhdGFUeXBlSW5mbywgRW50aXR5LCBGcmFtZUNvbnRleHQsIE5nRm9ybUNvbnRyb2wsIFJlcG9zaXRvcnkgfSBmcm9tIFwiQGZhcnJpcy9kZXZraXRcIjtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEZvcm1TZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgcHJpdmF0ZSBhcHBDb250ZXh0OiBBcHBDb250ZXh0LFxuICAgIHByaXZhdGUgcmVwb3NpdG9yeTogUmVwb3NpdG9yeTxFbnRpdHk+XG4gICkge1xuICB9XG4gIC8qKlxuICAgKiDmoLnmja7lrZfmrrXot6/lvoTojrflj5bor6XlrZfmrrXlnKjljaHniYfmiJbooajmoLzkuK3nmoTntKLlvJVcbiAgICogQHBhcmFtIHNvdXJjZSBuZ0Zvcm1Db250cm9sc+aIlmFueVtdW11cbiAgICogQHBhcmFtIHByb3BlcnR5UGF0aCDlrZfmrrXpmaRiaW5kaW5nUGF0aOS5i+WklueahOWujOaVtOi3r+W+hFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIHB1YmxpYyBnZXRJbmRleChzb3VyY2U6IHsgW3Byb3BlcnR5TmFtZTogc3RyaW5nXTogTmdGb3JtQ29udHJvbCB9IHwgYW55W10sIHByb3BlcnR5UGF0aDogc3RyaW5nKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlKSkge1xuICAgICAgY29uc3QgY29tYmluZTogYW55W10gPSBzb3VyY2UucmVkdWNlKChyZXN1bHQ6IGFueVtdLCBncm91cDogYW55W10pID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jb25jYXQoZ3JvdXApO1xuICAgICAgfSwgW10pO1xuICAgICAgcmV0dXJuIGNvbWJpbmUuZmluZEluZGV4KChpdGVtOiBhbnkpID0+IGl0ZW0uZmllbGQgPT09IHByb3BlcnR5UGF0aCk7XG4gICAgfSBlbHNlIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc291cmNlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzb3VyY2UpLmZpbmRJbmRleChrZXkgPT4gc291cmNlW2tleV0uYmluZGluZyA9PT0gcHJvcGVydHlQYXRoKTtcbiAgICB9XG4gIH1cbiAgXG59Il19