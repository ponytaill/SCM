/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-09-04 07:40:04
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-09-04 15:21:46
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Injectable } from '@angular/core';
import { KeyCode, KeyName, ShowType } from '../enums/public-api';
import { D, DD, M, MM, MMM, YYYY, SU, MO, TU, WE, TH, FR, SA, ZERO_STR, EMPTY_STR } from '../constants/constants';
export class UtilService {
    constructor() {
        this.weekDays = [SU, MO, TU, WE, TH, FR, SA];
    }
    /**
     * @param {?} dateStr
     * @param {?} options
     * @param {?=} isReturn
     * @return {?}
     */
    isDateValid(dateStr, options, isReturn = false) {
        // tslint:disable-next-line:one-variable-per-declaration
        /** @type {?} */
        let _dateStr;
        /** @type {?} */
        let hour = 0;
        /** @type {?} */
        let minute = 0;
        /** @type {?} */
        let second = 0;
        /** @type {?} */
        const returnDate = this.resetDate();
        if (!dateStr || !dateStr.length) {
            return returnDate;
        }
        const { dateFormat, minYear, maxYear, monthLabels, showTime, returnFormat, showType } = options;
        /** @type {?} */
        let _st = showTime;
        /** @type {?} */
        let formatStr = dateFormat;
        if (isReturn) {
            formatStr = returnFormat.replace(/[年,月]/g, '-').replace(/[日]/, '').replace(/[时,分]/g, ':').replace(/[秒]/g, '');
            dateStr = dateStr.replace(/[年,月]/g, '-').replace(/[日]/, '').replace(/[时,分]/g, ':').replace(/[秒]/g, '');
            if (dateStr[dateStr.length - 1] === '-' || dateStr[dateStr.length - 1] === ':') {
                dateStr = dateStr.substring(0, dateStr.length - 1);
            }
            if (!showTime && returnFormat.toLocaleLowerCase().indexOf('hh:mm') > -1) {
                _st = true;
            }
        }
        /** @type {?} */
        const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        /** @type {?} */
        const isMonthStr = formatStr.indexOf(MMM) !== -1;
        /** @type {?} */
        let delimeters = formatStr.match(/[^(DdMmYy)]{1,}/g);
        if (_st && dateStr) {
            _dateStr = dateStr.split(' ')[0];
            Object.assign(returnDate, { hour: 0, minute: 0, second: 0 });
            /** @type {?} */
            const timeStr = dateStr.split(' ')[1];
            if (timeStr) {
                /** @type {?} */
                const _timer = timeStr.replace('时', ':').replace('分', ':').replace('秒', '').split(':');
                if (_timer[0]) {
                    hour = Number(_timer[0].substr(0, 2));
                    hour = isNaN(hour) ? 0 : hour;
                }
                if (_timer[1]) {
                    minute = Number(_timer[1].substr(0, 2));
                    minute = isNaN(minute) ? 0 : minute;
                }
                if (_timer[2]) {
                    second = Number(_timer[2].substr(0, 2));
                    second = isNaN(second) ? 0 : second;
                }
            }
            else {
                delimeters = undefined;
                /** @type {?} */
                const reg = /^\d{1,}$/;
                if (reg.test(dateStr)) { // 验证传入的格式为 yyyyMMddHHmmss
                    // 验证传入的格式为 yyyyMMddHHmmss
                    /** @type {?} */
                    const df = formatStr;
                    _dateStr = dateStr.substr(0, 8);
                    /** @type {?} */
                    let _timer = dateStr.substr(8);
                    if (_timer) {
                        if (df.includes('HH')) {
                            if (_timer) {
                                hour = +_timer.slice(0, 2);
                                _timer = _timer.slice(2);
                            }
                        }
                        if (df.includes('mm')) {
                            if (_timer) {
                                minute = +_timer.slice(0, 2);
                                _timer = _timer.slice(2);
                            }
                        }
                        if (df.includes('ss')) {
                            if (_timer) {
                                second = +_timer.slice(0, 2);
                            }
                        }
                    }
                }
            }
        }
        else {
            _dateStr = dateStr ? dateStr.split(' ')[0] : '';
        }
        /** @type {?} */
        const dateValue = this.getDateValue(_dateStr, formatStr, delimeters);
        /** @type {?} */
        const year = this.getNumberByValue(dateValue[0]);
        /** @type {?} */
        const month = isMonthStr
            ? this.getMonthNumberByMonthName(dateValue[1], monthLabels)
            : this.getNumberByValue(dateValue[1]);
        /** @type {?} */
        const day = this.getNumberByValue(dateValue[2]);
        if (showType === ShowType.noDateAndMonth) {
            return { year, month: 1, day: 1 };
        }
        if (month !== -1 && day !== -1 && year !== -1) {
            if (year < minYear || year > maxYear || month < 1 || month > 12) {
                return returnDate;
            }
            /** @type {?} */
            const date = _st ? { year, month, day, hour, minute, second } : { year, month, day };
            if (this.isDisabledDate(date, options)) {
                return returnDate;
            }
            if (year % 400 === 0 || (year % 100 !== 0 && year % 4 === 0)) {
                daysInMonth[1] = 29;
            }
            if (day < 1 || day > daysInMonth[month - 1]) {
                return returnDate;
            }
            // Valid date
            if (options.showType === ShowType.noDate) {
                return { year: date.year, month: date.month };
            }
            else if (options.showType === ShowType.noDateAndMonth) {
                return { year: date.year };
            }
            else {
                return date;
            }
        }
        return returnDate;
    }
    /**
     * @param {?} dateRangeStr
     * @param {?} options
     * @return {?}
     */
    isDateValidDateRange(dateRangeStr, options) {
        /** @type {?} */
        let dateRange = {
            begin: this.resetDate(),
            end: this.resetDate()
        };
        if (dateRangeStr && dateRangeStr.length) {
            /** @type {?} */
            const dates = dateRangeStr.split(options.dateRangeDatesDelimiter);
            if (dates && dates.length === 2) {
                const [beginDate, endDate] = dates;
                /** @type {?} */
                const begin = this.isDateValid(beginDate, options, true);
                if (this.isInitializedDate(begin)) {
                    /** @type {?} */
                    const end = this.isDateValid(endDate, options, true);
                    if (this.isInitializedDate(end) && this.isDateSameOrEarlier(begin, end)) {
                        dateRange = { begin, end };
                    }
                }
            }
        }
        return dateRange;
    }
    /**
     * @param {?} dateStr
     * @param {?} dateFormat
     * @param {?} delimeters
     * @return {?}
     */
    getDateValue(dateStr, dateFormat, delimeters) {
        /** @type {?} */
        const da = [];
        if (delimeters) {
            /** @type {?} */
            let del = delimeters[0];
            if (delimeters[0] !== delimeters[1]) {
                del = delimeters[0] + delimeters[1];
                if (delimeters[2] && delimeters[1] !== delimeters[2]) {
                    del = del + delimeters[2];
                }
            }
            /** @type {?} */
            const re = new RegExp('[' + del + ']');
            /** @type {?} */
            const ds = dateStr.split(re);
            /** @type {?} */
            const df = dateFormat.split(re);
            for (let i = 0; i < df.length; i++) {
                if (df[i].indexOf(YYYY) !== -1) {
                    da[0] = { value: ds[i], format: df[i] };
                }
                if (df[i].indexOf(M) !== -1) {
                    da[1] = ds[i] === undefined ? { value: '1', format: df[i] } : { value: ds[i], format: df[i] };
                }
                if (df[i].indexOf(D) !== -1) {
                    da[2] = ds[i] === undefined ? { value: '1', format: df[i] } : { value: ds[i], format: df[i] };
                }
            }
        }
        else {
            /** @type {?} */
            const yearIndex = (dateFormat + '').indexOf(YYYY);
            /** @type {?} */
            const monthIndex = (dateFormat + '').indexOf(MM);
            /** @type {?} */
            const dayIndex = (dateFormat + '').indexOf(DD);
            if (yearIndex >= 0) {
                da[0] = { value: dateStr.substring(yearIndex, yearIndex + 4), format: dateFormat.substring(yearIndex, yearIndex + 4) };
            }
            if (monthIndex >= 0) {
                da[1] = { value: dateStr.substring(monthIndex, monthIndex + 2), format: dateFormat.substring(monthIndex, monthIndex + 2) };
            }
            if (dayIndex >= 0) {
                da[2] = { value: dateStr.substring(dayIndex, dayIndex + 2), format: dateFormat.substring(dayIndex, dayIndex + 2) };
            }
        }
        return da;
    }
    /**
     * @param {?} df
     * @param {?} monthLabels
     * @return {?}
     */
    getMonthNumberByMonthName(df, monthLabels) {
        if (df.value) {
            for (let key = 1; key <= 12; key++) {
                if (df.value.toLowerCase() === monthLabels[key].toLowerCase()) {
                    return key;
                }
            }
        }
        return -1;
    }
    /**
     * @param {?} df
     * @return {?}
     */
    getNumberByValue(df) {
        if (!df) {
            return 1;
        }
        if (!/^\d+$/.test(df.value)) {
            return -1;
        }
        /** @type {?} */
        let nbr = Number(df.value);
        if ((df.format.length === 1 && df.value.length !== 1 && nbr < 10) ||
            (df.format.length === 1 && df.value.length !== 2 && nbr >= 10)) {
            nbr = -1;
        }
        else if (df.format.length === 2 && df.value.length > 2) {
            nbr = -1;
        }
        return nbr;
    }
    /**
     * @param {?} monthString
     * @return {?}
     */
    parseDefaultMonth(monthString) {
        /** @type {?} */
        const month = { monthTxt: EMPTY_STR, monthNbr: 0, year: 0 };
        if (monthString !== EMPTY_STR) {
            /** @type {?} */
            const split = monthString.split(monthString.match(/[^0-9]/)[0]);
            month.monthNbr = split[0].length === 2 ? Number(split[0]) : Number(split[1]);
            month.year = split[0].length === 2 ? Number(split[1]) : Number(split[0]);
        }
        return month;
    }
    /**
     * @param {?} date
     * @param {?} options
     * @return {?}
     */
    isDisabledDate(date, options) {
        const { minYear, maxYear, disableUntil, disableSince, disableWeekends, disableDates, disableDateRanges, disableWeekdays, enableDates } = options;
        // for (const d of enableDates) {
        //     if (
        //         (d.year === 0 || d.year === date.year) &&
        //         (d.month === 0 || d.month === date.month) &&
        //         d.day === date.day
        //     ) {
        //         return false;
        //     }
        // }
        if ((date.year < minYear && date.month === 12) || (date.year > maxYear && date.month === 1)) {
            return true;
        }
        /** @type {?} */
        const dateMs = this.getTimeInMilliseconds(date);
        if (this.isInitializedDate(disableUntil) && (dateMs + 24 * 60 * 60 * 1000 - 1) < this.getTimeInMilliseconds(disableUntil)) {
            return true;
        }
        if (this.isInitializedDate(disableSince) && dateMs > this.getTimeInMilliseconds(disableSince)) {
            return true;
        }
        if (disableWeekends) {
            /** @type {?} */
            const dayNbr = this.getDayNumber(date);
            if (dayNbr === 0 || dayNbr === 6) {
                return true;
            }
        }
        /** @type {?} */
        const dn = this.getDayNumber(date);
        if (disableWeekdays.length > 0) {
            for (const wd of disableWeekdays) {
                if (dn === this.getWeekdayIndex(wd)) {
                    return true;
                }
            }
        }
        for (const d of disableDates) {
            if ((d.year === 0 || d.year === date.year) &&
                (d.month === 0 || d.month === date.month) &&
                d.day === date.day) {
                return true;
            }
        }
        for (const d of disableDateRanges) {
            if (this.isInitializedDate(d.begin) &&
                this.isInitializedDate(d.end) &&
                dateMs >= this.getTimeInMilliseconds(d.begin) &&
                dateMs <= this.getTimeInMilliseconds(d.end)) {
                return true;
            }
        }
        return false;
    }
    /**
     * @param {?} date
     * @param {?} markedDates
     * @param {?} markWeekends
     * @return {?}
     */
    isMarkedDate(date, markedDates, markWeekends) {
        for (const md of markedDates) {
            for (const d of md.dates) {
                if ((d.year === 0 || d.year === date.year) &&
                    (d.month === 0 || d.month === date.month) &&
                    d.day === date.day) {
                    return { marked: true, color: md.color };
                }
            }
        }
        if (markWeekends && markWeekends.marked) {
            /** @type {?} */
            const dayNbr = this.getDayNumber(date);
            if (dayNbr === 0 || dayNbr === 6) {
                return { marked: true, color: markWeekends.color };
            }
        }
        return { marked: false, color: EMPTY_STR };
    }
    /**
     * @param {?} date
     * @param {?} sunHighlight
     * @param {?} satHighlight
     * @param {?} highlightDates
     * @return {?}
     */
    isHighlightedDate(date, sunHighlight, satHighlight, highlightDates) {
        /** @type {?} */
        const dayNbr = this.getDayNumber(date);
        if ((sunHighlight && dayNbr === 0) || (satHighlight && dayNbr === 6)) {
            return true;
        }
        for (const d of highlightDates) {
            if ((d.year === 0 || d.year === date.year) &&
                (d.month === 0 || d.month === date.month) &&
                d.day === date.day) {
                return true;
            }
        }
        return false;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getWeekNumber(date) {
        /** @type {?} */
        const d = new Date(date.year, date.month - 1, date.day, 0, 0, 0, 0);
        d.setDate(d.getDate() + (d.getDay() === 0 ? -3 : 4 - d.getDay()));
        return Math.round((d.getTime() - new Date(d.getFullYear(), 0, 4).getTime()) / 86400000 / 7) + 1;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getNowWeekTime(date) {
        date.setDate(date.getDate() - ((date.getDay() + 6) % 7));
        /** @type {?} */
        const begin = {
            year: date.getFullYear(),
            month: date.getMonth() + 1,
            day: date.getDate()
        };
        date.setDate(date.getDate() + 6);
        /** @type {?} */
        const end = {
            year: date.getFullYear(),
            month: date.getMonth() + 1,
            day: date.getDate()
        };
        return { begin, end };
    }
    /**
     * @param {?} date
     * @param {?} disableUntil
     * @return {?}
     */
    isMonthDisabledByDisableUntil(date, disableUntil) {
        return (this.isInitializedDate(disableUntil) &&
            this.getTimeInMilliseconds(date) <= this.getTimeInMilliseconds(disableUntil));
    }
    /**
     * @param {?} date
     * @param {?} disableSince
     * @return {?}
     */
    isMonthDisabledByDisableSince(date, disableSince) {
        return (this.isInitializedDate(disableSince) &&
            this.getTimeInMilliseconds(date) >= this.getTimeInMilliseconds(disableSince));
    }
    /**
     * @param {?} date
     * @param {?} dateRange
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @param {?} rangeDelimiter
     * @param {?} returnFormat
     * @param {?=} dateStr
     * @return {?}
     */
    getDateModel(date, dateRange, dateFormat, monthLabels, rangeDelimiter, returnFormat, dateStr = EMPTY_STR) {
        /** @type {?} */
        let singleDateModel = null;
        /** @type {?} */
        let dateRangeModel = null;
        if (date) {
            singleDateModel = {
                date,
                jsDate: this.getDate2(date),
                formatted: dateStr.length ? dateStr : this.formatDate(date, dateFormat, monthLabels),
                returnFormatted: this.formatDate(date, returnFormat, monthLabels),
                epoc: this.getEpocTime(date)
            };
        }
        else {
            dateRangeModel = {
                beginDate: dateRange.begin,
                beginJsDate: this.getDate(dateRange.begin),
                beginEpoc: this.getEpocTime(dateRange.begin),
                endDate: dateRange.end,
                endJsDate: this.getDate(dateRange.end),
                endEpoc: this.getEpocTime(dateRange.end),
                formatted: this.formatDate(dateRange.begin, dateFormat, monthLabels) +
                    rangeDelimiter +
                    this.formatDate(dateRange.end, dateFormat, monthLabels),
                returnFormatted: this.formatDate(dateRange.begin, returnFormat, monthLabels) +
                    rangeDelimiter +
                    this.formatDate(dateRange.end, returnFormat, monthLabels),
            };
        }
        return {
            isRange: date === null,
            singleDate: singleDateModel,
            dateRange: dateRangeModel
        };
    }
    /**
     * @param {?} date
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @return {?}
     */
    formatDate(date, dateFormat, monthLabels) {
        if (!date.month && dateFormat.indexOf(MM) === -1) {
            dateFormat = this.delete(dateFormat, MM);
        }
        if (!date.day && dateFormat.indexOf(DD) === -1) {
            dateFormat = this.delete(dateFormat, DD);
        }
        /** @type {?} */
        let formatted = dateFormat.replace(YYYY, String(date.year));
        if (dateFormat.indexOf(M) === -1) {
            formatted = formatted.replace(MM, '01');
        }
        else {
            if (dateFormat.indexOf(MMM) !== -1) {
                formatted = formatted.replace(MMM, monthLabels[date.month]);
            }
            else if (dateFormat.indexOf(MM) !== -1) {
                formatted = formatted.replace(MM, this.preZero(date.month || 1));
            }
            else {
                formatted = formatted.replace(M, String(date.month || 1));
            }
        }
        if (dateFormat.indexOf(DD) === -1) {
            formatted = formatted.replace(DD, '01');
        }
        else if (dateFormat.indexOf(DD) !== -1) {
            formatted = formatted.replace(DD, this.preZero(date.day || 1));
        }
        else {
            formatted = formatted.replace(D, String(date.day || 1));
        }
        formatted = formatted.replace('MM', 'mm').replace('HH', this.preZero(date.hour || 0))
            .replace('mm', this.preZero(date.minute || 0))
            .replace('ss', this.preZero(date.second || 0));
        return formatted && formatted.length > 2 ? formatted : '';
    }
    /**
     * @param {?} format
     * @param {?} delStr
     * @return {?}
     */
    delete(format, delStr) {
        /** @type {?} */
        const re = format.match(/[^(DdMmYy)]{1,}/g);
        /** @type {?} */
        const index = format.indexOf(delStr);
        if (index < 0) {
            return format;
        }
        else if (index === 0) {
            if (re) {
                return format.substring(3);
            }
            else {
                return format.substring(2);
            }
        }
        else if (index + 2 === format.length) {
            if (re) {
                return format.substring(0, format.length - 3);
            }
            else {
                return format.substring(0, format.length - 2);
            }
        }
        else {
            if (re) {
                return format.substring(0, index) + format.substring(index + 3);
            }
            else {
                return format.substring(0, index) + format.substring(index + 2);
            }
        }
    }
    /**
     * @param {?} model
     * @return {?}
     */
    getFormattedDate(model) {
        return !model.isRange ? model.singleDate.formatted : model.dateRange.formatted;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    preZero(val) {
        return val < 10 ? ZERO_STR + Number(val) : String(val);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    isInitializedDate(date) {
        return date && date.year !== 0 && date.month !== 0 && date.day !== 0;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    isInitializedMonth(date) {
        return date && date.year !== 0 && date.month !== 0;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    isInitializedYear(date) {
        return date && date.year !== 0;
    }
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    isDateEarlier(firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) < this.getTimeInMilliseconds(secondDate);
    }
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    isDateSameOrEarlier(firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) <= this.getTimeInMilliseconds(secondDate);
    }
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    isDateSame(firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) === this.getTimeInMilliseconds(secondDate);
    }
    /**
     * @param {?} dateRange
     * @param {?} date
     * @return {?}
     */
    isDateRangeBeginOrEndSame(dateRange, date) {
        /** @type {?} */
        const dateMs = this.getTimeInMilliseconds(date);
        return (this.getTimeInMilliseconds(dateRange.begin) === dateMs ||
            this.getTimeInMilliseconds(dateRange.end) === dateMs);
    }
    /**
     * @param {?} date
     * @param {?} dateRange
     * @return {?}
     */
    isDateInRange(date, dateRange) {
        if (!this.isInitializedDate(dateRange.begin) || !this.isInitializedDate(dateRange.end)) {
            return false;
        }
        return this.isDateSameOrEarlier(dateRange.begin, date) && this.isDateSameOrEarlier(date, dateRange.end);
    }
    /**
     * @return {?}
     */
    resetDate() {
        return { year: 0, month: 0, day: 0 };
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getTimeInMilliseconds(date) {
        return this.getDate(date).getTime();
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getDate2(date) {
        /** @type {?} */
        const now = new Date();
        if (!date.year) {
            date.year = now.getFullYear();
        }
        if (!date.month) {
            date.month = now.getMonth() + 1;
        }
        if (!date.day) {
            date.day = 1;
        }
        return new Date(date.year, date.month - 1, date.day, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getDate(date) {
        return new Date(date.year || 0, date.month ? date.month - 1 : 0, date.day || 0, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getDayNumber(date) {
        return new Date(date.year, date.month - 1, date.day, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0).getDay();
    }
    /**
     * @param {?} wd
     * @return {?}
     */
    getWeekdayIndex(wd) {
        return this.weekDays.indexOf(wd);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getEpocTime(date) {
        return Math.round(this.getTimeInMilliseconds(date) / 1000.0);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    getKeyCodeFromEvent(event) {
        /** @type {?} */
        const key = event.key || event.keyCode;
        if (key === KeyName.enter || key === KeyCode.enter) {
            return KeyCode.enter;
        }
        else if (key === KeyName.esc || key === KeyCode.esc) {
            return KeyCode.esc;
        }
        else if (key === KeyName.space || key === KeyCode.space) {
            return KeyCode.space;
        }
        else if (key === KeyName.leftArrow || key === KeyCode.leftArrow) {
            return KeyCode.leftArrow;
        }
        else if (key === KeyName.upArrow || key === KeyCode.upArrow) {
            return KeyCode.upArrow;
        }
        else if (key === KeyName.rightArrow || key === KeyCode.rightArrow) {
            return KeyCode.rightArrow;
        }
        else if (key === KeyName.downArrow || key === KeyCode.downArrow) {
            return KeyCode.downArrow;
        }
        else if (key === KeyName.tab || key === KeyCode.tab) {
            return KeyCode.tab;
        }
        else if (key === KeyName.shift || key === KeyCode.shift) {
            return KeyCode.shift;
        }
        else {
            return null;
        }
    }
    /**
     * @param {?} now
     * @param {?} min
     * @param {?} max
     * @return {?}
     */
    getNearDate(now, min, max) {
        /** @type {?} */
        const minMilliseconds = this.getTimeInMilliseconds(min);
        /** @type {?} */
        const maxMilliseconds = this.getTimeInMilliseconds(max);
        /** @type {?} */
        const nowMilliseconds = this.getTimeInMilliseconds(now);
        if (maxMilliseconds - nowMilliseconds > nowMilliseconds - minMilliseconds) {
            return min;
        }
        else {
            return max;
        }
    }
    // 禁用时间对应的小时
    // 选中日期等于左区间日期时，禁用左端点的左部分[0，minHour）
    // 选中日期等于右区间日期时，禁用右端点的右部分(maxHour,23]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} currentDate
     * @return {?}
     */
    disabledHours(min, max, currentDate) {
        /** @type {?} */
        let minHour = min.hour;
        /** @type {?} */
        let maxHour = max.hour;
        /** @type {?} */
        let res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            while (minHour-- >= 0) {
                res.push(minHour);
            }
        }
        else if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            while (maxHour++ < 24) {
                res.push(maxHour);
            }
        }
        return res;
    }
    //禁用时间对应的分钟 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minMinute）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxMinute，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} currentDate
     * @return {?}
     */
    disabledMinutes(min, max, _hour, currentDate) {
        /** @type {?} */
        let maxHour = max.hour;
        /** @type {?} */
        let maxMinute = max.minute;
        /** @type {?} */
        let minHour = min.hour;
        /** @type {?} */
        let minMinute = min.minute;
        /** @type {?} */
        let res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            if (_hour == minHour) {
                while (minMinute-- >= 0) {
                    res.push(minMinute);
                }
            }
        }
        else if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            if (_hour == maxHour) {
                while (maxMinute++ < 60) {
                    res.push(maxMinute);
                }
            }
        }
        return res;
    }
    //禁用时间对应的秒 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minSecond）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxSecond，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} _minute
     * @param {?} currentDate
     * @return {?}
     */
    disabledSeconds(min, max, _hour, _minute, currentDate) {
        /** @type {?} */
        let maxHour = max.hour;
        /** @type {?} */
        let maxMinute = max.minute;
        /** @type {?} */
        let maxSecond = max.second;
        /** @type {?} */
        let minHour = min.hour;
        /** @type {?} */
        let minMinute = min.minute;
        /** @type {?} */
        let minSecond = min.second;
        /** @type {?} */
        let res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            if (_hour == minHour && _minute == minMinute) {
                while (minSecond-- >= 0) {
                    res.push(minSecond);
                }
            }
        }
        else if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            if (_hour == maxHour && _minute == maxMinute) {
                while (maxSecond++ < 60) {
                    res.push(maxSecond);
                }
            }
        }
        return res;
    }
}
UtilService.decorators = [
    { type: Injectable }
];
if (false) {
    /** @type {?} */
    UtilService.prototype.weekDays;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLWRhdGVwaWNrZXIudXRpbC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRlcGlja2VyLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2ZhcnJpcy1kYXRlcGlja2VyLnV0aWwuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFRQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBYzNDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBR2xILE1BQU0sT0FBTyxXQUFXO0lBRHhCO1FBRUksYUFBUSxHQUFrQixDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBZ3NCM0QsQ0FBQzs7Ozs7OztJQTlyQkcsV0FBVyxDQUFDLE9BQWUsRUFBRSxPQUFtQixFQUFFLFFBQVEsR0FBRyxLQUFLOzs7WUFFMUQsUUFBZ0I7O1lBQUUsSUFBSSxHQUFHLENBQUM7O1lBQUUsTUFBTSxHQUFHLENBQUM7O1lBQUUsTUFBTSxHQUFHLENBQUM7O2NBRWhELFVBQVUsR0FBWSxJQUFJLENBQUMsU0FBUyxFQUFFO1FBRTVDLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO1lBQzdCLE9BQU8sVUFBVSxDQUFDO1NBQ3JCO2NBRUssRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE9B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O29CQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2lCQUN2QjthQUNKO1NBQ0o7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7OztZQWpzQkosVUFBVTs7OztJQUVQLCtCQUF1RCIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDktMDQgMDc6NDA6MDRcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMDktMDQgMTU6MjE6NDZcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtcclxuICAgIElNeURhdGVNb2RlbCxcclxuICAgIElNeVNpbmdsZURhdGVNb2RlbCxcclxuICAgIElNeURhdGVSYW5nZU1vZGVsLFxyXG4gICAgSU15RGF0ZSxcclxuICAgIElNeURhdGVSYW5nZSxcclxuICAgIElNeU1vbnRoLFxyXG4gICAgSU15TW9udGhMYWJlbHMsXHJcbiAgICBJTXlNYXJrZWREYXRlcyxcclxuICAgIElNeU1hcmtlZERhdGUsXHJcbiAgICBJTXlEYXRlRm9ybWF0LFxyXG4gICAgSU15T3B0aW9uc1xyXG59IGZyb20gJy4uL2ludGVyZmFjZXMvcHVibGljLWFwaSc7XHJcbmltcG9ydCB7IEtleUNvZGUsIEtleU5hbWUsIFNob3dUeXBlIH0gZnJvbSAnLi4vZW51bXMvcHVibGljLWFwaSc7XHJcbmltcG9ydCB7IEQsIERELCBNLCBNTSwgTU1NLCBZWVlZLCBTVSwgTU8sIFRVLCBXRSwgVEgsIEZSLCBTQSwgWkVST19TVFIsIEVNUFRZX1NUUiB9IGZyb20gJy4uL2NvbnN0YW50cy9jb25zdGFudHMnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgVXRpbFNlcnZpY2Uge1xyXG4gICAgd2Vla0RheXM6IEFycmF5PHN0cmluZz4gPSBbU1UsIE1PLCBUVSwgV0UsIFRILCBGUiwgU0FdO1xyXG5cclxuICAgIGlzRGF0ZVZhbGlkKGRhdGVTdHI6IHN0cmluZywgb3B0aW9uczogSU15T3B0aW9ucywgaXNSZXR1cm4gPSBmYWxzZSk6IElNeURhdGUge1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpvbmUtdmFyaWFibGUtcGVyLWRlY2xhcmF0aW9uXHJcbiAgICAgICAgbGV0IF9kYXRlU3RyOiBzdHJpbmcsIGhvdXIgPSAwLCBtaW51dGUgPSAwLCBzZWNvbmQgPSAwO1xyXG5cclxuICAgICAgICBjb25zdCByZXR1cm5EYXRlOiBJTXlEYXRlID0gdGhpcy5yZXNldERhdGUoKTtcclxuXHJcbiAgICAgICAgaWYgKCFkYXRlU3RyIHx8ICFkYXRlU3RyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuRGF0ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHsgZGF0ZUZvcm1hdCwgbWluWWVhciwgbWF4WWVhciwgbW9udGhMYWJlbHMsIHNob3dUaW1lLCByZXR1cm5Gb3JtYXQsIHNob3dUeXBlIH0gPSBvcHRpb25zO1xyXG4gICAgICAgIGxldCBfc3QgPSBzaG93VGltZTtcclxuICAgICAgICBsZXQgZm9ybWF0U3RyID0gZGF0ZUZvcm1hdDtcclxuICAgICAgICBpZiAoaXNSZXR1cm4pIHtcclxuICAgICAgICAgICAgZm9ybWF0U3RyID0gcmV0dXJuRm9ybWF0LnJlcGxhY2UoL1vlubQs5pyIXS9nLCAnLScpLnJlcGxhY2UoL1vml6VdLywgJycpLnJlcGxhY2UoL1vml7Ys5YiGXS9nLCAnOicpLnJlcGxhY2UoL1vnp5JdL2csICcnKTtcclxuICAgICAgICAgICAgZGF0ZVN0ciA9IGRhdGVTdHIucmVwbGFjZSgvW+W5tCzmnIhdL2csICctJykucmVwbGFjZSgvW+aXpV0vLCAnJykucmVwbGFjZSgvW+aXtizliIZdL2csICc6JykucmVwbGFjZSgvW+enkl0vZywgJycpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGVTdHJbZGF0ZVN0ci5sZW5ndGggLSAxXSA9PT0gJy0nIHx8IGRhdGVTdHJbZGF0ZVN0ci5sZW5ndGggLSAxXSA9PT0gJzonKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRlU3RyID0gZGF0ZVN0ci5zdWJzdHJpbmcoMCwgZGF0ZVN0ci5sZW5ndGggLSAxKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFzaG93VGltZSAmJiByZXR1cm5Gb3JtYXQudG9Mb2NhbGVMb3dlckNhc2UoKS5pbmRleE9mKCdoaDptbScpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIF9zdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRheXNJbk1vbnRoOiBBcnJheTxudW1iZXI+ID0gWzMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdO1xyXG4gICAgICAgIGNvbnN0IGlzTW9udGhTdHI6IGJvb2xlYW4gPSBmb3JtYXRTdHIuaW5kZXhPZihNTU0pICE9PSAtMTtcclxuICAgICAgICBsZXQgZGVsaW1ldGVyczogQXJyYXk8c3RyaW5nPiA9IGZvcm1hdFN0ci5tYXRjaCgvW14oRGRNbVl5KV17MSx9L2cpO1xyXG4gICAgICAgIGlmIChfc3QgJiYgZGF0ZVN0cikge1xyXG4gICAgICAgICAgICBfZGF0ZVN0ciA9IGRhdGVTdHIuc3BsaXQoJyAnKVswXTtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihyZXR1cm5EYXRlLCB7IGhvdXI6IDAsIG1pbnV0ZTogMCwgc2Vjb25kOiAwIH0pO1xyXG4gICAgICAgICAgICBjb25zdCB0aW1lU3RyID0gZGF0ZVN0ci5zcGxpdCgnICcpWzFdO1xyXG4gICAgICAgICAgICBpZiAodGltZVN0cikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3RpbWVyID0gdGltZVN0ci5yZXBsYWNlKCfml7YnLCAnOicpLnJlcGxhY2UoJ+WIhicsICc6JykucmVwbGFjZSgn56eSJywgJycpLnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RpbWVyWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG91ciA9IE51bWJlcihfdGltZXJbMF0uc3Vic3RyKDAsIDIpKTtcclxuICAgICAgICAgICAgICAgICAgICBob3VyID0gaXNOYU4oaG91cikgPyAwIDogaG91cjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChfdGltZXJbMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBtaW51dGUgPSBOdW1iZXIoX3RpbWVyWzFdLnN1YnN0cigwLCAyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWludXRlID0gaXNOYU4obWludXRlKSA/IDAgOiBtaW51dGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKF90aW1lclsyXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZCA9IE51bWJlcihfdGltZXJbMl0uc3Vic3RyKDAsIDIpKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWNvbmQgPSBpc05hTihzZWNvbmQpID8gMCA6IHNlY29uZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRlbGltZXRlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWcgPSAvXlxcZHsxLH0kLztcclxuICAgICAgICAgICAgICAgIGlmIChyZWcudGVzdChkYXRlU3RyKSkgeyAvLyDpqozor4HkvKDlhaXnmoTmoLzlvI/kuLogeXl5eU1NZGRISG1tc3NcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZiA9IGZvcm1hdFN0cjtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0ZVN0ciA9IGRhdGVTdHIuc3Vic3RyKDAsIDgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBfdGltZXIgPSBkYXRlU3RyLnN1YnN0cig4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZi5pbmNsdWRlcygnSEgnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXIgPSArX3RpbWVyLnNsaWNlKDAsIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aW1lciA9IF90aW1lci5zbGljZSgyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGYuaW5jbHVkZXMoJ21tJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW51dGUgPSArX3RpbWVyLnNsaWNlKDAsIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aW1lciA9IF90aW1lci5zbGljZSgyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGYuaW5jbHVkZXMoJ3NzJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmQgPSArX3RpbWVyLnNsaWNlKDAsIDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgX2RhdGVTdHIgPSBkYXRlU3RyID8gZGF0ZVN0ci5zcGxpdCgnICcpWzBdIDogJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRhdGVWYWx1ZTogQXJyYXk8SU15RGF0ZUZvcm1hdD4gPSB0aGlzLmdldERhdGVWYWx1ZShfZGF0ZVN0ciwgZm9ybWF0U3RyLCBkZWxpbWV0ZXJzKTtcclxuXHJcbiAgICAgICAgY29uc3QgeWVhcjogbnVtYmVyID0gdGhpcy5nZXROdW1iZXJCeVZhbHVlKGRhdGVWYWx1ZVswXSk7XHJcbiAgICAgICAgY29uc3QgbW9udGg6IG51bWJlciA9IGlzTW9udGhTdHJcclxuICAgICAgICAgICAgPyB0aGlzLmdldE1vbnRoTnVtYmVyQnlNb250aE5hbWUoZGF0ZVZhbHVlWzFdLCBtb250aExhYmVscylcclxuICAgICAgICAgICAgOiB0aGlzLmdldE51bWJlckJ5VmFsdWUoZGF0ZVZhbHVlWzFdKTtcclxuICAgICAgICBjb25zdCBkYXk6IG51bWJlciA9IHRoaXMuZ2V0TnVtYmVyQnlWYWx1ZShkYXRlVmFsdWVbMl0pO1xyXG5cclxuICAgICAgICBpZiAoc2hvd1R5cGUgPT09IFNob3dUeXBlLm5vRGF0ZUFuZE1vbnRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHllYXIsIG1vbnRoOiAxLCBkYXk6IDEgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChtb250aCAhPT0gLTEgJiYgZGF5ICE9PSAtMSAmJiB5ZWFyICE9PSAtMSkge1xyXG4gICAgICAgICAgICBpZiAoeWVhciA8IG1pblllYXIgfHwgeWVhciA+IG1heFllYXIgfHwgbW9udGggPCAxIHx8IG1vbnRoID4gMTIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5EYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGU6IElNeURhdGUgPSBfc3QgPyB7IHllYXIsIG1vbnRoLCBkYXksIGhvdXIsIG1pbnV0ZSwgc2Vjb25kIH0gOiB7IHllYXIsIG1vbnRoLCBkYXkgfTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRGlzYWJsZWREYXRlKGRhdGUsIG9wdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJuRGF0ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHllYXIgJSA0MDAgPT09IDAgfHwgKHllYXIgJSAxMDAgIT09IDAgJiYgeWVhciAlIDQgPT09IDApKSB7XHJcbiAgICAgICAgICAgICAgICBkYXlzSW5Nb250aFsxXSA9IDI5O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF5IDwgMSB8fCBkYXkgPiBkYXlzSW5Nb250aFttb250aCAtIDFdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJuRGF0ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVmFsaWQgZGF0ZVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zaG93VHlwZSA9PT0gU2hvd1R5cGUubm9EYXRlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyB5ZWFyOiBkYXRlLnllYXIsIG1vbnRoOiBkYXRlLm1vbnRoIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zaG93VHlwZSA9PT0gU2hvd1R5cGUubm9EYXRlQW5kTW9udGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHllYXI6IGRhdGUueWVhciB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJldHVybkRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgaXNEYXRlVmFsaWREYXRlUmFuZ2UoZGF0ZVJhbmdlU3RyOiBzdHJpbmcsIG9wdGlvbnM6IElNeU9wdGlvbnMpOiBJTXlEYXRlUmFuZ2Uge1xyXG4gICAgICAgIGxldCBkYXRlUmFuZ2U6IElNeURhdGVSYW5nZSA9IHtcclxuICAgICAgICAgICAgYmVnaW46IHRoaXMucmVzZXREYXRlKCksXHJcbiAgICAgICAgICAgIGVuZDogdGhpcy5yZXNldERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGRhdGVSYW5nZVN0ciAmJiBkYXRlUmFuZ2VTdHIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGVzOiBBcnJheTxzdHJpbmc+ID0gZGF0ZVJhbmdlU3RyLnNwbGl0KG9wdGlvbnMuZGF0ZVJhbmdlRGF0ZXNEZWxpbWl0ZXIpO1xyXG4gICAgICAgICAgICBpZiAoZGF0ZXMgJiYgZGF0ZXMubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbYmVnaW5EYXRlLCBlbmREYXRlXSA9IGRhdGVzO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmVnaW46IElNeURhdGUgPSB0aGlzLmlzRGF0ZVZhbGlkKGJlZ2luRGF0ZSwgb3B0aW9ucywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkRGF0ZShiZWdpbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQ6IElNeURhdGUgPSB0aGlzLmlzRGF0ZVZhbGlkKGVuZERhdGUsIG9wdGlvbnMsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkRGF0ZShlbmQpICYmIHRoaXMuaXNEYXRlU2FtZU9yRWFybGllcihiZWdpbiwgZW5kKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlUmFuZ2UgPSB7IGJlZ2luLCBlbmQgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGVSYW5nZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRlVmFsdWUoZGF0ZVN0cjogc3RyaW5nLCBkYXRlRm9ybWF0OiBzdHJpbmcsIGRlbGltZXRlcnM6IEFycmF5PHN0cmluZz4pOiBBcnJheTxJTXlEYXRlRm9ybWF0PiB7XHJcbiAgICAgICAgY29uc3QgZGE6IEFycmF5PElNeURhdGVGb3JtYXQ+ID0gW107XHJcblxyXG4gICAgICAgIGlmIChkZWxpbWV0ZXJzKSB7XHJcbiAgICAgICAgICAgIGxldCBkZWw6IHN0cmluZyA9IGRlbGltZXRlcnNbMF07XHJcbiAgICAgICAgICAgIGlmIChkZWxpbWV0ZXJzWzBdICE9PSBkZWxpbWV0ZXJzWzFdKSB7XHJcbiAgICAgICAgICAgICAgICBkZWwgPSBkZWxpbWV0ZXJzWzBdICsgZGVsaW1ldGVyc1sxXTtcclxuICAgICAgICAgICAgICAgIGlmIChkZWxpbWV0ZXJzWzJdICYmIGRlbGltZXRlcnNbMV0gIT09IGRlbGltZXRlcnNbMl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWwgPSBkZWwgKyBkZWxpbWV0ZXJzWzJdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJlOiBhbnkgPSBuZXcgUmVnRXhwKCdbJyArIGRlbCArICddJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRzOiBBcnJheTxzdHJpbmc+ID0gZGF0ZVN0ci5zcGxpdChyZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRmOiBBcnJheTxzdHJpbmc+ID0gZGF0ZUZvcm1hdC5zcGxpdChyZSk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGYubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChkZltpXS5pbmRleE9mKFlZWVkpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhWzBdID0geyB2YWx1ZTogZHNbaV0sIGZvcm1hdDogZGZbaV0gfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkZltpXS5pbmRleE9mKE0pICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhWzFdID0gZHNbaV0gPT09IHVuZGVmaW5lZCA/IHsgdmFsdWU6ICcxJywgZm9ybWF0OiBkZltpXSB9IDogeyB2YWx1ZTogZHNbaV0sIGZvcm1hdDogZGZbaV0gfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkZltpXS5pbmRleE9mKEQpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhWzJdID0gZHNbaV0gPT09IHVuZGVmaW5lZCA/IHsgdmFsdWU6ICcxJywgZm9ybWF0OiBkZltpXSB9IDogeyB2YWx1ZTogZHNbaV0sIGZvcm1hdDogZGZbaV0gfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHllYXJJbmRleCA9IChkYXRlRm9ybWF0ICsgJycpLmluZGV4T2YoWVlZWSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vbnRoSW5kZXggPSAoZGF0ZUZvcm1hdCArICcnKS5pbmRleE9mKE1NKTtcclxuICAgICAgICAgICAgY29uc3QgZGF5SW5kZXggPSAoZGF0ZUZvcm1hdCArICcnKS5pbmRleE9mKEREKTtcclxuICAgICAgICAgICAgaWYgKHllYXJJbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYVswXSA9IHsgdmFsdWU6IGRhdGVTdHIuc3Vic3RyaW5nKHllYXJJbmRleCwgeWVhckluZGV4ICsgNCksIGZvcm1hdDogZGF0ZUZvcm1hdC5zdWJzdHJpbmcoeWVhckluZGV4LCB5ZWFySW5kZXggKyA0KSB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChtb250aEluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgIGRhWzFdID0geyB2YWx1ZTogZGF0ZVN0ci5zdWJzdHJpbmcobW9udGhJbmRleCwgbW9udGhJbmRleCArIDIpLCBmb3JtYXQ6IGRhdGVGb3JtYXQuc3Vic3RyaW5nKG1vbnRoSW5kZXgsIG1vbnRoSW5kZXggKyAyKSB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXlJbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYVsyXSA9IHsgdmFsdWU6IGRhdGVTdHIuc3Vic3RyaW5nKGRheUluZGV4LCBkYXlJbmRleCArIDIpLCBmb3JtYXQ6IGRhdGVGb3JtYXQuc3Vic3RyaW5nKGRheUluZGV4LCBkYXlJbmRleCArIDIpIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1vbnRoTnVtYmVyQnlNb250aE5hbWUoZGY6IElNeURhdGVGb3JtYXQsIG1vbnRoTGFiZWxzOiBJTXlNb250aExhYmVscyk6IG51bWJlciB7XHJcbiAgICAgICAgaWYgKGRmLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGtleSA9IDE7IGtleSA8PSAxMjsga2V5KyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChkZi52YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBtb250aExhYmVsc1trZXldLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuXHJcbiAgICBnZXROdW1iZXJCeVZhbHVlKGRmOiBJTXlEYXRlRm9ybWF0KTogbnVtYmVyIHtcclxuICAgICAgICBpZiAoIWRmKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGYudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBuYnI6IG51bWJlciA9IE51bWJlcihkZi52YWx1ZSk7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAoZGYuZm9ybWF0Lmxlbmd0aCA9PT0gMSAmJiBkZi52YWx1ZS5sZW5ndGggIT09IDEgJiYgbmJyIDwgMTApIHx8XHJcbiAgICAgICAgICAgIChkZi5mb3JtYXQubGVuZ3RoID09PSAxICYmIGRmLnZhbHVlLmxlbmd0aCAhPT0gMiAmJiBuYnIgPj0gMTApXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIG5iciA9IC0xO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGYuZm9ybWF0Lmxlbmd0aCA9PT0gMiAmJiBkZi52YWx1ZS5sZW5ndGggPiAyKSB7XHJcbiAgICAgICAgICAgIG5iciA9IC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmJyO1xyXG4gICAgfVxyXG5cclxuICAgIHBhcnNlRGVmYXVsdE1vbnRoKG1vbnRoU3RyaW5nOiBzdHJpbmcpOiBJTXlNb250aCB7XHJcbiAgICAgICAgY29uc3QgbW9udGg6IElNeU1vbnRoID0geyBtb250aFR4dDogRU1QVFlfU1RSLCBtb250aE5icjogMCwgeWVhcjogMCB9O1xyXG4gICAgICAgIGlmIChtb250aFN0cmluZyAhPT0gRU1QVFlfU1RSKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwbGl0ID0gbW9udGhTdHJpbmcuc3BsaXQobW9udGhTdHJpbmcubWF0Y2goL1teMC05XS8pWzBdKTtcclxuICAgICAgICAgICAgbW9udGgubW9udGhOYnIgPSBzcGxpdFswXS5sZW5ndGggPT09IDIgPyBOdW1iZXIoc3BsaXRbMF0pIDogTnVtYmVyKHNwbGl0WzFdKTtcclxuICAgICAgICAgICAgbW9udGgueWVhciA9IHNwbGl0WzBdLmxlbmd0aCA9PT0gMiA/IE51bWJlcihzcGxpdFsxXSkgOiBOdW1iZXIoc3BsaXRbMF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbW9udGg7XHJcbiAgICB9XHJcblxyXG4gICAgaXNEaXNhYmxlZERhdGUoZGF0ZTogSU15RGF0ZSwgb3B0aW9uczogSU15T3B0aW9ucyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgbWluWWVhcixcclxuICAgICAgICAgICAgbWF4WWVhcixcclxuICAgICAgICAgICAgZGlzYWJsZVVudGlsLFxyXG4gICAgICAgICAgICBkaXNhYmxlU2luY2UsXHJcbiAgICAgICAgICAgIGRpc2FibGVXZWVrZW5kcyxcclxuICAgICAgICAgICAgZGlzYWJsZURhdGVzLFxyXG4gICAgICAgICAgICBkaXNhYmxlRGF0ZVJhbmdlcyxcclxuICAgICAgICAgICAgZGlzYWJsZVdlZWtkYXlzLFxyXG4gICAgICAgICAgICBlbmFibGVEYXRlc1xyXG4gICAgICAgIH0gPSBvcHRpb25zO1xyXG5cclxuICAgICAgICAvLyBmb3IgKGNvbnN0IGQgb2YgZW5hYmxlRGF0ZXMpIHtcclxuICAgICAgICAvLyAgICAgaWYgKFxyXG4gICAgICAgIC8vICAgICAgICAgKGQueWVhciA9PT0gMCB8fCBkLnllYXIgPT09IGRhdGUueWVhcikgJiZcclxuICAgICAgICAvLyAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgLy8gICAgICAgICBkLmRheSA9PT0gZGF0ZS5kYXlcclxuICAgICAgICAvLyAgICAgKSB7XHJcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIGlmICgoZGF0ZS55ZWFyIDwgbWluWWVhciAmJiBkYXRlLm1vbnRoID09PSAxMikgfHwgKGRhdGUueWVhciA+IG1heFllYXIgJiYgZGF0ZS5tb250aCA9PT0gMSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRhdGVNczogbnVtYmVyID0gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGF0ZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVVudGlsKSAmJiAoZGF0ZU1zICsgMjQgKiA2MCAqIDYwICogMTAwMCAtIDEpIDwgdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGlzYWJsZVVudGlsKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVNpbmNlKSAmJiBkYXRlTXMgPiB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkaXNhYmxlU2luY2UpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRpc2FibGVXZWVrZW5kcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXlOYnIgPSB0aGlzLmdldERheU51bWJlcihkYXRlKTtcclxuICAgICAgICAgICAgaWYgKGRheU5iciA9PT0gMCB8fCBkYXlOYnIgPT09IDYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkbiA9IHRoaXMuZ2V0RGF5TnVtYmVyKGRhdGUpO1xyXG4gICAgICAgIGlmIChkaXNhYmxlV2Vla2RheXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHdkIG9mIGRpc2FibGVXZWVrZGF5cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRuID09PSB0aGlzLmdldFdlZWtkYXlJbmRleCh3ZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBkIG9mIGRpc2FibGVEYXRlcykge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAoZC55ZWFyID09PSAwIHx8IGQueWVhciA9PT0gZGF0ZS55ZWFyKSAmJlxyXG4gICAgICAgICAgICAgICAgKGQubW9udGggPT09IDAgfHwgZC5tb250aCA9PT0gZGF0ZS5tb250aCkgJiZcclxuICAgICAgICAgICAgICAgIGQuZGF5ID09PSBkYXRlLmRheVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGQgb2YgZGlzYWJsZURhdGVSYW5nZXMpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkLmJlZ2luKSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkLmVuZCkgJiZcclxuICAgICAgICAgICAgICAgIGRhdGVNcyA+PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkLmJlZ2luKSAmJlxyXG4gICAgICAgICAgICAgICAgZGF0ZU1zIDw9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGQuZW5kKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpc01hcmtlZERhdGUoZGF0ZTogSU15RGF0ZSwgbWFya2VkRGF0ZXM6IEFycmF5PElNeU1hcmtlZERhdGVzPiwgbWFya1dlZWtlbmRzOiBJTXlNYXJrZWREYXRlKTogSU15TWFya2VkRGF0ZSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBtZCBvZiBtYXJrZWREYXRlcykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGQgb2YgbWQuZGF0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAoZC55ZWFyID09PSAwIHx8IGQueWVhciA9PT0gZGF0ZS55ZWFyKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgZC5kYXkgPT09IGRhdGUuZGF5XHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtYXJrZWQ6IHRydWUsIGNvbG9yOiBtZC5jb2xvciB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtYXJrV2Vla2VuZHMgJiYgbWFya1dlZWtlbmRzLm1hcmtlZCkge1xyXG4gICAgICAgICAgICBjb25zdCBkYXlOYnIgPSB0aGlzLmdldERheU51bWJlcihkYXRlKTtcclxuICAgICAgICAgICAgaWYgKGRheU5iciA9PT0gMCB8fCBkYXlOYnIgPT09IDYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IG1hcmtlZDogdHJ1ZSwgY29sb3I6IG1hcmtXZWVrZW5kcy5jb2xvciB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IG1hcmtlZDogZmFsc2UsIGNvbG9yOiBFTVBUWV9TVFIgfTtcclxuICAgIH1cclxuXHJcbiAgICBpc0hpZ2hsaWdodGVkRGF0ZShcclxuICAgICAgICBkYXRlOiBJTXlEYXRlLFxyXG4gICAgICAgIHN1bkhpZ2hsaWdodDogYm9vbGVhbixcclxuICAgICAgICBzYXRIaWdobGlnaHQ6IGJvb2xlYW4sXHJcbiAgICAgICAgaGlnaGxpZ2h0RGF0ZXM6IEFycmF5PElNeURhdGU+XHJcbiAgICApOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBkYXlOYnI6IG51bWJlciA9IHRoaXMuZ2V0RGF5TnVtYmVyKGRhdGUpO1xyXG4gICAgICAgIGlmICgoc3VuSGlnaGxpZ2h0ICYmIGRheU5iciA9PT0gMCkgfHwgKHNhdEhpZ2hsaWdodCAmJiBkYXlOYnIgPT09IDYpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IGQgb2YgaGlnaGxpZ2h0RGF0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgKGQueWVhciA9PT0gMCB8fCBkLnllYXIgPT09IGRhdGUueWVhcikgJiZcclxuICAgICAgICAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgICAgICAgICBkLmRheSA9PT0gZGF0ZS5kYXlcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2Vla051bWJlcihkYXRlOiBJTXlEYXRlKTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBkOiBEYXRlID0gbmV3IERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoIC0gMSwgZGF0ZS5kYXksIDAsIDAsIDAsIDApO1xyXG4gICAgICAgIGQuc2V0RGF0ZShkLmdldERhdGUoKSArIChkLmdldERheSgpID09PSAwID8gLTMgOiA0IC0gZC5nZXREYXkoKSkpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKChkLmdldFRpbWUoKSAtIG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgMCwgNCkuZ2V0VGltZSgpKSAvIDg2NDAwMDAwIC8gNykgKyAxO1xyXG4gICAgfVxyXG4gICAgZ2V0Tm93V2Vla1RpbWUoZGF0ZTogRGF0ZSk6IElNeURhdGVSYW5nZSB7XHJcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpIC0gKChkYXRlLmdldERheSgpICsgNikgJSA3KSk7XHJcbiAgICAgICAgY29uc3QgYmVnaW4gPSB7XHJcbiAgICAgICAgICAgIHllYXI6IGRhdGUuZ2V0RnVsbFllYXIoKSxcclxuICAgICAgICAgICAgbW9udGg6IGRhdGUuZ2V0TW9udGgoKSArIDEsXHJcbiAgICAgICAgICAgIGRheTogZGF0ZS5nZXREYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDYpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHtcclxuICAgICAgICAgICAgeWVhcjogZGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgICAgICAgICBtb250aDogZGF0ZS5nZXRNb250aCgpICsgMSxcclxuICAgICAgICAgICAgZGF5OiBkYXRlLmdldERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHsgYmVnaW4sIGVuZCB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlzTW9udGhEaXNhYmxlZEJ5RGlzYWJsZVVudGlsKGRhdGU6IElNeURhdGUsIGRpc2FibGVVbnRpbDogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVVudGlsKSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlKSA8PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkaXNhYmxlVW50aWwpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpc01vbnRoRGlzYWJsZWRCeURpc2FibGVTaW5jZShkYXRlOiBJTXlEYXRlLCBkaXNhYmxlU2luY2U6IElNeURhdGUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWREYXRlKGRpc2FibGVTaW5jZSkgJiZcclxuICAgICAgICAgICAgdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGF0ZSkgPj0gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGlzYWJsZVNpbmNlKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0ZU1vZGVsKFxyXG4gICAgICAgIGRhdGU6IElNeURhdGUsXHJcbiAgICAgICAgZGF0ZVJhbmdlOiBJTXlEYXRlUmFuZ2UsXHJcbiAgICAgICAgZGF0ZUZvcm1hdDogc3RyaW5nLFxyXG4gICAgICAgIG1vbnRoTGFiZWxzOiBJTXlNb250aExhYmVscyxcclxuICAgICAgICByYW5nZURlbGltaXRlcjogc3RyaW5nLFxyXG4gICAgICAgIHJldHVybkZvcm1hdDogc3RyaW5nLFxyXG4gICAgICAgIGRhdGVTdHI6IHN0cmluZyA9IEVNUFRZX1NUUlxyXG4gICAgKTogSU15RGF0ZU1vZGVsIHtcclxuICAgICAgICBsZXQgc2luZ2xlRGF0ZU1vZGVsOiBJTXlTaW5nbGVEYXRlTW9kZWwgPSBudWxsO1xyXG4gICAgICAgIGxldCBkYXRlUmFuZ2VNb2RlbDogSU15RGF0ZVJhbmdlTW9kZWwgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAoZGF0ZSkge1xyXG4gICAgICAgICAgICBzaW5nbGVEYXRlTW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBkYXRlLFxyXG4gICAgICAgICAgICAgICAganNEYXRlOiB0aGlzLmdldERhdGUyKGRhdGUpLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkOiBkYXRlU3RyLmxlbmd0aCA/IGRhdGVTdHIgOiB0aGlzLmZvcm1hdERhdGUoZGF0ZSwgZGF0ZUZvcm1hdCwgbW9udGhMYWJlbHMpLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuRm9ybWF0dGVkOiB0aGlzLmZvcm1hdERhdGUoZGF0ZSwgcmV0dXJuRm9ybWF0LCBtb250aExhYmVscyksXHJcbiAgICAgICAgICAgICAgICBlcG9jOiB0aGlzLmdldEVwb2NUaW1lKGRhdGUpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGF0ZVJhbmdlTW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBiZWdpbkRhdGU6IGRhdGVSYW5nZS5iZWdpbixcclxuICAgICAgICAgICAgICAgIGJlZ2luSnNEYXRlOiB0aGlzLmdldERhdGUoZGF0ZVJhbmdlLmJlZ2luKSxcclxuICAgICAgICAgICAgICAgIGJlZ2luRXBvYzogdGhpcy5nZXRFcG9jVGltZShkYXRlUmFuZ2UuYmVnaW4pLFxyXG4gICAgICAgICAgICAgICAgZW5kRGF0ZTogZGF0ZVJhbmdlLmVuZCxcclxuICAgICAgICAgICAgICAgIGVuZEpzRGF0ZTogdGhpcy5nZXREYXRlKGRhdGVSYW5nZS5lbmQpLFxyXG4gICAgICAgICAgICAgICAgZW5kRXBvYzogdGhpcy5nZXRFcG9jVGltZShkYXRlUmFuZ2UuZW5kKSxcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdERhdGUoZGF0ZVJhbmdlLmJlZ2luLCBkYXRlRm9ybWF0LCBtb250aExhYmVscykgK1xyXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlRGVsaW1pdGVyICtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdERhdGUoZGF0ZVJhbmdlLmVuZCwgZGF0ZUZvcm1hdCwgbW9udGhMYWJlbHMpLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuRm9ybWF0dGVkOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0RGF0ZShkYXRlUmFuZ2UuYmVnaW4sIHJldHVybkZvcm1hdCwgbW9udGhMYWJlbHMpICtcclxuICAgICAgICAgICAgICAgICAgICByYW5nZURlbGltaXRlciArXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtYXREYXRlKGRhdGVSYW5nZS5lbmQsIHJldHVybkZvcm1hdCwgbW9udGhMYWJlbHMpLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpc1JhbmdlOiBkYXRlID09PSBudWxsLFxyXG4gICAgICAgICAgICBzaW5nbGVEYXRlOiBzaW5nbGVEYXRlTW9kZWwsXHJcbiAgICAgICAgICAgIGRhdGVSYW5nZTogZGF0ZVJhbmdlTW9kZWxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdERhdGUoZGF0ZTogSU15RGF0ZSwgZGF0ZUZvcm1hdDogc3RyaW5nLCBtb250aExhYmVsczogSU15TW9udGhMYWJlbHMpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICghZGF0ZS5tb250aCAmJiBkYXRlRm9ybWF0LmluZGV4T2YoTU0pID09PSAtMSkge1xyXG4gICAgICAgICAgICBkYXRlRm9ybWF0ID0gdGhpcy5kZWxldGUoZGF0ZUZvcm1hdCwgTU0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWRhdGUuZGF5ICYmIGRhdGVGb3JtYXQuaW5kZXhPZihERCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIGRhdGVGb3JtYXQgPSB0aGlzLmRlbGV0ZShkYXRlRm9ybWF0LCBERCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBmb3JtYXR0ZWQ6IHN0cmluZyA9IGRhdGVGb3JtYXQucmVwbGFjZShZWVlZLCBTdHJpbmcoZGF0ZS55ZWFyKSk7XHJcblxyXG4gICAgICAgIGlmIChkYXRlRm9ybWF0LmluZGV4T2YoTSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKE1NLCAnMDEnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoZGF0ZUZvcm1hdC5pbmRleE9mKE1NTSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZShNTU0sIG1vbnRoTGFiZWxzW2RhdGUubW9udGhdKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRlRm9ybWF0LmluZGV4T2YoTU0pICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoTU0sIHRoaXMucHJlWmVybyhkYXRlLm1vbnRoIHx8IDEpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKE0sIFN0cmluZyhkYXRlLm1vbnRoIHx8IDEpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRhdGVGb3JtYXQuaW5kZXhPZihERCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKERELCAnMDEnKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGVGb3JtYXQuaW5kZXhPZihERCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKERELCB0aGlzLnByZVplcm8oZGF0ZS5kYXkgfHwgMSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKEQsIFN0cmluZyhkYXRlLmRheSB8fCAxKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZSgnTU0nLCAnbW0nKS5yZXBsYWNlKCdISCcsIHRoaXMucHJlWmVybyhkYXRlLmhvdXIgfHwgMCkpXHJcbiAgICAgICAgLnJlcGxhY2UoJ21tJywgdGhpcy5wcmVaZXJvKGRhdGUubWludXRlIHx8IDApKVxyXG4gICAgICAgIC5yZXBsYWNlKCdzcycsIHRoaXMucHJlWmVybyhkYXRlLnNlY29uZCB8fCAwKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQgJiYgZm9ybWF0dGVkLmxlbmd0aCA+IDIgPyBmb3JtYXR0ZWQgOiAnJztcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGUoZm9ybWF0OiBzdHJpbmcsIGRlbFN0cjogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgcmUgPSBmb3JtYXQubWF0Y2goL1teKERkTW1ZeSldezEsfS9nKTtcclxuICAgICAgICBjb25zdCBpbmRleCA9IGZvcm1hdC5pbmRleE9mKGRlbFN0cik7XHJcblxyXG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdDtcclxuICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIGlmIChyZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdC5zdWJzdHJpbmcoMyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggKyAyID09PSBmb3JtYXQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmIChyZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdC5zdWJzdHJpbmcoMCwgZm9ybWF0Lmxlbmd0aCAtIDMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdC5zdWJzdHJpbmcoMCwgZm9ybWF0Lmxlbmd0aCAtIDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHJlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygwLCBpbmRleCkgKyBmb3JtYXQuc3Vic3RyaW5nKGluZGV4ICsgMyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygwLCBpbmRleCkgKyBmb3JtYXQuc3Vic3RyaW5nKGluZGV4ICsgMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRGb3JtYXR0ZWREYXRlKG1vZGVsOiBJTXlEYXRlTW9kZWwpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiAhbW9kZWwuaXNSYW5nZSA/IG1vZGVsLnNpbmdsZURhdGUuZm9ybWF0dGVkIDogbW9kZWwuZGF0ZVJhbmdlLmZvcm1hdHRlZDtcclxuICAgIH1cclxuXHJcbiAgICBwcmVaZXJvKHZhbDogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdmFsIDwgMTAgPyBaRVJPX1NUUiArIE51bWJlcih2YWwpIDogU3RyaW5nKHZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNJbml0aWFsaXplZERhdGUoZGF0ZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBkYXRlICYmIGRhdGUueWVhciAhPT0gMCAmJiBkYXRlLm1vbnRoICE9PSAwICYmIGRhdGUuZGF5ICE9PSAwO1xyXG4gICAgfVxyXG5cclxuICAgIGlzSW5pdGlhbGl6ZWRNb250aChkYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUgJiYgZGF0ZS55ZWFyICE9PSAwICYmIGRhdGUubW9udGggIT09IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaXNJbml0aWFsaXplZFllYXIoZGF0ZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBkYXRlICYmIGRhdGUueWVhciAhPT0gMDtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGVFYXJsaWVyKGZpcnN0RGF0ZTogSU15RGF0ZSwgc2Vjb25kRGF0ZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhmaXJzdERhdGUpIDwgdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoc2Vjb25kRGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNEYXRlU2FtZU9yRWFybGllcihmaXJzdERhdGU6IElNeURhdGUsIHNlY29uZERhdGU6IElNeURhdGUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZmlyc3REYXRlKSA8PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhzZWNvbmREYXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGVTYW1lKGZpcnN0RGF0ZTogSU15RGF0ZSwgc2Vjb25kRGF0ZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhmaXJzdERhdGUpID09PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhzZWNvbmREYXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGVSYW5nZUJlZ2luT3JFbmRTYW1lKGRhdGVSYW5nZTogSU15RGF0ZVJhbmdlLCBkYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgZGF0ZU1zOiBudW1iZXIgPSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlKTtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlUmFuZ2UuYmVnaW4pID09PSBkYXRlTXMgfHxcclxuICAgICAgICAgICAgdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGF0ZVJhbmdlLmVuZCkgPT09IGRhdGVNc1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNEYXRlSW5SYW5nZShkYXRlOiBJTXlEYXRlLCBkYXRlUmFuZ2U6IElNeURhdGVSYW5nZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkYXRlUmFuZ2UuYmVnaW4pIHx8ICF0aGlzLmlzSW5pdGlhbGl6ZWREYXRlKGRhdGVSYW5nZS5lbmQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNEYXRlU2FtZU9yRWFybGllcihkYXRlUmFuZ2UuYmVnaW4sIGRhdGUpICYmIHRoaXMuaXNEYXRlU2FtZU9yRWFybGllcihkYXRlLCBkYXRlUmFuZ2UuZW5kKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldERhdGUoKTogSU15RGF0ZSB7XHJcbiAgICAgICAgcmV0dXJuIHsgeWVhcjogMCwgbW9udGg6IDAsIGRheTogMCB9O1xyXG4gICAgfVxyXG5cclxuICAgIGdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlOiBJTXlEYXRlKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXREYXRlKGRhdGUpLmdldFRpbWUoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRlMihkYXRlOiBJTXlEYXRlKTogRGF0ZSB7XHJcbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICAgICAgaWYgKCFkYXRlLnllYXIpIHtcclxuICAgICAgICAgICAgZGF0ZS55ZWFyID0gbm93LmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWRhdGUubW9udGgpIHtcclxuICAgICAgICAgICAgZGF0ZS5tb250aCA9IG5vdy5nZXRNb250aCgpICsgMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZGF0ZS5kYXkpIHtcclxuICAgICAgICAgICAgZGF0ZS5kYXkgPSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKFxyXG4gICAgICAgICAgICBkYXRlLnllYXIsXHJcbiAgICAgICAgICAgIGRhdGUubW9udGggLSAxLFxyXG4gICAgICAgICAgICBkYXRlLmRheSxcclxuICAgICAgICAgICAgZGF0ZS5ob3VyID8gZGF0ZS5ob3VyIDogMCxcclxuICAgICAgICAgICAgZGF0ZS5taW51dGUgPyBkYXRlLm1pbnV0ZSA6IDAsXHJcbiAgICAgICAgICAgIGRhdGUuc2Vjb25kID8gZGF0ZS5zZWNvbmQgOiAwLFxyXG4gICAgICAgICAgICAwXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRlKGRhdGU6IElNeURhdGUpOiBEYXRlIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUoXHJcbiAgICAgICAgICAgIGRhdGUueWVhciB8fCAwLFxyXG4gICAgICAgICAgICBkYXRlLm1vbnRoID8gZGF0ZS5tb250aCAtIDEgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLmRheSB8fCAwLFxyXG4gICAgICAgICAgICBkYXRlLmhvdXIgPyBkYXRlLmhvdXIgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLm1pbnV0ZSA/IGRhdGUubWludXRlIDogMCxcclxuICAgICAgICAgICAgZGF0ZS5zZWNvbmQgPyBkYXRlLnNlY29uZCA6IDAsXHJcbiAgICAgICAgICAgIDBcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERheU51bWJlcihkYXRlOiBJTXlEYXRlKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUoXHJcbiAgICAgICAgICAgIGRhdGUueWVhcixcclxuICAgICAgICAgICAgZGF0ZS5tb250aCAtIDEsXHJcbiAgICAgICAgICAgIGRhdGUuZGF5LFxyXG4gICAgICAgICAgICBkYXRlLmhvdXIgPyBkYXRlLmhvdXIgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLm1pbnV0ZSA/IGRhdGUubWludXRlIDogMCxcclxuICAgICAgICAgICAgZGF0ZS5zZWNvbmQgPyBkYXRlLnNlY29uZCA6IDAsXHJcbiAgICAgICAgICAgIDBcclxuICAgICAgICApLmdldERheSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFdlZWtkYXlJbmRleCh3ZDogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud2Vla0RheXMuaW5kZXhPZih3ZCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RXBvY1RpbWUoZGF0ZTogSU15RGF0ZSk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQodGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGF0ZSkgLyAxMDAwLjApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEtleUNvZGVGcm9tRXZlbnQoZXZlbnQ6IGFueSk6IG51bWJlciB7XHJcbiAgICAgICAgY29uc3Qga2V5OiBhbnkgPSBldmVudC5rZXkgfHwgZXZlbnQua2V5Q29kZTtcclxuXHJcbiAgICAgICAgaWYgKGtleSA9PT0gS2V5TmFtZS5lbnRlciB8fCBrZXkgPT09IEtleUNvZGUuZW50ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtleUNvZGUuZW50ZXI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUuZXNjIHx8IGtleSA9PT0gS2V5Q29kZS5lc2MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtleUNvZGUuZXNjO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBLZXlOYW1lLnNwYWNlIHx8IGtleSA9PT0gS2V5Q29kZS5zcGFjZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5zcGFjZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS2V5TmFtZS5sZWZ0QXJyb3cgfHwga2V5ID09PSBLZXlDb2RlLmxlZnRBcnJvdykge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5sZWZ0QXJyb3c7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUudXBBcnJvdyB8fCBrZXkgPT09IEtleUNvZGUudXBBcnJvdykge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS51cEFycm93O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBLZXlOYW1lLnJpZ2h0QXJyb3cgfHwga2V5ID09PSBLZXlDb2RlLnJpZ2h0QXJyb3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtleUNvZGUucmlnaHRBcnJvdztcclxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS2V5TmFtZS5kb3duQXJyb3cgfHwga2V5ID09PSBLZXlDb2RlLmRvd25BcnJvdykge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5kb3duQXJyb3c7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUudGFiIHx8IGtleSA9PT0gS2V5Q29kZS50YWIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtleUNvZGUudGFiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBLZXlOYW1lLnNoaWZ0IHx8IGtleSA9PT0gS2V5Q29kZS5zaGlmdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5zaGlmdDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXROZWFyRGF0ZShub3c6IElNeURhdGUsIG1pbjogSU15RGF0ZSwgbWF4OiBJTXlEYXRlKSB7XHJcbiAgICAgICAgY29uc3QgbWluTWlsbGlzZWNvbmRzID0gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMobWluKVxyXG4gICAgICAgIGNvbnN0IG1heE1pbGxpc2Vjb25kcyA9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKG1heClcclxuICAgICAgICBjb25zdCBub3dNaWxsaXNlY29uZHMgPSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhub3cpXHJcbiAgICAgICAgaWYgKG1heE1pbGxpc2Vjb25kcyAtIG5vd01pbGxpc2Vjb25kcyA+IG5vd01pbGxpc2Vjb25kcyAtIG1pbk1pbGxpc2Vjb25kcykge1xyXG4gICAgICAgICAgICByZXR1cm4gbWluO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g56aB55So5pe26Ze05a+55bqU55qE5bCP5pe2XHJcbiAgICAvLyDpgInkuK3ml6XmnJ/nrYnkuo7lt6bljLrpl7Tml6XmnJ/ml7bvvIznpoHnlKjlt6bnq6/ngrnnmoTlt6bpg6jliIZbMO+8jG1pbkhvdXLvvIlcclxuICAgIC8vIOmAieS4reaXpeacn+etieS6juWPs+WMuumXtOaXpeacn+aXtu+8jOemgeeUqOWPs+err+eCueeahOWPs+mDqOWIhihtYXhIb3VyLDIzXVxyXG4gICAgZGlzYWJsZWRIb3VycyhtaW46IElNeURhdGUsIG1heDogSU15RGF0ZSwgY3VycmVudERhdGU6IElNeURhdGUpIHtcclxuICAgICAgICBsZXQgbWluSG91ciA9IG1pbi5ob3VyO1xyXG4gICAgICAgIGxldCBtYXhIb3VyID0gbWF4LmhvdXI7XHJcbiAgICAgICAgbGV0IHJlcyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWluLnllYXIsIG1vbnRoOiBtaW4ubW9udGgsIGRheTogbWluLmRheSB9KSkge1xyXG4gICAgICAgICAgICB3aGlsZSAobWluSG91ci0tID49IDApIHtcclxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKG1pbkhvdXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWF4LnllYXIsIG1vbnRoOiBtYXgubW9udGgsIGRheTogbWF4LmRheSB9KSkge1xyXG4gICAgICAgICAgICB3aGlsZSAobWF4SG91cisrIDwgMjQpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKG1heEhvdXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbiAgICAvL+emgeeUqOaXtumXtOWvueW6lOeahOWIhumSnyBcclxuICAgIC8v6YCJ5Lit5pel5pyf562J5LqO5bem5Yy66Ze05pel5pyf5pe277yM56aB55So5bem56uv54K555qE5bem6YOo5YiGWzDvvIxtaW5NaW51dGXvvIlcclxuICAgIC8v6YCJ5Lit5pel5pyf562J5LqO5Y+z5Yy66Ze05pel5pyf5pe277yM56aB55So5Y+z56uv54K555qE5Y+z6YOo5YiG77yIbWF4TWludXRl77yMNTldXHJcbiAgICBkaXNhYmxlZE1pbnV0ZXMobWluOiBJTXlEYXRlLCBtYXg6IElNeURhdGUsIF9ob3VyOiBudW1iZXIsIGN1cnJlbnREYXRlOiBJTXlEYXRlKSB7XHJcbiAgICAgICAgbGV0IG1heEhvdXIgPSBtYXguaG91cjtcclxuICAgICAgICBsZXQgbWF4TWludXRlID0gbWF4Lm1pbnV0ZTtcclxuICAgICAgICBsZXQgbWluSG91ciA9IG1pbi5ob3VyO1xyXG4gICAgICAgIGxldCBtaW5NaW51dGUgPSBtaW4ubWludXRlO1xyXG4gICAgICAgIGxldCByZXMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5pc0RhdGVTYW1lKHsgeWVhcjogY3VycmVudERhdGUueWVhciwgbW9udGg6IGN1cnJlbnREYXRlLm1vbnRoLCBkYXk6IGN1cnJlbnREYXRlLmRheSB9LCB7IHllYXI6IG1pbi55ZWFyLCBtb250aDogbWluLm1vbnRoLCBkYXk6IG1pbi5kYXkgfSkpIHtcclxuICAgICAgICAgICAgaWYgKF9ob3VyID09IG1pbkhvdXIpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChtaW5NaW51dGUtLSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2gobWluTWludXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0RhdGVTYW1lKHsgeWVhcjogY3VycmVudERhdGUueWVhciwgbW9udGg6IGN1cnJlbnREYXRlLm1vbnRoLCBkYXk6IGN1cnJlbnREYXRlLmRheSB9LCB7IHllYXI6IG1heC55ZWFyLCBtb250aDogbWF4Lm1vbnRoLCBkYXk6IG1heC5kYXkgfSkpIHtcclxuICAgICAgICAgICAgaWYgKF9ob3VyID09IG1heEhvdXIpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChtYXhNaW51dGUrKyA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2gobWF4TWludXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG5cclxuICAgIH1cclxuICAgIC8v56aB55So5pe26Ze05a+55bqU55qE56eSIFxyXG4gICAgLy/pgInkuK3ml6XmnJ/nrYnkuo7lt6bljLrpl7Tml6XmnJ/ml7bvvIznpoHnlKjlt6bnq6/ngrnnmoTlt6bpg6jliIZbMO+8jG1pblNlY29uZO+8iVxyXG4gICAgLy/pgInkuK3ml6XmnJ/nrYnkuo7lj7PljLrpl7Tml6XmnJ/ml7bvvIznpoHnlKjlj7Pnq6/ngrnnmoTlj7Ppg6jliIbvvIhtYXhTZWNvbmTvvIw1OV1cclxuICAgIGRpc2FibGVkU2Vjb25kcyhtaW46IElNeURhdGUsIG1heDogSU15RGF0ZSwgX2hvdXI6IG51bWJlciwgX21pbnV0ZTogbnVtYmVyLCBjdXJyZW50RGF0ZTogSU15RGF0ZSkge1xyXG4gICAgICAgIGxldCBtYXhIb3VyID0gbWF4LmhvdXI7XHJcbiAgICAgICAgbGV0IG1heE1pbnV0ZSA9IG1heC5taW51dGU7XHJcbiAgICAgICAgbGV0IG1heFNlY29uZCA9IG1heC5zZWNvbmQ7XHJcbiAgICAgICAgbGV0IG1pbkhvdXIgPSBtaW4uaG91cjtcclxuICAgICAgICBsZXQgbWluTWludXRlID0gbWluLm1pbnV0ZTtcclxuICAgICAgICBsZXQgbWluU2Vjb25kID0gbWluLnNlY29uZDtcclxuICAgICAgICBsZXQgcmVzID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEYXRlU2FtZSh7IHllYXI6IGN1cnJlbnREYXRlLnllYXIsIG1vbnRoOiBjdXJyZW50RGF0ZS5tb250aCwgZGF5OiBjdXJyZW50RGF0ZS5kYXkgfSwgeyB5ZWFyOiBtaW4ueWVhciwgbW9udGg6IG1pbi5tb250aCwgZGF5OiBtaW4uZGF5IH0pKSB7XHJcbiAgICAgICAgICAgIGlmIChfaG91ciA9PSBtaW5Ib3VyICYmIF9taW51dGUgPT0gbWluTWludXRlKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobWluU2Vjb25kLS0gPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKG1pblNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWF4LnllYXIsIG1vbnRoOiBtYXgubW9udGgsIGRheTogbWF4LmRheSB9KSkge1xyXG4gICAgICAgICAgICBpZiAoX2hvdXIgPT0gbWF4SG91ciAmJiBfbWludXRlID09IG1heE1pbnV0ZSkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG1heFNlY29uZCsrIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChtYXhTZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbn1cclxuIl19