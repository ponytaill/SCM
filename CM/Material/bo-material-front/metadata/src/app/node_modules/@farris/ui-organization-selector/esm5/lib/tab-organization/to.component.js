/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-organization/to.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
var OrganizationComponent = /** @class */ (function () {
    function OrganizationComponent(apiService, cdr, favoritesTool, injector, ngZone, stateMgr, msgService) {
        var _this = this;
        this.apiService = apiService;
        this.cdr = cdr;
        this.favoritesTool = favoritesTool;
        this.injector = injector;
        this.ngZone = ngZone;
        this.stateMgr = stateMgr;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.dataPermission = false;
        this.dataPermissionIds = [];
        this.selectionsChange = new EventEmitter();
        this.originalTreeData = [];
        this.locationOrgText = '';
        this.treeListData = [];
        this.treeTableCols = [];
        this.selections = [];
        this.favoritesList = [];
        this.initLoad = true;
        this.checkedOrgs = [];
        this.loadingService = null;
        this.localeService = null;
        this.dataToChecked = [];
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.enableHierarchicalLoading) {
                return of(true);
            }
            if (!_this.multiSelect) {
                if (e.rowNode.isSelected) {
                    _this.setSelections([]);
                }
                else {
                    _this.setSelections(new Array(e.rowNode.node.data));
                }
                return of(false);
            }
            // const param: OrgRequestParam = {
            //     absOrgType: this.absOrgType,
            //     notGetStopOrg: this.notGetStopOrg,
            //     getCurUser: false,
            //     parentID: e.rowNode.id,
            //     withAllSub: true,
            //     getOrgAllPath: true
            // };
            // return this.apiService.getOrganization(param).pipe(
            //     switchMap(
            //         (data: any) => {
            //             // if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
            //             //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
            //             //     return of(false)
            //             // }
            //             // if (!e.rowNode.isChecked) {
            //             //     // todo 待验证，加入selection，
            //             //     data.data.forEach(item => {
            //             //         if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
            //             //             this.setSelections(item, ChangeType.Append, 'other');
            //             //         }
            //             //     })
            //             // } else {
            //             //     this.selections.forEach((selection, index) => {
            //             //         data.data.forEach(item => {
            //             //             if (selection[this.primaryField] === item[this.primaryField]) {
            //             //                 this.setSelections(item, ChangeType.Remove, 'other');
            //             //             }
            //             //         });
            //             //     });
            //             // }
            //             // this.cdr.detectChanges();
            //             return of(true);
            //         }
            //     )
            // );
        });
        this.beforeCheckAll = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.enableHierarchicalLoading) {
                return of(true);
            }
            /** @type {?} */
            var param = {
                absOrgType: _this.absOrgType,
                notGetStopOrg: _this.notGetStopOrg,
                getCurUser: false,
                parentID: e.instance.data[0].id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return _this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                // if (data['data'].length > this.selectedLimit) {
                //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                //     return of(false)
                // }
                _this.setSelections(data['data'], ChangeType.ValueChanged, 'other');
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.loadingService = this.injector.get(LoadingService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.favoritesSub.unsubscribe();
        this.selectionsSub.unsubscribe();
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.treeTableCols = [
            { field: 'name', title: this.localeService.getValue("organizationSelector.organization.orgName"), template: this.orgNameCell },
            { field: 'code', title: this.localeService.getValue("organizationSelector.organization.orgCode") }
        ];
        if (this.enableFavorites) {
            this.treeTableCols.push({
                field: '',
                title: this.localeService.getValue("organizationSelector.organization.favorite"),
                template: this.favoritesCell
            });
            this.treeTableCols[0].width = 300;
            this.treeTableCols[1].width = 300;
        }
        if (this.initLoad && this.isActiveTab) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
        this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.favoritesList = data;
            _this.setFavorites(_this.treeListData);
            _this.farrisTree.detectChanges();
        }));
        this.currentTabId = this.activeTabId;
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data.changeType === ChangeType.ValueChanged) {
                _this.selections = _.cloneDeep(data.value);
                if (_this.selections.length === 0) {
                    _this.dataToSelected = null;
                    _this.dataToChecked = [];
                    _this.farrisTree.clearCheckeds();
                    _this.farrisTree.clearSelections();
                    _this.farrisTree.detectChanges();
                }
            }
            else if (data.changeType === ChangeType.Remove) {
                _this.selections = _this.selections.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this.primaryField] !== data.value[_this.primaryField]; }));
                if (data.from == 'selection' && _this.currentTabId == 'organization') {
                    _this.inTreeList(_this.treeListData, data.value);
                    if (data.value.inTreeList) {
                        if (_this.multiSelect) {
                            _this.farrisTree.unCheckedNode(data.value[_this.primaryField]);
                        }
                        else {
                            _this.farrisTree.clearAll();
                        }
                    }
                }
            }
            else if (data.changeType === ChangeType.Append) {
                CommonUtil.findIndex(data.value[_this.primaryField], _this.primaryField, _this.selections) === -1 ? _this.selections.push(data.value) : null;
            }
        }));
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        /*
        const orgIdsChange = changes.orgIds;
        if (orgIdsChange && orgIdsChange.currentValue) {
            this.checkedOrgs = orgIdsChange.currentValue;
        }
        */
    };
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.loadTreeData = 
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    /**
     * @return {?}
     */
    function () {
        if (this.initLoad) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
    };
    // 设置当前组织树各个节点的收藏状态
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    OrganizationComponent.prototype.setFavorites = 
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    function (treeListData) {
        for (var i = 0; i < treeListData.length; i++) {
            if (CommonUtil.findIndex(treeListData[i].id, this.primaryField, this.favoritesList) === -1) {
                treeListData[i].data.inFavorites = false;
            }
            else {
                treeListData[i].data.inFavorites = true;
            }
            if (treeListData[i].children.length) {
                this.setFavorites(treeListData[i].children);
            }
        }
    };
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    OrganizationComponent.prototype.setSelections = /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    function (selections, changeType, from) {
        if (changeType === void 0) { changeType = ChangeType.ValueChanged; }
        if (from === void 0) { from = 'tree'; }
        this.stateMgr.emitSelections(selections, changeType, from);
    };
    // 组织树全选事件
    // 组织树全选事件
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.checkAll = 
    // 组织树全选事件
    /**
     * @return {?}
     */
    function () {
        if (!this.enableHierarchicalLoading) {
            /** @type {?} */
            var checkeds_1 = [];
            this.farrisTree.checkeds.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                checkeds_1.push(item.data);
            }));
            this.setSelections(checkeds_1);
        }
    };
    // 组织树取消全选事件
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.unCheckAll = 
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    function () {
        this.setSelections([]);
    };
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.changeSelections = 
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /*
        if (!this.enableHierarchicalLoading && !!e.originalEvent) {
            this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        }
        */
        this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
    };
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.toggleChecked = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            checkeds.push(item.data);
        }));
        this.setSelections(checkeds.concat(this.dataToChecked));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.toggleSelected = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            selected.push(item.data);
        }));
        this.setSelections(selected);
    };
    // 根据传入的组织id确定已选择组织
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    OrganizationComponent.prototype.assembleDataByOrgIds = 
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        var _this = this;
        if (!ids || ids.length === 0) {
            return;
        }
        if (ids && ids.length > 0 && !this.multiSelect) {
            this.msgService.show('warning', this.localeService.getValue("organizationSelector.errorMessage.multiSelect"), true);
            return;
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            idList: ids,
            getCurUser: false,
            getOrgAllPath: true,
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.data && res.data.length > 0) {
                _this.checkedOrgs = res.data;
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.selections) === -1) {
                        _this.setSelections(item, ChangeType.Append, 'other');
                    }
                }));
                _this.tickSelections();
                _this.cdr.detectChanges();
            }
        }));
    };
    // 分层加载组织树
    // 分层加载组织树
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.hlAssembleData = 
    // 分层加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        /** @type {?} */
        var layerList = [];
        /** @type {?} */
        var layer = this.layer;
        while (layer > 0) {
            layerList.push(layer);
            layer -= 1;
        }
        param.layerList = layerList;
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.data) {
                return;
            }
            _this.originalTreeData = res.data;
            if (res && res.curAbsUser && res.curAbsUser.orgAllPathInfo) {
                /** @type {?} */
                var curUserOrgPath = ((/** @type {?} */ (res.curAbsUser.orgAllPathInfo))).filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    return !res.data.find((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) { return data[_this.primaryField] == item[_this.primaryField]; }));
                }));
                res.data = res.data.concat(curUserOrgPath || []);
            }
            if (_this.orgIds.length == 0) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    item.selectable = true;
                }));
            }
            if (_this.enableFavorites) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            _this.treeListData = _this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            _this.farrisTree.loadData(_this.treeListData);
            if (_this.multiSelect) {
                _this.checkOrgTreeNodes();
            }
            else {
                _this.selectOrgTreeNode();
            }
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 全加载组织树
    // 全加载组织树
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.assembleData = 
    // 全加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.data) {
                return;
            }
            if (_this.enableFavorites) {
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            _this.originalTreeData = res.data;
            _this.treeListData = _this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            _this.farrisTree.loadData(_this.treeListData);
            if (_this.multiSelect) {
                _this.checkOrgTreeNodes();
            }
            else {
                _this.selectOrgTreeNode();
            }
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 确定已选组织是否在当前组织树内
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    OrganizationComponent.prototype.inTreeList = 
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    function (treeListData, item) {
        for (var i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item[this.primaryField]) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    };
    // 在当前组织树内勾选所有已选择的组织
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    OrganizationComponent.prototype.tickSelections = 
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    function () {
        // const ids = [];
        // this.selectedDataNotInTreeList = [];
        // this.selections.forEach(item => {
        //     this.inTreeList(this.treeListData, item);
        //     if (!!item.inTreeList) {
        //         ids.push(item[this.primaryField]);
        //     } else {
        //         if(!this.multiSelect) {
        //             this.singleSelectedData = null;
        //         }
        //         this.selectedDataNotInTreeList.push(item);
        //     }
        // });
        // this.ngZone.runOutsideAngular(() => {
        //     setTimeout(() => {
        //         if (!ids.length) {
        //             return;
        //         }
        //         if (this.multiSelect) {
        //             this.farrisTree.checkedNodes(ids, true, true);
        //         } else {
        //             this.farrisTree.clearSelections();
        //             //
        //             this.farrisTree.detectChanges();
        //             this.selectOrgTreeNode();
        //         }
        //     })
        // })
    };
    /**
    * 组织数据转换
    * @param plainSource 接口原始数据
    * @param layer 层级
    * @returns 返回树形接口的数据
    */
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    OrganizationComponent.prototype.dataToTree = /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    function (plainSource, layer, expandedPath) {
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var treeSource = this.dealData(plainSource, expandedPath);
        // const parents = treeSource.filter(item => {
        //     return item.data.layer === layer;
        // });
        // this.treeData(parents, treeSource, 1);
        return treeSource;
    };
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    OrganizationComponent.prototype.dealDataWhenExpandTreeNode = /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    function (data, expandedPath) {
        var _this = this;
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            var maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (var a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        var newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var newsDataObj = {
                    data: {
                        orgId: item[_this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: []
                };
                // let expanded = [];
                // if (this.enableHierarchicalLoading) {
                //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //         newsDataObj.leaf = false;
                //         newsDataObj.expanded = false;
                //     }
                // }
                if (Number(item.layer) >= _this.layer) {
                    newsDataObj.expanded = false;
                }
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                    newsDataObj.expanded = true;
                }
                if (_this.enableHierarchicalLoading && item.isDetail === '0') {
                    newsDataObj.leaf = false;
                }
                newDatas.push(newsDataObj);
            }));
        }
        return newDatas;
    };
    /**
     * 预处理组织数据
     */
    /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    OrganizationComponent.prototype.dealData = /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    function (data, expandedPath) {
        var _this = this;
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            var maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (var a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        var nodes = new Map();
        /** @type {?} */
        var newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                // const newsDataObj: any = {
                //     data: {
                //         orgId: item[this.primaryField],
                //         name: item.name,
                //         path: item.path,
                //         code: item.code,
                //         layer: Number(item.layer),
                //         orgAllPath: item.orgAllPath,
                //         inFavorites: item.inFavorites
                //     },
                //     expanded: true,
                //     children: []
                // };
                // // let expanded = [];
                // // if (this.enableHierarchicalLoading) {
                // //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     newsDataObj.expanded = false;
                //     if (this.enableHierarchicalLoading && item.isDetail === '0') {
                //         newsDataObj.leaf = false;
                //     }
                // }
                // // todo 分层加载需要
                // //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //     //newsDataObj.leaf = false;
                //    // newsDataObj.expanded = false;
                // //}
                // newDatas.push(newsDataObj);
                /** @type {?} */
                var path = item['path'];
                /** @type {?} */
                var parentPath = Number(item['layer']) > 1 ? ((/** @type {?} */ (item['path']))).slice(0, 4 * (Number(item['layer']) - 1)) : 'top';
                if (!nodes[path]) {
                    nodes[path] = { children: [] };
                }
                nodes[path] = {
                    data: {
                        orgId: item[_this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: nodes[path]['children']
                };
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1 || Number(item.layer) < _this.layer) {
                    nodes[path]['expanded'] = true;
                }
                else {
                    nodes[path]['expanded'] = false;
                    if (_this.enableHierarchicalLoading && item.isDetail === '0') {
                        nodes[path]['leaf'] = false;
                    }
                }
                if (_this.dataPermission && _this.dataPermissionIds.length) {
                    /** @type {?} */
                    var target = _this.dataPermissionIds.find((/**
                     * @param {?} t
                     * @return {?}
                     */
                    function (t) { return t == item['orgId']; }));
                    nodes[path]['selectable'] = target ? true : false;
                }
                // todo 分层加载需要
                //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //newsDataObj.leaf = false;
                // newsDataObj.expanded = false;
                //}
                if (parentPath == 'top') {
                    newDatas.push(nodes[path]);
                }
                else {
                    if (!nodes[parentPath]) {
                        nodes[parentPath] = { children: [] };
                    }
                    ((/** @type {?} */ (nodes[parentPath]['children']))).push(nodes[path]);
                }
            }));
        }
        return newDatas;
    };
    /**
     * 数据转换
     * @param parents 父级节点信息
     * @param treeSource 原始数据信息
     * @param layer 层级
     */
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    OrganizationComponent.prototype.treeData = /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    function (parents, treeSource, layer) {
        var _this = this;
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        function (parent) {
            /** @type {?} */
            var parentPath = parent['data']['path'];
            /** @type {?} */
            var parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    var itemPath = item['data']['path'];
                    /** @type {?} */
                    var itemLayer = item['data']['layer'];
                    /** @type {?} */
                    var targetPath = void 0;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        _this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    };
    // 收藏或取消收藏当前节点对应的组织
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    OrganizationComponent.prototype.toggleFavorites = 
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    };
    // 监听组织树展开事件
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    OrganizationComponent.prototype.listenTreeExpand = 
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        // todo 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    };
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    OrganizationComponent.prototype.getOrganizationByParentNode = 
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    function (parentNode) {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            parentID: parentNode.id,
            notGetStopOrg: this.notGetStopOrg,
            getCurUser: false,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.data) {
                /** @type {?} */
                var newDatas_1 = [];
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.originalTreeData) === -1) {
                        item.selectable = true;
                        if (_this.dataPermission && _this.dataPermissionIds.length) {
                            /** @type {?} */
                            var target = _this.dataPermissionIds.find((/**
                             * @param {?} t
                             * @return {?}
                             */
                            function (t) { return t == item['orgId']; }));
                            if (!target) {
                                item.selectable = false;
                            }
                        }
                        _this.originalTreeData.push(item);
                    }
                    if (_this.enableFavorites) {
                        item.inFavorites = true;
                        if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.favoritesList) === -1) {
                            item.inFavorites = false;
                        }
                    }
                    newDatas_1.push(item);
                }));
                /** @type {?} */
                var nodes = _this.dealDataWhenExpandTreeNode(newDatas_1);
                _this.farrisTree.appendChildren(nodes, parentNode);
                _this.farrisTree.detectChanges();
                if (_this.multiSelect) {
                    _this.checkOrgTreeNodes();
                }
                else {
                    _this.selectOrgTreeNode();
                }
                if (_this.loadingService) {
                    _this.loadingService.close();
                }
            }
        }));
    };
    // 返回已经该节点是否展开过
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    OrganizationComponent.prototype.nodeExpanded = 
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    function (item, arr, expanded) {
        for (var i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    };
    // 展开节点
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    OrganizationComponent.prototype.expandTreeNode = 
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    function (treeData, path, layer) {
        var _this = this;
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (path.includes(node.data.path)) {
                _this.farrisTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                _this.expandTreeNode(node.children, path, layer);
            }
        }));
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.selectOrgTreeNode = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.treeListData && this.selections.length) {
            this.dataToSelected = this.selections[0];
            // if (!this.farrisTree.selectedRow) {
            //     if (this.orgTreeTimer) {
            //         clearTimeout(this.orgTreeTimer);
            //     }
            //     this.orgTreeTimer = 
            // } else {
            //     this.farrisTree.scrollToCurrentNode();
            // }
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.inTreeList(_this.treeListData, _this.dataToSelected);
                if (_this.dataToSelected.inTreeList) {
                    _this.farrisTree.selectNode(_this.dataToSelected[_this.primaryField]);
                    _this.dataToSelected = null;
                }
            }), 300);
        }
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.checkOrgTreeNodes = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.treeListData && this.selections.length) {
            this.dataToChecked = this.selections;
            /** @type {?} */
            var checkedNodes_1 = [];
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.dataToChecked.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    _this.inTreeList(_this.treeListData, item);
                    if (item.inTreeList) {
                        checkedNodes_1.push(item[_this.primaryField]);
                    }
                }));
                _this.dataToChecked = _this.dataToChecked.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return !checkedNodes_1.includes(item[_this.primaryField]); }));
                if (checkedNodes_1.length) {
                    _this.farrisTree.checkedNodes(checkedNodes_1, true, true);
                }
            }), 300);
        }
    };
    OrganizationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-org',
                    template: "<farris-treetable #farristree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"primaryField\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"!multiSelect\" [showBorder]=\"false\" [showCheckbox]=\"multiSelect\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\"\r\n    [virtualized]=\"true\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (checkAll)=\"checkAll()\" (unCheckAll)=\"unCheckAll()\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgNameCell let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F-\u6536\u85CF\u5217 -->\r\n<ng-template #favoritesCell let-ctx>\r\n    <span class=\"f-icon f-icon-star\" [class.default-light-color]=\"ctx.node.data.inFavorites\"\r\n        [class.default-dark-color]=\"!ctx.node.data.inFavorites\" (click)=\"toggleFavorites($event, ctx.node.data)\"></span>\r\n</ng-template>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    OrganizationComponent.ctorParameters = function () { return [
        { type: ApiService },
        { type: ChangeDetectorRef },
        { type: FavoritesTool },
        { type: Injector },
        { type: NgZone },
        { type: StateMgrTool },
        { type: MessagerService }
    ]; };
    OrganizationComponent.propDecorators = {
        enableFavorites: [{ type: Input }],
        baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
        farrisTree: [{ type: ViewChild, args: ['farristree',] }],
        orgNameCell: [{ type: ViewChild, args: ['orgNameCell',] }],
        favoritesCell: [{ type: ViewChild, args: ['favoritesCell',] }],
        primaryField: [{ type: Input }],
        enableHierarchicalLoading: [{ type: Input }],
        notGetStopOrg: [{ type: Input }],
        layer: [{ type: Input }],
        multiSelect: [{ type: Input }],
        absOrgType: [{ type: Input }],
        cascadeCheck: [{ type: Input }],
        cascadeUp: [{ type: Input }],
        cascadeDown: [{ type: Input }],
        showCheckAll: [{ type: Input }],
        keepSelect: [{ type: Input }],
        pathLength: [{ type: Input }],
        orgIds: [{ type: Input }],
        selectedLimit: [{ type: Input }],
        virtualizedLoad: [{ type: Input }],
        isActiveTab: [{ type: Input }],
        activeTabId: [{ type: Input }],
        dataPermission: [{ type: Input }],
        dataPermissionIds: [{ type: Input }],
        selectionsChange: [{ type: Output }]
    };
    return OrganizationComponent;
}());
export { OrganizationComponent };
if (false) {
    /** @type {?} */
    OrganizationComponent.prototype.enableFavorites;
    /** @type {?} */
    OrganizationComponent.prototype.baseCls;
    /** @type {?} */
    OrganizationComponent.prototype.farrisTree;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameCell;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesCell;
    /** @type {?} */
    OrganizationComponent.prototype.primaryField;
    /** @type {?} */
    OrganizationComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    OrganizationComponent.prototype.notGetStopOrg;
    /** @type {?} */
    OrganizationComponent.prototype.layer;
    /** @type {?} */
    OrganizationComponent.prototype.multiSelect;
    /** @type {?} */
    OrganizationComponent.prototype.absOrgType;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeCheck;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeUp;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeDown;
    /** @type {?} */
    OrganizationComponent.prototype.showCheckAll;
    /** @type {?} */
    OrganizationComponent.prototype.keepSelect;
    /** @type {?} */
    OrganizationComponent.prototype.pathLength;
    /** @type {?} */
    OrganizationComponent.prototype.orgIds;
    /** @type {?} */
    OrganizationComponent.prototype.selectedLimit;
    /** @type {?} */
    OrganizationComponent.prototype.virtualizedLoad;
    /** @type {?} */
    OrganizationComponent.prototype.isActiveTab;
    /** @type {?} */
    OrganizationComponent.prototype.activeTabId;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermission;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermissionIds;
    /** @type {?} */
    OrganizationComponent.prototype.selectionsChange;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesSub;
    /** @type {?} */
    OrganizationComponent.prototype.originalTreeData;
    /** @type {?} */
    OrganizationComponent.prototype.locationOrgText;
    /** @type {?} */
    OrganizationComponent.prototype.treeListData;
    /** @type {?} */
    OrganizationComponent.prototype.treeTableCols;
    /** @type {?} */
    OrganizationComponent.prototype.selections;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesList;
    /** @type {?} */
    OrganizationComponent.prototype.initLoad;
    /** @type {?} */
    OrganizationComponent.prototype.checkedOrgs;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.localeService;
    /** @type {?} */
    OrganizationComponent.prototype.dataToChecked;
    /** @type {?} */
    OrganizationComponent.prototype.dataToSelected;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.orgTreeTimer;
    /** @type {?} */
    OrganizationComponent.prototype.currentTabId;
    /** @type {?} */
    OrganizationComponent.prototype.beforeClickNode;
    /** @type {?} */
    OrganizationComponent.prototype.beforeCheckAll;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG8uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1vcmdhbml6YXRpb24tc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvdGFiLW9yZ2FuaXphdGlvbi90by5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFtRCxpQkFBaUIsRUFBWSxRQUFRLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUM5SyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFFL0IsT0FBTyxFQUFZLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0QsT0FBTyxFQUFFLFVBQVUsRUFBbUIsTUFBTSx3QkFBd0IsQ0FBQztBQUNyRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFZLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTFELE9BQU8sRUFBRSxTQUFTLEVBQU8sTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVsRTtJQWdJSSwrQkFDWSxVQUFzQixFQUN0QixHQUFzQixFQUN0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SUFDekIsNkNBQStCOztJQUMvQiwwQ0FBNEI7O0lBQzVCLDRDQUE4Qjs7SUFDOUIsNkNBQStCOztJQUMvQiwyQ0FBNkI7O0lBQzdCLDJDQUF3Qjs7SUFFeEIsdUNBQTBCOztJQUMxQiw4Q0FBK0I7O0lBQy9CLGdEQUFrQzs7SUFDbEMsNENBQThCOztJQUM5Qiw0Q0FBNkI7O0lBQzdCLCtDQUFnQzs7SUFDaEMsa0RBQTBDOztJQUMxQyxpREFBcUQ7Ozs7O0lBRXJELDhDQUFvQzs7Ozs7SUFDcEMsNkNBQW1DOztJQUNuQyxpREFBc0I7O0lBQ3RCLGdEQUFxQjs7SUFDckIsNkNBQThCOztJQUM5Qiw4Q0FBbUI7O0lBQ25CLDJDQUFnQjs7SUFDaEIsOENBQW1COztJQUNuQix5Q0FBZ0I7O0lBQ2hCLDRDQUFpQjs7Ozs7SUFDakIsK0NBQThDOzs7OztJQUM5Qyw4Q0FBNEM7O0lBQzVDLDhDQUFtQjs7SUFDbkIsK0NBQW9COzs7OztJQUNwQiw2Q0FBMEI7O0lBQzFCLDZDQUFxQjs7SUFFckIsZ0RBaURFOztJQUVGLCtDQXdCQzs7Ozs7SUFHRywyQ0FBOEI7Ozs7O0lBQzlCLG9DQUE4Qjs7Ozs7SUFDOUIsOENBQW9DOzs7OztJQUNwQyx5Q0FBMEI7Ozs7O0lBQzFCLHVDQUFzQjs7Ozs7SUFDdEIseUNBQThCOzs7OztJQUM5QiwyQ0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIEluamVjdG9yLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBIb3N0QmluZGluZywgTmdab25lLCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBub0RhdGFJbWcgfSBmcm9tICcuLi8uLi9hc3NldHMvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgT3JnUmVxdWVzdFBhcmFtIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5kZXgudHlwZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWwgfSBmcm9tICcuLi8uLi91dGlscy9jb21tb24udG9vbCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IFN0YXRlTWdyVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL3N0YXRlLm1nci50b29sJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9jYWxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItb3JnJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi90by5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi90by5jb21wb25lbnQuY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmdhbml6YXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuXHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXZvcml0ZXM6IGJvb2xlYW47XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtdXRpbHMtZmlsbC1mbGV4LWNvbHVtbicpIGJhc2VDbHMgPSB0cnVlO1xyXG4gICAgQFZpZXdDaGlsZCgnZmFycmlzdHJlZScpIGZhcnJpc1RyZWU6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ29yZ05hbWVDZWxsJykgb3JnTmFtZUNlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAVmlld0NoaWxkKCdmYXZvcml0ZXNDZWxsJykgZmF2b3JpdGVzQ2VsbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBJbnB1dCgpIHByaW1hcnlGaWVsZCA9ICdvcmdJZCc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbm90R2V0U3RvcE9yZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGxheWVyOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBtdWx0aVNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGFic09yZ1R5cGU6IGFueTtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVDaGVjazogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVVcDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVEb3duOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQWxsOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkga2VlcFNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHBhdGhMZW5ndGggPSA0O1xyXG4gICAgLy8g5bey6YCJ5Lit57uE57uH55qEaWQsIOagueaNrue7hOe7h2lk6I635Y+W57uE57uH5a6M5pW05L+h5oGv77yM54S25ZCO6L+95Yqg5Yiwc2VsZWN0aW9ucy0tLXRvZG9cclxuICAgIEBJbnB1dCgpIG9yZ0lkczogc3RyaW5nW107XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZExpbWl0OiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSB2aXJ0dWFsaXplZExvYWQ6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBpc0FjdGl2ZVRhYjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGFjdGl2ZVRhYklkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBkYXRhUGVybWlzc2lvbiA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgZGF0YVBlcm1pc3Npb25JZHM6IHN0cmluZ1tdID0gW107XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0aW9uc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0aW9uc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBmYXZvcml0ZXNTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIG9yaWdpbmFsVHJlZURhdGEgPSBbXTtcclxuICAgIGxvY2F0aW9uT3JnVGV4dCA9ICcnO1xyXG4gICAgdHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdID0gW107XHJcbiAgICB0cmVlVGFibGVDb2xzID0gW107XHJcbiAgICBzZWxlY3Rpb25zID0gW107XHJcbiAgICBmYXZvcml0ZXNMaXN0ID0gW107XHJcbiAgICBpbml0TG9hZCA9IHRydWU7XHJcbiAgICBjaGVja2VkT3JncyA9IFtdO1xyXG4gICAgcHJpdmF0ZSBsb2FkaW5nU2VydmljZTogTG9hZGluZ1NlcnZpY2UgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlID0gbnVsbDtcclxuICAgIGRhdGFUb0NoZWNrZWQgPSBbXTtcclxuICAgIGRhdGFUb1NlbGVjdGVkOiBhbnk7XHJcbiAgICBwcml2YXRlIG9yZ1RyZWVUaW1lcjogYW55O1xyXG4gICAgY3VycmVudFRhYklkOiBzdHJpbmc7XHJcblxyXG4gICAgYmVmb3JlQ2xpY2tOb2RlID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoZS5yb3dOb2RlLmlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMobmV3IEFycmF5KGUucm93Tm9kZS5ub2RlLmRhdGEpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gb2YoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAvLyAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgIC8vICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgLy8gICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgIC8vICAgICBwYXJlbnRJRDogZS5yb3dOb2RlLmlkLFxyXG4gICAgICAgIC8vICAgICB3aXRoQWxsU3ViOiB0cnVlLFxyXG4gICAgICAgIC8vICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgLy8gfTtcclxuICAgICAgICAvLyByZXR1cm4gdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkucGlwZShcclxuICAgICAgICAvLyAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgIC8vICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIGlmIChkYXRhWydkYXRhJ10ubGVuZ3RoID4gdGhpcy5zZWxlY3RlZExpbWl0ICYmICFlLnJvd05vZGUuaXNDaGVja2VkKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgYOS6su+8jOS4gOasoeaAp+mAieaLqeS6hui2hei/hyR7dGhpcy5zZWxlY3RlZExpbWl0feadoeaVsOaNrn5gLCB0cnVlKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIG9mKGZhbHNlKVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyBpZiAoIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgLy8gdG9kbyDlvoXpqozor4HvvIzliqDlhaVzZWxlY3Rpb27vvIxcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpID09PSAtMSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLkFwcGVuZCwgJ290aGVyJyk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgIH0pXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goKHNlbGVjdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIGRhdGEuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25bdGhpcy5wcmltYXJ5RmllbGRdID09PSBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoaXRlbSwgQ2hhbmdlVHlwZS5SZW1vdmUsICdvdGhlcicpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgKVxyXG4gICAgICAgIC8vICk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJlZm9yZUNoZWNrQWxsID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFyZW50SUQ6IGUuaW5zdGFuY2UuZGF0YVswXS5pZCxcclxuICAgICAgICAgICAgd2l0aEFsbFN1YjogdHJ1ZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoZGF0YVsnZGF0YSddLmxlbmd0aCA+IHRoaXMuc2VsZWN0ZWRMaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLm1zZ1NlcnZpY2Uuc2hvdygnd2FybmluZycsIGDkurLvvIzkuIDmrKHmgKfpgInmi6nkuobotoXov4cke3RoaXMuc2VsZWN0ZWRMaW1pdH3mnaHmlbDmja5+YCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiBvZihmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGRhdGFbJ2RhdGEnXSwgQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsICdvdGhlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcGlTZXJ2aWNlOiBBcGlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIGZhdm9yaXRlc1Rvb2w6IEZhdm9yaXRlc1Rvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcclxuICAgICAgICBwcml2YXRlIHN0YXRlTWdyOiBTdGF0ZU1nclRvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBtc2dTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuY2RyID0gdGhpcy5pbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2FkaW5nU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSk7XHJcbiAgICAgICAgaWYoIXRoaXMubG9jYWxlU2VydmljZS5sYW5nRGF0YVsnb3JnYW5pemF0aW9uU2VsZWN0b3InXSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2Uuc2V0TG9jYWxlRGF0YShPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRyZWVUYWJsZUNvbHMgPSBbXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICduYW1lJywgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5vcmdOYW1lXCIpLCB0ZW1wbGF0ZTogdGhpcy5vcmdOYW1lQ2VsbCB9LFxyXG4gICAgICAgICAgICB7IGZpZWxkOiAnY29kZScsIHRpdGxlOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5vcmdhbml6YXRpb24ub3JnQ29kZVwiKSB9XHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZmllbGQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5mYXZvcml0ZVwiKSxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0aGlzLmZhdm9yaXRlc0NlbGxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29sc1swXS53aWR0aCA9IDMwMDtcclxuICAgICAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzWzFdLndpZHRoID0gMzAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pbml0TG9hZCAmJiB0aGlzLmlzQWN0aXZlVGFiKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5obEFzc2VtYmxlRGF0YSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmluaXRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzU3ViID0gdGhpcy5mYXZvcml0ZXNUb29sLmZhdm9yaXRlc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmZhdm9yaXRlc0xpc3QgPSBkYXRhO1xyXG4gICAgICAgICAgICB0aGlzLnNldEZhdm9yaXRlcyh0aGlzLnRyZWVMaXN0RGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VGFiSWQgPSB0aGlzLmFjdGl2ZVRhYklkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uc1N1YiA9IHRoaXMuc3RhdGVNZ3Iuc2VsZWN0aW9uc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLlZhbHVlQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gXy5jbG9uZURlZXAoZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVRvU2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVRvQ2hlY2tlZCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gdGhpcy5zZWxlY3Rpb25zLmZpbHRlcihpdGVtID0+IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdICE9PSBkYXRhLnZhbHVlW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhLmZyb20gPT0gJ3NlbGVjdGlvbicgJiYgdGhpcy5jdXJyZW50VGFiSWQgPT0gJ29yZ2FuaXphdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFsdWUuaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUudW5DaGVja2VkTm9kZShkYXRhLnZhbHVlW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2xlYXJBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNoYW5nZVR5cGUgPT09IENoYW5nZVR5cGUuQXBwZW5kKSB7XHJcbiAgICAgICAgICAgICAgICBDb21tb25VdGlsLmZpbmRJbmRleChkYXRhLnZhbHVlW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xID8gdGhpcy5zZWxlY3Rpb25zLnB1c2goZGF0YS52YWx1ZSkgOiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBjb25zdCBvcmdJZHNDaGFuZ2UgPSBjaGFuZ2VzLm9yZ0lkcztcclxuICAgICAgICBpZiAob3JnSWRzQ2hhbmdlICYmIG9yZ0lkc0NoYW5nZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkT3JncyA9IG9yZ0lkc0NoYW5nZS5jdXJyZW50VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICovXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yid5aeLdGFi6aG15LiN5Li657uE57uH5p625p6E77yM5YiH5o2i6Iez57uE57uH5p625p6E5pe26I635Y+W57uE57uH5pWw5o2uXHJcbiAgICBsb2FkVHJlZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5pbml0TG9hZCkge1xyXG4gICAgICAgICAgICBpZih0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGxBc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pbml0TG9hZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDorr7nva7lvZPliY3nu4Tnu4fmoJHlkITkuKroioLngrnnmoTmlLbol4/nirbmgIFcclxuICAgIHByaXZhdGUgc2V0RmF2b3JpdGVzKHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJlZUxpc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleCh0cmVlTGlzdERhdGFbaV0uaWQsIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdHJlZUxpc3REYXRhW2ldLmRhdGEuaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRyZWVMaXN0RGF0YVtpXS5kYXRhLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXModHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFNlbGVjdGlvbnMoc2VsZWN0aW9uczogYW55LCBjaGFuZ2VUeXBlID0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsIGZyb206IHN0cmluZyA9ICd0cmVlJykge1xyXG4gICAgICAgIHRoaXMuc3RhdGVNZ3IuZW1pdFNlbGVjdGlvbnMoc2VsZWN0aW9ucywgY2hhbmdlVHlwZSwgZnJvbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g57uE57uH5qCR5YWo6YCJ5LqL5Lu2XHJcbiAgICBjaGVja0FsbCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2hlY2tlZHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNoZWNrZWRzLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGNoZWNrZWRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g57uE57uH5qCR5Y+W5raI5YWo6YCJ5LqL5Lu2XHJcbiAgICB1bkNoZWNrQWxsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6YCJ5Lit77yI5Y+W5raI6YCJ5Lit44CB5Yu+6YCJ44CB5Y+W5raI5Yu+6YCJ77yJ5qCR6IqC54K55pe26Kem5Y+RXHJcbiAgICAvLyB0b2RvIOWIhuWxguWKoOi9veeahOaXtuWAmeWSi+WkhOeQhuaVsOaNru+8jGJlZm9yZVVuQ2hlY2tBbGzov5jmnKrmlK/mjIHjgIJcclxuICAgIGNoYW5nZVNlbGVjdGlvbnMoZTogYW55KSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiAhIWUub3JpZ2luYWxFdmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLm11bHRpU2VsZWN0ID8gdGhpcy50b2dnbGVDaGVja2VkKGUpIDogdGhpcy50b2dnbGVTZWxlY3RlZChlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm11bHRpU2VsZWN0ID8gdGhpcy50b2dnbGVDaGVja2VkKGUpIDogdGhpcy50b2dnbGVTZWxlY3RlZChlKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVDaGVja2VkKGU6IGFueSkge1xyXG4gICAgICAgIGxldCBjaGVja2VkcyA9IFtdO1xyXG4gICAgICAgIGUgJiYgZS5pbnN0YW5jZSAmJiBlLmluc3RhbmNlLmNoZWNrZWRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGNoZWNrZWRzLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoY2hlY2tlZHMuY29uY2F0KHRoaXMuZGF0YVRvQ2hlY2tlZCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZVNlbGVjdGVkKGU6IGFueSkge1xyXG4gICAgICAgIGxldCBzZWxlY3RlZCA9IFtdO1xyXG4gICAgICAgIGUgJiYgZS5pbnN0YW5jZSAmJiBlLmluc3RhbmNlLnNlbGVjdGlvbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgc2VsZWN0ZWQucHVzaChpdGVtLmRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhzZWxlY3RlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5qC55o2u5Lyg5YWl55qE57uE57uHaWTnoa7lrprlt7LpgInmi6nnu4Tnu4dcclxuICAgIHByaXZhdGUgYXNzZW1ibGVEYXRhQnlPcmdJZHMoaWRzOiBzdHJpbmdbXSl7XHJcbiAgICAgICAgaWYoIWlkcyB8fCBpZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaWRzICYmIGlkcy5sZW5ndGggPiAwICYmICF0aGlzLm11bHRpU2VsZWN0KXtcclxuICAgICAgICAgICAgdGhpcy5tc2dTZXJ2aWNlLnNob3coJ3dhcm5pbmcnLCB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5lcnJvck1lc3NhZ2UubXVsdGlTZWxlY3RcIiksIHRydWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgaWRMaXN0OiBpZHMsXHJcbiAgICAgICAgICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhICYmIHJlcy5kYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZE9yZ3MgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGl0ZW0sIENoYW5nZVR5cGUuQXBwZW5kLCAnb3RoZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlja1NlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIhuWxguWKoOi9vee7hOe7h+agkVxyXG4gICAgaGxBc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGxheWVyTGlzdCA9IFtdO1xyXG4gICAgICAgIGxldCBsYXllciA9IHRoaXMubGF5ZXI7XHJcbiAgICAgICAgd2hpbGUgKGxheWVyID4gMCkge1xyXG4gICAgICAgICAgICBsYXllckxpc3QucHVzaChsYXllcik7XHJcbiAgICAgICAgICAgIGxheWVyIC09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmFtLmxheWVyTGlzdCA9IGxheWVyTGlzdDtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzIHx8ICFyZXMuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5jdXJBYnNVc2VyICYmIHJlcy5jdXJBYnNVc2VyLm9yZ0FsbFBhdGhJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJVc2VyT3JnUGF0aCA9IChyZXMuY3VyQWJzVXNlci5vcmdBbGxQYXRoSW5mbyBhcyBBcnJheTxhbnk+KS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFyZXMuZGF0YS5maW5kKGRhdGEgPT4gZGF0YVt0aGlzLnByaW1hcnlGaWVsZF0gPT0gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YSA9IHJlcy5kYXRhLmNvbmNhdChjdXJVc2VyT3JnUGF0aCB8fCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodGhpcy5vcmdJZHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUZhdm9yaXRlcykge1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLmRhdGEsIDEsIHJlcy5jdXJBYnNVc2VyLmRlZmF1bHRPcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgaWYodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja09yZ1RyZWVOb2RlcygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YWo5Yqg6L2957uE57uH5qCRXHJcbiAgICBhc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXMgfHwgIXJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuZmF2b3JpdGVzTGlzdCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLmRhdGEsIDEsIHJlcy5jdXJBYnNVc2VyLmRlZmF1bHRPcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgaWYodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja09yZ1RyZWVOb2RlcygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56Gu5a6a5bey6YCJ57uE57uH5piv5ZCm5Zyo5b2T5YmN57uE57uH5qCR5YaFXHJcbiAgICBwcml2YXRlIGluVHJlZUxpc3QodHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdLCBpdGVtOiBhbnkpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWVMaXN0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmlkID09PSBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5pblRyZWVMaXN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0cmVlTGlzdERhdGFbaV0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLCBpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlnKjlvZPliY3nu4Tnu4fmoJHlhoXli77pgInmiYDmnInlt7LpgInmi6nnmoTnu4Tnu4dcclxuICAgIHByaXZhdGUgdGlja1NlbGVjdGlvbnMoKSB7XHJcbiAgICAgICAgLy8gY29uc3QgaWRzID0gW107XHJcbiAgICAgICAgLy8gdGhpcy5zZWxlY3RlZERhdGFOb3RJblRyZWVMaXN0ID0gW107XHJcbiAgICAgICAgLy8gdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuaW5UcmVlTGlzdCh0aGlzLnRyZWVMaXN0RGF0YSwgaXRlbSk7XHJcbiAgICAgICAgLy8gICAgIGlmICghIWl0ZW0uaW5UcmVlTGlzdCkge1xyXG4gICAgICAgIC8vICAgICAgICAgaWRzLnB1c2goaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICAgICAgaWYoIXRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLnNpbmdsZVNlbGVjdGVkRGF0YSA9IG51bGw7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YU5vdEluVHJlZUxpc3QucHVzaChpdGVtKTtcclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIC8vIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAvLyAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAoIWlkcy5sZW5ndGgpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jaGVja2VkTm9kZXMoaWRzLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAvLyAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLnNlbGVjdE9yZ1RyZWVOb2RlKCk7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH0pXHJcbiAgICAgICAgLy8gfSlcclxuICAgIH0gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAqIOe7hOe7h+aVsOaNrui9rOaNolxyXG4gICAgKiBAcGFyYW0gcGxhaW5Tb3VyY2Ug5o6l5Y+j5Y6f5aeL5pWw5o2uXHJcbiAgICAqIEBwYXJhbSBsYXllciDlsYLnuqdcclxuICAgICogQHJldHVybnMg6L+U5Zue5qCR5b2i5o6l5Y+j55qE5pWw5o2uXHJcbiAgICAqL1xyXG4gICAgcHJpdmF0ZSBkYXRhVG9UcmVlKHBsYWluU291cmNlOiBhbnksIGxheWVyOiBudW1iZXIsIGV4cGFuZGVkUGF0aDogc3RyaW5nID0gJycpIHtcclxuICAgICAgICBjb25zdCB0cmVlU291cmNlID0gdGhpcy5kZWFsRGF0YShwbGFpblNvdXJjZSwgZXhwYW5kZWRQYXRoKTtcclxuICAgICAgICAvLyBjb25zdCBwYXJlbnRzID0gdHJlZVNvdXJjZS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBpdGVtLmRhdGEubGF5ZXIgPT09IGxheWVyO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIC8vIHRoaXMudHJlZURhdGEocGFyZW50cywgdHJlZVNvdXJjZSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIHRyZWVTb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZWFsRGF0YVdoZW5FeHBhbmRUcmVlTm9kZShkYXRhOiBhbnlbXSwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgaWYoZXhwYW5kZWRQYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSBleHBhbmRlZFBhdGgubGVuZ3RoIC8gdGhpcy5wYXRoTGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGggLT0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBhID0gMDsgYSA8IG1heExlbmd0aDsgYSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKHsgcGF0aDogZXhwYW5kZWRQYXRoLnN1YnN0cmluZygwLCA0ICogKGEgKyAxKSkgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3c0RhdGFPYmo6IGFueSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ0lkOiBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBpdGVtLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IE51bWJlcihpdGVtLmxheWVyKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnQWxsUGF0aDogaXRlbS5vcmdBbGxQYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZhdm9yaXRlczogaXRlbS5pbkZhdm9yaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXhwYW5kZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy8gbGV0IGV4cGFuZGVkID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5ub2RlRXhwYW5kZWQobmV3c0RhdGFPYmosIHRoaXMudHJlZUxpc3REYXRhLCBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnICYmIE51bWJlcihpdGVtLmxheWVyKSA+PSB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICBpZihOdW1iZXIoaXRlbS5sYXllcikgPj0gdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbmV3RGF0YXMucHVzaChuZXdzRGF0YU9iaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3RGF0YXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpooTlpITnkIbnu4Tnu4fmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkZWFsRGF0YShkYXRhOiBhbnlbXSwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgaWYoZXhwYW5kZWRQYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSBleHBhbmRlZFBhdGgubGVuZ3RoIC8gdGhpcy5wYXRoTGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGggLT0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBhID0gMDsgYSA8IG1heExlbmd0aDsgYSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKHsgcGF0aDogZXhwYW5kZWRQYXRoLnN1YnN0cmluZygwLCA0ICogKGEgKyAxKSkgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xyXG4gICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IG5ld3NEYXRhT2JqOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBvcmdJZDogaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcGF0aDogaXRlbS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGxheWVyOiBOdW1iZXIoaXRlbS5sYXllciksXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG9yZ0FsbFBhdGg6IGl0ZW0ub3JnQWxsUGF0aCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgaW5GYXZvcml0ZXM6IGl0ZW0uaW5GYXZvcml0ZXNcclxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgICAgIC8vIC8vIGxldCBleHBhbmRlZCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gICAgIHRoaXMubm9kZUV4cGFuZGVkKG5ld3NEYXRhT2JqLCB0aGlzLnRyZWVMaXN0RGF0YSwgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gfVxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW0ucGF0aCwgJ3BhdGgnLCBwYXRoTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAvLyAvLyB0b2RvIOWIhuWxguWKoOi9vemcgOimgVxyXG4gICAgICAgICAgICAgICAgLy8gLy9pZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIGl0ZW0uaXNEZXRhaWwgPT09ICcwJyAmJiBOdW1iZXIoaXRlbS5sYXllcikgPj0gdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIC8vbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgLy8gbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vIC8vfVxyXG4gICAgICAgICAgICAgICAgLy8gbmV3RGF0YXMucHVzaChuZXdzRGF0YU9iaik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gaXRlbVsncGF0aCddO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IE51bWJlcihpdGVtWydsYXllciddKSA+IDEgPyAoaXRlbVsncGF0aCddIGFzIHN0cmluZykuc2xpY2UoMCwgNCAqIChOdW1iZXIoaXRlbVsnbGF5ZXInXSkgLSAxKSkgOiAndG9wJztcclxuICAgICAgICAgICAgICAgIGlmKCFub2Rlc1twYXRoXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdID0geyBjaGlsZHJlbjogW10gfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbm9kZXNbcGF0aF0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnSWQ6IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogaXRlbS5jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllcjogTnVtYmVyKGl0ZW0ubGF5ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdBbGxQYXRoOiBpdGVtLm9yZ0FsbFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluRmF2b3JpdGVzOiBpdGVtLmluRmF2b3JpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogbm9kZXNbcGF0aF1bJ2NoaWxkcmVuJ11cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtLnBhdGgsICdwYXRoJywgcGF0aExpc3QpICE9PSAtMSB8fCBOdW1iZXIoaXRlbS5sYXllcikgPCB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF1bJ2V4cGFuZGVkJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnZXhwYW5kZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydsZWFmJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmRhdGFQZXJtaXNzaW9uICYmIHRoaXMuZGF0YVBlcm1pc3Npb25JZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5kYXRhUGVybWlzc2lvbklkcy5maW5kKHQgPT4gdCA9PSBpdGVtWydvcmdJZCddKTtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnc2VsZWN0YWJsZSddID0gdGFyZ2V0ID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gdG9kbyDliIblsYLliqDovb3pnIDopoFcclxuICAgICAgICAgICAgICAgIC8vaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBpdGVtLmlzRGV0YWlsID09PSAnMCcgJiYgTnVtYmVyKGl0ZW0ubGF5ZXIpID49IHRoaXMubGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL25ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgIC8vIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgIGlmKHBhcmVudFBhdGggPT0gJ3RvcCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhcy5wdXNoKG5vZGVzW3BhdGhdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIW5vZGVzW3BhcmVudFBhdGhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhcmVudFBhdGhdID0geyBjaGlsZHJlbjogW10gfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAobm9kZXNbcGFyZW50UGF0aF1bJ2NoaWxkcmVuJ10gYXMgQXJyYXk8YW55PikucHVzaChub2Rlc1twYXRoXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3RGF0YXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmlbDmja7ovazmjaJcclxuICAgICAqIEBwYXJhbSBwYXJlbnRzIOeItue6p+iKgueCueS/oeaBr1xyXG4gICAgICogQHBhcmFtIHRyZWVTb3VyY2Ug5Y6f5aeL5pWw5o2u5L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gbGF5ZXIg5bGC57qnXHJcbiAgICAgKi9cclxuICAgIHRyZWVEYXRhKHBhcmVudHM6IGFueSwgdHJlZVNvdXJjZTogYW55LCBsYXllcjogbnVtYmVyKSB7XHJcbiAgICAgICAgcGFyZW50cy5mb3JFYWNoKHBhcmVudCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBwYXJlbnRbJ2RhdGEnXVsncGF0aCddO1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRMYXllciA9IHBhcmVudFsnZGF0YSddWydsYXllciddO1xyXG4gICAgICAgICAgICB0cmVlU291cmNlLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWydkYXRhJ10gJiYgaXRlbVsnZGF0YSddWydwYXRoJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtUGF0aCA9IGl0ZW1bJ2RhdGEnXVsncGF0aCddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1MYXllciA9IGl0ZW1bJ2RhdGEnXVsnbGF5ZXInXTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0UGF0aDogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtUGF0aCAmJiBpdGVtUGF0aC5sZW5ndGggPiBwYXJlbnRQYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRQYXRoID0gaXRlbVBhdGguc3Vic3RyKDAsIE51bWJlcihsYXllcikgKiA0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IHRhcmdldFBhdGggJiYgcGFyZW50TGF5ZXIgPT09IGl0ZW1MYXllciAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50WydjaGlsZHJlbiddLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSB0YXJnZXRQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEoW2l0ZW1dLCB0cmVlU291cmNlLCBOdW1iZXIobGF5ZXIpICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOaUtuiXj+aIluWPlua2iOaUtuiXj+W9k+WJjeiKgueCueWvueW6lOeahOe7hOe7h1xyXG4gICAgdG9nZ2xlRmF2b3JpdGVzKGU6IGFueSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLnRvZ2dsZUZhdm9yaXRlcyhlLCBpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnm5HlkKznu4Tnu4fmoJHlsZXlvIDkuovku7ZcclxuICAgIGxpc3RlblRyZWVFeHBhbmQob2JqOiBhbnkpIHtcclxuICAgICAgICAvLyB0b2RvIOWIhuWxguWKoOi9vVxyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgb2JqLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldE9yZ2FuaXphdGlvbkJ5UGFyZW50Tm9kZShvYmopO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDliIblsYLliqDovb3ml7bvvIzojrflj5bkuIvnuqfnu4Tnu4fmlbDmja7lubbkuLrlvZPliY3nu4Tnu4fmoJHmt7vliqDlrZDoioLngrlcclxuICAgIGdldE9yZ2FuaXphdGlvbkJ5UGFyZW50Tm9kZShwYXJlbnROb2RlOiBhbnkpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIHBhcmVudElEOiBwYXJlbnROb2RlLmlkLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMub3JpZ2luYWxUcmVlRGF0YSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2VsZWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZGF0YVBlcm1pc3Npb24gJiYgdGhpcy5kYXRhUGVybWlzc2lvbklkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGF0YVBlcm1pc3Npb25JZHMuZmluZCh0ID0+IHQgPT0gaXRlbVsnb3JnSWQnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUZhdm9yaXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhcy5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuZGVhbERhdGFXaGVuRXhwYW5kVHJlZU5vZGUobmV3RGF0YXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmFwcGVuZENoaWxkcmVuKG5vZGVzLCBwYXJlbnROb2RlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja09yZ1RyZWVOb2RlcygpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdE9yZ1RyZWVOb2RlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6L+U5Zue5bey57uP6K+l6IqC54K55piv5ZCm5bGV5byA6L+HXHJcbiAgICBwcml2YXRlIG5vZGVFeHBhbmRlZChpdGVtOiBhbnksIGFycjogVHJlZU5vZGVbXSwgZXhwYW5kZWQ6IGJvb2xlYW5bXSk6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmRhdGEuaWQgPT09IGFycltpXS5kYXRhLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBleHBhbmRlZFswXSA9IGFycltpXS5leHBhbmRlZDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhcnJbaV0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVFeHBhbmRlZChpdGVtLCBhcnJbaV0uY2hpbGRyZW4sIGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlsZXlvIDoioLngrlcclxuICAgIHByaXZhdGUgZXhwYW5kVHJlZU5vZGUodHJlZURhdGE6IGFueSwgcGF0aDogYW55W10sIGxheWVyOiBudW1iZXIpIHtcclxuICAgICAgICB0cmVlRGF0YS5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAocGF0aC5pbmNsdWRlcyhub2RlLmRhdGEucGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5leHBhbmROb2RlKG5vZGUuZGF0YS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5sYXllciA8IGxheWVyICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZFRyZWVOb2RlKG5vZGUuY2hpbGRyZW4sIHBhdGgsIGxheWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzZWxlY3RPcmdUcmVlTm9kZSgpIHtcclxuICAgICAgICBpZih0aGlzLnRyZWVMaXN0RGF0YSAmJiB0aGlzLnNlbGVjdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVRvU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGlvbnNbMF07XHJcbiAgICAgICAgICAgIC8vIGlmICghdGhpcy5mYXJyaXNUcmVlLnNlbGVjdGVkUm93KSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAodGhpcy5vcmdUcmVlVGltZXIpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5vcmdUcmVlVGltZXIpO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5vcmdUcmVlVGltZXIgPSBcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuZmFycmlzVHJlZS5zY3JvbGxUb0N1cnJlbnROb2RlKCk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIHRoaXMuZGF0YVRvU2VsZWN0ZWQpO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5kYXRhVG9TZWxlY3RlZC5pblRyZWVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLnNlbGVjdE5vZGUodGhpcy5kYXRhVG9TZWxlY3RlZFt0aGlzLnByaW1hcnlGaWVsZF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVRvU2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIGNoZWNrT3JnVHJlZU5vZGVzKCkge1xyXG4gICAgICAgIGlmKHRoaXMudHJlZUxpc3REYXRhICYmIHRoaXMuc2VsZWN0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkID0gdGhpcy5zZWxlY3Rpb25zO1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkTm9kZXMgPSBbXTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb0NoZWNrZWQuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0uaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkTm9kZXMucHVzaChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkID0gdGhpcy5kYXRhVG9DaGVja2VkLmZpbHRlcihpdGVtID0+ICFjaGVja2VkTm9kZXMuaW5jbHVkZXMoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pKTtcclxuICAgICAgICAgICAgICAgIGlmKGNoZWNrZWROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2hlY2tlZE5vZGVzKGNoZWNrZWROb2RlcywgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==