/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { EventEmitter } from '@angular/core';
import { Component, ElementRef, ChangeDetectorRef, Inject, Renderer2, Injector, Input, ViewChild, forwardRef, ViewEncapsulation, Output } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { take, debounceTime } from 'rxjs/operators';
import { BaseComboComponent, ComboService } from '@farris/ui-combo-list';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { LookupUtils } from '@farris/ui-lookup';
import { TreeTableComponent } from '@farris/ui-treetable';
import { DataTableComponent } from '@farris/ui-datatable';
import { Subject } from 'rxjs';
import { IdService } from '@farris/ui-common';
/** @type {?} */
var INPUT_COMBO_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    // tslint:disable-next-line: no-use-before-declare
    useExisting: forwardRef((/**
     * @return {?}
     */
    function () { return ComboLookupComponent; })),
    multi: true
};
var ComboLookupComponent = /** @class */ (function (_super) {
    tslib_1.__extends(ComboLookupComponent, _super);
    function ComboLookupComponent(el, cdr, document, render, comboService, injector) {
        var _this = _super.call(this, el, cdr, document, render, comboService, injector) || this;
        _this.el = el;
        _this.cdr = cdr;
        _this.document = document;
        _this.render = render;
        _this.comboService = comboService;
        _this.injector = injector;
        _this.panelHeight = 300;
        _this.comPosition = {
            'height.px': _this.panelHeight
        };
        _this.showHeader = true;
        _this.useTreeView = false;
        /**
         * -1: 不展开； 0: 全部展开；>0: 展开到指定级数
         */
        _this.expandLevel = -1;
        _this.cascade = {
            enable: false,
            up: false,
            down: false
        };
        /**
         * 树形帮助数据加载方式： default: 内置取数； loadall: 加载所有 layerload：分层加载
         */
        _this.loadTreeDataType = 'default';
        /**
         * 启用构造完整树过滤
         */
        _this.enableFullTree = true;
        _this.pageChanged = new EventEmitter();
        _this.pageSizeChanged = new EventEmitter();
        /**
         * 使用表单映射，默认 false
         */
        _this.useFormDataMapping = false;
        _this.loadFinish = false;
        _this.pageInfo = { pageSize: 20, pageIndex: 1, total: 0 };
        _this.tt$ = new Subject();
        _this.loaded$ = new Subject();
        _this._searchKeyWords = '';
        _this.loadDataType = 'all';
        _this.idSer = _this.injector.get(IdService, null);
        if (!_this.idSer) {
            _this.idSer = new IdService();
        }
        return _this;
    }
    Object.defineProperty(ComboLookupComponent.prototype, "columns", {
        get: /**
         * @return {?}
         */
        function () {
            var _this = this;
            /** @type {?} */
            var cols = this._columns !== undefined && this._columns.length > 0 ? this._columns : this.comboService.columns;
            if (this.useTreeView && cols.length > 1) {
                cols = cols.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.field === _this.textField; }));
            }
            return cols;
        },
        // 树列表默认展开层级。 -1： 不展开； 0： 全部展开； >0:  展开到指定级数；
        set: 
        // 树列表默认展开层级。 -1： 不展开； 0： 全部展开； >0:  展开到指定级数；
        /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._columns = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ComboLookupComponent.prototype, "pagination", {
        get: /**
         * @return {?}
         */
        function () {
            if (this._pagination !== undefined) {
                return this._pagination;
            }
            else {
                return this.comboService.pageInfo && this.pageInfo.enablePager ? this.pageInfo.enablePager : false;
            }
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._pagination = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ComboLookupComponent.prototype, "displayType", {
        get: /**
         * @return {?}
         */
        function () {
            return this.comboService.displayType;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this.comboService.displayType = val + '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ComboLookupComponent.prototype, "treeCmpRef", {
        get: /**
         * @return {?}
         */
        function () {
            return this._treeCmpRef;
        },
        set: /**
         * @param {?} cmf
         * @return {?}
         */
        function (cmf) {
            if (cmf) {
                cmf.cascadeCheck = this.cascade.enable;
                cmf.cascadeDown = this.cascade.down;
                cmf.cascadeUp = this.cascade.up;
                this.tt$.next(cmf);
            }
            this._treeCmpRef = cmf;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ComboLookupComponent.prototype, "tableCmpRef", {
        set: /**
         * @param {?} cmf
         * @return {?}
         */
        function (cmf) {
            var _this = this;
            if (cmf && this.pagination && this._tableCmpRef) {
                this.loaded$.pipe(take(1)).subscribe((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    cmf.loadData({
                        pageSize: _this.pageInfo.pageSize,
                        total: _this.pageInfo.total,
                        data: _this.data,
                        pageIndex: _this.pageInfo.pageIndex
                    });
                }));
            }
            if (!this._tableCmpRef && this.loadFinish && cmf) {
                cmf.loadData({
                    pageSize: this.pageInfo.pageSize,
                    total: this.pageInfo.total,
                    data: this.data,
                    pageIndex: this.pageInfo.pageIndex
                });
                this._tableCmpRef = cmf;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ComboLookupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.ngOnInit.call(this);
        this.treeClientSearch.pipe(debounceTime(300)).subscribe((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!_this.remoteSearch && _this.treeCmpRef) {
                _this.treeCmpRef.searchHandle.search(_this.textField, value);
            }
        }));
        this.comboService.treeInfo$.subscribe((/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            if (t) {
                if (_this.loadTreeDataType === 'default') {
                    _this.loadDataType = t.loadDataType;
                }
                _this.treeInfo = Object.assign(_this.treeInfo || {}, t);
            }
        }));
    };
    /**
     * @protected
     * @param {?} selections
     * @return {?}
     */
    ComboLookupComponent.prototype.onSelectionsChange = /**
     * @protected
     * @param {?} selections
     * @return {?}
     */
    function (selections) {
        var _this = this;
        if (this.displayType === 'LOOKUPLIST') {
            if (!this.multiSelect) {
                this.ownSelections = selections[0] ? selections[0] : {};
            }
            else {
                this.ownSelections = {};
                this.comboService.selections.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    _this.ownSelections[item[_this.idField]] = item;
                }));
            }
            this.pageInfo = tslib_1.__assign({}, this.pageInfo, this.comboService.pageInfo);
            this.loadFinish = true;
            this.cdr.detectChanges();
            this.loaded$.next(this.pageInfo);
        }
        else {
            if (this.treeCmpRef) {
                this.initTreeData();
            }
            else {
                this.tt$.pipe(take(1)).subscribe((/**
                 * @param {?} cmf
                 * @return {?}
                 */
                function (cmf) {
                    _this.treeCmpRef = cmf;
                    _this.initTreeData();
                    // cmf.checkedNodes(ids, true, false);
                    // cmf.updateSerializedValue();
                }));
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    ComboLookupComponent.prototype.initTreeData = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var __selections = this.comboService.selections.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n !== null && n !== undefined; }));
        /** @type {?} */
        var ids = [];
        this.ownSelections = __selections.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            ids.push(item[_this.idField]);
            return { data: item, id: item[_this.idField] };
        }));
        this.treeCmpRef.selections = this.ownSelections;
        this.treeCmpRef.checkeds = this.ownSelections;
        if (this.comboService.data && this.comboService.data.length) {
            if (this.treeCmpRef.checkValues && this.treeCmpRef.checkValues.length) {
                if (this.multiSelect) {
                    this.treeCmpRef.checkedNodes(this.treeCmpRef.checkValues);
                    this.treeCmpRef.selectNodes(this.treeCmpRef.checkValues);
                }
                else {
                    this.treeCmpRef.selectNodes(this.treeCmpRef.checkValues);
                }
            }
        }
    };
    /**
     * @protected
     * @return {?}
     */
    ComboLookupComponent.prototype.initDatasChangeAction = /**
     * @protected
     * @return {?}
     */
    function () { };
    /**
     * @private
     * @return {?}
     */
    ComboLookupComponent.prototype.isTree = /**
     * @private
     * @return {?}
     */
    function () {
        return this.displayType === 'LOOKUPTREELIST';
    };
    /**
     * @param {?=} clearMapFields
     * @return {?}
     */
    ComboLookupComponent.prototype.updateMappingFieldValue = /**
     * @param {?=} clearMapFields
     * @return {?}
     */
    function (clearMapFields) {
        var _this = this;
        if (clearMapFields === void 0) { clearMapFields = false; }
        if (this.ngControl && this.ngControl.formDirective &&
            this.ngControl.formDirective.form && this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            var bindingData_1 = this.ngControl.formDirective.form.bindingData;
            /** @type {?} */
            var bindingPath = this.ngControl.formDirective.form.bindingPath;
            /** @type {?} */
            var pathArr_1 = [];
            if (bindingPath) {
                pathArr_1 = bindingPath.split('/').filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n !== ''; }));
            }
            this.mappingField = this.mappingField ? this.mappingField : {};
            if (this.mapFields) {
                /** @type {?} */
                var helpFields = Object.keys(this.mapFields);
                helpFields.forEach((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) {
                    /** @type {?} */
                    var fieldNames = _this.mapFields[f] ? _this.mapFields[f] : '';
                    /** @type {?} */
                    var value = '';
                    if (!clearMapFields) {
                        /** @type {?} */
                        var text = _this.comboService.selections && _this.comboService.selections.map((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return _this.comboService.getValueByObj(f, item);
                        })).filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n !== null; })).join(_this.separator);
                        // value = text ? text : this.displayText ? this.displayText : '';
                        value = text || '';
                    }
                    if (fieldNames) {
                        fieldNames.split(',').forEach((/**
                         * @param {?} fieldName
                         * @return {?}
                         */
                        function (fieldName) {
                            /** @type {?} */
                            var _val = value;
                            if (_this.nosearch && fieldName === _this.ngControl.name) {
                                _val = _this.displayText;
                            }
                            if (bindingData_1.setValue) {
                                if (!_this.useFormDataMapping) {
                                    bindingData_1.setValue(pathArr_1.concat(fieldName.split('.')), _val, true, true);
                                }
                            }
                            else {
                                _this.commonUtils.setValue(bindingData_1, fieldName, value);
                            }
                        }));
                    }
                }));
            }
        }
    };
    /**
     * @return {?}
     */
    ComboLookupComponent.prototype.updateSelectedValues = /**
     * @return {?}
     */
    function () {
        if (this.ngControl &&
            this.ngControl.formDirective &&
            this.ngControl.formDirective.form &&
            this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            var bindingData = this.ngControl.formDirective.form.bindingData;
            /** @type {?} */
            var bindingPath = this.ngControl.formDirective.form.bindingPath;
            /** @type {?} */
            var pathArr = [];
            if (bindingPath) {
                pathArr = bindingPath.split('/').filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n !== ''; }));
            }
            /** @type {?} */
            var targetField = this.mappingField ? this.mapFields[this.idField] : '';
            if (targetField && targetField.indexOf(',') > -1) {
                targetField = targetField.split(',')[0];
            }
            // this.mappingField = this.mappingField ? this.mappingField : '';
            if (targetField && bindingData.getValue) {
                this.selectedValues = bindingData.getValue(pathArr.concat(targetField.split('.'))) || '';
            }
            else if (targetField) {
                this.selectedValues = this.commonUtils.getValue(targetField, bindingData) || '';
            }
        }
    };
    /**
     * @param {?} row
     * @return {?}
     */
    ComboLookupComponent.prototype.onSelectRows = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        if (this.displayType === 'LOOKUPLIST') {
            var data = row.data, index = row.index;
            this.comboService.selectItem(data, index);
            this.selectChange.emit({ data: data, index: index, instance: this });
        }
        else if (this.displayType === 'LOOKUPTREELIST') {
            var node = row.node;
            if (row.nodes) {
                this.comboService.selectItem(row.nodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.data; })));
            }
            else {
                this.comboService.selectItem(node.data);
            }
            this.selectChange.emit(node);
        }
        this.updateTextAndValues();
        if (!this.multiSelect) {
            this.comboService.isOpen$.next(false);
        }
    };
    /**
     * @param {?} row
     * @return {?}
     */
    ComboLookupComponent.prototype.onUnSelectRows = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        if (this.displayType === 'LOOKUPLIST') {
            var data = row.data;
            this.comboService.unSelectItem(data);
        }
        else if (this.displayType === 'LOOKUPTREELIST') {
            var node = row.node;
            this.comboService.unSelectItem(node.data);
            this.selectChange.emit(node);
        }
        this.updateTextAndValues();
    };
    /**
     * @param {?} ev
     * @return {?}
     */
    ComboLookupComponent.prototype.onCheckAll = /**
     * @param {?} ev
     * @return {?}
     */
    function (ev) {
        /** @type {?} */
        var state;
        /** @type {?} */
        var selections = [];
        if (this.displayType === 'LOOKUPTREELIST') {
            state = ev.checked;
            selections = this.treeCmpRef.state.rowNodes
                .filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.node.selectable === undefined || n.node.selectable; }))
                .map((/**
             * @param {?} r
             * @return {?}
             */
            function (r) { return r.node.data; }));
        }
        else {
            state = ev;
            selections = this.data;
        }
        if (state) {
            this.comboService.selectAll(selections);
        }
        else {
            this.comboService.unSelectAll(selections);
        }
        this.updateTextAndValues();
    };
    /**
     * @private
     * @return {?}
     */
    ComboLookupComponent.prototype.updateTextAndValues = /**
     * @private
     * @return {?}
     */
    function () {
        this.selectedValues = this.comboService.getValue(this.idField);
        /** @type {?} */
        var _displayText = this.comboService.getValue(this.textField);
        this.onValueChange({ text: _displayText, value: this.selectedValues, selections: this.selections });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ComboLookupComponent.prototype.onKeyup = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // console.log('key up', $event);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ComboLookupComponent.prototype.onKeydown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // console.log('key down', $event);
        if ($event.code === 'Tab') {
            this.hide(false);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComboLookupComponent.prototype.onPageChanged = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.uri) {
            this.getData(event).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) { return _this.comboService.loadLookUpDataTable(data, !!event.sortName); }));
        }
        else {
            this.pageChanged.emit(event);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComboLookupComponent.prototype.onPageSizeChanged = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.uri) {
            this.getData(event).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) { return _this.comboService.loadLookUpDataTable(data, !!event.sortName); }));
        }
        else {
            this.pageSizeChanged.emit(event);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ComboLookupComponent.prototype.onColumnSorted = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        var _a = tslib_1.__assign({}, event), sortName = _a.sortName, sortOrder = _a.sortOrder;
        this.getData({ sortName: sortName, sortOrder: sortOrder }, 'search').subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.comboService.loadLookUpDataTable(data, true);
        }));
    };
    /**
     * @return {?}
     */
    ComboLookupComponent.prototype.onClear = /**
     * @return {?}
     */
    function () {
        this.ownSelections = [];
        if (this.isTree() && this.treeCmpRef) {
            this.treeCmpRef.clearAll();
        }
        _super.prototype.onClear.call(this);
    };
    /**
     * @private
     * @param {?} parentPath
     * @param {?} parentLayer
     * @param {?} searchData
     * @return {?}
     */
    ComboLookupComponent.prototype.getChildren = /**
     * @private
     * @param {?} parentPath
     * @param {?} parentLayer
     * @param {?} searchData
     * @return {?}
     */
    function (parentPath, parentLayer, searchData) {
        /** @type {?} */
        var search = tslib_1.__assign({ parentLayer: parentLayer, category: 'children' }, searchData);
        if (this.treeInfo.layerType === 'parentId') {
            search['parentId'] = parentPath;
        }
        else {
            search['parentPath'] = parentPath;
        }
        /** @type {?} */
        var param = {
            searchValue: JSON.stringify(search),
            customData: this.customData,
            enableFullTree: this.enableFullTree,
            loadTreeDataType: this.loadTreeDataType
        };
        if (this._searchKeyWords) {
            param.enableFullTree = false;
            param.loadTreeDataType = 'layerload';
            if (this.treeInfo.layerType === 'parentId') {
                // 树形帮助查询后，展开节点时将相关查询参数传递到后端 2022-09-13
                search.searchValue = '';
                search.searchField = '*';
            }
            param.searchValue = JSON.stringify(search);
        }
        /** @type {?} */
        var tt = (/** @type {?} */ (this.treeCmpRef));
        if (tt && tt.sortName) {
            Object.assign(param, {
                sortName: tt.sortName,
                sortOrder: tt.sortOrder
            });
        }
        return this.comboService.getData(param, 'get', true);
    };
    /**
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    ComboLookupComponent.prototype.getData = /**
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    function (event, type) {
        if (type === void 0) { type = 'all'; }
        event = event || {};
        if (this._searchKeyWords) {
            event.search = {
                field: '*',
                value: this._searchKeyWords
            };
        }
        /** @type {?} */
        var params = this.buildQueryParams(event, type);
        return this.comboService.getData(params);
    };
    /** 构选查询参数 */
    /**
     * 构选查询参数
     * @private
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    ComboLookupComponent.prototype.buildQueryParams = /**
     * 构选查询参数
     * @private
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    function (event, type) {
        if (type === void 0) { type = 'all'; }
        /** @type {?} */
        var params = {};
        /** @type {?} */
        var searchParam = { category: type };
        if (event) {
            if (event.pageInfo) {
                params['pageIndex'] = event.pageInfo.pageIndex;
                params['pageSize'] = event.pageInfo.pageSize;
            }
            if (event.search) {
                searchParam['searchField'] = event.search.field;
                searchParam['searchValue'] = event.search.value;
            }
            if (event.sortName) {
                searchParam['sortName'] = event.sortName;
            }
            if (event.sortOrder) {
                searchParam['sortOrder'] = event.sortOrder;
            }
        }
        params['searchValue'] = JSON.stringify(searchParam);
        if (this.customData) {
            params['customData'] = this.customData;
        }
        return params;
    };
    /**
     * @param {?} value
     * @param {?} field
     * @return {?}
     */
    ComboLookupComponent.prototype.filterDataOnServer = /**
     * @param {?} value
     * @param {?} field
     * @return {?}
     */
    function (value, field) {
        if (!this.isOpen) {
            return;
        }
        /** @type {?} */
        var search = { search: { field: field, value: value } };
        if (value) {
            this._searchKeyWords = value;
        }
        else {
            this._searchKeyWords = '';
            search = null;
        }
        /** @type {?} */
        var params = this.buildQueryParams(search, 'search');
        this.comboService.serachValue$.next(params);
    };
    /**
     * @param {?} tn
     * @return {?}
     */
    ComboLookupComponent.prototype.onExpandNode = /**
     * @param {?} tn
     * @return {?}
     */
    function (tn) {
        var _this = this;
        if (tn.leaf || tn['showLoading']) {
            return;
        }
        if (!tn.children || !tn.children.length) {
            /** @type {?} */
            var parentPath = '';
            /** @type {?} */
            var parentLayer = -1;
            var _a = {
                value: this._searchKeyWords
            }, _b = _a.field, field = _b === void 0 ? '*' : _b, _c = _a.value, value = _c === void 0 ? '' : _c;
            /** @type {?} */
            var treeInfoField = this.treeInfo.dataField;
            if (this.treeInfo.layerType === 'parentId') {
                // 父ID加载方式
                parentPath = tn['id'];
                parentLayer = tn.data[treeInfoField][this.treeInfo.layerField];
            }
            else {
                if (treeInfoField) {
                    parentPath = tn.data[treeInfoField][this.treeInfo.pathField];
                    parentLayer = tn.data[treeInfoField][this.treeInfo.layerField];
                }
                else {
                    this.treeCmpRef.writeConsole('未找到分级信息。');
                }
            }
            this.getChildren(parentPath, parentLayer, {
                searchField: field === '*' ? '*' : field,
                searchValue: value
            }).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                if (tn && data.items && data.items.length) {
                    /** @type {?} */
                    var nodes = _this.comboService.checkNodeCanBeSelect(data.items, false);
                    _this.treeCmpRef.appendChildren(nodes, tn);
                }
                _this.treeCmpRef.detectChanges();
                _this.treeCmpRef.psRef.directiveRef.update();
            }));
        }
    };
    ComboLookupComponent.decorators = [
        { type: Component, args: [{
                    // tslint:disable-next-line: component-selector
                    selector: 'farris-combo-lookup',
                    template: "<input-group\r\n    #input\r\n    [attr.title]=\"enableTitle ? displayText : ''\"\r\n    [class.actived]=\"isOpen\"\r\n    [(value)]=\"displayText\"\r\n    [forcePlaceholder]=\"forcePlaceholder\"\r\n    [disabled]=\"disabled\"\r\n    [readonly]=\"readonly\"\r\n    [editable]=\"editable\"\r\n    [groupText]=\"groupIcon\"\r\n    [placeholder]=\"placeholder\"\r\n    [enableClear]=\"enableClear\"\r\n    (clickHandle)=\"onClick()\"\r\n    (inputClick)=\"onInputclick($event)\"\r\n    (blurHandle)=\"onBlur($event)\"\r\n    (focusHandle)=\"onFocus($event)\"\r\n    (valueChange)=\"onTextChange($event)\"\r\n    (clear)=\"onClear()\"\r\n    (keyupHandle)=\"onKeyup($event)\"\r\n    (keydownHandle)=\"onKeydown($event)\"\r\n    [maxLength]=\"maxLength\" \r\n    style=\"display: block;\"\r\n>\r\n</input-group>\r\n<div class=\"comboPanel f-area-hide\" *ngIf=\"isOpen\"  #comboPanel style=\"overflow: hidden; height: 100%; width: 100%\" >\r\n    <farris-datatable\r\n        *ngIf=\"displayType === 'LOOKUPLIST'\"\r\n        #dt\r\n        [width]=\"panelWidth\"\r\n        [height]=\"panelHeight\"\r\n        [columns]=\"columns\"\r\n        [data]=\"comboService.data$ | async\"\r\n        [selections]=\"ownSelections\"\r\n        [idField]=\"idField\"\r\n        [singleSelect]=\"!multiSelect\"\r\n        [pagination] = \"pagination\"\r\n        [pageSize]=\"pageInfo.pageSize\"\r\n        [pageIndex]=\"pageInfo.pageIndex\"\r\n        [pageList]=\"pageInfo.pageList\"\r\n        [total]=\"pageInfo.total\"\r\n        [pagerViewMode]=\"'simple'\"\r\n        [showPageInfo]=\"false\" \r\n        [showPageNumber]=\"false\" \r\n        [showPageList]=\"false\"\r\n        [remoteSort]=\"false\"\r\n        [showHeader]=\"showHeader\"\r\n        (selectRows)=\"onSelectRows($event)\"\r\n        (unSelectRow)=\"onUnSelectRows($event)\"\r\n        (checkAll)=\"onCheckAll($event)\"\r\n        (pageChanged)=\"onPageChanged($event)\"\r\n        (pageSizeChanged)=\"onPageSizeChanged($event)\"\r\n        (columnSorted)=\"onColumnSorted($event)\"\r\n    ></farris-datatable>\r\n\r\n    <farris-treetable #tt\r\n        *ngIf=\"displayType === 'LOOKUPTREELIST'\"\r\n        [showHeader]=\"!useTreeView && showHeader\"\r\n        [showBorder]=\"!useTreeView\" \r\n        [showHeader]=\"!useTreeView\"\r\n        [expandLevel]=\"expandLevel\"\r\n        [virtualized]=\"true\"\r\n\r\n        [columns]=\"columns\"\r\n        [singleSelect]=\"!multiSelect\"\r\n        [idField]=\"idField\"\r\n        [data]=\"comboService.data$ | async\"\r\n        [checkOnSelect]=\"true\"\r\n        [selectOnCheck]=\"true\"\r\n        [fixedHeader]=\"true\"\r\n        [showCheckbox]=\"multiSelect\"\r\n        [fit]=\"true\"\r\n        [remoteSort]=\"false\"\r\n        [loadDataType]=\"loadDataType\"\r\n        (nodeSelected)=\"onSelectRows($event)\"\r\n        (nodeUnSelect)=\"onUnSelectRows($event)\"\r\n        (nodeChecked)=\"onSelectRows($event)\"\r\n        (nodeUnChecked)=\"onUnSelectRows($event)\"\r\n        (checkAll)=\"onCheckAll($event)\"\r\n        (unCheckAll)=\"onCheckAll($event)\"\r\n        (expand)=\"onExpandNode($event)\"\r\n        \r\n    ></farris-treetable>\r\n</div>\r\n<!--\r\n    [width]=\"panelWidth\"\r\n    [height]=\"panelHeight\"\r\n     -->",
                    encapsulation: ViewEncapsulation.None,
                    // styleUrls: ['./combo-lookup.component.scss'],
                    providers: [INPUT_COMBO_VALUE_ACCESSOR, ComboService, LookupUtils]
                }] }
    ];
    /** @nocollapse */
    ComboLookupComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ChangeDetectorRef },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
        { type: Renderer2 },
        { type: ComboService },
        { type: Injector }
    ]; };
    ComboLookupComponent.propDecorators = {
        showHeader: [{ type: Input }],
        useTreeView: [{ type: Input }],
        columns: [{ type: Input }],
        pagination: [{ type: Input }],
        displayType: [{ type: Input }],
        expandLevel: [{ type: Input }],
        treeCmpRef: [{ type: ViewChild, args: ['tt',] }],
        tableCmpRef: [{ type: ViewChild, args: ['dt',] }],
        cascade: [{ type: Input }],
        treeInfo: [{ type: Input }],
        loadTreeDataType: [{ type: Input }],
        enableFullTree: [{ type: Input }],
        pageChanged: [{ type: Output }],
        pageSizeChanged: [{ type: Output }],
        useFormDataMapping: [{ type: Input }]
    };
    return ComboLookupComponent;
}(BaseComboComponent));
export { ComboLookupComponent };
if (false) {
    /** @type {?} */
    ComboLookupComponent.prototype.panelHeight;
    /** @type {?} */
    ComboLookupComponent.prototype.comPosition;
    /** @type {?} */
    ComboLookupComponent.prototype.showHeader;
    /** @type {?} */
    ComboLookupComponent.prototype.useTreeView;
    /**
     * -1: 不展开； 0: 全部展开；>0: 展开到指定级数
     * @type {?}
     */
    ComboLookupComponent.prototype.expandLevel;
    /** @type {?} */
    ComboLookupComponent.prototype.cascade;
    /** @type {?} */
    ComboLookupComponent.prototype.treeInfo;
    /**
     * 树形帮助数据加载方式： default: 内置取数； loadall: 加载所有 layerload：分层加载
     * @type {?}
     */
    ComboLookupComponent.prototype.loadTreeDataType;
    /**
     * 启用构造完整树过滤
     * @type {?}
     */
    ComboLookupComponent.prototype.enableFullTree;
    /** @type {?} */
    ComboLookupComponent.prototype.pageChanged;
    /** @type {?} */
    ComboLookupComponent.prototype.pageSizeChanged;
    /**
     * 使用表单映射，默认 false
     * @type {?}
     */
    ComboLookupComponent.prototype.useFormDataMapping;
    /** @type {?} */
    ComboLookupComponent.prototype.ownSelections;
    /** @type {?} */
    ComboLookupComponent.prototype.loadFinish;
    /** @type {?} */
    ComboLookupComponent.prototype.pageInfo;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.tt$;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.loaded$;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._columns;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._pagination;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._tableCmpRef;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._treeCmpRef;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._searchKeyWords;
    /** @type {?} */
    ComboLookupComponent.prototype.loadDataType;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.idSer;
    /** @type {?} */
    ComboLookupComponent.prototype.el;
    /** @type {?} */
    ComboLookupComponent.prototype.cdr;
    /** @type {?} */
    ComboLookupComponent.prototype.document;
    /** @type {?} */
    ComboLookupComponent.prototype.render;
    /** @type {?} */
    ComboLookupComponent.prototype.comboService;
    /** @type {?} */
    ComboLookupComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tYm8tbG9va3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktY29tYm8tbG9va3VwLyIsInNvdXJjZXMiOlsibGliL2NvbWJvLWxvb2t1cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzdDLE9BQU8sRUFDSCxTQUFTLEVBQVUsVUFBVSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQ25FLFFBQVEsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxpQkFBaUIsRUFBb0IsTUFBTSxFQUN0RixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUFRLElBQUksRUFBMEIsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDbEYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxXQUFXLEVBQVksTUFBTSxtQkFBbUIsQ0FBQztBQUMxRCxPQUFPLEVBQVksa0JBQWtCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUMxRCxPQUFPLEVBQUUsT0FBTyxFQUEyQixNQUFNLE1BQU0sQ0FBQztBQUN4RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7O0lBRXhDLDBCQUEwQixHQUFRO0lBQ3BDLE9BQU8sRUFBRSxpQkFBaUI7O0lBRTFCLFdBQVcsRUFBRSxVQUFVOzs7SUFBQyxjQUFNLE9BQUEsb0JBQW9CLEVBQXBCLENBQW9CLEVBQUM7SUFDbkQsS0FBSyxFQUFFLElBQUk7Q0FDZDtB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MkNBQTZCOzs7OztJQUM3Qiw0Q0FBMEI7Ozs7O0lBQzFCLDJDQUF5Qjs7Ozs7SUFDekIsK0NBQTZCOztJQUU3Qiw0Q0FBcUI7Ozs7O0lBRXJCLHFDQUF5Qjs7SUFHckIsa0NBQXFCOztJQUNyQixtQ0FBNkI7O0lBQzdCLHdDQUFzQzs7SUFDdEMsc0NBQXdCOztJQUN4Qiw0Q0FBaUM7O0lBQ2pDLHdDQUF5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIEVsZW1lbnRSZWYsIENoYW5nZURldGVjdG9yUmVmLCBJbmplY3QsIFJlbmRlcmVyMixcclxuICAgIEluamVjdG9yLCBJbnB1dCwgVmlld0NoaWxkLCBmb3J3YXJkUmVmLCBWaWV3RW5jYXBzdWxhdGlvbiwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT3V0cHV0XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgc2tpcCwgdGFrZSwgZmlsdGVyLCB0YWtlVW50aWwsIG1hcCwgZGVib3VuY2VUaW1lIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBCYXNlQ29tYm9Db21wb25lbnQsIENvbWJvU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tYm8tbGlzdCc7XHJcbmltcG9ydCB7IE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBMb29rdXBVdGlscywgVHJlZUluZm8gfSBmcm9tICdAZmFycmlzL3VpLWxvb2t1cCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IERhdGFUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YXRhYmxlJztcclxuaW1wb3J0IHsgU3ViamVjdCwgZm9ya0pvaW4sIGludGVydmFsLCB6aXAgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgSWRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5cclxuY29uc3QgSU5QVVRfQ09NQk9fVkFMVUVfQUNDRVNTT1I6IGFueSA9IHtcclxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby11c2UtYmVmb3JlLWRlY2xhcmVcclxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IENvbWJvTG9va3VwQ29tcG9uZW50KSxcclxuICAgIG11bHRpOiB0cnVlXHJcbn07XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogY29tcG9uZW50LXNlbGVjdG9yXHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy1jb21iby1sb29rdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2NvbWJvLWxvb2t1cC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gICAgLy8gc3R5bGVVcmxzOiBbJy4vY29tYm8tbG9va3VwLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgICBwcm92aWRlcnM6IFtJTlBVVF9DT01CT19WQUxVRV9BQ0NFU1NPUiwgQ29tYm9TZXJ2aWNlLCBMb29rdXBVdGlsc11cclxufSlcclxuZXhwb3J0IGNsYXNzIENvbWJvTG9va3VwQ29tcG9uZW50IGV4dGVuZHMgQmFzZUNvbWJvQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIHBhbmVsSGVpZ2h0ID0gMzAwO1xyXG5cclxuICAgIGNvbVBvc2l0aW9uID0ge1xyXG4gICAgICAgICdoZWlnaHQucHgnOiB0aGlzLnBhbmVsSGVpZ2h0XHJcbiAgICB9O1xyXG5cclxuICAgIEBJbnB1dCgpIHNob3dIZWFkZXIgPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpIHVzZVRyZWVWaWV3ID0gZmFsc2U7XHJcbiAgICAvLyDmoJHliJfooajpu5jorqTlsZXlvIDlsYLnuqfjgIIgLTHvvJog5LiN5bGV5byA77ybIDDvvJog5YWo6YOo5bGV5byA77ybID4wOiAg5bGV5byA5Yiw5oyH5a6a57qn5pWw77ybXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGNvbHVtbnModmFsdWU6IGFueVtdKSB7XHJcbiAgICAgICAgdGhpcy5fY29sdW1ucyA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IGNvbHVtbnMoKTogYW55W10ge1xyXG4gICAgICAgIGxldCBjb2xzID0gdGhpcy5fY29sdW1ucyAhPT0gdW5kZWZpbmVkICYmIHRoaXMuX2NvbHVtbnMubGVuZ3RoID4gMCA/IHRoaXMuX2NvbHVtbnMgOiB0aGlzLmNvbWJvU2VydmljZS5jb2x1bW5zO1xyXG4gICAgICAgIGlmICh0aGlzLnVzZVRyZWVWaWV3ICYmIGNvbHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBjb2xzID0gY29scy5maWx0ZXIobiA9PiBuLmZpZWxkID09PSB0aGlzLnRleHRGaWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb2xzO1xyXG4gICAgfVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBwYWdpbmF0aW9uKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fcGFnaW5hdGlvbiA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IHBhZ2luYXRpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhZ2luYXRpb24gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFnaW5hdGlvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UucGFnZUluZm8gJiYgdGhpcy5wYWdlSW5mby5lbmFibGVQYWdlciA/IHRoaXMucGFnZUluZm8uZW5hYmxlUGFnZXIgOiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGRpc3BsYXlUeXBlKHZhbDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuZGlzcGxheVR5cGUgPSB2YWwgKyAnJztcclxuICAgIH1cclxuICAgIGdldCBkaXNwbGF5VHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UuZGlzcGxheVR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIC0xOiDkuI3lsZXlvIDvvJsgMDog5YWo6YOo5bGV5byA77ybPjA6IOWxleW8gOWIsOaMh+Wumue6p+aVsCAqL1xyXG4gICAgQElucHV0KCkgZXhwYW5kTGV2ZWwgPSAtMTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCd0dCcpXHJcbiAgICBzZXQgdHJlZUNtcFJlZihjbWY6IFRyZWVUYWJsZUNvbXBvbmVudCkge1xyXG4gICAgICAgIGlmIChjbWYpIHtcclxuICAgICAgICAgICAgY21mLmNhc2NhZGVDaGVjayA9IHRoaXMuY2FzY2FkZS5lbmFibGU7XHJcbiAgICAgICAgICAgIGNtZi5jYXNjYWRlRG93biA9IHRoaXMuY2FzY2FkZS5kb3duO1xyXG4gICAgICAgICAgICBjbWYuY2FzY2FkZVVwID0gdGhpcy5jYXNjYWRlLnVwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50dCQubmV4dChjbWYpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl90cmVlQ21wUmVmID0gY21mO1xyXG4gICAgfVxyXG4gICAgZ2V0IHRyZWVDbXBSZWYoKTogVHJlZVRhYmxlQ29tcG9uZW50IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHJlZUNtcFJlZjtcclxuICAgIH1cclxuICAgIEBWaWV3Q2hpbGQoJ2R0JylcclxuICAgIHNldCB0YWJsZUNtcFJlZihjbWY6IERhdGFUYWJsZUNvbXBvbmVudCkge1xyXG4gICAgICAgIGlmIChjbWYgJiYgdGhpcy5wYWdpbmF0aW9uICYmIHRoaXMuX3RhYmxlQ21wUmVmKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGVkJC5waXBlKHRha2UoMSkpLnN1YnNjcmliZShlID0+IHtcclxuICAgICAgICAgICAgICAgIGNtZi5sb2FkRGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZUluZm8ucGFnZVNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IHRoaXMucGFnZUluZm8udG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5kYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5mby5wYWdlSW5kZXhcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLl90YWJsZUNtcFJlZiAmJiB0aGlzLmxvYWRGaW5pc2ggJiYgY21mKSB7XHJcbiAgICAgICAgICAgIGNtZi5sb2FkRGF0YSh7XHJcbiAgICAgICAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlSW5mby5wYWdlU2l6ZSxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiB0aGlzLnBhZ2VJbmZvLnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogdGhpcy5kYXRhLFxyXG4gICAgICAgICAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmZvLnBhZ2VJbmRleFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fdGFibGVDbXBSZWYgPSBjbWY7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIGNhc2NhZGUgPSB7XHJcbiAgICAgICAgZW5hYmxlOiBmYWxzZSxcclxuICAgICAgICB1cDogZmFsc2UsXHJcbiAgICAgICAgZG93bjogZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgQElucHV0KCkgdHJlZUluZm86IFRyZWVJbmZvO1xyXG5cclxuICAgIC8qKiDmoJHlvaLluK7liqnmlbDmja7liqDovb3mlrnlvI/vvJogZGVmYXVsdDog5YaF572u5Y+W5pWw77ybIGxvYWRhbGw6IOWKoOi9veaJgOaciSBsYXllcmxvYWTvvJrliIblsYLliqDovb0gKi9cclxuICAgIEBJbnB1dCgpIGxvYWRUcmVlRGF0YVR5cGU6ICdkZWZhdWx0JyB8ICdsb2FkYWxsJyB8ICdsYXllcmxvYWQnID0gJ2RlZmF1bHQnO1xyXG4gICAgLyoqIOWQr+eUqOaehOmAoOWujOaVtOagkei/h+a7pCAqL1xyXG4gICAgQElucHV0KCkgZW5hYmxlRnVsbFRyZWUgPSB0cnVlO1xyXG5cclxuICAgIEBPdXRwdXQoKSBwYWdlQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBwYWdlU2l6ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5L2/55So6KGo5Y2V5pig5bCE77yM6buY6K6kIGZhbHNlICovXHJcbiAgICBASW5wdXQoKSB1c2VGb3JtRGF0YU1hcHBpbmcgPSBmYWxzZTtcclxuXHJcbiAgICBvd25TZWxlY3Rpb25zOiBhbnk7XHJcbiAgICBsb2FkRmluaXNoID0gZmFsc2U7XHJcbiAgICBwYWdlSW5mbzogYW55ID0geyBwYWdlU2l6ZTogMjAsIHBhZ2VJbmRleDogMSwgdG90YWw6IDAgfTtcclxuICAgIHByaXZhdGUgdHQkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHByaXZhdGUgbG9hZGVkJCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIF9jb2x1bW5zOiBhbnlbXTtcclxuICAgIHByaXZhdGUgX3BhZ2luYXRpb246IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIF90YWJsZUNtcFJlZjogYW55O1xyXG4gICAgcHJpdmF0ZSBfdHJlZUNtcFJlZjogYW55O1xyXG4gICAgcHJpdmF0ZSBfc2VhcmNoS2V5V29yZHMgPSAnJztcclxuXHJcbiAgICBsb2FkRGF0YVR5cGUgPSAnYWxsJztcclxuXHJcbiAgICBwcml2YXRlIGlkU2VyOiBJZFNlcnZpY2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHB1YmxpYyBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHB1YmxpYyBkb2N1bWVudDogYW55LFxyXG4gICAgICAgIHB1YmxpYyByZW5kZXI6IFJlbmRlcmVyMixcclxuICAgICAgICBwdWJsaWMgY29tYm9TZXJ2aWNlOiBDb21ib1NlcnZpY2UsXHJcbiAgICAgICAgcHVibGljIGluamVjdG9yOiBJbmplY3RvclxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoZWwsIGNkciwgZG9jdW1lbnQsIHJlbmRlciwgY29tYm9TZXJ2aWNlLCBpbmplY3Rvcik7XHJcbiAgICAgICAgdGhpcy5pZFNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KElkU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlkU2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRTZXIgPSBuZXcgSWRTZXJ2aWNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHN1cGVyLm5nT25Jbml0KCk7XHJcblxyXG4gICAgICAgIHRoaXMudHJlZUNsaWVudFNlYXJjaC5waXBlKGRlYm91bmNlVGltZSgzMDApKS5zdWJzY3JpYmUoKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlbW90ZVNlYXJjaCAmJiB0aGlzLnRyZWVDbXBSZWYpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5zZWFyY2hIYW5kbGUuc2VhcmNoKHRoaXMudGV4dEZpZWxkLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UudHJlZUluZm8kLnN1YnNjcmliZSggKHQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubG9hZFRyZWVEYXRhVHlwZSA9PT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkRGF0YVR5cGUgPSB0LmxvYWREYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVJbmZvID0gT2JqZWN0LmFzc2lnbih0aGlzLnRyZWVJbmZvfHwge30sIHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9uU2VsZWN0aW9uc0NoYW5nZShzZWxlY3Rpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAnTE9PS1VQTElTVCcpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm93blNlbGVjdGlvbnMgPSBzZWxlY3Rpb25zWzBdID8gc2VsZWN0aW9uc1swXSA6IHt9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25TZWxlY3Rpb25zID0ge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25TZWxlY3Rpb25zW2l0ZW1bdGhpcy5pZEZpZWxkXV0gPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wYWdlSW5mbyA9IHsgLi4udGhpcy5wYWdlSW5mbywgLi4udGhpcy5jb21ib1NlcnZpY2UucGFnZUluZm8gfTtcclxuICAgICAgICAgICAgdGhpcy5sb2FkRmluaXNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRlZCQubmV4dCh0aGlzLnBhZ2VJbmZvKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50cmVlQ21wUmVmKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRUcmVlRGF0YSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50dCQucGlwZSh0YWtlKDEpKS5zdWJzY3JpYmUoKGNtZjogVHJlZVRhYmxlQ29tcG9uZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlQ21wUmVmID0gY21mO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFRyZWVEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY21mLmNoZWNrZWROb2RlcyhpZHMsIHRydWUsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjbWYudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXRUcmVlRGF0YSgpIHtcclxuICAgICAgICBjb25zdCBfX3NlbGVjdGlvbnMgPSB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zLmZpbHRlcihuID0+IG4gIT09IG51bGwgJiYgbiAhPT0gdW5kZWZpbmVkKTtcclxuICAgICAgICBjb25zdCBpZHMgPSBbXTtcclxuICAgICAgICB0aGlzLm93blNlbGVjdGlvbnMgPSBfX3NlbGVjdGlvbnMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZHMucHVzaChpdGVtW3RoaXMuaWRGaWVsZF0pO1xyXG4gICAgICAgICAgICByZXR1cm4geyBkYXRhOiBpdGVtLCBpZDogaXRlbVt0aGlzLmlkRmllbGRdIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50cmVlQ21wUmVmLnNlbGVjdGlvbnMgPSB0aGlzLm93blNlbGVjdGlvbnM7XHJcbiAgICAgICAgdGhpcy50cmVlQ21wUmVmLmNoZWNrZWRzID0gdGhpcy5vd25TZWxlY3Rpb25zO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jb21ib1NlcnZpY2UuZGF0YSAmJiB0aGlzLmNvbWJvU2VydmljZS5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50cmVlQ21wUmVmLmNoZWNrVmFsdWVzICYmIHRoaXMudHJlZUNtcFJlZi5jaGVja1ZhbHVlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlQ21wUmVmLmNoZWNrZWROb2Rlcyh0aGlzLnRyZWVDbXBSZWYuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5zZWxlY3ROb2Rlcyh0aGlzLnRyZWVDbXBSZWYuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuc2VsZWN0Tm9kZXModGhpcy50cmVlQ21wUmVmLmNoZWNrVmFsdWVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgaW5pdERhdGFzQ2hhbmdlQWN0aW9uKCkgeyB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc1RyZWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBUUkVFTElTVCc7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHVwZGF0ZU1hcHBpbmdGaWVsZFZhbHVlKGNsZWFyTWFwRmllbGRzID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIHRoaXMubmdDb250cm9sICYmIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUgJiZcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtICYmIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nRGF0YSA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YTtcclxuICAgICAgICAgICAgY29uc3QgYmluZGluZ1BhdGggPSB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlLmZvcm0uYmluZGluZ1BhdGg7XHJcbiAgICAgICAgICAgIGxldCBwYXRoQXJyID0gW107XHJcbiAgICAgICAgICAgIGlmIChiaW5kaW5nUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgcGF0aEFyciA9IGJpbmRpbmdQYXRoLnNwbGl0KCcvJykuZmlsdGVyKG4gPT4gbiAhPT0gJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubWFwcGluZ0ZpZWxkID0gdGhpcy5tYXBwaW5nRmllbGQgPyB0aGlzLm1hcHBpbmdGaWVsZCA6IHt9O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tYXBGaWVsZHMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhlbHBGaWVsZHMgPSBPYmplY3Qua2V5cyh0aGlzLm1hcEZpZWxkcyk7XHJcbiAgICAgICAgICAgICAgICBoZWxwRmllbGRzLmZvckVhY2goKGY6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZXMgPSB0aGlzLm1hcEZpZWxkc1tmXSA/IHRoaXMubWFwRmllbGRzW2ZdIDogJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjbGVhck1hcEZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0aW9ucyAmJiB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5nZXRWYWx1ZUJ5T2JqKGYsIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuICE9PSBudWxsKS5qb2luKHRoaXMuc2VwYXJhdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFsdWUgPSB0ZXh0ID8gdGV4dCA6IHRoaXMuZGlzcGxheVRleHQgPyB0aGlzLmRpc3BsYXlUZXh0IDogJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGV4dCB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZE5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTmFtZXMuc3BsaXQoJywnKS5mb3JFYWNoKChmaWVsZE5hbWU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IF92YWwgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vc2VhcmNoICYmIGZpZWxkTmFtZSA9PT0gdGhpcy5uZ0NvbnRyb2wubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92YWwgPSB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpbmRpbmdEYXRhLnNldFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy51c2VGb3JtRGF0YU1hcHBpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZGluZ0RhdGEuc2V0VmFsdWUoIHBhdGhBcnIuY29uY2F0KGZpZWxkTmFtZS5zcGxpdCgnLicpKSwgX3ZhbCwgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbW1vblV0aWxzLnNldFZhbHVlKGJpbmRpbmdEYXRhLCBmaWVsZE5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVNlbGVjdGVkVmFsdWVzKCkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wgJiZcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlLmZvcm0gJiZcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdEYXRhXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJpbmRpbmdEYXRhID0gdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdEYXRhO1xyXG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nUGF0aCA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nUGF0aDtcclxuICAgICAgICAgICAgbGV0IHBhdGhBcnIgPSBbXTtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoQXJyID0gYmluZGluZ1BhdGguc3BsaXQoJy8nKS5maWx0ZXIobiA9PiBuICE9PSAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHRhcmdldEZpZWxkID0gdGhpcy5tYXBwaW5nRmllbGQgPyB0aGlzLm1hcEZpZWxkc1t0aGlzLmlkRmllbGRdIDogJyc7XHJcblxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0RmllbGQgJiYgdGFyZ2V0RmllbGQuaW5kZXhPZignLCcpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldEZpZWxkID0gdGFyZ2V0RmllbGQuc3BsaXQoJywnKVswXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gdGhpcy5tYXBwaW5nRmllbGQgPSB0aGlzLm1hcHBpbmdGaWVsZCA/IHRoaXMubWFwcGluZ0ZpZWxkIDogJyc7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRGaWVsZCAmJiBiaW5kaW5nRGF0YS5nZXRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IGJpbmRpbmdEYXRhLmdldFZhbHVlKHBhdGhBcnIuY29uY2F0KHRhcmdldEZpZWxkLnNwbGl0KCcuJykpKSB8fCAnJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXRGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUodGFyZ2V0RmllbGQsIGJpbmRpbmdEYXRhKSB8fCAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNlbGVjdFJvd3Mocm93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGEsIGluZGV4IH0gPSByb3c7XHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdEl0ZW0oZGF0YSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdENoYW5nZS5lbWl0KHsgZGF0YSwgaW5kZXgsIGluc3RhbmNlOiB0aGlzIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IG5vZGUgfSA9IHJvdztcclxuICAgICAgICAgICAgaWYgKHJvdy5ub2Rlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0SXRlbShyb3cubm9kZXMubWFwKG4gPT4gbi5kYXRhKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3RJdGVtKG5vZGUuZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2UuZW1pdChub2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlVGV4dEFuZFZhbHVlcygpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuaXNPcGVuJC5uZXh0KGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25VblNlbGVjdFJvd3Mocm93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJvdztcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UudW5TZWxlY3RJdGVtKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IG5vZGUgfSA9IHJvdztcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UudW5TZWxlY3RJdGVtKG5vZGUuZGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2hhbmdlLmVtaXQobm9kZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVRleHRBbmRWYWx1ZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrQWxsKGV2KSB7XHJcbiAgICAgICAgbGV0IHN0YXRlO1xyXG4gICAgICAgIGxldCBzZWxlY3Rpb25zID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBUUkVFTElTVCcpIHtcclxuICAgICAgICAgICAgc3RhdGUgPSBldi5jaGVja2VkO1xyXG4gICAgICAgICAgICBzZWxlY3Rpb25zID0gdGhpcy50cmVlQ21wUmVmLnN0YXRlLnJvd05vZGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG4gPT4gbi5ub2RlLnNlbGVjdGFibGUgPT09IHVuZGVmaW5lZCB8fCBuLm5vZGUuc2VsZWN0YWJsZSApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKHIgPT4gci5ub2RlLmRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN0YXRlID0gZXY7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvbnMgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0QWxsKHNlbGVjdGlvbnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnVuU2VsZWN0QWxsKHNlbGVjdGlvbnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0QW5kVmFsdWVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVUZXh0QW5kVmFsdWVzKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB0aGlzLmNvbWJvU2VydmljZS5nZXRWYWx1ZSh0aGlzLmlkRmllbGQpO1xyXG4gICAgICAgIGNvbnN0IF9kaXNwbGF5VGV4dCA9IHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoeyB0ZXh0OiBfZGlzcGxheVRleHQsIHZhbHVlOiB0aGlzLnNlbGVjdGVkVmFsdWVzLCBzZWxlY3Rpb25zOiB0aGlzLnNlbGVjdGlvbnMgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25LZXl1cCgkZXZlbnQpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygna2V5IHVwJywgJGV2ZW50KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25LZXlkb3duKCRldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdrZXkgZG93bicsICRldmVudCk7XHJcbiAgICAgICAgaWYgKCRldmVudC5jb2RlID09PSAnVGFiJykge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGUoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VDaGFuZ2VkKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMudXJpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGF0YShldmVudCkuc3Vic2NyaWJlKGRhdGEgPT4gdGhpcy5jb21ib1NlcnZpY2UubG9hZExvb2tVcERhdGFUYWJsZShkYXRhLCAhIWV2ZW50LnNvcnROYW1lKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlQ2hhbmdlZC5lbWl0KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25QYWdlU2l6ZUNoYW5nZWQoZXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy51cmkpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXREYXRhKGV2ZW50KS5zdWJzY3JpYmUoZGF0YSA9PiB0aGlzLmNvbWJvU2VydmljZS5sb2FkTG9va1VwRGF0YVRhYmxlKGRhdGEsICEhZXZlbnQuc29ydE5hbWUpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplQ2hhbmdlZC5lbWl0KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Db2x1bW5Tb3J0ZWQoZXZlbnQ6IHsgc29ydE5hbWU6IHN0cmluZzsgc29ydE9yZGVyOiBhbnkgfSkge1xyXG4gICAgICAgIGNvbnN0IHsgc29ydE5hbWUsIHNvcnRPcmRlciB9ID0geyAuLi5ldmVudCB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGF0YSh7IHNvcnROYW1lLCBzb3J0T3JkZXIgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UubG9hZExvb2tVcERhdGFUYWJsZShkYXRhLCB0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMub3duU2VsZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmlzVHJlZSgpICYmIHRoaXMudHJlZUNtcFJlZikge1xyXG4gICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuY2xlYXJBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3VwZXIub25DbGVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q2hpbGRyZW4oIHBhcmVudFBhdGgscGFyZW50TGF5ZXIsc2VhcmNoRGF0YTogeyBzZWFyY2hGaWVsZDogc3RyaW5nOyBzZWFyY2hWYWx1ZTogc3RyaW5nIH0pIHtcclxuICAgICAgICBjb25zdCBzZWFyY2ggPSB7IHBhcmVudExheWVyLCBjYXRlZ29yeTogJ2NoaWxkcmVuJywgLi4uc2VhcmNoRGF0YSB9O1xyXG4gICAgICAgIGlmICh0aGlzLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICBzZWFyY2hbJ3BhcmVudElkJ10gPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFsncGFyZW50UGF0aCddID0gcGFyZW50UGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtID0ge1xyXG4gICAgICAgICAgICBzZWFyY2hWYWx1ZTogSlNPTi5zdHJpbmdpZnkoc2VhcmNoKSxcclxuICAgICAgICAgICAgY3VzdG9tRGF0YTogdGhpcy5jdXN0b21EYXRhLFxyXG4gICAgICAgICAgICBlbmFibGVGdWxsVHJlZTogdGhpcy5lbmFibGVGdWxsVHJlZSxcclxuICAgICAgICAgICAgbG9hZFRyZWVEYXRhVHlwZTogdGhpcy5sb2FkVHJlZURhdGFUeXBlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3NlYXJjaEtleVdvcmRzKSB7XHJcbiAgICAgICAgICAgIHBhcmFtLmVuYWJsZUZ1bGxUcmVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHBhcmFtLmxvYWRUcmVlRGF0YVR5cGUgPSAnbGF5ZXJsb2FkJztcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICAgICAgLy8g5qCR5b2i5biu5Yqp5p+l6K+i5ZCO77yM5bGV5byA6IqC54K55pe25bCG55u45YWz5p+l6K+i5Y+C5pWw5Lyg6YCS5Yiw5ZCO56uvIDIwMjItMDktMTNcclxuICAgICAgICAgICAgICAgIHNlYXJjaC5zZWFyY2hWYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoLnNlYXJjaEZpZWxkID0gJyonO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtLnNlYXJjaFZhbHVlID0gSlNPTi5zdHJpbmdpZnkoc2VhcmNoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHR0ID0gdGhpcy50cmVlQ21wUmVmIGFzIFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgICAgICBpZiAodHQgJiYgdHQuc29ydE5hbWUpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYXJhbSwge1xyXG4gICAgICAgICAgICAgICAgc29ydE5hbWU6IHR0LnNvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgc29ydE9yZGVyOiB0dC5zb3J0T3JkZXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5nZXREYXRhKHBhcmFtLCAnZ2V0JywgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldERhdGEoZXZlbnQ/OiBhbnksIHR5cGUgPSAnYWxsJykge1xyXG4gICAgICAgIGV2ZW50ID0gZXZlbnQgfHwge307XHJcbiAgICAgICAgaWYgKHRoaXMuX3NlYXJjaEtleVdvcmRzKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnNlYXJjaCA9IHtcclxuICAgICAgICAgICAgICAgIGZpZWxkOiAnKicsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5fc2VhcmNoS2V5V29yZHNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMuYnVpbGRRdWVyeVBhcmFtcyhldmVudCwgdHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tYm9TZXJ2aWNlLmdldERhdGEocGFyYW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5p6E6YCJ5p+l6K+i5Y+C5pWwICovXHJcbiAgICBwcml2YXRlIGJ1aWxkUXVlcnlQYXJhbXMoZXZlbnQ/OiBhbnksIHR5cGUgPSAnYWxsJykge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtczogYW55ID0ge307XHJcblxyXG4gICAgICAgIGNvbnN0IHNlYXJjaFBhcmFtID0geyBjYXRlZ29yeTogdHlwZSB9O1xyXG4gICAgICAgIGlmIChldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQucGFnZUluZm8pIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1sncGFnZUluZGV4J10gPSBldmVudC5wYWdlSW5mby5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ3BhZ2VTaXplJ10gPSBldmVudC5wYWdlSW5mby5wYWdlU2l6ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnNlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoUGFyYW1bJ3NlYXJjaEZpZWxkJ10gPSBldmVudC5zZWFyY2guZmllbGQ7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbVsnc2VhcmNoVmFsdWUnXSA9IGV2ZW50LnNlYXJjaC52YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnNvcnROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbVsnc29ydE5hbWUnXSA9IGV2ZW50LnNvcnROYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5zb3J0T3JkZXIpIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaFBhcmFtWydzb3J0T3JkZXInXSA9IGV2ZW50LnNvcnRPcmRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcGFyYW1zWydzZWFyY2hWYWx1ZSddID0gSlNPTi5zdHJpbmdpZnkoc2VhcmNoUGFyYW0pO1xyXG4gICAgICAgIGlmICh0aGlzLmN1c3RvbURhdGEpIHtcclxuICAgICAgICAgICAgcGFyYW1zWydjdXN0b21EYXRhJ10gPSB0aGlzLmN1c3RvbURhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFyYW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbHRlckRhdGFPblNlcnZlcih2YWx1ZSwgZmllbGQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHNlYXJjaCA9IHsgc2VhcmNoOiB7IGZpZWxkLCB2YWx1ZSB9fTtcclxuICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoS2V5V29yZHMgPSB2YWx1ZTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoS2V5V29yZHMgPSAnJztcclxuICAgICAgICAgICAgc2VhcmNoID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5idWlsZFF1ZXJ5UGFyYW1zKHNlYXJjaCwgJ3NlYXJjaCcgKTtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZXJhY2hWYWx1ZSQubmV4dChwYXJhbXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRXhwYW5kTm9kZSh0bjogVHJlZU5vZGUpIHtcclxuICAgICAgICBpZiAodG4ubGVhZiB8fCAgdG5bJ3Nob3dMb2FkaW5nJ10pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0bi5jaGlsZHJlbiB8fCAhdG4uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnRQYXRoID0gJyc7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnRMYXllciA9IC0xO1xyXG4gICAgICAgICAgICBjb25zdCB7IGZpZWxkID0gJyonLCB2YWx1ZSA9ICcnIH0gPSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5fc2VhcmNoS2V5V29yZHNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgdHJlZUluZm9GaWVsZCA9IHRoaXMudHJlZUluZm8uZGF0YUZpZWxkO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50cmVlSW5mby5sYXllclR5cGUgPT09ICdwYXJlbnRJZCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIOeItklE5Yqg6L295pa55byPXHJcbiAgICAgICAgICAgICAgICBwYXJlbnRQYXRoID0gdG5bJ2lkJ107XHJcbiAgICAgICAgICAgICAgICBwYXJlbnRMYXllciA9IHRuLmRhdGFbdHJlZUluZm9GaWVsZF1bdGhpcy50cmVlSW5mby5sYXllckZpZWxkXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0cmVlSW5mb0ZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0aCA9IHRuLmRhdGFbdHJlZUluZm9GaWVsZF1bdGhpcy50cmVlSW5mby5wYXRoRmllbGRdO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudExheWVyID0gdG4uZGF0YVt0cmVlSW5mb0ZpZWxkXVt0aGlzLnRyZWVJbmZvLmxheWVyRmllbGRdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYud3JpdGVDb25zb2xlKCfmnKrmib7liLDliIbnuqfkv6Hmga/jgIInKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5nZXRDaGlsZHJlbihwYXJlbnRQYXRoLCBwYXJlbnRMYXllciwge1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoRmllbGQ6IGZpZWxkID09PSAnKicgPyAnKicgOiBmaWVsZCxcclxuICAgICAgICAgICAgICAgIHNlYXJjaFZhbHVlOiB2YWx1ZVxyXG4gICAgICAgICAgICB9KS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodG4gJiYgZGF0YS5pdGVtcyAmJiBkYXRhLml0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5jb21ib1NlcnZpY2UuY2hlY2tOb2RlQ2FuQmVTZWxlY3QoZGF0YS5pdGVtcywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5hcHBlbmRDaGlsZHJlbihub2RlcywgdG4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy50cmVlQ21wUmVmLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5wc1JlZi5kaXJlY3RpdmVSZWYudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=