import { FieldMetadataUtil } from '../entity/index';
import { BindingPropertyType } from './binding_property';
/**
 * 属性工具类
 */
var PropertyUtil = /** @class */ (function () {
    function PropertyUtil() {
    }
    /**
     * 获取实体上的属性集合，并将他们转换成BindingProperty集合
     * @param  entityType 实体类型
     * @returns 绑定属性集合
     */
    PropertyUtil.getProperties = function (entityType) {
        var properties = [];
        // Plain
        var ngFieldProperties = FieldMetadataUtil.getNgFields(entityType);
        Object.keys(ngFieldProperties).forEach(function (propertyName) {
            var ngFieldProperty = ngFieldProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Plain,
                isPrimaryKey: ngFieldProperty.primary,
                isForeignKey: ngFieldProperty.foreign,
                enableMultiLangInput: ngFieldProperty.enableMultiLangInput
            });
        });
        // Object
        var ngObjectProperties = FieldMetadataUtil.getNgObjects(entityType);
        Object.keys(ngObjectProperties).forEach(function (propertyName) {
            var ngObjectProperty = ngObjectProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Object,
                entityType: ngObjectProperty.type
            });
        });
        // List
        var ngListProperties = FieldMetadataUtil.getNgList(entityType);
        Object.keys(ngListProperties).forEach(function (propertyName) {
            var ngListProperty = ngListProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.List,
                entityType: ngListProperty.type
            });
        });
        // Dynamics
        var ngDynamicProperties = FieldMetadataUtil.getNgDynamic(entityType);
        Object.keys(ngDynamicProperties).forEach(function (propertyName) {
            var ngDynamicProperty = ngDynamicProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Dynamic,
                entityType: ngDynamicProperty.type
            });
        });
        return properties;
    };
    PropertyUtil.getDynamicProperties = function (dynamicData) {
        var properties = [];
        Object.keys(dynamicData).forEach(function (propertyName) {
            if (dynamicData.hasOwnProperty(propertyName)) {
                if (dynamicData[propertyName] instanceof Object) {
                    properties.push({
                        name: propertyName,
                        type: BindingPropertyType.Dynamic,
                        entityType: null
                    });
                }
                else {
                    properties.push({
                        name: propertyName,
                        type: BindingPropertyType.Plain,
                        isPrimaryKey: false,
                        isForeignKey: false
                    });
                }
            }
        });
        return properties;
    };
    /**
     * 根据属性名获取属性
     */
    PropertyUtil.getPropertyByName = function (properties, propertyName) {
        var targetProperty = properties.find(function (property) {
            return property.name === propertyName;
        });
        return targetProperty;
    };
    /**
     * 获取实体主键名
     * @param properties 属性集合
     * @returns 主键名
     */
    PropertyUtil.getPrimaryKey = function (properties) {
        // 实体必须有主键，如果没有主键在构造实体的时候就已经报错，这里不需要再进行检查
        var primaryProperty = properties.find(function (property) {
            return property.isPrimaryKey === true;
        });
        return primaryProperty ? primaryProperty.name : '';
    };
    return PropertyUtil;
}());
export { PropertyUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHlfdXRpbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvbW9iaWxlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9iaW5kaW5nLWRhdGEvcHJvcGVydHlfdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQVUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUM1RCxPQUFPLEVBQW1CLG1CQUFtQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFMUU7O0dBRUc7QUFDSDtJQUFBO0lBeUdBLENBQUM7SUF2R0M7Ozs7T0FJRztJQUNJLDBCQUFhLEdBQXBCLFVBQXFCLFVBQXdCO1FBQzNDLElBQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztRQUV0QixRQUFRO1FBQ1IsSUFBTSxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDcEUsTUFBTSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLFlBQW9CO1lBQzFELElBQU0sZUFBZSxHQUFHLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ3hELFVBQVUsQ0FBQyxJQUFJLENBQUM7Z0JBQ2QsSUFBSSxFQUFFLFlBQVk7Z0JBQ2xCLElBQUksRUFBRSxtQkFBbUIsQ0FBQyxLQUFLO2dCQUMvQixZQUFZLEVBQUUsZUFBZSxDQUFDLE9BQU87Z0JBQ3JDLFlBQVksRUFBRSxlQUFlLENBQUMsT0FBTztnQkFDckMsb0JBQW9CLEVBQUUsZUFBZSxDQUFDLG9CQUFvQjthQUMzRCxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILFNBQVM7UUFDVCxJQUFNLGtCQUFrQixHQUFHLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RSxNQUFNLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsWUFBb0I7WUFDM0QsSUFBTSxnQkFBZ0Is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SCxPQUFPLGVBQWUsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQ3JELENBQUM7SUFFSCxtQkFBQztBQUFELENBQUMsQUF6R0QsSUF5R0M7QUFFRCxPQUFPLEVBQUUsWUFBWSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1R5cGV9IGZyb20gJy4uL2NvcmUvaW5kZXgnO1xyXG5pbXBvcnQgeyBFbnRpdHksIEZpZWxkTWV0YWRhdGFVdGlsIH0gZnJvbSAnLi4vZW50aXR5L2luZGV4JztcclxuaW1wb3J0IHsgQmluZGluZ1Byb3BlcnR5LCBCaW5kaW5nUHJvcGVydHlUeXBlIH0gZnJvbSAnLi9iaW5kaW5nX3Byb3BlcnR5JztcclxuXHJcbi8qKlxyXG4gKiDlsZ7mgKflt6XlhbfnsbtcclxuICovXHJcbmNsYXNzIFByb3BlcnR5VXRpbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWunuS9k+S4iueahOWxnuaAp+mbhuWQiO+8jOW5tuWwhuS7luS7rOi9rOaNouaIkEJpbmRpbmdQcm9wZXJ0eembhuWQiFxyXG4gICAqIEBwYXJhbSAgZW50aXR5VHlwZSDlrp7kvZPnsbvlnotcclxuICAgKiBAcmV0dXJucyDnu5HlrprlsZ7mgKfpm4blkIhcclxuICAgKi9cclxuICBzdGF0aWMgZ2V0UHJvcGVydGllcyhlbnRpdHlUeXBlOiBUeXBlPEVudGl0eT4pOiBCaW5kaW5nUHJvcGVydHlbXSB7XHJcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gW107XHJcblxyXG4gICAgLy8gUGxhaW5cclxuICAgIGNvbnN0IG5nRmllbGRQcm9wZXJ0aWVzID0gRmllbGRNZXRhZGF0YVV0aWwuZ2V0TmdGaWVsZHMoZW50aXR5VHlwZSk7XHJcbiAgICBPYmplY3Qua2V5cyhuZ0ZpZWxkUHJvcGVydGllcykuZm9yRWFjaCgocHJvcGVydHlOYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgY29uc3QgbmdGaWVsZFByb3BlcnR5ID0gbmdGaWVsZFByb3BlcnRpZXNbcHJvcGVydHlOYW1lXTtcclxuICAgICAgcHJvcGVydGllcy5wdXNoKHtcclxuICAgICAgICBuYW1lOiBwcm9wZXJ0eU5hbWUsXHJcbiAgICAgICAgdHlwZTogQmluZGluZ1Byb3BlcnR5VHlwZS5QbGFpbixcclxuICAgICAgICBpc1ByaW1hcnlLZXk6IG5nRmllbGRQcm9wZXJ0eS5wcmltYXJ5LFxyXG4gICAgICAgIGlzRm9yZWlnbktleTogbmdGaWVsZFByb3BlcnR5LmZvcmVpZ24sXHJcbiAgICAgICAgZW5hYmxlTXVsdGlMYW5nSW5wdXQ6IG5nRmllbGRQcm9wZXJ0eS5lbmFibGVNdWx0aUxhbmdJbnB1dFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIE9iamVjdFxyXG4gICAgY29uc3QgbmdPYmplY3RQcm9wZXJ0aWVzID0gRmllbGRNZXRhZGF0YVV0aWwuZ2V0TmdPYmplY3RzKGVudGl0eVR5cGUpO1xyXG4gICAgT2JqZWN0LmtleXMobmdPYmplY3RQcm9wZXJ0aWVzKS5mb3JFYWNoKChwcm9wZXJ0eU5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICBjb25zdCBuZ09iamVjdFByb3BlcnR5ID0gbmdPYmplY3RQcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV07XHJcbiAgICAgIHByb3BlcnRpZXMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgIHR5cGU6IEJpbmRpbmdQcm9wZXJ0eVR5cGUuT2JqZWN0LFxyXG4gICAgICAgIGVudGl0eVR5cGU6IG5nT2JqZWN0UHJvcGVydHkudHlwZVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIExpc3RcclxuICAgIGNvbnN0IG5nTGlzdFByb3BlcnRpZXMgPSBGaWVsZE1ldGFkYXRhVXRpbC5nZXROZ0xpc3QoZW50aXR5VHlwZSk7XHJcbiAgICBPYmplY3Qua2V5cyhuZ0xpc3RQcm9wZXJ0aWVzKS5mb3JFYWNoKChwcm9wZXJ0eU5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICBjb25zdCBuZ0xpc3RQcm9wZXJ0eSA9IG5nTGlzdFByb3BlcnRpZXNbcHJvcGVydHlOYW1lXTtcclxuICAgICAgcHJvcGVydGllcy5wdXNoKHtcclxuICAgICAgICBuYW1lOiBwcm9wZXJ0eU5hbWUsXHJcbiAgICAgICAgdHlwZTogQmluZGluZ1Byb3BlcnR5VHlwZS5MaXN0LFxyXG4gICAgICAgIGVudGl0eVR5cGU6IG5nTGlzdFByb3BlcnR5LnR5cGVcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBEeW5hbWljc1xyXG4gICAgY29uc3QgbmdEeW5hbWljUHJvcGVydGllcyA9IEZpZWxkTWV0YWRhdGFVdGlsLmdldE5nRHluYW1pYyhlbnRpdHlUeXBlKTtcclxuICAgIE9iamVjdC5rZXlzKG5nRHluYW1pY1Byb3BlcnRpZXMpLmZvckVhY2goKHByb3BlcnR5TmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5nRHluYW1pY1Byb3BlcnR5ID0gbmdEeW5hbWljUHJvcGVydGllc1twcm9wZXJ0eU5hbWVdO1xyXG4gICAgICBwcm9wZXJ0aWVzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IHByb3BlcnR5TmFtZSxcclxuICAgICAgICB0eXBlOiBCaW5kaW5nUHJvcGVydHlUeXBlLkR5bmFtaWMsXHJcbiAgICAgICAgZW50aXR5VHlwZTogbmdEeW5hbWljUHJvcGVydHkudHlwZVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9wZXJ0aWVzO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldER5bmFtaWNQcm9wZXJ0aWVzKGR5bmFtaWNEYXRhOiBhbnkpOiBCaW5kaW5nUHJvcGVydHlbXSB7XHJcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gW107XHJcbiAgICBPYmplY3Qua2V5cyhkeW5hbWljRGF0YSkuZm9yRWFjaCgocHJvcGVydHlOYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgaWYgKGR5bmFtaWNEYXRhLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHtcclxuICAgICAgICBpZiAoZHluYW1pY0RhdGFbcHJvcGVydHlOYW1lXSBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICAgICAgcHJvcGVydGllcy5wdXNoKHtcclxuICAgICAgICAgICAgbmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiBCaW5kaW5nUHJvcGVydHlUeXBlLkR5bmFtaWMsXHJcbiAgICAgICAgICAgIGVudGl0eVR5cGU6IG51bGxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goe1xyXG4gICAgICAgICAgICBuYW1lOiBwcm9wZXJ0eU5hbWUsXHJcbiAgICAgICAgICAgIHR5cGU6IEJpbmRpbmdQcm9wZXJ0eVR5cGUuUGxhaW4sXHJcbiAgICAgICAgICAgIGlzUHJpbWFyeUtleTogZmFsc2UsXHJcbiAgICAgICAgICAgIGlzRm9yZWlnbktleTogZmFsc2VcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcHJvcGVydGllcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5qC55o2u5bGe5oCn5ZCN6I635Y+W5bGe5oCnXHJcbiAgICovXHJcbiAgc3RhdGljIGdldFByb3BlcnR5QnlOYW1lKHByb3BlcnRpZXM6IEJpbmRpbmdQcm9wZXJ0eVtdLCBwcm9wZXJ0eU5hbWU6IHN0cmluZyk6IEJpbmRpbmdQcm9wZXJ0eSB7XHJcbiAgICBjb25zdCB0YXJnZXRQcm9wZXJ0eSA9ICBwcm9wZXJ0aWVzLmZpbmQoKHByb3BlcnR5OiBCaW5kaW5nUHJvcGVydHkpID0+IHtcclxuICAgICAgcmV0dXJuIHByb3BlcnR5Lm5hbWUgPT09IHByb3BlcnR5TmFtZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRhcmdldFByb3BlcnR5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a6e5L2T5Li76ZSu5ZCNXHJcbiAgICogQHBhcmFtIHByb3BlcnRpZXMg5bGe5oCn6ZuG5ZCIXHJcbiAgICogQHJldHVybnMg5Li76ZSu5ZCNXHJcbiAgICovXHJcbiAgc3RhdGljIGdldFByaW1hcnlLZXkocHJvcGVydGllczogQmluZGluZ1Byb3BlcnR5W10pOiBzdHJpbmcge1xyXG5cclxuICAgIC8vIOWunuS9k+W/hemhu+acieS4u+mUru+8jOWmguaenOayoeacieS4u+mUruWcqOaehOmAoOWunuS9k+eahOaXtuWAmeWwseW3sue7j+aKpemUme+8jOi/memHjOS4jemcgOimgeWGjei/m+ihjOajgOafpVxyXG4gICAgY29uc3QgcHJpbWFyeVByb3BlcnR5ID0gcHJvcGVydGllcy5maW5kKChwcm9wZXJ0eTogQmluZGluZ1Byb3BlcnR5KSA9PiB7XHJcbiAgICAgIHJldHVybiBwcm9wZXJ0eS5pc1ByaW1hcnlLZXkgPT09IHRydWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcmltYXJ5UHJvcGVydHkgPyBwcmltYXJ5UHJvcGVydHkubmFtZSA6ICcnO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IFByb3BlcnR5VXRpbCB9O1xyXG4iXX0=