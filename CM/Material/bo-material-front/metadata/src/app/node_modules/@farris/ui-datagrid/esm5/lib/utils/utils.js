/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
var /*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
Utils = /** @class */ (function () {
    function Utils() {
    }
    /**
     * @return {?}
     */
    Utils.uuid = /**
     * @return {?}
     */
    function () {
        /**
         * @return {?}
         */
        function S4() {
            // tslint:disable-next-line: no-bitwise
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    };
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     */
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    Utils.getValue = /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    function (field, data, safe) {
        if (safe === void 0) { safe = false; }
        if (!data) {
            return '';
        }
        /** @type {?} */
        var resultVal = '';
        if (field.indexOf('.') === -1 || data.hasOwnProperty(field)) {
            resultVal = data[field];
        }
        else {
            resultVal = field.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            function (obj, key) {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), data);
        }
        if (safe) {
            return this.escapeValue(resultVal);
        }
        return resultVal;
    };
    /**
     * @param {?} field
     * @param {?} val
     * @param {?} obj
     * @param {?=} nest
     * @return {?}
     */
    Utils.setValue = /**
     * @param {?} field
     * @param {?} val
     * @param {?} obj
     * @param {?=} nest
     * @return {?}
     */
    function (field, val, obj, nest) {
        if (nest === void 0) { nest = true; }
        if (field) {
            if (field.indexOf('.') > -1 && nest) {
                /** @type {?} */
                var lastObj_1 = null;
                /** @type {?} */
                var _fields = field.split('.');
                _fields.reduce((/**
                 * @param {?} c
                 * @param {?} p
                 * @return {?}
                 */
                function (c, p) {
                    lastObj_1 = c;
                    return c[p];
                }), obj);
                if (lastObj_1) {
                    lastObj_1[_fields.pop()] = val;
                }
            }
            else {
                obj[field] = val;
            }
        }
    };
    /** 获取多语值 */
    /**
     * 获取多语值
     * @param {?} valObj
     * @param {?} localeId
     * @return {?}
     */
    Utils.getMultilingualValue = /**
     * 获取多语值
     * @param {?} valObj
     * @param {?} localeId
     * @return {?}
     */
    function (valObj, localeId) {
        if (valObj && typeof valObj === 'object' && Object.keys(valObj).length > 0) {
            localeId = localeId || 'zh-CHS';
            /** @type {?} */
            var val = valObj[localeId];
            if (val !== undefined) {
                return val;
            }
            else {
                return '';
            }
        }
        else {
            return '';
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    Utils.escapeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val === null || val === undefined || val === '') {
            return '';
        }
        /** @type {?} */
        var escapeHTML = (/**
         * @param {?} unsafe_str
         * @return {?}
         */
        function (unsafe_str) {
            return unsafe_str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\"/g, '&quot;')
                .replace(/\'/g, '&#39;')
                .replace(/\//g, '&#x2F;');
            // .replace('src','drc');
        });
        if (typeof val === 'string') {
            return escapeHTML(val);
        }
        return val;
    };
    /**
     * @param {?} evt
     * @return {?}
     */
    Utils.eventPath = /**
     * @param {?} evt
     * @return {?}
     */
    function (evt) {
        /** @type {?} */
        var path = (evt.composedPath && evt.composedPath()) || evt.path;
        /** @type {?} */
        var target = evt.target;
        if (path != null) {
            return (path.indexOf(window) < 0) ? path.concat(window) : path;
        }
        if (target === window) {
            return [window];
        }
        /** @type {?} */
        var getParents = (/**
         * @param {?} node
         * @param {?=} memo
         * @return {?}
         */
        function (node, memo) {
            if (memo === void 0) { memo = undefined; }
            memo = memo || [];
            /** @type {?} */
            var parentNode = node.parentNode;
            if (!parentNode) {
                return memo;
            }
            else {
                return getParents(parentNode, memo.concat(parentNode));
            }
        });
        return [target].concat(getParents(target), window);
    };
    /**
     * @return {?}
     */
    Utils.hasDialogOpen = /**
     * @return {?}
     */
    function () {
        // return document.body.classList.value.indexOf('modal-open') > -1;
        // 兼容IE 11
        return document.body.className.indexOf('modal-open') > -1;
    };
    /**
     * @param {?} el
     * @param {?} evt
     * @param {?} fn
     * @param {?=} opts
     * @return {?}
     */
    Utils.on = /**
     * @param {?} el
     * @param {?} evt
     * @param {?} fn
     * @param {?=} opts
     * @return {?}
     */
    function (el, evt, fn, opts) {
        if (opts === void 0) { opts = {}; }
        /** @type {?} */
        var delegatorFn = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.target.matches(opts.target) && fn.call(e.target, e); });
        el.addEventListener(evt, opts.target ? delegatorFn : fn, opts.options || false);
        return (/**
         * @return {?}
         */
        function () {
            el.removeEventListener(evt, delegatorFn, opts);
        });
    };
    /**
     * @param {?} el
     * @param {?} evt
     * @param {?=} fn
     * @param {?=} opts
     * @return {?}
     */
    Utils.off = /**
     * @param {?} el
     * @param {?} evt
     * @param {?=} fn
     * @param {?=} opts
     * @return {?}
     */
    function (el, evt, fn, opts) {
        if (fn === void 0) { fn = (/**
         * @return {?}
         */
        function () { }); }
        if (opts === void 0) { opts = {}; }
        el.removeEventListener(evt, fn, opts);
    };
    /** 获取字符长度，中文汉字占2个字符 */
    /**
     * 获取字符长度，中文汉字占2个字符
     * @param {?} str
     * @return {?}
     */
    Utils.getBLen = /**
     * 获取字符长度，中文汉字占2个字符
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str == null) {
            return 0;
        }
        if (typeof str !== 'string') {
            str += '';
        }
        return str.replace(/[^\x00-\xff]/g, '01').length;
    };
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    /**
     * @param {?} col
     * @param {?} localeId
     * @return {?}
     */
    Utils.getWhenEmptyText = 
    // static difference(first: any[], second: any[]): any[] {
    //     return first.filter(item => !second.includes(item));
    // }
    // static getDiffItems(arr1, arr2) {
    //     const diff1 = Utils.difference(arr1, arr2);
    //     const diff2 = Utils.difference(arr2, arr1);
    //     return diff1.concat(diff2);
    // }
    /**
     * @param {?} col
     * @param {?} localeId
     * @return {?}
     */
    function (col, localeId) {
        /** @type {?} */
        var EMPTY_INPUT_TEXT = {
            'zh-CHS': '请输入',
            'zh-CHT': '請輸入',
            en: 'Please input'
        };
        /** @type {?} */
        var EMPTY_SELECT_TEXT = {
            'zh-CHS': '请选择',
            'zh-CHT': '請選擇',
            en: 'Please select'
        };
        if (col.editor) {
            switch (col.editor.type) {
                case 'datepicker':
                case 'select':
                case 'lookup':
                case 'combolist':
                case 'combo-lookup':
                    return EMPTY_SELECT_TEXT[localeId];
                default:
                    return EMPTY_INPUT_TEXT[localeId];
            }
        }
        // 控制面板列
        if (col.field === '_datagrid-setting-control_') {
            return '';
        }
        return EMPTY_INPUT_TEXT[localeId];
    };
    return Utils;
}());
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:53
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 20:31:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
export { Utils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL3V0aWxzL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQVFBOzs7Ozs7Ozs7SUFBQTtJQW1NQSxDQUFDOzs7O0lBak1VLFVBQUk7OztJQUFYOzs7O1FBQ0ksU0FBUyxFQUFFO1lBQ1AsdUNBQXVDO1lBQ3ZDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0UsQ0FBQztRQUNELE9BQU8sQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsR0FBRyxHQUFHLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMzRixDQUFDO0lBR0Q7O09BRUc7Ozs7Ozs7O0lBQ0ksY0FBUTs7Ozs7OztJQUFmLFVBQWdCLEtBQWEsRUFBRSxJQUFTLEVBQUUsSUFBWTtRQUFaLHFCQUFBLEVBQUEsWUFBWTtRQUNsRCxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsT0FBUSxFQUFFLENBQUM7U0FDZDs7WUFDRyxTQUFTLEdBQUcsRUFBRTtRQUNsQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN6RCxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQzNCO2FBQU07WUFDSCxTQUFTLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNOzs7OztZQUFDLFVBQUMsR0FBRyxFQUFFLEdBQUc7Z0JBQ3pDLElBQUksR0FBRyxFQUFFO29CQUNMLE9BQU8sR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2lCQUNuQjtxQkFBTTtvQkFDSCxPQUFPLElBQUksQ0FBQztpQkFDZjtZQUNMLENBQUMsR0FBRSxJQUFJLENBQUMsQ0FBQztTQUNaO1FBRUQsSUFBSSxJQUFJLEVBQUU7WUFDTixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDdEM7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDOzs7Ozs7OztJQUVNLGNBQVE7Ozs7Ozs7SUFBZixVQUFpQixLQUFhLEVBQUUsR0FBUSxFQUFFLEdBQTJCLEVBQUUsSUFBVztRQUFYLHFCQUFBLEVBQUEsV0FBVztRQUM5RSxJQUFJLEtBQUssRUFBRTtZQUNQLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLEVBQUU7O29CQUM3QixTQUFPLEdBQUcsSUFBSTs7b0JBQ1osT0FBTyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO2dCQUNoQyxPQUFPLENBQUMsTUFBTTs7Ozs7Z0JBQUUsVUFBQyxDQUFDLEVBQUUsQ0FBQztvQkFDakIsU0FBTyxHQUFHLENBQUMsQ0FBQztvQkFDWixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDaEIsQ0FBQyxHQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUVSLElBQUksU0FBTyxFQUFFO29CQUNULFNBQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUM7aUJBQ2hDO2FBQ0o7aUJBQU07Z0JBQ0gsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQzthQUNwQjtTQUNKO0lBQ0wsQ0FBQztJQUVELFlBQVk7Ozs7Ozs7SUFDTCwwQkFBb0I7Ozs7OztJQUEzQixVQUE0QixNQUFNLEVBQUUsUUFBUTtRQUN4QyxJQUFJLE1BQU0sSUFBSSxPQUFPLE1BQU0sS0FBSyxRQUFRLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ3hFLFFBQVEsR0FBRyxRQUFRLElBQUksUUFBUSxDQUFDOztnQkFDMUIsR0FBRyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUM7WUFDNUIsSUFBSSxHQUFHLEtBQUssU0FBUyxFQUFFO2dCQUNuQixPQUFPLEdBQUcsQ0FBQzthQUNkO2lCQUFNO2dCQUNILE9BQU8sRUFBRSxDQUFDO2FBQ2I7U0FDSjthQUFNO1lBQ0gsT0FBTyxFQUFFLENBQUM7U0FDYjtJQUNMLENBQUM7Ozs7O0lBR00saUJBQVc7Ozs7SUFBbEIsVUFBbUIsR0FBUTtRQUN2QixJQUFJLEdBQUcsS0FBSyxJQUFJLElBQUksR0FBRyxLQUFLLFNBQVMsSUFBSSxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQ2pELE9BQU8sRUFBRSxDQUFDO1NBQ2I7O1lBRUssVUFBVTs7OztRQUFHLFVBQUMsVUFBVTtZQUMxQixPQUFPLFVBQVU7aUJBQ1osT0FBTyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUM7aUJBQ3RCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDO2lCQUNyQixPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQztpQkFDckIsT0FBTyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUM7aUJBQ3hCLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDO2lCQUN2QixPQUFPLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzFCLHlCQUF5QjtRQUNqQyxDQUFDLENBQUE7UUFFRCxJQUFJLE9BQU8sR0FBRyxLQUFLLFFBQVEsRUFBRTtZQUN6QixPQUFPLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMxQjtRQUVELE9BQU8sR0FBRyxDQUFDO0lBQ2YsQ0FBQzs7Ozs7SUFFTSxlQUFTOzs7O0lBQWhCLFVBQWlCLEdBQVE7O1lBQ2YsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLFlBQVksSUFBSSxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSTs7WUFDM0QsTUFBTSxHQUFHLEdBQUcsQ0FBQyxNQUFNO1FBRXpCLElBQUksSUFBSSxJQUFJLElBQUksRUFBRTtZQUNkLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7U0FDbEU7UUFFRCxJQUFJLE1BQU0sS0FBSyxNQUFNLEVBQUU7WUFDbkIsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ25COztZQUVLLFVBQVU7Ozs7O1FBQUcsVUFBQyxJQUFJLEVBQUUsSUFBZ0I7WUFBaEIscUJBQUEsRUFBQSxnQkFBZ0I7WUFDdEMsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7O2dCQUNaLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVTtZQUVsQyxJQUFJLENBQUMsVUFBVSxFQUFFO2dCQUNiLE9BQU8sSUFBSSxDQUFDO2FBQ2Y7aUJBQU07Z0JBQ0gsT0FBTyxVQUFVLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQzthQUMxRDtRQUNMLENBQUMsQ0FBQTtRQUVELE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZELENBQUM7Ozs7SUFFTSxtQkFBYTs7O0lBQXBCO1FBQ0ksbUVBQW1FO1FBQ25FLFVBQVU7UUFDVixPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM5RCxDQUFDOzs7Ozs7OztJQUVNLFFBQUU7Ozs7Ozs7SUFBVCxVQUFVLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLElBQWM7UUFBZCxxQkFBQSxFQUFBLFNBQWM7O1lBQzNCLFdBQVc7Ozs7UUFBRyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLEVBQXJELENBQXFELENBQUE7UUFDOUUsRUFBRSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsT0FBTyxJQUFJLEtBQUssQ0FBQyxDQUFDO1FBQ2hGOzs7UUFBTztZQUNILEVBQUUsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ25ELENBQUMsRUFBQztJQUNOLENBQUM7Ozs7Ozs7O0lBRU0sU0FBRzs7Ozs7OztJQUFWLFVBQVcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFZLEVBQUUsSUFBYztRQUE1QixtQkFBQSxFQUFBOzs7UUFBSSxjQUFPLENBQUMsQ0FBQTtRQUFFLHFCQUFBLEVBQUEsU0FBYztRQUM1QyxFQUFFLENBQUMsbUJBQW1CLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0QsdUJBQXVCOzs7Ozs7SUFDaEIsYUFBTzs7Ozs7SUFBZCxVQUFlLEdBQUc7UUFDZCxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUU7WUFDYixPQUFPLENBQUMsQ0FBQztTQUNaO1FBQ0QsSUFBSSxPQUFPLEdBQUcsS0FBSyxRQUFRLEVBQUU7WUFDM0IsR0FBRyxJQUFJLEVBQUUsQ0FBQztTQUNYO1FBQ0QsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDckQsQ0FBQztJQUVELDBEQUEwRDtJQUMxRCwyREFBMkQ7SUFDM0QsSUFBSTtJQUVKLG9DQUFvQztJQUNwQyxrREFBa0Q7SUFDbEQsa0RBQWtEO0lBRWxELGtDQUFrQztJQUNsQyxJQUFJOzs7Ozs7Ozs7Ozs7OztJQUVHLHNCQUFnQjs7Ozs7Ozs7Ozs7Ozs7SUFBdkIsVUFBd0IsR0FBUSxFQUFFLFFBQVE7O1lBRWhDLGdCQUFnQixHQUFHO1lBQ3JCLFFBQVEsRUFBRSxLQUFLO1lBQ2YsUUFBUSxFQUFFLEtBQUs7WUFDZixFQUFFLEVBQUUsY0FBYztTQUNyQjs7WUFFSyxpQkFBaUIsR0FBRztZQUN0QixRQUFRLEVBQUUsS0FBSztZQUNmLFFBQVEsRUFBRSxLQUFLO1lBQ2YsRUFBRSxFQUFFLGVBQWU7U0FDdEI7UUFHRCxJQUFJLEdBQUcsQ0FBQyxNQUFNLEVBQUU7WUFDWixRQUFRLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO2dCQUNyQixLQUFLLFlBQVksQ0FBQztnQkFDbEIsS0FBSyxRQUFRLENBQUM7Z0JBQ2QsS0FBSyxRQUFRLENBQUM7Z0JBQ2QsS0FBSyxXQUFXLENBQUM7Z0JBQ2pCLEtBQUssY0FBYztvQkFDZixPQUFRLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUN4QztvQkFDSSxPQUFPLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ3pDO1NBQ0o7UUFFRCxRQUFRO1FBQ1IsSUFBSSxHQUFHLENBQUMsS0FBSyxLQUFLLDRCQUE0QixFQUFFO1lBQzVDLE9BQU8sRUFBRSxDQUFDO1NBQ2I7UUFFRCxPQUFPLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFDTCxZQUFDO0FBQUQsQ0FBQyxBQW5NRCxJQW1NQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMDYgMDc6NDM6NTNcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMTkgMjA6MzE6MjdcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmV4cG9ydCBjbGFzcyBVdGlscyB7XHJcblxyXG4gICAgc3RhdGljIHV1aWQoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gUzQoKSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYml0d2lzZVxyXG4gICAgICAgICAgICByZXR1cm4gKCgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkgfCAwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKFM0KCkgKyBTNCgpICsgJy0nICsgUzQoKSArICctJyArIFM0KCkgKyAnLScgKyBTNCgpICsgJy0nICsgUzQoKSArIFM0KCkgKyBTNCgpKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blr7nosaHkuK3mjIflrprlrZfmrrXnmoTlgLzjgIIgZmllbGQ6IOWPr+S7peS4uuW4puacieWxgue6p+e7k+aehOeahOi3r+W+hO+8jOWmgu+8miB1c2VyLmZpcnN0TmFtZSB8IG5hbWUg562JXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBnZXRWYWx1ZShmaWVsZDogc3RyaW5nLCBkYXRhOiBhbnksIHNhZmUgPSBmYWxzZSkge1xyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcmVzdWx0VmFsID0gJyc7XHJcbiAgICAgICAgaWYgKGZpZWxkLmluZGV4T2YoJy4nKSA9PT0gLTEgfHwgZGF0YS5oYXNPd25Qcm9wZXJ0eShmaWVsZCkpIHtcclxuICAgICAgICAgICAgcmVzdWx0VmFsID0gZGF0YVtmaWVsZF07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0VmFsID0gZmllbGQuc3BsaXQoJy4nKS5yZWR1Y2UoKG9iaiwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialtrZXldO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2FmZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lc2NhcGVWYWx1ZShyZXN1bHRWYWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0VmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBzZXRWYWx1ZSggZmllbGQ6IHN0cmluZywgdmFsOiBhbnksIG9iajogeyBba2V5OiBzdHJpbmddOiBhbnkgfSwgbmVzdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAoZmllbGQpIHtcclxuICAgICAgICAgICAgaWYgKGZpZWxkLmluZGV4T2YoJy4nKSA+IC0xICYmIG5lc3QpIHtcclxuICAgICAgICAgICAgICAgIGxldCBsYXN0T2JqID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9maWVsZHMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICAgICAgX2ZpZWxkcy5yZWR1Y2UoIChjLCBwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9iaiA9IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNbcF07XHJcbiAgICAgICAgICAgICAgICB9LCBvYmopO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChsYXN0T2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9ialtfZmllbGRzLnBvcCgpXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9ialtmaWVsZF0gPSB2YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOiOt+WPluWkmuivreWAvCAqL1xyXG4gICAgc3RhdGljIGdldE11bHRpbGluZ3VhbFZhbHVlKHZhbE9iaiwgbG9jYWxlSWQpIHtcclxuICAgICAgICBpZiAodmFsT2JqICYmIHR5cGVvZiB2YWxPYmogPT09ICdvYmplY3QnICYmIE9iamVjdC5rZXlzKHZhbE9iaikubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsb2NhbGVJZCA9IGxvY2FsZUlkIHx8ICd6aC1DSFMnO1xyXG4gICAgICAgICAgICBjb25zdCB2YWwgPSB2YWxPYmpbbG9jYWxlSWRdO1xyXG4gICAgICAgICAgICBpZiAodmFsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzdGF0aWMgZXNjYXBlVmFsdWUodmFsOiBhbnkpIHtcclxuICAgICAgICBpZiAodmFsID09PSBudWxsIHx8IHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZXNjYXBlSFRNTCA9ICh1bnNhZmVfc3RyKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bnNhZmVfc3RyXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJmFtcDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXCIvZywgJyZxdW90OycpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwnL2csICcmIzM5OycpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwvL2csICcmI3gyRjsnKTtcclxuICAgICAgICAgICAgICAgIC8vIC5yZXBsYWNlKCdzcmMnLCdkcmMnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUhUTUwodmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGV2ZW50UGF0aChldnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHBhdGggPSAoZXZ0LmNvbXBvc2VkUGF0aCAmJiBldnQuY29tcG9zZWRQYXRoKCkpIHx8IGV2dC5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2dC50YXJnZXQ7XHJcblxyXG4gICAgICAgIGlmIChwYXRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChwYXRoLmluZGV4T2Yod2luZG93KSA8IDApID8gcGF0aC5jb25jYXQod2luZG93KSA6IHBhdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFt3aW5kb3ddO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZ2V0UGFyZW50cyA9IChub2RlLCBtZW1vID0gdW5kZWZpbmVkKSA9PiB7XHJcbiAgICAgICAgICAgIG1lbW8gPSBtZW1vIHx8IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQYXJlbnRzKHBhcmVudE5vZGUsIG1lbW8uY29uY2F0KHBhcmVudE5vZGUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBbdGFyZ2V0XS5jb25jYXQoZ2V0UGFyZW50cyh0YXJnZXQpLCB3aW5kb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBoYXNEaWFsb2dPcGVuKCkge1xyXG4gICAgICAgIC8vIHJldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC52YWx1ZS5pbmRleE9mKCdtb2RhbC1vcGVuJykgPiAtMTtcclxuICAgICAgICAvLyDlhbzlrrlJRSAxMVxyXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZS5pbmRleE9mKCdtb2RhbC1vcGVuJykgPiAtMTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgb24oZWwsIGV2dCwgZm4sIG9wdHM6IGFueSA9IHt9KSB7XHJcbiAgICAgICAgY29uc3QgZGVsZWdhdG9yRm4gPSBlID0+IGUudGFyZ2V0Lm1hdGNoZXMob3B0cy50YXJnZXQpICYmIGZuLmNhbGwoZS50YXJnZXQsIGUpO1xyXG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCBvcHRzLnRhcmdldCA/IGRlbGVnYXRvckZuIDogZm4sIG9wdHMub3B0aW9ucyB8fCBmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldnQsIGRlbGVnYXRvckZuLCBvcHRzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBvZmYoZWwsIGV2dCwgZm49ICgpID0+IHt9LCBvcHRzOiBhbnkgPSB7fSkge1xyXG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0LCBmbiwgb3B0cyk7XHJcbiAgICB9XHJcbiAgICAvKiog6I635Y+W5a2X56ym6ZW/5bqm77yM5Lit5paH5rGJ5a2X5Y2gMuS4quWtl+espiAqL1xyXG4gICAgc3RhdGljIGdldEJMZW4oc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIHN0ciAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIHN0ciArPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9bXlxceDAwLVxceGZmXS9nLCAnMDEnKS5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc3RhdGljIGRpZmZlcmVuY2UoZmlyc3Q6IGFueVtdLCBzZWNvbmQ6IGFueVtdKTogYW55W10ge1xyXG4gICAgLy8gICAgIHJldHVybiBmaXJzdC5maWx0ZXIoaXRlbSA9PiAhc2Vjb25kLmluY2x1ZGVzKGl0ZW0pKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyBzdGF0aWMgZ2V0RGlmZkl0ZW1zKGFycjEsIGFycjIpIHtcclxuICAgIC8vICAgICBjb25zdCBkaWZmMSA9IFV0aWxzLmRpZmZlcmVuY2UoYXJyMSwgYXJyMik7XHJcbiAgICAvLyAgICAgY29uc3QgZGlmZjIgPSBVdGlscy5kaWZmZXJlbmNlKGFycjIsIGFycjEpO1xyXG5cclxuICAgIC8vICAgICByZXR1cm4gZGlmZjEuY29uY2F0KGRpZmYyKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICBzdGF0aWMgZ2V0V2hlbkVtcHR5VGV4dChjb2w6IGFueSwgbG9jYWxlSWQpIHtcclxuXHJcbiAgICAgICAgY29uc3QgRU1QVFlfSU5QVVRfVEVYVCA9IHtcclxuICAgICAgICAgICAgJ3poLUNIUyc6ICfor7fovpPlhaUnLFxyXG4gICAgICAgICAgICAnemgtQ0hUJzogJ+iri+i8uOWFpScsXHJcbiAgICAgICAgICAgIGVuOiAnUGxlYXNlIGlucHV0J1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IEVNUFRZX1NFTEVDVF9URVhUID0ge1xyXG4gICAgICAgICAgICAnemgtQ0hTJzogJ+ivt+mAieaLqScsXHJcbiAgICAgICAgICAgICd6aC1DSFQnOiAn6KuL6YG45pOHJyxcclxuICAgICAgICAgICAgZW46ICdQbGVhc2Ugc2VsZWN0J1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBpZiAoY29sLmVkaXRvcikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbC5lZGl0b3IudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGF0ZXBpY2tlcic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3QnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbG9va3VwJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbWJvbGlzdCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjb21iby1sb29rdXAnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgRU1QVFlfU0VMRUNUX1RFWFRbbG9jYWxlSWRdO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfSU5QVVRfVEVYVFtsb2NhbGVJZF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOaOp+WItumdouadv+WIl1xyXG4gICAgICAgIGlmIChjb2wuZmllbGQgPT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIEVNUFRZX0lOUFVUX1RFWFRbbG9jYWxlSWRdO1xyXG4gICAgfVxyXG59XHJcblxyXG4iXX0=