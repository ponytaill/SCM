import { ApplicationRef, ChangeDetectorRef, Injectable, Injector } from "@angular/core";
/**
 * angular 脏值检查服务
 */
export class DirtyCheckingService {
    constructor(injector, cd, appRef) {
        this.injector = injector;
        this.cd = cd;
        this.appRef = appRef;
    }
    /**
     * Checks this view and its children.
     * @param global 是否全局检查
     */
    detectChanges(global) {
        global = (global === true || global === 'true') ? true : false;
        if (global && this.appRef) {
            this.appRef.tick();
        }
        else if (this.cd) {
            this.cd.detectChanges();
        }
    }
    /**
     * 在指定时间（ms）后触发Angular脏值检查
     * @param duration 超时时间(ms)
     * @param global 是否全局检查
     */
    detectChangesAfter(duration, global) {
        global = (global === true || global === 'true') ? true : false;
        if (isNaN(duration)) {
            return;
        }
        if (global && this.appRef) {
            window.setTimeout(() => {
                this.appRef.tick();
            }, duration);
        }
        else if (this.cd) {
            window.setTimeout(() => {
                this.cd.detectChanges();
            }, duration);
        }
    }
}
DirtyCheckingService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
DirtyCheckingService.ctorParameters = () => [
    { type: Injector },
    { type: ChangeDetectorRef },
    { type: ApplicationRef }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlydHktY2hlY2tpbmcuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tbWFuZC1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi9kaXJ0eS1jaGVja2luZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxjQUFjLEVBQUUsaUJBQWlCLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV4Rjs7R0FFRztBQUVILE1BQU0sT0FBTyxvQkFBb0I7SUFDL0IsWUFBbUIsUUFBa0IsRUFBVSxFQUFxQixFQUFVLE1BQXNCO1FBQWpGLGFBQVEsR0FBUixRQUFRLENBQVU7UUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUFVLFdBQU0sR0FBTixNQUFNLENBQWdCO0lBQ3BHLENBQUM7SUFDRDs7O09BR0c7SUFDSSxhQUFhLENBQUMsTUFBeUI7UUFDNUMsTUFBTSxHQUFHLENBQUMsTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQy9ELElBQUksTUFBTSxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNwQjthQUFNLElBQUksSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO1NBQ3pCO0lBQ0gsQ0FBQztJQUNEOzs7O09BSUc7SUFDSSxrQkFBa0IsQ0FBQyxRQUFnQixFQUFFLE1BQXlCO1FBQ25FLE1BQU0sR0FBRyxDQUFDLE1BQU0sS0FBSyxJQUFJLElBQUksTUFBTSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUMvRCxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUNuQixPQUFPO1NBQ1I7UUFDRCxJQUFJLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ3pCLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFO2dCQUNyQixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3JCLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztTQUNkO2FBQU0sSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFO2dCQUNyQixJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzFCLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztTQUNkO0lBQ0gsQ0FBQzs7O1lBbkNGLFVBQVU7Ozs7WUFMNkMsUUFBUTtZQUF2QyxpQkFBaUI7WUFBakMsY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcGxpY2F0aW9uUmVmLCBDaGFuZ2VEZXRlY3RvclJlZiwgSW5qZWN0YWJsZSwgSW5qZWN0b3IgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuXG4vKipcbiAqIGFuZ3VsYXIg6ISP5YC85qOA5p+l5pyN5YqhXG4gKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBEaXJ0eUNoZWNraW5nU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBpbmplY3RvcjogSW5qZWN0b3IsIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLCBwcml2YXRlIGFwcFJlZjogQXBwbGljYXRpb25SZWYpIHtcbiAgfVxuICAvKipcbiAgICogQ2hlY2tzIHRoaXMgdmlldyBhbmQgaXRzIGNoaWxkcmVuLiBcbiAgICogQHBhcmFtIGdsb2JhbCDmmK/lkKblhajlsYDmo4Dmn6VcbiAgICovXG4gIHB1YmxpYyBkZXRlY3RDaGFuZ2VzKGdsb2JhbD86IGJvb2xlYW4gfCBzdHJpbmcpIHtcbiAgICBnbG9iYWwgPSAoZ2xvYmFsID09PSB0cnVlIHx8IGdsb2JhbCA9PT0gJ3RydWUnKSA/IHRydWUgOiBmYWxzZTtcbiAgICBpZiAoZ2xvYmFsICYmIHRoaXMuYXBwUmVmKSB7XG4gICAgICB0aGlzLmFwcFJlZi50aWNrKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNkKSB7XG4gICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIOWcqOaMh+WumuaXtumXtO+8iG1z77yJ5ZCO6Kem5Y+RQW5ndWxhcuiEj+WAvOajgOafpVxuICAgKiBAcGFyYW0gZHVyYXRpb24g6LaF5pe25pe26Ze0KG1zKVxuICAgKiBAcGFyYW0gZ2xvYmFsIOaYr+WQpuWFqOWxgOajgOafpVxuICAgKi9cbiAgcHVibGljIGRldGVjdENoYW5nZXNBZnRlcihkdXJhdGlvbjogbnVtYmVyLCBnbG9iYWw/OiBib29sZWFuIHwgc3RyaW5nKSB7XG4gICAgZ2xvYmFsID0gKGdsb2JhbCA9PT0gdHJ1ZSB8fCBnbG9iYWwgPT09ICd0cnVlJykgPyB0cnVlIDogZmFsc2U7XG4gICAgaWYgKGlzTmFOKGR1cmF0aW9uKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZ2xvYmFsICYmIHRoaXMuYXBwUmVmKSB7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuYXBwUmVmLnRpY2soKTtcbiAgICAgIH0sIGR1cmF0aW9uKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2QpIHtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICB9LCBkdXJhdGlvbik7XG4gICAgfVxuICB9XG59Il19