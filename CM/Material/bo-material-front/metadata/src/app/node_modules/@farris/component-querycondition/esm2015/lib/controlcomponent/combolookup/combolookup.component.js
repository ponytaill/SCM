/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/combolookup/combolookup.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
export class ComboLookUpComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        this.selectedValues = "";
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.getComboLookUpBindingInfo();
        this.testId = this.solutionService.getGuid();
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.autoWidth = false;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.getComboLookUpBindingInfo();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            const isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            field => field == this.item.fieldCode));
            if (isChange) {
                this.textValue = ((/** @type {?} */ (this.item.value))).textValue;
            }
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    valueChangeHandler(data) {
        /** @type {?} */
        const helpValue = ((/** @type {?} */ (this.item.value)));
        helpValue.value = data.selections;
        helpValue.valueField = this.valueField;
        helpValue.textValue = helpValue.getTextValue(this.textField);
        this.textValue = helpValue.textValue;
        this.conditionChange.emit();
    }
    /**
     * @return {?}
     */
    getComboLookUpBindingInfo() {
        /** @type {?} */
        const comboLookUpControl = ((/** @type {?} */ (this.item.control)));
        this.uri = comboLookUpControl.uri;
        this.idField = comboLookUpControl.idField;
        this.valueField = comboLookUpControl.valueField;
        this.textField = comboLookUpControl.textField;
        this.mapFields = comboLookUpControl.mapFields;
        this.displayType = comboLookUpControl.displayType;
        this.preEventCmd = comboLookUpControl.preEventCmd;
        this.postEventCmd = comboLookUpControl.postEventCmd;
        this.multiSelect = comboLookUpControl.singleSelect === true ? false : true;
        this.panelWidth = comboLookUpControl.panelWidth ? comboLookUpControl.panelWidth : 300;
        this.panelHeight = comboLookUpControl.panelHeight ? comboLookUpControl.panelHeight : 300;
        /** @type {?} */
        const comboLookUpValue = ((/** @type {?} */ (this.item.value)));
        if (comboLookUpValue.textValue == 'help-text-value-null') { //旧数据兼容
            this.textValue = comboLookUpValue.getTextValue(this.textField);
        }
        else {
            this.textValue = comboLookUpValue.textValue;
        }
        if (comboLookUpValue && comboLookUpValue.value) {
            this.selectedValues = (comboLookUpValue.value || []).map((/**
             * @param {?} n
             * @return {?}
             */
            n => n[this.idField])).join(',');
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    clearData(data) {
        ((/** @type {?} */ (this.item.value))).clearValue();
        this.conditionChange.emit();
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
}
ComboLookUpComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-combolookup',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group common-group \"  [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-combo-lookup *ngIf=\"item\"\r\n                [uri]=\"uri\"\r\n                [placeholder]=\"placeholder\"\r\n                [(ngModel)]=\"textValue\"\r\n                [idField]=\"idField\"\r\n                [valueField]=\"valueField\"\r\n                [textField]=\"textField\"\r\n                [mapFields]=\"mapFields\"\r\n                [displayType]=\"displayType\"\r\n                [multiSelect]=\"multiSelect\"\r\n                [selectedValues]=\"selectedValues\"\r\n                [beforeShow]=\"preEventCmd\"\r\n                [beforeHide]=\"postEventCmd\"\r\n                (valueChange)=\"valueChangeHandler($event)\"\r\n                (clear)=\"clearData($event)\"\r\n                [autoWidth]=\"autoWidth\"\r\n                [panelWidth]=\"panelWidth\"\r\n                [panelHeight]=\"panelHeight\"\r\n                [readonly]=\"item.readonly\"\r\n                id=\"{{testId}}\"\r\n            >\r\n        </farris-combo-lookup>\r\n        </div>\r\n    </div>\r\n</div>"
            }] }
];
/** @nocollapse */
ComboLookUpComponent.ctorParameters = () => [
    { type: SolutionService }
];
ComboLookUpComponent.propDecorators = {
    item: [{ type: Input }],
    changeFields: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }]
};
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    ComboLookUpComponent.prototype.item;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    ComboLookUpComponent.prototype.changeFields;
    /** @type {?} */
    ComboLookUpComponent.prototype.conditionChange;
    /** @type {?} */
    ComboLookUpComponent.prototype.uri;
    /** @type {?} */
    ComboLookUpComponent.prototype.idField;
    /** @type {?} */
    ComboLookUpComponent.prototype.valueField;
    /** @type {?} */
    ComboLookUpComponent.prototype.textField;
    /** @type {?} */
    ComboLookUpComponent.prototype.textValue;
    /** @type {?} */
    ComboLookUpComponent.prototype.mapFields;
    /** @type {?} */
    ComboLookUpComponent.prototype.displayType;
    /** @type {?} */
    ComboLookUpComponent.prototype.multiSelect;
    /** @type {?} */
    ComboLookUpComponent.prototype.preEventCmd;
    /** @type {?} */
    ComboLookUpComponent.prototype.postEventCmd;
    /** @type {?} */
    ComboLookUpComponent.prototype.testId;
    /** @type {?} */
    ComboLookUpComponent.prototype.placeholder;
    /** @type {?} */
    ComboLookUpComponent.prototype.autoWidth;
    /** @type {?} */
    ComboLookUpComponent.prototype.panelWidth;
    /** @type {?} */
    ComboLookUpComponent.prototype.panelHeight;
    /** @type {?} */
    ComboLookUpComponent.prototype.selectedValues;
    /**
     * @type {?}
     * @private
     */
    ComboLookUpComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tYm9sb29rdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvY29udHJvbGNvbXBvbmVudC9jb21ib2xvb2t1cC9jb21ib2xvb2t1cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLFlBQVksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFJekcsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBT2pFLE1BQU0sT0FBTyxvQkFBb0I7Ozs7SUErQjdCLFlBQW9CLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjs7OztRQXJCM0MsaUJBQVksR0FBa0IsRUFBRSxDQUFDO1FBRWYsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBaUJoRSxtQkFBYyxHQUFHLEVBQUUsQ0FBQztJQUVtQyxDQUFDOzs7O0lBRXhELFFBQVE7UUFDSixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUNqQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDN0MsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN2RyxJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztJQUMzQixDQUFDOzs7OztJQUVELFdBQVcsQ0FBQyxPQUFzQjtRQUM5QixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUNqQyxJQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsWUFBWSxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsRUFBRTs7a0JBQ2xHLFFBQVEsR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUk7Ozs7WUFBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBQztZQUNqRyxJQUFHLFFBQVEsRUFBQztnQkFDUixJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQW9CLENBQUMsQ0FBQyxTQUFTLENBQUM7YUFDcEU7U0FDSjtJQUNMLENBQUM7Ozs7O0lBRUQsa0JBQWtCLENBQUMsSUFBUzs7Y0FDbEIsU0FBUyxHQUFHLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQW9CLENBQUM7UUFDdkQsU0FBUyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ2xDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUN2QyxTQUFTLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzdELElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQztRQUNyQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hDLENBQUM7Ozs7SUFFRCx5QkFBeUI7O2NBQ2Ysa0JBQWtCLEdBQUcsQ0FBQyxtQkFBQSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBc0IsQ0FBQztRQUNwRSxJQUFJLENBQUMsR0FBRyxHQUFHLGtCQUFrQixDQUFDLEdBQUcsQ0FBQztRQUNsQyxJQUFJLENBQUMsT0FBTyxHQUFHLGtCQUFrQixDQUFDLE9BQU8sQ0FBQztRQUMxQyxJQUFJLENBQUMsVUFBVSxHQUFHLGtCQUFrQixDQUFDLFVBQVUsQ0FBQztRQUNoRCxJQUFJLENBQUMsU0FBUyxHQUFHLGtCQUFrQixDQUFDLFNBQVMsQ0FBQztRQUM5QyxJQUFJLENBQUMsU0FBUyxHQUFHLGtCQUFrQixDQUFDLFNBQVMsQ0FBQztRQUM5QyxJQUFJLENBQUMsV0FBVyxHQUFHLGtCQUFrQixDQUFDLFdBQVcsQ0FBQztRQUNsRCxJQUFJLENBQUMsV0FBVyxHQUFHLGtCQUFrQixDQUFDLFdBQVcsQ0FBQztRQUNsRCxJQUFJLENBQUMsWUFBWSxHQUFHLGtCQUFrQixDQUFDLFlBQVksQ0FBQztRQUNwRCxJQUFJLENBQUMsV0FBVyxHQUFHLGtCQUFrQixDQUFDLFlBQVksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQzNFLElBQUksQ0FBQyxVQUFVLEdBQUcsa0JBQWtCLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUN0RixJQUFJLENBQUMsV0FBVyxHQUFHLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7O2NBQ25GLGdCQUFnQixHQUFHLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQW9CLENBQUM7UUFDOUQsSUFBRyxnQkFBZ0IsQ0FBQyxTQUFTLElBQUksc0JBQXNCLEVBQUMsRUFBQyxPQUFPO1lBQzVELElBQUksQ0FBQyxTQUFTLEdBQUcsZ0JBQWdCLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUNsRTthQUFJO1lBQ0QsSUFBSSxDQUFDLFNBQVMsR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUM7U0FDL0M7UUFFRCxJQUFJLGdCQUFnQixJQUFJLGdCQUFnQixDQUFDLEtBQUssRUFBRTtZQUM1QyxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUc7Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDNUY7SUFDTCxDQUFDOzs7OztJQUVELFNBQVMsQ0FBQyxJQUFTO1FBQ2YsQ0FBQyxtQkFBQSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBb0IsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ25ELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDaEMsQ0FBQzs7Ozs7SUFFRCxxQkFBcUIsQ0FBQyxLQUFvQjtRQUN0QyxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMscUJBQXFCLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0QsQ0FBQzs7O1lBaEdKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsMEJBQTBCO2dCQUNwQyw2aERBQTJDO2FBQzlDOzs7O1lBTFEsZUFBZTs7O21CQVluQixLQUFLOzJCQUtMLEtBQUs7OEJBRUwsTUFBTSxTQUFDLGlCQUFpQjs7Ozs7OztJQVB6QixvQ0FBa0I7Ozs7O0lBS2xCLDRDQUEwQzs7SUFFMUMsK0NBQWdFOztJQUVoRSxtQ0FBWTs7SUFDWix1Q0FBYTs7SUFDYiwwQ0FBZ0I7O0lBQ2hCLHlDQUFrQjs7SUFDbEIseUNBQWU7O0lBQ2YseUNBQWU7O0lBQ2YsMkNBQWlCOztJQUNqQiwyQ0FBcUI7O0lBQ3JCLDJDQUFpQjs7SUFDakIsNENBQWtCOztJQUNsQixzQ0FBZTs7SUFDZiwyQ0FBb0I7O0lBQ3BCLHlDQUFtQjs7SUFDbkIsMENBQW1COztJQUNuQiwyQ0FBb0I7O0lBQ3BCLDhDQUFvQjs7Ozs7SUFFUiwrQ0FBd0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIE9uQ2hhbmdlcywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBDb21ib0xvb2tVcENvbnRyb2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvY29tYm9sb29rdXAvY29tYm9sb29rdXAtY29udHJvbCc7XHJcbmltcG9ydCB7IENvbWJvTG9va1VwVmFsdWUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29uZGl0aW9udmFsdWUvY29tYm9sb29rdXAtdmFsdWUnO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2FwcC1zb2x1dGlvbi1jb21ib2xvb2t1cCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29tYm9sb29rdXAuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbWJvTG9va1VwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LE9uQ2hhbmdlc3tcclxuICAgXHJcbiAgICAvKipcclxuICAgICAqIFF1ZXJ5Q29uZGl0aW9u57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGl0ZW06YW55O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+Q5Liq5a2X5q615Y+R55Sf5YC85Y+Y5YyW5LqL5Lu25pe277yM6ZyA6KaB5ZCM5q2l5riF56m655qE5a2X5q6177yM5Y+v6IO95LiN5piv5b2T5YmN5a2X5q61XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNoYW5nZUZpZWxkczogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG5cclxuICAgIEBPdXRwdXQoJ2NvbmRpdGlvbkNoYW5nZScpIGNvbmRpdGlvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICB1cmk6IHN0cmluZztcclxuICAgIGlkRmllbGQ6IGFueTtcclxuICAgIHZhbHVlRmllbGQ6IGFueTtcclxuICAgIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgdGV4dFZhbHVlOiBhbnk7XHJcbiAgICBtYXBGaWVsZHM6IGFueTtcclxuICAgIGRpc3BsYXlUeXBlOiBhbnk7XHJcbiAgICBtdWx0aVNlbGVjdDogYm9vbGVhbjtcclxuICAgIHByZUV2ZW50Q21kOiBhbnk7XHJcbiAgICBwb3N0RXZlbnRDbWQ6IGFueTtcclxuICAgIHRlc3RJZDogc3RyaW5nO1xyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICAgIGF1dG9XaWR0aDogYm9vbGVhbjtcclxuICAgIHBhbmVsV2lkdGg6IG51bWJlcjtcclxuICAgIHBhbmVsSGVpZ2h0OiBudW1iZXI7XHJcbiAgICBzZWxlY3RlZFZhbHVlcyA9IFwiXCI7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzb2x1dGlvblNlcnZpY2U6IFNvbHV0aW9uU2VydmljZSl7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmdldENvbWJvTG9va1VwQmluZGluZ0luZm8oKTtcclxuICAgICAgICB0aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gKHRoaXMuaXRlbS5wbGFjZUhvbGRlcikgPyAodGhpcy5pdGVtLnBsYWNlSG9sZGVyKSA6ICh0aGlzLml0ZW0uY29udHJvbC5wbGFjZWhvbGRlcik7XHJcbiAgICAgICAgdGhpcy5hdXRvV2lkdGggPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRDb21ib0xvb2tVcEJpbmRpbmdJbmZvKCk7XHJcbiAgICAgICAgaWYoY2hhbmdlc1snY2hhbmdlRmllbGRzJ10gJiYgY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlICYmICFjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5maXJzdENoYW5nZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0NoYW5nZSA9IGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZS5zb21lKGZpZWxkID0+IGZpZWxkID09IHRoaXMuaXRlbS5maWVsZENvZGUpO1xyXG4gICAgICAgICAgICBpZihpc0NoYW5nZSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgQ29tYm9Mb29rVXBWYWx1ZSkudGV4dFZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhbHVlQ2hhbmdlSGFuZGxlcihkYXRhOiBhbnkpe1xyXG4gICAgICAgIGNvbnN0IGhlbHBWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgQ29tYm9Mb29rVXBWYWx1ZSk7XHJcbiAgICAgICAgaGVscFZhbHVlLnZhbHVlID0gZGF0YS5zZWxlY3Rpb25zO1xyXG4gICAgICAgIGhlbHBWYWx1ZS52YWx1ZUZpZWxkID0gdGhpcy52YWx1ZUZpZWxkO1xyXG4gICAgICAgIGhlbHBWYWx1ZS50ZXh0VmFsdWUgPSBoZWxwVmFsdWUuZ2V0VGV4dFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICB0aGlzLnRleHRWYWx1ZSA9IGhlbHBWYWx1ZS50ZXh0VmFsdWU7XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvbWJvTG9va1VwQmluZGluZ0luZm8oKXtcclxuICAgICAgICBjb25zdCBjb21ib0xvb2tVcENvbnRyb2wgPSAodGhpcy5pdGVtLmNvbnRyb2wgYXMgQ29tYm9Mb29rVXBDb250cm9sKTtcclxuICAgICAgICB0aGlzLnVyaSA9IGNvbWJvTG9va1VwQ29udHJvbC51cmk7XHJcbiAgICAgICAgdGhpcy5pZEZpZWxkID0gY29tYm9Mb29rVXBDb250cm9sLmlkRmllbGQ7XHJcbiAgICAgICAgdGhpcy52YWx1ZUZpZWxkID0gY29tYm9Mb29rVXBDb250cm9sLnZhbHVlRmllbGQ7XHJcbiAgICAgICAgdGhpcy50ZXh0RmllbGQgPSBjb21ib0xvb2tVcENvbnRyb2wudGV4dEZpZWxkO1xyXG4gICAgICAgIHRoaXMubWFwRmllbGRzID0gY29tYm9Mb29rVXBDb250cm9sLm1hcEZpZWxkcztcclxuICAgICAgICB0aGlzLmRpc3BsYXlUeXBlID0gY29tYm9Mb29rVXBDb250cm9sLmRpc3BsYXlUeXBlO1xyXG4gICAgICAgIHRoaXMucHJlRXZlbnRDbWQgPSBjb21ib0xvb2tVcENvbnRyb2wucHJlRXZlbnRDbWQ7XHJcbiAgICAgICAgdGhpcy5wb3N0RXZlbnRDbWQgPSBjb21ib0xvb2tVcENvbnRyb2wucG9zdEV2ZW50Q21kO1xyXG4gICAgICAgIHRoaXMubXVsdGlTZWxlY3QgPSBjb21ib0xvb2tVcENvbnRyb2wuc2luZ2xlU2VsZWN0ID09PSB0cnVlID8gZmFsc2UgOiB0cnVlO1xyXG4gICAgICAgIHRoaXMucGFuZWxXaWR0aCA9IGNvbWJvTG9va1VwQ29udHJvbC5wYW5lbFdpZHRoID8gY29tYm9Mb29rVXBDb250cm9sLnBhbmVsV2lkdGggOiAzMDA7XHJcbiAgICAgICAgdGhpcy5wYW5lbEhlaWdodCA9IGNvbWJvTG9va1VwQ29udHJvbC5wYW5lbEhlaWdodCA/IGNvbWJvTG9va1VwQ29udHJvbC5wYW5lbEhlaWdodCA6IDMwMDtcclxuICAgICAgICBjb25zdCBjb21ib0xvb2tVcFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBDb21ib0xvb2tVcFZhbHVlKTtcclxuICAgICAgICBpZihjb21ib0xvb2tVcFZhbHVlLnRleHRWYWx1ZSA9PSAnaGVscC10ZXh0LXZhbHVlLW51bGwnKXsvL+aXp+aVsOaNruWFvOWuuVxyXG4gICAgICAgICAgICB0aGlzLnRleHRWYWx1ZSA9IGNvbWJvTG9va1VwVmFsdWUuZ2V0VGV4dFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSBjb21ib0xvb2tVcFZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjb21ib0xvb2tVcFZhbHVlICYmIGNvbWJvTG9va1VwVmFsdWUudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IChjb21ib0xvb2tVcFZhbHVlLnZhbHVlIHx8IFtdKS5tYXAobiA9PiBuW3RoaXMuaWRGaWVsZF0pLmpvaW4oJywnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJEYXRhKGRhdGE6IGFueSl7XHJcbiAgICAgICAgKHRoaXMuaXRlbS52YWx1ZSBhcyBDb21ib0xvb2tVcFZhbHVlKS5jbGVhclZhbHVlKCk7XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDpRdWVyeUNvbmRpdGlvbil7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgICB9XHJcbn0iXX0=