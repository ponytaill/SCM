/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { cloneDeep } from 'lodash-es';
/*
* @Author: 疯狂秀才(lucas huang)
* @Date: 2018-10-27 10:55:02
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-10-16 14:14:14
* @Company: Inspur
* @Version: v0.0.1
*/
import { Component, Input, ViewChild, Output, EventEmitter, TemplateRef, ContentChildren, QueryList, Injector, ChangeDetectorRef, ElementRef, Renderer2 } from '@angular/core';
import { MessagerService } from '@farris/ui-messager';
import { TreeTableComponent } from '@farris/ui-treetable';
import { CommonUtils, FarrisTemplateDirective } from '@farris/ui-common';
import { LocaleService } from '@farris/ui-locale';
var MultiSelectComponent = /** @class */ (function () {
    function MultiSelectComponent(mesagerSer, injector, cd) {
        this.mesagerSer = mesagerSer;
        this.injector = injector;
        this.cd = cd;
        this.allTreeNodes = [];
        this._ds = [];
        this.displayType = 'List';
        /**
         * 显示右侧上移下移按钮
         */
        this.enableTargetSort = true;
        this.height = 445;
        this.fit = true;
        this.noDataMoveMessage = '请选择要移动的数据。';
        /**
         * 树结构时，是否显示级联选择控制选项
         */
        this.showCascadeControl = false;
        this.leftTitle = '未选择';
        this.rightTitle = '已选择';
        this.enableSearch = true;
        /**
         * 目标数据源显示checkbox 允许多选
         */
        this.showCheckbox = false;
        this.dataChange = new EventEmitter();
        this.selected = new EventEmitter();
        this.selectedIdChange = new EventEmitter();
        this.beforeMove = new EventEmitter();
        this.afterMove = new EventEmitter();
        this.sortMove = new EventEmitter();
        // 左侧选中的数据 { [keyVal]: obj, [keyVal]: obj ... }
        this._leftCheckeds = {};
        // 右侧数据
        this._rightData = [];
        this.canCheckLength = 0;
        this.leftCount = 0;
        this._searchValue = '';
        // 级联选择控制选项
        this.enableCascase = true;
        this.updateTimer1 = null;
        this.updateTimer2 = null;
        this.trackByItems = (/**
         * @param {?} index
         * @param {?} item
         * @return {?}
         */
        function (index, item) {
            return index;
        });
        if (!Object.values) {
            Object.values = (/**
             * @param {?} obj
             * @return {?}
             */
            function (obj) {
                return Object.keys(obj).map((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    return obj[e];
                }));
            });
        }
        this.el = this.injector.get(ElementRef);
        this.render = this.injector.get(Renderer2);
        this.localeService = this.injector.get(LocaleService);
        this.commonUtils = this.injector.get(CommonUtils, null);
    }
    Object.defineProperty(MultiSelectComponent.prototype, "dataSource", {
        get: /**
         * @return {?}
         */
        function () {
            return this._ds;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            val = val || [];
            this._ds = val;
            if (!this.searchValue) {
                if (val.length) {
                    if (val[0].toJSON) {
                        this.copyDataSource = val.map((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n.toJSON(); }));
                    }
                    else {
                        this.copyDataSource = cloneDeep(val);
                    }
                }
                this.initRightData(this.selectedId);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MultiSelectComponent.prototype, "selections", {
        get: /**
         * @return {?}
         */
        function () {
            return this._rightData;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._rightData = val;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MultiSelectComponent.prototype, "searchValue", {
        get: /**
         * @return {?}
         */
        function () {
            return this._searchValue;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            var _this_1 = this;
            this._searchValue = value;
            // this.copyDataSource = [...this.dataSource];
            if (value === undefined || value === null || value === '') {
                /** @type {?} */
                var leftCheckitems_1 = tslib_1.__assign({}, this._leftCheckeds);
                if (this.displayType === 'Tree') {
                    this.tt.selections.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) {
                        leftCheckitems_1[n.id] = n.data;
                    }));
                }
                this.dataSource = this.copyDataSource;
                if (this.displayType === 'Tree') {
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        /** @type {?} */
                        var ids = Object.keys(leftCheckitems_1);
                        if (ids && ids.length) {
                            _this_1.tt.checkedNodes(ids);
                        }
                    }));
                }
                else {
                    this._leftCheckeds = tslib_1.__assign({}, leftCheckitems_1);
                }
                return;
            }
            if (this.displayType === 'Tree') {
                /** @type {?} */
                var newDataSource = this.getTreeDataBySearch(this._searchValue, this.allTreeNodes);
                this.tt.loadData(newDataSource);
            }
            else {
                this.dataSource = this.getListDataBySearch(this._searchValue, this.copyDataSource);
            }
            if (this.updateTimer1) {
                clearTimeout(this.updateTimer1);
            }
            this.updateTimer1 = setTimeout((/**
             * @return {?}
             */
            function () {
                _this_1.canCheckLength = _this_1.getCanCheckLength();
            }));
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.copyDataSource = this.dataSource ? [...this.dataSource] : [];
        this.emptyData = this.localeService.getValue('multiSelect.emptyData') || '暂无数据';
        this.initRightData(this.selectedId);
        this.moveItem();
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var elt = this.el.nativeElement;
        this.render.addClass(elt, 'row');
        this.render.addClass(elt, 'f-multi-select');
        if (this.fit === true) {
            this.render.addClass(elt, 'f-utils-fill');
            this.render.setStyle(elt, 'height', '100%');
        }
        else {
            if (!!this.height) {
                this.render.setStyle(elt, 'height', this.height + 'px');
            }
        }
        this.noDataMoveMessage =
            this.noDataMoveMessage === '请选择要移动的数据。' ? this.localeService.getValue('multiSelect.noDataMoveMessage') : this.noDataMoveMessage;
        if (this.tt && this.selectedId) {
            this.tt.checkedNodes(this.selectedId);
        }
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        this.templates.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            switch (item.getType()) {
                case 'text':
                    _this_1.displayTemplate = item.template;
                    break;
            }
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    MultiSelectComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.dataSource && !changes.dataSource.isFirstChange()) {
            // this.copyDataSource = [...(this.dataSource || [])];
            this._leftCheckeds = {};
            this._rightData = [];
        }
        if (changes.selectedId && !changes.selectedId.isFirstChange()) {
            this.initRightData(changes.selectedId.currentValue);
        }
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.getCanCheckLength = /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        /** @type {?} */
        var n = 0;
        /** @type {?} */
        var total = 0;
        if (this.isTree()) {
            this.tt.serializedValue.forEach((/**
             * @param {?} rn
             * @return {?}
             */
            function (rn) {
                if (rn.node.selectable) {
                    if (_this_1.canChecked(rn.node)) {
                        n++;
                    }
                }
            }));
            total = this.tt.serializedValue.length;
        }
        else {
            this.dataSource.forEach((/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                if (_this_1.canChecked(d)) {
                    n++;
                }
            }));
            total = this.dataSource.length;
        }
        this.leftCount = total;
        return n;
    };
    /**
     * 获取搜索的数据，List结构
     * @param value 搜索的字符
     * @param data 数据
     */
    /**
     * 获取搜索的数据，List结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getListDataBySearch = /**
     * 获取搜索的数据，List结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    function (value, data) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        value = '' + value;
        if (data instanceof Array) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var txt = '';
                /** @type {?} */
                var val = '';
                if (_this_1.textField) {
                    txt = '' + _this_1.getText(item);
                }
                if (_this_1.valueField) {
                    val = '' + _this_1.getValue(item);
                }
                if (_this_1.textField && _this_1.valueField) {
                    if (txt.indexOf(value) !== -1 || val.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
                else if (_this_1.textField && !_this_1.valueField) {
                    if (txt.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
                else if (!_this_1.textField && _this_1.valueField) {
                    if (val.indexOf(value) !== -1) {
                        result.push(item);
                    }
                }
            }));
        }
        return result;
    };
    /**
     * 获取包含value值得节点
     */
    /**
     * 获取包含value值得节点
     * @private
     * @param {?} value
     * @param {?} data
     * @param {?} newData
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeDataByRecursive = /**
     * 获取包含value值得节点
     * @private
     * @param {?} value
     * @param {?} data
     * @param {?} newData
     * @return {?}
     */
    function (value, data, newData) {
        var _this_1 = this;
        value = '' + value;
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var txt = '';
            /** @type {?} */
            var val = '';
            if (_this_1.textField) {
                txt = '' + _this_1.getText(item.data);
            }
            if (_this_1.valueField) {
                val = '' + _this_1.getValue(item.data);
            }
            if (_this_1.textField && _this_1.valueField) {
                if (txt.indexOf(value) !== -1 || val.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            else if (_this_1.textField && !_this_1.valueField) {
                if (txt.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            else if (!_this_1.textField && _this_1.valueField) {
                if (val.indexOf(value) !== -1) {
                    newData.push(item);
                }
            }
            if (item.children && item.children.length) {
                _this_1.getTreeDataByRecursive(value, item.children, newData);
            }
        }));
    };
    /**
     * 获取根节点
     */
    /**
     * 获取根节点
     * @private
     * @param {?} data
     * @param {?} rootData
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeRootNode = /**
     * 获取根节点
     * @private
     * @param {?} data
     * @param {?} rootData
     * @return {?}
     */
    function (data, rootData) {
        var _this_1 = this;
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item.parent === null) {
                rootData.push(item);
            }
            else {
                _this_1.getTreeRootNode(new Array(item.parent), rootData);
            }
        }));
    };
    /**
     * 获取搜索的数据，Tree结构
     * @param value 搜索的字符
     * @param data 数据
     */
    /**
     * 获取搜索的数据，Tree结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeDataBySearch = /**
     * 获取搜索的数据，Tree结构
     * @private
     * @param {?} value 搜索的字符
     * @param {?} data 数据
     * @return {?}
     */
    function (value, data) {
        /** @type {?} */
        var rootNodes = [];
        /** @type {?} */
        var nodes = [];
        /** @type {?} */
        var finalRes = [];
        /** @type {?} */
        var uniqueId = [];
        // 获取包含value值得节点
        this.getTreeDataByRecursive(value, data, nodes);
        // 获取根节点
        this.getTreeRootNode(nodes, rootNodes);
        // 去重
        rootNodes.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (!uniqueId.some((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item == node.id; }))) {
                finalRes.push(node);
                uniqueId.push(node.id);
            }
        }));
        return finalRes;
    };
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    MultiSelectComponent.prototype.initRightData = /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        var _this_1 = this;
        /** @type {?} */
        var dataSource = [];
        if (ids && ids.length) {
            if (this.isTree()) {
                this.convertTreeDataToPlainData(this.copyDataSource, dataSource);
                this._rightData = this.getTreeSelectionsById(ids, dataSource);
            }
            else {
                this._rightData = this.getListSelectionsById(ids, this.copyDataSource);
            }
            this._leftCheckeds = ids.reduce((/**
             * @param {?} r
             * @param {?} id
             * @return {?}
             */
            function (r, id) {
                r[id] = _this_1._rightData.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this_1.idField] == id; }));
                return r;
            }), {});
        }
        if (this.updateTimer2) {
            clearTimeout(this.updateTimer2);
        }
        this.updateTimer2 = setTimeout((/**
         * @return {?}
         */
        function () {
            _this_1.canCheckLength = _this_1.getCanCheckLength();
            if (_this_1.tt) {
                _this_1.tt.checkedNodes(ids, true, false, true);
                _this_1.allTreeNodes = cloneDeep(_this_1.tt.state.rowNodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.node; })));
            }
        }));
    };
    /**
     * @param ids 选中数据的id
     * @param dataSource 原始数据
     */
    /**
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getListSelectionsById = /**
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    function (ids, dataSource) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        /** @type {?} */
        var _this = this;
        if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {
            /** @type {?} */
            var reusltObj = dataSource.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                return item[_this.idField] === ids;
            }));
            if (reusltObj) {
                result.push(reusltObj);
            }
        }
        else if (Array.isArray(ids)) {
            if (Array.isArray(dataSource)) {
                result = ids.map((/**
                 * @param {?} id
                 * @return {?}
                 */
                function (id) { return dataSource.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this_1.idField] === id; })); })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n; }));
            }
            else {
                result = [];
            }
        }
        else {
            result = [];
        }
        return result;
    };
    /**
     *
     * @param ids 选中数据的id
     * @param dataSource 原始数据
     */
    /**
     *
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    MultiSelectComponent.prototype.getTreeSelectionsById = /**
     *
     * @private
     * @param {?} ids 选中数据的id
     * @param {?} dataSource 原始数据
     * @return {?}
     */
    function (ids, dataSource) {
        var _this_1 = this;
        /** @type {?} */
        var result = [];
        /** @type {?} */
        var _this = this;
        if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {
            /** @type {?} */
            var reusltObj = dataSource.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                return item.data[_this.idField] === ids;
            }));
            if (reusltObj && reusltObj.data) {
                result.push(reusltObj.data);
            }
        }
        else if (Array.isArray(ids)) {
            if (Array.isArray(dataSource)) {
                result = ids.map((/**
                 * @param {?} id
                 * @return {?}
                 */
                function (id) {
                    return dataSource.find((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.data[_this_1.idField] === id; }));
                })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n; })).map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.data; }));
            }
            else {
                result = [];
            }
        }
        else {
            result = [];
        }
        return result;
    };
    /**
     * 判断是否选中
     * @param data 要验证的数据
     * @param direction 验证的数据所在的位置 L: 左侧，R: 右侧
     */
    /**
     * 判断是否选中
     * @param {?} data 要验证的数据
     * @param {?} direction 验证的数据所在的位置 L: 左侧，R: 右侧
     * @return {?}
     */
    MultiSelectComponent.prototype.isChecked = /**
     * 判断是否选中
     * @param {?} data 要验证的数据
     * @param {?} direction 验证的数据所在的位置 L: 左侧，R: 右侧
     * @return {?}
     */
    function (data, direction) {
        /** @type {?} */
        var keyVal = data[this.idField];
        if (direction === 'L') {
            return (this._leftCheckeds && this._leftCheckeds[keyVal] !== undefined); // || !this.canChecked(data);
        }
        else {
            if (this._rightCheckeds) {
                return this._rightCheckeds[keyVal] !== undefined;
            }
            else {
                return false;
            }
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    MultiSelectComponent.prototype.canChecked = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        var _this_1 = this;
        /** @type {?} */
        var data = item;
        if (this.isTree()) {
            data = item.data;
            if (item.selectable !== undefined && !item.selectable) {
                return false;
            }
        }
        if (!this.selections || this.selections.length === 0) {
            return true;
        }
        return this.selections.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c[_this_1.idField] === data[_this_1.idField]; })) === -1;
    };
    /**
     * @param {?} ids
     * @return {?}
     */
    MultiSelectComponent.prototype.onCheckValueChange = /**
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
    };
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype.isTree = /**
     * @return {?}
     */
    function () {
        return this.displayType === 'Tree';
    };
    /**
     * @param {?} data
     * @return {?}
     */
    MultiSelectComponent.prototype.leftDataChecked = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this_1 = this;
        if (data && data.length) {
            data.forEach((/**
             * @param {?} node
             * @return {?}
             */
            function (node) {
                /** @type {?} */
                var d = node;
                if (_this_1.isTree()) {
                    d = node.data;
                }
                if (_this_1.canChecked(node)) {
                    if (_this_1.isChecked(d, 'L')) {
                        delete _this_1._leftCheckeds[d[_this_1.idField]];
                    }
                    else {
                        if (!_this_1._leftCheckeds) {
                            _this_1._leftCheckeds = {};
                        }
                        _this_1._leftCheckeds[d[_this_1.idField]] = d;
                    }
                }
            }));
        }
    };
    /**
     * @param {?} dir
     * @return {?}
     */
    MultiSelectComponent.prototype.hasCheckeds = /**
     * @param {?} dir
     * @return {?}
     */
    function (dir) {
        if (dir === 'L') {
            if (this.isTree()) {
                return this.tt.checkeds && this.tt.checkeds.length || (this.tt.selections && this.tt.selections.length);
            }
            if (this._leftCheckeds) {
                return Object.keys(this._leftCheckeds).length > 0;
            }
            else {
                return false;
            }
        }
        else {
            if (this._rightCheckeds) {
                return Object.keys(this._rightCheckeds).length > 0;
            }
            else {
                return false;
            }
        }
    };
    /**
     * @param {?} item
     * @param {?=} emit
     * @return {?}
     */
    MultiSelectComponent.prototype.rightDataChecked = /**
     * @param {?} item
     * @param {?=} emit
     * @return {?}
     */
    function (item, emit) {
        if (emit === void 0) { emit = true; }
        /** @type {?} */
        var isCheck = this.isChecked(item, 'R');
        if (isCheck) {
            if (this.showCheckbox) {
                delete this._rightCheckeds[item[this.idField]];
            }
            else {
                this._rightCheckeds = {};
            }
            return;
        }
        else {
            if (this.showCheckbox) {
                this._rightCheckeds = this._rightCheckeds || {};
            }
            else {
                this._rightCheckeds = {};
            }
            this._rightCheckeds[item[this.idField]] = item;
        }
        this.cd.detectChanges();
        this.selected.emit({ selected: !isCheck, data: item });
    };
    /**
     * @param {?} id
     * @param {?=} emit
     * @return {?}
     */
    MultiSelectComponent.prototype.selectItem = /**
     * @param {?} id
     * @param {?=} emit
     * @return {?}
     */
    function (id, emit) {
        var _this_1 = this;
        if (emit === void 0) { emit = true; }
        if (this.selections && this.selections.length) {
            /** @type {?} */
            var item = this.selections.find((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n[_this_1.idField] === id; }));
            if (item) {
                this.rightDataChecked(item, emit);
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.clearSelections = /**
     * @private
     * @return {?}
     */
    function () {
    };
    /**
     * 将树结构数据转换为扁平数组
     * @param nodes 树节点数组
     * @param r 新的空数组
     */
    /**
     * 将树结构数据转换为扁平数组
     * @private
     * @param {?} nodes 树节点数组
     * @param {?=} r 新的空数组
     * @return {?}
     */
    MultiSelectComponent.prototype.convertTreeDataToPlainData = /**
     * 将树结构数据转换为扁平数组
     * @private
     * @param {?} nodes 树节点数组
     * @param {?=} r 新的空数组
     * @return {?}
     */
    function (nodes, r) {
        var _this_1 = this;
        if (r === void 0) { r = []; }
        if (nodes) {
            nodes.forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                r.push(n);
                if (n.children) {
                    _this_1.convertTreeDataToPlainData(n.children, r);
                }
            }));
        }
        return r;
    };
    //#region 左右移动
    //#region 左右移动
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.moveItem = 
    //#region 左右移动
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this_1 = this;
        this.beforeMove.subscribe((/**
         * @param {?} obj
         * @return {?}
         */
        function (obj) {
            /** @type {?} */
            var items = obj.items;
            /** @type {?} */
            var ids = Object.keys(items);
            /** @type {?} */
            var direction = 1;
            switch (obj.target) {
                case 'right':
                    Object.keys(items).forEach((/**
                     * @param {?} id
                     * @return {?}
                     */
                    function (id) {
                        if (!_this_1._rightData.find((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n[_this_1.idField].toString() === id; }))) {
                            _this_1._rightData.push(items[id]);
                        }
                    }));
                    _this_1._rightData = tslib_1.__spread(_this_1._rightData);
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                    }
                    direction = 1;
                    break;
                case 'rightAll':
                    items.forEach((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) {
                        if (_this_1._rightData.findIndex((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n[_this_1.idField] === data[_this_1.idField]; })) === -1) {
                            _this_1._rightData.push(data);
                        }
                    }));
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                    }
                    direction = 1;
                    break;
                case 'left':
                    _this_1._rightData = _this_1._rightData.filter((/**
                     * @param {?} v
                     * @return {?}
                     */
                    function (v) {
                        return ids.indexOf('' + v[_this_1.idField]) === -1;
                    }));
                    _this_1._rightCheckeds = {};
                    ids.forEach((/**
                     * @param {?} id
                     * @return {?}
                     */
                    function (id) {
                        delete _this_1._leftCheckeds[id];
                    }));
                    direction = -1;
                    if (_this_1.isTree()) {
                        _this_1.tt.findRowNodes(ids).forEach((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            n.node.selectable = true;
                        }));
                        _this_1.tt.unCheckedNodes(ids, true);
                    }
                    break;
                case 'leftAll':
                    _this_1._rightCheckeds = {};
                    _this_1._rightData = [];
                    direction = -1;
                    _this_1._leftCheckeds = {};
                    if (_this_1.isTree()) {
                        _this_1.tt.clearAll();
                        _this_1.tt.findRowNodes(ids).forEach((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) {
                            n.node.selectable = true;
                        }));
                    }
                    break;
            }
            _this_1.selectionsChange();
            _this_1.changeSelectIds(direction);
            _this_1.afterMove.emit(Object.values(items));
        }));
    };
    /** 右移 */
    /**
     * 右移
     * @param {?=} moveData
     * @return {?}
     */
    MultiSelectComponent.prototype.moveToRight = /**
     * 右移
     * @param {?=} moveData
     * @return {?}
     */
    function (moveData) {
        var _this_1 = this;
        var _a;
        if (moveData) {
            this.beforeMove.emit({ items: (_a = {}, _a[moveData[this.idField]] = moveData, _a), target: 'right' });
        }
        else {
            if (this.hasCheckeds('L')) {
                if (this.isTree()) {
                    this._leftCheckeds = {};
                    if (!this.tt.checkeds.filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) { return _this_1._rightData.findIndex((/**
                     * @param {?} r
                     * @return {?}
                     */
                    function (r) { return r.id === n.id; })) === -1; })).length) {
                        this.mesagerSer.warning(this.noDataMoveMessage);
                        return;
                    }
                    this.tt.checkeds.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) {
                        _this_1._leftCheckeds[n.data[_this_1.idField]] = n.data;
                    }));
                    this.tt.selections.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) {
                        _this_1._leftCheckeds[n.id] = n.data;
                    }));
                }
                else {
                    /** @type {?} */
                    var newCheckeds = Object.keys(this._leftCheckeds).filter((/**
                     * @param {?} id
                     * @return {?}
                     */
                    function (id) {
                        return _this_1._rightData.findIndex((/**
                         * @param {?} n
                         * @return {?}
                         */
                        function (n) { return n.id === id; })) === -1;
                    }));
                    if (!newCheckeds.length) {
                        this.mesagerSer.warning(this.noDataMoveMessage);
                        return;
                    }
                }
                this.beforeMove.emit({ items: this._leftCheckeds, target: 'right' });
            }
            else {
                this.mesagerSer.warning(this.noDataMoveMessage);
            }
        }
    };
    /** 全部右移 */
    /**
     * 全部右移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveAllToRight = /**
     * 全部右移
     * @return {?}
     */
    function () {
        if (this.searchValue === '') {
            this._rightData = [];
        }
        if (this.displayType === 'List') {
            /** @type {?} */
            var items = this.dataSource;
            // if (this.searchValue && this._leftCheckeds) {
            //     const checkids = Object.keys(this._leftCheckeds);
            //     if (checkids.length) {
            //         checkids.forEach(id => {
            //             if (!items.find(n => n[this.idField] === id)) {
            //                 items.push(this._leftCheckeds[id]);
            //             }
            //         });
            //     }
            // }
            this.beforeMove.emit({ items: items, target: 'rightAll' });
        }
        else {
            if (!this.searchValue) {
                /** @type {?} */
                var _dataSource = [];
                this.convertTreeDataToPlainData(this.dataSource, _dataSource);
                _dataSource = _dataSource.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.selectable && (n.visible || n.visible === undefined); })).map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.data; }));
                this.beforeMove.emit({ items: _dataSource, target: 'rightAll' });
            }
            else {
                /** @type {?} */
                var _dataSource = this.tt.serializedValue.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.node.data; }));
                this.beforeMove.emit({ items: _dataSource, target: 'rightAll' });
            }
        }
    };
    /** 左移 */
    /**
     * 左移
     * @param {?=} moveData
     * @return {?}
     */
    MultiSelectComponent.prototype.moveToLeft = /**
     * 左移
     * @param {?=} moveData
     * @return {?}
     */
    function (moveData) {
        var _a;
        if (moveData) {
            this.beforeMove.emit({ items: (_a = {}, _a[moveData[this.idField]] = moveData, _a), target: 'left' });
        }
        else {
            if (this.hasCheckeds('R')) {
                this.beforeMove.emit({ items: this._rightCheckeds, target: 'left' });
            }
            else {
                this.mesagerSer.warning(this.noDataMoveMessage);
            }
        }
    };
    /** 全部左移 */
    /**
     * 全部左移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveAllToLeft = /**
     * 全部左移
     * @return {?}
     */
    function () {
        this.beforeMove.emit({ items: this._rightData, target: 'leftAll' });
    };
    //#endregion
    //#region 上下移动显示列顺序
    //#endregion
    //#region 上下移动显示列顺序
    /**
     * @return {?}
     */
    MultiSelectComponent.prototype._getSelectInfo = 
    //#endregion
    //#region 上下移动显示列顺序
    /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var key_1 = Object.keys(this._rightCheckeds)[0];
            /** @type {?} */
            var index = this._rightData.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return '' + c[_this_1.idField] === key_1; }));
            return {
                key: key_1, index: index
            };
        }
        return null;
    };
    /** 置顶 */
    /**
     * 置顶
     * @return {?}
     */
    MultiSelectComponent.prototype.moveTop = /**
     * 置顶
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = this._getSelectInfo();
        if (obj) {
            this._rightData.unshift(this._rightData[obj.index]);
            this._rightData.splice(obj.index + 1, 1);
            this.selectionsChange();
            this.changeSelectIds(0);
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 上移 */
    /**
     * 上移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveUp = /**
     * 上移
     * @return {?}
     */
    function () {
        var _a;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var obj = this._getSelectInfo();
            if (obj) {
                /** @type {?} */
                var index = obj.index;
                if (index !== 0) {
                    /** @type {?} */
                    var tempArr = this._rightData.splice(index, 1);
                    (_a = this._rightData).splice.apply(_a, tslib_1.__spread([index - 1, 0], tempArr));
                }
                this.selectionsChange();
                this.changeSelectIds(0);
            }
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 下移 */
    /**
     * 下移
     * @return {?}
     */
    MultiSelectComponent.prototype.moveDown = /**
     * 下移
     * @return {?}
     */
    function () {
        var _a;
        if (this.hasCheckeds('R')) {
            /** @type {?} */
            var obj = this._getSelectInfo();
            if (obj) {
                /** @type {?} */
                var len = this._rightData.length;
                /** @type {?} */
                var index = obj.index;
                if (index === 0 || index !== len - 1) {
                    /** @type {?} */
                    var tempArr = this._rightData.splice(index, 1);
                    (_a = this._rightData).splice.apply(_a, tslib_1.__spread([index + 1, 0], tempArr));
                }
                this.changeSelectIds(0);
                this.selectionsChange();
            }
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /** 置底 */
    /**
     * 置底
     * @return {?}
     */
    MultiSelectComponent.prototype.moveBottom = /**
     * 置底
     * @return {?}
     */
    function () {
        /** @type {?} */
        var obj = this._getSelectInfo();
        if (obj) {
            this._rightData.push(this._rightCheckeds[obj.key]);
            this._rightData.splice(obj.index, 1);
            this.changeSelectIds(0);
            this.selectionsChange();
        }
        else {
            this.mesagerSer.warning(this.noDataMoveMessage);
        }
    };
    /**
     * 触发选择中id
     * @param number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     */
    /**
     * 触发选择中id
     * @private
     * @param {?} number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     * @return {?}
     */
    MultiSelectComponent.prototype.changeSelectIds = /**
     * 触发选择中id
     * @private
     * @param {?} number 1代表左侧数据右移，-1,代表数据左移，0代表上移下移
     * @return {?}
     */
    function (number) {
        var _this_1 = this;
        /** @type {?} */
        var ids = this._rightData.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item[_this_1.idField];
        }));
        if (number === 0) {
            if (typeof this.selectedId === 'string') {
                this.selectedId = ids.join(',');
            }
            else if (Array.isArray(this.selectedId)) {
                this.selectedId = ids;
            }
            this.selectedIdChange.emit(this.selectedId);
            return;
        }
        if (!this.selectedId) {
            this.selectedId = [];
        }
        if (number === 1 || number === -1) {
            if (!ids.length) {
                this.selectedId = [];
            }
            else {
                this.selectedId = ids;
            }
            if (this.isTree()) {
                if (ids && ids.length) {
                    this.tt.checkedNodes(ids, true, false, true);
                }
            }
        }
        this.canCheckLength = this.getCanCheckLength();
        this.selectedIdChange.emit(this.selectedId);
    };
    //#endregion
    //#endregion
    /**
     * @private
     * @return {?}
     */
    MultiSelectComponent.prototype.selectionsChange = 
    //#endregion
    /**
     * @private
     * @return {?}
     */
    function () {
        this.dataChange.emit(this._rightData);
        this.cd.detectChanges();
    };
    /**
     * @param {?} item
     * @param {?=} textField
     * @return {?}
     */
    MultiSelectComponent.prototype.getText = /**
     * @param {?} item
     * @param {?=} textField
     * @return {?}
     */
    function (item, textField) {
        if (textField === void 0) { textField = this.textField; }
        if (item) {
            if (this.commonUtils && this.commonUtils.getValue && textField) {
                return this.commonUtils.getValue(textField, item);
            }
            else {
                return item[textField];
            }
        }
        else {
            return '';
        }
    };
    /**
     * @param {?} item
     * @param {?=} valueField
     * @return {?}
     */
    MultiSelectComponent.prototype.getValue = /**
     * @param {?} item
     * @param {?=} valueField
     * @return {?}
     */
    function (item, valueField) {
        if (valueField === void 0) { valueField = this.valueField; }
        if (item) {
            if (this.commonUtils && this.commonUtils.getValue && valueField) {
                return this.commonUtils.getValue(valueField, item);
            }
            else {
                return item[valueField];
            }
        }
        else {
            return '';
        }
    };
    MultiSelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'multi-select',
                    template: "<div class=\"f-utils-fill f-multi-select-list d-flex flex-column\">\r\n    <div class=\"f-utils-flex-column f-multi-select-list-content f-utils-fill\">\r\n        <legend class=\"f-multi-select-list-title\">\r\n            {{leftTitle === '\u672A\u9009\u62E9' ? ('multiSelect.leftTitle'|locale) : leftTitle}} ( {{ canCheckLength }} / {{ leftCount }} )\r\n            <span *ngIf=\"displayType === 'Tree' && showCascadeControl\" style=\"display: flex; align-items: center;\">\r\n                <input type=\"checkbox\" style=\"margin-right:2px\" [(ngModel)]=\"enableCascase\" id=\"fms_chkenablecascade\"><label for=\"fms_chkenablecascade\" style=\"margin:0\">\u7EA7\u8054\u9009\u62E9</label>\r\n            </span>\r\n            <ng-content select=\".left-title\"></ng-content>\r\n        </legend>\r\n        <div class=\"input-group\" *ngIf=\"enableSearch\" style=\"margin: 5px; width: auto\">\r\n            <input type=\"text\" class=\"form-control\" [(ngModel)]=\"searchValue\" placeholder=\"{{ 'multiSelect.filterPlaceholder' | locale }}\" />\r\n            <div class=\"input-group-append\" style=\"background: transparent;display: flex;align-items: center;padding: 0 5px;\">\r\n                <span class=\"f-icon f-icon-search\" *ngIf=\"!searchValue\" ></span>\r\n                <span class=\"f-icon f-icon-close\" style=\"cursor: pointer;\" *ngIf=\"searchValue\" (click)=\"searchValue = '';\"></span>\r\n            </div>\r\n        </div>\r\n        <div class=\"container columns-box f-utils-fill\" [class.pl-2]=\"displayType !== 'List'\">\r\n            <perfect-scrollbar [config]=\"{}\">\r\n                <ng-container *ngIf=\"displayType === 'List'; else tree\">\r\n                    <ul class=\"f-multi-select-list-group multi-select-list-group-flush f-multi-select-list-group--left\" [class.f-multi-select-norecords]=\"!dataSource || !dataSource.length\">\r\n                        <ng-template [ngIf]=\"dataSource && dataSource.length\">\r\n                            <li class=\"f-multi-select-list-group-item\" *ngFor=\"let data of dataSource;trackBy: trackByItems\" [ngClass]=\"{'f-state-disabled':!canChecked(data),'active':isChecked(data, 'L')}\">\r\n                                <div class=\"custom-control custom-checkbox  custom-control-inline\"\r\n                                    (click)=\"leftDataChecked([data])\">\r\n                                    <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"isChecked(data, 'L')\"\r\n                                        [disabled]=\"!canChecked(data)\">\r\n                                    <label class=\"custom-control-label\">\r\n                                        <display-text [template]=\"displayTemplate\" [data]=\"data\"></display-text>\r\n                                    </label>\r\n                                </div>\r\n                            </li>\r\n                        </ng-template>\r\n                        <ng-template [ngIf]=\"!dataSource || !dataSource.length\">\r\n                            <li class=\"f-multi-select-norecords-content\"> {{emptyData}} </li>\r\n                        </ng-template>\r\n                    </ul>\r\n                </ng-container>\r\n\r\n                <ng-template #tree>\r\n                    <farris-treetable #tt [data]=\"dataSource\" [idField]=\"idField\" [striped]=\"false\" [cascadeCheck]=\"enableCascase\" [cascadeDown]=\"enableCascase\" [cascadeUp]=\"enableCascase\"\r\n                        [singleSelect]=\"false\" [showIcon]=\"false\" [showFilterBar]=\"false\" [showCheckbox]=\"true\"\r\n                        [selectOnCheck]=\"true\" [checkOnSelect]=\"true\" [showBorder]=\"false\" (checkValuesChange)=\"onCheckValueChange($event)\">\r\n                        <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\">\r\n                            <tr #row=\"row\" [selectRow]=\"rowNode\" [dblclick]=\"true\"\r\n                                [selectRowDisabled]=\"!canChecked(treeNode)\">\r\n                                <td style=\"border: 0; line-height: 26px;padding: 0px\" [style.color]=\"row.selectRowDisabled? '#a6a6a6': '#333'\">\r\n                                    <farris-treeTableToggler [disabled]=\"!canChecked(treeNode)\" [rowNode]=\"rowNode\">\r\n                                    </farris-treeTableToggler>\r\n                                    <display-text [template]=\"displayTemplate\" [data]=\"rowData\"></display-text>\r\n                                </td>\r\n                            </tr>\r\n                        </ng-template>\r\n                    </farris-treetable>\r\n                </ng-template>\r\n            </perfect-scrollbar>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"f-multi-select-list-btns\" [class.col-2]=\"!enableTargetSort\">\r\n    <button [title]=\"'multiSelect.shiftRight' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveToRight()\">\r\n        <span class=\"f-icon f-icon-arrow-chevron-right\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.allShiftRight' | locale\" class=\"btn btn-secondary f-btn-icon right-all\" type=\"button\"\r\n        (click)=\"moveAllToRight()\">\r\n        <span class=\"f-icon f-icon-arrow-seek-right\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftLeft' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveToLeft()\">\r\n        <span class=\"f-icon f-icon-arrow-chevron-left\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.allShiftLeft' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveAllToLeft()\">\r\n        <span class=\"f-icon f-icon-arrow-seek-left\"></span>\r\n    </button>\r\n</div>\r\n<div class=\"f-utils-fill f-multi-select-list d-flex flex-column\">\r\n    <div class=\"f-utils-flex-column f-multi-select-list-content f-utils-fill\">\r\n        <legend class=\"f-multi-select-list-title\">\r\n            {{rightTitle === '\u5DF2\u9009\u62E9' ? ('multiSelect.rightTitle'|locale) : rightTitle}} ({{selections && selections.length}})\r\n\r\n            <ng-content select=\".right-title\"></ng-content>\r\n        </legend>\r\n        <div class=\"container columns-box f-utils-fill\">\r\n            <perfect-scrollbar [config]=\"{}\">\r\n                <ul class=\"f-multi-select-list-group multi-select-list-group-flush f-multi-select-list-group--right\">\r\n                    <li class=\"f-multi-select-list-group-item\" *ngFor=\"let data of selections;trackBy: trackByItems\"\r\n                        (click)=\"rightDataChecked(data)\"  [ngClass]=\"{'active':isChecked(data, 'R'),'item--show-checkbox':showCheckbox && data['showCheckbox'] !== false}\">\r\n                        <ng-container *ngIf=\"showCheckbox && data['showCheckbox'] !== false\">\r\n                            <div class=\"custom-control custom-checkbox f-checkradio-single\">\r\n                               <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"isChecked(data, 'R')\">\r\n                               <label class=\"custom-control-label\"></label>\r\n                            </div>\r\n                            <display-text [template]=\"displayTemplate\" [data]=\"data\" [side]=\"'R'\"></display-text>\r\n                        </ng-container>\r\n                        <ng-container *ngIf=\"!showCheckbox\">\r\n                            <display-text [template]=\"displayTemplate\" [data]=\"data\" [side]=\"'R'\"></display-text>\r\n                        </ng-container>\r\n                    </li>\r\n                </ul>\r\n            </perfect-scrollbar>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"f-multi-select-list-btns\" *ngIf=\"enableTargetSort\">\r\n    <button [title]=\"'multiSelect.top' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\" (click)=\"moveTop()\">\r\n        <span class=\"f-icon f-icon-roofing\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftUp' | locale\" class=\"btn btn-secondary f-btn-icon right-all\" type=\"button\"\r\n        (click)=\"moveUp()\">\r\n        <span class=\"f-icon f-icon-arrow-double-60-up\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.shiftDown' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveDown()\">\r\n        <span class=\"f-icon f-icon-arrow-double-60-down\"></span>\r\n    </button>\r\n    <button [title]=\"'multiSelect.bottom' | locale\" class=\"btn btn-secondary f-btn-icon\" type=\"button\"\r\n        (click)=\"moveBottom()\">\r\n        <span class=\"f-icon f-icon-bottomsetting\"></span>\r\n    </button>\r\n</div>",
                    styles: [".f-multi-select-list .search{position:relative}.f-multi-select-list .search .form-control{line-height:1.875;height:1.875;outline:0}.f-multi-select-list .f-table-norecords-content{margin:-10.0625rem 0 0 -.225rem}"]
                }] }
    ];
    /** @nocollapse */
    MultiSelectComponent.ctorParameters = function () { return [
        { type: MessagerService },
        { type: Injector },
        { type: ChangeDetectorRef }
    ]; };
    MultiSelectComponent.propDecorators = {
        dataSource: [{ type: Input }],
        displayType: [{ type: Input }],
        enableTargetSort: [{ type: Input }],
        idField: [{ type: Input }],
        textField: [{ type: Input }],
        valueField: [{ type: Input }],
        height: [{ type: Input }],
        fit: [{ type: Input }],
        noDataMoveMessage: [{ type: Input }],
        showCascadeControl: [{ type: Input }],
        leftTitle: [{ type: Input }],
        rightTitle: [{ type: Input }],
        selectedId: [{ type: Input }],
        enableSearch: [{ type: Input }],
        showCheckbox: [{ type: Input }],
        dataChange: [{ type: Output }],
        selected: [{ type: Output }],
        selectedIdChange: [{ type: Output }],
        beforeMove: [{ type: Output }],
        afterMove: [{ type: Output }],
        sortMove: [{ type: Output }],
        templates: [{ type: ContentChildren, args: [FarrisTemplateDirective,] }],
        tt: [{ type: ViewChild, args: ['tt',] }]
    };
    return MultiSelectComponent;
}());
export { MultiSelectComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.allTreeNodes;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype._ds;
    /** @type {?} */
    MultiSelectComponent.prototype.displayType;
    /**
     * 显示右侧上移下移按钮
     * @type {?}
     */
    MultiSelectComponent.prototype.enableTargetSort;
    /** @type {?} */
    MultiSelectComponent.prototype.idField;
    /** @type {?} */
    MultiSelectComponent.prototype.textField;
    /** @type {?} */
    MultiSelectComponent.prototype.valueField;
    /** @type {?} */
    MultiSelectComponent.prototype.height;
    /** @type {?} */
    MultiSelectComponent.prototype.fit;
    /** @type {?} */
    MultiSelectComponent.prototype.noDataMoveMessage;
    /**
     * 树结构时，是否显示级联选择控制选项
     * @type {?}
     */
    MultiSelectComponent.prototype.showCascadeControl;
    /** @type {?} */
    MultiSelectComponent.prototype.leftTitle;
    /** @type {?} */
    MultiSelectComponent.prototype.rightTitle;
    /** @type {?} */
    MultiSelectComponent.prototype.selectedId;
    /** @type {?} */
    MultiSelectComponent.prototype.enableSearch;
    /**
     * 目标数据源显示checkbox 允许多选
     * @type {?}
     */
    MultiSelectComponent.prototype.showCheckbox;
    /** @type {?} */
    MultiSelectComponent.prototype.dataChange;
    /** @type {?} */
    MultiSelectComponent.prototype.selected;
    /** @type {?} */
    MultiSelectComponent.prototype.selectedIdChange;
    /** @type {?} */
    MultiSelectComponent.prototype.beforeMove;
    /** @type {?} */
    MultiSelectComponent.prototype.afterMove;
    /** @type {?} */
    MultiSelectComponent.prototype.sortMove;
    /** @type {?} */
    MultiSelectComponent.prototype.templates;
    /** @type {?} */
    MultiSelectComponent.prototype.tt;
    /** @type {?} */
    MultiSelectComponent.prototype._rightCheckeds;
    /** @type {?} */
    MultiSelectComponent.prototype._leftCheckeds;
    /** @type {?} */
    MultiSelectComponent.prototype._rightData;
    /** @type {?} */
    MultiSelectComponent.prototype.canCheckLength;
    /** @type {?} */
    MultiSelectComponent.prototype.leftCount;
    /** @type {?} */
    MultiSelectComponent.prototype._searchValue;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.copyDataSource;
    /** @type {?} */
    MultiSelectComponent.prototype.treeDataLength;
    /** @type {?} */
    MultiSelectComponent.prototype.displayTemplate;
    /** @type {?} */
    MultiSelectComponent.prototype.emptyData;
    /** @type {?} */
    MultiSelectComponent.prototype.el;
    /** @type {?} */
    MultiSelectComponent.prototype.render;
    /** @type {?} */
    MultiSelectComponent.prototype.localeService;
    /** @type {?} */
    MultiSelectComponent.prototype.commonUtils;
    /** @type {?} */
    MultiSelectComponent.prototype.enableCascase;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.updateTimer1;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.updateTimer2;
    /** @type {?} */
    MultiSelectComponent.prototype.trackByItems;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.mesagerSer;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    MultiSelectComponent.prototype.cd;
}
var DisplayTextComponent = /** @class */ (function () {
    function DisplayTextComponent(ms) {
        this.ms = ms;
        this.side = 'L';
    }
    /**
     * @return {?}
     */
    DisplayTextComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // console.log(this.data);
    };
    /**
     * @param {?} item
     * @return {?}
     */
    DisplayTextComponent.prototype._getText = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        return this.ms.getText(item);
    };
    DisplayTextComponent.decorators = [
        { type: Component, args: [{
                    selector: 'display-text',
                    template: "\n        <ng-container *ngIf=\"template\" >\n            <ng-container\n                *ngTemplateOutlet=\"template; context: {$implicit: data,instance: ms, side: side, selected: ms.isChecked(data, 'R') }\">\n            </ng-container>\n        </ng-container>\n        <ng-container *ngIf=\"!template\">\n            {{ _getText(data) }}\n        </ng-container>\n    "
                }] }
    ];
    /** @nocollapse */
    DisplayTextComponent.ctorParameters = function () { return [
        { type: MultiSelectComponent }
    ]; };
    DisplayTextComponent.propDecorators = {
        template: [{ type: Input }],
        data: [{ type: Input }],
        side: [{ type: Input }]
    };
    return DisplayTextComponent;
}());
export { DisplayTextComponent };
if (false) {
    /** @type {?} */
    DisplayTextComponent.prototype.template;
    /** @type {?} */
    DisplayTextComponent.prototype.data;
    /** @type {?} */
    DisplayTextComponent.prototype.side;
    /** @type {?} */
    DisplayTextComponent.prototype.ms;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktc2VsZWN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbXVsdGktc2VsZWN0LyIsInNvdXJjZXMiOlsibGliL211bHRpLXNlbGVjdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDOzs7Ozs7Ozs7QUFVdEMsT0FBTyxFQUNILFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQ3pELFdBQVcsRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUNiLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUMvRSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGtCQUFrQixFQUFZLE1BQU0sc0JBQXNCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFdBQVcsRUFBRSx1QkFBdUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRDtJQW9KSSw4QkFBb0IsVUFBMkIsRUFBVSxRQUFrQixFQUFVLEVBQXFCO1FBQXRGLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBMUlsRyxpQkFBWSxHQUFHLEVBQUUsQ0FBQztRQUNsQixRQUFHLEdBQVEsRUFBRSxDQUFDO1FBbUJiLGdCQUFXLEdBQW9CLE1BQU0sQ0FBQzs7OztRQUV0QyxxQkFBZ0IsR0FBRyxJQUFJLENBQUM7UUFPeEIsV0FBTSxHQUFHLEdBQUcsQ0FBQztRQUNiLFFBQUcsR0FBRyxJQUFJLENBQUM7UUFDWCxzQkFBaUIsR0FBRyxZQUFZLENBQUM7Ozs7UUFFakMsdUJBQWtCLEdBQUcsS0FBSyxDQUFD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OztJQWp1QlcsMENBQW1DOzs7OztJQUFFLHdDQUEwQjs7Ozs7SUFBRSxrQ0FBNkI7O0FBc3VCOUc7SUFrQkksOEJBQW1CLEVBQXdCO1FBQXhCLE9BQUUsR0FBRixFQUFFLENBQXNCO1FBRmxDLFNBQUksR0FBRyxHQUFHLENBQUM7SUFFMkIsQ0FBQzs7OztJQUVoRCx1Q0FBUTs7O0lBQVI7UUFDSSwwQkFBMEI7SUFDOUIsQ0FBQzs7Ozs7SUFFRCx1Q0FBUTs7OztJQUFSLFVBQVMsSUFBSTtRQUNULE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Z0JBMUJKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsY0FBYztvQkFDeEIsUUFBUSxFQUFFLHNYQVNUO2lCQUNKOzs7O2dCQU0wQixvQkFBb0I7OzsyQkFKMUMsS0FBSzt1QkFDTCxLQUFLO3VCQUNMLEtBQUs7O0lBV1YsMkJBQUM7Q0FBQSxBQTNCRCxJQTJCQztTQWRZLG9CQUFvQjs7O0lBQzdCLHdDQUFvQzs7SUFDcEMsb0NBQW1COztJQUNuQixvQ0FBb0I7O0lBRVIsa0NBQStCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuLypcclxuKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0obHVjYXMgaHVhbmcpXHJcbiogQERhdGU6IDIwMTgtMTAtMjcgMTA6NTU6MDJcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTAtMTYgMTQ6MTQ6MTRcclxuKiBAQ29tcGFueTogSW5zcHVyXHJcbiogQFZlcnNpb246IHYwLjAuMVxyXG4qL1xyXG5cclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBPdXRwdXQsIEV2ZW50RW1pdHRlcixcclxuICAgIFRlbXBsYXRlUmVmLCBDb250ZW50Q2hpbGRyZW4sIFF1ZXJ5TGlzdCwgQWZ0ZXJDb250ZW50SW5pdCwgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgSW5qZWN0b3IsIENoYW5nZURldGVjdG9yUmVmLCBFbGVtZW50UmVmLCBSZW5kZXJlcjJcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFRyZWVUYWJsZUNvbXBvbmVudCwgVHJlZU5vZGUgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzLCBGYXJyaXNUZW1wbGF0ZURpcmVjdGl2ZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdtdWx0aS1zZWxlY3QnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL211bHRpLXNlbGVjdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFtcclxuICAgICAgICAnLi9tdWx0aS1zZWxlY3QuY3NzJ1xyXG4gICAgXVxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIE11bHRpU2VsZWN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQsIEFmdGVyQ29udGVudEluaXQge1xyXG5cclxuICAgIHByaXZhdGUgYWxsVHJlZU5vZGVzID0gW107XHJcbiAgICBwcml2YXRlIF9kczogYW55ID0gW107XHJcbiAgICBnZXQgZGF0YVNvdXJjZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZHM7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBzZXQgZGF0YVNvdXJjZSh2YWw6IGFueSkge1xyXG4gICAgICAgIHZhbCA9IHZhbCAgfHwgW107XHJcbiAgICAgICAgdGhpcy5fZHMgPSB2YWw7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlYXJjaFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWwubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsWzBdLnRvSlNPTikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29weURhdGFTb3VyY2UgPSB2YWwubWFwKG4gPT4gbi50b0pTT04oKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29weURhdGFTb3VyY2UgPSBjbG9uZURlZXAodmFsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmluaXRSaWdodERhdGEodGhpcy5zZWxlY3RlZElkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgZGlzcGxheVR5cGU6ICdMaXN0JyB8ICdUcmVlJyA9ICdMaXN0JztcclxuICAgIC8qKiDmmL7npLrlj7PkvqfkuIrnp7vkuIvnp7vmjInpkq4gKi9cclxuICAgIEBJbnB1dCgpIGVuYWJsZVRhcmdldFNvcnQgPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpIGlkRmllbGQ6IHN0cmluZztcclxuXHJcbiAgICBASW5wdXQoKSB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIHZhbHVlRmllbGQ6IHN0cmluZztcclxuXHJcbiAgICBASW5wdXQoKSBoZWlnaHQgPSA0NDU7XHJcbiAgICBASW5wdXQoKSBmaXQgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgbm9EYXRhTW92ZU1lc3NhZ2UgPSAn6K+36YCJ5oup6KaB56e75Yqo55qE5pWw5o2u44CCJztcclxuICAgIC8qKiDmoJHnu5PmnoTml7bvvIzmmK/lkKbmmL7npLrnuqfogZTpgInmi6nmjqfliLbpgInpobkgKi9cclxuICAgIEBJbnB1dCgpIHNob3dDYXNjYWRlQ29udHJvbCA9IGZhbHNlO1xyXG5cclxuICAgIEBJbnB1dCgpIGxlZnRUaXRsZSA9ICfmnKrpgInmi6knO1xyXG4gICAgQElucHV0KCkgcmlnaHRUaXRsZSA9ICflt7LpgInmi6knO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRJZDogYW55O1xyXG4gICAgQElucHV0KCkgZW5hYmxlU2VhcmNoID0gdHJ1ZTtcclxuICAgIC8qKiDnm67moIfmlbDmja7mupDmmL7npLpjaGVja2JveCDlhYHorrjlpJrpgIkgKi9cclxuICAgIEBJbnB1dCgpIHNob3dDaGVja2JveCA9IGZhbHNlO1xyXG4gICBcclxuXHJcbiAgICBAT3V0cHV0KCkgZGF0YUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZElkQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBPdXRwdXQoKSBiZWZvcmVNb3ZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGFmdGVyTW92ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCkgc29ydE1vdmUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQENvbnRlbnRDaGlsZHJlbihGYXJyaXNUZW1wbGF0ZURpcmVjdGl2ZSkgdGVtcGxhdGVzOiBRdWVyeUxpc3Q8RmFycmlzVGVtcGxhdGVEaXJlY3RpdmU+O1xyXG4gICAgQFZpZXdDaGlsZCgndHQnKSB0dDogVHJlZVRhYmxlQ29tcG9uZW50O1xyXG5cclxuXHJcbiAgICAvLyDlj7PkvqfpgInkuK3nmoTmlbDmja4geyBba2V5VmFsXTogb2JqLCBba2V5VmFsXTogb2JqIC4uLiB9XHJcbiAgICBfcmlnaHRDaGVja2VkczogYW55O1xyXG4gICAgLy8g5bem5L6n6YCJ5Lit55qE5pWw5o2uIHsgW2tleVZhbF06IG9iaiwgW2tleVZhbF06IG9iaiAuLi4gfVxyXG4gICAgX2xlZnRDaGVja2VkczogYW55ID0ge307XHJcblxyXG4gICAgLy8g5Y+z5L6n5pWw5o2uXHJcbiAgICBfcmlnaHREYXRhID0gW107XHJcbiAgICBnZXQgc2VsZWN0aW9ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmlnaHREYXRhO1xyXG4gICAgfVxyXG4gICAgc2V0IHNlbGVjdGlvbnModmFsOiBhbnkpIHtcclxuICAgICAgICB0aGlzLl9yaWdodERhdGEgPSB2YWw7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcbiAgICBnZXQgc2VhcmNoVmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlYXJjaFZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2V0IHNlYXJjaFZhbHVlKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLl9zZWFyY2hWYWx1ZSA9IHZhbHVlO1xyXG5cclxuICAgICAgICAvLyB0aGlzLmNvcHlEYXRhU291cmNlID0gWy4uLnRoaXMuZGF0YVNvdXJjZV07XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSAnJykge1xyXG4gICAgICAgICAgICBsZXQgbGVmdENoZWNraXRlbXMgPSB7Li4udGhpcy5fbGVmdENoZWNrZWRzfTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAnVHJlZScpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHQuc2VsZWN0aW9ucy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRDaGVja2l0ZW1zW24uaWRdID0gbi5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlID0gdGhpcy5jb3B5RGF0YVNvdXJjZTtcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ1RyZWUnKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpZHMgPSBPYmplY3Qua2V5cyhsZWZ0Q2hlY2tpdGVtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHQuY2hlY2tlZE5vZGVzKGlkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzID0gey4uLmxlZnRDaGVja2l0ZW1zfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ1RyZWUnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0RhdGFTb3VyY2UgPSB0aGlzLmdldFRyZWVEYXRhQnlTZWFyY2godGhpcy5fc2VhcmNoVmFsdWUsIHRoaXMuYWxsVHJlZU5vZGVzKTtcclxuICAgICAgICAgICAgdGhpcy50dC5sb2FkRGF0YShuZXdEYXRhU291cmNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UgPSB0aGlzLmdldExpc3REYXRhQnlTZWFyY2godGhpcy5fc2VhcmNoVmFsdWUsIHRoaXMuY29weURhdGFTb3VyY2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlVGltZXIxKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnVwZGF0ZVRpbWVyMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudXBkYXRlVGltZXIxID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FuQ2hlY2tMZW5ndGggPSB0aGlzLmdldENhbkNoZWNrTGVuZ3RoKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FuQ2hlY2tMZW5ndGggPSAwO1xyXG4gICAgbGVmdENvdW50ID0gMDtcclxuICAgIF9zZWFyY2hWYWx1ZSA9ICcnO1xyXG4gICAgLy8g5aSN5Yi25LiA5Lu95pWw5o2u5rqQXHJcbiAgICBwcml2YXRlIGNvcHlEYXRhU291cmNlOiBhbnk7XHJcbiAgICAvLyDmoJHlvaLnu5PmnoTnmoTmlbDmja5sZW5ndGhcclxuICAgIHRyZWVEYXRhTGVuZ3RoOiBudW1iZXI7XHJcbiAgICBkaXNwbGF5VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG5cclxuICAgIGVtcHR5RGF0YTtcclxuICAgIGVsOiBFbGVtZW50UmVmO1xyXG4gICAgcmVuZGVyOiBSZW5kZXJlcjI7XHJcbiAgICBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlO1xyXG4gICAgY29tbW9uVXRpbHM6IENvbW1vblV0aWxzO1xyXG4gICAgLy8g57qn6IGU6YCJ5oup5o6n5Yi26YCJ6aG5XHJcbiAgICBlbmFibGVDYXNjYXNlID0gdHJ1ZTtcclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVRpbWVyMSA9IG51bGw7XHJcbiAgICBwcml2YXRlIHVwZGF0ZVRpbWVyMiA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBtZXNhZ2VyU2VyOiBNZXNzYWdlclNlcnZpY2UsIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikge1xyXG4gICAgICAgIGlmICghT2JqZWN0LnZhbHVlcykge1xyXG4gICAgICAgICAgICBPYmplY3QudmFsdWVzID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubWFwKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialtlXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVsID0gdGhpcy5pbmplY3Rvci5nZXQ8RWxlbWVudFJlZj4oRWxlbWVudFJlZik7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIgPSB0aGlzLmluamVjdG9yLmdldChSZW5kZXJlcjIpO1xyXG4gICAgICAgIHRoaXMubG9jYWxlU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbW1vblV0aWxzID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tbW9uVXRpbHMsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIC8vIHRoaXMuY29weURhdGFTb3VyY2UgPSB0aGlzLmRhdGFTb3VyY2UgPyBbLi4udGhpcy5kYXRhU291cmNlXSA6IFtdO1xyXG4gICAgICAgIHRoaXMuZW1wdHlEYXRhID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdtdWx0aVNlbGVjdC5lbXB0eURhdGEnKSB8fCAn5pqC5peg5pWw5o2uJztcclxuICAgICAgICB0aGlzLmluaXRSaWdodERhdGEodGhpcy5zZWxlY3RlZElkKTtcclxuICAgICAgICB0aGlzLm1vdmVJdGVtKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIGNvbnN0IGVsdCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhlbHQsICdyb3cnKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhlbHQsICdmLW11bHRpLXNlbGVjdCcpO1xyXG4gICAgICAgIGlmICh0aGlzLmZpdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhlbHQsICdmLXV0aWxzLWZpbGwnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUoZWx0LCAnaGVpZ2h0JywgJzEwMCUnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoISF0aGlzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUoZWx0LCAnaGVpZ2h0JywgdGhpcy5oZWlnaHQgKyAncHgnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSA9XHJcbiAgICAgICAgICAgIHRoaXMubm9EYXRhTW92ZU1lc3NhZ2UgPT09ICfor7fpgInmi6nopoHnp7vliqjnmoTmlbDmja7jgIInID8gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdtdWx0aVNlbGVjdC5ub0RhdGFNb3ZlTWVzc2FnZScpIDogdGhpcy5ub0RhdGFNb3ZlTWVzc2FnZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudHQgJiYgdGhpcy5zZWxlY3RlZElkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHQuY2hlY2tlZE5vZGVzKHRoaXMuc2VsZWN0ZWRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoaXRlbS5nZXRUeXBlKCkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVRlbXBsYXRlID0gaXRlbS50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy5kYXRhU291cmNlICYmICFjaGFuZ2VzLmRhdGFTb3VyY2UuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY29weURhdGFTb3VyY2UgPSBbLi4uKHRoaXMuZGF0YVNvdXJjZSB8fCBbXSldO1xyXG4gICAgICAgICAgICB0aGlzLl9sZWZ0Q2hlY2tlZHMgPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhID0gW107XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zZWxlY3RlZElkICYmICFjaGFuZ2VzLnNlbGVjdGVkSWQuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdFJpZ2h0RGF0YShjaGFuZ2VzLnNlbGVjdGVkSWQuY3VycmVudFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FuQ2hlY2tMZW5ndGgoKSB7XHJcbiAgICAgICAgbGV0IG4gPSAwO1xyXG4gICAgICAgIGxldCB0b3RhbCA9IDA7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy50dC5zZXJpYWxpemVkVmFsdWUuZm9yRWFjaChybiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocm4ubm9kZS5zZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuQ2hlY2tlZChybi5ub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuKys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdG90YWwgPSB0aGlzLnR0LnNlcmlhbGl6ZWRWYWx1ZS5sZW5ndGg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlLmZvckVhY2goZCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW5DaGVja2VkKGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbisrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdG90YWwgPSB0aGlzLmRhdGFTb3VyY2UubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxlZnRDb3VudCA9IHRvdGFsO1xyXG4gICAgICAgIHJldHVybiBuO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5pCc57Si55qE5pWw5o2u77yMTGlzdOe7k+aehFxyXG4gICAgICogQHBhcmFtIHZhbHVlIOaQnOe0oueahOWtl+esplxyXG4gICAgICogQHBhcmFtIGRhdGEg5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0TGlzdERhdGFCeVNlYXJjaCh2YWx1ZTogc3RyaW5nLCBkYXRhOiBhbnlbXSk6IGFueVtdIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgICAgICB2YWx1ZSA9ICcnICsgdmFsdWU7XHJcbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHR4dCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgbGV0IHZhbCA9ICcnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHR4dCA9ICcnICsgdGhpcy5nZXRUZXh0KGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSAnJyArIHRoaXMuZ2V0VmFsdWUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dEZpZWxkICYmIHRoaXMudmFsdWVGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eHQuaW5kZXhPZih2YWx1ZSkgIT09IC0xIHx8IHZhbC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRleHRGaWVsZCAmJiAhdGhpcy52YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR4dC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy50ZXh0RmllbGQgJiYgdGhpcy52YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbC5pbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWMheWQq3ZhbHVl5YC85b6X6IqC54K5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0VHJlZURhdGFCeVJlY3Vyc2l2ZSh2YWx1ZTogc3RyaW5nLCBkYXRhOiBhbnlbXSwgbmV3RGF0YTogYW55W10pIHtcclxuICAgICAgICB2YWx1ZSA9ICcnICsgdmFsdWU7XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG5cclxuICAgICAgICAgICAgbGV0IHR4dCA9ICcnO1xyXG4gICAgICAgICAgICBsZXQgdmFsID0gJyc7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0RmllbGQpIHtcclxuICAgICAgICAgICAgICAgIHR4dCA9ICcnICsgdGhpcy5nZXRUZXh0KGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhbCA9ICcnICsgdGhpcy5nZXRWYWx1ZShpdGVtLmRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0RmllbGQgJiYgdGhpcy52YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHh0LmluZGV4T2YodmFsdWUpICE9PSAtMSB8fCB2YWwuaW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGV4dEZpZWxkICYmICF0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eHQuaW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnRleHRGaWVsZCAmJiB0aGlzLnZhbHVlRmllbGQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwuaW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyZWVEYXRhQnlSZWN1cnNpdmUodmFsdWUsIGl0ZW0uY2hpbGRyZW4sIG5ld0RhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluagueiKgueCuVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFRyZWVSb290Tm9kZShkYXRhOiBhbnlbXSwgcm9vdERhdGE6IGFueVtdKSB7XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5wYXJlbnQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJvb3REYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyZWVSb290Tm9kZShuZXcgQXJyYXkoaXRlbS5wYXJlbnQpLCByb290RGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaQnOe0oueahOaVsOaNru+8jFRyZWXnu5PmnoRcclxuICAgICAqIEBwYXJhbSB2YWx1ZSDmkJzntKLnmoTlrZfnrKZcclxuICAgICAqIEBwYXJhbSBkYXRhIOaVsOaNrlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFRyZWVEYXRhQnlTZWFyY2godmFsdWU6IHN0cmluZywgZGF0YTogYW55W10pOiBhbnlbXSB7XHJcbiAgICAgICAgY29uc3Qgcm9vdE5vZGVzID0gW107XHJcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBbXTtcclxuICAgICAgICBjb25zdCBmaW5hbFJlcyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZUlkID0gW107XHJcbiAgICAgICAgLy8g6I635Y+W5YyF5ZCrdmFsdWXlgLzlvpfoioLngrlcclxuICAgICAgICB0aGlzLmdldFRyZWVEYXRhQnlSZWN1cnNpdmUodmFsdWUsIGRhdGEsIG5vZGVzKTtcclxuICAgICAgICAvLyDojrflj5bmoLnoioLngrlcclxuICAgICAgICB0aGlzLmdldFRyZWVSb290Tm9kZShub2Rlcywgcm9vdE5vZGVzKTtcclxuICAgICAgICAvLyDljrvph41cclxuICAgICAgICByb290Tm9kZXMuZm9yRWFjaChub2RlID0+IHtcclxuICAgICAgICAgICAgaWYgKCF1bmlxdWVJZC5zb21lKGl0ZW0gPT4gaXRlbSA9PSBub2RlLmlkKSkge1xyXG4gICAgICAgICAgICAgICAgZmluYWxSZXMucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIHVuaXF1ZUlkLnB1c2gobm9kZS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZmluYWxSZXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0UmlnaHREYXRhKGlkcykge1xyXG4gICAgICAgIGxldCBkYXRhU291cmNlOiBhbnkgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnRUcmVlRGF0YVRvUGxhaW5EYXRhKHRoaXMuY29weURhdGFTb3VyY2UsIGRhdGFTb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhID0gdGhpcy5nZXRUcmVlU2VsZWN0aW9uc0J5SWQoaWRzLCBkYXRhU291cmNlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IHRoaXMuZ2V0TGlzdFNlbGVjdGlvbnNCeUlkKGlkcywgdGhpcy5jb3B5RGF0YVNvdXJjZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2xlZnRDaGVja2VkcyA9IGlkcy5yZWR1Y2UoKHIsIGlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByW2lkXSA9IHRoaXMuX3JpZ2h0RGF0YS5maW5kKG4gPT4gblt0aGlzLmlkRmllbGRdID09IGlkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgICAgICB9LCB7fSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlVGltZXIyKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnVwZGF0ZVRpbWVyMik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVRpbWVyMiA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNhbkNoZWNrTGVuZ3RoID0gdGhpcy5nZXRDYW5DaGVja0xlbmd0aCgpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50dC5jaGVja2VkTm9kZXMoaWRzLCB0cnVlLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsbFRyZWVOb2RlcyA9IGNsb25lRGVlcCh0aGlzLnR0LnN0YXRlLnJvd05vZGVzLm1hcChuID0+IG4ubm9kZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gaWRzIOmAieS4reaVsOaNrueahGlkXHJcbiAgICAgKiBAcGFyYW0gZGF0YVNvdXJjZSDljp/lp4vmlbDmja5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRMaXN0U2VsZWN0aW9uc0J5SWQoaWRzOiBhbnksIGRhdGFTb3VyY2U6IGFueSkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcclxuICAgICAgICBjb25zdCBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCh0eXBlb2YgaWRzID09PSAnc3RyaW5nJyAmJiAhIWlkcykgfHwgdHlwZW9mIGlkcyA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgY29uc3QgcmV1c2x0T2JqID0gZGF0YVNvdXJjZS5maW5kKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1bX3RoaXMuaWRGaWVsZF0gPT09IGlkcztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChyZXVzbHRPYmopIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJldXNsdE9iaik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaWRzKSkge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhU291cmNlKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gaWRzLm1hcChpZCA9PiBkYXRhU291cmNlLmZpbmQoaXRlbSA9PiBpdGVtW3RoaXMuaWRGaWVsZF0gPT09IGlkKSkuZmlsdGVyKG4gPT4gbik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZHMg6YCJ5Lit5pWw5o2u55qEaWRcclxuICAgICAqIEBwYXJhbSBkYXRhU291cmNlIOWOn+Wni+aVsOaNrlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFRyZWVTZWxlY3Rpb25zQnlJZChpZHM6IGFueSwgZGF0YVNvdXJjZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGNvbnN0IF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoKHR5cGVvZiBpZHMgPT09ICdzdHJpbmcnICYmICEhaWRzKSB8fCB0eXBlb2YgaWRzID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBjb25zdCByZXVzbHRPYmogPSBkYXRhU291cmNlLmZpbmQoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kYXRhW190aGlzLmlkRmllbGRdID09PSBpZHM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAocmV1c2x0T2JqICYmIHJldXNsdE9iai5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyZXVzbHRPYmouZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaWRzKSkge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhU291cmNlKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gaWRzLm1hcChpZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2UuZmluZChpdGVtID0+IGl0ZW0uZGF0YVt0aGlzLmlkRmllbGRdID09PSBpZCk7XHJcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuKS5tYXAobiA9PiBuLmRhdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5ZCm6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDopoHpqozor4HnmoTmlbDmja5cclxuICAgICAqIEBwYXJhbSBkaXJlY3Rpb24g6aqM6K+B55qE5pWw5o2u5omA5Zyo55qE5L2N572uIEw6IOW3puS+p++8jFI6IOWPs+S+p1xyXG4gICAgICovXHJcbiAgICBpc0NoZWNrZWQoZGF0YTogYW55LCBkaXJlY3Rpb246ICdMJyB8ICdSJyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IGtleVZhbCA9IGRhdGFbdGhpcy5pZEZpZWxkXTtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnTCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9sZWZ0Q2hlY2tlZHMgJiYgdGhpcy5fbGVmdENoZWNrZWRzW2tleVZhbF0gIT09IHVuZGVmaW5lZCk7IC8vIHx8ICF0aGlzLmNhbkNoZWNrZWQoZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3JpZ2h0Q2hlY2tlZHMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yaWdodENoZWNrZWRzW2tleVZhbF0gIT09IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjYW5DaGVja2VkKGl0ZW06IGFueSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gaXRlbTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgZGF0YSA9IGl0ZW0uZGF0YTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpdGVtLnNlbGVjdGFibGUgIT09IHVuZGVmaW5lZCAmJiAhaXRlbS5zZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25zIHx8IHRoaXMuc2VsZWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnMuZmluZEluZGV4KGMgPT4gY1t0aGlzLmlkRmllbGRdID09PSBkYXRhW3RoaXMuaWRGaWVsZF0pID09PSAtMTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrVmFsdWVDaGFuZ2UoaWRzOiBzdHJpbmdbXSkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGlzVHJlZSgpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRpc3BsYXlUeXBlID09PSAnVHJlZSc7XHJcbiAgICB9XHJcblxyXG4gICAgbGVmdERhdGFDaGVja2VkKGRhdGE6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGQgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gbm9kZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuQ2hlY2tlZChub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQ2hlY2tlZChkLCAnTCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9sZWZ0Q2hlY2tlZHNbZFt0aGlzLmlkRmllbGRdXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xlZnRDaGVja2Vkcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzW2RbdGhpcy5pZEZpZWxkXV0gPSBkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhc0NoZWNrZWRzKGRpcjogJ0wnIHwgJ1InKSB7XHJcbiAgICAgICAgaWYgKGRpciA9PT0gJ0wnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50dC5jaGVja2VkcyAmJiB0aGlzLnR0LmNoZWNrZWRzLmxlbmd0aCB8fCAoIHRoaXMudHQuc2VsZWN0aW9ucyAmJiB0aGlzLnR0LnNlbGVjdGlvbnMubGVuZ3RoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xlZnRDaGVja2Vkcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX2xlZnRDaGVja2VkcykubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9yaWdodENoZWNrZWRzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fcmlnaHRDaGVja2VkcykubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByaWdodERhdGFDaGVja2VkKGl0ZW0sIGVtaXQgPSB0cnVlKSB7XHJcbiAgICAgICAgY29uc3QgaXNDaGVjayA9IHRoaXMuaXNDaGVja2VkKGl0ZW0sICdSJyk7XHJcbiAgICAgICAgaWYgKGlzQ2hlY2spIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0NoZWNrYm94KSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcmlnaHRDaGVja2Vkc1tpdGVtW3RoaXMuaWRGaWVsZF1dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHRDaGVja2VkcyA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaG93Q2hlY2tib3gpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0Q2hlY2tlZHMgPSB0aGlzLl9yaWdodENoZWNrZWRzIHx8IHt9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmlnaHRDaGVja2VkcyA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3JpZ2h0Q2hlY2tlZHNbaXRlbVt0aGlzLmlkRmllbGRdXSA9IGl0ZW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQuZW1pdCh7IHNlbGVjdGVkOiAhaXNDaGVjaywgZGF0YTogaXRlbSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RJdGVtKGlkLCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbnMgJiYgdGhpcy5zZWxlY3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zZWxlY3Rpb25zLmZpbmQobiA9PiBuW3RoaXMuaWRGaWVsZF0gPT09IGlkKTtcclxuICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHREYXRhQ2hlY2tlZChpdGVtLCBlbWl0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFyU2VsZWN0aW9ucygpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlsIbmoJHnu5PmnoTmlbDmja7ovazmjaLkuLrmiYHlubPmlbDnu4RcclxuICAgICAqIEBwYXJhbSBub2RlcyDmoJHoioLngrnmlbDnu4RcclxuICAgICAqIEBwYXJhbSByIOaWsOeahOepuuaVsOe7hFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNvbnZlcnRUcmVlRGF0YVRvUGxhaW5EYXRhKG5vZGVzOiBUcmVlTm9kZVtdLCByOiBhbnlbXSA9IFtdKSB7XHJcbiAgICAgICAgaWYgKG5vZGVzKSB7XHJcbiAgICAgICAgICAgIG5vZGVzLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICByLnB1c2gobik7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVydFRyZWVEYXRhVG9QbGFpbkRhdGEobi5jaGlsZHJlbiwgcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8jcmVnaW9uIOW3puWPs+enu+WKqFxyXG5cclxuICAgIHByaXZhdGUgbW92ZUl0ZW0oKSB7XHJcbiAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLnN1YnNjcmliZSgob2JqOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBvYmouaXRlbXM7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkcyA9IE9iamVjdC5rZXlzKGl0ZW1zKTtcclxuICAgICAgICAgICAgbGV0IGRpcmVjdGlvbiA9IDE7XHJcbiAgICAgICAgICAgIHN3aXRjaCAob2JqLnRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGl0ZW1zKS5mb3JFYWNoKGlkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9yaWdodERhdGEuZmluZChuID0+IG5bdGhpcy5pZEZpZWxkXS50b1N0cmluZygpID09PSBpZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YS5wdXNoKGl0ZW1zW2lkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodERhdGEgPSBbLi4udGhpcy5fcmlnaHREYXRhXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1RyZWUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmNsZWFyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyaWdodEFsbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JpZ2h0RGF0YS5maW5kSW5kZXgobiA9PiBuW3RoaXMuaWRGaWVsZF0gPT09IGRhdGFbdGhpcy5pZEZpZWxkXSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodERhdGEucHVzaChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVHJlZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHQuY2xlYXJBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodERhdGEgPSB0aGlzLl9yaWdodERhdGEuZmlsdGVyKHYgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWRzLmluZGV4T2YoJycgKyB2W3RoaXMuaWRGaWVsZF0pID09PSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgaWRzLmZvckVhY2goaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fbGVmdENoZWNrZWRzW2lkXTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dC5maW5kUm93Tm9kZXMoaWRzKS5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5ub2RlLnNlbGVjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dC51bkNoZWNrZWROb2RlcyhpZHMsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0QWxsJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dC5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LmZpbmRSb3dOb2RlcyhpZHMpLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLm5vZGUuc2VsZWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlU2VsZWN0SWRzKGRpcmVjdGlvbik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFmdGVyTW92ZS5lbWl0KE9iamVjdC52YWx1ZXMoaXRlbXMpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqIOWPs+enuyAqL1xyXG4gICAgbW92ZVRvUmlnaHQobW92ZURhdGE/OiBhbnkpIHtcclxuXHJcbiAgICAgICAgaWYgKG1vdmVEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlTW92ZS5lbWl0KHsgaXRlbXM6IHsgW21vdmVEYXRhW3RoaXMuaWRGaWVsZF1dOiBtb3ZlRGF0YSB9LCB0YXJnZXQ6ICdyaWdodCcgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzQ2hlY2tlZHMoJ0wnKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sZWZ0Q2hlY2tlZHMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnR0LmNoZWNrZWRzLmZpbHRlcihuID0+IHRoaXMuX3JpZ2h0RGF0YS5maW5kSW5kZXgociA9PiByLmlkID09PSBuLmlkKSA9PT0gLTEgKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50dC5jaGVja2Vkcy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9sZWZ0Q2hlY2tlZHNbbi5kYXRhW3RoaXMuaWRGaWVsZF1dID0gbi5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR0LnNlbGVjdGlvbnMuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGVmdENoZWNrZWRzW24uaWRdID0gbi5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2hlY2tlZHMgPSBPYmplY3Qua2V5cyh0aGlzLl9sZWZ0Q2hlY2tlZHMpLmZpbHRlcihpZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yaWdodERhdGEuZmluZEluZGV4KG4gPT4gbi5pZCA9PT0gaWQpID09PSAtMVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbmV3Q2hlY2tlZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzYWdlclNlci53YXJuaW5nKHRoaXMubm9EYXRhTW92ZU1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuYmVmb3JlTW92ZS5lbWl0KHsgaXRlbXM6IHRoaXMuX2xlZnRDaGVja2VkcywgdGFyZ2V0OiAncmlnaHQnIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOWFqOmDqOWPs+enuyAqL1xyXG4gICAgbW92ZUFsbFRvUmlnaHQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VhcmNoVmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xpc3QnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5kYXRhU291cmNlO1xyXG4gICAgICAgICAgICAvLyBpZiAodGhpcy5zZWFyY2hWYWx1ZSAmJiB0aGlzLl9sZWZ0Q2hlY2tlZHMpIHtcclxuICAgICAgICAgICAgLy8gICAgIGNvbnN0IGNoZWNraWRzID0gT2JqZWN0LmtleXModGhpcy5fbGVmdENoZWNrZWRzKTtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChjaGVja2lkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBjaGVja2lkcy5mb3JFYWNoKGlkID0+IHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKCFpdGVtcy5maW5kKG4gPT4gblt0aGlzLmlkRmllbGRdID09PSBpZCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2godGhpcy5fbGVmdENoZWNrZWRzW2lkXSk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICB0aGlzLmJlZm9yZU1vdmUuZW1pdCh7IGl0ZW1zICwgdGFyZ2V0OiAncmlnaHRBbGwnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWFyY2hWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IF9kYXRhU291cmNlID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnRUcmVlRGF0YVRvUGxhaW5EYXRhKHRoaXMuZGF0YVNvdXJjZSwgX2RhdGFTb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgX2RhdGFTb3VyY2UgPSBfZGF0YVNvdXJjZS5maWx0ZXIobiA9PiBuLnNlbGVjdGFibGUgJiYgKG4udmlzaWJsZSB8fCBuLnZpc2libGUgPT09IHVuZGVmaW5lZCkpLm1hcChuID0+IG4uZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogX2RhdGFTb3VyY2UsIHRhcmdldDogJ3JpZ2h0QWxsJyB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9kYXRhU291cmNlID0gdGhpcy50dC5zZXJpYWxpemVkVmFsdWUubWFwKG4gPT4gbi5ub2RlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogX2RhdGFTb3VyY2UsIHRhcmdldDogJ3JpZ2h0QWxsJyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOW3puenuyAqL1xyXG4gICAgbW92ZVRvTGVmdChtb3ZlRGF0YT86IGFueSkge1xyXG5cclxuICAgICAgICBpZiAobW92ZURhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVNb3ZlLmVtaXQoeyBpdGVtczogeyBbbW92ZURhdGFbdGhpcy5pZEZpZWxkXV06IG1vdmVEYXRhIH0sIHRhcmdldDogJ2xlZnQnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc0NoZWNrZWRzKCdSJykpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmVmb3JlTW92ZS5lbWl0KHsgaXRlbXM6IHRoaXMuX3JpZ2h0Q2hlY2tlZHMsIHRhcmdldDogJ2xlZnQnIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOWFqOmDqOW3puenuyAqL1xyXG4gICAgbW92ZUFsbFRvTGVmdCgpIHtcclxuICAgICAgICB0aGlzLmJlZm9yZU1vdmUuZW1pdCh7IGl0ZW1zOiB0aGlzLl9yaWdodERhdGEsIHRhcmdldDogJ2xlZnRBbGwnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vI3JlZ2lvbiDkuIrkuIvnp7vliqjmmL7npLrliJfpobrluo9cclxuXHJcbiAgICBfZ2V0U2VsZWN0SW5mbygpIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNDaGVja2VkcygnUicpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHRoaXMuX3JpZ2h0Q2hlY2tlZHMpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuX3JpZ2h0RGF0YS5maW5kSW5kZXgoYyA9PiAnJyArIGNbdGhpcy5pZEZpZWxkXSA9PT0ga2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGtleSwgaW5kZXhcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgLyoqIOe9rumhtiAqL1xyXG4gICAgbW92ZVRvcCgpIHtcclxuICAgICAgICBjb25zdCBvYmogPSB0aGlzLl9nZXRTZWxlY3RJbmZvKCk7XHJcbiAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodERhdGEudW5zaGlmdCh0aGlzLl9yaWdodERhdGFbb2JqLmluZGV4XSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YS5zcGxpY2Uob2JqLmluZGV4ICsgMSwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uc0NoYW5nZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVNlbGVjdElkcygwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1lc2FnZXJTZXIud2FybmluZyh0aGlzLm5vRGF0YU1vdmVNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOS4iuenuyAqL1xyXG4gICAgbW92ZVVwKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0NoZWNrZWRzKCdSJykpIHtcclxuICAgICAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5fZ2V0U2VsZWN0SW5mbygpO1xyXG4gICAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IG9iai5pbmRleDtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBBcnIgPSB0aGlzLl9yaWdodERhdGEuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yaWdodERhdGEuc3BsaWNlKGluZGV4IC0gMSwgMCwgLi4udGVtcEFycik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlU2VsZWN0SWRzKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNhZ2VyU2VyLndhcm5pbmcodGhpcy5ub0RhdGFNb3ZlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkuIvnp7sgKi9cclxuICAgIG1vdmVEb3duKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0NoZWNrZWRzKCdSJykpIHtcclxuICAgICAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5fZ2V0U2VsZWN0SW5mbygpO1xyXG4gICAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSB0aGlzLl9yaWdodERhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBvYmouaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDAgfHwgaW5kZXggIT09IGxlbiAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wQXJyID0gdGhpcy5fcmlnaHREYXRhLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmlnaHREYXRhLnNwbGljZShpbmRleCArIDEsIDAsIC4uLnRlbXBBcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VTZWxlY3RJZHMoMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzYWdlclNlci53YXJuaW5nKHRoaXMubm9EYXRhTW92ZU1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog572u5bqVICovXHJcbiAgICBtb3ZlQm90dG9tKCkge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHRoaXMuX2dldFNlbGVjdEluZm8oKTtcclxuICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JpZ2h0RGF0YS5wdXNoKHRoaXMuX3JpZ2h0Q2hlY2tlZHNbb2JqLmtleV0pO1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodERhdGEuc3BsaWNlKG9iai5pbmRleCwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlU2VsZWN0SWRzKDApO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1lc2FnZXJTZXIud2FybmluZyh0aGlzLm5vRGF0YU1vdmVNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOinpuWPkemAieaLqeS4rWlkXHJcbiAgICAgKiBAcGFyYW0gbnVtYmVyIDHku6Pooajlt6bkvqfmlbDmja7lj7Pnp7vvvIwtMSzku6PooajmlbDmja7lt6bnp7vvvIww5Luj6KGo5LiK56e75LiL56e7XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2hhbmdlU2VsZWN0SWRzKG51bWJlcjogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgaWRzID0gdGhpcy5fcmlnaHREYXRhLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGhpcy5pZEZpZWxkXTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKG51bWJlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2VsZWN0ZWRJZCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IGlkcy5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLnNlbGVjdGVkSWQpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBpZHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZElkQ2hhbmdlLmVtaXQodGhpcy5zZWxlY3RlZElkKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkSWQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZElkID0gW107XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobnVtYmVyID09PSAxIHx8IG51bWJlciA9PT0gLTEpIHtcclxuICAgICAgICAgICAgaWYgKCFpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBbXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IGlkcztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVlKCkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpZHMgJiYgaWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHQuY2hlY2tlZE5vZGVzKGlkcywgdHJ1ZSwgZmFsc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FuQ2hlY2tMZW5ndGggPSB0aGlzLmdldENhbkNoZWNrTGVuZ3RoKCk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZElkQ2hhbmdlLmVtaXQodGhpcy5zZWxlY3RlZElkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyNlbmRyZWdpb25cclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdGlvbnNDaGFuZ2UoKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhQ2hhbmdlLmVtaXQodGhpcy5fcmlnaHREYXRhKTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRUZXh0KGl0ZW0sIHRleHRGaWVsZCA9IHRoaXMudGV4dEZpZWxkKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tbW9uVXRpbHMgJiYgdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSAmJiB0ZXh0RmllbGQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbW1vblV0aWxzLmdldFZhbHVlKHRleHRGaWVsZCwgaXRlbSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVt0ZXh0RmllbGRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRWYWx1ZShpdGVtLCB2YWx1ZUZpZWxkID0gdGhpcy52YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tbW9uVXRpbHMgJiYgdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSAmJiB2YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSh2YWx1ZUZpZWxkLCBpdGVtKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtW3ZhbHVlRmllbGRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5SXRlbXMgPSAoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2Rpc3BsYXktdGV4dCcsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ0ZW1wbGF0ZVwiID5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgKm5nVGVtcGxhdGVPdXRsZXQ9XCJ0ZW1wbGF0ZTsgY29udGV4dDogeyRpbXBsaWNpdDogZGF0YSxpbnN0YW5jZTogbXMsIHNpZGU6IHNpZGUsIHNlbGVjdGVkOiBtcy5pc0NoZWNrZWQoZGF0YSwgJ1InKSB9XCI+XHJcbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhdGVtcGxhdGVcIj5cclxuICAgICAgICAgICAge3sgX2dldFRleHQoZGF0YSkgfX1cclxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgIGBcclxufSlcclxuZXhwb3J0IGNsYXNzIERpc3BsYXlUZXh0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIEBJbnB1dCgpIHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQElucHV0KCkgZGF0YTogYW55O1xyXG4gICAgQElucHV0KCkgc2lkZSA9ICdMJztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbXM6IE11bHRpU2VsZWN0Q29tcG9uZW50KSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZXh0KGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tcy5nZXRUZXh0KGl0ZW0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==