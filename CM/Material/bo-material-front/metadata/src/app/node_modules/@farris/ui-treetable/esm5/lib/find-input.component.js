/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { debounceTime, map, filter } from 'rxjs/operators';
import { Component, EventEmitter, Output, ElementRef, ViewChild, NgZone, Injector, Input } from '@angular/core';
import { fromEvent } from 'rxjs';
var FindInputComponent = /** @class */ (function () {
    function FindInputComponent(el, ngZone, injector) {
        this.el = el;
        this.ngZone = ngZone;
        this.injector = injector;
        this.current = 0;
        this.count = 0;
        this.columns = [];
        this.close = new EventEmitter();
        this.valueChanged = new EventEmitter();
        this.enterHandler = new EventEmitter();
        this.findField = '';
        this.keyupEventSub = null;
    }
    /**
     * @return {?}
     */
    FindInputComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.columns.length) {
            this.columns = this.columns.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return !c.formatter && c.field; }));
            this.findField = this.columns[0].field;
        }
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.keyupEventSub = fromEvent(_this.input.nativeElement, 'keyup').pipe(filter((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return (e.switch || e.keyCode) !== 13; })), debounceTime(200), map((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e.target.value; }))).subscribe((/**
             * @param {?} v
             * @return {?}
             */
            function (v) {
                _this.valueChanged.emit({ value: v, field: _this.findField });
            }));
        }));
    };
    /**
     * @return {?}
     */
    FindInputComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.input.nativeElement.focus();
    };
    /**
     * @return {?}
     */
    FindInputComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.keyupEventSub) {
            this.keyupEventSub.unsubscribe();
        }
        this.keyupEventSub = null;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FindInputComponent.prototype.onClose = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.close.emit();
        return false;
    };
    /**
     * @param {?} $event
     * @param {?} step
     * @return {?}
     */
    FindInputComponent.prototype.onEnter = /**
     * @param {?} $event
     * @param {?} step
     * @return {?}
     */
    function ($event, step) {
        this.enterHandler.emit(step);
        return false;
    };
    FindInputComponent.decorators = [
        { type: Component, args: [{
                    selector: 'find-input',
                    template: "\n        <div class=\"f-find-input\" style=\"\">\n            <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                    <select class=\"form-control\" [(ngModel)]=\"findField\">\n                        <option *ngFor=\"let col of columns\" value=\"{{col.field}}\">{{ col.title }}</option>\n                    </select>\n                </div>\n                <input #input type=\"text\" placeholder=\"\u81F3\u5C112\u4E2A\u5B57\u7B26\" class=\"form-control\"\n                    (keydown.esc)=\"onClose($event)\" (keydown.enter)=\"onEnter($event, 0)\">\n                <div class=\"input-group-append\">\n                    <span class=\"input-group-text\">{{current}}/{{count}}</span>\n                    <button class=\"btn btn-outline-secondary\" type=\"button\" title=\"\u4E0A\u4E00\u4E2A\"\n                        [disabled]=\"current === 0\" (click)=\"onEnter($event, -1)\">\n                        <span class=\"f-icon f-icon-arrow-chevron-up\"></span>\n                    </button>\n                    <button class=\"btn btn-outline-secondary\" type=\"button\" title=\"\u4E0B\u4E00\u4E2A\"\n                    [disabled]=\"current === count\" (click)=\"onEnter($event, 1)\">\n                        <span class=\"f-icon f-icon-arrow-chevron-down\"></span>\n                    </button>\n                    <button class=\"btn btn-outline-secondary\" type=\"button\" title=\"\u5173\u95ED\" (click)=\"onClose($event)\">\n                        <span class=\"f-icon f-icon-close\"></span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    ",
                    styles: ["\n        .f-find-input {\n            width: 300px; height: 40px; background: #fefefe; position: absolute; right: 0; z-index: 10; padding: 5px;\n            border: 1px solid #d5d5d5;\n            box-shadow: 0px 1px 2px 0px #989898;\n        }\n        .f-find-input .input-group-text { border-right: 1px solid #ccc; font-size: 10px }\n        .f-find-input .input-group-append { background: #fff; }\n        .f-find-input .input-group-append button { padding:1px 6px;}\n        "]
                }] }
    ];
    /** @nocollapse */
    FindInputComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: NgZone },
        { type: Injector }
    ]; };
    FindInputComponent.propDecorators = {
        current: [{ type: Input }],
        count: [{ type: Input }],
        columns: [{ type: Input }],
        close: [{ type: Output }],
        valueChanged: [{ type: Output }],
        enterHandler: [{ type: Output }],
        input: [{ type: ViewChild, args: ['input',] }]
    };
    return FindInputComponent;
}());
export { FindInputComponent };
if (false) {
    /** @type {?} */
    FindInputComponent.prototype.current;
    /** @type {?} */
    FindInputComponent.prototype.count;
    /** @type {?} */
    FindInputComponent.prototype.columns;
    /** @type {?} */
    FindInputComponent.prototype.close;
    /** @type {?} */
    FindInputComponent.prototype.valueChanged;
    /** @type {?} */
    FindInputComponent.prototype.enterHandler;
    /** @type {?} */
    FindInputComponent.prototype.input;
    /** @type {?} */
    FindInputComponent.prototype.findField;
    /**
     * @type {?}
     * @private
     */
    FindInputComponent.prototype.keyupEventSub;
    /**
     * @type {?}
     * @private
     */
    FindInputComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    FindInputComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    FindInputComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmluZC1pbnB1dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXRyZWV0YWJsZS8iLCJzb3VyY2VzIjpbImxpYi9maW5kLWlucHV0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxHQUFHLEVBQWEsTUFBTSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDdEUsT0FBTyxFQUFFLFNBQVMsRUFBVSxZQUFZLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFDeEQsU0FBUyxFQUFhLE1BQU0sRUFBRSxRQUFRLEVBQWlCLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RixPQUFPLEVBQWdCLFNBQVMsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUUvQztJQXVESSw0QkFBb0IsRUFBYyxFQUFVLE1BQWMsRUFBVSxRQUFrQjtRQUFsRSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVU7UUFaN0UsWUFBTyxHQUFHLENBQUMsQ0FBQztRQUNaLFVBQUssR0FBRyxDQUFDLENBQUM7UUFDVixZQUFPLEdBQUcsRUFBRSxDQUFDO1FBRVosVUFBSyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDM0IsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2xDLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUc1QyxjQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ1Asa0JBQWEsR0FBaUIsSUFBSSxDQUFDO0lBRStDLENBQUM7Ozs7SUFFM0YscUNBQVE7OztJQUFSO1FBQUEsaUJBZUM7UUFkRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNOzs7O1lBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsQ0FBQyxTQUFTLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBdkIsQ0FBdUIsRUFBQyxDQUFDO1lBQ2pFLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7U0FDMUM7UUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQjs7O1FBQUM7WUFDMUIsS0FBSSxDQUFDLGFBQWEsR0FBRyxTQUFTLENBQUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUNsRSxNQUFNOzs7O1lBQUMsVUFBQyxDQUFNLElBQUssT0FBQSxDQUFDLENBQUMsQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBOUIsQ0FBOEIsRUFBQyxFQUNsRCxZQUFZLENBQUMsR0FBRyxDQUFDLEVBQ2pCLEdBQUc7Ozs7WUFBQyxVQUFDLENBQU0sSUFBSyxPQUFBLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFkLENBQWMsRUFBQyxDQUNsQyxDQUFDLFNBQVM7Ozs7WUFBQyxVQUFDLENBQUM7Z0JBQ1YsS0FBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFJLENBQUMsU0FBUyxFQUFDLENBQUMsQ0FBQztZQUM5RCxDQUFDLEVBQUMsQ0FBQztRQUNQLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7OztJQUVELDRDQUFlOzs7SUFBZjtRQUNJLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3JDLENBQUM7Ozs7SUFFRCx3Q0FBVzs7O0lBQVg7UUFDSSxJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDcEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNwQztRQUNELElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO0lBQzlCLENBQUM7Ozs7O0lBRUQsb0NBQU87Ozs7SUFBUCxVQUFRLEtBQUs7UUFDVCxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2xCLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7Ozs7OztJQUVELG9DQUFPOzs7OztJQUFQLFVBQVEsTUFBTSxFQUFFLElBQUk7UUFDaEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDN0IsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQzs7Z0JBN0ZKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsWUFBWTtvQkFDdEIsUUFBUSxFQUFFLHFuREEwQlQ7NkJBRUcsbWVBU0M7aUJBRVI7Ozs7Z0JBN0NpRCxVQUFVO2dCQUNsQyxNQUFNO2dCQUFFLFFBQVE7OzswQkE4Q3JDLEtBQUs7d0JBQ0wsS0FBSzswQkFDTCxLQUFLO3dCQUVMLE1BQU07K0JBQ04sTUFBTTsrQkFDTixNQUFNO3dCQUVOLFNBQVMsU0FBQyxPQUFPOztJQTRDdEIseUJBQUM7Q0FBQSxBQS9GRCxJQStGQztTQXJEWSxrQkFBa0I7OztJQUMzQixxQ0FBcUI7O0lBQ3JCLG1DQUFtQjs7SUFDbkIscUNBQXNCOztJQUV0QixtQ0FBcUM7O0lBQ3JDLDBDQUE0Qzs7SUFDNUMsMENBQTRDOztJQUU1QyxtQ0FBc0M7O0lBQ3RDLHVDQUFlOzs7OztJQUNmLDJDQUEyQzs7Ozs7SUFFL0IsZ0NBQXNCOzs7OztJQUFFLG9DQUFzQjs7Ozs7SUFBRSxzQ0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWJvdW5jZVRpbWUsIG1hcCwgYXVkaXRUaW1lLCBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgRWxlbWVudFJlZixcclxuICAgIFZpZXdDaGlsZCwgT25EZXN0cm95LCBOZ1pvbmUsIEluamVjdG9yLCBBZnRlclZpZXdJbml0LCBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIGZyb21FdmVudCB9IGZyb20gJ3J4anMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZpbmQtaW5wdXQnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwiZi1maW5kLWlucHV0XCIgc3R5bGU9XCJcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAtcHJlcGVuZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBbKG5nTW9kZWwpXT1cImZpbmRGaWVsZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uICpuZ0Zvcj1cImxldCBjb2wgb2YgY29sdW1uc1wiIHZhbHVlPVwie3tjb2wuZmllbGR9fVwiPnt7IGNvbC50aXRsZSB9fTwvb3B0aW9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXQgI2lucHV0IHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCLoh7PlsJEy5Liq5a2X56ymXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxyXG4gICAgICAgICAgICAgICAgICAgIChrZXlkb3duLmVzYyk9XCJvbkNsb3NlKCRldmVudClcIiAoa2V5ZG93bi5lbnRlcik9XCJvbkVudGVyKCRldmVudCwgMClcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dC1ncm91cC1hcHBlbmRcIj5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImlucHV0LWdyb3VwLXRleHRcIj57e2N1cnJlbnR9fS97e2NvdW50fX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnlcIiB0eXBlPVwiYnV0dG9uXCIgdGl0bGU9XCLkuIrkuIDkuKpcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwiY3VycmVudCA9PT0gMFwiIChjbGljayk9XCJvbkVudGVyKCRldmVudCwgLTEpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1hcnJvdy1jaGV2cm9uLXVwXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtc2Vjb25kYXJ5XCIgdHlwZT1cImJ1dHRvblwiIHRpdGxlPVwi5LiL5LiA5LiqXCJcclxuICAgICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwiY3VycmVudCA9PT0gY291bnRcIiAoY2xpY2spPVwib25FbnRlcigkZXZlbnQsIDEpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1hcnJvdy1jaGV2cm9uLWRvd25cIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1zZWNvbmRhcnlcIiB0eXBlPVwiYnV0dG9uXCIgdGl0bGU9XCLlhbPpl61cIiAoY2xpY2spPVwib25DbG9zZSgkZXZlbnQpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1jbG9zZVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgLmYtZmluZC1pbnB1dCB7XHJcbiAgICAgICAgICAgIHdpZHRoOiAzMDBweDsgaGVpZ2h0OiA0MHB4OyBiYWNrZ3JvdW5kOiAjZmVmZWZlOyBwb3NpdGlvbjogYWJzb2x1dGU7IHJpZ2h0OiAwOyB6LWluZGV4OiAxMDsgcGFkZGluZzogNXB4O1xyXG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZDVkNWQ1O1xyXG4gICAgICAgICAgICBib3gtc2hhZG93OiAwcHggMXB4IDJweCAwcHggIzk4OTg5ODtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmYtZmluZC1pbnB1dCAuaW5wdXQtZ3JvdXAtdGV4dCB7IGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNjY2M7IGZvbnQtc2l6ZTogMTBweCB9XHJcbiAgICAgICAgLmYtZmluZC1pbnB1dCAuaW5wdXQtZ3JvdXAtYXBwZW5kIHsgYmFja2dyb3VuZDogI2ZmZjsgfVxyXG4gICAgICAgIC5mLWZpbmQtaW5wdXQgLmlucHV0LWdyb3VwLWFwcGVuZCBidXR0b24geyBwYWRkaW5nOjFweCA2cHg7fVxyXG4gICAgICAgIGBcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZpbmRJbnB1dENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBBZnRlclZpZXdJbml0IHtcclxuICAgIEBJbnB1dCgpIGN1cnJlbnQgPSAwO1xyXG4gICAgQElucHV0KCkgY291bnQgPSAwO1xyXG4gICAgQElucHV0KCkgY29sdW1ucyA9IFtdO1xyXG5cclxuICAgIEBPdXRwdXQoKSBjbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSB2YWx1ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgZW50ZXJIYW5kbGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0JykgaW5wdXQ6IEVsZW1lbnRSZWY7XHJcbiAgICBmaW5kRmllbGQgPSAnJztcclxuICAgIHByaXZhdGUga2V5dXBFdmVudFN1YjogU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIG5nWm9uZTogTmdab25lLCBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcikgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sdW1ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gdGhpcy5jb2x1bW5zLmZpbHRlcihjID0+ICFjLmZvcm1hdHRlciAmJiBjLmZpZWxkKTtcclxuICAgICAgICAgICAgdGhpcy5maW5kRmllbGQgPSB0aGlzLmNvbHVtbnNbMF0uZmllbGQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMua2V5dXBFdmVudFN1YiA9IGZyb21FdmVudCh0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQsICdrZXl1cCcpLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXIoKGU6IGFueSkgPT4gKGUuc3dpdGNoIHx8IGUua2V5Q29kZSkgIT09IDEzKSxcclxuICAgICAgICAgICAgICAgIGRlYm91bmNlVGltZSgyMDApLFxyXG4gICAgICAgICAgICAgICAgbWFwKChlOiBhbnkpID0+IGUudGFyZ2V0LnZhbHVlKVxyXG4gICAgICAgICAgICApLnN1YnNjcmliZSgodikgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUNoYW5nZWQuZW1pdCh7dmFsdWU6IHYsIGZpZWxkOiB0aGlzLmZpbmRGaWVsZH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMua2V5dXBFdmVudFN1Yikge1xyXG4gICAgICAgICAgICB0aGlzLmtleXVwRXZlbnRTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5rZXl1cEV2ZW50U3ViID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZS5lbWl0KCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRW50ZXIoJGV2ZW50LCBzdGVwKSB7XHJcbiAgICAgICAgdGhpcy5lbnRlckhhbmRsZXIuZW1pdChzdGVwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==