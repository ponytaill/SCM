/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-09-02 17:55:57
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-10-23 16:57:28
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { format, isValid, parseISO } from 'date-fns';
import { Injectable } from '@angular/core';
import { MyDateConverter } from './myDateConverter';
import * as i0 from "@angular/core";
var DateTimeHelperService = /** @class */ (function () {
    function DateTimeHelperService() {
        this.$D = null;
        this.$D = new MyDateConverter();
    }
    /**
     * @param value 要转换格式的日期
     * @param fmt 格式化字符串
     *
     * 更多的格式化请参考
     * [点我点我](https://date-fns.org/v1.30.1/docs/format)
     */
    /**
     * @param {?} value 要转换格式的日期
     * @param {?=} fmt 格式化字符串
     *
     * 更多的格式化请参考
     * [点我点我](https://date-fns.org/v1.30.1/docs/format)
     * @return {?}
     */
    DateTimeHelperService.prototype.formatTo = /**
     * @param {?} value 要转换格式的日期
     * @param {?=} fmt 格式化字符串
     *
     * 更多的格式化请参考
     * [点我点我](https://date-fns.org/v1.30.1/docs/format)
     * @return {?}
     */
    function (value, fmt) {
        if (fmt === void 0) { fmt = 'yyyy-MM-dd'; }
        if (!value) {
            return '';
        }
        if (typeof value === 'string' && value.indexOf('0001') === 0) {
            return '';
        }
        if (value instanceof Date) {
            return format(value, fmt);
        }
        /** @type {?} */
        var _d = parseISO(value);
        if (_d == 'Invalid Date') {
            _d = this.createDate(value) || new Date(value);
        }
        // const d = parseISO(value);
        if (isValid(_d)) {
            /** @type {?} */
            var d = parseISO(format(_d, 'yyyy-MM-dd HH:mm:ss'));
            return format(d, fmt);
        }
        else {
            // console.error(`${value} 转换为Date时失败。`);
            if (fmt.indexOf('HH') === 0 || fmt.indexOf('hh') === 0) {
                // 仅有时间部分
                // 提取时间
                /** @type {?} */
                var _time = value.match(/\d*/g).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n !== ''; })).join(':');
                /** @type {?} */
                var fullDateTime = new Date('2022-11-25 ' + _time);
                return format(fullDateTime, fmt);
            }
            return '';
        }
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    DateTimeHelperService.prototype.createDate = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        return this.$D.create(val);
    };
    DateTimeHelperService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    DateTimeHelperService.ctorParameters = function () { return []; };
    /** @nocollapse */ DateTimeHelperService.ngInjectableDef = i0.defineInjectable({ factory: function DateTimeHelperService_Factory() { return new DateTimeHelperService(); }, token: DateTimeHelperService, providedIn: "root" });
    return DateTimeHelperService;
}());
export { DateTimeHelperService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DateTimeHelperService.prototype.$D;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1oZWxwZXIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktY29tbW9uL2RhdGUvIiwic291cmNlcyI6WyJsaWIvZGF0ZS1oZWxwZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFRQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDckQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7O0FBRXBEO0lBT0k7UUFGUSxPQUFFLEdBQUcsSUFBSSxDQUFDO1FBR2QsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO0lBQ3BDLENBQUM7SUFDRDs7Ozs7O09BTUc7Ozs7Ozs7OztJQUNILHdDQUFROzs7Ozs7OztJQUFSLFVBQVMsS0FBVSxFQUFFLEdBQTBCO1FBQTFCLG9CQUFBLEVBQUEsa0JBQTBCO1FBQzNDLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDUixPQUFPLEVBQUUsQ0FBQztTQUNiO1FBRUQsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDMUQsT0FBTyxFQUFFLENBQUM7U0FDYjtRQUVELElBQUksS0FBSyxZQUFZLElBQUksRUFBRTtZQUN2QixPQUFPLE1BQU0sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDN0I7O1lBRUcsRUFBRSxHQUFRLFFBQVEsQ0FBQyxLQUFLLENBQUM7UUFFN0IsSUFBSSxFQUFFLElBQUksY0FBYyxFQUFFO1lBQ3RCLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ2xEO1FBRUQsNkJBQTZCO1FBQzdCLElBQUksT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFOztnQkFDUCxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUNyRCxPQUFPLE1BQU0sQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDekI7YUFBTTtZQUNILHlDQUF5QztZQUN6QyxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFOzs7O29CQUc5QyxLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNOzs7O2dCQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxLQUFJLEVBQUUsRUFBUCxDQUFPLEVBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDOztvQkFDMUQsWUFBWSxHQUFHLElBQUksSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7Z0JBQ3BELE9BQU8sTUFBTSxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQzthQUNwQztZQUNELE9BQU8sRUFBRSxDQUFDO1NBQ2I7SUFDTCxDQUFDOzs7Ozs7SUFFTywwQ0FBVTs7Ozs7SUFBbEIsVUFBbUIsR0FBRztRQUNsQixPQUFPLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQy9CLENBQUM7O2dCQXZESixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7OztnQ0FkRDtDQXFFQyxBQXpERCxJQXlEQztTQXREWSxxQkFBcUI7Ozs7OztJQUU5QixtQ0FBa0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA5LTAyIDE3OjU1OjU3XHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTEwLTIzIDE2OjU3OjI4XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5pbXBvcnQgeyBmb3JtYXQsIGlzVmFsaWQsIHBhcnNlSVNPIH0gZnJvbSAnZGF0ZS1mbnMnO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE15RGF0ZUNvbnZlcnRlciB9IGZyb20gJy4vbXlEYXRlQ29udmVydGVyJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICAgIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0ZVRpbWVIZWxwZXJTZXJ2aWNlIHtcclxuXHJcbiAgICBwcml2YXRlICREID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLiREID0gbmV3IE15RGF0ZUNvbnZlcnRlcigpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUg6KaB6L2s5o2i5qC85byP55qE5pel5pyfXHJcbiAgICAgKiBAcGFyYW0gZm10IOagvOW8j+WMluWtl+espuS4slxyXG4gICAgICpcclxuICAgICAqIOabtOWkmueahOagvOW8j+WMluivt+WPguiAg1xyXG4gICAgICogW+eCueaIkeeCueaIkV0oaHR0cHM6Ly9kYXRlLWZucy5vcmcvdjEuMzAuMS9kb2NzL2Zvcm1hdClcclxuICAgICAqL1xyXG4gICAgZm9ybWF0VG8odmFsdWU6IGFueSwgZm10OiBzdHJpbmcgPSAneXl5eS1NTS1kZCcpIHtcclxuICAgICAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLmluZGV4T2YoJzAwMDEnKSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXQodmFsdWUsIGZtdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgX2Q6IGFueSA9IHBhcnNlSVNPKHZhbHVlKTtcclxuXHJcbiAgICAgICAgaWYgKF9kID09ICdJbnZhbGlkIERhdGUnKSB7XHJcbiAgICAgICAgICAgIF9kID0gdGhpcy5jcmVhdGVEYXRlKHZhbHVlKSB8fCBuZXcgRGF0ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjb25zdCBkID0gcGFyc2VJU08odmFsdWUpO1xyXG4gICAgICAgIGlmIChpc1ZhbGlkKF9kKSkge1xyXG4gICAgICAgICAgICBjb25zdCBkID0gcGFyc2VJU08oZm9ybWF0KF9kLCAneXl5eS1NTS1kZCBISDptbTpzcycpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdChkLCBmbXQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoYCR7dmFsdWV9IOi9rOaNouS4ukRhdGXml7blpLHotKXjgIJgKTtcclxuICAgICAgICAgICAgaWYgKGZtdC5pbmRleE9mKCdISCcpID09PSAwIHx8IGZtdC5pbmRleE9mKCdoaCcpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDku4XmnInml7bpl7Tpg6jliIZcclxuICAgICAgICAgICAgICAgIC8vIOaPkOWPluaXtumXtFxyXG4gICAgICAgICAgICAgICAgY29uc3QgX3RpbWUgPSB2YWx1ZS5tYXRjaCgvXFxkKi9nKS5maWx0ZXIobiA9PiBuIT09ICcnKS5qb2luKCc6Jyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmdWxsRGF0ZVRpbWUgPSBuZXcgRGF0ZSgnMjAyMi0xMS0yNSAnICsgX3RpbWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdChmdWxsRGF0ZVRpbWUsIGZtdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZURhdGUodmFsKSAgICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLiRELmNyZWF0ZSh2YWwpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=