/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { LocaleService } from '@farris/ui-locale';
import { Injectable, Injector, EventEmitter } from '@angular/core';
import { Compare } from '@farris/ui-common/types';
import { DatagridFacadeService } from './datagrid-facade.service';
import { Utils } from './../utils/utils';
import { ColumnFilterType } from '../types/data-column';
import { DatagridColumnsHelper } from './datagrid-columns.helper';
var DatagridFilterService = /** @class */ (function () {
    function DatagridFilterService(dfs, localeSer, inject) {
        this.dfs = dfs;
        this.localeSer = localeSer;
        this.inject = inject;
        this.removeField = new EventEmitter();
    }
    /**
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.validateRowData = /**
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    function (rowData, conditions) {
        if (!conditions || Object.keys(conditions).length === 0) {
            return true;
        }
        return this.checkAllFieldInRowData(rowData, conditions);
    };
    /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.executeFilter = /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    function (data, conditions) {
        var _this = this;
        if (this.dfs.getState().enableSmartFilter) {
            return this.executeSmartFilter(data, conditions);
        }
        if (data && data.length) {
            return data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return _this.validateRowData(n, conditions); }));
        }
        return data;
    };
    /**
     * @private
     * @param {?} fieldDataValue
     * @param {?} operator
     * @param {?} targetValue
     * @return {?}
     */
    DatagridFilterService.prototype.getCompareResult = /**
     * @private
     * @param {?} fieldDataValue
     * @param {?} operator
     * @param {?} targetValue
     * @return {?}
     */
    function (fieldDataValue, operator, targetValue) {
        /** @type {?} */
        var op = parseInt('' + operator, 10);
        switch (op) {
            case Compare.Equal:
                return fieldDataValue == targetValue;
            case Compare.NotEqual:
                return ('' + fieldDataValue).toLowerCase() !== ('' + targetValue).toLowerCase();
            case Compare.Greater:
                return fieldDataValue > targetValue;
            case Compare.GreaterOrEqual:
                return fieldDataValue >= targetValue;
            case Compare.Less:
                return fieldDataValue < targetValue;
            case Compare.LessOrEqual:
                return fieldDataValue <= targetValue;
            case Compare.Like:
                return ('' + fieldDataValue).toLowerCase().indexOf(targetValue.toLowerCase()) > -1;
            case Compare.NotLike:
                return ('' + fieldDataValue).toLowerCase().indexOf(targetValue.toLowerCase()) === -1;
            case Compare.In:
                targetValue = targetValue || [];
                return targetValue.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n == fieldDataValue; })) > -1;
            case 1001: // Empty
                return fieldDataValue === '' || fieldDataValue === null;
            case 1002: // NotEmpty
                return fieldDataValue !== '' && fieldDataValue !== null;
            case 1003: // Null
                return fieldDataValue === null;
            case 1004: // NotNull
                return fieldDataValue !== null;
        }
    };
    /**
     * @private
     * @param {?} result1
     * @param {?} relation
     * @param {?} result2
     * @return {?}
     */
    DatagridFilterService.prototype.getRelationResult = /**
     * @private
     * @param {?} result1
     * @param {?} relation
     * @param {?} result2
     * @return {?}
     */
    function (result1, relation, result2) {
        /** @type {?} */
        var _relation = relation.toLowerCase();
        if (_relation === 'and') {
            return result1 && result2;
        }
        else {
            return result1 || result2;
        }
    };
    /**
     * @private
     * @param {?} resultObj
     * @return {?}
     */
    DatagridFilterService.prototype.checkAllFieldResult = /**
     * @private
     * @param {?} resultObj
     * @return {?}
     */
    function (resultObj) {
        if (!resultObj) {
            return true;
        }
        return Object.values(resultObj).reduce((/**
         * @param {?} c
         * @param {?} n
         * @return {?}
         */
        function (c, n) {
            return c && n;
        }), true);
    };
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.checkAllFieldInRowData = /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    function (rowData, conditions) {
        var _this = this;
        // this.state = conditions;
        /** @type {?} */
        var resultObj = null;
        if (conditions) {
            /** @type {?} */
            var fields = Object.keys(conditions);
            resultObj = {};
            fields.forEach((/**
             * @param {?} field
             * @return {?}
             */
            function (field) {
                /** @type {?} */
                var fieldValue = Utils.getValue(field, rowData);
                /** @type {?} */
                var columnObj = _this.dfs.getColumn(field);
                if (columnObj && columnObj.isMultilingualField) {
                    fieldValue = Utils.getMultilingualValue(fieldValue, _this.localeSer.localeId);
                }
                /** @type {?} */
                var where = conditions[field];
                var value1 = where.value1, operator1 = where.operator1, relation = where.relation, operator2 = where.operator2, value2 = where.value2;
                if (where) {
                    /** @type {?} */
                    var result = _this.getCompareResult(fieldValue, operator1, value1);
                    resultObj[field] = result;
                    if (relation) {
                        /** @type {?} */
                        var result2 = _this.getCompareResult(fieldValue, operator2, value2);
                        resultObj[field] = _this.getRelationResult(result, relation, result2);
                    }
                }
            }));
        }
        return this.checkAllFieldResult(resultObj);
    };
    /**
     * @param {?} field
     * @return {?}
     */
    DatagridFilterService.prototype.removeFilterField = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        this.removeField.emit(field);
    };
    /**
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.convertFilterCondition2String = /**
     * @param {?} conditions
     * @return {?}
     */
    function (conditions) {
        var _this = this;
        if (!conditions) {
            return '';
        }
        /** @type {?} */
        var str = '';
        /** @type {?} */
        var andText = this.localeSer.getValue('datagrid.filter.and');
        /** @type {?} */
        var orText = this.localeSer.getValue('datagrid.filter.or');
        /** @type {?} */
        var and = "<span class='badge badge-success'>" + andText + "</span>";
        /** @type {?} */
        var and2 = "<span class='badge badge-info'>" + andText + "</span>";
        /** @type {?} */
        var or = "<span class='badge badge-warning'>" + orText + "</span>";
        /** @type {?} */
        var lbracket = "<b>\u3014</b>";
        /** @type {?} */
        var rbracket = "<b>\u3015</b>";
        /** @type {?} */
        var ellipsis = "[ <span class=\"ellipsis\" title=\"$title$\">  $value$<i class=\"f-icon f-icon-lookup\"></i></span> ]";
        str = Object.keys(conditions).reduce((/**
         * @param {?} c
         * @param {?} r
         * @return {?}
         */
        function (c, r) {
            /** @type {?} */
            var filter = conditions[r];
            /** @type {?} */
            var col = _this.dfs.getColumn(r);
            /** @type {?} */
            var t = "<b>" + col.title + "</b>";
            /** @type {?} */
            var s = " " + t + " " + _this.getCompareString(filter.operator1) + " " + Utils.escapeValue(filter.value1) + "  ";
            if (filter.operator1 == Compare.In) {
                /** @type {?} */
                var txt = filter.value1;
                /** @type {?} */
                var txt2 = txt;
                if (col.filter.type === ColumnFilterType.enum) {
                    /** @type {?} */
                    var enumOpts = DatagridColumnsHelper.getFilterEnumOptions(col);
                    txt = DatagridColumnsHelper.getEnumText(enumOpts, filter.value1);
                    txt2 = txt.split(',').slice(0, 2).join(',');
                }
                else {
                    txt2 = txt.slice(0, 2).join(',');
                }
                s = " " + t + " " + _this.getCompareString(filter.operator1) + " [ " + txt + " ]  ";
                if (filter.value1.length > 2) {
                    s = " " + t + " " + _this.getCompareString(filter.operator1) + " " + ellipsis.replace('$title$', txt).replace('$value$', txt2) + "  ";
                }
            }
            else {
                if (filter.operator1 == Compare.Equal && Array.isArray(filter.value1)) {
                    if (!filter.value1.length) {
                        s = " " + t + " " + _this.getCompareString(filter.operator1) + " ''  ";
                    }
                }
            }
            if (filter.relation) {
                /** @type {?} */
                var s2 = t + " " + _this.getCompareString(filter.operator2) + " " + filter.value2;
                s = lbracket + " " + s + " " + (filter.relation === 'and' ? and2 : or) + " " + s2 + " " + rbracket;
            }
            return c + " <span class=\"filter-field filter-column-" + r + "\"> " + s + " AND </span>";
        }), '');
        /** @type {?} */
        var lastANDidx = str.lastIndexOf('AND');
        /** @type {?} */
        var resultStr = str.substr(0, lastANDidx);
        resultStr += str.substr(lastANDidx + 3);
        return resultStr.replace(/AND/g, and).replace(/OR/g, or);
    };
    /**
     * @private
     * @param {?} operator
     * @return {?}
     */
    DatagridFilterService.prototype.getCompareString = /**
     * @private
     * @param {?} operator
     * @return {?}
     */
    function (operator) {
        /** @type {?} */
        var op = parseInt('' + operator, 10);
        /** @type {?} */
        var code = '';
        switch (op) {
            case Compare.Equal:
            case Compare.NotEqual:
            case Compare.Greater:
            case Compare.GreaterOrEqual:
            case Compare.Less:
            case Compare.LessOrEqual:
            case Compare.Like:
            case Compare.NotLike:
            case Compare.In:
                code = Compare[op];
                code = code[0].toLowerCase() + code.substr(1);
                return this.localeSer.getValue('datagrid.filter.operators.' + code);
            case 1001: // Empty
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.empty');
            case 1002: // NotEmpty
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.notEmpty');
            case 1003: // Null
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.null');
            case 1004: // NotNull
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.notNull');
        }
    };
    /**
     * @param {?} condition
     * @return {?}
     */
    DatagridFilterService.prototype.convert2FilterArray = /**
     * @param {?} condition
     * @return {?}
     */
    function (condition) {
        /** @type {?} */
        var filterArr = [];
        if (condition) {
            /** @type {?} */
            var fields = Object.keys(condition);
            if (fields && fields.length) {
                fields.forEach((/**
                 * @param {?} field
                 * @return {?}
                 */
                function (field) {
                    /** @type {?} */
                    var obj = { filterField: field, value: '', lbracket: '', rbracket: '', relation: 1, compare: 0 };
                    /** @type {?} */
                    var conditionVal = condition[field];
                    if (typeof conditionVal === 'object') {
                        obj.compare = conditionVal.operator1;
                        obj.value = conditionVal.value1;
                        filterArr.push(obj);
                        if (conditionVal.value2) {
                            obj.lbracket = '(';
                            obj.relation = conditionVal.relation === 'and' ? 1 : 2;
                            /** @type {?} */
                            var obj2 = { filterField: field, value: '', lbracket: '', rbracket: ')', relation: 1, compare: 0 };
                            obj2.compare = conditionVal.operator2;
                            obj2.value = conditionVal.value2;
                            filterArr.push(obj2);
                        }
                        else {
                            if (conditionVal.operator2) {
                                /** @type {?} */
                                var op2 = parseInt('' + conditionVal.operator2, 10);
                                if (op2 === 1001 || op2 === 1002) {
                                    obj.lbracket = '(';
                                    obj.relation = conditionVal.relation === 'and' ? 1 : 2;
                                    /** @type {?} */
                                    var obj2 = { filterField: field, value: '', lbracket: '', rbracket: ')', relation: 1, compare: 0 };
                                    obj2.compare = op2 === 1001 ? Compare.Equal : Compare.NotEqual;
                                    obj2.value = '';
                                    filterArr.push(obj2);
                                }
                            }
                        }
                    }
                    return obj;
                }));
            }
        }
        if (filterArr.length) {
            this.checkEnumTypeFilters(filterArr);
            filterArr[filterArr.length - 1].relation = 0;
        }
        return filterArr;
    };
    /**
     * @private
     * @param {?} filterArr
     * @return {?}
     */
    DatagridFilterService.prototype.checkEnumTypeFilters = /**
     * @private
     * @param {?} filterArr
     * @return {?}
     */
    function (filterArr) {
        var _this = this;
        /** @type {?} */
        var enumFilters = {};
        filterArr.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        function (f, i) {
            /** @type {?} */
            var enumFilterArr = _this.convertEnumTypeFilter(f);
            if (enumFilterArr && enumFilterArr.length) {
                enumFilters[f.filterField] = enumFilterArr;
            }
        }));
        /** @type {?} */
        var keys = Object.keys(enumFilters);
        if (keys.length) {
            keys.forEach((/**
             * @param {?} k
             * @return {?}
             */
            function (k) {
                /** @type {?} */
                var i = filterArr.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.filterField === k; }));
                filterArr.splice.apply(filterArr, tslib_1.__spread([i, 1], enumFilters[k]));
            }));
        }
        return filterArr;
    };
    // 将enum 类型的条件转换多个条件
    // 将enum 类型的条件转换多个条件
    /**
     * @private
     * @param {?} filter
     * @return {?}
     */
    DatagridFilterService.prototype.convertEnumTypeFilter = 
    // 将enum 类型的条件转换多个条件
    /**
     * @private
     * @param {?} filter
     * @return {?}
     */
    function (filter) {
        if (filter) {
            /** @type {?} */
            var col = (/** @type {?} */ (this.dfs.getColumn(filter.filterField)));
            if (col && col.filter && col.filter.type === ColumnFilterType.enum) {
                if (Array.isArray(filter.value) && filter.value.length) {
                    if (filter.value.length === 1) {
                        filter.compare = Compare.Equal;
                        filter.value = filter.value[0];
                        return [];
                    }
                    else {
                        // > 1
                        /** @type {?} */
                        var filterArr = filter.value.map((/**
                         * @param {?} val
                         * @return {?}
                         */
                        function (val) {
                            return {
                                filterField: filter.filterField,
                                value: val,
                                lbracket: '',
                                rbracket: '',
                                relation: 2,
                                // or
                                compare: 0
                            };
                        }));
                        filterArr[0].lbracket = '(';
                        filterArr[filter.value.length - 1].rbracket = ')';
                        filterArr[filter.value.length - 1].relation = 1;
                        return filterArr;
                    }
                }
            }
        }
        return [];
    };
    /**
     * @param {?} col
     * @return {?}
     */
    DatagridFilterService.prototype.createColumnFilterOptions = /**
     * @param {?} col
     * @return {?}
     */
    function (col) {
        /** @type {?} */
        var filterTypeOptions = {
            type: ColumnFilterType.string,
            enableOperator: true
        };
        if (col.editor) {
            switch (col.editor.type) {
                case 'textarea':
                case 'textbox':
                case 'language-textbox':
                    filterTypeOptions = {
                        type: ColumnFilterType.string,
                        enableOperator: true
                    };
                    break;
                case 'checkbox':
                case 'switch':
                    filterTypeOptions = {
                        type: ColumnFilterType.boolean,
                        enableOperator: false
                    };
                    break;
                case 'numberbox':
                    filterTypeOptions = {
                        type: ColumnFilterType.number,
                        enableOperator: true
                    };
                    break;
                case 'combolist':
                case 'select':
                    filterTypeOptions = {
                        type: ColumnFilterType.enum,
                        enableOperator: true,
                        options: col.editor.options
                    };
                    break;
                case 'datepicker':
                    filterTypeOptions = {
                        type: col['dataType'] === 'datetime' ? ColumnFilterType.datetime : ColumnFilterType.date,
                        enableOperator: true,
                        options: {
                            dateFormat: col.editor.options.dateFormat,
                            returnFormat: col.editor.options.returnFormat
                        }
                    };
                    break;
                case 'timepicker':
                    filterTypeOptions = {
                        type: ColumnFilterType.time,
                        enableOperator: true
                    };
                    break;
            }
        }
        else if (col.formatter) {
            if (typeof col.formatter === 'object' && Object.keys(col.formatter).length) {
                /** @type {?} */
                var options = col.formatter['options'];
                switch (col.formatter['type']) {
                    case 'number':
                        filterTypeOptions = {
                            type: ColumnFilterType.number,
                            enableOperator: true
                        };
                        break;
                    case 'enum':
                        filterTypeOptions = {
                            type: ColumnFilterType.enum,
                            enableOperator: true,
                            options: options
                        };
                        break;
                    case 'boolean':
                        filterTypeOptions = {
                            type: ColumnFilterType.boolean,
                            enableOperator: false
                        };
                        break;
                    case 'datetime':
                        /** @type {?} */
                        var tye = ColumnFilterType.datetime;
                        /** @type {?} */
                        var fmt = 'yyyy-MM-dd';
                        /** @type {?} */
                        var returnFmt = 'yyyy-MM-dd';
                        if (options && options.format) {
                            fmt = options.format;
                            if (fmt.indexOf('HH:') == -1) {
                                tye = ColumnFilterType.date;
                            }
                            else {
                                returnFmt += ' HH:mm';
                                if (fmt.indexOf('ss') > -1) {
                                    returnFmt += ':ss';
                                }
                            }
                        }
                        else {
                            tye = ColumnFilterType.date;
                        }
                        filterTypeOptions = {
                            type: tye,
                            enableOperator: true
                        };
                        filterTypeOptions.options = { dateFormat: fmt, returnFormat: returnFmt };
                        break;
                    default:
                        filterTypeOptions = {
                            type: ColumnFilterType.string,
                            enableOperator: true
                        };
                }
            }
        }
        else {
            filterTypeOptions = {
                type: ColumnFilterType.string,
                enableOperator: true
            };
        }
        return filterTypeOptions;
    };
    //#region  Smart Filter
    //#region  Smart Filter
    /**
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.convertSmartFilter2EntityFilter = 
    //#region  Smart Filter
    /**
     * @param {?} conditions
     * @return {?}
     */
    function (conditions) {
        if (conditions && conditions.length) {
            return conditions.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n;
            }));
        }
        return [];
    };
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.validateRowData2 = /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    function (rowData, conditions) {
        if (!conditions || conditions.length === 0) {
            return true;
        }
        return this.checkRowDataWithCondition(rowData, conditions);
    };
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.checkRowDataWithCondition = /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    function (rowData, conditions) {
        var _this = this;
        /** @type {?} */
        var resultObj = null;
        if (conditions) {
            resultObj = {};
            conditions.forEach((/**
             * @param {?} condition
             * @return {?}
             */
            function (condition) {
                /** @type {?} */
                var field = condition.FilterField;
                /** @type {?} */
                var fieldValue = Utils.getValue(field, rowData);
                /** @type {?} */
                var columnObj = _this.dfs.getColumn(field);
                if (columnObj && columnObj.isMultilingualField) {
                    fieldValue = Utils.getMultilingualValue(fieldValue, _this.localeSer.localeId);
                }
                /** @type {?} */
                var where = condition;
                var Value = where.Value, Relation = where.Relation, operator1 = where.Compare;
                if (where) {
                    /** @type {?} */
                    var r = _this.getCompareResult(fieldValue, operator1, Value);
                    if (resultObj[field] === undefined) {
                        resultObj[field] = [r];
                    }
                    else {
                        resultObj[field].push(r);
                    }
                }
            }));
        }
        // return this.checkAllFieldResult(resultObj);
        /** @type {?} */
        var fields = Object.keys(resultObj);
        /** @type {?} */
        var result = [];
        fields.forEach((/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            /** @type {?} */
            var _filters = conditions.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.FilterField === f; }));
            if (resultObj[f].length === 1) {
                result.push(resultObj[f][0]);
            }
            else {
                if (_filters[0].Relation === 1 && resultObj[f].length === 2) { // and
                    result.push(resultObj[f][0] && resultObj[f][1]);
                }
                else { // or
                    result.push(resultObj[f].indexOf(true) > -1);
                }
            }
        }));
        return result.indexOf(false) === -1;
    };
    /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    DatagridFilterService.prototype.executeSmartFilter = /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    function (data, conditions) {
        var _this = this;
        if (data && data.length) {
            return data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return _this.validateRowData2(n, conditions); }));
        }
        return data;
    };
    DatagridFilterService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    DatagridFilterService.ctorParameters = function () { return [
        { type: DatagridFacadeService },
        { type: LocaleService },
        { type: Injector }
    ]; };
    return DatagridFilterService;
}());
export { DatagridFilterService };
if (false) {
    /** @type {?} */
    DatagridFilterService.prototype.removeField;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.dfs;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.localeSer;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtZmlsdGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2RhdGFncmlkLWZpbHRlci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUM3RSxPQUFPLEVBQUUsT0FBTyxFQUFtQixNQUFNLHlCQUF5QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN6QyxPQUFPLEVBQWMsZ0JBQWdCLEVBQTBELE1BQU0sc0JBQXNCLENBQUM7QUFDNUgsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFFbEU7SUFJSSwrQkFBb0IsR0FBMEIsRUFBVSxTQUF3QixFQUFVLE1BQWdCO1FBQXRGLFFBQUcsR0FBSCxHQUFHLENBQXVCO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBZTtRQUFVLFdBQU0sR0FBTixNQUFNLENBQVU7UUFGMUcsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO0lBR3pDLENBQUM7Ozs7OztJQUVELCtDQUFlOzs7OztJQUFmLFVBQWdCLE9BQVksRUFBRSxVQUFzRDtRQUNoRixJQUFJLENBQUMsVUFBVSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUNyRCxPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQzVELENBQUM7Ozs7OztJQUVE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Q0FBa0M7Ozs7O0lBQUUsMENBQWdDOzs7OztJQUFFLHVDQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbmltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yLCBFdmVudEVtaXR0ZXIsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbXBhcmUsIEZpbHRlckNvbmRpdGlvbiB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL3R5cGVzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRGYWNhZGVTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhZ3JpZC1mYWNhZGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4sIENvbHVtbkZpbHRlclR5cGUsIENvbHVtbkZpbHRlciwgRmlsdGVyQ29uZGl0aW9uIGFzIENsaWVudEZpbHRlckNvbmRpdGlvbiB9IGZyb20gJy4uL3R5cGVzL2RhdGEtY29sdW1uJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb2x1bW5zSGVscGVyIH0gZnJvbSAnLi9kYXRhZ3JpZC1jb2x1bW5zLmhlbHBlcic7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBEYXRhZ3JpZEZpbHRlclNlcnZpY2Uge1xyXG4gICAgcmVtb3ZlRmllbGQgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRmczogRGF0YWdyaWRGYWNhZGVTZXJ2aWNlLCBwcml2YXRlIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZSwgcHJpdmF0ZSBpbmplY3Q6IEluamVjdG9yKSB7XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGVSb3dEYXRhKHJvd0RhdGE6IGFueSwgY29uZGl0aW9uczogeyBbZmllbGQ6IHN0cmluZ106IENsaWVudEZpbHRlckNvbmRpdGlvbiB9KSB7XHJcbiAgICAgICAgaWYgKCFjb25kaXRpb25zIHx8IE9iamVjdC5rZXlzKGNvbmRpdGlvbnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBbGxGaWVsZEluUm93RGF0YShyb3dEYXRhLCBjb25kaXRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBleGVjdXRlRmlsdGVyKGRhdGE6IFtdLCBjb25kaXRpb25zOiBhbnkpOiBhbnlbXSB7XHJcbiAgICAgICAgaWYgKCB0aGlzLmRmcy5nZXRTdGF0ZSgpLmVuYWJsZVNtYXJ0RmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4ZWN1dGVTbWFydEZpbHRlcihkYXRhLCBjb25kaXRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZpbHRlcihuID0+IHRoaXMudmFsaWRhdGVSb3dEYXRhKG4sIGNvbmRpdGlvbnMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDb21wYXJlUmVzdWx0KGZpZWxkRGF0YVZhbHVlOiBhbnksIG9wZXJhdG9yOiBDb21wYXJlLCB0YXJnZXRWYWx1ZTogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgb3AgPSBwYXJzZUludCgnJyArIG9wZXJhdG9yLCAxMCk7XHJcbiAgICAgICAgc3dpdGNoIChvcCkge1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuRXF1YWw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgPT0gdGFyZ2V0VmFsdWU7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RFcXVhbDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAoJycgKyBmaWVsZERhdGFWYWx1ZSkudG9Mb3dlckNhc2UoKSAhPT0gKCcnICsgdGFyZ2V0VmFsdWUpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5HcmVhdGVyOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlID4gdGFyZ2V0VmFsdWU7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5HcmVhdGVyT3JFcXVhbDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZERhdGFWYWx1ZSA+PSB0YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxlc3M6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgPCB0YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxlc3NPckVxdWFsOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlIDw9IHRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuTGlrZTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAoJycgKyBmaWVsZERhdGFWYWx1ZSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRhcmdldFZhbHVlLnRvTG93ZXJDYXNlKCkpID4gLTE7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RMaWtlOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICgnJyArIGZpZWxkRGF0YVZhbHVlKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGFyZ2V0VmFsdWUudG9Mb3dlckNhc2UoKSkgPT09IC0xO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuSW46XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRWYWx1ZSA9IHRhcmdldFZhbHVlIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFZhbHVlLmZpbmRJbmRleCggbiA9PiBuID09IGZpZWxkRGF0YVZhbHVlKSA+IC0xO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDE6IC8vIEVtcHR5XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgPT09ICcnIHx8IGZpZWxkRGF0YVZhbHVlID09PSBudWxsO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDI6ICAvLyBOb3RFbXB0eVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlICE9PSAnJyAmJiBmaWVsZERhdGFWYWx1ZSAhPT0gbnVsbDtcclxuICAgICAgICAgICAgY2FzZSAxMDAzOiAvLyBOdWxsXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgPT09IG51bGw7XHJcbiAgICAgICAgICAgIGNhc2UgMTAwNDogLy8gTm90TnVsbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlICE9PSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJlbGF0aW9uUmVzdWx0KHJlc3VsdDE6IGJvb2xlYW4sIHJlbGF0aW9uOiAnYW5kJyB8ICdvcicsIHJlc3VsdDI6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCBfcmVsYXRpb24gPSByZWxhdGlvbi50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChfcmVsYXRpb24gPT09ICdhbmQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQxICYmIHJlc3VsdDI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDEgfHwgcmVzdWx0MjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja0FsbEZpZWxkUmVzdWx0KHJlc3VsdE9iajogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0pIHtcclxuICAgICAgICBpZiAoIXJlc3VsdE9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHJlc3VsdE9iaikucmVkdWNlKChjLCBuKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBjICYmIG47XHJcbiAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja0FsbEZpZWxkSW5Sb3dEYXRhKHJvd0RhdGE6IGFueSwgY29uZGl0aW9uczogeyBbZmllbGQ6IHN0cmluZ106IENsaWVudEZpbHRlckNvbmRpdGlvbiB9KSB7XHJcbiAgICAgICAgLy8gdGhpcy5zdGF0ZSA9IGNvbmRpdGlvbnM7XHJcbiAgICAgICAgbGV0IHJlc3VsdE9iaiA9IG51bGw7XHJcbiAgICAgICAgaWYgKGNvbmRpdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXMoY29uZGl0aW9ucyk7XHJcbiAgICAgICAgICAgIHJlc3VsdE9iaiA9IHt9O1xyXG4gICAgICAgICAgICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZmllbGRWYWx1ZSA9IFV0aWxzLmdldFZhbHVlKGZpZWxkLCByb3dEYXRhKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbk9iaiA9IHRoaXMuZGZzLmdldENvbHVtbihmaWVsZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uT2JqICYmIGNvbHVtbk9iai5pc011bHRpbGluZ3VhbEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRWYWx1ZSA9IFV0aWxzLmdldE11bHRpbGluZ3VhbFZhbHVlKGZpZWxkVmFsdWUsIHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB3aGVyZSA9IGNvbmRpdGlvbnNbZmllbGRdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyB2YWx1ZTEsIG9wZXJhdG9yMSwgcmVsYXRpb24sIG9wZXJhdG9yMiwgdmFsdWUyIH0gPSB3aGVyZTtcclxuICAgICAgICAgICAgICAgIGlmICh3aGVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZ2V0Q29tcGFyZVJlc3VsdChmaWVsZFZhbHVlLCBvcGVyYXRvcjEsIHZhbHVlMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0T2JqW2ZpZWxkXSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0MiA9IHRoaXMuZ2V0Q29tcGFyZVJlc3VsdChmaWVsZFZhbHVlLCBvcGVyYXRvcjIsIHZhbHVlMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE9ialtmaWVsZF0gPSB0aGlzLmdldFJlbGF0aW9uUmVzdWx0KHJlc3VsdCwgcmVsYXRpb24sIHJlc3VsdDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBbGxGaWVsZFJlc3VsdChyZXN1bHRPYmopO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUZpbHRlckZpZWxkKGZpZWxkKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVGaWVsZC5lbWl0KGZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb252ZXJ0RmlsdGVyQ29uZGl0aW9uMlN0cmluZyhjb25kaXRpb25zOiBhbnkpIHtcclxuICAgICAgICBpZiAoIWNvbmRpdGlvbnMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc3RyID0gJyc7XHJcbiAgICAgICAgY29uc3QgYW5kVGV4dCA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5maWx0ZXIuYW5kJyk7XHJcbiAgICAgICAgY29uc3Qgb3JUZXh0ID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcicpO1xyXG4gICAgICAgIGNvbnN0IGFuZCA9IGA8c3BhbiBjbGFzcz0nYmFkZ2UgYmFkZ2Utc3VjY2Vzcyc+JHthbmRUZXh0fTwvc3Bhbj5gO1xyXG4gICAgICAgIGNvbnN0IGFuZDIgPSBgPHNwYW4gY2xhc3M9J2JhZGdlIGJhZGdlLWluZm8nPiR7YW5kVGV4dH08L3NwYW4+YDtcclxuICAgICAgICBjb25zdCBvciA9IGA8c3BhbiBjbGFzcz0nYmFkZ2UgYmFkZ2Utd2FybmluZyc+JHtvclRleHR9PC9zcGFuPmA7XHJcbiAgICAgICAgY29uc3QgbGJyYWNrZXQgPSBgPGI+44CUPC9iPmA7XHJcbiAgICAgICAgY29uc3QgcmJyYWNrZXQgPSBgPGI+44CVPC9iPmA7XHJcbiAgICAgICAgY29uc3QgZWxsaXBzaXMgPSBgWyA8c3BhbiBjbGFzcz1cImVsbGlwc2lzXCIgdGl0bGU9XCIkdGl0bGUkXCI+ICAkdmFsdWUkPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT48L3NwYW4+IF1gO1xyXG5cclxuICAgICAgICBzdHIgPSBPYmplY3Qua2V5cyhjb25kaXRpb25zKS5yZWR1Y2UoKGMsIHIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZmlsdGVyID0gY29uZGl0aW9uc1tyXTtcclxuICAgICAgICAgICAgY29uc3QgY29sID0gdGhpcy5kZnMuZ2V0Q29sdW1uKHIpO1xyXG4gICAgICAgICAgICBjb25zdCB0ID0gYDxiPiR7Y29sLnRpdGxlfTwvYj5gO1xyXG5cclxuICAgICAgICAgICAgbGV0IHMgPSBgICR7dH0gJHt0aGlzLmdldENvbXBhcmVTdHJpbmcoZmlsdGVyLm9wZXJhdG9yMSl9ICR7VXRpbHMuZXNjYXBlVmFsdWUoZmlsdGVyLnZhbHVlMSl9ICBgO1xyXG4gICAgICAgICAgICBpZiAoZmlsdGVyLm9wZXJhdG9yMSA9PSBDb21wYXJlLkluKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdHh0ID0gZmlsdGVyLnZhbHVlMTtcclxuICAgICAgICAgICAgICAgIGxldCB0eHQyID0gdHh0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5maWx0ZXIudHlwZSA9PT0gQ29sdW1uRmlsdGVyVHlwZS5lbnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW51bU9wdHMgPSBEYXRhZ3JpZENvbHVtbnNIZWxwZXIuZ2V0RmlsdGVyRW51bU9wdGlvbnMoY29sKTtcclxuICAgICAgICAgICAgICAgICAgICB0eHQgPSBEYXRhZ3JpZENvbHVtbnNIZWxwZXIuZ2V0RW51bVRleHQoZW51bU9wdHMsIGZpbHRlci52YWx1ZTEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHR4dDIgPSB0eHQuc3BsaXQoJywnKS5zbGljZSgwLCAyKS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHR4dDIgPSB0eHQuc2xpY2UoMCwgMikuam9pbignLCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHMgPSBgICR7dH0gJHt0aGlzLmdldENvbXBhcmVTdHJpbmcoZmlsdGVyLm9wZXJhdG9yMSl9IFsgJHt0eHR9IF0gIGA7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyLnZhbHVlMS5sZW5ndGggPiAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcyA9IGAgJHt0fSAke3RoaXMuZ2V0Q29tcGFyZVN0cmluZyhmaWx0ZXIub3BlcmF0b3IxKX0gJHtlbGxpcHNpcy5yZXBsYWNlKCckdGl0bGUkJywgdHh0KS5yZXBsYWNlKCckdmFsdWUkJywgdHh0Mil9ICBgO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlci5vcGVyYXRvcjEgPT0gQ29tcGFyZS5FcXVhbCAmJiBBcnJheS5pc0FycmF5KGZpbHRlci52YWx1ZTEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIudmFsdWUxLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzID0gYCAke3R9ICR7dGhpcy5nZXRDb21wYXJlU3RyaW5nKGZpbHRlci5vcGVyYXRvcjEpfSAnJyAgYDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbHRlci5yZWxhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgczIgPSBgJHt0fSAke3RoaXMuZ2V0Q29tcGFyZVN0cmluZyhmaWx0ZXIub3BlcmF0b3IyKX0gJHtmaWx0ZXIudmFsdWUyfWA7XHJcbiAgICAgICAgICAgICAgICBzID0gYCR7bGJyYWNrZXR9ICR7c30gJHtmaWx0ZXIucmVsYXRpb24gPT09ICdhbmQnID8gYW5kMiA6IG9yfSAke3MyfSAke3JicmFja2V0fWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGAke2N9IDxzcGFuIGNsYXNzPVwiZmlsdGVyLWZpZWxkIGZpbHRlci1jb2x1bW4tJHtyfVwiPiAke3N9IEFORCA8L3NwYW4+YDtcclxuICAgICAgICB9LCAnJyk7XHJcbiAgICAgICAgY29uc3QgbGFzdEFORGlkeCA9IHN0ci5sYXN0SW5kZXhPZignQU5EJyk7XHJcbiAgICAgICAgbGV0IHJlc3VsdFN0ciA9IHN0ci5zdWJzdHIoMCwgbGFzdEFORGlkeCk7XHJcbiAgICAgICAgcmVzdWx0U3RyICs9IHN0ci5zdWJzdHIobGFzdEFORGlkeCArIDMpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRTdHIucmVwbGFjZSgvQU5EL2csIGFuZCkucmVwbGFjZSgvT1IvZywgb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q29tcGFyZVN0cmluZyhvcGVyYXRvcjogQ29tcGFyZSkge1xyXG4gICAgICAgIGNvbnN0IG9wID0gcGFyc2VJbnQoJycgKyBvcGVyYXRvciwgMTApO1xyXG4gICAgICAgIGxldCBjb2RlID0gJyc7XHJcbiAgICAgICAgc3dpdGNoIChvcCkge1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuRXF1YWw6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkdyZWF0ZXI6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5HcmVhdGVyT3JFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxlc3M6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5MZXNzT3JFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxpa2U6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RMaWtlOlxyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuSW46XHJcbiAgICAgICAgICAgICAgICBjb2RlID0gQ29tcGFyZVtvcF07XHJcbiAgICAgICAgICAgICAgICBjb2RlID0gY29kZVswXS50b0xvd2VyQ2FzZSgpICsgY29kZS5zdWJzdHIoMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcGVyYXRvcnMuJyArIGNvZGUpO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDE6IC8vIEVtcHR5XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyAnICsgdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcGVyYXRvcnMuZW1wdHknKTtcclxuICAgICAgICAgICAgY2FzZSAxMDAyOiAgLy8gTm90RW1wdHlcclxuICAgICAgICAgICAgICAgIHJldHVybiAnICcgKyB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuZmlsdGVyLm9wZXJhdG9ycy5ub3RFbXB0eScpO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDM6IC8vIE51bGxcclxuICAgICAgICAgICAgICAgIHJldHVybiAnICcgKyB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuZmlsdGVyLm9wZXJhdG9ycy5udWxsJyk7XHJcbiAgICAgICAgICAgIGNhc2UgMTAwNDogLy8gTm90TnVsbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcgJyArIHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5maWx0ZXIub3BlcmF0b3JzLm5vdE51bGwnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGNvbnZlcnQyRmlsdGVyQXJyYXkoY29uZGl0aW9uOiB7IFtmaWVsZDogc3RyaW5nXTogYW55IH0pOiBGaWx0ZXJDb25kaXRpb25bXSB7XHJcbiAgICAgICAgY29uc3QgZmlsdGVyQXJyID0gW107XHJcbiAgICAgICAgaWYgKGNvbmRpdGlvbikge1xyXG4gICAgICAgICAgICBjb25zdCBmaWVsZHMgPSBPYmplY3Qua2V5cyhjb25kaXRpb24pO1xyXG4gICAgICAgICAgICBpZiAoZmllbGRzICYmIGZpZWxkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmogPSB7IGZpbHRlckZpZWxkOiBmaWVsZCwgdmFsdWU6ICcnLCBsYnJhY2tldDogJycsIHJicmFja2V0OiAnJywgcmVsYXRpb246IDEsIGNvbXBhcmU6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb25WYWwgPSBjb25kaXRpb25bZmllbGRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uZGl0aW9uVmFsID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouY29tcGFyZSA9IGNvbmRpdGlvblZhbC5vcGVyYXRvcjE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai52YWx1ZSA9IGNvbmRpdGlvblZhbC52YWx1ZTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckFyci5wdXNoKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25kaXRpb25WYWwudmFsdWUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoubGJyYWNrZXQgPSAnKCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoucmVsYXRpb24gPSBjb25kaXRpb25WYWwucmVsYXRpb24gPT09ICdhbmQnID8gMSA6IDI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqMiA9IHsgZmlsdGVyRmllbGQ6IGZpZWxkLCB2YWx1ZTogJycsIGxicmFja2V0OiAnJywgcmJyYWNrZXQ6ICcpJywgcmVsYXRpb246IDEsIGNvbXBhcmU6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iajIuY29tcGFyZSA9IGNvbmRpdGlvblZhbC5vcGVyYXRvcjI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLnZhbHVlID0gY29uZGl0aW9uVmFsLnZhbHVlMjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnIucHVzaChvYmoyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25kaXRpb25WYWwub3BlcmF0b3IyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3AyID0gcGFyc2VJbnQoJycgKyBjb25kaXRpb25WYWwub3BlcmF0b3IyLCAxMCk7IC8vICBFbXB0eTogMTAwMSwgTm90RW1wdHk6IDEwMDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3AyID09PSAxMDAxIHx8IG9wMiA9PT0gMTAwMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoubGJyYWNrZXQgPSAnKCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5yZWxhdGlvbiA9IGNvbmRpdGlvblZhbC5yZWxhdGlvbiA9PT0gJ2FuZCcgPyAxIDogMjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iajIgPSB7IGZpbHRlckZpZWxkOiBmaWVsZCwgdmFsdWU6ICcnLCBsYnJhY2tldDogJycsIHJicmFja2V0OiAnKScsIHJlbGF0aW9uOiAxLCBjb21wYXJlOiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iajIuY29tcGFyZSA9IG9wMiA9PT0gMTAwMSA/IENvbXBhcmUuRXF1YWwgOiBDb21wYXJlLk5vdEVxdWFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLnZhbHVlID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnIucHVzaChvYmoyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZmlsdGVyQXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRW51bVR5cGVGaWx0ZXJzKGZpbHRlckFycik7XHJcbiAgICAgICAgICAgIGZpbHRlckFycltmaWx0ZXJBcnIubGVuZ3RoIC0gMV0ucmVsYXRpb24gPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZpbHRlckFycjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrRW51bVR5cGVGaWx0ZXJzKGZpbHRlckFycjogRmlsdGVyQ29uZGl0aW9uW10pIHtcclxuICAgICAgICBjb25zdCBlbnVtRmlsdGVyczp7W2tleTpzdHJpbmddOiBhbnlbXX0gPSB7IH07XHJcbiAgICAgICAgZmlsdGVyQXJyLmZvckVhY2goKGYsIGkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZW51bUZpbHRlckFyciA9IHRoaXMuY29udmVydEVudW1UeXBlRmlsdGVyKGYpO1xyXG4gICAgICAgICAgICBpZiAoZW51bUZpbHRlckFyciAmJiBlbnVtRmlsdGVyQXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgZW51bUZpbHRlcnNbZi5maWx0ZXJGaWVsZF0gPSBlbnVtRmlsdGVyQXJyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGVudW1GaWx0ZXJzKTtcclxuICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKChrKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZmlsdGVyQXJyLmZpbmRJbmRleChuID0+IG4uZmlsdGVyRmllbGQgPT09IGspO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyQXJyLnNwbGljZShpLCAxLCAuLi5lbnVtRmlsdGVyc1trXSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmlsdGVyQXJyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWwhmVudW0g57G75Z6L55qE5p2h5Lu26L2s5o2i5aSa5Liq5p2h5Lu2XHJcbiAgICBwcml2YXRlIGNvbnZlcnRFbnVtVHlwZUZpbHRlcihmaWx0ZXI6IEZpbHRlckNvbmRpdGlvbikgOiBGaWx0ZXJDb25kaXRpb25bXSB7XHJcbiAgICAgICAgaWYgKGZpbHRlcikge1xyXG4gICAgICAgICAgICBjb25zdCBjb2wgPSB0aGlzLmRmcy5nZXRDb2x1bW4oZmlsdGVyLmZpbHRlckZpZWxkKSBhcyBEYXRhQ29sdW1uO1xyXG4gICAgICAgICAgICBpZiAoY29sICYmIGNvbC5maWx0ZXIgJiYgY29sLmZpbHRlci50eXBlID09PSAgQ29sdW1uRmlsdGVyVHlwZS5lbnVtKSAge1xyXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyLnZhbHVlKSAmJiBmaWx0ZXIudmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlci52YWx1ZS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyLmNvbXBhcmUgPSBDb21wYXJlLkVxdWFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIudmFsdWUgPSBmaWx0ZXIudmFsdWVbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA+IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlckFyciA9IGZpbHRlci52YWx1ZS5tYXAoKHZhbDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckZpZWxkOiBmaWx0ZXIuZmlsdGVyRmllbGQsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWwsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxicmFja2V0OiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYnJhY2tldDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpb246IDIsICAvLyBvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmU6IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckFyclswXS5sYnJhY2tldCA9ICcoJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQXJyW2ZpbHRlci52YWx1ZS5sZW5ndGggLTFdLnJicmFja2V0ID0gJyknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnJbZmlsdGVyLnZhbHVlLmxlbmd0aCAtMV0ucmVsYXRpb24gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyQXJyO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUNvbHVtbkZpbHRlck9wdGlvbnMoY29sOiBEYXRhQ29sdW1uKSB7XHJcbiAgICAgICAgbGV0IGZpbHRlclR5cGVPcHRpb25zOiBDb2x1bW5GaWx0ZXIgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuc3RyaW5nLFxyXG4gICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGNvbC5lZGl0b3IpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChjb2wuZWRpdG9yLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RleHRhcmVhJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RleHRib3gnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGFuZ3VhZ2UtdGV4dGJveCc6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdzd2l0Y2gnOlxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBDb2x1bW5GaWx0ZXJUeXBlLmJvb2xlYW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdudW1iZXJib3gnOlxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBDb2x1bW5GaWx0ZXJUeXBlLm51bWJlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY29tYm9saXN0JzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuZW51bSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGNvbC5lZGl0b3Iub3B0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkYXRlcGlja2VyJzpcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogY29sWydkYXRhVHlwZSddID09PSAnZGF0ZXRpbWUnID8gQ29sdW1uRmlsdGVyVHlwZS5kYXRldGltZSA6IENvbHVtbkZpbHRlclR5cGUuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQ6IGNvbC5lZGl0b3Iub3B0aW9ucy5kYXRlRm9ybWF0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRm9ybWF0OiBjb2wuZWRpdG9yLm9wdGlvbnMucmV0dXJuRm9ybWF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndGltZXBpY2tlcic6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUudGltZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY29sLmZvcm1hdHRlcikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbC5mb3JtYXR0ZXIgPT09ICdvYmplY3QnICYmIE9iamVjdC5rZXlzKGNvbC5mb3JtYXR0ZXIpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uczogYW55ID0gY29sLmZvcm1hdHRlclsnb3B0aW9ucyddO1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChjb2wuZm9ybWF0dGVyWyd0eXBlJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUubnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW51bSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5lbnVtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuYm9vbGVhbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRldGltZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0eWUgPSBDb2x1bW5GaWx0ZXJUeXBlLmRhdGV0aW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm10ID0gJ3l5eXktTU0tZGQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmV0dXJuRm10ID0gJ3l5eXktTU0tZGQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm10ID0gb3B0aW9ucy5mb3JtYXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm10LmluZGV4T2YoJ0hIOicpID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHllID0gQ29sdW1uRmlsdGVyVHlwZS5kYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5GbXQgKz0gJyBISDptbSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZtdC5pbmRleE9mKCdzcycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRm10ICs9ICc6c3MnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5ZSA9IENvbHVtbkZpbHRlclR5cGUuZGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucy5vcHRpb25zID0geyBkYXRlRm9ybWF0OiBmbXQsIHJldHVybkZvcm1hdDogcmV0dXJuRm10IH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5zdHJpbmcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDb2x1bW5GaWx0ZXJUeXBlLnN0cmluZyxcclxuICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiB0cnVlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmaWx0ZXJUeXBlT3B0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvLyNyZWdpb24gIFNtYXJ0IEZpbHRlclxyXG5cclxuICAgIGNvbnZlcnRTbWFydEZpbHRlcjJFbnRpdHlGaWx0ZXIoY29uZGl0aW9uczogYW55W10pIHtcclxuICAgICAgICBpZiAoY29uZGl0aW9ucyAmJiBjb25kaXRpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY29uZGl0aW9ucy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZVJvd0RhdGEyKHJvd0RhdGE6IGFueSwgY29uZGl0aW9uczogYW55KSB7XHJcbiAgICAgICAgaWYgKCFjb25kaXRpb25zIHx8IGNvbmRpdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja1Jvd0RhdGFXaXRoQ29uZGl0aW9uKHJvd0RhdGEsIGNvbmRpdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tSb3dEYXRhV2l0aENvbmRpdGlvbihyb3dEYXRhOiBhbnksIGNvbmRpdGlvbnMpIHtcclxuICAgICAgICBsZXQgcmVzdWx0T2JqID0gbnVsbDtcclxuICAgICAgICBpZiAoY29uZGl0aW9ucykge1xyXG4gICAgICAgICAgICByZXN1bHRPYmogPSB7fTtcclxuICAgICAgICAgICAgY29uZGl0aW9ucy5mb3JFYWNoKGNvbmRpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IGNvbmRpdGlvbi5GaWx0ZXJGaWVsZDtcclxuICAgICAgICAgICAgICAgIGxldCBmaWVsZFZhbHVlID0gVXRpbHMuZ2V0VmFsdWUoZmllbGQsIHJvd0RhdGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29sdW1uT2JqID0gdGhpcy5kZnMuZ2V0Q29sdW1uKGZpZWxkKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5PYmogJiYgY29sdW1uT2JqLmlzTXVsdGlsaW5ndWFsRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZFZhbHVlID0gVXRpbHMuZ2V0TXVsdGlsaW5ndWFsVmFsdWUoZmllbGRWYWx1ZSwgdGhpcy5sb2NhbGVTZXIubG9jYWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHdoZXJlID0gY29uZGl0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBWYWx1ZSwgUmVsYXRpb24sIENvbXBhcmU6IG9wZXJhdG9yMSB9ID0gd2hlcmU7XHJcbiAgICAgICAgICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5nZXRDb21wYXJlUmVzdWx0KGZpZWxkVmFsdWUsIG9wZXJhdG9yMSwgVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRPYmpbZmllbGRdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0T2JqW2ZpZWxkXSA9IFsgciBdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE9ialtmaWVsZF0ucHVzaChyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHJldHVybiB0aGlzLmNoZWNrQWxsRmllbGRSZXN1bHQocmVzdWx0T2JqKTtcclxuICAgICAgICBjb25zdCBmaWVsZHMgPSBPYmplY3Qua2V5cyhyZXN1bHRPYmopO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKCAoZikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBfZmlsdGVycyA9IGNvbmRpdGlvbnMuZmlsdGVyKG4gPT4gbi5GaWx0ZXJGaWVsZCA9PT0gZik7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRPYmpbZl0ubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyZXN1bHRPYmpbZl1bMF0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKF9maWx0ZXJzWzBdLlJlbGF0aW9uID09PSAxICYmIHJlc3VsdE9ialtmXS5sZW5ndGggPT09IDIpIHsgIC8vIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJlc3VsdE9ialtmXVswXSAmJiByZXN1bHRPYmpbZl1bMV0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgIC8vIG9yXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocmVzdWx0T2JqW2ZdLmluZGV4T2YodHJ1ZSkgPiAtMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5pbmRleE9mKGZhbHNlKSA9PT0gLTE7XHJcbiAgICB9XHJcblxyXG4gICAgZXhlY3V0ZVNtYXJ0RmlsdGVyKGRhdGE6IFtdLCBjb25kaXRpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZpbHRlcihuID0+IHRoaXMudmFsaWRhdGVSb3dEYXRhMihuLCBjb25kaXRpb25zKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG59XHJcbiJdfQ==