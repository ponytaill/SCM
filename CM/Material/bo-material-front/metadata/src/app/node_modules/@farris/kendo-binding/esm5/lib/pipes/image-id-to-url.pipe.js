import { Injector, Optional, Pipe } from '@angular/core';
import { DownloadService } from '@gsp-svc/formdoc-upload';
var ImageIdToUrlPipe = /** @class */ (function () {
    function ImageIdToUrlPipe(injector) {
        this.injector = injector;
        this.defaultPic = '/platform/common/web/assets/imgs/no-pic.png';
        this.downloadService = this.injector && this.injector.get(DownloadService, null) || null;
    }
    ImageIdToUrlPipe.prototype.transform = function (value, rootId) {
        if (rootId === void 0) { rootId = 'default-root'; }
        if (!value) {
            return this.defaultPic;
        }
        //const rootId = 'default-root';
        if (this.downloadService) {
            return this.downloadService.getDownloadUrl(value, rootId);
        }
        else {
            console.warn('因安全问题，附件下载提供安全校验机制，附件下载功能需重新编译。');
            return "/api/runtime/dfs/v1.0/formdoc/download/" + value;
        }
    };
    ImageIdToUrlPipe.decorators = [
        { type: Pipe, args: [{ name: 'imageIdToUrl' },] }
    ];
    /** @nocollapse */
    ImageIdToUrlPipe.ctorParameters = function () { return [
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    return ImageIdToUrlPipe;
}());
export { ImageIdToUrlPipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UtaWQtdG8tdXJsLnBpcGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2tlbmRvLWJpbmRpbmcvIiwic291cmNlcyI6WyJsaWIvcGlwZXMvaW1hZ2UtaWQtdG8tdXJsLnBpcGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQUN4RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDMUQ7SUFJRSwwQkFBZ0MsUUFBa0I7UUFBbEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUYxQyxlQUFVLEdBQUcsNkNBQTZDLENBQUM7UUFHakUsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFrQixlQUFlLEVBQUUsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDO0lBQzVHLENBQUM7SUFFRCxvQ0FBUyxHQUFULFVBQVUsS0FBYSxFQUFFLE1BQStCO1FBQS9CLHVCQUFBLEVBQUEsdUJBQStCO1FBQ3RELElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDVixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7U0FDeEI7UUFDRCxnQ0FBZ0M7UUFDaEMsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3hCLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQzNEO2FBQU07WUFDTCxPQUFPLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxDQUFDLENBQUM7WUFDaEQsT0FBTyw0Q0FBMEMsS0FBTyxDQUFDO1NBQzFEO0lBQ0gsQ0FBQzs7Z0JBbkJGLElBQUksU0FBQyxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUU7Ozs7Z0JBRnJCLFFBQVEsdUJBTUYsUUFBUTs7SUFnQnZCLHVCQUFDO0NBQUEsQUFwQkQsSUFvQkM7QUFFRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdG9yLCBPcHRpb25hbCwgUGlwZSwgUGlwZVRyYW5zZm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEb3dubG9hZFNlcnZpY2UgfSBmcm9tICdAZ3NwLXN2Yy9mb3JtZG9jLXVwbG9hZCc7XHJcbkBQaXBlKHsgbmFtZTogJ2ltYWdlSWRUb1VybCcgfSlcclxuY2xhc3MgSW1hZ2VJZFRvVXJsUGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xyXG4gIHByaXZhdGUgZGVmYXVsdFBpYyA9ICcvcGxhdGZvcm0vY29tbW9uL3dlYi9hc3NldHMvaW1ncy9uby1waWMucG5nJztcclxuICBwcml2YXRlIGRvd25sb2FkU2VydmljZTogRG93bmxvYWRTZXJ2aWNlO1xyXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgICB0aGlzLmRvd25sb2FkU2VydmljZSA9IHRoaXMuaW5qZWN0b3IgJiYgdGhpcy5pbmplY3Rvci5nZXQ8RG93bmxvYWRTZXJ2aWNlPihEb3dubG9hZFNlcnZpY2UsIG51bGwpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICB0cmFuc2Zvcm0odmFsdWU6IHN0cmluZywgcm9vdElkOiBzdHJpbmcgPSAnZGVmYXVsdC1yb290Jyk6IHN0cmluZyB7XHJcbiAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRQaWM7XHJcbiAgICB9XHJcbiAgICAvL2NvbnN0IHJvb3RJZCA9ICdkZWZhdWx0LXJvb3QnO1xyXG4gICAgaWYgKHRoaXMuZG93bmxvYWRTZXJ2aWNlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmRvd25sb2FkU2VydmljZS5nZXREb3dubG9hZFVybCh2YWx1ZSwgcm9vdElkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUud2Fybign5Zug5a6J5YWo6Zeu6aKY77yM6ZmE5Lu25LiL6L295o+Q5L6b5a6J5YWo5qCh6aqM5py65Yi277yM6ZmE5Lu25LiL6L295Yqf6IO96ZyA6YeN5paw57yW6K+R44CCJyk7XHJcbiAgICAgIHJldHVybiBgL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvZG93bmxvYWQvJHt2YWx1ZX1gO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgSW1hZ2VJZFRvVXJsUGlwZSB9O1xyXG4iXX0=