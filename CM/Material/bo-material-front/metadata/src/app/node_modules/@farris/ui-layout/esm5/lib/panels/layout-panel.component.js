/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ElementRef, Renderer2, ViewChild, Output, EventEmitter, NgZone } from '@angular/core';
import { AngularResizableDirective } from '@farris/ui-draggable';
import { LayoutComponent } from './../layout.component';
var LayoutPanelComponent = /** @class */ (function () {
    function LayoutPanelComponent(el, render2, layout, ngZone) {
        this.el = el;
        this.render2 = render2;
        this.layout = layout;
        this.ngZone = ngZone;
        this.minHeight = 50;
        this.minWidth = 50;
        this.title = '';
        this.iconCls = '';
        this._resizable = true;
        this.bsColClass = '';
        this.showBorder = true;
        this.resizing = new EventEmitter();
        this.resized = new EventEmitter();
    }
    Object.defineProperty(LayoutPanelComponent.prototype, "split", {
        get: /**
         * @return {?}
         */
        function () {
            return this._resizable;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._resizable = val;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.setStyles = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var width;
            /** @type {?} */
            var height;
            /** @type {?} */
            var rect = _this.el.nativeElement.getBoundingClientRect();
            if (_this.height) {
                height = _this.height;
                _this.render2.setStyle(_this.el.nativeElement, 'height', height + 'px');
                _this.render2.setStyle(_this.panel.nativeElement, 'height', height + 'px');
            }
            if (_this.width) {
                width = _this.width;
                if (rect.width > _this.width) {
                    width = rect.width;
                    _this.width = width;
                }
                _this.render2.setStyle(_this.el.nativeElement, 'width', width + 'px');
                _this.render2.setStyle(_this.panel.nativeElement, 'width', width + 'px');
                _this.resetFlex();
            }
        }));
        // });
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.getrzHandler = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.region) {
            /** @type {?} */
            var rzdir = '';
            switch (this.region) {
                case 'west':
                    rzdir = 'e';
                    break;
                case 'east':
                    rzdir = 'w';
                    break;
                case 'north':
                    rzdir = 's';
                    break;
                case 'south':
                    rzdir = 'n';
                    break;
            }
            this.rzHandler = rzdir;
        }
        else {
            this.rzHandler = '';
        }
    };
    /**
     * @return {?}
     */
    LayoutPanelComponent.prototype.isCenterPanel = /**
     * @return {?}
     */
    function () {
        return this.region === 'center';
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    LayoutPanelComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.width && !changes.width.isFirstChange()) {
            this.setStyles();
        }
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.getBsClass = /**
     * @private
     * @return {?}
     */
    function () {
        return Array.from(this.el.nativeElement.classList).find((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.indexOf('col-') > -1; }));
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.hasBsClass = /**
     * @private
     * @return {?}
     */
    function () {
        return this.getBsClass() !== undefined;
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.initSize = /**
     * @private
     * @return {?}
     */
    function () {
        this.setStyles();
        if (this.region) {
            if (this.region === 'west' || this.region === 'east') {
                this.render2.setStyle(this.panel.nativeElement, 'height', '100%');
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.initClass = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.isCenterPanel()) {
            this.render2.addClass(this.panel.nativeElement, 'flex-fill');
            if (this.el.nativeElement.parentElement.attributes['layout-panel']) {
                this.render2.addClass(this.el.nativeElement.parentElement, 'd-flex');
            }
            this.render2.addClass(this.el.nativeElement, 'd-flex');
            this.render2.addClass(this.el.nativeElement, 'flex-fill');
        }
        if (this.showBorder) {
            this.render2.addClass(this.panel.nativeElement, 'layout-border');
        }
    };
    /**
     * @return {?}
     */
    LayoutPanelComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.initSize();
        this.initClass();
        this.getrzHandler();
        this.bsColClass = this.getBsClass();
        this.layout.panels.push(this);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LayoutPanelComponent.prototype.onResizeStart = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.resetFlex();
    };
    /**
     * @private
     * @return {?}
     */
    LayoutPanelComponent.prototype.resetFlex = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.region === 'west' || this.region === 'east') {
            this.render2.setStyle(this.el.nativeElement, 'flex', 'none');
            this.render2.setStyle(this.el.nativeElement, 'max-width', 'none');
        }
    };
    /**
     * @param {?} size
     * @return {?}
     */
    LayoutPanelComponent.prototype.resize = /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        this.setStyles();
        this.onResized({ size: size });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LayoutPanelComponent.prototype.onReizing = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.updatePanelSize($event);
        // console.log($event);
        this.resizing.emit({ target: this, size: $event.size });
    };
    /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    LayoutPanelComponent.prototype.updatePanelSize = /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.region === 'south') {
            this.render2.setStyle(this.panel.nativeElement, 'top', 0);
        }
        if (this.region === 'east') {
            this.render2.setStyle(this.panel.nativeElement, 'left', 0);
        }
        if (this.region === 'south' || this.region === 'north') {
            this.render2.setStyle(this.el.nativeElement, 'height', $event.size.height + 'px');
        }
        if (this.region === 'west' || this.region === 'east') {
            this.render2.setStyle(this.el.nativeElement, 'width', $event.size.width + 'px');
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LayoutPanelComponent.prototype.onResized = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.region === 'south' || this.region === 'north') {
            this.height = $event.size.height;
        }
        if (this.region === 'west' || this.region === 'east') {
            this.width = $event.size.width;
        }
        this.updatePanelSize($event);
        this.layout.setPanelMaxSize();
        this.resized.emit($event.size);
        this.layout.getPanel('center').resized.emit($event.size);
    };
    LayoutPanelComponent.decorators = [
        { type: Component, args: [{
                    selector: 'layout-panel',
                    template: "\n        <div #panel #ngResizable class=\"layout-panel\"\n            [ngResizable]=\"split\" [attr.region]=\"region\"\n            [rzHandles]=\"rzHandler\"\n            [rzMinWidth]=\"minWidth\"\n            [rzMaxWidth]=\"maxWidth\"\n            [rzMinHeight]=\"minHeight\"\n            [rzMaxHeight]=\"maxHeight\"\n            (rzResizing)=\"onReizing($event)\"\n            (rzStop) = \"onResized($event)\"\n            (rzStart) =\"onResizeStart($event)\" >\n\n            <layout-panel-title *ngIf=\"title\" [title]=\"title\"></layout-panel-title>\n\n            <ng-content></ng-content>\n        <div>\n    ",
                    styles: [".layout-border{border:1px solid #f2f2f2}.layout-panel{background:#fff}.ng-resizeable-bar{position:relative}.ng-resizable-w>.ng-resizeable-bar{right:1px;height:100%;width:5px}.ng-resizable-e>.ng-resizeable-bar{left:3px;height:100%;width:5px}.ng-resizable-s>.ng-resizeable-bar{top:3px;width:100%;height:5px}.ng-resizable-n>.ng-resizeable-bar{bottom:0;width:100%;height:5px}.ng-resizable-handle:hover>.ng-resizeable-bar{background-color:#bababa}.ng-resizable-handle:active>.ng-resizeable-bar{background-color:#5b5b5b}:host{padding:0}"]
                }] }
    ];
    /** @nocollapse */
    LayoutPanelComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: LayoutComponent },
        { type: NgZone }
    ]; };
    LayoutPanelComponent.propDecorators = {
        region: [{ type: Input }],
        height: [{ type: Input }],
        width: [{ type: Input }],
        minHeight: [{ type: Input }],
        minWidth: [{ type: Input }],
        maxHeight: [{ type: Input }],
        maxWidth: [{ type: Input }],
        title: [{ type: Input }],
        iconCls: [{ type: Input }],
        split: [{ type: Input }],
        showBorder: [{ type: Input }],
        resizing: [{ type: Output }],
        resized: [{ type: Output }],
        panel: [{ type: ViewChild, args: ['panel',] }],
        ngResizable: [{ type: ViewChild, args: [AngularResizableDirective,] }]
    };
    return LayoutPanelComponent;
}());
export { LayoutPanelComponent };
if (false) {
    /** @type {?} */
    LayoutPanelComponent.prototype.region;
    /** @type {?} */
    LayoutPanelComponent.prototype.height;
    /** @type {?} */
    LayoutPanelComponent.prototype.width;
    /** @type {?} */
    LayoutPanelComponent.prototype.minHeight;
    /** @type {?} */
    LayoutPanelComponent.prototype.minWidth;
    /** @type {?} */
    LayoutPanelComponent.prototype.maxHeight;
    /** @type {?} */
    LayoutPanelComponent.prototype.maxWidth;
    /** @type {?} */
    LayoutPanelComponent.prototype.title;
    /** @type {?} */
    LayoutPanelComponent.prototype.iconCls;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype._resizable;
    /** @type {?} */
    LayoutPanelComponent.prototype.rzHandler;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.bsColClass;
    /** @type {?} */
    LayoutPanelComponent.prototype.showBorder;
    /** @type {?} */
    LayoutPanelComponent.prototype.resizing;
    /** @type {?} */
    LayoutPanelComponent.prototype.resized;
    /** @type {?} */
    LayoutPanelComponent.prototype.panel;
    /** @type {?} */
    LayoutPanelComponent.prototype.ngResizable;
    /** @type {?} */
    LayoutPanelComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.render2;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.layout;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.ngZone;
}
var LayoutPanelTitleComponent = /** @class */ (function () {
    function LayoutPanelTitleComponent() {
        this.title = '';
        this.iconCls = '';
    }
    LayoutPanelTitleComponent.decorators = [
        { type: Component, args: [{
                    selector: 'layout-panel-title',
                    template: "\n        <div class=\"d-flex flex-row\" style=\"height: 28px; line-height: 28px\">\n            <div class=\"layout-panel-title\">\n                <span *ngIf=\"iconCls\" [class]=\"iconCls\"></span>\n                {{ title }}\n            </div>\n            <div class=\"layout-panel-title-tools flex-fill\">\n\n            </div>\n        </div>\n    "
                }] }
    ];
    LayoutPanelTitleComponent.propDecorators = {
        title: [{ type: Input }],
        iconCls: [{ type: Input }]
    };
    return LayoutPanelTitleComponent;
}());
export { LayoutPanelTitleComponent };
if (false) {
    /** @type {?} */
    LayoutPanelTitleComponent.prototype.title;
    /** @type {?} */
    LayoutPanelTitleComponent.prototype.iconCls;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbGF5b3V0LyIsInNvdXJjZXMiOlsibGliL3BhbmVscy9sYXlvdXQtcGFuZWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFDMUQsTUFBTSxFQUFFLFlBQVksRUFBZ0QsTUFBTSxFQUM3RSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFeEQ7SUEwR0ksOEJBQW1CLEVBQWMsRUFBVSxPQUFrQixFQUFVLE1BQXVCLEVBQVUsTUFBYztRQUFuRyxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsWUFBTyxHQUFQLE9BQU8sQ0FBVztRQUFVLFdBQU0sR0FBTixNQUFNLENBQWlCO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQWpGN0csY0FBUyxHQUFHLEVBQUUsQ0FBQztRQUNmLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFHZCxVQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ1gsWUFBTyxHQUFHLEVBQUUsQ0FBQztRQUVkLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFFbEIsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQVVmLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFFakIsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDOUIsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUEyRG1GLENBQUM7SUF2RTNILHNCQUFhLHVDQUFLOzs7O1FBQWxCO1lBQ0ksT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQzNCLENBQUM7Ozs7O1FBRUQsVUFBVSxHQUFZO1lBQ2xCLElBQUksQ0FBQyxVQUFVLEdBQUcs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O0lBQzFCLHFDQUFvQjs7SUFDcEIsdUNBQXNCOzs7OztJQUV0QiwwQ0FBMEI7O0lBQzFCLHlDQUFrQjs7Ozs7SUFDbEIsMENBQXdCOztJQVV4QiwwQ0FBMkI7O0lBRTNCLHdDQUF3Qzs7SUFDeEMsdUNBQXVDOztJQUV2QyxxQ0FBc0M7O0lBQ3RDLDJDQUE2RTs7SUF3RGpFLGtDQUFxQjs7Ozs7SUFBRSx1Q0FBMEI7Ozs7O0lBQUUsc0NBQStCOzs7OztJQUFFLHNDQUFzQjs7QUF5RzFIO0lBQUE7UUFlYSxVQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ1gsWUFBTyxHQUFHLEVBQUUsQ0FBQztJQUMxQixDQUFDOztnQkFqQkEsU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxvQkFBb0I7b0JBQzlCLFFBQVEsRUFBRSx1V0FVVDtpQkFDSjs7O3dCQUVJLEtBQUs7MEJBQ0wsS0FBSzs7SUFDVixnQ0FBQztDQUFBLEFBakJELElBaUJDO1NBSFkseUJBQXlCOzs7SUFDbEMsMENBQW9COztJQUNwQiw0Q0FBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBFbGVtZW50UmVmLCBSZW5kZXJlcjIsIFZpZXdDaGlsZCxcclxuICAgIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3QsIGZvcndhcmRSZWYsIFNpbXBsZUNoYW5nZXMsIE9uQ2hhbmdlcywgTmdab25lXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFuZ3VsYXJSZXNpemFibGVEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyYWdnYWJsZSc7XHJcbmltcG9ydCB7IExheW91dENvbXBvbmVudCB9IGZyb20gJy4vLi4vbGF5b3V0LmNvbXBvbmVudCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbGF5b3V0LXBhbmVsJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICAgICAgPGRpdiAjcGFuZWwgI25nUmVzaXphYmxlIGNsYXNzPVwibGF5b3V0LXBhbmVsXCJcclxuICAgICAgICAgICAgW25nUmVzaXphYmxlXT1cInNwbGl0XCIgW2F0dHIucmVnaW9uXT1cInJlZ2lvblwiXHJcbiAgICAgICAgICAgIFtyekhhbmRsZXNdPVwicnpIYW5kbGVyXCJcclxuICAgICAgICAgICAgW3J6TWluV2lkdGhdPVwibWluV2lkdGhcIlxyXG4gICAgICAgICAgICBbcnpNYXhXaWR0aF09XCJtYXhXaWR0aFwiXHJcbiAgICAgICAgICAgIFtyek1pbkhlaWdodF09XCJtaW5IZWlnaHRcIlxyXG4gICAgICAgICAgICBbcnpNYXhIZWlnaHRdPVwibWF4SGVpZ2h0XCJcclxuICAgICAgICAgICAgKHJ6UmVzaXppbmcpPVwib25SZWl6aW5nKCRldmVudClcIlxyXG4gICAgICAgICAgICAocnpTdG9wKSA9IFwib25SZXNpemVkKCRldmVudClcIlxyXG4gICAgICAgICAgICAocnpTdGFydCkgPVwib25SZXNpemVTdGFydCgkZXZlbnQpXCIgPlxyXG5cclxuICAgICAgICAgICAgPGxheW91dC1wYW5lbC10aXRsZSAqbmdJZj1cInRpdGxlXCIgW3RpdGxlXT1cInRpdGxlXCI+PC9sYXlvdXQtcGFuZWwtdGl0bGU+XHJcblxyXG4gICAgICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcbiAgICAgICAgPGRpdj5cclxuICAgIGAsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9sYXlvdXQtcGFuZWwuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIExheW91dFBhbmVsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gICAgQElucHV0KCkgcmVnaW9uOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBoZWlnaHQ6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIHdpZHRoOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBtaW5IZWlnaHQgPSA1MDtcclxuICAgIEBJbnB1dCgpIG1pbldpZHRoID0gNTA7XHJcbiAgICBASW5wdXQoKSBtYXhIZWlnaHQ6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIG1heFdpZHRoOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSB0aXRsZSA9ICcnO1xyXG4gICAgQElucHV0KCkgaWNvbkNscyA9ICcnO1xyXG5cclxuICAgIHByaXZhdGUgX3Jlc2l6YWJsZSA9IHRydWU7XHJcbiAgICByekhhbmRsZXI6IHN0cmluZztcclxuICAgIHByaXZhdGUgYnNDb2xDbGFzcyA9ICcnO1xyXG4gICAgQElucHV0KCkgZ2V0IHNwbGl0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNpemFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHNwbGl0KHZhbDogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3Jlc2l6YWJsZSA9IHZhbDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgQElucHV0KCkgc2hvd0JvcmRlciA9IHRydWU7XHJcblxyXG4gICAgQE91dHB1dCgpIHJlc2l6aW5nID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgncGFuZWwnKSBwYW5lbDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoQW5ndWxhclJlc2l6YWJsZURpcmVjdGl2ZSkgbmdSZXNpemFibGU6IEFuZ3VsYXJSZXNpemFibGVEaXJlY3RpdmU7XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRTdHlsZXMoKSB7XHJcbiAgICAgICAgLy8gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB3aWR0aCwgaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMucGFuZWwubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsIGhlaWdodCArICdweCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlY3Qud2lkdGggPiB0aGlzLndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcmVjdC53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCB3aWR0aCArICdweCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLnBhbmVsLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHdpZHRoICsgJ3B4Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGbGV4KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0cnpIYW5kbGVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbikge1xyXG4gICAgICAgICAgICBsZXQgcnpkaXIgPSAnJztcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnJlZ2lvbikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnd2VzdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcnpkaXIgPSAnZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdlYXN0JzpcclxuICAgICAgICAgICAgICAgICAgICByemRpciA9ICd3JztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ25vcnRoJzpcclxuICAgICAgICAgICAgICAgICAgICByemRpciA9ICdzJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3NvdXRoJzpcclxuICAgICAgICAgICAgICAgICAgICByemRpciA9ICduJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5yekhhbmRsZXIgPSByemRpcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJ6SGFuZGxlciA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpc0NlbnRlclBhbmVsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lvbiA9PT0gJ2NlbnRlcic7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIHJlbmRlcjI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBsYXlvdXQ6IExheW91dENvbXBvbmVudCwgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSkgeyB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLndpZHRoICYmICFjaGFuZ2VzLndpZHRoLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0eWxlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEJzQ2xhc3MoKSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb208c3RyaW5nPih0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0KS5maW5kKChjOiBzdHJpbmcpID0+IGMuaW5kZXhPZignY29sLScpID4gLTEpO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBoYXNCc0NsYXNzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEJzQ2xhc3MoKSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdFNpemUoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdHlsZXMoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVnaW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3dlc3QnIHx8IHRoaXMucmVnaW9uID09PSAnZWFzdCcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLnBhbmVsLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCAnMTAwJScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdENsYXNzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2VudGVyUGFuZWwoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuYWRkQ2xhc3ModGhpcy5wYW5lbC5uYXRpdmVFbGVtZW50LCAnZmxleC1maWxsJyk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudC5hdHRyaWJ1dGVzWydsYXlvdXQtcGFuZWwnXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudC5wYXJlbnRFbGVtZW50LCAnZC1mbGV4Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdkLWZsZXgnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2ZsZXgtZmlsbCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuYWRkQ2xhc3ModGhpcy5wYW5lbC5uYXRpdmVFbGVtZW50LCAnbGF5b3V0LWJvcmRlcicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLmluaXRTaXplKCk7XHJcbiAgICAgICAgdGhpcy5pbml0Q2xhc3MoKTtcclxuICAgICAgICB0aGlzLmdldHJ6SGFuZGxlcigpO1xyXG5cclxuICAgICAgICB0aGlzLmJzQ29sQ2xhc3MgPSB0aGlzLmdldEJzQ2xhc3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5sYXlvdXQucGFuZWxzLnB1c2godGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemVTdGFydCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMucmVzZXRGbGV4KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZXNldEZsZXgoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucmVnaW9uID09PSAnd2VzdCcgfHwgdGhpcy5yZWdpb24gPT09ICdlYXN0Jykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZmxleCcsICdub25lJyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdtYXgtd2lkdGgnLCAnbm9uZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXNpemUoc2l6ZTogeyB3aWR0aD86IG51bWJlciwgaGVpZ2h0PzogbnVtYmVyIH0pIHtcclxuICAgICAgICB0aGlzLnNldFN0eWxlcygpO1xyXG4gICAgICAgIHRoaXMub25SZXNpemVkKHsgc2l6ZSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvblJlaXppbmcoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsU2l6ZSgkZXZlbnQpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCRldmVudCk7XHJcbiAgICAgICAgdGhpcy5yZXNpemluZy5lbWl0KHsgdGFyZ2V0OiB0aGlzLCBzaXplOiAkZXZlbnQuc2l6ZSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVBhbmVsU2l6ZSgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3NvdXRoJykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5wYW5lbC5uYXRpdmVFbGVtZW50LCAndG9wJywgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ2Vhc3QnKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLnBhbmVsLm5hdGl2ZUVsZW1lbnQsICdsZWZ0JywgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3NvdXRoJyB8fCB0aGlzLnJlZ2lvbiA9PT0gJ25vcnRoJykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgJGV2ZW50LnNpemUuaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3dlc3QnIHx8IHRoaXMucmVnaW9uID09PSAnZWFzdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ3dpZHRoJywgJGV2ZW50LnNpemUud2lkdGggKyAncHgnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemVkKCRldmVudDogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMucmVnaW9uID09PSAnc291dGgnIHx8IHRoaXMucmVnaW9uID09PSAnbm9ydGgnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gJGV2ZW50LnNpemUuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVnaW9uID09PSAnd2VzdCcgfHwgdGhpcy5yZWdpb24gPT09ICdlYXN0Jykge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gJGV2ZW50LnNpemUud2lkdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsU2l6ZSgkZXZlbnQpO1xyXG5cclxuICAgICAgICB0aGlzLmxheW91dC5zZXRQYW5lbE1heFNpemUoKTtcclxuICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdCgkZXZlbnQuc2l6ZSk7XHJcbiAgICAgICAgdGhpcy5sYXlvdXQuZ2V0UGFuZWwoJ2NlbnRlcicpLnJlc2l6ZWQuZW1pdCgkZXZlbnQuc2l6ZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsYXlvdXQtcGFuZWwtdGl0bGUnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwiZC1mbGV4IGZsZXgtcm93XCIgc3R5bGU9XCJoZWlnaHQ6IDI4cHg7IGxpbmUtaGVpZ2h0OiAyOHB4XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsYXlvdXQtcGFuZWwtdGl0bGVcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiaWNvbkNsc1wiIFtjbGFzc109XCJpY29uQ2xzXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAge3sgdGl0bGUgfX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsYXlvdXQtcGFuZWwtdGl0bGUtdG9vbHMgZmxleC1maWxsXCI+XHJcblxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIGBcclxufSlcclxuZXhwb3J0IGNsYXNzIExheW91dFBhbmVsVGl0bGVDb21wb25lbnQge1xyXG4gICAgQElucHV0KCkgdGl0bGUgPSAnJztcclxuICAgIEBJbnB1dCgpIGljb25DbHMgPSAnJztcclxufVxyXG4iXX0=