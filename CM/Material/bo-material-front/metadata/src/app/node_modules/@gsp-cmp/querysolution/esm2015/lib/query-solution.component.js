/**
 * @fileoverview added by tsickle
 * Generated from: lib/query-solution.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ViewEncapsulation, HostBinding, ComponentFactoryResolver, Injector, Input, Output, EventEmitter, ViewChild, InjectFlags, ElementRef, ChangeDetectorRef } from '@angular/core';
import { SaveAsDialogComponent } from './saveasdialog/saveasdialog.component';
import { SolutionManangerComponent } from './solutionmanager/solutionmanager.component';
import { Observable } from 'rxjs/Observable';
import { ConvertorService, QueryConditionComponent, QuerySolutionVo } from '@farris/component-querycondition';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { HttpService } from './service/httpservice';
import { FieldConfigService } from './service/fieldconfig.service';
import { QuerySolutionVoConvertor, SolutionService } from '@farris/component-querycondition';
import { QUERYSOLUTION_HANDLER_TOKEN } from './interface/IQuerySolutionHandler';
import { LocaleService } from '@farris/ui-locale';
import { cloneDeep } from 'lodash-es';
import { SolutionCacheService } from './service/solution.cache.service';
import { EventManager } from '@angular/platform-browser';
import { IdService } from '@farris/ui-common';
export class QuerySolutionComponent {
    /**
     * @param {?} notify
     * @param {?} resolver
     * @param {?} injector
     * @param {?} modalService
     * @param {?} convertService
     * @param {?} solutionService
     * @param {?} httpService
     * @param {?} fieldConfigService
     * @param {?} localeService
     */
    constructor(notify, resolver, injector, modalService, convertService, solutionService, httpService, fieldConfigService, localeService) {
        this.notify = notify;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.convertService = convertService;
        this.solutionService = solutionService;
        this.httpService = httpService;
        this.fieldConfigService = fieldConfigService;
        this.localeService = localeService;
        this._fieldConfigs = [];
        this._presetFieldConfigs = [];
        this._resetFieldConfigs = [];
        /**
         * 此值由设计器传入
         * 组件在设计时无法点击被禁用，true
         * 组件在运行时可以点击使用，false
         */
        this.isDisabled = false;
        /**
         * 查询条件列表
         */
        this.queryEmitter = new EventEmitter();
        /**
         * 查询方案cls
         */
        this.cls = 'query-solution';
        /**
         * 查询方案数据源
         */
        this.querySolutionVos = new Array();
        /**
         * 当前所选的方案，有可能不是方案
         */
        this.selectedSolution = new QuerySolutionVo();
        /**
         * 是否折叠
         */
        this.isFold = false;
        /**
         * label和控件是否排成一行，默认是；false时排成上下两行
         */
        this.isControlInline = true;
        /**
         * 是否需要完整显示超过6个字符的标签，默认false
         */
        this.showCompleteLabel = false;
        /**
         * 是否启用加载后查询
         */
        this.enableInitQuery = false;
        /**
         * 选择的控件展示列表
         */
        this.selectedFieldConditions = new Array();
        //方案是否赋默认值
        this.isSetDefaultValue = false;
        //方案是否已赋默认值
        this.doneSetDefaultValue = false;
        //是否已完成自动查询，默认值为true，当enableInitQuery输入值为true时，首次执行ngOnchanges()时将其设为false
        this.doneInitQuery = true;
        /**
         * 条件概要
         */
        this.summaryConditions = [];
        /**
         * 是否启用记录历史方式
         * 上次查询——不能删除、可以另存、不存在变更
         * 方案列表只有上次查询时，上次查询、系统默认都存在
         * 方案列表多个时，有上次查询，上次查询选中
         * 方案列表没有上次查询时，但是LocalStorage有,构造一个上次查询
         *
         */
        this.enableHistory = false;
        this.historyRefer = {
            schemeKey: '',
            // 历史记录scheme
            foundSchme: null,
            // 历史方案保存
            schemeKeyLS: '',
            //LocalStorage 历史记录标记
            initCondition: false //LocalStorage是否按照执行完查询
        };
        this.newSaveAsSolutionVo = (/**
         * @return {?}
         */
        () => {
            //当前选中的方案，再修改筛选条件后，其原来的筛选条件并没有变化，仅仅this.selectedFieldConditions有变化
            /** @type {?} */
            const solution = cloneDeep(this.selectedSolution);
            //新增的方案要清空查询方案编号
            solution.code = '';
            //是否系统属性必须设置为False
            solution.isSystem = false;
            //解决方案所属表单
            solution.belongId = this.formId;
            //新增方案Id需要Guid
            solution.id = this.solutionService.getGuid();
            //新增方案isDefault需要设置为false
            solution.isDefault = false;
            //新增方案的筛选条件，是当前选中的筛选条件
            solution.queryConditions = this.selectedFieldConditions;
            //设置类型要清空
            solution.type = "";
            solution.isChanged = false;
            return solution;
        });
        this.handleKeyDown = (/**
         * @param {?} event
         * @return {?}
         */
        (event) => {
            if (event.key == 'Enter')
                this.query();
        });
        this._idSer = new IdService();
        this.solutionHandler = this.injector.get(QUERYSOLUTION_HANDLER_TOKEN, null, InjectFlags.Optional);
        this._self = this.injector.get(ElementRef);
        this.cdf = this.injector.get(ChangeDetectorRef);
        this.eventManager = this.injector.get(EventManager);
    }
    /**
     * 字段配置数据源，用于选择字段配置
     * @param {?} fieldConfigJson
     * @return {?}
     */
    set fieldConfigs(fieldConfigJson) {
        this._fieldConfigs = this.solutionService.convertToQueryConditions(fieldConfigJson);
    }
    /**
     * @return {?}
     */
    get fieldConfigs() {
        return this._fieldConfigs;
    }
    /**
     * @param {?} resetFieldConfigJson
     * @return {?}
     */
    set resetFieldConfigs(resetFieldConfigJson) {
        if (!resetFieldConfigJson || resetFieldConfigJson.length == 0) {
            return;
        }
        // 规范数据
        /** @type {?} */
        let formatResetConfigJson = resetFieldConfigJson.map((/**
         * @param {?} tConfigItem
         * @return {?}
         */
        tConfigItem => {
            /** @type {?} */
            let findItem = this.presetFieldConfigs.find((/**
             * @param {?} presetItem
             * @return {?}
             */
            presetItem => presetItem['fieldCode'] == tConfigItem['labelCode']));
            if (findItem) {
                tConfigItem['control']['controltype'] = findItem.control.getControlType();
                return tConfigItem;
            }
        }));
        this._resetFieldConfigs = this.solutionService.convertToSimpleQueryConditions(formatResetConfigJson);
        // 更新已有配置
        this.solutionService.updateControl(this._presetFieldConfigs, this._resetFieldConfigs);
        // 更新已有的方案
        this.sysQuerySolutionVo && this.solutionService.updateControl(this.sysQuerySolutionVo.queryConditions, this._resetFieldConfigs);
        // 更新历史记录
        this.historyRefer['foundSchme'] && this.solutionService.updateControl(this.historyRefer['foundSchme'].queryConditions, this._resetFieldConfigs);
        // 更新已选
        this.selectedSolution && this.solutionService.updateControl(this.selectedSolution.queryConditions, this._resetFieldConfigs);
    }
    /**
     * @return {?}
     */
    get resetFieldConfigs() {
        return this._resetFieldConfigs;
    }
    /**
     * 预置查询字段
     * @param {?} presetFieldConfigJson
     * @return {?}
     */
    set presetFieldConfigs(presetFieldConfigJson) {
        this._presetFieldConfigs = this.solutionService.convertToQueryConditions(presetFieldConfigJson);
    }
    /**
     * @return {?}
     */
    get presetFieldConfigs() {
        return this._presetFieldConfigs;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this._self.nativeElement.removeEventListener("keydown", this.handleKeyDown);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes['defaultConfigs']) {
            this.isSetDefaultValue = true;
            if (changes['defaultConfigs'].currentValue && !changes['defaultConfigs'].firstChange) { //设计时不会给defaultConfigs赋值
                this.setQueryConditionValues(changes['defaultConfigs'].currentValue, this.selectedSolution);
                this.initAutoQuery(this.selectedSolution);
            }
        }
        if (changes['enableInitQuery'] && changes['enableInitQuery'].firstChange && changes['enableInitQuery'].currentValue) {
            this.doneInitQuery = false;
        }
    }
    /**
     * 组件初始化
     * @return {?}
     */
    ngOnInit() {
        //只在运行时 获取sessionId，查询已存储方案
        this.initSysQuerySolution();
        if (!this.isDisabled) {
            this.sessionId = this.solutionHandler.getUserSessionId();
            // 缓存历史方案
            this.initAutoQueryByLS();
            // 加载方案列表
            this.loadQuerySolutions();
            //注册键盘监听事件
            this.listenKeyBoard();
        }
        else {
            //设计时只加载系统预置方案
            this.loadSysQuerySolution();
        }
    }
    /**
     * @return {?}
     */
    initSysQuerySolution() {
        if (this.presetQuerySolutionName && this.presetQuerySolutionName != '') {
            this.sysQuerySolutionVo = new QuerySolutionVo();
            this.sysQuerySolutionVo.id = this.solutionService.getGuid();
            this.sysQuerySolutionVo.code = (this.presetQuerySolutionName != this.localeService.getValue("querySolution.container.sysPresetName")) ? this.presetQuerySolutionName : this.localeService.getValue("querySolution.container.defaultName");
            this.sysQuerySolutionVo.queryConditions = cloneDeep(this.presetFieldConfigs);
            this.sysQuerySolutionVo.belongId = this.formId;
            this.sysQuerySolutionVo.isSystem = true;
            // this.querySolutionVos.push(this.sysQuerySolutionVo);
        }
    }
    /**
     * 加载系统预置方案
     * @return {?}
     */
    loadSysQuerySolution() {
        this.querySolutionVos.push(this.sysQuerySolutionVo);
        this.selectedSolution = cloneDeep(this.sysQuerySolutionVo);
        this.loadQueryConditions();
    }
    /**
     * 规范方案条件
     * @private
     * @param {?} tConvertor
     * @param {?} element
     * @param {?=} fromJobject
     * @return {?}
     */
    formatQuerySolutionVO(tConvertor, element, fromJobject = false) {
        /** @type {?} */
        let querysolutionVO;
        /** @type {?} */
        let sourceData;
        /** @type {?} */
        let _fieldCodeArr = [];
        /** @type {?} */
        let _tQueryConditions;
        if (fromJobject) {
            querysolutionVO = tConvertor.initFromJobject(element);
        }
        else {
            querysolutionVO = element;
        }
        this.fieldConfigs.forEach((/**
         * @param {?} _item
         * @return {?}
         */
        _item => { _fieldCodeArr.push(_item.fieldCode); }));
        if (querysolutionVO && querysolutionVO.queryConditions && querysolutionVO.queryConditions.length > 0) {
            //若表单上删除了某个字段，但已保存的自定义方案中包含该字段时，在加载方案过程中将该字段剔除
            _tQueryConditions = querysolutionVO.queryConditions.filter((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                return _fieldCodeArr.indexOf(element.fieldCode) > -1;
            }));
            querysolutionVO.queryConditions = _tQueryConditions;
            //对自定义方案的国际化信息、帮助控件的帮助前及帮助后事件进行动态赋值
            querysolutionVO.queryConditions.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                sourceData = this.fieldConfigs.find((/**
                 * @param {?} _item
                 * @return {?}
                 */
                _item => _item.fieldCode == element.fieldCode));
                element.fieldName = sourceData.fieldName;
                element.placeHolder = sourceData.placeHolder;
                element.beginPlaceHolder = sourceData.hasOwnProperty('beginPlaceHolder') ? sourceData['beginPlaceHolder'] : '';
                element.endPlaceHolder = sourceData.hasOwnProperty('endPlaceHolder') ? sourceData['endPlaceHolder'] : '';
                if (sourceData.control.preEventCmd) {
                    ((/** @type {?} */ (element.control))).preEventCmd = sourceData.control.preEventCmd;
                }
                if (sourceData.control.postEventCmd) {
                    ((/** @type {?} */ (element.control))).postEventCmd = sourceData.control.postEventCmd;
                }
                if (sourceData.control.clear) {
                    ((/** @type {?} */ (element.control))).clear = sourceData.control.clear;
                }
                if (sourceData.control.click) {
                    ((/** @type {?} */ (element.control))).click = sourceData.control.click;
                }
                if (sourceData.control.enumValues && sourceData.control.enumValues.length > 0) {
                    ((/** @type {?} */ (element.control))).enumValues = sourceData.control.enumValues;
                    ((/** @type {?} */ (element.control))).enumValues = sourceData.control.enumValues;
                }
                if (sourceData.control.data && sourceData.control.data.length > 0) {
                    ((/** @type {?} */ (element.control))).data = sourceData.control.data;
                }
            }));
        }
        return querysolutionVO;
    }
    /**
     * 加载查询方案数据
     * @return {?}
     */
    loadQuerySolutions() {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            /** @type {?} */
            const self = this;
            this.httpService.query(this.formId, this.sessionId).subscribe((/**
             * @param {?} items
             * @return {?}
             */
            (items) => {
                /** @type {?} */
                const convertor = new QuerySolutionVoConvertor();
                /** @type {?} */
                let querysolutionVO;
                if (items && items.length > 0) {
                    items.forEach((/**
                     * @param {?} element
                     * @return {?}
                     */
                    element => {
                        querysolutionVO = this.formatQuerySolutionVO(convertor, element, true);
                        if (this.enableHistory && querysolutionVO['type'] == 'pre') {
                            // 如果返回列表内存在历史记录                        
                            querysolutionVO.code = this.localeService.getValue("querySolution.container.histroyName");
                            this.historyRefer['schemeKey'] = querysolutionVO.id;
                            this.historyRefer['foundSchme'] = cloneDeep(querysolutionVO);
                            this.historyRefer['initCondition'] = true;
                            //  this.defaultQuerySolution = cloneDeep(querysolutionVO);
                        }
                        else if (querysolutionVO['type'] != 'pre') {
                            this.querySolutionVos.push(querysolutionVO);
                            if (querysolutionVO.isDefault) { //如果有默认方案，则设置全局默认方案
                                this.defaultQuerySolution = cloneDeep(querysolutionVO);
                            }
                        }
                    }));
                    self.setSolutionCache(this.querySolutionVos);
                }
                if (this.enableHistory && !this.historyRefer['initCondition']) {
                    //如果还没有设置条件
                    this.formatInitQuerySolution();
                }
                if (this.enableHistory && this.historyRefer['initCondition']) {
                    this.selectedSolution = cloneDeep(this.historyRefer['foundSchme']);
                    //只有缓存记录
                    this.querySolutionVos.splice(0, 0, this.historyRefer['foundSchme']);
                    if (this.querySolutionVos.length == 1) {
                        // 只有上次查询时
                        this.querySolutionVos.push(this.sysQuerySolutionVo);
                    }
                    self.setSolutionCache(this.querySolutionVos);
                    this.loadQueryConditions();
                    // if(this.historyRefer['schemeKey'] !== ''){
                    //     //更新一次缓存
                    //     this.changeQueryHistroy(false);
                    // }                
                }
                else if (this.defaultQuerySolution || this.querySolutionVos.length) {
                    //如果已查到有默认方案，或已有存储的方案
                    //不再加载系统配置的方案，首先加载默认方案，没有默认则加载第一个方案
                    if (this.defaultQuerySolution && this.defaultQuerySolution.id != '') {
                        this.selectedSolution = cloneDeep(this.defaultQuerySolution);
                    }
                    else {
                        this.selectedSolution = cloneDeep(this.querySolutionVos[0]);
                    }
                    this.loadQueryConditions();
                }
                else {
                    //如果没有任何已存储的方案，则加载系统配置方案
                    this.loadSysQuerySolution();
                }
                if (this.isSetDefaultValue && !this.historyRefer['initCondition']) {
                    this.setQueryConditionValues(this.defaultConfigs, this.selectedSolution);
                }
                this.initAutoQuery(this.selectedSolution);
            }));
        });
    }
    /**
     * @param {?} querySolutionVos
     * @return {?}
     */
    setSolutionCache(querySolutionVos) {
        if (!this.isDisabled && gspframeworkService && querySolutionVos && querySolutionVos.length) {
            // 获取当前功能菜单信息, 并以功能菜单ID为缓存key
            /** @type {?} */
            const option = gspframeworkService.rtf.session.getCommonVariable();
            SolutionCacheService.setSolutionCache(option.tabId, querySolutionVos);
            SolutionCacheService.solutionListChanged.next(true);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    setCurrentSolutionCache(value) {
        if (!this.isDisabled && gspframeworkService && value) {
            // 获取当前功能菜单信息, 并以功能菜单ID为缓存key
            /** @type {?} */
            const option = gspframeworkService.rtf.session.getCommonVariable();
            if (option && option.tabId) {
                SolutionCacheService.setCurrentSolution(option.tabId, value);
            }
        }
    }
    /**
     * @return {?}
     */
    loadQueryConditions() {
        //加载筛选条件
        this.selectedFieldConditions = new Array();
        if (this.selectedSolution && this.selectedSolution.queryConditions && this.selectedSolution.queryConditions.length > 0) {
            // this.selectedFieldConditions = this.selectedSolution.queryConditions as Array<QueryCondition>;
            this.selectedFieldConditions = this.selectedSolution.queryConditions;
        }
        // 如果方案的变更是在収折时
        this.whenFoldSetSummaryConditions();
        this.showSaveButton = this.selectedSolution.isSystem ? false : true;
        !this.isDisabled && this.solutionHandler.setCurrentQueryConditions(cloneDeep(this.selectedFieldConditions));
        this.setCurrentSolutionCache(this.selectedSolution);
    }
    /**
     * @return {?}
     */
    saveAs() {
        this.openSaveAsDialog(this.localeService.getValue("querySolution.saveAsDialog.title"));
    }
    /**
     * 获取默认标签
     * @param {?} solution
     * @return {?}
     */
    getDefaultLabel(solution) {
        if (!(this.defaultQuerySolution)) {
            return { 'visibility': 'hidden' };
        }
        else {
            if (solution.id == this.defaultQuerySolution.id) {
                // //不处理了
            }
            else {
                return { 'visibility': 'hidden' };
            }
        }
    }
    /**
     * 方案选择事件
     * @param {?} solution 当前选中的方案
     * @return {?}
     */
    select(solution) {
        this.selectedSolution = Object.assign(new QuerySolutionVo(), solution);
        if (solution.queryConditions && solution.queryConditions.length > 0) {
            this.selectedFieldConditions = this.selectedSolution.queryConditions;
        }
        else {
            this.selectedFieldConditions = new Array();
        }
        this.showSaveButton = this.selectedSolution.isSystem ? false : true;
        !this.isDisabled && this.solutionHandler.setCurrentQueryConditions(cloneDeep(this.selectedFieldConditions));
        this.setCurrentSolutionCache(this.selectedSolution);
        // 如果方案的变更是在収折时
        this.whenFoldSetSummaryConditions();
    }
    /**
     * @param {?} solution
     * @return {?}
     */
    selectAndQuery(solution) {
        if (this.defaultConfigs && this.defaultConfigs.isCurrent || (solution.isSystem && solution.type !== 'pre')) {
            this.setQueryConditionValues(this.defaultConfigs, solution); //已包含select操作
        }
        else {
            if (this.enableHistory && solution.type == 'pre') {
                /** @type {?} */
                let conditions = cloneDeep(this.historyRefer['foundSchme']['queryConditions']);
                if (conditions.length > 0) {
                    solution.queryConditions = conditions;
                }
            }
            this.select(solution);
        }
        this.query();
    }
    /**
     * 打开字段配置窗口
     * @return {?}
     */
    openFieldConfigDialog() {
        this.farrisQueryCondition.openFieldConfigDialog();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    fieldConditionsChangeHander($event) {
        /** @type {?} */
        let data = $event;
        // this.selectedSolution.queryConditions = data;此时不改变当前选中的方案，等到保存时，直接调用this.selectedFieldConditions来保存。
        this.selectedFieldConditions = data;
        if (!this.isDisabled) {
            this.solutionHandler.setCurrentQueryConditions(cloneDeep(this.selectedFieldConditions));
            this.solutionHandler.setFilterConditions(this.selectedFieldConditions);
            this.setCurrentSolutionCache(this.selectedSolution);
        }
        this.markAsChanged(true, this.selectedSolution.id);
    }
    /**
     * 保存方案
     * @return {?}
     */
    save() {
        if (!this.formId) {
            this.solutionService.showInfo(this.localeService.getValue("querySolution.container.pleaseInput"), 'error', '', 1500);
            return;
        }
        //id为空则表示没有预置方案，则此时保存方案相当于新增一个方案
        if (!this.selectedSolution.id) {
            this.openSaveAsDialog(this.localeService.getValue("querySolution.container.save"));
        }
        //直接保存
        else {
            this.selectedSolution.queryConditions = this.selectedFieldConditions;
            this.httpService.update(this.selectedSolution, this.sessionId).subscribe((/**
             * @return {?}
             */
            () => {
                /** @type {?} */
                let tempIndex = this.querySolutionVos.findIndex((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => x.id == this.selectedSolution.id));
                // this.selectedFieldConditions = this.selectedSolution.queryConditions;
                this.querySolutionVos.splice(tempIndex, 1, this.selectedSolution);
                this.markAsChanged(false, this.selectedSolution.id);
                this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveSuccess"), 'success', '', 1500);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveFail"), 'error', '', 1500);
                throw error;
            }));
        }
    }
    /**
     * 打开另存为对话框，点击保存按钮时也走该逻辑
     * @param {?} title
     * @return {?}
     */
    openSaveAsDialog(title) {
        if (!this.formId) {
            this.solutionService.showInfo(this.localeService.getValue("querySolution.container.pleaseInput"), 'error', '', 1500);
            return;
        }
        this.saveAsDialog.title = title;
        this.saveAsDialog.querySolution = this.newSaveAsSolutionVo();
        this.saveAsDialog.show();
    }
    /**
     * 另存为确定事件处理
     * @param {?} _event
     * @return {?}
     */
    saveAsConfrimHandler(_event) {
        /** @type {?} */
        const solution = _event['querySolution'];
        if (solution.queryConditions && solution.queryConditions.length) {
            solution.queryConditions.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                if (!!element.readonly) {
                    element.readonly = false;
                }
            }));
        }
        this.httpService.create(solution, this.sessionId).subscribe((/**
         * @return {?}
         */
        () => {
            //重新设置全局的默认方案
            if (solution.isDefault) { //被设置为默认方案
                this.defaultQuerySolution = solution;
                this.querySolutionVos = this.querySolutionVos.map((/**
                 * @param {?} vo
                 * @return {?}
                 */
                vo => {
                    vo.isDefault = false;
                    return vo;
                }));
            }
            //用户保存自己的筛选方案后，不再显示系统默认的方案
            if (this.querySolutionVos.length === 1 && this.querySolutionVos[0].isSystem) {
                //用户没有配置自己的筛选方案时，或者用户只配置了一个筛选方案时，此数组都有一个方案；若此方案是系统默认方案，则应在另存为时删掉
                this.querySolutionVos = new Array();
            }
            else if (this.querySolutionVos.length === 2 && this.enableHistory) {
                /** @type {?} */
                let filterSolutionVos = new Array();
                filterSolutionVos = this.querySolutionVos.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (item.type == 'pre') {
                        return true;
                    }
                    return !item.isSystem;
                }));
                this.querySolutionVos = filterSolutionVos;
            }
            this.querySolutionVos.push(solution);
            this.selectedSolution = solution;
            this.showSaveButton = this.selectedSolution.isSystem ? false : true;
            this.selectedFieldConditions = this.selectedSolution.queryConditions;
            this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveSuccess"), 'success', '', 1500);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveFail"), 'error', '', 1500);
            throw error;
        }));
    }
    /**
     * 打开管理界面
     * @return {?}
     */
    openManangerDialog() {
        this.manageDialog.show(cloneDeep(this.querySolutionVos));
    }
    /**
     * 管理界面确定处理
     * @param {?} _event
     * @return {?}
     */
    managerConfirmHandler(_event) {
        /** @type {?} */
        let obj = _event;
        if (obj['validator'] == true) {
            //点击checkbox时，newDefaultQuerySolution被赋值； 全局默认方案被删除时，newDefaultQuerySolution变为null
            /** @type {?} */
            const defaultId = obj['newDefaultQuerySolution'] ? obj['newDefaultQuerySolution'].id : '';
            /** @type {?} */
            const belongId = this.formId;
            //若没有删除任何方案，deletedQuerySolutionVos会是一个空数组
            /** @type {?} */
            const deletedIds = obj['deletedQuerySolutionIds'];
            this.httpService.batchUpdate({ defaultId, belongId, deletedIds }, this.sessionId).subscribe((/**
             * @return {?}
             */
            () => {
                //把删除后的vo赋值给 this.querySolutionVos；如果没删除方案， this.querySolutionVos跟obj['splicedQuerySolutionVos']同值
                //默认方案的变化也记录在updatedQuerySolutionVos中
                this.querySolutionVos = obj['updatedQuerySolutionVos'];
                if (!obj['currentDefaultQuerySolutionId']) { //如果传过来的当前默认方案id是空，代表所有默认方案都取消了
                    this.defaultQuerySolution = null;
                }
                //如果有默认方案先显示默认方案，如果没有默认方案则直接显示当前查询方案的第一个；如果没有任何查询方案则直接清空查询方案，则显示系统预置的默认方案
                if (defaultId) {
                    //已设置默认方案
                    this.select(obj['newDefaultQuerySolution']);
                    this.defaultQuerySolution = obj['newDefaultQuerySolution'];
                }
                else {
                    //未更改默认方案，判断当前选择的查询方案是否已被删除
                    if (deletedIds.includes(this.selectedSolution.id)) { //如果被删除
                        if (this.querySolutionVos.length > 0) {
                            if (this.enableHistory && this.querySolutionVos.length == 1 && this.querySolutionVos[0].type == 'pre') {
                                this.select(this.sysQuerySolutionVo);
                                this.querySolutionVos.push(this.sysQuerySolutionVo);
                            }
                            else {
                                this.select(this.querySolutionVos[0]);
                            }
                        }
                        else {
                            this.select(this.sysQuerySolutionVo);
                            this.querySolutionVos.push(this.sysQuerySolutionVo);
                        }
                    }
                    else {
                        //什么也没发生
                        //把所有的默认都取消了
                    }
                }
                this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveSuccess"), 'success', '', 1500);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                this.solutionService.showInfo(this.localeService.getValue("querySolution.container.saveFail"), 'error', '', 1500);
                return Observable.throw(error);
            }));
        }
        else {
            //校验失败
        }
    }
    /**
     * 执行筛选
     * @return {?}
     */
    query() {
        if (!this.isDisabled) {
            /** @type {?} */
            const errorArr = this.solutionService.isValid(this.selectedFieldConditions);
            if (errorArr && errorArr.length) {
                /** @type {?} */
                const errorFields = errorArr.map((/**
                 * @param {?} error
                 * @return {?}
                 */
                error => error.field));
                this.solutionService.showInfo(this.localeService.getValue("querySolution.container.require").replace('{fields}', errorFields.join(', ')), 'warning', '', 2500);
            }
            else {
                /** @type {?} */
                const queryConditions = cloneDeep(this.selectedFieldConditions);
                this.solutionHandler.setFilterConditions(queryConditions);
                this.queryEmitter.emit(queryConditions);
                // 更新历史记录
                this.changeQueryHistroy();
            }
        }
    }
    /**
     * 清空->条件全部重置为空
     * @return {?}
     */
    clear() {
        // this.isFold = !this.isFold;
        /** @type {?} */
        const isNotEmpty = this.selectedFieldConditions.some((/**
         * @param {?} condition
         * @return {?}
         */
        condition => condition.value.isEmpty() == false));
        if (isNotEmpty) {
            /** @type {?} */
            const newList = cloneDeep(this.farrisQueryCondition.resetSelectedConditionValues(true));
            this.selectedFieldConditions = newList;
            this.selectedSolution.queryConditions = newList;
            this.solutionHandler.setCurrentQueryConditions(cloneDeep(newList));
            this.solutionHandler.setFilterConditions(newList);
            this.markAsChanged(true, this.selectedSolution.id);
            this.query();
        }
    }
    /**
     * 折叠按钮的清空
     * @return {?}
     */
    foldClearHandler() {
        if (this.isFold) {
            // 如果点击的时候是収折的
            this.isFold = false;
            if (this.summaryConditions.length > 0) {
                this.summaryConditions = [];
                this.clear();
            }
        }
        else {
            // 如果点击的时候是展开的
            this.clear();
        }
    }
    /**
     * 箭头点击事件
     * @return {?}
     */
    arrowClick() {
        this.isFold = !this.isFold;
        this.whenFoldSetSummaryConditions();
        if (!this.isFold) {
            this.summaryConditions = [];
        }
    }
    /**
     * @private
     * @return {?}
     */
    whenFoldSetSummaryConditions() {
        if (this.isFold) {
            // 如果収折
            /** @type {?} */
            const isNotEmpty = this.selectedFieldConditions.some((/**
             * @param {?} condition
             * @return {?}
             */
            condition => condition.value.isEmpty() == false));
            if (isNotEmpty) {
                this.summaryConditions = this.selectedFieldConditions.filter((/**
                 * @param {?} condition
                 * @return {?}
                 */
                condition => condition.value.isEmpty() == false));
            }
            else {
                this.summaryConditions = [];
            }
        }
    }
    /**
     * 为系统预置方案或者自定义查询方案设置筛选条件默认值
     * @param {?} configs 默认值设置
     * @param {?} selectedSolution 当前选择的筛选方案
     * @return {?}
     */
    setQueryConditionValues(configs, selectedSolution) {
        /** @type {?} */
        let targetSolution;
        /** @type {?} */
        let targetSolutionWithValues;
        if (configs && configs.fieldConfigs && configs.fieldConfigs.length) {
            if (selectedSolution.hasOwnProperty('type') && selectedSolution['type'] == 'pre') {
                //如果是历史记录
                targetSolution = null;
                this.select(selectedSolution);
            }
            else {
                targetSolution = configs.isCurrent ? selectedSolution : (selectedSolution.isSystem ? selectedSolution : null);
            }
            if (targetSolution && targetSolution.queryConditions && targetSolution.queryConditions.length) {
                targetSolutionWithValues = cloneDeep(this.solutionService.setValues(targetSolution, configs.fieldConfigs, !!configs.readonly));
                this.doneSetDefaultValue = true;
                this.select(targetSolutionWithValues);
            }
            else {
                //不为自定义方案设置默认值时，标记下要为其赋默认值的意图，但未成功
                this.doneSetDefaultValue = true;
                //如果没有设置默认值，就把当前选中方案的条件的值传出
                this.solutionHandler.setCurrentQueryConditions(this.selectedSolution.queryConditions);
            }
        }
    }
    /**
     * 加载筛选方案后自动查询
     * @param {?} currentSolution 当前筛选方案
     * @return {?}
     */
    initAutoQuery(currentSolution) {
        if (this.enableInitQuery && this.doneInitQuery && this.enableHistory) {
            // 已通过历史记录进行过查询
            return;
        }
        /** @type {?} */
        let enableQuery = true;
        if (currentSolution && currentSolution.queryConditions && currentSolution.queryConditions.length) {
            if (this.isSetDefaultValue && !this.doneSetDefaultValue) {
                enableQuery = false;
            }
        }
        else {
            enableQuery = false;
        }
        if (enableQuery && this.enableInitQuery) {
            // this.solutionHandler.setFilterConditions(this.selectedSolution.queryConditions); 执行query方法时，已经执行setFilterConditions
            //if(this._self.nativeElement.querySelector('.farris-panel .btn-group .btn-primary')){
            this.query();
            this.doneInitQuery = true;
            //}
        }
    }
    /**
     * 当前查询方案的筛选条件发生变化时，标记方案处于编辑状态
     * @param {?} isChanged 方案是否处于编辑状态
     * @param {?} solutionId 需要标记是否处于编辑状态的方案的id
     * @return {?}
     */
    markAsChanged(isChanged, solutionId) {
        this.querySolutionVos.forEach((/**
         * @param {?} solution
         * @return {?}
         */
        solution => {
            if (solution.id == solutionId)
                solution.isChanged = isChanged;
        }));
        this.selectedSolution.isChanged = isChanged;
        this.cdf.detectChanges();
    }
    /**
         * 处理筛选按钮和清空按钮的响应式位置变更
         * @param $event farris-querycondition组件内部是否显示按钮
         */
    // showButtonHandle($event: any) {
    //     if(!this.isDisabled){
    //         let data = $event;
    //         this.queryButtonOnRight = !data;
    //         if(this.enableInitQuery && !this.doneInitQuery) {
    //             this.initAutoQuery(this.selectedSolution);
    //         }
    //     }
    // }
    /**
     * 键盘监听函数，当按下回车键时相当于按下筛选按钮
     * @private
     * @return {?}
     */
    listenKeyBoard() {
        this._self.nativeElement.addEventListener("keydown", this.handleKeyDown);
    }
    /**
     * 自动初始化查询
     * 启用历史记录，并且启用了初始化查询，如果有条件，就进行查询
     * @private
     * @return {?}
     */
    initAutoQueryByLS() {
        // 启用历史
        if (this.enableHistory && !this.isDisabled) {
            // key
            this.setLSKey();
            // 初始化对象
            this.initQuerySolution();
            // 如果设置了初始查询
            if (this.enableInitQuery) {
                this.formatInitQuerySolution();
                if (this.historyRefer['foundSchme']['queryConditions'].length > 0) {
                    /** @type {?} */
                    const queryConditions = cloneDeep(this.historyRefer['foundSchme']['queryConditions']);
                    this.selectedFieldConditions = queryConditions;
                    // 设置查询条件
                    this.solutionHandler.setFilterConditions(queryConditions);
                    // 抛出查询事件
                    this.queryEmitter.emit(queryConditions);
                    // 标记
                    this.doneInitQuery = true;
                }
            }
        }
    }
    /**
     * 初始化
     * @private
     * @return {?}
     */
    initQuerySolution() {
        /** @type {?} */
        let querysolutionVO = new QuerySolutionVo();
        querysolutionVO.id = this.solutionService.getGuid();
        querysolutionVO.code = this.localeService.getValue("querySolution.container.histroyName");
        querysolutionVO.queryConditions = [];
        querysolutionVO.belongId = this.formId;
        querysolutionVO.isSystem = true;
        querysolutionVO.type = 'pre';
        this.historyRefer['foundSchme'] = querysolutionVO;
    }
    /**
     * 初始化来自LS的条件
     * @private
     * @return {?}
     */
    formatInitQuerySolution() {
        /** @type {?} */
        let histroyCondition = this.httpService.getLS(this.historyRefer.schemeKeyLS);
        if (histroyCondition.length > 0) {
            /** @type {?} */
            let convertor = new QuerySolutionVoConvertor();
            this.historyRefer['foundSchme']['queryConditions'] = histroyCondition;
            // 规范化条件
            this.historyRefer['foundSchme'] = this.formatQuerySolutionVO(convertor, this.historyRefer['foundSchme']);
            // 更新配置
            this.solutionService.updateControl(this.historyRefer['foundSchme'], this.resetFieldConfigs);
            this.historyRefer.initCondition = true;
        }
    }
    /**
     * 保存之后更新历史
     * @private
     * @param {?=} updateAll
     * @return {?}
     */
    changeQueryHistroy(updateAll = true) {
        if (!this.enableHistory) {
            return;
        }
        if (this.selectedSolution['type'] == 'pre') {
            this.selectedSolution['isChanged'] = false;
        }
        else {
            /** @type {?} */
            let preIndex = this.querySolutionVos.findIndex((/**
             * @param {?} qsolutionVO
             * @return {?}
             */
            (qsolutionVO) => {
                return qsolutionVO['type'] == 'pre';
            }));
            // 执行查询之后，上次查询的修改就不认为是变更了
            if (preIndex > -1) {
                this.querySolutionVos[preIndex]['isChanged'] = false;
            }
        }
        /** @type {?} */
        const queryConditions = cloneDeep(this.selectedFieldConditions);
        this.historyRefer['foundSchme'].queryConditions = queryConditions;
        // 更新缓存
        this.httpService.setLS(this.historyRefer.schemeKeyLS, this.historyRefer['foundSchme'].queryConditions);
        if (updateAll) {
            // 发起请求保存历史记录
            this.httpService.saveHistroy(this.historyRefer['foundSchme'], this.sessionId).subscribe((/**
             * @return {?}
             */
            () => {
            }));
        }
    }
    /**
     * 处理iframe嵌套
     * @private
     * @return {?}
     */
    getTopWindow() {
        /** @type {?} */
        let curWin = window.self;
        try {
            while (curWin.location.origin === curWin.parent.location.origin) {
                if (curWin !== curWin.parent && !((/** @type {?} */ (curWin))).isRTFTopWin) {
                    curWin = curWin.parent;
                }
                else {
                    break;
                }
            }
        }
        catch (e) { }
        return curWin;
    }
    /**
     * 设置key
     * @private
     * @return {?}
     */
    setLSKey() {
        // 获取window
        /** @type {?} */
        let curWindow = this.getTopWindow();
        /** @type {?} */
        let userCode = '';
        if (curWindow['gspframeworkService'] && curWindow['gspframeworkService'].hasOwnProperty('common')) {
            userCode = curWindow['gspframeworkService']['common'].userInfos.get().code;
        }
        this.historyRefer.schemeKeyLS = userCode ? 'Scheme' + this._idSer.encrypt(userCode + this.formId) : '';
    }
}
QuerySolutionComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-querysolution',
                template: "<div #querysolution class=\"farris-panel position-relative\" tabindex=\"1\" style=\"outline: none;\">\r\n    <div class=\"solution-header\">\r\n        <div class=\"btn-group mr-3\" fDropdown>\r\n            <div class=\"solution-header-title\" fDropdownToggle>               \r\n                <span style=\"max-width: 288px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap\"\r\n                    title=\"{{selectedSolution.code}}\">{{selectedSolution.code}}</span>\r\n                <b class=\"header-title--change\" *ngIf=\"selectedSolution.isChanged\">*</b>\r\n                <span class=\"f-icon f-accordion-expand\"></span>\r\n            </div>\r\n            <div class=\"dropdown-menu solution-header-title-menu\" fDropdownMenu>\r\n                <div class=\"solution-header-title-menu-inner\">\r\n                    <div class=\"solution-header-title-menu-arrow\"></div>\r\n                    <li class=\"dropdown-item solution-header-dropdown-item\"\r\n                        [ngClass]=\"{'solution-header-dropdown-item-active': solution.id === selectedSolution.id }\"\r\n                        (click)=\"selectAndQuery(solution)\" *ngFor=\"let solution of querySolutionVos\">\r\n                        <b *ngIf=\"solution.isChanged\"  class=\"menu-item--change\" >*</b>\r\n                        <span class=\"solution-header-dropdown-item-title\" [title]=\"solution.code\">{{solution.code}}</span>\r\n                        <span class=\"solution-header-dropdown-item-tip\"\r\n                            [ngStyle]=\"getDefaultLabel(solution)\">{{'querySolution.container.default' | locale}}</span>\r\n                    </li>\r\n                    <li class=\"solution-header-dropdown-item-btns\">\r\n                        <span class=\"dropdown-item-btn\" *ngIf=\"showSaveButton\"\r\n                            (click)=\"save()\">{{'queryCondition.container.save' | locale}}</span>\r\n                        <span class=\"dropdown-item-btn\"\r\n                            (click)=\"saveAs()\">{{'queryCondition.container.saveAs' | locale}}</span>\r\n                        <span class=\"dropdown-item-btn\"\r\n                            (click)=\"openManangerDialog()\">{{'querySolution.container.manage' | locale}}</span>\r\n                    </li>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"summary-condition\" *ngIf=\"isFold&&summaryConditions.length>0\">\r\n            <lib-summary-list [conditions]=\"summaryConditions\"></lib-summary-list>\r\n        </div>\r\n        <div class=\"solution-action\">\r\n            <div class=\"btn-group\" *ngIf=\"!isFold\">\r\n                <button *ngIf=\"isFold==false\" (click)=\"query()\" type=\"button\"\r\n                    class=\"btn btn-primary \">{{'queryCondition.container.query' | locale}}</button>\r\n            </div>\r\n            <div class=\"icon-group\">\r\n                <!--\u6E05\u7A7A\u6309\u94AE-->\r\n                <span *ngIf=\"!isFold||summaryConditions.length>0\" class=\"icon-group-remove\" (click)=\"foldClearHandler()\"\r\n                    title=\"{{'querySolution.container.clear' | locale}}\">\r\n                    <span class=\"f-icon f-icon-remove\"></span>\r\n                </span>                \r\n                <ng-container *ngIf=\"!isFold\">\r\n                    <span class=\"divide\"></span>\r\n                    <!--\u914D\u7F6E\u6309\u94AE-->\r\n                    <span class=\"icon-group-setup\" (click)=\"openFieldConfigDialog()\"\r\n                        title=\"{{'queryCondition.container.config' | locale}}\">\r\n                        <span class=\"f-icon f-icon-home-setup\"></span>\r\n                    </span>\r\n                    <!--\u5C55\u5F00\u6536\u8D77-->\r\n                    <span class=\"icon-group-packup\" (click)=\"arrowClick()\"\r\n                        title=\"{{'querySolution.container.arrowUp' | locale}}\">\r\n                        <span class=\"f-icon f-icon-packup\"></span>\r\n                    </span>\r\n                </ng-container>\r\n                <!--\u5C55\u5F00\u6536\u8D77-->\r\n                <span *ngIf=\"isFold\" class=\"icon-group-packup\" (click)=\"arrowClick()\"\r\n                    title=\"{{'querySolution.container.arrowDown' | locale}}\">\r\n                    <span class=\"f-icon f-icon-packup\" style=\"transform: rotate(180deg);\"></span>\r\n                </span>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div>\r\n        <farris-querycondition [ngClass]=\"{'d-none':isFold}\" #farrisQueryCondition\r\n            [(selectedFieldConditions)]=\"selectedFieldConditions\" [fieldConfigs]=\"fieldConfigs\"\r\n            (fieldConditionsChange)=\"fieldConditionsChangeHander($event)\" [isControlInline]=\"isControlInline\"\r\n            [showCompleteLabel]=\"showCompleteLabel\" [isDisabled]=\"isDisabled\" [resetFieldConfigs]=\"resetFieldConfigs\">\r\n        </farris-querycondition>\r\n    </div>\r\n\r\n    <app-solutionmanager #manageDialog (confirmEmitter)=\"managerConfirmHandler($event)\"></app-solutionmanager>\r\n    <app-saveasdialog #saveAsDialog (confirmEmitter)=\"saveAsConfrimHandler($event)\"></app-saveasdialog>\r\n    <div *ngIf=\"isDisabled\" style=\"position:absolute;top:0;bottom:0;left:0;right:0;z-index: 99;\"></div>\r\n</div>",
                encapsulation: ViewEncapsulation.None,
                providers: [HttpService, ConvertorService, FieldConfigService],
                styles: [".solution-action{float:right}.solution-action span{vertical-align:middle;margin:0 3px}.solution-action .divide{font-size:12px;padding:3px 0}.solution-header{height:30px;margin-bottom:5px;-webkit-box-pack:start;justify-content:flex-start}.solution-action .f-icon{cursor:pointer}.solution-action .icon-group{display:inline-block}.solution-header-title-text{overflow:initial!important}"]
            }] }
];
/** @nocollapse */
QuerySolutionComponent.ctorParameters = () => [
    { type: NotifyService },
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: BsModalService },
    { type: ConvertorService },
    { type: SolutionService },
    { type: HttpService },
    { type: FieldConfigService },
    { type: LocaleService }
];
QuerySolutionComponent.propDecorators = {
    defaultConfigs: [{ type: Input }],
    fieldConfigs: [{ type: Input }],
    presetQuerySolutionName: [{ type: Input }],
    resetFieldConfigs: [{ type: Input }],
    presetFieldConfigs: [{ type: Input }],
    isDisabled: [{ type: Input }],
    formId: [{ type: Input }],
    queryEmitter: [{ type: Output }],
    cls: [{ type: HostBinding, args: ['class',] }],
    isFold: [{ type: Input }],
    isControlInline: [{ type: Input }],
    showCompleteLabel: [{ type: Input }],
    enableInitQuery: [{ type: Input }],
    enableHistory: [{ type: Input }],
    farrisQueryCondition: [{ type: ViewChild, args: ['farrisQueryCondition',] }],
    manageDialog: [{ type: ViewChild, args: ['manageDialog',] }],
    saveAsDialog: [{ type: ViewChild, args: ['saveAsDialog',] }]
};
if (false) {
    /** @type {?} */
    QuerySolutionComponent.prototype._fieldConfigs;
    /** @type {?} */
    QuerySolutionComponent.prototype._presetFieldConfigs;
    /** @type {?} */
    QuerySolutionComponent.prototype._resetFieldConfigs;
    /** @type {?} */
    QuerySolutionComponent.prototype.defaultConfigs;
    /**
     * 系统预置查询方案名称
     * @type {?}
     */
    QuerySolutionComponent.prototype.presetQuerySolutionName;
    /**
     * 此值由设计器传入
     * 组件在设计时无法点击被禁用，true
     * 组件在运行时可以点击使用，false
     * @type {?}
     */
    QuerySolutionComponent.prototype.isDisabled;
    /**
     * 表单ID，必选字段，表示查询方案所属的表单
     * @type {?}
     */
    QuerySolutionComponent.prototype.formId;
    /**
     * sessionId
     * @type {?}
     */
    QuerySolutionComponent.prototype.sessionId;
    /**
     * 查询条件列表
     * @type {?}
     */
    QuerySolutionComponent.prototype.queryEmitter;
    /**
     * 查询方案cls
     * @type {?}
     */
    QuerySolutionComponent.prototype.cls;
    /**
     * 查询方案数据源
     * @type {?}
     */
    QuerySolutionComponent.prototype.querySolutionVos;
    /**
     * 当前所选的方案，有可能不是方案
     * @type {?}
     */
    QuerySolutionComponent.prototype.selectedSolution;
    /**
     * 是否折叠
     * @type {?}
     */
    QuerySolutionComponent.prototype.isFold;
    /**
     * label和控件是否排成一行，默认是；false时排成上下两行
     * @type {?}
     */
    QuerySolutionComponent.prototype.isControlInline;
    /**
     * 是否需要完整显示超过6个字符的标签，默认false
     * @type {?}
     */
    QuerySolutionComponent.prototype.showCompleteLabel;
    /**
     * 是否启用加载后查询
     * @type {?}
     */
    QuerySolutionComponent.prototype.enableInitQuery;
    /**
     * 默认方案
     * @type {?}
     */
    QuerySolutionComponent.prototype.defaultQuerySolution;
    /**
     * 选择的控件展示列表
     * @type {?}
     */
    QuerySolutionComponent.prototype.selectedFieldConditions;
    /** @type {?} */
    QuerySolutionComponent.prototype.sysQuerySolutionVo;
    /** @type {?} */
    QuerySolutionComponent.prototype.showSaveButton;
    /** @type {?} */
    QuerySolutionComponent.prototype.isSetDefaultValue;
    /** @type {?} */
    QuerySolutionComponent.prototype.doneSetDefaultValue;
    /** @type {?} */
    QuerySolutionComponent.prototype.doneInitQuery;
    /**
     * 组件服务接口
     * @type {?}
     */
    QuerySolutionComponent.prototype.solutionHandler;
    /** @type {?} */
    QuerySolutionComponent.prototype.cdf;
    /**
     * 条件概要
     * @type {?}
     */
    QuerySolutionComponent.prototype.summaryConditions;
    /** @type {?} */
    QuerySolutionComponent.prototype.eventManager;
    /**
     * 是否启用记录历史方式
     * 上次查询——不能删除、可以另存、不存在变更
     * 方案列表只有上次查询时，上次查询、系统默认都存在
     * 方案列表多个时，有上次查询，上次查询选中
     * 方案列表没有上次查询时，但是LocalStorage有,构造一个上次查询
     *
     * @type {?}
     */
    QuerySolutionComponent.prototype.enableHistory;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.historyRefer;
    /** @type {?} */
    QuerySolutionComponent.prototype.farrisQueryCondition;
    /** @type {?} */
    QuerySolutionComponent.prototype.manageDialog;
    /** @type {?} */
    QuerySolutionComponent.prototype.saveAsDialog;
    /** @type {?} */
    QuerySolutionComponent.prototype._self;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype._idSer;
    /** @type {?} */
    QuerySolutionComponent.prototype.newSaveAsSolutionVo;
    /** @type {?} */
    QuerySolutionComponent.prototype.handleKeyDown;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.convertService;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.solutionService;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.httpService;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.fieldConfigService;
    /**
     * @type {?}
     * @private
     */
    QuerySolutionComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnktc29sdXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1jbXAvcXVlcnlzb2x1dGlvbi8iLCJzb3VyY2VzIjpbImxpYi9xdWVyeS1zb2x1dGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsT0FBTyxFQUNILFNBQVMsRUFBVSxpQkFBaUIsRUFBRSxXQUFXLEVBQW9CLHdCQUF3QixFQUM3RixRQUFRLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQTRCLGlCQUFpQixFQUN6SCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUM5RSxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUN4RixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDN0MsT0FBTyxFQUNVLGdCQUFnQixFQUFrQix1QkFBdUIsRUFBRSxlQUFlLEVBRTFGLE1BQU0sa0NBQWtDLENBQUM7QUFDMUMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQWMsTUFBTSxrQkFBa0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDcEQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDbkUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLGVBQWUsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQzdGLE9BQU8sRUFBeUIsMkJBQTJCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN2RyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUN0QyxPQUFP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QVMsU0FBQyxjQUFjOzs7O0lBckt6QiwrQ0FBMEM7O0lBQzFDLHFEQUFnRDs7SUFDaEQsb0RBQWlDOztJQUNqQyxnREFDK0I7Ozs7O0lBZS9CLHlEQUF5Qzs7Ozs7OztJQTJDekMsNENBQXFDOzs7OztJQUlyQyx3Q0FBd0I7Ozs7O0lBS3hCLDJDQUFrQjs7Ozs7SUFLbEIsOENBQXNGOzs7OztJQUt0RixxQ0FBNkM7Ozs7O0lBSzdDLGtEQUF3RTs7Ozs7SUFLeEUsa0RBQTBEOzs7OztJQUsxRCx3Q0FBaUM7Ozs7O0lBS2pDLGlEQUF5Qzs7Ozs7SUFLekMsbURBQTRDOzs7OztJQUs1QyxpREFBMEM7Ozs7O0lBSTFDLHNEQUFzQzs7Ozs7SUFLdEMseURBQTZFOztJQUM3RSxvREFBb0M7O0lBRXBDLGdEQUF3Qjs7SUFHeEIsbURBQW1DOztJQUduQyxxREFBcUM7O0lBR3JDLCtDQUE4Qjs7Ozs7SUFROUIsaURBQXVDOztJQUN2QyxxQ0FBdUI7Ozs7O0lBSXZCLG1EQUFzQjs7SUFDdEIsOENBQTJCOzs7Ozs7Ozs7O0lBUzNCLCtDQUF3Qzs7Ozs7SUFDeEMsOENBS0M7O0lBRUQsc0RBQWlGOztJQUNqRiw4Q0FBbUU7O0lBQ25FLDhDQUErRDs7SUFDL0QsdUNBQVc7Ozs7O0lBQ1gsd0NBQTBCOztJQW9WMUIscURBbUJDOztJQTRSRCwrQ0FHQzs7Ozs7SUFyb0JXLHdDQUE2Qjs7Ozs7SUFBRSwwQ0FBMEM7Ozs7O0lBQUUsMENBQTBCOzs7OztJQUM3Ryw4Q0FBb0M7Ozs7O0lBQUUsZ0RBQXdDOzs7OztJQUFFLGlEQUF3Qzs7Ozs7SUFDeEgsNkNBQWdDOzs7OztJQUFFLG9EQUE4Qzs7Ozs7SUFBRSwrQ0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdFbmNhcHN1bGF0aW9uLCBIb3N0QmluZGluZywgQ29tcG9uZW50RmFjdG9yeSwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgSW5qZWN0b3IsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBJbmplY3RGbGFncywgRWxlbWVudFJlZiwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgT25EZXN0cm95LCBPcHRpb25hbFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTYXZlQXNEaWFsb2dDb21wb25lbnQgfSBmcm9tICcuL3NhdmVhc2RpYWxvZy9zYXZlYXNkaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHsgU29sdXRpb25NYW5hbmdlckNvbXBvbmVudCB9IGZyb20gJy4vc29sdXRpb25tYW5hZ2VyL3NvbHV0aW9ubWFuYWdlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcclxuaW1wb3J0IHtcclxuICAgIEZpZWxkQ29uZmlnLCBDb252ZXJ0b3JTZXJ2aWNlLCBRdWVyeUNvbmRpdGlvbiwgUXVlcnlDb25kaXRpb25Db21wb25lbnQsIFF1ZXJ5U29sdXRpb25WbyxcclxuICAgIFNtYXJ0SGVscENvbnRvbCwgRHJvcERvd25MaXN0Q29udHJvbCwgQ2hlY2tCb3hDb250cm9sLCBSYWRpb0NvbnRyb2wsIElucHV0R3JvdXBDb250cm9sXHJcbn0gZnJvbSAnQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgQnNNb2RhbFJlZiB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJy4vc2VydmljZS9odHRwc2VydmljZSc7XHJcbmltcG9ydCB7IEZpZWxkQ29uZmlnU2VydmljZSB9IGZyb20gJy4vc2VydmljZS9maWVsZGNvbmZpZy5zZXJ2aWNlJztcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yLCBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICdAZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbic7XHJcbmltcG9ydCB7IElRdWVyeVNvbHV0aW9uSGFuZGxlciwgUVVFUllTT0xVVElPTl9IQU5ETEVSX1RPS0VOIH0gZnJvbSAnLi9pbnRlcmZhY2UvSVF1ZXJ5U29sdXRpb25IYW5kbGVyJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgU29sdXRpb25DYWNoZVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2Uvc29sdXRpb24uY2FjaGUuc2VydmljZSc7XHJcbmltcG9ydCB7IERlZmF1bHRDb25maWdzIH0gZnJvbSAnLi9pbnRlcmZhY2UvRGVmYXVsdENvbmZpZ3MnO1xyXG5pbXBvcnQgeyBFdmVudE1hbmFnZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuaW1wb3J0IHsgSWRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5cclxuZGVjbGFyZSB2YXIgZ3NwZnJhbWV3b3JrU2VydmljZTogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy1xdWVyeXNvbHV0aW9uJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9xdWVyeS1zb2x1dGlvbi5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9xdWVyeS1zb2x1dGlvbi5jb21wb25lbnQuY3NzJ10sXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gICAgcHJvdmlkZXJzOiBbSHR0cFNlcnZpY2UsIENvbnZlcnRvclNlcnZpY2UsIEZpZWxkQ29uZmlnU2VydmljZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIFF1ZXJ5U29sdXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuXHJcbiAgICBfZmllbGRDb25maWdzOiBBcnJheTxRdWVyeUNvbmRpdGlvbj4gPSBbXTtcclxuICAgIF9wcmVzZXRGaWVsZENvbmZpZ3M6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPiA9IFtdO1xyXG4gICAgX3Jlc2V0RmllbGRDb25maWdzOkFycmF5PGFueT49W107XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZGVmYXVsdENvbmZpZ3M6IERlZmF1bHRDb25maWdzO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlrZfmrrXphY3nva7mlbDmja7mupDvvIznlKjkuo7pgInmi6nlrZfmrrXphY3nva5cclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBmaWVsZENvbmZpZ3MoZmllbGRDb25maWdKc29uOiBBcnJheTxhbnk+KSB7XHJcbiAgICAgICAgdGhpcy5fZmllbGRDb25maWdzID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuY29udmVydFRvUXVlcnlDb25kaXRpb25zKGZpZWxkQ29uZmlnSnNvbik7XHJcbiAgICB9XHJcbiAgICBnZXQgZmllbGRDb25maWdzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maWVsZENvbmZpZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDns7vnu5/pooTnva7mn6Xor6LmlrnmoYjlkI3np7BcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgcHJlc2V0UXVlcnlTb2x1dGlvbk5hbWU6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIFxyXG4gICAgc2V0IHJlc2V0RmllbGRDb25maWdzKHJlc2V0RmllbGRDb25maWdKc29uOkFycmF5PGFueT4pe1xyXG4gICAgICAgIGlmKCFyZXNldEZpZWxkQ29uZmlnSnNvbnx8cmVzZXRGaWVsZENvbmZpZ0pzb24ubGVuZ3RoPT0wKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDop4TojIPmlbDmja5cclxuICAgICAgICBsZXQgZm9ybWF0UmVzZXRDb25maWdKc29uPXJlc2V0RmllbGRDb25maWdKc29uLm1hcCh0Q29uZmlnSXRlbT0+e1xyXG4gICAgICAgICAgICBsZXQgZmluZEl0ZW09IHRoaXMucHJlc2V0RmllbGRDb25maWdzLmZpbmQocHJlc2V0SXRlbT0+cHJlc2V0SXRlbVsnZmllbGRDb2RlJ109PXRDb25maWdJdGVtWydsYWJlbENvZGUnXSk7XHJcbiAgICAgICAgICAgIGlmKGZpbmRJdGVtKXtcclxuICAgICAgICAgICAgICAgIHRDb25maWdJdGVtWydjb250cm9sJ11bJ2NvbnRyb2x0eXBlJ109ZmluZEl0ZW0uY29udHJvbC5nZXRDb250cm9sVHlwZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRDb25maWdJdGVtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9yZXNldEZpZWxkQ29uZmlncz10aGlzLnNvbHV0aW9uU2VydmljZS5jb252ZXJ0VG9TaW1wbGVRdWVyeUNvbmRpdGlvbnMoZm9ybWF0UmVzZXRDb25maWdKc29uKTtcclxuICAgICAgICAvLyDmm7TmlrDlt7LmnInphY3nva5cclxuICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS51cGRhdGVDb250cm9sKHRoaXMuX3ByZXNldEZpZWxkQ29uZmlncyx0aGlzLl9yZXNldEZpZWxkQ29uZmlncyk7XHJcbiAgICAgICAgLy8g5pu05paw5bey5pyJ55qE5pa55qGIXHJcbiAgICAgICAgdGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8mJnRoaXMuc29sdXRpb25TZXJ2aWNlLnVwZGF0ZUNvbnRyb2wodGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zLHRoaXMuX3Jlc2V0RmllbGRDb25maWdzKTtcclxuICAgICAgICAvLyDmm7TmlrDljoblj7LorrDlvZVcclxuICAgICAgICB0aGlzLmhpc3RvcnlSZWZlclsnZm91bmRTY2htZSddJiZ0aGlzLnNvbHV0aW9uU2VydmljZS51cGRhdGVDb250cm9sKHRoaXMuaGlzdG9yeVJlZmVyWydmb3VuZFNjaG1lJ10ucXVlcnlDb25kaXRpb25zLHRoaXMuX3Jlc2V0RmllbGRDb25maWdzKTtcclxuICAgICAgICAvLyDmm7TmlrDlt7LpgIlcclxuICAgICAgICB0aGlzLnNlbGVjdGVkU29sdXRpb24mJnRoaXMuc29sdXRpb25TZXJ2aWNlLnVwZGF0ZUNvbnRyb2wodGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucyx0aGlzLl9yZXNldEZpZWxkQ29uZmlncyk7XHJcbiAgICB9XHJcbiAgICBnZXQgcmVzZXRGaWVsZENvbmZpZ3MoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVzZXRGaWVsZENvbmZpZ3M7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmihOe9ruafpeivouWtl+autVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHByZXNldEZpZWxkQ29uZmlncyhwcmVzZXRGaWVsZENvbmZpZ0pzb246IEFycmF5PGFueT4pIHtcclxuICAgICAgICB0aGlzLl9wcmVzZXRGaWVsZENvbmZpZ3MgPSB0aGlzLnNvbHV0aW9uU2VydmljZS5jb252ZXJ0VG9RdWVyeUNvbmRpdGlvbnMocHJlc2V0RmllbGRDb25maWdKc29uKTtcclxuICAgIH1cclxuICAgIGdldCBwcmVzZXRGaWVsZENvbmZpZ3MoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByZXNldEZpZWxkQ29uZmlncztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOatpOWAvOeUseiuvuiuoeWZqOS8oOWFpVxyXG4gICAgICog57uE5Lu25Zyo6K6+6K6h5pe25peg5rOV54K55Ye76KKr56aB55So77yMdHJ1ZVxyXG4gICAgICog57uE5Lu25Zyo6L+Q6KGM5pe25Y+v5Lul54K55Ye75L2/55So77yMZmFsc2VcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXNEaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoqXHJcbiAgICAgKiDooajljZVJRO+8jOW/hemAieWtl+aute+8jOihqOekuuafpeivouaWueahiOaJgOWxnueahOihqOWNlVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBmb3JtSWQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIHNlc3Npb25JZFxyXG4gICAgICovXHJcbiAgICBzZXNzaW9uSWQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOafpeivouadoeS7tuWIl+ihqFxyXG4gICAgICovXHJcbiAgICBAT3V0cHV0KCkgcXVlcnlFbWl0dGVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8QXJyYXk8UXVlcnlDb25kaXRpb24+PigpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+l6K+i5pa55qGIY2xzXHJcbiAgICAgKi9cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MnKSBjbHMgPSAncXVlcnktc29sdXRpb24nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+l6K+i5pa55qGI5pWw5o2u5rqQXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5U29sdXRpb25Wb3M6IEFycmF5PFF1ZXJ5U29sdXRpb25Wbz4gPSBuZXcgQXJyYXk8UXVlcnlTb2x1dGlvblZvPigpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5b2T5YmN5omA6YCJ55qE5pa55qGI77yM5pyJ5Y+v6IO95LiN5piv5pa55qGIXHJcbiAgICAgKi9cclxuICAgIHNlbGVjdGVkU29sdXRpb246IFF1ZXJ5U29sdXRpb25WbyA9IG5ldyBRdWVyeVNvbHV0aW9uVm8oKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuaKmOWPoFxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBpc0ZvbGQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIGxhYmVs5ZKM5o6n5Lu25piv5ZCm5o6S5oiQ5LiA6KGM77yM6buY6K6k5piv77ybZmFsc2Xml7bmjpLmiJDkuIrkuIvkuKTooYxcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXNDb250cm9sSW5saW5lOiBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpumcgOimgeWujOaVtOaYvuekuui2hei/hzbkuKrlrZfnrKbnmoTmoIfnrb7vvIzpu5jorqRmYWxzZVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBzaG93Q29tcGxldGVMYWJlbDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5ZCv55So5Yqg6L295ZCO5p+l6K+iXHJcbiAgICAqL1xyXG4gICAgQElucHV0KCkgZW5hYmxlSW5pdFF1ZXJ5OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIOm7mOiupOaWueahiFxyXG4gICAgICovXHJcbiAgICBkZWZhdWx0UXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YCJ5oup55qE5o6n5Lu25bGV56S65YiX6KGoXHJcbiAgICAgKi9cclxuICAgIHNlbGVjdGVkRmllbGRDb25kaXRpb25zOiBBcnJheTxRdWVyeUNvbmRpdGlvbj4gPSBuZXcgQXJyYXk8UXVlcnlDb25kaXRpb24+KCk7XHJcbiAgICBzeXNRdWVyeVNvbHV0aW9uVm86IFF1ZXJ5U29sdXRpb25WbztcclxuXHJcbiAgICBzaG93U2F2ZUJ1dHRvbjogYm9vbGVhbjtcclxuXHJcbiAgICAvL+aWueahiOaYr+WQpui1i+m7mOiupOWAvFxyXG4gICAgaXNTZXREZWZhdWx0VmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICAvL+aWueahiOaYr+WQpuW3sui1i+m7mOiupOWAvFxyXG4gICAgZG9uZVNldERlZmF1bHRWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIC8v5piv5ZCm5bey5a6M5oiQ6Ieq5Yqo5p+l6K+i77yM6buY6K6k5YC85Li6dHJ1Ze+8jOW9k2VuYWJsZUluaXRRdWVyeei+k+WFpeWAvOS4unRydWXml7bvvIzpppbmrKHmiafooYxuZ09uY2hhbmdlcygp5pe25bCG5YW26K6+5Li6ZmFsc2VcclxuICAgIGRvbmVJbml0UXVlcnk6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIC8v562b6YCJ5oyJ6ZKu5piv5ZCm5Zyo55WM6Z2i5Y+z5L6nXHJcbiAgICAvL3F1ZXJ5QnV0dG9uT25SaWdodDogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnu4Tku7bmnI3liqHmjqXlj6NcclxuICAgICovXHJcbiAgICBzb2x1dGlvbkhhbmRsZXI6IElRdWVyeVNvbHV0aW9uSGFuZGxlcjtcclxuICAgIGNkZjogQ2hhbmdlRGV0ZWN0b3JSZWY7XHJcbiAgICAvKipcclxuICAgICAqIOadoeS7tuamguimgVxyXG4gICAgICovXHJcbiAgICBzdW1tYXJ5Q29uZGl0aW9ucyA9IFtdXHJcbiAgICBldmVudE1hbmFnZXI6IEV2ZW50TWFuYWdlcjtcclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5ZCv55So6K6w5b2V5Y6G5Y+y5pa55byPXHJcbiAgICAgKiDkuIrmrKHmn6Xor6LigJTigJTkuI3og73liKDpmaTjgIHlj6/ku6Xlj6blrZjjgIHkuI3lrZjlnKjlj5jmm7RcclxuICAgICAqIOaWueahiOWIl+ihqOWPquacieS4iuasoeafpeivouaXtu+8jOS4iuasoeafpeivouOAgeezu+e7n+m7mOiupOmDveWtmOWcqFxyXG4gICAgICog5pa55qGI5YiX6KGo5aSa5Liq5pe277yM5pyJ5LiK5qyh5p+l6K+i77yM5LiK5qyh5p+l6K+i6YCJ5LitXHJcbiAgICAgKiDmlrnmoYjliJfooajmsqHmnInkuIrmrKHmn6Xor6Lml7bvvIzkvYbmmK9Mb2NhbFN0b3JhZ2XmnIks5p6E6YCg5LiA5Liq5LiK5qyh5p+l6K+iXHJcbiAgICAgKiBcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgZW5hYmxlSGlzdG9yeTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBoaXN0b3J5UmVmZXIgPSB7XHJcbiAgICAgICAgc2NoZW1lS2V5OiAnJywvLyDljoblj7LorrDlvZVzY2hlbWVcclxuICAgICAgICBmb3VuZFNjaG1lOiBudWxsLC8vIOWOhuWPsuaWueahiOS/neWtmFxyXG4gICAgICAgIHNjaGVtZUtleUxTOiAnJywvL0xvY2FsU3RvcmFnZSDljoblj7LorrDlvZXmoIforrBcclxuICAgICAgICBpbml0Q29uZGl0aW9uOiBmYWxzZS8vTG9jYWxTdG9yYWdl5piv5ZCm5oyJ54Wn5omn6KGM5a6M5p+l6K+iXHJcbiAgICB9XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnZmFycmlzUXVlcnlDb25kaXRpb24nKSBmYXJyaXNRdWVyeUNvbmRpdGlvbjogUXVlcnlDb25kaXRpb25Db21wb25lbnQ7XHJcbiAgICBAVmlld0NoaWxkKCdtYW5hZ2VEaWFsb2cnKSBtYW5hZ2VEaWFsb2c6IFNvbHV0aW9uTWFuYW5nZXJDb21wb25lbnQ7XHJcbiAgICBAVmlld0NoaWxkKCdzYXZlQXNEaWFsb2cnKSBzYXZlQXNEaWFsb2c6IFNhdmVBc0RpYWxvZ0NvbXBvbmVudDtcclxuICAgIF9zZWxmOiBhbnk7XHJcbiAgICBwcml2YXRlIF9pZFNlcjogSWRTZXJ2aWNlO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLCBwcml2YXRlIGNvbnZlcnRTZXJ2aWNlOiBDb252ZXJ0b3JTZXJ2aWNlLCBwcml2YXRlIHNvbHV0aW9uU2VydmljZTogU29sdXRpb25TZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgaHR0cFNlcnZpY2U6IEh0dHBTZXJ2aWNlLCBwcml2YXRlIGZpZWxkQ29uZmlnU2VydmljZTogRmllbGRDb25maWdTZXJ2aWNlLCBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2UpIHtcclxuICAgICAgICB0aGlzLl9pZFNlciA9IG5ldyBJZFNlcnZpY2UoKTtcclxuICAgICAgICB0aGlzLnNvbHV0aW9uSGFuZGxlciA9IHRoaXMuaW5qZWN0b3IuZ2V0PElRdWVyeVNvbHV0aW9uSGFuZGxlcj4oUVVFUllTT0xVVElPTl9IQU5ETEVSX1RPS0VOLCBudWxsLCBJbmplY3RGbGFncy5PcHRpb25hbCk7XHJcbiAgICAgICAgdGhpcy5fc2VsZiA9IHRoaXMuaW5qZWN0b3IuZ2V0KEVsZW1lbnRSZWYpO1xyXG4gICAgICAgIHRoaXMuY2RmID0gdGhpcy5pbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gdGhpcy5pbmplY3Rvci5nZXQoRXZlbnRNYW5hZ2VyKTtcclxuICAgIH1cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3NlbGYubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmhhbmRsZUtleURvd24pO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2hhbmdlc1snZGVmYXVsdENvbmZpZ3MnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmlzU2V0RGVmYXVsdFZhbHVlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKGNoYW5nZXNbJ2RlZmF1bHRDb25maWdzJ10uY3VycmVudFZhbHVlICYmICFjaGFuZ2VzWydkZWZhdWx0Q29uZmlncyddLmZpcnN0Q2hhbmdlKSB7Ly/orr7orqHml7bkuI3kvJrnu5lkZWZhdWx0Q29uZmlnc+i1i+WAvFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRRdWVyeUNvbmRpdGlvblZhbHVlcyhjaGFuZ2VzWydkZWZhdWx0Q29uZmlncyddLmN1cnJlbnRWYWx1ZSwgdGhpcy5zZWxlY3RlZFNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdEF1dG9RdWVyeSh0aGlzLnNlbGVjdGVkU29sdXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjaGFuZ2VzWydlbmFibGVJbml0UXVlcnknXSAmJiBjaGFuZ2VzWydlbmFibGVJbml0UXVlcnknXS5maXJzdENoYW5nZSAmJiBjaGFuZ2VzWydlbmFibGVJbml0UXVlcnknXS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kb25lSW5pdFF1ZXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog57uE5Lu25Yid5aeL5YyWXHJcbiAgICAgKi9cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8v5Y+q5Zyo6L+Q6KGM5pe2IOiOt+WPlnNlc3Npb25JZO+8jOafpeivouW3suWtmOWCqOaWueahiFxyXG4gICAgICAgIHRoaXMuaW5pdFN5c1F1ZXJ5U29sdXRpb24oKTtcclxuICAgICAgICBpZiAoIXRoaXMuaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlc3Npb25JZCA9IHRoaXMuc29sdXRpb25IYW5kbGVyLmdldFVzZXJTZXNzaW9uSWQoKTtcclxuICAgICAgICAgICAgLy8g57yT5a2Y5Y6G5Y+y5pa55qGIXHJcbiAgICAgICAgICAgIHRoaXMuaW5pdEF1dG9RdWVyeUJ5TFMoKTtcclxuICAgICAgICAgICAgLy8g5Yqg6L295pa55qGI5YiX6KGoXHJcbiAgICAgICAgICAgIHRoaXMubG9hZFF1ZXJ5U29sdXRpb25zKCk7XHJcbiAgICAgICAgICAgIC8v5rOo5YaM6ZSu55uY55uR5ZCs5LqL5Lu2XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuS2V5Qm9hcmQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL+iuvuiuoeaXtuWPquWKoOi9veezu+e7n+mihOe9ruaWueahiFxyXG4gICAgICAgICAgICB0aGlzLmxvYWRTeXNRdWVyeVNvbHV0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGluaXRTeXNRdWVyeVNvbHV0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnByZXNldFF1ZXJ5U29sdXRpb25OYW1lICYmIHRoaXMucHJlc2V0UXVlcnlTb2x1dGlvbk5hbWUgIT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8gPSBuZXcgUXVlcnlTb2x1dGlvblZvKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvLmlkID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0R3VpZCgpO1xyXG4gICAgICAgICAgICB0aGlzLnN5c1F1ZXJ5U29sdXRpb25Wby5jb2RlID0gKHRoaXMucHJlc2V0UXVlcnlTb2x1dGlvbk5hbWUgIT0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIuc3lzUHJlc2V0TmFtZVwiKSkgPyB0aGlzLnByZXNldFF1ZXJ5U29sdXRpb25OYW1lIDogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIuZGVmYXVsdE5hbWVcIik7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvLnF1ZXJ5Q29uZGl0aW9ucyA9IGNsb25lRGVlcCh0aGlzLnByZXNldEZpZWxkQ29uZmlncyk7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvLmJlbG9uZ0lkID0gdGhpcy5mb3JtSWQ7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvLmlzU3lzdGVtID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gdGhpcy5xdWVyeVNvbHV0aW9uVm9zLnB1c2godGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veezu+e7n+mihOe9ruaWueahiFxyXG4gICAgKi9cclxuICAgIGxvYWRTeXNRdWVyeVNvbHV0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcy5wdXNoKHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkU29sdXRpb24gPSBjbG9uZURlZXAodGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8pO1xyXG4gICAgICAgIHRoaXMubG9hZFF1ZXJ5Q29uZGl0aW9ucygpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDop4TojIPmlrnmoYjmnaHku7ZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBmb3JtYXRRdWVyeVNvbHV0aW9uVk8odENvbnZlcnRvcjogUXVlcnlTb2x1dGlvblZvQ29udmVydG9yLCBlbGVtZW50LCBmcm9tSm9iamVjdCA9IGZhbHNlKTogUXVlcnlTb2x1dGlvblZvIHtcclxuICAgICAgICBsZXQgcXVlcnlzb2x1dGlvblZPOiBRdWVyeVNvbHV0aW9uVm87XHJcbiAgICAgICAgbGV0IHNvdXJjZURhdGE6IGFueTtcclxuICAgICAgICBsZXQgX2ZpZWxkQ29kZUFycjogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgICAgIGxldCBfdFF1ZXJ5Q29uZGl0aW9uczogQXJyYXk8UXVlcnlDb25kaXRpb24+O1xyXG4gICAgICAgIGlmIChmcm9tSm9iamVjdCkge1xyXG4gICAgICAgICAgICBxdWVyeXNvbHV0aW9uVk8gPSB0Q29udmVydG9yLmluaXRGcm9tSm9iamVjdChlbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBxdWVyeXNvbHV0aW9uVk8gPSBlbGVtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpZWxkQ29uZmlncy5mb3JFYWNoKF9pdGVtID0+IHsgX2ZpZWxkQ29kZUFyci5wdXNoKF9pdGVtLmZpZWxkQ29kZSkgfSk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5c29sdXRpb25WTyAmJiBxdWVyeXNvbHV0aW9uVk8ucXVlcnlDb25kaXRpb25zICYmIHF1ZXJ5c29sdXRpb25WTy5xdWVyeUNvbmRpdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvL+iLpeihqOWNleS4iuWIoOmZpOS6huafkOS4quWtl+aute+8jOS9huW3suS/neWtmOeahOiHquWumuS5ieaWueahiOS4reWMheWQq+ivpeWtl+auteaXtu+8jOWcqOWKoOi9veaWueahiOi/h+eoi+S4reWwhuivpeWtl+auteWJlOmZpFxyXG4gICAgICAgICAgICBfdFF1ZXJ5Q29uZGl0aW9ucyA9IHF1ZXJ5c29sdXRpb25WTy5xdWVyeUNvbmRpdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2ZpZWxkQ29kZUFyci5pbmRleE9mKGVsZW1lbnQuZmllbGRDb2RlKSA+IC0xO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcXVlcnlzb2x1dGlvblZPLnF1ZXJ5Q29uZGl0aW9ucyA9IF90UXVlcnlDb25kaXRpb25zO1xyXG5cclxuICAgICAgICAgICAgLy/lr7noh6rlrprkuYnmlrnmoYjnmoTlm73pmYXljJbkv6Hmga/jgIHluK7liqnmjqfku7bnmoTluK7liqnliY3lj4rluK7liqnlkI7kuovku7bov5vooYzliqjmgIHotYvlgLxcclxuICAgICAgICAgICAgcXVlcnlzb2x1dGlvblZPLnF1ZXJ5Q29uZGl0aW9ucy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgc291cmNlRGF0YSA9IHRoaXMuZmllbGRDb25maWdzLmZpbmQoX2l0ZW0gPT4gX2l0ZW0uZmllbGRDb2RlID09IGVsZW1lbnQuZmllbGRDb2RlKTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZmllbGROYW1lID0gc291cmNlRGF0YS5maWVsZE5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnBsYWNlSG9sZGVyID0gc291cmNlRGF0YS5wbGFjZUhvbGRlcjtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYmVnaW5QbGFjZUhvbGRlciA9c291cmNlRGF0YS5oYXNPd25Qcm9wZXJ0eSgnYmVnaW5QbGFjZUhvbGRlcicpP3NvdXJjZURhdGFbJ2JlZ2luUGxhY2VIb2xkZXInXTonJztcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZW5kUGxhY2VIb2xkZXIgPXNvdXJjZURhdGEuaGFzT3duUHJvcGVydHkoJ2VuZFBsYWNlSG9sZGVyJyk/c291cmNlRGF0YVsnZW5kUGxhY2VIb2xkZXInXTonJzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZURhdGEuY29udHJvbC5wcmVFdmVudENtZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIChlbGVtZW50LmNvbnRyb2wgYXMgU21hcnRIZWxwQ29udG9sKS5wcmVFdmVudENtZCA9IHNvdXJjZURhdGEuY29udHJvbC5wcmVFdmVudENtZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChzb3VyY2VEYXRhLmNvbnRyb2wucG9zdEV2ZW50Q21kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgKGVsZW1lbnQuY29udHJvbCBhcyBTbWFydEhlbHBDb250b2wpLnBvc3RFdmVudENtZCA9IHNvdXJjZURhdGEuY29udHJvbC5wb3N0RXZlbnRDbWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlRGF0YS5jb250cm9sLmNsZWFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgKGVsZW1lbnQuY29udHJvbCBhcyBTbWFydEhlbHBDb250b2wpLmNsZWFyID0gc291cmNlRGF0YS5jb250cm9sLmNsZWFyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZURhdGEuY29udHJvbC5jbGljaykge1xyXG4gICAgICAgICAgICAgICAgICAgIChlbGVtZW50LmNvbnRyb2wgYXMgSW5wdXRHcm91cENvbnRyb2wpLmNsaWNrID0gc291cmNlRGF0YS5jb250cm9sLmNsaWNrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZURhdGEuY29udHJvbC5lbnVtVmFsdWVzICYmIHNvdXJjZURhdGEuY29udHJvbC5lbnVtVmFsdWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAoZWxlbWVudC5jb250cm9sIGFzIERyb3BEb3duTGlzdENvbnRyb2wpLmVudW1WYWx1ZXMgPSBzb3VyY2VEYXRhLmNvbnRyb2wuZW51bVZhbHVlcztcclxuICAgICAgICAgICAgICAgICAgICAoZWxlbWVudC5jb250cm9sIGFzIFJhZGlvQ29udHJvbCkuZW51bVZhbHVlcyA9IHNvdXJjZURhdGEuY29udHJvbC5lbnVtVmFsdWVzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZURhdGEuY29udHJvbC5kYXRhICYmIHNvdXJjZURhdGEuY29udHJvbC5kYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAoZWxlbWVudC5jb250cm9sIGFzIENoZWNrQm94Q29udHJvbCkuZGF0YSA9IHNvdXJjZURhdGEuY29udHJvbC5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHF1ZXJ5c29sdXRpb25WTztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L295p+l6K+i5pa55qGI5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGxvYWRRdWVyeVNvbHV0aW9ucygpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLmh0dHBTZXJ2aWNlLnF1ZXJ5KHRoaXMuZm9ybUlkLCB0aGlzLnNlc3Npb25JZCkuc3Vic2NyaWJlKChpdGVtczogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yKCk7XHJcbiAgICAgICAgICAgIGxldCBxdWVyeXNvbHV0aW9uVk86IFF1ZXJ5U29sdXRpb25WbztcclxuICAgICAgICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlzb2x1dGlvblZPID0gdGhpcy5mb3JtYXRRdWVyeVNvbHV0aW9uVk8oY29udmVydG9yLCBlbGVtZW50LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaXN0b3J5ICYmIHF1ZXJ5c29sdXRpb25WT1sndHlwZSddID09ICdwcmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOi/lOWbnuWIl+ihqOWGheWtmOWcqOWOhuWPsuiusOW9lSAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeXNvbHV0aW9uVk8uY29kZT10aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5oaXN0cm95TmFtZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5UmVmZXJbJ3NjaGVtZUtleSddID0gcXVlcnlzb2x1dGlvblZPLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlSZWZlclsnZm91bmRTY2htZSddID0gY2xvbmVEZWVwKHF1ZXJ5c29sdXRpb25WTyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeVJlZmVyWydpbml0Q29uZGl0aW9uJ10gPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgdGhpcy5kZWZhdWx0UXVlcnlTb2x1dGlvbiA9IGNsb25lRGVlcChxdWVyeXNvbHV0aW9uVk8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihxdWVyeXNvbHV0aW9uVk9bJ3R5cGUnXSAhPSAncHJlJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcy5wdXNoKHF1ZXJ5c29sdXRpb25WTyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeXNvbHV0aW9uVk8uaXNEZWZhdWx0KSB7Ly/lpoLmnpzmnInpu5jorqTmlrnmoYjvvIzliJnorr7nva7lhajlsYDpu5jorqTmlrnmoYhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFF1ZXJ5U29sdXRpb24gPSBjbG9uZURlZXAocXVlcnlzb2x1dGlvblZPKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRTb2x1dGlvbkNhY2hlKHRoaXMucXVlcnlTb2x1dGlvblZvcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGlzdG9yeSAmJiAhdGhpcy5oaXN0b3J5UmVmZXJbJ2luaXRDb25kaXRpb24nXSkge1xyXG4gICAgICAgICAgICAgICAgLy/lpoLmnpzov5jmsqHmnInorr7nva7mnaHku7ZcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0SW5pdFF1ZXJ5U29sdXRpb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaXN0b3J5ICYmIHRoaXMuaGlzdG9yeVJlZmVyWydpbml0Q29uZGl0aW9uJ10pIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkU29sdXRpb24gPSBjbG9uZURlZXAodGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXSk7XHJcbiAgICAgICAgICAgICAgICAvL+WPquaciee8k+WtmOiusOW9lVxyXG4gICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uVm9zLnNwbGljZSgwLCAwLCB0aGlzLmhpc3RvcnlSZWZlclsnZm91bmRTY2htZSddKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5xdWVyeVNvbHV0aW9uVm9zLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5Y+q5pyJ5LiK5qyh5p+l6K+i5pe2XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uVm9zLnB1c2godGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRTb2x1dGlvbkNhY2hlKHRoaXMucXVlcnlTb2x1dGlvblZvcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRRdWVyeUNvbmRpdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgIC8vIGlmKHRoaXMuaGlzdG9yeVJlZmVyWydzY2hlbWVLZXknXSAhPT0gJycpe1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIC8v5pu05paw5LiA5qyh57yT5a2YXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5jaGFuZ2VRdWVyeUhpc3Ryb3koZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgLy8gfSAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRlZmF1bHRRdWVyeVNvbHV0aW9uIHx8IHRoaXMucXVlcnlTb2x1dGlvblZvcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8v5aaC5p6c5bey5p+l5Yiw5pyJ6buY6K6k5pa55qGI77yM5oiW5bey5pyJ5a2Y5YKo55qE5pa55qGIXHJcbiAgICAgICAgICAgICAgICAvL+S4jeWGjeWKoOi9veezu+e7n+mFjee9rueahOaWueahiO+8jOmmluWFiOWKoOi9vem7mOiupOaWueahiO+8jOayoeaciem7mOiupOWImeWKoOi9veesrOS4gOS4quaWueahiFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFF1ZXJ5U29sdXRpb24gJiYgdGhpcy5kZWZhdWx0UXVlcnlTb2x1dGlvbi5pZCAhPSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbiA9IGNsb25lRGVlcCh0aGlzLmRlZmF1bHRRdWVyeVNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNvbHV0aW9uID0gY2xvbmVEZWVwKHRoaXMucXVlcnlTb2x1dGlvblZvc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRRdWVyeUNvbmRpdGlvbnMoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8v5aaC5p6c5rKh5pyJ5Lu75L2V5bey5a2Y5YKo55qE5pa55qGI77yM5YiZ5Yqg6L2957O757uf6YWN572u5pa55qGIXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRTeXNRdWVyeVNvbHV0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2V0RGVmYXVsdFZhbHVlICYmICF0aGlzLmhpc3RvcnlSZWZlclsnaW5pdENvbmRpdGlvbiddKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFF1ZXJ5Q29uZGl0aW9uVmFsdWVzKHRoaXMuZGVmYXVsdENvbmZpZ3MsIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaW5pdEF1dG9RdWVyeSh0aGlzLnNlbGVjdGVkU29sdXRpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFNvbHV0aW9uQ2FjaGUocXVlcnlTb2x1dGlvblZvczogYW55KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQgJiYgZ3NwZnJhbWV3b3JrU2VydmljZSAmJiBxdWVyeVNvbHV0aW9uVm9zICYmIHF1ZXJ5U29sdXRpb25Wb3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluW9k+WJjeWKn+iDveiPnOWNleS/oeaBrywg5bm25Lul5Yqf6IO96I+c5Y2VSUTkuLrnvJPlrZhrZXlcclxuICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuc2Vzc2lvbi5nZXRDb21tb25WYXJpYWJsZSgpO1xyXG4gICAgICAgICAgICBTb2x1dGlvbkNhY2hlU2VydmljZS5zZXRTb2x1dGlvbkNhY2hlKG9wdGlvbi50YWJJZCwgcXVlcnlTb2x1dGlvblZvcyk7XHJcbiAgICAgICAgICAgIFNvbHV0aW9uQ2FjaGVTZXJ2aWNlLnNvbHV0aW9uTGlzdENoYW5nZWQubmV4dCh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q3VycmVudFNvbHV0aW9uQ2FjaGUodmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0Rpc2FibGVkICYmIGdzcGZyYW1ld29ya1NlcnZpY2UgJiYgdmFsdWUpIHtcclxuICAgICAgICAgICAgLy8g6I635Y+W5b2T5YmN5Yqf6IO96I+c5Y2V5L+h5oGvLCDlubbku6Xlip/og73oj5zljZVJROS4uue8k+WtmGtleVxyXG4gICAgICAgICAgICBjb25zdCBvcHRpb24gPSBnc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5zZXNzaW9uLmdldENvbW1vblZhcmlhYmxlKCk7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb24gJiYgb3B0aW9uLnRhYklkKSB7XHJcbiAgICAgICAgICAgICAgICBTb2x1dGlvbkNhY2hlU2VydmljZS5zZXRDdXJyZW50U29sdXRpb24ob3B0aW9uLnRhYklkLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbG9hZFF1ZXJ5Q29uZGl0aW9ucygpIHtcclxuICAgICAgICAvL+WKoOi9veetm+mAieadoeS7tlxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnMgPSBuZXcgQXJyYXk8UXVlcnlDb25kaXRpb24+KCk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRTb2x1dGlvbiAmJiB0aGlzLnNlbGVjdGVkU29sdXRpb24ucXVlcnlDb25kaXRpb25zICYmIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyB0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zID0gdGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucyBhcyBBcnJheTxRdWVyeUNvbmRpdGlvbj47XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnMgPSB0aGlzLnNlbGVjdGVkU29sdXRpb24ucXVlcnlDb25kaXRpb25zO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpzmlrnmoYjnmoTlj5jmm7TmmK/lnKjlj47mipjml7ZcclxuICAgICAgICB0aGlzLndoZW5Gb2xkU2V0U3VtbWFyeUNvbmRpdGlvbnMoKTtcclxuICAgICAgICB0aGlzLnNob3dTYXZlQnV0dG9uID0gdGhpcy5zZWxlY3RlZFNvbHV0aW9uLmlzU3lzdGVtID8gZmFsc2UgOiB0cnVlO1xyXG4gICAgICAgICF0aGlzLmlzRGlzYWJsZWQgJiYgdGhpcy5zb2x1dGlvbkhhbmRsZXIuc2V0Q3VycmVudFF1ZXJ5Q29uZGl0aW9ucyhjbG9uZURlZXAodGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucykpO1xyXG4gICAgICAgIHRoaXMuc2V0Q3VycmVudFNvbHV0aW9uQ2FjaGUodGhpcy5zZWxlY3RlZFNvbHV0aW9uKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2F2ZUFzKCkge1xyXG4gICAgICAgIHRoaXMub3BlblNhdmVBc0RpYWxvZyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLnNhdmVBc0RpYWxvZy50aXRsZVwiKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bpu5jorqTmoIfnrb5cclxuICAgICAqIEBwYXJhbSBzb2x1dGlvblxyXG4gICAgICovXHJcbiAgICBnZXREZWZhdWx0TGFiZWwoc29sdXRpb246IFF1ZXJ5U29sdXRpb25Wbykge1xyXG4gICAgICAgIGlmICghKHRoaXMuZGVmYXVsdFF1ZXJ5U29sdXRpb24pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7ICd2aXNpYmlsaXR5JzogJ2hpZGRlbicgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHNvbHV0aW9uLmlkID09IHRoaXMuZGVmYXVsdFF1ZXJ5U29sdXRpb24uaWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIC8v5LiN5aSE55CG5LqGXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyAndmlzaWJpbGl0eSc6ICdoaWRkZW4nIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaWueahiOmAieaLqeS6i+S7tlxyXG4gICAgICogQHBhcmFtIHNvbHV0aW9uIOW9k+WJjemAieS4reeahOaWueahiFxyXG4gICAgICovXHJcbiAgICBzZWxlY3Qoc29sdXRpb246IFF1ZXJ5U29sdXRpb25Wbykge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbiA9IE9iamVjdC5hc3NpZ24obmV3IFF1ZXJ5U29sdXRpb25WbygpLCBzb2x1dGlvbik7XHJcbiAgICAgICAgaWYgKHNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucyAmJiBzb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zID0gdGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnMgPSBuZXcgQXJyYXk8UXVlcnlDb25kaXRpb24+KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd1NhdmVCdXR0b24gPSB0aGlzLnNlbGVjdGVkU29sdXRpb24uaXNTeXN0ZW0gPyBmYWxzZSA6IHRydWU7XHJcbiAgICAgICAgIXRoaXMuaXNEaXNhYmxlZCAmJiB0aGlzLnNvbHV0aW9uSGFuZGxlci5zZXRDdXJyZW50UXVlcnlDb25kaXRpb25zKGNsb25lRGVlcCh0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zKSk7XHJcbiAgICAgICAgdGhpcy5zZXRDdXJyZW50U29sdXRpb25DYWNoZSh0aGlzLnNlbGVjdGVkU29sdXRpb24pO1xyXG4gICAgICAgIC8vIOWmguaenOaWueahiOeahOWPmOabtOaYr+WcqOWPjuaKmOaXtlxyXG4gICAgICAgIHRoaXMud2hlbkZvbGRTZXRTdW1tYXJ5Q29uZGl0aW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIHNlbGVjdEFuZFF1ZXJ5KHNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm8pIHtcclxuICAgICAgICBpZiAodGhpcy5kZWZhdWx0Q29uZmlncyAmJiB0aGlzLmRlZmF1bHRDb25maWdzLmlzQ3VycmVudHx8KHNvbHV0aW9uLmlzU3lzdGVtJiZzb2x1dGlvbi50eXBlIT09J3ByZScpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UXVlcnlDb25kaXRpb25WYWx1ZXModGhpcy5kZWZhdWx0Q29uZmlncywgc29sdXRpb24pOy8v5bey5YyF5ZCrc2VsZWN05pON5L2cXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGlzdG9yeSAmJiBzb2x1dGlvbi50eXBlID09ICdwcmUnKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29uZGl0aW9ucyA9IGNsb25lRGVlcCh0aGlzLmhpc3RvcnlSZWZlclsnZm91bmRTY2htZSddWydxdWVyeUNvbmRpdGlvbnMnXSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29sdXRpb24ucXVlcnlDb25kaXRpb25zID0gY29uZGl0aW9ucztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdChzb2x1dGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucXVlcnkoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5omT5byA5a2X5q616YWN572u56qX5Y+jXHJcbiAgICAgKi9cclxuICAgIG9wZW5GaWVsZENvbmZpZ0RpYWxvZygpIHtcclxuICAgICAgICB0aGlzLmZhcnJpc1F1ZXJ5Q29uZGl0aW9uLm9wZW5GaWVsZENvbmZpZ0RpYWxvZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpZWxkQ29uZGl0aW9uc0NoYW5nZUhhbmRlcigkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gJGV2ZW50O1xyXG4gICAgICAgIC8vIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnMgPSBkYXRhO+atpOaXtuS4jeaUueWPmOW9k+WJjemAieS4reeahOaWueahiO+8jOetieWIsOS/neWtmOaXtu+8jOebtOaOpeiwg+eUqHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnPmnaXkv53lrZjjgIJcclxuICAgICAgICB0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zID0gZGF0YTtcclxuICAgICAgICBpZiAoIXRoaXMuaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNvbHV0aW9uSGFuZGxlci5zZXRDdXJyZW50UXVlcnlDb25kaXRpb25zKGNsb25lRGVlcCh0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zKSk7XHJcbiAgICAgICAgICAgIHRoaXMuc29sdXRpb25IYW5kbGVyLnNldEZpbHRlckNvbmRpdGlvbnModGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucyk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q3VycmVudFNvbHV0aW9uQ2FjaGUodGhpcy5zZWxlY3RlZFNvbHV0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXJrQXNDaGFuZ2VkKHRydWUsIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5pZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDkv53lrZjmlrnmoYhcclxuICAgICAqL1xyXG4gICAgc2F2ZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZm9ybUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc29sdXRpb25TZXJ2aWNlLnNob3dJbmZvKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcInF1ZXJ5U29sdXRpb24uY29udGFpbmVyLnBsZWFzZUlucHV0XCIpLCAnZXJyb3InLCAnJywgMTUwMCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9pZOS4uuepuuWImeihqOekuuayoeaciemihOe9ruaWueahiO+8jOWImeatpOaXtuS/neWtmOaWueahiOebuOW9k+S6juaWsOWinuS4gOS4quaWueahiFxyXG4gICAgICAgIGlmICghdGhpcy5zZWxlY3RlZFNvbHV0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlblNhdmVBc0RpYWxvZyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5zYXZlXCIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/nm7TmjqXkv53lrZhcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucyA9IHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnM7XHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFNlcnZpY2UudXBkYXRlKHRoaXMuc2VsZWN0ZWRTb2x1dGlvbiwgdGhpcy5zZXNzaW9uSWQpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcEluZGV4ID0gdGhpcy5xdWVyeVNvbHV0aW9uVm9zLmZpbmRJbmRleCh4ID0+IHguaWQgPT0gdGhpcy5zZWxlY3RlZFNvbHV0aW9uLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zID0gdGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25Wb3Muc3BsaWNlKHRlbXBJbmRleCwgMSwgdGhpcy5zZWxlY3RlZFNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtBc0NoYW5nZWQoZmFsc2UsIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIuc2F2ZVN1Y2Nlc3NcIiksICdzdWNjZXNzJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5zaG93SW5mbyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5zYXZlRmFpbFwiKSwgJ2Vycm9yJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omT5byA5Y+m5a2Y5Li65a+56K+d5qGG77yM54K55Ye75L+d5a2Y5oyJ6ZKu5pe25Lmf6LWw6K+l6YC76L6RXHJcbiAgICAgKiBAcGFyYW0gdGl0bGVcclxuICAgICAqL1xyXG4gICAgb3BlblNhdmVBc0RpYWxvZyh0aXRsZTogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmZvcm1JZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5zaG93SW5mbyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5wbGVhc2VJbnB1dFwiKSwgJ2Vycm9yJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2F2ZUFzRGlhbG9nLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5zYXZlQXNEaWFsb2cucXVlcnlTb2x1dGlvbiA9IHRoaXMubmV3U2F2ZUFzU29sdXRpb25WbygpO1xyXG4gICAgICAgIHRoaXMuc2F2ZUFzRGlhbG9nLnNob3coKTtcclxuICAgIH1cclxuXHJcbiAgICBuZXdTYXZlQXNTb2x1dGlvblZvID0gKCkgPT4ge1xyXG4gICAgICAgIC8v5b2T5YmN6YCJ5Lit55qE5pa55qGI77yM5YaN5L+u5pS5562b6YCJ5p2h5Lu25ZCO77yM5YW25Y6f5p2l55qE562b6YCJ5p2h5Lu25bm25rKh5pyJ5Y+Y5YyW77yM5LuF5LuFdGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9uc+acieWPmOWMllxyXG4gICAgICAgIGNvbnN0IHNvbHV0aW9uID0gY2xvbmVEZWVwKHRoaXMuc2VsZWN0ZWRTb2x1dGlvbik7XHJcbiAgICAgICAgLy/mlrDlop7nmoTmlrnmoYjopoHmuIXnqbrmn6Xor6LmlrnmoYjnvJblj7dcclxuICAgICAgICBzb2x1dGlvbi5jb2RlID0gJyc7XHJcbiAgICAgICAgLy/mmK/lkKbns7vnu5/lsZ7mgKflv4Xpobvorr7nva7kuLpGYWxzZVxyXG4gICAgICAgIHNvbHV0aW9uLmlzU3lzdGVtID0gZmFsc2U7XHJcbiAgICAgICAgLy/op6PlhrPmlrnmoYjmiYDlsZ7ooajljZVcclxuICAgICAgICBzb2x1dGlvbi5iZWxvbmdJZCA9IHRoaXMuZm9ybUlkO1xyXG4gICAgICAgIC8v5paw5aKe5pa55qGISWTpnIDopoFHdWlkXHJcbiAgICAgICAgc29sdXRpb24uaWQgPSB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRHdWlkKCk7XHJcbiAgICAgICAgLy/mlrDlop7mlrnmoYhpc0RlZmF1bHTpnIDopoHorr7nva7kuLpmYWxzZVxyXG4gICAgICAgIHNvbHV0aW9uLmlzRGVmYXVsdCA9IGZhbHNlO1xyXG4gICAgICAgIC8v5paw5aKe5pa55qGI55qE562b6YCJ5p2h5Lu277yM5piv5b2T5YmN6YCJ5Lit55qE562b6YCJ5p2h5Lu2XHJcbiAgICAgICAgc29sdXRpb24ucXVlcnlDb25kaXRpb25zID0gdGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucztcclxuICAgICAgICAvL+iuvue9ruexu+Wei+imgea4heepulxyXG4gICAgICAgIHNvbHV0aW9uLnR5cGUgPSBcIlwiO1xyXG4gICAgICAgIHNvbHV0aW9uLmlzQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBzb2x1dGlvbjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPpuWtmOS4uuehruWumuS6i+S7tuWkhOeQhlxyXG4gICAgICogQHBhcmFtIHNvbHV0aW9uIOaWsOWinueahOafpeivouaWueahiFxyXG4gICAgICovXHJcbiAgICBzYXZlQXNDb25mcmltSGFuZGxlcihfZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm8gPSBfZXZlbnRbJ3F1ZXJ5U29sdXRpb24nXTtcclxuICAgICAgICBpZiAoc29sdXRpb24ucXVlcnlDb25kaXRpb25zICYmIHNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgc29sdXRpb24ucXVlcnlDb25kaXRpb25zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISFlbGVtZW50LnJlYWRvbmx5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZWFkb25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5odHRwU2VydmljZS5jcmVhdGUoc29sdXRpb24sIHRoaXMuc2Vzc2lvbklkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8v6YeN5paw6K6+572u5YWo5bGA55qE6buY6K6k5pa55qGIXHJcbiAgICAgICAgICAgICAgICBpZiAoc29sdXRpb24uaXNEZWZhdWx0KSB7Ly/ooqvorr7nva7kuLrpu5jorqTmlrnmoYhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeVNvbHV0aW9uID0gc29sdXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uVm9zID0gdGhpcy5xdWVyeVNvbHV0aW9uVm9zLm1hcCh2byA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZvLmlzRGVmYXVsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm87XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL+eUqOaIt+S/neWtmOiHquW3seeahOetm+mAieaWueahiOWQju+8jOS4jeWGjeaYvuekuuezu+e7n+m7mOiupOeahOaWueahiFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlTb2x1dGlvblZvcy5sZW5ndGggPT09IDEgJiYgdGhpcy5xdWVyeVNvbHV0aW9uVm9zWzBdLmlzU3lzdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/nlKjmiLfmsqHmnInphY3nva7oh6rlt7HnmoTnrZvpgInmlrnmoYjml7bvvIzmiJbogIXnlKjmiLflj6rphY3nva7kuobkuIDkuKrnrZvpgInmlrnmoYjml7bvvIzmraTmlbDnu4Tpg73mnInkuIDkuKrmlrnmoYjvvJvoi6XmraTmlrnmoYjmmK/ns7vnu5/pu5jorqTmlrnmoYjvvIzliJnlupTlnKjlj6blrZjkuLrml7bliKDmjolcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25Wb3MgPSBuZXcgQXJyYXk8UXVlcnlTb2x1dGlvblZvPigpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodGhpcy5xdWVyeVNvbHV0aW9uVm9zLmxlbmd0aD09PTImJnRoaXMuZW5hYmxlSGlzdG9yeSl7ICAgXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlclNvbHV0aW9uVm9zID0gbmV3IEFycmF5PFF1ZXJ5U29sdXRpb25Wbz4oKTsgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlclNvbHV0aW9uVm9zPXRoaXMucXVlcnlTb2x1dGlvblZvcy5maWx0ZXIoaXRlbT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLnR5cGU9PSdwcmUnKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhaXRlbS5pc1N5c3RlbVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uVm9zPWZpbHRlclNvbHV0aW9uVm9zO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcy5wdXNoKHNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbiA9IHNvbHV0aW9uO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93U2F2ZUJ1dHRvbiA9IHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5pc1N5c3RlbSA/IGZhbHNlIDogdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnMgPSB0aGlzLnNlbGVjdGVkU29sdXRpb24ucXVlcnlDb25kaXRpb25zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIuc2F2ZVN1Y2Nlc3NcIiksICdzdWNjZXNzJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5zaG93SW5mbyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5zYXZlRmFpbFwiKSwgJ2Vycm9yJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omT5byA566h55CG55WM6Z2iXHJcbiAgICAgKi9cclxuICAgIG9wZW5NYW5hbmdlckRpYWxvZygpIHtcclxuICAgICAgICB0aGlzLm1hbmFnZURpYWxvZy5zaG93KGNsb25lRGVlcCh0aGlzLnF1ZXJ5U29sdXRpb25Wb3MpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOeuoeeQhueVjOmdouehruWumuWkhOeQhlxyXG4gICAgICogQHBhcmFtIF9ldmVudFxyXG4gICAgICogQHBhcmFtIGRpYWxvZ1xyXG4gICAgICovXHJcbiAgICBtYW5hZ2VyQ29uZmlybUhhbmRsZXIoX2V2ZW50OiBhbnkpIHtcclxuICAgICAgICBsZXQgb2JqOiBvYmplY3QgPSBfZXZlbnQ7XHJcbiAgICAgICAgaWYgKG9ialsndmFsaWRhdG9yJ10gPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAvL+eCueWHu2NoZWNrYm945pe277yMbmV3RGVmYXVsdFF1ZXJ5U29sdXRpb27ooqvotYvlgLzvvJsg5YWo5bGA6buY6K6k5pa55qGI6KKr5Yig6Zmk5pe277yMbmV3RGVmYXVsdFF1ZXJ5U29sdXRpb27lj5jkuLpudWxsXHJcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRJZCA9IG9ialsnbmV3RGVmYXVsdFF1ZXJ5U29sdXRpb24nXSA/IG9ialsnbmV3RGVmYXVsdFF1ZXJ5U29sdXRpb24nXS5pZCA6ICcnO1xyXG4gICAgICAgICAgICBjb25zdCBiZWxvbmdJZCA9IHRoaXMuZm9ybUlkO1xyXG4gICAgICAgICAgICAvL+iLpeayoeacieWIoOmZpOS7u+S9leaWueahiO+8jGRlbGV0ZWRRdWVyeVNvbHV0aW9uVm9z5Lya5piv5LiA5Liq56m65pWw57uEXHJcbiAgICAgICAgICAgIGNvbnN0IGRlbGV0ZWRJZHMgPSBvYmpbJ2RlbGV0ZWRRdWVyeVNvbHV0aW9uSWRzJ107XHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFNlcnZpY2UuYmF0Y2hVcGRhdGUoeyBkZWZhdWx0SWQsIGJlbG9uZ0lkLCBkZWxldGVkSWRzIH0sIHRoaXMuc2Vzc2lvbklkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/miorliKDpmaTlkI7nmoR2b+i1i+WAvOe7mSB0aGlzLnF1ZXJ5U29sdXRpb25Wb3PvvJvlpoLmnpzmsqHliKDpmaTmlrnmoYjvvIwgdGhpcy5xdWVyeVNvbHV0aW9uVm9z6Lefb2JqWydzcGxpY2VkUXVlcnlTb2x1dGlvblZvcydd5ZCM5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgLy/pu5jorqTmlrnmoYjnmoTlj5jljJbkuZ/orrDlvZXlnKh1cGRhdGVkUXVlcnlTb2x1dGlvblZvc+S4rVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcyA9IG9ialsndXBkYXRlZFF1ZXJ5U29sdXRpb25Wb3MnXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9ialsnY3VycmVudERlZmF1bHRRdWVyeVNvbHV0aW9uSWQnXSkgey8v5aaC5p6c5Lyg6L+H5p2l55qE5b2T5YmN6buY6K6k5pa55qGIaWTmmK/nqbrvvIzku6PooajmiYDmnInpu5jorqTmlrnmoYjpg73lj5bmtojkuoZcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnlTb2x1dGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5pyJ6buY6K6k5pa55qGI5YWI5pi+56S66buY6K6k5pa55qGI77yM5aaC5p6c5rKh5pyJ6buY6K6k5pa55qGI5YiZ55u05o6l5pi+56S65b2T5YmN5p+l6K+i5pa55qGI55qE56ys5LiA5Liq77yb5aaC5p6c5rKh5pyJ5Lu75L2V5p+l6K+i5pa55qGI5YiZ55u05o6l5riF56m65p+l6K+i5pa55qGI77yM5YiZ5pi+56S657O757uf6aKE572u55qE6buY6K6k5pa55qGIXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+W3suiuvue9rum7mOiupOaWueahiFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdChvYmpbJ25ld0RlZmF1bHRRdWVyeVNvbHV0aW9uJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeVNvbHV0aW9uID0gb2JqWyduZXdEZWZhdWx0UXVlcnlTb2x1dGlvbiddO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5pyq5pu05pS56buY6K6k5pa55qGI77yM5Yik5pat5b2T5YmN6YCJ5oup55qE5p+l6K+i5pa55qGI5piv5ZCm5bey6KKr5Yig6ZmkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWxldGVkSWRzLmluY2x1ZGVzKHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5pZCkpIHsvL+WmguaenOiiq+WIoOmZpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlTb2x1dGlvblZvcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5lbmFibGVIaXN0b3J5JiZ0aGlzLnF1ZXJ5U29sdXRpb25Wb3MubGVuZ3RoPT0xJiZ0aGlzLnF1ZXJ5U29sdXRpb25Wb3NbMF0udHlwZT09J3ByZScpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCh0aGlzLnN5c1F1ZXJ5U29sdXRpb25Wbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcy5wdXNoKHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QodGhpcy5xdWVyeVNvbHV0aW9uVm9zWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0KHRoaXMuc3lzUXVlcnlTb2x1dGlvblZvKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNvbHV0aW9uVm9zLnB1c2godGhpcy5zeXNRdWVyeVNvbHV0aW9uVm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ku4DkuYjkuZ/msqHlj5HnlJ9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5oqK5omA5pyJ55qE6buY6K6k6YO95Y+W5raI5LqGXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIuc2F2ZVN1Y2Nlc3NcIiksICdzdWNjZXNzJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS5zaG93SW5mbyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJxdWVyeVNvbHV0aW9uLmNvbnRhaW5lci5zYXZlRmFpbFwiKSwgJ2Vycm9yJywgJycsIDE1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYnNlcnZhYmxlLnRocm93KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8v5qCh6aqM5aSx6LSlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omn6KGM562b6YCJXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5KCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVycm9yQXJyID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuaXNWYWxpZCh0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zKTtcclxuICAgICAgICAgICAgaWYgKGVycm9yQXJyICYmIGVycm9yQXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JGaWVsZHMgPSBlcnJvckFyci5tYXAoZXJyb3IgPT4gZXJyb3IuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2Uuc2hvd0luZm8odGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwicXVlcnlTb2x1dGlvbi5jb250YWluZXIucmVxdWlyZVwiKS5yZXBsYWNlKCd7ZmllbGRzfScsIGVycm9yRmllbGRzLmpvaW4oJywgJykpLCAnd2FybmluZycsICcnLCAyNTAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHF1ZXJ5Q29uZGl0aW9ucyA9IGNsb25lRGVlcCh0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc29sdXRpb25IYW5kbGVyLnNldEZpbHRlckNvbmRpdGlvbnMocXVlcnlDb25kaXRpb25zKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlFbWl0dGVyLmVtaXQocXVlcnlDb25kaXRpb25zKTtcclxuICAgICAgICAgICAgICAgIC8vIOabtOaWsOWOhuWPsuiusOW9lVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VRdWVyeUhpc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOa4heepui0+5p2h5Lu25YWo6YOo6YeN572u5Li656m6XHJcbiAgICAgKi9cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIC8vIHRoaXMuaXNGb2xkID0gIXRoaXMuaXNGb2xkO1xyXG4gICAgICAgIGNvbnN0IGlzTm90RW1wdHkgPSB0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zLnNvbWUoY29uZGl0aW9uID0+IGNvbmRpdGlvbi52YWx1ZS5pc0VtcHR5KCkgPT0gZmFsc2UpO1xyXG4gICAgICAgIGlmIChpc05vdEVtcHR5KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0xpc3QgPSBjbG9uZURlZXAodGhpcy5mYXJyaXNRdWVyeUNvbmRpdGlvbi5yZXNldFNlbGVjdGVkQ29uZGl0aW9uVmFsdWVzKHRydWUpKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucyA9IG5ld0xpc3Q7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRTb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnMgPSBuZXdMaXN0O1xyXG4gICAgICAgICAgICB0aGlzLnNvbHV0aW9uSGFuZGxlci5zZXRDdXJyZW50UXVlcnlDb25kaXRpb25zKGNsb25lRGVlcChuZXdMaXN0KSk7XHJcbiAgICAgICAgICAgIHRoaXMuc29sdXRpb25IYW5kbGVyLnNldEZpbHRlckNvbmRpdGlvbnMobmV3TGlzdCk7XHJcbiAgICAgICAgICAgIHRoaXMubWFya0FzQ2hhbmdlZCh0cnVlLCB0aGlzLnNlbGVjdGVkU29sdXRpb24uaWQpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmipjlj6DmjInpkq7nmoTmuIXnqbpcclxuICAgICAqL1xyXG4gICAgZm9sZENsZWFySGFuZGxlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0ZvbGQpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c54K55Ye755qE5pe25YCZ5piv5Y+O5oqY55qEXHJcbiAgICAgICAgICAgIHRoaXMuaXNGb2xkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN1bW1hcnlDb25kaXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VtbWFyeUNvbmRpdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOeCueWHu+eahOaXtuWAmeaYr+WxleW8gOeahFxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog566t5aS054K55Ye75LqL5Lu2XHJcbiAgICAgKi9cclxuICAgIGFycm93Q2xpY2soKSB7XHJcbiAgICAgICAgdGhpcy5pc0ZvbGQgPSAhdGhpcy5pc0ZvbGQ7XHJcbiAgICAgICAgdGhpcy53aGVuRm9sZFNldFN1bW1hcnlDb25kaXRpb25zKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRm9sZCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1bW1hcnlDb25kaXRpb25zID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSB3aGVuRm9sZFNldFN1bW1hcnlDb25kaXRpb25zKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRm9sZCkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzlj47miphcclxuICAgICAgICAgICAgY29uc3QgaXNOb3RFbXB0eSA9IHRoaXMuc2VsZWN0ZWRGaWVsZENvbmRpdGlvbnMuc29tZShjb25kaXRpb24gPT4gY29uZGl0aW9uLnZhbHVlLmlzRW1wdHkoKSA9PSBmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChpc05vdEVtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1bW1hcnlDb25kaXRpb25zID0gdGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucy5maWx0ZXIoY29uZGl0aW9uID0+IGNvbmRpdGlvbi52YWx1ZS5pc0VtcHR5KCkgPT0gZmFsc2UpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdW1tYXJ5Q29uZGl0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Li657O757uf6aKE572u5pa55qGI5oiW6ICF6Ieq5a6a5LmJ5p+l6K+i5pa55qGI6K6+572u562b6YCJ5p2h5Lu26buY6K6k5YC8XHJcbiAgICAgKiBAcGFyYW0gY29uZmlncyDpu5jorqTlgLzorr7nva5cclxuICAgICAqIEBwYXJhbSBzZWxlY3RlZFNvbHV0aW9uIOW9k+WJjemAieaLqeeahOetm+mAieaWueahiFxyXG4gICAgICovXHJcbiAgICBzZXRRdWVyeUNvbmRpdGlvblZhbHVlcyhjb25maWdzOiBEZWZhdWx0Q29uZmlncywgc2VsZWN0ZWRTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IHRhcmdldFNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm87XHJcbiAgICAgICAgbGV0IHRhcmdldFNvbHV0aW9uV2l0aFZhbHVlczogUXVlcnlTb2x1dGlvblZvO1xyXG4gICAgICAgIGlmIChjb25maWdzICYmIGNvbmZpZ3MuZmllbGRDb25maWdzICYmIGNvbmZpZ3MuZmllbGRDb25maWdzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZihzZWxlY3RlZFNvbHV0aW9uLmhhc093blByb3BlcnR5KCd0eXBlJykmJnNlbGVjdGVkU29sdXRpb25bJ3R5cGUnXT09J3ByZScpe1xyXG4gICAgICAgICAgICAgICAgLy/lpoLmnpzmmK/ljoblj7LorrDlvZVcclxuICAgICAgICAgICAgICAgIHRhcmdldFNvbHV0aW9uPW51bGw7IFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Qoc2VsZWN0ZWRTb2x1dGlvbik7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0U29sdXRpb24gPSBjb25maWdzLmlzQ3VycmVudCA/IHNlbGVjdGVkU29sdXRpb24gOiAoc2VsZWN0ZWRTb2x1dGlvbi5pc1N5c3RlbSA/IHNlbGVjdGVkU29sdXRpb24gOiBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0U29sdXRpb24gJiYgdGFyZ2V0U29sdXRpb24ucXVlcnlDb25kaXRpb25zICYmIHRhcmdldFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldFNvbHV0aW9uV2l0aFZhbHVlcyA9IGNsb25lRGVlcCh0aGlzLnNvbHV0aW9uU2VydmljZS5zZXRWYWx1ZXModGFyZ2V0U29sdXRpb24sIGNvbmZpZ3MuZmllbGRDb25maWdzLCAhIWNvbmZpZ3MucmVhZG9ubHkpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9uZVNldERlZmF1bHRWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCh0YXJnZXRTb2x1dGlvbldpdGhWYWx1ZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy/kuI3kuLroh6rlrprkuYnmlrnmoYjorr7nva7pu5jorqTlgLzml7bvvIzmoIforrDkuIvopoHkuLrlhbbotYvpu5jorqTlgLznmoTmhI/lm77vvIzkvYbmnKrmiJDlip9cclxuICAgICAgICAgICAgICAgIHRoaXMuZG9uZVNldERlZmF1bHRWYWx1ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgLy/lpoLmnpzmsqHmnInorr7nva7pu5jorqTlgLzvvIzlsLHmiorlvZPliY3pgInkuK3mlrnmoYjnmoTmnaHku7bnmoTlgLzkvKDlh7pcclxuICAgICAgICAgICAgICAgIHRoaXMuc29sdXRpb25IYW5kbGVyLnNldEN1cnJlbnRRdWVyeUNvbmRpdGlvbnModGhpcy5zZWxlY3RlZFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3nrZvpgInmlrnmoYjlkI7oh6rliqjmn6Xor6JcclxuICAgICAqIEBwYXJhbSBjdXJyZW50U29sdXRpb24g5b2T5YmN562b6YCJ5pa55qGIIFxyXG4gICAgICovXHJcbiAgICBpbml0QXV0b1F1ZXJ5KGN1cnJlbnRTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlSW5pdFF1ZXJ5ICYmIHRoaXMuZG9uZUluaXRRdWVyeSAmJiB0aGlzLmVuYWJsZUhpc3RvcnkpIHtcclxuICAgICAgICAgICAgLy8g5bey6YCa6L+H5Y6G5Y+y6K6w5b2V6L+b6KGM6L+H5p+l6K+iXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGVuYWJsZVF1ZXJ5OiBib29sZWFuID0gdHJ1ZTtcclxuICAgICAgICBpZiAoY3VycmVudFNvbHV0aW9uICYmIGN1cnJlbnRTb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnMgJiYgY3VycmVudFNvbHV0aW9uLnF1ZXJ5Q29uZGl0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNTZXREZWZhdWx0VmFsdWUgJiYgIXRoaXMuZG9uZVNldERlZmF1bHRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlUXVlcnkgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVuYWJsZVF1ZXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZW5hYmxlUXVlcnkgJiYgdGhpcy5lbmFibGVJbml0UXVlcnkpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5zb2x1dGlvbkhhbmRsZXIuc2V0RmlsdGVyQ29uZGl0aW9ucyh0aGlzLnNlbGVjdGVkU29sdXRpb24ucXVlcnlDb25kaXRpb25zKTsg5omn6KGMcXVlcnnmlrnms5Xml7bvvIzlt7Lnu4/miafooYxzZXRGaWx0ZXJDb25kaXRpb25zXHJcbiAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXJyaXMtcGFuZWwgLmJ0bi1ncm91cCAuYnRuLXByaW1hcnknKSl7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnkoKTtcclxuICAgICAgICAgICAgdGhpcy5kb25lSW5pdFF1ZXJ5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5b2T5YmN5p+l6K+i5pa55qGI55qE562b6YCJ5p2h5Lu25Y+R55Sf5Y+Y5YyW5pe277yM5qCH6K6w5pa55qGI5aSE5LqO57yW6L6R54q25oCBXHJcbiAgICAgKiBAcGFyYW0gaXNDaGFuZ2VkIOaWueahiOaYr+WQpuWkhOS6jue8lui+keeKtuaAgVxyXG4gICAgICogQHBhcmFtIHNvbHV0aW9uSWQg6ZyA6KaB5qCH6K6w5piv5ZCm5aSE5LqO57yW6L6R54q25oCB55qE5pa55qGI55qEaWRcclxuICAgICAqL1xyXG4gICAgbWFya0FzQ2hhbmdlZChpc0NoYW5nZWQ6IGJvb2xlYW4sIHNvbHV0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMucXVlcnlTb2x1dGlvblZvcy5mb3JFYWNoKHNvbHV0aW9uID0+IHtcclxuICAgICAgICAgICAgaWYgKHNvbHV0aW9uLmlkID09IHNvbHV0aW9uSWQpXHJcbiAgICAgICAgICAgICAgICBzb2x1dGlvbi5pc0NoYW5nZWQgPSBpc0NoYW5nZWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFNvbHV0aW9uLmlzQ2hhbmdlZCA9IGlzQ2hhbmdlZDtcclxuICAgICAgICB0aGlzLmNkZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlpITnkIbnrZvpgInmjInpkq7lkozmuIXnqbrmjInpkq7nmoTlk43lupTlvI/kvY3nva7lj5jmm7RcclxuICAgICAqIEBwYXJhbSAkZXZlbnQgZmFycmlzLXF1ZXJ5Y29uZGl0aW9u57uE5Lu25YaF6YOo5piv5ZCm5pi+56S65oyJ6ZKuXHJcbiAgICAgKi9cclxuICAgIC8vIHNob3dCdXR0b25IYW5kbGUoJGV2ZW50OiBhbnkpIHtcclxuICAgIC8vICAgICBpZighdGhpcy5pc0Rpc2FibGVkKXtcclxuICAgIC8vICAgICAgICAgbGV0IGRhdGEgPSAkZXZlbnQ7XHJcbiAgICAvLyAgICAgICAgIHRoaXMucXVlcnlCdXR0b25PblJpZ2h0ID0gIWRhdGE7XHJcbiAgICAvLyAgICAgICAgIGlmKHRoaXMuZW5hYmxlSW5pdFF1ZXJ5ICYmICF0aGlzLmRvbmVJbml0UXVlcnkpIHtcclxuICAgIC8vICAgICAgICAgICAgIHRoaXMuaW5pdEF1dG9RdWVyeSh0aGlzLnNlbGVjdGVkU29sdXRpb24pO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6ZSu55uY55uR5ZCs5Ye95pWw77yM5b2T5oyJ5LiL5Zue6L2m6ZSu5pe255u45b2T5LqO5oyJ5LiL562b6YCJ5oyJ6ZKuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbGlzdGVuS2V5Qm9hcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fc2VsZi5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuaGFuZGxlS2V5RG93bik7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlS2V5RG93biA9IChldmVudCkgPT4ge1xyXG4gICAgICAgIGlmIChldmVudC5rZXkgPT0gJ0VudGVyJylcclxuICAgICAgICAgICAgdGhpcy5xdWVyeSgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDoh6rliqjliJ3lp4vljJbmn6Xor6JcclxuICAgICAqIOWQr+eUqOWOhuWPsuiusOW9le+8jOW5tuS4lOWQr+eUqOS6huWIneWni+WMluafpeivou+8jOWmguaenOacieadoeS7tu+8jOWwsei/m+ihjOafpeivolxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGluaXRBdXRvUXVlcnlCeUxTKCkge1xyXG4gICAgICAgIC8vIOWQr+eUqOWOhuWPslxyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUhpc3RvcnkgJiYgIXRoaXMuaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAvLyBrZXlcclxuICAgICAgICAgICAgdGhpcy5zZXRMU0tleSgpO1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJblr7nosaFcclxuICAgICAgICAgICAgdGhpcy5pbml0UXVlcnlTb2x1dGlvbigpO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzorr7nva7kuobliJ3lp4vmn6Xor6JcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSW5pdFF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdEluaXRRdWVyeVNvbHV0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXVsncXVlcnlDb25kaXRpb25zJ10ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHF1ZXJ5Q29uZGl0aW9ucyA9IGNsb25lRGVlcCh0aGlzLmhpc3RvcnlSZWZlclsnZm91bmRTY2htZSddWydxdWVyeUNvbmRpdGlvbnMnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZpZWxkQ29uZGl0aW9ucyA9IHF1ZXJ5Q29uZGl0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7mn6Xor6LmnaHku7ZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNvbHV0aW9uSGFuZGxlci5zZXRGaWx0ZXJDb25kaXRpb25zKHF1ZXJ5Q29uZGl0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5oqb5Ye65p+l6K+i5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeUVtaXR0ZXIuZW1pdChxdWVyeUNvbmRpdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOagh+iusFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9uZUluaXRRdWVyeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpbml0UXVlcnlTb2x1dGlvbigpIHtcclxuICAgICAgICBsZXQgcXVlcnlzb2x1dGlvblZPID0gbmV3IFF1ZXJ5U29sdXRpb25WbygpO1xyXG4gICAgICAgIHF1ZXJ5c29sdXRpb25WTy5pZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICBxdWVyeXNvbHV0aW9uVk8uY29kZSA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcInF1ZXJ5U29sdXRpb24uY29udGFpbmVyLmhpc3Ryb3lOYW1lXCIpO1xyXG4gICAgICAgIHF1ZXJ5c29sdXRpb25WTy5xdWVyeUNvbmRpdGlvbnMgPSBbXTtcclxuICAgICAgICBxdWVyeXNvbHV0aW9uVk8uYmVsb25nSWQgPSB0aGlzLmZvcm1JZDtcclxuICAgICAgICBxdWVyeXNvbHV0aW9uVk8uaXNTeXN0ZW0gPSB0cnVlO1xyXG4gICAgICAgIHF1ZXJ5c29sdXRpb25WTy50eXBlID0gJ3ByZSc7XHJcbiAgICAgICAgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXSA9IHF1ZXJ5c29sdXRpb25WTztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW5p2l6IeqTFPnmoTmnaHku7ZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBmb3JtYXRJbml0UXVlcnlTb2x1dGlvbigpIHtcclxuICAgICAgICBsZXQgaGlzdHJveUNvbmRpdGlvbiA9IHRoaXMuaHR0cFNlcnZpY2UuZ2V0TFModGhpcy5oaXN0b3J5UmVmZXIuc2NoZW1lS2V5TFMpO1xyXG4gICAgICAgIGlmIChoaXN0cm95Q29uZGl0aW9uLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICAgICAgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXVsncXVlcnlDb25kaXRpb25zJ10gPSBoaXN0cm95Q29uZGl0aW9uO1xyXG4gICAgICAgICAgICAvLyDop4TojIPljJbmnaHku7ZcclxuICAgICAgICAgICAgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXSA9IHRoaXMuZm9ybWF0UXVlcnlTb2x1dGlvblZPKGNvbnZlcnRvciwgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXSk7XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOmFjee9rlxyXG4gICAgICAgICAgICB0aGlzLnNvbHV0aW9uU2VydmljZS51cGRhdGVDb250cm9sKHRoaXMuaGlzdG9yeVJlZmVyWydmb3VuZFNjaG1lJ10sdGhpcy5yZXNldEZpZWxkQ29uZmlncyk7XHJcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeVJlZmVyLmluaXRDb25kaXRpb24gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5L+d5a2Y5LmL5ZCO5pu05paw5Y6G5Y+yXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2hhbmdlUXVlcnlIaXN0cm95KHVwZGF0ZUFsbCA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGlzdG9yeSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkU29sdXRpb25bJ3R5cGUnXSA9PSAncHJlJykge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkU29sdXRpb25bJ2lzQ2hhbmdlZCddID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHByZUluZGV4ID0gdGhpcy5xdWVyeVNvbHV0aW9uVm9zLmZpbmRJbmRleCgocXNvbHV0aW9uVk8pID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBxc29sdXRpb25WT1sndHlwZSddID09ICdwcmUnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8g5omn6KGM5p+l6K+i5LmL5ZCO77yM5LiK5qyh5p+l6K+i55qE5L+u5pS55bCx5LiN6K6k5Li65piv5Y+Y5pu05LqGXHJcbiAgICAgICAgICAgIGlmIChwcmVJbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U29sdXRpb25Wb3NbcHJlSW5kZXhdWydpc0NoYW5nZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHF1ZXJ5Q29uZGl0aW9ucyA9IGNsb25lRGVlcCh0aGlzLnNlbGVjdGVkRmllbGRDb25kaXRpb25zKTtcclxuXHJcbiAgICAgICAgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXS5xdWVyeUNvbmRpdGlvbnMgPSBxdWVyeUNvbmRpdGlvbnM7XHJcbiAgICAgICAgLy8g5pu05paw57yT5a2YXHJcbiAgICAgICAgdGhpcy5odHRwU2VydmljZS5zZXRMUyh0aGlzLmhpc3RvcnlSZWZlci5zY2hlbWVLZXlMUywgdGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXS5xdWVyeUNvbmRpdGlvbnMpO1xyXG4gICAgICAgIGlmICh1cGRhdGVBbGwpIHtcclxuICAgICAgICAgICAgLy8g5Y+R6LW36K+35rGC5L+d5a2Y5Y6G5Y+y6K6w5b2VXHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFNlcnZpY2Uuc2F2ZUhpc3Ryb3kodGhpcy5oaXN0b3J5UmVmZXJbJ2ZvdW5kU2NobWUnXSwgdGhpcy5zZXNzaW9uSWQpLnN1YnNjcmliZSgoKSA9PiB7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWkhOeQhmlmcmFtZeW1jOWll1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFRvcFdpbmRvdygpOiBXaW5kb3cge1xyXG4gICAgICAgIGxldCBjdXJXaW46IFdpbmRvdyA9IHdpbmRvdy5zZWxmO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChjdXJXaW4ubG9jYXRpb24ub3JpZ2luID09PSBjdXJXaW4ucGFyZW50LmxvY2F0aW9uLm9yaWdpbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cldpbiAhPT0gY3VyV2luLnBhcmVudCAmJiAhKGN1cldpbiBhcyBhbnkpLmlzUlRGVG9wV2luKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VyV2luID0gY3VyV2luLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7IH1cclxuICAgICAgICByZXR1cm4gY3VyV2luO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva5rZXlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzZXRMU0tleSgpIHtcclxuICAgICAgICAvLyDojrflj5Z3aW5kb3dcclxuICAgICAgICBsZXQgY3VyV2luZG93ID0gdGhpcy5nZXRUb3BXaW5kb3coKTtcclxuICAgICAgICBsZXQgdXNlckNvZGUgPSAnJztcclxuICAgICAgICBpZiAoY3VyV2luZG93Wydnc3BmcmFtZXdvcmtTZXJ2aWNlJ10gJiYgY3VyV2luZG93Wydnc3BmcmFtZXdvcmtTZXJ2aWNlJ10uaGFzT3duUHJvcGVydHkoJ2NvbW1vbicpKSB7XHJcbiAgICAgICAgICAgIHVzZXJDb2RlID0gY3VyV2luZG93Wydnc3BmcmFtZXdvcmtTZXJ2aWNlJ11bJ2NvbW1vbiddLnVzZXJJbmZvcy5nZXQoKS5jb2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhpc3RvcnlSZWZlci5zY2hlbWVLZXlMUyA9IHVzZXJDb2RlID8gJ1NjaGVtZScgKyB0aGlzLl9pZFNlci5lbmNyeXB0KHVzZXJDb2RlICsgdGhpcy5mb3JtSWQpIDogJyc7XHJcbiAgICB9XHJcbn1cclxuIl19