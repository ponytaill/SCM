!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mxgraph"),require("@ngx-translate/core"),require("@angular/common"),require("@angular/common/http"),require("@ecp-caf/caf-common"),require("@farris/ui-draggable"),require("@farris/ui-text"),require("@farris/ui-section"),require("@farris/ui-dialog"),require("@farris/ui-datagrid"),require("rxjs/operators"),require("@gsp-sys/rtf-common"),require("@edp-bif/common-api"),require("@farris/ui-loading"),require("@farris/ui-modal"),require("@farris/ui-notify"),require("@angular/forms"),require("rxjs"),require("@edp-aif/runtime-api"),require("@edp-aif/common-api"),require("@farris/ui-messager"),require("@farris/devkit"),require("@farris/command-services"),require("@angular/core")):"function"==typeof define&&define.amd?define("@edp-bif/runtime-api",["exports","mxgraph","@ngx-translate/core","@angular/common","@angular/common/http","@ecp-caf/caf-common","@farris/ui-draggable","@farris/ui-text","@farris/ui-section","@farris/ui-dialog","@farris/ui-datagrid","rxjs/operators","@gsp-sys/rtf-common","@edp-bif/common-api","@farris/ui-loading","@farris/ui-modal","@farris/ui-notify","@angular/forms","rxjs","@edp-aif/runtime-api","@edp-aif/common-api","@farris/ui-messager","@farris/devkit","@farris/command-services","@angular/core"],t):t((e["edp-bif"]=e["edp-bif"]||{},e["edp-bif"]["runtime-api"]={}),e.mxgraphFactory,e.core,e.ng.common,e.ng.common.http,e.cafCommon,e.uiDraggable,e.uiText,e.uiSection,e.uiDialog,e.uiDatagrid,e.rxjs.operators,e.rtfCommon,e.commonApi,e.uiLoading,e.uiModal,e.uiNotify,e.ng.forms,e.rxjs,e.runtimeApi,e.commonApi$1,e.uiMessager,e.devkit,e.commandServices,e.ng.core)}(this,function(exports,mxgraphFactory,core,common,http,cafCommon,uiDraggable,uiText,uiSection,uiDialog,uiDatagrid,operators,rtfCommon,commonApi,uiLoading,uiModal,uiNotify,forms,rxjs,runtimeApi,commonApi$1,uiMessager,devkit,commandServices,core$1){"use strict";mxgraphFactory=mxgraphFactory&&mxgraphFactory.hasOwnProperty("default")?mxgraphFactory["default"]:mxgraphFactory,window.mxBasePath=window.mxBasePath||"/platform/runtime/common/web/@edp-pmf/mxgraph",window.mxLoadResources=window.mxLoadResources||undefined,window.mxForceIncludes=window.mxForceIncludes||undefined,window.mxResourceExtension=window.mxResourceExtension||undefined,window.mxLoadStylesheets=window.mxLoadStylesheets||undefined,window.imageBasePath=window.imageBasePath||undefined,window.mxLanguage=window.mxLanguage||undefined,window.mxDefaultLanguage=window.mxDefaultLanguage||undefined,window.mxLanguages=window.mxLanguages||undefined;var mxgraph=mxgraphFactory({}),mxDefaultKeyHandlerType=mxgraph.mxDefaultKeyHandler,mxDefaultPopupMenuType=mxgraph.mxDefaultPopupMenu,mxDefaultToolbarType=mxgraph.mxDefaultToolbar,mxEditorType=mxgraph.mxEditor,mxCellHighlightType=mxgraph.mxCellHighlight,mxCellMarkerType=mxgraph.mxCellMarker,mxCellTrackerType=mxgraph.mxCellTracker,mxConnectionHandlerType=mxgraph.mxConnectionHandler,mxConstraintHandlerType=mxgraph.mxConstraintHandler,mxEdgeHandlerType=mxgraph.mxEdgeHandler,mxEdgeSegmentHandlerType=mxgraph.mxEdgeSegmentHandler,mxElbowEdgeHandlerType=mxgraph.mxElbowEdgeHandler,mxGraphHandlerType=mxgraph.mxGraphHandler,mxHandleType=mxgraph.mxHandle,mxKeyHandlerType=mxgraph.mxKeyHandler,mxPanningHandlerType=mxgraph.mxPanningHandler,mxPopupMenuHandlerType=mxgraph.mxPopupMenuHandler,mxRubberbandType=mxgraph.mxRubberband,mxSelectionCellsHandlerType=mxgraph.mxSelectionCellsHandler,mxTooltipHandlerType=mxgraph.mxTooltipHandler,mxVertexHandlerType=mxgraph.mxVertexHandler,mxCellCodecType=mxgraph.mxCellCodec,mxChildChangeCodecType=mxgraph.mxChildChangeCodec,mxDefaultKeyHandlerCodecType=mxgraph.mxDefaultKeyHandlerCodec,mxDefaultPopupMenuCodecType=mxgraph.mxDefaultPopupMenuCodec,mxDefaultToolbarCodecType=mxgraph.mxDefaultToolbarCodec,mxEditorCodecType=mxgraph.mxEditorCodec,mxGenericChangeCodecType=mxgraph.mxGenericChangeCodec,mxGraphCodecType=mxgraph.mxGraphCodec,mxGraphViewCodecType=mxgraph.mxGraphViewCodec,mxModelCodecType=mxgraph.mxModelCodec,mxObjectCodecType=mxgraph.mxObjectCodec,mxRootChangeCodecType=mxgraph.mxRootChangeCodec,mxStylesheetCodecType=mxgraph.mxStylesheetCodec,mxTerminalChangeCodecType=mxgraph.mxTerminalChangeCodec,mxCircleLayoutType=mxgraph.mxCircleLayout,mxCompactTreeLayoutType=mxgraph.mxCompactTreeLayout,mxCompositeLayoutType=mxgraph.mxCompositeLayout,mxEdgeLabelLayoutType=mxgraph.mxEdgeLabelLayout,mxFastOrganicLayoutType=mxgraph.mxFastOrganicLayout,mxGraphLayoutType=mxgraph.mxGraphLayout,mxParallelEdgeLayoutType=mxgraph.mxParallelEdgeLayout,mxPartitionLayoutType=mxgraph.mxPartitionLayout,mxRadialTreeLayoutType=mxgraph.mxRadialTreeLayout,mxStackLayoutType=mxgraph.mxStackLayout,mxHierarchicalLayoutType=mxgraph.mxHierarchicalLayout,mxSwimlaneLayoutType=mxgraph.mxSwimlaneLayout,mxGraphAbstractHierarchyCellType=mxgraph.mxGraphAbstractHierarchyCell,mxGraphHierarchyEdgeType=mxgraph.mxGraphHierarchyEdge,mxGraphHierarchyModelType=mxgraph.mxGraphHierarchyModel,mxGraphHierarchyNodeType=mxgraph.mxGraphHierarchyNode,mxSwimlaneModelType=mxgraph.mxSwimlaneModel,mxCoordinateAssignmentType=mxgraph.mxCoordinateAssignment,mxHierarchicalLayoutStageType=mxgraph.mxHierarchicalLayoutStage,mxMedianHybridCrossingReductionType=mxgraph.mxMedianHybridCrossingReduction,mxMinimumCycleRemoverType=mxgraph.mxMinimumCycleRemover,mxSwimlaneOrderingType=mxgraph.mxSwimlaneOrdering,mxCellType=mxgraph.mxCell,mxCellPathType=mxgraph.mxCellPath,mxGeometryType=mxgraph.mxGeometry,mxGraphModelType=mxgraph.mxGraphModel,renderingHintType=mxgraph.renderingHint,mxActorType=mxgraph.mxActor,mxArrowType=mxgraph.mxArrow,mxArrowConnectorType=mxgraph.mxArrowConnector,mxCloudType=mxgraph.mxCloud,mxConnectorType=mxgraph.mxConnector,mxCylinderType=mxgraph.mxCylinder,mxDoubleEllipseType=mxgraph.mxDoubleEllipse,mxEllipseType=mxgraph.mxEllipse,mxHexagonType=mxgraph.mxHexagon,mxImageShapeType=mxgraph.mxImageShape,mxLabelType=mxgraph.mxLabel,mxLineType=mxgraph.mxLine,mxMarkerType=mxgraph.mxMarker,mxPolylineType=mxgraph.mxPolyline,mxRectangleShapeType=mxgraph.mxRectangleShape,mxRhombusType=mxgraph.mxRhombus,mxShapeType=mxgraph.mxShape,mxStencilType=mxgraph.mxStencil,mxStencilRegistryType=mxgraph.mxStencilRegistry,mxSwimlaneType=mxgraph.mxSwimlane,mxTextType=mxgraph.mxText,mxTriangleType=mxgraph.mxTriangle,mxAbstractCanvas2DType=mxgraph.mxAbstractCanvas2D,mxAnimationType=mxgraph.mxAnimation,mxAutoSaveManagerType=mxgraph.mxAutoSaveManager,mxClipboardType=mxgraph.mxClipboard,mxConstantsType=mxgraph.mxConstants,mxDictionaryType=mxgraph.mxDictionary,mxDivResizerType=mxgraph.mxDivResizer,mxDragSourceType=mxgraph.mxDragSource,mxEffectsType=mxgraph.mxEffects,mxEventType=mxgraph.mxEvent,mxEventObjectType=mxgraph.mxEventObject,mxEventSourceType=mxgraph.mxEventSource,mxFormType=mxgraph.mxForm,mxGuideType=mxgraph.mxGuide,mxImageType=mxgraph.mxImage,mxImageBundleType=mxgraph.mxImageBundle,mxImageExportType=mxgraph.mxImageExport,mxLogType=mxgraph.mxLog,mxMorphingType=mxgraph.mxMorphing,mxMouseEventType=mxgraph.mxMouseEvent,mxObjectIdentityType=mxgraph.mxObjectIdentity,mxPanningManagerType=mxgraph.mxPanningManager,mxPointType=mxgraph.mxPoint,mxPopupMenuType=mxgraph.mxPopupMenu,mxRectangleType=mxgraph.mxRectangle,mxResourcesType=mxgraph.mxResources,mxSvgCanvas2DType=mxgraph.mxSvgCanvas2D,mxToolbarType=mxgraph.mxToolbar,mxUndoableEditType=mxgraph.mxUndoableEdit,mxUndoManagerType=mxgraph.mxUndoManager,mxUrlConverterType=mxgraph.mxUrlConverter,mxUtilsType=mxgraph.mxUtils,mxVmlCanvas2DType=mxgraph.mxVmlCanvas2D,mxWindowType=mxgraph.mxWindow,mxXmlCanvas2DType=mxgraph.mxXmlCanvas2D,mxXmlRequestType=mxgraph.mxXmlRequest,mxCellEditorType=mxgraph.mxCellEditor,mxCellOverlayType=mxgraph.mxCellOverlay,mxCellRendererType=mxgraph.mxCellRenderer,mxCellStateType=mxgraph.mxCellState,mxCellStatePreviewType=mxgraph.mxCellStatePreview,mxConnectionConstraintType=mxgraph.mxConnectionConstraint,mxEdgeStyleType=mxgraph.mxEdgeStyle,mxGraphType=mxgraph.mxGraph,mxGraphSelectionModelType=mxgraph.mxGraphSelectionModel,mxGraphViewType=mxgraph.mxGraphView,mxLayoutManagerType=mxgraph.mxLayoutManager,mxMultiplicityType=mxgraph.mxMultiplicity,mxOutlineType=mxgraph.mxOutline,mxPerimeterType=mxgraph.mxPerimeter,mxPrintPreviewType=mxgraph.mxPrintPreview,mxStyleRegistryType=mxgraph.mxStyleRegistry,mxStylesheetType=mxgraph.mxStylesheet,mxSwimlaneManagerType=mxgraph.mxSwimlaneManager,mxTemporaryCellStatesType=mxgraph.mxTemporaryCellStates,mxClientType=mxgraph.mxClient;exports.MxGraphNS||(exports.MxGraphNS={});var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(n)throw n.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var BillData=(K=commonApi$1.JsonConvertableImpl,__extends(L,K),L.prototype.ResetBeforeLoadFrom=function(){K.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},L.prototype.ConvertToJsonObject=function(){var e=K.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},L.prototype.LoadFromJsonObject=function(e){K.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},L),K;function L(){return null!==K&&K.apply(this,arguments)||this}var ManualCreationMode={Push:"Push",Pull:"Pull",SpecificPush:"SpecificPush",SpecificPull:"SpecificPull"},FormBillCreationProcessExecutorArgs=(O=runtimeApi.FormCreationRuleExecutorArgs,__extends(P,O),P.prototype.ResetBeforeLoadFrom=function(){O.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessId=null,this.creationRuleInstanceId=null},P.prototype.ConvertToJsonObject=function(){var e=O.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessId",this.billCreationProcessId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"creationRuleInstanceId",this.creationRuleInstanceId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"manualCreationMode",this.manualCreationMode),e},P.prototype.LoadFromJsonObject=function(e){O.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billCreationProcessId"),this.creationRuleInstanceId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"creationRuleInstanceId"),this.manualCreationMode=ManualCreationMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"creationRuleInstanceId")]},P),O;function P(){return null!==O&&O.apply(this,arguments)||this}var FormGetBillCreationProcessEntityExArgs=(S=commonApi$1.JsonConvertableImpl,__extends(T,S),T.prototype.ResetBeforeLoadFrom=function(){S.prototype.ResetBeforeLoadFrom.call(this),this.upBillVoId=null,this.downBillVoId=null,this.manualCreationMode=null},T.prototype.ConvertToJsonObject=function(){var e=S.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillVoId",this.upBillVoId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillVoId",this.downBillVoId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"manualCreationMode",this.manualCreationMode),e},T.prototype.LoadFromJsonObject=function(e){S.prototype.LoadFromJsonObject.call(this,e),this.upBillVoId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillVoId"),this.downBillVoId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillVoId"),this.manualCreationMode=ManualCreationMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"manualCreationMode")]},T),S;function T(){return null!==S&&S.apply(this,arguments)||this}var FormGetBillCreationProcessEntityExResult=(W=commonApi$1.JsonConvertableImpl,__extends(X,W),X.prototype.ResetBeforeLoadFrom=function(){W.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessEntityExes=new Array},X.prototype.ConvertToJsonObject=function(){var e=W.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessEntityExes",this.billCreationProcessEntityExes),e},X.prototype.LoadFromJsonObject=function(e){W.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessEntityExes=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billCreationProcessEntityExes",commonApi.RtSlimBillCreationProcessEntityEx)},X),W;function X(){return null!==W&&W.apply(this,arguments)||this}var GeneralTextIdWithDataId=($=commonApi$1.JsonConvertableImpl,__extends(_,$),_.prototype.ResetBeforeLoadFrom=function(){$.prototype.ResetBeforeLoadFrom.call(this),this.generalTextId=null,this.dataId=null},_.prototype.ConvertToJsonObject=function(){var e=$.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"generalTextId",this.generalTextId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),e},_.prototype.LoadFromJsonObject=function(e){$.prototype.LoadFromJsonObject.call(this,e),this.generalTextId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"generalTextId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId")},_),$;function _(){return null!==$&&$.apply(this,arguments)||this}var BillDetailInfo=(ca=commonApi$1.JsonConvertableImpl,__extends(da,ca),da.prototype.ResetBeforeLoadFrom=function(){ca.prototype.ResetBeforeLoadFrom.call(this),this.detailCode=null,this.detailIds=[]},da.prototype.ConvertToJsonObject=function(){var e=ca.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"detailCode",this.detailCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"detailIds",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.detailIds)),e},da.prototype.LoadFromJsonObject=function(e){ca.prototype.LoadFromJsonObject.call(this,e),this.detailCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailCode"),this.detailIds=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailIds"))},da),ca;function da(){var e=null!==ca&&ca.apply(this,arguments)||this;return e.detailIds=[],e}var BillItemInfo=(ha=commonApi$1.JsonConvertableImpl,__extends(ia,ha),ia.prototype.ResetBeforeLoadFrom=function(){ha.prototype.ResetBeforeLoadFrom.call(this),this.itemId=null,this.billDetailInfos=[]},ia.prototype.ConvertToJsonObject=function(){var e=ha.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"itemId",this.itemId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDetailInfos",this.billDetailInfos),e},ia.prototype.LoadFromJsonObject=function(e){ha.prototype.LoadFromJsonObject.call(this,e),this.itemId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemId"),this.billDetailInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDetailInfos",BillDetailInfo)},ia),ha;function ia(){var e=null!==ha&&ha.apply(this,arguments)||this;return e.billDetailInfos=[],e}var BillChildInfo=(ma=commonApi$1.JsonConvertableImpl,__extends(na,ma),na.prototype.ResetBeforeLoadFrom=function(){ma.prototype.ResetBeforeLoadFrom.call(this),this.itemCode=null,this.billItemInfos=[]},na.prototype.ConvertToJsonObject=function(){var e=ma.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"itemCode",this.itemCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billItemInfos",this.billItemInfos),e},na.prototype.LoadFromJsonObject=function(e){ma.prototype.LoadFromJsonObject.call(this,e),this.itemCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemCode"),this.billItemInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billItemInfos",BillItemInfo)},na),ma;function na(){var e=null!==ma&&ma.apply(this,arguments)||this;return e.billItemInfos=[],e}var TrackingMappingAssociation=(ra=commonApi$1.JsonConvertableImpl,__extends(sa,ra),sa.prototype.ResetBeforeLoadFrom=function(){ra.prototype.ResetBeforeLoadFrom.call(this),this.upBillTableCodePath=null,this.upBillDataIdPath=null,this.downBillTableCodePath=null,this.downBillDataIdPath=null},sa.prototype.ConvertToJsonObject=function(){var e=ra.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillTableCodePath",this.upBillTableCodePath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillDataIdPath",this.upBillDataIdPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillTableCodePath",this.downBillTableCodePath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillDataIdPath",this.downBillDataIdPath),e},sa.prototype.LoadFromJsonObject=function(e){ra.prototype.LoadFromJsonObject.call(this,e),this.upBillTableCodePath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillTableCodePath"),this.upBillDataIdPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillDataIdPath"),this.downBillTableCodePath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillTableCodePath"),this.downBillDataIdPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillDataIdPath")},sa),ra;function sa(){return null!==ra&&ra.apply(this,arguments)||this}var BillDataInfo=(va=commonApi$1.JsonConvertableImpl,__extends(wa,va),wa.prototype.ResetBeforeLoadFrom=function(){va.prototype.ResetBeforeLoadFrom.call(this),this.dataId=null,this.caption=null,this.summary=null,this.canContinueTracking=!1,this.trackingMappingAssociations=null,this.billChildInfos=[],this.curYear=null},wa.prototype.ConvertToJsonObject=function(){var e=va.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canContinueTracking",this.canContinueTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingMappingAssociations",this.trackingMappingAssociations),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},wa.prototype.LoadFromJsonObject=function(e){va.prototype.LoadFromJsonObject.call(this,e),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.canContinueTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canContinueTracking"),this.trackingMappingAssociations=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"trackingMappingAssociations",TrackingMappingAssociation),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},wa),va;function wa(){var e=null!==va&&va.apply(this,arguments)||this;return e.billChildInfos=[],e}var BillInfo=(Aa=commonApi$1.JsonConvertableImpl,__extends(Ba,Aa),Ba.prototype.ResetBeforeLoadFrom=function(){Aa.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.schemaId=null,this.suCode=null,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataInfos=[],this.jointQueryMode=commonApi.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null},Ba.prototype.ConvertToJsonObject=function(){var e=Aa.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDataInfos",this.billDataInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),e},Ba.prototype.LoadFromJsonObject=function(e){Aa.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDataInfos",BillDataInfo),this.jointQueryMode=commonApi.JointQueryMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType")},Ba),Aa;function Ba(){var e=null!==Aa&&Aa.apply(this,arguments)||this;return e.billDataInfos=[],e.jointQueryMode=commonApi.JointQueryMode.DEFAULT,e}var CanTrackingInfo=(Fa=commonApi$1.JsonConvertableImpl,__extends(Ga,Fa),Ga.prototype.ResetBeforeLoadFrom=function(){Fa.prototype.ResetBeforeLoadFrom.call(this),this.canUpTracking=!1,this.canDownTracking=!1,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.dataId=null,this.caption=null,this.summary=null,this.suCode=null,this.schemaId=null,this.billChildInfos=[],this.jointQueryMode=commonApi.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null,this.curYear=null},Ga.prototype.ConvertToJsonObject=function(){var e=Fa.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canUpTracking",this.canUpTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canDownTracking",this.canDownTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Ga.prototype.LoadFromJsonObject=function(e){Fa.prototype.LoadFromJsonObject.call(this,e),this.canUpTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canUpTracking"),this.canDownTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canDownTracking"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.jointQueryMode=commonApi.JointQueryMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Ga),Fa;function Ga(){var e=null!==Fa&&Fa.apply(this,arguments)||this;return e.billChildInfos=[],e.jointQueryMode=commonApi.JointQueryMode.DEFAULT,e}var DownBillInfo=(Ka=BillInfo,__extends(La,Ka),La),Ka;function La(){return null!==Ka&&Ka.apply(this,arguments)||this}var GetBillsInfoArgs=(Ma=commonApi$1.JsonConvertableImpl,__extends(Na,Ma),Na.prototype.ResetBeforeLoadFrom=function(){Ma.prototype.ResetBeforeLoadFrom.call(this),this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataId=null,this.billChildInfos=[],this.curYear=null},Na.prototype.ConvertToJsonObject=function(){var e=Ma.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDataId",this.billDataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},Na.prototype.LoadFromJsonObject=function(e){Ma.prototype.LoadFromJsonObject.call(this,e),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billDataId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},Na),Ma;function Na(){var e=null!==Ma&&Ma.apply(this,arguments)||this;return e.billChildInfos=[],e}var GetDownBillsInfoArgs=(Ra=GetBillsInfoArgs,__extends(Sa,Ra),Sa),Ra;function Sa(){return null!==Ra&&Ra.apply(this,arguments)||this}var GetUpBillsInfoArgs=(Ta=GetBillsInfoArgs,__extends(Ua,Ta),Ua),Ta;function Ua(){return null!==Ta&&Ta.apply(this,arguments)||this}var TrackingHelper=(Va.concatDownBillInfos=function(e,t){var r,o,n,i;if(null==e&&(e=new Array),null==t||0==t.length)return e;var a=new Array;e.forEach(function(e){return a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var w=s.value;if(a.includes(w.schemaId))try{for(var c=__values(e),p=c.next();!p.done;p=c.next())!function(e){var t,r,o,n,i,a,l,s;if(e.schemaId==w.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var d=__values(w.billDataInfos),u=d.next();!u.done;u=d.next()){var m=u.value;if(p.includes(m.dataId))try{for(var h=__values(c),y=h.next();!y.done;y=h.next()){var f=y.value;if(f.dataId==m.dataId){var g=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),v=x.next();!v.done;v=x.next()){var b=v.value,C=0;try{for(var S=__values(g),T=S.next();!T.done;T=S.next()){var A=T.value;b.downBillDataIdPath==A.downBillDataIdPath&&b.downBillTableCodePath==A.downBillTableCodePath&&b.upBillDataIdPath==A.upBillDataIdPath&&b.upBillTableCodePath==A.upBillTableCodePath||C++}}catch(I){l={error:I}}finally{try{T&&!T.done&&(s=S["return"])&&s.call(S)}finally{if(l)throw l.error}}C==g.length&&g.push(b)}}catch(B){i={error:B}}finally{try{v&&!v.done&&(a=x["return"])&&a.call(x)}finally{if(i)throw i.error}}}}}catch(E){o={error:E}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(M){t={error:M}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}}}(p.value)}catch(d){n={error:d}}finally{try{p&&!p.done&&(i=c["return"])&&i.call(c)}finally{if(n)throw n.error}}else a.push(w.schemaId),e.push(w)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return e},Va.concatUpBillInfos=function(e,t){var r,o,n,i;if(null==e&&(e=new Array),null==t||0==t.length)return e;var a=new Array;e.forEach(function(e){a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var w=s.value;if(a.includes(w.schemaId))try{for(var c=__values(e),p=c.next();!p.done;p=c.next())!function(e){var t,r,o,n,i,a,l,s;if(e.schemaId==w.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var d=__values(w.billDataInfos),u=d.next();!u.done;u=d.next()){var m=u.value;if(p.includes(m.dataId))try{for(var h=__values(c),y=h.next();!y.done;y=h.next()){var f=y.value;if(f.dataId==m.dataId){var g=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),v=x.next();!v.done;v=x.next()){var b=v.value,C=0;try{for(var S=__values(g),T=S.next();!T.done;T=S.next()){var A=T.value;b.downBillDataIdPath==A.downBillDataIdPath&&b.downBillTableCodePath==A.downBillTableCodePath&&b.upBillDataIdPath==A.upBillDataIdPath&&b.upBillTableCodePath==A.upBillTableCodePath||C++}}catch(I){l={error:I}}finally{try{T&&!T.done&&(s=S["return"])&&s.call(S)}finally{if(l)throw l.error}}C==g.length&&g.push(b)}}catch(B){i={error:B}}finally{try{v&&!v.done&&(a=x["return"])&&a.call(x)}finally{if(i)throw i.error}}}}}catch(E){o={error:E}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(M){t={error:M}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}}}(p.value)}catch(d){n={error:d}}finally{try{p&&!p.done&&(i=c["return"])&&i.call(c)}finally{if(n)throw n.error}}else a.push(w.schemaId),e.push(w)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return e},Va);function Va(){}var UpBillInfo=(Uc=BillInfo,__extends(Vc,Uc),Vc),Uc;function Vc(){return null!==Uc&&Uc.apply(this,arguments)||this}var TypeToFormat={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL",STRING:"STRING"},FieldsWithOrder=(Wc=commonApi$1.JsonConvertableImpl,__extends(Xc,Wc),Xc.prototype.ResetBeforeLoadFrom=function(){Wc.prototype.ResetBeforeLoadFrom.call(this),this.order=0,this.fieldName=null,this.fieldPath=null,this.name=null,this.customName=null,this.colI18nValues=null,this.typeToFormat=TypeToFormat.DEFAULT,this.formatInfo=null,this.version=0},Xc.prototype.ConvertToJsonObject=function(){var e=Wc.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"order",this.order),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldName",this.fieldName),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"customName",this.customName),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"colI18nValues",this.colI18nValues),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"typeToFormat",this.typeToFormat),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"formatInfo",this.formatInfo),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},Xc.prototype.LoadFromJsonObject=function(e){Wc.prototype.LoadFromJsonObject.call(this,e),this.order=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"order"),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.fieldName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldName"),this.fieldPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.customName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"customName"),this.colI18nValues=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"colI18nValues"),this.typeToFormat=TypeToFormat[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"typeToFormat")],this.formatInfo=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"formatInfo"),this.version=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},Xc),Wc;function Xc(){var e=null!==Wc&&Wc.apply(this,arguments)||this;return e.typeToFormat=TypeToFormat.DEFAULT,e}var SummaryFieldsInfo=(_c=commonApi$1.JsonConvertableImpl,__extends(ad,_c),ad.prototype.ResetBeforeLoadFrom=function(){_c.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.fields=[],this.childFieldInfos=[]},ad.prototype.ConvertToJsonObject=function(){var e=_c.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fields",this.fields),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"childFieldInfos",this.childFieldInfos),e},ad.prototype.LoadFromJsonObject=function(e){_c.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.fields=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"fields",FieldsWithOrder),this.childFieldInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"childFieldInfos",ad)},ad),_c;function ad(){var e=null!==_c&&_c.apply(this,arguments)||this;return e.fields=[],e.childFieldInfos=[],e}var FieldNameAndValue=(ed=commonApi$1.JsonConvertableImpl,__extends(fd,ed),fd.prototype.ResetBeforeLoadFrom=function(){ed.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},fd.prototype.ConvertToJsonObject=function(){var e=ed.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},fd.prototype.LoadFromJsonObject=function(e){ed.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},fd),ed;function fd(){return null!==ed&&ed.apply(this,arguments)||this}var DateTypeFormatInfo=(id=commonApi$1.JsonConvertableImpl,__extends(jd,id),jd.prototype.ResetBeforeLoadFrom=function(){id.prototype.ResetBeforeLoadFrom.call(this),this.displayFormat=null},jd.prototype.ConvertToJsonObject=function(){var e=id.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"displayFormat",this.displayFormat),e},jd.prototype.LoadFromJsonObject=function(e){id.prototype.LoadFromJsonObject.call(this,e),this.displayFormat=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"displayFormat")},jd),id;function jd(){return null!==id&&id.apply(this,arguments)||this}var ScaleMode={DEFAULT:"DEFAULT",NUMBER:"NUMBER",FIELD:"FIELD",EXPRESSION:"EXPRESSION"},DecimalTypeFormatInfo=(md=commonApi$1.JsonConvertableImpl,__extends(nd,md),nd.prototype.ResetBeforeLoadFrom=function(){md.prototype.ResetBeforeLoadFrom.call(this),this.scale=0,this.scaleMode=ScaleMode.DEFAULT,this.fieldPath=null,this.version=0},nd.prototype.ConvertToJsonObject=function(){var e=md.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scaleMode",this.scaleMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},nd.prototype.LoadFromJsonObject=function(e){md.prototype.LoadFromJsonObject.call(this,e),this.scale=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"scale");var t=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"scaleMode");this.scaleMode=null==t?ScaleMode.DEFAULT:ScaleMode[t],this.fieldPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.version=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},nd),md;function nd(){var e=null!==md&&md.apply(this,arguments)||this;return e.scaleMode=ScaleMode.DEFAULT,e}var TypeToFormat$1={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL",STRING:"STRING"},JointQueryParameterContent=(sd=commonApi$1.JsonConvertableImpl,__extends(td,sd),td.prototype.ResetBeforeLoadFrom=function(){sd.prototype.ResetBeforeLoadFrom.call(this),this.parameterCode=null},td.prototype.ConvertToJsonObject=function(){var e=sd.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"parameterCode",this.parameterCode),e},td.prototype.LoadFromJsonObject=function(e){sd.prototype.LoadFromJsonObject.call(this,e),this.parameterCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"parameterCode")},td),sd;function td(){return null!==sd&&sd.apply(this,arguments)||this}var ExpressionJointQueryParameterContent=(wd=JointQueryParameterContent,__extends(xd,wd),xd.prototype.ResetBeforeLoadFrom=function(){wd.prototype.ResetBeforeLoadFrom.call(this),this.expressionContent=null},xd.prototype.ConvertToJsonObject=function(){var e=wd.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"expressionContent",this.expressionContent),e},xd.prototype.LoadFromJsonObject=function(e){wd.prototype.LoadFromJsonObject.call(this,e),this.expressionContent=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"expressionContent")},xd),wd;function xd(){return null!==wd&&wd.apply(this,arguments)||this}var FieldJointQueryParameterContent=(Ad=JointQueryParameterContent,__extends(Bd,Ad),Bd.prototype.ResetBeforeLoadFrom=function(){Ad.prototype.ResetBeforeLoadFrom.call(this),this.fieldContent=null},Bd.prototype.ConvertToJsonObject=function(){var e=Ad.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldContent",this.fieldContent),e},Bd.prototype.LoadFromJsonObject=function(e){Ad.prototype.LoadFromJsonObject.call(this,e),this.fieldContent=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldContent")},Bd),Ad;function Bd(){return null!==Ad&&Ad.apply(this,arguments)||this}var JointQueryParameterMode={FIELD:"FIELD",EXPRESSION:"EXPRESSION",COMPONENT:"COMPONENT"},JointQueryParameterResult=(Ed=commonApi$1.JsonConvertableImpl,__extends(Fd,Ed),Fd.prototype.ResetBeforeLoadFrom=function(){Ed.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.value=null},Fd.prototype.ConvertToJsonObject=function(){var e=Ed.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},Fd.prototype.LoadFromJsonObject=function(e){Ed.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},Fd),Ed;function Fd(){return null!==Ed&&Ed.apply(this,arguments)||this}var JointQueryParametersContent=(Id=commonApi$1.JsonConvertableImpl,__extends(Jd,Id),Jd.prototype.ResetBeforeLoadFrom=function(){Id.prototype.ResetBeforeLoadFrom.call(this),this.jointQueryParameterMode=JointQueryParameterMode.FIELD,this.content=null},Jd.prototype.ConvertToJsonObject=function(){var e=Id.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameterMode",this.jointQueryParameterMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"content",this.content),e},Jd.prototype.LoadFromJsonObject=function(e){Id.prototype.LoadFromJsonObject.call(this,e),this.jointQueryParameterMode=JointQueryParameterMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameterMode")],this.content=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"content")},Jd),Id;function Jd(){var e=null!==Id&&Id.apply(this,arguments)||this;return e.jointQueryParameterMode=JointQueryParameterMode.FIELD,e}var SimpleValueMappingInfo=(Nd=commonApi$1.JsonConvertableImpl,__extends(Od,Nd),Od.prototype.ResetBeforeLoadFrom=function(){Nd.prototype.ResetBeforeLoadFrom.call(this),this.displayValue=null,this.actualValue=null},Od.prototype.ConvertToJsonObject=function(){var e=Nd.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"displayValue",this.displayValue),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"actualValue",this.actualValue),e},Od.prototype.LoadFromJsonObject=function(e){Nd.prototype.LoadFromJsonObject.call(this,e),this.displayValue=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"displayValue"),this.actualValue=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"actualValue")},Od),Nd;function Od(){return null!==Nd&&Nd.apply(this,arguments)||this}var StringDisplayMode={SIMPLEVALUEMAPPING:"SIMPLEVALUEMAPPING"},StringTypeFormatInfo=(Rd=commonApi$1.JsonConvertableImpl,__extends(Sd,Rd),Sd.prototype.ResetBeforeLoadFrom=function(){Rd.prototype.ResetBeforeLoadFrom.call(this),this.stringDisplayMode=StringDisplayMode.SIMPLEVALUEMAPPING,this.simpleValueMappingInfos=[]},Sd.prototype.ConvertToJsonObject=function(){var e=Rd.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"stringDisplayMode",this.stringDisplayMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"simpleValueMappingInfos",this.simpleValueMappingInfos),e},Sd.prototype.LoadFromJsonObject=function(e){Rd.prototype.LoadFromJsonObject.call(this,e),this.stringDisplayMode=StringDisplayMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"stringDisplayMode")],this.simpleValueMappingInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"simpleValueMappingInfos",SimpleValueMappingInfo)},Sd),Rd;function Sd(){var e=null!==Rd&&Rd.apply(this,arguments)||this;return e.stringDisplayMode=StringDisplayMode.SIMPLEVALUEMAPPING,e.simpleValueMappingInfos=[],e}var BIF_UISTATE_KEY_OPEN_TYPE="abdbaec8-0bbe-4894-acee-b8d493bc4e1c",BIF_UISTATE_KEY_CREATION_RESULT="5eb32009-1d86-43df-96c8-8d685aea4e66",ModuleConfig=function(){},SELECTOR_ARGS_INJECTOR=new core$1.InjectionToken("SELECTOR_ARGS_INJECTOR"),DEFAULT_SELECTOR_ARGS={upBillVoId:null,downBillVoId:null,manaualCreationMode:null},PushTaskArgs=(Xd=commonApi$1.JsonConvertableImpl,__extends(Yd,Xd),Yd.prototype.ResetBeforeLoadFrom=function(){Xd.prototype.ResetBeforeLoadFrom.call(this),this.suCode=null,this.creationRuleExecutorResult=null},Yd.prototype.ConvertToJsonObject=function(){var e=Xd.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"creationRuleExecutorResult",this.creationRuleExecutorResult),e},Yd.prototype.LoadFromJsonObject=function(e){Xd.prototype.LoadFromJsonObject.call(this,e),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.creationRuleExecutorResult=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"creationRuleExecutorResult",runtimeApi.RpcCreationRuleExecutorResult)},Yd),Xd;function Yd(){return null!==Xd&&Xd.apply(this,arguments)||this}var GetEntityDatasArgs=(_d=commonApi$1.JsonConvertableImpl,__extends(ae,_d),ae.prototype.ResetBeforeLoadFrom=function(){_d.prototype.ResetBeforeLoadFrom.call(this),this.voId=null,this.dataId=null,this.suCode=null},ae.prototype.ConvertToJsonObject=function(){var e=_d.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.voId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),e},ae.prototype.LoadFromJsonObject=function(e){_d.prototype.LoadFromJsonObject.call(this,e),this.voId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode")},ae),_d;function ae(){return null!==_d&&_d.apply(this,arguments)||this}var LANG_RESOURCES={"zh-CHS":{confirm:"确定",cancel:"取消",emptyResult:"查询结果为空",selectUpstreamBill:"请选择上游单据",selectDownstreamBill:"请选择下游单据",selectCreationProcess:"请选择生单流程",processDesciption:"流程描述",creationProcessSelector:"生单流程选择",upstreamBillSelector:"上游单据选择",creationExecutionError:"生单流程执行错误",creationResultEmpty:"生单结果为空",pushTaskCenterSuccess:"推送至任务中心",pushTaskCenterFailed:"推送任务中心失败"},en:{confirm:"confirm",cancel:"cancel",emptyResult:"The result is empty",selectUpstreamBill:"Select upstream bill",selectDownstreamBill:"Select downstream bill",selectCreationProcess:"Select creation process",processDesciption:"Desciption",creationProcessSelector:"CreationRule Selector",upstreamBillSelector:"Upstream Bill Selector",creationExecutionError:"Creation Process Execution Error",creationResultEmpty:"Creation result is empty",pushTaskCenterSuccess:"Success to push data to task center",pushTaskCenterFailed:"Failed to push data to task center"},"zh-CHT":{confirm:"確定",cancel:"取消",emptyResult:"查詢結果為空",selectUpstreamBill:"請選擇上遊單據",selectDownstreamBill:"請選擇下遊單據",selectCreationProcess:"請選擇生單流程",processDesciption:"流程描述",creationProcessSelector:"生單流程選擇",upstreamBillSelector:"上遊單據選擇",creationExecutionError:"生單規則執行錯誤",creationResultEmpty:"生單結果為空",pushTaskCenterSuccess:"推送至任務中心",pushTaskCenterFailed:"推送任務中心失敗"}},LocalePipe=(de.prototype.transform=function(e){return this.lang[e]||e},de.decorators=[{type:core$1.Pipe,args:[{name:"locale"}]}],de.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},de);function de(e){this.langCode=e||"zh-CHS",this.lang=LANG_RESOURCES[this.langCode]}var BifDataService=(ge.prototype.getSlimBillCreationProcessEntityExesByUpBillVoId4Push=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.upBillVoId=e,t.manualCreationMode=ManualCreationMode.Push,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},ge.prototype.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.downBillVoId=e,t.manualCreationMode=ManualCreationMode.Pull,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPush,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPull,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getSlimBillCreationProcessEntityExById=function(e){return null!=this.httpService?this.httpService.request(this.getBillCreationProcessEntityExByIdMethod,this.getBillCreationProcessEntityExByIdUrl+"/"+e,{}):this.repository.proxy.request(this.getBillCreationProcessEntityExByIdUrl+"/"+e,this.getBillCreationProcessEntityExByIdMethod,null)},ge.prototype.getFormSettingsById=function(e){if(null==e||""==e.trim())throw"FormSettingsId为空";return(null!=this.httpService?this.httpService.request(this.generalTextMethod,this.generalTextUrl+"/"+e,{responseType:"text"}):this.repository.proxy.request(this.generalTextUrl+"/"+e,this.generalTextMethod,null,{responseType:"text"})).pipe(operators.map(function(e){var t=new commonApi.GeneralTextEntity;t.LoadFromJson(e);var r=new commonApi.FormSettings;return r.LoadFromJson(t.text),r}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getCreationResultById=function(e){if(null==e||""==e.trim())throw"creationResultId为空";return(null!=this.httpService?this.httpService.request(this.generalTextMethod,this.generalTextUrl+"/"+e,{responseType:"text"}):this.repository.proxy.request(this.generalTextUrl+"/"+e,this.generalTextMethod,null,{responseType:"text"})).pipe(operators.map(function(e){var t=new commonApi.GeneralTextEntity;t.LoadFromJson(e);var r=new runtimeApi.FormBillCreationProcessExecutorResult;return r.LoadFromJson(t.text),r}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.addFormBillCreationProcessExecutorResult=function(e){if(null==e)throw"参数creationResult不可为空";if("string"==typeof e){if(""==e)throw"参数creationResult不可为空";var t=new runtimeApi.FormBillCreationProcessExecutorResult;t.LoadFromJson(e),e=t}var r;if(e instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((r=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(e),e=r),0!=e.conditionResult.conditionExecutionResult){if(null!=e.creationRuleExecutorResult&&null!=e.creationRuleExecutorResult.mappingResults&&0!=e.creationRuleExecutorResult.mappingResults.length){var o={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.generalTextCreationMethod,""+this.generalTextUrl,o):this.repository.proxy.request(""+this.generalTextUrl,this.generalTextCreationMethod,null,o)).pipe(operators.map(function(e){return commonApi.BpmnModelJsonHelper.FromJson(e,GeneralTextIdWithDataId)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))}this.messager.error(this.localePipe.transform("creationResultEmpty"))}else this.messager.error(e.conditionResult.message||this.localePipe.transform("creationExecutionError"))},ge.prototype.executeBillCreationProcess=function(e){if(null==e.manualCreationMode)throw"manualCreationMode不可为空";var t={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.executeBillCreationProcessMethod,this.executeBillCreationProcessUrl,t):this.repository.proxy.request(this.executeBillCreationProcessUrl,this.executeBillCreationProcessMethod,null,t)).pipe(operators.map(function(e){var t=new runtimeApi.FormBillCreationProcessExecutorResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.createEntityDatas=function(e){var n=this,t={body:e.ConvertToJson(),responseType:"text"};return this.repository.proxy.request(this.formCreateUrl,this.formCreateMethod,null,t).pipe(operators.switchMap(function(e){var t=new runtimeApi.FormCreateResult;t.LoadFromJson(e);var r=t.entityDataList.map(function(e){var t=n.repository.buildEntity(JSON.parse(e));return n.appendInitialData(t,t),t}),o=n.repository.entityCollection.getAllEntities();return null==o||0==o.length?n.repository.entityCollection.loadEntities(r):n.repository.entityCollection.addEntities(r),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.updateEntityDatas=function(e){var t={body:e.ConvertToJson(),responseType:"text"};return this.repository.proxy.request(this.formUpdateUrl,this.formUpdateMethod,null,t).pipe(operators.map(function(e){var t=new runtimeApi.FormUpdateResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.pushTaskCenter=function(e){var t={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.pushTaskMethod,this.pushTaskUrl,t):this.repository.proxy.request(this.pushTaskUrl,this.pushTaskMethod,null,t)).pipe(operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getEntityDatas=function(e){var t={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.getEntityDatasMethod,this.getEntityDatasUrl,t):this.repository.proxy.request(this.getEntityDatasUrl,this.getEntityDatasMethod,null,t)).pipe(operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.getSlimBillCreationProcessEntityExes=function(e){if(null==e)throw"args不可为空";if("string"==typeof e){if(""==e)throw"args不可为空";var t=new FormGetBillCreationProcessEntityExArgs;t.LoadFromJson(e),e=t}var r={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.getBillCreationProcessEntityExMethod,this.getBillCreationProcessEntityExUrl,r):this.repository.proxy.request(this.getBillCreationProcessEntityExUrl,this.getBillCreationProcessEntityExMethod,null,r)).pipe(operators.map(function(e){var t=new FormGetBillCreationProcessEntityExResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},ge.prototype.appendInitialData=function(e,t){var r=Object.assign({},t);delete r.id,delete r.parentID,e.initialData=r},ge.decorators=[{type:core$1.Injectable}],ge.ctorParameters=function(){return[{type:http.HttpClient},{type:devkit.Repository},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]},{type:core$1.NgModuleFactoryLoader,decorators:[{type:core$1.Optional}]},{type:uiModal.BsModalService,decorators:[{type:core$1.Optional}]},{type:uiMessager.MessagerService,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]},{type:LocalePipe,decorators:[{type:core$1.Optional}]},{type:cafCommon.HttpService,decorators:[{type:core$1.Optional}]}]},ge);function ge(e,t,r,o,n,i,a,l,s,c,p,d){this.httpClient=e,this.injector=r,this.cfr=o,this.loader=n,this.modal=i,this.messager=a,this.frameContext=l,this.localeId=s,this.runtimeFrameworkService=c,this.localePipe=p,this.httpService=d,this.getBillCreationProcessEntityExByIdUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityex",this.getBillCreationProcessEntityExByIdMethod="GET",this.getBillCreationProcessEntityExUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityexes",this.getBillCreationProcessEntityExMethod="POST",this.executeBillCreationProcessUrl="/api/runtime/aif/v1.0/manualcreationbill/executebillcreationprocess",this.executeBillCreationProcessMethod="POST",this.formCreateUrl="/api/runtime/aif/v1.0/form/create",this.formCreateMethod="POST",this.formUpdateUrl="/api/runtime/aif/v1.0/form/update",this.formUpdateMethod="POST",this.generalTextUrl="/api/runtime/aif/v1.0/generaltext",this.generalTextMethod="GET",this.generalTextCreationMethod="POST",this.pushTaskUrl="/api/runtime/aif/v1.0/manualcreationbill/pushtask",this.pushTaskMethod="POST",this.getEntityDatasUrl="/api/runtime/aif/v1.0/manualcreationbill/getentitydatas",this.getEntityDatasMethod="POST",this.repository=t,this.injector=null!=this.injector?this.injector:this.repository.appContext.injector,this.cfr=null!=this.cfr?this.cfr:this.injector.get(core$1.ComponentFactoryResolver,null),this.loader=null!=this.loader?this.loader:this.injector.get(core$1.NgModuleFactoryLoader,null),this.modal=null!=this.modal?this.modal:this.injector.get(uiModal.BsModalService,null),this.messager=null!=this.messager?this.messager:this.injector.get(uiMessager.MessagerService,null),this.frameContext=null!=this.frameContext?this.frameContext:this.injector.get(devkit.FrameContext,null),this.localeId=null!=this.localeId?this.localeId:this.injector.get(core$1.LOCALE_ID,localStorage.getItem("languageCode")||"zh-CHS"),this.runtimeFrameworkService=null!=this.runtimeFrameworkService?this.runtimeFrameworkService:this.injector.get(commandServices.RuntimeFrameworkService,null),this.localePipe=null!=this.localePipe?this.localePipe:this.injector.get(LocalePipe,new LocalePipe(this.localeId)),this.httpService=null!=this.httpService?this.httpService:this.injector.get(cafCommon.HttpService,null)}var AbstractBifDataSelectorService=(wg.decorators=[{type:core$1.Injectable}],wg);function wg(){this.subject4EntityDatas=new rxjs.Subject}var DefaultBifDataSelectorService=(xg=AbstractBifDataSelectorService,__extends(yg,xg),yg.decorators=[{type:core$1.Injectable}],yg.ctorParameters=function(){return[{type:devkit.FrameContext},{type:devkit.ViewModel},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},yg),xg;function yg(e,t,r,o){var n=xg.call(this)||this;return n.frameContext=e,n.viewModel=t,n.cfr=r,n.injector=o,n.subject4EntityDatas=new rxjs.Subject,n.clickOk4BifSelector=function(){n.viewModel.frameContext.repository.getById(n.viewModel.bindingData.getObject().id).subscribe(function(e){n.subject4EntityDatas.next([e]),n.subject4EntityDatas.complete(),n.bsModalRef4BifSelector.close()})},n.clickClose4BifSelector=function(){n.subject4EntityDatas.complete(),n.bsModalRef4BifSelector.close()},n}var AbstractUiService=(Fg.prototype.openBillCreationProcessSelector=function(e,t,r,o,n){var i=this;if("string"==typeof r){if(""==r)throw"modalOptions不可为空";r=JSON.parse(r)}(r=null==r?this.defaultModalOptions:r).title=null==r.title?this.localePipe.transform("creationProcessSelector"):r.title;var a=null;if(null!=o&&""!=o.trim())return rxjs.from(this.loader.load(o)).pipe(operators.switchMap(function(e){var t=e.create(i.frameContext.root.injector).instance.createCreationProcessSelector(i.frameContext.root.injector,n);return t instanceof rxjs.Observable?t.pipe(operators.switchMap(function(e){return a=e,i.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=i.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()})):t instanceof core$1.ComponentRef?(a=t,i.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=i.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()):void 0}));var l=this.cfr.resolveComponentFactory(t),s=core$1.ReflectiveInjector.resolveAndCreate([{provide:SELECTOR_ARGS_INJECTOR,useValue:e.ConvertToJsonObject()},uiLoading.LoadingService],this.injector),a=l.create(s);return this.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=this.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()},Fg.prototype.configModalButtons=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.instance.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.instance.clickClose4BifSelector}],e.showButtons=!0},Fg.ctorParameters=function(){return[{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},Fg);function Fg(e,t,r,o,n,i,a,l){this.frameContext=e,this.modalService=t,this.messager=r,this.injector=o,this.cfr=n,this.loader=i,this.localeId=a,this.defaultModalOptions={title:null,width:650,height:415,buttons:null,showButtons:null},this.runtimeFrameworkService=l||o.get(commandServices.RuntimeFrameworkService),this.localePipe=new LocalePipe(a)}var PushSelectorComponent=(Object.defineProperty(bh.prototype,"selectedVoId",{get:function(){return this._selectedVoId},set:function(e){null!=(this._selectedVoId=e)&&(this.selectedEntity=this.entityDict[this._selectedVoId][0])},enumerable:!0,configurable:!0}),bh.prototype.ngOnInit=function(){this.loadItems()},bh.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef}),(null==this.args.downBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoId4Push(this.args.upBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){e.forEach(function(e){!1===t.voIdList.includes(e.downBillVoId)&&(t.voIdList.push(e.downBillVoId),t.entityDict[e.downBillVoId]=new Array),t.nameDict[e.downBillVoId]=e.downBillVoName,t.entityDict[e.downBillVoId].push(e)}),t.selectedVoId=0<t.voIdList.length?t.voIdList[0]:null,t.loading.close()},function(e){throw t.loading.close(),e})},bh.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-push-selector",template:'<div class="g-main px-3 py-2">\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="height: 150px;overflow-y: auto;">\r\n    <div [hidden]="voIdList.length != 0"><span style="color: red;">{{ \'emptyResult\' | locale }}</span></div>\r\n    <div>{{ \'selectDownstreamBill\' | locale }}</div>\r\n    <div *ngFor="let voId of voIdList;let i=index" class="col-sm-12 col-md-5 form-check form-check-inline">\r\n      <input class="form-check-input" type="radio" [name]="\'voId\'+i" [id]="voId" [value]="voId"\r\n        [(ngModel)]="selectedVoId" />\r\n      <label class="form-check-label" [for]="\'voId\'+i">{{nameDict[voId]}}</label>\r\n    </div>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'selectCreationProcess\' | locale }}</div>\r\n    <select class="form-control" name="selectedEntity" [(ngModel)]="selectedEntity">\r\n      <option *ngFor="let cr of entityDict[selectedVoId];" [ngValue]="cr">\r\n        {{cr.name}}({{cr.code}})</option>\r\n    </select>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'processDesciption\' | locale }}</div>\r\n    <textarea readonly class="form-control" name="description" rows="3"\r\n      [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n  </div>\r\n</div>',styles:[""]}]}],bh.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef}]},bh);function bh(e,t,r,o,n){var i=this;this.dataService=t,this.loading=o,this.elementRef=n,this.voIdList=[],this.nameDict={},this.entityDict={},this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){i.subject4CreationProcess.next(i.selectedEntity),i.subject4CreationProcess.complete(),i.bsModalRef4BifSelector.close()},this.clickClose4BifSelector=function(){i.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e)}function judgeBrowserType(){var e,t={type:"Unknown",IEVersion:undefined},r=navigator.userAgent,o=-1<r.indexOf("Opera"),n=(n=-1<r.indexOf("compatible")&&-1<r.indexOf("MSIE")&&!o)||!!window.ActiveXObject||"ActiveXObject"in window,i=-1<r.indexOf("Windows NT 6.1; Trident/7.0;")&&!n,a=-1<r.indexOf("Firefox"),l=-1<r.indexOf("Safari")&&-1==r.indexOf("Chrome"),s=-1<r.indexOf("Chrome")&&-1<r.indexOf("Safari");return n&&(t.type="IE",null!=navigator.userAgent&&navigator.userAgent.match(/Trident\/7\./)?t.IEVersion="IE11":(new RegExp("MSIE (\\d+\\.\\d+);").test(r),e=parseFloat(RegExp.$1),t.IEVersion=7==e?"IE7":8==e?"IE8":9==e?"IE9":10==e?"IE10":11==e?"IE11":"Unknown")),a&&(t.type="FF"),o&&(t.type="Opera"),l&&(t.type="Safari"),s&&(t.type="Chrome"),i&&(t.type="Edge"),t}var BifSourceUiService=(zh=AbstractUiService,__extends(Ah,zh),Ah.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,n){var i=new FormGetBillCreationProcessEntityExArgs;return i.upBillVoId=e,i.manualCreationMode=ManualCreationMode.Push,this.openBillCreationProcessSelector(i,PushSelectorComponent,r,o,n)},Ah.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,n,i){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPush,this.openBillCreationProcessSelector(a,PushSelectorComponent,o,n,i)},Ah.prototype.openTargetForm=function(e,t,r){var o,n,i;if(null==e)throw"参数formSettings不可为空";if(null==t)throw"参数creationResult不可为空";if("string"==typeof t){if(""==t)throw"参数creationResult不可为空";var a=new runtimeApi.FormBillCreationProcessExecutorResult;a.LoadFromJson(t),t=a}if(t instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((i=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(t),t=i),0!=t.conditionResult.conditionExecutionResult)if(null!=t.creationRuleExecutorResult&&null!=t.creationRuleExecutorResult.mappingResults&&0!=t.creationRuleExecutorResult.mappingResults.length)if(1==t.creationRuleExecutorResult.mappingResults.length)null!=(c=e.targetCardAppLoadCmd)&&""!=c&&(null==r?r={action:c}:r.action=null!=r.action&&""!=r.action?r.action:c),this.openApp(t.creationRuleExecutorResult.mappingResults[0].associations[0].tarRootDataId,e.targetCardAppId,e.targetCardAppEntrance,t,r,!1);else{if(null!=e.targetListAppId)throw"暂不支持打开批量编辑界面";try{for(var l=__values(t.creationRuleExecutorResult.mappingResults),s=l.next();!s.done;s=l.next()){var c,p=s.value,d=new runtimeApi.FormBillCreationProcessExecutorResult;d.conditionResult=t.conditionResult,d.creationRuleExecutorResult=new runtimeApi.RpcCreationRuleExecutorResult,d.creationRuleExecutorResult.bizFlowchartId=t.creationRuleExecutorResult.bizFlowchartId,d.creationRuleExecutorResult.creationRuleId=t.creationRuleExecutorResult.creationRuleId,d.creationRuleExecutorResult.creationRuleInstanceId=t.creationRuleExecutorResult.creationRuleInstanceId,d.creationRuleExecutorResult.mappingResults=[p],null!=(c=e.targetCardAppLoadCmd)&&""!=c&&(null==r?r={action:c}:r.action=null!=r.action&&""!=r.action?r.action:c),this.openApp(p.associations[0].tarRootDataId,e.targetCardAppId,e.targetCardAppEntrance,d,r,!1)}}catch(u){o={error:u}}finally{try{s&&!s.done&&(n=l["return"])&&n.call(l)}finally{if(o)throw o.error}}}else this.messager.error(this.localePipe.transform("creationResultEmpty"));else this.messager.error(t.conditionResult.message||this.localePipe.transform("creationExecutionError"))},Ah.prototype.openApp=function(e,t,r,o,n,i,a,l,s){n=null==n?{}:n;var c=judgeBrowserType();"IE"==c.type&&"IE11"==c.IEVersion?(window.top.localStorage.setItem(e,o.ConvertToJson()),this.navigationService.openApp(e,t,r,n,i,a,l,s)):this.navigationService.openApp(e,t,r,this.buildRouteParams(o,n),i,a,l,s)},Ah.prototype.buildRouteParams=function(e,t){var r=t;return r[this.uiStateKeyCreationResult]=e.ConvertToJson(),null!=r.action&&""!=r.action||(r.action="rootviewmodelbifLoad1"),r},Ah.prototype.openTargetApp=function(e,t,r,o){var n,i;if(null==e)throw"参数formSettings不可为空";if(null==r)throw"参数creationResult不可为空";if("string"==typeof r){if(""==r)throw"参数creationResult不可为空";r=commonApi$1.BpmnModelJsonHelper.FromJson(r,GeneralTextIdWithDataId)}if(0!=t.conditionExecutionResult)if(null==r||null==r.length||r.length<=0)this.messager.error(this.localePipe.transform("creationResultEmpty"));else if(1==r.length)null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==o?o={action:s}:o.action=null!=o.action&&""!=o.action?o.action:s),this.openAppWithGeneralText(r[0].dataId,e.targetCardAppId,e.targetCardAppEntrance,r[0].generalTextId,o,!1);else{if(null!=e.targetListAppId)throw"暂不支持打开批量编辑界面";try{for(var a=__values(r),l=a.next();!l.done;l=a.next()){var s,c=l.value;null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==o?o={action:s}:o.action=null!=o.action&&""!=o.action?o.action:s),this.openAppWithGeneralText(c.dataId,e.targetCardAppId,e.targetCardAppEntrance,c.generalTextId,o,!1)}}catch(p){n={error:p}}finally{try{l&&!l.done&&(i=a["return"])&&i.call(a)}finally{if(n)throw n.error}}}else this.messager.error(t.message||this.localePipe.transform("creationExecutionError"))},Ah.prototype.openAppWithGeneralText=function(e,t,r,o,n,i,a,l,s){n=null==n?{}:n;var c=judgeBrowserType();"IE"==c.type&&"IE11"==c.IEVersion&&window.top.localStorage.setItem(e,o),this.navigationService.openApp(e,t,r,this.buildRouteParamsWithGeneralText(o,n),i,a,l,s)},Ah.prototype.buildRouteParamsWithGeneralText=function(e,t){var r=t;return r[this.uiStateKeyCreationResult]=e,null!=r.action&&""!=r.action||(r.action="rootviewmodelbifLoad1"),r},Ah.decorators=[{type:core$1.Injectable}],Ah.ctorParameters=function(){return[{type:commandServices.NavigationService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},Ah),zh;function Ah(e,t,r,o,n,i,a,l,s){var c=zh.call(this,t,r,o,n,i,a,l,s)||this;return c.navigationService=e,c.frameContext=t,c.modalService=r,c.messager=o,c.injector=n,c.cfr=i,c.loader=a,c.localeId=l,c.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,c}var PullSelectorComponent=(Object.defineProperty(Wi.prototype,"selectedVoId",{get:function(){return this._selectedVoId},set:function(e){null!=(this._selectedVoId=e)&&(this.selectedEntity=this.entityDict[this._selectedVoId][0])},enumerable:!0,configurable:!0}),Wi.prototype.ngOnInit=function(){this.loadItems()},Wi.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef}),(null==this.args.upBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull(this.args.downBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){e.forEach(function(e){!1===t.voIdList.includes(e.upBillVoId)&&(t.voIdList.push(e.upBillVoId),t.entityDict[e.upBillVoId]=new Array),t.nameDict[e.upBillVoId]=e.upBillVoName,t.entityDict[e.upBillVoId].push(e)}),t.selectedVoId=0<t.voIdList.length?t.voIdList[0]:null,t.loading.close()},function(e){throw t.loading.close(),e})},Wi.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-pull-selector",template:'<div class="g-main px-3 py-2">\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="height: 150px;overflow-y: auto;">\r\n    <div [hidden]="voIdList.length != 0"><span style="color: red;">{{ \'emptyResult\' | locale }}</span></div>\r\n    <div>{{ \'selectUpstreamBill\' | locale }}</div>\r\n    <div *ngFor="let voId of voIdList;let i=index" class="col-sm-12 col-md-5 form-check form-check-inline">\r\n      <input class="form-check-input" type="radio" [name]="\'voId\'+i" [id]="voId" [value]="voId"\r\n        [(ngModel)]="selectedVoId" />\r\n      <label class="form-check-label" [for]="\'voId\'+i">{{nameDict[voId]}}</label>\r\n    </div>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'selectCreationProcess\' | locale }}</div>\r\n    <select class="form-control" name="selectedEntity" [(ngModel)]="selectedEntity">\r\n      <option *ngFor="let cr of entityDict[selectedVoId];" [ngValue]="cr">\r\n        {{cr.name}}({{cr.code}})</option>\r\n    </select>\r\n  </div>\r\n\r\n  \x3c!--  --\x3e\r\n  <div class="form-group" style="">\r\n    <div>{{ \'processDesciption\' | locale }}</div>\r\n    <textarea readonly class="form-control" name="description" rows="3"\r\n      [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n  </div>\r\n</div>',styles:[""]}]}],Wi.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef}]},Wi);function Wi(e,t,r,o,n){var i=this;this.dataService=t,this.loading=o,this.elementRef=n,this.voIdList=[],this.nameDict={},this.entityDict={},this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){i.subject4CreationProcess.next(i.selectedEntity),i.subject4CreationProcess.complete(),i.bsModalRef4BifSelector.close()},this.clickClose4BifSelector=function(){i.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e)}function canJSONParse(e){try{if("object"==typeof JSON.parse(e))return 1}catch(t){}}var BifTargetUiService=(lj=AbstractUiService,__extends(mj,lj),mj.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,n){var i=new FormGetBillCreationProcessEntityExArgs;return i.downBillVoId=e,i.manualCreationMode=ManualCreationMode.Pull,this.openBillCreationProcessSelector(i,PullSelectorComponent,r,o,n)},mj.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,n,i){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPull,this.openBillCreationProcessSelector(a,PullSelectorComponent,o,n,i)},mj.prototype.openSourceDataSelector4Pull=function(n,i,a){var l=this;(i=null==i?this.defaultModalOptions:i).title=null==i.title?this.localePipe.transform("sourceDataSelector"):i.title;var s=null;if(null==n||null==n.sourceDataSelectorModuleUrl)throw"暂无默认实现，请使用自定义来源单据选择器";return(null!=n.sourceDataSelectorAppId?rxjs.from(System["import"](n.sourceDataSelectorModuleUrl.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(n.sourceDataSelectorModuleUrl))).pipe(operators.switchMap(function(e){var t=e.create(l.frameContext.root.injector);if(!(t.instance.createSourceDataSelector&&t.instance.createSourceDataSelector instanceof Function)){var r=t.injector.get(core.TranslateService);return r.getTranslation(l.localeId).pipe(operators.switchMap(function(e){return r.setTranslation(l.localeId,e),r.defaultLang=l.localeId,r.currentLang=l.localeId,l.getEntityData(t,n,i,a)}),operators.catchError(function(e){return console.error(e),l.getEntityData(t,n,i,a)}))}var o=t.instance.createSourceDataSelector(l.frameContext.root.injector,null,a);return o instanceof rxjs.Observable?o.pipe(operators.switchMap(function(e){return s=e,l.configModalButtons(i,s),s.instance.bsModalRef4BifSelector=l.modalService.show(s,i),s.instance.subject4EntityDatas.asObservable()})):o instanceof core$1.ComponentRef?(s=o,l.configModalButtons(i,s),s.instance.bsModalRef4BifSelector=l.modalService.show(s,i),s.instance.subject4EntityDatas.asObservable()):void 0}))},mj.prototype.getFormBillCreationProcessExecutorResult=function(){var e,t=this.runtimeFrameworkService.tabId,r=t.substr(t.length-36),o=judgeBrowserType();"IE"==o.type&&"IE11"==o.IEVersion&&(e=window.top.localStorage.getItem(r),window.top.localStorage.removeItem(r),this.frameContext.root.uiState.setPropertyValue(this.uiStateKeyCreationResult,e));var n=this.frameContext.root.uiState[this.uiStateKeyCreationResult];if(null==n)throw"FormBillCreationProcessExecutorResult is null";var i=new runtimeApi.FormBillCreationProcessExecutorResult;if("string"==typeof n)i.LoadFromJson(n);else{if("object"!=typeof n)throw"不合法的类型";i.LoadFromJsonObject(n)}return i},mj.prototype.getCreationResult=function(){var e,t=this.runtimeFrameworkService.tabId,r=t.substr(t.length-36),o=judgeBrowserType();"IE"==o.type&&"IE11"==o.IEVersion&&(e=window.top.localStorage.getItem(r),window.top.localStorage.removeItem(r),this.frameContext.root.uiState.setPropertyValue(this.uiStateKeyCreationResult,e));var n=this.frameContext.root.uiState[this.uiStateKeyCreationResult];if(null==n)throw"FormBillCreationProcessExecutorResult is null";var i=new runtimeApi.FormBillCreationProcessExecutorResult;if("string"==typeof n)return canJSONParse(n)?(i.LoadFromJson(n),rxjs.of(i)):this.dataService.getCreationResultById(n);if("object"==typeof n)return i.LoadFromJsonObject(n),rxjs.of(i);throw"不合法的类型"},mj.prototype.configModalButtonsByService=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.clickClose4BifSelector}],e.showButtons=!0},mj.prototype.getEntityData=function(n,e,t,r){var i=null,a=null,l="app-rootcomponent",o=null,s=n.componentFactoryResolver._factories,c=null;r&&r.bootstrapComponentSelector?(l=r.bootstrapComponentSelector,s.forEach(function(e,t,r){var o=e.selector;l==o&&(i=n.componentFactoryResolver.resolveComponentFactory(t),a=i.create(n.injector))})):(o=n._bootstrapComponents[0])?(i=n.componentFactoryResolver.resolveComponentFactory(o),a=i.create(n.injector)):s.forEach(function(e,t,r){var o=e.selector;l==o&&(i=n.componentFactoryResolver.resolveComponentFactory(t),a=i.create(n.injector))}),a&&a.instance&&a.instance.viewModel&&a.instance.viewModel.uiState&&(a.instance.viewModel.uiState.setPropertyValue("action","Load1"),a.instance.viewModel.uiState.setPropertyValue("DEVKIT_DIALOG",!0));var p,d,u,m=a.injector.get(AbstractBifDataSelectorService,null),c=null!=m?(this.configModalButtonsByService(t,m),m.bsModalRef4BifSelector=this.modalService.show(a,t),m.subject4EntityDatas.asObservable()):(this.configModalButtons(t,a),a.instance.bsModalRef4BifSelector=this.modalService.show(a,t),a.instance.subject4EntityDatas.asObservable());return a&&a.instance&&a.instance.viewModel&&r&&r.loadCommand&&(p=r.loadCommand,(d=a.instance.viewModel[p])&&(u=undefined,r&&r.loadParams&&(u=Array.isArray(r.loadParams)?r.loadParams:[r.loadParams]),d.apply(a.instance.viewModel,u))),c},mj.decorators=[{type:core$1.Injectable}],mj.ctorParameters=function(){return[{type:BifDataService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},mj),lj;function mj(e,t,r,o,n,i,a,l,s){var c=lj.call(this,t,r,o,n,i,a,l,s)||this;return c.dataService=e,c.frameContext=t,c.modalService=r,c.messager=o,c.injector=n,c.cfr=i,c.loader=a,c.localeId=l,c.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,c}var ɵ0=localStorage.getItem("languageCode")||"zh-CHS",ɵ1={},BifManualCreationModule=(Jk.forRoot=function(e){return{ngModule:Jk,providers:[{provide:ModuleConfig,useValue:e||{}},BifDataService,BifSourceUiService,BifTargetUiService]}},Jk.decorators=[{type:core$1.NgModule,args:[{declarations:[PushSelectorComponent,PullSelectorComponent,LocalePipe],imports:[common.CommonModule,forms.FormsModule,http.HttpClientModule,uiModal.ModalModule.forRoot(),uiNotify.NotifyModule.forRoot(),uiMessager.MessagerModule.forRoot(),uiDialog.FarrisDialogModule.forRoot(),uiLoading.LoadingModule.forRoot()],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0},{provide:ModuleConfig,useValue:ɵ1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},BifDataService,BifSourceUiService,BifTargetUiService],exports:[PushSelectorComponent,PullSelectorComponent],entryComponents:[PushSelectorComponent,PullSelectorComponent]}]}],Jk);function Jk(){}var CanTrackingResult=(Mk=CanTrackingInfo,__extends(Nk,Mk),Nk.prototype.ResetBeforeLoadFrom=function(){Mk.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.voName=null},Nk.prototype.ConvertToJsonObject=function(){var e=Mk.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},Nk.prototype.LoadFromJsonObject=function(e){Mk.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},Nk),Mk;function Nk(){return null!==Mk&&Mk.apply(this,arguments)||this}var GetChildrenEntityDataArgs=(Qk=commonApi$1.JsonConvertableImpl,__extends(Rk,Qk),Rk.prototype.ResetBeforeLoadFrom=function(){Qk.prototype.ResetBeforeLoadFrom.call(this),this.voId=null,this.voMetadataId=null,this.suCode=null,this.nodeCodes=null,this.hierachyIdList=null},Rk.prototype.ConvertToJsonObject=function(){var e=Qk.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voId",this.voId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"nodeCodes",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.nodeCodes)),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"hierachyIdList",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.hierachyIdList)),e},Rk.prototype.LoadFromJsonObject=function(e){Qk.prototype.LoadFromJsonObject.call(this,e),this.voId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voId"),this.voMetadataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.nodeCodes=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"nodeCodes")),this.hierachyIdList=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"hierachyIdList"))},Rk),Qk;function Rk(){return null!==Qk&&Qk.apply(this,arguments)||this}var DownBillInfoResult=(Uk=DownBillInfo,__extends(Vk,Uk),Vk.prototype.ResetBeforeLoadFrom=function(){Uk.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},Vk.prototype.ConvertToJsonObject=function(){var e=Uk.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},Vk.prototype.LoadFromJsonObject=function(e){Uk.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},Vk),Uk;function Vk(){return null!==Uk&&Uk.apply(this,arguments)||this}var EntityDataResult=(Yk=commonApi$1.JsonConvertableImpl,__extends(Zk,Yk),Zk.prototype.ResetBeforeLoadFrom=function(){Yk.prototype.ResetBeforeLoadFrom.call(this),this.billSchema=null,this.billData=null},Zk.prototype.ConvertToJsonObject=function(){var e=Yk.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billSchema",this.billSchema),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billData",this.billData),e},Zk.prototype.LoadFromJsonObject=function(e){Yk.prototype.LoadFromJsonObject.call(this,e),this.billSchema=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billSchema",commonApi$1.BillSchema),this.billData=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billData",commonApi$1.BillData)},Zk),Yk;function Zk(){return null!==Yk&&Yk.apply(this,arguments)||this}var GetEntityDataArgs=(al=commonApi$1.JsonConvertableImpl,__extends(bl,al),bl.prototype.ResetBeforeLoadFrom=function(){al.prototype.ResetBeforeLoadFrom.call(this),this.schemaId=null,this.dataId=null,this.suCode=null,this.voMetadataId=null,this.billChildInfos=[],this.trackingSourceType=null,this.curYear=null,this.documentTypeId=null},bl.prototype.ConvertToJsonObject=function(){var e=al.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),e},bl.prototype.LoadFromJsonObject=function(e){al.prototype.LoadFromJsonObject.call(this,e),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.voMetadataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId")},bl),al;function bl(){var e=null!==al&&al.apply(this,arguments)||this;return e.billChildInfos=[],e}var GetMainEntityDataArgs=(fl=GetEntityDataArgs,__extends(gl,fl),gl),fl;function gl(){return null!==fl&&fl.apply(this,arguments)||this}var UpBillInfoResult=(hl=UpBillInfo,__extends(il,hl),il.prototype.ResetBeforeLoadFrom=function(){hl.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},il.prototype.ConvertToJsonObject=function(){var e=hl.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},il.prototype.LoadFromJsonObject=function(e){hl.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},il),hl;function il(){return null!==hl&&hl.apply(this,arguments)||this}var GetJointQueryParametersArgs=(ll=commonApi$1.JsonConvertableImpl,__extends(ml,ll),ml.prototype.ResetBeforeLoadFrom=function(){ll.prototype.ResetBeforeLoadFrom.call(this),this.trackingSourceType=null,this.suCode=null,this.schemaId=null,this.dataId=null,this.contents=[],this.curYear=null},ml.prototype.ConvertToJsonObject=function(){var e=ll.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"contents",this.contents),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},ml.prototype.LoadFromJsonObject=function(e){ll.prototype.LoadFromJsonObject.call(this,e),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.contents=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"contents",JointQueryParametersContent),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},ml),ll;function ml(){var e=null!==ll&&ll.apply(this,arguments)||this;return e.contents=[],e}var BillTrackerArgs=(ql.decorators=[{type:core$1.Injectable}],ql.ctorParameters=function(){return[]},ql);function ql(){this.getBillsInfoArgs=null,this.canTrackingResult=null,this.direction=null,this.graphOptions=null,this.gridOptions=null}var BillTrackerConstant=(rl.IMAGE_PATH="/platform/runtime/common/web/@edp-bif/runtime-api/images",rl.DEFAULT_FUNC_ID="DefaultBillTracker",rl.DEFAULT_APP_ID="BillIntegrationFrameworkRT",rl.DEFAULT_APP_ENTRANCE="default-bill-tracker",rl.BILL_VIEWER_FUNC_ID="BifBillViewer",rl.BILL_VIEWER_APP_ID="BillIntegrationFrameworkRT",rl.BILL_VIEWER_APP_ENTRANCE="bif-bill-viewer",rl);function rl(){}var BillTrackerModuleConfig=function(){},BillTrackerDirection={Down:"Down",Up:"Up",Both:"Both"},BillTrackerGraphOptions=function(){this.nodeWidth=100,this.nodeHeight=60,this.overlayWidth=10,this.overlayHeight=10,this.showDownBills=!0,this.showUpBills=!0},BillTrackerGridOptions=function(){this.showEntryData=!0,this.defaultHeight=180},GraphView=(vl=mxGraphViewType,__extends(wl,vl),wl.prototype.validate=function(e){var t,r,o=this.graph;null!=o&&null!=o.container&&mxUtilsType.hasScrollbars(o.container)&&(t=o.getPagePadding(),r=o.getPageSize(),this.translate.x,this.translate.y,this.translate.x=t.x/this.scale-(this.x0||0)*r.width,this.translate.y=t.y/this.scale-(this.y0||0)*r.height),vl.prototype.validate.call(this,e)},wl.prototype.getBackgroundPageBounds=function(){var e=this.graph,t=e.getPageLayout(),r=e.getPageSize();return new mxRectangleType(this.scale*(this.translate.x+t.x*r.width),this.scale*(this.translate.y+t.y*r.height),this.scale*t.width*r.width,this.scale*t.height*r.height)},wl),vl;function wl(e){var t=vl.call(this,e)||this;return t.gridSteps=4,t.minGridSize=4,t.gridImage=mxClientType.IS_SVG?"data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=":BillTrackerConstant.IMAGE_PATH+"/grid.gif",t.gridColor="#e0e0e0",t}var BillNodeShape=(Il=mxRectangleShapeType,__extends(Jl,Il),Jl.prototype.init=function(e){Il.prototype.init.call(this,e),this.fill="none",this.stroke="#000000"},Jl),Il;function Jl(e,t,r,o){return e=e||new mxRectangleType(0,0,0,0),t=t||"none",r=r||"#000000",o=o||undefined,Il.call(this,e,t,r,o)||this}var BillAssociationLine=(Ql=mxLineType,__extends(Rl,Ql),Rl),Ql;function Rl(e,t,r){return Ql.call(this,e,t,r)||this}var Events=(Vl.RESET_GRAPH_VIEW="resetGraphView",Vl.CLICK_FIRST_SUMMARY="clickFirstSummary",Vl.BILL_CELLS_ADDED_AND_MOVED="billCellsAddedAndMoved",Vl);function Vl(){}var BillCell=(Wl=mxCellType,__extends(Xl,Wl),Xl.prototype.getCaption=function(){var e=new commonApi.BillTrackingSettings;return this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings),this.billDataInfo.caption||e.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary},Xl.prototype.buildHtmlTooltip=function(){return"            <span>"+this.billDataInfo.dataId+"</span>        "},Xl.prototype.buildHtmlLabel=function(e){return this.buildHtmlLabelByDOM(e)},Xl.prototype.buildHtmlLabelByDOM=function(c){var p=this,e=c.view.scale,t=(c.view.getState(this),this.geometry.width),r=this.geometry.height,o=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings);var n,i,a=this.billDataInfo.caption||o.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary,l=this.entry,s=document.createElement("div");if(s.classList.add("bif-cell-node"),s.style.width=t+"px",s.style.height=r+"px",l&&(n=document.createElement("div"),s.appendChild(n),n.classList.add("bif-cell-node-current"),i=document.createElement("span"),n.appendChild(i),i.classList.add("bif-cell-node-current-text"),i.innerHTML=c&&c.localePipe&&c.localePipe.transform("currentNode")||"当前"),e<this.THUMB_SCALE){var d=document.createElement("div");s.appendChild(d),d.classList.add("bif-cell-node-title-only");var u=document.createElement("div");d.appendChild(u),u.classList.add("bif-cell-node-title-only-text"),u.innerHTML=a;var m=this.billInfo.jointQueryMode,h=JSON.parse(this.billInfo.jointQueryParameters);(m==commonApi.JointQueryMode.APP&&h.funcId||m==commonApi.JointQueryMode.URL&&h.url)&&(u.classList.add("bif-cell-node-title-link"),mxEventType.addListener(u,"click",function(){return c.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",p)),event.stopPropagation(),!1}))}else{var y=document.createElement("div");s.appendChild(y),y.classList.add("bif-cell-node-main");var f=document.createElement("div");y.appendChild(f),f.classList.add("bif-cell-node-title");var g=document.createElement("div");f.appendChild(g),g.classList.add("bif-cell-node-title-text"),g.innerHTML=a;var x=document.createElement("div");y.appendChild(x),x.classList.add("bif-cell-node-summary-list"),x.style.minHeight=r-46+"px";try{var v=commonApi$1.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);v&&v.forEach(function(e,t){var r=document.createElement("div");x.appendChild(r),r.classList.add("bif-cell-node-summary");var o=document.createElement("div");r.appendChild(o),o.classList.add("bif-cell-node-summary-caption");var n=document.createElement("div");o.appendChild(n),n.classList.add("bif-cell-node-summary-caption-text"),n.title=e.name,n.innerHTML=e.name;var i=document.createElement("div");r.appendChild(i),i.classList.add("bif-cell-node-summary-value");var a,l,s=document.createElement("div");i.appendChild(s),s.classList.add("bif-cell-node-summary-value-text"),s.title=e.value,s.innerText=e.value,0==t&&(a=p.billInfo.jointQueryMode,l=JSON.parse(p.billInfo.jointQueryParameters),(a==commonApi.JointQueryMode.APP&&l.funcId||a==commonApi.JointQueryMode.URL&&l.url)&&(s.classList.add("bif-cell-node-title-link","bif-cell-node-title-link-color"),mxEventType.addListener(s,"click",function(){return c.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",p)),event.stopPropagation(),!1})))})}catch(b){console.error(b)}}return s},Xl.prototype.buildHtmlLabelByTemplateText=function(e){var t=e.view.getState(this),r=t&&t.width?t.width:this.geometry.width,o=t&&t.height?t.height:this.geometry.height,n=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&n.LoadFromJson(this.billInfo.billTrackingSettings);var i=this.billDataInfo.caption||n.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary,a=this.entry?"rgba(86,160,255,0.08)":"#FFFFFF",l="";try{var s=commonApi$1.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);s&&s.forEach(function(e,t){var r=0==t?"<a href='javascript:void(0);'>"+e.value+"</a>":e.value;l+='                        <div class="bif-cell-node-summary">                            <div class="bif-cell-node-summary-caption">                                <div class="bif-cell-node-summary-caption-text" title="'+e.name+'">'+e.name+'</div>                            </div>                            <div class="bif-cell-node-summary-value">                                <div class="bif-cell-node-summary-value-text" title="'+e.value+'">'+r+"</div>                            </div>                        </div>                    "})}catch(c){console.error(c)}return'            <div class="bif-cell-node" style="width:'+r+'px;">                <div class="bif-cell-node-main" style="background: '+a+';">                    <div class="bif-cell-node-title">                        <div class="bif-cell-node-title-text">'+i+'</div>                    </div>                    <div class="bif-cell-node-summary-list" style="min-height: '+(o-30)+'px;">                        '+l+"                    </div>                </div>            </div>        "},Xl),Wl;function Xl(e,t,r,o,n){var i=Wl.call(this,null,o,n)||this;i.THUMB_SCALE=.6,i.billDataInfo=e,i.billInfo=t;var a=new commonApi.BillTrackingSettings;return t&&t.billTrackingSettings&&a.LoadFromJson(t.billTrackingSettings),i.entry=r,i}var Base64=(an.encode=function(e,t){var r,o,n,i,a,l,s,c="",p=0;for((t=null!=t&&t)||(e=an._utf8_encode(e));p<e.length;)i=(r=e.charCodeAt(p++))>>2,a=(3&r)<<4|(o=e.charCodeAt(p++))>>4,l=(15&o)<<2|(n=e.charCodeAt(p++))>>6,s=63&n,isNaN(o)?l=s=64:isNaN(n)&&(s=64),c=c+an._keyStr.charAt(i)+an._keyStr.charAt(a)+an._keyStr.charAt(l)+an._keyStr.charAt(s);return c},an._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t+=String.fromCharCode(o):(127<o&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t},an.decode=function(e,t){t=null!=t&&t;var r,o,n,i,a,l,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=this._keyStr.indexOf(e.charAt(c++))<<2|(i=this._keyStr.indexOf(e.charAt(c++)))>>4,o=(15&i)<<4|(a=this._keyStr.indexOf(e.charAt(c++)))>>2,n=(3&a)<<6|(l=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(r),64!=a&&(s+=String.fromCharCode(o)),64!=l&&(s+=String.fromCharCode(n));return t||(s=an._utf8_decode(s)),s},an._utf8_decode=function(e){for(var t="",r=0,o=0,n=0,i=0;r<e.length;)(o=e.charCodeAt(r))<128?(t+=String.fromCharCode(o),r++):191<o&&o<224?(n=e.charCodeAt(r+1),t+=String.fromCharCode((31&o)<<6|63&n),r+=2):(n=e.charCodeAt(r+1),i=e.charCodeAt(r+2),t+=String.fromCharCode((15&o)<<12|(63&n)<<6|63&i),r+=3);return t},an._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",an);function an(){}var VertexHandler=(In=mxVertexHandlerType,__extends(Jn,In),Jn.prototype.getSelectionBounds=function(e){return In.prototype.getSelectionBounds.call(this,e)},Jn.prototype.redrawHandles=function(){In.prototype.redrawHandles.call(this),null!=this.sizers&&7<this.sizers.length&&(this.sizers[1].node.style.display="none",this.sizers[3].node.style.display="none",this.sizers[4].node.style.display="none",this.sizers[6].node.style.display="none")},Jn.prototype.createSelectionShape=function(e){if(this.state.cell instanceof BillCell){var t=new mxRectangleShapeType(mxRectangleType.fromRectangle(e),null,this.getSelectionColor());return t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t.isRounded=!0,t.style=t.style||[],t.style[mxConstantsType.STYLE_ARCSIZE]=4*this.state.view.scale,t}return In.prototype.createSelectionShape.call(this,e)},Jn),In;function Jn(e){return In.call(this,e)||this}var Styles=(On.STYLE_BILL_NODE_NAME="billNode",On.STYLE_BILL_NODE_ENTRY_NAME="billNodeEntry",On.STYLE_BILL_ASSOCIATION_NAME="billAssociation",On);function On(){}mxCellRendererType.registerShape("billNodeShape",BillNodeShape),mxCellRendererType.registerShape("billAssociationLine",BillAssociationLine);var Graph=(Pn=mxGraphType,__extends(Qn,Pn),Qn.prototype.createGraphView=function(){return new GraphView(this)},Qn.prototype.createVertexHandler=function(e){return new VertexHandler(e)},Qn.prototype.getPagePadding=function(){return new mxPointType(Math.max(0,Math.round(this.container.offsetWidth-34)),Math.max(0,Math.round(this.container.offsetHeight-34)))},Qn.prototype.getPageSize=function(){return this.pageVisible?new mxRectangleType(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.getScrollTileSize()},Qn.prototype.getPageLayout=function(){var e=this.pageVisible?this.getPageSize():this.getScrollTileSize(),t=this.getGraphBounds();if(0==t.width||0==t.height)return new mxRectangleType(0,0,1,1);var r=Math.ceil(t.x/this.view.scale-this.view.translate.x),o=Math.ceil(t.y/this.view.scale-this.view.translate.y),n=Math.floor(t.width/this.view.scale),i=Math.floor(t.height/this.view.scale),a=Math.floor(r/e.width),l=Math.floor(o/e.height),s=Math.ceil((r+n)/e.width)-a,c=Math.ceil((o+i)/e.height)-l;return new mxRectangleType(a,l,s,c)},Qn.prototype.getScrollTileSize=function(){return null==this.scrollTileSize&&(this.scrollTileSize=new mxRectangleType(0,0,400,600)),this.scrollTileSize},Qn.prototype.getPreferredPageSize=function(e,t,r){var o=this.getPageLayout(),n=this.getPageSize();return new mxRectangleType(0,0,o.width*n.width,o.height*n.height)},Qn.prototype.sizeDidChange=function(){if(null!=this.container&&mxUtilsType.hasScrollbars(this.container)){var e=this.getPageLayout(),t=this.getPagePadding(),r=this.getPageSize(),o=Math.ceil(2*t.x/this.view.scale+e.width*r.width),n=Math.ceil(2*t.y/this.view.scale+e.height*r.height),i=this.minimumGraphSize;null!=i&&i.width==o&&i.height==n||(this.minimumGraphSize=new mxRectangleType(0,0,o,n));var a=t.x/this.view.scale-e.x*r.width,l=t.y/this.view.scale-e.y*r.height;if(!this.autoTranslate&&(this.view.translate.x!=a||this.view.translate.y!=l)){this.autoTranslate=!0,this.view.x0=e.x,this.view.y0=e.y;var s=this.view.translate.x,c=this.view.translate.y;return this.view.setTranslate(a,l),this.container.scrollLeft+=(a-s)*this.view.scale,this.container.scrollTop+=(l-c)*this.view.scale,void(this.autoTranslate=!1)}Pn.prototype.sizeDidChange.call(this)}},Qn.prototype.resetGraphView=function(){var e=this.getGraphBounds(),t=0;this.gridOptions.showEntryData&&(t="string"==typeof this.gridOptions.defaultHeight?0:this.gridOptions.defaultHeight);var r=Math.min(this.container.clientWidth/e.width,(this.container.clientHeight-t-20)/e.height);r=(r=1<=r?1:r)<=.6?.6:r,this.zoomTo(r,!0),e=this.getGraphBounds(),Math.max(e.width,this.scrollTileSize.width*this.view.scale),Math.max(e.height,this.scrollTileSize.height*this.view.scale),this.container.scrollTop=Math.floor(Math.max(0,e.y-(this.container.clientHeight-e.height)/2+79)),this.container.scrollLeft=Math.floor(Math.max(0,e.x-(this.container.clientWidth-e.width)/2))},Qn.prototype.insertBillCell=function(e,t,r,o,n,i,a,l,s,c,p){var d=this.createBillCell(e,t,r,o,n,i,a,l,s,c,p);return this.addCell(d,e)},Qn.prototype.createBillCell=function(e,t,r,o,n,i,a,l,s,c,p){var d=new mxGeometryType(i,a,l,s);d.relative=null!=p&&p;var u=new BillCell(r,o,n,d,c);return u.setId(t),u.setVertex(!0),u.setConnectable(!0),u},Qn.prototype.getTooltipForCell=function(e){return e instanceof BillCell?e.buildHtmlTooltip():Pn.prototype.getTooltipForCell.call(this,e)},Qn.prototype.getLabel=function(e){return Pn.prototype.getLabel.call(this,e)},Qn.prototype.convertValueToString=function(e){return e instanceof BillCell?e.buildHtmlLabel(this):Pn.prototype.convertValueToString.call(this,e)},Qn.prototype.defineInnerStylesNewBTS=function(){var e=Object.assign({},this.getStylesheet().getDefaultVertexStyle());e[mxConstantsType.STYLE_FILLCOLOR]="none",e[mxConstantsType.STYLE_STROKE_OPACITY]="0",e[mxConstantsType.STYLE_STROKEWIDTH]="1",e[mxConstantsType.STYLE_FONTCOLOR]="black",e[mxConstantsType.STYLE_FONTSIZE]="12",e[mxConstantsType.STYLE_FONTSTYLE]="1",e[mxConstantsType.STYLE_ROUNDED]="1",e[mxConstantsType.STYLE_SPACING]=8,e[mxConstantsType.STYLE_WHITE_SPACE]="wrap",e[mxConstantsType.STYLE_IMAGE_ASPECT]="0",e[mxConstantsType.STYLE_PERIMETER]=mxPerimeterType.RectanglePerimeter,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,e),e=Object.assign({},e),this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,e),(e=Object.assign({},this.getStylesheet().getDefaultEdgeStyle()))[mxConstantsType.STYLE_SHAPE]=mxConstantsType.SHAPE_CONNECTOR,e[mxConstantsType.STYLE_STROKECOLOR]="#2A87FF",e[mxConstantsType.STYLE_ENDARROW]=mxConstantsType.ARROW_CLASSIC,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_EDGE]=mxConstantsType.EDGESTYLE_ELBOW,e[mxConstantsType.STYLE_ELBOW]=mxConstantsType.ELBOW_HORIZONTAL,e[mxConstantsType.STYLE_STROKEWIDTH]=1.8,e[mxConstantsType.STYLE_DASHED]=1,e[mxConstantsType.STYLE_OPACITY]=80,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,e)},Qn.createSvgImage=function(e,t,r){var o=unescape(encodeURIComponent('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e+'px" height="'+t+'px" version="1.1">'+r+"</svg>"));return new mxImageType("data:image/svg+xml;base64,"+(window.btoa?btoa(o):Base64.encode(o,!0)),e,t)},Qn.handleFill="#29b6f2",Qn),Pn;function Qn(e,t,r,o){var n=Pn.call(this,e,t,r,o)||this;return n.background="#ffffff",n.autoScroll=!1,n.autoExtend=!0,n.setCellsResizable(!1),n.setCellsEditable(!1),n.setTooltips(!1),n.setHtmlLabels(!0),n.setVertexLabelsMovable(!1),n.setAllowDanglingEdges(!1),n.defineInnerStylesNewBTS(),n.setPanning(!0),n.panningHandler.useLeftButtonForPanning=!0,n.container.style.cursor="grab",n.scrollTileSize=new mxRectangleType(0,0,400,400),n.addListener(Events.RESET_GRAPH_VIEW,n.resetGraphView),n}var CompactTreeLayout=(fp=mxCompactTreeLayoutType,__extends(gp,fp),gp.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e,o=this.createNode(e);var n=this.graph.getModel(),i=null,a=this.graph.getEdges(e,t,this.invert,!this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortOutgoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p,d,u=a[s];this.isEdgeIgnored(u)||(this.resetEdges&&this.setEdgePoints(u,null),this.edgeRouting&&(this.setEdgeStyleEnabled(u,!1),this.setEdgePoints(u,null)),p=null!=(c=l.getState(u))?c.getVisibleTerminal(this.invert):l.getVisibleTerminal(u,this.invert),null!=(d=this.dfs(p,t))&&null!=n.getGeometry(p)&&(null==i?o.child=d:i.next=d,i=d))}}return o},gp.prototype.sortIngoingEdges=function(a,e){var l=new mxDictionaryType;e.sort(function(e,t){var r=e.getTerminal(e.getTerminal(!0)==a),o=l.get(r);null==o&&(o=mxCellPathType.create(r).split(mxCellPathType.PATH_SEPARATOR),l.put(r,o));var n=t.getTerminal(t.getTerminal(!0)==a),i=l.get(n);return null==i&&(i=mxCellPathType.create(n).split(mxCellPathType.PATH_SEPARATOR),l.put(n,i)),mxCellPathType.compare(o,i)})},gp.prototype.execute=function(e,t){this.parent=e;var r,o,n,i,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),this.invert,!this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,this.invert);if(0<p.length)for(var d=0;d<p.length;d++)if(!this.isVertexIgnored(p[d])&&0<this.graph.getEdges(p[d],null,this.invert,!this.invert,!1).length){this.root=p[d];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(n=this.getVertexBounds(this.root))&&(r=n.x,o=n.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,r,o):this.verticalLayout(this.node,null,r,o))&&((a=i=0)<s.x&&(i=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==i&&0==a||this.moveNode(this.node,i,a),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(this.node)),null!=this.parentX&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l)))}finally{c.endUpdate()}}},gp.prototype.horizontalLayout=function(e,t,r,o){e.x+=t+e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var n=e.child;if(null!=n){o=this.horizontalLayout(n,e.x,e.y,o);for(var i=e.y+n.offsetY,a=n.next;null!=a;)o=this.horizontalLayout(a,e.x+n.offsetX,i,o),i+=a.offsetY,a=a.next}return o},gp),fp;function gp(e,t,r){var o=fp.call(this,e,t,r)||this;return o.useBoundingBox=!1,o}var RevertCompactTreeLayout=($p=mxCompactTreeLayoutType,__extends(_p,$p),_p.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e,o=this.createNode(e);var n=this.graph.getModel(),i=null,a=this.graph.getEdges(e,t,!this.invert,this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortIngoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p,d,u=a[s];this.isEdgeIgnored(u)||(this.resetEdges&&this.setEdgePoints(u,null),this.edgeRouting&&(this.setEdgeStyleEnabled(u,!1),this.setEdgePoints(u,null)),p=null!=(c=l.getState(u))?c.getVisibleTerminal(!this.invert):l.getVisibleTerminal(u,!this.invert),null!=(d=this.dfs(p,t))&&null!=n.getGeometry(p)&&(null==i?o.child=d:i.next=d,i=d))}}return o},_p.prototype.sortIngoingEdges=function(a,e){var l=new mxDictionaryType;e.sort(function(e,t){var r=e.getTerminal(e.getTerminal(!0)==a),o=l.get(r);null==o&&(o=mxCellPathType.create(r).split(mxCellPathType.PATH_SEPARATOR),l.put(r,o));var n=t.getTerminal(t.getTerminal(!0)==a),i=l.get(n);return null==i&&(i=mxCellPathType.create(n).split(mxCellPathType.PATH_SEPARATOR),l.put(n,i)),mxCellPathType.compare(o,i)})},_p.prototype.execute=function(e,t){this.parent=e;var r,o,n,i,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),!this.invert,this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,!0);if(0<p.length)for(var d=0;d<p.length;d++)if(!this.isVertexIgnored(p[d])&&0<this.graph.getEdges(p[d],null,!this.invert,this.invert,!1).length){this.root=p[d];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(n=this.getVertexBounds(this.root))&&(r=n.x,o=n.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,-r,o):this.verticalLayout(this.node,null,r,o))&&((a=i=0)<s.x&&(i=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==i&&0==a||this.moveNode(this.node,i,a),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(this.node)),null!=this.parentX&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l)))}finally{c.endUpdate()}}},_p.prototype.horizontalLayout=function(e,t,r,o){e.x+=t-e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var n=e.child;if(null!=n){o=this.horizontalLayout(n,e.x,e.y,o);for(var i=e.y+n.offsetY,a=n.next;null!=a;)o=this.horizontalLayout(a,e.x-n.offsetX,i,o),i+=a.offsetY,a=a.next}return o},_p),$p;function _p(e,t,r){var o=$p.call(this,e,t,r)||this;return o.useBoundingBox=!1,o}var CellOverlayState={Search:"Search",Fold:"Fold"},CellOverlay=(Tq=mxCellOverlayType,__extends(Uq,Tq),Uq),Tq;function Uq(e,t,r,o,n,i,a){var l=Tq.call(this,e,t,r,o,n,i)||this;return l.state=a||CellOverlayState.Search,l}var Outline=(br=mxOutlineType,__extends(cr,br),cr.prototype.createGraph=function(e){var t=new mxGraphType(e,this.source.getModel(),this.graphRenderHint);return t.foldingEnabled=!1,t.autoScroll=!1,this.extendStyleSheets(t,this.source),t},cr.prototype.extendStyleSheets=function(e,t){var r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_NAME,t.getStylesheet().getDefaultVertexStyle()));r[mxConstantsType.STYLE_FILLCOLOR]="#2A87FF",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,r),(r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,t.getStylesheet().getDefaultVertexStyle())))[mxConstantsType.STYLE_FILLCOLOR]="#F5A144",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,r),r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,t.getStylesheet().getDefaultEdgeStyle())),e.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,r)},cr),br;function cr(e,t){return br.call(this,e,t)||this}var BillTrackerDataService=(kr.prototype.getJointQueryParameters=function(e){var t=e.ConvertToJson(),r=this.httpService.setHeader({body:t});return this.httpService.request(this.jointQueryParserMethod,this.jointQueryParserUrl,r).pipe(operators.switchMap(function(e){var t=commonApi$1.BpmnModelJsonHelper.FromJson(e.value,JointQueryParameterResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},kr.prototype.canTracking=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.canTrackingMethod,this.canTrackingUrl,t).pipe(operators.switchMap(function(e){var t=new CanTrackingResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},kr.prototype.getDownBillsInfo=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getDownBillsInfoMethod,this.getDownBillsInfoUrl,t).pipe(operators.switchMap(function(e){var t=commonApi$1.BpmnModelJsonHelper.FromJson(e,DownBillInfoResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},kr.prototype.getUpBillsInfo=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getUpBillsInfoMethod,this.getUpBillsInfoUrl,t).pipe(operators.switchMap(function(e){var t=commonApi$1.BpmnModelJsonHelper.FromJson(e,UpBillInfoResult);return rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},kr.prototype.getEntityData=function(e){var t=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getEntityDataMethod,this.getEntityDataUrl,t).pipe(operators.switchMap(function(e){var t=new EntityDataResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},kr.prototype.buildEntryBillInfo=function(e){var t=new DownBillInfoResult;t.schemaId=e.schemaId,t.suCode=e.suCode,t.voName=e.voName,t.billTrackingSettings=e.billTrackingSettings,t.bizKind=e.bizKind,t.bizType=e.bizType,t.jointQueryMode=e.jointQueryMode,t.jointQueryParameters=e.jointQueryParameters,t.trackingSourceType=e.trackingSourceType;var r=new BillDataInfo;return r.caption=e.caption,r.dataId=e.dataId,r.summary=e.summary,r.trackingMappingAssociations=[],r.billChildInfos=e.billChildInfos,r.curYear=e.curYear,t.billDataInfos=[r],t.documentTypeId=e.documentTypeId,t},kr.prototype.buildGetBillsInfoArgs=function(e){var t=new GetBillsInfoArgs;return t.billDataId=e.billDataInfo.dataId,t.documentTypeId=e.billInfo.documentTypeId,t.bizKind=e.billInfo.bizKind,t.bizType=e.billInfo.bizType,t.billChildInfos=e.billDataInfo.billChildInfos,t.curYear=e.billDataInfo.curYear,t},kr.prototype.buildGetUpBillsInfoArgs=function(e){var t=new GetUpBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},kr.prototype.buildGetDownBillsInfoArgs=function(e){var t=new GetDownBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},kr.prototype.buildGetMainEntityDataArgs=function(e,t){var r=new GetMainEntityDataArgs;return r.dataId=t.dataId,r.suCode=e.suCode,r.schemaId=e.schemaId,r.trackingSourceType=e.trackingSourceType,r.billChildInfos=t.billChildInfos,r.curYear=t.curYear,r.documentTypeId=e.documentTypeId,r},kr.prototype.hasDynamicParams=function(e){return!!e.params&&!!Array.isArray(e.params)&&null!=e.params.find(function(e){return e.type!=commonApi.JointQueryParameterType.Constant})},kr.prototype.buildGetJointQueryParametersArgs=function(e,t,r){var o=new GetJointQueryParametersArgs;return o.dataId=r.dataId,o.suCode=t.suCode,o.schemaId=t.schemaId,o.trackingSourceType=t.trackingSourceType,o.curYear=r.curYear,o.contents=[],Array.isArray(e.params)&&e.params.forEach(function(e){var t,r;e.type!=commonApi.JointQueryParameterType.Constant&&(t=new JointQueryParametersContent,e.type==commonApi.JointQueryParameterType.Field?(t.jointQueryParameterMode=JointQueryParameterMode.FIELD,(r=new FieldJointQueryParameterContent).parameterCode=e.code,r.fieldContent=e.value,t.content=r.ConvertToJson()):e.type==commonApi.JointQueryParameterType.Expression&&(t.jointQueryParameterMode=JointQueryParameterMode.EXPRESSION,(r=new ExpressionJointQueryParameterContent).parameterCode=e.code,r.expressionContent=e.value,t.content=r.ConvertToJson()),o.contents.push(t))}),o},kr.decorators=[{type:core$1.Injectable}],kr.ctorParameters=function(){return[{type:cafCommon.HttpService},{type:http.HttpClient}]},kr);function kr(e,t){this.httpService=e,this.httpClient=t,this.baseUrl="/api/runtime/aif/v1.0/billtracking",this.canTrackingUrl=this.baseUrl+"/cantracking",this.canTrackingMethod="POST",this.getDownBillsInfoUrl=this.baseUrl+"/getdownbillsinfo",this.getDownBillsInfoMethod="POST",this.getUpBillsInfoUrl=this.baseUrl+"/getupbillsinfo",this.getUpBillsInfoMethod="POST",this.getEntityDataUrl=this.baseUrl+"/getentitydata",this.getEntityDataMethod="POST",this.jointQueryParserUrl="/api/runtime/aif/v1.0/jointquery",this.jointQueryParserMethod="POST"}var BillTrackerDataInfoService=(rs.prototype.isNewBTS=function(e){var t;return"string"==typeof e&&((t=new commonApi.BillTrackingSettings).LoadFromJson(e),e=t),null!=e&&"1.0"===e.version},rs.prototype.extractDataRows=function(e,n,i,a){var t,r,l=this,s=[];try{for(var o=__values(e),c=o.next();!c.done;c=o.next())!function(t){var r={};r[a]=t.dataId;var o=[];n.forEach(function(e){e.dataType==commonApi$1.DataType.Decimal?o.push(e):r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),i)}),o.forEach(function(e){r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),i)}),s.push(r)}(c.value)}catch(p){t={error:p}}finally{try{c&&!c.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}return s},rs.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},rs.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},rs.prototype.extractFFields=function(e,n,i){var a=this,l=[];return e.forEach(function(e){var t,r,o;e.show=!0,"Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?(t=a.extractFieldPath(e),o=null,i&&null==(o=n.find(function(e){return e.fieldPath==t}))&&(e.show=!1),e=a.setExtendProps(e,o,t+".Name"),l.push(e)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?l.push.apply(l,__spread(a.extractFFields(e.GetSubFieldList(),n,i))):(r=a.extractFieldPath(e),o=null,i&&null==(o=n.find(function(e){return e.fieldPath==r}))&&(e.show=!1),e=a.setExtendProps(e,o,r),l.push(e))}),l},rs.prototype.hasChildData=function(e,t){var r,o,n=!1,i=this.getBillTrackerSchema(t),a=e.GetChildTableList();try{for(var l=__values(a),s=l.next();!s.done;s=l.next()){var c=s.value,p=!1,d=!1,u=i&&i[c.tableName],p=null==u||null==u.show||u.show;if(c.GetRowList()&&0<c.GetRowList().length&&(d=!0),1==(n=p&&d))break}}catch(m){r={error:m}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return n},rs.prototype.getFieldValue=function(e,t,r){for(var o=e.fieldPath?e.fieldPath.split("."):[e.fieldName],n=o&&t[o[0]],i=1;null!=n&&i<o.length;i++){var a=n.GetSubFieldMap();if(null==a)break;n=a[o[i]]}var l=n?n.GetTextValue():"";if(null==l)return null;if(e.dataType==commonApi$1.DataType.String){if(null==e.formatInfo)return(e.fieldValue=l)||"";var s=e.formatInfo.stringMapFormatter;if(null==s)return(e.fieldValue=l)||"";var c=s[l]||l;return e.fieldValue=c}if(e.dataType==commonApi$1.DataType.Decimal){var p,d,u=e.scale;return null!=e.formatInfo&&(null!=e.formatInfo.scale&&(u=e.formatInfo.scale),e.formatInfo.enableScaleExpression&&null!=e.formatInfo.scaleExpression&&(null==(d=(p=this.getFieldInFields(r,e.formatInfo.scaleExpression))&&parseInt(String(this.getFieldValue(p,t))))||isNaN(d)||(u=d))),e.fieldValue=parseFloat(String(l)),parseFloat(String(l)).toFixed(u).toString()||""}if(e.dataType==commonApi$1.DataType.Boolean)return""==l?(e.fieldValue=null,l):(e.fieldValue=JSON.parse(l),JSON.parse(l));if(e.dataType!=commonApi$1.DataType.DateTime)return(e.fieldValue=l)||"";var m=commonApi$1.BpmnModelJsonHelper.DateTimeFromString(l),h=e.formatInfo&&e.formatInfo.dateFormatter||"yyyy-MM-dd";return e.fieldValue=m,this.dateFormat(m,h)},rs.prototype.getFieldInFields=function(e,t){var r,o,n=null;try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){for(var l=a.value,s=l,c=l;c.attachedField;)c=c.attachedField;if(s.fullPath=commonApi.fullPathPrefix+c.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){n=s;break}var p=s.GetSubFieldList();if(p&&0<p.length&&null!=(n=this.getFieldInFields(p,t)))break}}catch(d){r={error:d}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},rs.prototype.getFieldValueInFieldsWithValue=function(e,t){var r,o,n=null;try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){for(var l=a.value;l.attachedField;)l=l.attachedField;var s=l;if(s.fullPath=commonApi.fullPathPrefix+s.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){n=s.fieldValue;break}}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},rs.prototype.getBasicInfoFieldsWithValue=function(e,t,r,o){var n=this;void 0===o&&(o=!0);var i=[],a=new commonApi.BillTrackingSettings;e&&e.billTrackingSettings&&a.LoadFromJson(e.billTrackingSettings);var l=this.getBillTrackerSchema(e),s=(s=l&&l[t.tableName]&&l[t.tableName].fields)||[],c=a.billTrackingDataShownMode===commonApi.BillTrackingDataShownMode.CUSTOMFIELD,p=t.getFieldList(),d=r.GetRowList()[0].GetFieldMap(),u=this.extractFFields(p,s,c),m=[];return u.forEach(function(e){e.dataType==commonApi$1.DataType.Decimal?m.push(e):e.fieldValue=n.getFieldValue(e,d)}),m.forEach(function(e){e.fieldValue=n.getFieldValue(e,d,p)}),i.push.apply(i,__spread(u)),i},rs.prototype.setExtendProps=function(e,t,r,o){return e.captionPath=this.extractCaptionPath(e),e.fieldPath=r,t&&(e.displayName=t.displayName,e.i18nCols=t.i18nCols,e.formatInfo=t.formatInfo,e.order=t.order),o&&(e.fieldValue=this.getFieldValue(e,o)),e},rs.prototype.sortFieldsByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},rs.prototype.dateFormat=function(e,t){var r,o={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(var n in o)(r=new RegExp("("+n+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?o[n]:o[n].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?o[n]:this.myPadStart(o[n],r[1].length,"0")));return t},rs.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},rs.prototype.getFieldLabel=function(e,t){return t&&e.i18nCols&&e.i18nCols.colI18nValues.displayName&&e.i18nCols.colI18nValues.displayName[t]||e.displayName||e.captionPath||e.caption},rs.prototype.getTableLabel=function(e,t,r){var o=this.getBillTrackerSchema(e),n=o&&o[t.tableName];if(null==n)return t.caption;var i=n.i18nCols;return r&&i&&i.colI18nValues.displayName&&i.colI18nValues.displayName[r]||n.displayName||n.caption||n.code},rs.prototype.getChildTables=function(e,t){var r=[],o=this.getBillTrackerSchema(e),n=t.GetChildTableList();return n&&n.forEach(function(e){var t=o&&o[e.tableName];null!=t&&null!=t.show?1==t.show&&(e.order=t.order,r.push(e)):r.push(e)}),r=this.sortTablesByOrder(r)},rs.prototype.sortTablesByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},rs.prototype.getBillTrackerSchema=function(e){var t=new commonApi.BillTrackingSettings;e&&e.billTrackingSettings&&t.LoadFromJson(e.billTrackingSettings);var r=t.customFieldContent,o=r&&("object"==typeof r?r:JSON.parse(r));return o&&o.schema},rs.decorators=[{type:core$1.Injectable}],rs);function rs(){}var BILL_TRACKER_LANG_RESOURCES={"zh-CHS":{billTracker:"单据追踪",noAssoBill:"没有关联的业务单据",modalOptionsCantBeEmpty:"模态框配置不可为空",downSearch:"下查",upSearch:"上查",folder:"折叠",caption:"标题",summary:"摘要",basicInfo:"基本信息",lineNumber:"序号",childData:"明细",selectOneFirst:"请先选择一条数据",noChildData:"没有明细数据",zoomIn:"放大（Ctrl+滚轮）",zoomOut:"缩小（Ctrl+滚轮）",zoomReset:"还原",print:"打印",expandUp:"向上展开",expandUpAll:"向上展开全部",expandDown:"向下展开",expandDownAll:"向下展开全部",loading:"正在加载",yes:"是",no:"否",currentNode:"当前"},en:{billTracker:"Bill Tracker",noAssoBill:"There is no associated business bill.",modalOptionsCantBeEmpty:"Modal options cant be empty",downSearch:"Down search",upSearch:"Up search",folder:"Folder",caption:"Caption",summary:"Summary",basicInfo:"Basic Information",lineNumber:"No",childData:"Detail",selectOneFirst:"Please select an item at first",noChildData:"No detail data",zoomIn:"Zoom In(Ctrl+MouseWheel)",zoomOut:"Zoom Out(Ctrl+MouseWheel)",zoomReset:"Zoom Reset",print:"Print",expandUp:"Expand Upward",expandUpAll:"Expand All Upward",expandDown:"Expand Downward",expandDownAll:"Expand All Downward",loading:"Loading...",yes:"Yes",no:"No",currentNode:"Entry"},"zh-CHT":{billTracker:"單據追蹤",noAssoBill:"沒有關聯的業務單據",modalOptionsCantBeEmpty:"模態框配置不可為空",downSearch:"下查",upSearch:"上查",folder:"折疊",caption:"標題",summary:"摘要",basicInfo:"基本信息",lineNumber:"序號",childData:"明細",selectOneFirst:"請先選擇壹條數據",noChildData:"沒有明細數據",zoomIn:"放大（Ctrl+滾輪）",zoomOut:"縮小（Ctrl+滾輪）",zoomReset:"還原",print:"打印",expandUp:"向上展開",expandUpAll:"向上展開全部",expandDown:"向下展開",expandDownAll:"向下展開全部",loading:"正在加載",yes:"是",no:"否",currentNode:"當前"}},BillTrackerLocalePipe=(gv.prototype.transform=function(e){return this.lang[e]||e},gv.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerLocale"}]}],gv.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},gv);function gv(e){this.defaultLang="zh-CHS",this.langCode=e||this.defaultLang,this.lang=BILL_TRACKER_LANG_RESOURCES[this.langCode]||BILL_TRACKER_LANG_RESOURCES[this.defaultLang]}var BillTrackerInternalUiService=function(){function BillTrackerInternalUiService(e,t,r,o,n,i,a,l,s,c){this.framework=e,this.messager=t,this.loading=r,this.dataService=n,this.dataInfoService=i,this.modalService=a,this.cfr=l,this.injector=s,this.localePipe=c}return BillTrackerInternalUiService.prototype.openBillDetail=function(e,t){var r,o=this,n=e.jointQueryMode,i=JSON.parse(e.jointQueryParameters),a=t.dataId;this.dataService.hasDynamicParams(i)?(r=this.dataService.buildGetJointQueryParametersArgs(i,e,t),this.dataService.getJointQueryParameters(r).subscribe(function(e){n==commonApi.JointQueryMode.APP?o.openMenu(i,a,e):n==commonApi.JointQueryMode.URL&&o.openUrl(i,a,e)})):n==commonApi.JointQueryMode.APP?this.openMenu(i,a):n==commonApi.JointQueryMode.URL&&this.openUrl(i,a)},BillTrackerInternalUiService.prototype.openBillDetailWithFields=function(e,t,r){var o,n=this,i=t.dataId,a=e.jointQueryMode,l=JSON.parse(e.jointQueryParameters);this.dataService.hasDynamicParams(l)?(o=this.dataService.buildGetJointQueryParametersArgs(l,e,t),this.dataService.getJointQueryParameters(o).subscribe(function(e){a==commonApi.JointQueryMode.APP?n.openMenu(l,i,e):a==commonApi.JointQueryMode.URL&&n.openUrl(l,i,e)})):a==commonApi.JointQueryMode.APP?this.openMenu(l,i):a==commonApi.JointQueryMode.URL&&this.openUrl(l,i)},BillTrackerInternalUiService.prototype.openMenu=function(e,t,r){var o={};o.id=t,o.action="LoadAndView1";var n=new Map;n.set("id",t),n.set("action","LoadAndView1"),this.buildOpenMenuParams(e,n,o,r);var i=encodeURIComponent(JSON.stringify(o));n.set("WEB_FORM_ROUTE_PARAMS",i);var a={appType:rtfCommon.AppType.Menu,funcId:e.funcId,appEntrance:null,appId:null,tabId:t,entityParams:o,queryStringParams:n};this.framework.openMenu(a)},BillTrackerInternalUiService.prototype.openUrl=function(t,e,o){var n=this,i=this.appendQueryParam(t.url,"id",e);Array.isArray(t.params)?t.params.forEach(function(t){var e,r=t.value;t.type!=commonApi.JointQueryParameterType.Field&&t.type!=commonApi.JointQueryParameterType.Expression||(r=(e=o.find(function(e){return e.code==t.code}))&&e.value),i=n.appendQueryParam(i,t.code,r)}):Object.keys(t.params).forEach(function(e){i=n.appendQueryParam(i,e,t.params[e])});var r=t.params||{};r.id=e,r.url=i,r.action="LoadAndView1";var a=new Map;a.set("url",i),a.set("id",e),a.set("action","LoadAndView1"),this.buildOpenMenuParams(t,a,undefined,o);var l={appType:rtfCommon.AppType.Menu,funcId:BillTrackerConstant.BILL_VIEWER_FUNC_ID,appEntrance:null,appId:null,tabId:e,entityParams:r,queryStringParams:a};this.framework.openMenu(l)},BillTrackerInternalUiService.prototype.buildOpenMenuParams=function(t,r,o,n){void 0===o&&(o={}),Array.isArray(t.params)?t.params.forEach(function(t){var e=t.value;t.type!=commonApi.JointQueryParameterType.Field&&t.type!=commonApi.JointQueryParameterType.Expression||n&&(e=n.find(function(e){return e.code==t.code}).value),o[t.code]=e,r.set(t.code,e)}):Object.keys(t.params).forEach(function(e){o[e]=t.params[e],r.set(e,t.params[e])})},BillTrackerInternalUiService.prototype.appendQueryParam=function(url,k,v){var re1,re2,paraStr,idx;return-1<url.indexOf(k)?(re1=eval("/(\\?)("+k+"=)([^&]*)/gi"),url=url.replace(re1,"?"+k+"="+v),re2=eval("/(&)("+k+"=)([^&]*)/gi"),url=url.replace(re2,"&"+k+"="+v)):(paraStr=k+"="+v,idx=url.indexOf("?"),idx<0?url+="?":0<=idx&&idx!=url.length-1&&(url+="&"),url+=paraStr),url},BillTrackerInternalUiService.decorators=[{type:core$1.Injectable}],BillTrackerInternalUiService.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:rtfCommon.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:BillTrackerDataInfoService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector},{type:BillTrackerLocalePipe}]},BillTrackerInternalUiService}(),BillTrackerComponent=(lw.prototype.ngOnInit=function(){},lw.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.paintGraph()},0)},lw.prototype.paintGraph=function(){var r=this;this.billGraph.paint(),this.graphZoomScale=this.billGraph.getZoomScale(),this.billGraph.graph.view.addListener(mxEventType.SCALE,function(e,t){r.graphZoomScale=r.billGraph.getZoomScale()})},lw.prototype.selectHandler=function(e){if(e){var t=e.billInfo,r=e.billDataInfo;if(t==this.lastBillInfo&&r==this.lastBillDataInfo&&1==this.showData)return;var o=this.dataService.buildGetMainEntityDataArgs(t,r);this.billData.showDataGrid(o,t,r,null),this.divDataWrapperER.nativeElement.scrollTo({top:0}),this.showData=!0,this.lastBillInfo=t,this.lastBillDataInfo=r}else this.billData.clearDataRegion(),this.showData=!1},lw.prototype.stateChangeHandler=function(e){e.type==Events.CLICK_FIRST_SUMMARY&&this.openBillDetail(e.data)},lw.prototype.setModalRef=function(e){this.modalRef=e,null!=this.billGraph&&this.billGraph.setModalRef(e)},lw.prototype.resetGraphHeight=function(e){var t=this;e.host.style.top="",e.host.style.left="",this.graphContainerER.nativeElement.style.height=this.mainContainerER.nativeElement.clientHeight-e.size.height+"px",setTimeout(function(){t.billGraph.refresh()})},lw.prototype.expandDataRegion=function(){this.dataFullScreen=!0,this.divDataWrapperER.nativeElement.style.height="100%",this.divDataWrapperER.nativeElement.style.top="0"},lw.prototype.collapseDataRegion=function(){this.dataFullScreen=!1,this.dataWrapperHeight=this.defaultDataWrapperHeight,this.divDataWrapperER.nativeElement.style.height=this.dataWrapperHeight+"px",this.divDataWrapperER.nativeElement.style.top=null},lw.prototype.onRzResized=function(e){e.position.top<0&&(this.divDataWrapperER.nativeElement.style.top="0",this.divDataWrapperER.nativeElement.style.height="100%",this.dataFullScreen=!0)},lw.prototype.graphZoomIn=function(){this.billGraph.zoomIn()},lw.prototype.graphZoomOut=function(){this.billGraph.zoomOut()},lw.prototype.graphZoomActual=function(){this.billGraph.zoomActual()},lw.prototype.graphPrint=function(){this.billGraph.print()},lw.prototype.graphExpand=function(e,t){void 0===t&&(t=!1),this.billGraph.expand(e,t)},lw.prototype.graphExpandUpAll=function(){this.graphExpand(BillTrackerDirection.Up,!0)},lw.prototype.graphExpandUp=function(){this.graphExpand(BillTrackerDirection.Up,!1)},lw.prototype.graphExpandDown=function(){this.graphExpand(BillTrackerDirection.Down,!1)},lw.prototype.graphExpandDownAll=function(){this.graphExpand(BillTrackerDirection.Down,!0)},lw.prototype.openBillDetail=function(e){this.internalUiService.openBillDetail(e.billInfo,e.billDataInfo)},lw.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker",template:'<div class="g-main" style="height: 100%; background-color: #ffffff;" #mainContainer>\r\n    <div class="bill-tracker-toolbar-wrapper" *ngIf="modalRef!=null">\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUpAll()">\r\n            {{\'expandUpAll\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUp()">\r\n            {{\'expandUp\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDown()">\r\n            {{\'expandDown\'|billTrackerLocale}}\r\n        </button>\r\n        <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDownAll()">\r\n            {{\'expandDownAll\'|billTrackerLocale}}\r\n        </button>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomOut()">\r\n            <i class="f-icon f-icon-minus" title="{{\'zoomOut\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-input">\r\n            <input *ngIf="false" type="text" style="border: 0; width: 30px; text-align: right;" readonly\r\n                [(ngModel)]="graphZoomScale">\r\n            <span style="border: 0; width: 30px; text-align: right;">{{graphZoomScale}}</span>\r\n            <span>%</span>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomIn()">\r\n            <i class="f-icon f-icon-add" title="{{\'zoomIn\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphZoomActual()">\r\n            <i class="f-icon f-icon-reset" title="{{\'zoomReset\' | billTrackerLocale}}"></i>\r\n        </div>\r\n        <div class="bill-tracker-toolbar-icon" (click)="graphPrint()" *ngIf="false">\r\n            <i class="f-icon f-icon-print" title="{{\'print\' | billTrackerLocale}}"></i>\r\n        </div>\r\n    </div>\r\n    <div class="bill-tracker-graph-wrapper" #graphContainer>\r\n        <lib-bill-tracker-graph #billGraph [billTrackerArgs]="billTrackerArgs" (select)="selectHandler($event)"\r\n            (stateChange)="stateChangeHandler($event)">\r\n        </lib-bill-tracker-graph>\r\n    </div>\r\n</div>\r\n\x3c!-- todo: 分割条暂未加最大高度限制 --\x3e\r\n<div #divDataWrapper class="bill-tracker-data-wrapper" [style.height]="dataWrapperHeight + \'px\'"\r\n    [style.display]="showData ? null : \'none\'" ngResizable rzAspectRatio="false" [rzHandles]="\'n\'" [rzMinHeight]="40"\r\n    (rzStop)="onRzResized($event)">\r\n    <div class="bill-tracker-divider-wrapper">\r\n        <div class="bill-tracker-divider bill-tracker-divider-transparent bill-tracker-divider-img">\r\n        </div>\r\n    </div>\r\n    <div class="bill-tracker-fold-wrapper">\r\n        <div class="bill-tracker-fold-icon">\r\n            <i class="f-icon f-icon-arrow-seek-up" *ngIf="dataFullScreen==false" (click)="expandDataRegion()"></i>\r\n            <i class="f-icon f-icon-arrow-seek-down" *ngIf="dataFullScreen==true" (click)="collapseDataRegion()"></i>\r\n        </div>\r\n    </div>\r\n    <div #divDataTable class="bill-tracker-data-table-wrapper">\r\n        <lib-bill-tracker-data #billData></lib-bill-tracker-data>\r\n    </div>\r\n</div>',providers:[BillTrackerDataService],changeDetection:core$1.ChangeDetectionStrategy.Default,styles:['.bill-tracker-divider{position:relative;height:1px}.bill-tracker-divider-transparent:before{content:"";position:absolute;top:0;left:0;width:100%;height:1px;background-color:#e9ecf3}.bill-tracker-divider-transparent:hover:before{content:"";position:absolute;top:0;left:0;width:100%;height:1px;background-color:#3f65ff}.bill-tracker-divider-img:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator.svg);background-repeat:no-repeat}.bill-tracker-divider-img:hover:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator-hover.svg);background-repeat:no-repeat}.bill-tracker-graph-wrapper{height:100%;position:relative}.bill-tracker-data-wrapper{z-index:2;overflow-y:auto;position:absolute;left:0;width:100%;bottom:0;height:200px;background-color:#fff;border-top:1px solid #e9ecf3}.bill-tracker-data-table-wrapper{position:relative;width:100%;padding-top:6px}.bill-tracker-fold-wrapper{z-index:1;position:absolute;right:0;top:0;width:2rem;height:2rem}.bill-tracker-fold-icon{display:inline-flex;width:1.5em;height:1.5em;line-height:1.5em;text-align:center;color:#848c9a;background:#fff;border-radius:1.5em;border:1px solid #e9ecf3;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden;margin:.5em .5em 0 0}.bill-tracker-fold-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-wrapper{z-index:1;position:absolute;right:0;top:0;display:flex;margin-right:14px;margin-top:14px;background-color:#fff}.bill-tracker-toolbar-icon{background:#fff;width:22px;height:22px;line-height:22px;text-align:center;color:#595d63;border:1px solid #e8ebf2;box-shadow:0 2px 6px 0 rgba(31,35,41,.06);border-radius:22px;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden}.bill-tracker-toolbar-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-btn:hover{background-color:#fff}']}]}],lw.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ChangeDetectorRef},{type:core$1.ViewContainerRef},{type:core$1.ApplicationRef},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]}]},lw.propDecorators={billGraph:[{type:core$1.ViewChild,args:["billGraph"]}],billGraphVCR:[{type:core$1.ViewChild,args:["billGraph",{read:core$1.ViewContainerRef}]}],mainContainerER:[{type:core$1.ViewChild,args:["mainContainer"]}],graphContainerER:[{type:core$1.ViewChild,args:["graphContainer"]}],billData:[{type:core$1.ViewChild,args:["billData"]}],billDataVCR:[{type:core$1.ViewChild,args:["billData",{read:core$1.ViewContainerRef}]}],divDataTableER:[{type:core$1.ViewChild,args:["divDataTable"]}],divDataWrapperER:[{type:core$1.ViewChild,args:["divDataWrapper"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},lw);function lw(e,t,r,o,n,i,a,l,s,c,p,d){this.localeId=t,this.dataService=r,this.notify=o,this.messager=n,this.loading=i,this.modal=a,this.cdf=l,this.vcr=s,this.appr=c,this.inj=p,this.cfr=d,this.defaultDataWrapperHeight=180,this.dataWrapperHeight=180,this.showData=!1,this.dataFullScreen=!1,this.billTrackerArgs=e,this.dataInfoService=new BillTrackerDataInfoService,this.newBTS=this.dataInfoService.isNewBTS(this.billTrackerArgs.canTrackingResult.billTrackingSettings);var u=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=u.get(BillTrackerInternalUiService,null),this.defaultDataWrapperHeight=e&&e.gridOptions&&e.gridOptions.defaultHeight?e.gridOptions.defaultHeight:this.defaultDataWrapperHeight,this.dataWrapperHeight=this.defaultDataWrapperHeight}var BillTrackerUiService=(Pw.prototype.openDefaultBillTrackerDialog=function(a,l,e,s,c){var p=this;if(void 0===l&&(l=!0),"string"==typeof e){if(""==e)return this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty")),rxjs.of(null);e=JSON.parse(e)}var d={title:this.localePipe.transform("billTracker")},d=Object.assign(d,this.defaultModalOptions,e);"string"==typeof s&&(s=""!=s?JSON.parse(s):null),"string"==typeof c&&(c=""!=c?JSON.parse(c):null);var t=new GetDownBillsInfoArgs;return t.billDataId=a.billDataId,t.documentTypeId=a.documentTypeId,t.bizKind=a.bizKind,t.bizType=a.bizType,t.billChildInfos=a.billChildInfos,t.curYear=a.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(t).pipe(operators.switchMap(function(e){if(!e.canDownTracking&&!e.canUpTracking)return p.messager.info(p.localePipe.transform("noAssoBill")),p.loading.close(),rxjs.of(null);var t=new BillTrackerArgs;t.canTrackingResult=e,t.getBillsInfoArgs=a;var r=new BillTrackerGraphOptions,r=Object.assign(r,s);t.graphOptions=r;var o=new BillTrackerGridOptions,o=Object.assign(o,c);t.gridOptions=o;var n=p.createBillTrackerComponent(t);p.loading.close();var i=p.modalService.show(n,d);return l&&i.dialog.instance.maxDialog(),n.instance.setModalRef(i),rxjs.of(n.instance)}),operators.catchError(function(e){throw p.loading.close(),p.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},Pw.prototype.openDefaultBillTrackerApp=function(i,a,l){var s=this;if("string"==typeof a){if(""==a)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));a=JSON.parse(a)}if("string"==typeof l){if(""==l)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));l=JSON.parse(l)}var e=new GetDownBillsInfoArgs;e.documentTypeId=i.documentTypeId,e.billDataId=i.billDataId,e.bizKind=i.bizKind,e.bizType=i.bizType,e.billChildInfos=i.billChildInfos,e.curYear=i.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(e).subscribe(function(e){if(!e.canDownTracking&&!e.canUpTracking)return s.messager.info(s.localePipe.transform("noAssoBill")),void s.loading.close();var t=new BillTrackerArgs;t.canTrackingResult=e,t.getBillsInfoArgs=i;var r=new BillTrackerGraphOptions,r=Object.assign(r,a);t.graphOptions=r;var o=new BillTrackerGridOptions,o=Object.assign(o,l);t.gridOptions=o;var n={appId:BillTrackerConstant.DEFAULT_APP_ID,appEntrance:BillTrackerConstant.DEFAULT_APP_ENTRANCE,funcId:BillTrackerConstant.DEFAULT_FUNC_ID,tabId:"billTracker"+Date.now(),tabName:s.localePipe.transform("billTracker"),appType:rtfCommon.AppType.App,entityParams:t,queryStringParams:s.buildQueryMap(t),isReload:undefined};s.frameworkService.openMenu(n),s.loading.close()},function(e){throw s.loading.close(),s.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},Pw.prototype.createBillTrackerComponent=function(e,t,r,o){t=null==t?this.cfr:t,r=null==r?this.injector:r,o=null==o||0==Array.isArray(o)?[]:o;var n=core$1.ReflectiveInjector.resolveAndCreate(__spread([{provide:BillTrackerArgs,useValue:e}],o),r);return t.resolveComponentFactory(BillTrackerComponent).create(n)},Pw.prototype.canTracking=function(e){return this.dataService.canTracking(e)},Pw.prototype.getDownBillsInfo=function(e){return this.dataService.getDownBillsInfo(e)},Pw.prototype.getUpBillsInfo=function(e){return this.dataService.getUpBillsInfo(e)},Pw.prototype.getEntityData=function(e){return this.dataService.getEntityData(e)},Pw.prototype.buildQueryMap=function(e){var t=new Map;for(var r in e){var o=e[r];"object"==typeof o&&(o=o&&JSON.stringify(o)),t.set(r,o)}return t},Pw.decorators=[{type:core$1.Injectable}],Pw.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},Pw);function Pw(e,t,r,o,n,i,a,l){this.frameworkService=e,this.messager=t,this.loading=r,this.dataService=n,this.modalService=i,this.cfr=a,this.injector=l,this.defaultModalOptions={title:null,width:1100,height:480,buttons:null,showButtons:null},this.localePipe=new BillTrackerLocalePipe(o)}var CellData=function(){this.diagramInfo={x:null,y:null,width:null,height:null,extProps:{}}},EntryCellData=(Mx=CellData,__extends(Nx,Mx),Nx),Mx;function Nx(){var e=null!==Mx&&Mx.apply(this,arguments)||this;return e.ups=[],e.downs=[],e}var UpCellData=(Px=CellData,__extends(Qx,Px),Qx),Px;function Qx(){var e=null!==Px&&Px.apply(this,arguments)||this;return e.ups=[],e}var DownCellData=(Sx=CellData,__extends(Tx,Sx),Tx),Sx;function Tx(){var e=null!==Sx&&Sx.apply(this,arguments)||this;return e.downs=[],e}var billTrackerCellCss="\n.bif-cell-node { \n    position: relative;\n    height: 100%;\n    font-weight: normal;\n    font-family: PingFangSC-Regular;\n    display:block;\n    text-align: left;\n}\n.bif-cell-node-main { \n    height: 100%;\n    background: #FFFFFF;\n    border: 1px solid rgba(230,233,240,1);\n    box-shadow: 0px 2px 10px 0px rgba(3,18,51,0.08);\n    border-radius: 8px;\n    border-left-width: 4px;\n    border-left-color: #2A87FF;\n}\n.bif-cell-node-current {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 50px;\n    height: 28px;\n    background-image: linear-gradient(39deg, #F5A144 0%, #FFC527 100%);\n    box-shadow: 0px 2px 6px 0px rgba(245,161,68,0.4);\n    border-radius: 0px 8px 0px 64px;\n    color: white;\n    text-align: center;\n}\n.bif-cell-node-current-text {\n    display: block;\n    margin: auto;\n    line-height: 28px;\n}\n.bif-cell-node-title {\n    padding-left:19px;\n    padding-right:12px;\n    padding-top: 16px;\n    padding-bottom: 6px;\n}\n.bif-cell-node-title-text { \n    font-size: 16px;\n    color: #2D2F33;\n    letter-spacing: 0;\n    line-height: 24px;\n    font-weight: 400;\n}\n.bif-cell-node-summary-list { \n    \n}\n.bif-cell-node-summary { \n    display: flex;\n    padding-left: 19px;\n    padding-right:12px;\n    font-size: 13px;\n    color: #5A5E66;\n    line-height: 24px;\n    font-weight: 400;\n}\n.bif-cell-node-summary-caption { \n    letter-spacing: 0;\n    margin-right: 4px;\n    width: 52px;\n    min-width: 52px;\n    text-align: right;\n}\n.bif-cell-node-summary-caption-text { \n    white-space: normal;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    word-break: break-all;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1;\n}\n.bif-cell-node-summary-value { \n    \n}\n.bif-cell-node-summary-value-text { \n    font-family: PingFangSC-Regular,HelveticaNeue,Helvetica,Arial,sans-serif;\n    color: rgba(0,0,0,0.85);\n    text-align: left;\n    white-space: normal;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    -webkit-line-clamp: 1;\n    word-break: break-all;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n.bif-cell-node-title-link { \n}\n.bif-cell-node-title-link:hover { \n    text-decoration: underline;\n    cursor: pointer;\n}\n.bif-cell-node-title-link-color {\n    color: #56A0FF;\n}\n.bif-cell-node-title-only {\n    justify-content: center;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    border: 1px solid rgb(193,195,199,1);\n}\n.bif-cell-node-title-only-text {\n    font-size: xx-large;\n}\n.bif-cell-node-thumb {\n    height: 100%;\n    background: #FFFFFF;\n}\n.bif-cell-node-thumb-img-container {\n    height: 80%;\n}\n.bif-cell-node-thumb-img {\n    height: 100%;\n    width: 100%;\n}\n.bif-cell-node-thumb-title {\n    height: 20%;\n    display: flex;\n    justify-content: center;\n    display: flex;\n    align-items: center;\n}\n.bif-cell-node-thumb-title-text {\n    font-size: x-large;\n}\n";function addCustomCSS(t){var e,r,o=document.createElement("style"),n=document.head||document.getElementsByTagName("head")[0];o.type="text/css",o.styleSheet?(e=function(){try{o.styleSheet.cssText=t}catch(e){}},o.styleSheet.disabled?setTimeout(e,10):e()):(r=document.createTextNode(t),o.appendChild(r)),n.appendChild(o)}addCustomCSS(billTrackerCellCss);var BillTrackerGraphComponent=(ay.prototype.ngOnInit=function(){this.graph=this.createGraph(),this.createLayout(this.graph),this.layoutManager=new mxLayoutManagerType(this.graph),this.outline=new Outline(this.graph,this.mxOutlineContainer.nativeElement)},ay.prototype.ngAfterViewInit=function(){},ay.prototype.refresh=function(e){void 0===e&&(e=!0),e&&null!=this.graph&&this.graph.sizeDidChange()},ay.prototype.paint=function(){this.paintGraph(this.graph)},ay.prototype.setModalRef=function(e){var t,r=this;this.modalRef=e,null!=this.modalRef&&(this.modalRef.dialog.instance.closed.subscribe(function(e){r.graph&&r.graph.destroy()}),t=0,this.modalRef.dialog.instance.resized.subscribe(function(e){2<=t&&r.refresh(),t++}))},ay.prototype.createGraph=function(){mxGraphHandlerType.prototype.guidesEnabled=!0,mxEventType.disableContextMenu(this.mxContainerER.nativeElement),mxGraphHandlerType.prototype.scrollOnMove=!1,mxGraphHandlerType.prototype.scaleGrid=!0,mxConstantsType.HANDLE_FILLCOLOR="#29b6f2",mxHandleType.prototype.createShape=function(e){var t=new mxEllipseType(0,0,mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE);return new mxEllipseType(t,mxConstantsType.HANDLE_FILLCOLOR,mxConstantsType.HANDLE_STROKECOLOR)},mxVertexHandlerType.prototype.handleImage=mxClientType.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="3" stroke="#fff" fill="'+Graph.handleFill+'" stroke-width="1"/>'):new mxImageType(BillTrackerConstant.IMAGE_PATH+"/handle-main.png",mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE),mxConstantsType.DEFAULT_VALID_COLOR="#FFFFFF",mxConstantsType.HIGHLIGHT_STROKEWIDTH=1,mxConstantsType.GUIDE_COLOR="#0088cf",mxGuideType.prototype.createGuideShape=function(e){return new mxPolylineType([],mxConstantsType.GUIDE_COLOR,mxConstantsType.GUIDE_STROKEWIDTH)},mxConstantsType.VERTEX_SELECTION_STROKEWIDTH=1,mxConstantsType.VERTEX_SELECTION_COLOR="#3E8DFF",mxConstantsType.VERTEX_SELECTION_DASHED=!1,mxConnectionHandlerType.prototype.getEdgeWidth=function(e){return 1},mxConstantsType.VALID_COLOR="#00CD66";var e=new Graph(this.mxContainerER.nativeElement,undefined,undefined,undefined);return e.localePipe=this.localePipe,e.graphOptions=this.graphOptions,e.gridOptions=this.gridOptions,this.addListener(e),e},ay.prototype.createLayout=function(e){var t=new RevertCompactTreeLayout(e,!0);t.levelDistance=this.hspace,t.edgeRouting=!1,t.resetEdges=!1,this.upLayout=t;var r=new CompactTreeLayout(e,!0);r.levelDistance=this.hspace,r.edgeRouting=!1,r.resetEdges=!0,this.downLayout=r},ay.prototype.addListener=function(e){var o=this;mxEventType.addListener(window,"resize",function(){window.setTimeout(function(){null!=o.graph&&o.refresh()},0)}),mxEventType.addMouseWheelListener(function(e,t){if(mxEventType.isControlDown(e)||mxClientType.IS_MAC&&e.metaKey)return t?o.zoomIn():o.zoomOut(),mxEventType.consume(e),!1},this.mxContainerER.nativeElement),e.getSelectionModel().addListener(mxEventType.CHANGE,function(e,t){var r;e instanceof mxGraphSelectionModelType&&(null!=e.cells&&1==e.cells.length?!(r=e.cells[0]).edge&&r.vertex&&o.selectEventEmitter.emit(r):o.selectEventEmitter.emit(null))}),e.addListener(Events.CLICK_FIRST_SUMMARY,function(e,t){var r=t.getProperty("cell");o.stateChangeEventEmitter.emit({type:Events.CLICK_FIRST_SUMMARY,data:r})})},ay.prototype.paintGraph=function(e){e.getModel().beginUpdate(),this.entry=this.paintEntry(e),this.afterPaintGraph(this.graph,this.entry),e.getModel().endUpdate()},ay.prototype.afterPaintGraph=function(e,t){var r;null!=t&&(this.billTrackerArgs.gridOptions.showEntryData&&e.setSelectionCell(this.entry),r=this.billTrackerArgs.canTrackingResult,1==this.billTrackerArgs.graphOptions.showDownBills&&r.canDownTracking&&this.entry.downCellOverlay&&this.entry.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"resetView",!0)),1==this.billTrackerArgs.graphOptions.showUpBills&&r.canUpTracking&&this.entry.upCellOverlay&&this.entry.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"resetView",!0)))},ay.prototype.paintEntry=function(e){var t=null;if(null==this.billTrackerArgs||null==this.billTrackerArgs.canTrackingResult)return t;var r=this.billTrackerArgs.canTrackingResult,o=this.dataService.buildEntryBillInfo(r),n=o.billDataInfos[0];(new commonApi.BillTrackingSettings).LoadFromJson(r.billTrackingSettings);var i=e.getDefaultParent();e.getModel().beginUpdate();try{var a=new commonApi.BillTrackingSettings;o&&o.billTrackingSettings&&a.LoadFromJson(o.billTrackingSettings);var l,t=e.insertBillCell(i,null,n,o,!0,0,0,this.nodeWidth,this.nodeHeight,"billNode;billNodeEntry;");e.getModel().getGeometry(t),e.getPreferredSizeForCell(t),this.entryCellData=new EntryCellData,this.setCellData(this.entryCellData,t),this.entryCellData.canTrackingResult=r,t.data=this.entryCellData,r.canDownTracking&&(l=this.addDownOverlay(e,t),t.downCellOverlay=l),r.canUpTracking&&(l=this.addUpOverlay(e,t),t.upCellOverlay=l),this.upParent=i.clone(),this.downParent=i.clone(),e.addCells([this.upParent,this.downParent],i)}finally{e.getModel().endUpdate()}return t},ay.prototype.addUpOverlay=function(o,n){var i=this,a=new CellOverlay(this.upSearchImage,this.localePipe.transform("upSearch"),mxConstantsType.ALIGN_LEFT,mxConstantsType.ALIGN_MIDDLE,this.upSearchOffset,"hand");a.state=CellOverlayState.Search;var l=function(e,t){var r=t.getProperty("resetView");o.getModel().beginUpdate(),i.addUpAssoCell(o,n,r),a.removeListener(l),a.tooltip=i.localePipe.transform("folder"),a.image=i.upFolderImage,a.state=CellOverlayState.Fold,a.addListener(mxEventType.CLICK,s),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()},s=function(e,t){o.getModel().beginUpdate(),i.removeAssoCell(o,n,BillTrackerDirection.Up),a.removeListener(s),a.tooltip=i.localePipe.transform("upSearch"),a.image=i.upSearchImage,a.state=CellOverlayState.Search,a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.model.endUpdate()};return a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),a},ay.prototype.addDownOverlay=function(o,n){var i=this,a=new CellOverlay(this.downSearchImage,this.localePipe.transform("downSearch"),mxConstantsType.ALIGN_RIGHT,mxConstantsType.ALIGN_MIDDLE,this.downSearchOffset,"hand");a.state=CellOverlayState.Search;var l=function(e,t){var r=t.getProperty("resetView");o.getModel().beginUpdate(),i.addDownAssoCell(o,n,r),a.image=i.downFolderImage,a.tooltip=i.localePipe.transform("folder"),a.state=CellOverlayState.Fold,a.removeListener(l),a.addListener(mxEventType.CLICK,s),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()},s=function(e,t){o.getModel().beginUpdate(),i.removeAssoCell(o,n,BillTrackerDirection.Down),a.image=i.downSearchImage,a.tooltip=i.localePipe.transform("downSearch"),a.state=CellOverlayState.Search,a.removeListener(s),a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()};return a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),a},ay.prototype.addUpAssoCell=function(k,O,J){var _=this;void 0===J&&(J=!1),k.getModel().beginUpdate();var e=this.dataService.buildGetUpBillsInfoArgs(O);this.loading.show({message:this.localePipe.transform("loading")}),this.numCellsAddingReq++,this.dataService.getUpBillsInfo(e).subscribe(function(e){var t,r,o,n,i,a,l,s,c=k.getDefaultParent(),p=[];try{try{for(var d=__values(e),u=d.next();!u.done;u=d.next()){var m=u.value;try{for(var h=__values(m.billDataInfos),y=h.next();!y.done;y=h.next()){var f=y.value,g=new commonApi.BillTrackingSettings;m&&m.billTrackingSettings&&g.LoadFromJson(m.billTrackingSettings);var x=k.insertBillCell(_.upParent,null,f,m,!1,O.geometry.x-_.hspace,O.geometry.y,_.nodeWidth,_.nodeHeight,"billNode;");p.push(x)}}catch(P){o={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}}}catch(L){t={error:L}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}_.calCellsPosition(k,O,p,BillTrackerDirection.Up);try{for(var v,b=__values(p),C=b.next();!C.done;C=b.next())(w=C.value).billDataInfo.canContinueTracking&&(v=_.addUpOverlay(k,w),w.upCellOverlay=v),k.insertEdge(c,null,"",w,O,"billAssociation;")}catch(D){i={error:D}}finally{try{C&&!C.done&&(a=b["return"])&&a.call(b)}finally{if(i)throw i.error}}var S=_.entry.getGeometry().clone();_.upLayout.execute(_.upParent,_.entry);var T=_.entry.getGeometry().clone(),A=S.x-T.x,I=S.y-T.y;_.restoreEntryPosition(k,_.entry,A,I);var B=O.data;B.ups.length=0;try{for(var E=__values(p),M=E.next();!M.done;M=E.next()){var w=M.value,R=new UpCellData;_.setCellData(R,w),((w.data=R).down=B).ups.push(R)}}catch(F){l={error:F}}finally{try{M&&!M.done&&(s=E["return"])&&s.call(E)}finally{if(l)throw l.error}}}finally{k.getModel().endUpdate()}J&&k.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),_.numCellsAddingReq--,_.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",_.upParent)),_.loading.close()},function(e){throw _.numCellsAddingReq--,_.loading.close(),_.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},ay.prototype.addDownAssoCell=function(k,O,J){var _=this;void 0===J&&(J=!1),k.getModel().beginUpdate();var e=this.dataService.buildGetDownBillsInfoArgs(O);this.loading.show({message:this.localePipe.transform("loading")}),this.numCellsAddingReq++,this.dataService.getDownBillsInfo(e).subscribe(function(e){k.getModel();var t,r,o,n,i,a,l,s,c=k.getDefaultParent(),p=[];try{try{for(var d=__values(e),u=d.next();!u.done;u=d.next()){var m=u.value;try{for(var h=__values(m.billDataInfos),y=h.next();!y.done;y=h.next()){var f=y.value,g=new commonApi.BillTrackingSettings;m&&m.billTrackingSettings&&g.LoadFromJson(m.billTrackingSettings);var x=k.insertBillCell(_.downParent,null,f,m,!1,O.geometry.x+_.hspace,O.geometry.y,_.nodeWidth,_.nodeHeight,"billNode;");p.push(x)}}catch(P){o={error:P}}finally{try{y&&!y.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}}}catch(L){t={error:L}}finally{try{u&&!u.done&&(r=d["return"])&&r.call(d)}finally{if(t)throw t.error}}_.calCellsPosition(k,O,p,BillTrackerDirection.Down);try{for(var v,b=__values(p),C=b.next();!C.done;C=b.next())(w=C.value).billDataInfo.canContinueTracking&&(v=_.addDownOverlay(k,w),w.downCellOverlay=v),k.insertEdge(c,null,"",O,w,"billAssociation;")}catch(D){i={error:D}}finally{try{C&&!C.done&&(a=b["return"])&&a.call(b)}finally{if(i)throw i.error}}var S=_.entry.getGeometry().clone();_.downLayout.execute(_.downParent,_.entry);var T=_.entry.getGeometry().clone(),A=S.x-T.x,I=S.y-T.y;_.restoreEntryPosition(k,_.entry,A,I);var B=O.data;B.downs.length=0;try{for(var E=__values(p),M=E.next();!M.done;M=E.next()){var w=M.value,R=new DownCellData;_.setCellData(R,w),((w.data=R).up=B).downs.push(R)}}catch(F){l={error:F}}finally{try{M&&!M.done&&(s=E["return"])&&s.call(E)}finally{if(l)throw l.error}}}finally{k.getModel().endUpdate()}J&&k.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),_.numCellsAddingReq--,_.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",_.downParent)),_.loading.close()},function(e){throw _.numCellsAddingReq--,_.loading.close(),_.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},ay.prototype.removeAssoCell=function(e,t,r){var o=e.getModel();e.getDefaultParent(),e.getModel().beginUpdate();try{var n=[];if(r==BillTrackerDirection.Down)for(var i=o.getOutgoingEdges(t),a=0;i&&0<i.length&&a<i.length;)i[a].target&&i[a].target!=this.entry&&(n.push(i[a].target),i.push.apply(i,__spread(o.getOutgoingEdges(i[a].target)))),a++;else if(r==BillTrackerDirection.Up)for(i=o.getIncomingEdges(t),a=0;i&&0<i.length&&a<i.length;)i[a].source&&i[a].source!=this.entry&&(n.push(i[a].source),i.push.apply(i,__spread(o.getIncomingEdges(i[a].source)))),a++;r==BillTrackerDirection.Down?t.data.downs.length=0:r==BillTrackerDirection.Up&&(t.data.ups.length=0),e.removeCells(n);var l=this.entry.getGeometry().clone();this.upLayout.execute(this.upParent,this.entry);var s=this.entry.getGeometry().clone(),c=l.x-s.x,p=l.y-s.y;this.restoreEntryPosition(e,this.entry,c,p);var d=this.entry.getGeometry().clone();this.downLayout.execute(this.downParent,this.entry);var u=this.entry.getGeometry().clone(),m=d.x-u.x,h=d.y-u.y;this.restoreEntryPosition(e,this.entry,m,h)}finally{e.getModel().endUpdate()}},ay.prototype.restoreEntryPosition=function(e,t,r,o){e.getModel().beginUpdate();try{var n=__spread([t],e.getChildCells(this.upParent,!0,!1),e.getChildCells(this.downParent,!0,!1));e.moveCells(n,r,o)}finally{e.getModel().endUpdate()}},ay.prototype.calCellsPosition=function(e,t,r,o){o==BillTrackerDirection.Down?this.resetDownCellsPosition(e,t,r):o==BillTrackerDirection.Up&&this.resetUpCellsPosition(e,t,r)},ay.prototype.resetDownCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getOutgoingEdges(e).map(function(e){return e.target}),n=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),i=0<n.length?n[n.length-1].geometry.y:e.geometry.y,a=0<n.length?n[0].geometry.y:e.geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p=(a+i)/2,d=e.geometry.y-p;for(var u in o.forEach(function(e){t.translateCell(e,0,d)}),i+=d,a+=d,p+=d,t.model.cells)t.model.cells[u]!=t.model.root&&null!=t.model.cells[u].geometry&&1!=t.model.cells[u].edge&&t.model.cells[u]!=e&&-1==r.indexOf(t.model.cells[u])&&t.model.cells[u]!=this.entry&&(t.model.cells[u].geometry.x<this.entry.geometry.x||(c=(s=t.model.cells[u]).geometry,t.translateCell(s,0,c.y<=e.geometry.y?i-(e.geometry.y-c.y)-c.y:a+(c.y-e.geometry.y)-c.y)))}finally{t.getModel().endUpdate()}},ay.prototype.resetUpCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getIncomingEdges(e).map(function(e){return e.source}),n=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),i=0<n.length?n[n.length-1].geometry.y:e.geometry.y,a=0<n.length?n[0].geometry.y:e.geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p=(a+i)/2,d=e.geometry.y-p;for(var u in o.forEach(function(e){t.translateCell(e,0,d)}),i+=d,a+=d,p+=d,t.model.cells)t.model.cells[u]!=t.model.root&&null!=t.model.cells[u].geometry&&1!=t.model.cells[u].edge&&t.model.cells[u]!=e&&-1==r.indexOf(t.model.cells[u])&&t.model.cells[u]!=this.entry&&(t.model.cells[u].geometry.x>this.entry.geometry.x||(c=(s=t.model.cells[u]).geometry,t.translateCell(s,0,c.y<=e.geometry.y?i-(e.geometry.y-c.y)-c.y:a+(c.y-e.geometry.y)-c.y)))}finally{t.getModel().endUpdate()}},ay.prototype.setCellData=function(e,t){e.billInfo=t.billInfo,e.billDataInfo=t.billDataInfo,e.visible=!0,e.diagramInfo.x=t.geometry.x,e.diagramInfo.y=t.geometry.y,e.diagramInfo.width=t.geometry.width,e.diagramInfo.height=t.geometry.height,e.diagramInfo.extProps={style:t.style}},ay.prototype.zoomOut=function(){this.graph.zoomOut()},ay.prototype.zoomIn=function(){this.graph.zoomIn()},ay.prototype.zoomActual=function(){this.graph.zoomActual()},ay.prototype.getZoomScale=function(){return Math.round(100*this.graph.view.scale)},ay.prototype.print=function(){var e=new mxPrintPreviewType(this.graph,1);e.printOverlays=!0,e.printControls=!0,e.printBackgroundImage=!0,e.open(billTrackerCellCss)},ay.prototype.expand=function(e,t){var r;void 0===t&&(t=!1),t?this.expandAll(e):e==BillTrackerDirection.Up?(r=[this.entry],this.upParent.children&&r.push.apply(r,__spread(this.upParent.children)),r.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})):e==BillTrackerDirection.Down&&(r=[this.entry],this.downParent.children&&r.push.apply(r,__spread(this.downParent.children)),r.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))}))},ay.prototype.expandAll=function(e){var r,o=this;e!=BillTrackerDirection.Up&&e!=BillTrackerDirection.Down||(r=null,e==BillTrackerDirection.Up?r=function(){var e=[o.entry];o.upParent.children&&e.push.apply(e,__spread(o.upParent.children));var t=e.filter(function(e){return e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search});null==t||0==t.length?0===o.numCellsAddingReq&&o.graph.removeListener(r):t.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})}:e==BillTrackerDirection.Down&&(r=function(){var e=[o.entry];o.downParent.children&&e.push.apply(e,__spread(o.downParent.children));var t=e.filter(function(e){return e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search});null==t||0==t.length?0===o.numCellsAddingReq&&o.graph.removeListener(r):t.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})}),this.graph.addListener("billCellsAddedAndMoved",r),r())},ay.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-graph",template:'<div #mxContainer id="mx-container" class="mx-container-ng">\r\n\r\n</div>\r\n\r\n<div #mxOutlineContainer id="mx-outline-container" class="mx-outline-container" [style.top]="modalRef?\'50px\':null">\r\n\r\n</div>',styles:[".mx-container-ng{position:absolute;top:0;left:0;bottom:0;right:0;cursor:default;overflow:auto;padding-right:16px;padding-bottom:16px;margin:4px}.mx-outline-container{z-index:1;position:absolute;overflow:hidden;top:20px;right:20px;width:160px;height:120px;background:#fff;border:1px solid #d3d3d3}"]}]}],ay.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},ay.propDecorators={mxContainerER:[{type:core$1.ViewChild,args:["mxContainer"]}],mxOutlineContainer:[{type:core$1.ViewChild,args:["mxOutlineContainer"]}],selectEventEmitter:[{type:core$1.Output,args:["select"]}],stateChangeEventEmitter:[{type:core$1.Output,args:["stateChange"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},ay);function ay(e,t,r,o,n,i,a,l,s,c,p){this.dataService=r,this.notify=o,this.messager=n,this.loading=i,this.modal=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.selectEventEmitter=new core$1.EventEmitter,this.stateChangeEventEmitter=new core$1.EventEmitter,this.hspace=80,this.vspace=28,this.defaultWidth=250,this.defaultHeight=138,this.nodeWidth=this.defaultWidth,this.nodeHeight=this.defaultHeight,this.defaultNonEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.png",this.defaultEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/entry-bill.png",this.defaultOverlayWidth=26,this.defaultOverlayHeight=26,this.overlayWidth=this.defaultOverlayWidth,this.overlayHeight=this.defaultOverlayHeight,this.defaultUpSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultUpFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.upSearchImage=this.defaultUpSearchImage,this.downSearchImage=this.defaultDownSearchImage,this.upFolderImage=this.defaultUpFolderImage,this.downFolderImage=this.defaultDownFolderImage,this.upSearchOffset=new mxPointType(-50,0),this.downSearchOffset=new mxPointType(50,0),this.numCellsAddingReq=0,this.localePipe=new BillTrackerLocalePipe(t),this.dataInfoService=new BillTrackerDataInfoService,this.billTrackerArgs=e;var d=this.billTrackerArgs.graphOptions;this.graphOptions=d;var u=this.billTrackerArgs.gridOptions;this.gridOptions=u,this.upSearchImage=d&&d.upSearchImage?new mxImageType(d.upSearchImage,this.overlayWidth,this.overlayHeight):this.upSearchImage,this.downSearchImage=d&&d.downSearchImage?new mxImageType(d.downSearchImage,this.overlayWidth,this.overlayHeight):this.downSearchImage,this.upFolderImage=d&&d.upFolderImage?new mxImageType(d.upFolderImage,this.overlayWidth,this.overlayHeight):this.upFolderImage,this.downFolderImage=d&&d.downFolderImage?new mxImageType(d.downFolderImage,this.overlayWidth,this.overlayHeight):this.downFolderImage}var BillFrontField=function(){},BillFrontDataRow=function(){},BasicTableComponent=(OC.prototype.ngOnInit=function(){},OC.prototype.clickHandler=function(e,t){e.expanded=!e.expanded},OC.prototype.showMainTable=function(e){this.showTable(e.billSchema.mainTable,e.billData.mainTable)},OC.prototype.showTable=function(e,t){this.billSchemaTable=e,this.billDataTable=t,this.loadData(e.getFieldList(),t.GetRowList()),this.cdr.detectChanges()},OC.prototype.loadData=function(e,t){this.fields=e,this.rows=t;var r=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&r.LoadFromJson(this.billInfo.billTrackingSettings),r.billTrackingDataShownMode==commonApi.BillTrackingDataShownMode.CUSTOMFIELD?this.ffields=this.extractFFieldsWithCustomFields(e,r.customFieldContent):this.ffields=this.extractFFields(e),this.frows=this.extractFRows(t,this.ffields)},OC.prototype.extractFFields=function(e){var t,r,o=[];try{for(var n=__values(e),i=n.next();!i.done;i=n.next()){var a,l=i.value;"Enum"==l.fieldType||"EnumSingleUdt"==l.fieldType?((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l)+".Name",o.push(a)):null!=l.GetSubFieldList()&&0<l.GetSubFieldList().length?o.push.apply(o,__spread(this.extractFSubFields(l.GetSubFieldList()))):((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l),o.push(a))}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return o},OC.prototype.extractFSubFields=function(e,t){var r,o,n=[];try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var l,s=a.value;"Enum"==s.fieldType||"EnumSingleUdt"==s.fieldType?((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s)+".Name",n.push(l)):null!=s.GetSubFieldList()&&0<s.GetSubFieldList().length?n.push.apply(n,__spread(this.extractFSubFields(s.GetSubFieldList()))):((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s),n.push(l))}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},OC.prototype.extractFFieldsWithCustomFields=function(e,a){var t,r,l=this.billSchemaTable.tableName,o=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings);var s="object"==typeof a?a:JSON.parse(a),c=[],p=this;try{for(var n=__values(e),i=n.next();!i.done;i=n.next())!function(e){var t,r=p.extractFieldPath(e),o=null;for(var n in s.schema)if("selectedAll"!=n&&n==l){var i=s.schema[n],o=i&&i.fields.find(function(e){return e.fieldPath==r});break}null!=o&&("Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e)+".Name",c.push(t)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e),c.push(t)))}(i.value)}catch(d){t={error:d}}finally{try{i&&!i.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return c},OC.prototype.extractFSubFieldsWithCustomFields=function(e,a,t){var r,o,l=this.billSchemaTable.tableName,n=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&n.LoadFromJson(this.billInfo.billTrackingSettings);var s="object"==typeof a?a:JSON.parse(a),c=[],p=this;try{for(var i=__values(e),d=i.next();!d.done;d=i.next())!function(e){var t,r=p.extractFieldPath(e),o=null;for(var n in s.schema)if("selectedAll"!=n&&n==l){var i=s.schema[n],o=i&&i.fields.find(function(e){return e.fieldPath==r});break}null!=o&&("Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e)+".Name",c.push(t)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((t=new BillFrontField).fieldName=e.fieldName,t.dataType=e.dataType,t.caption=e.caption,t.fieldType=e.fieldType,t.length=e.length,t.precision=e.precision,t.scale=e.scale,t.captionPath=o.displayName||e.caption,t.fieldPath=p.extractFieldPath(e),c.push(t)))}(d.value)}catch(u){r={error:u}}finally{try{d&&!d.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return c},OC.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},OC.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},OC.prototype.extractFRows=function(e,t){var r,o,n,i,a=[];try{for(var l=__values(e),s=l.next();!s.done;s=l.next()){var c=s.value,p=new BillFrontDataRow;p.expanded=0==c.GetChildTableList().length?null:!(!c.attachedTable||null!=c.attachedTable.attachedRow),p.hasChildren=this.hasChildren(c),p.data={};try{for(var d=__values(t),u=d.next();!u.done;u=d.next()){var m=u.value;p.data[m.fieldPath]=this.extractFieldPathValue(c.GetFieldMap(),m.fieldPath)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(i=d["return"])&&i.call(d)}finally{if(n)throw n.error}}a.push(p)}}catch(y){r={error:y}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return a},OC.prototype.hasChildren=function(e){var t,r,o=e.GetChildTableList()&&0<e.GetChildTableList().length;if(o){var n=!1;try{for(var i=__values(e.GetChildTableList()),a=i.next();!a.done;a=i.next()){var l=a.value;if(l.GetRowList()&&0<l.GetRowList().length){n=!0;break}}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}o=n}return o},OC.prototype.extractFieldPathValue=function(e,t){for(var r=t.split("."),o=e[r[0]],n=1;null!=o&&n<r.length;n++){var i=o.GetSubFieldMap();if(null==i)break;o=i[r[n]]}return o?o.GetTextValue():""},OC.prototype.getShownText=function(e,t){if(null==e[t.fieldPath])return"";if(t.dataType==commonApi$1.DataType.String)return e[t.fieldPath]||"";if(t.dataType==commonApi$1.DataType.Decimal)return parseFloat(String(e[t.fieldPath])).toFixed(t.scale).toString()||"";if(t.dataType!=commonApi$1.DataType.DateTime)return e[t.fieldPath]||"";var r=commonApi$1.BpmnModelJsonHelper.DateTimeFromString(e[t.fieldPath]);return"DateTime"==t.fieldType?this.dateFormat(r,"yyyy-MM-dd HH:mm:ss.SSS"):(t.fieldType,this.dateFormat(r,"yyyy-MM-dd"))},OC.prototype.isObject=function(e){return"object"==typeof e},OC.prototype.isArray=function(e){return Array.isArray(e)},OC.prototype.dateFormat=function(e,t){var r,o={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(var n in o)(r=new RegExp("("+n+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?o[n]:o[n].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?o[n]:this.myPadStart(o[n],r[1].length,"0")));return t},OC.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},OC.decorators=[{type:core$1.Component,args:[{selector:"app-basic-table",template:'<table class="table table-striped table-hover text-nowrap" [ngStyle]="{\'margin-left\': isMain ? null : \'24px\'}"\r\n    style="min-width: 100%; width: auto;" *ngIf="ffields && ffields.length > 0 && frows && frows.length > 0">\r\n    <thead class="thead-light">\r\n        <tr>\r\n            <th style="width: 40px;"><span></span></th>\r\n            <th *ngFor="let ffield of ffields">\r\n                <span>{{ffield.captionPath}}</span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <ng-container *ngFor="let frow of frows;let rowIdx = index;">\r\n            <tr #tr>\r\n                <td>\r\n                    <span *ngIf="frow.hasChildren" style="cursor:pointer;" (click)="clickHandler(frow, $event)"\r\n                        [ngClass]="{\'k-icon\': true, \'k-i-plus-outline\': !frow.expanded, \'k-i-minus-outline\': frow.expanded}"></span>\r\n                </td>\r\n                <ng-container *ngFor="let ffield of ffields">\r\n                    <td>\r\n                        <span>{{getShownText(frow.data, ffield)}}</span>\r\n                        <span *ngIf="ffield.showMore" class="f-icon f-icon-more"></span>\r\n                    </td>\r\n                </ng-container>\r\n            </tr>\r\n            <tr *ngIf="frow.expanded&&frow.hasChildren">\r\n                <td [attr.colspan]="tr.cells.length">\r\n                    <ng-container appChildRowTable [parentRow]="rows[rowIdx]" [parentSchemaTable]="billSchemaTable"\r\n                        [parentDataTable]="billDataTable" [billInfo]="billInfo" [expanded]="frow.expanded"\r\n                        [colspan]="tr.cells.length">\r\n                    </ng-container>\r\n                </td>\r\n            </tr>\r\n        </ng-container>\r\n    </tbody>\r\n    <tfoot>\r\n    </tfoot>\r\n</table>',changeDetection:core$1.ChangeDetectionStrategy.OnPush,styles:["./basic-table.component.css"]}]}],OC.ctorParameters=function(){return[{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},OC.propDecorators={childTrTable:[{type:core$1.ViewChild,args:["childTrTable"]}],childTrTableVCR:[{type:core$1.ViewChild,args:["childTrTable",{read:core$1.ViewContainerRef}]}]},OC);function OC(e,t,r,o){this.viewContainerRef=e,this.inj=t,this.cfr=r,this.cdr=o}var BasicInfoComponent=(lF.prototype.ngOnInit=function(){this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId),this.fieldsWithValue=this.dataInfoService.getBasicInfoFieldsWithValue(this.billInfo,this.schemaTable,this.dataTable),this.fieldsWithValue=this.dataInfoService.sortFieldsByOrder(this.fieldsWithValue);var e,t=this.dataTable.GetRowList()[0];this.childSchemaTables=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),this.childDataTableMap=t.GetChildTableMap(),null!=this.billInfo.jointQueryParameters?(e=JSON.parse(this.billInfo.jointQueryParameters),this.hasLink=this.billInfo.jointQueryMode==commonApi.JointQueryMode.APP&&null!=e.funcId||this.billInfo.jointQueryMode==commonApi.JointQueryMode.URL&&null!=e.url):this.hasLink=!1},lF.prototype.clickLink=function(){return this.internalUiService.openBillDetailWithFields(this.billInfo,this.billDataInfo,this.fieldsWithValue),event.stopPropagation(),!1},lF.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-main-table",template:'<farris-section class="f-section-form f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n    <div class="f-form-layout farris-form farris-form-controls-inline">\r\n        <ng-container *ngFor="let field of fieldsWithValue; let i = index">\r\n            <div class="col-12 col-md-6 col-xl-3 col-el-2" *ngIf="field.show">\r\n                \x3c!-- 仅显示show属性为true的字段 --\x3e\r\n                \x3c!-- <div class="farris-group-wrap" *ngIf="!(hasLink && i==0); else linkTemp"> --\x3e\r\n                <div class="farris-group-wrap">\r\n                    \x3c!-- 非布尔值使用文本框 --\x3e\r\n                    <div class="form-group farris-form-group" *ngIf="field.dataType!=dateType.Boolean">\r\n                        <label class="col-form-label">\r\n                            <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class="farris-input-wrap">\r\n                            <div class="f-component-text" *ngIf="field.dataType!=dateType.Boolean">\r\n                                <span class="f-form-control-text" title="{{field.fieldValue}}">\r\n                                    {{field.fieldValue}}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    \x3c!-- 布尔值使用复选框 --\x3e\r\n                    <div class="form-group farris-form-group" *ngIf="field.dataType==dateType.Boolean">\r\n                        <label class="col-form-label">\r\n                            <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                {{field | billTrackerFieldLabel}}\r\n                            </span>\r\n                        </label>\r\n                        <div class="farris-input-wrap">\r\n                            <div class="custom-control custom-checkbox">\r\n                                <input class="custom-control-input" type="checkbox" readonly\r\n                                    [checked]="field.fieldValue" />\r\n                                <label class="custom-control-label"></label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                \x3c!-- 有联查配置时，默认取第一个字段作为超链接 --\x3e\r\n                \x3c!-- <ng-template #linkTemp> --\x3e\r\n                \x3c!-- <div class="farris-group-wrap"> --\x3e\r\n                \x3c!-- 非布尔值链接在value上 --\x3e\r\n                \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType!=dateType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    {{field | billTrackerFieldLabel}}\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="f-component-text">\r\n                                    <span class="f-form-control-text" title="{{field.fieldValue}}">\r\n                                        <a href="javascript:void(0);" (click)="clickLink()">{{field.fieldValue}}</a>\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n\r\n                \x3c!-- 布尔值链接在label上 --\x3e\r\n                \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType==dateType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    <a href="javascript:void(0);" (click)="clickLink()">\r\n                                        {{field | billTrackerFieldLabel}}\r\n                                    </a>\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="farris-input-wrap">\r\n                                    <div class="custom-control custom-checkbox">\r\n                                        <input class="custom-control-input" type="checkbox" readonly\r\n                                            [checked]="field.fieldValue" />\r\n                                        <label class="custom-control-label"></label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n                \x3c!-- </div> --\x3e\r\n                \x3c!-- </ng-template> --\x3e\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n</farris-section>\r\n<lib-bill-tracker-child-info-list [childSchemaTables]="childSchemaTables" [childDataTableMap]="childDataTableMap"\r\n    [billInfo]="billInfo">\r\n</lib-bill-tracker-child-info-list>'}]}],lF.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},lF.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],billDataInfo:[{type:core$1.Input,args:["billDataInfo"]}]},lF);function lF(e,t,r,o,n,i,a,l,s,c,p,d){this.framework=e,this.dataInfoService=t,this.notify=r,this.messager=o,this.loading=n,this.modal=i,this.localePipe=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.localeId=d,this.fieldsWithValue=[],this.childSchemaTables=[],this.childDataTableMap={},this.dateType=commonApi$1.DataType,this.secTitle="",this.localeId=d||this.inj.get(core$1.LOCALE_ID);var u=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=u.get(BillTrackerInternalUiService,null)}var BillTrackerDataComponent=(BF.prototype.ngOnInit=function(){},BF.prototype.ngAfterViewInit=function(){},BF.prototype.clearDataRegion=function(){this.dataRegion.clear()},BF.prototype.showDataGrid=function(e,t,r,o){var n=new commonApi.BillTrackingSettings;t&&t.billTrackingSettings&&n.LoadFromJson(t.billTrackingSettings),n.billTrackingDataShownMode==commonApi.BillTrackingDataShownMode.CUSTOMFORM?this.showCustomForm(e,t,r):this.showGeneralForm(e,t,r,o)},BF.prototype.showGeneralForm=function(e,t,r,o,n){var i,a=this;null!=o?this.createDataComp(o,t,r):(i=this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.getEntityData(e).subscribe(function(e){a.createDataComp(e,t,r),i.close()},function(e){throw i.close(),a.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},BF.prototype.showCustomForm=function(r,e,t){var o=this,n=new commonApi.BillTrackingSettings;e&&e.billTrackingSettings&&n.LoadFromJson(e.billTrackingSettings);var i=JSON.parse(n.customFormContent);(i.form.endsWith(".js")?rxjs.from(System["import"](i.form.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(i.form))).subscribe(function(e){var t=e.create(o.inj).instance.createDataShownComponent(o.inj,r);t instanceof core$1.ComponentRef&&(t=rxjs.of(t)),t.subscribe(function(e){o.dataRegion.element.nativeElement.parentElement.scrollTo({left:0}),o.dataRegion.clear(),o.dataRegion.insert(e.hostView)})})},BF.prototype.createDataComp=function(e,t,r){this.dataInfoService.isNewBTS(t.billTrackingSettings);try{this.createNewDataComp(e,t,r)}catch(a){var o=this.dataRegion.element.nativeElement.parentElement;o&&o.scrollTo({left:0}),this.dataRegion.clear();var n=this.cfr.resolveComponentFactory(BasicTableComponent),i=this.dataRegion.createComponent(n);i.instance.billInfo=t,i.instance.isMain=!0,i.instance.showMainTable(e),this.dataRegion.insert(i.hostView)}},BF.prototype.createNewDataComp=function(e,t,r){var o=this.dataRegion.element.nativeElement.parentElement;o&&o.scrollTo({left:0}),this.dataRegion.clear();var n=this.cfr.resolveComponentFactory(BasicInfoComponent),i=this.dataRegion.createComponent(n);i.instance.schemaTable=e.billSchema.mainTable,i.instance.dataTable=e.billData.mainTable,i.instance.billInfo=t,i.instance.billDataInfo=r,this.dataRegion.insert(i.hostView)},BF.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-data",template:'<div style="">\r\n    <ng-container #dataRegion></ng-container>\r\n</div>',styles:[""]}]}],BF.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},BF.propDecorators={dataRegion:[{type:core$1.ViewChild,args:["dataRegion",{read:core$1.ViewContainerRef}]}]},BF);function BF(e,t,r,o,n,i,a,l,s,c){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataService=n,this.inj=i,this.cfr=a,this.cdf=l,this.loader=s,this.dataInfoService=new BillTrackerDataInfoService,this.localeId=c||this.inj.get(core$1.LOCALE_ID,null)||"zh-CHS",this.localePipe=new BillTrackerLocalePipe(c)}var ChildRowTableDirective=(Object.defineProperty(CG.prototype,"expanded",{get:function(){return this._expanded},set:function(e){(this._expanded=e)?this.showChildTable():this.clearChildTable()},enumerable:!0,configurable:!0}),CG.prototype.showChildTable=function(){var e,t;if(null!=this.parentRow){this.clearChildTable();var r=this.cfr.resolveComponentFactory(BasicTableComponent);try{for(var o=__values(this.parentRow.GetChildTableList()),n=o.next();!n.done;n=o.next()){var i=n.value,a=this.vcRef.createComponent(r);a.instance.billInfo=this.billInfo,a.instance.isMain=!1,a.instance.showTable(this.parentSchemaTable.GetChildTableMap()[i.tableName],i),this.vcRef.insert(a.hostView)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}this.cdr.markForCheck()}},CG.prototype.clearChildTable=function(){this.vcRef.clear()},CG.decorators=[{type:core$1.Directive,args:[{selector:"[appChildRowTable]"}]}],CG.ctorParameters=function(){return[{type:core$1.ComponentFactoryResolver},{type:core$1.ViewContainerRef},{type:core$1.ChangeDetectorRef}]},CG.propDecorators={billInfo:[{type:core$1.Input,args:["billInfo"]}],colspan:[{type:core$1.Input,args:["colspan"]}],parentRow:[{type:core$1.Input,args:["parentRow"]}],parentSchemaTable:[{type:core$1.Input,args:["parentSchemaTable"]}],parentDataTable:[{type:core$1.Input,args:["parentDataTable"]}],expanded:[{type:core$1.Input,args:["expanded"]}],hasChildren:[{type:core$1.Output,args:["hasChildren"]}]},CG);function CG(e,t,r){this.cfr=e,this.vcRef=t,this.cdr=r,this.hasChildren=new core$1.EventEmitter}var ChildInfoListComponent=(QG.prototype.ngOnInit=function(){},QG.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info-list",template:'<ng-container *ngFor="let childTable of childSchemaTables">\r\n    <lib-bill-tracker-child-info [schemaTable]="childTable" [dataTable]="childDataTableMap[childTable.tableName]"\r\n        [billInfo]="billInfo">\r\n    </lib-bill-tracker-child-info>\r\n</ng-container>'}]}],QG.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},QG.propDecorators={childSchemaTables:[{type:core$1.Input,args:["childSchemaTables"]}],childDataTableMap:[{type:core$1.Input,args:["childDataTableMap"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}]},QG);function QG(e,t,r,o,n,i,a,l,s,c){this.dataInfoService=e,this.notify=t,this.messager=r,this.loading=o,this.modal=n,this.localePipe=i,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c}var ChildInfoComponent=(_G.prototype.ngOnInit=function(){var o=this;this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId);var e=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings);var t=e.customFieldContent,r=t&&("object"==typeof t?t:JSON.parse(t)),n=(n=r&&r.schema&&r.schema[this.schemaTable.tableName]&&r.schema[this.schemaTable.tableName].fields)||[],i=e.billTrackingDataShownMode===commonApi.BillTrackingDataShownMode.CUSTOMFIELD,a=this.schemaTable.getFieldList(),l=(l=this.dataInfoService.extractFFields(a,n,i)).filter(function(e){return e.show});l=this.dataInfoService.sortFieldsByOrder(l),this.dgCols=[],l.forEach(function(e){var t={field:e.fieldPath||e.fieldName,title:o.dataInfoService.getFieldLabel(e,o.localeId),width:120};e.dataType==commonApi$1.DataType.Boolean&&(t.formatter=function(e,t,r){return 1==e?o.localePipe.transform("yes"):0==e?o.localePipe.transform("no"):"-"}),o.dgCols.push(t)});var s=this.dataTable.GetRowList();this.dgData=__spread(this.dataInfoService.extractDataRows(s,l,a,this.dgIdField)),0<this.dgData.length&&setTimeout(function(){o.dg&&o.dg.selectRow(o.dgData[0][o.dgIdField])},500)},_G.prototype.selectChanged=function(e){var t=this.dataTable.GetRowMap()[e.id];this.showDetail=this.dataInfoService.hasChildData(t,this.billInfo),this.cdr.detectChanges()},_G.prototype.viewChildData=function(){var e,t,r,o;null!=this.dg.selectedRow?(e=this.dataTable.GetRowMap()[this.dg.selectedRow.id],this.dataInfoService.hasChildData(e,this.billInfo)?(t=this.cfr.resolveComponentFactory(ChildInfoListComponent).create(this.inj,[]),r=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),t.instance.childSchemaTables=r,t.instance.childDataTableMap=e.GetChildTableMap(),t.instance.billInfo=this.billInfo,o=this.modal.show(t,{title:this.localePipe.transform("childData"),width:900,height:600,showButtons:!1}),t.instance.bsModalRef=o):this.notify.info(this.localePipe.transform("noChildData"))):this.notify.warning(this.localePipe.transform("selectOneFirst"))},_G.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info",template:'<div class="f-struct-wrapper" *ngIf="dgCols&&dgCols.length>0&&dgData&&dgData.length>0">\r\n    <farris-section class="f-section-tabs f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n        <ng-template farrisSectionToolbar [toolbarCls]="\'section-test-toolbar\'">\r\n            <button class="btn btn-secondary f-btn-ml" *ngIf="showDetail" (click)="viewChildData()">\r\n                {{ "childData" | billTrackerLocale}}\r\n            </button>\r\n        </ng-template>\r\n        <div class="">\r\n            <div class="f-utils-fill">\r\n                <farris-datagrid #dg [data]="dgData" [idField]="dgIdField" [fields]="dgCols" [showLineNumber]="true"\r\n                    [striped]="true" [virtualized]="false" [pagination]="false" [virtualizedAsyncLoad]="false"\r\n                    [multiSelect]="false" [fit]="true" [showCheckbox]="false" [showAllCheckbox]="false"\r\n                    [lineNumberTitle]="dgLineNumberTitle" [mergeCell]="false" [showBorder]="true"\r\n                    [checkOnSelect]="false" [selectOnCheck]="false" [nowrap]="true" [autoFitColumns]="true"\r\n                    [fitColumns]="true" [autoHeight]="false" (selectChanged)="selectChanged($event)">\r\n                </farris-datagrid>\r\n            </div>\r\n        </div>\r\n    </farris-section>\r\n</div>'}]}],_G.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataInfoService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},_G.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],dg:[{type:core$1.ViewChild,args:["dg"]}]},_G);function _G(e,t,r,o,n,i,a,l,s,c,p){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataInfoService=n,this.localePipe=i,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c,this.localeId=p,this.secTitle=null,this.showDetail=!1,this.dgCols=[],this.dgData=[],this.dgLineNumberTitle=this.localePipe.transform("lineNumber"),this.dgIdField="bifDgId0d63",this.localeId=p||this.inj.get(core$1.LOCALE_ID)}var BillTrackerFieldLabelPipe=(HH.prototype.transform=function(e,t){return this.dataInfoService.getFieldLabel(e,t||this.localeId)},HH.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerFieldLabel"}]}],HH.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},HH);function HH(e,t){this.dataInfoService=e,this.localeId=t}var ɵ0$1=localStorage.getItem("languageCode")||"zh-CHS",ɵ1$1={},BillTrackerModule=(MH.forRoot=function(e){return{ngModule:MH,providers:[{provide:BillTrackerModuleConfig,useValue:e||{}}]}},MH.decorators=[{type:core$1.NgModule,args:[{declarations:[BillTrackerComponent,BillTrackerGraphComponent,BillTrackerDataComponent,BasicTableComponent,ChildRowTableDirective,BillTrackerLocalePipe,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent,BillTrackerFieldLabelPipe],imports:[common.CommonModule,http.HttpClientModule,forms.FormsModule,uiDraggable.AngularDraggableModule,uiMessager.MessagerModule.forRoot(),uiLoading.LoadingModule.forRoot(),uiNotify.NotifyModule,uiText.TextModule,uiSection.FarrisSectionModule,uiDatagrid.DatagridModule.forRoot(),uiDialog.FarrisDialogModule],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0$1},{provide:BillTrackerModuleConfig,useValue:ɵ1$1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},cafCommon.CacheService,cafCommon.SessionService,cafCommon.HttpService,rtfCommon.FrmEventBus,rtfCommon.FuncsService,rtfCommon.LoadingService,rtfCommon.AppService,rtfCommon.FrameworkService,BillTrackerDataService,BillTrackerUiService,BillTrackerInternalUiService,BillTrackerLocalePipe,BillTrackerDataInfoService],bootstrap:[BillTrackerComponent],exports:[BillTrackerComponent,BillTrackerDataComponent],entryComponents:[BillTrackerComponent,BillTrackerDataComponent,BasicTableComponent,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent]}]}],MH);function MH(){}var BifBillTrackerWebCmpService=(OH.prototype.openDialog=function(e,t,r,o,n){e="string"==typeof e&&canJSONParse(e)?JSON.parse(e):e,t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n;var i=new GetBillsInfoArgs;return"string"==typeof e?i.billDataId=e:i.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerDialog(i,t,r,o,n)},OH.prototype.openApp=function(e,t,r){e="string"==typeof e&&canJSONParse(e)?JSON.parse(e):e,t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r;var o=new GetBillsInfoArgs;"string"==typeof e?o.billDataId=e:o.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerApp(o,t,r)},OH.decorators=[{type:core$1.Injectable}],OH.ctorParameters=function(){return[{type:BillTrackerUiService},{type:devkit.BindingData,decorators:[{type:core$1.Optional}]},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},OH);function OH(e,t,r,o){this.trackerUiService=e,this.bindingData=t,this.viewModel=r,this.frameContext=o}var BifManualCreationDataWebCmpService=(bI.prototype.getSlimBillCreationProcessEntityExById=function(e){return this.dataService.getSlimBillCreationProcessEntityExById(e)},bI.prototype.getFormSettingsById=function(e){return this.dataService.getFormSettingsById(e)},bI.prototype.executeBillCreationProcess=function(e,t,r,o,n){if(null==e)throw"entities is null.";e instanceof Map&&(e=Array.from(e.values())),e=Array.isArray(e)?e:[e];var i=new FormBillCreationProcessExecutorArgs;return i.billCreationProcessId=t,i.creationRuleId=r,i.sourceVoEntityDatas=e.map(function(e){return JSON.stringify(e.toJSON(!1,!0))}),i.targetVoDataIds=o,i.manualCreationMode=n,this.dataService.executeBillCreationProcess(i)},bI.prototype.createEntityDatas=function(e,t){var r=new runtimeApi.FormCreateArgs;return r.formVoId=e,r.rpcCreationRuleExecutorResult=t.creationRuleExecutorResult.ConvertToJson(),this.dataService.createEntityDatas(r)},bI.prototype.updateEntityDatas=function(e){var t=new runtimeApi.FormUpdateArgs;return 1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),this.dataService.updateEntityDatas(t)):rxjs.throwError("creationRuleExecutorResult is empty!"):rxjs.throwError("conditionExecutionResult is false!")},bI.prototype.pushTaskCenter=function(e){var t=new PushTaskArgs;return 1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?e.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER?(t.suCode=e.downBillSuCode,t.creationRuleExecutorResult=e.creationRuleExecutorResult,this.dataService.pushTaskCenter(t)):rxjs.throwError("creationRuleExecutorResult can't be pushed to task center!"):rxjs.throwError("creationRuleExecutorResult is empty!"):rxjs.throwError("conditionExecutionResult is false!")},bI.prototype.getCreationResultById=function(e){return this.dataService.getCreationResultById(e)},bI.prototype.addFormBillCreationProcessExecutorResult=function(e){if(null==e)throw"参数creationResult不可为空";if("string"==typeof e){if(""==e)throw"参数creationResult不可为空";var t=new runtimeApi.FormBillCreationProcessExecutorResult;t.LoadFromJson(e),e=t}var r;return e instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((r=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(e),e=r),this.dataService.addFormBillCreationProcessExecutorResult(e)},bI.prototype.getEntityDatas=function(e,t,r){if(null==e)throw"参数dataId不可为空";if(null==t)throw"参数voId不可为空";if(null==r)throw"参数suCode不可为空";var o=new GetEntityDatasArgs;return o.dataId=e,o.suCode=r,o.voId=t,this.dataService.getEntityDatas(o)},bI.decorators=[{type:core$1.Injectable}],bI.ctorParameters=function(){return[{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},bI);function bI(e,t,r,o,n){this.dataService=e,this.bindingData=t,this.messagerService=r,this.viewModel=o,this.frameContext=n}var BifManualCreationSourceWebCmpService=(FI.prototype.pushBySourceVoId=function(e,o,n,t,r,i,a,l){var s=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],null!=n&&""!=n||(n="rootviewmodelbifLoad1"),t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,i=""===i||null==i?undefined:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,this.sourceUiService.openBillCreationProcessSelector4Push(e,t,r,i,a).subscribe(function(t){s.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.Push,s.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?s.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){s.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:n},l))}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,s.dataService.pushTaskCenter(e).subscribe(function(){s.messagerService.success(s.localePipe.transform("pushTaskCenterSuccess"))},function(e){s.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||s.localePipe.transform("pushTaskCenterFailed"))})):s.messagerService.error(s.localePipe.transform("creationResultEmpty")):s.messagerService.error(t.conditionResult.message||s.localePipe.transform("creationExecutionError"))},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})})})},FI.prototype.pushBySourceVoIdAndTargetVoId=function(e,t,o,n,r,i,a,l,s){var c=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],null!=n&&""!=n||(n="rootviewmodelbifLoad1"),r=""===r||null==r?undefined:r,i=""===i||null==i?undefined:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s,this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,r,i,a,l).subscribe(function(t){c.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.SpecificPush,c.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?c.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){c.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:n},s))}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,c.dataService.pushTaskCenter(e).subscribe(function(){c.messagerService.success(c.localePipe.transform("pushTaskCenterSuccess"))},function(e){c.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||c.localePipe.transform("pushTaskCenterFailed"))})):c.messagerService.error(c.localePipe.transform("creationResultEmpty")):c.messagerService.error(t.conditionResult.message||c.localePipe.transform("creationExecutionError"))},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})})})},FI.prototype.pushByCreationProcessId=function(e,o,n,i){var a=this;if(null==o)throw"entities is null.";o instanceof Map&&(o=Array.from(o.values())),o=Array.isArray(o)?o:[o],i=""===i||null==i?undefined:i,null!=n&&""!=n||(n="rootviewmodelbifLoad1"),this.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(t){a.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=o.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.SpecificPush,a.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?a.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){a.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:n},i))}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,a.dataService.pushTaskCenter(e).subscribe(function(){a.messagerService.success(a.localePipe.transform("pushTaskCenterSuccess"))},function(e){a.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||a.localePipe.transform("pushTaskCenterFailed"))})):a.messagerService.error(a.localePipe.transform("creationResultEmpty")):a.messagerService.error(t.conditionResult.message||a.localePipe.transform("creationExecutionError"))},function(e){a.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})})})},FI.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,n){return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,this.sourceUiService.openBillCreationProcessSelector4Push(e,t,r,o,n)},FI.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,n,i){return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,r,o,n,i)},FI.prototype.openTargetForm=function(e,t,r,o){null!=r&&""!=r||(r="rootviewmodelbifLoad1"),this.sourceUiService.openTargetForm(e,t,__assign({action:r},o))},FI.prototype.openTargetApp=function(e,t,r,o,n){null!=o&&""!=o||(o="rootviewmodelbifLoad1"),this.sourceUiService.openTargetApp(e,t,r,__assign({action:o},n))},FI.decorators=[{type:core$1.Injectable}],FI.ctorParameters=function(){return[{type:BifSourceUiService},{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},FI);function FI(e,t,r,o,n,i){this.sourceUiService=e,this.dataService=t,this.bindingData=r,this.messagerService=o,this.viewModel=n,this.frameContext=i,this.localePipe=new LocalePipe(this.sourceUiService&&this.sourceUiService.localeId||"zh-CHS")}var BifManualCreationTargetWebCmpService=(hK.prototype.bifLoad=function(e){var t=this,r=new runtimeApi.FormCreateArgs;r.formVoId=e,this.targetUiService.getCreationResult().subscribe(function(e){r.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),t.dataService.createEntityDatas(r).subscribe(function(e){t.stateMachineService.transit("Create")},function(e){t.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})})},hK.prototype.referByTargetVoId=function(e,o,t,r,n,i,a,l){var s=this;t=""===t||null==t?undefined:t,o=""===o||null==o?[this.bindingData.getObject().id]:o,r=""===r||null==r?undefined:r,n=""===n||null==n?undefined:n,i=""===i||null==i?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,this.cardDataService.update().subscribe(function(){s.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,n,a).subscribe(function(r){s.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){s.targetUiService.openSourceDataSelector4Pull(e,i,l).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.Pull,s.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),s.dataService.updateEntityDatas(t).subscribe(function(e){s.cardDataService.load(o[0]).subscribe()},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):s.messagerService.error(s.localePipe.transform("creationResultEmpty")):s.messagerService.error(e.conditionResult.message||s.localePipe.transform("creationExecutionError"))})})})})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},hK.prototype.referBySourceVoIdAndTargetVoId=function(e,t,o,r,n,i,a,l,s){var c=this;r=""===r||null==r?undefined:r,o=""===o||null==o?[this.bindingData.getObject().id]:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,a=""===a||null==a?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s,this.cardDataService.update().subscribe(function(){c.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,n,i,l).subscribe(function(r){c.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){c.targetUiService.openSourceDataSelector4Pull(e,a,s).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.SpecificPull,c.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),c.dataService.updateEntityDatas(t).subscribe(function(e){c.cardDataService.load(o[0]).subscribe()},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):c.messagerService.error(c.localePipe.transform("creationResultEmpty")):c.messagerService.error(e.conditionResult.message||c.localePipe.transform("creationExecutionError"))})})})})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},hK.prototype.referByCreationProcessId=function(e,o,t,n){var i=this;o=""===o||null==o?[this.bindingData.getObject().id]:o,t=""===t||null==t?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:t,n=""===n||null==n?undefined:n,this.cardDataService.update().subscribe(function(){i.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(r){i.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){i.targetUiService.openSourceDataSelector4Pull(e,t,n).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=e.map(function(e){return e instanceof devkit.Entity||"BindingObject"!=e.__type__?JSON.stringify(e.toJSON(!1,!0)):JSON.stringify(e.toJSON({useFullMultiLangProperty:!0}))}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.SpecificPull,i.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),i.dataService.updateEntityDatas(t).subscribe(function(e){i.cardDataService.load(o[0]).subscribe()},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):i.messagerService.error(i.localePipe.transform("creationResultEmpty")):i.messagerService.error(e.conditionResult.message||i.localePipe.transform("creationExecutionError"))})})})})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},hK.prototype.getFormBillCreationProcessExecutorResult=function(){return this.targetUiService.getFormBillCreationProcessExecutorResult()},hK.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,n){return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,this.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,o,n)},hK.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,n,i){return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,this.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,o,n,i)},hK.prototype.openSourceDataSelector4Pull=function(e,t,r){return t=""===t||null==t?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:t,r=""===r||null==r?undefined:r,this.targetUiService.openSourceDataSelector4Pull(e,t,r)},hK.prototype.getCreationResult=function(){return this.targetUiService.getCreationResult()},hK.decorators=[{type:core$1.Injectable}],hK.ctorParameters=function(){return[{type:BifDataService},{type:BifTargetUiService},{type:commandServices.StateMachineService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:commandServices.CardDataService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},hK);function hK(e,t,r,o,n,i,a,l){this.dataService=e,this.targetUiService=t,this.stateMachineService=r,this.bindingData=o,this.messagerService=n,this.cardDataService=i,this.viewModel=a,this.frameContext=l,this.localePipe=new LocalePipe(this.targetUiService&&this.targetUiService.localeId||"zh-CHS")}var BIF_MANUAL_CREATION_PROVIDERS=[BifDataService,BifSourceUiService,BifTargetUiService,BifManualCreationDataWebCmpService,BifManualCreationSourceWebCmpService,BifManualCreationTargetWebCmpService],BIF_BILL_TRACKER_PROVIDERS=[BillTrackerUiService,BifBillTrackerWebCmpService],BIF_DEVKIT_PROVIDERS=__spread(BIF_MANUAL_CREATION_PROVIDERS,BIF_BILL_TRACKER_PROVIDERS),BifBillTrackerWebCmpModule=(QL.decorators=[{type:core$1.NgModule,args:[{providers:BIF_BILL_TRACKER_PROVIDERS}]}],QL);function QL(){}var BifManualCreationWebCmpModule=(RL.decorators=[{type:core$1.NgModule,args:[{providers:BIF_MANUAL_CREATION_PROVIDERS}]}],RL);function RL(){}exports.FormBillCreationProcessExecutorResult=runtimeApi.FormBillCreationProcessExecutorResult,exports.FormCreationRuleExecutorArgs=runtimeApi.FormCreationRuleExecutorArgs,exports.FormCreateArgs=runtimeApi.FormCreateArgs,exports.FormCreateResult=runtimeApi.FormCreateResult,exports.FormUpdateArgs=runtimeApi.FormUpdateArgs,exports.FormUpdateResult=runtimeApi.FormUpdateResult,exports.RpcCreationRuleExecutorResult=runtimeApi.RpcCreationRuleExecutorResult,exports.RpcCreationMappingResult=runtimeApi.RpcCreationMappingResult,exports.MappingAssociation=runtimeApi.MappingAssociation,exports.RpcMappingResult=runtimeApi.RpcMappingResult,exports.BifDataService=BifDataService,exports.AbstractBifDataSelectorService=AbstractBifDataSelectorService,exports.DefaultBifDataSelectorService=DefaultBifDataSelectorService,exports.BifSourceUiService=BifSourceUiService,exports.BifTargetUiService=BifTargetUiService,exports.PushSelectorComponent=PushSelectorComponent,exports.PullSelectorComponent=PullSelectorComponent,exports.BifManualCreationModule=BifManualCreationModule,exports.BillTrackerArgs=BillTrackerArgs,exports.BillTrackerUiService=BillTrackerUiService,exports.BillTrackerComponent=BillTrackerComponent,exports.BillTrackerModule=BillTrackerModule,exports.BifBillTrackerWebCmpService=BifBillTrackerWebCmpService,exports.BifManualCreationDataWebCmpService=BifManualCreationDataWebCmpService,exports.BifManualCreationSourceWebCmpService=BifManualCreationSourceWebCmpService,exports.BifManualCreationTargetWebCmpService=BifManualCreationTargetWebCmpService,exports.BifBillTrackerWebCmpModule=BifBillTrackerWebCmpModule,exports.BifManualCreationWebCmpModule=BifManualCreationWebCmpModule,exports.mxDefaultKeyHandler=mxDefaultKeyHandlerType,exports.mxDefaultPopupMenu=mxDefaultPopupMenuType,exports.mxDefaultToolbar=mxDefaultToolbarType,exports.mxEditor=mxEditorType,exports.mxCellHighlight=mxCellHighlightType,exports.mxCellMarker=mxCellMarkerType,exports.mxCellTracker=mxCellTrackerType,exports.mxConnectionHandler=mxConnectionHandlerType,exports.mxConstraintHandler=mxConstraintHandlerType,exports.mxEdgeHandler=mxEdgeHandlerType,exports.mxEdgeSegmentHandler=mxEdgeSegmentHandlerType,exports.mxElbowEdgeHandler=mxElbowEdgeHandlerType,exports.mxGraphHandler=mxGraphHandlerType,exports.mxHandle=mxHandleType,exports.mxKeyHandler=mxKeyHandlerType,exports.mxPanningHandler=mxPanningHandlerType,exports.mxPopupMenuHandler=mxPopupMenuHandlerType,exports.mxRubberband=mxRubberbandType,exports.mxSelectionCellsHandler=mxSelectionCellsHandlerType,exports.mxTooltipHandler=mxTooltipHandlerType,exports.mxVertexHandler=mxVertexHandlerType,exports.mxCellCodec=mxCellCodecType,exports.mxChildChangeCodec=mxChildChangeCodecType,exports.mxDefaultKeyHandlerCodec=mxDefaultKeyHandlerCodecType,exports.mxDefaultPopupMenuCodec=mxDefaultPopupMenuCodecType,exports.mxDefaultToolbarCodec=mxDefaultToolbarCodecType,exports.mxEditorCodec=mxEditorCodecType,exports.mxGenericChangeCodec=mxGenericChangeCodecType,exports.mxGraphCodec=mxGraphCodecType,exports.mxGraphViewCodec=mxGraphViewCodecType,exports.mxModelCodec=mxModelCodecType,exports.mxObjectCodec=mxObjectCodecType,exports.mxRootChangeCodec=mxRootChangeCodecType,exports.mxStylesheetCodec=mxStylesheetCodecType,exports.mxTerminalChangeCodec=mxTerminalChangeCodecType,exports.mxCircleLayout=mxCircleLayoutType,exports.mxCompactTreeLayout=mxCompactTreeLayoutType,exports.mxCompositeLayout=mxCompositeLayoutType,exports.mxEdgeLabelLayout=mxEdgeLabelLayoutType,exports.mxFastOrganicLayout=mxFastOrganicLayoutType,exports.mxGraphLayout=mxGraphLayoutType,exports.mxParallelEdgeLayout=mxParallelEdgeLayoutType,exports.mxPartitionLayout=mxPartitionLayoutType,exports.mxRadialTreeLayout=mxRadialTreeLayoutType,exports.mxStackLayout=mxStackLayoutType,exports.mxHierarchicalLayout=mxHierarchicalLayoutType,exports.mxSwimlaneLayout=mxSwimlaneLayoutType,exports.mxGraphAbstractHierarchyCell=mxGraphAbstractHierarchyCellType,exports.mxGraphHierarchyEdge=mxGraphHierarchyEdgeType,exports.mxGraphHierarchyModel=mxGraphHierarchyModelType,exports.mxGraphHierarchyNode=mxGraphHierarchyNodeType,exports.mxSwimlaneModel=mxSwimlaneModelType,exports.mxCoordinateAssignment=mxCoordinateAssignmentType,exports.mxHierarchicalLayoutStage=mxHierarchicalLayoutStageType,exports.mxMedianHybridCrossingReduction=mxMedianHybridCrossingReductionType,exports.mxMinimumCycleRemover=mxMinimumCycleRemoverType,exports.mxSwimlaneOrdering=mxSwimlaneOrderingType,exports.mxCell=mxCellType,exports.mxCellPath=mxCellPathType,exports.mxGeometry=mxGeometryType,exports.mxGraphModel=mxGraphModelType,exports.renderingHint=renderingHintType,exports.mxActor=mxActorType,exports.mxArrow=mxArrowType,exports.mxArrowConnector=mxArrowConnectorType,exports.mxCloud=mxCloudType,exports.mxConnector=mxConnectorType,exports.mxCylinder=mxCylinderType,exports.mxDoubleEllipse=mxDoubleEllipseType,exports.mxEllipse=mxEllipseType,exports.mxHexagon=mxHexagonType,exports.mxImageShape=mxImageShapeType,exports.mxLabel=mxLabelType,exports.mxLine=mxLineType,exports.mxMarker=mxMarkerType,exports.mxPolyline=mxPolylineType,exports.mxRectangleShape=mxRectangleShapeType,exports.mxRhombus=mxRhombusType,exports.mxShape=mxShapeType,exports.mxStencil=mxStencilType,exports.mxStencilRegistry=mxStencilRegistryType,exports.mxSwimlane=mxSwimlaneType,exports.mxText=mxTextType,exports.mxTriangle=mxTriangleType,exports.mxAbstractCanvas2D=mxAbstractCanvas2DType,exports.mxAnimation=mxAnimationType,exports.mxAutoSaveManager=mxAutoSaveManagerType,exports.mxClipboard=mxClipboardType,exports.mxConstants=mxConstantsType,exports.mxDictionary=mxDictionaryType,exports.mxDivResizer=mxDivResizerType,exports.mxDragSource=mxDragSourceType,exports.mxEffects=mxEffectsType,exports.mxEvent=mxEventType,exports.mxEventObject=mxEventObjectType,exports.mxEventSource=mxEventSourceType,exports.mxForm=mxFormType,exports.mxGuide=mxGuideType,exports.mxImage=mxImageType,exports.mxImageBundle=mxImageBundleType,exports.mxImageExport=mxImageExportType,exports.mxLog=mxLogType,exports.mxMorphing=mxMorphingType,exports.mxMouseEvent=mxMouseEventType,exports.mxObjectIdentity=mxObjectIdentityType,exports.mxPanningManager=mxPanningManagerType,exports.mxPoint=mxPointType,exports.mxPopupMenu=mxPopupMenuType,exports.mxRectangle=mxRectangleType,exports.mxResources=mxResourcesType,exports.mxSvgCanvas2D=mxSvgCanvas2DType,exports.mxToolbar=mxToolbarType,exports.mxUndoableEdit=mxUndoableEditType,exports.mxUndoManager=mxUndoManagerType,exports.mxUrlConverter=mxUrlConverterType,exports.mxUtils=mxUtilsType,exports.mxVmlCanvas2D=mxVmlCanvas2DType,exports.mxWindow=mxWindowType,exports.mxXmlCanvas2D=mxXmlCanvas2DType,exports.mxXmlRequest=mxXmlRequestType,exports.mxCellEditor=mxCellEditorType,exports.mxCellOverlay=mxCellOverlayType,exports.mxCellRenderer=mxCellRendererType,exports.mxCellState=mxCellStateType,exports.mxCellStatePreview=mxCellStatePreviewType,exports.mxConnectionConstraint=mxConnectionConstraintType,exports.mxEdgeStyle=mxEdgeStyleType,exports.mxGraph=mxGraphType,exports.mxGraphSelectionModel=mxGraphSelectionModelType,exports.mxGraphView=mxGraphViewType,exports.mxLayoutManager=mxLayoutManagerType,exports.mxMultiplicity=mxMultiplicityType,exports.mxOutline=mxOutlineType,exports.mxPerimeter=mxPerimeterType,exports.mxPrintPreview=mxPrintPreviewType,exports.mxStyleRegistry=mxStyleRegistryType,exports.mxStylesheet=mxStylesheetType,exports.mxSwimlaneManager=mxSwimlaneManagerType,exports.mxTemporaryCellStates=mxTemporaryCellStatesType,exports.mxClient=mxClientType,exports.mxgraph=mxgraph,exports.BillData=BillData,exports.FormBillCreationProcessExecutorArgs=FormBillCreationProcessExecutorArgs,exports.FormGetBillCreationProcessEntityExArgs=FormGetBillCreationProcessEntityExArgs,exports.FormGetBillCreationProcessEntityExResult=FormGetBillCreationProcessEntityExResult,exports.ManualCreationMode=ManualCreationMode,exports.GeneralTextIdWithDataId=GeneralTextIdWithDataId,exports.BillDataInfo=BillDataInfo,exports.BillInfo=BillInfo,exports.CanTrackingInfo=CanTrackingInfo,exports.DownBillInfo=DownBillInfo,exports.GetBillsInfoArgs=GetBillsInfoArgs,exports.GetDownBillsInfoArgs=GetDownBillsInfoArgs,exports.GetUpBillsInfoArgs=GetUpBillsInfoArgs,exports.TrackingHelper=TrackingHelper,exports.TrackingMappingAssociation=TrackingMappingAssociation,exports.UpBillInfo=UpBillInfo,exports.BillChildInfo=BillChildInfo,exports.BillDetailInfo=BillDetailInfo,exports.BillItemInfo=BillItemInfo,exports.FieldsWithOrder=FieldsWithOrder,exports.SummaryFieldsInfo=SummaryFieldsInfo,exports.FieldNameAndValue=FieldNameAndValue,exports.DateTypeFormatInfo=DateTypeFormatInfo,exports.DecimalTypeFormatInfo=DecimalTypeFormatInfo,exports.TypeToFormat=TypeToFormat$1,exports.ScaleMode=ScaleMode,exports.ExpressionJointQueryParameterContent=ExpressionJointQueryParameterContent,exports.FieldJointQueryParameterContent=FieldJointQueryParameterContent,exports.JointQueryParameterContent=JointQueryParameterContent,exports.JointQueryParameterMode=JointQueryParameterMode,exports.JointQueryParameterResult=JointQueryParameterResult,exports.JointQueryParametersContent=JointQueryParametersContent,exports.SimpleValueMappingInfo=SimpleValueMappingInfo,exports.StringDisplayMode=StringDisplayMode,exports.StringTypeFormatInfo=StringTypeFormatInfo,exports.BIF_UISTATE_KEY_CREATION_RESULT=BIF_UISTATE_KEY_CREATION_RESULT,exports.BIF_UISTATE_KEY_OPEN_TYPE=BIF_UISTATE_KEY_OPEN_TYPE,exports.ModuleConfig=ModuleConfig,exports.SELECTOR_ARGS_INJECTOR=SELECTOR_ARGS_INJECTOR,exports.DEFAULT_SELECTOR_ARGS=DEFAULT_SELECTOR_ARGS,exports.PushTaskArgs=PushTaskArgs,exports.GetEntityDatasArgs=GetEntityDatasArgs,exports.CanTrackingResult=CanTrackingResult,exports.GetChildrenEntityDataArgs=GetChildrenEntityDataArgs,exports.DownBillInfoResult=DownBillInfoResult,exports.EntityDataResult=EntityDataResult,exports.GetEntityDataArgs=GetEntityDataArgs,exports.GetMainEntityDataArgs=GetMainEntityDataArgs,exports.UpBillInfoResult=UpBillInfoResult,exports.GetJointQueryParametersArgs=GetJointQueryParametersArgs,exports.BillTrackerConstant=BillTrackerConstant,exports.BillTrackerModuleConfig=BillTrackerModuleConfig,exports.BillTrackerDirection=BillTrackerDirection,exports.BillTrackerGraphOptions=BillTrackerGraphOptions,exports.BillTrackerGridOptions=BillTrackerGridOptions,exports.Graph=Graph,exports.GraphView=GraphView,exports.BillNodeShape=BillNodeShape,exports.BillAssociationLine=BillAssociationLine,exports.CompactTreeLayout=CompactTreeLayout,exports.RevertCompactTreeLayout=RevertCompactTreeLayout,exports.VertexHandler=VertexHandler,exports.Events=Events,exports.BillCell=BillCell,exports.CellOverlay=CellOverlay,exports.CellOverlayState=CellOverlayState,exports.Outline=Outline,exports.Styles=Styles,exports.BIF_MANUAL_CREATION_PROVIDERS=BIF_MANUAL_CREATION_PROVIDERS,exports.BIF_BILL_TRACKER_PROVIDERS=BIF_BILL_TRACKER_PROVIDERS,exports.BIF_DEVKIT_PROVIDERS=BIF_DEVKIT_PROVIDERS,exports.ɵe=ModuleConfig,exports.ɵd=SELECTOR_ARGS_INJECTOR,exports.ɵa=LocalePipe,exports.ɵb=AbstractUiService,exports.ɵl=BasicInfoComponent,exports.ɵi=BasicTableComponent,exports.ɵj=ChildRowTableDirective,exports.ɵh=BillTrackerDataComponent,exports.ɵg=BillTrackerGraphComponent,exports.ɵo=ChildInfoListComponent,exports.ɵn=ChildInfoComponent,exports.ɵq=BillTrackerModuleConfig,exports.ɵp=BillTrackerFieldLabelPipe,exports.ɵk=BillTrackerLocalePipe,exports.ɵm=BillTrackerDataInfoService,exports.ɵf=BillTrackerDataService,exports.ɵr=BillTrackerInternalUiService,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=edp-bif-runtime-api.umd.min.js.map