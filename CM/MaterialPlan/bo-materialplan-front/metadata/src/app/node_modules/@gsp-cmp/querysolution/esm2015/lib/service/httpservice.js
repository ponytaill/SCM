/**
 * @fileoverview added by tsickle
 * Generated from: lib/service/httpservice.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { QuerySolutionVoConvertor } from '@farris/component-querycondition';
export class HttpService {
    /**
     * @param {?} http
     */
    constructor(http) {
        this.http = http;
        this.histroyUrl = "/api/runtime/sys/v1.0/querysolution/previousQuery";
        this.url = '/api/runtime/sys/v1.0/querysolution';
    }
    /**
     * 新增查询方案
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    create(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.post(this.url, body, options);
    }
    /**
     * 根据表单ID查询当前表单当前登录用户的查询方案列表
     * @param {?} formId 表单ID
     * @param {?} sessionId
     * @return {?}
     */
    query(formId, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
        };
        /** @type {?} */
        let belongId = formId;
        // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/bybelongid/${belongId}`;
        /** @type {?} */
        let url = `${this.url}/belongId/${belongId}`;
        return this.http.get(url, options);
    }
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    update(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.put(this.url, body, options);
    }
    /**
         * 删除
         * @unused
         * @param idArray 删除的解决方案ID列表
         */
    // delete(idArray: Array<string>, sessionId: string) {
    //     if (!idArray || idArray.length <= 0) {
    //         return;
    //     }
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'application/json',
    //         'sessionid': sessionId
    //     });
    //     const options = {
    //         headers: headers,
    //         sessionid: sessionId
    //     };
    //     let ids = '';
    //     idArray.forEach(id => {
    //         ids = ids + "#" + id;
    //     });
    //     let url = `/api/dev/main/v1.0/querysolution/${encodeURIComponent(ids)}`;
    //     return this.http.delete(url, options);
    // }
    /**
     * 批量更新
     * @param {?} body
     * @param {?} sessionId
     * @return {?}
     */
    batchUpdate(body, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            'Content-Type': 'application/json',
            'sessionid': sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers,
            sessionid: sessionId
        };
        /** @type {?} */
        let url = `${this.url}/batch`;
        return this.http.put(url, body, options);
    }
    /**
         * 获取默认查询方案ID
         * @unused
         * @param formId
         */
    // getDefaultQuerySolution(formId: string, sessionId: string): Observable<any> {
    //     let headers = new HttpHeaders({
    //         'Content-Type': 'text/plain',
    //         'sessionid': sessionId
    //     });
    //     let belongId = formId;
    //     // let url = `http://localhost:5100/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     let url = `/api/dev/main/v1.0/querysolution/defaultSolution/bybelongid/${belongId}`;
    //     return this.http.get(url, { headers: headers, responseType: 'text' });
    // }
    /**
     * 是否支持
     * @return {?}
     */
    supportLS() {
        if (window.hasOwnProperty("localStorage")) {
            return true;
        }
        return false;
    }
    /**
     * 设置保存时候，属性从小写变成大写
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    setLS(key, value) {
        /** @type {?} */
        let conditionsStr = '[]';
        if (value) {
            if (typeof value == 'string') {
                conditionsStr = value;
            }
            else {
                /** @type {?} */
                const convertor = new QuerySolutionVoConvertor();
                conditionsStr = JSON.stringify(convertor.formatConvertJObject(value));
            }
        }
        if (key && this.supportLS) {
            localStorage.setItem(key, conditionsStr);
        }
    }
    /**
     * 获取时，属性从大写变成小写
     * @param {?} key
     * @return {?}
     */
    getLS(key) {
        /** @type {?} */
        let result = new Array();
        if (key && this.supportLS) {
            /** @type {?} */
            var v = localStorage.getItem(key);
            if (v != undefined || v !== null) {
                result = JSON.parse(v);
            }
        }
        if (result.length > 0) {
            /** @type {?} */
            const convertor = new QuerySolutionVoConvertor();
            return convertor.formatFromJobject(result);
        }
        return result;
    }
    /**
     * 更新
     * @param {?} querySolution 查询方案实体
     * @param {?} sessionId
     * @return {?}
     */
    saveHistroy(querySolution, sessionId) {
        /** @type {?} */
        let headers = new HttpHeaders({
            "Content-Type": "application/json",
            sessionid: sessionId
        });
        /** @type {?} */
        const options = {
            headers: headers
        };
        /** @type {?} */
        let convertor = new QuerySolutionVoConvertor();
        /** @type {?} */
        let body = convertor.convertJObject(querySolution);
        return this.http.put(this.histroyUrl, body, options);
    }
}
HttpService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
HttpService.ctorParameters = () => [
    { type: HttpClient }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.histroyUrl;
    /** @type {?} */
    HttpService.prototype.url;
    /**
     * @type {?}
     * @private
     */
    HttpService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cHNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLWNtcC9xdWVyeXNvbHV0aW9uLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvaHR0cHNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFL0QsT0FBTyxFQUFtQix3QkFBd0IsRUFBa0IsTUFBTSxrQ0FBa0MsQ0FBQztBQUc3RyxNQUFNLE9BQU8sV0FBVzs7OztJQUVwQixZQUFvQixJQUFnQjtRQUFoQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQzVCLGVBQVUsR0FBVyxtREFBbUQsQ0FBQztRQUNqRixRQUFHLEdBQVcscUNBQXFDLENBQUM7SUFGWixDQUFDOzs7Ozs7O0lBT3pDLE1BQU0sQ0FBQyxhQUE4QixFQUFFLFNBQWlCOztZQUNoRCxPQUFPLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDMUIsY0FBYyxFQUFFLGtCQUFrQjtZQUNsQyxXQUFXLEVBQUUsU0FBUztTQUN6QixDQUFDOztjQUNJLE9BQU8sR0FBRztZQUNaLE9BQU8sRUFBRSxPQUFPO1lBQ2hCLFNBQVMsRUFBRSxTQUFTO1NBQ3ZCOztZQUNHLFNBQVMsR0FBRyxJQUFJLHdCQUF3QixFQUFFOztZQUMxQyxJQUFJLEdBQUcsU0FBUyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUM7UUFDbEQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNuRCxDQUFDOzs7Ozs7O0lBTUQsS0FBSyxDQUFDLE1BQWMsRUFBRSxTQUFpQjs7WUFDL0IsT0FBTyxHQUFHLElBQUksV0FBVyxDQUFDO1lBQzFCLGNBQWMsRUFBRSxrQkFBa0I7WUFDbEMsV0FBVyxFQUFFLFNB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QUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDOzs7Ozs7O0lBTUQsV0FBVyxDQUFDLGFBQThCLEVBQUUsU0FBaUI7O1lBQ3JELE9BQU8sR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUMxQixjQUFjLEVBQUUsa0JBQWtCO1lBQ2xDLFNBQVMsRUFBRSxTQUFTO1NBQ3ZCLENBQUM7O2NBQ0ksT0FBTyxHQUFHO1lBQ1osT0FBTyxFQUFFLE9BQU87U0FDbkI7O1lBQ0csU0FBUyxHQUFHLElBQUksd0JBQXdCLEVBQUU7O1lBQzFDLElBQUksR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztRQUNsRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3pELENBQUM7OztZQW5MSixVQUFVOzs7O1lBSkYsVUFBVTs7Ozs7OztJQVFmLGlDQUFpRjs7SUFDakYsMEJBQW9EOzs7OztJQUZ4QywyQkFBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBIZWFkZXJzIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFF1ZXJ5U29sdXRpb25WbywgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yLCBRdWVyeUNvbmRpdGlvbiB9IGZyb20gJ0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEh0dHBTZXJ2aWNlIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQpIHsgfVxyXG4gICAgcHJpdmF0ZSBoaXN0cm95VXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9zeXMvdjEuMC9xdWVyeXNvbHV0aW9uL3ByZXZpb3VzUXVlcnlcIjtcclxuICAgIHVybDogc3RyaW5nID0gJy9hcGkvcnVudGltZS9zeXMvdjEuMC9xdWVyeXNvbHV0aW9uJztcclxuICAgIC8qKlxyXG4gICAgICog5paw5aKe5p+l6K+i5pa55qGIXHJcbiAgICAgKiBAcGFyYW0gcXVlcnlTb2x1dGlvbiDmn6Xor6LmlrnmoYjlrp7kvZNcclxuICAgICAqL1xyXG4gICAgY3JlYXRlKHF1ZXJ5U29sdXRpb246IFF1ZXJ5U29sdXRpb25Wbywgc2Vzc2lvbklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgIGxldCBib2R5ID0gY29udmVydG9yLmNvbnZlcnRKT2JqZWN0KHF1ZXJ5U29sdXRpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh0aGlzLnVybCwgYm9keSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7ooajljZVJROafpeivouW9k+WJjeihqOWNleW9k+WJjeeZu+W9leeUqOaIt+eahOafpeivouaWueahiOWIl+ihqFxyXG4gICAgICogQHBhcmFtIGZvcm1JZCDooajljZVJRFxyXG4gICAgICovXHJcbiAgICBxdWVyeShmb3JtSWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgYmVsb25nSWQgPSBmb3JtSWQ7XHJcbiAgICAgICAgLy8gbGV0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjUxMDAvYXBpL2Rldi9tYWluL3YxLjAvcXVlcnlzb2x1dGlvbi9ieWJlbG9uZ2lkLyR7YmVsb25nSWR9YDtcclxuICAgICAgICBsZXQgdXJsID0gYCR7dGhpcy51cmx9L2JlbG9uZ0lkLyR7YmVsb25nSWR9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pu05pawXHJcbiAgICAgKiBAcGFyYW0gcXVlcnlTb2x1dGlvbiDmn6Xor6LmlrnmoYjlrp7kvZNcclxuICAgICAqL1xyXG4gICAgdXBkYXRlKHF1ZXJ5U29sdXRpb246IFF1ZXJ5U29sdXRpb25Wbywgc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgIGxldCBib2R5ID0gY29udmVydG9yLmNvbnZlcnRKT2JqZWN0KHF1ZXJ5U29sdXRpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucHV0KHRoaXMudXJsLCBib2R5LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIoOmZpFxyXG4gICAgICogQHVudXNlZFxyXG4gICAgICogQHBhcmFtIGlkQXJyYXkg5Yig6Zmk55qE6Kej5Yaz5pa55qGISUTliJfooahcclxuICAgICAqL1xyXG4gICAgLy8gZGVsZXRlKGlkQXJyYXk6IEFycmF5PHN0cmluZz4sIHNlc3Npb25JZDogc3RyaW5nKSB7XHJcbiAgICAvLyAgICAgaWYgKCFpZEFycmF5IHx8IGlkQXJyYXkubGVuZ3RoIDw9IDApIHtcclxuICAgIC8vICAgICAgICAgcmV0dXJuO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAvLyAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAvLyAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgLy8gICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxyXG4gICAgLy8gICAgICAgICBzZXNzaW9uaWQ6IHNlc3Npb25JZFxyXG4gICAgLy8gICAgIH07XHJcbiAgICAvLyAgICAgbGV0IGlkcyA9ICcnO1xyXG4gICAgLy8gICAgIGlkQXJyYXkuZm9yRWFjaChpZCA9PiB7XHJcbiAgICAvLyAgICAgICAgIGlkcyA9IGlkcyArIFwiI1wiICsgaWQ7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgbGV0IHVybCA9IGAvYXBpL2Rldi9tYWluL3YxLjAvcXVlcnlzb2x1dGlvbi8ke2VuY29kZVVSSUNvbXBvbmVudChpZHMpfWA7XHJcbiAgICAvLyAgICAgcmV0dXJuIHRoaXMuaHR0cC5kZWxldGUodXJsLCBvcHRpb25zKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJuemHj+abtOaWsFxyXG4gICAgICogQHBhcmFtIG9iamVjdCA6ICd7ZGVmYXVsdElkLCBiZWxvbmdJZCwgZGVsZXRlZElkc30nXHJcbiAgICAgKi9cclxuICAgIGJhdGNoVXBkYXRlKGJvZHk6IGFueSwgc2Vzc2lvbklkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHNlc3Npb25JZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgdXJsID0gYCR7dGhpcy51cmx9L2JhdGNoYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh1cmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W6buY6K6k5p+l6K+i5pa55qGISURcclxuICAgICAqIEB1bnVzZWRcclxuICAgICAqIEBwYXJhbSBmb3JtSWRcclxuICAgICAqL1xyXG4gICAgLy8gZ2V0RGVmYXVsdFF1ZXJ5U29sdXRpb24oZm9ybUlkOiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIC8vICAgICBsZXQgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XHJcbiAgICAvLyAgICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicsXHJcbiAgICAvLyAgICAgICAgICdzZXNzaW9uaWQnOiBzZXNzaW9uSWRcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBsZXQgYmVsb25nSWQgPSBmb3JtSWQ7XHJcbiAgICAvLyAgICAgLy8gbGV0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjUxMDAvYXBpL2Rldi9tYWluL3YxLjAvcXVlcnlzb2x1dGlvbi9kZWZhdWx0U29sdXRpb24vYnliZWxvbmdpZC8ke2JlbG9uZ0lkfWA7XHJcbiAgICAvLyAgICAgbGV0IHVybCA9IGAvYXBpL2Rldi9tYWluL3YxLjAvcXVlcnlzb2x1dGlvbi9kZWZhdWx0U29sdXRpb24vYnliZWxvbmdpZC8ke2JlbG9uZ0lkfWA7XHJcbiAgICAvLyAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsLCB7IGhlYWRlcnM6IGhlYWRlcnMsIHJlc3BvbnNlVHlwZTogJ3RleHQnIH0pO1xyXG4gICAgLy8gfVxyXG4gICAgLyoqXHJcbiAgICAgICAgKiDmmK/lkKbmlK/mjIFcclxuICAgICAgICAqL1xyXG4gICAgc3VwcG9ydExTKCkge1xyXG4gICAgICAgIGlmICh3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJsb2NhbFN0b3JhZ2VcIikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5L+d5a2Y5pe25YCZ77yM5bGe5oCn5LuO5bCP5YaZ5Y+Y5oiQ5aSn5YaZXHJcbiAgICAgKiBAcGFyYW0ga2V5IFxyXG4gICAgICogQHBhcmFtIHZhbHVlIFxyXG4gICAgICovXHJcbiAgICBzZXRMUyhrZXksIHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBsZXQgY29uZGl0aW9uc1N0cj0nW10nO1xyXG4gICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiggdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKXtcclxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbnNTdHI9dmFsdWU7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVydG9yID0gbmV3IFF1ZXJ5U29sdXRpb25Wb0NvbnZlcnRvcigpO1xyXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uc1N0cj1KU09OLnN0cmluZ2lmeShjb252ZXJ0b3IuZm9ybWF0Q29udmVydEpPYmplY3QodmFsdWUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoa2V5JiZ0aGlzLnN1cHBvcnRMUykge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBjb25kaXRpb25zU3RyKTtcclxuICAgICAgICB9IFxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bml7bvvIzlsZ7mgKfku47lpKflhpnlj5jmiJDlsI/lhplcclxuICAgICAqIEBwYXJhbSBrZXkgXHJcbiAgICAgKi9cclxuICAgIGdldExTKGtleSk6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPiB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IG5ldyBBcnJheTxRdWVyeUNvbmRpdGlvbj4oKTtcclxuICAgICAgICBpZiAoa2V5JiZ0aGlzLnN1cHBvcnRMUykge1xyXG4gICAgICAgICAgICB2YXIgdiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIGlmICh2ICE9IHVuZGVmaW5lZCB8fCB2ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHJlc3VsdC5sZW5ndGg+MCl7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRvci5mb3JtYXRGcm9tSm9iamVjdChyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pu05pawXHJcbiAgICAgKiBAcGFyYW0gcXVlcnlTb2x1dGlvbiDmn6Xor6LmlrnmoYjlrp7kvZNcclxuICAgICAqL1xyXG4gICAgc2F2ZUhpc3Ryb3kocXVlcnlTb2x1dGlvbjogUXVlcnlTb2x1dGlvblZvLCBzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEh0dHBIZWFkZXJzKHtcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogc2Vzc2lvbklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3IoKTtcclxuICAgICAgICBsZXQgYm9keSA9IGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChxdWVyeVNvbHV0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh0aGlzLmhpc3Ryb3lVcmwsIGJvZHksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==