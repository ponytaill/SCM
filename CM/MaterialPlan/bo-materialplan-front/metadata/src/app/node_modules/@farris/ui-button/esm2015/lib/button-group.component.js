/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { NgZone, ChangeDetectionStrategy, } from "@angular/core";
import { ChangeDetectorRef, } from "@angular/core";
import { Component, Input, Output, EventEmitter, ViewChild, ElementRef, } from "@angular/core";
import { Subject } from "rxjs";
import { IdService, OverLayHiddenService } from "@farris/ui-common";
/**
 * @return {?}
 */
function hideBtnMenu() {
    /** @type {?} */
    const ddm = document.querySelector(".f-btn-group-dropdown-menu.show");
    if (ddm) {
        ddm.className = ddm.className.replace("show", "");
    }
}
/**
 * @param {?} e
 * @return {?}
 */
function hideButtonMenu(e) {
    if (!e.target) {
        return;
    }
    /** @type {?} */
    var classList = Array.from(e.target.classList || []);
    if (e.target.nodeName !== "LI" && !e.target.closest('li.dropdown-item') && !classList.includes("dropdown-item")) {
        hideBtnMenu();
    }
}
export class FarrisButtonGroupComponent {
    /**
     * @param {?} changeRef
     * @param {?} ngZone
     */
    constructor(changeRef, ngZone) {
        this.changeRef = changeRef;
        this.ngZone = ngZone;
        // 是否自动纠正位置
        this.autoRectify = true;
        // 计算方向的真正placement
        this.realPlacement = "bottom-right";
        // 重新计算后的placement
        this.rectifyPlacement = "bottom-right";
        /* 显示的按钮数量  默认为2 */
        this.count = 2;
        /* 按钮大小 */
        this.size = "small";
        /* 按钮样式 */
        this.type = "primary";
        /* 按钮展示位置 */
        this._placement = "bottom";
        /* menu size */
        /**
         * 2021.06.12 废弃，因为使用者不知道在中英文情况下，下拉面板的宽度和高度
         */
        this.width = 120;
        this.height = 250;
        this._menuWidth = 0;
        this._menuHeight = 0;
        /* 下拉按钮 触发事件 */
        this.changeState = new EventEmitter();
        /* 下拉菜单项点击事件 */
        this.change = new EventEmitter();
        this.click = new EventEmitter();
        /* 触发下拉按钮面板区域之外的事件 */
        this.clickMenuOut = new EventEmitter();
        /**
         * 2021.06.12 废弃，因为当autoSize为true的时候，按钮显示不出来。
         */
        this.autoSize = false;
        /* 下拉面板显示 */
        this.show = false;
        this.setPosition$ = new Subject();
        this.btnmenuid = 'btn-menu-';
        this.previous = 0;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set placement(value) {
        if (!value) {
            return;
        }
        if (value !== this._placement) {
            this.realPlacement = this.getRealPlacement(value);
            this._placement = value;
        }
    }
    /**
     * @return {?}
     */
    get placement() {
        return this._placement;
    }
    /* 显示出来的按钮组 */
    /**
     * @return {?}
     */
    get flatButtons() {
        return this.data && this.data.slice(0, this.count);
    }
    /**
     * @return {?}
     */
    get dpButtons() {
        // this.height = this.dpButtons.length * 35;
        return this.data && this.data.slice(this.count);
    }
    /**
     * @private
     * @return {?}
     */
    btnmenuId() {
        /** @type {?} */
        const idSer = new IdService();
        this.btnmenuid += idSer.guid();
        this.overLayService = new OverLayHiddenService();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.btnmenuId();
    }
    /**
     * @param {?} simpleChanges
     * @return {?}
     */
    ngOnChanges(simpleChanges) {
        if (simpleChanges["data"]) {
            // this.flatButtons = this.data.slice(0, this.count);
            // this.dpButtons = this.data.slice(this.count);
            // this.height = this.dpButtons.length * 35;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() { }
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
        if (this.show) {
            // const { height, width } = this.dpMenu.nativeElement.getBoundingClientRect();
            this.setPosition(this.event);
            // this.setPosition$.subscribe(res => this.setPosition(res, width, height));
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    clickEvent(e) {
        e.stopPropagation();
        this.show = !(this.show && this.dpMenu.nativeElement.className.indexOf('show') > -1);
        // body添加面板
        if (this.show) {
            /** 移除现有的下拉展示菜单 */
            hideBtnMenu();
            this.appendBody();
            // this.setPosition(e);
            // this.setPosition$.next(e);
            // 注册鼠标滚轮，点击事件，用于隐藏Panel
            this.overLayService.registerMouseEvent(this.dpBtn.nativeElement, (/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                hideButtonMenu(e);
            }));
            this.event = e;
            // 绑定相应的事件
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            () => {
                this.bindMenuMouseenter();
                this.bindiMenuMouseleave();
                // this.bindDocClick();
                this.mouseNotEnterLeave();
            }));
        }
        // 面板显示 脏值检测
        this.changeRef.detectChanges();
        this.changeRef.markForCheck();
        // this.changeState.emit({ originEvent: e, show: this.show });
        this.changeState.emit(this.show);
    }
    /* 按钮触发事件 */
    /**
     * @param {?} e
     * @param {?} btn
     * @return {?}
     */
    toggle(e, btn) {
        e.stopPropagation();
        if (btn.disabled)
            return;
        this.show = false;
        // this.unbindDocClick();
        // 关闭下拉按钮面板  脏值检测
        this.changeRef.detectChanges();
        this.changeRef.markForCheck();
        this.change.emit(btn.id);
        this.click.emit(btn);
        this.overLayService.destory(this.dpBtn.nativeElement);
    }
    // 下拉按钮显示到body中  可改变面板方向
    /**
     * @return {?}
     */
    appendBody() {
        if (this.dpMenu.nativeElement && !document.querySelector('body>#' + this.btnmenuid)) {
            // 添加到body  便于全部显示
            document.body.appendChild(this.dpMenu.nativeElement);
        }
        this.dpMenu.nativeElement.className = this.dpMenu.nativeElement.className + ' show';
    }
    /**
     * @return {?}
     */
    removeMenuPanel() {
        if (this.dpMenu.nativeElement && document.querySelector('body>#' + this.btnmenuid)) {
            this.dpMenu.nativeElement.remove();
        }
    }
    /**
     * 当下拉超出边界时  转换方向,
     * 并未处理，边界不够下拉展示的情况
     * @param {?} btnSize
     * @return {?}
     */
    changePlacement(btnSize) {
        if (!this.autoRectify) {
            return;
        }
        /** @type {?} */
        let referPosition = this.getReferencePosition();
        /** @type {?} */
        let newPlacement = this.realPlacement;
        if (newPlacement.indexOf("bottom") > -1) {
            if (this._menuHeight > referPosition.bottom - btnSize.bottom) {
                newPlacement = newPlacement.replace("bottom", "top");
            }
        }
        else if (newPlacement.indexOf("top") > -1) {
            if (this._menuHeight > btnSize.top - referPosition.top) {
                newPlacement = newPlacement.replace("top", "bottom");
            }
        }
        if (newPlacement.indexOf("left") > -1) {
            if (this._menuWidth > btnSize.left - referPosition.left) {
                newPlacement = newPlacement.replace("left", "right");
            }
        }
        else if (newPlacement.indexOf("right") > -1) {
            if (this._menuWidth > referPosition.right - btnSize.right) {
                newPlacement = newPlacement.replace("right", "left");
            }
        }
        this.rectifyPlacement = newPlacement;
    }
    /**
     * 确认参照的边界
     * @private
     * @return {?}
     */
    getReferencePosition() {
        /** @type {?} */
        let rRight = document.documentElement.clientWidth;
        /** @type {?} */
        let rBottom = document.documentElement.clientHeight;
        /** @type {?} */
        let rTop = 0;
        /** @type {?} */
        let rLeft = 0;
        // 横向参照
        if (this.rectifyReferenceH) {
            rRight = this.rectifyReferenceH.getBoundingClientRect().right;
            rLeft = this.rectifyReferenceH.getBoundingClientRect().left;
        }
        // 纵向参照
        if (this.rectifyReferenceV) {
            rBottom = this.rectifyReferenceV.getBoundingClientRect().bottom;
            rTop = this.rectifyReferenceV.getBoundingClientRect().top;
        }
        return { top: rTop, left: rLeft, right: rRight, bottom: rBottom };
    }
    /**
     * 变化对应的class
     * @param {?} position
     * @return {?}
     */
    _getClsName(position) {
        /** @type {?} */
        let className = "";
        switch (position) {
            case "top-right":
            case "top":
                // 朝上，朝上-朝右
                className = "dropup";
                break;
            case "top-left":
                // 朝上-朝左
                className = "dropup-left";
                break;
            case "left-bottom":
            case "left":
                // 横向——朝左——朝下
                className = "dropleft";
                break;
            case "left-top":
                // 横向——朝左——朝上
                className = "dropleft-up";
                break;
            case "right-bottom":
            case "right":
                // 横向——朝右——朝下
                className = "dropright";
                break;
            case "right-top":
                // 横向——朝右——朝上
                className = "dropright-up";
                break;
            case "bottom-left":
                // 朝下——朝左
                className = "dropdown-left";
                break;
            case "bottom-right":
                className = "dropdown";
                break;
            default:
                // 朝下，朝下——朝右
                className = "dropdown";
        }
        return className;
    }
    /**
     * @private
     * @param {?} pment
     * @return {?}
     */
    getRealPlacement(pment) {
        /** @type {?} */
        var result = "bottom-right";
        switch (pment) {
            case "top":
                result = "top-right";
                break;
            case "left":
                result = "left-bottom";
                break;
            case "right":
                result = "right-bottom";
                break;
            case "bottom":
                result = "bottom-right";
                break;
            default:
                result = pment;
        }
        return result;
    }
    /*
         * 计算的位置区分忒细化
         */
    /**
     * @private
     * @param {?} btnSize
     * @return {?}
     */
    changePosition(btnSize) {
        /** @type {?} */
        let rplacement = "";
        if (this.autoRectify) {
            rplacement = this.rectifyPlacement;
        }
        else {
            rplacement = this.realPlacement;
        }
        /** @type {?} */
        let styleTop = 0;
        /** @type {?} */
        let styleLeft = 0;
        if (rplacement.indexOf("top") > -1) {
            styleTop = btnSize.top - this._menuHeight;
        }
        else if (rplacement.indexOf("bottom") > -1) {
            styleTop = btnSize.bottom;
        }
        if (rplacement.indexOf("right") > -1) {
            styleLeft = btnSize.right;
        }
        else if (rplacement.indexOf("left") > -1) {
            styleLeft = btnSize.left - this._menuWidth;
        }
        // 开头
        if (rplacement.indexOf("-top") > -1) {
            styleTop = styleTop - btnSize.height;
        }
        else if (rplacement.indexOf("-bottom") > -1) {
            styleTop = styleTop + btnSize.height;
        }
        this.dpMenu.nativeElement.style.top = styleTop + "px";
        this.dpMenu.nativeElement.style.left = styleLeft + "px";
    }
    /* 绑定下拉面板鼠标进入事件 */
    /**
     * @return {?}
     */
    bindMenuMouseenter() {
        this.unbindMenuMouseenter();
        this.mouseenterEvent = this.changeFlagToTrue.bind(this);
        this.dpMenu.nativeElement.addEventListener("mouseenter", this.mouseenterEvent);
    }
    /* 绑定下拉面板鼠标离开事件  */
    /**
     * @return {?}
     */
    bindiMenuMouseleave() {
        this.unbindiMenuMouseleave();
        this.mouseleaveEvent = this.mouseLeave.bind(this);
        this.dpMenu.nativeElement.addEventListener("mouseleave", this.mouseleaveEvent);
    }
    /* 绑定点击面板区域之外触发的事件 */
    // bindDocClick() {
    //   this.documentClickEvent = this.clickDoc.bind(this);
    //   document.addEventListener('click', this.documentClickEvent);
    // }
    /* 解绑事件 */
    /**
     * @return {?}
     */
    unbindMenuMouseenter() {
        if (this.mouseenterEvent) {
            this.dpMenu.nativeElement.removeEventListener("mouseenter", this.mouseenterEvent);
        }
    }
    /**
     * @return {?}
     */
    unbindiMenuMouseleave() {
        if (this.mouseleaveEvent) {
            this.dpMenu.nativeElement.removeEventListener("mouseleave", this.mouseleaveEvent);
        }
    }
    // unbindDocClick() {
    //   if (this.documentClickEvent) {
    //     document.removeEventListener('click', this.documentClickEvent);
    //   }
    // }
    /* flag true */
    /**
     * @return {?}
     */
    changeFlagToTrue() {
        this.dpFlag = true;
    }
    /* flag false */
    /**
     * @return {?}
     */
    changeFlagToFalse() {
        this.dpFlag = false;
    }
    /* 鼠标离开时  关闭menu */
    /**
     * @return {?}
     */
    mouseLeave() {
        if (this.dpFlag) {
            this.changeFlagToFalse();
            // this.unbindDocClick();
            this.unbindiMenuMouseleave();
            this.unbindMenuMouseenter();
            this.close();
            if (this.setTimeObj) {
                this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                () => {
                    clearTimeout(this.setTimeObj);
                }));
            }
        }
    }
    /* 鼠标没有进入到面板  一段时间后面板自动消失 */
    /**
     * @return {?}
     */
    mouseNotEnterLeave() {
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            if (this.setTimeObj) {
                clearTimeout(this.setTimeObj);
            }
            this.setTimeObj = setTimeout((/**
             * @return {?}
             */
            () => {
                if (!this.dpFlag) {
                    this.changeFlagToFalse();
                    // this.unbindDocClick();
                    this.unbindiMenuMouseleave();
                    this.unbindMenuMouseenter();
                    this.close();
                    if (this.setTimeObj) {
                        clearTimeout(this.setTimeObj);
                    }
                }
            }), 2000);
        }));
    }
    /* 关闭下拉面板 */
    /**
     * @return {?}
     */
    close() {
        this.show = false;
        // 关闭下拉按钮面板  脏值检测
        if (!this.changeRef["destroyed"]) {
            this.changeRef.detectChanges();
            this.changeRef.markForCheck();
        }
        this.dpBtn.nativeElement.blur();
        this.overLayService.destory(this.dpBtn.nativeElement);
    }
    /* 动态指定menu在body中的位置 */
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    setPosition(e) {
        // 下拉按钮
        /** @type {?} */
        const btnSize = this.dpBtn.nativeElement.getBoundingClientRect();
        // 下拉面板
        /** @type {?} */
        let menuRect = this.dpMenu.nativeElement.getBoundingClientRect();
        this._menuHeight = menuRect.height;
        this._menuWidth = menuRect.width;
        // 如果要自动纠正方向
        if (this.autoRectify) {
            this.changePlacement(btnSize);
        }
        this.changePosition(btnSize);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        // this.removeMenuPanel();
        if (this.dpBtn && this.dpBtn.nativeElement) {
            this.overLayService.destory(this.dpBtn.nativeElement);
        }
        this.overLayService = null;
    }
}
FarrisButtonGroupComponent.decorators = [
    { type: Component, args: [{
                selector: "farris-button-group",
                template: "<div class=\"f-btn-group\">\r\n    <div [class]=\"(size==='large'?'btn-group-lg':'btn-group-sm')+' btn-group f-btn-group-links'\">\r\n        <ng-container *ngFor=\"let btn of flatButtons\">\r\n            <ng-container *ngIf=\"btn.icon\">\r\n                <button [id]=\"btn.id\" class=\"btn btn-link btn-icontext\" [disabled]=\"btn.disabled\" (click)=\"toggle($event,btn)\">\r\n                    <i class=\"f-icon\"  [ngClass]=\"btn.icon\"></i>\r\n                </button>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"!btn.icon\">\r\n            <button [id]=\"btn.id\"\r\n                [class]=\"'btn '+(btn.type?'btn-'+btn.type:'btn-link')+' '+ (btn.type && btn.type !== 'link' ? 'f-btn-ml' :'')\"\r\n                [disabled]=\"btn.disabled\" (click)=\"toggle($event,btn)\">\r\n                {{btn.text}}\r\n            </button> \r\n            </ng-container>\r\n        </ng-container>\r\n    </div>\r\n    <ng-container *ngIf=\"dpButtons.length\">\r\n        <div class=\"btn-group f-btn-group-dropdown\">\r\n            <button #dpBtn type=\"button\" class=\"f-btn-dropdown\" (click)=\"clickEvent($event)\">\r\n                <span class=\"f-icon f-icon-lookup\"></span>\r\n            </button>\r\n            <div #dpMenu class=\"dropdown-menu f-btn-group-dropdown-menu\" [class.show]=\"show\"  style=\"position:fixed;\" id=\"{{btnmenuid}}\">\r\n                <ng-container *ngFor=\"let dpBtn of dpButtons\">\r\n                    <div class=\"dropdown-divider\" *ngIf=\"dpBtn.divider\"></div>\r\n                    <li [id]=\"dpBtn.id\" class=\"dropdown-item\" [class.disabled]=\"dpBtn.disabled\"\r\n                        (click)=\"toggle($event,dpBtn)\">\r\n                        <ng-container *ngIf=\"dpBtn.icon\">\r\n                            <i class=\"f-icon dropdown-item-icon\" [ngClass]=\"dpBtn.icon\"></i>\r\n                        </ng-container>\r\n                        <span>{{dpBtn.text}}</span>\r\n                    </li>\r\n                </ng-container>\r\n            </div>\r\n        </div>\r\n    </ng-container>\r\n</div>",
                changeDetection: ChangeDetectionStrategy.OnPush
            }] }
];
/** @nocollapse */
FarrisButtonGroupComponent.ctorParameters = () => [
    { type: ChangeDetectorRef },
    { type: NgZone }
];
FarrisButtonGroupComponent.propDecorators = {
    dpBtn: [{ type: ViewChild, args: ["dpBtn",] }],
    dpMenu: [{ type: ViewChild, args: ["dpMenu",] }],
    rectifyReferenceH: [{ type: Input }],
    rectifyReferenceV: [{ type: Input }],
    autoRectify: [{ type: Input }],
    data: [{ type: Input }],
    count: [{ type: Input }],
    size: [{ type: Input }],
    type: [{ type: Input }],
    placement: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    changeState: [{ type: Output }],
    change: [{ type: Output }],
    click: [{ type: Output }],
    clickMenuOut: [{ type: Output }],
    autoSize: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.dpBtn;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.dpMenu;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.rectifyReferenceH;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.rectifyReferenceV;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.autoRectify;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype.realPlacement;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.rectifyPlacement;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.data;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.count;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.size;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.type;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype._placement;
    /**
     * 2021.06.12 废弃，因为使用者不知道在中英文情况下，下拉面板的宽度和高度
     * @type {?}
     */
    FarrisButtonGroupComponent.prototype.width;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.height;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype._menuWidth;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype._menuHeight;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.changeState;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.change;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.click;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.clickMenuOut;
    /**
     * 2021.06.12 废弃，因为当autoSize为true的时候，按钮显示不出来。
     * @type {?}
     */
    FarrisButtonGroupComponent.prototype.autoSize;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.show;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.setPosition$;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.event;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.dpFlag;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.mouseenterEvent;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.mouseleaveEvent;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.documentClickEvent;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.btnSize;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.setTimeObj;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.btnmenuid;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype.previous;
    /** @type {?} */
    FarrisButtonGroupComponent.prototype.overLayService;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype.changeRef;
    /**
     * @type {?}
     * @private
     */
    FarrisButtonGroupComponent.prototype.ngZone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLWdyb3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktYnV0dG9uLyIsInNvdXJjZXMiOlsibGliL2J1dHRvbi1ncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFFSCxNQUFNLEVBQ04sdUJBQXVCLEdBSTFCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFHSCxpQkFBaUIsR0FDcEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUNILFNBQVMsRUFFVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFlBQVksRUFDWixTQUFTLEVBQ1QsVUFBVSxHQUNiLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDOzs7O0FBRXBFLFNBQVMsV0FBVzs7VUFDVixHQUFHLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxpQ0FBaUMsQ0FBQztJQUNyRSxJQUFJLEdBQUcsRUFBRTtRQUNMLEdBQUcsQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0tBQ3JEO0FBQ0wsQ0FBQzs7Ozs7QUFFRCxTQUFTLGNBQWMsQ0FBQyxDQUFDO0lBQ3JCLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFO1FBQ1gsT0FBTztLQUNWOztRQUVHLFNBQVMsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsU0FBUyxJQUFJLEVBQUUsQ0FBQztJQUVwRCxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxLQUFLLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxFQUFFO1FBQzdHLFdBQVcsRUFBRSxDQUFDO0tBQ2pCO0FBQ0wsQ0FBQztBQVFELE1BQU0sT0FBTywwQkFBMEI7Ozs7O0lBcUduQyxZQUFvQixTQUE0QixFQUFVLE1BQWM7UUFBcEQsY0FBUyxHQUFULFNBQVMsQ0FBbUI7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFROztRQTNGL0QsZ0JBQVcsR0FBRyxJQUFJLENBQUM7O1FBRXBCLGtCQUFhLEdBQUcsY0FBYyxDQUFDOztRQUV2QyxxQkFBZ0IsR0FBRyxjQUFjLENBQUM7O1FBTXpCLFVBQUssR0FBRyxDQUFDLENBQUM7O1FBR1YsU0FBSSxHQUFHLE9BQU8sQ0FBQzs7UUFHZixTQUFJLEdBQUcsU0FBUyxDQUFDOztRQUdsQixlQUFVLEdBQUcsUUFBUSxDQUFDOzs7OztRQW1CckIsVUFBSyxHQUFHLEdBQUcsQ0FBQztRQUNaLFdBQU0sR0FBRyxHQUFHLENBQUM7UUFDZCxlQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQ2YsZ0JBQVcsR0FBRyxDQUFDLENBQUM7O1FBR2QsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOztRQUd0QyxXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNqQyxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUFHaEMsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBS3hDLGFBQVEsR0FBRyxLQUFLLENBQUM7O1FBRzFCLFNBQUksR0FBRyxLQUFLLENBQUM7UUFZYixpQkFBWSxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7UUFpQmhDLGNBQVMsR0FBRyxXQUFXLENBQUM7UUFDaEIsYUFBUSxHQUFHLENBQUMsQ0FBQztJQUV5RCxDQUFDOzs7OztJQXZFNUUsSUFDSSxTQUFTLENBQUMsS0FBSztRQUNmLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDUixPQUFPO1NBQ1Y7UUFDRCxJQUFJLEtBQUssS0FBSyxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQzNCLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2xELElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO1NBQzNCO0lBQ0wsQ0FBQzs7OztJQUNELElBQUksU0FBUztRQUNULE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUMzQixDQUFDOzs7OztJQTZCRCxJQUFJLFdBQVc7UUFDWCxPQUFPLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2RCxDQUFDOzs7O0lBRUQsSUFBSSxTQUFTO1FBQ1QsNENBQTRDO1FBRTVDLE9BQU8sSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDcEQsQ0FBQzs7Ozs7SUF3QkksU0FBUzs7Y0FDVixLQUFLLEdBQUcsSUFBSSxTQUFTLEVBQUU7UUFDN0IsSUFBSSxDQUFDLFNBQVMsSUFBSSxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLG9CQUFvQixFQUFFLENBQUM7SUFDeEQsQ0FBQzs7OztJQUVFLFFBQVE7UUFDSixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDckIsQ0FBQzs7Ozs7SUFFRCxXQUFXLENBQUMsYUFBNEI7UUFDcEMsSUFBSSxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDdkIscURBQXFEO1lBQ3JELGdEQUFnRDtZQUNoRCw0Q0FBNEM7U0FDL0M7SUFDTCxDQUFDOzs7O0lBRUQsZUFBZSxLQUFJLENBQUM7Ozs7SUFFcEIsa0JBQWtCO1FBQ2QsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1gsK0VBQStFO1lBQy9FLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzdCLDRFQUE0RTtTQUMvRTtJQUNMLENBQUM7Ozs7O0lBRUQsVUFBVSxDQUFDLENBQU07UUFDYixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckYsV0FBVztRQUNYLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUNwQixrQkFBa0I7WUFDbEIsV0FBVyxFQUFFLENBQUM7WUFDTCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDbEIsdUJBQXVCO1lBQ3ZCLDZCQUE2QjtZQUU3Qix3QkFBd0I7WUFDeEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWE7Ozs7WUFBRSxDQUFDLENBQWEsRUFBRSxFQUFFO2dCQUMvRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEIsQ0FBQyxFQUFDLENBQUM7WUFJSCxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUNmLFVBQVU7WUFDVixJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQjs7O1lBQUMsR0FBRyxFQUFFO2dCQUMvQixJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztnQkFDMUIsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7Z0JBQzNCLHVCQUF1QjtnQkFDdkIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDOUIsQ0FBQyxFQUFDLENBQUM7U0FDTjtRQUNELFlBQVk7UUFDWixJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDOUIsOERBQThEO1FBQzlELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyQyxDQUFDOzs7Ozs7O0lBR0QsTUFBTSxDQUFDLENBQU0sRUFBRSxHQUFHO1FBQ2QsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3BCLElBQUksR0FBRyxDQUFDLFFBQVE7WUFBRSxPQUFPO1FBQ3pCLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2xCLHlCQUF5QjtRQUN6QixpQkFBaUI7UUFDakIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUMvQixJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQzlCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN6QixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVyQixJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzFELENBQUM7Ozs7O0lBR0QsVUFBVTtRQUNOLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDakYsa0JBQWtCO1lBQ2xCLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7U0FDeEQ7UUFDUCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQztJQUNsRixDQUFDOzs7O0lBRUQsZUFBZTtRQUNYLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLElBQUksUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ2hGLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxDQUFDO1NBQ3RDO0lBQ0wsQ0FBQzs7Ozs7OztJQU9ELGVBQWUsQ0FBQyxPQUFZO1FBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ25CLE9BQU87U0FDVjs7WUFDRyxhQUFhLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFOztZQUMzQyxZQUFZLEdBQUcsSUFBSSxDQUFDLGFBQWE7UUFDckMsSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ3JDLElBQUksSUFBSSxDQUFDLFdBQVcsR0FBRyxhQUFhLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUU7Z0JBQzFELFlBQVksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQzthQUN4RDtTQUNKO2FBQU0sSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ3pDLElBQUksSUFBSSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUMsR0FBRyxHQUFHLGFBQWEsQ0FBQyxHQUFHLEVBQUU7Z0JBQ3BELFlBQVksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQzthQUN4RDtTQUNKO1FBQ0QsSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ25DLElBQUksSUFBSSxDQUFDLFVBQVUsR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHLGFBQWEsQ0FBQyxJQUFJLEVBQUU7Z0JBQ3JELFlBQVksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQzthQUN4RDtTQUNKO2FBQU0sSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQzNDLElBQUksSUFBSSxDQUFDLFVBQVUsR0FBRyxhQUFhLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLEVBQUU7Z0JBQ3ZELFlBQVksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQzthQUN4RDtTQUNKO1FBQ0QsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFlBQVksQ0FBQztJQUN6QyxDQUFDOzs7Ozs7SUFJTyxvQkFBb0I7O1lBQ3BCLE1BQU0sR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLFdBQVc7O1lBQzdDLE9BQU8sR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLFlBQVk7O1lBQy9DLElBQUksR0FBRyxDQUFDOztZQUNSLEtBQUssR0FBRyxDQUFDO1FBQ2IsT0FBTztRQUNQLElBQUksSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQ3hCLE1BQU0sR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxLQUFLLENBQUM7WUFDOUQsS0FBSyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLElBQUksQ0FBQztTQUMvRDtRQUNELE9BQU87UUFDUCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtZQUN4QixPQUFPLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLHFCQUFxQixFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ2hFLElBQUksR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxHQUFHLENBQUM7U0FDN0Q7UUFDRCxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDO0lBQ3RFLENBQUM7Ozs7OztJQUtELFdBQVcsQ0FBQyxRQUFROztZQUNaLFNBQVMsR0FBRyxFQUFFO1FBQ2xCLFFBQVEsUUFBUSxFQUFFO1lBQ2QsS0FBSyxXQUFXLENBQUM7WUFDakIsS0FBSyxLQUFLO2dCQUNOLFdBQVc7Z0JBQ1gsU0FBUyxHQUFHLFFBQVEsQ0FBQztnQkFDckIsTUFBTTtZQUNWLEtBQUssVUFBVTtnQkFDWCxRQUFRO2dCQUNSLFNBQVMsR0FBRyxhQUFhLENBQUM7Z0JBQzFCLE1BQU07WUFDVixLQUFLLGFBQWEsQ0FBQztZQUNuQixLQUFLLE1BQU07Z0JBQ1AsYUFBYTtnQkFDYixTQUFTLEdBQUcsVUFBVSxDQUFDO2dCQUN2QixNQUFNO1lBQ1YsS0FBSyxVQUFVO2dCQUNYLGFBQWE7Z0JBQ2IsU0FBUyxHQUFHLGFBQWEsQ0FBQztnQkFDMUIsTUFBTTtZQUNWLEtBQUssY0FBYyxDQUFDO1lBQ3BCLEtBQUssT0FBTztnQkFDUixhQUFhO2dCQUNiLFNBQVMsR0FBRyxXQUFXLENBQUM7Z0JBQ3hCLE1BQU07WUFDVixLQUFLLFdBQVc7Z0JBQ1osYUFBYTtnQkFDYixTQUFTLEdBQUcsY0FBYyxDQUFDO2dCQUMzQixNQUFNO1lBQ1YsS0FBSyxhQUFhO2dCQUNkLFNBQVM7Z0JBQ1QsU0FBUyxHQUFHLGVBQWUsQ0FBQztnQkFDNUIsTUFBTTtZQUNWLEtBQUssY0FBYztnQkFDZixTQUFTLEdBQUcsVUFBVSxDQUFDO2dCQUN2QixNQUFNO1lBQ1Y7Z0JBQ0ksWUFBWTtnQkFDWixTQUFTLEdBQUcsVUFBVSxDQUFDO1NBQzlCO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDckIsQ0FBQzs7Ozs7O0lBRU8sZ0JBQWdCLENBQUMsS0FBSzs7WUFDdEIsTUFBTSxHQUFHLGNBQWM7UUFDM0IsUUFBUSxLQUFLLEVBQUU7WUFDWCxLQUFLLEtBQUs7Z0JBQ04sTUFBTSxHQUFHLFdBQVcsQ0FBQztnQkFDckIsTUFBTTtZQUNWLEtBQUssTUFBTTtnQkFDUCxNQUFNLEdBQUcsYUFBYSxDQUFDO2dCQUN2QixNQUFNO1lBQ1YsS0FBSyxPQUFPO2dCQUNSLE1BQU0sR0FBRyxjQUFjLENBQUM7Z0JBQ3hCLE1BQU07WUFDVixLQUFLLFFBQVE7Z0JBQ1QsTUFBTSxHQUFHLGNBQWMsQ0FBQztnQkFDeEIsTUFBTTtZQUNWO2dCQUNJLE1BQU0sR0FBRyxLQUFLLENBQUM7U0FDdEI7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDOzs7Ozs7Ozs7SUFLTyxjQUFjLENBQUMsT0FBWTs7WUFDM0IsVUFBVSxHQUFHLEVBQUU7UUFDbkIsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLFVBQVUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7U0FDdEM7YUFBTTtZQUNILFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDO1NBQ25DOztZQUNHLFFBQVEsR0FBRyxDQUFDOztZQUNaLFNBQVMsR0FBRyxDQUFDO1FBQ2pCLElBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUNoQyxRQUFRLEdBQUcsT0FBTyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDO1NBQzdDO2FBQU0sSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQzFDLFFBQVEsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO1NBQzdCO1FBQ0QsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ2xDLFNBQVMsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO1NBQzdCO2FBQU0sSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ3hDLFNBQVMsR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7U0FDOUM7UUFDRCxLQUFLO1FBQ0wsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBQ2pDLFFBQVEsR0FBRyxRQUFRLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztTQUN4QzthQUFNLElBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUMzQyxRQUFRLEdBQUcsUUFBUSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7U0FDeEM7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDdEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxTQUFTLEdBQUcsSUFBSSxDQUFDO0lBQzVELENBQUM7Ozs7O0lBR0Qsa0JBQWtCO1FBQ2QsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDNUIsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hELElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUN0QyxZQUFZLEVBQ1osSUFBSSxDQUFDLGVBQWUsQ0FDdkIsQ0FBQztJQUNOLENBQUM7Ozs7O0lBR0QsbUJBQW1CO1FBQ2YsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FDdEMsWUFBWSxFQUNaLElBQUksQ0FBQyxlQUFlLENBQ3ZCLENBQUM7SUFDTixDQUFDOzs7Ozs7Ozs7O0lBU0Qsb0JBQW9CO1FBQ2hCLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FDekMsWUFBWSxFQUNaLElBQUksQ0FBQyxlQUFlLENBQ3ZCLENBQUM7U0FDTDtJQUNMLENBQUM7Ozs7SUFDRCxxQkFBcUI7UUFDakIsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3RCLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLG1CQUFtQixDQUN6QyxZQUFZLEVBQ1osSUFBSSxDQUFDLGVBQWUsQ0FDdkIsQ0FBQztTQUNMO0lBQ0wsQ0FBQzs7Ozs7Ozs7OztJQVFELGdCQUFnQjtRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO0lBQ3ZCLENBQUM7Ozs7O0lBR0QsaUJBQWlCO1FBQ2IsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7SUFDeEIsQ0FBQzs7Ozs7SUFHRCxVQUFVO1FBQ04sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2IsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFDekIseUJBQXlCO1lBQ3pCLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBQzdCLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQzVCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNiLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRTtnQkFDakIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUI7OztnQkFBQyxHQUFHLEVBQUU7b0JBQy9CLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ2xDLENBQUMsRUFBQyxDQUFDO2FBQ047U0FDSjtJQUNMLENBQUM7Ozs7O0lBR0Qsa0JBQWtCO1FBQ2QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUI7OztRQUFDLEdBQUcsRUFBRTtZQUN4QyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7Z0JBQ3BCLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7YUFDOUI7WUFDUSxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVU7OztZQUFDLEdBQUcsRUFBRTtnQkFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7b0JBQ2QsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7b0JBQ3pCLHlCQUF5QjtvQkFDekIsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7b0JBQzdCLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO29CQUM1QixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7b0JBQ2IsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO3dCQUNqQixZQUFZLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO3FCQUNqQztpQkFDSjtZQUNMLENBQUMsR0FBRSxJQUFJLENBQUMsQ0FBQztRQUNiLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7Ozs7SUFHRCxLQUFLO1FBQ0QsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7UUFDbEIsaUJBQWlCO1FBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQzlCLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDL0IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNqQztRQUNELElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDO1FBRWhDLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDMUQsQ0FBQzs7Ozs7OztJQUdPLFdBQVcsQ0FBQyxDQUFDOzs7Y0FFWCxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUU7OztZQUU1RCxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUU7UUFDaEUsSUFBSSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQ25DLElBQUksQ0FBQyxVQUFVLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQztRQUNqQyxZQUFZO1FBQ1osSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDakM7UUFDRCxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7Ozs7SUFFRCxXQUFXO1FBQ1AsMEJBQTBCO1FBQzFCLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRTtZQUN4QyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1NBQ3pEO1FBQ0QsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7SUFDL0IsQ0FBQzs7O1lBbGVKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUscUJBQXFCO2dCQUMvQixza0VBQTRDO2dCQUM1QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTthQUNsRDs7OztZQXZDRyxpQkFBaUI7WUFUakIsTUFBTTs7O29CQW9ETCxTQUFTLFNBQUMsT0FBTztxQkFDakIsU0FBUyxTQUFDLFFBQVE7Z0NBRWxCLEtBQUs7Z0NBRUwsS0FBSzswQkFFTCxLQUFLO21CQU9MLEtBQUs7b0JBR0wsS0FBSzttQkFHTCxLQUFLO21CQUdMLEtBQUs7d0JBSUwsS0FBSztvQkFrQkwsS0FBSztxQkFDTCxLQUFLOzBCQUtMLE1BQU07cUJBR04sTUFBTTtvQkFDTixNQUFNOzJCQUdOLE1BQU07dUJBS04sS0FBSzs7OztJQS9ETiwyQ0FBc0M7O0lBQ3RDLDRDQUF3Qzs7SUFFeEMsdURBQXdDOztJQUV4Qyx1REFBd0M7O0lBRXhDLGlEQUE0Qjs7Ozs7SUFFNUIsbURBQXVDOztJQUV2QyxzREFBa0M7O0lBR2xDLDBDQUF3Qjs7SUFHeEIsMkNBQW1COztJQUduQiwwQ0FBd0I7O0lBR3hCLDBDQUEwQjs7Ozs7SUFHMUIsZ0RBQThCOzs7OztJQW1COUIsMkNBQXFCOztJQUNyQiw0Q0FBc0I7Ozs7O0lBQ3RCLGdEQUF1Qjs7Ozs7SUFDdkIsaURBQXdCOztJQUd4QixpREFBZ0Q7O0lBR2hELDRDQUEyQzs7SUFDM0MsMkNBQTBDOztJQUcxQyxrREFBaUQ7Ozs7O0lBS2pELDhDQUEwQjs7SUFHMUIsMENBQWE7O0lBWWIsa0RBQTZCOztJQUM3QiwyQ0FBVzs7SUFHWCw0Q0FBZ0I7O0lBR2hCLHFEQUFxQjs7SUFDckIscURBQXFCOztJQUNyQix3REFBd0I7O0lBR3hCLDZDQUFhOztJQUdiLGdEQUFnQjs7SUFFbkIsK0NBQXdCOzs7OztJQUN4Qiw4Q0FBcUI7O0lBQ2xCLG9EQUFxQzs7Ozs7SUFDekIsK0NBQW9DOzs7OztJQUFFLDRDQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBPbkRlc3Ryb3ksXHJcbiAgICBOZ1pvbmUsXHJcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICAgIFJlbmRlcmVyMixcclxuICAgIE9uQ2hhbmdlcyxcclxuICAgIFNpbXBsZUNoYW5nZXMsXHJcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHtcclxuICAgIEFmdGVyVmlld0luaXQsXHJcbiAgICBBZnRlclZpZXdDaGVja2VkLFxyXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuICAgIE9uSW5pdCxcclxuICAgIElucHV0LFxyXG4gICAgT3V0cHV0LFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgVmlld0NoaWxkLFxyXG4gICAgRWxlbWVudFJlZixcclxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tIFwiLi9idXR0b25cIjtcclxuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gXCJyeGpzXCI7XHJcbmltcG9ydCB7IElkU2VydmljZSwgT3ZlckxheUhpZGRlblNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1jb21tb25cIjtcclxuXHJcbmZ1bmN0aW9uIGhpZGVCdG5NZW51KCkge1xyXG4gICAgY29uc3QgZGRtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mLWJ0bi1ncm91cC1kcm9wZG93bi1tZW51LnNob3dcIik7XHJcbiAgICBpZiAoZGRtKSB7XHJcbiAgICAgICAgZGRtLmNsYXNzTmFtZSA9IGRkbS5jbGFzc05hbWUucmVwbGFjZShcInNob3dcIiwgXCJcIik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVCdXR0b25NZW51KGUpIHtcclxuICAgIGlmICghZS50YXJnZXQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNsYXNzTGlzdCA9IEFycmF5LmZyb20oZS50YXJnZXQuY2xhc3NMaXN0IHx8IFtdKTtcclxuXHJcbiAgICBpZiAoZS50YXJnZXQubm9kZU5hbWUgIT09IFwiTElcIiAmJiAhZS50YXJnZXQuY2xvc2VzdCgnbGkuZHJvcGRvd24taXRlbScpICYmICFjbGFzc0xpc3QuaW5jbHVkZXMoXCJkcm9wZG93bi1pdGVtXCIpKSB7XHJcbiAgICAgICAgaGlkZUJ0bk1lbnUoKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6IFwiZmFycmlzLWJ1dHRvbi1ncm91cFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IGAuL2J1dHRvbi1ncm91cC5jb21wb25lbnQuaHRtbGAsXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc0J1dHRvbkdyb3VwQ29tcG9uZW50XHJcbiAgICBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3lcclxue1xyXG4gICAgQFZpZXdDaGlsZChcImRwQnRuXCIpIGRwQnRuOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZChcImRwTWVudVwiKSBkcE1lbnU6IEVsZW1lbnRSZWY7XHJcbiAgICAvLyDmqKrlkJHnuqDmraPnmoTlj4LnhadcclxuICAgIEBJbnB1dCgpIHJlY3RpZnlSZWZlcmVuY2VIOiBIVE1MRWxlbWVudDtcclxuICAgIC8vIOe6teWQkee6oOato+eahOWPgueFp1xyXG4gICAgQElucHV0KCkgcmVjdGlmeVJlZmVyZW5jZVY6IEhUTUxFbGVtZW50O1xyXG4gICAgLy8g5piv5ZCm6Ieq5Yqo57qg5q2j5L2N572uXHJcbiAgICBASW5wdXQoKSBhdXRvUmVjdGlmeSA9IHRydWU7XHJcbiAgICAvLyDorqHnrpfmlrnlkJHnmoTnnJ/mraNwbGFjZW1lbnRcclxuICAgIHByaXZhdGUgcmVhbFBsYWNlbWVudCA9IFwiYm90dG9tLXJpZ2h0XCI7XHJcbiAgICAvLyDph43mlrDorqHnrpflkI7nmoRwbGFjZW1lbnRcclxuICAgIHJlY3RpZnlQbGFjZW1lbnQgPSBcImJvdHRvbS1yaWdodFwiO1xyXG5cclxuICAgIC8qIOaMiemSruS/oeaBryAqL1xyXG4gICAgQElucHV0KCkgZGF0YTogQnV0dG9uW107XHJcblxyXG4gICAgLyog5pi+56S655qE5oyJ6ZKu5pWw6YePICDpu5jorqTkuLoyICovXHJcbiAgICBASW5wdXQoKSBjb3VudCA9IDI7XHJcblxyXG4gICAgLyog5oyJ6ZKu5aSn5bCPICovXHJcbiAgICBASW5wdXQoKSBzaXplID0gXCJzbWFsbFwiO1xyXG5cclxuICAgIC8qIOaMiemSruagt+W8jyAqL1xyXG4gICAgQElucHV0KCkgdHlwZSA9IFwicHJpbWFyeVwiO1xyXG5cclxuICAgIC8qIOaMiemSruWxleekuuS9jee9riAqL1xyXG4gICAgcHJpdmF0ZSBfcGxhY2VtZW50ID0gXCJib3R0b21cIjtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgcGxhY2VtZW50KHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5fcGxhY2VtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVhbFBsYWNlbWVudCA9IHRoaXMuZ2V0UmVhbFBsYWNlbWVudCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYWNlbWVudCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBwbGFjZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYWNlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICAvKiBtZW51IHNpemUgKi9cclxuICAgIC8qKlxyXG4gICAgICoyMDIxLjA2LjEyIOW6n+W8g++8jOWboOS4uuS9v+eUqOiAheS4jeefpemBk+WcqOS4reiLseaWh+aDheWGteS4i++8jOS4i+aLiemdouadv+eahOWuveW6puWSjOmrmOW6plxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSB3aWR0aCA9IDEyMDtcclxuICAgIEBJbnB1dCgpIGhlaWdodCA9IDI1MDtcclxuICAgIHByaXZhdGUgX21lbnVXaWR0aCA9IDA7XHJcbiAgICBwcml2YXRlIF9tZW51SGVpZ2h0ID0gMDtcclxuXHJcbiAgICAvKiDkuIvmi4nmjInpkq4g6Kem5Y+R5LqL5Lu2ICovXHJcbiAgICBAT3V0cHV0KCkgY2hhbmdlU3RhdGUgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICAvKiDkuIvmi4noj5zljZXpobnngrnlh7vkuovku7YgKi9cclxuICAgIEBPdXRwdXQoKSBjaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBjbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIC8qIOinpuWPkeS4i+aLieaMiemSrumdouadv+WMuuWfn+S5i+WklueahOS6i+S7tiAqL1xyXG4gICAgQE91dHB1dCgpIGNsaWNrTWVudU91dCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogMjAyMS4wNi4xMiDlup/lvIPvvIzlm6DkuLrlvZNhdXRvU2l6ZeS4unRydWXnmoTml7blgJnvvIzmjInpkq7mmL7npLrkuI3lh7rmnaXjgIJcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgYXV0b1NpemUgPSBmYWxzZTtcclxuXHJcbiAgICAvKiDkuIvmi4npnaLmnb/mmL7npLogKi9cclxuICAgIHNob3cgPSBmYWxzZTtcclxuICAgIC8qIOaYvuekuuWHuuadpeeahOaMiemSrue7hCAqL1xyXG4gICAgZ2V0IGZsYXRCdXR0b25zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEgJiYgdGhpcy5kYXRhLnNsaWNlKDAsIHRoaXMuY291bnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBkcEJ1dHRvbnMoKSB7XHJcbiAgICAgICAgLy8gdGhpcy5oZWlnaHQgPSB0aGlzLmRwQnV0dG9ucy5sZW5ndGggKiAzNTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEuc2xpY2UodGhpcy5jb3VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0UG9zaXRpb24kID0gbmV3IFN1YmplY3QoKTtcclxuICAgIGV2ZW50OiBhbnk7XHJcblxyXG4gICAgLyog5LiL5ouJ6Z2i5p2/5pi+56S65qCH5b+XICovXHJcbiAgICBkcEZsYWc6IGJvb2xlYW47XHJcblxyXG4gICAgLyog5LqL5Lu2ICovXHJcbiAgICBtb3VzZWVudGVyRXZlbnQ6IGFueTtcclxuICAgIG1vdXNlbGVhdmVFdmVudDogYW55O1xyXG4gICAgZG9jdW1lbnRDbGlja0V2ZW50OiBhbnk7XHJcblxyXG4gICAgLyog5LiJ5Liq54K55oyJ6ZKu5bC65a+4ICovXHJcbiAgICBidG5TaXplOiBhbnk7XHJcblxyXG4gICAgLyogICovXHJcbiAgICBzZXRUaW1lT2JqOiBhbnk7XHJcblxyXG5cdGJ0bm1lbnVpZCA9ICdidG4tbWVudS0nO1xyXG5cdHByaXZhdGUgcHJldmlvdXMgPSAwO1xyXG4gICAgb3ZlckxheVNlcnZpY2U6IE92ZXJMYXlIaWRkZW5TZXJ2aWNlO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjaGFuZ2VSZWY6IENoYW5nZURldGVjdG9yUmVmLCBwcml2YXRlIG5nWm9uZTogTmdab25lKSB7fVxyXG5cclxuXHRwcml2YXRlIGJ0bm1lbnVJZCgpIHtcclxuXHRcdGNvbnN0IGlkU2VyID0gbmV3IElkU2VydmljZSgpO1xyXG5cdFx0dGhpcy5idG5tZW51aWQgKz0gaWRTZXIuZ3VpZCgpO1xyXG4gICAgICAgIHRoaXMub3ZlckxheVNlcnZpY2UgPSBuZXcgT3ZlckxheUhpZGRlblNlcnZpY2UoKTtcclxuXHR9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5idG5tZW51SWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhzaW1wbGVDaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKHNpbXBsZUNoYW5nZXNbXCJkYXRhXCJdKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuZmxhdEJ1dHRvbnMgPSB0aGlzLmRhdGEuc2xpY2UoMCwgdGhpcy5jb3VudCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuZHBCdXR0b25zID0gdGhpcy5kYXRhLnNsaWNlKHRoaXMuY291bnQpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmhlaWdodCA9IHRoaXMuZHBCdXR0b25zLmxlbmd0aCAqIDM1O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7fVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5zaG93KSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCB9ID0gdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvbih0aGlzLmV2ZW50KTtcclxuICAgICAgICAgICAgLy8gdGhpcy5zZXRQb3NpdGlvbiQuc3Vic2NyaWJlKHJlcyA9PiB0aGlzLnNldFBvc2l0aW9uKHJlcywgd2lkdGgsIGhlaWdodCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGlja0V2ZW50KGU6IGFueSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5zaG93ID0gISh0aGlzLnNob3cgJiYgdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZignc2hvdycpID4gLTEpO1xyXG4gICAgICAgIC8vIGJvZHnmt7vliqDpnaLmnb9cclxuICAgICAgICBpZiAodGhpcy5zaG93KSB7XHJcblx0XHRcdC8qKiDnp7vpmaTnjrDmnInnmoTkuIvmi4nlsZXnpLroj5zljZUgKi9cclxuXHRcdFx0aGlkZUJ0bk1lbnUoKTtcclxuICAgICAgICAgICAgdGhpcy5hcHBlbmRCb2R5KCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuc2V0UG9zaXRpb24oZSk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuc2V0UG9zaXRpb24kLm5leHQoZSk7XHJcblxyXG4gICAgICAgICAgICAvLyDms6jlhozpvKDmoIfmu5rova7vvIzngrnlh7vkuovku7bvvIznlKjkuo7pmpDol49QYW5lbFxyXG4gICAgICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlLnJlZ2lzdGVyTW91c2VFdmVudCh0aGlzLmRwQnRuLm5hdGl2ZUVsZW1lbnQsIChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBoaWRlQnV0dG9uTWVudShlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnQgPSBlO1xyXG4gICAgICAgICAgICAvLyDnu5Hlrprnm7jlupTnmoTkuovku7ZcclxuICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kTWVudU1vdXNlZW50ZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZGlNZW51TW91c2VsZWF2ZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5iaW5kRG9jQ2xpY2soKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2VOb3RFbnRlckxlYXZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDpnaLmnb/mmL7npLog6ISP5YC85qOA5rWLXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VSZWYuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlUmVmLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgIC8vIHRoaXMuY2hhbmdlU3RhdGUuZW1pdCh7IG9yaWdpbkV2ZW50OiBlLCBzaG93OiB0aGlzLnNob3cgfSk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZS5lbWl0KHRoaXMuc2hvdyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyog5oyJ6ZKu6Kem5Y+R5LqL5Lu2ICovXHJcbiAgICB0b2dnbGUoZTogYW55LCBidG4pIHtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGlmIChidG4uZGlzYWJsZWQpIHJldHVybjtcclxuICAgICAgICB0aGlzLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAvLyB0aGlzLnVuYmluZERvY0NsaWNrKCk7XHJcbiAgICAgICAgLy8g5YWz6Zet5LiL5ouJ5oyJ6ZKu6Z2i5p2/ICDohI/lgLzmo4DmtYtcclxuICAgICAgICB0aGlzLmNoYW5nZVJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VSZWYubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2UuZW1pdChidG4uaWQpO1xyXG4gICAgICAgIHRoaXMuY2xpY2suZW1pdChidG4pO1xyXG5cclxuICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlLmRlc3RvcnkodGhpcy5kcEJ0bi5uYXRpdmVFbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDkuIvmi4nmjInpkq7mmL7npLrliLBib2R55LitICDlj6/mlLnlj5jpnaLmnb/mlrnlkJFcclxuICAgIGFwcGVuZEJvZHkoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZHBNZW51Lm5hdGl2ZUVsZW1lbnQgJiYgIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHk+IycgKyB0aGlzLmJ0bm1lbnVpZCkpIHtcclxuICAgICAgICAgICAgLy8g5re75Yqg5YiwYm9keSAg5L6/5LqO5YWo6YOo5pi+56S6XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cdFx0dGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5jbGFzc05hbWUgPSB0aGlzLmRwTWVudS5uYXRpdmVFbGVtZW50LmNsYXNzTmFtZSArICcgc2hvdyc7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlTWVudVBhbmVsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRwTWVudS5uYXRpdmVFbGVtZW50ICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHk+IycgKyB0aGlzLmJ0bm1lbnVpZCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPkuIvmi4notoXlh7rovrnnlYzml7YgIOi9rOaNouaWueWQkSxcclxuICAgICAqIOW5tuacquWkhOeQhu+8jOi+ueeVjOS4jeWkn+S4i+aLieWxleekuueahOaDheWGtVxyXG4gICAgICogQHBhcmFtIGJ0blNpemVcclxuICAgICAqL1xyXG4gICAgY2hhbmdlUGxhY2VtZW50KGJ0blNpemU6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5hdXRvUmVjdGlmeSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByZWZlclBvc2l0aW9uID0gdGhpcy5nZXRSZWZlcmVuY2VQb3NpdGlvbigpO1xyXG4gICAgICAgIGxldCBuZXdQbGFjZW1lbnQgPSB0aGlzLnJlYWxQbGFjZW1lbnQ7XHJcbiAgICAgICAgaWYgKG5ld1BsYWNlbWVudC5pbmRleE9mKFwiYm90dG9tXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX21lbnVIZWlnaHQgPiByZWZlclBvc2l0aW9uLmJvdHRvbSAtIGJ0blNpemUuYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdQbGFjZW1lbnQgPSBuZXdQbGFjZW1lbnQucmVwbGFjZShcImJvdHRvbVwiLCBcInRvcFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobmV3UGxhY2VtZW50LmluZGV4T2YoXCJ0b3BcIikgPiAtMSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVudUhlaWdodCA+IGJ0blNpemUudG9wIC0gcmVmZXJQb3NpdGlvbi50b3ApIHtcclxuICAgICAgICAgICAgICAgIG5ld1BsYWNlbWVudCA9IG5ld1BsYWNlbWVudC5yZXBsYWNlKFwidG9wXCIsIFwiYm90dG9tXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZXdQbGFjZW1lbnQuaW5kZXhPZihcImxlZnRcIikgPiAtMSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVudVdpZHRoID4gYnRuU2l6ZS5sZWZ0IC0gcmVmZXJQb3NpdGlvbi5sZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICBuZXdQbGFjZW1lbnQgPSBuZXdQbGFjZW1lbnQucmVwbGFjZShcImxlZnRcIiwgXCJyaWdodFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobmV3UGxhY2VtZW50LmluZGV4T2YoXCJyaWdodFwiKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZW51V2lkdGggPiByZWZlclBvc2l0aW9uLnJpZ2h0IC0gYnRuU2l6ZS5yaWdodCkge1xyXG4gICAgICAgICAgICAgICAgbmV3UGxhY2VtZW50ID0gbmV3UGxhY2VtZW50LnJlcGxhY2UoXCJyaWdodFwiLCBcImxlZnRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWN0aWZ5UGxhY2VtZW50ID0gbmV3UGxhY2VtZW50O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDnoa7orqTlj4LnhafnmoTovrnnlYxcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRSZWZlcmVuY2VQb3NpdGlvbigpIHtcclxuICAgICAgICBsZXQgclJpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgICAgIGxldCByQm90dG9tID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcclxuICAgICAgICBsZXQgclRvcCA9IDA7XHJcbiAgICAgICAgbGV0IHJMZWZ0ID0gMDtcclxuICAgICAgICAvLyDmqKrlkJHlj4LnhadcclxuICAgICAgICBpZiAodGhpcy5yZWN0aWZ5UmVmZXJlbmNlSCkge1xyXG4gICAgICAgICAgICByUmlnaHQgPSB0aGlzLnJlY3RpZnlSZWZlcmVuY2VILmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0O1xyXG4gICAgICAgICAgICByTGVmdCA9IHRoaXMucmVjdGlmeVJlZmVyZW5jZUguZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g57q15ZCR5Y+C54WnXHJcbiAgICAgICAgaWYgKHRoaXMucmVjdGlmeVJlZmVyZW5jZVYpIHtcclxuICAgICAgICAgICAgckJvdHRvbSA9IHRoaXMucmVjdGlmeVJlZmVyZW5jZVYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tO1xyXG4gICAgICAgICAgICByVG9wID0gdGhpcy5yZWN0aWZ5UmVmZXJlbmNlVi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IHRvcDogclRvcCwgbGVmdDogckxlZnQsIHJpZ2h0OiByUmlnaHQsIGJvdHRvbTogckJvdHRvbSB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlj5jljJblr7nlupTnmoRjbGFzc1xyXG4gICAgICogQHBhcmFtIHBvc2l0aW9uXHJcbiAgICAgKi9cclxuICAgIF9nZXRDbHNOYW1lKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgbGV0IGNsYXNzTmFtZSA9IFwiXCI7XHJcbiAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xyXG4gICAgICAgICAgICBjYXNlIFwidG9wLXJpZ2h0XCI6XHJcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcclxuICAgICAgICAgICAgICAgIC8vIOacneS4iu+8jOacneS4ii3mnJ3lj7NcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IFwiZHJvcHVwXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInRvcC1sZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAvLyDmnJ3kuIot5pyd5bemXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBcImRyb3B1cC1sZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImxlZnQtYm90dG9tXCI6XHJcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XHJcbiAgICAgICAgICAgICAgICAvLyDmqKrlkJHigJTigJTmnJ3lt6bigJTigJTmnJ3kuItcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IFwiZHJvcGxlZnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwibGVmdC10b3BcIjpcclxuICAgICAgICAgICAgICAgIC8vIOaoquWQkeKAlOKAlOacneW3puKAlOKAlOacneS4ilxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gXCJkcm9wbGVmdC11cFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodC1ib3R0b21cIjpcclxuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICAvLyDmqKrlkJHigJTigJTmnJ3lj7PigJTigJTmnJ3kuItcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IFwiZHJvcHJpZ2h0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInJpZ2h0LXRvcFwiOlxyXG4gICAgICAgICAgICAgICAgLy8g5qiq5ZCR4oCU4oCU5pyd5Y+z4oCU4oCU5pyd5LiKXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBcImRyb3ByaWdodC11cFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJib3R0b20tbGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgLy8g5pyd5LiL4oCU4oCU5pyd5bemXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBcImRyb3Bkb3duLWxlZnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tLXJpZ2h0XCI6XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBcImRyb3Bkb3duXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIC8vIOacneS4i++8jOacneS4i+KAlOKAlOacneWPs1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gXCJkcm9wZG93blwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2xhc3NOYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UmVhbFBsYWNlbWVudChwbWVudCkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBcImJvdHRvbS1yaWdodFwiO1xyXG4gICAgICAgIHN3aXRjaCAocG1lbnQpIHtcclxuICAgICAgICAgICAgY2FzZSBcInRvcFwiOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJ0b3AtcmlnaHRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJsZWZ0LWJvdHRvbVwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJyaWdodC1ib3R0b21cIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcImJvdHRvbS1yaWdodFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBwbWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgICog6K6h566X55qE5L2N572u5Yy65YiG5b+S57uG5YyWXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2hhbmdlUG9zaXRpb24oYnRuU2l6ZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHJwbGFjZW1lbnQgPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLmF1dG9SZWN0aWZ5KSB7XHJcbiAgICAgICAgICAgIHJwbGFjZW1lbnQgPSB0aGlzLnJlY3RpZnlQbGFjZW1lbnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcnBsYWNlbWVudCA9IHRoaXMucmVhbFBsYWNlbWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHN0eWxlVG9wID0gMDtcclxuICAgICAgICBsZXQgc3R5bGVMZWZ0ID0gMDtcclxuICAgICAgICBpZiAocnBsYWNlbWVudC5pbmRleE9mKFwidG9wXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgc3R5bGVUb3AgPSBidG5TaXplLnRvcCAtIHRoaXMuX21lbnVIZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIGlmIChycGxhY2VtZW50LmluZGV4T2YoXCJib3R0b21cIikgPiAtMSkge1xyXG4gICAgICAgICAgICBzdHlsZVRvcCA9IGJ0blNpemUuYm90dG9tO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocnBsYWNlbWVudC5pbmRleE9mKFwicmlnaHRcIikgPiAtMSkge1xyXG4gICAgICAgICAgICBzdHlsZUxlZnQgPSBidG5TaXplLnJpZ2h0O1xyXG4gICAgICAgIH0gZWxzZSBpZiAocnBsYWNlbWVudC5pbmRleE9mKFwibGVmdFwiKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIHN0eWxlTGVmdCA9IGJ0blNpemUubGVmdCAtIHRoaXMuX21lbnVXaWR0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5byA5aS0XHJcbiAgICAgICAgaWYgKHJwbGFjZW1lbnQuaW5kZXhPZihcIi10b3BcIikgPiAtMSkge1xyXG4gICAgICAgICAgICBzdHlsZVRvcCA9IHN0eWxlVG9wIC0gYnRuU2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIGlmIChycGxhY2VtZW50LmluZGV4T2YoXCItYm90dG9tXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgc3R5bGVUb3AgPSBzdHlsZVRvcCArIGJ0blNpemUuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRwTWVudS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9IHN0eWxlVG9wICsgXCJweFwiO1xyXG4gICAgICAgIHRoaXMuZHBNZW51Lm5hdGl2ZUVsZW1lbnQuc3R5bGUubGVmdCA9IHN0eWxlTGVmdCArIFwicHhcIjtcclxuICAgIH1cclxuXHJcbiAgICAvKiDnu5HlrprkuIvmi4npnaLmnb/pvKDmoIfov5vlhaXkuovku7YgKi9cclxuICAgIGJpbmRNZW51TW91c2VlbnRlcigpIHtcclxuICAgICAgICB0aGlzLnVuYmluZE1lbnVNb3VzZWVudGVyKCk7XHJcbiAgICAgICAgdGhpcy5tb3VzZWVudGVyRXZlbnQgPSB0aGlzLmNoYW5nZUZsYWdUb1RydWUuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmRwTWVudS5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgIFwibW91c2VlbnRlclwiLFxyXG4gICAgICAgICAgICB0aGlzLm1vdXNlZW50ZXJFdmVudFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyog57uR5a6a5LiL5ouJ6Z2i5p2/6byg5qCH56a75byA5LqL5Lu2ICAqL1xyXG4gICAgYmluZGlNZW51TW91c2VsZWF2ZSgpIHtcclxuICAgICAgICB0aGlzLnVuYmluZGlNZW51TW91c2VsZWF2ZSgpO1xyXG4gICAgICAgIHRoaXMubW91c2VsZWF2ZUV2ZW50ID0gdGhpcy5tb3VzZUxlYXZlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICBcIm1vdXNlbGVhdmVcIixcclxuICAgICAgICAgICAgdGhpcy5tb3VzZWxlYXZlRXZlbnRcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qIOe7keWumueCueWHu+mdouadv+WMuuWfn+S5i+WkluinpuWPkeeahOS6i+S7tiAqL1xyXG4gICAgLy8gYmluZERvY0NsaWNrKCkge1xyXG4gICAgLy8gICB0aGlzLmRvY3VtZW50Q2xpY2tFdmVudCA9IHRoaXMuY2xpY2tEb2MuYmluZCh0aGlzKTtcclxuICAgIC8vICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRvY3VtZW50Q2xpY2tFdmVudCk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgLyog6Kej57uR5LqL5Lu2ICovXHJcbiAgICB1bmJpbmRNZW51TW91c2VlbnRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5tb3VzZWVudGVyRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAgICAgXCJtb3VzZWVudGVyXCIsXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlZW50ZXJFdmVudFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVuYmluZGlNZW51TW91c2VsZWF2ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5tb3VzZWxlYXZlRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAgICAgXCJtb3VzZWxlYXZlXCIsXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlbGVhdmVFdmVudFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHVuYmluZERvY0NsaWNrKCkge1xyXG4gICAgLy8gICBpZiAodGhpcy5kb2N1bWVudENsaWNrRXZlbnQpIHtcclxuICAgIC8vICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZG9jdW1lbnRDbGlja0V2ZW50KTtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8qIGZsYWcgdHJ1ZSAqL1xyXG4gICAgY2hhbmdlRmxhZ1RvVHJ1ZSgpIHtcclxuICAgICAgICB0aGlzLmRwRmxhZyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyogZmxhZyBmYWxzZSAqL1xyXG4gICAgY2hhbmdlRmxhZ1RvRmFsc2UoKSB7XHJcbiAgICAgICAgdGhpcy5kcEZsYWcgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKiDpvKDmoIfnprvlvIDml7YgIOWFs+mXrW1lbnUgKi9cclxuICAgIG1vdXNlTGVhdmUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZHBGbGFnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlRmxhZ1RvRmFsc2UoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy51bmJpbmREb2NDbGljaygpO1xyXG4gICAgICAgICAgICB0aGlzLnVuYmluZGlNZW51TW91c2VsZWF2ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnVuYmluZE1lbnVNb3VzZWVudGVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0VGltZU9iaikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNldFRpbWVPYmopO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyog6byg5qCH5rKh5pyJ6L+b5YWl5Yiw6Z2i5p2/ICDkuIDmrrXml7bpl7TlkI7pnaLmnb/oh6rliqjmtojlpLEgKi9cclxuICAgIG1vdXNlTm90RW50ZXJMZWF2ZSgpIHtcclxuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcblx0XHRcdGlmICh0aGlzLnNldFRpbWVPYmopIHtcclxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5zZXRUaW1lT2JqKTtcclxuXHRcdFx0fVxyXG4gICAgICAgICAgICB0aGlzLnNldFRpbWVPYmogPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kcEZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUZsYWdUb0ZhbHNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy51bmJpbmREb2NDbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5iaW5kaU1lbnVNb3VzZWxlYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmJpbmRNZW51TW91c2VlbnRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXRUaW1lT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNldFRpbWVPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMjAwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyog5YWz6Zet5LiL5ouJ6Z2i5p2/ICovXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAvLyDlhbPpl63kuIvmi4nmjInpkq7pnaLmnb8gIOiEj+WAvOajgOa1i1xyXG4gICAgICAgIGlmICghdGhpcy5jaGFuZ2VSZWZbXCJkZXN0cm95ZWRcIl0pIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VSZWYuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVJlZi5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kcEJ0bi5uYXRpdmVFbGVtZW50LmJsdXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5vdmVyTGF5U2VydmljZS5kZXN0b3J5KHRoaXMuZHBCdG4ubmF0aXZlRWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyog5Yqo5oCB5oyH5a6abWVudeWcqGJvZHnkuK3nmoTkvY3nva4gKi9cclxuICAgIHByaXZhdGUgc2V0UG9zaXRpb24oZSkge1xyXG4gICAgICAgIC8vIOS4i+aLieaMiemSrlxyXG4gICAgICAgIGNvbnN0IGJ0blNpemUgPSB0aGlzLmRwQnRuLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgLy8g5LiL5ouJ6Z2i5p2/XHJcbiAgICAgICAgbGV0IG1lbnVSZWN0ID0gdGhpcy5kcE1lbnUubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB0aGlzLl9tZW51SGVpZ2h0ID0gbWVudVJlY3QuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuX21lbnVXaWR0aCA9IG1lbnVSZWN0LndpZHRoO1xyXG4gICAgICAgIC8vIOWmguaenOimgeiHquWKqOe6oOato+aWueWQkVxyXG4gICAgICAgIGlmICh0aGlzLmF1dG9SZWN0aWZ5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUGxhY2VtZW50KGJ0blNpemUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYW5nZVBvc2l0aW9uKGJ0blNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIC8vIHRoaXMucmVtb3ZlTWVudVBhbmVsKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZHBCdG4gJiYgdGhpcy5kcEJ0bi5uYXRpdmVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMub3ZlckxheVNlcnZpY2UuZGVzdG9yeSh0aGlzLmRwQnRuLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlID0gbnVsbDtcclxuICAgIH1cclxufVxyXG4iXX0=