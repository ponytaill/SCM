import { Injector, Injectable, Optional, SkipSelf, InjectFlags } from '@angular/core';
import { Repository } from '../repository/index';
import { BindingData } from '../binding-data/index';
import { UIState, PARAM_TYPE_TRANSFORM_TOKEN } from '../ui-state/index';
import { Form } from '../form/index';
import { StateMachine } from '../state-machine/index';
import { ViewModel } from '../view-model/index';
import { CommandBus, CommandHandlerExtenderRegistry, CommandHandlerFactory, CommandHandlerRegistry } from '../command/index';
import { Context } from '../context/index';
import { AppContext } from '../app/index';
import { RouterParamService } from '../misc/index';
import { FRAME_ID, NAMESPACE } from './tokens';
import { ChangeType } from '../binding-data/index';
import { EventBus } from '../event-bus-new/index';
import { EXCEPTION_HANDLER } from '../exception/tokens';
import { EntityUtil } from '../binding-data/entity_util';
import { TranslateToken } from '../i18n/translate_token';
import { VariableParseService } from '../variable/variable_parse_service';
import { TranslateService } from '../i18n/translate_service';
import { UserSettingsToken } from '../i18n/tokens';
import { UserSettingsService } from '../i18n/user_settings_service';
import { ExpressionEngineImpl } from '../expression/expression_engine_impl';
import { ExpressionManager } from '../expression/expression_manager';
import { ExpressionResult } from '../expression/expression_result';
import { ExpressionResultFactory } from '../expression/expression_result_factory';
import { CommandVariableParser, DataVariableParser, FrameIdVariableParser, StateMachineVariableParser, UIStateVariableParser } from '../variable';
import { CHANGE_SET_POLICY_TOKEN, RunMode } from '../core';
import { Subject } from 'rxjs';
import { ComponentRefManager } from './component_ref_manager';
/**
 * 组件上下文
 * @description
 * # 上下文
 * ## Overview
 *
 * 每个组件（FrameComponent）都有自己的上下文（FrameContext）,通过上下文可以获取控制器的所有属性，如常用的`frameId`、`BindingData`、`Repository`、`ViewModel`、`StateMachine`、 * `UIState`等。上下文在内存中呈树形结构，依附于FrameComponent。结构如下：
 *
 * ![image-20210806204755378](https://open.inspuronline.com/iGIX/assets/cloudplus/igix_2110/farris/devkit/guide/images/image-20210806204755378.png)
 *
 * 从上图我们可以看出每个上下文都有自己的`ViewModel`、`UIState`，那么如何确定一个命令在执行时用的是哪个上下文呢？其实无论命令在哪个地方被调用，上下文都是命令所在的组件的上下文。即，如果 * 命令挂载到了`detail-form-component`的视图模型，但命令最终被`root-component`上的按钮调用了，其上下文仍然是`detail-from-component`组件的上下文。之所以出现这种现象和Angular的依赖注 * 入密不可分，由于Angular在查找`provider`的时候总是从自己的组件开始向上找，如果在组件内部找到了则不再继续查找，如果找不到则会继续向上，如果查找到最上级依然找不到就会报`No provider  * for xx`错误。
 *
 * 既然如此，如果我们在`detail-form-component`中想要获取`root-component`中定义的变量（UIState）该如何做呢？答案是切换上下文，可以通过以下方式实现：
 *
 * ```typescript
 * // 方法1
 * const rootFrameContext = this.frameContext.root;
 * // 方法2
 * const rootFrameContext = this.frameContext.appContext.frameContextManager.getFrameContextById('root-component');
 * ```
 *
 * 通常在编写`Web构件`时先引入FrameContext，如：
 *
 * ```javascript
 * import {FrameContext,BindingData,Repository} from '@farris/devkit';
 *
 * constructor(private frameContext:FrameContext){}
 *
 * public method(){
 *     const bindingData: BindingData = this.frameContext.bindingData;
 *     const repository: Repository = this.frameContext.repository;
 * }
 * ```
 *
 * > `FrameContext`称为`ViewModelContext`更合适，可以理解为`MVVM`架构中`VM`的上下文。
 *
 * 控制器中亦存在`ViewModel`的概念。和`MVVM`架构中的的VM一致，所以也可以从`VM`访问常用的属性。如：
 *
 * ```typescript
 * import {BindingData,Repository,ViewModel} from '@farris/devkit';
 *
 * constructor(private viewModel:ViewModel){}
 *
 * public method(){
 *     const bindingData: BindingData = this.viewModel.bindingData;
 *     const repository: Repository = this.viewModel.repository;
 * }
 * ```
 *
 *
 *
 * ## 常用操作
 *
 * ### 获取当前上下文所属的组件
 *
 * ```typescript
 * this.frameContext.frameComponent;
 * ```
 *
 * ### 获取当前上下文的根上下文
 *
 * ```typescript
 * this.frameContext.root;
 * ```
 *
 * ### 获取当前上下文的appContext
 *
 * ```typescript
 * this.frameContext.appContext;
 * ```
 *
 * ### 获取指定frameId的上下文
 *
 * ```typescript
 * this.frameContext.appContext.frameContextManager.getFrameContextById('data-grid-component');
 * ```
 *
 * ### 获取表单所有上下文
 *
 * ```typescript
 * this.frameContext.appContext.frameContextManager.getFrameContexts();
 * ```
 *
 *
 *
 * ## 常用属性
 *
 * ### BindingData
 *
 * [参考]([浪潮企业云开放平台 (inspuronline.com)](https://open.inspuronline.com/iGIX/#/document/mddoc/igix-2103%2Ffarris%2Fdevkit%2Fguide%2F绑定数据.md))
 *
 * ### Repository
 *
 * [参考]([浪潮企业云开放平台 (inspuronline.com)](https://open.inspuronline.com/iGIX/#/document/mddoc/igix-2103%2Ffarris%2Fdevkit%2Fguide%2F仓库.md))
 *
 * ### ViewModel
 *
 * 控制器中ViewMode同MVVM架构中的VM，和FrameContext类似，可以通过ViewModel拿到FrameContext，同样的也可以通过FrameContext拿到ViewModel。
 *
 * ### namespace
 *
 * 命名空间，主要在组合表单场景用到，每一个表单都有自己的命名空间，被组合进来的表单其命名空间是相同的，如A表单组合了B表单，则B表单具有相同的命名空间，命名空间主要用于表单隔离。
 *
 * ### root
 *
 * 获取整个表单的根上下文
 *
 * ### uiState
 *
 * 获取当前组件的变量
 *
 * ### frameId
 *
 * 上下文标识。
 */
export class FrameContext extends Context {
    /**
     * 构造函数
     * @param injector 注入器
     */
    constructor(injector, parent) {
        super();
        this.injector = injector;
        this.typeName = 'FrameContext';
        this.isDestoried = false;
        this.isDisposed = false;
        this.metadata = {
            identify: '',
            namespace: '',
            commands: null,
            form: null,
            formControls: null,
            subForms: null,
            stateMachine: null,
            uiStates: null,
            bindingTo: ''
        };
        /**
         * 组件引用管理
         */
        this.componentRefManager = new ComponentRefManager();
        // 在解析模式下，通过依赖注入获取不到AppContext时，返回null，在子类中进行赋值。
        this.appContext = injector.get(AppContext);
        this.destorySignal = new Subject();
        // 确定父子关系
        // 必须对appContext进行判断，原因如下：
        // 1、否则会导致动态路由表单中，被路由的表单的RootFrameContext变成主表单的RootFrameContext；
        // 2、进而导致从RootFrameContext上拿VO变量拿不到。
        if (!parent || parent.appContext !== this.appContext) { // 取消 appContext 的判断
            this.parent = null;
            this.root = this;
        }
        else {
            this.parent = parent;
            this.root = parent.root;
        }
        this.frameId = injector.get(FRAME_ID);
        if (this.appContext.contextMetadataManager.exsit(this.frameId)) {
            this.metadata = this.appContext.contextMetadataManager.getContextMetadataByName(this.frameId);
        }
        this.namespace = injector.get(NAMESPACE, null);
        this.bindingData = this.injector.get(BindingData, new BindingData());
        if (!this.appContext.useIsoluteEventBus || (this.appContext.useIsoluteEventBus && !this.appContext.isoluteEventBus)) {
            this.eventBus = this.injector.get(EventBus, null, InjectFlags.Optional);
        }
        else {
            this.eventBus = this.appContext.isoluteEventBus;
        }
        this.form = this.injector.get(Form, new Form());
        this.repository = this.injector.get(Repository, this.appContext.repository);
        // 获取变更集策略，默认只提交合法的变更
        const changeSetPolicy = this.injector.get(CHANGE_SET_POLICY_TOKEN, 'valid');
        if (this.repository) {
            this.repository.entityCollection.changeSetPolicy = changeSetPolicy;
        }
        this.uiState = this.injector.get(UIState, new UIState());
        const defaultViewModel = new ViewModel();
        defaultViewModel.setMetadata(this.metadata);
        this.viewModel = this.injector.get(ViewModel, defaultViewModel);
        this.variableParseService = injector.get(VariableParseService, new VariableParseService([
            new FrameIdVariableParser(),
            new DataVariableParser(),
            new UIStateVariableParser(),
            new StateMachineVariableParser(),
            new CommandVariableParser()
        ]));
        // 注入exceptionHandler
        this.exceptionHandler = injector.get(EXCEPTION_HANDLER, null, InjectFlags.Optional);
        // 初始化多语服务
        const translate = injector.get(TranslateToken, null);
        this.translate = translate;
        TranslateService.setTranslate(translate);
        // 初始化用户配置
        const userSettings = injector.get(UserSettingsToken, null);
        UserSettingsService.setUserSettings(userSettings);
        this.initializeRepository();
        this.appContext.regFrameContext(this);
        this.registerAppContextDestroyEvent();
    }
    dispose(options) {
        if (this.isDisposed) {
            return;
        }
        this.isDestoried = true;
        this.isDisposed = true;
        if (this.destorySignal) {
            this.destorySignal.next();
            this.destorySignal.complete();
        }
        if (this.appContext) {
            this.appContext.frameContextManager.unregFrameContext(this);
            this.appContext.frameComponentRefresher.unregFrameContext(this);
        }
        if (this.appContext && this.isRootFrameContext() === true) {
            const viewModelNames = this['viewModelNames'];
            if (viewModelNames && Array.isArray(viewModelNames)) {
                viewModelNames.forEach(name => {
                    this[name] = null;
                });
            }
            this.appContext.unregisterFromManager();
        }
        if (this.bindingData) {
            this.bindingData.dispose();
            // this.bindingData = null;
        }
        if (this.viewModel) {
            this.viewModel.dispose();
        }
        if (this.form) {
            this.form.dispose();
            this.form = null;
        }
        if (this.commandBus) {
            this.commandBus.dispose();
            this.commandBus = null;
        }
        TranslateService.dispose();
        // this.root = null;
        // this.parent = null;
        // this.uiState = null;
        this.frameComponent = null;
        this.repository = null;
        // this.stateMachine = null;
        // this.appContext = null;
        this.exceptionHandler = null;
        this.expressionManager = null;
        this.expressionEngineImpl = null;
        this.variableParseService = null;
        this.eventBus = null;
        this.translate = null;
        this.injector = null;
        this.expressionResult = null;
        UserSettingsService.setUserSettings(null);
    }
    ngOnDestroy() {
        this.dispose();
    }
    /**
     * 通过组件标识获取对应的组件实例
     * @param id 组件标识
     * @returns
     */
    getComponentById(id) {
        const components = this.componentRefManager.get(id);
        if (components && components.length > 0) {
            const component = components[0];
            return component;
        }
        return null;
    }
    /**
     * 获取指定标识的所有组件
     * @param id 组件标识
     */
    getComponentsById(id) {
        return this.componentRefManager.get(id);
    }
    bindInjector(componentInjector) {
        this.injector = componentInjector;
    }
    // #region 初始化
    /**
     * 初始化
     * @todo:
     * 1、CommandHandler中的服务可能会注入Context，所以CommandHandler创建时必须已经存在ComponentContext
     * 2、ViewModel的buildCommands中会使用CommandBus，为了保证顺序，将ViewModel的创建也放在init中。
     */
    init(frameComponent) {
        this.frameComponent = frameComponent;
        this.initializeBindingData();
        this.initializeStateMachine();
        this.initializeUiState();
        this.initializeForm();
        this.initializeCommandBus();
        this.initializeViewModel();
        this.registerExceptionHandler();
        this.initExpression();
        this.appContext.frameComponentRefresher.regFrameComponent(this.frameId, this.frameComponent);
    }
    initExpression() {
        this.expressionEngineImpl = this.injector.get(ExpressionEngineImpl, null);
        this.expressionManager = this.injector.get(ExpressionManager, null);
        const expressionResultFactory = this.injector.get(ExpressionResultFactory, null);
        this.expressionResult = this.injector.get(ExpressionResult, null);
    }
    /**
     * 订阅异常消息
     */
    registerExceptionHandler() {
        // tslint:disable: no-string-literal
        const formAppContext = this.getFormAppContext();
        const applicationId = formAppContext.ApplicationId;
        window[window.location.href] = applicationId;
        if (this.exceptionHandler !== null) {
            const applicationContext = window[applicationId] = window[applicationId] || {};
            if (this.eventBus !== null && this.isRootFrameContext()) {
                applicationContext.isExceptionHandlerExist = true;
                this.exceptionHandler.setContext(this.appContext);
                this.eventBus.on('Exception', '', 'onException', formAppContext, (error) => {
                    if (this.isDestoried === true) {
                        return;
                    }
                    if (error && error.error) {
                        try {
                            error.error.__frame_context__ = this;
                        }
                        catch (_a) { }
                    }
                    this.exceptionHandler.handle(error);
                });
            }
            this.destorySignal.subscribe(() => {
                this.eventBus.off('Exception', '', 'onException', formAppContext);
            });
        }
    }
    registerAppContextDestroyEvent() {
        if (this.appContext && this.appContext.destorySignal) {
            this.appContext.destorySignal.subscribe(() => {
                if (this.stateMachine) {
                    this.stateMachine.dispose();
                    this.stateMachine = null;
                }
                if (this.repository) {
                    this.repository.dispose();
                }
            });
        }
    }
    /**
     * 获取表单appcontext，即最上层appcontext
     */
    getFormAppContext() {
        return this.appContext;
    }
    /**
     * 获取frameId
     * @description 获取完整的FrameId，在非普通表单中该值等于frameId，在组合表单中该值为namespace_frameId
     */
    getFrameId(relativeFrameId) {
        if (!relativeFrameId) {
            return this.frameId;
        }
        if (this.namespace && this.namespace.length > 0) {
            return `${this.namespace}_${relativeFrameId}`;
        }
        else {
            return relativeFrameId;
        }
    }
    /**
     * 初始化Repository
     */
    initializeRepository() {
        this.repository.setPaginationConfig(this.repository.paginationInfo);
    }
    initializeForm() {
        // 设置Form语言服务
        // this.form.setTranslateService(translateService);
        // 初始化Form，提取FormControl定义，添加FormControl
        // this.form.init(this.bindingData, this.metadata.bindingTo, this);
        // Form
        this.form = this.injector.get(Form, null);
        if (this.form) {
            // 设置Form语言服务
            this.form.setTranslateService(this.injector.get(TranslateToken, null));
            // 初始化Form，提取FormControl定义，添加FormControl
            const bindingPath = this.viewModel.bindingPath || this.metadata.bindingTo;
            this.form.init(this.bindingData, bindingPath, this);
        }
    }
    initializeStateMachine() {
        // StateMachine 状态机需要在绑定数据之后加载
        this.stateMachine = this.injector.get(StateMachine, null);
        if (this.stateMachine) {
            this.stateMachine.initialize(this, this.variableParseService);
        }
    }
    initializeCommandBus() {
        const handlerRegistry = this.injector.get(CommandHandlerRegistry, new CommandHandlerRegistry(this.metadata.commandHandlers));
        const extendsRegistry = this.injector.get(CommandHandlerExtenderRegistry, new CommandHandlerExtenderRegistry(this.metadata.commandHandlerExtends));
        const commandHandlerFactory = new CommandHandlerFactory(handlerRegistry, extendsRegistry, this, this.variableParseService);
        this.commandBus = new CommandBus(commandHandlerFactory);
    }
    /**
     * 初始化ViewModel
     * @todo
     * 1、需要按照一定的顺序进行初始化，否则依赖无法正确处理；
     * 2、暂时使用init解决Context和其他部分的循环依赖问题，待优化；
     */
    initializeViewModel() {
        if (!this.metadata.bindingTo) {
            this.metadata.bindingTo = this.viewModel.bindingPath;
        }
        this.viewModel.init(this);
        this.regViewModel(this.viewModel);
    }
    /**
     * 初始化BindingData
     * @summary
     * 老表单：repositoryName为空，复制当前Repository里的数据；
     * 新表单：repositoryName有值，引用全局BindingData里的数据；
     */
    initializeBindingData() {
        const repositoryName = this.repository.name;
        const isRunAtHighSpeedMode = this.appContext.runMode === RunMode.highSpeed;
        if (repositoryName && isRunAtHighSpeedMode) {
            const repositoryBindingData = this.appContext.bindingDataManager.getBindingDataByName(repositoryName);
            this.bindingData.initByBindingList(repositoryBindingData.list, this.viewModel.bindingPath);
            this.bindingData.pagingInfo = repositoryBindingData.pagingInfo;
            this.bindingData.setDataTypeInfo(this.repository.entityTypeInfo);
            EntityUtil.watchReposiroty(this.repository, this.bindingData);
        }
        else {
            this.bindingData.initByRepository(this.repository, this.viewModel.bindingPath);
            EntityUtil.watchReposiroty(this.repository, this.bindingData);
            this.bindingData.changes.subscribe((change) => {
                if (change.type === ChangeType.GlobalSelectionChanged) {
                    this.appContext.handleSelectChange(change, this);
                }
            });
        }
    }
    /**
     * 初始化UIState
     * 合并路由参数到UIState中
     */
    initializeUiState() {
        const isInFramework = window.location.href.indexOf('platform') > -1;
        const paramTypeTransform = this.injector.get(PARAM_TYPE_TRANSFORM_TOKEN, false);
        // 获取UIState
        this.uiState = this.injector.get(UIState, null);
        if (!this.uiState) {
            return;
        }
        this.uiState.paramTypeTransform = paramTypeTransform;
        this.uiState.initialize(this);
        // 获取路由参数
        const url = (this.appContext && this.appContext.router && this.appContext.router.url) || '';
        const routerParamService = new RouterParamService();
        const routerParams = routerParamService.getParams(url);
        // 在UIState为路由参数创建属性
        Object.keys(routerParams).forEach((propName) => {
            Object.defineProperty(this.uiState, propName, {
                get: () => {
                    return routerParams[propName];
                }
            });
        });
    }
    /**
     * 注册子ViewModel
     * @todo
     * 1、propName写死了
     */
    regViewModel(viewModel) {
        if (this.appContext && this.appContext.viewModelManager.exsit(viewModel.name) === false) {
            this.appContext.viewModelManager.register(viewModel.name, viewModel);
        }
        const className = viewModel.constructor.name;
        const parentContext = this.parent;
        let parentViewModel = null;
        if (parentContext && parentContext.viewModel) {
            parentViewModel = parentContext.viewModel;
        }
        if (!parentViewModel) {
            return;
        }
        // 优先使用生成器生成的name
        const childViewModels = parentViewModel['childViewModels'];
        let viewModelName = null;
        if (childViewModels) {
            const name = viewModel.constructor.name;
            viewModelName = childViewModels[viewModel.name] || childViewModels[name];
        }
        else if (className.length === 1) {
            const classNameTokens = viewModel.name.split('-').map((nameToken, index) => {
                if (index > 0 && nameToken.length) {
                    const pasicalName = nameToken.charAt(0).toLocaleUpperCase() + nameToken.substr(1, nameToken.length - 1);
                    return pasicalName;
                }
                else if (index === 0 && nameToken.length) {
                    const camelName = nameToken.charAt(0).toLocaleLowerCase() + nameToken.substr(1, nameToken.length - 1);
                    return camelName;
                }
                return nameToken;
            });
            viewModelName = classNameTokens.join('');
        }
        else if (viewModel["relateChildName"]) {
            // 增加该参数的目的  是为了解析表单可以进行和生成型相同的层级结构
            viewModelName = viewModel["relateChildName"];
        }
        // 兼容产品部老表单的写法，如果需要vm name统一，应按照此规则
        if (!viewModelName) {
            viewModelName = className[0].toLowerCase() + className.substring(1, className.length);
        }
        parentViewModel['viewModelNames'] = parentViewModel['viewModelNames'] || [];
        parentViewModel[viewModelName] = viewModel;
        parentViewModel['viewModelNames'].push(viewModelName);
        viewModel.bindToParent(parentViewModel);
    }
    // #endregion
    /**
     * 检查是否为根FrameContext
     * @summary
     * 检查该FrameContext是不是所在AppContext中的根FrameContext
     */
    isRootFrameContext() {
        return this.parent === null || (this.appContext.runMode === RunMode.highSpeed && this.getVirtualRootFrameContext().frameComponent['isDialogRootComponent'] === true);
    }
    /**
     * 通过namespace获取当前表单的root-framecontext(非整个表单)
     * @description
     * 如果为组合表单，其当前表单的root-framecontext为单个表单的framecontext，而非整个表单的framecontext
     */
    getVirtualRootFrameContext() {
        let formFrameContext = this;
        let parent = this.parent;
        while (parent) {
            // 兼容没有重新编译的表单，如果判断parent.namespace存在会导致获取不到root-framecontext
            if (parent.namespace === this.namespace) {
                formFrameContext = parent;
                parent = parent.parent;
            }
            else {
                break;
            }
        }
        return formFrameContext;
    }
    getContextById(identify) {
        return this.appContext.getContextById(identify);
    }
    getViewModel(viewModelName) {
        const renderAppContext = this.appContext;
        if (renderAppContext) {
            return renderAppContext.viewModelManager.getViewModelByName(viewModelName);
        }
        return null;
    }
    attachViewComponent(viewComponent) {
        this.frameComponent = viewComponent;
        this.appContext.frameComponentRefresher.regFrameComponent(this.frameId, this.frameComponent);
    }
    invoke(actionPath, $event) {
        const actionBindingPath = actionPath.split('.');
        const actionName = actionBindingPath[actionBindingPath.length - 1];
        const bindingViewModel = actionBindingPath.length === 1 ? this.viewModel :
            this.getViewModel(actionBindingPath[actionBindingPath.length - 2]);
        if (!bindingViewModel) {
            alert(`未匹配到'${actionPath}'命令的视图模型，请检查事件是否配置正确。`);
        }
        return bindingViewModel[actionName]($event);
    }
}
FrameContext.decorators = [
    { type: Injectable }
];
/** @nocollapse */
FrameContext.ctorParameters = () => [
    { type: Injector },
    { type: FrameContext, decorators: [{ type: Optional }, { type: SkipSelf }] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnJhbWVfY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2ZyYW1lL2ZyYW1lX2NvbnRleHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQWEsTUFBTSxlQUFlLENBQUM7QUFHakcsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDeEUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyQyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxVQUFVLEVBQUUsOEJBQThCLEVBQUUscUJBQXFCLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUM3SCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDM0MsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUMxQyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbkQsT0FBTyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDL0MsT0FBTyxFQUFVLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzNELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUdsRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsVUFBVSxFQUFF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LGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1NBQzVFO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRU0sbUJBQW1CLENBQUMsYUFBNkI7UUFDdEQsSUFBSSxDQUFDLGNBQWMsR0FBRyxhQUFhLENBQUM7UUFDcEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUMvRixDQUFDO0lBRU0sTUFBTSxDQUFDLFVBQWtCLEVBQUUsTUFBVztRQUMzQyxNQUFNLGlCQUFpQixHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDaEQsTUFBTSxVQUFVLEdBQUcsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25FLE1BQU0sZ0JBQWdCLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3hFLElBQUksQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckUsSUFBSSxDQUFDLGdCQUFnQixFQUFFO1lBQ3JCLEtBQUssQ0FBQyxRQUFRLFVBQVUsdUJBQXVCLENBQUMsQ0FBQztTQUNsRDtRQUNELE9BQU8sZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDOUMsQ0FBQzs7O1lBdGtCRixVQUFVOzs7O1lBN0pGLFFBQVE7WUFrU3dELFlBQVksdUJBQTNDLFFBQVEsWUFBSSxRQUFRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0b3IsIEluamVjdGFibGUsIE9wdGlvbmFsLCBTa2lwU2VsZiwgSW5qZWN0RmxhZ3MsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBFbnRpdHkgfSBmcm9tICcuLi9lbnRpdHkvaW5kZXgnO1xyXG5pbXBvcnQgeyBSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yeS9pbmRleCc7XHJcbmltcG9ydCB7IEJpbmRpbmdEYXRhIH0gZnJvbSAnLi4vYmluZGluZy1kYXRhL2luZGV4JztcclxuaW1wb3J0IHsgVUlTdGF0ZSwgUEFSQU1fVFlQRV9UUkFOU0ZPUk1fVE9LRU4gfSBmcm9tICcuLi91aS1zdGF0ZS9pbmRleCc7XHJcbmltcG9ydCB7IEZvcm0gfSBmcm9tICcuLi9mb3JtL2luZGV4JztcclxuaW1wb3J0IHsgU3RhdGVNYWNoaW5lIH0gZnJvbSAnLi4vc3RhdGUtbWFjaGluZS9pbmRleCc7XHJcbmltcG9ydCB7IFZpZXdNb2RlbCB9IGZyb20gJy4uL3ZpZXctbW9kZWwvaW5kZXgnO1xyXG5pbXBvcnQgeyBDb21tYW5kQnVzLCBDb21tYW5kSGFuZGxlckV4dGVuZGVyUmVnaXN0cnksIENvbW1hbmRIYW5kbGVyRmFjdG9yeSwgQ29tbWFuZEhhbmRsZXJSZWdpc3RyeSB9IGZyb20gJy4uL2NvbW1hbmQvaW5kZXgnO1xyXG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSAnLi4vY29udGV4dC9pbmRleCc7XHJcbmltcG9ydCB7IEFwcENvbnRleHQgfSBmcm9tICcuLi9hcHAvaW5kZXgnO1xyXG5pbXBvcnQgeyBSb3V0ZXJQYXJhbVNlcnZpY2UgfSBmcm9tICcuLi9taXNjL2luZGV4JztcclxuaW1wb3J0IHsgRlJBTUVfSUQsIE5BTUVTUEFDRSB9IGZyb20gJy4vdG9rZW5zJztcclxuaW1wb3J0IHsgQ2hhbmdlLCBDaGFuZ2VUeXBlIH0gZnJvbSAnLi4vYmluZGluZy1kYXRhL2luZGV4JztcclxuaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICcuLi9ldmVudC1idXMtbmV3L2luZGV4JztcclxuaW1wb3J0IHsgRnJhbWVDb21wb25lbnQgfSBmcm9tICcuL2ZyYW1lX2NvbXBvbmVudCc7XHJcbmltcG9ydCB7IElFeGNlcHRpb25IYW5kbGVyIH0gZnJvbSAnLi4vZXhjZXB0aW9uL3R5cGVzJztcclxuaW1wb3J0IHsgRVhDRVBUSU9OX0hBTkRMRVIgfSBmcm9tICcuLi9leGNlcHRpb24vdG9rZW5zJztcclxuaW1wb3J0IHsgRW50aXR5VXRpbCB9IGZyb20gJy4uL2JpbmRpbmctZGF0YS9lbnRpdHlfdXRpbCc7XHJcbmltcG9ydCB7IFRyYW5zbGF0ZVRva2VuIH0gZnJvbSAnLi4vaTE4bi90cmFuc2xhdGVfdG9rZW4nO1xyXG5pbXBvcnQgeyBWYXJpYWJsZVBhcnNlU2VydmljZSB9IGZyb20gJy4uL3ZhcmlhYmxlL3ZhcmlhYmxlX3BhcnNlX3NlcnZpY2UnO1xyXG5pbXBvcnQgeyBJQ29udGV4dE1ldGFkYXRhIH0gZnJvbSAnLi4vYXBwL2FwcF9tZXRhZGF0YSc7XHJcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UgfSBmcm9tICcuLi9pMThuL3RyYW5zbGF0ZV9zZXJ2aWNlJztcclxuaW1wb3J0IHsgVHJhbnNsYXRlIH0gZnJvbSAnLi4vaTE4bic7XHJcbmltcG9ydCB7IFVzZXJTZXR0aW5ncyB9IGZyb20gJy4uL2kxOG4vdHlwZXMnO1xyXG5pbXBvcnQgeyBVc2VyU2V0dGluZ3NUb2tlbiB9IGZyb20gJy4uL2kxOG4vdG9rZW5zJztcclxuaW1wb3J0IHsgVXNlclNldHRpbmdzU2VydmljZSB9IGZyb20gJy4uL2kxOG4vdXNlcl9zZXR0aW5nc19zZXJ2aWNlJztcclxuaW1wb3J0IHsgRXhwcmVzc2lvbkVuZ2luZUltcGwgfSBmcm9tICcuLi9leHByZXNzaW9uL2V4cHJlc3Npb25fZW5naW5lX2ltcGwnO1xyXG5pbXBvcnQgeyBFeHByZXNzaW9uTWFuYWdlciB9IGZyb20gJy4uL2V4cHJlc3Npb24vZXhwcmVzc2lvbl9tYW5hZ2VyJztcclxuaW1wb3J0IHsgRXhwcmVzc2lvblJlc3VsdCB9IGZyb20gJy4uL2V4cHJlc3Npb24vZXhwcmVzc2lvbl9yZXN1bHQnO1xyXG5pbXBvcnQgeyBFeHByZXNzaW9uUmVzdWx0RmFjdG9yeSB9IGZyb20gJy4uL2V4cHJlc3Npb24vZXhwcmVzc2lvbl9yZXN1bHRfZmFjdG9yeSc7XHJcbmltcG9ydCB7XHJcbiAgQ29tbWFuZFZhcmlhYmxlUGFyc2VyLCBEYXRhVmFyaWFibGVQYXJzZXIsIEZyYW1lSWRWYXJpYWJsZVBhcnNlcixcclxuICBTdGF0ZU1hY2hpbmVWYXJpYWJsZVBhcnNlciwgVUlTdGF0ZVZhcmlhYmxlUGFyc2VyXHJcbn0gZnJvbSAnLi4vdmFyaWFibGUnO1xyXG5pbXBvcnQgeyBDaGFuZ2VTZXRQb2xpY3ksIENIQU5HRV9TRVRfUE9MSUNZX1RPS0VOLCBSdW5Nb2RlIH0gZnJvbSAnLi4vY29yZSc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgSURpc3Bvc2FibGUgfSBmcm9tICcuLi9jb3JlL2luZGV4JztcclxuaW1wb3J0IHsgQ29tcG9uZW50UmVmTWFuYWdlciB9IGZyb20gJy4vY29tcG9uZW50X3JlZl9tYW5hZ2VyJztcclxuXHJcblxyXG4vKipcclxuICog57uE5Lu25LiK5LiL5paHXHJcbiAqIEBkZXNjcmlwdGlvbiBcclxuICogIyDkuIrkuIvmlodcclxuICogIyMgT3ZlcnZpZXdcclxuICogXHJcbiAqIOavj+S4que7hOS7tu+8iEZyYW1lQ29tcG9uZW5077yJ6YO95pyJ6Ieq5bex55qE5LiK5LiL5paH77yIRnJhbWVDb250ZXh077yJLOmAmui/h+S4iuS4i+aWh+WPr+S7peiOt+WPluaOp+WItuWZqOeahOaJgOacieWxnuaAp++8jOWmguW4uOeUqOeahGBmcmFtZUlkYOOAgWBCaW5kaW5nRGF0YWDjgIFgUmVwb3NpdG9yeWDjgIFgVmlld01vZGVsYOOAgWBTdGF0ZU1hY2hpbmVg44CBICogYFVJU3RhdGVg562J44CC5LiK5LiL5paH5Zyo5YaF5a2Y5Lit5ZGI5qCR5b2i57uT5p6E77yM5L6d6ZmE5LqORnJhbWVDb21wb25lbnTjgILnu5PmnoTlpoLkuIvvvJpcclxuICogXHJcbiAqICFbaW1hZ2UtMjAyMTA4MDYyMDQ3NTUzNzhdKGh0dHBzOi8vb3Blbi5pbnNwdXJvbmxpbmUuY29tL2lHSVgvYXNzZXRzL2Nsb3VkcGx1cy9pZ2l4XzIxMTAvZmFycmlzL2RldmtpdC9ndWlkZS9pbWFnZXMvaW1hZ2UtMjAyMTA4MDYyMDQ3NTUzNzgucG5nKVxyXG4gKiBcclxuICog5LuO5LiK5Zu+5oiR5Lus5Y+v5Lul55yL5Ye65q+P5Liq5LiK5LiL5paH6YO95pyJ6Ieq5bex55qEYFZpZXdNb2RlbGDjgIFgVUlTdGF0ZWDvvIzpgqPkuYjlpoLkvZXnoa7lrprkuIDkuKrlkb3ku6TlnKjmiafooYzml7bnlKjnmoTmmK/lk6rkuKrkuIrkuIvmloflkaLvvJ/lhbblrp7ml6Dorrrlkb3ku6TlnKjlk6rkuKrlnLDmlrnooqvosIPnlKjvvIzkuIrkuIvmlofpg73mmK/lkb3ku6TmiYDlnKjnmoTnu4Tku7bnmoTkuIrkuIvmlofjgILljbPvvIzlpoLmnpwgKiDlkb3ku6TmjILovb3liLDkuoZgZGV0YWlsLWZvcm0tY29tcG9uZW50YOeahOinhuWbvuaooeWei++8jOS9huWRveS7pOacgOe7iOiiq2Byb290LWNvbXBvbmVudGDkuIrnmoTmjInpkq7osIPnlKjkuobvvIzlhbbkuIrkuIvmlofku43nhLbmmK9gZGV0YWlsLWZyb20tY29tcG9uZW50YOe7hOS7tueahOS4iuS4i+aWh+OAguS5i+aJgOS7peWHuueOsOi/meenjeeOsOixoeWSjEFuZ3VsYXLnmoTkvp3otZbms6ggKiDlhaXlr4bkuI3lj6/liIbvvIznlLHkuo5Bbmd1bGFy5Zyo5p+l5om+YHByb3ZpZGVyYOeahOaXtuWAmeaAu+aYr+S7juiHquW3seeahOe7hOS7tuW8gOWni+WQkeS4iuaJvu+8jOWmguaenOWcqOe7hOS7tuWGhemDqOaJvuWIsOS6huWImeS4jeWGjee7p+e7reafpeaJvu+8jOWmguaenOaJvuS4jeWIsOWImeS8mue7p+e7reWQkeS4iu+8jOWmguaenOafpeaJvuWIsOacgOS4iue6p+S+neeEtuaJvuS4jeWIsOWwseS8muaKpWBObyBwcm92aWRlciAgKiBmb3IgeHhg6ZSZ6K+v44CCXHJcbiAqIFxyXG4gKiDml6LnhLblpoLmraTvvIzlpoLmnpzmiJHku6zlnKhgZGV0YWlsLWZvcm0tY29tcG9uZW50YOS4reaDs+imgeiOt+WPlmByb290LWNvbXBvbmVudGDkuK3lrprkuYnnmoTlj5jph4/vvIhVSVN0YXRl77yJ6K+l5aaC5L2V5YGa5ZGi77yf562U5qGI5piv5YiH5o2i5LiK5LiL5paH77yM5Y+v5Lul6YCa6L+H5Lul5LiL5pa55byP5a6e546w77yaXHJcbiAqIFxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIC8vIOaWueazlTFcclxuICogY29uc3Qgcm9vdEZyYW1lQ29udGV4dCA9IHRoaXMuZnJhbWVDb250ZXh0LnJvb3Q7XHJcbiAqIC8vIOaWueazlTJcclxuICogY29uc3Qgcm9vdEZyYW1lQ29udGV4dCA9IHRoaXMuZnJhbWVDb250ZXh0LmFwcENvbnRleHQuZnJhbWVDb250ZXh0TWFuYWdlci5nZXRGcmFtZUNvbnRleHRCeUlkKCdyb290LWNvbXBvbmVudCcpO1xyXG4gKiBgYGBcclxuICogXHJcbiAqIOmAmuW4uOWcqOe8luWGmWBXZWLmnoTku7Zg5pe25YWI5byV5YWlRnJhbWVDb250ZXh077yM5aaC77yaXHJcbiAqIFxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIGltcG9ydCB7RnJhbWVDb250ZXh0LEJpbmRpbmdEYXRhLFJlcG9zaXRvcnl9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcclxuICogXHJcbiAqIGNvbnN0cnVjdG9yKHByaXZhdGUgZnJhbWVDb250ZXh0OkZyYW1lQ29udGV4dCl7fVxyXG4gKiBcclxuICogcHVibGljIG1ldGhvZCgpe1xyXG4gKiAgICAgY29uc3QgYmluZGluZ0RhdGE6IEJpbmRpbmdEYXRhID0gdGhpcy5mcmFtZUNvbnRleHQuYmluZGluZ0RhdGE7XHJcbiAqICAgICBjb25zdCByZXBvc2l0b3J5OiBSZXBvc2l0b3J5ID0gdGhpcy5mcmFtZUNvbnRleHQucmVwb3NpdG9yeTtcclxuICogfVxyXG4gKiBgYGBcclxuICogXHJcbiAqID4gYEZyYW1lQ29udGV4dGDnp7DkuLpgVmlld01vZGVsQ29udGV4dGDmm7TlkIjpgILvvIzlj6/ku6XnkIbop6PkuLpgTVZWTWDmnrbmnoTkuK1gVk1g55qE5LiK5LiL5paH44CCXHJcbiAqIFxyXG4gKiDmjqfliLblmajkuK3kuqblrZjlnKhgVmlld01vZGVsYOeahOamguW/teOAguWSjGBNVlZNYOaetuaehOS4reeahOeahFZN5LiA6Ie077yM5omA5Lul5Lmf5Y+v5Lul5LuOYFZNYOiuv+mXruW4uOeUqOeahOWxnuaAp+OAguWmgu+8mlxyXG4gKiBcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBpbXBvcnQge0JpbmRpbmdEYXRhLFJlcG9zaXRvcnksVmlld01vZGVsfSBmcm9tICdAZmFycmlzL2RldmtpdCc7XHJcbiAqIFxyXG4gKiBjb25zdHJ1Y3Rvcihwcml2YXRlIHZpZXdNb2RlbDpWaWV3TW9kZWwpe31cclxuICogXHJcbiAqIHB1YmxpYyBtZXRob2QoKXtcclxuICogICAgIGNvbnN0IGJpbmRpbmdEYXRhOiBCaW5kaW5nRGF0YSA9IHRoaXMudmlld01vZGVsLmJpbmRpbmdEYXRhO1xyXG4gKiAgICAgY29uc3QgcmVwb3NpdG9yeTogUmVwb3NpdG9yeSA9IHRoaXMudmlld01vZGVsLnJlcG9zaXRvcnk7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqIFxyXG4gKiBcclxuICogXHJcbiAqICMjIOW4uOeUqOaTjeS9nFxyXG4gKiBcclxuICogIyMjIOiOt+WPluW9k+WJjeS4iuS4i+aWh+aJgOWxnueahOe7hOS7tlxyXG4gKiBcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiB0aGlzLmZyYW1lQ29udGV4dC5mcmFtZUNvbXBvbmVudDtcclxuICogYGBgXHJcbiAqIFxyXG4gKiAjIyMg6I635Y+W5b2T5YmN5LiK5LiL5paH55qE5qC55LiK5LiL5paHXHJcbiAqIFxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIHRoaXMuZnJhbWVDb250ZXh0LnJvb3Q7XHJcbiAqIGBgYFxyXG4gKiBcclxuICogIyMjIOiOt+WPluW9k+WJjeS4iuS4i+aWh+eahGFwcENvbnRleHRcclxuICogXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogdGhpcy5mcmFtZUNvbnRleHQuYXBwQ29udGV4dDtcclxuICogYGBgXHJcbiAqIFxyXG4gKiAjIyMg6I635Y+W5oyH5a6aZnJhbWVJZOeahOS4iuS4i+aWh1xyXG4gKiBcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiB0aGlzLmZyYW1lQ29udGV4dC5hcHBDb250ZXh0LmZyYW1lQ29udGV4dE1hbmFnZXIuZ2V0RnJhbWVDb250ZXh0QnlJZCgnZGF0YS1ncmlkLWNvbXBvbmVudCcpO1xyXG4gKiBgYGBcclxuICogXHJcbiAqICMjIyDojrflj5booajljZXmiYDmnInkuIrkuIvmlodcclxuICogXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogdGhpcy5mcmFtZUNvbnRleHQuYXBwQ29udGV4dC5mcmFtZUNvbnRleHRNYW5hZ2VyLmdldEZyYW1lQ29udGV4dHMoKTtcclxuICogYGBgXHJcbiAqIFxyXG4gKiBcclxuICogXHJcbiAqICMjIOW4uOeUqOWxnuaAp1xyXG4gKiBcclxuICogIyMjIEJpbmRpbmdEYXRhIFxyXG4gKiBcclxuICogW+WPguiAg10oW+a1qua9ruS8geS4muS6keW8gOaUvuW5s+WPsCAoaW5zcHVyb25saW5lLmNvbSldKGh0dHBzOi8vb3Blbi5pbnNwdXJvbmxpbmUuY29tL2lHSVgvIy9kb2N1bWVudC9tZGRvYy9pZ2l4LTIxMDMlMkZmYXJyaXMlMkZkZXZraXQlMkZndWlkZSUyRue7keWumuaVsOaNri5tZCkpXHJcbiAqIFxyXG4gKiAjIyMgUmVwb3NpdG9yeVxyXG4gKiBcclxuICogW+WPguiAg10oW+a1qua9ruS8geS4muS6keW8gOaUvuW5s+WPsCAoaW5zcHVyb25saW5lLmNvbSldKGh0dHBzOi8vb3Blbi5pbnNwdXJvbmxpbmUuY29tL2lHSVgvIy9kb2N1bWVudC9tZGRvYy9pZ2l4LTIxMDMlMkZmYXJyaXMlMkZkZXZraXQlMkZndWlkZSUyRuS7k+W6ky5tZCkpXHJcbiAqIFxyXG4gKiAjIyMgVmlld01vZGVsXHJcbiAqIFxyXG4gKiDmjqfliLblmajkuK1WaWV3TW9kZeWQjE1WVk3mnrbmnoTkuK3nmoRWTe+8jOWSjEZyYW1lQ29udGV4dOexu+S8vO+8jOWPr+S7pemAmui/h1ZpZXdNb2RlbOaLv+WIsEZyYW1lQ29udGV4dO+8jOWQjOagt+eahOS5n+WPr+S7pemAmui/h0ZyYW1lQ29udGV4dOaLv+WIsFZpZXdNb2RlbOOAglxyXG4gKiBcclxuICogIyMjIG5hbWVzcGFjZVxyXG4gKiBcclxuICog5ZG95ZCN56m66Ze077yM5Li76KaB5Zyo57uE5ZCI6KGo5Y2V5Zy65pmv55So5Yiw77yM5q+P5LiA5Liq6KGo5Y2V6YO95pyJ6Ieq5bex55qE5ZG95ZCN56m66Ze077yM6KKr57uE5ZCI6L+b5p2l55qE6KGo5Y2V5YW25ZG95ZCN56m66Ze05piv55u45ZCM55qE77yM5aaCQeihqOWNlee7hOWQiOS6hkLooajljZXvvIzliJlC6KGo5Y2V5YW35pyJ55u45ZCM55qE5ZG95ZCN56m66Ze077yM5ZG95ZCN56m66Ze05Li76KaB55So5LqO6KGo5Y2V6ZqU56a744CCXHJcbiAqIFxyXG4gKiAjIyMgcm9vdFxyXG4gKiBcclxuICog6I635Y+W5pW05Liq6KGo5Y2V55qE5qC55LiK5LiL5paHXHJcbiAqIFxyXG4gKiAjIyMgdWlTdGF0ZVxyXG4gKiBcclxuICog6I635Y+W5b2T5YmN57uE5Lu255qE5Y+Y6YePXHJcbiAqIFxyXG4gKiAjIyMgZnJhbWVJZFxyXG4gKiBcclxuICog5LiK5LiL5paH5qCH6K+G44CCXHJcbiAqL1xyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBGcmFtZUNvbnRleHQgZXh0ZW5kcyBDb250ZXh0IGltcGxlbWVudHMgSURpc3Bvc2FibGUsIE9uRGVzdHJveSB7XHJcblxyXG4gIHB1YmxpYyB0eXBlTmFtZSA9ICdGcmFtZUNvbnRleHQnO1xyXG5cclxuICBwcm90ZWN0ZWQgaXNEZXN0b3JpZWQgPSBmYWxzZTtcclxuICBwdWJsaWMgaXNEaXNwb3NlZCA9IGZhbHNlO1xyXG4gIC8qKlxyXG4gICAqIGlkXHJcbiAgICovXHJcbiAgcHVibGljIGZyYW1lSWQ6IHN0cmluZztcclxuXHJcbiAgLyoqXHJcbiAgICog5rOo5YWl5ZmoXHJcbiAgICovXHJcbiAgLy8gcHVibGljIGluamVjdG9yOiBJbmplY3RvcjtcclxuXHJcbiAgLyoqXHJcbiAgICog5bqU55So5LiK5LiL5paHXHJcbiAgICovXHJcbiAgcHVibGljIGFwcENvbnRleHQ6IEFwcENvbnRleHQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIOaguee7hOS7tuS4iuS4i+aWh1xyXG4gICAqL1xyXG4gIHB1YmxpYyByb290OiBGcmFtZUNvbnRleHQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIOeItlZpZXdNb2RlbFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXJlbnQ6IEZyYW1lQ29udGV4dDtcclxuXHJcbiAgLyoqXHJcbiAgICog5ZCO5Luj6IqC54K5XHJcbiAgICovXHJcbiAgcHVibGljIGNoaWxkcmVuOiBNYXA8c3RyaW5nLCBGcmFtZUNvbnRleHQ+O1xyXG5cclxuICAvKipcclxuICAgKiDlrp7kvZPku5PlupNcclxuICAgKi9cclxuICBwdWJsaWMgcmVwb3NpdG9yeTogUmVwb3NpdG9yeTxFbnRpdHk+O1xyXG5cclxuICAvKipcclxuICAgKiDlkb3ku6TmgLvnur9cclxuICAgKi9cclxuICBwdWJsaWMgY29tbWFuZEJ1czogQ29tbWFuZEJ1cztcclxuXHJcbiAgLyoqXHJcbiAgICog5LqL5Lu25oC757q/XHJcbiAgICovXHJcbiAgcHVibGljIGV2ZW50QnVzOiBFdmVudEJ1cztcclxuXHJcbiAgLyoqXHJcbiAgICog6KeG5Zu+5qih5Z6LXHJcbiAgICovXHJcbiAgcHVibGljIHZpZXdNb2RlbDogVmlld01vZGVsO1xyXG5cclxuICAvKipcclxuICAgKiDmlbDmja7nu5HlrppcclxuICAgKi9cclxuICBwdWJsaWMgYmluZGluZ0RhdGE6IEJpbmRpbmdEYXRhO1xyXG5cclxuICAvKipcclxuICAgKiBVSeeKtuaAgVxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aVN0YXRlOiBVSVN0YXRlO1xyXG5cclxuICAvKipcclxuICAgKiDnirbmgIHmnLpcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGVNYWNoaW5lOiBTdGF0ZU1hY2hpbmU7XHJcblxyXG4gIC8qKlxyXG4gICAqIOihqOWNlVxyXG4gICAqL1xyXG4gIHB1YmxpYyBmb3JtOiBGb3JtO1xyXG5cclxuICAvKipcclxuICAgKiDmiYDlsZ7nu4Tku7ZcclxuICAgKi9cclxuICBwdWJsaWMgZnJhbWVDb21wb25lbnQ6IEZyYW1lQ29tcG9uZW50O1xyXG5cclxuICAvKipcclxuICAgKiDlvILluLjlpITnkIZcclxuICAgKi9cclxuICBwdWJsaWMgZXhjZXB0aW9uSGFuZGxlcjogSUV4Y2VwdGlvbkhhbmRsZXI7XHJcblxyXG4gIC8qKlxyXG4gICAqIOihqOWNleWRveWQjeepuumXtFxyXG4gICAqL1xyXG4gIHB1YmxpYyBuYW1lc3BhY2U6IHN0cmluZztcclxuXHJcbiAgcHVibGljIHZhcmlhYmxlUGFyc2VTZXJ2aWNlOiBWYXJpYWJsZVBhcnNlU2VydmljZTtcclxuXHJcbiAgcHVibGljIG1ldGFkYXRhOiBJQ29udGV4dE1ldGFkYXRhID0ge1xyXG4gICAgaWRlbnRpZnk6ICcnLFxyXG4gICAgbmFtZXNwYWNlOiAnJyxcclxuICAgIGNvbW1hbmRzOiBudWxsLFxyXG4gICAgZm9ybTogbnVsbCxcclxuICAgIGZvcm1Db250cm9sczogbnVsbCxcclxuICAgIHN1YkZvcm1zOiBudWxsLFxyXG4gICAgc3RhdGVNYWNoaW5lOiBudWxsLFxyXG4gICAgdWlTdGF0ZXM6IG51bGwsXHJcbiAgICBiaW5kaW5nVG86ICcnXHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICog5pqC5YGc5LqL5Lu25oqb5Ye6XHJcbiAgICovXHJcbiAgcHVibGljIHN1c3BlbmQ6IGJvb2xlYW47XHJcbiAgcHVibGljIGV4cHJlc3Npb25FbmdpbmVJbXBsOiBFeHByZXNzaW9uRW5naW5lSW1wbDtcclxuICBwdWJsaWMgZXhwcmVzc2lvbk1hbmFnZXI6IEV4cHJlc3Npb25NYW5hZ2VyO1xyXG4gIHB1YmxpYyBleHByZXNzaW9uUmVzdWx0OiBFeHByZXNzaW9uUmVzdWx0O1xyXG4gIC8qKlxyXG4gICAqIOe0ouW8lSjku44w5byA5aeLKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbmRleDogbnVtYmVyO1xyXG4gIC8qKlxyXG4gICAqIOWkmuivrVxyXG4gICAqL1xyXG4gIHB1YmxpYyB0cmFuc2xhdGU6IFRyYW5zbGF0ZTtcclxuICAvKipcclxuICAgKiDkuIrkuIvmlofplIDmr4HmtYFcclxuICAgKi9cclxuICBwdWJsaWMgZGVzdG9yeVNpZ25hbDogU3ViamVjdDxhbnk+O1xyXG4gIC8qKlxyXG4gICAqIOe7hOS7tuW8leeUqOeuoeeQhlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb21wb25lbnRSZWZNYW5hZ2VyOiBDb21wb25lbnRSZWZNYW5hZ2VyID0gbmV3IENvbXBvbmVudFJlZk1hbmFnZXIoKTtcclxuICAvKipcclxuICAgKiDmnoTpgKDlh73mlbBcclxuICAgKiBAcGFyYW0gaW5qZWN0b3Ig5rOo5YWl5ZmoXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IocHVibGljIGluamVjdG9yOiBJbmplY3RvciwgQE9wdGlvbmFsKCkgQFNraXBTZWxmKCkgcGFyZW50OiBGcmFtZUNvbnRleHQpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICAvLyDlnKjop6PmnpDmqKHlvI/kuIvvvIzpgJrov4fkvp3otZbms6jlhaXojrflj5bkuI3liLBBcHBDb250ZXh05pe277yM6L+U5ZuebnVsbO+8jOWcqOWtkOexu+S4rei/m+ihjOi1i+WAvOOAglxyXG4gICAgdGhpcy5hcHBDb250ZXh0ID0gaW5qZWN0b3IuZ2V0KEFwcENvbnRleHQpO1xyXG4gICAgdGhpcy5kZXN0b3J5U2lnbmFsID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgLy8g56Gu5a6a54i25a2Q5YWz57O7XHJcbiAgICAvLyDlv4Xpobvlr7lhcHBDb250ZXh06L+b6KGM5Yik5pat77yM5Y6f5Zug5aaC5LiL77yaXHJcbiAgICAvLyAx44CB5ZCm5YiZ5Lya5a+86Ie05Yqo5oCB6Lev55Sx6KGo5Y2V5Lit77yM6KKr6Lev55Sx55qE6KGo5Y2V55qEUm9vdEZyYW1lQ29udGV4dOWPmOaIkOS4u+ihqOWNleeahFJvb3RGcmFtZUNvbnRleHTvvJtcclxuICAgIC8vIDLjgIHov5vogIzlr7zoh7Tku45Sb290RnJhbWVDb250ZXh05LiK5ou/Vk/lj5jph4/mi7/kuI3liLDjgIJcclxuICAgIGlmICghcGFyZW50IHx8IHBhcmVudC5hcHBDb250ZXh0ICE9PSB0aGlzLmFwcENvbnRleHQpIHsgLy8g5Y+W5raIIGFwcENvbnRleHQg55qE5Yik5patXHJcbiAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcclxuICAgICAgdGhpcy5yb290ID0gdGhpcztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICB0aGlzLnJvb3QgPSBwYXJlbnQucm9vdDtcclxuICAgIH1cclxuICAgIHRoaXMuZnJhbWVJZCA9IGluamVjdG9yLmdldDxzdHJpbmc+KEZSQU1FX0lEKTtcclxuICAgIGlmICh0aGlzLmFwcENvbnRleHQuY29udGV4dE1ldGFkYXRhTWFuYWdlci5leHNpdCh0aGlzLmZyYW1lSWQpKSB7XHJcbiAgICAgIHRoaXMubWV0YWRhdGEgPSB0aGlzLmFwcENvbnRleHQuY29udGV4dE1ldGFkYXRhTWFuYWdlci5nZXRDb250ZXh0TWV0YWRhdGFCeU5hbWUodGhpcy5mcmFtZUlkKTtcclxuICAgIH1cclxuICAgIHRoaXMubmFtZXNwYWNlID0gaW5qZWN0b3IuZ2V0KE5BTUVTUEFDRSwgbnVsbCk7XHJcbiAgICB0aGlzLmJpbmRpbmdEYXRhID0gdGhpcy5pbmplY3Rvci5nZXQ8QmluZGluZ0RhdGE+KEJpbmRpbmdEYXRhLCBuZXcgQmluZGluZ0RhdGEoKSk7XHJcbiAgICBpZiAoIXRoaXMuYXBwQ29udGV4dC51c2VJc29sdXRlRXZlbnRCdXMgfHwgKHRoaXMuYXBwQ29udGV4dC51c2VJc29sdXRlRXZlbnRCdXMgJiYgIXRoaXMuYXBwQ29udGV4dC5pc29sdXRlRXZlbnRCdXMpKSB7XHJcbiAgICAgIHRoaXMuZXZlbnRCdXMgPSB0aGlzLmluamVjdG9yLmdldChFdmVudEJ1cywgbnVsbCwgSW5qZWN0RmxhZ3MuT3B0aW9uYWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5ldmVudEJ1cyA9IHRoaXMuYXBwQ29udGV4dC5pc29sdXRlRXZlbnRCdXM7XHJcbiAgICB9XHJcbiAgICB0aGlzLmZvcm0gPSB0aGlzLmluamVjdG9yLmdldDxGb3JtPihGb3JtLCBuZXcgRm9ybSgpKTtcclxuICAgIHRoaXMucmVwb3NpdG9yeSA9IHRoaXMuaW5qZWN0b3IuZ2V0KFJlcG9zaXRvcnksIHRoaXMuYXBwQ29udGV4dC5yZXBvc2l0b3J5KTtcclxuICAgIC8vIOiOt+WPluWPmOabtOmbhuetlueVpe+8jOm7mOiupOWPquaPkOS6pOWQiOazleeahOWPmOabtFxyXG4gICAgY29uc3QgY2hhbmdlU2V0UG9saWN5ID0gdGhpcy5pbmplY3Rvci5nZXQ8Q2hhbmdlU2V0UG9saWN5PihDSEFOR0VfU0VUX1BPTElDWV9UT0tFTiwgJ3ZhbGlkJyk7XHJcbiAgICBpZiAodGhpcy5yZXBvc2l0b3J5KSB7XHJcbiAgICAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmNoYW5nZVNldFBvbGljeSA9IGNoYW5nZVNldFBvbGljeTtcclxuICAgIH1cclxuICAgIHRoaXMudWlTdGF0ZSA9IHRoaXMuaW5qZWN0b3IuZ2V0PFVJU3RhdGU+KFVJU3RhdGUsIG5ldyBVSVN0YXRlKCkpO1xyXG4gICAgY29uc3QgZGVmYXVsdFZpZXdNb2RlbCA9IG5ldyBWaWV3TW9kZWwoKTtcclxuICAgIGRlZmF1bHRWaWV3TW9kZWwuc2V0TWV0YWRhdGEodGhpcy5tZXRhZGF0YSk7XHJcbiAgICB0aGlzLnZpZXdNb2RlbCA9IHRoaXMuaW5qZWN0b3IuZ2V0PFZpZXdNb2RlbD4oVmlld01vZGVsLCBkZWZhdWx0Vmlld01vZGVsKTtcclxuICAgIHRoaXMudmFyaWFibGVQYXJzZVNlcnZpY2UgPSBpbmplY3Rvci5nZXQ8VmFyaWFibGVQYXJzZVNlcnZpY2U+KFZhcmlhYmxlUGFyc2VTZXJ2aWNlLCBuZXcgVmFyaWFibGVQYXJzZVNlcnZpY2UoW1xyXG4gICAgICBuZXcgRnJhbWVJZFZhcmlhYmxlUGFyc2VyKCksXHJcbiAgICAgIG5ldyBEYXRhVmFyaWFibGVQYXJzZXIoKSxcclxuICAgICAgbmV3IFVJU3RhdGVWYXJpYWJsZVBhcnNlcigpLFxyXG4gICAgICBuZXcgU3RhdGVNYWNoaW5lVmFyaWFibGVQYXJzZXIoKSxcclxuICAgICAgbmV3IENvbW1hbmRWYXJpYWJsZVBhcnNlcigpXHJcbiAgICBdKSk7XHJcbiAgICAvLyDms6jlhaVleGNlcHRpb25IYW5kbGVyXHJcbiAgICB0aGlzLmV4Y2VwdGlvbkhhbmRsZXIgPSBpbmplY3Rvci5nZXQ8SUV4Y2VwdGlvbkhhbmRsZXI+KEVYQ0VQVElPTl9IQU5ETEVSLCBudWxsLCBJbmplY3RGbGFncy5PcHRpb25hbCk7XHJcbiAgICAvLyDliJ3lp4vljJblpJror63mnI3liqFcclxuICAgIGNvbnN0IHRyYW5zbGF0ZSA9IGluamVjdG9yLmdldDxUcmFuc2xhdGU+KFRyYW5zbGF0ZVRva2VuLCBudWxsKTtcclxuICAgIHRoaXMudHJhbnNsYXRlID0gdHJhbnNsYXRlO1xyXG4gICAgVHJhbnNsYXRlU2VydmljZS5zZXRUcmFuc2xhdGUodHJhbnNsYXRlKTtcclxuICAgIC8vIOWIneWni+WMlueUqOaIt+mFjee9rlxyXG4gICAgY29uc3QgdXNlclNldHRpbmdzID0gaW5qZWN0b3IuZ2V0PFVzZXJTZXR0aW5ncz4oVXNlclNldHRpbmdzVG9rZW4sIG51bGwpO1xyXG4gICAgVXNlclNldHRpbmdzU2VydmljZS5zZXRVc2VyU2V0dGluZ3ModXNlclNldHRpbmdzKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZVJlcG9zaXRvcnkoKTtcclxuICAgIHRoaXMuYXBwQ29udGV4dC5yZWdGcmFtZUNvbnRleHQodGhpcyk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyQXBwQ29udGV4dERlc3Ryb3lFdmVudCgpO1xyXG4gIH1cclxuICBkaXNwb3NlKG9wdGlvbnM/OiBhbnkpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pc0Rlc3RvcmllZCA9IHRydWU7XHJcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xyXG4gICAgaWYgKHRoaXMuZGVzdG9yeVNpZ25hbCkge1xyXG4gICAgICB0aGlzLmRlc3RvcnlTaWduYWwubmV4dCgpO1xyXG4gICAgICB0aGlzLmRlc3RvcnlTaWduYWwuY29tcGxldGUoKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmFwcENvbnRleHQpIHtcclxuICAgICAgdGhpcy5hcHBDb250ZXh0LmZyYW1lQ29udGV4dE1hbmFnZXIudW5yZWdGcmFtZUNvbnRleHQodGhpcyk7XHJcbiAgICAgIHRoaXMuYXBwQ29udGV4dC5mcmFtZUNvbXBvbmVudFJlZnJlc2hlci51bnJlZ0ZyYW1lQ29udGV4dCh0aGlzKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmFwcENvbnRleHQgJiYgdGhpcy5pc1Jvb3RGcmFtZUNvbnRleHQoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICBjb25zdCB2aWV3TW9kZWxOYW1lcyA9IHRoaXNbJ3ZpZXdNb2RlbE5hbWVzJ107XHJcbiAgICAgIGlmICh2aWV3TW9kZWxOYW1lcyAmJiBBcnJheS5pc0FycmF5KHZpZXdNb2RlbE5hbWVzKSkge1xyXG4gICAgICAgIHZpZXdNb2RlbE5hbWVzLmZvckVhY2gobmFtZSA9PiB7XHJcbiAgICAgICAgICB0aGlzW25hbWVdID0gbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmFwcENvbnRleHQudW5yZWdpc3RlckZyb21NYW5hZ2VyKCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5iaW5kaW5nRGF0YSkge1xyXG4gICAgICB0aGlzLmJpbmRpbmdEYXRhLmRpc3Bvc2UoKTtcclxuICAgICAgLy8gdGhpcy5iaW5kaW5nRGF0YSA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy52aWV3TW9kZWwpIHtcclxuICAgICAgdGhpcy52aWV3TW9kZWwuZGlzcG9zZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZm9ybSkge1xyXG4gICAgICB0aGlzLmZvcm0uZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLmZvcm0gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuY29tbWFuZEJ1cykge1xyXG4gICAgICB0aGlzLmNvbW1hbmRCdXMuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLmNvbW1hbmRCdXMgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgVHJhbnNsYXRlU2VydmljZS5kaXNwb3NlKCk7XHJcbiAgICAvLyB0aGlzLnJvb3QgPSBudWxsO1xyXG4gICAgLy8gdGhpcy5wYXJlbnQgPSBudWxsO1xyXG4gICAgLy8gdGhpcy51aVN0YXRlID0gbnVsbDtcclxuICAgIHRoaXMuZnJhbWVDb21wb25lbnQgPSBudWxsO1xyXG4gICAgdGhpcy5yZXBvc2l0b3J5ID0gbnVsbDtcclxuICAgIC8vIHRoaXMuc3RhdGVNYWNoaW5lID0gbnVsbDtcclxuICAgIC8vIHRoaXMuYXBwQ29udGV4dCA9IG51bGw7XHJcbiAgICB0aGlzLmV4Y2VwdGlvbkhhbmRsZXIgPSBudWxsO1xyXG4gICAgdGhpcy5leHByZXNzaW9uTWFuYWdlciA9IG51bGw7XHJcbiAgICB0aGlzLmV4cHJlc3Npb25FbmdpbmVJbXBsID0gbnVsbDtcclxuICAgIHRoaXMudmFyaWFibGVQYXJzZVNlcnZpY2UgPSBudWxsO1xyXG4gICAgdGhpcy5ldmVudEJ1cyA9IG51bGw7XHJcbiAgICB0aGlzLnRyYW5zbGF0ZSA9IG51bGw7XHJcbiAgICB0aGlzLmluamVjdG9yID0gbnVsbDtcclxuICAgIHRoaXMuZXhwcmVzc2lvblJlc3VsdCA9IG51bGw7XHJcbiAgICBVc2VyU2V0dGluZ3NTZXJ2aWNlLnNldFVzZXJTZXR0aW5ncyhudWxsKTtcclxuICB9XHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2UoKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6YCa6L+H57uE5Lu25qCH6K+G6I635Y+W5a+55bqU55qE57uE5Lu25a6e5L6LXHJcbiAgICogQHBhcmFtIGlkIOe7hOS7tuagh+ivhlxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRDb21wb25lbnRCeUlkPFQ+KGlkOiBzdHJpbmcpOiBUIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudFJlZk1hbmFnZXIuZ2V0KGlkKTtcclxuICAgIGlmIChjb21wb25lbnRzICYmIGNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBjb21wb25lbnQgPSBjb21wb25lbnRzWzBdIGFzIFQ7XHJcbiAgICAgIHJldHVybiBjb21wb25lbnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+W5oyH5a6a5qCH6K+G55qE5omA5pyJ57uE5Lu2XHJcbiAgICogQHBhcmFtIGlkIOe7hOS7tuagh+ivhlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRDb21wb25lbnRzQnlJZDxUPihpZDogc3RyaW5nKTogVFtdIHtcclxuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudFJlZk1hbmFnZXIuZ2V0KGlkKSBhcyBUW107XHJcbiAgfVxyXG4gIGJpbmRJbmplY3Rvcihjb21wb25lbnRJbmplY3RvcjogSW5qZWN0b3IpIHtcclxuICAgIHRoaXMuaW5qZWN0b3IgPSBjb21wb25lbnRJbmplY3RvcjtcclxuICB9XHJcblxyXG4gIC8vICNyZWdpb24g5Yid5aeL5YyWXHJcblxyXG4gIC8qKlxyXG4gICAqIOWIneWni+WMllxyXG4gICAqIEB0b2RvOlxyXG4gICAqIDHjgIFDb21tYW5kSGFuZGxlcuS4reeahOacjeWKoeWPr+iDveS8muazqOWFpUNvbnRleHTvvIzmiYDku6VDb21tYW5kSGFuZGxlcuWIm+W7uuaXtuW/hemhu+W3sue7j+WtmOWcqENvbXBvbmVudENvbnRleHRcclxuICAgKiAy44CBVmlld01vZGVs55qEYnVpbGRDb21tYW5kc+S4reS8muS9v+eUqENvbW1hbmRCdXPvvIzkuLrkuobkv53or4Hpobrluo/vvIzlsIZWaWV3TW9kZWznmoTliJvlu7rkuZ/mlL7lnKhpbml05Lit44CCXHJcbiAgICovXHJcbiAgcHVibGljIGluaXQoZnJhbWVDb21wb25lbnQ6IEZyYW1lQ29tcG9uZW50KSB7XHJcbiAgICB0aGlzLmZyYW1lQ29tcG9uZW50ID0gZnJhbWVDb21wb25lbnQ7XHJcbiAgICB0aGlzLmluaXRpYWxpemVCaW5kaW5nRGF0YSgpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplU3RhdGVNYWNoaW5lKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVVaVN0YXRlKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVGb3JtKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVDb21tYW5kQnVzKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVWaWV3TW9kZWwoKTtcclxuICAgIHRoaXMucmVnaXN0ZXJFeGNlcHRpb25IYW5kbGVyKCk7XHJcbiAgICB0aGlzLmluaXRFeHByZXNzaW9uKCk7XHJcbiAgICB0aGlzLmFwcENvbnRleHQuZnJhbWVDb21wb25lbnRSZWZyZXNoZXIucmVnRnJhbWVDb21wb25lbnQodGhpcy5mcmFtZUlkLCB0aGlzLmZyYW1lQ29tcG9uZW50KTtcclxuICB9XHJcbiAgcHVibGljIGluaXRFeHByZXNzaW9uKCkge1xyXG4gICAgdGhpcy5leHByZXNzaW9uRW5naW5lSW1wbCA9IHRoaXMuaW5qZWN0b3IuZ2V0PEV4cHJlc3Npb25FbmdpbmVJbXBsPihFeHByZXNzaW9uRW5naW5lSW1wbCwgbnVsbCk7XHJcbiAgICB0aGlzLmV4cHJlc3Npb25NYW5hZ2VyID0gdGhpcy5pbmplY3Rvci5nZXQ8RXhwcmVzc2lvbk1hbmFnZXI+KEV4cHJlc3Npb25NYW5hZ2VyLCBudWxsKTtcclxuICAgIGNvbnN0IGV4cHJlc3Npb25SZXN1bHRGYWN0b3J5ID0gdGhpcy5pbmplY3Rvci5nZXQ8RXhwcmVzc2lvblJlc3VsdEZhY3Rvcnk+KEV4cHJlc3Npb25SZXN1bHRGYWN0b3J5LCBudWxsKTtcclxuICAgIHRoaXMuZXhwcmVzc2lvblJlc3VsdCA9IHRoaXMuaW5qZWN0b3IuZ2V0PEV4cHJlc3Npb25SZXN1bHQ+KEV4cHJlc3Npb25SZXN1bHQsIG51bGwpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDorqLpmIXlvILluLjmtojmga9cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgcmVnaXN0ZXJFeGNlcHRpb25IYW5kbGVyKCkge1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGU6IG5vLXN0cmluZy1saXRlcmFsXHJcbiAgICBjb25zdCBmb3JtQXBwQ29udGV4dCA9IHRoaXMuZ2V0Rm9ybUFwcENvbnRleHQoKTtcclxuICAgIGNvbnN0IGFwcGxpY2F0aW9uSWQgPSBmb3JtQXBwQ29udGV4dC5BcHBsaWNhdGlvbklkO1xyXG4gICAgd2luZG93W3dpbmRvdy5sb2NhdGlvbi5ocmVmXSA9IGFwcGxpY2F0aW9uSWQ7XHJcbiAgICBpZiAodGhpcy5leGNlcHRpb25IYW5kbGVyICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IGFwcGxpY2F0aW9uQ29udGV4dCA9IHdpbmRvd1thcHBsaWNhdGlvbklkXSA9IHdpbmRvd1thcHBsaWNhdGlvbklkXSB8fCB7fTtcclxuICAgICAgaWYgKHRoaXMuZXZlbnRCdXMgIT09IG51bGwgJiYgdGhpcy5pc1Jvb3RGcmFtZUNvbnRleHQoKSkge1xyXG4gICAgICAgIGFwcGxpY2F0aW9uQ29udGV4dC5pc0V4Y2VwdGlvbkhhbmRsZXJFeGlzdCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5leGNlcHRpb25IYW5kbGVyLnNldENvbnRleHQodGhpcy5hcHBDb250ZXh0KTtcclxuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKCdFeGNlcHRpb24nLCAnJywgJ29uRXhjZXB0aW9uJywgZm9ybUFwcENvbnRleHQsIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMuaXNEZXN0b3JpZWQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLmVycm9yKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgZXJyb3IuZXJyb3IuX19mcmFtZV9jb250ZXh0X18gPSB0aGlzO1xyXG4gICAgICAgICAgICB9IGNhdGNoIHsgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5leGNlcHRpb25IYW5kbGVyLmhhbmRsZShlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5kZXN0b3J5U2lnbmFsLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5ldmVudEJ1cy5vZmYoJ0V4Y2VwdGlvbicsICcnLCAnb25FeGNlcHRpb24nLCBmb3JtQXBwQ29udGV4dCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcm90ZWN0ZWQgcmVnaXN0ZXJBcHBDb250ZXh0RGVzdHJveUV2ZW50KCkge1xyXG4gICAgaWYgKHRoaXMuYXBwQ29udGV4dCAmJiB0aGlzLmFwcENvbnRleHQuZGVzdG9yeVNpZ25hbCkge1xyXG4gICAgICB0aGlzLmFwcENvbnRleHQuZGVzdG9yeVNpZ25hbC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlTWFjaGluZSkge1xyXG4gICAgICAgICAgdGhpcy5zdGF0ZU1hY2hpbmUuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgdGhpcy5zdGF0ZU1hY2hpbmUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZXBvc2l0b3J5KSB7XHJcbiAgICAgICAgICB0aGlzLnJlcG9zaXRvcnkuZGlzcG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluihqOWNlWFwcGNvbnRleHTvvIzljbPmnIDkuIrlsYJhcHBjb250ZXh0XHJcbiAgICovXHJcbiAgcHVibGljIGdldEZvcm1BcHBDb250ZXh0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYXBwQ29udGV4dDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+WZnJhbWVJZFxyXG4gICAqIEBkZXNjcmlwdGlvbiDojrflj5blrozmlbTnmoRGcmFtZUlk77yM5Zyo6Z2e5pmu6YCa6KGo5Y2V5Lit6K+l5YC8562J5LqOZnJhbWVJZO+8jOWcqOe7hOWQiOihqOWNleS4reivpeWAvOS4um5hbWVzcGFjZV9mcmFtZUlkXHJcbiAgICovXHJcbiAgcHVibGljIGdldEZyYW1lSWQocmVsYXRpdmVGcmFtZUlkOiBzdHJpbmcpIHtcclxuICAgIGlmICghcmVsYXRpdmVGcmFtZUlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmZyYW1lSWQ7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5uYW1lc3BhY2UgJiYgdGhpcy5uYW1lc3BhY2UubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gYCR7dGhpcy5uYW1lc3BhY2V9XyR7cmVsYXRpdmVGcmFtZUlkfWA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gcmVsYXRpdmVGcmFtZUlkO1xyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiDliJ3lp4vljJZSZXBvc2l0b3J5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplUmVwb3NpdG9yeSgpIHtcclxuXHJcbiAgICB0aGlzLnJlcG9zaXRvcnkuc2V0UGFnaW5hdGlvbkNvbmZpZyh0aGlzLnJlcG9zaXRvcnkucGFnaW5hdGlvbkluZm8pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplRm9ybSgpIHtcclxuICAgIC8vIOiuvue9rkZvcm3or63oqIDmnI3liqFcclxuICAgIC8vIHRoaXMuZm9ybS5zZXRUcmFuc2xhdGVTZXJ2aWNlKHRyYW5zbGF0ZVNlcnZpY2UpO1xyXG4gICAgLy8g5Yid5aeL5YyWRm9ybe+8jOaPkOWPlkZvcm1Db250cm9s5a6a5LmJ77yM5re75YqgRm9ybUNvbnRyb2xcclxuICAgIC8vIHRoaXMuZm9ybS5pbml0KHRoaXMuYmluZGluZ0RhdGEsIHRoaXMubWV0YWRhdGEuYmluZGluZ1RvLCB0aGlzKTtcclxuICAgIC8vIEZvcm1cclxuICAgIHRoaXMuZm9ybSA9IHRoaXMuaW5qZWN0b3IuZ2V0PEZvcm0+KEZvcm0sIG51bGwpO1xyXG4gICAgaWYgKHRoaXMuZm9ybSkge1xyXG4gICAgICAvLyDorr7nva5Gb3Jt6K+t6KiA5pyN5YqhXHJcbiAgICAgIHRoaXMuZm9ybS5zZXRUcmFuc2xhdGVTZXJ2aWNlKHRoaXMuaW5qZWN0b3IuZ2V0KFRyYW5zbGF0ZVRva2VuLCBudWxsKSk7XHJcbiAgICAgIC8vIOWIneWni+WMlkZvcm3vvIzmj5Dlj5ZGb3JtQ29udHJvbOWumuS5ie+8jOa3u+WKoEZvcm1Db250cm9sXHJcbiAgICAgIGNvbnN0IGJpbmRpbmdQYXRoID0gdGhpcy52aWV3TW9kZWwuYmluZGluZ1BhdGggfHwgdGhpcy5tZXRhZGF0YS5iaW5kaW5nVG87XHJcbiAgICAgIHRoaXMuZm9ybS5pbml0KHRoaXMuYmluZGluZ0RhdGEsIGJpbmRpbmdQYXRoLCB0aGlzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVN0YXRlTWFjaGluZSgpIHtcclxuICAgIC8vIFN0YXRlTWFjaGluZSDnirbmgIHmnLrpnIDopoHlnKjnu5HlrprmlbDmja7kuYvlkI7liqDovb1cclxuICAgIHRoaXMuc3RhdGVNYWNoaW5lID0gdGhpcy5pbmplY3Rvci5nZXQ8U3RhdGVNYWNoaW5lPihTdGF0ZU1hY2hpbmUsIG51bGwpO1xyXG4gICAgaWYgKHRoaXMuc3RhdGVNYWNoaW5lKSB7XHJcbiAgICAgIHRoaXMuc3RhdGVNYWNoaW5lLmluaXRpYWxpemUodGhpcywgdGhpcy52YXJpYWJsZVBhcnNlU2VydmljZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGluaXRpYWxpemVDb21tYW5kQnVzKCkge1xyXG4gICAgY29uc3QgaGFuZGxlclJlZ2lzdHJ5ID0gdGhpcy5pbmplY3Rvci5nZXQ8Q29tbWFuZEhhbmRsZXJSZWdpc3RyeT4oQ29tbWFuZEhhbmRsZXJSZWdpc3RyeSxcclxuICAgICAgbmV3IENvbW1hbmRIYW5kbGVyUmVnaXN0cnkodGhpcy5tZXRhZGF0YS5jb21tYW5kSGFuZGxlcnMpKTtcclxuICAgIGNvbnN0IGV4dGVuZHNSZWdpc3RyeSA9IHRoaXMuaW5qZWN0b3IuZ2V0PENvbW1hbmRIYW5kbGVyRXh0ZW5kZXJSZWdpc3RyeT4oQ29tbWFuZEhhbmRsZXJFeHRlbmRlclJlZ2lzdHJ5LFxyXG4gICAgICBuZXcgQ29tbWFuZEhhbmRsZXJFeHRlbmRlclJlZ2lzdHJ5KHRoaXMubWV0YWRhdGEuY29tbWFuZEhhbmRsZXJFeHRlbmRzKSk7XHJcbiAgICBjb25zdCBjb21tYW5kSGFuZGxlckZhY3RvcnkgPSBuZXcgQ29tbWFuZEhhbmRsZXJGYWN0b3J5KGhhbmRsZXJSZWdpc3RyeSwgZXh0ZW5kc1JlZ2lzdHJ5LCB0aGlzLCB0aGlzLnZhcmlhYmxlUGFyc2VTZXJ2aWNlKTtcclxuICAgIHRoaXMuY29tbWFuZEJ1cyA9IG5ldyBDb21tYW5kQnVzKGNvbW1hbmRIYW5kbGVyRmFjdG9yeSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJ3lp4vljJZWaWV3TW9kZWxcclxuICAgKiBAdG9kb1xyXG4gICAqIDHjgIHpnIDopoHmjInnhafkuIDlrprnmoTpobrluo/ov5vooYzliJ3lp4vljJbvvIzlkKbliJnkvp3otZbml6Dms5XmraPnoa7lpITnkIbvvJtcclxuICAgKiAy44CB5pqC5pe25L2/55SoaW5pdOino+WGs0NvbnRleHTlkozlhbbku5bpg6jliIbnmoTlvqrnjq/kvp3otZbpl67popjvvIzlvoXkvJjljJbvvJtcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVWaWV3TW9kZWwoKSB7XHJcbiAgICBpZiAoIXRoaXMubWV0YWRhdGEuYmluZGluZ1RvKSB7XHJcbiAgICAgIHRoaXMubWV0YWRhdGEuYmluZGluZ1RvID0gdGhpcy52aWV3TW9kZWwuYmluZGluZ1BhdGg7XHJcbiAgICB9XHJcbiAgICB0aGlzLnZpZXdNb2RlbC5pbml0KHRoaXMpO1xyXG4gICAgdGhpcy5yZWdWaWV3TW9kZWwodGhpcy52aWV3TW9kZWwpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOWIneWni+WMlkJpbmRpbmdEYXRhXHJcbiAgICogQHN1bW1hcnlcclxuICAgKiDogIHooajljZXvvJpyZXBvc2l0b3J5TmFtZeS4uuepuu+8jOWkjeWItuW9k+WJjVJlcG9zaXRvcnnph4znmoTmlbDmja7vvJtcclxuICAgKiDmlrDooajljZXvvJpyZXBvc2l0b3J5TmFtZeacieWAvO+8jOW8leeUqOWFqOWxgEJpbmRpbmdEYXRh6YeM55qE5pWw5o2u77ybXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplQmluZGluZ0RhdGEoKSB7XHJcbiAgICBjb25zdCByZXBvc2l0b3J5TmFtZSA9IHRoaXMucmVwb3NpdG9yeS5uYW1lO1xyXG4gICAgY29uc3QgaXNSdW5BdEhpZ2hTcGVlZE1vZGUgPSB0aGlzLmFwcENvbnRleHQucnVuTW9kZSA9PT0gUnVuTW9kZS5oaWdoU3BlZWQ7XHJcbiAgICBpZiAocmVwb3NpdG9yeU5hbWUgJiYgaXNSdW5BdEhpZ2hTcGVlZE1vZGUpIHtcclxuICAgICAgY29uc3QgcmVwb3NpdG9yeUJpbmRpbmdEYXRhID0gdGhpcy5hcHBDb250ZXh0LmJpbmRpbmdEYXRhTWFuYWdlci5nZXRCaW5kaW5nRGF0YUJ5TmFtZShyZXBvc2l0b3J5TmFtZSk7XHJcbiAgICAgIHRoaXMuYmluZGluZ0RhdGEuaW5pdEJ5QmluZGluZ0xpc3QocmVwb3NpdG9yeUJpbmRpbmdEYXRhLmxpc3QsIHRoaXMudmlld01vZGVsLmJpbmRpbmdQYXRoKTtcclxuICAgICAgdGhpcy5iaW5kaW5nRGF0YS5wYWdpbmdJbmZvID0gcmVwb3NpdG9yeUJpbmRpbmdEYXRhLnBhZ2luZ0luZm87XHJcbiAgICAgIHRoaXMuYmluZGluZ0RhdGEuc2V0RGF0YVR5cGVJbmZvKHRoaXMucmVwb3NpdG9yeS5lbnRpdHlUeXBlSW5mbyk7XHJcbiAgICAgIEVudGl0eVV0aWwud2F0Y2hSZXBvc2lyb3R5KHRoaXMucmVwb3NpdG9yeSwgdGhpcy5iaW5kaW5nRGF0YSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmJpbmRpbmdEYXRhLmluaXRCeVJlcG9zaXRvcnkodGhpcy5yZXBvc2l0b3J5LCB0aGlzLnZpZXdNb2RlbC5iaW5kaW5nUGF0aCk7XHJcbiAgICAgIEVudGl0eVV0aWwud2F0Y2hSZXBvc2lyb3R5KHRoaXMucmVwb3NpdG9yeSwgdGhpcy5iaW5kaW5nRGF0YSk7XHJcbiAgICAgIHRoaXMuYmluZGluZ0RhdGEuY2hhbmdlcy5zdWJzY3JpYmUoKGNoYW5nZTogQ2hhbmdlKSA9PiB7XHJcbiAgICAgICAgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLkdsb2JhbFNlbGVjdGlvbkNoYW5nZWQpIHtcclxuICAgICAgICAgIHRoaXMuYXBwQ29udGV4dC5oYW5kbGVTZWxlY3RDaGFuZ2UoY2hhbmdlLCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOWIneWni+WMllVJU3RhdGVcclxuICAgKiDlkIjlubbot6/nlLHlj4LmlbDliLBVSVN0YXRl5LitXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplVWlTdGF0ZSgpIHtcclxuICAgIGNvbnN0IGlzSW5GcmFtZXdvcmsgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCdwbGF0Zm9ybScpID4gLTE7XHJcbiAgICBjb25zdCBwYXJhbVR5cGVUcmFuc2Zvcm0gPSB0aGlzLmluamVjdG9yLmdldDxib29sZWFuPihQQVJBTV9UWVBFX1RSQU5TRk9STV9UT0tFTiwgZmFsc2UpO1xyXG4gICAgLy8g6I635Y+WVUlTdGF0ZVxyXG4gICAgdGhpcy51aVN0YXRlID0gdGhpcy5pbmplY3Rvci5nZXQ8VUlTdGF0ZT4oVUlTdGF0ZSwgbnVsbCk7XHJcbiAgICBpZiAoIXRoaXMudWlTdGF0ZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnVpU3RhdGUucGFyYW1UeXBlVHJhbnNmb3JtID0gcGFyYW1UeXBlVHJhbnNmb3JtO1xyXG4gICAgdGhpcy51aVN0YXRlLmluaXRpYWxpemUodGhpcyk7XHJcbiAgICAvLyDojrflj5bot6/nlLHlj4LmlbBcclxuICAgIGNvbnN0IHVybCA9ICh0aGlzLmFwcENvbnRleHQgJiYgdGhpcy5hcHBDb250ZXh0LnJvdXRlciAmJiB0aGlzLmFwcENvbnRleHQucm91dGVyLnVybCkgfHwgJyc7XHJcbiAgICBjb25zdCByb3V0ZXJQYXJhbVNlcnZpY2UgPSBuZXcgUm91dGVyUGFyYW1TZXJ2aWNlKCk7XHJcbiAgICBjb25zdCByb3V0ZXJQYXJhbXMgPSByb3V0ZXJQYXJhbVNlcnZpY2UuZ2V0UGFyYW1zKHVybCk7XHJcblxyXG4gICAgLy8g5ZyoVUlTdGF0ZeS4uui3r+eUseWPguaVsOWIm+W7uuWxnuaAp1xyXG4gICAgT2JqZWN0LmtleXMocm91dGVyUGFyYW1zKS5mb3JFYWNoKChwcm9wTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLnVpU3RhdGUsIHByb3BOYW1lLCB7XHJcbiAgICAgICAgZ2V0OiAoKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gcm91dGVyUGFyYW1zW3Byb3BOYW1lXTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDms6jlhozlrZBWaWV3TW9kZWxcclxuICAgKiBAdG9kb1xyXG4gICAqIDHjgIFwcm9wTmFtZeWGmeatu+S6hlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWdWaWV3TW9kZWwodmlld01vZGVsOiBWaWV3TW9kZWwpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmFwcENvbnRleHQgJiYgdGhpcy5hcHBDb250ZXh0LnZpZXdNb2RlbE1hbmFnZXIuZXhzaXQodmlld01vZGVsLm5hbWUpID09PSBmYWxzZSkge1xyXG4gICAgICB0aGlzLmFwcENvbnRleHQudmlld01vZGVsTWFuYWdlci5yZWdpc3Rlcih2aWV3TW9kZWwubmFtZSwgdmlld01vZGVsKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGNsYXNzTmFtZSA9IHZpZXdNb2RlbC5jb25zdHJ1Y3Rvci5uYW1lO1xyXG4gICAgY29uc3QgcGFyZW50Q29udGV4dCA9IHRoaXMucGFyZW50O1xyXG4gICAgbGV0IHBhcmVudFZpZXdNb2RlbCA9IG51bGw7XHJcbiAgICBpZiAocGFyZW50Q29udGV4dCAmJiBwYXJlbnRDb250ZXh0LnZpZXdNb2RlbCkge1xyXG4gICAgICBwYXJlbnRWaWV3TW9kZWwgPSBwYXJlbnRDb250ZXh0LnZpZXdNb2RlbDtcclxuICAgIH1cclxuICAgIGlmICghcGFyZW50Vmlld01vZGVsKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vIOS8mOWFiOS9v+eUqOeUn+aIkOWZqOeUn+aIkOeahG5hbWVcclxuICAgIGNvbnN0IGNoaWxkVmlld01vZGVscyA9IHBhcmVudFZpZXdNb2RlbFsnY2hpbGRWaWV3TW9kZWxzJ107XHJcbiAgICBsZXQgdmlld01vZGVsTmFtZSA9IG51bGw7XHJcbiAgICBpZiAoY2hpbGRWaWV3TW9kZWxzKSB7XHJcbiAgICAgIGNvbnN0IG5hbWUgPSB2aWV3TW9kZWwuY29uc3RydWN0b3IubmFtZTtcclxuICAgICAgdmlld01vZGVsTmFtZSA9IGNoaWxkVmlld01vZGVsc1t2aWV3TW9kZWwubmFtZV0gfHwgY2hpbGRWaWV3TW9kZWxzW25hbWVdO1xyXG4gICAgfSBlbHNlIGlmIChjbGFzc05hbWUubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIGNvbnN0IGNsYXNzTmFtZVRva2VucyA9IHZpZXdNb2RlbC5uYW1lLnNwbGl0KCctJykubWFwKChuYW1lVG9rZW4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgaWYgKGluZGV4ID4gMCAmJiBuYW1lVG9rZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICBjb25zdCBwYXNpY2FsTmFtZSA9IG5hbWVUb2tlbi5jaGFyQXQoMCkudG9Mb2NhbGVVcHBlckNhc2UoKSArIG5hbWVUb2tlbi5zdWJzdHIoMSwgbmFtZVRva2VuLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgcmV0dXJuIHBhc2ljYWxOYW1lO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IDAgJiYgbmFtZVRva2VuLmxlbmd0aCkge1xyXG4gICAgICAgICAgY29uc3QgY2FtZWxOYW1lID0gbmFtZVRva2VuLmNoYXJBdCgwKS50b0xvY2FsZUxvd2VyQ2FzZSgpICsgbmFtZVRva2VuLnN1YnN0cigxLCBuYW1lVG9rZW4ubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICByZXR1cm4gY2FtZWxOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmFtZVRva2VuO1xyXG4gICAgICB9KTtcclxuICAgICAgdmlld01vZGVsTmFtZSA9IGNsYXNzTmFtZVRva2Vucy5qb2luKCcnKTtcclxuICAgIH0gZWxzZSBpZiAodmlld01vZGVsW1wicmVsYXRlQ2hpbGROYW1lXCJdKSB7XHJcbiAgICAgIC8vIOWinuWKoOivpeWPguaVsOeahOebrueahCAg5piv5Li65LqG6Kej5p6Q6KGo5Y2V5Y+v5Lul6L+b6KGM5ZKM55Sf5oiQ5Z6L55u45ZCM55qE5bGC57qn57uT5p6EXHJcbiAgICAgIHZpZXdNb2RlbE5hbWUgPSB2aWV3TW9kZWxbXCJyZWxhdGVDaGlsZE5hbWVcIl07XHJcbiAgICB9XHJcbiAgICAvLyDlhbzlrrnkuqflk4Hpg6jogIHooajljZXnmoTlhpnms5XvvIzlpoLmnpzpnIDopoF2bSBuYW1l57uf5LiA77yM5bqU5oyJ54Wn5q2k6KeE5YiZXHJcbiAgICBpZiAoIXZpZXdNb2RlbE5hbWUpIHtcclxuICAgICAgdmlld01vZGVsTmFtZSA9IGNsYXNzTmFtZVswXS50b0xvd2VyQ2FzZSgpICsgY2xhc3NOYW1lLnN1YnN0cmluZygxLCBjbGFzc05hbWUubGVuZ3RoKTtcclxuICAgIH1cclxuICAgIHBhcmVudFZpZXdNb2RlbFsndmlld01vZGVsTmFtZXMnXSA9IHBhcmVudFZpZXdNb2RlbFsndmlld01vZGVsTmFtZXMnXSB8fCBbXTtcclxuICAgIHBhcmVudFZpZXdNb2RlbFt2aWV3TW9kZWxOYW1lXSA9IHZpZXdNb2RlbDtcclxuICAgIHBhcmVudFZpZXdNb2RlbFsndmlld01vZGVsTmFtZXMnXS5wdXNoKHZpZXdNb2RlbE5hbWUpO1xyXG4gICAgdmlld01vZGVsLmJpbmRUb1BhcmVudChwYXJlbnRWaWV3TW9kZWwpO1xyXG4gIH1cclxuXHJcbiAgLy8gI2VuZHJlZ2lvblxyXG5cclxuICAvKipcclxuICAgKiDmo4Dmn6XmmK/lkKbkuLrmoLlGcmFtZUNvbnRleHRcclxuICAgKiBAc3VtbWFyeVxyXG4gICAqIOajgOafpeivpUZyYW1lQ29udGV4dOaYr+S4jeaYr+aJgOWcqEFwcENvbnRleHTkuK3nmoTmoLlGcmFtZUNvbnRleHRcclxuICAgKi9cclxuICBwdWJsaWMgaXNSb290RnJhbWVDb250ZXh0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMucGFyZW50ID09PSBudWxsIHx8ICh0aGlzLmFwcENvbnRleHQucnVuTW9kZSA9PT0gUnVuTW9kZS5oaWdoU3BlZWQgJiYgdGhpcy5nZXRWaXJ0dWFsUm9vdEZyYW1lQ29udGV4dCgpLmZyYW1lQ29tcG9uZW50Wydpc0RpYWxvZ1Jvb3RDb21wb25lbnQnXSA9PT0gdHJ1ZSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOmAmui/h25hbWVzcGFjZeiOt+WPluW9k+WJjeihqOWNleeahHJvb3QtZnJhbWVjb250ZXh0KOmdnuaVtOS4quihqOWNlSlcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiDlpoLmnpzkuLrnu4TlkIjooajljZXvvIzlhbblvZPliY3ooajljZXnmoRyb290LWZyYW1lY29udGV4dOS4uuWNleS4quihqOWNleeahGZyYW1lY29udGV4dO+8jOiAjOmdnuaVtOS4quihqOWNleeahGZyYW1lY29udGV4dFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRWaXJ0dWFsUm9vdEZyYW1lQ29udGV4dCgpIHtcclxuICAgIGxldCBmb3JtRnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQgPSB0aGlzO1xyXG4gICAgbGV0IHBhcmVudCA9IHRoaXMucGFyZW50O1xyXG4gICAgd2hpbGUgKHBhcmVudCkge1xyXG4gICAgICAvLyDlhbzlrrnmsqHmnInph43mlrDnvJbor5HnmoTooajljZXvvIzlpoLmnpzliKTmlq1wYXJlbnQubmFtZXNwYWNl5a2Y5Zyo5Lya5a+86Ie06I635Y+W5LiN5Yiwcm9vdC1mcmFtZWNvbnRleHRcclxuICAgICAgaWYgKHBhcmVudC5uYW1lc3BhY2UgPT09IHRoaXMubmFtZXNwYWNlKSB7XHJcbiAgICAgICAgZm9ybUZyYW1lQ29udGV4dCA9IHBhcmVudDtcclxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZm9ybUZyYW1lQ29udGV4dDtcclxuICB9XHJcblxyXG5cclxuICBwdWJsaWMgZ2V0Q29udGV4dEJ5SWQoaWRlbnRpZnk6IHN0cmluZyk6IGFueSB7XHJcbiAgICByZXR1cm4gdGhpcy5hcHBDb250ZXh0LmdldENvbnRleHRCeUlkKGlkZW50aWZ5KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRWaWV3TW9kZWwodmlld01vZGVsTmFtZTogc3RyaW5nKTogVmlld01vZGVsIHtcclxuICAgIGNvbnN0IHJlbmRlckFwcENvbnRleHQgPSB0aGlzLmFwcENvbnRleHQ7XHJcbiAgICBpZiAocmVuZGVyQXBwQ29udGV4dCkge1xyXG4gICAgICByZXR1cm4gcmVuZGVyQXBwQ29udGV4dC52aWV3TW9kZWxNYW5hZ2VyLmdldFZpZXdNb2RlbEJ5TmFtZSh2aWV3TW9kZWxOYW1lKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGF0dGFjaFZpZXdDb21wb25lbnQodmlld0NvbXBvbmVudDogRnJhbWVDb21wb25lbnQpIHtcclxuICAgIHRoaXMuZnJhbWVDb21wb25lbnQgPSB2aWV3Q29tcG9uZW50O1xyXG4gICAgdGhpcy5hcHBDb250ZXh0LmZyYW1lQ29tcG9uZW50UmVmcmVzaGVyLnJlZ0ZyYW1lQ29tcG9uZW50KHRoaXMuZnJhbWVJZCwgdGhpcy5mcmFtZUNvbXBvbmVudCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaW52b2tlKGFjdGlvblBhdGg6IHN0cmluZywgJGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IGFjdGlvbkJpbmRpbmdQYXRoID0gYWN0aW9uUGF0aC5zcGxpdCgnLicpO1xyXG4gICAgY29uc3QgYWN0aW9uTmFtZSA9IGFjdGlvbkJpbmRpbmdQYXRoW2FjdGlvbkJpbmRpbmdQYXRoLmxlbmd0aCAtIDFdO1xyXG4gICAgY29uc3QgYmluZGluZ1ZpZXdNb2RlbCA9IGFjdGlvbkJpbmRpbmdQYXRoLmxlbmd0aCA9PT0gMSA/IHRoaXMudmlld01vZGVsIDpcclxuICAgICAgdGhpcy5nZXRWaWV3TW9kZWwoYWN0aW9uQmluZGluZ1BhdGhbYWN0aW9uQmluZGluZ1BhdGgubGVuZ3RoIC0gMl0pO1xyXG4gICAgaWYgKCFiaW5kaW5nVmlld01vZGVsKSB7XHJcbiAgICAgIGFsZXJ0KGDmnKrljLnphY3liLAnJHthY3Rpb25QYXRofSflkb3ku6TnmoTop4blm77mqKHlnovvvIzor7fmo4Dmn6Xkuovku7bmmK/lkKbphY3nva7mraPnoa7jgIJgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBiaW5kaW5nVmlld01vZGVsW2FjdGlvbk5hbWVdKCRldmVudCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==