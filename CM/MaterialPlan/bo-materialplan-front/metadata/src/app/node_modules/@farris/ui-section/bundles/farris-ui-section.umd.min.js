!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("resize-observer-polyfill"),require("rxjs/operators"),require("@angular/core"),require("@angular/common"),require("@farris/ui-locale"),require("@farris/ui-common"),require("@farris/ui-tabs")):"function"==typeof define&&define.amd?define("@farris/ui-section",["exports","rxjs","resize-observer-polyfill","rxjs/operators","@angular/core","@angular/common","@farris/ui-locale","@farris/ui-common","@farris/ui-tabs"],e):e((t.farris=t.farris||{},t.farris["ui-section"]={}),t.rxjs,t.ResizeObserver,t.rxjs.operators,t.ng.core,t.ng.common,t.uiLocale,t.uiCommon,t.uiTabs)}(this,function(t,o,n,i,e,r,a,s,l){"use strict";n=n&&n.hasOwnProperty("default")?n["default"]:n;var c=(p.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],p.ctorParameters=function(){return[]},p.ngInjectableDef=e.defineInjectable({factory:function(){return new p},token:p,providedIn:"root"}),p);function p(){}function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(o=r.next()).done;)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return a}function b(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}var u=(f.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionTitle]"}]}],f.ctorParameters=function(){return[{type:e.TemplateRef}]},f.propDecorators={titleCls:[{type:e.Input}]},f);function f(t){this.templateRef=t}var h=(g.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionHeader]"}]}],g.ctorParameters=function(){return[{type:e.TemplateRef}]},g.propDecorators={headerCls:[{type:e.Input}]},g);function g(t){this.templateRef=t}var m=(v.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionHcontent]"}]}],v.ctorParameters=function(){return[{type:e.TemplateRef}]},v.propDecorators={hcontentCls:[{type:e.Input}]},v);function v(t){this.templateRef=t}var y=(C.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionToolbar]"}]}],C.ctorParameters=function(){return[{type:e.TemplateRef}]},C.propDecorators={toolbarCls:[{type:e.Input}]},C);function C(t){this.templateRef=t}var D=(x.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionViewChange]"}]}],x.ctorParameters=function(){return[{type:e.TemplateRef}]},x.propDecorators={viewChangeCls:[{type:e.Input}]},x);function x(t){this.templateRef=t}var T=(I.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionExtend]"}]}],I.ctorParameters=function(){return[{type:e.TemplateRef}]},I.propDecorators={extendCls:[{type:e.Input}]},I);function I(t){this.templateRef=t}var S=(w.decorators=[{type:e.Directive,args:[{selector:"[farrisSectionContent]"}]}],w.ctorParameters=function(){return[{type:e.TemplateRef}]},w.propDecorators={contentCls:[{type:e.Input}]},w);function w(t){this.templateRef=t}var B=(Object.defineProperty(R.prototype,"fillCls",{get:function(){return this.fill},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"enableAccordionCls",{get:function(){return"default"==this.enableAccordion},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"enableCollapseCls",{get:function(){return("default"===this.enableAccordion||"custom"===this.enableAccordion)&&!this.expandStatus},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"enableCustomAccordionCls",{get:function(){return"custom"==this.enableAccordion},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"toolbar",{get:function(){return this._toolbar},set:function(t){t?(this._toolbar=t,this.toolbarPosition=this.getToolbarPosition(),this.toolbarBtns=b(this.toolbar.contents),this.inMoreButtonContents=[],this.bindResizeEvent(),this.afterBindToolbarData()):(this._toolbar=null,this.toolbarPosition="",this.toolbarBtns=[],this.inMoreButtonContents=[],this.unBindResizeEvent())},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"btnStates",{set:function(t){t&&(this._disableDatas&&this._disableDatas.hasOwnProperty("unsubscribe")&&this._disableDatas.unsubscribe(),this._disableDatas=t)},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"btnVisible",{set:function(t){t&&(this._visibleDatas&&this._visibleDatas.hasOwnProperty("unsubscribe")&&this._visibleDatas.unsubscribe(),this._visibleDatas=t)},enumerable:!0,configurable:!0}),R.prototype.trackByButton=function(t,e){return e.id},R.prototype.ngOnInit=function(){var e=this;this.clickSubscription=this.clickItems.pipe(i.debounceTime(this.clickThrottleTime)).subscribe(function(t){t.click&&"function"==typeof t.click&&t.click({context:e.context})}),this._disableDatas.subscribe(function(t){e.changeState(t,"disable")}),this._visibleDatas.subscribe(function(t){e.changeState(t,"visible")})},R.prototype.getState=function(t,e){return t.hasOwnProperty(e)?t[e]:"visible"==e},R.prototype.changeState=function(o,i){var r=this,n=Object.keys(o);n.forEach(function(t){var e=o[t],n=r._findItemByID(t,r.toolbarBtns);n&&(n[i]=e)}),this.inMoreButtonContents.forEach(function(e){var t=n.find(function(t){return t==e.id});t&&(e[i]=o[t])})},R.prototype._findItemByID=function(e,t){return t.find(function(t){return t.id==e})},R.prototype.ngOnDestroy=function(){this.clickSubscription&&(this.clickSubscription.unsubscribe(),this.clickSubscription=null),this._visibleDatas&&this._visibleDatas.hasOwnProperty("unsubscribe")&&(this._visibleDatas.unsubscribe(),this._visibleDatas=null),this._disableDatas&&this._disableDatas.hasOwnProperty("unsubscribe")&&(this._disableDatas.unsubscribe(),this._disableDatas=null),this.unBindResizeEvent()},R.prototype.bindResizeEvent=function(){var e=this;this.ngZone&&this.toolbar&&0<this.toolbar.contents.length?this.ngZone.runOutsideAngular(function(){setTimeout(function(){if(e.toolbarContainer){if(e.ro){if(e.toolbarContainer.nativeElement.parentElement==e.resizeEl)return;e.unBindResizeEvent()}null===e.ro&&(e.ro=new n(function(t){e._calculateToolbarDropdownIsShow(),e._calculateButtonsShow()}),e.resizeEl=e.toolbarContainer.nativeElement.parentElement,e.ro.observe(e.resizeEl))}},0)}):this.unBindResizeEvent()},R.prototype.afterBindToolbarData=function(){var t=this;this.ngZone&&this.toolbar&&0<this.toolbar.contents.length&&this.ngZone.runOutsideAngular(function(){setTimeout(function(){t._calculateToolbarDropdownIsShow(),t._calculateButtonsShow()},0)})},R.prototype._calculateToolbarDropdownIsShow=function(){if(this.toolbarContainer&&this.toolbar&&this.toolbarPosition){var t=this.toolbarContainer.nativeElement.parentElement;this.btnPlaceHolder.nativeElement.scrollWidth>t.offsetWidth?this.toolbarDpHidden=!1:this.toolbarDpHidden=!0}else this.toolbarDpHidden=!0},R.prototype._calculateButtonsShow=function(){if(this.toolbarContainer&&this.toolbar&&this.toolbarPosition){if(this.toolbarDpHidden)return this.toolbarBtns=b(this.toolbar.contents),void(this.inMoreButtonContents=[]);var t=this.toolbarContainer.nativeElement.parentElement,e=this.toolbarContainer.nativeElement,n=this.btnPlaceHolder.nativeElement,o=n.querySelectorAll("button"),i=t.querySelector(".morebtn"),r=parseInt(n.getBoundingClientRect().left),a=t.offsetWidth-i.offsetWidth-12,s=!0,l=0;if(1==o.length)n.offsetWidth>a?s=!1:l=1;else for(l=1;l<=o.length-1;l++)if(l==o.length-1){if(n.offsetWidth>a){s=!1,l-=1;break}}else if(parseInt(o[l].getBoundingClientRect().left)-r>a){s=!1,l-=1;break}this.toolbarDpHidden=s,e.querySelectorAll("button");var c=this.toolbar.contents.filter(function(t,e){return e<l});this.toolbarBtns=c?b(c):[],this.toolbar.contents&&this.toolbar.contents.length&&(this.inMoreButtonContents=this.toolbar.contents.filter(function(t,e){return l<=e}))}},R.prototype.unBindResizeEvent=function(){this.ro&&(this.resizeEl&&this.ro.unobserve(this.resizeEl),this.ro=null)},R.prototype.getToolbarPosition=function(){return this.toolbar&&this.toolbar.hasOwnProperty("position")&&this.toolbar.hasOwnProperty("contents")&&0<this.toolbar.contents.length?"inHead"===this.toolbar.position?"inHead":"inContent":""},R.prototype.getToolbarState=function(e,t,n){return void 0===t&&(t=this.btnStates),void 0===n&&(n=!1),t?t.pipe(i.map(function(t){return t[e]===undefined?n:t[e]})):o.of(n)},R.prototype.clickHandler=function(t){t&&this.clickItems.next(t)},R.decorators=[{type:e.Component,args:[{selector:"farris-section",template:'<div class="f-section-header" [ngClass]="headerDirective && headerDirective.headerCls" *ngIf="showHeader">\r\n    \r\n    <div *ngIf="headerComponentType" component-template [cmpRef]="headerComponentType" [ctx]="ctx"></div>\r\n\r\n    <ng-template [ngTemplateOutlet]="headerDirective.templateRef"\r\n        *ngIf="!headerComponentType&&headerDirective && headerDirective.templateRef"></ng-template>\r\n    <ng-template [ngIf]="!headerDirective">\r\n        <div component-template *ngIf="titleComponentType" [cmpRef]="titleComponentType" [ctx]="ctx"></div>\r\n        <ng-template [ngTemplateOutlet]="headerTitleDirective.templateRef"\r\n            *ngIf="!titleComponentType&&headerTitleDirective && headerTitleDirective.templateRef" [ngTemplateOutletContext]="{context:this.context,index:this.index }"></ng-template>\r\n        <div *ngIf="!headerComponentType&&!titleComponentType&&(!headerTitleDirective||!headerTitleDirective.templateRef)" class="f-title"\r\n            (click)="this.expandStatus = !this.expandStatus">\r\n            <h4 class="f-title-text">{{ mainTitle }}</h4>\r\n            <span *ngIf="subTitle && subTitle.length">{{\r\n            subTitle\r\n        }}</span>\r\n        </div>\r\n        <div class="f-content"  *ngIf="contentComponentType" component-template [cmpRef]="contentComponentType" [ctx]="ctx"></div>\r\n        <div class="f-content" [ngClass]="\r\n            headerContentDirective &&\r\n            headerContentDirective.hcontentCls\r\n        " *ngIf="\r\n            !contentComponentType&&headerContentDirective &&\r\n            headerContentDirective.templateRef\r\n        ">\r\n            <ng-template [ngTemplateOutlet]="headerContentDirective.templateRef"></ng-template>\r\n        </div>\r\n        <div class="f-toolbar"  *ngIf="toolbarComponentType" component-template [cmpRef]="toolbarComponentType" [ctx]="ctx"></div>\r\n        <div class="f-toolbar" [ngClass]="\r\n            headerToolbarDirective &&\r\n            headerToolbarDirective.toolbarCls" *ngIf=" !toolbarComponentType&&headerToolbarDirective &&headerToolbarDirective.templateRef ">\r\n            <ng-template [ngTemplateOutlet]="headerToolbarDirective.templateRef" *ngIf="\r\n                headerToolbarDirective &&\r\n                headerToolbarDirective.templateRef\r\n            "></ng-template>\r\n        </div>\r\n        <div #toolbarHeaderContainer class="f-section-toolbar f-section-header--toolbar"\r\n            *ngIf="!toolbarComponentType&&!headerToolbarDirective&&toolbarPosition==\'inHead\'">\r\n            <ng-container [ngTemplateOutlet]="toolbarBtnTmpl"\r\n                [ngTemplateOutletContext]="{ datas: toolbarBtns, dpHidden:toolbarDpHidden,dpDatas:inMoreButtonContents}">\r\n            </ng-container>\r\n        </div>\r\n        <div class="f-viewchange" *ngIf="viewchagneComponentType" component-template [cmpRef]="viewchagneComponentType" [ctx]="ctx"></div>\r\n        <div class="f-viewchange" [ngClass]="viewChangeDirective && viewChangeDirective.viewChangeCls"\r\n            *ngIf="!viewchagneComponentType&&viewChangeDirective &&viewChangeDirective.templateRef ">\r\n            <ng-template [ngTemplateOutlet]="viewChangeDirective.templateRef"></ng-template>\r\n        </div>\r\n        <div class="f-max-accordion" *ngIf="enableMaximize||enableAccordion!=\'\'">\r\n            <span class="f-icon" *ngIf="enableMaximize" [class.f-icon-maximize]="!maxStatus"\r\n                [class.f-icon-minimize]="maxStatus" (click)="this.maxStatus = !this.maxStatus"> </span>\r\n            <button class="btn f-btn-collapse-expand f-btn-mx" *ngIf="enableAccordion"\r\n                [ngClass]="{ \'f-state-expand\': expandStatus }" (click)="this.expandStatus = !this.expandStatus">\r\n                <span *ngIf="!expandStatus">{{\'section.expandLabel\'|locale}}</span>\r\n                <span *ngIf="expandStatus">{{\'section.collapseLabel\'|locale}}</span>\r\n            </button>\r\n        </div>\r\n    </ng-template>\r\n\r\n    <div class="f-section-header--btn-placeholder" #btnPlaceholder *ngIf="!headerToolbarDirective&&toolbarPosition">\r\n        <ng-container *ngFor="let btn of toolbar.contents">\r\n            <button [ngClass]="btn.appearance.class"\r\n                *ngIf="getToolbarState(btn.id, btnVisible,true) | async">{{btn.title}}</button>\r\n        </ng-container>\r\n    </div>\r\n</div>\r\n<div class="f-section-header--btn-placeholder" #btnPlaceholder *ngIf="!showHeader&&toolbarPosition==\'inContent\'">\r\n    <ng-container *ngFor="let btn of toolbar.contents">\r\n        <button [ngClass]="btn.appearance.class"\r\n            *ngIf="getToolbarState(btn.id, btnVisible,true) | async">{{btn.title}}</button>\r\n    </ng-container>\r\n</div>\r\n\r\n<div class="f-section-extend" *ngIf="extendComponentType" component-template [cmpRef]="extendComponentType" [ctx]="ctx">\r\n</div>\r\n\r\n<div class="f-section-extend" [ngClass]="extendDirective && extendDirective.extendCls" \r\n    *ngIf="!extendComponentType&&extendDirective && extendDirective.templateRef">\r\n    <ng-template  [ngTemplateOutlet]="extendDirective.templateRef"></ng-template>\r\n</div>\r\n\r\n<div class="f-section-content" [ngClass]="contentCls">\r\n    <div class="f-section-toolbar f-section-content--toolbar"\r\n        *ngIf="!toolbarComponentType&&!headerToolbarDirective&&toolbarPosition==\'inContent\'">\r\n        <ng-container [ngTemplateOutlet]="toolbarBtnTmpl"\r\n            [ngTemplateOutletContext]="{ datas: toolbarBtns, dpHidden:toolbarDpHidden,dpDatas:inMoreButtonContents}">\r\n        </ng-container>\r\n    </div>\r\n    <ng-content></ng-content>\r\n</div>\r\n<ng-template #toolbarBtnTmpl let-datas="datas" let-dpHidden="dpHidden" let-dpDatas="dpDatas">\r\n    <div class="toolbar-btn-inline-flex" #toolbarContainer>\r\n        <ng-container *ngFor="let btn of datas;trackBy:trackByButton">\r\n            <button [attr.id]="btn.id" [ngClass]="btn.appearance.class"\r\n                *ngIf="getState(btn,\'visible\')"\r\n                [disabled]="getState(btn,\'disable\')"\r\n                (click)="clickHandler(btn)">{{btn.title}}</button>\r\n        </ng-container>\r\n    </div>\r\n    <div class="btn-group sc-nav-btn" ngbDropdown [hidden]="dpHidden">\r\n        <button class="btn btn-link morebtn" ngbDropdownToggle>{{\'tabs.more\' | locale}}</button>\r\n        <ul class="dropdown-menu" ngbDropdownMenu *ngIf="dpDatas.length>0">\r\n            <ng-container *ngFor="let dpBtn of dpDatas;trackBy:trackByButton">\r\n                <li class="dropdown-item text-truncate px-2"   *ngIf="getState(dpBtn,\'visible\')">\r\n                    <button style="width:100%;" [attr.id]="dpBtn.id" class="btn btn-link text-left"\r\n                        [class.disabled]="getState(dpBtn,\'disable\')"\r\n                        (click)="clickHandler(dpBtn)">{{dpBtn.title}}</button>\r\n                </li>\r\n            </ng-container>\r\n        </ul>\r\n    </div>\r\n</ng-template>',styles:[".f-section-header--btn-placeholder{position:absolute;display:-webkit-inline-box;display:inline-flex;top:-30px;left:0;opacity:0;overflow:hidden;z-index:-90}.f-section-content .toolbar-btn-inline-flex,.f-section-header .toolbar-btn-inline-flex{display:-webkit-inline-box;display:inline-flex;overflow:hidden}.f-section-header--toolbar{-webkit-box-flex:1;flex:1;-webkit-box-align:center;align-items:center;width:30%;display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;margin-left:.875rem}.f-section-content--toolbar{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}"]}]}],R.ctorParameters=function(){return[{type:e.Injector,decorators:[{type:e.Optional}]}]},R.propDecorators={contentCls:[{type:e.Input}],baseCls:[{type:e.HostBinding,args:["class.f-section"]}],maxStatus:[{type:e.HostBinding,args:["class.f-section-maximize"]}],fillCls:[{type:e.HostBinding,args:["class.f-section-fill"]}],enableAccordionCls:[{type:e.HostBinding,args:["class.f-section-accordion"]}],enableCollapseCls:[{type:e.HostBinding,args:["class.f-state-collapse"]}],enableCustomAccordionCls:[{type:e.HostBinding,args:["class.f-section-custom-accordion"]}],mainTitle:[{type:e.Input}],subTitle:[{type:e.Input}],showHeader:[{type:e.Input}],enableMaximize:[{type:e.Input}],enableAccordion:[{type:e.Input}],fill:[{type:e.Input}],expandStatus:[{type:e.Input}],context:[{type:e.Input}],index:[{type:e.Input}],toolbar:[{type:e.Input}],ctx:[{type:e.Input}],headerComponentType:[{type:e.Input}],titleComponentType:[{type:e.Input}],contentComponentType:[{type:e.Input}],toolbarComponentType:[{type:e.Input}],extendComponentType:[{type:e.Input}],viewchagneComponentType:[{type:e.Input}],headerDirective:[{type:e.ContentChild,args:[h]}],headerTitleDirective:[{type:e.ContentChild,args:[u]}],headerContentDirective:[{type:e.ContentChild,args:[m]}],headerToolbarDirective:[{type:e.ContentChild,args:[y]}],extendDirective:[{type:e.ContentChild,args:[T]}],contentDirective:[{type:e.ContentChild,args:[S]}],viewChangeDirective:[{type:e.ContentChild,args:[D]}],btnStates:[{type:e.Input}],btnVisible:[{type:e.Input}],clickThrottleTime:[{type:e.Input}],toolbarContainer:[{type:e.ViewChild,args:["toolbarContainer"]}],btnPlaceHolder:[{type:e.ViewChild,args:["btnPlaceholder"]}]},R);function R(t){this.inject=t,this.contentCls="",this.baseCls=!0,this.maxStatus=!1,this.showHeader=!0,this.enableMaximize=!1,this.enableAccordion="",this.fill=!1,this.expandStatus=!0,this.toolbarPosition="",this.toolbarBtns=[],this._toolbar=null,this.toolbarDpHidden=!0,this._disableDatas=new o.Subject,this._visibleDatas=new o.Subject,this.clickThrottleTime=350,this.clickItems=new o.Subject,this.ro=null,this.resizeEl=null,this.inMoreButtonContents=[],this.inject&&(this.ngZone=this.inject.get(e.NgZone,null),this.renderer=this.inject.get(e.Renderer2,null))}var P=(k.decorators=[{type:e.NgModule,args:[{declarations:[B,S,T,m,h,u,y,D],imports:[r.CommonModule,s.FarrisCommonModule,a.LocaleModule,l.NgbDropdownModule.forRoot()],exports:[B,S,T,m,h,u,y,D]}]}],k);function k(){}t.SectionService=c,t.FarrisSectionComponent=B,t.FarrisSectionModule=P,t.FarrisSectionContentDirective=S,t.FarrisSectionExtendDirective=T,t.FarrisSectionHcontentDirective=m,t.FarrisSectionHeaderDirective=h,t.FarrisSectionTitleDirective=u,t.FarrisSectionToolbarDirective=y,t.FarrisSectionViewChangeDirective=D,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-section.umd.min.js.map