/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, Output, EventEmitter, ViewChild, Injector, Renderer2, Input } from '@angular/core';
import { trigger, style, transition, animate } from '@angular/animations';
import { PersonalConfigService } from './lookup-presonalConfig.service';
export class LookupTabsComponent {
    /**
     * @param {?} injector
     */
    constructor(injector) {
        this.injector = injector;
        this.enableFav = false;
        this.enableSelected = false;
        this.selectedTotal = 0;
        this.activeTab = 'datalist';
        this.visible = false;
        this.layout = 'default';
        this.dialogTitle = '';
        this.tabChange = new EventEmitter();
        this.render = null;
        this.el = null;
        this.personalConfigService = this.injector.get(PersonalConfigService, null);
        this.render = this.injector.get(Renderer2);
        this.el = this.injector.get(ElementRef);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.activeTab && !changes.activeTab.isFirstChange()) {
            this.initInkBarPos(changes.activeTab.currentValue);
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.initInkBarPos(this.activeTab);
        }), 300);
    }
    /**
     * @param {?} e
     * @param {?} v
     * @return {?}
     */
    navClickHandle(e, v) {
        e.stopPropagation();
        if (this.activeTab !== v) {
            this.activeTab = v;
            this.tabChange.emit({ event: e, tabIndex: v });
            this.initInkBarPos(v);
        }
    }
    /**
     * @param {?} which
     * @return {?}
     */
    initInkBarPos(which) {
        if (this.layout !== 'default') {
            return;
        }
        if (!this.enableFav && !this.enableSelected) {
            return;
        }
        /** @type {?} */
        let width = this.dataListNavRef.nativeElement.offsetWidth;
        /** @type {?} */
        let left = 0;
        if (which !== 'datalist') {
            left = this.dataListNavRef.nativeElement.offsetWidth;
        }
        if (which === 'favorite') {
            width = this.favoriteNavRef.nativeElement.offsetWidth;
        }
        else if (which === 'selected') {
            if (this.favoriteNavRef) {
                left += this.favoriteNavRef.nativeElement.offsetWidth;
            }
            if (this.selectedNavRef) {
                width = this.selectedNavRef.nativeElement.offsetWidth;
            }
            else {
                this.activeTab = 'datalist';
            }
        }
        this.inkBarRef.nativeElement.style = `width: ${width}px; transform: translate3d(${left}px, 0px, 0px);`;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
}
LookupTabsComponent.decorators = [
    { type: Component, args: [{
                selector: 'lookup-tabs',
                template: "<div class=\"lookup-tabs-nav\" *ngIf=\"(enableFav || enableSelected) && layout === 'default'\">\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'datalist'\" (click)=\"navClickHandle($event, 'datalist')\" #dataListNav>{{ 'lookup.datalist' | locale: '\u6570\u636E\u5217\u8868' }}</div>\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'favorite'\" *ngIf=\"enableFav\" (click)=\"navClickHandle($event, 'favorite')\" #favoriteNav>{{ 'lookup.favorites' | locale: '\u6536\u85CF\u5939' }}</div>\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'selected'\"  *ngIf=\"enableSelected\" (click)=\"navClickHandle($event, 'selected')\" #selectedNav>{{ 'lookup.selected' | locale: '\u5DF2\u9009\u6570\u636E' }}\r\n        <div class=\"lookup-selected-total\" style=\"background: #0068f3;display: inline-block;\r\n        color: white;border-radius: 10px;padding: 0 5px; text-align: center;\">\r\n        {{ selectedTotal }}\r\n        </div>\r\n    </div>\r\n    <div class=\"tabs-ink-bar tabs-ink-bar-animated\" #inkBar></div>\r\n</div>\r\n\r\n<lookup-advanced-layout *ngIf=\"layout !== 'default'\" #advanceLayout class=\"lookup-advanced-layout\"\r\n[title]=\"dialogTitle\"\r\n[enableFav]=\"enableFav\"\r\n[activeTab]=\"activeTab\"\r\n(tabChanged)=\"navClickHandle($event.$event, $event.tab)\"\r\n></lookup-advanced-layout>\r\n\r\n<div class=\"lookup-tabs-content\" style=\"transition: all 0.1s ease-in;\" [style.opacity]=\"visible ? 1: 0\">\r\n    <div class=\"lookup-datalist\" style=\"height:100%\"  @flyInOut *ngIf=\"activeTab === 'datalist'\">\r\n        <div style=\"height: 100%\">\r\n            <ng-content select=\"[datalist]\"></ng-content>\r\n        </div>\r\n    </div>\r\n    <div class=\"lookup-favorites\" style=\"height:100%; padding-top: 10px;\" @flyInOut *ngIf=\"activeTab === 'favorite'\" >\r\n        <div style=\"height: 100%\">\r\n            <ng-content select=\"[favorites]\"></ng-content>\r\n        </div>\r\n    </div>\r\n    <div class=\"lookup-selected\" style=\"height:100%; padding-top: 10px;\" @flyInOut *ngIf=\"activeTab === 'selected'\">\r\n        <div  style=\"height: 100%\">\r\n            <ng-content select=\"[selected]\"></ng-content>\r\n        </div>\r\n    </div>\r\n</div>",
                animations: [
                    trigger('flyInOut', [
                        transition(':enter', [style({ opacity: 0 }), animate('.3s', style({ opacity: 1 }))]),
                        transition(':leave', [animate('.3s', style({ opacity: 0 }))])
                    ])
                ],
                styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}:host .lookup-tabs-nav{position:relative;display:inline-block;box-sizing:border-box;margin:0;padding-left:0;list-style:none;-webkit-transition:-webkit-transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1)}:host .lookup-tabs-nav .nav-item{position:relative;display:inline-block;text-decoration:none;box-sizing:border-box;padding:.625rem .8125rem;color:inherit;cursor:pointer}:host .lookup-tabs-nav .nav-item-selected{color:#1890ff}:host .lookup-tabs-nav .tabs-ink-bar{position:absolute;bottom:1px;left:0;z-index:1;box-sizing:border-box;height:2px;background-color:#1890ff;-webkit-transform-origin:0 0;transform-origin:0 0}:host .lookup-tabs-nav .tabs-ink-bar-animated{-webkit-transition:width .3s cubic-bezier(.645,.045,.355,1),left .3s cubic-bezier(.71,.03,.35,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1),width .3s cubic-bezier(.645,.045,.355,1),left .3s cubic-bezier(.71,.03,.35,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1)}:host .lookup-tabs-content{-webkit-box-flex:1;flex:1;border-top:1px solid #cecece;position:relative;top:-2px}"]
            }] }
];
/** @nocollapse */
LookupTabsComponent.ctorParameters = () => [
    { type: Injector }
];
LookupTabsComponent.propDecorators = {
    enableFav: [{ type: Input }],
    enableSelected: [{ type: Input }],
    selectedTotal: [{ type: Input }],
    activeTab: [{ type: Input }],
    visible: [{ type: Input }],
    layout: [{ type: Input }],
    dialogTitle: [{ type: Input }],
    tabChange: [{ type: Output }],
    inkBarRef: [{ type: ViewChild, args: ['inkBar',] }],
    dataListNavRef: [{ type: ViewChild, args: ['dataListNav',] }],
    favoriteNavRef: [{ type: ViewChild, args: ['favoriteNav',] }],
    selectedNavRef: [{ type: ViewChild, args: ['selectedNav',] }],
    advanceLayoutRef: [{ type: ViewChild, args: ['advanceLayout',] }]
};
if (false) {
    /** @type {?} */
    LookupTabsComponent.prototype.enableFav;
    /** @type {?} */
    LookupTabsComponent.prototype.enableSelected;
    /** @type {?} */
    LookupTabsComponent.prototype.selectedTotal;
    /** @type {?} */
    LookupTabsComponent.prototype.activeTab;
    /** @type {?} */
    LookupTabsComponent.prototype.visible;
    /** @type {?} */
    LookupTabsComponent.prototype.layout;
    /** @type {?} */
    LookupTabsComponent.prototype.dialogTitle;
    /** @type {?} */
    LookupTabsComponent.prototype.tabChange;
    /** @type {?} */
    LookupTabsComponent.prototype.inkBarRef;
    /** @type {?} */
    LookupTabsComponent.prototype.dataListNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.favoriteNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.selectedNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.advanceLayoutRef;
    /** @type {?} */
    LookupTabsComponent.prototype.personalConfigService;
    /**
     * @type {?}
     * @private
     */
    LookupTabsComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    LookupTabsComponent.prototype.el;
    /** @type {?} */
    LookupTabsComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLXRhYnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1sb29rdXAvIiwic291cmNlcyI6WyJsaWIvbG9va3VwLXRhYnMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFVLFVBQVUsRUFDN0IsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQzlELE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxPQUFPLEVBQVMsS0FBSyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQWF4RSxNQUFNLE9BQU8sbUJBQW1COzs7O0lBdUI1QixZQUFtQixRQUFrQjtRQUFsQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBckI1QixjQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ2xCLG1CQUFjLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLGtCQUFhLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLGNBQVMsR0FBRyxVQUFVLENBQUM7UUFDdkIsWUFBTyxHQUFHLEtBQUssQ0FBQztRQUVoQixXQUFNLEdBQUcsU0FBUyxDQUFDO1FBQ25CLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBRWhCLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBVXRDLFdBQU0sR0FBYyxJQUFJLENBQUM7UUFDekIsT0FBRSxHQUFlLElBQUksQ0FBQztRQUUxQixJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDNUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzQyxJQUFJLENB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QyxDQUFDLENBQUMsQ0FBQztxQkFDaEUsQ0FBQztpQkFDTDs7YUFDSjs7OztZQWZvQyxRQUFROzs7d0JBa0J4QyxLQUFLOzZCQUNMLEtBQUs7NEJBQ0wsS0FBSzt3QkFDTCxLQUFLO3NCQUNMLEtBQUs7cUJBRUwsS0FBSzswQkFDTCxLQUFLO3dCQUVMLE1BQU07d0JBRU4sU0FBUyxTQUFDLFFBQVE7NkJBQ2xCLFNBQVMsU0FBQyxhQUFhOzZCQUN2QixTQUFTLFNBQUMsYUFBYTs2QkFDdkIsU0FBUyxTQUFDLGFBQWE7K0JBQ3ZCLFNBQVMsU0FBQyxlQUFlOzs7O0lBZjFCLHdDQUEyQjs7SUFDM0IsNkNBQWdDOztJQUNoQyw0Q0FBMkI7O0lBQzNCLHdDQUFnQzs7SUFDaEMsc0NBQXlCOztJQUV6QixxQ0FBNEI7O0lBQzVCLDBDQUEwQjs7SUFFMUIsd0NBQThDOztJQUU5Qyx3Q0FBMkM7O0lBQzNDLDZDQUFxRDs7SUFDckQsNkNBQXFEOztJQUNyRCw2Q0FBcUQ7O0lBQ3JELCtDQUF5RDs7SUFFekQsb0RBQW9EOzs7OztJQUVwRCxxQ0FBaUM7Ozs7O0lBQ2pDLGlDQUE4Qjs7SUFDbEIsdUNBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBFbGVtZW50UmVmLCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsXHJcbiAgICBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBJbmplY3RvciwgUmVuZGVyZXIyLCBJbnB1dCwgU2ltcGxlQ2hhbmdlcywgVmlld0VuY2Fwc3VsYXRpb25cclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgdHJpZ2dlciwgc3RhdGUsIHN0eWxlLCB0cmFuc2l0aW9uLCBhbmltYXRlIH0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XHJcbmltcG9ydCB7IFBlcnNvbmFsQ29uZmlnU2VydmljZSB9IGZyb20gJy4vbG9va3VwLXByZXNvbmFsQ29uZmlnLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2xvb2t1cC10YWJzJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9sb29rdXAtdGFicy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9sb29rdXAtdGFicy5jb21wb25lbnQuc2NzcyddLFxyXG4gICAgYW5pbWF0aW9uczogW1xyXG4gICAgICAgIHRyaWdnZXIoJ2ZseUluT3V0JywgW1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCc6ZW50ZXInLCBbc3R5bGUoeyBvcGFjaXR5OiAwIH0pLCBhbmltYXRlKCcuM3MnLCBzdHlsZSh7IG9wYWNpdHk6IDEgfSkpXSksXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb24oJzpsZWF2ZScsIFthbmltYXRlKCcuM3MnLCBzdHlsZSh7IG9wYWNpdHk6IDAgfSkpXSlcclxuICAgICAgICBdKVxyXG4gICAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTG9va3VwVGFic0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0IHtcclxuXHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXYgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGVuYWJsZVNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZFRvdGFsID0gMDtcclxuICAgIEBJbnB1dCgpIGFjdGl2ZVRhYiA9ICdkYXRhbGlzdCc7XHJcbiAgICBASW5wdXQoKSB2aXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KCkgbGF5b3V0ID0gJ2RlZmF1bHQnO1xyXG4gICAgQElucHV0KCkgZGlhbG9nVGl0bGUgPSAnJztcclxuXHJcbiAgICBAT3V0cHV0KCkgdGFiQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnaW5rQmFyJykgaW5rQmFyUmVmOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZGF0YUxpc3ROYXYnKSBkYXRhTGlzdE5hdlJlZjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2Zhdm9yaXRlTmF2JykgZmF2b3JpdGVOYXZSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdzZWxlY3RlZE5hdicpIHNlbGVjdGVkTmF2UmVmOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnYWR2YW5jZUxheW91dCcpIGFkdmFuY2VMYXlvdXRSZWY6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgcHVibGljIHBlcnNvbmFsQ29uZmlnU2VydmljZTogUGVyc29uYWxDb25maWdTZXJ2aWNlO1xyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZiA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzb25hbENvbmZpZ1NlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChQZXJzb25hbENvbmZpZ1NlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuICAgICAgICB0aGlzLmVsID0gdGhpcy5pbmplY3Rvci5nZXQoRWxlbWVudFJlZik7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmFjdGl2ZVRhYiAmJiAhY2hhbmdlcy5hY3RpdmVUYWIuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdElua0JhclBvcyhjaGFuZ2VzLmFjdGl2ZVRhYi5jdXJyZW50VmFsdWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRJbmtCYXJQb3ModGhpcy5hY3RpdmVUYWIpO1xyXG4gICAgICAgIH0sIDMwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmF2Q2xpY2tIYW5kbGUoZTogRXZlbnQsIHY6IHN0cmluZykge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiICE9PSB2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiID0gdjtcclxuICAgICAgICAgICAgdGhpcy50YWJDaGFuZ2UuZW1pdCh7IGV2ZW50OiBlLCB0YWJJbmRleDogdiB9KTtcclxuICAgICAgICAgICAgdGhpcy5pbml0SW5rQmFyUG9zKHYpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdElua0JhclBvcyh3aGljaDogc3RyaW5nKSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmxheW91dCAhPT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVGYXYgJiYgIXRoaXMuZW5hYmxlU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHdpZHRoID0gdGhpcy5kYXRhTGlzdE5hdlJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGxldCBsZWZ0ID0gMDtcclxuICAgICAgICBpZiAod2hpY2ggIT09ICdkYXRhbGlzdCcpIHtcclxuICAgICAgICAgICAgbGVmdCA9IHRoaXMuZGF0YUxpc3ROYXZSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdoaWNoID09PSAnZmF2b3JpdGUnKSB7XHJcbiAgICAgICAgICAgIHdpZHRoID0gdGhpcy5mYXZvcml0ZU5hdlJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2hpY2ggPT09ICdzZWxlY3RlZCcpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZmF2b3JpdGVOYXZSZWYpIHtcclxuICAgICAgICAgICAgICAgIGxlZnQgKz0gdGhpcy5mYXZvcml0ZU5hdlJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE5hdlJlZikge1xyXG4gICAgICAgICAgICAgICAgd2lkdGggPSB0aGlzLnNlbGVjdGVkTmF2UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVRhYiA9ICdkYXRhbGlzdCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaW5rQmFyUmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUgPSBgd2lkdGg6ICR7d2lkdGh9cHg7IHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoJHtsZWZ0fXB4LCAwcHgsIDBweCk7YDtcclxuICAgIH1cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=