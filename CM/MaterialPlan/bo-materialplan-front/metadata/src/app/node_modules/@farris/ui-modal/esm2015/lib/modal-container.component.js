/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, HostListener, Renderer2, ViewChild, Output, EventEmitter, TemplateRef, Input, ViewChildren, QueryList, HostBinding } from '@angular/core';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { DomSanitizer } from "@angular/platform-browser";
import { CLASS_NAME, DISMISS_REASONS, ModalOptions, TRANSITION_DURATIONS } from './modal-options.class';
import { isBs3 } from '@farris/ui-modal/utils';
import { ModalButtonDirective } from './modal-button.directive';
import { fromEvent } from 'rxjs';
import { debounceTime } from 'rxjs/operators';
export class ModalContainerComponent {
    /**
     * @param {?} options
     * @param {?} el
     * @param {?} _renderer
     * @param {?} sanitizer
     */
    constructor(options, el, _renderer, sanitizer) {
        this.el = el;
        this._renderer = _renderer;
        this.sanitizer = sanitizer;
        this.isShown = false;
        this.isModalHiding = false;
        // 记录上次的高度
        this.isMax = false;
        this.closed = new EventEmitter();
        this.opened = new EventEmitter();
        this.resized = new EventEmitter();
        this.modalID = `MODALID_${Date.now().toPrecision()}`;
        this._windowResizeToMax = false;
        this.windowResize$ = null;
        this.config = Object.assign({}, options);
        if (!this.config.buttons) {
            this.config.buttons = [
                {
                    text: '取消',
                    cls: 'btn btn-light',
                    iconCls: 'k-icon k-i-close',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        this.close();
                    })
                },
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    iconCls: 'k-icon k-i-check',
                    handle: (/**
                     * @return {?}
                     */
                    () => { alert('好(｡･∀･)ﾉﾞ嗨哟!!'); })
                }
            ];
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set iframe(value) {
        if (this.sanitizer) {
            this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.boundsElement = this.el.nativeElement;
        if (this.config.fitContent) {
            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');
        }
        if (this.isAnimated) {
            this._renderer.addClass(this.el.nativeElement, CLASS_NAME.FADE);
        }
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.isShown = true;
            this._renderer.addClass(this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
            if (this.config.fitContent && this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {
                this.el.nativeElement.scrollTop = 0;
            }
            if (document && document.body) {
                /** @type {?} */
                const modalLen = this.bsModalService.getModalsCount();
                if (modalLen === 1) {
                    this.bsModalService.checkScrollbar();
                    this.bsModalService.setScrollbar();
                }
                if (!document.body.classList.contains(CLASS_NAME.OPEN)) {
                    this._renderer.addClass(document.body, CLASS_NAME.OPEN);
                }
            }
            this.opened.emit({ modal: this });
        }), this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);
        // });
        if (this.el.nativeElement) {
            this.el.nativeElement.focus();
        }
        this.dlgHeaderLineHeight = this.getDialogHeaderLineHeight() + 'px';
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // Called after ngAfterContentInit when the component's view has been initialized. Applies to components only.
        // Add 'implements AfterViewInit' to the class.
        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
        // 如果内容适应宽度
        if (this.config.fitContent) {
            /** @type {?} */
            let initElRect = this.el.nativeElement.getBoundingClientRect();
            /** @type {?} */
            let initBodySize = this.getContainerSize();
            if (initElRect.height < initBodySize.height + 30) {
                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');
            }
        }
        this.originalHeight = this.config.height;
        this.originalWidth = this.config.width;
        this.windowResize$ = fromEvent(window, 'resize').pipe(debounceTime(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            /** @type {?} */
            const winWidth = window.innerWidth - 20;
            /** @type {?} */
            const winHeight = window.innerHeight - 20;
            if (this.config.width <= winWidth && this.config.height <= winHeight) {
                if (this._windowResizeToMax) {
                    this.revertDialog();
                    this._windowResizeToMax = false;
                }
                else {
                    if (this.isMax) {
                        this.maxDialog(false);
                    }
                }
            }
            else {
                if (!this.isMax) {
                    this._windowResizeToMax = true;
                    this.maxDialog();
                }
                else {
                    this.maxDialog(false);
                }
            }
            this.toCenter();
            this.moveTo(0, 0);
        }));
    }
    /**
     * @private
     * @return {?}
     */
    getDlgElement() {
        return this.el.nativeElement.querySelector('.modal-dialog');
    }
    /**
     * @private
     * @return {?}
     */
    getDialogHeaderLineHeight() {
        if (this.config.showHeader) {
            /** @type {?} */
            const modalHeaderStyles = window.getComputedStyle(this.modalHeader.nativeElement);
            /** @type {?} */
            const paddingTop = parseInt(modalHeaderStyles.paddingTop.replace('px', ''), 10);
            /** @type {?} */
            const paddingBottom = parseInt(modalHeaderStyles.paddingBottom.replace('px', ''), 10);
            return this.config.dialogHeaderHeight - paddingTop - paddingBottom;
        }
        else {
            return 0;
        }
    }
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    getContainerSize() {
        /** @type {?} */
        const bodyTarget = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        const height = bodyTarget.offsetHeight;
        /** @type {?} */
        const width = bodyTarget.offsetWidth;
        return { width, height };
    }
    /**
     * @return {?}
     */
    buildFooterStyles() {
        /** @type {?} */
        let styles = {};
        if (this.config.dialogFooterStyles) {
            styles = Object.assign({}, styles, this.config.dialogFooterStyles);
        }
        return styles;
    }
    /**
     * @return {?}
     */
    useButtonsTemplate() {
        return this.config.buttons instanceof TemplateRef;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        /** @type {?} */
        const tag = (/** @type {?} */ (event.target));
        // if (tag.localName === 'label') {
        //     if (tag.className) {
        //         const clsList = tag.className.split(' ');
        //         if (
        //             clsList.indexOf('k-radio-label') > -1 ||
        //             clsList.indexOf('k-checkbox-label') > -1 ||
        //             clsList.indexOf('custom-control-label') > -1
        //         ) {
        //             return;
        //         }
        //     }
        // }
        // if (tag.localName === 'input' && (tag.type === 'checkbox' || tag.type === 'radio' || tag.type === 'file')) {
        //     return;
        // }
        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement) {
            event.stopPropagation();
            return;
        }
        this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);
        this.close();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onEsc(event) {
        if (!this.isShown) {
            return;
        }
        if (event.keyCode === 27) {
            event.preventDefault();
        }
        if (this.config.keyboard &&
            this.level === this.bsModalService.getModalsCount()) {
            this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);
            this.close(event);
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.isShown) {
            this.close();
        }
        if (this.windowResize$) {
            this.windowResize$.unsubscribe();
            this.windowResize$ = null;
        }
    }
    /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    close(e, isCloseButton = false) {
        if (e && e.stopPropagation) {
            e.stopPropagation();
        }
        if (this.isModalHiding || !this.isShown) {
            return;
        }
        this.config.beforeClose(this, { event: e }).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        r => {
            if (!r) {
                return false;
            }
            this.isModalHiding = true;
            this._renderer.removeClass(this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.isShown = false;
                if (document &&
                    document.body) {
                    if (this.bsModalService.getModalsCount() === 1) {
                        this._renderer.removeClass(document.body, CLASS_NAME.OPEN);
                    }
                }
                this.bsModalService.hide(this.level);
                this.isModalHiding = false;
                if (this.config.closed) {
                    this.config.closed(isCloseButton, { modalRef: this, event: e });
                }
                this.closed.emit(this.level);
            }), this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);
            // });
        }));
    }
    /**
     * @return {?}
     */
    toCenter() {
        /** @type {?} */
        const marginLeft = Number.parseInt('' + -this.config.width / 2);
        /** @type {?} */
        const marginTop = Number.parseInt('' + -this.config.height / 2);
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        /** @type {?} */
        const contentEl = this.el.nativeElement.querySelector('.modal-body');
        // this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);
        // this._renderer.setStyle(dialogEl, 'margin-top', marginTop);
        this._renderer.setStyle(dialogEl, 'left', `${window.innerWidth / 2 + marginLeft}px`);
        this._renderer.setStyle(dialogEl, 'top', `${window.innerHeight / 2 + marginTop}px`);
        /** @type {?} */
        let contentHeight = this.config.height - 38;
        if (this.config.showButtons) {
            contentHeight = contentHeight - 50;
        }
        if (!this.config.fitContent) {
            this._renderer.setStyle(contentEl, 'height', contentHeight + 'px');
        }
        this._renderer.setStyle(contentEl, 'overflow', 'hidden');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(0px, 0px, 0px)`);
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const container = this.getContainerSize();
            const { width: containerWidth, height: containerHeight } = container;
            this.resized.emit({ width: this.config.width, height: this.config.height, containerWidth, containerHeight });
        }));
    }
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    moveTo(x, y) {
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(${x}px, ${y}px, 0px)`);
        // this._renderer.setStyle(dialogEl, 'top', '50%');
        // this._renderer.setStyle(dialogEl, 'left', '50%');
        // const marginLeft = Number.parseInt('' + -this.config.width / 2);
        // const marginTop = Number.parseInt('' + -this.config.height / 2);
        // this._renderer.setStyle(dialogEl, 'left', `${window.innerWidth / 2 + marginLeft}px`);
        // this._renderer.setStyle(dialogEl, 'top',  `${window.innerHeight / 2 + marginTop}px`);
        this.draggbar.position = { x, y };
        this.draggbar.resetPosition();
    }
    /**
     * @param {?=} rememberPrevSize
     * @return {?}
     */
    maxDialog(rememberPrevSize = true) {
        if (rememberPrevSize) {
            this.prevWidth = this.config.width;
            this.prevHeight = this.config.height;
        }
        // this.config.width = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientWidth'] - 20;
        // this.config.height = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientHeight'] - 20;
        this.config.width = window.innerWidth - 20;
        this.config.height = window.innerHeight - 20;
        this.config.draggable = false;
        this.config.resizable = false;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.addClass(dialogEl, 'model-dialog-maximize');
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.isMax = true;
        this.toCenter();
        this.moveTo(0, 0);
    }
    /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    resize(width, height) {
        if (width) {
            this.config.width = width;
        }
        if (height) {
            this.config.height = height;
        }
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    }
    /**
     * @param {?} el
     * @return {?}
     */
    dropdown(el) {
        // const rect = el.getBoundingClientRect();
        // this._renderer.removeStyle(el, 'margin-top');
        // this._renderer.removeStyle(el, 'margin-left');
        // this._renderer.setStyle(el, 'top', `${rect.top}px`);
        // this._renderer.setStyle(el, 'left', `${rect.left}px`);
        // this._renderer.removeStyle(el, 'transform');
        // this._renderer.removeStyle(el, '-webkit-transform');
        // this._renderer.removeStyle(el, '-ms-transform');
        // this._renderer.removeStyle(el, '-moz-transform');
        // this._renderer.removeStyle(el, '-o-transform');
    }
    /**
     * @return {?}
     */
    revertDialog() {
        this.isMax = false;
        /** @type {?} */
        const ww = window.innerWidth - 20;
        /** @type {?} */
        const wh = window.innerHeight - 20;
        this.config.width = this.prevWidth == ww ? this.originalWidth : this.prevWidth;
        this.config.height = this.prevHeight == wh ? this.originalHeight : this.prevHeight;
        if (this.config.width > ww) {
            this.config.width = ww;
        }
        if (this.config.height > wh) {
            this.config.height = wh;
        }
        this.config.draggable = true;
        this.config.resizable = true;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    }
    /**
     * @return {?}
     */
    changeDialogSize() {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
        this._windowResizeToMax = false;
    }
    /**
     * @param {?} opts
     * @return {?}
     */
    resizeStop(opts) {
        // console.log('resizeStop');
        this.config.width = opts.size.width;
        this.config.height = opts.size.height;
        /** @type {?} */
        const container = this.getContainerSize();
        const { width: containerWidth, height: containerHeight } = container;
        this.resized.emit(Object.assign({}, opts.size, { containerWidth, containerHeight }));
    }
}
ModalContainerComponent.decorators = [
    { type: Component, args: [{
                selector: 'modal-container',
                template: `
    <div [attr.id]="modalID"

        [ngDraggable]="config.draggable"
        [ngResizable]="config.resizable"
        [rzMinWidth]="config.minWidth"
        [rzMaxWidth]="config.maxWidth"
        [rzMinHeight]="config.minHeight"
        [rzMaxHeight]="config.maxHeight"
        rzHandles="all" [handle]="config.showHeader ? header:dragEl"
        (stopped)="dropdown($event)"
        (rzStop)="resizeStop($event)"
        [inBounds]="true" [bounds]="boundsElement" [rzContainment]="boundsElement"
        [class]="'modal-dialog' + (config.class ? ' ' + config.class : '')" role="document"
        [style.width]="config.width + 'px'" [style.height]="config.fitContent?'auto':(config.height + 'px')"
        style="position: absolute;top: 50%;left: 50%;">
        <div class="modal-content" [ngClass]="{'modal-content--has-header':config.showHeader}">
            <div #header class="modal-header" [style.display]="config.showHeader ? '': 'none'">
                <div class="modal-title">
                    <span *ngIf="config.iconCls" [class]="config.iconCls" style="margin-right: 8px"></span>
                    <span class="modal-title-label">{{ config.title }}</span>
                </div>
                <div class="actions">
                    <ul>
                        <li *ngIf="config.showMinButton" class="f-btn-icon f-bare">
                            <span class="f-icon modal_minimize"></span></li>
                        <li *ngIf="config.showMaxButton" (click)="changeDialogSize()" class="f-btn-icon f-bare">
                            <span class="f-icon modal_maximize" [class.modalrevert]="isMax"></span>
                        </li>
                        <li *ngIf="config.showCloseButton" (click)="close($event, true)" class="f-btn-icon f-bare">
                             <span class="f-icon modal_close"></span>
                        </li>
                    </ul>
                </div>
            </div>
        <div #dragEl class="f-utils-absolute-all" style="height:10px;z-index: 1;" [style.display]="config.showHeader ? 'none': ''"></div>
            <div class="modal-body" [class.f-utils-flex-column]="dialogType === 'iframe'"   [f-area-response]="config.areaResponse">
                <perfect-scrollbar [config]="{}" [disabled]="!config.enableScroll||config.fitContent"  *ngIf="!dialogType || dialogType === 'default'">
                    <ng-content ></ng-content>
                </perfect-scrollbar>
                <iframe *ngIf="dialogType === 'iframe'" class="f-utils-fill" width="100%" frameborder="0" [src]="iframeSrc"></iframe>
            </div>

            <div [style.textAlign]="config.buttonAlign" class="modal-footer" [ngStyle]="buildFooterStyles()" *ngIf="config.showButtons && config.buttons">
                <ng-container [ngTemplateOutlet]="useButtonsTemplate() ? config.buttons : defaultButtonRef"></ng-container>
            </div>
        </div>
    </div>

    <ng-template #defaultButtonRef>

        <ng-container *ngFor="let btn of config.buttons; last as isLast">
            <button type="button" modal-button  *ngIf="btn.display === undefined && btn.tipsEnable === undefined"
                [class]="btn.cls"
                (click)="btn.handle && btn.handle($event) ">
                <span [class]="btn.iconCls" *ngIf="btn.iconCls"></span> {{ btn.text }}
            </button>

            <button type="button" modal-button  *ngIf="btn.display !== undefined || btn.tipsEnable !== undefined"
                [class]="btn.cls"
                (click)="btn.handle && btn.handle($event) " 
                [style.display]="(btn.display === true || btn.display === undefined) ? '' : 'none'"
                [farrisTooltip]="btn?.tipsEnable" [placement]="'top'" [delay]="500" [content]="btn?.tipsText">
                <span [class]="btn.iconCls" *ngIf="btn.iconCls"></span> {{ btn.text }}
            </button>

        </ng-container>

    </ng-template>
  `,
                host: {
                    class: 'modal farris-modal',
                    role: 'dialog',
                    tabindex: '-1',
                    '[attr.aria-modal]': 'true'
                }
            }] }
];
/** @nocollapse */
ModalContainerComponent.ctorParameters = () => [
    { type: ModalOptions },
    { type: ElementRef },
    { type: Renderer2 },
    { type: DomSanitizer }
];
ModalContainerComponent.propDecorators = {
    iframe: [{ type: Input }],
    draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
    modalHeader: [{ type: ViewChild, args: ['header',] }],
    closed: [{ type: Output }],
    opened: [{ type: Output }],
    resized: [{ type: Output }],
    modalID: [{ type: HostBinding, args: ['id',] }],
    buttons: [{ type: ViewChildren, args: [ModalButtonDirective,] }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onEsc: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    ModalContainerComponent.prototype.config;
    /** @type {?} */
    ModalContainerComponent.prototype.isShown;
    /** @type {?} */
    ModalContainerComponent.prototype.level;
    /** @type {?} */
    ModalContainerComponent.prototype.isAnimated;
    /** @type {?} */
    ModalContainerComponent.prototype.bsModalService;
    /** @type {?} */
    ModalContainerComponent.prototype.dialogType;
    /** @type {?} */
    ModalContainerComponent.prototype.iframeSrc;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.isModalHiding;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevHeight;
    /** @type {?} */
    ModalContainerComponent.prototype.isMax;
    /** @type {?} */
    ModalContainerComponent.prototype.draggbar;
    /** @type {?} */
    ModalContainerComponent.prototype.modalHeader;
    /** @type {?} */
    ModalContainerComponent.prototype.boundsElement;
    /** @type {?} */
    ModalContainerComponent.prototype.closed;
    /** @type {?} */
    ModalContainerComponent.prototype.opened;
    /** @type {?} */
    ModalContainerComponent.prototype.resized;
    /** @type {?} */
    ModalContainerComponent.prototype.modalID;
    /** @type {?} */
    ModalContainerComponent.prototype.buttons;
    /** @type {?} */
    ModalContainerComponent.prototype.dlgHeaderLineHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype._windowResizeToMax;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.windowResize$;
    /**
     * @type {?}
     * @protected
     */
    ModalContainerComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.sanitizer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbW9kYWwvIiwic291cmNlcyI6WyJsaWIvbW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNILFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUMzQixTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFDcEMsWUFBWSxFQUFFLFdBQVcsRUFBaUIsS0FBSyxFQUUvQyxZQUFZLEVBQ1osU0FBUyxFQUNULFdBQVcsRUFDZCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFtQixNQUFNLDJCQUEyQixDQUFDO0FBQzFFLE9BQU8sRUFDSCxVQUFVLEVBQUUsZUFBZSxFQUMzQixZQUFZLEVBQUUsb0JBQW9CLEVBQ3JDLE1BQU0sdUJBQXVCLENBQUM7QUFFL0IsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9DLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxTQUFTLEVBQWdCLE1BQU0sTUFBTSxDQUFDO0FBQy9DLE9BQU8sRUFBRSxZQUFZLEVBQVMsTUFBTSxnQkFBZ0IsQ0FBQztBQWlGckQsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7OztJQXFDaEMsWUFDSSxPQUFxQixFQUNYLEVBQWMsRUFDaEIsU0FBb0IsRUFDcEIsU0FBdUI7UUFGckIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNoQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3BCLGNBQVMsR0FBVCxTQUFTLENBQWM7UUF2Q25DLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFZUixrQkFBYSxHQUFHLEtBQUssQ0FBQzs7UUFNOUIsVUFBSyxHQUFHLEtBQUssQ0FBQztRQU1K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dFJlZiwgSG9zdExpc3RlbmVyLCBPbkRlc3Ryb3ksXHJcbiAgICBPbkluaXQsIFJlbmRlcmVyMiwgVmlld0NoaWxkLCBPdXRwdXQsXHJcbiAgICBFdmVudEVtaXR0ZXIsIFRlbXBsYXRlUmVmLCBBZnRlclZpZXdJbml0LCBJbnB1dCxcclxuICAgIE5nWm9uZSxcclxuICAgIFZpZXdDaGlsZHJlbixcclxuICAgIFF1ZXJ5TGlzdCxcclxuICAgIEhvc3RCaW5kaW5nXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyYWdnYWJsZSc7XHJcbmltcG9ydCB7IERvbVNhbml0aXplciwgU2FmZVJlc291cmNlVXJsIH0gZnJvbSBcIkBhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXJcIjtcclxuaW1wb3J0IHtcclxuICAgIENMQVNTX05BTUUsIERJU01JU1NfUkVBU09OUyxcclxuICAgIE1vZGFsT3B0aW9ucywgVFJBTlNJVElPTl9EVVJBVElPTlNcclxufSBmcm9tICcuL21vZGFsLW9wdGlvbnMuY2xhc3MnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJy4vYnMtbW9kYWwuc2VydmljZSc7XHJcbmltcG9ydCB7IGlzQnMzIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbC91dGlscyc7XHJcbmltcG9ydCB7IE1vZGFsQnV0dG9uRGlyZWN0aXZlIH0gZnJvbSAnLi9tb2RhbC1idXR0b24uZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgZnJvbUV2ZW50LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZGVib3VuY2VUaW1lLCBkZWxheSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdtb2RhbC1jb250YWluZXInLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgW2F0dHIuaWRdPVwibW9kYWxJRFwiXHJcblxyXG4gICAgICAgIFtuZ0RyYWdnYWJsZV09XCJjb25maWcuZHJhZ2dhYmxlXCJcclxuICAgICAgICBbbmdSZXNpemFibGVdPVwiY29uZmlnLnJlc2l6YWJsZVwiXHJcbiAgICAgICAgW3J6TWluV2lkdGhdPVwiY29uZmlnLm1pbldpZHRoXCJcclxuICAgICAgICBbcnpNYXhXaWR0aF09XCJjb25maWcubWF4V2lkdGhcIlxyXG4gICAgICAgIFtyek1pbkhlaWdodF09XCJjb25maWcubWluSGVpZ2h0XCJcclxuICAgICAgICBbcnpNYXhIZWlnaHRdPVwiY29uZmlnLm1heEhlaWdodFwiXHJcbiAgICAgICAgcnpIYW5kbGVzPVwiYWxsXCIgW2hhbmRsZV09XCJjb25maWcuc2hvd0hlYWRlciA/IGhlYWRlcjpkcmFnRWxcIlxyXG4gICAgICAgIChzdG9wcGVkKT1cImRyb3Bkb3duKCRldmVudClcIlxyXG4gICAgICAgIChyelN0b3ApPVwicmVzaXplU3RvcCgkZXZlbnQpXCJcclxuICAgICAgICBbaW5Cb3VuZHNdPVwidHJ1ZVwiIFtib3VuZHNdPVwiYm91bmRzRWxlbWVudFwiIFtyekNvbnRhaW5tZW50XT1cImJvdW5kc0VsZW1lbnRcIlxyXG4gICAgICAgIFtjbGFzc109XCInbW9kYWwtZGlhbG9nJyArIChjb25maWcuY2xhc3MgPyAnICcgKyBjb25maWcuY2xhc3MgOiAnJylcIiByb2xlPVwiZG9jdW1lbnRcIlxyXG4gICAgICAgIFtzdHlsZS53aWR0aF09XCJjb25maWcud2lkdGggKyAncHgnXCIgW3N0eWxlLmhlaWdodF09XCJjb25maWcuZml0Q29udGVudD8nYXV0byc6KGNvbmZpZy5oZWlnaHQgKyAncHgnKVwiXHJcbiAgICAgICAgc3R5bGU9XCJwb3NpdGlvbjogYWJzb2x1dGU7dG9wOiA1MCU7bGVmdDogNTAlO1wiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCIgW25nQ2xhc3NdPVwieydtb2RhbC1jb250ZW50LS1oYXMtaGVhZGVyJzpjb25maWcuc2hvd0hlYWRlcn1cIj5cclxuICAgICAgICAgICAgPGRpdiAjaGVhZGVyIGNsYXNzPVwibW9kYWwtaGVhZGVyXCIgW3N0eWxlLmRpc3BsYXldPVwiY29uZmlnLnNob3dIZWFkZXIgPyAnJzogJ25vbmUnXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWwtdGl0bGVcIj5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImNvbmZpZy5pY29uQ2xzXCIgW2NsYXNzXT1cImNvbmZpZy5pY29uQ2xzXCIgc3R5bGU9XCJtYXJnaW4tcmlnaHQ6IDhweFwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vZGFsLXRpdGxlLWxhYmVsXCI+e3sgY29uZmlnLnRpdGxlIH19PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDx1bD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpICpuZ0lmPVwiY29uZmlnLnNob3dNaW5CdXR0b25cIiBjbGFzcz1cImYtYnRuLWljb24gZi1iYXJlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImYtaWNvbiBtb2RhbF9taW5pbWl6ZVwiPjwvc3Bhbj48L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd01heEJ1dHRvblwiIChjbGljayk9XCJjaGFuZ2VEaWFsb2dTaXplKClcIiBjbGFzcz1cImYtYnRuLWljb24gZi1iYXJlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImYtaWNvbiBtb2RhbF9tYXhpbWl6ZVwiIFtjbGFzcy5tb2RhbHJldmVydF09XCJpc01heFwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpICpuZ0lmPVwiY29uZmlnLnNob3dDbG9zZUJ1dHRvblwiIChjbGljayk9XCJjbG9zZSgkZXZlbnQsIHRydWUpXCIgY2xhc3M9XCJmLWJ0bi1pY29uIGYtYmFyZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIG1vZGFsX2Nsb3NlXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiAjZHJhZ0VsIGNsYXNzPVwiZi11dGlscy1hYnNvbHV0ZS1hbGxcIiBzdHlsZT1cImhlaWdodDoxMHB4O3otaW5kZXg6IDE7XCIgW3N0eWxlLmRpc3BsYXldPVwiY29uZmlnLnNob3dIZWFkZXIgPyAnbm9uZSc6ICcnXCI+PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCIgW2NsYXNzLmYtdXRpbHMtZmxleC1jb2x1bW5dPVwiZGlhbG9nVHlwZSA9PT0gJ2lmcmFtZSdcIiAgIFtmLWFyZWEtcmVzcG9uc2VdPVwiY29uZmlnLmFyZWFSZXNwb25zZVwiPlxyXG4gICAgICAgICAgICAgICAgPHBlcmZlY3Qtc2Nyb2xsYmFyIFtjb25maWddPVwie31cIiBbZGlzYWJsZWRdPVwiIWNvbmZpZy5lbmFibGVTY3JvbGx8fGNvbmZpZy5maXRDb250ZW50XCIgICpuZ0lmPVwiIWRpYWxvZ1R5cGUgfHwgZGlhbG9nVHlwZSA9PT0gJ2RlZmF1bHQnXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRlbnQgPjwvbmctY29udGVudD5cclxuICAgICAgICAgICAgICAgIDwvcGVyZmVjdC1zY3JvbGxiYXI+XHJcbiAgICAgICAgICAgICAgICA8aWZyYW1lICpuZ0lmPVwiZGlhbG9nVHlwZSA9PT0gJ2lmcmFtZSdcIiBjbGFzcz1cImYtdXRpbHMtZmlsbFwiIHdpZHRoPVwiMTAwJVwiIGZyYW1lYm9yZGVyPVwiMFwiIFtzcmNdPVwiaWZyYW1lU3JjXCI+PC9pZnJhbWU+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgPGRpdiBbc3R5bGUudGV4dEFsaWduXT1cImNvbmZpZy5idXR0b25BbGlnblwiIGNsYXNzPVwibW9kYWwtZm9vdGVyXCIgW25nU3R5bGVdPVwiYnVpbGRGb290ZXJTdHlsZXMoKVwiICpuZ0lmPVwiY29uZmlnLnNob3dCdXR0b25zICYmIGNvbmZpZy5idXR0b25zXCI+XHJcbiAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInVzZUJ1dHRvbnNUZW1wbGF0ZSgpID8gY29uZmlnLmJ1dHRvbnMgOiBkZWZhdWx0QnV0dG9uUmVmXCI+PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcblxyXG4gICAgPG5nLXRlbXBsYXRlICNkZWZhdWx0QnV0dG9uUmVmPlxyXG5cclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBidG4gb2YgY29uZmlnLmJ1dHRvbnM7IGxhc3QgYXMgaXNMYXN0XCI+XHJcbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIG1vZGFsLWJ1dHRvbiAgKm5nSWY9XCJidG4uZGlzcGxheSA9PT0gdW5kZWZpbmVkICYmIGJ0bi50aXBzRW5hYmxlID09PSB1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICAgICAgW2NsYXNzXT1cImJ0bi5jbHNcIlxyXG4gICAgICAgICAgICAgICAgKGNsaWNrKT1cImJ0bi5oYW5kbGUgJiYgYnRuLmhhbmRsZSgkZXZlbnQpIFwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gW2NsYXNzXT1cImJ0bi5pY29uQ2xzXCIgKm5nSWY9XCJidG4uaWNvbkNsc1wiPjwvc3Bhbj4ge3sgYnRuLnRleHQgfX1cclxuICAgICAgICAgICAgPC9idXR0b24+XHJcblxyXG4gICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBtb2RhbC1idXR0b24gICpuZ0lmPVwiYnRuLmRpc3BsYXkgIT09IHVuZGVmaW5lZCB8fCBidG4udGlwc0VuYWJsZSAhPT0gdW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgICAgIFtjbGFzc109XCJidG4uY2xzXCJcclxuICAgICAgICAgICAgICAgIChjbGljayk9XCJidG4uaGFuZGxlICYmIGJ0bi5oYW5kbGUoJGV2ZW50KSBcIiBcclxuICAgICAgICAgICAgICAgIFtzdHlsZS5kaXNwbGF5XT1cIihidG4uZGlzcGxheSA9PT0gdHJ1ZSB8fCBidG4uZGlzcGxheSA9PT0gdW5kZWZpbmVkKSA/ICcnIDogJ25vbmUnXCJcclxuICAgICAgICAgICAgICAgIFtmYXJyaXNUb29sdGlwXT1cImJ0bj8udGlwc0VuYWJsZVwiIFtwbGFjZW1lbnRdPVwiJ3RvcCdcIiBbZGVsYXldPVwiNTAwXCIgW2NvbnRlbnRdPVwiYnRuPy50aXBzVGV4dFwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gW2NsYXNzXT1cImJ0bi5pY29uQ2xzXCIgKm5nSWY9XCJidG4uaWNvbkNsc1wiPjwvc3Bhbj4ge3sgYnRuLnRleHQgfX1cclxuICAgICAgICAgICAgPC9idXR0b24+XHJcblxyXG4gICAgICAgIDwvbmctY29udGFpbmVyPlxyXG5cclxuICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgYCxcclxuICAgIGhvc3Q6IHtcclxuICAgICAgICBjbGFzczogJ21vZGFsIGZhcnJpcy1tb2RhbCcsXHJcbiAgICAgICAgcm9sZTogJ2RpYWxvZycsXHJcbiAgICAgICAgdGFiaW5kZXg6ICctMScsXHJcbiAgICAgICAgJ1thdHRyLmFyaWEtbW9kYWxdJzogJ3RydWUnXHJcbiAgICB9XHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBNb2RhbENvbnRhaW5lckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBBZnRlclZpZXdJbml0IHtcclxuICAgIGNvbmZpZzogTW9kYWxPcHRpb25zO1xyXG4gICAgaXNTaG93biA9IGZhbHNlO1xyXG4gICAgbGV2ZWw6IG51bWJlcjtcclxuICAgIGlzQW5pbWF0ZWQ6IGJvb2xlYW47XHJcbiAgICBic01vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2U7XHJcbiAgICBkaWFsb2dUeXBlOiBzdHJpbmc7XHJcbiAgICBpZnJhbWVTcmM6IFNhZmVSZXNvdXJjZVVybDtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBwdWJsaWMgc2V0IGlmcmFtZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2FuaXRpemVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lU3JjID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdFJlc291cmNlVXJsKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGlzTW9kYWxIaWRpbmcgPSBmYWxzZTtcclxuICAgIHByaXZhdGUgb3JpZ2luYWxXaWR0aDogbnVtYmVyOyAgLy8g6K6w5b2V5Y6f5aeL55qE5a695bqmXHJcbiAgICBwcml2YXRlIG9yaWdpbmFsSGVpZ2h0OiBudW1iZXI7IC8vIOiusOW9leWOn+Wni+eahOmrmOW6plxyXG5cclxuICAgIHByaXZhdGUgcHJldldpZHRoOiBudW1iZXI7IC8vIOiusOW9leS4iuasoeeahOWuveW6plxyXG4gICAgcHJpdmF0ZSBwcmV2SGVpZ2h0OiBudW1iZXI7IC8vIOiusOW9leS4iuasoeeahOmrmOW6plxyXG4gICAgaXNNYXggPSBmYWxzZTtcclxuXHJcbiAgICBAVmlld0NoaWxkKEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmUpIGRyYWdnYmFyOiBBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZCgnaGVhZGVyJykgbW9kYWxIZWFkZXI6IEVsZW1lbnRSZWY7XHJcbiAgICBib3VuZHNFbGVtZW50OiBIVE1MRWxlbWVudDtcclxuXHJcbiAgICBAT3V0cHV0KCkgY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIG9wZW5lZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSByZXNpemVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBIb3N0QmluZGluZygnaWQnKSBtb2RhbElEID0gYE1PREFMSURfJHtEYXRlLm5vdygpLnRvUHJlY2lzaW9uKCl9YDtcclxuXHJcbiAgICBAVmlld0NoaWxkcmVuKE1vZGFsQnV0dG9uRGlyZWN0aXZlKSBidXR0b25zOiBRdWVyeUxpc3Q8TW9kYWxCdXR0b25EaXJlY3RpdmU+O1xyXG5cclxuICAgIGRsZ0hlYWRlckxpbmVIZWlnaHQ6IGFueTtcclxuICAgIHByaXZhdGUgX3dpbmRvd1Jlc2l6ZVRvTWF4ID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIHdpbmRvd1Jlc2l6ZSQ6IFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBvcHRpb25zOiBNb2RhbE9wdGlvbnMsXHJcbiAgICAgICAgcHJvdGVjdGVkIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgcHJpdmF0ZSBzYW5pdGl6ZXI6IERvbVNhbml0aXplclxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29uZmlnLmJ1dHRvbnMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcuYnV0dG9ucyA9IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn5Y+W5raIJyxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLWxpZ2h0JyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xzOiAnay1pY29uIGstaS1jbG9zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfnoa7lrponLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNsczogJ2staWNvbiBrLWktY2hlY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4geyBhbGVydCgn5aW9KO+9oe+9peKIgO+9pSnvvonvvp7ll6jlk58hIScpOyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuYm91bmRzRWxlbWVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWZpdENvbnRlbnQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzQW5pbWF0ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCBDTEFTU19OQU1FLkZBREUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTaG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgaXNCczMoKSA/IENMQVNTX05BTUUuSU4gOiBDTEFTU19OQU1FLlNIT1dcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCAmJiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YoJ2YtbW9kYWwtZml0Q29udGVudC1zY3JvbGwnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50ICYmIGRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsTGVuID0gdGhpcy5ic01vZGFsU2VydmljZS5nZXRNb2RhbHNDb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZGFsTGVuID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5jaGVja1Njcm9sbGJhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0U2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX05BTUUuT1BFTikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhkb2N1bWVudC5ib2R5LCBDTEFTU19OQU1FLk9QRU4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3BlbmVkLmVtaXQoeyBtb2RhbDogdGhpcyB9KTtcclxuICAgICAgICB9LCB0aGlzLmlzQW5pbWF0ZWQgPyBUUkFOU0lUSU9OX0RVUkFUSU9OUy5CQUNLRFJPUCA6IDApO1xyXG4gICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5lbC5uYXRpdmVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kbGdIZWFkZXJMaW5lSGVpZ2h0ID0gdGhpcy5nZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCkgKyAncHgnO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyBDYWxsZWQgYWZ0ZXIgbmdBZnRlckNvbnRlbnRJbml0IHdoZW4gdGhlIGNvbXBvbmVudCdzIHZpZXcgaGFzIGJlZW4gaW5pdGlhbGl6ZWQuIEFwcGxpZXMgdG8gY29tcG9uZW50cyBvbmx5LlxyXG4gICAgICAgIC8vIEFkZCAnaW1wbGVtZW50cyBBZnRlclZpZXdJbml0JyB0byB0aGUgY2xhc3MuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICAgIC8vIOWmguaenOWGheWuuemAguW6lOWuveW6plxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIGxldCBpbml0RWxSZWN0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICBsZXQgaW5pdEJvZHlTaXplID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgICAgIGlmIChpbml0RWxSZWN0LmhlaWdodCA8IGluaXRCb2R5U2l6ZS5oZWlnaHQgKyAzMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZi1tb2RhbC1maXRDb250ZW50LXNjcm9sbCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm9yaWdpbmFsSGVpZ2h0ID0gdGhpcy5jb25maWcuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG5cclxuICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZSQgPSBmcm9tRXZlbnQod2luZG93LCAncmVzaXplJykucGlwZShcclxuICAgICAgICAgICAgZGVib3VuY2VUaW1lKDUwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgd2luV2lkdGggPSAgd2luZG93LmlubmVyV2lkdGggLTIwO1xyXG4gICAgICAgICAgICBjb25zdCB3aW5IZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy53aWR0aCA8PSB3aW5XaWR0aCAmJiB0aGlzLmNvbmZpZy5oZWlnaHQgPD0gd2luSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fd2luZG93UmVzaXplVG9NYXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJldmVydERpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dpbmRvd1Jlc2l6ZVRvTWF4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTWF4KSB7ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1heERpYWxvZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzTWF4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2luZG93UmVzaXplVG9NYXggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4RGlhbG9nKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4RGlhbG9nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy50b0NlbnRlcigpO1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbygwLCAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREbGdFbGVtZW50KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGlhbG9nSGVhZGVyTGluZUhlaWdodCgpIHtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuc2hvd0hlYWRlcikge1xyXG4gICAgICAgICAgICBjb25zdCBtb2RhbEhlYWRlclN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMubW9kYWxIZWFkZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZGRpbmdUb3AgPSBwYXJzZUludChtb2RhbEhlYWRlclN0eWxlcy5wYWRkaW5nVG9wLnJlcGxhY2UoJ3B4JywgJycpLCAxMCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZGRpbmdCb3R0b20gPSBwYXJzZUludChtb2RhbEhlYWRlclN0eWxlcy5wYWRkaW5nQm90dG9tLnJlcGxhY2UoJ3B4JywgJycpLCAxMCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5kaWFsb2dIZWFkZXJIZWlnaHQgLSBwYWRkaW5nVG9wIC0gcGFkZGluZ0JvdHRvbTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6I635Y+W5YaF5a655Yy65Z+f55qE5bC65a+4XHJcbiAgICBnZXRDb250YWluZXJTaXplKCkge1xyXG4gICAgICAgIGNvbnN0IGJvZHlUYXJnZXQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWJvZHknKTtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBib2R5VGFyZ2V0Lm9mZnNldEhlaWdodDtcclxuICAgICAgICBjb25zdCB3aWR0aCA9IGJvZHlUYXJnZXQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgcmV0dXJuIHsgd2lkdGgsIGhlaWdodCB9O1xyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkRm9vdGVyU3R5bGVzKCkge1xyXG4gICAgICAgIGxldCBzdHlsZXMgPSB7fTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmRpYWxvZ0Zvb3RlclN0eWxlcykge1xyXG4gICAgICAgICAgICBzdHlsZXMgPSBPYmplY3QuYXNzaWduKHt9LCBzdHlsZXMsIHRoaXMuY29uZmlnLmRpYWxvZ0Zvb3RlclN0eWxlcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc3R5bGVzO1xyXG4gICAgfVxyXG5cclxuICAgIHVzZUJ1dHRvbnNUZW1wbGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuYnV0dG9ucyBpbnN0YW5jZW9mIFRlbXBsYXRlUmVmO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBjb25zdCB0YWcgPSBldmVudC50YXJnZXQgYXMgYW55O1xyXG5cclxuICAgICAgICAvLyBpZiAodGFnLmxvY2FsTmFtZSA9PT0gJ2xhYmVsJykge1xyXG4gICAgICAgIC8vICAgICBpZiAodGFnLmNsYXNzTmFtZSkge1xyXG4gICAgICAgIC8vICAgICAgICAgY29uc3QgY2xzTGlzdCA9IHRhZy5jbGFzc05hbWUuc3BsaXQoJyAnKTtcclxuICAgICAgICAvLyAgICAgICAgIGlmIChcclxuICAgICAgICAvLyAgICAgICAgICAgICBjbHNMaXN0LmluZGV4T2YoJ2stcmFkaW8tbGFiZWwnKSA+IC0xIHx8XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgY2xzTGlzdC5pbmRleE9mKCdrLWNoZWNrYm94LWxhYmVsJykgPiAtMSB8fFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGNsc0xpc3QuaW5kZXhPZignY3VzdG9tLWNvbnRyb2wtbGFiZWwnKSA+IC0xXHJcbiAgICAgICAgLy8gICAgICAgICApIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIGlmICh0YWcubG9jYWxOYW1lID09PSAnaW5wdXQnICYmICh0YWcudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCB0YWcudHlwZSA9PT0gJ3JhZGlvJyB8fCB0YWcudHlwZSA9PT0gJ2ZpbGUnKSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm47XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jb25maWcuaWdub3JlQmFja2Ryb3BDbGljayB8fCB0aGlzLmNvbmZpZy5iYWNrZHJvcCA9PT0gJ3N0YXRpYycgfHwgZXZlbnQudGFyZ2V0ICE9PSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQgKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLnNldERpc21pc3NSZWFzb24oRElTTUlTU19SRUFTT05TLkJBQ0tSRE9QKTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignd2luZG93OmtleWRvd24uZXNjJywgWyckZXZlbnQnXSlcclxuICAgIG9uRXNjKGV2ZW50OiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNTaG93bikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdGhpcy5jb25maWcua2V5Ym9hcmQgJiZcclxuICAgICAgICAgICAgdGhpcy5sZXZlbCA9PT0gdGhpcy5ic01vZGFsU2VydmljZS5nZXRNb2RhbHNDb3VudCgpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0RGlzbWlzc1JlYXNvbihESVNNSVNTX1JFQVNPTlMuRVNDKTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZShldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmlzU2hvd24pIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMud2luZG93UmVzaXplJCkge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZSQudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dSZXNpemUkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoZT86IE1vdXNlRXZlbnQsIGlzQ2xvc2VCdXR0b24gPSBmYWxzZSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChlICYmIGUuc3RvcFByb3BhZ2F0aW9uKSB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pc01vZGFsSGlkaW5nIHx8ICF0aGlzLmlzU2hvd24pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb25maWcuYmVmb3JlQ2xvc2UodGhpcywgeyBldmVudDogZSB9KS5zdWJzY3JpYmUociA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmlzTW9kYWxIaWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhcclxuICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudCxcclxuICAgICAgICAgICAgICAgIGlzQnMzKCkgPyBDTEFTU19OQU1FLklOIDogQ0xBU1NfTkFNRS5TSE9XXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1Nob3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQgJiZcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5XHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ic01vZGFsU2VydmljZS5nZXRNb2RhbHNDb3VudCgpID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksIENMQVNTX05BTUUuT1BFTik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5oaWRlKHRoaXMubGV2ZWwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc01vZGFsSGlkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcuY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcuY2xvc2VkKGlzQ2xvc2VCdXR0b24sIHsgbW9kYWxSZWY6IHRoaXMsIGV2ZW50OiBlIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZWQuZW1pdCh0aGlzLmxldmVsKTtcclxuICAgICAgICAgICAgfSwgdGhpcy5pc0FuaW1hdGVkID8gVFJBTlNJVElPTl9EVVJBVElPTlMuTU9EQUwgOiAwKTtcclxuICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9DZW50ZXIoKSB7XHJcbiAgICAgICAgY29uc3QgbWFyZ2luTGVmdCA9IE51bWJlci5wYXJzZUludCgnJyArIC10aGlzLmNvbmZpZy53aWR0aCAvIDIpO1xyXG4gICAgICAgIGNvbnN0IG1hcmdpblRvcCA9IE51bWJlci5wYXJzZUludCgnJyArIC10aGlzLmNvbmZpZy5oZWlnaHQgLyAyKTtcclxuXHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ21hcmdpbi1sZWZ0JywgbWFyZ2luTGVmdCk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdtYXJnaW4tdG9wJywgbWFyZ2luVG9wKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgYCR7d2luZG93LmlubmVyV2lkdGggLyAyICsgbWFyZ2luTGVmdH1weGApO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgIGAke3dpbmRvdy5pbm5lckhlaWdodCAvIDIgKyBtYXJnaW5Ub3B9cHhgKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQgLSAzODtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuc2hvd0J1dHRvbnMpIHtcclxuICAgICAgICAgICAgY29udGVudEhlaWdodCA9IGNvbnRlbnRIZWlnaHQgLSA1MDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgY29udGVudEVsLFxyXG4gICAgICAgICAgICAgICAgJ2hlaWdodCcsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50SGVpZ2h0ICsgJ3B4J1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjb250ZW50RWwsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KWApO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdCh7IHdpZHRoOiB0aGlzLmNvbmZpZy53aWR0aCwgaGVpZ2h0OiB0aGlzLmNvbmZpZy5oZWlnaHQsICBjb250YWluZXJXaWR0aCwgIGNvbnRhaW5lckhlaWdodCB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlM2QoJHt4fXB4LCAke3l9cHgsIDBweClgKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RvcCcsICc1MCUnKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ2xlZnQnLCAnNTAlJyk7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IG1hcmdpbkxlZnQgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcud2lkdGggLyAyKTtcclxuICAgICAgICAvLyBjb25zdCBtYXJnaW5Ub3AgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcuaGVpZ2h0IC8gMik7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgYCR7d2luZG93LmlubmVyV2lkdGggLyAyICsgbWFyZ2luTGVmdH1weGApO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgIGAke3dpbmRvdy5pbm5lckhlaWdodCAvIDIgKyBtYXJnaW5Ub3B9cHhgKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucG9zaXRpb24gPSB7IHgsIHkgfTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBtYXhEaWFsb2cocmVtZW1iZXJQcmV2U2l6ZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAocmVtZW1iZXJQcmV2U2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMuY29uZmlnLndpZHRoID0gKGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ/ZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudDpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpWydjbGllbnRXaWR0aCddIC0gMjA7XHJcbiAgICAgICAgLy8gdGhpcy5jb25maWcuaGVpZ2h0ID0gKGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ/ZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudDpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpWydjbGllbnRIZWlnaHQnXSAtIDIwO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gMjA7XHJcbiAgICAgICAgdGhpcy5jb25maWcuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gMjA7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLmRyYWdnYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgJzUwJScpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnbGVmdCcsICc1MCUnKTtcclxuICAgICAgICB0aGlzLmlzTWF4ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgICAgICAgdGhpcy5tb3ZlVG8oMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgICAgIHRoaXMudG9DZW50ZXIoKTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBkcm9wZG93bihlbDogYW55KSB7XHJcbiAgICAgICAgLy8gY29uc3QgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnbWFyZ2luLXRvcCcpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnbWFyZ2luLWxlZnQnKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShlbCwgJ3RvcCcsIGAke3JlY3QudG9wfXB4YCk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZWwsICdsZWZ0JywgYCR7cmVjdC5sZWZ0fXB4YCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAndHJhbnNmb3JtJyk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIucmVtb3ZlU3R5bGUoZWwsICctd2Via2l0LXRyYW5zZm9ybScpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnLW1zLXRyYW5zZm9ybScpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnLW1vei10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJy1vLXRyYW5zZm9ybScpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldmVydERpYWxvZygpIHtcclxuICAgICAgICB0aGlzLmlzTWF4ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGNvbnN0IHd3ID0gd2luZG93LmlubmVyV2lkdGggLSAyMDtcclxuICAgICAgICBjb25zdCB3aCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIDIwXHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gdGhpcy5wcmV2V2lkdGggPT0gd3cgPyB0aGlzLm9yaWdpbmFsV2lkdGggOiB0aGlzLnByZXZXaWR0aDtcclxuICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSB0aGlzLnByZXZIZWlnaHQgPT0gd2ggPyB0aGlzLm9yaWdpbmFsSGVpZ2h0IDogdGhpcy5wcmV2SGVpZ2h0O1xyXG4gICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLndpZHRoID4gd3cpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcud2lkdGggPSB3dztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5oZWlnaHQgPiB3aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSB3aDtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKGRpYWxvZ0VsLCAnbW9kZWwtZGlhbG9nLW1heGltaXplJyk7XHJcbiAgICAgICAgdGhpcy50b0NlbnRlcigpO1xyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZURpYWxvZ1NpemUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNNYXgpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXZlcnREaWFsb2coKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1heERpYWxvZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl93aW5kb3dSZXNpemVUb01heCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2l6ZVN0b3Aob3B0czogYW55KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3Jlc2l6ZVN0b3AnKTtcclxuICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IG9wdHMuc2l6ZS53aWR0aDtcclxuICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSBvcHRzLnNpemUuaGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZ2V0Q29udGFpbmVyU2l6ZSgpO1xyXG4gICAgICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMucmVzaXplZC5lbWl0KHsgLi4ub3B0cy5zaXplLCAuLi57IGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQgfSB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=