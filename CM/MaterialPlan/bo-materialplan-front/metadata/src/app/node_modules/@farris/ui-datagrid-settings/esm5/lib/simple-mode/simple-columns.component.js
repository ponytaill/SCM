/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, EventEmitter, HostBinding, Injector, Input, Output, ViewEncapsulation, HostListener, ViewChild, ElementRef } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
import { MessagerService } from '@farris/ui-messager';
import { getMultilingualValue } from '../getValueWithLocaleId';
var SimpleColumnsComponent = /** @class */ (function () {
    function SimpleColumnsComponent(injector, cd) {
        this.injector = injector;
        this.cd = cd;
        this.enableScheme = false;
        this.seartTypes = [];
        /**
         * 所有列
         */
        this.columns = [];
        /**
         * 显示的列
         */
        this.fields = [];
        /**
         * 点击侧边样式以外的区域隐藏面板。默认为 true
         */
        this.clickToHidden = true;
        this.top = 0;
        this._schemeList = [];
        this.cls = 'f-datagrid-settings-simple-host';
        this.formatChange = new EventEmitter();
        this.fieldsChange = new EventEmitter();
        this.submit = new EventEmitter();
        this.closed = new EventEmitter();
        this.advanced = new EventEmitter();
        this.addNewScheme = new EventEmitter();
        this.showSchemeList = new EventEmitter();
        this.activeItemChange = new EventEmitter();
        this.allCols = [];
        this.columnType = 'all';
        this.isEn = false;
        this.showSchemePanel = false;
        this.switchValue = false;
        // 当前方案
        this.currentSchemeItem = null;
        this.searchResultIsVisibleAll = false;
        this.defaultSchemeName = '系统预制';
        this.settings = {};
        this.localeSer = this.injector.get(LocaleService, null);
        this.messager = this.injector.get(MessagerService, null);
    }
    Object.defineProperty(SimpleColumnsComponent.prototype, "schemeList", {
        get: /**
         * @return {?}
         */
        function () {
            return this._schemeList;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            var _this = this;
            if (val && val.length) {
                val.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    n['_title_'] = getMultilingualValue(JSON.parse(n.name), _this.localeSer.localeId);
                }));
            }
            this._schemeList = val || [];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // console.log($event);
        $event.stopPropagation();
        /** @type {?} */
        var clsname = $event.target['className'] || '';
        if (clsname.indexOf('f-datagrid-settings-simple-host') > -1) {
            // 隐藏侧边栏；
            if (this.clickToHidden) {
                this.close();
            }
        }
        this.showSchemePanel = false;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onEscKeydown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.close();
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onEnterKeydown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.onSubmitClick();
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onControlGKeydown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event.ctrlKey && !document.querySelector('modal-container')) {
            $event.preventDefault();
            $event.stopPropagation();
            if ($event.key.toLowerCase() === 'g') {
                this.showAdvanced($event);
            }
            else if ($event.key.toLowerCase() === 'r') {
                this.onSettingReset();
            }
            else if ($event.key.toLowerCase() === 's') {
                this.searchInput.nativeElement.focus();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    SimpleColumnsComponent.prototype.getCurrentSchemeSettings = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.currentSchemeItem) {
            /** @type {?} */
            var schemeSettings = JSON.parse(this.currentSchemeItem.queryConditionString);
            return (/** @type {?} */ (schemeSettings[this.localeSer.localeId]));
        }
        return null;
    };
    /**
     * @return {?}
     */
    SimpleColumnsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.allCols = this.columns[0];
        if (this.gridInstance.enableScheme && this.currentSchemeItem) {
            this.settings = this.getCurrentSchemeSettings() || {};
        }
        if (this.settings && this.settings.viewColumns && this.settings.viewColumns.length) {
            this.fields = this.settings.viewColumns;
            this.dirtySettings(true);
        }
        else {
            this.fields = this.getViewColumns();
        }
        this.container.nativeElement.focus();
        this.defaultSchemeName = this.localeSer.getValue('datagrid.scheme.syspreset') || this.gridInstance.defaultSchemeName;
    };
    /**
     * @private
     * @return {?}
     */
    SimpleColumnsComponent.prototype.getViewColumns = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // 多表头
        /** @type {?} */
        var visibleCls = [];
        if (this.columns.length > 1) {
            this.columns.forEach((/**
             * @param {?} cols
             * @return {?}
             */
            function (cols) {
                visibleCls = visibleCls.concat(_this._getViewColumns(cols));
            }));
        }
        else {
            visibleCls = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return (n.visible || n.visible === undefined); }));
        }
        return visibleCls.map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
    };
    /**
     * @private
     * @param {?} cols
     * @return {?}
     */
    SimpleColumnsComponent.prototype._getViewColumns = /**
     * @private
     * @param {?} cols
     * @return {?}
     */
    function (cols) {
        return cols.filter((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return !c.colspan && (c.visible || c.visible === undefined); }));
    };
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    SimpleColumnsComponent.prototype.filterColumns = 
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    function (searchWords) {
        var _this = this;
        if (searchWords === void 0) { searchWords = ''; }
        /** @type {?} */
        var cols = [];
        if (this.switchValue) {
            cols = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return _this.fields.indexOf(n.field) > -1; }));
        }
        else {
            cols = this.columns[0];
        }
        if (searchWords) {
            cols = cols.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.title.toLowerCase().indexOf(searchWords.toLowerCase()) > -1; }));
        }
        this.allCols = cols;
    };
    /**
     * @private
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onFieldsChanged = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.gridInstance.enableScheme) {
            this.fieldsChange.emit(this.fields);
        }
    };
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onDblClick = /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    function ($event, col) {
        // console.log('显示与隐藏切换事件', col);
        this.onCheckboxClick($event, col);
    };
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onCheckboxClick = /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    function ($event, col) {
        // console.log('显示与隐藏切换事件', col);
        $event.stopPropagation();
        this.showSchemePanel = false;
        /** @type {?} */
        var checked = false;
        /** @type {?} */
        var index = this.fields.indexOf(col.field);
        if (index === -1) {
            this.fields.push(col.field);
            checked = true;
        }
        else {
            this.fields.splice(index, 1);
            checked = false;
        }
        /** @type {?} */
        var item = this.columns[0].find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field === col.field; }));
        if (item) {
            item.visible = checked;
        }
        // this.columns[0].forEach(f => {
        //     f.visible = this.fields.indexOf(f.field) > -1;
        // });
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        this.searchResultIsVisibleAll = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).length === this.allCols.length;
        this.dirtySettings(true);
        this.onFieldsChanged();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.searchColumn = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var txt = $event.target.value;
        this.filterColumns(txt);
    };
    /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onFieldDrop = /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    function (fieldInfo, txt, ulElRef) {
        var _a;
        this.showSchemePanel = false;
        // console.log('drop', fieldInfo);
        var removedIndex = fieldInfo.removedIndex, addedIndex = fieldInfo.addedIndex;
        /** @type {?} */
        var moveItem = this.allCols[removedIndex];
        /** @type {?} */
        var targetItem = this.allCols[addedIndex];
        /** @type {?} */
        var moveItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field === moveItem.field; }));
        /** @type {?} */
        var targetItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field === targetItem.field; }));
        /** @type {?} */
        var removedItem = this.columns[0].splice(moveItemIndex, 1);
        (_a = this.columns[0]).splice.apply(_a, tslib_1.__spread([targetItemIndex, 0], removedItem));
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        this.onFieldsChanged();
        this.filterColumns(txt);
    };
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     */
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @return {?}
     */
    SimpleColumnsComponent.prototype.getCheckAllState = /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @return {?}
     */
    function () {
        if (!this.searchInput.nativeElement.value) {
            if (this.fields.length === 0) {
                return 0;
            }
            else {
                if (this.fields.length === this.columns[0].length) {
                    return 1;
                }
                return 2;
            }
        }
        else {
            /** @type {?} */
            var visibleLen = this.allCols.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.visible; })).length;
            if (visibleLen === this.allCols.length) {
                return 1;
            }
            else {
                if (visibleLen < this.allCols.length) {
                    if (visibleLen === 0) {
                        return 0;
                    }
                    return 1;
                }
            }
        }
    };
    // 全选
    // 全选
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onCheckAllClick = 
    // 全选
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    function ($event, txt) {
        var _this = this;
        $event.stopPropagation();
        this.showSchemePanel = false;
        /** @type {?} */
        var state = this.getCheckAllState();
        /** @type {?} */
        var isCheckAll = state === 0 || state === 2;
        if (!txt) {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.visible = isCheckAll; }));
        }
        else {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                /** @type {?} */
                var item = _this.allCols.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return n.field == a.field; }));
                if (item) {
                    n.visible = isCheckAll;
                    item.visible = isCheckAll;
                }
            }));
        }
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        this.searchResultIsVisibleAll = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).length === this.allCols.length;
        this.dirtySettings(true);
        this.onFieldsChanged();
        this.filterColumns(txt);
    };
    /**
     * @param {?=} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.close = /**
     * @param {?=} $event
     * @return {?}
     */
    function ($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.closed.emit();
    };
    // 打开高级设置窗口
    // 打开高级设置窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.showAdvanced = 
    // 打开高级设置窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.close($event);
        this.advanced.emit({ viewFields: this.fields });
    };
    // 恢复默认
    // 恢复默认
    /**
     * @param {?=} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onSettingReset = 
    // 恢复默认
    /**
     * @param {?=} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        /** @type {?} */
        var restorDefaultText = this.localeSer.getValue('datagrid.settings.restoreDefaultSettingsText') || '确认要恢复默认设置吗？';
        this.messager.confirm(restorDefaultText).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            if (t) {
                _this.reset2Default();
                _this.dirtySettings(true);
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    SimpleColumnsComponent.prototype.reset2Default = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var options = this.gridInstance.dfs['_state'].initialOptions;
        if (options.columnFields && options.columnFields.length) {
            /** @type {?} */
            var newColumns_1 = [];
            options.columnFields.forEach((/**
             * @param {?} c
             * @return {?}
             */
            function (c) {
                if (c.field !== '_datagrid-setting-control_') {
                    /** @type {?} */
                    var col = _this.gridInstance.columns[0].find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) { return n.field === c.field; }));
                    if (col) {
                        col.visible = c.visible;
                        col.halign = c.halign;
                        col.align = c.align;
                        col.width = c.width;
                        col.footer = tslib_1.__assign({}, c.footer || {});
                        col.groupFooter = tslib_1.__assign({}, c.groupFooter || {});
                        newColumns_1.push(col);
                    }
                }
            }));
            this.columns = [newColumns_1];
        }
        this.allCols = this.columns[0];
        this.settings = {};
        this.fields = this.getViewColumns();
        this.settings.viewColumns = this.fields;
        this.settings.columnFormat = tslib_1.__spread(this.columns[0]);
        if (options.sort) {
            /** @type {?} */
            var sortOrders = options.sort.sortOrder ? options.sort.sortOrder.split(',') : [];
            /** @type {?} */
            var sortNames = options.sort.sortName ? options.sort.sortName.split(',') : [];
            this.settings.sortInfo = { sortName: sortNames, sortOrder: sortOrders };
        }
        else {
            this.settings.sortInfo = {};
        }
        this.settings.groupField = options.groupField ? options.groupField.split(',') : [];
    };
    // 确定按钮点击事件
    // 确定按钮点击事件
    /**
     * @param {?=} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onSubmitClick = 
    // 确定按钮点击事件
    /**
     * @param {?=} $event
     * @return {?}
     */
    function ($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.settings.viewColumns = this.fields;
        if (!this.enableScheme || !this.currentSchemeItem) {
            if (!this.settings.columnFormat) {
                this.settings.columnFormat = tslib_1.__spread(this.columns[0]);
            }
            if (!this.settings.sortInfo) {
                this.settings.sortInfo = {
                    sortName: this.gridInstance.sortName ? this.gridInstance.sortName.split(',') : [],
                    sortOrder: this.gridInstance.sortOrder ? this.gridInstance.sortOrder.split(',') : []
                };
            }
            if (this.settings.groupField === undefined) {
                this.settings.groupField = this.gridInstance.groupField ? this.gridInstance.groupField.split(',') : [];
            }
        }
        else {
            /** @type {?} */
            var _settings = this.getCurrentSchemeSettings();
            if (_settings) {
                this.settings = Object.assign(_settings || {}, this.settings);
            }
        }
        // this.activeItemChange.emit(this.activeSchemeItem);
        this.submit.emit({ content: this.settings, close: this.close.bind(this), target: this.btnOk.nativeElement, currentScheme: this.currentSchemeItem });
    };
    // 显示下拉方案列表
    // 显示下拉方案列表
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onChooseScheme = 
    // 显示下拉方案列表
    /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = !this.showSchemePanel;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.schemeitemsEleRef && _this.currentSchemeItem) {
                /** @type {?} */
                var itemEl = _this.schemeitemsEleRef.nativeElement.querySelector("#schemeitem_" + _this.currentSchemeItem.id);
                if (itemEl) {
                    if (itemEl.scrollIntoViewIfNeeded) {
                        itemEl.scrollIntoViewIfNeeded();
                    }
                    else {
                        itemEl.scrollIntoView();
                    }
                }
            }
        }));
    };
    // 仅显示可见列
    // 仅显示可见列
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onlySeeVisibleColumns = 
    // 仅显示可见列
    /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.switchValue = $event;
        this.filterColumns();
    };
    // 新增方案
    // 新增方案
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onNewSchemeClick = 
    // 新增方案
    /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.addNewScheme.emit();
    };
    // 显示方案列表管理窗口
    // 显示方案列表管理窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onShowSchemeList = 
    // 显示方案列表管理窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        this.showSchemeList.emit();
    };
    // 方案点击
    // 方案点击
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    SimpleColumnsComponent.prototype.onSchemeItemClick = 
    // 方案点击
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    function ($event, item) {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.currentSchemeItem = item;
            _this.showSchemePanel = false;
            /** @type {?} */
            var schemeSettings = null;
            if (item) {
                schemeSettings = JSON.parse(item.queryConditionString);
                schemeSettings = schemeSettings[_this.localeSer.localeId];
                if (!schemeSettings) {
                    _this.reset2Default();
                }
                else {
                    _this.settings = schemeSettings;
                    _this.fields = schemeSettings.viewColumns;
                }
            }
            else {
                _this.reset2Default();
            }
            _this.cd.detectChanges();
        }));
    };
    /**
     * @param {?} flag
     * @return {?}
     */
    SimpleColumnsComponent.prototype.dirtySettings = /**
     * @param {?} flag
     * @return {?}
     */
    function (flag) {
        // this.isChanged = flag;
    };
    SimpleColumnsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'datagrid-settings-simple',
                    template: "<div class=\"d-flex flex-column f-datagrid-settings-simple\" tabindex=\"0\" #colcontainer\r\n    [style.top.px]=\"top\" [style.height]=\"'calc(100vh - ' +  top + 'px)'\" >\r\n\r\n    <div class=\"header d-flex\">\r\n        <div class=\"f-utils-fill title d-flex flex-row\"> {{ 'datagrid.settings.simple.title' | locale }} \r\n            <button #btnSchemeName class=\"btn ml-3 px-2 scheme-name d-flex flex-row\"  *ngIf=\"enableScheme\" (click)=\"onChooseScheme($event)\">\r\n                <!-- <span *ngIf=\"isChanged\">*</span> -->\r\n                <span>{{ currentSchemeItem? currentSchemeItem._title_ : defaultSchemeName }}</span>\r\n                <span class=\"f-icon f-icon-arrow-s ml-2\" style=\"font-size: 12px;\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"closed\" (click)=\"close($event)\">\r\n            <span class=\"f-icon f-icon-close\" style=\"font-size: 20px;\"></span>\r\n        </div>\r\n    </div>\r\n    <div class=\"scheme-manager-dropdown\" [style.display]=\"showSchemePanel? '': 'none'\" [style.left.px]=\"btnRef? btnRef.nativeElement.offsetLeft : 97\"  (click)=\"$event.stopPropagation()\">\r\n        <div class=\"f-utils-fill f-utils-flex-column m-2\">\r\n            <div class=\"pb-2\" style=\"max-height: calc(100vh - 300px);overflow: auto\">\r\n                <ul #schemeitems>\r\n                    <li class=\"scheme-manager__item\" [class.active]=\"!currentSchemeItem\" (click)=\"onSchemeItemClick($event, null)\"> \r\n                        <!-- <span *ngIf=\"isChanged && !activeSchemeItem\">*</span> -->\r\n                        {{'datagrid.scheme.syspreset' | locale}}\r\n                    </li>\r\n                    <li [attr.id]=\"'schemeitem_'+ item.id\" class=\"scheme-manager__item d-flex flex-row\" \r\n                        [class.active]=\"currentSchemeItem && currentSchemeItem?.id === item.id\"  \r\n                        *ngFor=\"let item of schemeList\" (click)=\"onSchemeItemClick($event, item)\" title=\"{{item._title_}}\">\r\n                        <!-- <span *ngIf=\"isChanged && activeSchemeItem?.id==item.id\">*</span> -->\r\n                        <span class=\"f-utils-fill mr-1\" style=\"text-overflow: ellipsis;\">{{item._title_}}</span>\r\n                        <span class=\"scheme-manager__label default\" *ngIf=\"item.isDefault\">{{'datagrid.scheme.isDefault' | locale}}</span>\r\n                        <span class=\"scheme-manager__label public\" *ngIf=\"item.type === 'public'\">{{'datagrid.scheme.isPublic' | locale}}</span>\r\n                        <span class=\"scheme-manager__label private\" *ngIf=\"!item.isDefault && item.type === 'private'\">{{'datagrid.scheme.isPrivate' | locale}}</span>\r\n                        <span class=\"scheme-manager__label org\" *ngIf=\"item.type === 'org'\">{{'datagrid.scheme.isOrg' | locale}}</span>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n\r\n            <div class=\"d-flex scheme-manager__button-add\">\r\n                <button (click)=\"onNewSchemeClick($event)\">\r\n                    <span class=\"f-icon f-icon-plus\"></span>{{'datagrid.scheme.newScheme' | locale}}\r\n                </button>\r\n            </div>\r\n\r\n            <div class=\"p-2 mt-2\">\r\n                <div class=\"btn-toolbar\" style=\"justify-content: flex-end;\">\r\n                    <button class=\"btn btn-link mr-3\" (click)=\"onShowSchemeList($event)\">{{'datagrid.scheme.mgrScheme' | locale}}</button>\r\n                    <button class=\"btn btn-primary mr-1\" (click)=\"onNewSchemeClick($event)\">{{'datagrid.scheme.saveas' | locale}} </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"f-utils-fill content d-flex flex-column\">\r\n        <div>\r\n            <div class=\"d-flex flex-row mb-2\" style=\"align-items: center;\">\r\n                <h5 class=\"count f-utils-fill m-0\" [innerHTML]=\"'datagrid.settings.simple.count' | locale | replaceX: fields.length\"></h5>\r\n                <div class=\"d-flex flex-row\">{{'datagrid.scheme.onlyshowcolumns' | locale}} \r\n                    <farris-switch style=\"position: relative;\r\n                    top: 2px;\r\n                    margin-left: 5px;\"\r\n                    id=\"only-visible-columns\"\r\n                    [square]=\"false\" [size]=\"'small'\"\r\n                    [ngModel]=\"switchValue\" \r\n                    (valueChange)=\"onlySeeVisibleColumns($event)\"\r\n                    ></farris-switch></div>\r\n            </div>\r\n\r\n            <div class=\"tip\">\r\n                {{ 'datagrid.settings.simple.tip' | locale }}\r\n            </div>\r\n            <div class=\"input-group mb-2 scheme-manager__search-box\">\r\n                <input #inputWord type=\"text\" class=\"form-control\" placeholder=\"{{'datagrid.settings.searchPlaceholder' | locale}}\"\r\n                (input)=\"searchColumn($event)\" style=\"height: 26px;\">\r\n                <div  class=\"input-group-append\">\r\n                    <span  class=\"fa f-icon-search\"></span>\r\n                </div>\r\n            </div>\r\n            \r\n\r\n            <div style=\"padding: 5px 0px;\">\r\n                <button class=\"btn btn-link \" style=\"height: 32px;padding-left: 4px;\" (click)=\"onCheckAllClick($event,inputWord.value)\">\r\n                    <span class=\"f-icon f-icon-minus-outline checkall\" [class.f-icon-checkbox]=\"!fields.length\"\r\n                        [class.f-icon-checkbox-checked]=\" searchInput.nativeElement.value ?  searchResultIsVisibleAll : fields.length === allCols.length\"></span>\r\n                    {{ 'datagrid.settings.checkall' | locale }}\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div style=\"overflow: auto;padding-right:3px\" class=\"f-utils-fill\">\r\n            <ul class=\"list-group list-group-flush\" #ul column-visible-drag (drop)=\"onFieldDrop($event, inputWord.value, ul)\">\r\n                <li class=\"list-group-item list-group-item-action smooth-dnd-draggable-wrapper format-setting-column\" *ngFor=\"let col of allCols\" \r\n                    (click)=\"onDblClick($event, col)\">\r\n                    <span class=\"f-icon checkbox\"\r\n                        [class.f-icon-checkbox-checked]=\"fields.indexOf(col.field) > -1\"\r\n                        [class.f-icon-checkbox]=\"fields.indexOf(col.field) == -1\"\r\n                        (click)=\"onCheckboxClick($event, col)\"></span>\r\n                    {{ col.title}} \r\n\r\n                    <span class=\"f-icon f-icon-drag-vertical field-drag-handle\"></span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n\r\n    </div>\r\n    <div class=\"footer\">\r\n\r\n        <div class=\"buttons\">\r\n            <button class=\"btn btn-link advanced\" (click)=\"showAdvanced($event)\">{{ 'datagrid.settings.advancedMode' | locale: '\u9AD8\u7EA7\u6A21\u5F0F' }}</button>\r\n            <button class=\"btn btn-link reset\" (click)=\"onSettingReset($event)\">{{ 'datagrid.settings.reset' | locale: '\u6062\u590D\u9ED8\u8BA4' }}</button>\r\n            <button class=\"btn btn-secondary cancel\"\r\n                (click)=\"close($event)\">{{'datagrid.settings.cancel' | locale}}</button>\r\n            <button class=\"btn btn-primary ok\" #okbtn\r\n                (click)=\"onSubmitClick($event)\">{{'datagrid.settings.ok' | locale}}</button>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n",
                    encapsulation: ViewEncapsulation.None,
                    styles: [".f-datagrid-settings-simple{position:fixed;top:100px;right:-500px;z-index:10000;height:calc(100vh - 100px);width:468px;background:#fff;border:1px solid #e6e9f0;border-radius:10px 0 0 10px;transition:right .3s}.f-datagrid-settings-simple:focus{outline:0}.f-datagrid-settings-simple .header{height:50px;line-height:50px;border-bottom:1px solid #eaedf3;font-size:18px;color:#2d2f33}.f-datagrid-settings-simple .header .scheme-name{border-radius:6px;color:#2a87ff;background:#ebf4ff;height:28px;align-items:center}.f-datagrid-settings-simple .header .title{padding-left:21px;font-weight:700;align-items:center}.f-datagrid-settings-simple .header .closed{width:50px;text-align:center;cursor:pointer}.f-datagrid-settings-simple .content .count{font-size:14px;color:#2d2f33}.f-datagrid-settings-simple .content .tip{background:#f7faff;border-radius:6px;line-height:20px;margin-bottom:10px;min-height:42px;align-items:center;display:flex;padding:5px}.f-datagrid-settings-simple .content .checkall{margin-left:5px;font-size:14px;color:#0089ff;margin-right:5px}.f-datagrid-settings-simple .content{margin:20px 24px}.f-datagrid-settings-simple .footer{height:32px;margin:20px}.smooth-dnd-ghost.format-setting-column{z-index:999999999!important;padding:4px 8px;background-color:#e7f1ff;border:1px solid #2a87ff}.smooth-dnd-ghost.format-setting-column .field-drag-handle{float:right}.f-datagrid-settings-simple .smooth-dnd-drop-preview-constant-class{background-color:#dee1ea}.f-datagrid-settings-simple .format-setting-column{background:#fafbfd;padding:4px 8px;margin-bottom:5px;border:1px solid #f2f4f8;border-radius:5px;color:#000}.f-datagrid-settings-simple .format-setting-column.active{border:1px solid #2a87ff;background:#e7f1ff;border-top:1px solid #2a87ff!important;border-bottom:1px solid #2a87ff!important}.format-setting-column .checkbox{font-size:14px;color:#0089ff;margin-right:5px;cursor:pointer}.f-datagrid-settings-simple .format-setting-column .field-drag-handle{float:right;cursor:-webkit-grab;cursor:grab}.f-datagrid-settings-simple .format-setting-column .field-drag-handle:active{cursor:-webkit-grabbing;cursor:grabbing}.f-datagrid-settings-simple .list-group-flush:last-child .list-group-item:last-child{border-bottom:1px solid #f2f4f8}.f-datagrid-settings-simple .list-group-flush:first-child .list-group-item:first-child{border-top:1px solid #f2f4f8}.f-datagrid-settings-simple .buttons{text-align:right}.f-datagrid-settings-simple .buttons button{width:66px;height:32px}.f-datagrid-settings-simple .buttons .cancel{margin-left:12px;margin-right:8px}.f-datagrid-settings-simple .buttons .ok{width:100px}.f-datagrid-settings-simple .buttons .advanced{width:66px;height:32px;float:left}.f-datagrid-settings-simple-host{width:100%;height:100%;position:absolute;top:0;left:0;z-index:1000}.f-datagrid-settings-simple .visible-cols-count{font-size:18px;font-weight:500}.scheme-manager-dropdown{z-index:1000;position:absolute;top:50px;width:230px;border-radius:10px;background-color:#fff;border:1px solid #eaedf3;left:95px;box-shadow:0 2px 12px 0 #d8dce6}.scheme-manager-dropdown::before{content:\"\";position:absolute;border:10px solid #0000;bottom:100%;left:20px;border-bottom-color:#e3e3e3}.scheme-manager-dropdown::after{content:\"\";position:absolute;border:10px solid #0000;bottom:100%;left:20px;border-bottom-color:#fff;margin-bottom:-1px}.scheme-manager__button-add{align-items:center;justify-content:center}.scheme-manager__button-add>button{background:#fff;width:100%;height:32px;border:1px dashed #2a87ff40;border-radius:6px;cursor:pointer}.scheme-manager__button-add>button:focus{outline:0}.scheme-manager__button-add>button>span.f-icon{position:relative;top:2px}.scheme-manager__button-add>button:hover{background:#2a87ff;color:#fff}.scheme-manager__search-box{border-radius:5px}.scheme-manager__search-box .input-group-append{width:30px;background:0 0;color:#b4bccc;display:flex;align-items:center;justify-content:center}.scheme-manager__item{line-height:30px;padding:2px 10px;font-size:13px;border-radius:6px;cursor:pointer;align-items:center}.scheme-manager__item:hover{background-color:#f7f8fb}.scheme-manager__item.active{background:#cbe1ff;color:#1564cb}#only-visible-columns .switch-small{min-width:1.88rem;height:.85rem}#only-visible-columns .switch-small small{width:.775rem;height:.775rem;left:1px;top:0}#only-visible-columns .switch.switch-small.checked small{right:1px;left:auto}.f-datagrid-save-scheme .header{height:50px;align-items:center;cursor:move;border-bottom:0}.f-datagrid-save-scheme .header .title{font-size:17px;color:#2d2f33;font-weight:500;margin-left:20px}.f-datagrid_scheme-switch .switch-medium{min-width:1.88rem!important;height:.85rem!important}.scheme-manager__label{border-radius:4px;font-size:12px;height:18px;min-width:32px;align-items:end;line-height:16px;text-align:center}.scheme-manager__label.default{border:1px solid green;color:green;background:#f0f9f2}.scheme-manager__label.public{border:1px solid #4075fa;color:#4075fa;background:#ecf2ff}.scheme-manager__label.private{border:1px solid #d8dce6;color:#878d99;background:#f7f8fb}.scheme-manager__label.org{border:1px solid #f4883e;color:#e46700;background:#fff9eb}.scheme-org-tip{padding-left:5px;color:#878d99;font-size:12px}"]
                }] }
    ];
    /** @nocollapse */
    SimpleColumnsComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ChangeDetectorRef }
    ]; };
    SimpleColumnsComponent.propDecorators = {
        enableScheme: [{ type: Input }],
        seartTypes: [{ type: Input }],
        columns: [{ type: Input }],
        fields: [{ type: Input }],
        clickToHidden: [{ type: Input }],
        top: [{ type: Input }],
        schemeList: [{ type: Input }],
        cls: [{ type: HostBinding, args: ['class',] }],
        container: [{ type: ViewChild, args: ['colcontainer',] }],
        btnOk: [{ type: ViewChild, args: ['okbtn',] }],
        searchInput: [{ type: ViewChild, args: ['inputWord',] }],
        schemeitemsEleRef: [{ type: ViewChild, args: ['schemeitems',] }],
        btnRef: [{ type: ViewChild, args: ['btnSchemeName',] }],
        formatChange: [{ type: Output }],
        fieldsChange: [{ type: Output }],
        submit: [{ type: Output }],
        closed: [{ type: Output }],
        advanced: [{ type: Output }],
        addNewScheme: [{ type: Output }],
        showSchemeList: [{ type: Output }],
        activeItemChange: [{ type: Output }],
        onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
        onEscKeydown: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }],
        onEnterKeydown: [{ type: HostListener, args: ['window:keydown.enter', ['$event'],] }],
        onControlGKeydown: [{ type: HostListener, args: ['keydown', ['$event'],] }]
    };
    return SimpleColumnsComponent;
}());
export { SimpleColumnsComponent };
if (false) {
    /** @type {?} */
    SimpleColumnsComponent.prototype.enableScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.seartTypes;
    /**
     * 所有列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.columns;
    /**
     * 显示的列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.fields;
    /**
     * 点击侧边样式以外的区域隐藏面板。默认为 true
     * @type {?}
     */
    SimpleColumnsComponent.prototype.clickToHidden;
    /** @type {?} */
    SimpleColumnsComponent.prototype.top;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype._schemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cls;
    /** @type {?} */
    SimpleColumnsComponent.prototype.container;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnOk;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchInput;
    /** @type {?} */
    SimpleColumnsComponent.prototype.schemeitemsEleRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.formatChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.fieldsChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.submit;
    /** @type {?} */
    SimpleColumnsComponent.prototype.closed;
    /** @type {?} */
    SimpleColumnsComponent.prototype.advanced;
    /** @type {?} */
    SimpleColumnsComponent.prototype.addNewScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.activeItemChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.allCols;
    /** @type {?} */
    SimpleColumnsComponent.prototype.columnType;
    /** @type {?} */
    SimpleColumnsComponent.prototype.gridInstance;
    /** @type {?} */
    SimpleColumnsComponent.prototype.localeSer;
    /** @type {?} */
    SimpleColumnsComponent.prototype.isEn;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemePanel;
    /** @type {?} */
    SimpleColumnsComponent.prototype.switchValue;
    /** @type {?} */
    SimpleColumnsComponent.prototype.currentSchemeItem;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchResultIsVisibleAll;
    /** @type {?} */
    SimpleColumnsComponent.prototype.defaultSchemeName;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.messager;
    /** @type {?} */
    SimpleColumnsComponent.prototype.settings;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.injector;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLWNvbHVtbnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhZ3JpZC1zZXR0aW5ncy8iLCJzb3VyY2VzIjpbImxpYi9zaW1wbGUtbW9kZS9zaW1wbGUtY29sdW1ucy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFDekUsTUFBTSxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzlGLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFHdEQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFL0Q7SUF1RUksZ0NBQW9CLFFBQWtCLEVBQVMsRUFBcUI7UUFBaEQsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFTLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBOUQzRCxpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUNyQixlQUFVLEdBQVEsRUFBRSxDQUFDOzs7O1FBRXJCLFlBQU8sR0FBRyxFQUFFLENBQUM7Ozs7UUFFYixXQUFNLEdBQUcsRUFBRSxDQUFDOzs7O1FBRVosa0JBQWEsR0FBRyxJQUFJLENBQUM7UUFFckIsUUFBRyxHQUFHLENBQUMsQ0FBQztRQUNULGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBY0gsUUFBRyxHQUFHLGlDQUFpQyxDQUFDO1FBU3BELGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbEMsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDNUIsV0FBTSxHQUFHLElBQUks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REFBeUI7O0lBRXpCLDBEQUFpQzs7SUFDakMsbURBQTJCOzs7OztJQUUzQiwwQ0FBa0M7O0lBRWxDLDBDQUE0Qjs7Ozs7SUFFaEIsMENBQTBCOztJQUFFLG9DQUE0QiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLCBJbmplY3RvciwgSW5wdXQsIE9uSW5pdCxcclxuICAgICAgICBPdXRwdXQsIFZpZXdFbmNhcHN1bGF0aW9uLCBIb3N0TGlzdGVuZXIsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgU2V0dGluZ01vZGVsIH0gZnJvbSAnLi4vc2V0dGluZy5tb2RlbCc7XHJcbmltcG9ydCB7IGdldE11bHRpbGluZ3VhbFZhbHVlIH0gZnJvbSAnLi4vZ2V0VmFsdWVXaXRoTG9jYWxlSWQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLXNldHRpbmdzLXNpbXBsZScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc2ltcGxlLWNvbHVtbnMuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbXHJcbiAgICAgICAgYC4vc2V0dGluZ3Mtc2ltcGxlLnNjc3NgXHJcbiAgICBdLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2ltcGxlQ29sdW1uc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSBlbmFibGVTY2hlbWUgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIHNlYXJ0VHlwZXM6IGFueSA9IFtdO1xyXG4gICAgLyoqIOaJgOacieWIlyAqL1xyXG4gICAgQElucHV0KCkgY29sdW1ucyA9IFtdO1xyXG4gICAgLyoqIOaYvuekuueahOWIlyAqL1xyXG4gICAgQElucHV0KCkgZmllbGRzID0gW107XHJcbiAgICAvKiog54K55Ye75L6n6L655qC35byP5Lul5aSW55qE5Yy65Z+f6ZqQ6JeP6Z2i5p2/44CC6buY6K6k5Li6IHRydWUgKi9cclxuICAgIEBJbnB1dCgpIGNsaWNrVG9IaWRkZW4gPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpIHRvcCA9IDA7XHJcbiAgICBwcml2YXRlIF9zY2hlbWVMaXN0ID0gW107XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IHNjaGVtZUxpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtZUxpc3Q7XHJcbiAgICB9XHJcbiAgICBzZXQgc2NoZW1lTGlzdCh2YWwpIHtcclxuICAgICAgICBpZiAodmFsICYmIHZhbC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFsLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBuWydfdGl0bGVfJ10gPSBnZXRNdWx0aWxpbmd1YWxWYWx1ZShKU09OLnBhcnNlKG4ubmFtZSksIHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NjaGVtZUxpc3QgPSB2YWwgfHwgW107XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGNscyA9ICdmLWRhdGFncmlkLXNldHRpbmdzLXNpbXBsZS1ob3N0JztcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjb2xjb250YWluZXInKSBjb250YWluZXI6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdva2J0bicpIGJ0bk9rOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnaW5wdXRXb3JkJykgc2VhcmNoSW5wdXQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnc2NoZW1laXRlbXMnKSBzY2hlbWVpdGVtc0VsZVJlZjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2J0blNjaGVtZU5hbWUnKSBidG5SZWY6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgQE91dHB1dCgpIGZvcm1hdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBmaWVsZHNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgc3VibWl0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBhZHZhbmNlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCkgYWRkTmV3U2NoZW1lID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNob3dTY2hlbWVMaXN0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGFjdGl2ZUl0ZW1DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBhbGxDb2xzID0gW107XHJcbiAgICBjb2x1bW5UeXBlID0gJ2FsbCc7XHJcblxyXG4gICAgZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICAgIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZTtcclxuICAgIGlzRW4gPSBmYWxzZTtcclxuXHJcbiAgICBzaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgICBzd2l0Y2hWYWx1ZSA9IGZhbHNlO1xyXG4gICAgLy8g5b2T5YmN5pa55qGIXHJcbiAgICBjdXJyZW50U2NoZW1lSXRlbSA9IG51bGw7XHJcblxyXG4gICAgc2VhcmNoUmVzdWx0SXNWaXNpYmxlQWxsID0gZmFsc2U7XHJcbiAgICBkZWZhdWx0U2NoZW1lTmFtZSA9ICfns7vnu5/pooTliLYnO1xyXG5cclxuICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZTtcclxuXHJcbiAgICBzZXR0aW5nczogU2V0dGluZ01vZGVsID0ge307XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsIHB1YmxpYyBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXIgPSB0aGlzLmluamVjdG9yLmdldChNZXNzYWdlclNlcnZpY2UsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ2xpY2soJGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJGV2ZW50KTtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgY29uc3QgY2xzbmFtZSA9ICRldmVudC50YXJnZXRbJ2NsYXNzTmFtZSddIHx8ICcnO1xyXG4gICAgICAgIGlmIChjbHNuYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtc2V0dGluZ3Mtc2ltcGxlLWhvc3QnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIC8vIOmakOiXj+S+p+i+ueagj++8m1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jbGlja1RvSGlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignd2luZG93OmtleWRvd24uZXNjJywgWyckZXZlbnQnXSlcclxuICAgIG9uRXNjS2V5ZG93bigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtb2RhbC1jb250YWluZXInKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlkb3duLmVudGVyJywgWyckZXZlbnQnXSlcclxuICAgIG9uRW50ZXJLZXlkb3duKCRldmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21vZGFsLWNvbnRhaW5lcicpKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXRDbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ29udHJvbEdLZXlkb3duKCRldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQuY3RybEtleSAmJiAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbW9kYWwtY29udGFpbmVyJykpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKCRldmVudC5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ2cnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dBZHZhbmNlZCgkZXZlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRldmVudC5rZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uU2V0dGluZ1Jlc2V0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJGV2ZW50LmtleS50b0xvd2VyQ2FzZSgpID09PSAncycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q3VycmVudFNjaGVtZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjaGVtZVNldHRpbmdzID0gSlNPTi5wYXJzZSh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKTtcclxuICAgICAgICAgICAgcmV0dXJuIHNjaGVtZVNldHRpbmdzW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSBhcyBTZXR0aW5nTW9kZWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmFsbENvbHMgPSB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICAgICAgaWYgKHRoaXMuZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZSAmJiB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLmdldEN1cnJlbnRTY2hlbWVTZXR0aW5ncygpIHx8IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MgJiYgdGhpcy5zZXR0aW5ncy52aWV3Q29sdW1ucyAmJiB0aGlzLnNldHRpbmdzLnZpZXdDb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuc2V0dGluZ3Mudmlld0NvbHVtbnM7XHJcbiAgICAgICAgICAgIHRoaXMuZGlydHlTZXR0aW5ncyh0cnVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuZ2V0Vmlld0NvbHVtbnMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0U2NoZW1lTmFtZSA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5zY2hlbWUuc3lzcHJlc2V0JykgfHwgdGhpcy5ncmlkSW5zdGFuY2UuZGVmYXVsdFNjaGVtZU5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRWaWV3Q29sdW1ucygpIHtcclxuICAgICAgICAvLyDlpJrooajlpLRcclxuICAgICAgICBsZXQgdmlzaWJsZUNscyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbHVtbnMubGVuZ3RoID4gMSApIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goY29scyA9PiB7XHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlQ2xzID0gdmlzaWJsZUNscy5jb25jYXQodGhpcy5fZ2V0Vmlld0NvbHVtbnMoY29scykpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2aXNpYmxlQ2xzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IChuLnZpc2libGUgfHwgbi52aXNpYmxlID09PSB1bmRlZmluZWQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB2aXNpYmxlQ2xzLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2dldFZpZXdDb2x1bW5zKGNvbHM6IGFueVtdKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbHMuZmlsdGVyKGMgPT4gIWMuY29sc3BhbiAmJiAoYy52aXNpYmxlIHx8IGMudmlzaWJsZSA9PT0gdW5kZWZpbmVkKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOagueaNruWIl+eahOexu+Wei+i/m+ihjOetm+mAiei/h+a7pO+8jFxyXG4gICAgLy8gYWxsIOaJgOacieWIl1xyXG4gICAgLy8gdmlzaWJsZSDlj6/op4HliJdcclxuICAgIC8vIGhpZGRlbiDpmpDol4/liJdcclxuICAgIC8vIGdyb3VwIOWIhue7hOWIl1xyXG4gICAgZmlsdGVyQ29sdW1ucyhzZWFyY2hXb3JkcyA9ICcnKSB7XHJcbiAgICAgICAgbGV0IGNvbHMgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3dpdGNoVmFsdWUpIHtcclxuICAgICAgICAgICAgY29scyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiB0aGlzLmZpZWxkcy5pbmRleE9mKG4uZmllbGQpID4gLTEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2VhcmNoV29yZHMpIHtcclxuICAgICAgICAgICAgY29scyA9IGNvbHMuZmlsdGVyKGMgPT4gYy50aXRsZS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoV29yZHMudG9Mb3dlckNhc2UoKSkgPiAtMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFsbENvbHMgPSBjb2xzO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBvbkZpZWxkc0NoYW5nZWQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmdyaWRJbnN0YW5jZS5lbmFibGVTY2hlbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHNDaGFuZ2UuZW1pdCh0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25EYmxDbGljaygkZXZlbnQsIGNvbCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCfmmL7npLrkuI7pmpDol4/liIfmjaLkuovku7YnLCBjb2wpO1xyXG4gICAgICAgIHRoaXMub25DaGVja2JveENsaWNrKCRldmVudCwgY29sKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrYm94Q2xpY2soJGV2ZW50LCBjb2wpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygn5pi+56S65LiO6ZqQ6JeP5YiH5o2i5LqL5Lu2JywgY29sKTtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBsZXQgY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maWVsZHMuaW5kZXhPZihjb2wuZmllbGQpO1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHMucHVzaChjb2wuZmllbGQpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5jb2x1bW5zWzBdLmZpbmQobiA9PiBuLmZpZWxkID09PSBjb2wuZmllbGQpO1xyXG4gICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgIGl0ZW0udmlzaWJsZSA9IGNoZWNrZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMuY29sdW1uc1swXS5mb3JFYWNoKGYgPT4ge1xyXG4gICAgICAgIC8vICAgICBmLnZpc2libGUgPSB0aGlzLmZpZWxkcy5pbmRleE9mKGYuZmllbGQpID4gLTE7XHJcbiAgICAgICAgLy8gfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VhcmNoUmVzdWx0SXNWaXNpYmxlQWxsID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4udmlzaWJsZSkubGVuZ3RoID09PSB0aGlzLmFsbENvbHMubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hDb2x1bW4oJGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgdHh0ID0gJGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnModHh0KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkZpZWxkRHJvcChmaWVsZEluZm8sIHR4dCwgdWxFbFJlZjogYW55KSB7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgIC8vIGNvbnNvbGUubG9nKCdkcm9wJywgZmllbGRJbmZvKTtcclxuICAgICAgICBjb25zdCB7IHJlbW92ZWRJbmRleCwgYWRkZWRJbmRleCB9ID0gZmllbGRJbmZvO1xyXG5cclxuICAgICAgICBjb25zdCBtb3ZlSXRlbSA9IHRoaXMuYWxsQ29sc1tyZW1vdmVkSW5kZXhdO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEl0ZW0gPSB0aGlzLmFsbENvbHNbYWRkZWRJbmRleF07XHJcblxyXG4gICAgICAgIGNvbnN0IG1vdmVJdGVtSW5kZXggPSB0aGlzLmNvbHVtbnNbMF0uZmluZEluZGV4KG4gPT4gbi5maWVsZCA9PT0gbW92ZUl0ZW0uZmllbGQpO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEl0ZW1JbmRleCA9IHRoaXMuY29sdW1uc1swXS5maW5kSW5kZXgobiA9PiBuLmZpZWxkID09PSB0YXJnZXRJdGVtLmZpZWxkKTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVtb3ZlZEl0ZW0gPSB0aGlzLmNvbHVtbnNbMF0uc3BsaWNlKG1vdmVJdGVtSW5kZXgsIDEpO1xyXG4gICAgICAgIHRoaXMuY29sdW1uc1swXS5zcGxpY2UodGFyZ2V0SXRlbUluZGV4LCAwLCAuLi5yZW1vdmVkSXRlbSk7XHJcblxyXG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAwOiAx5Liq5Lmf5rKh5pyJ6YCJ5Lit77ybIDE6IOWFqOmDqOmAieS4re+8myAyOiDmnInpgInkuK3nmoTkuZ/mnInmsqHpgInkuK3nmoRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRDaGVja0FsbFN0YXRlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5zZWFyY2hJbnB1dC5uYXRpdmVFbGVtZW50LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmllbGRzLmxlbmd0aCA9PT0gdGhpcy5jb2x1bW5zWzBdLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aXNpYmxlTGVuID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4udmlzaWJsZSkubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA9PT0gdGhpcy5hbGxDb2xzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA8IHRoaXMuYWxsQ29scy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmlzaWJsZUxlbiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlhajpgIlcclxuICAgIG9uQ2hlY2tBbGxDbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQsIHR4dCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5nZXRDaGVja0FsbFN0YXRlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2tBbGwgPSBzdGF0ZSA9PT0gMCB8fCBzdGF0ZSA9PT0gMjtcclxuXHJcbiAgICAgICAgaWYgKCF0eHQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiBuLnZpc2libGUgPSBpc0NoZWNrQWxsKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5hbGxDb2xzLmZpbmQoYSA9PiBuLmZpZWxkID09IGEuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnZpc2libGUgPSBpc0NoZWNrQWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udmlzaWJsZSA9IGlzQ2hlY2tBbGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc1Zpc2libGVBbGwgPSB0aGlzLmFsbENvbHMuZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5sZW5ndGggPT09IHRoaXMuYWxsQ29scy5sZW5ndGg7XHJcblxyXG4gICAgICAgIHRoaXMuZGlydHlTZXR0aW5ncyh0cnVlKTtcclxuXHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnModHh0KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgkZXZlbnQ/OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2xvc2VkLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmiZPlvIDpq5jnuqforr7nva7nqpflj6NcclxuICAgIHNob3dBZHZhbmNlZCgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCRldmVudCk7XHJcbiAgICAgICAgdGhpcy5hZHZhbmNlZC5lbWl0KHsgdmlld0ZpZWxkczogdGhpcy5maWVsZHMgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5oGi5aSN6buY6K6kXHJcbiAgICBvblNldHRpbmdSZXNldCgkZXZlbnQ/OiBhbnkpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgcmVzdG9yRGVmYXVsdFRleHQgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3MucmVzdG9yZURlZmF1bHRTZXR0aW5nc1RleHQnKSB8fCAn56Gu6K6k6KaB5oGi5aSN6buY6K6k6K6+572u5ZCX77yfJztcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyLmNvbmZpcm0ocmVzdG9yRGVmYXVsdFRleHQpLnN1YnNjcmliZSgodDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldDJEZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlc2V0MkRlZmF1bHQoKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZ3JpZEluc3RhbmNlLmRmc1snX3N0YXRlJ10uaW5pdGlhbE9wdGlvbnM7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuY29sdW1uRmllbGRzICYmIG9wdGlvbnMuY29sdW1uRmllbGRzLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbmV3Q29sdW1ucyA9IFtdO1xyXG4gICAgICAgICAgICBvcHRpb25zLmNvbHVtbkZpZWxkcy5mb3JFYWNoKGMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGMuZmllbGQgIT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2wgPSB0aGlzLmdyaWRJbnN0YW5jZS5jb2x1bW5zWzBdLmZpbmQoKG46IGFueSkgPT4gbi5maWVsZCA9PT0gYy5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wudmlzaWJsZSA9IGMudmlzaWJsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmhhbGlnbiA9IGMuaGFsaWduO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuYWxpZ24gPSBjLmFsaWduO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wud2lkdGggPSBjLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuZm9vdGVyID0gey4uLmMuZm9vdGVyIHx8IHt9fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmdyb3VwRm9vdGVyID0gey4uLmMuZ3JvdXBGb290ZXIgfHwge319O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2x1bW5zLnB1c2goY29sKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gW25ld0NvbHVtbnNdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hbGxDb2xzID0gdGhpcy5jb2x1bW5zWzBdO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB7fTtcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuZ2V0Vmlld0NvbHVtbnMoKTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLnZpZXdDb2x1bW5zID0gdGhpcy5maWVsZHM7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5jb2x1bW5Gb3JtYXQgPSBbLi4udGhpcy5jb2x1bW5zWzBdXTtcclxuICAgICAgICBpZiAob3B0aW9ucy5zb3J0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNvcnRPcmRlcnMgPSBvcHRpb25zLnNvcnQuc29ydE9yZGVyPyBvcHRpb25zLnNvcnQuc29ydE9yZGVyLnNwbGl0KCcsJykgOiBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29ydE5hbWVzID0gb3B0aW9ucy5zb3J0LnNvcnROYW1lID8gb3B0aW9ucy5zb3J0LnNvcnROYW1lLnNwbGl0KCcsJykgOiBbXTtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zb3J0SW5mbyA9IHsgc29ydE5hbWU6IHNvcnROYW1lcywgc29ydE9yZGVyOiAgc29ydE9yZGVycyB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc29ydEluZm8gPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5ncm91cEZpZWxkID0gIG9wdGlvbnMuZ3JvdXBGaWVsZCA/IG9wdGlvbnMuZ3JvdXBGaWVsZC5zcGxpdCgnLCcpIDogW107XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56Gu5a6a5oyJ6ZKu54K55Ye75LqL5Lu2XHJcbiAgICBvblN1Ym1pdENsaWNrKCRldmVudD86IGFueSkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3Mudmlld0NvbHVtbnMgPSB0aGlzLmZpZWxkcztcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVNjaGVtZSB8fCAhdGhpcy5jdXJyZW50U2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuY29sdW1uRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNvbHVtbkZvcm1hdCA9IFsuLi50aGlzLmNvbHVtbnNbMF1dO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3Muc29ydEluZm8pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc29ydEluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE5hbWU6IHRoaXMuZ3JpZEluc3RhbmNlLnNvcnROYW1lID8gdGhpcy5ncmlkSW5zdGFuY2Uuc29ydE5hbWUuc3BsaXQoJywnKSA6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNvcnRPcmRlcjogIHRoaXMuZ3JpZEluc3RhbmNlLnNvcnRPcmRlciA/IHRoaXMuZ3JpZEluc3RhbmNlLnNvcnRPcmRlci5zcGxpdCgnLCcpIDogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdyb3VwRmllbGQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5ncm91cEZpZWxkID0gdGhpcy5ncmlkSW5zdGFuY2UuZ3JvdXBGaWVsZCA/IHRoaXMuZ3JpZEluc3RhbmNlLmdyb3VwRmllbGQuc3BsaXQoJywnKSA6IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgX3NldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50U2NoZW1lU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgaWYgKF9zZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oX3NldHRpbmdzIHx8IHt9LCB0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmFjdGl2ZUl0ZW1DaGFuZ2UuZW1pdCh0aGlzLmFjdGl2ZVNjaGVtZUl0ZW0pO1xyXG4gICAgICAgIHRoaXMuc3VibWl0LmVtaXQoe2NvbnRlbnQ6IHRoaXMuc2V0dGluZ3MsIGNsb3NlOiB0aGlzLmNsb3NlLmJpbmQodGhpcyksIHRhcmdldDogdGhpcy5idG5Pay5uYXRpdmVFbGVtZW50LCBjdXJyZW50U2NoZW1lOiB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5pi+56S65LiL5ouJ5pa55qGI5YiX6KGoXHJcbiAgICBvbkNob29zZVNjaGVtZSgkZXZlbnQpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gIXRoaXMuc2hvd1NjaGVtZVBhbmVsO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NoZW1laXRlbXNFbGVSZWYgJiYgdGhpcy5jdXJyZW50U2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbUVsID0gdGhpcy5zY2hlbWVpdGVtc0VsZVJlZi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCNzY2hlbWVpdGVtXyR7dGhpcy5jdXJyZW50U2NoZW1lSXRlbS5pZH1gKTtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtRWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbUVsLnNjcm9sbEludG9WaWV3SWZOZWVkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUVsLnNjcm9sbEludG9WaWV3SWZOZWVkZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtRWwuc2Nyb2xsSW50b1ZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOS7heaYvuekuuWPr+ingeWIl1xyXG4gICAgb25seVNlZVZpc2libGVDb2x1bW5zKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuc3dpdGNoVmFsdWUgPSAkZXZlbnQ7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5paw5aKe5pa55qGIXHJcbiAgICBvbk5ld1NjaGVtZUNsaWNrKCRldmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWRkTmV3U2NoZW1lLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrmlrnmoYjliJfooajnrqHnkIbnqpflj6NcclxuICAgIG9uU2hvd1NjaGVtZUxpc3QoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lTGlzdC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5pa55qGI54K55Ye7XHJcbiAgICBvblNjaGVtZUl0ZW1DbGljaygkZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2NoZW1lSXRlbSA9IGl0ZW07XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2NoZW1lU2V0dGluZ3MgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgc2NoZW1lU2V0dGluZ3MgPSBKU09OLnBhcnNlKGl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgc2NoZW1lU2V0dGluZ3MgPSBzY2hlbWVTZXR0aW5nc1t0aGlzLmxvY2FsZVNlci5sb2NhbGVJZF07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFzY2hlbWVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQyRGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzID0gc2NoZW1lU2V0dGluZ3M7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZHMgPSBzY2hlbWVTZXR0aW5ncy52aWV3Q29sdW1uczsgICBcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0MkRlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZGlydHlTZXR0aW5ncyhmbGFnKSB7XHJcbiAgICAgICAgLy8gdGhpcy5pc0NoYW5nZWQgPSBmbGFnO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==