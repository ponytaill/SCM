/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { BigNumber } from 'bignumber.js';
import { Component, forwardRef, Input, Output, ViewChild, ElementRef, EventEmitter } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { NumberSpinnerComponent } from './number-spinner.component';
import { PopoverDirective } from '@farris/ui-popover';
var NumberRangeComponent = /** @class */ (function (_super) {
    tslib_1.__extends(NumberRangeComponent, _super);
    function NumberRangeComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.beginPlaceHolder = '';
        _this.endPlaceHolder = '';
        _this.separator = '~';
        _this.__value = '';
        _this.beginValueChange = new EventEmitter();
        _this.endValueChange = new EventEmitter();
        _this.prevValue = '';
        _this.nextValue = '';
        _this._beginValue = '';
        _this._endValue = '';
        _this.focusState = {
            isFocus: false,
            target: '' // begin | end
        };
        return _this;
        //#endregion
    }
    Object.defineProperty(NumberRangeComponent.prototype, "beginValue", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.prevValue = this.format(value);
            this._beginValue = this.isEmpty(value) ? '' : value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NumberRangeComponent.prototype, "endValue", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.nextValue = this.format(value);
            this._endValue = this.isEmpty(value) ? '' : value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NumberRangeComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this.__value;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (v !== this.__value) {
                this.__value = v === '~' ? '' : v;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NumberRangeComponent.prototype, "preNumValue", {
        get: /**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var v = this.getRealValue(this.parser ? this.prevValue : this._beginValue);
            if (this.canNull && this.isEmpty(v)) {
                return '';
            }
            else {
                return v || 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NumberRangeComponent.prototype, "nextNumValue", {
        get: /**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var v = this.getRealValue(this.parser ? this.nextValue : this._endValue);
            if (this.canNull && this.isEmpty(v)) {
                return '';
            }
            else {
                return v || 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NumberRangeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        _super.prototype.ngOnInit.call(this);
        this.showButton = false;
        this.initPlaceHolderInfo();
    };
    /**
     * @return {?}
     */
    NumberRangeComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.documentClick = this.render.listen(document, 'click', (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.render.setStyle(_this.prevWrapper.nativeElement, 'flex', 1);
            _this.render.setStyle(_this.nextWrapper.nativeElement, 'flex', 1);
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    NumberRangeComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        _super.prototype.ngOnChanges.call(this, changes);
        if (changes.value && !changes.value.isFirstChange()) {
            this.setValue(changes.value.currentValue);
        }
    };
    /**
     * @return {?}
     */
    NumberRangeComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.documentClick) {
            this.documentClick();
        }
    };
    /**
     * @private
     * @return {?}
     */
    NumberRangeComponent.prototype.initPlaceHolderInfo = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.beginPlaceHolder) {
            this.beginPlaceHolder = this.localeService.getValue('numberSpinner.range.begin') || this.placeholder;
        }
        if (!this.endPlaceHolder) {
            this.endPlaceHolder = this.localeService.getValue('numberSpinner.range.end') || this.placeholder;
        }
    };
    /**
     * @private
     * @return {?}
     */
    NumberRangeComponent.prototype.getRangeValue = /**
     * @private
     * @return {?}
     */
    function () {
        return this.preNumValue + this.separator + this.nextNumValue;
    };
    /**
     * @private
     * @return {?}
     */
    NumberRangeComponent.prototype.getEndValue = /**
     * @private
     * @return {?}
     */
    function () {
        return this.getRealValue(this.nextValue);
    };
    /**
     * @private
     * @return {?}
     */
    NumberRangeComponent.prototype.getBeginValue = /**
     * @private
     * @return {?}
     */
    function () {
        return this.getRealValue(this.prevValue);
    };
    /**
     * @param {?} val
     * @return {?}
     */
    NumberRangeComponent.prototype.getRealValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (this.parser) {
            return this.parser(val);
        }
        /** @type {?} */
        var _n = this.validInterval(new BigNumber(val));
        if (_n.isNaN()) {
            /** @type {?} */
            var minBigNum = new BigNumber('' + this.min);
            if (this.canNull || minBigNum.isNaN()) {
                return null;
            }
            else {
                _n = minBigNum;
            }
        }
        return (/** @type {?} */ (this._getRealValue(_n)));
    };
    /**
     * @param {?} val
     * @param {?=} type
     * @return {?}
     */
    NumberRangeComponent.prototype.onModelChange = /**
     * @param {?} val
     * @param {?=} type
     * @return {?}
     */
    function (val, type) {
        if (type === 'begin') {
            this._beginValue = val;
        }
        else if (type === 'end') {
            this._endValue = val;
        }
        this.value = this.getRangeValue();
        this.onChangeCallback(this.value);
        this.onTouchedCallback();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NumberRangeComponent.prototype.onClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
    };
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    NumberRangeComponent.prototype.onBlur = /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    function (e, type) {
        if (!this.readonly && !this.disabled) {
            /** @type {?} */
            var tmpValue = e.value;
            this.focusState = { isFocus: false, target: type };
            if (type === 'begin') {
                /** @type {?} */
                var nextVal = this.getEndValue();
                /** @type {?} */
                var minValue = this.isEmpty(tmpValue)
                    ? ''
                    : this.isEmpty(nextVal)
                        ? tmpValue
                        : BigNumber.min(tmpValue, nextVal).toFixed();
                // this.prevValue = this.format(minValue);
                this.beginValue = this.validInterval(new BigNumber(minValue)).toFixed();
                // this.beginValue = this.getRealValue(this.prevValue);
                this.inputPrev.nativeElement.value = this.prevValue;
                this.onModelChange(minValue, type);
            }
            else {
                /** @type {?} */
                var beginVal = this.getBeginValue();
                /** @type {?} */
                var maxValue = this.isEmpty(tmpValue)
                    ? ''
                    : this.isEmpty(beginVal)
                        ? tmpValue
                        : BigNumber.max(tmpValue, beginVal).toFixed();
                // this.nextValue = this.format(maxValue);
                // this.endValue = this.getRealValue(this.nextValue);
                this.endValue = this.validInterval(new BigNumber(maxValue)).toFixed();
                this.inputNext.nativeElement.value = this.nextValue;
                this.onModelChange(maxValue, type);
            }
        }
        this.valueChange.emit(this.value);
        if (type === 'begin') {
            this.beginValueChange.emit(this.preNumValue);
        }
        else {
            this.endValueChange.emit(this.nextNumValue);
        }
        this.blur.emit();
    };
    /**
     * @param {?=} type
     * @return {?}
     */
    NumberRangeComponent.prototype.onFocus = /**
     * @param {?=} type
     * @return {?}
     */
    function (type) {
        if (!this.readonly && !this.disabled) {
            this.focusState = { isFocus: true, target: type };
            if (type === 'begin') {
                this.inputPrev.nativeElement.value = this._beginValue;
                this.inputPrev.nativeElement.setSelectionRange(0, this._beginValue.length);
                this.expendWidth('begin', 3);
            }
            else {
                this.inputNext.nativeElement.value = this._endValue;
                this.inputNext.nativeElement.setSelectionRange(0, this._endValue.length);
                this.expendWidth('end', 3);
            }
        }
        this.focus.emit(type);
    };
    /**
     * @param {?} which
     * @param {?} num
     * @return {?}
     */
    NumberRangeComponent.prototype.expendWidth = /**
     * @param {?} which
     * @param {?} num
     * @return {?}
     */
    function (which, num) {
        /** @type {?} */
        var target;
        /** @type {?} */
        var other;
        if (which === 'begin') {
            target = this.prevWrapper.nativeElement;
            other = this.nextWrapper.nativeElement;
        }
        else {
            target = this.nextWrapper.nativeElement;
            other = this.prevWrapper.nativeElement;
        }
        var width = target.getBoundingClientRect().width;
        if (width < 150) {
            this.render.setStyle(target, 'flex', num);
            this.render.setStyle(other, 'flex', 1);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NumberRangeComponent.prototype.onMouseEnter = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.isActiveTip = this.isShowPopover();
        if (this.nextValue && this.prevValue) {
            this.popValue = this.prevValue + '~' + this.nextValue;
        }
        else {
            this.popValue = '';
        }
    };
    /**
     * @return {?}
     */
    NumberRangeComponent.prototype.isShowPopover = /**
     * @return {?}
     */
    function () {
        var width = this.el.nativeElement.getBoundingClientRect().width;
        if (width && width < 200) {
            return true;
        }
        return false;
    };
    /**
     * @param {?} $event
     * @param {?} typ
     * @return {?}
     */
    NumberRangeComponent.prototype.onKeyDownRange = /**
     * @param {?} $event
     * @param {?} typ
     * @return {?}
     */
    function ($event, typ) {
        if ($event.key === 'ArrowDown') {
            $event.preventDefault();
            this.down($event, typ);
        }
        if ($event.key === 'ArrowUp') {
            $event.preventDefault();
            this.up($event, typ);
        }
        $event.stopPropagation();
    };
    /**
     * @param {?} val
     * @return {?}
     */
    NumberRangeComponent.prototype.writeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        this.setValue(val);
    };
    /**
     * @param {?} val
     * @return {?}
     */
    NumberRangeComponent.prototype.setValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (typeof val === 'string') {
            /** @type {?} */
            var valArr = val.split(this.separator);
            this._beginValue = valArr[0] ? valArr[0] : '';
            this._endValue = valArr[1] ? valArr[1] : '';
        }
        else {
            this._beginValue = '';
            this._beginValue = '';
        }
        this.prevValue = this.format(this._beginValue);
        this.nextValue = this.format(this._endValue);
    };
    //#region 上下操作按钮 或 上下方向键
    //#region 上下操作按钮 或 上下方向键
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    NumberRangeComponent.prototype.up = 
    //#region 上下操作按钮 或 上下方向键
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    function (e, type) {
        e.stopPropagation();
        this._compute(type, 'up', ((/** @type {?} */ (e.target))).value);
    };
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    NumberRangeComponent.prototype.down = /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    function (e, type) {
        e.stopPropagation();
        this._compute(type, 'down', ((/** @type {?} */ (e.target))).value);
    };
    /**
     * @private
     * @param {?} type
     * @param {?} dir
     * @param {?} tagVal
     * @return {?}
     */
    NumberRangeComponent.prototype._compute = /**
     * @private
     * @param {?} type
     * @param {?} dir
     * @param {?} tagVal
     * @return {?}
     */
    function (type, dir, tagVal) {
        /** @type {?} */
        var m = dir === 'up' ? 'plus' : 'minus';
        if (type === 'begin' && this.isDisableOfBtn(dir, this.prevValue)) {
            /** @type {?} */
            var bv = tagVal || 0;
            /** @type {?} */
            var ev = this.getRealValue(this.nextValue);
            /** @type {?} */
            var r = new BigNumber(bv)[m](Number(this.step));
            /** @type {?} */
            var v = r.toFixed();
            /** @type {?} */
            var minValue = BigNumber.min(v, ev);
            if (!minValue.eq(v) && !this.isEmpty(ev)) {
                v = ev;
            }
            this._beginValue = v;
            // this.prevValue = this.format(v);
            this.inputPrev.nativeElement.value = v;
            this.onModelChange(v, type);
            this.beginValueChange.emit(v);
        }
        else if (type === 'end' && this.isDisableOfBtn(dir, this.nextValue)) {
            /** @type {?} */
            var bv = this.getRealValue(this.prevValue);
            /** @type {?} */
            var ev = tagVal || 0;
            /** @type {?} */
            var r = new BigNumber(ev)[m](Number(this.step));
            /** @type {?} */
            var v = r.toFixed();
            /** @type {?} */
            var maxValue = BigNumber.max(bv, v);
            if (!maxValue.eq(v) && !this.isEmpty(bv)) {
                v = bv;
            }
            this._endValue = v;
            // this.nextValue = this.format(v);
            this.inputNext.nativeElement.value = v;
            this.onModelChange(v, type);
            this.endValueChange.emit(v);
        }
        this.valueChange.emit(this.value);
        this.expendWidth(type, 3);
    };
    NumberRangeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-number-range',
                    template: "<div\r\n    class=\"input-group number-range f-cmp-number-spinner\"\r\n    [ngClass]=\"{\r\n        'f-state-disabled': disabled,\r\n        'f-state-readonly': readonly\r\n    }\"\r\n    (click)=\"$event.stopPropagation()\" (mouseenter)=\"onMouseEnter($event)\"\r\n>\r\n    <div class=\"form-control input-container\"\r\n        #popover=\"bs-popover\"\r\n        farrisPopover\r\n        [popover]=\"popValue\"\r\n        [triggers]=\"'hover'\"\r\n        [popActive]=\"isActiveTip\"\r\n        [showAction]=\"'show2'\"\r\n        [container]=\"'body'\"\r\n    >\r\n        <div class=\"sub-input-group\" #prevWrapper>\r\n            <input\r\n                type=\"text\"\r\n                number-only\r\n                [precision]=\"precision\"\r\n                autocomplete=\"off\"\r\n                class=\"sub-input form-control f-state-focus f-state-hover\"\r\n                [(ngModel)]=\"prevValue\"\r\n                #inputPrev\r\n                (blur)=\"onBlur(inputPrev, 'begin')\"\r\n                (focus)=\"onFocus('begin')\"\r\n                (ngModelChange)=\"onModelChange($event, 'begin')\"\r\n                [placeholder]=\"disabled || readonly ?'':beginPlaceHolder\"\r\n                [readOnly]=\"disabled || readonly ? 'readonly' : ''\"\r\n                [style.text-align]=\"textAlign\"\r\n                (keydown)=\"onKeyDownRange($event, 'begin')\"\r\n                (click)=\"onClick($event)\"\r\n            />\r\n            <div\r\n                class=\"input-group-append btn-group btn-group-number sub-btn-group\"\r\n                *ngIf=\"!readonly && !disabled && showButton\"\r\n            >\r\n                <button\r\n                    class=\"btn btn-secondary btn-number-flag btn-number-flag-up\"\r\n                    [style.cursor]=\"isDisableOfBtn('up', prevValue) ? 'pointer' : 'not-allowed'\"\r\n                    (click)=\"up($event, 'begin')\"\r\n                >\r\n                    <span class=\"f-icon f-icon-dropdown number-arrow-chevron\"></span>\r\n                </button>\r\n                <button\r\n                    class=\"btn btn-secondary btn-number-flag  btn-number-flag-down\"\r\n                    [style.cursor]=\"isDisableOfBtn('down', prevValue) ? 'pointer' : 'not-allowed'\"\r\n                    (click)=\"down($event, 'begin')\"\r\n                >\r\n                    <span class=\"f-icon f-icon-dropdown number-arrow-chevron\"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <span class=\"spliter\">~</span>\r\n        <div class=\"sub-input-group\" #nextWrapper>\r\n            <input\r\n                type=\"text\"\r\n                number-only\r\n                [precision]=\"precision\"\r\n                autocomplete=\"off\"\r\n                class=\"sub-input form-control f-state-focus f-state-hover\"\r\n                [(ngModel)]=\"nextValue\"\r\n                #inputNext\r\n                (blur)=\"onBlur(inputNext, 'end')\"\r\n                (focus)=\"onFocus('end')\"\r\n                (ngModelChange)=\"onModelChange($event, 'end')\"\r\n                [placeholder]=\"disabled || readonly ?'':endPlaceHolder\"\r\n                [readOnly]=\"disabled || readonly ? 'readonly' : ''\"\r\n                [style.text-align]=\"textAlign\"\r\n                (keydown)=\"onKeyDownRange($event, 'end')\"\r\n                (click)=\"onClick($event)\"\r\n            />\r\n            <div\r\n                class=\"input-group-append btn-group btn-group-number sub-btn-group\"\r\n                *ngIf=\"!readonly && !disabled  && showButton\"\r\n                [style.text-align]=\"textAlign\"\r\n            >\r\n                <button\r\n                    class=\"btn btn-secondary btn-number-flag\"\r\n                    [style.cursor]=\"isDisableOfBtn('up', nextValue) ? 'pointer' : 'not-allowed'\"\r\n                    (click)=\"up($event, 'end')\"\r\n                >\r\n                    <span class=\"icon k-i-arrow-chevron-up number-arrow-chevron\"></span>\r\n                </button>\r\n                <button\r\n                    class=\"btn btn-secondary btn-number-flag\"\r\n                    [style.cursor]=\"isDisableOfBtn('down', nextValue) ? 'pointer' : 'not-allowed'\"\r\n                    (click)=\"down($event, 'end')\"\r\n                >\r\n                    <span class=\"icon k-i-arrow-chevron-down number-arrow-chevron\"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n",
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return NumberRangeComponent; })),
                            multi: true
                        }
                    ],
                    styles: [".input-group .btn-group-number{height:1.50003rem;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;background-color:#fff}.input-group .btn-group-number .btn-number-flag{height:50%;display:-webkit-box;display:flex;box-shadow:none;padding:0 5px;margin-left:1px;border-left:1px solid #d9d9d9;overflow:hidden;-webkit-transition:.1s linear;transition:.1s linear}.input-group .btn-group-number .btn-number-flag .number-arrow-chevron{-webkit-box-flex:1;flex:1;line-height:1}.input-group .btn-group-number .btn-number-flag:hover{height:60%!important}.input-group .btn-group-number .btn-number-flag:nth-child(2){border-top:1px solid #d9d9d9}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none!important;margin:0}.number-range{position:relative}.number-range .input-container{display:-webkit-box;display:flex;padding:0}.number-range .input-container .sub-input-group{-webkit-box-flex:1;flex:1;position:relative;display:-webkit-box;display:flex;-webkit-transition:.3s ease-out;transition:.3s ease-out}.number-range .input-container .sub-input-group .sub-input{width:100%;border:none;outline:0;background-color:rgba(0,0,0,0);min-width:2px;padding:.125rem 4px .125rem .5rem}.number-range .input-container .spliter{width:15px;text-align:center}"]
                }] }
    ];
    NumberRangeComponent.propDecorators = {
        beginPlaceHolder: [{ type: Input }],
        endPlaceHolder: [{ type: Input }],
        inputPrev: [{ type: ViewChild, args: ['inputPrev',] }],
        inputNext: [{ type: ViewChild, args: ['inputNext',] }],
        prevWrapper: [{ type: ViewChild, args: ['prevWrapper',] }],
        nextWrapper: [{ type: ViewChild, args: ['nextWrapper',] }],
        popover: [{ type: ViewChild, args: ['popover',] }],
        separator: [{ type: Input }],
        beginValue: [{ type: Input }],
        endValue: [{ type: Input }],
        value: [{ type: Input }],
        beginValueChange: [{ type: Output }],
        endValueChange: [{ type: Output }]
    };
    return NumberRangeComponent;
}(NumberSpinnerComponent));
export { NumberRangeComponent };
if (false) {
    /** @type {?} */
    NumberRangeComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    NumberRangeComponent.prototype.endPlaceHolder;
    /** @type {?} */
    NumberRangeComponent.prototype.inputPrev;
    /** @type {?} */
    NumberRangeComponent.prototype.inputNext;
    /** @type {?} */
    NumberRangeComponent.prototype.prevWrapper;
    /** @type {?} */
    NumberRangeComponent.prototype.nextWrapper;
    /** @type {?} */
    NumberRangeComponent.prototype.popover;
    /** @type {?} */
    NumberRangeComponent.prototype.separator;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype.__value;
    /** @type {?} */
    NumberRangeComponent.prototype.beginValueChange;
    /** @type {?} */
    NumberRangeComponent.prototype.endValueChange;
    /** @type {?} */
    NumberRangeComponent.prototype.prevValue;
    /** @type {?} */
    NumberRangeComponent.prototype.nextValue;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype._beginValue;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype._endValue;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype.documentClick;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype.focusState;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtYmVyLXJhbmdlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbnVtYmVyLXNwaW5uZXIvIiwic291cmNlcyI6WyJsaWIvbnVtYmVyLXJhbmdlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFFekMsT0FBTyxFQUNILFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFDckIsU0FBUyxFQUFFLFVBQVUsRUFDcEMsWUFBWSxFQUdmLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRXREO0lBWTBDLGdEQUFzQjtJQVpoRTtRQUFBLHFFQTRVQztRQTlUWSxzQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDdEIsb0JBQWMsR0FBRyxFQUFFLENBQUM7UUFRcEIsZUFBUyxHQUFHLEdBQUcsQ0FBQztRQWNqQixhQUFPLEdBQUcsRUFBRSxDQUFDO1FBWVgsc0JBQWdCLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUN0QyxvQkFBYyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFOUMsZUFBUyxHQUFRLEVBQUUsQ0FBQztRQUNwQixlQUFTLEdBQVEsRUFBRSxDQUFDO1FBRVosaUJBQVcsR0FBRyxFQUFFLENBQUM7UUFDakIsZUFBUyxHQUFHLEVBQUUsQ0FBQztRQW9CZixnQkFBVSxHQUFHO1lBQ2pCLE9BQU8sRUFBRSxLQUFLO1lBQ2QsTUFBTSxFQUFFLEVBQUUsQ0FBSSxjQUFjO1NBQy9CLENBQUM7O1FBMlBGLFlBQVk7SUFFaEIsQ0FBQztJQW5URyxzQkFDSSw0Q0FBVTs7Ozs7UUFEZCxVQUNlLEtBQUs7WUFDaEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDeEQsQ0FBQzs7O09BQUE7SUFFRCxzQkFDSSwwQ0FBUTs7Ozs7UUFEWixVQUNhLEtBQUs7WUFDZCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUN0RCxDQUFDOzs7T0FBQTtJQUdELHNCQUNJLHVDQUFLOzs7O1FBRFQ7WUFFSSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDeEIsQ0FBQzs7Ozs7UUFFRCxVQUFVLENBQU07WUFDWixJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNwQixJQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3JDO1FBQ0wsQ0FBQzs7O09BTkE7SUFnQkQsc0JBQUksNkNBQVc7Ozs7UUFBZjs7Z0JBQ1UsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQztZQUM1RSxJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDakMsT0FBTyxFQUFFLENBQUM7YUFDYjtpQkFBTTtnQkFDSCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDakI7UUFDTCxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDhDQUFZOzs7O1FBQWhCOztnQkFDVSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQzFFLElBQUksSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUNqQyxPQUFPLEVBQUUsQ0FBQzthQUNiO2lCQUFNO2dCQUNILE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNqQjtRQUNMLENBQUM7OztPQUFBOzs7O0lBUUQsdUNBQVE7OztJQUFSO1FBQ0ksaUJBQU0sUUFBUSxXQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFFeEIsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDL0IsQ0FBQzs7OztJQUVELDhDQUFlOzs7SUFBZjtRQUFBLGlCQUtDO1FBSkcsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsT0FBTzs7OztRQUFFLFVBQUEsQ0FBQztZQUN4RCxLQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDaEUsS0FBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7Ozs7SUFFRCwwQ0FBVzs7OztJQUFYLFVBQVksT0FBc0I7UUFDOUIsaUJBQU0sV0FBVyxZQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzNCLElBQUksT0FBTyxDQUFDLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDakQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQzdDO0lBQ0wsQ0FBQzs7OztJQUVELDBDQUFXOzs7SUFBWDtRQUNJLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtZQUNwQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7U0FDeEI7SUFDTCxDQUFDOzs7OztJQUVPLGtEQUFtQjs7OztJQUEzQjtRQUNJLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDeEIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLDJCQUEyQixDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQztTQUN4RztRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3RCLElBQUksQ0FBQyxjQUFjLEdBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMseUJBQXlCLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDO1NBQ3JHO0lBQ0wsQ0FBQzs7Ozs7SUFFTyw0Q0FBYTs7OztJQUFyQjtRQUNJLE9BQU8sSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDakUsQ0FBQzs7Ozs7SUFFTywwQ0FBVzs7OztJQUFuQjtRQUNJLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDN0MsQ0FBQzs7Ozs7SUFDTyw0Q0FBYTs7OztJQUFyQjtRQUNJLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDN0MsQ0FBQzs7Ozs7SUFFRCwyQ0FBWTs7OztJQUFaLFVBQWEsR0FBUTtRQUNqQixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDYixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDM0I7O1lBQ0csRUFBRSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDL0MsSUFBSSxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7O2dCQUNOLFNBQVMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztZQUM5QyxJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFO2dCQUNuQyxPQUFPLElBQUksQ0FBQzthQUNmO2lCQUFNO2dCQUNILEVBQUUsR0FBRyxTQUFTLENBQUM7YUFDbEI7U0FDSjtRQUVELE9BQU8sbUJBQUEsSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsRUFBTyxDQUFDO0lBQ3pDLENBQUM7Ozs7OztJQUVELDRDQUFhOzs7OztJQUFiLFVBQWMsR0FBRyxFQUFFLElBQWE7UUFDNUIsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDO1NBQzFCO2FBQU0sSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDO1NBQ3hCO1FBQ0QsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDbEMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUM3QixDQUFDOzs7OztJQUVELHNDQUFPOzs7O0lBQVAsVUFBUSxNQUFNO1FBQ1YsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQzdCLENBQUM7Ozs7OztJQUVELHFDQUFNOzs7OztJQUFOLFVBQU8sQ0FBTSxFQUFFLElBQVk7UUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFOztnQkFDNUIsUUFBUSxHQUFHLENBQUMsQ0FBQyxLQUFLO1lBQ3hCLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQztZQUNuRCxJQUFJLElBQUksS0FBSyxPQUFPLEVBQUU7O29CQUNaLE9BQU8sR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFOztvQkFDNUIsUUFBUSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDO29CQUNuQyxDQUFDLENBQUMsRUFBRTtvQkFDSixDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7d0JBQ25CLENBQUMsQ0FBQyxRQUFRO3dCQUNWLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ3BELDBDQUEwQztnQkFDMUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ3hFLHVEQUF1RDtnQkFDdkQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7Z0JBQ3BELElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO2FBQ3RDO2lCQUFNOztvQkFDRyxRQUFRLEdBQUcsSUFBSSxDQUFDLGFBQWEsRUFBRTs7b0JBQy9CLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztvQkFDbkMsQ0FBQyxDQUFDLEVBQUU7b0JBQ0osQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDO3dCQUNwQixDQUFDLENBQUMsUUFBUTt3QkFDVixDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFO2dCQUNyRCwwQ0FBMEM7Z0JBQzFDLHFEQUFxRDtnQkFDckQsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ3RFLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO2dCQUNwRCxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQzthQUN0QztTQUNKO1FBRUQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2xDLElBQUksSUFBSSxLQUFLLE9BQU8sRUFBRTtZQUNsQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUNoRDthQUFNO1lBQ0gsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQy9DO1FBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNyQixDQUFDOzs7OztJQUVELHNDQUFPOzs7O0lBQVAsVUFBUSxJQUFhO1FBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNsQyxJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7WUFDbEQsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO2dCQUNsQixJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQztnQkFDdEQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQzNFLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQ2hDO2lCQUFNO2dCQUNILElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO2dCQUNwRCxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDekUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7YUFDOUI7U0FDSjtRQUVELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzFCLENBQUM7Ozs7OztJQUVELDBDQUFXOzs7OztJQUFYLFVBQVksS0FBYSxFQUFFLEdBQVc7O1lBQzlCLE1BQWU7O1lBQ2YsS0FBYztRQUNsQixJQUFJLEtBQUssS0FBSyxPQUFPLEVBQUU7WUFDbkIsTUFBTSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDO1lBQ3hDLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQztTQUMxQzthQUFNO1lBQ0gsTUFBTSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDO1lBQ3hDLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQztTQUMxQztRQUNPLElBQUEsNENBQUs7UUFDYixJQUFJLEtBQUssR0FBRyxHQUFHLEVBQUU7WUFDYixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQzFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDMUM7SUFDTCxDQUFDOzs7OztJQUVELDJDQUFZOzs7O0lBQVosVUFBYSxLQUFLO1FBQ2QsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDeEMsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbEMsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1NBQ3pEO2FBQU07WUFDSCxJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztTQUN0QjtJQUNMLENBQUM7Ozs7SUFFRCw0Q0FBYTs7O0lBQWI7UUFDWSxJQUFBLDJEQUFLO1FBQ2IsSUFBSSxLQUFLLElBQUksS0FBSyxHQUFHLEdBQUcsRUFBRTtZQUN0QixPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQzs7Ozs7O0lBRUQsNkNBQWM7Ozs7O0lBQWQsVUFBZSxNQUFxQixFQUFFLEdBQWtCO1FBQ3BELElBQUksTUFBTSxDQUFDLEdBQUcsS0FBSyxXQUFXLEVBQUU7WUFDNUIsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQzFCO1FBRUQsSUFBSSxNQUFNLENBQUMsR0FBRyxLQUFLLFNBQVMsRUFBRTtZQUMxQixNQUFNLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDeEI7UUFFRCxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDN0IsQ0FBQzs7Ozs7SUFFRCx5Q0FBVTs7OztJQUFWLFVBQVcsR0FBUTtRQUNmLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdkIsQ0FBQzs7Ozs7SUFFRCx1Q0FBUTs7OztJQUFSLFVBQVMsR0FBUTtRQUNiLElBQUksT0FBTyxHQUFHLEtBQUssUUFBUSxFQUFFOztnQkFDbkIsTUFBTSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUN4QyxJQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDOUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1NBQy9DO2FBQU07WUFDSCxJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztZQUN0QixJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztTQUN6QjtRQUNELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDL0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBR0Qsd0JBQXdCOzs7Ozs7O0lBQ3hCLGlDQUFFOzs7Ozs7O0lBQUYsVUFBRyxDQUFRLEVBQUUsSUFBWTtRQUNyQixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsbUJBQUEsQ0FBQyxDQUFDLE1BQU0sRUFBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdkQsQ0FBQzs7Ozs7O0lBRUQsbUNBQUk7Ozs7O0lBQUosVUFBSyxDQUFRLEVBQUUsSUFBWTtRQUN2QixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsbUJBQUEsQ0FBQyxDQUFDLE1BQU0sRUFBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDekQsQ0FBQzs7Ozs7Ozs7SUFFTyx1Q0FBUTs7Ozs7OztJQUFoQixVQUFpQixJQUFZLEVBQUUsR0FBa0IsRUFBRSxNQUFNOztZQUMvQyxDQUFDLEdBQUcsR0FBRyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPO1FBQ3pDLElBQUksSUFBSSxLQUFLLE9BQU8sSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUU7O2dCQUN4RCxFQUFFLEdBQUcsTUFBTSxJQUFJLENBQUM7O2dCQUNoQixFQUFFLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDOztnQkFDdEMsQ0FBQyxHQUFHLElBQUksU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7O2dCQUM3QyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRTs7Z0JBQ2IsUUFBUSxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUNyQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUU7Z0JBQ3RDLENBQUMsR0FBRyxFQUFFLENBQUM7YUFDVjtZQUNELElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDO1lBQ3JCLG1DQUFtQztZQUNuQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQ3ZDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzVCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDakM7YUFBTSxJQUFJLElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFOztnQkFDN0QsRUFBRSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQzs7Z0JBQ3RDLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQzs7Z0JBQ2hCLENBQUMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDOztnQkFDN0MsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUU7O2dCQUNiLFFBQVEsR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFO2dCQUN0QyxDQUFDLEdBQUcsRUFBRSxDQUFDO2FBQ1Y7WUFDRCxJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztZQUNuQixtQ0FBbUM7WUFDbkMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUN2QyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUM1QixJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMvQjtRQUNELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM5QixDQUFDOztnQkF4VUosU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxxQkFBcUI7b0JBQy9CLDg4SUFBNEM7b0JBRTVDLFNBQVMsRUFBRTt3QkFDUDs0QkFDSSxPQUFPLEVBQUUsaUJBQWlCOzRCQUMxQixXQUFXLEVBQUUsVUFBVTs7OzRCQUFDLGNBQU0sT0FBQSxvQkFBb0IsRUFBcEIsQ0FBb0IsRUFBQzs0QkFDbkQsS0FBSyxFQUFFLElBQUk7eUJBQ2Q7cUJBQ0o7O2lCQUNKOzs7bUNBR0ksS0FBSztpQ0FDTCxLQUFLOzRCQUVMLFNBQVMsU0FBQyxXQUFXOzRCQUNyQixTQUFTLFNBQUMsV0FBVzs4QkFDckIsU0FBUyxTQUFDLGFBQWE7OEJBQ3ZCLFNBQVMsU0FBQyxhQUFhOzBCQUN2QixTQUFTLFNBQUMsU0FBUzs0QkFFbkIsS0FBSzs2QkFFTCxLQUFLOzJCQU1MLEtBQUs7d0JBT0wsS0FBSzttQ0FXTCxNQUFNO2lDQUNOLE1BQU07O0lBMFJYLDJCQUFDO0NBQUEsQUE1VUQsQ0FZMEMsc0JBQXNCLEdBZ1UvRDtTQWhVWSxvQkFBb0I7OztJQUU3QixnREFBK0I7O0lBQy9CLDhDQUE2Qjs7SUFFN0IseUNBQThDOztJQUM5Qyx5Q0FBOEM7O0lBQzlDLDJDQUFrRDs7SUFDbEQsMkNBQWtEOztJQUNsRCx1Q0FBZ0Q7O0lBRWhELHlDQUF5Qjs7Ozs7SUFjekIsdUNBQXFCOztJQVlyQixnREFBZ0Q7O0lBQ2hELDhDQUE4Qzs7SUFFOUMseUNBQW9COztJQUNwQix5Q0FBb0I7Ozs7O0lBRXBCLDJDQUF5Qjs7Ozs7SUFDekIseUNBQXVCOzs7OztJQW1CdkIsNkNBQXNCOzs7OztJQUN0QiwwQ0FHRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gJ2JpZ251bWJlci5qcyc7XHJcblxyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBmb3J3YXJkUmVmLCBJbnB1dCwgT3V0cHV0LFxyXG4gICAgQWZ0ZXJWaWV3SW5pdCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBPbkRlc3Ryb3ksIFNpbXBsZUNoYW5nZXMsXHJcbiAgICBFdmVudEVtaXR0ZXIsXHJcbiAgICBPbkluaXQsXHJcbiAgICBPbkNoYW5nZXNcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IE51bWJlclNwaW5uZXJDb21wb25lbnQgfSBmcm9tICcuL251bWJlci1zcGlubmVyLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFBvcG92ZXJEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLXBvcG92ZXInO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy1udW1iZXItcmFuZ2UnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL251bWJlci1yYW5nZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9udW1iZXIuY29tcG9uZW50LnNjc3MnXSxcclxuICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IE51bWJlclJhbmdlQ29tcG9uZW50KSxcclxuICAgICAgICAgICAgbXVsdGk6IHRydWVcclxuICAgICAgICB9XHJcbiAgICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOdW1iZXJSYW5nZUNvbXBvbmVudCBleHRlbmRzIE51bWJlclNwaW5uZXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgICBASW5wdXQoKSBiZWdpblBsYWNlSG9sZGVyID0gJyc7XHJcbiAgICBASW5wdXQoKSBlbmRQbGFjZUhvbGRlciA9ICcnO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0UHJldicpIGlucHV0UHJldjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0TmV4dCcpIGlucHV0TmV4dDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3ByZXZXcmFwcGVyJykgcHJldldyYXBwZXI6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCduZXh0V3JhcHBlcicpIG5leHRXcmFwcGVyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgncG9wb3ZlcicpIHBvcG92ZXI6IFBvcG92ZXJEaXJlY3RpdmU7XHJcblxyXG4gICAgQElucHV0KCkgc2VwYXJhdG9yID0gJ34nO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgYmVnaW5WYWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMucHJldlZhbHVlID0gdGhpcy5mb3JtYXQodmFsdWUpO1xyXG4gICAgICAgIHRoaXMuX2JlZ2luVmFsdWUgPSB0aGlzLmlzRW1wdHkodmFsdWUpID8gJycgOiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGVuZFZhbHVlKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5uZXh0VmFsdWUgPSB0aGlzLmZvcm1hdCh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5fZW5kVmFsdWUgPSB0aGlzLmlzRW1wdHkodmFsdWUpID8gJycgOiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9fdmFsdWUgPSAnJztcclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgdmFsdWUoKTogYW55IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fX3ZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB2YWx1ZSh2OiBhbnkpIHtcclxuICAgICAgICBpZiAodiAhPT0gdGhpcy5fX3ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX192YWx1ZSA9IHYgPT09ICd+JyA/ICcnIDogdjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgQE91dHB1dCgpIGJlZ2luVmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgZW5kVmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHJldlZhbHVlOiBhbnkgPSAnJztcclxuICAgIG5leHRWYWx1ZTogYW55ID0gJyc7XHJcblxyXG4gICAgcHJpdmF0ZSBfYmVnaW5WYWx1ZSA9ICcnO1xyXG4gICAgcHJpdmF0ZSBfZW5kVmFsdWUgPSAnJztcclxuICAgIGdldCBwcmVOdW1WYWx1ZSgpIHtcclxuICAgICAgICBjb25zdCB2ID0gdGhpcy5nZXRSZWFsVmFsdWUodGhpcy5wYXJzZXIgPyB0aGlzLnByZXZWYWx1ZSA6IHRoaXMuX2JlZ2luVmFsdWUpO1xyXG4gICAgICAgIGlmICh0aGlzLmNhbk51bGwgJiYgdGhpcy5pc0VtcHR5KHYpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdiB8fCAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgbmV4dE51bVZhbHVlKCkge1xyXG4gICAgICAgIGNvbnN0IHYgPSB0aGlzLmdldFJlYWxWYWx1ZSh0aGlzLnBhcnNlciA/IHRoaXMubmV4dFZhbHVlIDogdGhpcy5fZW5kVmFsdWUpO1xyXG4gICAgICAgIGlmICh0aGlzLmNhbk51bGwgJiYgdGhpcy5pc0VtcHR5KHYpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdiB8fCAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRvY3VtZW50Q2xpY2s7XHJcbiAgICBwcml2YXRlIGZvY3VzU3RhdGUgPSB7XHJcbiAgICAgICAgaXNGb2N1czogZmFsc2UsXHJcbiAgICAgICAgdGFyZ2V0OiAnJyAgICAvLyBiZWdpbiB8IGVuZFxyXG4gICAgfTtcclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBzdXBlci5uZ09uSW5pdCgpO1xyXG4gICAgICAgIHRoaXMuc2hvd0J1dHRvbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRQbGFjZUhvbGRlckluZm8oKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENsaWNrID0gdGhpcy5yZW5kZXIubGlzdGVuKGRvY3VtZW50LCAnY2xpY2snLCBlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5wcmV2V3JhcHBlci5uYXRpdmVFbGVtZW50LCAnZmxleCcsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLm5leHRXcmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdmbGV4JywgMSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgIHN1cGVyLm5nT25DaGFuZ2VzKGNoYW5nZXMpO1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLnZhbHVlICYmICFjaGFuZ2VzLnZhbHVlLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFZhbHVlKGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRDbGljaykge1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50Q2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0UGxhY2VIb2xkZXJJbmZvKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5iZWdpblBsYWNlSG9sZGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVnaW5QbGFjZUhvbGRlciA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbnVtYmVyU3Bpbm5lci5yYW5nZS5iZWdpbicpIHx8IHRoaXMucGxhY2Vob2xkZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5lbmRQbGFjZUhvbGRlcikge1xyXG4gICAgICAgICAgICB0aGlzLmVuZFBsYWNlSG9sZGVyID0gIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbnVtYmVyU3Bpbm5lci5yYW5nZS5lbmQnKSB8fCB0aGlzLnBsYWNlaG9sZGVyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJhbmdlVmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJlTnVtVmFsdWUgKyB0aGlzLnNlcGFyYXRvciArIHRoaXMubmV4dE51bVZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RW5kVmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVhbFZhbHVlKHRoaXMubmV4dFZhbHVlKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0QmVnaW5WYWx1ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZWFsVmFsdWUodGhpcy5wcmV2VmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFJlYWxWYWx1ZSh2YWw6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhcnNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZXIodmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IF9uID0gdGhpcy52YWxpZEludGVydmFsKG5ldyBCaWdOdW1iZXIodmFsKSk7XHJcbiAgICAgICAgaWYgKF9uLmlzTmFOKCkpIHtcclxuICAgICAgICAgICAgY29uc3QgbWluQmlnTnVtID0gbmV3IEJpZ051bWJlcignJyArIHRoaXMubWluKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FuTnVsbCB8fCBtaW5CaWdOdW0uaXNOYU4oKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfbiA9IG1pbkJpZ051bTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJlYWxWYWx1ZShfbikgYXMgYW55O1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW9kZWxDaGFuZ2UodmFsLCB0eXBlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdiZWdpbicpIHtcclxuICAgICAgICAgICAgdGhpcy5fYmVnaW5WYWx1ZSA9IHZhbDtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdlbmQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VuZFZhbHVlID0gdmFsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5nZXRSYW5nZVZhbHVlKCk7XHJcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHRoaXMudmFsdWUpO1xyXG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsaWNrKCRldmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkJsdXIoZTogYW55LCB0eXBlOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoIXRoaXMucmVhZG9ubHkgJiYgIXRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdG1wVmFsdWUgPSBlLnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLmZvY3VzU3RhdGUgPSB7IGlzRm9jdXM6IGZhbHNlLCB0YXJnZXQ6IHR5cGUgfTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdiZWdpbicpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRWYWwgPSB0aGlzLmdldEVuZFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaW5WYWx1ZSA9IHRoaXMuaXNFbXB0eSh0bXBWYWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICA/ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLmlzRW1wdHkobmV4dFZhbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyB0bXBWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IEJpZ051bWJlci5taW4odG1wVmFsdWUsIG5leHRWYWwpLnRvRml4ZWQoKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMucHJldlZhbHVlID0gdGhpcy5mb3JtYXQobWluVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iZWdpblZhbHVlID0gdGhpcy52YWxpZEludGVydmFsKG5ldyBCaWdOdW1iZXIobWluVmFsdWUpKS50b0ZpeGVkKCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmJlZ2luVmFsdWUgPSB0aGlzLmdldFJlYWxWYWx1ZSh0aGlzLnByZXZWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0UHJldi5uYXRpdmVFbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2VmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uTW9kZWxDaGFuZ2UobWluVmFsdWUsIHR5cGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmVnaW5WYWwgPSB0aGlzLmdldEJlZ2luVmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1heFZhbHVlID0gdGhpcy5pc0VtcHR5KHRtcFZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgID8gJydcclxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMuaXNFbXB0eShiZWdpblZhbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyB0bXBWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IEJpZ051bWJlci5tYXgodG1wVmFsdWUsIGJlZ2luVmFsKS50b0ZpeGVkKCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLm5leHRWYWx1ZSA9IHRoaXMuZm9ybWF0KG1heFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZW5kVmFsdWUgPSB0aGlzLmdldFJlYWxWYWx1ZSh0aGlzLm5leHRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVuZFZhbHVlID0gdGhpcy52YWxpZEludGVydmFsKG5ldyBCaWdOdW1iZXIobWF4VmFsdWUpKS50b0ZpeGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0TmV4dC5uYXRpdmVFbGVtZW50LnZhbHVlID0gdGhpcy5uZXh0VmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uTW9kZWxDaGFuZ2UobWF4VmFsdWUsIHR5cGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQodGhpcy52YWx1ZSk7XHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdiZWdpbicpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWdpblZhbHVlQ2hhbmdlLmVtaXQodGhpcy5wcmVOdW1WYWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbmRWYWx1ZUNoYW5nZS5lbWl0KHRoaXMubmV4dE51bVZhbHVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYmx1ci5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Gb2N1cyh0eXBlPzogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnJlYWRvbmx5ICYmICF0aGlzLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9jdXNTdGF0ZSA9IHsgaXNGb2N1czogdHJ1ZSwgdGFyZ2V0OiB0eXBlIH07XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnYmVnaW4nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0UHJldi5uYXRpdmVFbGVtZW50LnZhbHVlID0gdGhpcy5fYmVnaW5WYWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRQcmV2Lm5hdGl2ZUVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgdGhpcy5fYmVnaW5WYWx1ZS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBlbmRXaWR0aCgnYmVnaW4nLCAzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXROZXh0Lm5hdGl2ZUVsZW1lbnQudmFsdWUgPSB0aGlzLl9lbmRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXROZXh0Lm5hdGl2ZUVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgdGhpcy5fZW5kVmFsdWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhwZW5kV2lkdGgoJ2VuZCcsIDMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmZvY3VzLmVtaXQodHlwZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZXhwZW5kV2lkdGgod2hpY2g6IHN0cmluZywgbnVtOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQgdGFyZ2V0OiBFbGVtZW50O1xyXG4gICAgICAgIGxldCBvdGhlcjogRWxlbWVudDtcclxuICAgICAgICBpZiAod2hpY2ggPT09ICdiZWdpbicpIHtcclxuICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy5wcmV2V3JhcHBlci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICBvdGhlciA9IHRoaXMubmV4dFdyYXBwZXIubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0YXJnZXQgPSB0aGlzLm5leHRXcmFwcGVyLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIG90aGVyID0gdGhpcy5wcmV2V3JhcHBlci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IHdpZHRoIH0gPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgaWYgKHdpZHRoIDwgMTUwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRhcmdldCwgJ2ZsZXgnLCBudW0pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZShvdGhlciwgJ2ZsZXgnLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZUVudGVyKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5pc0FjdGl2ZVRpcCA9IHRoaXMuaXNTaG93UG9wb3ZlcigpO1xyXG4gICAgICAgIGlmICh0aGlzLm5leHRWYWx1ZSAmJiB0aGlzLnByZXZWYWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnBvcFZhbHVlID0gdGhpcy5wcmV2VmFsdWUgKyAnficgKyB0aGlzLm5leHRWYWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBvcFZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzU2hvd1BvcG92ZXIoKSB7XHJcbiAgICAgICAgY29uc3QgeyB3aWR0aCB9ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIGlmICh3aWR0aCAmJiB3aWR0aCA8IDIwMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uS2V5RG93blJhbmdlKCRldmVudDogS2V5Ym9hcmRFdmVudCwgdHlwOiAnYmVnaW4nfCdlbmQnKSB7XHJcbiAgICAgICAgaWYgKCRldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nKSB7XHJcbiAgICAgICAgICAgICRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLmRvd24oJGV2ZW50LCB0eXApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCRldmVudC5rZXkgPT09ICdBcnJvd1VwJykge1xyXG4gICAgICAgICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy51cCgkZXZlbnQsIHR5cCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgd3JpdGVWYWx1ZSh2YWw6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2V0VmFsdWUodmFsKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZSh2YWw6IGFueSkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBjb25zdCB2YWxBcnIgPSB2YWwuc3BsaXQodGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLl9iZWdpblZhbHVlID0gdmFsQXJyWzBdID8gdmFsQXJyWzBdIDogJyc7XHJcbiAgICAgICAgICAgIHRoaXMuX2VuZFZhbHVlID0gdmFsQXJyWzFdID8gdmFsQXJyWzFdIDogJyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYmVnaW5WYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLl9iZWdpblZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJldlZhbHVlID0gdGhpcy5mb3JtYXQodGhpcy5fYmVnaW5WYWx1ZSk7XHJcbiAgICAgICAgdGhpcy5uZXh0VmFsdWUgPSB0aGlzLmZvcm1hdCh0aGlzLl9lbmRWYWx1ZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vI3JlZ2lvbiDkuIrkuIvmk43kvZzmjInpkq4g5oiWIOS4iuS4i+aWueWQkemUrlxyXG4gICAgdXAoZTogRXZlbnQsIHR5cGU6IHN0cmluZykge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5fY29tcHV0ZSh0eXBlLCAndXAnLCAoZS50YXJnZXQgYXMgYW55KS52YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZG93bihlOiBFdmVudCwgdHlwZTogc3RyaW5nKSB7XHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLl9jb21wdXRlKHR5cGUsICdkb3duJywgKGUudGFyZ2V0IGFzIGFueSkudmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2NvbXB1dGUodHlwZTogc3RyaW5nLCBkaXI6ICd1cCcgfCAnZG93bicsIHRhZ1ZhbCkge1xyXG4gICAgICAgIGNvbnN0IG0gPSBkaXIgPT09ICd1cCcgPyAncGx1cycgOiAnbWludXMnO1xyXG4gICAgICAgIGlmICh0eXBlID09PSAnYmVnaW4nICYmIHRoaXMuaXNEaXNhYmxlT2ZCdG4oZGlyLCB0aGlzLnByZXZWYWx1ZSkpIHtcclxuICAgICAgICAgICAgY29uc3QgYnYgPSB0YWdWYWwgfHwgMDtcclxuICAgICAgICAgICAgY29uc3QgZXYgPSB0aGlzLmdldFJlYWxWYWx1ZSh0aGlzLm5leHRWYWx1ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgQmlnTnVtYmVyKGJ2KVttXShOdW1iZXIodGhpcy5zdGVwKSk7XHJcbiAgICAgICAgICAgIGxldCB2ID0gci50b0ZpeGVkKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1pblZhbHVlID0gQmlnTnVtYmVyLm1pbih2LCBldik7XHJcbiAgICAgICAgICAgIGlmICghbWluVmFsdWUuZXEodikgJiYgIXRoaXMuaXNFbXB0eShldikpIHtcclxuICAgICAgICAgICAgICAgIHYgPSBldjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9iZWdpblZhbHVlID0gdjtcclxuICAgICAgICAgICAgLy8gdGhpcy5wcmV2VmFsdWUgPSB0aGlzLmZvcm1hdCh2KTtcclxuICAgICAgICAgICAgdGhpcy5pbnB1dFByZXYubmF0aXZlRWxlbWVudC52YWx1ZSA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMub25Nb2RlbENoYW5nZSh2LCB0eXBlKTtcclxuICAgICAgICAgICAgdGhpcy5iZWdpblZhbHVlQ2hhbmdlLmVtaXQodik7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnZW5kJyAmJiB0aGlzLmlzRGlzYWJsZU9mQnRuKGRpciwgdGhpcy5uZXh0VmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ2ID0gdGhpcy5nZXRSZWFsVmFsdWUodGhpcy5wcmV2VmFsdWUpO1xyXG4gICAgICAgICAgICBjb25zdCBldiA9IHRhZ1ZhbCB8fCAwO1xyXG4gICAgICAgICAgICBjb25zdCByID0gbmV3IEJpZ051bWJlcihldilbbV0oTnVtYmVyKHRoaXMuc3RlcCkpO1xyXG4gICAgICAgICAgICBsZXQgdiA9IHIudG9GaXhlZCgpO1xyXG4gICAgICAgICAgICBjb25zdCBtYXhWYWx1ZSA9IEJpZ051bWJlci5tYXgoYnYsIHYpO1xyXG4gICAgICAgICAgICBpZiAoIW1heFZhbHVlLmVxKHYpICYmICF0aGlzLmlzRW1wdHkoYnYpKSB7XHJcbiAgICAgICAgICAgICAgICB2ID0gYnY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fZW5kVmFsdWUgPSB2O1xyXG4gICAgICAgICAgICAvLyB0aGlzLm5leHRWYWx1ZSA9IHRoaXMuZm9ybWF0KHYpO1xyXG4gICAgICAgICAgICB0aGlzLmlucHV0TmV4dC5uYXRpdmVFbGVtZW50LnZhbHVlID0gdjtcclxuICAgICAgICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlKHYsIHR5cGUpO1xyXG4gICAgICAgICAgICB0aGlzLmVuZFZhbHVlQ2hhbmdlLmVtaXQodik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh0aGlzLnZhbHVlKTtcclxuICAgICAgICB0aGlzLmV4cGVuZFdpZHRoKHR5cGUsIDMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxufVxyXG4iXX0=