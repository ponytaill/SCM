/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { NotifyService } from '@farris/ui-notify';
import { Input, Output, EventEmitter, ElementRef, ChangeDetectorRef, Renderer2, ViewChild, Inject, Injector, NgZone } from '@angular/core';
import { Subject, interval, of, fromEvent } from 'rxjs';
import { NgControl } from '@angular/forms';
import { DOCUMENT } from '@angular/common';
import { takeUntil, filter, skip, debounceTime, throttle, take, throwIfEmpty } from 'rxjs/operators';
import { ComboService } from './combo.service';
import { InputGroupComponent } from '@farris/ui-input-group';
import { ComboLocaleService } from './services/combo.locale.service';
import { CommonUtils, reqAnimFrame } from '@farris/ui-common';
import { EventManager } from '@angular/platform-browser';
import ResizeObserver from 'resize-observer-polyfill';
/** @type {?} */
let nextUniqueId = 0;
export class BaseComboComponent {
    /**
     * @param {?} el
     * @param {?} cdr
     * @param {?} document
     * @param {?} render
     * @param {?} comboService
     * @param {?} injector
     */
    constructor(el, cdr, document, render, comboService, injector) {
        this.el = el;
        this.cdr = cdr;
        this.document = document;
        this.render = render;
        this.comboService = comboService;
        this.injector = injector;
        this.disabled = false;
        this.readonly = false;
        this.editable = true;
        this.placeholder = '';
        this.panelWidth = 300;
        this.panelHeight = 'auto';
        this.autoWidth = true;
        this.enableClear = true;
        /**
         * 禁用只读时显示 placeholder
         */
        this.forcePlaceholder = false;
        /**
         * 任意输入 20210202
         */
        this.nosearch = false;
        // 鼠标滑过显示文本内容
        this.enableTitle = true;
        /**
         * 展示类型： text文本，tag标签。 默认 text
         */
        this.viewType = 'text';
        this.displayText = '';
        this.maxHeight = 200;
        this.enableCancelSelected = false;
        // 如果面板已打开， 点击清空按钮时是否关闭面板。true: 关闭； false: 不关闭；
        this.hidePanelOnClear = false;
        /**
         * 开启后，ngModel 的值为 valueField or  idField; 否则为textField的值
         */
        this.useValue = false;
        this.separator = ',';
        this.showPanel = new EventEmitter();
        this.hidePanel = new EventEmitter();
        this.clear = new EventEmitter();
        this.valueChange = new EventEmitter();
        this.selectChange = new EventEmitter();
        this.isOpen = false;
        this.comPosition = {};
        this.destroy$ = new Subject();
        this.ngControl = null;
        this.groupIcon = '<span class="f-icon f-icon-arrow-60-down"></span>';
        this._cmbPanel = null;
        this._comboPanelCreated$ = new Subject();
        // private _hasPosited = false;
        // private _container: Element;
        this.willHide$ = new Subject();
        this.panelListener = null;
        this.ngZone = null;
        this.mouseWheelEvent = null;
        this.textChangeSubject = new Subject();
        this.initdataSubscription = null;
        this.customData = null;
        this.originalText = '';
        this.isTextChange = false;
        this.treeClientSearch = new Subject();
        this.ro = null;
        this.onChange = (/**
         * @return {?}
         */
        () => null);
        this.onTouched = (/**
         * @return {?}
         */
        () => null);
        this.initToggleAction();
        this.initSelectionsChangeAction();
        this.initDatasChangeAction();
        this.commonUtils = this.injector.get(CommonUtils, null);
        this.willHide$.pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        e => {
            if (!this.nosearch && this.displayText !== this.originalText) {
                this.displayText = this.originalText;
                if (this.isLookup()) {
                    this.onChange(this.displayText);
                }
                else {
                    /** @type {?} */
                    const _displayText = this.comboService.getValue(this.textField);
                    this.onValueChange({ text: _displayText, value: this.selectedValues, selections: this.selections });
                }
            }
            this.onTouched();
            this.hidePanel.emit(this);
        }));
        this.ngZone = this.injector.get(NgZone);
        this.eventMgr = this.injector.get(EventManager);
        this.emitTextChange();
        this.notifySer = this.injector.get(NotifyService, null);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set context(value) {
        this.comboService.context = value;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set mappingField(v) {
        this.mapFields = v;
    }
    /**
     * @return {?}
     */
    get mappingField() {
        return this.mapFields;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set data(val) {
        this.comboService.data = val;
    }
    /**
     * @return {?}
     */
    get data() {
        return this.comboService.data;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set idField(val) {
        this.comboService.idField = val;
    }
    /**
     * @return {?}
     */
    get idField() {
        return this.comboService.idField;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set valueField(val) {
        this.comboService.valueField = val;
    }
    /**
     * @return {?}
     */
    get valueField() {
        return this.comboService.valueField ? this.comboService.valueField : this.idField;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set textField(val) {
        this.comboService.textField = val;
    }
    /**
     * @return {?}
     */
    get textField() {
        return this.comboService.textField;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set multiSelect(val) {
        this.comboService.multiSelect = val;
    }
    /**
     * @return {?}
     */
    get multiSelect() {
        return this.comboService.multiSelect;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set uri(val) {
        this.comboService.uri = val;
    }
    /**
     * @return {?}
     */
    get uri() {
        return this.comboService.uri;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set selectedValues(val) {
        this.comboService.selectedValues = val;
    }
    /**
     * @return {?}
     */
    get selectedValues() {
        return this.comboService.selectedValues;
    }
    /**
     * @return {?}
     */
    get selectedValuesStr() {
        if (this.selectedValues === null || this.selectedValues === undefined) {
            this.selectedValues = '';
        }
        return (this.selectedValues) + '';
    }
    /**
     * 远端过滤
     * @return {?}
     */
    get remoteSearch() {
        return this.comboService.remoteSearch;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set remoteSearch(val) {
        this.comboService.remoteSearch = val;
    }
    /**
     * @param {?} cmp
     * @return {?}
     */
    set cmbPanel(cmp) {
        if (cmp) {
            this._cmbPanel = cmp;
            this.ro.observe(cmp.nativeElement);
            this._comboPanelCreated$.next(cmp);
        }
        else {
            this._cmbPanel = null;
            // this.ro.unobserve(this.el.nativeElement);
            if (this.ro) {
                this.ro.disconnect();
            }
            this._comboPanelCreated$.next(null);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set selections(value) {
        this.comboService.selections = value;
    }
    /**
     * @return {?}
     */
    get selections() {
        if (this.comboService.selections) {
            return this.comboService.selections.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n !== null && n !== undefined));
        }
        return [];
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.localeService = this.injector.get(ComboLocaleService, '');
        if (this.localeService) {
            /** @type {?} */
            const localConfig = this.localeService.getLocaleConfig();
            if (localConfig) {
                if (!this.placeholder) {
                    this.placeholder = localConfig['placeholder'] || '请选择';
                }
            }
        }
        this.comboService.separator = this.separator;
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        /** @type {?} */
        const that = this;
        this.ngControl = this.injector.get(NgControl, null);
        fromEvent(window, 'resize').pipe(takeUntil(this.destroy$)).pipe(debounceTime(100), throttle((/**
         * @param {?} ev
         * @return {?}
         */
        ev => interval(100)))).subscribe((/**
         * @return {?}
         */
        () => {
            this.updatePanelWidth();
            if (this.isOpen) {
                this.comboService.isOpen$.next(false);
                this.willHide$.next();
            }
        }));
        if (this.ngZone) {
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            () => {
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    that.updatePanelWidth();
                }));
            }));
            /** @type {?} */
            let reszieTimer = null;
            this.ro = new ResizeObserver((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                () => {
                    if (reszieTimer) {
                        clearTimeout(reszieTimer);
                    }
                    reszieTimer = setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        if (that._cmbPanel && that.panelElement) {
                            reqAnimFrame((/**
                             * @return {?}
                             */
                            () => {
                                that.updatePosition(that._cmbPanel.nativeElement);
                                if (that._cmbPanel.nativeElement.className.indexOf('f-area-show') === -1) {
                                    that.render.addClass(that._cmbPanel.nativeElement, 'f-area-show');
                                }
                            }));
                        }
                    }), 10);
                }));
            }));
        }
        this.comboService.injectService();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
        this.comboService.serachValue$.unsubscribe();
        if (this.mouseWheelEvent) {
            this.mouseWheelEvent();
        }
    }
    /**
     * @private
     * @return {?}
     */
    updatePanelWidth() {
        const { width } = this.getInputSizeInfo();
        this.panelWidth = this.autoWidth ? width : this.panelWidth;
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    onClick($event = null) {
        if ($event) {
            if ($event.stopPropagation) {
                $event.stopPropagation();
            }
            else {
                if ($event.originalEvent) {
                    $event.originalEvent.stopPropagation();
                }
            }
        }
        // 重复执行面板关闭事件 故注释掉 20220917
        // if (this.isOpen) {
        //     this.willHide$.next();
        // } else {
        //     this.comboService.isOpen$.next(!this.isOpen);
        // }
        this.comboService.isOpen$.next(!this.isOpen);
        if (this.input && this.input.textbox) {
            this.input.textbox.nativeElement.focus();
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onBlur(event) {
        this.onTouched();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onFocus(event) {
        // // 启用任意输入后，文本框得到焦点后不弹出下拉面板。2021/02/19
        // if (this.nosearch) {
        //     return ;
        // }
        // if (!this.isOpen) {
        //     this.comboService.isOpen$.next(true);
        //     // 延迟执行变更检测 更新弹出框位置
        // of('').pipe(debounceTime(0)).subscribe(() => {
        //     this.cdr.detectChanges();
        // });
        // } else {
        //     this.hide();
        // }
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    onInputclick($event) {
        if ($event && $event.stopPropagation) {
            $event.stopPropagation();
        }
        this.comboService.isOpen$.next(!this.isOpen);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onEnter(event) { }
    /**
     * @return {?}
     */
    blur() {
        this.input.textbox.nativeElement.blur();
    }
    /**
     * @return {?}
     */
    focus() {
        this.input.textbox.nativeElement.focus();
    }
    /**
     * @return {?}
     */
    onClear() {
        this.selectedValues = '';
        this.selections = [];
        this.onValueChange({ text: '', value: '', selections: [] });
        this.clear.emit();
        if (this.isOpen && this.hidePanelOnClear) {
            // this.comboService.isOpen$.next(false);
            this.willHide$.next();
        }
    }
    /**
     * @private
     * @return {?}
     */
    getInputSizeInfo() {
        /** @type {?} */
        const el = this.viewType === 'text' ? this.input.inputGroup : this.input2;
        return el.nativeElement.getBoundingClientRect();
    }
    /**
     * @private
     * @return {?}
     */
    emitTextChange() {
        return this.textChangeSubject.pipe(debounceTime(200)).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        (r) => {
            /** @type {?} */
            const _selectedValues = this.selectedValues;
            /** @type {?} */
            const val = r ? r : this.displayText;
            if (r === '') {
                this.onClear();
            }
            else if (this.nosearch) {
                this.onValueChange({ text: r, value: '', selections: this.selections, nosearch: true });
            }
            if (!this.remoteSearch) {
                if (!this.multiSelect) {
                    if (this.comboService.displayType === 'LOOKUPTREELIST') {
                        this.treeClientSearch.next(val);
                    }
                    else {
                        this.comboService.serachValue$.next(val);
                    }
                }
                else {
                    /** @type {?} */
                    const valArr = (val + '').split(this.separator);
                    /** @type {?} */
                    const appendVal = valArr[valArr.length - 1] ? valArr[valArr.length - 1] : '';
                    this.comboService.serachValue$.next(appendVal);
                }
                // if (_selectedValues !== this.selectedValues) {
                //     this.onValueChange({ text: this.displayText, value: this.selectedValues, selections: this.selections });
                // }
            }
            else {
                this.filterDataOnServer(val, '*');
            }
        }));
    }
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    __createPanel(value) {
        /** @type {?} */
        let params = {};
        /** @type {?} */
        let method = 'get';
        if (value instanceof Object) {
            const { params: _p, data, method: _m, showDialog } = value;
            if (showDialog === false) {
                return;
            }
            if (data) {
                params = { data };
                this.customData = data;
            }
            else {
                if (_p) {
                    params = { data: _p };
                    this.customData = _p;
                }
                else {
                    this.customData = null;
                }
            }
            if (_m) {
                method = _m;
            }
        }
        else if (typeof value === 'boolean') {
            if (value === false) {
                return;
            }
        }
        this.initCreatPanelAction();
        if (this.uri) {
            this.updateSelectedValues();
            if (this.isLookup()) {
                this.isOpen = true;
            }
        }
        else {
            this.isOpen = true;
        }
        if (this.comboService.displayType === 'LOOKUPTREELIST') {
            params.enableFullTree = this['enableFullTree'];
            params.loadTreeDataType = this['loadTreeDataType'];
        }
        if (this.isLookup() && this.input && this.nosearch) {
            this.input.textbox.nativeElement.disabled = true;
        }
        /** @type {?} */
        const focusInput = (/**
         * @return {?}
         */
        () => {
            if (this.isLookup() && this.input && this.nosearch) {
                this.input.textbox.nativeElement.disabled = false;
                this.input.focus();
            }
        });
        this.initdataSubscription = this.comboService.initData(params, method, this.selectedValues).pipe(throwIfEmpty(focusInput)).subscribe((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            if (!this.isOpen) {
                this.isOpen = true;
            }
            focusInput();
            this.cdr.detectChanges();
        }));
        // 禁止滚动
        // this.render.setStyle(this.containerElement, 'pointer-events', 'auto');
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.registerDocumentEvent();
        }));
    }
    // 显示前事件
    /**
     * @private
     * @return {?}
     */
    onBeforeShow() {
        if (!this.beforeShow) {
            this.beforeShow = (/**
             * @return {?}
             */
            () => of(''));
        }
        return this.beforeShow(this).pipe(take(1));
    }
    /**
     * @private
     * @return {?}
     */
    isLookup() {
        return this.comboService.displayType.indexOf('LOOKUP') > -1;
    }
    // 隐藏前事件
    /**
     * @private
     * @return {?}
     */
    onBeforeHide() {
        if (!this.beforeHide) {
            this.beforeHide = (/**
             * @return {?}
             */
            () => of(''));
        }
        this.beforeHide(this)
            .pipe(take(1))
            .subscribe((/**
         * @param {?} value
         * @return {?}
         */
        value => {
            if (typeof value === 'boolean') {
                if (value) {
                    this.hide(true);
                }
            }
            else if (typeof value === 'object') {
                if (value.hide) {
                    this.hide(true);
                }
                else {
                    if (value.message) {
                        if (this.notifySer) {
                            this.notifySer.warning(value.message);
                        }
                        else {
                            // console.info(value.message);
                        }
                    }
                }
            }
            else {
                this.hide(true);
            }
        }));
    }
    // 显示或隐藏下拉框
    /**
     * @private
     * @return {?}
     */
    initToggleAction() {
        this.comboService.isOpen$.pipe(debounceTime(20), takeUntil(this.destroy$), skip(1)).subscribe((/**
         * @param {?} value
         * @return {?}
         */
        value => {
            if (this.readonly || this.disabled) {
                return;
            }
            if (value) {
                this.onBeforeShow().subscribe((/**
                 * @param {?} v
                 * @return {?}
                 */
                (v) => {
                    this.__createPanel(v);
                }));
                return;
            }
            else {
                this.onBeforeHide();
            }
            this.cdr.detectChanges();
        }));
        this._comboPanelCreated$.pipe(takeUntil(this.destroy$), filter((/**
         * @param {?} value
         * @return {?}
         */
        value => !!value))).subscribe((/**
         * @param {?} cmp
         * @return {?}
         */
        (cmp) => {
            cmp.nativeElement.style.display = '';
            this.panelElement.appendChild(cmp.nativeElement);
            /** @type {?} */
            let transitionFlag = true;
            cmp.nativeElement.addEventListener('transitionend', (/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                if (e.target === e.currentTarget && transitionFlag) {
                    transitionFlag = false;
                    this.showPanel.emit(this);
                }
            }));
            if (this.isLookup()) {
                cmp.nativeElement.style.width = `${this.panelWidth}px`;
                cmp.nativeElement.style.height = `${this.panelHeight}px`;
                this.render.addClass(cmp.nativeElement, 'f-area-show');
            }
            // this.updatePosition(cmp.nativeElement);
            // this.cdr.detectChanges();
        }));
        this.destroy$.pipe(take(1)).subscribe((/**
         * @return {?}
         */
        () => {
            this.comboService.closeLoading();
            nextUniqueId = 0;
            if (this.panelListener) {
                this.panelListener();
            }
            if (this.initdataSubscription) {
                this.initdataSubscription.unsubscribe();
                this.initdataSubscription = null;
            }
            this.removePanelElement();
        }));
    }
    /**
     * @private
     * @param {?} action
     * @return {?}
     */
    iframeEventHandle(action) {
        /** @type {?} */
        const iframes = Array.from(document.querySelectorAll('iframe'));
        if (iframes && iframes.length) {
            for (const iframe of iframes) {
                /** @type {?} */
                const iframeDoc = iframe.contentDocument;
                if (iframeDoc) {
                    iframeDoc[action]('mousedown', this._documentClickEvent);
                    iframeDoc[action]('mousewheel', this._documentClickEvent);
                    iframeDoc[action]('DOMMouseScroll', this._documentClickEvent);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    removeDocumentListener() {
        if (this._documentClickEvent) {
            document.removeEventListener('mousedown', this._documentClickEvent, true);
            document.removeEventListener('mousewheel', this._documentClickEvent, true);
            document.removeEventListener('DOMMouseScroll', this._documentClickEvent, true);
            if (top !== window) {
                top.document.body.removeEventListener('mousedown', this._documentClickEvent, true);
            }
            this.iframeEventHandle('removeEventListener');
            this._documentClickEvent = null;
        }
    }
    /**
     * @private
     * @return {?}
     */
    registerDocumentEvent() {
        // 注册 mousedown 事件 隐藏panel
        document.addEventListener('mousedown', (this._documentClickEvent = (/**
         * @param {?} event
         * @return {?}
         */
        event => {
            if (!this.el.nativeElement.contains(event.target) &&
                this._cmbPanel &&
                !this.contains(this._cmbPanel, event)) {
                this.comboService.isOpen$.next(false);
                // this.willHide$.next();
            }
        })), true);
        document.addEventListener('mousewheel', this._documentClickEvent, true);
        document.addEventListener('DOMMouseScroll', this._documentClickEvent, true);
        if (top !== window) {
            top.document.body.addEventListener('mousedown', this._documentClickEvent, true);
        }
        this.iframeEventHandle('addEventListener');
    }
    // 创建下拉面板时事件
    /**
     * @private
     * @return {?}
     */
    initCreatPanelAction() {
        if (this.panelElement) {
            return;
        }
        this.createPanel(document.body);
        this.panelListener = this.render.listen(this.panelElement, 'click', (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            e.stopPropagation();
        }));
    }
    /**
     * @private
     * @return {?}
     */
    removePanelElement() {
        reqAnimFrame((/**
         * @return {?}
         */
        () => {
            if (this.panelElement) {
                document.body.removeChild(this.panelElement);
                this.panelElement = null;
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    initSelectionsChangeAction() {
        this.comboService.selections$.pipe(takeUntil(this.destroy$), debounceTime(100)).subscribe((/**
         * @param {?} value
         * @return {?}
         */
        value => {
            if (value.action === 'initData') {
                this.onSelectionsChange(this.selections);
            }
            else {
                this.onSelectionsChangeDefault();
            }
        }));
    }
    /**
     * @protected
     * @return {?}
     */
    initDatasChangeAction() { }
    // canNull 解决取消选中时依然显示
    /**
     * @private
     * @return {?}
     */
    onSelectionsChangeDefault() {
        /** @type {?} */
        const _displayText = this.comboService.getValue(this.textField);
        /** @type {?} */
        const _selectedValues = this.comboService.getValue(this.idField);
        if (this.displayText !== _displayText && !this.nosearch) {
            this.displayText = _displayText || this.displayText;
            this.displayText = this.displayText || '';
            this.originalText = _selectedValues ? _displayText : this.displayText;
        }
        if (this.input) {
            this.input.textbox.nativeElement.value = this.displayText;
        }
        this.selectedValues =
            (_selectedValues !== '' && _selectedValues !== undefined && _selectedValues !== null) ? _selectedValues : this.selectedValues;
        if (!this.cdr['destroyed']) {
            this.cdr.detectChanges();
        }
    }
    /**
     * @protected
     * @param {?} v
     * @return {?}
     */
    onSelectionsChange(v) { }
    /**
     * @param {?=} clearMapFields
     * @return {?}
     */
    updateMappingFieldValue(clearMapFields = false) {
        if (this.mappingField &&
            this.ngControl &&
            this.ngControl.formDirective &&
            this.ngControl.formDirective.form &&
            this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            const bindingData = this.ngControl.formDirective.form.bindingData;
            if (clearMapFields) {
                this.selectedValues = '';
            }
            if (bindingData.setValue) {
                /** @type {?} */
                const bindingPath = this.ngControl.formDirective.form.bindingPath;
                /** @type {?} */
                let pathArr = [];
                if (bindingPath) {
                    pathArr = bindingPath.split('/').filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n !== ''));
                }
                /** @type {?} */
                const mappingField = this.mappingField ? this.mappingField : '';
                bindingData.setValue(pathArr.concat(mappingField.split('.')), this.selectedValues, true, true);
            }
            else if (this.commonUtils) {
                this.commonUtils.setValue(bindingData, this.mappingField, this.selectedValues);
            }
            // if (!bindingData.setValue && this.commonUtils) {
            //     this.commonUtils.setValue(bindingData, this.mappingField, this.selectedValues);
            // }
        }
    }
    /**
     * @return {?}
     */
    updateSelectedValues() {
        if (this.mappingField &&
            this.ngControl &&
            this.ngControl.formDirective &&
            this.ngControl.formDirective.form &&
            this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            const bindingData = this.ngControl.formDirective.form.bindingData;
            if (bindingData.getValue) {
                /** @type {?} */
                const bindingPath = this.ngControl.formDirective.form.bindingPath;
                /** @type {?} */
                let pathArr = [];
                if (bindingPath) {
                    pathArr = bindingPath.split('/').filter((/**
                     * @param {?} value
                     * @return {?}
                     */
                    value => value !== ''));
                }
                /** @type {?} */
                const mappingField = this.mappingField ? this.mappingField : '';
                this.selectedValues = bindingData.getValue(pathArr.concat(mappingField.split('.')));
            }
            else if (this.commonUtils) {
                this.selectedValues = this.commonUtils.getValue(this.mappingField, bindingData);
            }
        }
        else if (!this.mappingField) {
            // this.selectedValues = this.displayText
        }
    }
    /**
     * @param {?=} val
     * @return {?}
     */
    onTextChange(val) {
        this.isTextChange = true;
        if (this.nosearch) {
            this.selectedValues = val;
            this.updateMappingFieldValue(this.isLookup());
            this.onChange(val);
        }
        this.textChangeSubject.next(val);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    onValueChange(changes) {
        this.displayText = changes.text;
        this.originalText = this.displayText;
        if (!this.uri && this.data && this.data.length > 0 && (!this['displayType'] || this.useValue)) {
            this.onChange(this.selectedValues);
        }
        else {
            this.onChange(this.displayText);
        }
        // if (!changes.nosearch) {
        // }
        this.valueChange.emit(changes);
        this.updateMappingFieldValue();
        this.onTouched();
        // if (this.isOpen && changes.emitHidePanel) { this.willHide$.next(); }
    }
    /**
     * @param {?} item
     * @return {?}
     */
    onSelect(item) { }
    /**
     * @param {?} item
     * @return {?}
     */
    onUnSelected(item) { }
    /**
     * emit: 默认为 true;
     * @param {?=} emit
     * @return {?}
     */
    hide(emit = true) {
        if (!this.isOpen) {
            return;
        }
        this.removeDocumentListener();
        this.isOpen = false;
        if (emit) {
            this.willHide$.next();
        }
        if (this.initdataSubscription) {
            this.initdataSubscription.unsubscribe();
            this.initdataSubscription = null;
        }
        this.removePanelElement();
    }
    /**
     * @return {?}
     */
    show() {
        if (this.isOpen) {
            return;
        }
        this.onBeforeShow().subscribe((/**
         * @param {?} value
         * @return {?}
         */
        (value) => {
            this.__createPanel(value);
        }));
        this.cdr.detectChanges();
    }
    /**
     * @private
     * @param {?} host
     * @return {?}
     */
    createPanel(host) {
        this.panelElement = this.document.createElement('div');
        this.panelElement.id = `overlay-${nextUniqueId++}`;
        this.panelElement.classList.add('overlay-pane');
        this.panelElement.style.display = 'none';
        host.appendChild(this.panelElement);
        this.comboService.panelElement = this.panelElement;
        if (this.isLookup()) {
            const { panelWidth, top, left } = this.getPanelSize();
            this.panelElement.style.width = `${this.panelWidth}px`;
            this.panelElement.style.height = `${this.panelHeight}px`;
            this.panelElement.style.top = `${top}px`;
            this.panelElement.style.left = `${left}px`;
            this.panelElement.style.zIndex = 10001;
            this.panelElement.classList.add('f-combo-lookup');
        }
        else {
            this.panelElement.style.overflow = 'hidden';
            this.render.setStyle(this.panelElement, 'top', '0');
            this.render.setStyle(this.panelElement, 'left', '0');
            this.panelElement.classList.add('f-combo-lookup');
        }
        this.panelElement.style.display = '';
    }
    /**
     * @private
     * @param {?=} target
     * @return {?}
     */
    getPanelSize(target) {
        /** @type {?} */
        let panelHeight = this.panelHeight;
        this.innerPanelHeight = 202;
        if (this.autoWidth) {
            const { width } = this.getInputSizeInfo();
            this.panelWidth = width ? width : this.panelWidth;
        }
        // 如果taget高度存在 修改pnaelHeight 用于重定位弹出框位置
        if (target && target.tagName && panelHeight === 'auto') {
            /** @type {?} */
            const targetHeight = target.scrollHeight;
            /** @type {?} */
            const isNoRecord = !!target.querySelector('.f-table-norecords-content');
            // if (this.uri) {
            //     if (this.data && this.data.length) {
            //         if (this.comboService.displayType === 'LIST' && target.querySelector('.list-group')) {
            //             this.innerPanelHeight = target.querySelector('.list-group')['offsetHeight'] + 2;
            //         } else {
            //             this.innerPanelHeight = targetHeight;
            //         }
            //     }
            // } else {
            //     this.innerPanelHeight = targetHeight && targetHeight > 10 && !isNoRecord ? Math.floor(targetHeight) : this.panelHeight;
            // }
            if (this.data && this.data.length) {
                if (this.comboService.displayType === 'LIST' && target.querySelector('.list-group')) {
                    this.innerPanelHeight = target.querySelector('.list-group')['offsetHeight'] + 2;
                }
                else {
                    this.innerPanelHeight = targetHeight;
                }
            }
        }
        else if (target && target.tagName && panelHeight && !String(panelHeight).includes('px')) {
            panelHeight = panelHeight;
        }
        let { top, height, left, right } = this.el.nativeElement.getBoundingClientRect();
        height = height + 1;
        /** @type {?} */
        const bottom = window.innerHeight - height - top;
        if (panelHeight === 'auto') {
            if (this.maxHeight && this.maxHeight > this.innerPanelHeight) {
                panelHeight = this.innerPanelHeight;
            }
            else {
                panelHeight = this.maxHeight;
            }
        }
        /** @type {?} */
        const h = top > bottom ? top : bottom;
        /** @type {?} */
        const below = h === bottom;
        /** @type {?} */
        let fx = 'top';
        if (bottom > panelHeight) {
            top = top + height;
        }
        else {
            if (top > bottom) {
                if (h < panelHeight) {
                    panelHeight = h - 10;
                    top = 10;
                }
                else {
                    top = top - parseInt('' + panelHeight, 10) - 5;
                }
                fx = 'bottom';
            }
            else {
                if (h < panelHeight) {
                    panelHeight = h - 10;
                }
                top = top + height;
            }
        }
        if (window.innerWidth - left < this.panelWidth) {
            left = right - 400;
        }
        return { panelWidth: this.panelWidth, panelHeight, top, left, below, fx };
    }
    /**
     * @private
     * @return {?}
     */
    compatibleScrollTop() {
        if (document.scrollingElement) {
            return document.scrollingElement.scrollTop;
        }
        return Math.max(window.pageYOffset, document.documentElement.scrollTop, document.body.scrollTop);
    }
    /**
     * @private
     * @return {?}
     */
    compatibleScrollLeft() {
        if (document.scrollingElement) {
            return document.scrollingElement.scrollLeft;
        }
        return Math.max(window.pageXOffset, document.documentElement.scrollLeft, document.body.scrollLeft);
    }
    // 设置弹出框位置
    /**
     * @param {?} target
     * @return {?}
     */
    updatePosition(target) {
        const { panelHeight, left, top, below, fx } = this.getPanelSize(target);
        if (!this.isLookup()) {
            /** @type {?} */
            let _top = top;
            /** @type {?} */
            let _height = panelHeight;
            if (top < 0) {
                _height = this.innerPanelHeight + top - 10;
                _top = 10;
            }
            _top += this.compatibleScrollTop();
            if (this.panelHeight !== 'auto') {
                if (this.maxHeight < _height) {
                    this.maxHeight = (/** @type {?} */ (_height));
                }
            }
            this.comPosition = {
                'left': left + this.compatibleScrollLeft(),
                'top': _top,
                'width': this.panelWidth,
                height: _height === 'auto' ? 'auto' : _height,
                'max-height': this.maxHeight
            };
        }
        else {
            this.comPosition = {
                'width': this.panelWidth,
                'height': panelHeight
            };
        }
        this.panelElement.style.overflow = '';
        target['style'].display = '';
        Object.keys(this.comPosition).forEach((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            /** @type {?} */
            let val = this.comPosition[n];
            if (val !== 'auto') {
                val += 'px';
            }
            this.render.setStyle(target, n, val);
        }));
        target.style.transformOrigin = '100% ' + fx;
        // target['style'].visibility = 'visible';
        return this.comPosition;
    }
    /**
     * @param {?} el
     * @param {?} event
     * @return {?}
     */
    contains(el, event) {
        return el.nativeElement.contains(event.target);
    }
    /**
     * @protected
     * @param {?} value
     * @param {?} data
     * @return {?}
     */
    filterSelections(value, data) {
        /** @type {?} */
        const selectedItems = String(value)
            .split(this.separator)
            .map((/**
         * @param {?} selectedItem
         * @return {?}
         */
        selectedItem => {
            /** @type {?} */
            const item = data.find((/**
             * @param {?} val
             * @return {?}
             */
            val => selectedItem == this.commonUtils.getValue(this.idField, val) + ''));
            return item ? this.commonUtils.getValue(this.textField, item) : '';
        }));
        return selectedItems.filter((/**
         * @param {?} el
         * @return {?}
         */
        el => el));
    }
    /**
     * @protected
     * @param {?} selectedValues
     * @param {?} data
     * @return {?}
     */
    updateSelections(selectedValues, data) {
        if (selectedValues === null || selectedValues === undefined) {
            this.selections = [];
        }
        if (typeof selectedValues === 'boolean' || typeof selectedValues === 'number') {
            selectedValues = '' + selectedValues;
        }
        /** @type {?} */
        const selectedItems = selectedValues ? String(selectedValues).split(this.separator).map((/**
         * @param {?} val
         * @return {?}
         */
        val => {
            if (this.comboService.displayType === 'LOOKUPTREELIST') {
                return this.comboService.treeNodeToFlatData(data, val, this.idField);
            }
            return data.find((/**
             * @param {?} _data
             * @return {?}
             */
            _data => '' + val == this.commonUtils.getValue(this.idField, _data) + ''));
        })) : [];
        this.selections = selectedItems || [];
    }
    /**
     * @private
     * @param {?} value
     * @param {?} data
     * @return {?}
     */
    getDisplayText(value, data) {
        if (value !== null && value !== undefined) {
            /** @type {?} */
            const selectedItems = this.filterSelections(value, data);
            if (!selectedItems || !selectedItems.length) {
                return value;
            }
            else {
                return selectedItems.filter((/**
                 * @param {?} v
                 * @return {?}
                 */
                v => !!v)).join(this.separator);
            }
        }
        else {
            return '';
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        /** @type {?} */
        let data = [];
        if (this.data instanceof Array) {
            data = this.data;
        }
        else if (this.data) {
            data = ((/** @type {?} */ (this.data['items']))) instanceof Array ? this.data['items'] : data;
        }
        this.originalText = value;
        this.selectedValues = '';
        if (!this.uri && data && data.length > 0) {
            this.selectedValues = value;
            this.updateSelections(value, data);
            this.displayText = this.getDisplayText(value, this.selections || []);
            this.originalText = this.displayText;
        }
        else {
            // this.displayText = this.getDisplayText(value, this.selections);
            this.displayText = value;
            this.updateSelectedValues();
            if (!this.selectedValues) {
                this.selectedValues = value;
            }
            if (this.viewType === 'tag' && this.multiSelect && (this.displayText !== null && this.displayText !== undefined)) {
                /** @type {?} */
                const txtArr = this.displayText.split(this.separator).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n));
                this.selections = txtArr.reduce((/**
                 * @param {?} r
                 * @param {?} c
                 * @param {?} i
                 * @return {?}
                 */
                (r, c, i) => {
                    r.push({ [this.textField]: c });
                    return r;
                }), []);
            }
        }
        this.cdr.markForCheck();
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this.cdr.markForCheck();
    }
    /**
     * @param {?} searchValue
     * @param {?} searchField
     * @return {?}
     */
    filterDataOnServer(searchValue, searchField) {
    }
}
/** @nocollapse */
BaseComboComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
    { type: Renderer2 },
    { type: ComboService },
    { type: Injector }
];
BaseComboComponent.propDecorators = {
    disabled: [{ type: Input }],
    readonly: [{ type: Input }],
    editable: [{ type: Input }],
    placeholder: [{ type: Input }],
    panelWidth: [{ type: Input }],
    panelHeight: [{ type: Input }],
    autoWidth: [{ type: Input }],
    enableClear: [{ type: Input }],
    mapFields: [{ type: Input }],
    forcePlaceholder: [{ type: Input }],
    nosearch: [{ type: Input }],
    maxLength: [{ type: Input }],
    enableTitle: [{ type: Input }],
    viewType: [{ type: Input }],
    context: [{ type: Input }],
    mappingField: [{ type: Input }],
    data: [{ type: Input }],
    idField: [{ type: Input }],
    valueField: [{ type: Input }],
    textField: [{ type: Input }],
    multiSelect: [{ type: Input }],
    uri: [{ type: Input }],
    selectedValues: [{ type: Input }],
    displayText: [{ type: Input }],
    maxHeight: [{ type: Input }],
    enableCancelSelected: [{ type: Input }],
    remoteSearch: [{ type: Input }],
    beforeShow: [{ type: Input }],
    beforeHide: [{ type: Input }],
    hidePanelOnClear: [{ type: Input }],
    useValue: [{ type: Input }],
    separator: [{ type: Input }],
    showPanel: [{ type: Output }],
    hidePanel: [{ type: Output }],
    clear: [{ type: Output }],
    valueChange: [{ type: Output }],
    selectChange: [{ type: Output }],
    cmbPanel: [{ type: ViewChild, args: ['comboPanel',] }],
    input: [{ type: ViewChild, args: ['input',] }],
    input2: [{ type: ViewChild, args: ['input2',] }]
};
if (false) {
    /** @type {?} */
    BaseComboComponent.prototype.disabled;
    /** @type {?} */
    BaseComboComponent.prototype.readonly;
    /** @type {?} */
    BaseComboComponent.prototype.editable;
    /** @type {?} */
    BaseComboComponent.prototype.placeholder;
    /** @type {?} */
    BaseComboComponent.prototype.panelWidth;
    /** @type {?} */
    BaseComboComponent.prototype.panelHeight;
    /** @type {?} */
    BaseComboComponent.prototype.autoWidth;
    /** @type {?} */
    BaseComboComponent.prototype.enableClear;
    /** @type {?} */
    BaseComboComponent.prototype.mapFields;
    /**
     * 禁用只读时显示 placeholder
     * @type {?}
     */
    BaseComboComponent.prototype.forcePlaceholder;
    /**
     * 任意输入 20210202
     * @type {?}
     */
    BaseComboComponent.prototype.nosearch;
    /**
     * 允许最大输入长度
     * @type {?}
     */
    BaseComboComponent.prototype.maxLength;
    /** @type {?} */
    BaseComboComponent.prototype.enableTitle;
    /**
     * 展示类型： text文本，tag标签。 默认 text
     * @type {?}
     */
    BaseComboComponent.prototype.viewType;
    /** @type {?} */
    BaseComboComponent.prototype.displayText;
    /** @type {?} */
    BaseComboComponent.prototype.maxHeight;
    /** @type {?} */
    BaseComboComponent.prototype.enableCancelSelected;
    /** @type {?} */
    BaseComboComponent.prototype.beforeShow;
    /** @type {?} */
    BaseComboComponent.prototype.beforeHide;
    /** @type {?} */
    BaseComboComponent.prototype.hidePanelOnClear;
    /**
     * 开启后，ngModel 的值为 valueField or  idField; 否则为textField的值
     * @type {?}
     */
    BaseComboComponent.prototype.useValue;
    /** @type {?} */
    BaseComboComponent.prototype.separator;
    /** @type {?} */
    BaseComboComponent.prototype.showPanel;
    /** @type {?} */
    BaseComboComponent.prototype.hidePanel;
    /** @type {?} */
    BaseComboComponent.prototype.clear;
    /** @type {?} */
    BaseComboComponent.prototype.valueChange;
    /** @type {?} */
    BaseComboComponent.prototype.selectChange;
    /** @type {?} */
    BaseComboComponent.prototype.input;
    /** @type {?} */
    BaseComboComponent.prototype.input2;
    /** @type {?} */
    BaseComboComponent.prototype.isOpen;
    /** @type {?} */
    BaseComboComponent.prototype.comPosition;
    /** @type {?} */
    BaseComboComponent.prototype.destroy$;
    /** @type {?} */
    BaseComboComponent.prototype.ngControl;
    /** @type {?} */
    BaseComboComponent.prototype.groupIcon;
    /** @type {?} */
    BaseComboComponent.prototype.localeService;
    /** @type {?} */
    BaseComboComponent.prototype.innerPanelHeight;
    /** @type {?} */
    BaseComboComponent.prototype.commonUtils;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype._cmbPanel;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype._comboPanelCreated$;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.willHide$;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.containerElement;
    /**
     * overlay
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.panelElement;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype._documentClickEvent;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.panelListener;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.mouseWheelEvent;
    /** @type {?} */
    BaseComboComponent.prototype.textChangeSubject;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.initdataSubscription;
    /** @type {?} */
    BaseComboComponent.prototype.customData;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.originalText;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.isTextChange;
    /** @type {?} */
    BaseComboComponent.prototype.treeClientSearch;
    /** @type {?} */
    BaseComboComponent.prototype.eventMgr;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.notifySer;
    /**
     * @type {?}
     * @private
     */
    BaseComboComponent.prototype.ro;
    /** @type {?} */
    BaseComboComponent.prototype.onChange;
    /** @type {?} */
    BaseComboComponent.prototype.onTouched;
    /** @type {?} */
    BaseComboComponent.prototype.el;
    /** @type {?} */
    BaseComboComponent.prototype.cdr;
    /** @type {?} */
    BaseComboComponent.prototype.document;
    /** @type {?} */
    BaseComboComponent.prototype.render;
    /** @type {?} */
    BaseComboComponent.prototype.comboService;
    /** @type {?} */
    BaseComboComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1jb21iby5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWNvbWJvLWxpc3QvIiwic291cmNlcyI6WyJsaWIvYmFzZS1jb21iby5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQ0ssS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLGlCQUFpQixFQUNsRSxTQUFTLEVBQUUsU0FBUyxFQUE0QixNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFDM0UsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUE0QixTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDbEYsT0FBTyxFQUF3QixTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFhLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2hILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUU3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNyRSxPQUFPLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQzlELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN6RCxPQUFPLGNBQWMsTUFBTSwwQkFBMEIsQ0FBQzs7SUFFbEQsWUFBWSxHQUFHLENBQUM7QUFDcEIsTUFBTSxPQUFPLGtC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akQsOENBQThCOzs7Ozs7SUFFOUIsMENBQTBCOzs7OztJQUMxQixpREFBaUM7Ozs7O0lBV2pDLDJDQUE2Qjs7Ozs7SUFFN0Isb0NBQThCOzs7OztJQUM5Qiw2Q0FBK0I7O0lBQy9CLCtDQUFrQzs7Ozs7SUFDbEMsa0RBQWtEOztJQUVsRCx3Q0FBa0I7Ozs7O0lBRWxCLDBDQUEwQjs7Ozs7SUFDMUIsMENBQTZCOztJQUU3Qiw4Q0FBaUM7O0lBRWpDLHNDQUF1Qjs7Ozs7SUFDdkIsdUNBQWlDOzs7OztJQUNqQyxnQ0FBeUM7O0lBQ3pDLHNDQUEwRDs7SUFDMUQsdUNBQW1DOztJQUcvQixnQ0FBcUI7O0lBQ3JCLGlDQUE2Qjs7SUFDN0Isc0NBQXNDOztJQUN0QyxvQ0FBd0I7O0lBQ3hCLDBDQUFpQzs7SUFDakMsc0NBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHtcclxuICAgIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBFbGVtZW50UmVmLCBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgIFJlbmRlcmVyMiwgVmlld0NoaWxkLCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIEluamVjdCwgSW5qZWN0b3IsIE5nWm9uZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJqZWN0LCBpbnRlcnZhbCwgb2YsIE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiwgZnJvbUV2ZW50IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0NvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgdGFrZVVudGlsLCBmaWx0ZXIsIHNraXAsIGRlYm91bmNlVGltZSwgdGhyb3R0bGUsIHRha2UsIGRlbGF5V2hlbiwgdGhyb3dJZkVtcHR5IH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBDb21ib1NlcnZpY2UgfSBmcm9tICcuL2NvbWJvLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBJbnB1dEdyb3VwQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1pbnB1dC1ncm91cCc7XHJcbmltcG9ydCB7IFNlbGVjdEl0ZW0sIE5vcm1hbE9iamVjdCwgQ29tYm9DaGFuZ2VzIH0gZnJvbSAnLi9jb21iby5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBDb21ib0xvY2FsZVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2NvbWJvLmxvY2FsZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbHMsIHJlcUFuaW1GcmFtZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uJztcclxuaW1wb3J0IHsgRXZlbnRNYW5hZ2VyIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XHJcbmltcG9ydCBSZXNpemVPYnNlcnZlciBmcm9tICdyZXNpemUtb2JzZXJ2ZXItcG9seWZpbGwnO1xyXG5cclxubGV0IG5leHRVbmlxdWVJZCA9IDA7XHJcbmV4cG9ydCBjbGFzcyBCYXNlQ29tYm9Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgQ29udHJvbFZhbHVlQWNjZXNzb3Ige1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIHJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBlZGl0YWJsZSA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcnO1xyXG4gICAgQElucHV0KCkgcGFuZWxXaWR0aCA9IDMwMDtcclxuICAgIEBJbnB1dCgpIHBhbmVsSGVpZ2h0OiBudW1iZXIgfCBzdHJpbmcgPSAnYXV0byc7XHJcbiAgICBASW5wdXQoKSBhdXRvV2lkdGggPSB0cnVlO1xyXG4gICAgQElucHV0KCkgZW5hYmxlQ2xlYXIgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgbWFwRmllbGRzOiBhbnk7XHJcbiAgICAvKiog56aB55So5Y+q6K+75pe25pi+56S6IHBsYWNlaG9sZGVyICovXHJcbiAgICBASW5wdXQoKSBmb3JjZVBsYWNlaG9sZGVyID0gZmFsc2U7XHJcblxyXG4gICAgLyoqIOS7u+aEj+i+k+WFpSAyMDIxMDIwMiAqL1xyXG4gICAgQElucHV0KCkgbm9zZWFyY2ggPSBmYWxzZTtcclxuICAgIC8qKiDlhYHorrjmnIDlpKfovpPlhaXplb/luqYgKi9cclxuICAgIEBJbnB1dCgpIG1heExlbmd0aDtcclxuXHJcbiAgICAvLyDpvKDmoIfmu5Hov4fmmL7npLrmlofmnKzlhoXlrrlcclxuICAgIEBJbnB1dCgpIGVuYWJsZVRpdGxlID0gdHJ1ZTtcclxuICAgIC8qKiDlsZXnpLrnsbvlnovvvJogdGV4dOaWh+acrO+8jHRhZ+agh+etvuOAgiDpu5jorqQgdGV4dCAqL1xyXG4gICAgQElucHV0KCkgdmlld1R5cGU6ICd0ZXh0JyB8ICd0YWcnID0gJ3RleHQnO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBjb250ZXh0KHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuY29udGV4dCA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBtYXBwaW5nRmllbGQodjogYW55KSB7XHJcbiAgICAgICAgdGhpcy5tYXBGaWVsZHMgPSB2O1xyXG4gICAgfVxyXG4gICAgZ2V0IG1hcHBpbmdGaWVsZCgpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1hcEZpZWxkcztcclxuICAgIH1cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgZGF0YSh2YWw6IE5vcm1hbE9iamVjdFtdKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuZGF0YSA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBkYXRhKCk6IE5vcm1hbE9iamVjdFtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UuZGF0YTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBpZEZpZWxkKHZhbDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuaWRGaWVsZCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBpZEZpZWxkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tYm9TZXJ2aWNlLmlkRmllbGQ7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHZhbHVlRmllbGQodmFsOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS52YWx1ZUZpZWxkID0gdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IHZhbHVlRmllbGQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UudmFsdWVGaWVsZCA/IHRoaXMuY29tYm9TZXJ2aWNlLnZhbHVlRmllbGQgOiB0aGlzLmlkRmllbGQ7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHRleHRGaWVsZCh2YWw6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnRleHRGaWVsZCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCB0ZXh0RmllbGQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UudGV4dEZpZWxkO1xyXG4gICAgfVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBtdWx0aVNlbGVjdCh2YWw6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5tdWx0aVNlbGVjdCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBtdWx0aVNlbGVjdCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UubXVsdGlTZWxlY3Q7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHVyaSh2YWw6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnVyaSA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCB1cmkoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UudXJpO1xyXG4gICAgfVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBzZWxlY3RlZFZhbHVlcyh2YWw6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdGVkVmFsdWVzID0gdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IHNlbGVjdGVkVmFsdWVzKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdGVkVmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzZWxlY3RlZFZhbHVlc1N0cigpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFZhbHVlcyA9PT0gbnVsbCB8fCB0aGlzLnNlbGVjdGVkVmFsdWVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKHRoaXMuc2VsZWN0ZWRWYWx1ZXMpICsgJyc7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKSBkaXNwbGF5VGV4dCA9ICcnO1xyXG4gICAgQElucHV0KCkgbWF4SGVpZ2h0ID0gMjAwO1xyXG4gICAgQElucHV0KCkgZW5hYmxlQ2FuY2VsU2VsZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAvKiog6L+c56uv6L+H5rukICovXHJcbiAgICBASW5wdXQoKSBnZXQgcmVtb3RlU2VhcmNoKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5yZW1vdGVTZWFyY2g7XHJcbiAgICB9XHJcbiAgICBzZXQgcmVtb3RlU2VhcmNoKHZhbDogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnJlbW90ZVNlYXJjaCA9IHZhbDtcclxuICAgIH1cclxuICAgIEBJbnB1dCgpIGJlZm9yZVNob3c6IChpbnN0YW5jZT86IHRoaXMpID0+IE9ic2VydmFibGU8YW55PjtcclxuICAgIEBJbnB1dCgpIGJlZm9yZUhpZGU6IChpbnN0YW5jZT86IHRoaXMpID0+IE9ic2VydmFibGU8YW55PjtcclxuXHJcbiAgICAvLyDlpoLmnpzpnaLmnb/lt7LmiZPlvIDvvIwg54K55Ye75riF56m65oyJ6ZKu5pe25piv5ZCm5YWz6Zet6Z2i5p2/44CCdHJ1ZTog5YWz6Zet77ybIGZhbHNlOiDkuI3lhbPpl63vvJtcclxuICAgIEBJbnB1dCgpIGhpZGVQYW5lbE9uQ2xlYXIgPSBmYWxzZTtcclxuICAgIC8qKiDlvIDlkK/lkI7vvIxuZ01vZGVsIOeahOWAvOS4uiB2YWx1ZUZpZWxkIG9yICBpZEZpZWxkOyDlkKbliJnkuLp0ZXh0RmllbGTnmoTlgLwgKi9cclxuICAgIEBJbnB1dCgpIHVzZVZhbHVlID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KCkgc2VwYXJhdG9yID0gJywnO1xyXG5cclxuICAgIEBPdXRwdXQoKSBzaG93UGFuZWwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgaGlkZVBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNsZWFyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHZhbHVlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxDb21ib0NoYW5nZXM+KCk7XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxTZWxlY3RJdGVtPigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2NvbWJvUGFuZWwnKSBzZXQgY21iUGFuZWwoY21wOiBFbGVtZW50UmVmKSB7XHJcbiAgICAgICAgaWYgKGNtcCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jbWJQYW5lbCA9IGNtcDtcclxuICAgICAgICAgICAgdGhpcy5yby5vYnNlcnZlKGNtcC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5fY29tYm9QYW5lbENyZWF0ZWQkLm5leHQoY21wKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9jbWJQYW5lbCA9IG51bGw7XHJcbiAgICAgICAgICAgIC8vIHRoaXMucm8udW5vYnNlcnZlKHRoaXMuZWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJvKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9jb21ib1BhbmVsQ3JlYXRlZCQubmV4dChudWxsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgQFZpZXdDaGlsZCgnaW5wdXQnKSBpbnB1dDogSW5wdXRHcm91cENvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0MicpIGlucHV0MjogRWxlbWVudFJlZjtcclxuICAgIHB1YmxpYyBpc09wZW4gPSBmYWxzZTtcclxuICAgIHB1YmxpYyBjb21Qb3NpdGlvbiA9IHt9O1xyXG4gICAgcHVibGljIGRlc3Ryb3kkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHB1YmxpYyBuZ0NvbnRyb2w6IE5nQ29udHJvbCB8IGFueSA9IG51bGw7XHJcbiAgICBwdWJsaWMgZ3JvdXBJY29uID0gJzxzcGFuIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1hcnJvdy02MC1kb3duXCI+PC9zcGFuPic7XHJcbiAgICBwdWJsaWMgbG9jYWxlU2VydmljZTogQ29tYm9Mb2NhbGVTZXJ2aWNlO1xyXG4gICAgcHVibGljIGlubmVyUGFuZWxIZWlnaHQ6IGFueTtcclxuICAgIHB1YmxpYyBjb21tb25VdGlsczogQ29tbW9uVXRpbHM7XHJcbiAgICBwcml2YXRlIF9jbWJQYW5lbDogRWxlbWVudFJlZiA9IG51bGw7XHJcbiAgICBwcml2YXRlIF9jb21ib1BhbmVsQ3JlYXRlZCQgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgLy8gcHJpdmF0ZSBfaGFzUG9zaXRlZCA9IGZhbHNlO1xyXG4gICAgLy8gcHJpdmF0ZSBfY29udGFpbmVyOiBFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSB3aWxsSGlkZSQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgcHJpdmF0ZSBjb250YWluZXJFbGVtZW50OiBhbnk7XHJcbiAgICAvKiogb3ZlcmxheSAqL1xyXG4gICAgcHJpdmF0ZSBwYW5lbEVsZW1lbnQ6IGFueTtcclxuICAgIHByaXZhdGUgX2RvY3VtZW50Q2xpY2tFdmVudDogYW55O1xyXG4gICAgc2V0IHNlbGVjdGlvbnModmFsdWU6IE5vcm1hbE9iamVjdFtdKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0aW9ucyA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IHNlbGVjdGlvbnMoKTogTm9ybWFsT2JqZWN0W10ge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zLmZpbHRlcihuID0+IG4gIT09IG51bGwgJiYgbiAhPT0gdW5kZWZpbmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcGFuZWxMaXN0ZW5lciA9IG51bGw7XHJcblxyXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSA9IG51bGw7XHJcbiAgICBwcml2YXRlIG1vdXNlV2hlZWxFdmVudCA9IG51bGw7XHJcbiAgICB0ZXh0Q2hhbmdlU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIGluaXRkYXRhU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24gPSBudWxsO1xyXG5cclxuICAgIGN1c3RvbURhdGEgPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgb3JpZ2luYWxUZXh0ID0gJyc7XHJcbiAgICBwcml2YXRlIGlzVGV4dENoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgIHRyZWVDbGllbnRTZWFyY2ggPSBuZXcgU3ViamVjdCgpO1xyXG5cclxuICAgIGV2ZW50TWdyOiBFdmVudE1hbmFnZXI7XHJcbiAgICBwcml2YXRlIG5vdGlmeVNlcjogTm90aWZ5U2VydmljZTtcclxuICAgIHByaXZhdGUgcm86IFJlc2l6ZU9ic2VydmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgICBvbkNoYW5nZTogKHZhbHVlOiBzdHJpbmcgfCBzdHJpbmdbXSkgPT4gdm9pZCA9ICgpID0+IG51bGw7XHJcbiAgICBvblRvdWNoZWQ6ICgpID0+IHZvaWQgPSAoKSA9PiBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBlbDogRWxlbWVudFJlZixcclxuICAgICAgICBwdWJsaWMgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBASW5qZWN0KERPQ1VNRU5UKSBwdWJsaWMgZG9jdW1lbnQ6IGFueSxcclxuICAgICAgICBwdWJsaWMgcmVuZGVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgcHVibGljIGNvbWJvU2VydmljZTogQ29tYm9TZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBpbmplY3RvcjogSW5qZWN0b3JcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuaW5pdFRvZ2dsZUFjdGlvbigpO1xyXG4gICAgICAgIHRoaXMuaW5pdFNlbGVjdGlvbnNDaGFuZ2VBY3Rpb24oKTtcclxuICAgICAgICB0aGlzLmluaXREYXRhc0NoYW5nZUFjdGlvbigpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbW1vblV0aWxzID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tbW9uVXRpbHMsIG51bGwpO1xyXG4gICAgICAgIHRoaXMud2lsbEhpZGUkLnBpcGUoXHJcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKGUgPT4ge1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLm5vc2VhcmNoICYmIHRoaXMuZGlzcGxheVRleHQgIT09IHRoaXMub3JpZ2luYWxUZXh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlUZXh0ID0gdGhpcy5vcmlnaW5hbFRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNMb29rdXAoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2UodGhpcy5kaXNwbGF5VGV4dCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IF9kaXNwbGF5VGV4dCA9IHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoeyB0ZXh0OiBfZGlzcGxheVRleHQsIHZhbHVlOiB0aGlzLnNlbGVjdGVkVmFsdWVzLCBzZWxlY3Rpb25zOiB0aGlzLnNlbGVjdGlvbnMgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vblRvdWNoZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5oaWRlUGFuZWwuZW1pdCh0aGlzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNZ3IgPSB0aGlzLmluamVjdG9yLmdldChFdmVudE1hbmFnZXIpO1xyXG4gICAgICAgIHRoaXMuZW1pdFRleHRDaGFuZ2UoKTtcclxuXHJcbiAgICAgICAgdGhpcy5ub3RpZnlTZXIgPSB0aGlzLmluamVjdG9yLmdldChOb3RpZnlTZXJ2aWNlLCBudWxsKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tYm9Mb2NhbGVTZXJ2aWNlLCAnJyk7XHJcbiAgICAgICAgaWYgKHRoaXMubG9jYWxlU2VydmljZSkge1xyXG4gICAgICAgICAgICBjb25zdCBsb2NhbENvbmZpZyA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRMb2NhbGVDb25maWcoKTtcclxuICAgICAgICAgICAgaWYgKGxvY2FsQ29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGxhY2Vob2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gbG9jYWxDb25maWdbJ3BsYWNlaG9sZGVyJ10gfHwgJ+ivt+mAieaLqSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlcGFyYXRvciA9IHRoaXMuc2VwYXJhdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgICAgICB0aGlzLm5nQ29udHJvbCA9IHRoaXMuaW5qZWN0b3IuZ2V0KE5nQ29udHJvbCwgbnVsbCk7XHJcbiAgICAgICAgZnJvbUV2ZW50KHdpbmRvdywgJ3Jlc2l6ZScpLnBpcGUoXHJcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICkucGlwZShcclxuICAgICAgICAgICAgZGVib3VuY2VUaW1lKDEwMCksXHJcbiAgICAgICAgICAgIHRocm90dGxlKGV2ID0+IGludGVydmFsKDEwMCkpLFxyXG4gICAgICAgICkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVQYW5lbFdpZHRoKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuaXNPcGVuJC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lsbEhpZGUkLm5leHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5uZ1pvbmUpIHtcclxuICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQYW5lbFdpZHRoKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcmVzemllVGltZXIgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnJvID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3ppZVRpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChyZXN6aWVUaW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3ppZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGF0Ll9jbWJQYW5lbCAmJiB0aGF0LnBhbmVsRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxQW5pbUZyYW1lKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVBvc2l0aW9uKHRoYXQuX2NtYlBhbmVsLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGF0Ll9jbWJQYW5lbC5uYXRpdmVFbGVtZW50LmNsYXNzTmFtZS5pbmRleE9mKCdmLWFyZWEtc2hvdycpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnJlbmRlci5hZGRDbGFzcyh0aGF0Ll9jbWJQYW5lbC5uYXRpdmVFbGVtZW50LCAnZi1hcmVhLXNob3cnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLmluamVjdFNlcnZpY2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VyYWNoVmFsdWUkLnVuc3Vic2NyaWJlKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1vdXNlV2hlZWxFdmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlV2hlZWxFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVBhbmVsV2lkdGgoKSB7XHJcbiAgICAgICAgY29uc3QgeyB3aWR0aCB9ID0gdGhpcy5nZXRJbnB1dFNpemVJbmZvKCk7XHJcbiAgICAgICAgdGhpcy5wYW5lbFdpZHRoID0gdGhpcy5hdXRvV2lkdGggPyB3aWR0aCA6IHRoaXMucGFuZWxXaWR0aDtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsaWNrKCRldmVudDogYW55ID0gbnVsbCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKCRldmVudC5zdG9wUHJvcGFnYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgkZXZlbnQub3JpZ2luYWxFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRldmVudC5vcmlnaW5hbEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDph43lpI3miafooYzpnaLmnb/lhbPpl63kuovku7Yg5pWF5rOo6YeK5o6JIDIwMjIwOTE3XHJcbiAgICAgICAgLy8gaWYgKHRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMud2lsbEhpZGUkLm5leHQoKTtcclxuICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmNvbWJvU2VydmljZS5pc09wZW4kLm5leHQoIXRoaXMuaXNPcGVuKTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLmlzT3BlbiQubmV4dCghdGhpcy5pc09wZW4pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pbnB1dCAmJiB0aGlzLmlucHV0LnRleHRib3gpIHtcclxuICAgICAgICAgICAgdGhpcy5pbnB1dC50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25CbHVyKGV2ZW50OiBFdmVudCkge1xyXG4gICAgICAgIHRoaXMub25Ub3VjaGVkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Gb2N1cyhldmVudDogRXZlbnQpIHtcclxuICAgICAgICAvLyAvLyDlkK/nlKjku7vmhI/ovpPlhaXlkI7vvIzmlofmnKzmoYblvpfliLDnhKbngrnlkI7kuI3lvLnlh7rkuIvmi4npnaLmnb/jgIIyMDIxLzAyLzE5XHJcbiAgICAgICAgLy8gaWYgKHRoaXMubm9zZWFyY2gpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIDtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIGlmICghdGhpcy5pc09wZW4pIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5jb21ib1NlcnZpY2UuaXNPcGVuJC5uZXh0KHRydWUpO1xyXG4gICAgICAgIC8vICAgICAvLyDlu7bov5/miafooYzlj5jmm7Tmo4DmtYsg5pu05paw5by55Ye65qGG5L2N572uXHJcbiAgICAgICAgLy8gb2YoJycpLnBpcGUoZGVib3VuY2VUaW1lKDApKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG5cclxuICAgIG9uSW5wdXRjbGljaygkZXZlbnQ/OiBhbnkpIHtcclxuICAgICAgICBpZiAoJGV2ZW50ICYmICRldmVudC5zdG9wUHJvcGFnYXRpb24pIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5pc09wZW4kLm5leHQoIXRoaXMuaXNPcGVuKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkVudGVyKGV2ZW50OiBFdmVudCkgeyB9XHJcblxyXG4gICAgYmx1cigpIHtcclxuICAgICAgICB0aGlzLmlucHV0LnRleHRib3gubmF0aXZlRWxlbWVudC5ibHVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9jdXMoKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dC50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSAnJztcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoeyB0ZXh0OiAnJywgdmFsdWU6ICcnLCBzZWxlY3Rpb25zOiBbXSB9KTtcclxuICAgICAgICB0aGlzLmNsZWFyLmVtaXQoKTtcclxuICAgICAgICBpZiAodGhpcy5pc09wZW4gJiYgdGhpcy5oaWRlUGFuZWxPbkNsZWFyKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY29tYm9TZXJ2aWNlLmlzT3BlbiQubmV4dChmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMud2lsbEhpZGUkLm5leHQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRJbnB1dFNpemVJbmZvKCkge1xyXG4gICAgICAgIGNvbnN0IGVsOiBhbnkgPSB0aGlzLnZpZXdUeXBlID09PSAndGV4dCcgPyB0aGlzLmlucHV0LmlucHV0R3JvdXAgOiB0aGlzLmlucHV0MjtcclxuICAgICAgICByZXR1cm4gZWwubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBlbWl0VGV4dENoYW5nZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50ZXh0Q2hhbmdlU3ViamVjdC5waXBlKFxyXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUoMjAwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgX3NlbGVjdGVkVmFsdWVzID0gdGhpcy5zZWxlY3RlZFZhbHVlcztcclxuICAgICAgICAgICAgY29uc3QgdmFsID0gciA/IHIgOiB0aGlzLmRpc3BsYXlUZXh0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHIgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2xlYXIoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm5vc2VhcmNoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoeyB0ZXh0OiByLCB2YWx1ZTogJycsIHNlbGVjdGlvbnM6IHRoaXMuc2VsZWN0aW9ucywgbm9zZWFyY2g6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5yZW1vdGVTZWFyY2gpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbWJvU2VydmljZS5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbGllbnRTZWFyY2gubmV4dCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlcmFjaFZhbHVlJC5uZXh0KHZhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxBcnIgPSAodmFsICsgJycpLnNwbGl0KHRoaXMuc2VwYXJhdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhcHBlbmRWYWwgPSB2YWxBcnJbdmFsQXJyLmxlbmd0aCAtIDFdID8gdmFsQXJyW3ZhbEFyci5sZW5ndGggLSAxXSA6ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlcmFjaFZhbHVlJC5uZXh0KGFwcGVuZFZhbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoX3NlbGVjdGVkVmFsdWVzICE9PSB0aGlzLnNlbGVjdGVkVmFsdWVzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5vblZhbHVlQ2hhbmdlKHsgdGV4dDogdGhpcy5kaXNwbGF5VGV4dCwgdmFsdWU6IHRoaXMuc2VsZWN0ZWRWYWx1ZXMsIHNlbGVjdGlvbnM6IHRoaXMuc2VsZWN0aW9ucyB9KTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckRhdGFPblNlcnZlcih2YWwsICcqJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfX2NyZWF0ZVBhbmVsKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBsZXQgcGFyYW1zOiBhbnkgPSB7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgbWV0aG9kID0gJ2dldCc7XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgcGFyYW1zOiBfcCwgZGF0YSwgbWV0aG9kOiBfbSwgc2hvd0RpYWxvZyB9ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChzaG93RGlhbG9nID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zID0ge2RhdGF9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXN0b21EYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChfcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IHtkYXRhOiBfcH07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21EYXRhID0gX3A7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChfbSkge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kID0gX207XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0Q3JlYXRQYW5lbEFjdGlvbigpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy51cmkpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZFZhbHVlcygpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb29rdXAoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbWJvU2VydmljZS5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICBwYXJhbXMuZW5hYmxlRnVsbFRyZWUgPSB0aGlzWydlbmFibGVGdWxsVHJlZSddO1xyXG4gICAgICAgICAgICBwYXJhbXMubG9hZFRyZWVEYXRhVHlwZSA9IHRoaXNbJ2xvYWRUcmVlRGF0YVR5cGUnXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzTG9va3VwKCkgJiYgdGhpcy5pbnB1dCAmJiB0aGlzLm5vc2VhcmNoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5wdXQudGV4dGJveC5uYXRpdmVFbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGZvY3VzSW5wdXQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9va3VwKCkgJiYgdGhpcy5pbnB1dCAgJiYgdGhpcy5ub3NlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dC50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGRhdGFTdWJzY3JpcHRpb24gPSB0aGlzLmNvbWJvU2VydmljZS5pbml0RGF0YShwYXJhbXMsIG1ldGhvZCwgdGhpcy5zZWxlY3RlZFZhbHVlcykucGlwZShcclxuICAgICAgICAgICAgdGhyb3dJZkVtcHR5KGZvY3VzSW5wdXQpXHJcbiAgICAgICAgKS5zdWJzY3JpYmUobiA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc09wZW4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb2N1c0lucHV0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8g56aB5q2i5rua5YqoXHJcbiAgICAgICAgLy8gdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5jb250YWluZXJFbGVtZW50LCAncG9pbnRlci1ldmVudHMnLCAnYXV0bycpO1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckRvY3VtZW50RXZlbnQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrliY3kuovku7ZcclxuICAgIHByaXZhdGUgb25CZWZvcmVTaG93KCkge1xyXG4gICAgICAgIGlmICghdGhpcy5iZWZvcmVTaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlU2hvdyA9ICgpID0+IG9mKCcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmVmb3JlU2hvdyh0aGlzKS5waXBlKHRha2UoMSkpO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBpc0xvb2t1cCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UuZGlzcGxheVR5cGUuaW5kZXhPZignTE9PS1VQJykgPiAtMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDpmpDol4/liY3kuovku7ZcclxuICAgIHByaXZhdGUgb25CZWZvcmVIaWRlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5iZWZvcmVIaWRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlSGlkZSA9ICgpID0+IG9mKCcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5iZWZvcmVIaWRlKHRoaXMpXHJcbiAgICAgICAgICAgIC5waXBlKHRha2UoMSkpXHJcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuaGlkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLm1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vdGlmeVNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U2VyLndhcm5pbmcodmFsdWUubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuaW5mbyh2YWx1ZS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrmiJbpmpDol4/kuIvmi4nmoYZcclxuICAgIHByaXZhdGUgaW5pdFRvZ2dsZUFjdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5pc09wZW4kLnBpcGUoXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSgyMCksXHJcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSxcclxuICAgICAgICAgICAgc2tpcCgxKSkuc3Vic2NyaWJlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlYWRvbmx5IHx8IHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQmVmb3JlU2hvdygpLnN1YnNjcmliZSgodikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9fY3JlYXRlUGFuZWwodik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQmVmb3JlSGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NvbWJvUGFuZWxDcmVhdGVkJC5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXHJcbiAgICAgICAgICAgIGZpbHRlcih2YWx1ZSA9PiAhIXZhbHVlKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChjbXA6IEVsZW1lbnRSZWYpID0+IHtcclxuICAgICAgICAgICAgY21wLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuYXBwZW5kQ2hpbGQoY21wLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICBsZXQgdHJhbnNpdGlvbkZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICBjbXAubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSBlLmN1cnJlbnRUYXJnZXQgJiYgdHJhbnNpdGlvbkZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BhbmVsLmVtaXQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb29rdXAoKSkge1xyXG4gICAgICAgICAgICAgICAgY21wLm5hdGl2ZUVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHt0aGlzLnBhbmVsV2lkdGh9cHhgO1xyXG4gICAgICAgICAgICAgICAgY21wLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5wYW5lbEhlaWdodH1weGA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhjbXAubmF0aXZlRWxlbWVudCwgJ2YtYXJlYS1zaG93Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHRoaXMudXBkYXRlUG9zaXRpb24oY21wLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGVzdHJveSQucGlwZSh0YWtlKDEpKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgbmV4dFVuaXF1ZUlkID0gMDtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGFuZWxMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbExpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGRhdGFTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGRhdGFTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGRhdGFTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlUGFuZWxFbGVtZW50KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpZnJhbWVFdmVudEhhbmRsZShhY3Rpb246ICdhZGRFdmVudExpc3RlbmVyJyB8ICdyZW1vdmVFdmVudExpc3RlbmVyJykge1xyXG4gICAgICAgIGNvbnN0IGlmcmFtZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpKTtcclxuICAgICAgICBpZiAoaWZyYW1lcyAmJiBpZnJhbWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlmcmFtZSBvZiBpZnJhbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZnJhbWVEb2MgPSBpZnJhbWUuY29udGVudERvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGlmcmFtZURvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZURvY1thY3Rpb25dKCdtb3VzZWRvd24nLCB0aGlzLl9kb2N1bWVudENsaWNrRXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZURvY1thY3Rpb25dKCdtb3VzZXdoZWVsJywgdGhpcy5fZG9jdW1lbnRDbGlja0V2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBpZnJhbWVEb2NbYWN0aW9uXSgnRE9NTW91c2VTY3JvbGwnLCB0aGlzLl9kb2N1bWVudENsaWNrRXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVtb3ZlRG9jdW1lbnRMaXN0ZW5lcigpIHtcclxuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnRDbGlja0V2ZW50KSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2RvY3VtZW50Q2xpY2tFdmVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNld2hlZWwnLCB0aGlzLl9kb2N1bWVudENsaWNrRXZlbnQsIHRydWUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdET01Nb3VzZVNjcm9sbCcsIHRoaXMuX2RvY3VtZW50Q2xpY2tFdmVudCwgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodG9wICE9PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgICAgIHRvcC5kb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2RvY3VtZW50Q2xpY2tFdmVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lRXZlbnRIYW5kbGUoJ3JlbW92ZUV2ZW50TGlzdGVuZXInKTtcclxuICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnRDbGlja0V2ZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWdpc3RlckRvY3VtZW50RXZlbnQoKSB7XHJcbiAgICAgICAgLy8g5rOo5YaMIG1vdXNlZG93biDkuovku7Yg6ZqQ6JePcGFuZWxcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAodGhpcy5fZG9jdW1lbnRDbGlja0V2ZW50ID0gZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAhdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NtYlBhbmVsICYmXHJcbiAgICAgICAgICAgICAgICAhdGhpcy5jb250YWlucyh0aGlzLl9jbWJQYW5lbCwgZXZlbnQpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UuaXNPcGVuJC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMud2lsbEhpZGUkLm5leHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLCB0cnVlKTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V3aGVlbCcsIHRoaXMuX2RvY3VtZW50Q2xpY2tFdmVudCwgdHJ1ZSk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NTW91c2VTY3JvbGwnLCB0aGlzLl9kb2N1bWVudENsaWNrRXZlbnQsIHRydWUpO1xyXG5cclxuICAgICAgICBpZiAodG9wICE9PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgdG9wLmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fZG9jdW1lbnRDbGlja0V2ZW50LCB0cnVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaWZyYW1lRXZlbnRIYW5kbGUoJ2FkZEV2ZW50TGlzdGVuZXInKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8g5Yib5bu65LiL5ouJ6Z2i5p2/5pe25LqL5Lu2XHJcbiAgICBwcml2YXRlIGluaXRDcmVhdFBhbmVsQWN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhbmVsRWxlbWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY3JlYXRlUGFuZWwoZG9jdW1lbnQuYm9keSk7XHJcbiAgICAgICAgdGhpcy5wYW5lbExpc3RlbmVyID0gdGhpcy5yZW5kZXIubGlzdGVuKHRoaXMucGFuZWxFbGVtZW50LCAnY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZVBhbmVsRWxlbWVudCgpIHtcclxuICAgICAgICByZXFBbmltRnJhbWUoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYW5lbEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5wYW5lbEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0U2VsZWN0aW9uc0NoYW5nZUFjdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zJC5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUuYWN0aW9uID09PSAnaW5pdERhdGEnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uU2VsZWN0aW9uc0NoYW5nZSh0aGlzLnNlbGVjdGlvbnMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdGlvbnNDaGFuZ2VEZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgaW5pdERhdGFzQ2hhbmdlQWN0aW9uKCkgeyB9XHJcblxyXG4gICAgLy8gY2FuTnVsbCDop6PlhrPlj5bmtojpgInkuK3ml7bkvp3nhLbmmL7npLpcclxuICAgIHByaXZhdGUgb25TZWxlY3Rpb25zQ2hhbmdlRGVmYXVsdCgpIHtcclxuXHJcbiAgICAgICAgY29uc3QgX2Rpc3BsYXlUZXh0ID0gdGhpcy5jb21ib1NlcnZpY2UuZ2V0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgIGNvbnN0IF9zZWxlY3RlZFZhbHVlcyA9IHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlKHRoaXMuaWRGaWVsZCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlUZXh0ICE9PSBfZGlzcGxheVRleHQgJiYgIXRoaXMubm9zZWFyY2gpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9IF9kaXNwbGF5VGV4dCB8fCB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlUZXh0ID0gdGhpcy5kaXNwbGF5VGV4dCB8fCAnJztcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRleHQgPSBfc2VsZWN0ZWRWYWx1ZXMgPyBfZGlzcGxheVRleHQgOiB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaW5wdXQpIHtcclxuICAgICAgICAgICAgdGhpcy5pbnB1dC50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQudmFsdWUgPSB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9XHJcbiAgICAgICAgICAgIChfc2VsZWN0ZWRWYWx1ZXMgIT09ICcnICYmIF9zZWxlY3RlZFZhbHVlcyAhPT0gdW5kZWZpbmVkICYmIF9zZWxlY3RlZFZhbHVlcyAhPT0gbnVsbCkgPyBfc2VsZWN0ZWRWYWx1ZXMgOiB0aGlzLnNlbGVjdGVkVmFsdWVzO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuY2RyWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBvblNlbGVjdGlvbnNDaGFuZ2UodjogYW55W10pIHsgfVxyXG5cclxuICAgIHVwZGF0ZU1hcHBpbmdGaWVsZFZhbHVlKGNsZWFyTWFwRmllbGRzID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMubWFwcGluZ0ZpZWxkICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUgJiZcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nRGF0YSA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjbGVhck1hcEZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9ICcnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYmluZGluZ0RhdGEuc2V0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJpbmRpbmdQYXRoID0gdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdQYXRoO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhdGhBcnI6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAoYmluZGluZ1BhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoQXJyID0gYmluZGluZ1BhdGguc3BsaXQoJy8nKS5maWx0ZXIobiA9PiBuICE9PSAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwaW5nRmllbGQgPSB0aGlzLm1hcHBpbmdGaWVsZCA/IHRoaXMubWFwcGluZ0ZpZWxkIDogJyc7XHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nRGF0YS5zZXRWYWx1ZShwYXRoQXJyLmNvbmNhdChtYXBwaW5nRmllbGQuc3BsaXQoJy4nKSksIHRoaXMuc2VsZWN0ZWRWYWx1ZXMsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY29tbW9uVXRpbHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tbW9uVXRpbHMuc2V0VmFsdWUoYmluZGluZ0RhdGEsIHRoaXMubWFwcGluZ0ZpZWxkLCB0aGlzLnNlbGVjdGVkVmFsdWVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAoIWJpbmRpbmdEYXRhLnNldFZhbHVlICYmIHRoaXMuY29tbW9uVXRpbHMpIHtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuY29tbW9uVXRpbHMuc2V0VmFsdWUoYmluZGluZ0RhdGEsIHRoaXMubWFwcGluZ0ZpZWxkLCB0aGlzLnNlbGVjdGVkVmFsdWVzKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTZWxlY3RlZFZhbHVlcygpIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMubWFwcGluZ0ZpZWxkICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUgJiZcclxuICAgICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nRGF0YSA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nRGF0YTtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdEYXRhLmdldFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBiaW5kaW5nUGF0aCA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nUGF0aDtcclxuICAgICAgICAgICAgICAgIGxldCBwYXRoQXJyOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJpbmRpbmdQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aEFyciA9IGJpbmRpbmdQYXRoLnNwbGl0KCcvJykuZmlsdGVyKHZhbHVlID0+IHZhbHVlICE9PSAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwaW5nRmllbGQgPSB0aGlzLm1hcHBpbmdGaWVsZCA/IHRoaXMubWFwcGluZ0ZpZWxkIDogJyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gYmluZGluZ0RhdGEuZ2V0VmFsdWUocGF0aEFyci5jb25jYXQobWFwcGluZ0ZpZWxkLnNwbGl0KCcuJykpKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbW1vblV0aWxzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSh0aGlzLm1hcHBpbmdGaWVsZCwgYmluZGluZ0RhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5tYXBwaW5nRmllbGQpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5zZWxlY3RlZFZhbHVlcyA9IHRoaXMuZGlzcGxheVRleHRcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBvblRleHRDaGFuZ2UodmFsPzogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5pc1RleHRDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLm5vc2VhcmNoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB2YWw7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTWFwcGluZ0ZpZWxkVmFsdWUodGhpcy5pc0xvb2t1cCgpKTtcclxuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZSh2YWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRleHRDaGFuZ2VTdWJqZWN0Lm5leHQodmFsKTtcclxuICAgIH1cclxuXHJcbiAgICBvblZhbHVlQ2hhbmdlKGNoYW5nZXM6IENvbWJvQ2hhbmdlcykge1xyXG4gICAgICAgIHRoaXMuZGlzcGxheVRleHQgPSBjaGFuZ2VzLnRleHQ7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFRleHQgPSB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgIGlmICghdGhpcy51cmkgJiYgdGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGggPiAwICYmICghdGhpc1snZGlzcGxheVR5cGUnXSB8fCB0aGlzLnVzZVZhbHVlKSApIHtcclxuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZSh0aGlzLnNlbGVjdGVkVmFsdWVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuZGlzcGxheVRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiAoIWNoYW5nZXMubm9zZWFyY2gpIHtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KGNoYW5nZXMpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlTWFwcGluZ0ZpZWxkVmFsdWUoKTtcclxuICAgICAgICB0aGlzLm9uVG91Y2hlZCgpO1xyXG4gICAgICAgIC8vIGlmICh0aGlzLmlzT3BlbiAmJiBjaGFuZ2VzLmVtaXRIaWRlUGFuZWwpIHsgdGhpcy53aWxsSGlkZSQubmV4dCgpOyB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWxlY3QoaXRlbTogYW55KSB7IH1cclxuICAgIG9uVW5TZWxlY3RlZChpdGVtOiBhbnkpIHsgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogZW1pdDog6buY6K6k5Li6IHRydWU7XHJcbiAgICAgKi9cclxuICAgIGhpZGUoZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW1vdmVEb2N1bWVudExpc3RlbmVyKCk7XHJcbiAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcclxuICAgICAgICBpZiAoZW1pdCkge1xyXG4gICAgICAgICAgICB0aGlzLndpbGxIaWRlJC5uZXh0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pbml0ZGF0YVN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRkYXRhU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGRhdGFTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbW92ZVBhbmVsRWxlbWVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vbkJlZm9yZVNob3coKS5zdWJzY3JpYmUoKHZhbHVlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fX2NyZWF0ZVBhbmVsKHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVQYW5lbChob3N0OiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMucGFuZWxFbGVtZW50ID0gdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHJcbiAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuaWQgPSBgb3ZlcmxheS0ke25leHRVbmlxdWVJZCsrfWA7XHJcbiAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnb3ZlcmxheS1wYW5lJyk7XHJcblxyXG4gICAgICAgIHRoaXMucGFuZWxFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgIGhvc3QuYXBwZW5kQ2hpbGQodGhpcy5wYW5lbEVsZW1lbnQpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5wYW5lbEVsZW1lbnQgPSB0aGlzLnBhbmVsRWxlbWVudDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNMb29rdXAoKSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IHBhbmVsV2lkdGgsIHRvcCwgbGVmdCB9ID0gdGhpcy5nZXRQYW5lbFNpemUoKTtcclxuICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHt0aGlzLnBhbmVsV2lkdGh9cHhgO1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLnBhbmVsSGVpZ2h0fXB4YDtcclxuICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuc3R5bGUudG9wID0gYCR7dG9wfXB4YDtcclxuICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgO1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsRWxlbWVudC5zdHlsZS56SW5kZXggPSAxMDAwMTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGFuZWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2YtY29tYm8tbG9va3VwJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5wYW5lbEVsZW1lbnQsICd0b3AnLCAnMCcpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnBhbmVsRWxlbWVudCwgJ2xlZnQnLCAnMCcpO1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmLWNvbWJvLWxvb2t1cCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wYW5lbEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UGFuZWxTaXplKHRhcmdldD86IEVsZW1lbnQpIHtcclxuICAgICAgICBsZXQgcGFuZWxIZWlnaHQgPSB0aGlzLnBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuaW5uZXJQYW5lbEhlaWdodCA9IDIwMjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYXV0b1dpZHRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGggfSA9IHRoaXMuZ2V0SW5wdXRTaXplSW5mbygpO1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsV2lkdGggPSB3aWR0aCA/IHdpZHRoIDogdGhpcy5wYW5lbFdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpx0YWdldOmrmOW6puWtmOWcqCDkv67mlLlwbmFlbEhlaWdodCDnlKjkuo7ph43lrprkvY3lvLnlh7rmoYbkvY3nva5cclxuICAgICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC50YWdOYW1lICYmIHBhbmVsSGVpZ2h0ID09PSAnYXV0bycpIHtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0LnNjcm9sbEhlaWdodDtcclxuICAgICAgICAgICAgY29uc3QgaXNOb1JlY29yZCA9ICEhdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5mLXRhYmxlLW5vcmVjb3Jkcy1jb250ZW50Jyk7XHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLnVyaSkge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHRoaXMuY29tYm9TZXJ2aWNlLmRpc3BsYXlUeXBlID09PSAnTElTVCcgJiYgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LWdyb3VwJykpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5pbm5lclBhbmVsSGVpZ2h0ID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LWdyb3VwJylbJ29mZnNldEhlaWdodCddICsgMjtcclxuICAgICAgICAgICAgLy8gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLmlubmVyUGFuZWxIZWlnaHQgPSB0YXJnZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5pbm5lclBhbmVsSGVpZ2h0ID0gdGFyZ2V0SGVpZ2h0ICYmIHRhcmdldEhlaWdodCA+IDEwICYmICFpc05vUmVjb3JkID8gTWF0aC5mbG9vcih0YXJnZXRIZWlnaHQpIDogdGhpcy5wYW5lbEhlaWdodDtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb21ib1NlcnZpY2UuZGlzcGxheVR5cGUgPT09ICdMSVNUJyAmJiB0YXJnZXQucXVlcnlTZWxlY3RvcignLmxpc3QtZ3JvdXAnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5uZXJQYW5lbEhlaWdodCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKCcubGlzdC1ncm91cCcpWydvZmZzZXRIZWlnaHQnXSArIDI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5uZXJQYW5lbEhlaWdodCA9IHRhcmdldEhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCAmJiB0YXJnZXQudGFnTmFtZSAmJiBwYW5lbEhlaWdodCAmJiAhU3RyaW5nKHBhbmVsSGVpZ2h0KS5pbmNsdWRlcygncHgnKSkge1xyXG4gICAgICAgICAgICBwYW5lbEhlaWdodCA9IHBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgeyB0b3AsIGhlaWdodCwgbGVmdCwgcmlnaHQgfSA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBoZWlnaHQgPSBoZWlnaHQgKyAxO1xyXG4gICAgICAgIGNvbnN0IGJvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGhlaWdodCAtIHRvcDtcclxuICAgICAgICBpZiAocGFuZWxIZWlnaHQgPT09ICdhdXRvJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tYXhIZWlnaHQgJiYgdGhpcy5tYXhIZWlnaHQgPiB0aGlzLmlubmVyUGFuZWxIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHBhbmVsSGVpZ2h0ID0gdGhpcy5pbm5lclBhbmVsSGVpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFuZWxIZWlnaHQgPSB0aGlzLm1heEhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaCA9IHRvcCA+IGJvdHRvbSA/IHRvcCA6IGJvdHRvbTtcclxuICAgICAgICBjb25zdCBiZWxvdyA9IGggPT09IGJvdHRvbTtcclxuXHJcbiAgICAgICAgbGV0IGZ4ID0gJ3RvcCc7XHJcbiAgICAgICAgaWYgKGJvdHRvbSA+IHBhbmVsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRvcCA9IHRvcCArIGhlaWdodDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodG9wID4gYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaCA8IHBhbmVsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFuZWxIZWlnaHQgPSBoIC0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wID0gMTA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IHRvcCAtIHBhcnNlSW50KCcnICsgcGFuZWxIZWlnaHQsIDEwKSAtIDU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmeCA9ICdib3R0b20nXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaCA8IHBhbmVsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFuZWxIZWlnaHQgPSBoIC0gMTA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0b3AgPSB0b3AgKyBoZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCAtIGxlZnQgPCB0aGlzLnBhbmVsV2lkdGgpIHtcclxuICAgICAgICAgICAgbGVmdCA9IHJpZ2h0IC0gNDAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgcGFuZWxXaWR0aDogdGhpcy5wYW5lbFdpZHRoLCBwYW5lbEhlaWdodCwgdG9wLCBsZWZ0LCBiZWxvdywgZnggfTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgY29tcGF0aWJsZVNjcm9sbFRvcCgpIHtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudC5zY3JvbGxUb3A7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gTWF0aC5tYXgod2luZG93LnBhZ2VZT2Zmc2V0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCk7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGNvbXBhdGlibGVTY3JvbGxMZWZ0KCkge1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gTWF0aC5tYXgod2luZG93LnBhZ2VYT2Zmc2V0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0KTtcclxuICAgIH1cclxuICAgIC8vIOiuvue9ruW8ueWHuuahhuS9jee9rlxyXG4gICAgdXBkYXRlUG9zaXRpb24odGFyZ2V0OiBhbnkpIHtcclxuICAgICAgICBjb25zdCB7IHBhbmVsSGVpZ2h0LCBsZWZ0LCB0b3AsIGJlbG93LCBmeCB9ID0gdGhpcy5nZXRQYW5lbFNpemUodGFyZ2V0KTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmlzTG9va3VwKCkpIHtcclxuICAgICAgICAgICAgbGV0IF90b3AgPSB0b3A7XHJcbiAgICAgICAgICAgIGxldCBfaGVpZ2h0ID0gcGFuZWxIZWlnaHQ7XHJcbiAgICAgICAgICAgIGlmICh0b3AgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBfaGVpZ2h0ID0gdGhpcy5pbm5lclBhbmVsSGVpZ2h0ICsgdG9wIC0gMTA7XHJcbiAgICAgICAgICAgICAgICBfdG9wID0gMTA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RvcCArPSB0aGlzLmNvbXBhdGlibGVTY3JvbGxUb3AoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBhbmVsSGVpZ2h0ICE9PSAnYXV0bycpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1heEhlaWdodCA8IF9oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heEhlaWdodCA9IF9oZWlnaHQgYXMgbnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbVBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgJ2xlZnQnOiBsZWZ0ICsgdGhpcy5jb21wYXRpYmxlU2Nyb2xsTGVmdCgpLFxyXG4gICAgICAgICAgICAgICAgJ3RvcCc6IF90b3AsXHJcbiAgICAgICAgICAgICAgICAnd2lkdGgnOiB0aGlzLnBhbmVsV2lkdGgsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IF9oZWlnaHQgPT09ICdhdXRvJyA/ICdhdXRvJyA6IF9oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAnbWF4LWhlaWdodCc6IHRoaXMubWF4SGVpZ2h0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb21Qb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICd3aWR0aCc6IHRoaXMucGFuZWxXaWR0aCxcclxuICAgICAgICAgICAgICAgICdoZWlnaHQnOiBwYW5lbEhlaWdodFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBhbmVsRWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICcnO1xyXG4gICAgICAgIHRhcmdldFsnc3R5bGUnXS5kaXNwbGF5ID0gJyc7XHJcblxyXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuY29tUG9zaXRpb24pLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgIGxldCB2YWwgPSB0aGlzLmNvbVBvc2l0aW9uW25dO1xyXG4gICAgICAgICAgICBpZiAodmFsICE9PSAnYXV0bycpIHtcclxuICAgICAgICAgICAgICAgIHZhbCArPSAncHgnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRhcmdldCwgbiwgdmFsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0YXJnZXQuc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gJzEwMCUgJyArIGZ4O1xyXG4gICAgICAgIC8vIHRhcmdldFsnc3R5bGUnXS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbVBvc2l0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnRhaW5zKGVsOiBFbGVtZW50UmVmLCBldmVudDogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIGVsLm5hdGl2ZUVsZW1lbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgZmlsdGVyU2VsZWN0aW9ucyh2YWx1ZTogc3RyaW5nLCBkYXRhOiBhbnlbXSkge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSXRlbXMgPSBTdHJpbmcodmFsdWUpXHJcbiAgICAgICAgICAgIC5zcGxpdCh0aGlzLnNlcGFyYXRvcilcclxuICAgICAgICAgICAgLm1hcChzZWxlY3RlZEl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRhdGEuZmluZCh2YWwgPT4gc2VsZWN0ZWRJdGVtID09IHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUodGhpcy5pZEZpZWxkLCB2YWwpICsgJycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0gPyB0aGlzLmNvbW1vblV0aWxzLmdldFZhbHVlKHRoaXMudGV4dEZpZWxkLCBpdGVtKSA6ICcnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2VsZWN0ZWRJdGVtcy5maWx0ZXIoZWwgPT4gZWwpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCB1cGRhdGVTZWxlY3Rpb25zKHNlbGVjdGVkVmFsdWVzOiBzdHJpbmcsIGRhdGE6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkVmFsdWVzID09PSBudWxsIHx8IHNlbGVjdGVkVmFsdWVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdGVkVmFsdWVzID09PSAnYm9vbGVhbicgfHwgdHlwZW9mIHNlbGVjdGVkVmFsdWVzID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBzZWxlY3RlZFZhbHVlcyA9ICcnICsgc2VsZWN0ZWRWYWx1ZXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzZWxlY3RlZEl0ZW1zID0gc2VsZWN0ZWRWYWx1ZXMgPyBTdHJpbmcoc2VsZWN0ZWRWYWx1ZXMpLnNwbGl0KHRoaXMuc2VwYXJhdG9yKS5tYXAodmFsID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tYm9TZXJ2aWNlLmRpc3BsYXlUeXBlID09PSAnTE9PS1VQVFJFRUxJU1QnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb21ib1NlcnZpY2UudHJlZU5vZGVUb0ZsYXREYXRhKGRhdGEsIHZhbCwgdGhpcy5pZEZpZWxkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZGF0YS5maW5kKF9kYXRhID0+ICcnICsgdmFsID09IHRoaXMuY29tbW9uVXRpbHMuZ2V0VmFsdWUodGhpcy5pZEZpZWxkLCBfZGF0YSkgKyAnJyk7XHJcblxyXG4gICAgICAgIH0pIDogW107XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gc2VsZWN0ZWRJdGVtcyB8fCBbXTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldERpc3BsYXlUZXh0KHZhbHVlLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRJdGVtcyA9IHRoaXMuZmlsdGVyU2VsZWN0aW9ucyh2YWx1ZSwgZGF0YSk7XHJcbiAgICAgICAgICAgIGlmICghc2VsZWN0ZWRJdGVtcyB8fCAhc2VsZWN0ZWRJdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEl0ZW1zLmZpbHRlcih2ID0+ICEhdikuam9pbih0aGlzLnNlcGFyYXRvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGxldCBkYXRhID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRhdGEpIHtcclxuICAgICAgICAgICAgZGF0YSA9ICh0aGlzLmRhdGFbJ2l0ZW1zJ10gYXMgYW55KSBpbnN0YW5jZW9mIEFycmF5ID8gdGhpcy5kYXRhWydpdGVtcyddIDogZGF0YTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub3JpZ2luYWxUZXh0ID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9ICcnO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMudXJpICYmIGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb25zKHZhbHVlLCBkYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9IHRoaXMuZ2V0RGlzcGxheVRleHQodmFsdWUsIHRoaXMuc2VsZWN0aW9ucyB8fCBbXSk7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUZXh0ID0gdGhpcy5kaXNwbGF5VGV4dDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGlzLmRpc3BsYXlUZXh0ID0gdGhpcy5nZXREaXNwbGF5VGV4dCh2YWx1ZSwgdGhpcy5zZWxlY3Rpb25zKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkVmFsdWVzKCk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RlZFZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ3RhZycgJiYgdGhpcy5tdWx0aVNlbGVjdCAmJiAodGhpcy5kaXNwbGF5VGV4dCAhPT0gbnVsbCAmJiB0aGlzLmRpc3BsYXlUZXh0ICE9PSB1bmRlZmluZWQpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eHRBcnIgPSB0aGlzLmRpc3BsYXlUZXh0LnNwbGl0KHRoaXMuc2VwYXJhdG9yKS5maWx0ZXIobiA9PiBuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHR4dEFyci5yZWR1Y2UoKHIsIGMsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByLnB1c2goeyBbdGhpcy50ZXh0RmllbGRdOiBjIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgICAgICAgICAgfSwgW10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25Ub3VjaGVkID0gZm47XHJcbiAgICB9XHJcbiAgICBzZXREaXNhYmxlZFN0YXRlPyhpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsdGVyRGF0YU9uU2VydmVyKHNlYXJjaFZhbHVlLCBzZWFyY2hGaWVsZCkge1xyXG4gICAgfVxyXG59XHJcbiJdfQ==