/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @Company: Inspur
 * @Version: v0.0.15
 * @Date: 2019-04-02 11:48:08
 * @LastEditTime: 2019-10-26 16:38:34
 */
import { Injectable, Injector, NgZone } from "@angular/core";
import { Subject, of } from "rxjs";
import { BsModalService } from "@farris/ui-modal";
import { MessagerDefaultConfig, MESSAGER_DEFAULT_CONFIG, } from "./messager.config";
import { MessagerComponent } from "./messager.component";
import { LocaleService } from "@farris/ui-locale";
import { format } from "date-fns";
export class MessagerService {
    /**
     * @param {?} bsModalService
     * @param {?} injector
     */
    constructor(bsModalService, injector) {
        this.bsModalService = bsModalService;
        this.injector = injector;
        this.version = "0.0.15";
        this.currentId = -1;
        this.modals = [];
        this.defaultMessagerConfig = null;
        /** @type {?} */
        const config = this.injector.get(MESSAGER_DEFAULT_CONFIG) || MessagerDefaultConfig;
        this.defaultMessagerConfig = Object.assign({}, MessagerDefaultConfig, config);
        this.ngZone = this.injector.get(NgZone);
        this.localeService = this.injector.get(LocaleService);
    }
    /**
     * @return {?}
     */
    get okText() {
        return this.localeService.getValue("messager.ok");
    }
    /**
     * @return {?}
     */
    get cancelText() {
        return this.localeService.getValue("messager.cancel");
    }
    /**
     * @return {?}
     */
    get yesText() {
        return this.localeService.getValue("messager.yes");
    }
    /**
     * @return {?}
     */
    get noText() {
        return this.localeService.getValue("messager.no");
    }
    /**
     * @return {?}
     */
    get titleText() {
        return this.localeService.getValue("messager.title");
    }
    /**
     * @return {?}
     */
    get errorTitle() {
        return this.localeService.getValue("messager.errorTitle");
    }
    /**
     * @param {?} str
     * @return {?}
     */
    escapeHtml(str) {
        if (str === null || str === undefined) {
            return "";
        }
        return str
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/\"/g, "&quot;")
            .replace(/\'/g, "&#39;")
            .replace(/\//g, "&#x2F;");
    }
    /**
     * 显示信息提示框
     * @param {?} msgtype 消息类别
     * @param {?} message 提示消息一
     * @param {?=} opts 参数 提供属性 fitContent:true支持自动适应宽度
     * @param {?=} submsg 提示消息二级
     * @return {?}
     */
    show(msgtype, message, opts, submsg = "") {
        if (document.activeElement) {
            ((/** @type {?} */ (document.activeElement))).blur();
        }
        /** @type {?} */
        const modalHeight = 180;
        /** @type {?} */
        let defaultOpts = {
            safeHtml: true,
            title: this.titleText,
            width: 390,
            height: modalHeight,
            showButtons: false,
            showMaxButton: false,
            resizable: false,
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    this.close();
                }),
            },
            class: "modal-message " +
                (msgtype ? "modal-message-type-" + msgtype : ""),
            showHeader: false,
        };
        defaultOpts = Object.assign({}, this.defaultMessagerConfig, defaultOpts);
        /** @type {?} */
        let extendOpts = {};
        switch (msgtype) {
            case "prompt":
                // 弹出对话类型
                extendOpts = { showHeader: true, modalHeight: 260 };
                break;
            case "error":
                // 错误
                extendOpts = {
                    title: this.errorTitle,
                    width: 446,
                    showHeader: true,
                    showMaxButton: true,
                    fitContent: true,
                };
                break;
            case "exception":
                extendOpts = {
                    safeHtml: false,
                    title: this.errorTitle,
                    width: 446,
                    showHeader: true,
                    fitContent: true,
                };
                break;
            default:
                // 默认其他
                extendOpts = { width: submsg ? 446 : 390, fitContent: true };
        }
        Object.assign(defaultOpts, extendOpts);
        if (opts) {
            Object.assign(defaultOpts, opts);
        }
        if (message && defaultOpts.safeHtml) {
            message = this.escapeHtml(message);
        }
        Object.assign(defaultOpts.initialState, {
            type: msgtype,
            message,
            msg: submsg,
            exception: opts && opts["exception"] ? opts["exception"] : null,
            showLines: opts && opts["showLines"] ? opts["showLines"] : 3,
            readonly: opts && opts["readonly"] ? opts["readonly"] : false,
        });
        if (defaultOpts["buttons"] && defaultOpts["buttons"].length) {
            if (!defaultOpts.initialState["buttons"] ||
                !defaultOpts.initialState["buttons"].length) {
                defaultOpts.initialState["buttons"] = defaultOpts["buttons"];
            }
        }
        /** @type {?} */
        const _modal = this.bsModalService.show(MessagerComponent, defaultOpts);
        // _modal.content.buttons = defaultOpts['buttons'] || [];
        this.confirmSubject = new Subject();
        if (this.modals.length > 0) {
            /** @type {?} */
            const modalContainerComponent = _modal.dialog;
            modalContainerComponent.instance.isShown = true;
            modalContainerComponent.instance.moveTo(15 * this.modals.length, 15 * this.modals.length);
        }
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            // 第1个按钮获取焦点
            setTimeout((/**
             * @return {?}
             */
            () => {
                /** @type {?} */
                const btnOk = _modal.content.btnOkEl
                    ? _modal.content.btnOkEl.nativeElement
                    : null;
                if (btnOk) {
                    btnOk["focus"]();
                }
                else {
                    /** @type {?} */
                    const btns = _modal.dialog.location.nativeElement.querySelectorAll(".modal-footer button");
                    if (btns.length) {
                        btns.item(0)["focus"]();
                    }
                }
                /** @type {?} */
                const overlays = Array.from(document.body.querySelectorAll('body>div, body>farris-dialog>.farris-modal,body>.farris-modal')).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n)).map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return window.getComputedStyle(n).zIndex;
                })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n && n !== 'auto')).map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return parseInt(n, 10);
                }));
                /** @type {?} */
                const maxZindex = Math.max(...overlays);
                _modal.dialog.location.nativeElement.style.zIndex = maxZindex + 1;
            }));
        }));
        this.msgMgr(_modal);
        return _modal;
    }
    /**
     * @private
     * @param {?} ref
     * @return {?}
     */
    msgMgr(ref) {
        /** @type {?} */
        const id = this.bsModalService.getModalsCount() + 1000;
        if (this.modals.length === 0) {
            this.modals.push({ id, ref });
        }
        else {
            if (!this.getModalById(id)) {
                this.modals.push({ id, ref });
            }
            else {
                this.getModalById(id).ref = ref;
            }
        }
        /** @type {?} */
        const cmp = this.getModalCmp();
        cmp.closed.subscribe((/**
         * @param {?} level
         * @return {?}
         */
        (level) => {
            this.removeMessager(id);
            this.confirmSubject.unsubscribe();
        }));
        this.currentId = id;
    }
    /**
     * @param {?} message
     * @param {?} okCallback
     * @param {?=} cancelCallback
     * @param {?=} msg
     * @param {?=} fitContent
     * @return {?}
     */
    question(message, okCallback, cancelCallback, msg, fitContent = true) {
        /** @type {?} */
        const questionDlg = this.show("question", message, {
            initialState: {
                okText: this.yesText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    questionDlg.close();
                    if (okCallback) {
                        okCallback();
                    }
                }),
                cancelText: this.noText,
                cancelHandle: (/**
                 * @return {?}
                 */
                () => {
                    questionDlg.close();
                    if (cancelCallback) {
                        cancelCallback();
                    }
                }),
            },
            fitContent,
        }, msg);
        return questionDlg;
    }
    /**
     * @param {?} messager
     * @param {?} btns
     * @param {?=} msg
     * @param {?=} fitContent
     * @return {?}
     */
    question2(messager, btns, msg, fitContent = true) {
        return this.show("question", messager, {
            initialState: {
                buttons: btns,
            },
            fitContent,
        }, msg);
    }
    /**
     * 2020年3月7日因为textarea高度在不同浏览器下不一样，固定高度可能会出现滚动条
     * @param {?} title 标题
     * @param {?=} msg 信息
     * @param {?=} fitContent 自适应内容
     * @return {?}
     */
    prompt(title, msg, fitContent = true) {
        /** @type {?} */
        const promptSubject = new Subject();
        /** @type {?} */
        const dlg = this.show("prompt", msg, {
            title,
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    /** @type {?} */
                    const mc = (/** @type {?} */ (dlg.content));
                    dlg.close();
                    promptSubject.next(mc.promptText.nativeElement.value);
                }),
                cancelText: this.cancelText,
                cancelHandle: (/**
                 * @return {?}
                 */
                () => {
                    dlg.close();
                    promptSubject.next(false);
                }),
            },
            fitContent,
            closed: (/**
             * @return {?}
             */
            () => {
                promptSubject.unsubscribe();
            }),
        }, msg);
        return promptSubject;
    }
    /**
     * @param {?} title
     * @param {?=} msg
     * @param {?=} opts
     * @return {?}
     */
    prompt2(title, msg, opts) {
        /** @type {?} */
        const promptSubject = new Subject();
        /** @type {?} */
        const _opts = {
            showOkButton: true,
            showCloseButton: true,
            showFontSize: false,
            fontSize: 18,
            readonly: false,
            saveSize: false,
            closeWhenever: true,
        };
        if (!opts) {
            opts = _opts;
        }
        else {
            opts = Object.assign(_opts, opts);
        }
        /** @type {?} */
        const _dialogOpts = {
            title,
            initialState: {
                showOkButton: opts.showOkButton === undefined ? true : opts.showOkButton,
                showCancelButton: opts.showCancelButton === undefined
                    ? true
                    : opts.showCancelButton,
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    /** @type {?} */
                    const mc = (/** @type {?} */ (dlg.content));
                    /** @type {?} */
                    const val = mc.promptText.nativeElement.value;
                    if (opts.closeWhenever) {
                        dlg.close();
                        promptSubject.next(val);
                    }
                    else {
                        promptSubject.next({ val, dlg });
                    }
                }),
                cancelText: this.cancelText,
                cancelHandle: (/**
                 * @return {?}
                 */
                () => {
                    dlg.close();
                    promptSubject.next(false);
                }),
                showFontSize: opts.showFontSize,
                fontSize: opts.fontSize || 18,
                enableWordCount: !!opts.enableWordCount,
                countType: opts.countType || "length",
                maxLength: opts.maxLength,
                inputType: opts.inputType || "textarea",
                placeholder: opts.placeholder || "",
            },
            fitContent: false,
            showMaxButton: true,
            resizable: true,
            class: "",
            closed: (/**
             * @return {?}
             */
            () => {
                promptSubject.unsubscribe();
            }),
            opened: (/**
             * @return {?}
             */
            () => {
                if (opts.inputType !== "textarea") {
                    return;
                }
                else {
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        /** @type {?} */
                        const textareaEle = dlg.content.promptText.nativeElement;
                        textareaEle.closest("section").style.padding = "15px";
                        textareaEle.style.resize = "none";
                        textareaEle.style.height = "100%";
                        if (opts.readonly) {
                            textareaEle.readOnly = true;
                        }
                    }));
                }
            }),
            beforeClose: (/**
             * @param {?} modalRef
             * @return {?}
             */
            (modalRef) => {
                if (opts.saveSize && !dlg.dialog.instance.isMax) {
                    /** @type {?} */
                    const data = {
                        fontSize: dlg.content.fontSize,
                        width: modalRef.config.width,
                        height: modalRef.config.height,
                    };
                    this.saveTextAreaSizeInfo(data);
                }
                return of(true);
            }),
        };
        /** @type {?} */
        let dialogOpts = _dialogOpts;
        if (opts) {
            dialogOpts = Object.assign(dialogOpts, opts);
        }
        /** @type {?} */
        const dlg = this.show("prompt", msg, dialogOpts, msg);
        if (opts.inputType && dlg.content.promptText) {
            dlg.content.promptText.nativeElement.focus();
        }
        return promptSubject;
    }
    /**
     * @return {?}
     */
    getKeyString() {
        // 一台终端共用一个配置
        // 保留最后一次的设置，
        // 保存窗口大小，字体大小
        return "IGIX-FARRIS-UI-TEXTAREA-ZOOM-SETTINGS";
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    saveTextAreaSizeInfo(data) {
        if (window.localStorage) {
            /** @type {?} */
            const key = this.getKeyString();
            localStorage.setItem(key, JSON.stringify(data));
        }
    }
    /**
     * @param {?} message
     * @param {?=} msg
     * @param {?=} fitContent
     * @return {?}
     */
    confirm(message, msg, fitContent = true) {
        /** @type {?} */
        const confirmSubject = new Subject();
        /** @type {?} */
        const _msg = typeof msg === "number" ? null : msg;
        /** @type {?} */
        const confirmDlg = this.show("question", message, {
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    confirmDlg.close();
                    confirmSubject.next(true);
                }),
                cancelText: this.cancelText,
                cancelHandle: (/**
                 * @return {?}
                 */
                () => {
                    confirmDlg.close();
                    confirmSubject.next(false);
                }),
            },
            fitContent,
            closed: (/**
             * @return {?}
             */
            () => {
                confirmSubject.unsubscribe();
            }),
        }, _msg);
        if (msg && typeof msg === "number") {
            confirmDlg.dialog.location.nativeElement.style.zIndex = msg;
        }
        return confirmSubject.asObservable();
    }
    /**
     * @param {?} message
     * @param {?=} callback
     * @param {?=} msg
     * @param {?=} fitContent
     * @return {?}
     */
    info(message, callback, msg, fitContent = true) {
        /** @type {?} */
        const infoDlg = this.show("info", message, {
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    infoDlg.close();
                    if (callback) {
                        callback();
                    }
                }),
            },
            fitContent,
        }, msg);
        return infoDlg;
    }
    /**
     * 操作成功提示，
     * message: 提示信息
     * msg: 2级信息
     * fitCountent: 默认为true
     * callback: 确定事件回调
     * @param {?} message
     * @param {?=} msg
     * @param {?=} fitContent
     * @param {?=} callback
     * @return {?}
     */
    success(message, msg, fitContent = true, callback = null) {
        /** @type {?} */
        const successDlg = this.show("success", message, {
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    successDlg.close();
                    if (callback) {
                        callback();
                    }
                }),
            },
            fitContent,
        }, msg);
        return successDlg;
    }
    /**
     * 提示错误信息，
     * message: 提示信息
     * msg: 2级信息
     * fitCountent: 默认为true
     * callback: 确定事件回调
     * @param {?} message
     * @param {?=} msg
     * @param {?=} fitContent
     * @param {?=} callback
     * @param {?=} safeHtml
     * @return {?}
     */
    error(message, msg, fitContent = true, callback = null, safeHtml = true) {
        /** @type {?} */
        const errorDlg = this.show("error", message, {
            safeHtml,
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    errorDlg.close();
                    if (callback) {
                        callback();
                    }
                }),
            },
            fitContent,
        }, msg);
        return errorDlg;
    }
    /**
     * @param {?} message
     * @param {?=} msg
     * @param {?=} fitContent
     * @param {?=} callback
     * @return {?}
     */
    warning(message, msg, fitContent = true, callback = null) {
        /** @type {?} */
        const warningDlg = this.show("warning", message, {
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    warningDlg.close();
                    if (callback) {
                        callback();
                    }
                }),
            },
            fitContent,
        }, msg);
        return warningDlg;
    }
    /**
     * @param {?} type
     * @param {?} title
     * @param {?=} message
     * @param {?=} callback
     * @return {?}
     */
    showHtmlMsg(type, title, message, callback = null) {
        /** @type {?} */
        const msgDlg = this.show(type, title, {
            safeHtml: false,
            initialState: {
                okText: this.okText,
                okHandle: (/**
                 * @return {?}
                 */
                () => {
                    msgDlg.close();
                    if (callback) {
                        callback();
                    }
                }),
            },
            fitContent: true,
        }, message);
        return msgDlg;
    }
    /**
     * @private
     * @return {?}
     */
    close() {
        if (this.modals.length) {
            /** @type {?} */
            const msgbox = this.getModalById(this.currentId);
            if (msgbox) {
                msgbox.ref.close();
            }
        }
    }
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    getModalById(id) {
        return this.modals.find((/**
         * @param {?} item
         * @return {?}
         */
        (item) => item.id === id));
    }
    /**
     * @private
     * @return {?}
     */
    getModalCmp() {
        return this.bsModalService.getCurrentModalContainer().instance;
    }
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    removeMessager(id) {
        this.modals = this.modals.filter((/**
         * @param {?} n
         * @return {?}
         */
        (n) => n.id !== id));
        if (!this.modals.length) {
            this.currentId = -1;
        }
        else {
            this.currentId = this.modals[this.modals.length - 1].id;
        }
    }
    /**
     * @private
     * @param {?} text
     * @return {?}
     */
    copyToClipboard(text) {
        /** @type {?} */
        const windowRef = window;
        if (windowRef.clipboardData && windowRef.clipboardData.setData) {
            return windowRef.clipboardData.setData("Text", text);
        }
        else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
            /** @type {?} */
            var textarea = document.createElement("textarea");
            textarea.textContent = text;
            textarea.style.position = "fixed";
            document.body.appendChild(textarea);
            textarea.select();
            try {
                return document.execCommand("copy");
            }
            catch (ex) {
            }
            finally {
                document.body.removeChild(textarea);
            }
        }
        return false;
    }
    /**
     * @param {?} error
     * @param {?=} opts
     * @return {?}
     */
    exception(error, opts = { width: 440, height: 200, log: false }) {
        /** @type {?} */
        const exceptionMsg = error.Message || "";
        /** @type {?} */
        const date = error.date || format(new Date(), 'yyyy-MM-dd HH:mm:ss');
        /** @type {?} */
        const localDate = date;
        // 发生时间
        /** @type {?} */
        const happenedTime = this.localeService.getValue('messager.exception.happend');
        // 详细信息
        /** @type {?} */
        const detailInfo = this.localeService.getValue('messager.exception.detail');
        /** @type {?} */
        const detail = error.Detail ||
            `${error.Message}\r\n${happenedTime}：${localDate}\r\n${detailInfo}：${error.innerMessage}` ||
            "";
        /** @type {?} */
        const innerMessage = error.innerMessage || null;
        /** @type {?} */
        const defaultOptions = { width: 440, height: 200, log: false };
        /** @type {?} */
        let exoptions = defaultOptions;
        if (opts) {
            exoptions = Object.assign({}, defaultOptions, opts);
        }
        /** @type {?} */
        let bsModalRef;
        /** @type {?} */
        const options = {
            showMaxButton: false,
            buttons: [
                {
                    text: this.localeService.getValue('messager.exception.roger'),
                    cls: "btn btn-primary btn-lg",
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        bsModalRef.close();
                    }),
                },
            ],
            // showHeader: false,
            width: exoptions.width,
            height: exoptions.height,
            safeHtml: false,
            exception: {
                date: localDate,
                message: innerMessage,
                copyButton: {
                    text: this.localeService.getValue('messager.exception.copy'),
                    onClick: (/**
                     * @param {?} e
                     * @return {?}
                     */
                    (e) => {
                        /** @type {?} */
                        const result = this.copyToClipboard(detail);
                        /** @type {?} */
                        const text = result
                            ? this.localeService.getValue('messager.exception.copySuccess')
                            : this.localeService.getValue('messager.exception.copyFailed');
                        bsModalRef.content.showMiniNotify(text, 1500);
                    }),
                },
            },
        };
        if (exoptions.log) {
            console.error(error);
        }
        // this.displayError(error);
        bsModalRef = this.show("exception", exceptionMsg, options);
    }
}
MessagerService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
MessagerService.ctorParameters = () => [
    { type: BsModalService },
    { type: Injector }
];
if (false) {
    /** @type {?} */
    MessagerService.prototype.version;
    /** @type {?} */
    MessagerService.prototype.currentId;
    /** @type {?} */
    MessagerService.prototype.modals;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.defaultMessagerConfig;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.confirmSubject;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.bsModalService;
    /**
     * @type {?}
     * @private
     */
    MessagerService.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZXIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbWVzc2FnZXIvIiwic291cmNlcyI6WyJsaWIvbWVzc2FnZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFTQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0QsT0FBTyxFQUFFLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0MsT0FBTyxFQUFFLGNBQWMsRUFBNEIsTUFBTSxrQkFBa0IsQ0FBQztBQUM1RSxPQUFPLEVBRUgscUJBQXFCLEVBQ3JCLHVCQUF1QixHQUUxQixNQUFNLG1CQUFtQixDQUFDO0FBQzNCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBR2xDLE1BQU0sT0FBTyxlQUFlOzs7OztJQVd4QixZQUNZLGNBQThCLEVBQzlCLFFBQWtCO1FBRGxCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBWjlCLFlBQU8sR0FBRyxRQUFRLENBQUM7UUFDbkIsY0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2YsV0FBTSxHQUFzQyxFQUFFLENBQUM7UUFDdkMsMEJBQXFCLEdBQW1CLElBQUksQ0FBQzs7Y0FXM0MsTUFBTSxHQUNSLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDLElBQUkscUJBQXFCO1FBQ3ZFLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUN0QyxFQUFFLEVBQ0YscUJBQXFCLEVBQ3JCLE1BQU0sQ0FDVCxDQUFDO1FBQ0YsSUFBSSxDQUFDLE1BQU0sR0FB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QUFnQyxDQUFDOzRCQUMvRCxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsK0JBQStCLENBQUM7d0JBQ2xFLFVBQVUsQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztvQkFDbEQsQ0FBQyxDQUFBO2lCQUNKO2FBQ0o7U0FDSjtRQUNELElBQUksU0FBUyxDQUFDLEdBQUcsRUFBRTtZQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDeEI7UUFDRCw0QkFBNEI7UUFDNUIsVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQ2xCLFdBQVcsRUFDWCxZQUFZLEVBQ1osT0FBTyxDQUNWLENBQUM7SUFDTixDQUFDOzs7WUF0c0JKLFVBQVU7Ozs7WUFaRixjQUFjO1lBRkYsUUFBUTs7OztJQWdCekIsa0NBQW1COztJQUNuQixvQ0FBZTs7SUFDZixpQ0FBK0M7Ozs7O0lBQy9DLGdEQUFxRDs7Ozs7SUFFckQseUNBQXVCOzs7OztJQUN2QixpQ0FBdUI7Ozs7O0lBRXZCLHdDQUFxQzs7Ozs7SUFHakMseUNBQXNDOzs7OztJQUN0QyxtQ0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBAQ29tcGFueTogSW5zcHVyXHJcbiAqIEBWZXJzaW9uOiB2MC4wLjE1XHJcbiAqIEBEYXRlOiAyMDE5LTA0LTAyIDExOjQ4OjA4XHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTAtMjYgMTY6Mzg6MzRcclxuICovXHJcblxyXG5pbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3RvciwgTmdab25lIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgQnNNb2RhbFJlZiwgRGlhbG9nQnV0dG9uIH0gZnJvbSBcIkBmYXJyaXMvdWktbW9kYWxcIjtcclxuaW1wb3J0IHtcclxuICAgIE1lc3NhZ2VyQ29uZmlnLFxyXG4gICAgTWVzc2FnZXJEZWZhdWx0Q29uZmlnLFxyXG4gICAgTUVTU0FHRVJfREVGQVVMVF9DT05GSUcsXHJcbiAgICBTZXJ2ZXJFeGNlcHRpb25FbnRpdHksXHJcbn0gZnJvbSBcIi4vbWVzc2FnZXIuY29uZmlnXCI7XHJcbmltcG9ydCB7IE1lc3NhZ2VyQ29tcG9uZW50IH0gZnJvbSBcIi4vbWVzc2FnZXIuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1sb2NhbGVcIjtcclxuaW1wb3J0IHsgdW5lc2NhcGVJZGVudGlmaWVyIH0gZnJvbSBcIkBhbmd1bGFyL2NvbXBpbGVyXCI7XHJcbmltcG9ydCB7IGZvcm1hdCB9IGZyb20gXCJkYXRlLWZuc1wiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgTWVzc2FnZXJTZXJ2aWNlIHtcclxuICAgIHZlcnNpb24gPSBcIjAuMC4xNVwiO1xyXG4gICAgY3VycmVudElkID0gLTE7XHJcbiAgICBtb2RhbHM6IHsgaWQ6IG51bWJlcjsgcmVmOiBCc01vZGFsUmVmIH1bXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBkZWZhdWx0TWVzc2FnZXJDb25maWc6IE1lc3NhZ2VyQ29uZmlnID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIGNvbmZpcm1TdWJqZWN0O1xyXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZTtcclxuXHJcbiAgICBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBic01vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3JcclxuICAgICkge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9XHJcbiAgICAgICAgICAgIHRoaXMuaW5qZWN0b3IuZ2V0KE1FU1NBR0VSX0RFRkFVTFRfQ09ORklHKSB8fCBNZXNzYWdlckRlZmF1bHRDb25maWc7XHJcbiAgICAgICAgdGhpcy5kZWZhdWx0TWVzc2FnZXJDb25maWcgPSBPYmplY3QuYXNzaWduKFxyXG4gICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgTWVzc2FnZXJEZWZhdWx0Q29uZmlnLFxyXG4gICAgICAgICAgICBjb25maWdcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMubmdab25lID0gdGhpcy5pbmplY3Rvci5nZXQoTmdab25lKTtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGVTZXJ2aWNlKTtcclxuICAgIH1cclxuICAgIGdldCBva1RleHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm1lc3NhZ2VyLm9rXCIpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGNhbmNlbFRleHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm1lc3NhZ2VyLmNhbmNlbFwiKTtcclxuICAgIH1cclxuICAgIGdldCB5ZXNUZXh0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJtZXNzYWdlci55ZXNcIik7XHJcbiAgICB9XHJcbiAgICBnZXQgbm9UZXh0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJtZXNzYWdlci5ub1wiKTtcclxuICAgIH1cclxuICAgIGdldCB0aXRsZVRleHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm1lc3NhZ2VyLnRpdGxlXCIpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGVycm9yVGl0bGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm1lc3NhZ2VyLmVycm9yVGl0bGVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZXNjYXBlSHRtbChzdHIpIHtcclxuICAgICAgICBpZiAoc3RyID09PSBudWxsIHx8IHN0ciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mL2csIFwiJmFtcDtcIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8+L2csIFwiJmd0O1wiKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxcIi9nLCBcIiZxdW90O1wiKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwnL2csIFwiJiMzOTtcIilcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcLy9nLCBcIiYjeDJGO1wiKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuS/oeaBr+aPkOekuuahhlxyXG4gICAgICogQHBhcmFtIG1zZ3R5cGUg5raI5oGv57G75YirXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSDmj5DnpLrmtojmga/kuIBcclxuICAgICAqIEBwYXJhbSBvcHRzIOWPguaVsCDmj5DkvpvlsZ7mgKcgZml0Q29udGVudDp0cnVl5pSv5oyB6Ieq5Yqo6YCC5bqU5a695bqmXHJcbiAgICAgKiBAcGFyYW0gc3VibXNnIOaPkOekuua2iOaBr+S6jOe6p1xyXG4gICAgICovXHJcbiAgICBzaG93KG1zZ3R5cGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBvcHRzPzoge30sIHN1Ym1zZyA9IFwiXCIpIHtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBhcyBhbnkpLmJsdXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbW9kYWxIZWlnaHQgPSAxODA7XHJcbiAgICAgICAgbGV0IGRlZmF1bHRPcHRzID0ge1xyXG4gICAgICAgICAgICBzYWZlSHRtbDogdHJ1ZSxcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGVUZXh0LFxyXG4gICAgICAgICAgICB3aWR0aDogMzkwLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IG1vZGFsSGVpZ2h0LFxyXG4gICAgICAgICAgICBzaG93QnV0dG9uczogZmFsc2UsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIG9rVGV4dDogdGhpcy5va1RleHQsXHJcbiAgICAgICAgICAgICAgICBva0hhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNsYXNzOlxyXG4gICAgICAgICAgICAgICAgXCJtb2RhbC1tZXNzYWdlIFwiICtcclxuICAgICAgICAgICAgICAgIChtc2d0eXBlID8gXCJtb2RhbC1tZXNzYWdlLXR5cGUtXCIgKyBtc2d0eXBlIDogXCJcIiksXHJcbiAgICAgICAgICAgIHNob3dIZWFkZXI6IGZhbHNlLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZGVmYXVsdE9wdHMgPSBPYmplY3QuYXNzaWduKFxyXG4gICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0TWVzc2FnZXJDb25maWcsXHJcbiAgICAgICAgICAgIGRlZmF1bHRPcHRzXHJcbiAgICAgICAgKTtcclxuICAgICAgICBsZXQgZXh0ZW5kT3B0cyA9IHt9O1xyXG5cclxuICAgICAgICBzd2l0Y2ggKG1zZ3R5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcInByb21wdFwiOlxyXG4gICAgICAgICAgICAgICAgLy8g5by55Ye65a+56K+d57G75Z6LXHJcbiAgICAgICAgICAgICAgICBleHRlbmRPcHRzID0geyBzaG93SGVhZGVyOiB0cnVlLCBtb2RhbEhlaWdodDogMjYwIH07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XHJcbiAgICAgICAgICAgICAgICAvLyDplJnor69cclxuICAgICAgICAgICAgICAgIGV4dGVuZE9wdHMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuZXJyb3JUaXRsZSxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogNDQ2LFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3dIZWFkZXI6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmaXRDb250ZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiZXhjZXB0aW9uXCI6XHJcbiAgICAgICAgICAgICAgICBleHRlbmRPcHRzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNhZmVIdG1sOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5lcnJvclRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiA0NDYsXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0hlYWRlcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmaXRDb250ZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgLy8g6buY6K6k5YW25LuWXHJcbiAgICAgICAgICAgICAgICBleHRlbmRPcHRzID0geyB3aWR0aDogc3VibXNnID8gNDQ2IDogMzkwLCBmaXRDb250ZW50OiB0cnVlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIE9iamVjdC5hc3NpZ24oZGVmYXVsdE9wdHMsIGV4dGVuZE9wdHMpO1xyXG4gICAgICAgIGlmIChvcHRzKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGVmYXVsdE9wdHMsIG9wdHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG1lc3NhZ2UgJiYgZGVmYXVsdE9wdHMuc2FmZUh0bWwpIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IHRoaXMuZXNjYXBlSHRtbChtZXNzYWdlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIE9iamVjdC5hc3NpZ24oZGVmYXVsdE9wdHMuaW5pdGlhbFN0YXRlLCB7XHJcbiAgICAgICAgICAgIHR5cGU6IG1zZ3R5cGUsXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIG1zZzogc3VibXNnLFxyXG4gICAgICAgICAgICBleGNlcHRpb246IG9wdHMgJiYgb3B0c1tcImV4Y2VwdGlvblwiXSA/IG9wdHNbXCJleGNlcHRpb25cIl0gOiBudWxsLFxyXG4gICAgICAgICAgICBzaG93TGluZXM6IG9wdHMgJiYgb3B0c1tcInNob3dMaW5lc1wiXSA/IG9wdHNbXCJzaG93TGluZXNcIl0gOiAzLFxyXG4gICAgICAgICAgICByZWFkb25seTogb3B0cyAmJiBvcHRzW1wicmVhZG9ubHlcIl0gPyBvcHRzW1wicmVhZG9ubHlcIl0gOiBmYWxzZSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGRlZmF1bHRPcHRzW1wiYnV0dG9uc1wiXSAmJiBkZWZhdWx0T3B0c1tcImJ1dHRvbnNcIl0ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICFkZWZhdWx0T3B0cy5pbml0aWFsU3RhdGVbXCJidXR0b25zXCJdIHx8XHJcbiAgICAgICAgICAgICAgICAhZGVmYXVsdE9wdHMuaW5pdGlhbFN0YXRlW1wiYnV0dG9uc1wiXS5sZW5ndGhcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0T3B0cy5pbml0aWFsU3RhdGVbXCJidXR0b25zXCJdID0gZGVmYXVsdE9wdHNbXCJidXR0b25zXCJdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IF9tb2RhbCA9IHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2hvdyhNZXNzYWdlckNvbXBvbmVudCwgZGVmYXVsdE9wdHMpO1xyXG4gICAgICAgIC8vIF9tb2RhbC5jb250ZW50LmJ1dHRvbnMgPSBkZWZhdWx0T3B0c1snYnV0dG9ucyddIHx8IFtdO1xyXG4gICAgICAgIHRoaXMuY29uZmlybVN1YmplY3QgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGFscy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsQ29udGFpbmVyQ29tcG9uZW50ID0gX21vZGFsLmRpYWxvZztcclxuICAgICAgICAgICAgbW9kYWxDb250YWluZXJDb21wb25lbnQuaW5zdGFuY2UuaXNTaG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIG1vZGFsQ29udGFpbmVyQ29tcG9uZW50Lmluc3RhbmNlLm1vdmVUbyhcclxuICAgICAgICAgICAgICAgIDE1ICogdGhpcy5tb2RhbHMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgMTUgKiB0aGlzLm1vZGFscy5sZW5ndGhcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgLy8g56ysMeS4quaMiemSruiOt+WPlueEpueCuVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJ0bk9rID0gX21vZGFsLmNvbnRlbnQuYnRuT2tFbFxyXG4gICAgICAgICAgICAgICAgICAgID8gX21vZGFsLmNvbnRlbnQuYnRuT2tFbC5uYXRpdmVFbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJ0bk9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnRuT2tbXCJmb2N1c1wiXSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBidG5zID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX21vZGFsLmRpYWxvZy5sb2NhdGlvbi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi5tb2RhbC1mb290ZXIgYnV0dG9uXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYnRucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnRucy5pdGVtKDApW1wiZm9jdXNcIl0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3ZlcmxheXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnYm9keT5kaXYsIGJvZHk+ZmFycmlzLWRpYWxvZz4uZmFycmlzLW1vZGFsLGJvZHk+LmZhcnJpcy1tb2RhbCcpKS5maWx0ZXIobiA9PiBuKS5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG4pLnpJbmRleDtcclxuICAgICAgICAgICAgICAgIH0pLmZpbHRlcihuID0+IG4gJiYgbiE9PSAnYXV0bycpLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQobiwgMTApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhaaW5kZXggPSBNYXRoLm1heCguLi5vdmVybGF5cyk7XHJcbiAgICAgICAgICAgICAgICBfbW9kYWwuZGlhbG9nLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gbWF4WmluZGV4ICsgMTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMubXNnTWdyKF9tb2RhbCk7XHJcbiAgICAgICAgcmV0dXJuIF9tb2RhbDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG1zZ01ncihyZWY6IEJzTW9kYWxSZWYpIHtcclxuICAgICAgICBjb25zdCBpZCA9IHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKSArIDEwMDA7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kYWxzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFscy5wdXNoKHsgaWQsIHJlZiB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0TW9kYWxCeUlkKGlkKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RhbHMucHVzaCh7IGlkLCByZWYgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldE1vZGFsQnlJZChpZCkucmVmID0gcmVmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjbXAgPSB0aGlzLmdldE1vZGFsQ21wKCk7XHJcblxyXG4gICAgICAgIGNtcC5jbG9zZWQuc3Vic2NyaWJlKChsZXZlbDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTWVzc2FnZXIoaWQpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpcm1TdWJqZWN0LnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudElkID0gaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcXVlc3Rpb24oXHJcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxyXG4gICAgICAgIG9rQ2FsbGJhY2s6ICgpID0+IHZvaWQsXHJcbiAgICAgICAgY2FuY2VsQ2FsbGJhY2s/OiAoKSA9PiB2b2lkLFxyXG4gICAgICAgIG1zZz86IHN0cmluZyxcclxuICAgICAgICBmaXRDb250ZW50ID0gdHJ1ZVxyXG4gICAgKSB7XHJcbiAgICAgICAgY29uc3QgcXVlc3Rpb25EbGcgPSB0aGlzLnNob3coXHJcbiAgICAgICAgICAgIFwicXVlc3Rpb25cIixcclxuICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2tUZXh0OiB0aGlzLnllc1RleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgb2tIYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25EbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9rQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9rQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogdGhpcy5ub1RleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uRGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW5jZWxDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZml0Q29udGVudCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbXNnXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25EbGc7XHJcbiAgICB9XHJcblxyXG4gICAgcXVlc3Rpb24yKFxyXG4gICAgICAgIG1lc3NhZ2VyOiBzdHJpbmcsXHJcbiAgICAgICAgYnRuczogRGlhbG9nQnV0dG9uW10sXHJcbiAgICAgICAgbXNnPzogc3RyaW5nLFxyXG4gICAgICAgIGZpdENvbnRlbnQgPSB0cnVlXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zaG93KFxyXG4gICAgICAgICAgICBcInF1ZXN0aW9uXCIsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VyLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25zOiBidG5zLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZpdENvbnRlbnQsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1zZ1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIDIwMjDlubQz5pyIN+aXpeWboOS4unRleHRhcmVh6auY5bqm5Zyo5LiN5ZCM5rWP6KeI5Zmo5LiL5LiN5LiA5qC377yM5Zu65a6a6auY5bqm5Y+v6IO95Lya5Ye6546w5rua5Yqo5p2hXHJcbiAgICAgKiBAcGFyYW0gdGl0bGUg5qCH6aKYXHJcbiAgICAgKiBAcGFyYW0gbXNnIOS/oeaBr1xyXG4gICAgICogQHBhcmFtIGZpdENvbnRlbnQg6Ieq6YCC5bqU5YaF5a65XHJcbiAgICAgKi9cclxuICAgIHByb21wdCh0aXRsZTogc3RyaW5nLCBtc2c/OiBzdHJpbmcsIGZpdENvbnRlbnQgPSB0cnVlKSB7XHJcbiAgICAgICAgY29uc3QgcHJvbXB0U3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAgICAgY29uc3QgZGxnID0gdGhpcy5zaG93KFxyXG4gICAgICAgICAgICBcInByb21wdFwiLFxyXG4gICAgICAgICAgICBtc2csXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2tUZXh0OiB0aGlzLm9rVGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBva0hhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYyA9IGRsZy5jb250ZW50IGFzIE1lc3NhZ2VyQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0U3ViamVjdC5uZXh0KG1jLnByb21wdFRleHQubmF0aXZlRWxlbWVudC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjYW5jZWxUZXh0OiB0aGlzLmNhbmNlbFRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHRTdWJqZWN0Lm5leHQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZml0Q29udGVudCxcclxuICAgICAgICAgICAgICAgIGNsb3NlZDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb21wdFN1YmplY3QudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1zZ1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiBwcm9tcHRTdWJqZWN0O1xyXG4gICAgfVxyXG5cclxuICAgIHByb21wdDIodGl0bGU6IHN0cmluZywgbXNnPzogc3RyaW5nLCBvcHRzPzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcHJvbXB0U3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IF9vcHRzID0ge1xyXG4gICAgICAgICAgICBzaG93T2tCdXR0b246IHRydWUsXHJcbiAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSxcclxuICAgICAgICAgICAgc2hvd0ZvbnRTaXplOiBmYWxzZSxcclxuICAgICAgICAgICAgZm9udFNpemU6IDE4LFxyXG4gICAgICAgICAgICByZWFkb25seTogZmFsc2UsXHJcbiAgICAgICAgICAgIHNhdmVTaXplOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VXaGVuZXZlcjogdHJ1ZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICghb3B0cykge1xyXG4gICAgICAgICAgICBvcHRzID0gX29wdHM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgb3B0cyA9IE9iamVjdC5hc3NpZ24oX29wdHMsIG9wdHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgX2RpYWxvZ09wdHMgPSB7XHJcbiAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIHNob3dPa0J1dHRvbjpcclxuICAgICAgICAgICAgICAgICAgICBvcHRzLnNob3dPa0J1dHRvbiA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IG9wdHMuc2hvd09rQnV0dG9uLFxyXG4gICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjpcclxuICAgICAgICAgICAgICAgICAgICBvcHRzLnNob3dDYW5jZWxCdXR0b24gPT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBvcHRzLnNob3dDYW5jZWxCdXR0b24sXHJcbiAgICAgICAgICAgICAgICBva1RleHQ6IHRoaXMub2tUZXh0LFxyXG4gICAgICAgICAgICAgICAgb2tIYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYyA9IGRsZy5jb250ZW50IGFzIE1lc3NhZ2VyQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IG1jLnByb21wdFRleHQubmF0aXZlRWxlbWVudC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5jbG9zZVdoZW5ldmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHRTdWJqZWN0Lm5leHQodmFsKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHRTdWJqZWN0Lm5leHQoeyB2YWwsIGRsZyB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogdGhpcy5jYW5jZWxUZXh0LFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0U3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaG93Rm9udFNpemU6IG9wdHMuc2hvd0ZvbnRTaXplLFxyXG4gICAgICAgICAgICAgICAgZm9udFNpemU6IG9wdHMuZm9udFNpemUgfHwgMTgsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVXb3JkQ291bnQ6ICEhb3B0cy5lbmFibGVXb3JkQ291bnQsXHJcbiAgICAgICAgICAgICAgICBjb3VudFR5cGU6IG9wdHMuY291bnRUeXBlIHx8IFwibGVuZ3RoXCIsXHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IG9wdHMubWF4TGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlOiBvcHRzLmlucHV0VHlwZSB8fCBcInRleHRhcmVhXCIsXHJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogb3B0cy5wbGFjZWhvbGRlciB8fCBcIlwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmaXRDb250ZW50OiBmYWxzZSxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogdHJ1ZSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBjbGFzczogXCJcIixcclxuICAgICAgICAgICAgY2xvc2VkOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwcm9tcHRTdWJqZWN0LnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9wZW5lZDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdHMuaW5wdXRUeXBlICE9PSBcInRleHRhcmVhXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0YXJlYUVsZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbGcuY29udGVudC5wcm9tcHRUZXh0Lm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhRWxlLmNsb3Nlc3QoXCJzZWN0aW9uXCIpLnN0eWxlLnBhZGRpbmcgPSBcIjE1cHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWFFbGUuc3R5bGUucmVzaXplID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhRWxlLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMucmVhZG9ubHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhRWxlLnJlYWRPbmx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBiZWZvcmVDbG9zZTogKG1vZGFsUmVmOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRzLnNhdmVTaXplICYmICFkbGcuZGlhbG9nLmluc3RhbmNlLmlzTWF4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IGRsZy5jb250ZW50LmZvbnRTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogbW9kYWxSZWYuY29uZmlnLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IG1vZGFsUmVmLmNvbmZpZy5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVUZXh0QXJlYVNpemVJbmZvKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGRpYWxvZ09wdHMgPSBfZGlhbG9nT3B0cztcclxuICAgICAgICBpZiAob3B0cykge1xyXG4gICAgICAgICAgICBkaWFsb2dPcHRzID0gT2JqZWN0LmFzc2lnbihkaWFsb2dPcHRzLCBvcHRzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRsZyA9IHRoaXMuc2hvdyhcInByb21wdFwiLCBtc2csIGRpYWxvZ09wdHMsIG1zZyk7XHJcblxyXG4gICAgICAgIGlmIChvcHRzLmlucHV0VHlwZSAmJiBkbGcuY29udGVudC5wcm9tcHRUZXh0KSB7XHJcbiAgICAgICAgICAgIGRsZy5jb250ZW50LnByb21wdFRleHQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHByb21wdFN1YmplY3Q7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0S2V5U3RyaW5nKCkge1xyXG4gICAgICAgIC8vIOS4gOWPsOe7iOerr+WFseeUqOS4gOS4qumFjee9rlxyXG4gICAgICAgIC8vIOS/neeVmeacgOWQjuS4gOasoeeahOiuvue9ru+8jFxyXG4gICAgICAgIC8vIOS/neWtmOeql+WPo+Wkp+Wwj++8jOWtl+S9k+Wkp+Wwj1xyXG4gICAgICAgIHJldHVybiBcIklHSVgtRkFSUklTLVVJLVRFWFRBUkVBLVpPT00tU0VUVElOR1NcIjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNhdmVUZXh0QXJlYVNpemVJbmZvKGRhdGEpIHtcclxuICAgICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleVN0cmluZygpO1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlybShtZXNzYWdlOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT47XHJcbiAgICBjb25maXJtKG1lc3NhZ2U6IHN0cmluZywgbXNnPzogc3RyaW5nIHwgbnVtYmVyLCAgZml0Q29udGVudD86IGJvb2xlYW4pOiBPYnNlcnZhYmxlPGFueT47XHJcbiAgICBjb25maXJtKG1lc3NhZ2U6IHN0cmluZywgbXNnPzogc3RyaW5nLCBmaXRDb250ZW50ID0gdHJ1ZSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgY29uZmlybVN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG5cclxuICAgICAgICBjb25zdCBfbXNnID0gdHlwZW9mIG1zZyA9PT0gXCJudW1iZXJcIiA/IG51bGwgOiBtc2c7XHJcbiAgICAgICAgY29uc3QgY29uZmlybURsZyA9IHRoaXMuc2hvdyhcclxuICAgICAgICAgICAgXCJxdWVzdGlvblwiLFxyXG4gICAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBva1RleHQ6IHRoaXMub2tUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIG9rSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1EbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybVN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbFRleHQ6IHRoaXMuY2FuY2VsVGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBjYW5jZWxIYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybURsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtU3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZpdENvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBjbG9zZWQ6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25maXJtU3ViamVjdC51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX21zZ1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmIChtc2cgJiYgdHlwZW9mIG1zZyA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICBjb25maXJtRGxnLmRpYWxvZy5sb2NhdGlvbi5uYXRpdmVFbGVtZW50LnN0eWxlLnpJbmRleCA9IG1zZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjb25maXJtU3ViamVjdC5hc09ic2VydmFibGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBpbmZvKFxyXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcclxuICAgICAgICBjYWxsYmFjaz86ICgpID0+IHZvaWQsXHJcbiAgICAgICAgbXNnPzogc3RyaW5nLFxyXG4gICAgICAgIGZpdENvbnRlbnQgPSB0cnVlXHJcbiAgICApIHtcclxuICAgICAgICBjb25zdCBpbmZvRGxnID0gdGhpcy5zaG93KFxyXG4gICAgICAgICAgICBcImluZm9cIixcclxuICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2tUZXh0OiB0aGlzLm9rVGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBva0hhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvRGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZml0Q29udGVudCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbXNnXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gaW5mb0RsZztcclxuICAgIH1cclxuXHJcbiAgICAvKiog5pON5L2c5oiQ5Yqf5o+Q56S677yMXHJcbiAgICAgKiBtZXNzYWdlOiDmj5DnpLrkv6Hmga9cclxuICAgICAqIG1zZzogMue6p+S/oeaBr1xyXG4gICAgICogZml0Q291bnRlbnQ6IOm7mOiupOS4unRydWVcclxuICAgICAqIGNhbGxiYWNrOiDnoa7lrprkuovku7blm57osINcclxuICAgICAqL1xyXG4gICAgc3VjY2VzcyhcclxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXHJcbiAgICAgICAgbXNnPzogc3RyaW5nLFxyXG4gICAgICAgIGZpdENvbnRlbnQgPSB0cnVlLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB2b2lkID0gbnVsbFxyXG4gICAgKSB7XHJcbiAgICAgICAgY29uc3Qgc3VjY2Vzc0RsZyA9IHRoaXMuc2hvdyhcclxuICAgICAgICAgICAgXCJzdWNjZXNzXCIsXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGluaXRpYWxTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG9rVGV4dDogdGhpcy5va1RleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgb2tIYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc0RsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZpdENvbnRlbnQsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1zZ1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiBzdWNjZXNzRGxnO1xyXG4gICAgfVxyXG4gICAgLyoqIOaPkOekuumUmeivr+S/oeaBr++8jFxyXG4gICAgICogbWVzc2FnZTog5o+Q56S65L+h5oGvXHJcbiAgICAgKiBtc2c6IDLnuqfkv6Hmga9cclxuICAgICAqIGZpdENvdW50ZW50OiDpu5jorqTkuLp0cnVlXHJcbiAgICAgKiBjYWxsYmFjazog56Gu5a6a5LqL5Lu25Zue6LCDXHJcbiAgICAgKi9cclxuICAgIGVycm9yKFxyXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcclxuICAgICAgICBtc2c/OiBzdHJpbmcsXHJcbiAgICAgICAgZml0Q29udGVudCA9IHRydWUsXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHZvaWQgPSBudWxsLFxyXG4gICAgICAgIHNhZmVIdG1sID0gdHJ1ZVxyXG4gICAgKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JEbGcgPSB0aGlzLnNob3coXHJcbiAgICAgICAgICAgIFwiZXJyb3JcIixcclxuICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc2FmZUh0bWwsXHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBva1RleHQ6IHRoaXMub2tUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIG9rSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZml0Q29udGVudCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbXNnXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGVycm9yRGxnO1xyXG4gICAgfVxyXG5cclxuICAgIHdhcm5pbmcoXHJcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxyXG4gICAgICAgIG1zZz86IHN0cmluZyxcclxuICAgICAgICBmaXRDb250ZW50ID0gdHJ1ZSxcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4gdm9pZCA9IG51bGxcclxuICAgICkge1xyXG4gICAgICAgIGNvbnN0IHdhcm5pbmdEbGcgPSB0aGlzLnNob3coXHJcbiAgICAgICAgICAgIFwid2FybmluZ1wiLFxyXG4gICAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBva1RleHQ6IHRoaXMub2tUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIG9rSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5pbmdEbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmaXRDb250ZW50LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtc2dcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB3YXJuaW5nRGxnO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3dIdG1sTXNnKFxyXG4gICAgICAgIHR5cGU6IFwid2FybmluZ1wiIHwgXCJpbmZvXCIgfCBcImVycm9yXCIgfCBcInN1Y2Nlc3NcIixcclxuICAgICAgICB0aXRsZTogc3RyaW5nLFxyXG4gICAgICAgIG1lc3NhZ2U/OiBzdHJpbmcsXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHZvaWQgPSBudWxsXHJcbiAgICApIHtcclxuICAgICAgICBjb25zdCBtc2dEbGcgPSB0aGlzLnNob3coXHJcbiAgICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzYWZlSHRtbDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgICAgICBva1RleHQ6IHRoaXMub2tUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIG9rSGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zZ0RsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZpdENvbnRlbnQ6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2VcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiBtc2dEbGc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbG9zZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5tb2RhbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1zZ2JveCA9IHRoaXMuZ2V0TW9kYWxCeUlkKHRoaXMuY3VycmVudElkKTtcclxuICAgICAgICAgICAgaWYgKG1zZ2JveCkge1xyXG4gICAgICAgICAgICAgICAgbXNnYm94LnJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TW9kYWxCeUlkKGlkOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RhbHMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TW9kYWxDbXAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0Q3VycmVudE1vZGFsQ29udGFpbmVyKCkuaW5zdGFuY2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW1vdmVNZXNzYWdlcihpZCkge1xyXG4gICAgICAgIHRoaXMubW9kYWxzID0gdGhpcy5tb2RhbHMuZmlsdGVyKChuKSA9PiBuLmlkICE9PSBpZCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLm1vZGFscy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50SWQgPSAtMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRJZCA9IHRoaXMubW9kYWxzW3RoaXMubW9kYWxzLmxlbmd0aCAtIDFdLmlkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNvcHlUb0NsaXBib2FyZCh0ZXh0KTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3Qgd2luZG93UmVmOiBhbnkgPSB3aW5kb3c7XHJcbiAgICAgICAgaWYgKHdpbmRvd1JlZi5jbGlwYm9hcmREYXRhICYmIHdpbmRvd1JlZi5jbGlwYm9hcmREYXRhLnNldERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvd1JlZi5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJUZXh0XCIsIHRleHQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQucXVlcnlDb21tYW5kU3VwcG9ydGVkICYmIGRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZChcImNvcHlcIikpIHtcclxuICAgICAgICAgICAgdmFyIHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRleHRhcmVhKTtcclxuICAgICAgICAgICAgdGV4dGFyZWEuc2VsZWN0KCk7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuZXhlY0NvbW1hbmQoXCJjb3B5XCIpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGV4Y2VwdGlvbihlcnJvcjogU2VydmVyRXhjZXB0aW9uRW50aXR5LCBvcHRzID0ge3dpZHRoOiA0NDAsIGhlaWdodDogMjAwLCBsb2c6IGZhbHNlfSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGV4Y2VwdGlvbk1zZyA9IGVycm9yLk1lc3NhZ2UgfHwgXCJcIjtcclxuICAgICAgICBjb25zdCBkYXRlID0gZXJyb3IuZGF0ZSB8fCBmb3JtYXQobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQgSEg6bW06c3MnKVxyXG4gICAgICAgIGNvbnN0IGxvY2FsRGF0ZSA9IGRhdGU7XHJcbiAgICAgICAgLy8g5Y+R55Sf5pe26Ze0XHJcbiAgICAgICAgY29uc3QgaGFwcGVuZWRUaW1lID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdtZXNzYWdlci5leGNlcHRpb24uaGFwcGVuZCcpO1xyXG4gICAgICAgIC8vIOivpue7huS/oeaBr1xyXG4gICAgICAgIGNvbnN0IGRldGFpbEluZm8gPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ21lc3NhZ2VyLmV4Y2VwdGlvbi5kZXRhaWwnKTtcclxuICAgICAgICBjb25zdCBkZXRhaWwgPVxyXG4gICAgICAgICAgICBlcnJvci5EZXRhaWwgfHxcclxuICAgICAgICAgICAgYCR7ZXJyb3IuTWVzc2FnZX1cXHJcXG4ke2hhcHBlbmVkVGltZX3vvJoke2xvY2FsRGF0ZX1cXHJcXG4ke2RldGFpbEluZm9977yaJHtlcnJvci5pbm5lck1lc3NhZ2V9YCB8fFxyXG4gICAgICAgICAgICBcIlwiO1xyXG5cclxuICAgICAgICBjb25zdCBpbm5lck1lc3NhZ2UgPSBlcnJvci5pbm5lck1lc3NhZ2UgfHwgbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7d2lkdGg6IDQ0MCwgaGVpZ2h0OiAyMDAsIGxvZzogZmFsc2V9O1xyXG4gICAgICAgIGxldCBleG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcclxuICAgICAgICBpZiAob3B0cykge1xyXG4gICAgICAgICAgICBleG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYnNNb2RhbFJlZjogQnNNb2RhbFJlZjtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbWVzc2FnZXIuZXhjZXB0aW9uLnJvZ2VyJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiBcImJ0biBidG4tcHJpbWFyeSBidG4tbGdcIixcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnNNb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAvLyBzaG93SGVhZGVyOiBmYWxzZSxcclxuICAgICAgICAgICAgd2lkdGg6IGV4b3B0aW9ucy53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBleG9wdGlvbnMuaGVpZ2h0LFxyXG4gICAgICAgICAgICBzYWZlSHRtbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGV4Y2VwdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgZGF0ZTogbG9jYWxEYXRlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogaW5uZXJNZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgY29weUJ1dHRvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbWVzc2FnZXIuZXhjZXB0aW9uLmNvcHknKSxcclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNvcHlUb0NsaXBib2FyZChkZXRhaWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZSgnbWVzc2FnZXIuZXhjZXB0aW9uLmNvcHlTdWNjZXNzJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdtZXNzYWdlci5leGNlcHRpb24uY29weUZhaWxlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBic01vZGFsUmVmLmNvbnRlbnQuc2hvd01pbmlOb3RpZnkodGV4dCwgMTUwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoZXhvcHRpb25zLmxvZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdGhpcy5kaXNwbGF5RXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIGJzTW9kYWxSZWYgPSB0aGlzLnNob3coXHJcbiAgICAgICAgICAgIFwiZXhjZXB0aW9uXCIsXHJcbiAgICAgICAgICAgIGV4Y2VwdGlvbk1zZyxcclxuICAgICAgICAgICAgb3B0aW9uc1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIl19