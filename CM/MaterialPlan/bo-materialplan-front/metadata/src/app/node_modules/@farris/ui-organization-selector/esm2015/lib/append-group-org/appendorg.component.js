/**
 * @fileoverview added by tsickle
 * Generated from: lib/append-group-org/appendorg.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
export class AppendGroupOrgComponent {
    /**
     * @param {?} apiService
     * @param {?} cdr
     * @param {?} injector
     * @param {?} ngZone
     * @param {?} msgService
     */
    constructor(apiService, cdr, injector, ngZone, msgService) {
        this.apiService = apiService;
        this.cdr = cdr;
        this.injector = injector;
        this.ngZone = ngZone;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.originalTreeData = [];
        this.treeListData = [];
        this.treeTableCols = [];
        this.initLoad = true;
        this.loadingService = null;
        this.localeService = null;
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.enableHierarchicalLoading) {
                return of(true);
            }
            /*
                    if (!this.multiSelect) {
                        if (e.rowNode.isSelected) {
                            this.currentOrgs = [];
                        } else {
                            this.currentOrgs = new Array(e.rowNode.node.data);
                        }
                        return of(false);
                    }
                    */
            /** @type {?} */
            const param = {
                absOrgType: this.absOrgType,
                notGetStopOrg: this.notGetStopOrg,
                getCurUser: false,
                parentID: e.rowNode.id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                // if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
                //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                //     return of(false)
                // }
                // if (!e.rowNode.isChecked) {
                //     data.data.forEach(item => {
                //         if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.currentOrgs) === -1) {
                //             this.currentOrgs.push(item);
                //         }
                //     })
                // } else {
                //     this.currentOrgs.forEach((org, index) => {
                //         data.data.forEach(item => {
                //             if (org[this.primaryField] === item[this.primaryField]) {
                //                 this.currentOrgs.splice(index, 1);
                //             }
                //         });
                //     });
                // }
                // this.cdr.detectChanges();
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.loadingService = this.injector.get(LoadingService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.treeTableCols = [
            { field: 'name', title: this.localeService.getValue("organizationSelector.organization.orgName"), template: this.orgName },
            { field: 'code', title: this.localeService.getValue("organizationSelector.organization.orgCode") }
        ];
        if (this.initLoad) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
    }
    /**
     * @param {?} e
     * @return {?}
     */
    changeSelections(e) {
        //this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        this.toggleChecked(e);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleChecked(e) {
        /** @type {?} */
        const checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            checkeds.push(item.data);
        }));
        this.currentOrgs = _.cloneDeep(checkeds);
        if (this.currentOrgs.length == 0) {
            this.orgTree.clearCheckeds();
            this.orgTree.clearSelections();
            this.orgTree.detectChanges();
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSelected(e) {
        /** @type {?} */
        const selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            selected.push(item.data);
        }));
        this.currentOrgs = _.cloneDeep(selected);
        if (this.currentOrgs.length == 0) {
            this.orgTree.clearCheckeds();
            this.orgTree.clearSelections();
            this.orgTree.detectChanges();
        }
    }
    // 分层加载组织树
    /**
     * @return {?}
     */
    hlAssembleData() {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        /** @type {?} */
        const layerList = [];
        /** @type {?} */
        let layer = this.layer;
        while (layer > 0) {
            layerList.push(layer);
            layer -= 1;
        }
        param.layerList = layerList;
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.data) {
                return;
            }
            this.originalTreeData = res.data;
            if (res && res.curAbsUser && res.curAbsUser.orgAllPathInfo) {
                /** @type {?} */
                const curUserOrgPath = ((/** @type {?} */ (res.curAbsUser.orgAllPathInfo))).filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    return !res.data.find((/**
                     * @param {?} data
                     * @return {?}
                     */
                    data => data[this.primaryField] == item[this.primaryField]));
                }));
                res.data = res.data.concat(curUserOrgPath || []);
            }
            this.treeListData = this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            this.orgTree.loadData(this.treeListData);
            //this.tickCheckedNodes();
            this.cdr.detectChanges();
            if (this.loadingService) {
                this.loadingService.close();
            }
        }));
    }
    // 全加载组织树
    /**
     * @return {?}
     */
    assembleData() {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            notGetStopOrg: this.notGetStopOrg,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.data) {
                return;
            }
            this.originalTreeData = res.data;
            this.treeListData = this.dataToTree(res.data, 1, res.curAbsUser.defaultOrgPath);
            this.orgTree.loadData(this.treeListData);
            // this.tickCheckedNodes();
            this.cdr.detectChanges();
            if (this.loadingService) {
                this.loadingService.close();
            }
        }));
    }
    // 确定组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    inTreeList(treeListData, item) {
        for (let i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item[this.primaryField]) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    }
    // 在当前组织树内勾选所有已在群组内的组织
    /**
     * @private
     * @return {?}
     */
    tickCheckedNodes() {
        /** @type {?} */
        const ids = [];
        this.currentOrgs.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.inTreeList(this.treeListData, item);
            if (!!item.inTreeList) {
                ids.push(item[this.primaryField]);
            }
        }));
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (!ids.length) {
                    return;
                }
                if (this.multiSelect) {
                    this.orgTree.checkedNodes(ids, true, true);
                }
                else {
                    if (ids.length > 1) {
                        this.msgService.show('warning', this.localeService.getValue("organizationSelector.errorMessage.multiSelect"), true);
                        return;
                    }
                    this.orgTree.clearSelections();
                    this.orgTree.detectChanges();
                    this.orgTree.selectNode(ids.join());
                }
            }));
        }));
    }
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    dataToTree(plainSource, layer, expandedPath = '') {
        /** @type {?} */
        const treeSource = this.dealData(plainSource, expandedPath);
        // const parents = treeSource.filter(item => {
        //     return item.data.layer === layer;
        // });
        // this.treeData(parents, treeSource, 1);
        return treeSource;
    }
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    dealDataWhenExpandTreeNode(data, expandedPath = '') {
        /** @type {?} */
        const pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            let maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (let a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        const newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const newsDataObj = {
                    data: {
                        orgId: item[this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: []
                };
                // let expanded = [];
                // if (this.enableHierarchicalLoading) {
                //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     newsDataObj.expanded = false;
                //     if (this.enableHierarchicalLoading && item.isDetail === '0') {
                //         newsDataObj.leaf = false;
                //     }
                // }
                if (Number(item.layer) >= this.layer) {
                    newsDataObj.expanded = false;
                }
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                    newsDataObj.expanded = true;
                }
                if (this.enableHierarchicalLoading && item.isDetail === '0') {
                    newsDataObj.leaf = false;
                }
                newDatas.push(newsDataObj);
            }));
        }
        return newDatas;
    }
    // 预处理组织数据
    /**
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    dealData(data, expandedPath = '') {
        /** @type {?} */
        const pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            let maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (let a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        /** @type {?} */
        const nodes = new Map();
        /** @type {?} */
        const newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                // const newsDataObj: any = {
                //     data: {
                //         orgId: item[this.primaryField],
                //         name: item.name,
                //         path: item.path,
                //         code: item.code,
                //         layer: Number(item.layer),
                //         orgAllPath: item.orgAllPath,
                //         inFavorites: item.inFavorites
                //     },
                //     expanded: true,
                //     children: []
                // };
                // // let expanded = [];
                // // if (this.enableHierarchicalLoading) {
                // //     this.nodeExpanded(newsDataObj, this.treeListData, expanded);
                // // }
                // if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1) {
                //     newsDataObj.expanded = true;
                // } else {
                //     newsDataObj.expanded = false;
                //     if (this.enableHierarchicalLoading && item.isDetail === '0') {
                //         newsDataObj.leaf = false;
                //     }
                // }
                // // todo 分层加载需要
                // //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //     //newsDataObj.leaf = false;
                //    // newsDataObj.expanded = false;
                // //}
                // newDatas.push(newsDataObj);
                /** @type {?} */
                const path = item['path'];
                /** @type {?} */
                const parentPath = Number(item['layer']) > 1 ? ((/** @type {?} */ (item['path']))).slice(0, 4 * (Number(item['layer']) - 1)) : 'top';
                if (!nodes[path]) {
                    nodes[path] = { children: [] };
                }
                nodes[path] = {
                    data: {
                        orgId: item[this.primaryField],
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        layer: Number(item.layer),
                        orgAllPath: item.orgAllPath,
                        inFavorites: item.inFavorites
                    },
                    expanded: true,
                    children: nodes[path]['children']
                };
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1 || Number(item.layer) < this.layer) {
                    nodes[path]['expanded'] = true;
                }
                else {
                    nodes[path]['expanded'] = false;
                    if (this.enableHierarchicalLoading && item.isDetail === '0') {
                        nodes[path]['leaf'] = false;
                    }
                }
                // todo 分层加载需要
                //if (this.enableHierarchicalLoading && item.isDetail === '0' && Number(item.layer) >= this.layer) {
                //newsDataObj.leaf = false;
                // newsDataObj.expanded = false;
                //}
                if (parentPath == 'top') {
                    newDatas.push(nodes[path]);
                }
                else {
                    if (!nodes[parentPath]) {
                        nodes[parentPath] = { children: [] };
                    }
                    ((/** @type {?} */ (nodes[parentPath]['children']))).push(nodes[path]);
                }
            }));
        }
        return newDatas;
    }
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    treeData(parents, treeSource, layer) {
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        parent => {
            /** @type {?} */
            const parentPath = parent['data']['path'];
            /** @type {?} */
            const parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    const itemPath = item['data']['path'];
                    /** @type {?} */
                    const itemLayer = item['data']['layer'];
                    /** @type {?} */
                    let targetPath;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    }
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    listenTreeExpand(obj) {
        // 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    }
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    getOrganizationByParentNode(parentNode) {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            parentID: parentNode.id,
            notGetStopOrg: this.notGetStopOrg,
            getCurUser: false,
            getOrgAllPath: true
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.data) {
                /** @type {?} */
                const newDatas = [];
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.originalTreeData) === -1) {
                        item.selectable = true;
                        this.originalTreeData.push(item);
                    }
                    newDatas.push(item);
                }));
                /** @type {?} */
                const nodes = this.dealDataWhenExpandTreeNode(newDatas);
                this.orgTree.appendChildren(nodes, parentNode);
                this.orgTree.detectChanges();
                //this.tickCheckedNodes();
                if (this.loadingService) {
                    this.loadingService.close();
                }
            }
        }));
    }
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    nodeExpanded(item, arr, expanded) {
        for (let i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    }
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    expandTreeNode(treeData, path, layer) {
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        node => {
            if (path.includes(node.data.path)) {
                this.orgTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                this.expandTreeNode(node.children, path, layer);
            }
        }));
    }
}
AppendGroupOrgComponent.decorators = [
    { type: Component, args: [{
                selector: 'append-group-org',
                template: "<!--\r\n<div style=\"background: #f9f9fc; display: flex; justify-content: space-between; border-bottom: 1px solid #EAEDF3\">\r\n    <span style=\"line-height: 22px;margin-left: 10px;font-weight: 600;color: #2a87ff;border-bottom: 2px solid #2a87ff;\r\n    padding: 8px 0;\">\u7EC4\u7EC7\u67B6\u6784</span>\r\n    <input-group style=\"width: 240px; margin: 6px 10px 6px 0;\"\r\n        [placeholder]=\"searchPlaceholder\" [(value)]=\"searchText\" [groupText]=\"groupIcon\" (enterHandle)=\"onSearch({pageIndex: 1})\"\r\n        (clickHahndle)=\"onSearch({pageIndex: 1})\" (keyup)=\"listenSearchText($event)\" (clear)=\"searchClear()\">\r\n    </input-group>\r\n</div>\r\n-->\r\n<farris-treetable #orgTree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"primaryField\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"false\" [showBorder]=\"false\" [showCheckbox]=\"true\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\" [virtualized]=\"true\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\" [beforeClickNode]=\"beforeClickNode\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgName let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>",
                styles: [":host{height:100%;overflow:hidden;display:-webkit-box;display:flex;background:#fff;width:100%;border-radius:10px;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;border:1px solid #dee1ea}"]
            }] }
];
/** @nocollapse */
AppendGroupOrgComponent.ctorParameters = () => [
    { type: ApiService },
    { type: ChangeDetectorRef },
    { type: Injector },
    { type: NgZone },
    { type: MessagerService }
];
AppendGroupOrgComponent.propDecorators = {
    baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
    orgTree: [{ type: ViewChild, args: ['orgTree',] }],
    orgName: [{ type: ViewChild, args: ['orgName',] }],
    primaryField: [{ type: Input }],
    enableHierarchicalLoading: [{ type: Input }],
    notGetStopOrg: [{ type: Input }],
    layer: [{ type: Input }],
    multiSelect: [{ type: Input }],
    absOrgType: [{ type: Input }],
    cascadeCheck: [{ type: Input }],
    cascadeDown: [{ type: Input }],
    cascadeUp: [{ type: Input }],
    keepSelect: [{ type: Input }],
    showCheckAll: [{ type: Input }],
    selectedLimit: [{ type: Input }],
    pathLength: [{ type: Input }],
    virtualizedLoad: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    AppendGroupOrgComponent.prototype.baseCls;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.orgTree;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.orgName;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.primaryField;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.notGetStopOrg;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.layer;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.multiSelect;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.absOrgType;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeCheck;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeDown;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.cascadeUp;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.keepSelect;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.showCheckAll;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.selectedLimit;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.pathLength;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.virtualizedLoad;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.originalTreeData;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.treeListData;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.treeTableCols;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.currentOrgs;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.initLoad;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.localeService;
    /** @type {?} */
    AppendGroupOrgComponent.prototype.beforeClickNode;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    AppendGroupOrgComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwZW5kb3JnLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktb3JnYW5pemF0aW9uLXNlbGVjdG9yLyIsInNvdXJjZXMiOlsibGliL2FwcGVuZC1ncm91cC1vcmcvYXBwZW5kb3JnLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUF5RSxpQkFBaUIsRUFBWSxRQUFRLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUM5SyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFFL0IsT0FBTyxFQUFZLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUVwQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFZLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFcEUsT0FBTyxFQUFFLFNBQVMsRUFBTyxNQUFNLGdCQUFnQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBT2xFLE1BQU0sT0FBTyx1QkFBdUI7Ozs7Ozs7O0lBK0VoQyxZQUNZLFVBQXNCLEVBQ3RCLEdBQXNCLEVBQ3RCLFFBQWtCLEVBQ2xCLE1BQWMsRUFDZCxVQUEyQjtRQUozQixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLFFBQUcsR0FBSCxHQUFHLENBQW1CO1FBQ3RCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFD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QUNMLEtBQUs7OEJBQ0wsS0FBSzs7OztJQWhCTiwwQ0FBOEQ7O0lBQzlELDBDQUFrRDs7SUFDbEQsMENBQWdEOztJQUNoRCwrQ0FBZ0M7O0lBQ2hDLDREQUE0Qzs7SUFDNUMsZ0RBQWdDOztJQUNoQyx3Q0FBdUI7O0lBQ3ZCLDhDQUE4Qjs7SUFDOUIsNkNBQXlCOztJQUN6QiwrQ0FBK0I7O0lBQy9CLDhDQUE4Qjs7SUFDOUIsNENBQTRCOztJQUM1Qiw2Q0FBNkI7O0lBQzdCLCtDQUErQjs7SUFDL0IsZ0RBQStCOztJQUMvQiw2Q0FBd0I7O0lBQ3hCLGtEQUFrQzs7SUFFbEMsbURBQXNCOztJQUN0QiwrQ0FBOEI7O0lBQzlCLGdEQUFtQjs7SUFDbkIsOENBQW1COztJQUNuQiwyQ0FBZ0I7Ozs7O0lBQ2hCLGlEQUE4Qzs7Ozs7SUFDOUMsZ0RBQTRDOztJQUU1QyxrREFpREU7Ozs7O0lBR0UsNkNBQThCOzs7OztJQUM5QixzQ0FBOEI7Ozs7O0lBQzlCLDJDQUEwQjs7Ozs7SUFDMUIseUNBQXNCOzs7OztJQUN0Qiw2Q0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIEluamVjdG9yLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBIb3N0QmluZGluZywgTmdab25lLCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBub0RhdGFJbWcgfSBmcm9tICcuLi8uLi9hc3NldHMvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgT3JnUmVxdWVzdFBhcmFtIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5kZXgudHlwZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWwgfSBmcm9tICcuLi8uLi91dGlscy9jb21tb24udG9vbCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgT1JHQU5JWkFUSU9OX1NFTEVDVE9SX0xPQ0FMRSB9IGZyb20gJy4uLy4uL3V0aWxzL2xvY2FsZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwZW5kLWdyb3VwLW9yZycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vYXBwZW5kb3JnLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2FwcGVuZG9yZy5jb21wb25lbnQuY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBcHBlbmRHcm91cE9yZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtdXRpbHMtZmlsbC1mbGV4LWNvbHVtbicpIGJhc2VDbHMgPSB0cnVlO1xyXG4gICAgQFZpZXdDaGlsZCgnb3JnVHJlZScpIG9yZ1RyZWU6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ29yZ05hbWUnKSBvcmdOYW1lOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQElucHV0KCkgcHJpbWFyeUZpZWxkID0gJ29yZ0lkJztcclxuICAgIEBJbnB1dCgpIGVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBub3RHZXRTdG9wT3JnOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbGF5ZXI6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIG11bHRpU2VsZWN0OiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgYWJzT3JnVHlwZTogYW55O1xyXG4gICAgQElucHV0KCkgY2FzY2FkZUNoZWNrOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgY2FzY2FkZURvd246IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlVXA6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBrZWVwU2VsZWN0OiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQWxsOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRMaW1pdDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgcGF0aExlbmd0aCA9IDQ7XHJcbiAgICBASW5wdXQoKSB2aXJ0dWFsaXplZExvYWQ6IGJvb2xlYW47XHJcbiAgICBcclxuICAgIG9yaWdpbmFsVHJlZURhdGEgPSBbXTtcclxuICAgIHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSA9IFtdO1xyXG4gICAgdHJlZVRhYmxlQ29scyA9IFtdO1xyXG4gICAgY3VycmVudE9yZ3M6IGFueVtdO1xyXG4gICAgaW5pdExvYWQgPSB0cnVlO1xyXG4gICAgcHJpdmF0ZSBsb2FkaW5nU2VydmljZTogTG9hZGluZ1NlcnZpY2UgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlID0gbnVsbDtcclxuXHJcbiAgICBiZWZvcmVDbGlja05vZGUgPSAoZSkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLypcclxuICAgICAgICBpZiAoIXRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgaWYgKGUucm93Tm9kZS5pc1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRPcmdzID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRPcmdzID0gbmV3IEFycmF5KGUucm93Tm9kZS5ub2RlLmRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICovXHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXJlbnRJRDogZS5yb3dOb2RlLmlkLFxyXG4gICAgICAgICAgICB3aXRoQWxsU3ViOiB0cnVlLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIChkYXRhWydkYXRhJ10ubGVuZ3RoID4gdGhpcy5zZWxlY3RlZExpbWl0ICYmICFlLnJvd05vZGUuaXNDaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgYOS6su+8jOS4gOasoeaAp+mAieaLqeS6hui2hei/hyR7dGhpcy5zZWxlY3RlZExpbWl0feadoeaVsOaNrn5gLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIG9mKGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLmN1cnJlbnRPcmdzKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLmN1cnJlbnRPcmdzLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5jdXJyZW50T3Jncy5mb3JFYWNoKChvcmcsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBkYXRhLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAob3JnW3RoaXMucHJpbWFyeUZpZWxkXSA9PT0gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50T3Jncy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgYXBpU2VydmljZTogQXBpU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcclxuICAgICAgICBwcml2YXRlIG1zZ1NlcnZpY2U6IE1lc3NhZ2VyU2VydmljZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5jZHIgPSB0aGlzLmluamVjdG9yLmdldChDaGFuZ2VEZXRlY3RvclJlZik7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvYWRpbmdTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGVTZXJ2aWNlKTtcclxuICAgICAgICBpZighdGhpcy5sb2NhbGVTZXJ2aWNlLmxhbmdEYXRhWydvcmdhbml6YXRpb25TZWxlY3RvciddKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxlU2VydmljZS5zZXRMb2NhbGVEYXRhKE9SR0FOSVpBVElPTl9TRUxFQ1RPUl9MT0NBTEUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRyZWVUYWJsZUNvbHMgPSBbXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICduYW1lJywgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5vcmdOYW1lXCIpLCB0ZW1wbGF0ZTogdGhpcy5vcmdOYW1lIH0sXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICdjb2RlJywgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5vcmdDb2RlXCIpIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGlmICh0aGlzLmluaXRMb2FkKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5obEFzc2VtYmxlRGF0YSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmluaXRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2VTZWxlY3Rpb25zKGU6IGFueSkge1xyXG4gICAgICAgIC8vdGhpcy5tdWx0aVNlbGVjdCA/IHRoaXMudG9nZ2xlQ2hlY2tlZChlKSA6IHRoaXMudG9nZ2xlU2VsZWN0ZWQoZSk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVDaGVja2VkKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUNoZWNrZWQoZTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgY2hlY2tlZHMgPSBbXTtcclxuICAgICAgICBlICYmIGUuaW5zdGFuY2UgJiYgZS5pbnN0YW5jZS5jaGVja2Vkcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBjaGVja2Vkcy5wdXNoKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50T3JncyA9IF8uY2xvbmVEZWVwKGNoZWNrZWRzKTtcclxuICAgICAgICBpZih0aGlzLmN1cnJlbnRPcmdzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3JnVHJlZS5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgIHRoaXMub3JnVHJlZS5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlU2VsZWN0ZWQoZTogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBbXTtcclxuICAgICAgICBlICYmIGUuaW5zdGFuY2UgJiYgZS5pbnN0YW5jZS5zZWxlY3Rpb25zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRPcmdzID0gXy5jbG9uZURlZXAoc2VsZWN0ZWQpO1xyXG4gICAgICAgIGlmKHRoaXMuY3VycmVudE9yZ3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICB0aGlzLm9yZ1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDliIblsYLliqDovb3nu4Tnu4fmoJFcclxuICAgIGhsQXNzZW1ibGVEYXRhKCkge1xyXG4gICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBsYXllckxpc3QgPSBbXTtcclxuICAgICAgICBsZXQgbGF5ZXIgPSB0aGlzLmxheWVyO1xyXG4gICAgICAgIHdoaWxlIChsYXllciA+IDApIHtcclxuICAgICAgICAgICAgbGF5ZXJMaXN0LnB1c2gobGF5ZXIpO1xyXG4gICAgICAgICAgICBsYXllciAtPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJhbS5sYXllckxpc3QgPSBsYXllckxpc3Q7XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuY3VyQWJzVXNlciAmJiByZXMuY3VyQWJzVXNlci5vcmdBbGxQYXRoSW5mbykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VyVXNlck9yZ1BhdGggPSAocmVzLmN1ckFic1VzZXIub3JnQWxsUGF0aEluZm8gYXMgQXJyYXk8YW55PikuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhcmVzLmRhdGEuZmluZChkYXRhID0+IGRhdGFbdGhpcy5wcmltYXJ5RmllbGRdID09IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEgPSByZXMuZGF0YS5jb25jYXQoY3VyVXNlck9yZ1BhdGggfHwgW10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudHJlZUxpc3REYXRhID0gdGhpcy5kYXRhVG9UcmVlKHJlcy5kYXRhLCAxLCByZXMuY3VyQWJzVXNlci5kZWZhdWx0T3JnUGF0aCk7XHJcbiAgICAgICAgICAgIHRoaXMub3JnVHJlZS5sb2FkRGF0YSh0aGlzLnRyZWVMaXN0RGF0YSk7XHJcbiAgICAgICAgICAgIC8vdGhpcy50aWNrQ2hlY2tlZE5vZGVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YWo5Yqg6L2957uE57uH5qCRXHJcbiAgICBhc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXMgfHwgIXJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZUxpc3REYXRhID0gdGhpcy5kYXRhVG9UcmVlKHJlcy5kYXRhLCAxLCByZXMuY3VyQWJzVXNlci5kZWZhdWx0T3JnUGF0aCk7XHJcbiAgICAgICAgICAgIHRoaXMub3JnVHJlZS5sb2FkRGF0YSh0aGlzLnRyZWVMaXN0RGF0YSk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMudGlja0NoZWNrZWROb2RlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOehruWumue7hOe7h+aYr+WQpuWcqOW9k+WJjee7hOe7h+agkeWGhVxyXG4gICAgcHJpdmF0ZSBpblRyZWVMaXN0KHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmVlTGlzdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRyZWVMaXN0RGF0YVtpXS5pZCA9PT0gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5UcmVlTGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pblRyZWVMaXN0KHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbiwgaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Zyo5b2T5YmN57uE57uH5qCR5YaF5Yu+6YCJ5omA5pyJ5bey5Zyo576k57uE5YaF55qE57uE57uHXHJcbiAgICBwcml2YXRlIHRpY2tDaGVja2VkTm9kZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaWRzID0gW107XHJcbiAgICAgICAgdGhpcy5jdXJyZW50T3Jncy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGl0ZW0pO1xyXG4gICAgICAgICAgICBpZiAoISFpdGVtLmluVHJlZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGlkcy5wdXNoKGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JnVHJlZS5jaGVja2VkTm9kZXMoaWRzLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3IuZXJyb3JNZXNzYWdlLm11bHRpU2VsZWN0XCIpLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yZ1RyZWUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yZ1RyZWUuc2VsZWN0Tm9kZShpZHMuam9pbigpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiDnu4Tnu4fmlbDmja7ovazmjaJcclxuICAgICogQHBhcmFtIHBsYWluU291cmNlIOaOpeWPo+WOn+Wni+aVsOaNrlxyXG4gICAgKiBAcGFyYW0gbGF5ZXIg5bGC57qnXHJcbiAgICAqIEByZXR1cm5zIOi/lOWbnuagkeW9ouaOpeWPo+eahOaVsOaNrlxyXG4gICAgKi9cclxuICAgIHByaXZhdGUgZGF0YVRvVHJlZShwbGFpblNvdXJjZTogYW55LCBsYXllcjogbnVtYmVyLCBleHBhbmRlZFBhdGg6IHN0cmluZyA9ICcnKSB7XHJcbiAgICAgICAgY29uc3QgdHJlZVNvdXJjZSA9IHRoaXMuZGVhbERhdGEocGxhaW5Tb3VyY2UsIGV4cGFuZGVkUGF0aCk7XHJcbiAgICAgICAgLy8gY29uc3QgcGFyZW50cyA9IHRyZWVTb3VyY2UuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gaXRlbS5kYXRhLmxheWVyID09PSBsYXllcjtcclxuICAgICAgICAvLyB9KTtcclxuICAgICAgICAvLyB0aGlzLnRyZWVEYXRhKHBhcmVudHMsIHRyZWVTb3VyY2UsIDEpO1xyXG4gICAgICAgIHJldHVybiB0cmVlU291cmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVhbERhdGFXaGVuRXhwYW5kVHJlZU5vZGUoZGF0YTogYW55W10sIGV4cGFuZGVkUGF0aDogc3RyaW5nID0gJycpIHtcclxuICAgICAgICBjb25zdCBwYXRoTGlzdCA9IFtdO1xyXG4gICAgICAgIGlmKGV4cGFuZGVkUGF0aCAhPSAnJykge1xyXG4gICAgICAgICAgICBsZXQgbWF4TGVuZ3RoID0gZXhwYW5kZWRQYXRoLmxlbmd0aCAvIHRoaXMucGF0aExlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgbWF4TGVuZ3RoIC09IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCBtYXhMZW5ndGg7IGErKykge1xyXG4gICAgICAgICAgICAgICAgcGF0aExpc3QucHVzaCh7IHBhdGg6IGV4cGFuZGVkUGF0aC5zdWJzdHJpbmcoMCwgNCAqIChhICsgMSkpIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld3NEYXRhT2JqOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdJZDogaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogaXRlbS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyOiBOdW1iZXIoaXRlbS5sYXllciksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZ0FsbFBhdGg6IGl0ZW0ub3JnQWxsUGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5GYXZvcml0ZXM6IGl0ZW0uaW5GYXZvcml0ZXNcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBleHBhbmRlZCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMubm9kZUV4cGFuZGVkKG5ld3NEYXRhT2JqLCB0aGlzLnRyZWVMaXN0RGF0YSwgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW0ucGF0aCwgJ3BhdGgnLCBwYXRoTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICBpZihOdW1iZXIoaXRlbS5sYXllcikgPj0gdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NEYXRhT2JqLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbmV3RGF0YXMucHVzaChuZXdzRGF0YU9iaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3RGF0YXM7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIOmihOWkhOeQhue7hOe7h+aVsOaNrlxyXG4gICAgcHJpdmF0ZSBkZWFsRGF0YShkYXRhOiBhbnlbXSwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgaWYoZXhwYW5kZWRQYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSBleHBhbmRlZFBhdGgubGVuZ3RoIC8gdGhpcy5wYXRoTGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGggLT0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBhID0gMDsgYSA8IG1heExlbmd0aDsgYSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoTGlzdC5wdXNoKHsgcGF0aDogZXhwYW5kZWRQYXRoLnN1YnN0cmluZygwLCA0ICogKGEgKyAxKSkgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xyXG4gICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IG5ld3NEYXRhT2JqOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBvcmdJZDogaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgcGF0aDogaXRlbS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGxheWVyOiBOdW1iZXIoaXRlbS5sYXllciksXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG9yZ0FsbFBhdGg6IGl0ZW0ub3JnQWxsUGF0aCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgaW5GYXZvcml0ZXM6IGl0ZW0uaW5GYXZvcml0ZXNcclxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICAgICAgICAgIC8vIC8vIGxldCBleHBhbmRlZCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gICAgIHRoaXMubm9kZUV4cGFuZGVkKG5ld3NEYXRhT2JqLCB0aGlzLnRyZWVMaXN0RGF0YSwgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gLy8gfVxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW0ucGF0aCwgJ3BhdGgnLCBwYXRoTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgbmV3c0RhdGFPYmouZXhwYW5kZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBuZXdzRGF0YU9iai5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG5ld3NEYXRhT2JqLmxlYWYgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAvLyAvLyB0b2RvIOWIhuWxguWKoOi9vemcgOimgVxyXG4gICAgICAgICAgICAgICAgLy8gLy9pZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIGl0ZW0uaXNEZXRhaWwgPT09ICcwJyAmJiBOdW1iZXIoaXRlbS5sYXllcikgPj0gdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIC8vbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgLy8gbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vIC8vfVxyXG4gICAgICAgICAgICAgICAgLy8gbmV3RGF0YXMucHVzaChuZXdzRGF0YU9iaik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gaXRlbVsncGF0aCddO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IE51bWJlcihpdGVtWydsYXllciddKSA+IDEgPyAoaXRlbVsncGF0aCddIGFzIHN0cmluZykuc2xpY2UoMCwgNCAqIChOdW1iZXIoaXRlbVsnbGF5ZXInXSkgLSAxKSkgOiAndG9wJztcclxuICAgICAgICAgICAgICAgIGlmKCFub2Rlc1twYXRoXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdID0geyBjaGlsZHJlbjogW10gfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbm9kZXNbcGF0aF0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JnSWQ6IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogaXRlbS5jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllcjogTnVtYmVyKGl0ZW0ubGF5ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmdBbGxQYXRoOiBpdGVtLm9yZ0FsbFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluRmF2b3JpdGVzOiBpdGVtLmluRmF2b3JpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogbm9kZXNbcGF0aF1bJ2NoaWxkcmVuJ11cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtLnBhdGgsICdwYXRoJywgcGF0aExpc3QpICE9PSAtMSB8fCBOdW1iZXIoaXRlbS5sYXllcikgPCB0aGlzLmxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF1bJ2V4cGFuZGVkJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnZXhwYW5kZWQnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgaXRlbS5pc0RldGFpbCA9PT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydsZWFmJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB0b2RvIOWIhuWxguWKoOi9vemcgOimgVxyXG4gICAgICAgICAgICAgICAgLy9pZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmIGl0ZW0uaXNEZXRhaWwgPT09ICcwJyAmJiBOdW1iZXIoaXRlbS5sYXllcikgPj0gdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgLy8gbmV3c0RhdGFPYmouZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgaWYocGFyZW50UGF0aCA9PSAndG9wJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2gobm9kZXNbcGF0aF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZighbm9kZXNbcGFyZW50UGF0aF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGFyZW50UGF0aF0gPSB7IGNoaWxkcmVuOiBbXSB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIChub2Rlc1twYXJlbnRQYXRoXVsnY2hpbGRyZW4nXSBhcyBBcnJheTxhbnk+KS5wdXNoKG5vZGVzW3BhdGhdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdEYXRhcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaVsOaNrui9rOaNolxyXG4gICAgICogQHBhcmFtIHBhcmVudHMg54i257qn6IqC54K55L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gdHJlZVNvdXJjZSDljp/lp4vmlbDmja7kv6Hmga9cclxuICAgICAqIEBwYXJhbSBsYXllciDlsYLnuqdcclxuICAgICAqL1xyXG4gICAgdHJlZURhdGEocGFyZW50czogYW55LCB0cmVlU291cmNlOiBhbnksIGxheWVyOiBudW1iZXIpIHtcclxuICAgICAgICBwYXJlbnRzLmZvckVhY2gocGFyZW50ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IHBhcmVudFsnZGF0YSddWydwYXRoJ107XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudExheWVyID0gcGFyZW50WydkYXRhJ11bJ2xheWVyJ107XHJcbiAgICAgICAgICAgIHRyZWVTb3VyY2UuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW1bJ2RhdGEnXSAmJiBpdGVtWydkYXRhJ11bJ3BhdGgnXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1QYXRoID0gaXRlbVsnZGF0YSddWydwYXRoJ107XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbUxheWVyID0gaXRlbVsnZGF0YSddWydsYXllciddO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRQYXRoOiBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1QYXRoICYmIGl0ZW1QYXRoLmxlbmd0aCA+IHBhcmVudFBhdGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFBhdGggPSBpdGVtUGF0aC5zdWJzdHIoMCwgTnVtYmVyKGxheWVyKSAqIDQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gdGFyZ2V0UGF0aCAmJiBwYXJlbnRMYXllciA9PT0gaXRlbUxheWVyIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRbJ2NoaWxkcmVuJ10ucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IHRhcmdldFBhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlRGF0YShbaXRlbV0sIHRyZWVTb3VyY2UsIE51bWJlcihsYXllcikgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g55uR5ZCs57uE57uH5qCR5bGV5byA5LqL5Lu2XHJcbiAgICBsaXN0ZW5UcmVlRXhwYW5kKG9iajogYW55KSB7XHJcbiAgICAgICAgLy8g5YiG5bGC5Yqg6L29XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBvYmouY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0T3JnYW5pemF0aW9uQnlQYXJlbnROb2RlKG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIhuWxguWKoOi9veaXtu+8jOiOt+WPluS4i+e6p+e7hOe7h+aVsOaNruW5tuS4uuW9k+WJjee7hOe7h+agkea3u+WKoOWtkOiKgueCuVxyXG4gICAgZ2V0T3JnYW5pemF0aW9uQnlQYXJlbnROb2RlKHBhcmVudE5vZGU6IGFueSkge1xyXG4gICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgcGFyZW50SUQ6IHBhcmVudE5vZGUuaWQsXHJcbiAgICAgICAgICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgZ2V0Q3VyVXNlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5vcmlnaW5hbFRyZWVEYXRhKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5kZWFsRGF0YVdoZW5FeHBhbmRUcmVlTm9kZShuZXdEYXRhcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yZ1RyZWUuYXBwZW5kQ2hpbGRyZW4obm9kZXMsIHBhcmVudE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcmdUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIC8vdGhpcy50aWNrQ2hlY2tlZE5vZGVzKCk7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6L+U5Zue5bey57uP6K+l6IqC54K55piv5ZCm5bGV5byA6L+HXHJcbiAgICBwcml2YXRlIG5vZGVFeHBhbmRlZChpdGVtOiBhbnksIGFycjogVHJlZU5vZGVbXSwgZXhwYW5kZWQ6IGJvb2xlYW5bXSk6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmRhdGEuaWQgPT09IGFycltpXS5kYXRhLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBleHBhbmRlZFswXSA9IGFycltpXS5leHBhbmRlZDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhcnJbaV0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVFeHBhbmRlZChpdGVtLCBhcnJbaV0uY2hpbGRyZW4sIGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlsZXlvIDoioLngrlcclxuICAgIHByaXZhdGUgZXhwYW5kVHJlZU5vZGUodHJlZURhdGE6IGFueSwgcGF0aDogYW55W10sIGxheWVyOiBudW1iZXIpIHtcclxuICAgICAgICB0cmVlRGF0YS5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAocGF0aC5pbmNsdWRlcyhub2RlLmRhdGEucGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3JnVHJlZS5leHBhbmROb2RlKG5vZGUuZGF0YS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5sYXllciA8IGxheWVyICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZFRyZWVOb2RlKG5vZGUuY2hpbGRyZW4sIHBhdGgsIGxheWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=