import { Injectable } from "@angular/core";
var FormControlService = /** @class */ (function () {
    function FormControlService() {
    }
    FormControlService.prototype.getFormControlsByFrameContext = function (frameContext) {
        return frameContext && frameContext.form && frameContext.form.ngFormControls || null;
    };
    /**
     * 通过binding元数据获取NgFormControl
     * @param frameContext
     * @param binding binding
     * @returns
     */
    FormControlService.prototype.getFormControlByBinding = function (frameContext, binding) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).find(function (ngFormControl) { return ngFormControl && ngFormControl.binding === binding; });
    };
    /**
     *
     * @param frameContext frameContext
     * @param fullPath
     * @returns
     */
    FormControlService.prototype.getFormControlIndexByFullPath = function (frameContext, fullPath) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        var bindings = fullPath.split('/').filter(function (p) { return p; });
        return Object.values(ngFormControls).findIndex(function (ngFormControl) {
            if (!ngFormControl) {
                return false;
            }
            var bindingPath = frameContext.viewModel.bindingPath;
            var bindingPaths = bindingPath.split('/').filter(function (p) { return p; });
            var formControlBindingPaths = ngFormControl.binding.split('.').filter(function (p) { return p; });
            var fullPath = bindingPaths.concat(formControlBindingPaths);
            return fullPath.join('/') === bindings.join('/');
        });
    };
    /**
     * 通过binding元数据获取NgFormControl位置
     * @param frameContext
     * @param binding binding
     * @returns 从0开始
     */
    FormControlService.prototype.getFormControlIndexByBinding = function (frameContext, binding) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).findIndex(function (ngFormControl) { return ngFormControl && ngFormControl.binding === binding; });
    };
    FormControlService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FormControlService.ctorParameters = function () { return []; };
    return FormControlService;
}());
export { FormControlService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1jb250cm9sLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbW1hbmQtc2VydmljZXMvIiwic291cmNlcyI6WyJsaWIvZm9ybS1jb250cm9sLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQztJQUVFO0lBQWdCLENBQUM7SUFDViwwREFBNkIsR0FBcEMsVUFBcUMsWUFBMEI7UUFDN0QsT0FBTyxZQUFZLElBQUksWUFBWSxDQUFDLElBQUksSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUM7SUFDdkYsQ0FBQztJQUNEOzs7OztPQUtHO0lBQ0ksb0RBQXVCLEdBQTlCLFVBQStCLFlBQTBCLEVBQUUsT0FBZTtRQUN4RSxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLGFBQTRCLElBQUssT0FBQSxhQUFhLElBQUksYUFBYSxDQUFDLE9BQU8sS0FBSyxPQUFPLEVBQWxELENBQWtELENBQUMsQ0FBQztJQUVsSSxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSwwREFBNkIsR0FBcEMsVUFBcUMsWUFBMEIsRUFBRSxRQUFnQjtRQUMvRSxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsSUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEVBQUQsQ0FBQyxDQUFDLENBQUM7UUFDcEQsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxVQUFDLGFBQTRCO1lBQzFFLElBQUksQ0FBQyxhQUFhLEVBQUU7Z0JBQ2xCLE9BQU8sS0FBSyxDQUFDO2FBQ2Q7WUFDRCxJQUFNLFdBQVcsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQztZQUN2RCxJQUFNLFlBQVksR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQztZQUMzRCxJQUFNLHVCQUF1QixHQUFHLGFBQWEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQztZQUNoRixJQUFNLFFBQVEsR0FBRyxZQUFZLENBQUMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFDOUQsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSx5REFBNEIsR0FBbkMsVUFBb0MsWUFBMEIsRUFBRSxPQUFlO1FBQzdFLElBQU0sY0FBYyxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ25CLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUMsYUFBNEIsSUFBSyxPQUFBLGFBQWEsSUFBSSxhQUFhLENBQUMsT0FBTyxLQUFLLE9BQU8sRUFBbEQsQ0FBa0QsQ0FBQyxDQUFDO0lBQ3ZJLENBQUM7O2dCQXZERixVQUFVOzs7O0lBd0RYLHlCQUFDO0NBQUEsQUF4REQsSUF3REM7U0F2RFksa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBGcmFtZUNvbnRleHQsIE5nRm9ybUNvbnRyb2wgfSBmcm9tIFwiQGZhcnJpcy9kZXZraXRcIjtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEZvcm1Db250cm9sU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKCkgeyB9XG4gIHB1YmxpYyBnZXRGb3JtQ29udHJvbHNCeUZyYW1lQ29udGV4dChmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCk6IHsgW3Byb3BlcnR5TmFtZTogc3RyaW5nXTogTmdGb3JtQ29udHJvbCB9IHwgbnVsbCB7XG4gICAgcmV0dXJuIGZyYW1lQ29udGV4dCAmJiBmcmFtZUNvbnRleHQuZm9ybSAmJiBmcmFtZUNvbnRleHQuZm9ybS5uZ0Zvcm1Db250cm9scyB8fCBudWxsO1xuICB9XG4gIC8qKlxuICAgKiDpgJrov4diaW5kaW5n5YWD5pWw5o2u6I635Y+WTmdGb3JtQ29udHJvbFxuICAgKiBAcGFyYW0gZnJhbWVDb250ZXh0IFxuICAgKiBAcGFyYW0gYmluZGluZyBiaW5kaW5nXG4gICAqIEByZXR1cm5zIFxuICAgKi9cbiAgcHVibGljIGdldEZvcm1Db250cm9sQnlCaW5kaW5nKGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0LCBiaW5kaW5nOiBzdHJpbmcpOiBOZ0Zvcm1Db250cm9sIHtcbiAgICBjb25zdCBuZ0Zvcm1Db250cm9scyA9IHRoaXMuZ2V0Rm9ybUNvbnRyb2xzQnlGcmFtZUNvbnRleHQoZnJhbWVDb250ZXh0KTtcbiAgICBpZiAoIW5nRm9ybUNvbnRyb2xzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobmdGb3JtQ29udHJvbHMpLmZpbmQoKG5nRm9ybUNvbnRyb2w6IE5nRm9ybUNvbnRyb2wpID0+IG5nRm9ybUNvbnRyb2wgJiYgbmdGb3JtQ29udHJvbC5iaW5kaW5nID09PSBiaW5kaW5nKTtcblxuICB9XG4gIC8qKlxuICAgKiBcbiAgICogQHBhcmFtIGZyYW1lQ29udGV4dCBmcmFtZUNvbnRleHRcbiAgICogQHBhcmFtIGZ1bGxQYXRoIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIHB1YmxpYyBnZXRGb3JtQ29udHJvbEluZGV4QnlGdWxsUGF0aChmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCwgZnVsbFBhdGg6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3QgbmdGb3JtQ29udHJvbHMgPSB0aGlzLmdldEZvcm1Db250cm9sc0J5RnJhbWVDb250ZXh0KGZyYW1lQ29udGV4dCk7XG4gICAgaWYgKCFuZ0Zvcm1Db250cm9scykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGJpbmRpbmdzID0gZnVsbFBhdGguc3BsaXQoJy8nKS5maWx0ZXIocCA9PiBwKTtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhuZ0Zvcm1Db250cm9scykuZmluZEluZGV4KChuZ0Zvcm1Db250cm9sOiBOZ0Zvcm1Db250cm9sKSA9PiB7XG4gICAgICBpZiAoIW5nRm9ybUNvbnRyb2wpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgYmluZGluZ1BhdGggPSBmcmFtZUNvbnRleHQudmlld01vZGVsLmJpbmRpbmdQYXRoO1xuICAgICAgY29uc3QgYmluZGluZ1BhdGhzID0gYmluZGluZ1BhdGguc3BsaXQoJy8nKS5maWx0ZXIocCA9PiBwKTtcbiAgICAgIGNvbnN0IGZvcm1Db250cm9sQmluZGluZ1BhdGhzID0gbmdGb3JtQ29udHJvbC5iaW5kaW5nLnNwbGl0KCcuJykuZmlsdGVyKHAgPT4gcCk7XG4gICAgICBjb25zdCBmdWxsUGF0aCA9IGJpbmRpbmdQYXRocy5jb25jYXQoZm9ybUNvbnRyb2xCaW5kaW5nUGF0aHMpO1xuICAgICAgcmV0dXJuIGZ1bGxQYXRoLmpvaW4oJy8nKSA9PT0gYmluZGluZ3Muam9pbignLycpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiDpgJrov4diaW5kaW5n5YWD5pWw5o2u6I635Y+WTmdGb3JtQ29udHJvbOS9jee9rlxuICAgKiBAcGFyYW0gZnJhbWVDb250ZXh0IFxuICAgKiBAcGFyYW0gYmluZGluZyBiaW5kaW5nXG4gICAqIEByZXR1cm5zIOS7jjDlvIDlp4tcbiAgICovXG4gIHB1YmxpYyBnZXRGb3JtQ29udHJvbEluZGV4QnlCaW5kaW5nKGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0LCBiaW5kaW5nOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IG5nRm9ybUNvbnRyb2xzID0gdGhpcy5nZXRGb3JtQ29udHJvbHNCeUZyYW1lQ29udGV4dChmcmFtZUNvbnRleHQpO1xuICAgIGlmICghbmdGb3JtQ29udHJvbHMpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhuZ0Zvcm1Db250cm9scykuZmluZEluZGV4KChuZ0Zvcm1Db250cm9sOiBOZ0Zvcm1Db250cm9sKSA9PiBuZ0Zvcm1Db250cm9sICYmIG5nRm9ybUNvbnRyb2wuYmluZGluZyA9PT0gYmluZGluZyk7XG4gIH1cbn0iXX0=