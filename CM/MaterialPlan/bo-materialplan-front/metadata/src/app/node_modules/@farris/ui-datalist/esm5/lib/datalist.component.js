/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Directive, TemplateRef, ContentChild, ElementRef, HostBinding, ViewEncapsulation, Output, EventEmitter, ChangeDetectionStrategy, ViewChild } from '@angular/core';
import { DataListFacadeService } from './core/datalist-facade.service';
var DataListItemTemplateDirective = /** @class */ (function () {
    function DataListItemTemplateDirective(template) {
        this.template = template;
    }
    DataListItemTemplateDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[list-item-tmp]'
                },] }
    ];
    /** @nocollapse */
    DataListItemTemplateDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return DataListItemTemplateDirective;
}());
export { DataListItemTemplateDirective };
if (false) {
    /** @type {?} */
    DataListItemTemplateDirective.prototype.template;
}
var DatalistComponent = /** @class */ (function () {
    function DatalistComponent(el, store) {
        this.el = el;
        this.store = store;
        this.cls = true;
        this.fit = true;
        this.width = 300;
        this.height = 400;
        this.multiSelect = false;
        this.disabled = false;
        this.showHeader = false;
        this.showCheckBox = false;
        this.headerHeight = 40;
        this.enableCancelSelected = true;
        /**
         * 分隔符，默认为 ,
         */
        this.separator = ',';
        this.selected = new EventEmitter();
        this.unSelected = new EventEmitter();
        this.selectedValuesChange = new EventEmitter();
        this.scrollbarHeight$ = this.store.containerHeight$;
        // tslint:disable-next-line:variable-name
        this._options$ = this.store.options$;
        this.data$ = this.store.data$;
    }
    Object.defineProperty(DatalistComponent.prototype, "fluid", {
        get: /**
         * @return {?}
         */
        function () {
            return this._height === 'auto' ? false : this.fit;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} changes
     * @return {?}
     */
    DatalistComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes && changes.data && !changes.data.isFirstChange()) {
            this.initCtrlState();
        }
        if (changes.selectedValues && !changes.selectedValues.isFirstChange()) {
            if (this.selectedValues !== '' && this.selectedValues !== undefined && this.selectedValues !== null) {
                this.store.setSelections(this.selectedValues, this.separator);
            }
            else {
                this.clearSelections();
            }
        }
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this._height = this.height;
        this.initCtrlState();
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.selectedValues && _this.height !== 'auto') {
                /** @type {?} */
                var val_1 = _this.selectedValues;
                if (_this.selectedValues.indexOf(_this.separator) > -1) {
                    val_1 = _this.selectedValues.indexOf(_this.separator)[0];
                }
                /** @type {?} */
                var index = _this.data.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.idField] == val_1; }));
                /** @type {?} */
                var ulEl = _this.el.nativeElement.querySelector('ul.list-group');
                if (ulEl.children[index]) {
                    ulEl.children[index].scrollIntoView({ block: 'nearest' });
                }
            }
        }), 10);
    };
    /**
     * @private
     * @return {?}
     */
    DatalistComponent.prototype.loadData = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.data) {
            this.store.loadData(this.data, this.selectedValues, this.separator);
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatalistComponent.prototype.initCtrlState = /**
     * @private
     * @return {?}
     */
    function () {
        var _a = tslib_1.__assign({}, this), title = _a.title, textField = _a.textField, fit = _a.fit, idField = _a.idField, valueField = _a.valueField, width = _a.width, height = _a.height, multiSelect = _a.multiSelect, disabled = _a.disabled, headerHeight = _a.headerHeight, separator = _a.separator;
        this.store.initState({
            title: title,
            textField: textField,
            valueField: valueField,
            fit: fit,
            idField: idField,
            width: width,
            height: height,
            multiSelect: multiSelect,
            disabled: disabled,
            headerHeight: headerHeight,
            separator: separator
        });
        this.loadData();
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.clearSelections = /**
     * @return {?}
     */
    function () {
        this.store.clearSelections();
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.resize = /**
     * @return {?}
     */
    function () {
        if (this.fit) {
            /** @type {?} */
            var container = this.el.nativeElement.parentElement;
            /** @type {?} */
            var width = container.offsetWidth;
            /** @type {?} */
            var height = container.offsetHeight;
            this.store.updateContainerSize(width, height);
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatalistComponent.prototype.updateSelectValues = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.selectedValues = this.store.getSelections().map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item[_this.valueField];
        })).join(this.separator);
        this.selectedValuesChange.emit(this.selectedValues);
    };
    /**
     * @param {?} event
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    DatalistComponent.prototype.onSelectHandler = /**
     * @param {?} event
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    function (event, index, item) {
        event.stopPropagation();
        if (this.disabled) {
            return false;
        }
        var data = tslib_1.__assign({}, item).data;
        if (!this.store.isSelect(item.id)) {
            this.store.selectItem(data, index);
            this.updateSelectValues();
            this.selected.emit({ index: index, data: data });
        }
        else {
            if (this.enableCancelSelected) {
                this.store.unSelectItem(data);
                this.updateSelectValues();
                this.unSelected.emit({ index: index, data: data });
            }
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatalistComponent.prototype.onCheckedChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var index = $event.index, row = $event.row, originalEvent = $event.originalEvent;
        this.onSelectHandler(originalEvent, index, row);
    };
    /**
     * @param {?} item
     * @return {?}
     */
    DatalistComponent.prototype.isChecked = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        var _this = this;
        /** @type {?} */
        var val = this.selectedValues;
        if (this.selectedValues === null && this.selectedValues === undefined) {
            val = '';
        }
        if (typeof val === 'boolean') {
            val = '' + val;
        }
        if (val) {
            /** @type {?} */
            var _vals = [];
            if (this.multiSelect) {
                _vals = val.split(this.separator);
            }
            else {
                _vals = [val];
            }
            return _vals.some((/**
             * @param {?} v
             * @return {?}
             */
            function (v) { return v == '' + item.data[_this.valueField]; }));
        }
        return false;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    DatalistComponent.prototype.isSelected = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        return this.isChecked(item);
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.selectAll = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.selectedValues = this.data.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item[_this.valueField]; })).join(this.separator);
        this.store.selectAll();
    };
    /**
     * @return {?}
     */
    DatalistComponent.prototype.unSelectAll = /**
     * @return {?}
     */
    function () {
        this.selectedValues = '';
        this.store.clearSelections();
    };
    DatalistComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-datalist',
                    template: "<div *ngIf=\"_options$ | async as opts\" class=\"card\" [style.width.%]=\"100\" [style.height]=\"opts.height === 'auto' ? 'auto' : opts.height + 'px'\" style=\"min-height: 10px;\">\r\n    <div class=\"card-header\" *ngIf=\"opts.showHeader\">\r\n        {{ opts.title }}\r\n    </div>\r\n    <!-- <perfect-scrollbar #ps *ngIf=\"opts.height && opts.height !== 'auto'\" [style.width.%]=\"100\" [style.height.px]=\"scrollbarHeight$ | async\"> -->\r\n    <div *ngIf=\"opts.height && opts.height !== 'auto' && (data$ | async).length > 0\" style=\"overflow: auto;\" [style.width.%]=\"100\" [style.height.px]=\"scrollbarHeight$ | async\">\r\n        <ul class=\"list-group list-group-flush\">\r\n            <li style=\"cursor: default;\" [farrist-datalist-item]=\"item\" [style.height.px]=\"itemHeight\"\r\n                [class.active]=\"store.isSelect(item.id)\" class=\"list-group-item list-group-item-action\"\r\n                *ngFor=\"let item of data$ | async; let i = index\" title=\"{{item.data[textField]}}\" (click)=\"onSelectHandler( $event, i, item)\">\r\n                <dl-checkbox *ngIf=\"multiSelect\" [checked]=\"isChecked(item)\" [index]=\"i\" [row]=\"item\"\r\n                    (checkedChange)=\"onCheckedChange($event)\"></dl-checkbox>\r\n                <ng-container *ngIf=\"!itemTemplate\">\r\n                    <span class=\"f-datalist-item-text\">{{ item.data[textField] }}</span>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"itemTemplate\" [ngTemplateOutlet]=\"itemTemplate\"\r\n                    [ngTemplateOutletContext]=\"{ data: item, index: i }\">\r\n                </ng-container>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <!-- </perfect-scrollbar> -->\r\n    <div *ngIf=\"opts.height === 'auto' && (data$ | async).length > 0\" >\r\n        <ul class=\"list-group list-group-flush\">\r\n            <li style=\"cursor: default;\" [farrist-datalist-item]=\"item\" [style.height.px]=\"itemHeight\"\r\n                [class.active]=\"isSelected(item)\" class=\"list-group-item list-group-item-action\"\r\n                *ngFor=\"let item of data$ | async; let i = index\" title=\"{{item.data[textField]}}\" (click)=\"onSelectHandler( $event, i, item)\">\r\n                <dl-checkbox *ngIf=\"multiSelect\" [checked]=\"isChecked(item)\" [index]=\"i\" [row]=\"item\"\r\n                    (checkedChange)=\"onCheckedChange($event)\"></dl-checkbox>\r\n                <ng-container *ngIf=\"!itemTemplate\">\r\n                    <span class=\"f-datalist-item-text\">{{ item.data[textField] }}</span>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"itemTemplate\" [ngTemplateOutlet]=\"itemTemplate\"\r\n                    [ngTemplateOutletContext]=\"{ data: item, index: i }\">\r\n                </ng-container>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div *ngIf=\"(data$ | async).length === 0\" style=\"height: 200px;\">\r\n        <div class=\"f-table-norecords-content\">\u6682\u65E0\u6570\u636E</div>\r\n    </div>\r\n</div>",
                    providers: [DataListFacadeService],
                    encapsulation: ViewEncapsulation.None,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    styles: ["\n            .ps__rail-x,\n            .ps__rail-y {\n                z-index: 9;\n            }\n            .norecords-content {\n                height: 8.125rem;\n                padding: 7.8125rem 0 0;\n                width: 100%;\n                text-align: center;\n                font-size: 1rem;\n                color: rgba(0,0,0,.25);\n                background: url(imgs/table-norecords.png) top center no-repeat;\n                margin: -4.0625rem 0 0 -.625rem;\n                line-height: 2.5rem;\n            }\n        "]
                }] }
    ];
    /** @nocollapse */
    DatalistComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: DataListFacadeService }
    ]; };
    DatalistComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class.f-datalist',] }],
        fluid: [{ type: HostBinding, args: ['class.farris-main-area',] }],
        itemHeight: [{ type: Input }],
        title: [{ type: Input }],
        data: [{ type: Input }],
        textField: [{ type: Input }],
        valueField: [{ type: Input }],
        idField: [{ type: Input }],
        fit: [{ type: Input }],
        width: [{ type: Input }],
        height: [{ type: Input }],
        multiSelect: [{ type: Input }],
        disabled: [{ type: Input }],
        showHeader: [{ type: Input }],
        showCheckBox: [{ type: Input }],
        headerHeight: [{ type: Input }],
        selectedValues: [{ type: Input }],
        enableCancelSelected: [{ type: Input }],
        separator: [{ type: Input }],
        itemTemplate: [{ type: ContentChild, args: [DataListItemTemplateDirective, { read: TemplateRef },] }],
        selected: [{ type: Output }],
        unSelected: [{ type: Output }],
        selectedValuesChange: [{ type: Output }]
    };
    return DatalistComponent;
}());
export { DatalistComponent };
if (false) {
    /** @type {?} */
    DatalistComponent.prototype.cls;
    /** @type {?} */
    DatalistComponent.prototype.itemHeight;
    /** @type {?} */
    DatalistComponent.prototype.title;
    /** @type {?} */
    DatalistComponent.prototype.data;
    /** @type {?} */
    DatalistComponent.prototype.textField;
    /** @type {?} */
    DatalistComponent.prototype.valueField;
    /** @type {?} */
    DatalistComponent.prototype.idField;
    /** @type {?} */
    DatalistComponent.prototype.fit;
    /** @type {?} */
    DatalistComponent.prototype.width;
    /** @type {?} */
    DatalistComponent.prototype.height;
    /** @type {?} */
    DatalistComponent.prototype.multiSelect;
    /** @type {?} */
    DatalistComponent.prototype.disabled;
    /** @type {?} */
    DatalistComponent.prototype.showHeader;
    /** @type {?} */
    DatalistComponent.prototype.showCheckBox;
    /** @type {?} */
    DatalistComponent.prototype.headerHeight;
    /** @type {?} */
    DatalistComponent.prototype.selectedValues;
    /** @type {?} */
    DatalistComponent.prototype.enableCancelSelected;
    /**
     * 分隔符，默认为 ,
     * @type {?}
     */
    DatalistComponent.prototype.separator;
    /** @type {?} */
    DatalistComponent.prototype.itemTemplate;
    /** @type {?} */
    DatalistComponent.prototype.selected;
    /** @type {?} */
    DatalistComponent.prototype.unSelected;
    /** @type {?} */
    DatalistComponent.prototype.selectedValuesChange;
    /** @type {?} */
    DatalistComponent.prototype.scrollbarHeight$;
    /** @type {?} */
    DatalistComponent.prototype._options$;
    /** @type {?} */
    DatalistComponent.prototype.data$;
    /**
     * @type {?}
     * @private
     */
    DatalistComponent.prototype._height;
    /** @type {?} */
    DatalistComponent.prototype.el;
    /** @type {?} */
    DatalistComponent.prototype.store;
}
var DataListItemComponentDirective = /** @class */ (function () {
    function DataListItemComponentDirective(el) {
        this.el = el;
    }
    /**
     * @return {?}
     */
    DataListItemComponentDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    DataListItemComponentDirective.decorators = [
        { type: Directive, args: [{
                    // tslint:disable-next-line:directive-selector
                    selector: '[farrist-datalist-item]'
                },] }
    ];
    /** @nocollapse */
    DataListItemComponentDirective.ctorParameters = function () { return [
        { type: ElementRef }
    ]; };
    DataListItemComponentDirective.propDecorators = {
        data: [{ type: Input, args: ['farrist-datalist-item',] }]
    };
    return DataListItemComponentDirective;
}());
export { DataListItemComponentDirective };
if (false) {
    /** @type {?} */
    DataListItemComponentDirective.prototype.data;
    /**
     * @type {?}
     * @private
     */
    DataListItemComponentDirective.prototype.el;
}
/**
 * 表体checkbox 组件
 */
var DataListCheckboxComponent = /** @class */ (function () {
    function DataListCheckboxComponent() {
        this.checkedChange = new EventEmitter();
    }
    /**
     * @return {?}
     */
    DataListCheckboxComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?} event
     * @return {?}
     */
    DataListCheckboxComponent.prototype.handleClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.checked = !this.checked;
        this.checkedChange.emit({ originalEvent: event, index: this.index, row: this.row, state: this.checked });
        event.stopPropagation();
    };
    DataListCheckboxComponent.decorators = [
        { type: Component, args: [{
                    // tslint:disable-next-line:component-selector
                    selector: 'dl-checkbox',
                    template: "\n        <div class=\"custom-control custom-checkbox  custom-control-inline dl-checkbox\">\n            <input type=\"checkbox\" #chk class=\"custom-control-input\" [disabled]=\"disabled\" [checked]=\"checked\" />\n            <label class=\"custom-control-label\" (click)=\"handleClick($event)\"></label>\n        </div>\n    ",
                    styles: ["\n            :host .custom-checkbox {\n                opacity: 1;\n                float: none;\n                margin: 0;\n                vertical-align: top;\n                padding-right: 0px;\n            }\n        "]
                }] }
    ];
    /** @nocollapse */
    DataListCheckboxComponent.ctorParameters = function () { return []; };
    DataListCheckboxComponent.propDecorators = {
        checked: [{ type: Input }],
        disabled: [{ type: Input }],
        index: [{ type: Input }],
        row: [{ type: Input }],
        checkedChange: [{ type: Output }],
        chk: [{ type: ViewChild, args: ['chk',] }]
    };
    return DataListCheckboxComponent;
}());
export { DataListCheckboxComponent };
if (false) {
    /** @type {?} */
    DataListCheckboxComponent.prototype.checked;
    /** @type {?} */
    DataListCheckboxComponent.prototype.disabled;
    /** @type {?} */
    DataListCheckboxComponent.prototype.index;
    /** @type {?} */
    DataListCheckboxComponent.prototype.row;
    /** @type {?} */
    DataListCheckboxComponent.prototype.checkedChange;
    /** @type {?} */
    DataListCheckboxComponent.prototype.chk;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWxpc3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhbGlzdC8iLCJzb3VyY2VzIjpbImxpYi9kYXRhbGlzdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUVULEtBQUssRUFDTCxTQUFTLEVBQ1QsV0FBVyxFQUNYLFlBQVksRUFDWixVQUFVLEVBQ1YsV0FBVyxFQUVYLGlCQUFpQixFQUNqQixNQUFNLEVBQ04sWUFBWSxFQUNaLHVCQUF1QixFQUd2QixTQUFTLEVBQ1osTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFHdkU7SUFJSSx1Q0FBbUIsUUFBMEI7UUFBMUIsYUFBUSxHQUFSLFFBQVEsQ0FBa0I7SUFBRyxDQUFDOztnQkFKcEQsU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxpQkFBaUI7aUJBQzlCOzs7O2dCQW5CRyxXQUFXOztJQXNCZixvQ0FBQztDQUFBLEFBTEQsSUFLQztTQUZZLDZCQUE2Qjs7O0lBQzFCLGlEQUFpQzs7QUFHakQ7SUFnRUksMkJBQW1CLEVBQWMsRUFBUyxLQUE0QjtRQUFuRCxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBdUI7UUFyQ3JDLFFBQUcsR0FBRyxJQUFJLENBQUM7UUFjbkMsUUFBRyxHQUFHLElBQUksQ0FBQztRQUNYLFVBQUssR0FBRyxHQUFHLENBQUM7UUFDWixXQUFNLEdBQW9CLEdBQUcsQ0FBQztRQUM5QixnQkFBVyxHQUFHLEtBQUssQ0FBQztRQUNwQixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ2pCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFDckIsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFFbEIseUJBQW9CLEdBQUcsSUFBSSxDQUFDOzs7O1FBRTVCLGNBQVMs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QUUsQ0FBQyxDQUFDO1FBQ3pHLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUM1QixDQUFDOztnQkF0Q0osU0FBUyxTQUFDOztvQkFFUCxRQUFRLEVBQUUsYUFBYTtvQkFDdkIsUUFBUSxFQUFFLDBVQUtUOzZCQUVHLG1PQVFDO2lCQUVSOzs7OzswQkFFSSxLQUFLOzJCQUNMLEtBQUs7d0JBQ0wsS0FBSztzQkFDTCxLQUFLO2dDQUNMLE1BQU07c0JBRU4sU0FBUyxTQUFDLEtBQUs7O0lBV3BCLGdDQUFDO0NBQUEsQUF2Q0QsSUF1Q0M7U0FsQlkseUJBQXlCOzs7SUFDbEMsNENBQTBCOztJQUMxQiw2Q0FBMkI7O0lBQzNCLDBDQUF1Qjs7SUFDdkIsd0NBQWtCOztJQUNsQixrREFBNkM7O0lBRTdDLHdDQUFrQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBPbkluaXQsXHJcbiAgICBJbnB1dCxcclxuICAgIERpcmVjdGl2ZSxcclxuICAgIFRlbXBsYXRlUmVmLFxyXG4gICAgQ29udGVudENoaWxkLFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIEhvc3RCaW5kaW5nLFxyXG4gICAgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxyXG4gICAgT3V0cHV0LFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXHJcbiAgICBTaW1wbGVDaGFuZ2VzLFxyXG4gICAgT25DaGFuZ2VzLFxyXG4gICAgVmlld0NoaWxkXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZhcnJpc0RhdGFJdGVtIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBEYXRhTGlzdEZhY2FkZVNlcnZpY2UgfSBmcm9tICcuL2NvcmUvZGF0YWxpc3QtZmFjYWRlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTZWxlY3RJdGVtIH0gZnJvbSAnLi9jb3JlL3R5cGVzJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbbGlzdC1pdGVtLXRtcF0nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhTGlzdEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4pIHt9XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtZGF0YWxpc3QnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2RhdGFsaXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlczogW1xyXG4gICAgICAgIGBcclxuICAgICAgICAgICAgLnBzX19yYWlsLXgsXHJcbiAgICAgICAgICAgIC5wc19fcmFpbC15IHtcclxuICAgICAgICAgICAgICAgIHotaW5kZXg6IDk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLm5vcmVjb3Jkcy1jb250ZW50IHtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogOC4xMjVyZW07XHJcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA3LjgxMjVyZW0gMCAwO1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDFyZW07XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogcmdiYSgwLDAsMCwuMjUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdXJsKGltZ3MvdGFibGUtbm9yZWNvcmRzLnBuZykgdG9wIGNlbnRlciBuby1yZXBlYXQ7XHJcbiAgICAgICAgICAgICAgICBtYXJnaW46IC00LjA2MjVyZW0gMCAwIC0uNjI1cmVtO1xyXG4gICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDIuNXJlbTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGBcclxuICAgIF0sXHJcbiAgICBwcm92aWRlcnM6IFtEYXRhTGlzdEZhY2FkZVNlcnZpY2VdLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhbGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0IHtcclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZi1kYXRhbGlzdCcpIGNscyA9IHRydWU7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mYXJyaXMtbWFpbi1hcmVhJylcclxuICAgIGdldCBmbHVpZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0ID09PSAnYXV0bycgPyBmYWxzZSA6IHRoaXMuZml0O1xyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIGl0ZW1IZWlnaHQ6IG51bWJlcjtcclxuXHJcbiAgICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZGF0YTogYW55O1xyXG4gICAgQElucHV0KCkgdGV4dEZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSB2YWx1ZUZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBpZEZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBmaXQgPSB0cnVlO1xyXG4gICAgQElucHV0KCkgd2lkdGggPSAzMDA7XHJcbiAgICBASW5wdXQoKSBoZWlnaHQ6IG51bWJlciB8IHN0cmluZyA9IDQwMDtcclxuICAgIEBJbnB1dCgpIG11bHRpU2VsZWN0ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgc2hvd0hlYWRlciA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQm94ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBoZWFkZXJIZWlnaHQgPSA0MDtcclxuICAgIEBJbnB1dCgpIHNlbGVjdGVkVmFsdWVzOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVDYW5jZWxTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAvKiog5YiG6ZqU56ym77yM6buY6K6k5Li6ICwgKi9cclxuICAgIEBJbnB1dCgpIHNlcGFyYXRvciA9ICcsJztcclxuICAgIEBDb250ZW50Q2hpbGQoRGF0YUxpc3RJdGVtVGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgaXRlbVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXI8U2VsZWN0SXRlbT4oKTtcclxuICAgIEBPdXRwdXQoKSB1blNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxTZWxlY3RJdGVtPigpO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdGVkVmFsdWVzQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHNjcm9sbGJhckhlaWdodCQgPSB0aGlzLnN0b3JlLmNvbnRhaW5lckhlaWdodCQ7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZVxyXG4gICAgX29wdGlvbnMkID0gdGhpcy5zdG9yZS5vcHRpb25zJDtcclxuICAgIGRhdGEkID0gdGhpcy5zdG9yZS5kYXRhJDtcclxuICAgIHByaXZhdGUgX2hlaWdodDogYW55O1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIGVsOiBFbGVtZW50UmVmLCBwdWJsaWMgc3RvcmU6IERhdGFMaXN0RmFjYWRlU2VydmljZSkge31cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0Q3RybFN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zZWxlY3RlZFZhbHVlcyAmJiAhY2hhbmdlcy5zZWxlY3RlZFZhbHVlcy5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRWYWx1ZXMgIT09ICcnICYmIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNlbGVjdGVkVmFsdWVzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLnNldFNlbGVjdGlvbnModGhpcy5zZWxlY3RlZFZhbHVlcywgdGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLl9oZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICB0aGlzLmluaXRDdHJsU3RhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzICYmIHRoaXMuaGVpZ2h0ICE9PSAnYXV0bycpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0gdGhpcy5zZWxlY3RlZFZhbHVlcztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzLmluZGV4T2YodGhpcy5zZXBhcmF0b3IpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnNlbGVjdGVkVmFsdWVzLmluZGV4T2YodGhpcy5zZXBhcmF0b3IpWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kYXRhLmZpbmRJbmRleChuID0+IG5bdGhpcy5pZEZpZWxkXSA9PSB2YWwpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdWxFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bC5saXN0LWdyb3VwJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodWxFbC5jaGlsZHJlbltpbmRleF0pIHtcclxuICAgICAgICAgICAgICAgICAgICB1bEVsLmNoaWxkcmVuW2luZGV4XS5zY3JvbGxJbnRvVmlldyh7YmxvY2s6ICduZWFyZXN0J30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMTApO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBsb2FkRGF0YSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmUubG9hZERhdGEodGhpcy5kYXRhLCB0aGlzLnNlbGVjdGVkVmFsdWVzLCB0aGlzLnNlcGFyYXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdEN0cmxTdGF0ZSgpIHtcclxuICAgICAgICBjb25zdCB7IHRpdGxlLCB0ZXh0RmllbGQsIGZpdCwgaWRGaWVsZCwgdmFsdWVGaWVsZCwgd2lkdGgsIGhlaWdodCwgbXVsdGlTZWxlY3QsIGRpc2FibGVkLCBoZWFkZXJIZWlnaHQsIHNlcGFyYXRvciB9ID0ge1xyXG4gICAgICAgICAgICAuLi50aGlzXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnN0b3JlLmluaXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICB0ZXh0RmllbGQsXHJcbiAgICAgICAgICAgIHZhbHVlRmllbGQsXHJcbiAgICAgICAgICAgIGZpdCxcclxuICAgICAgICAgICAgaWRGaWVsZCxcclxuICAgICAgICAgICAgd2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodCxcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3QsXHJcbiAgICAgICAgICAgIGRpc2FibGVkLFxyXG4gICAgICAgICAgICBoZWFkZXJIZWlnaHQsXHJcbiAgICAgICAgICAgIHNlcGFyYXRvclxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmxvYWREYXRhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIHRoaXMuc3RvcmUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzaXplKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZpdCkge1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBjb250YWluZXIub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmUudXBkYXRlQ29udGFpbmVyU2l6ZSh3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVTZWxlY3RWYWx1ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IHRoaXMuc3RvcmUuZ2V0U2VsZWN0aW9ucygpLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGhpcy52YWx1ZUZpZWxkXTtcclxuICAgICAgICB9KS5qb2luKHRoaXMuc2VwYXJhdG9yKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzQ2hhbmdlLmVtaXQodGhpcy5zZWxlY3RlZFZhbHVlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWxlY3RIYW5kbGVyKGV2ZW50OiBFdmVudCwgaW5kZXg6IG51bWJlciwgaXRlbTogRmFycmlzRGF0YUl0ZW0pIHtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0geyAuLi5pdGVtIH07XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5zdG9yZS5pc1NlbGVjdChpdGVtLmlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3JlLnNlbGVjdEl0ZW0oZGF0YSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdFZhbHVlcygpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkLmVtaXQoeyBpbmRleCwgZGF0YSB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVDYW5jZWxTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yZS51blNlbGVjdEl0ZW0oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdFZhbHVlcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkLmVtaXQoeyBpbmRleCwgZGF0YSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uQ2hlY2tlZENoYW5nZSgkZXZlbnQpIHtcclxuICAgICAgICBjb25zdCB7IGluZGV4LCByb3csIG9yaWdpbmFsRXZlbnQgfSA9ICRldmVudDtcclxuICAgICAgICB0aGlzLm9uU2VsZWN0SGFuZGxlcihvcmlnaW5hbEV2ZW50LCBpbmRleCwgcm93KTtcclxuICAgIH1cclxuICAgIGlzQ2hlY2tlZChpdGVtOiBGYXJyaXNEYXRhSXRlbSkge1xyXG4gICAgICAgIGxldCB2YWwgPSB0aGlzLnNlbGVjdGVkVmFsdWVzO1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzID09PSBudWxsICYmIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB2YWwgPSAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgdmFsID0gJycgKyB2YWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgICAgIGxldCBfdmFscyA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgX3ZhbHMgPSB2YWwuc3BsaXQodGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3ZhbHMgPSBbdmFsXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gX3ZhbHMuc29tZSggdiA9PiB2ID09ICAnJyArIGl0ZW0uZGF0YVt0aGlzLnZhbHVlRmllbGRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlzU2VsZWN0ZWQoaXRlbTogRmFycmlzRGF0YUl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc0NoZWNrZWQoaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZWN0QWxsKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB0aGlzLmRhdGEubWFwKGl0ZW0gPT4gaXRlbVt0aGlzLnZhbHVlRmllbGRdKS5qb2luKHRoaXMuc2VwYXJhdG9yKTtcclxuICAgICAgICB0aGlzLnN0b3JlLnNlbGVjdEFsbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHVuU2VsZWN0QWxsKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSAnJztcclxuICAgICAgICB0aGlzLnN0b3JlLmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpkaXJlY3RpdmUtc2VsZWN0b3JcclxuICAgIHNlbGVjdG9yOiAnW2ZhcnJpc3QtZGF0YWxpc3QtaXRlbV0nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhTGlzdEl0ZW1Db21wb25lbnREaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gICAgQElucHV0KCdmYXJyaXN0LWRhdGFsaXN0LWl0ZW0nKSBkYXRhOiBGYXJyaXNEYXRhSXRlbTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmKSB7fVxyXG4gICAgbmdPbkluaXQoKSB7fVxyXG59XHJcblxyXG4vKipcclxuICog6KGo5L2TY2hlY2tib3gg57uE5Lu2XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcclxuICAgIHNlbGVjdG9yOiAnZGwtY2hlY2tib3gnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwiY3VzdG9tLWNvbnRyb2wgY3VzdG9tLWNoZWNrYm94ICBjdXN0b20tY29udHJvbC1pbmxpbmUgZGwtY2hlY2tib3hcIj5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiICNjaGsgY2xhc3M9XCJjdXN0b20tY29udHJvbC1pbnB1dFwiIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiIFtjaGVja2VkXT1cImNoZWNrZWRcIiAvPlxyXG4gICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJjdXN0b20tY29udHJvbC1sYWJlbFwiIChjbGljayk9XCJoYW5kbGVDbGljaygkZXZlbnQpXCI+PC9sYWJlbD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgICAgIDpob3N0IC5jdXN0b20tY2hlY2tib3gge1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICAgICAgICAgIGZsb2F0OiBub25lO1xyXG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwO1xyXG4gICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDtcclxuICAgICAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDBweDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGBcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFMaXN0Q2hlY2tib3hDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gICAgQElucHV0KCkgY2hlY2tlZDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGRpc2FibGVkOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgaW5kZXg6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIHJvdzogYW55O1xyXG4gICAgQE91dHB1dCgpIGNoZWNrZWRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnY2hrJykgY2hrOiBFbGVtZW50UmVmO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgICBuZ09uSW5pdCgpIHt9XHJcblxyXG4gICAgaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNoZWNrZWQgPSAhdGhpcy5jaGVja2VkO1xyXG4gICAgICAgIHRoaXMuY2hlY2tlZENoYW5nZS5lbWl0KHsgb3JpZ2luYWxFdmVudDogZXZlbnQsIGluZGV4OiB0aGlzLmluZGV4LCByb3c6IHRoaXMucm93LCBzdGF0ZTogdGhpcy5jaGVja2VkIH0pO1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==