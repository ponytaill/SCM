/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { delay, debounceTime, takeUntil } from 'rxjs/operators';
import { of, Subject } from 'rxjs';
import ResizeObserver from 'resize-observer-polyfill';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 07:47:12
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-26 10:21:25
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, ChangeDetectorRef, ChangeDetectionStrategy, NgZone, Injector, Optional, ApplicationRef, Output, EventEmitter } from '@angular/core';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { ScrollbarDirective } from '../../scrollbar/scrollbar.directive';
import { SCROLL_X_ACTION, SCROLL_Y_ACTION, SCROLL_X_REACH_START_ACTION, TR_PREFIX } from '../../types/constant';
import { DatagridService } from '../../services/datagrid.service';
import { DatagridComponent } from '../../datagrid.component';
import { FormatCellDataPipe } from '../../utils/format-cell-data.pipe';
import { ColumnFormatService } from '@farris/ui-common/column';
import { Utils } from '../../utils/utils';
export class DatagridBodyComponent {
    /**
     * @param {?} injector
     * @param {?} app
     * @param {?} dg
     * @param {?} cd
     * @param {?} el
     */
    constructor(injector, app, dg, cd, el) {
        this.injector = injector;
        this.app = app;
        this.dg = dg;
        this.cd = cd;
        this.el = el;
        // 自动高度时，禁用纵向滚动条
        this.psConfig = { swipeEasing: false, minScrollbarLength: 15, handlers: ['click-rail', 'drag-thumb', 'wheel', 'touch'], suppressScrollY: this.dg.autoHeight && this.dg.maxHeight ? false : this.dg.autoHeight };
        this.scrollTop = 0;
        this.scrollLeft = 0;
        this.deltaTopHeight = 0;
        // wheelHeight = 0;
        this.wheelWidth = 0;
        this._fixedRightScrollLeft = 0;
        this.maxScrollLeft = 0;
        this.showRightShadow = false;
        this.footerHeight = 0;
        // 虚拟加载
        this.topHideHeight = 0;
        this.bottomHideHeight = 0;
        this.startRowIndex = 0;
        this.dataChange = new EventEmitter();
        this.scrollBarMode = 'auto';
        this.checkedRows = [];
        /**
         * 性能优化版，默认为 false
         */
        this.fast = false;
        this.visibleContextMenus = [];
        this.currentRowId = undefined;
        this._hoverRowIndex = -1;
        this.subscriptions = [];
        this.minRowBuffer = 3;
        this.vScrollDir = 1;
        this.rowsCache = {};
        this.lastRenderedScrollTop = 0;
        this.lastRenderedScrollLeft = 0;
        this.prevScrollTop = 0;
        this.prevScrollLeft = 0;
        this.rows = [];
        this.blankTopHeight = 0;
        this.blankBottomHeight = 0;
        this.cellContentFormatter = null;
        // 当启用多选且允许多选中，列表不能编辑时，取选中后禁止触发body 的click 事件
        this.__triggerBodyClickEvent = true;
        this.destroy$ = new Subject();
        this._onMouseClick = null;
        this._scrollTimer = 0;
        this._scrollXTimer = 0;
        this.ro = null;
        this.resizeObserverTimer = 0;
        this.onBeforeShowContextMenu = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            // row_1_fixedleft  row_1  row_1_fixedright
            const { contextMenuDom, event } = e;
            if (event.target.closest('.datagrid-editor')) {
                return of({ show: false });
            }
            /** @type {?} */
            let rowID = event.target.id;
            if (contextMenuDom) {
                // 排除分组行、分组合计行
                if (contextMenuDom.className.indexOf('f-datagrid-group-row') === -1 && contextMenuDom.className.indexOf('f-datagrid-group-footer') === -1) {
                    rowID = contextMenuDom.id.replace('row_', '').replace('_fixedleft', '').replace('_fixedright', '');
                    /** @type {?} */
                    const rowData = this.dfs.findRow(rowID);
                    /** @type {?} */
                    const focusTargetWidth = this.viewportW > this.totalWidth ? this.totalWidth : this.viewportW;
                    return of({ show: true, data: { data: rowData.data, grid: this.dg }, focusTargetWidth });
                }
            }
            return of({ show: false });
        });
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        this.ngZone = this.injector.get(NgZone);
        this.render = this.injector.get(Renderer2);
        /** @type {?} */
        const columnFormatService = this.injector.get(ColumnFormatService);
        this.cellContentFormatter = new FormatCellDataPipe(columnFormatService, this.injector);
    }
    /**
     * @return {?}
     */
    get fixedRightScrollLeft() {
        return this._fixedRightScrollLeft;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set fixedRightScrollLeft(val) {
        this._fixedRightScrollLeft = val;
    }
    /**
     * @return {?}
     */
    get hoverRowIndex() {
        return this._hoverRowIndex;
    }
    /**
     * @param {?} rowIdx
     * @return {?}
     */
    set hoverRowIndex(rowIdx) {
        this._hoverRowIndex = rowIdx;
        this.cd.detectChanges();
    }
    /**
     * @return {?}
     */
    get selectedRows() {
        return this.dg.selections;
    }
    //////////////////////////////////////////////////////////////////////////
    /**
     * @return {?}
     */
    get scrollbarXHeight() {
        if (this.dg && this.ps && this.ps.instance) {
            /** @type {?} */
            const h = this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 22 : 0;
            if (this.ps.instance['scrollbarYActive'] && h) {
                return h + 18; // + (this.dg.showScrollArrow && this.ps.instance['scrollbarYActive'] ? 18 : 0);
            }
        }
    }
    /**
     * @return {?}
     */
    get scrollbarYWidth() {
        if (this.dg && this.ps && this.ps.instance) {
            return this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarYActive'] && this.showRightShadow ? 18 : 0;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.listenSubjects();
        this.dg.scrollInstance = this.ps;
        /** @type {?} */
        const s1 = this.dgs.showGridHeader.subscribe((/**
         * @param {?} headerHeight
         * @return {?}
         */
        headerHeight => {
            this.updateContainerSize(headerHeight);
        }));
        this.subscriptions.push(s1);
        /** @type {?} */
        const s10 = this.dgs.footerPositionChanged.subscribe((/**
         * @return {?}
         */
        () => {
            this.updateContainerSize();
        }));
        this.subscriptions.push(s10);
        /** @type {?} */
        const s2 = this.dgs.rowHeightChanged.subscribe((/**
         * @return {?}
         */
        () => {
            this.cd.detectChanges();
        }));
        this.subscriptions.push(s2);
        /** @type {?} */
        const s3 = this.dfs.clientSort$.subscribe((/**
         * @return {?}
         */
        () => {
            this.checkScrollbarPosition(true);
            this.cd.detectChanges();
            // this.dg.columnSorted.emit();
        }));
        this.subscriptions.push(s3);
        /** @type {?} */
        const s5 = this.dg.dgs.columnsChanged.pipe(delay(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (e && e.scrollToLeft) {
                this.ps.elementRef.nativeElement.scrollTo(0, 0);
                this.ps.scrollToLeft(0, 100);
            }
        }));
        this.subscriptions.push(s5);
        this.viewScrollContainer.nativeElement.addEventListener('click', this._onMouseClick = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.onMouseClick(e);
        }));
    }
    /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    updateContainerSize(headerHeight) {
        /** @type {?} */
        const hh = headerHeight || this.dg.realHeaderHeight;
        this.setPositionTop(hh);
        this.height = this.dg.height - this.top;
        this.bodyStyle = this.getBodyStyle();
        this.cd.detectChanges();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.data && !changes.data.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
            this.dfs.setCurrentPageData(changes.data.currentValue);
            /** @type {?} */
            const isDiffrentDataSource = !!changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => !n['__group__'])).map((/**
             * @param {?} n
             * @return {?}
             */
            n => n.id)).filter((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                return !changes.data.previousValue.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => !n['__group__'])).find((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.id === n));
            })).length;
            /** @type {?} */
            const isSameLength = changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => !n['__group__'])).length >= changes.data.previousValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => !n['__group__'])).length;
            this.onDataChanged(isSameLength, isDiffrentDataSource);
            if (!changes.data.currentValue || !changes.data.currentValue.length) {
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    this.setPositionTop(this.dg.realHeaderHeight);
                }));
            }
        }
        if (changes.footerHeight !== undefined && !changes.footerHeight.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
        }
        if (changes.scrollBarMode !== undefined && !changes.scrollBarMode.isFirstChange()) {
            if (this.ps && this.ps.instance && this.scrollBarMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            else {
                this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            }
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
        }
        if (changes.showScrollArrow && !changes.showScrollArrow.isFirstChange()) {
            this.ps && this.ps.update();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
        this.cellContentFormatter = null;
        this.dg.scrollInstance = null;
        this.destroySubscriptions();
        this.viewScrollContainer.nativeElement.removeEventListener('click', this._onMouseClick);
        if (this.ro) {
            this.ro.unobserve(this.viewScrollContainer.nativeElement);
            this.ro.disconnect();
        }
        if (this.resizeObserverTimer) {
            clearTimeout(this.resizeObserverTimer);
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.ro = new ResizeObserver((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (this.viewScrollContainer.nativeElement.offsetParent) {
                if (this.resizeObserverTimer) {
                    clearTimeout(this.resizeObserverTimer);
                }
                this.resizeObserverTimer = setTimeout((/**
                 * @return {?}
                 */
                () => {
                    this.updateCanvasHeight();
                    if (this.scrollBarMode === 'allways') {
                        this.ps.update();
                    }
                    this.cd.detectChanges();
                    this.dgs.scrollbarUpdate.emit({ scrollbarRef: this.ps.instance, rightWidth: this.rightFixedWidth });
                }), 100);
            }
        }));
        this.ro.observe(this.viewScrollContainer.nativeElement);
    }
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
    }
    /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    setPositionTop(headerHeight) {
        this.top = headerHeight;
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            this.top += this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            this.top += this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && (this.dg.footerPosition === 'top' || this.dg.footerPosition === 'both')) {
            // headerHeight 已包括过滤行的高度 tfs 542471
            if (this.data && this.data.length) {
                this.top += this.dg.footerHeight;
            }
        }
    }
    /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    checkScrollbarPosition(toTop = false) {
        if (!this.dg.data || !this.dg.data.length) {
            return;
        }
        /** @type {?} */
        const scrollBar = this.ps.instance;
        /** @type {?} */
        const scrollElRef = this.ps.elementRef.nativeElement;
        // scrollBar.update();
        /** @type {?} */
        const lastScrollLeft = scrollBar ? scrollBar.lastScrollLeft : 0;
        /** @type {?} */
        const lastScrollTop = scrollBar ? scrollBar.lastScrollTop : 0;
        // const lastScrollLeft = this.scrollLeft;
        // const lastScrollTop = this.scrollTop;
        /** @type {?} */
        const scrollTop = scrollElRef.scrollTop;
        /** @type {?} */
        const scrollLeft = scrollElRef.scrollLeft;
        if (!toTop) {
            if (scrollTop != lastScrollTop) {
                this.ps.scrollToTop(lastScrollTop);
                this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
            }
        }
        else {
            this.ps.scrollToTop();
            this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
        }
        this.scrollLeft = lastScrollLeft;
        if (scrollLeft != lastScrollLeft) {
            this.ps.scrollToX(lastScrollLeft);
            this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
        }
        else {
            if (lastScrollLeft) {
                this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
            }
        }
    }
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isSameLength
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    onDataChanged(isSameLength = true, isDiffrentDataSource = false) {
        this.dg.setPagerHeight();
        this.viewportH = this.getViewPortHeight();
        this.bodyStyle = this.getBodyStyle();
        /**
         * update:
         * node_modules\perfect-scrollbar\types\perfect-scrollbar.d.ts
         * lastScrollTop: number
         */
        if (this.ps && this.ps.instance && !this.dg.isEditing() && !this.dg.clientFilterChanged && !this.dg.autoHeight) {
            this.scrollTop = 0;
            this.lastRenderedScrollTop = 0;
            this.ps.scrollToTop();
            this.scrollLeft = 0;
            this.ps.scrollToLeft();
        }
        this.rowsCache = {};
        /** @type {?} */
        const keepscrollPos = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const scrollInfo = this.dg.dfs.getState().scrollInfo;
            if (scrollInfo) {
                if (scrollInfo.y) {
                    this.scrollTop = scrollInfo.y;
                    this.dg.scrollInstance.scrollToY(scrollInfo.y);
                    this.dgs.onScrollMove(scrollInfo.y, SCROLL_Y_ACTION);
                }
                if (scrollInfo.x) {
                    this.scrollLeft = scrollInfo.x;
                    this.dg.scrollInstance.scrollToX(scrollInfo.x);
                    this.dg.dgs.onScrollMove(scrollInfo.x, SCROLL_X_ACTION);
                }
            }
        });
        if (!this.dg.nowrap || this.dg.autoHeight) {
            this.renderData(false);
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.updateRowHeight();
            }), 100);
        }
        else {
            if (isSameLength) {
                keepscrollPos();
            }
            this.renderData(false);
            this.ps.update();
        }
        if (isDiffrentDataSource) {
            this.dg.initSelectOrChecked();
        }
        else {
            this.dg.refreshSelectedData();
        }
        this.dg.clientFilterChanged = false;
        this.dataChange.emit(this.data);
    }
    /**
     * @private
     * @return {?}
     */
    destroySubscriptions() {
        if (this.subscriptions && this.subscriptions.length) {
            this.subscriptions.forEach((/**
             * @param {?} sub
             * @return {?}
             */
            (sub) => {
                if (sub) {
                    sub.unsubscribe();
                    sub = null;
                }
            }));
            this.subscriptions = [];
        }
    }
    /**
     * @private
     * @return {?}
     */
    listenSubjects() {
        this.destroySubscriptions();
        this.gridSizeSubscribe = this.dfs.gridSize$.pipe(takeUntil(this.destroy$)).pipe(debounceTime(50)).subscribe((/**
         * @param {?} state
         * @return {?}
         */
        state => {
            if (state) {
                this.dg.setPagerHeight();
                /** @type {?} */
                const hh = this.dg.setHeaderHeight();
                this.setPositionTop(hh);
                this.height = state.height - this.top;
                /** @type {?} */
                const oldWidth = this.width;
                this.width = Math.floor(state.width);
                this.rowHeight = state.rowHeight;
                if (this.dg.showBorder) {
                    this.width -= 2;
                }
                this.viewportW = this.width;
                this.viewportH = this.getViewPortHeight();
                this.canvasHeight = this.getCanvasHeight();
                this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                () => {
                    this.columnsGroup = state.columnsGroup;
                    this.checkScrollbarPosition();
                    // this.setFixedRightPosition();
                    this.updateColumnSize(state.columnsGroup);
                    this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
                    this.renderData(false);
                    if (this._scrollXTimer) {
                        clearTimeout(this._scrollXTimer);
                    }
                    if (!this.dg.nowrap || this.dg.autoHeight) {
                        this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        () => {
                            this.updateRowHeight();
                            this.keepScrollbarPosition(oldWidth);
                        }), 100);
                    }
                    else {
                        this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        () => {
                            this.keepScrollbarPosition(oldWidth);
                        }), 100);
                    }
                    // this.ps.update();
                }));
                if (this.scrollBarMode === 'allways') {
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        if (!this.dg.showScrollArrow) {
                            this.dgs.scrollbarUpdate.emit({ scrollbarRef: this.ps.instance, rightWidth: this.rightFixedWidth });
                        }
                        this.keepScrollbarPosition(oldWidth);
                    }), 100);
                }
            }
        }));
        this.subscriptions.push(this.gridSizeSubscribe);
        this.columnResizeSubscribe = this.dfs.columnResize$.subscribe((/**
         * @param {?} cg
         * @return {?}
         */
        (cg) => {
            this.updateColumnSize(cg);
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.columnResizeSubscribe);
        this.dgs.setSelecedRow.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        (r) => {
            if (r && r.selected) {
                this.currentRowId = r.id;
            }
            else {
                this.currentRowId = undefined;
            }
        }));
        this.selectRowSubscribe = this.dfs.selectRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            if (row) {
                this.currentRowId = row.id;
                // 20210817 方向键移动后刷新视图状态
                this.cd.detectChanges();
            }
        }));
        this.subscriptions.push(this.selectRowSubscribe);
        this.unselectRowSubscribe = this.dfs.unSelectRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        (prevRow) => {
            if (prevRow && prevRow.id === this.currentRowId) {
                this.currentRowId = undefined;
                this.dg.selectedRow = null;
            }
            if (!this.dg.editable && this.dg.multiSelect) {
                this.__triggerBodyClickEvent = this.dg.selectionMode === 'default';
            }
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.unselectRowSubscribe);
        this.selectAllSubscribe = this.dfs.selectAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            this.dg.selectAll.emit(rows);
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.selectAllSubscribe);
        this.checkRowSubscribe = this.dfs.checkRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            this.dg.checked.emit(row);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkRowSubscribe);
        this.clearSelectionsSubscribe = this.dfs.clearSelections$.subscribe((/**
         * @return {?}
         */
        () => {
            this.currentRowId = undefined;
            if (this.dg.checkOnSelect) {
                this.checkedRowsChanged();
            }
            this.dg.unSelectAll.emit();
        }));
        this.subscriptions.push(this.clearSelectionsSubscribe);
        this.uncheckRowSubscribe = this.dfs.unCheckRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        (prevRow) => {
            this.dg.unChecked.emit(prevRow);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.uncheckRowSubscribe);
        this.checkAllSubscribe = this.dfs.checkAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            this.dg.checkAll.emit(rows);
            this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkAllSubscribe);
        this.clearCheckedsSubscribe = this.dfs.clearCheckeds$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        (rows) => {
            if (this.dg.selectOnCheck) {
                this.currentRowId = undefined;
            }
            this.dg.unCheckAll.emit(rows);
            this.checkedRowsChanged();
            this.cd.detectChanges();
        }));
        this.subscriptions.push(this.clearCheckedsSubscribe);
        this.subscriptions.push(this.dgs.setScrollbarPosition.subscribe((/**
         * @return {?}
         */
        () => {
            this.checkScrollbarPosition();
            this.updateScrollPosition(this.scrollLeft);
        })));
        this.dgs.columnResized.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.dg.nowrap ||
                (this.dg.currentCell && this.dg.currentCell.isEditing && this.dg.currentCell.column &&
                    this.dg.currentCell.column.editor && this.dg.currentCell.column.editor.type === 'textarea')) {
                /** @type {?} */
                const trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(.f-datagrid-footer-row)');
                trdoms.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    this.render.setStyle(n, 'height', 'auto');
                }));
                /** @type {?} */
                let trID = '';
                if (e) {
                    /** @type {?} */
                    const rowId = e.id;
                    trID = TR_PREFIX + rowId;
                }
                this.updateRowHeight(trID);
                // trdoms.forEach(n => n.style.height = '');
            }
            if (this.dg.headerWrap) {
                this.dg.setHeaderHeight();
                this.dfs.columnResizeEnd();
            }
        }));
        this.dgs.cellContentWrapChanged.pipe(delay(100)).subscribe((/**
         * @return {?}
         */
        () => {
            this.updateRowHeight();
        }));
        this.dg.dfs.rowUpdate$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        (row) => {
            if (row && row.data) {
                this.buildCustomCellStyle(row);
            }
        }));
        if (this.dg.groupRows) {
            this.dfs.expandGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => this.groupRowStateChanged(e.data, true)));
            this.dfs.collapseGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => this.groupRowStateChanged(e.data, false)));
        }
    }
    /**
     * @private
     * @param {?} groupRow
     * @param {?} isExpand
     * @return {?}
     */
    groupRowExpandUpdate(groupRow, isExpand) {
        if (groupRow.rows && groupRow.rows.length) {
            groupRow.rows.forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                this.data.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    if (element.id === n.id) {
                        if (!isExpand) {
                            element['__group_visible__'] = isExpand;
                        }
                        else {
                            element['__group_visible__'] = groupRow.expanded;
                        }
                        if (element.rows && element.rows.length) {
                            this.groupRowExpandUpdate(element, isExpand);
                        }
                    }
                }));
            }));
        }
    }
    /**
     * @private
     * @param {?} rowData
     * @param {?} expand
     * @return {?}
     */
    groupRowStateChanged(rowData, expand) {
        if (this.dg.virtualized) {
            /** @type {?} */
            const gr = this.data.find((/**
             * @param {?} n
             * @return {?}
             */
            n => n.id === rowData.id));
            this.groupRowExpandUpdate(gr, expand);
            this.renderData(false);
        }
        else {
            this.getCanvasHeight();
        }
        if (this['_psUpdateTimer_']) {
            clearTimeout(this['_psUpdateTimer_']);
        }
        this['_psUpdateTimer_'] = setTimeout((/**
         * @return {?}
         */
        () => {
            this.ps.update();
            this.cd.detectChanges();
        }), 100);
    }
    /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    keepScrollbarPosition(oldWidth) {
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
        this.ps.update();
        if (!this.ps.instance) {
            return;
        }
        /** @type {?} */
        const scrollReach = this.ps.instance.reach;
        /** @type {?} */
        let t = this.width - oldWidth;
        /** @type {?} */
        let scrollLeft = t;
        if (scrollReach.x === 'start' || !this.ps.instance.lastScrollLeft) {
            scrollLeft = 0;
            this.ps.scrollToX(0);
        }
        else if (scrollReach.x === 'end') {
            this.ps.scrollToRight(0);
            scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        }
        else {
            scrollLeft = this.ps.instance.lastScrollLeft - t;
            this.ps.elementRef.nativeElement.scrollLeft = scrollLeft;
        }
        this.updateScrollPosition(scrollLeft);
    }
    /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    updateColumnSize(cg) {
        if (cg) {
            this.columnsGroup = cg;
            this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
            this.colsWidth = this.columnsGroup.normalWidth;
            this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
            this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
            this.fixedRightScrollLeft = this.maxScrollLeft;
            // grid 容器宽度
            /** @type {?} */
            const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
            // 所有列宽之和
            /** @type {?} */
            const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
            this.bodyStyle = this.getBodyStyle();
            if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
                this.showRightShadow = false;
            }
            else {
                this.showRightShadow = true;
                // 右侧固定列的位置
                this.fixedRightScrollLeft = this.width + this.scrollLeft;
            }
            if (this.ps && this.ps.instance && this.dg.scrollBarShowMode === 'allways' && this.ps.instance.scrollbarYActive) {
                if (this.showRightShadow) {
                    this.rightFixedWidth += 18;
                    this.fixedRightScrollLeft = this.fixedRightScrollLeft - this.rightFixedWidth;
                }
                else {
                    if (this.canvasWidth > this.totalWidth && this.canvasWidth - this.totalWidth < 18) {
                        this.rightFixedWidth += 18;
                    }
                }
            }
            this.totalWidth = this.columnsGroup.totalWidth;
            if (this.scrollBarMode === 'allways' && !this.rightRowsCmp && !this.dg.useControlPanel) {
                this.totalWidth += 18;
            }
        }
    }
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    buildCustomCellStyle(row) {
        /** @type {?} */
        let rightTrs = [];
        /** @type {?} */
        let leftTrs = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        /** @type {?} */
        const trs = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        /** @type {?} */
        const updateCellStyle = (/**
         * @param {?} arr
         * @param {?} col
         * @param {?} style
         * @return {?}
         */
        (arr, col, style) => {
            if (arr.length) {
                /** @type {?} */
                const td = arr[row.index].querySelector(`[field="${col.field}"]`);
                if (td) {
                    this.dg.renderCustomStyle(style, td);
                }
            }
        });
        this.dg.flatColumns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        col => {
            if (col.styler) {
                /** @type {?} */
                const _rd = row.data;
                /** @type {?} */
                const val = Utils.getValue(col.field, _rd);
                /** @type {?} */
                const cs = col.styler(val, _rd, row.index);
                if (cs && Object.keys(cs).length) {
                    updateCellStyle(leftTrs, col, cs);
                    updateCellStyle(rightTrs, col, cs);
                    updateCellStyle(trs, col, cs);
                }
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    checkedRowsChanged() {
        this.dgs.onCheckedRowsCountChange();
        /** @type {?} */
        const checkedRows = this.dg.checkeds;
        this.dg.checkValues = checkedRows.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.id));
        this.dg.checkValuesChange.emit(this.dg.checkValues);
        this.dg.checkedChange.emit(checkedRows);
    }
    /**
     * @private
     * @return {?}
     */
    getTrDomHeight() {
        /** @type {?} */
        const list = [];
        /** @type {?} */
        let rightTrs = [];
        /** @type {?} */
        let leftTrs = [];
        /** @type {?} */
        let trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        (tr, i) => {
            /** @type {?} */
            let t1 = 0;
            /** @type {?} */
            const t2 = Math.ceil(tr.offsetHeight);
            /** @type {?} */
            let t3 = 0;
            if (leftTrs && leftTrs.length) {
                t1 = Math.ceil(leftTrs[i].offsetHeight);
            }
            if (rightTrs && rightTrs.length) {
                t3 = Math.ceil(rightTrs[i].offsetHeight);
            }
            /** @type {?} */
            const _h = Math.max(t1, t2, t3, this.dg.rowHeight);
            list.push(_h);
        }));
        return list;
    }
    /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    updateRowHeight(trDomId = null) {
        if (this.fast) {
            return;
        }
        if (!this.mainArea) {
            return;
        }
        /** @type {?} */
        const dgBody = this.el.nativeElement.querySelector('div.f-datagrid-body');
        if (dgBody) {
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(dgBody, 'data-wrap');
            }
            else {
                this.render.removeClass(dgBody, 'data-wrap');
            }
        }
        /** @type {?} */
        let cssTextArr = [];
        if (!trDomId) {
            this.rows.forEach((/**
             * @param {?} r
             * @param {?} i
             * @return {?}
             */
            (r, i) => {
                /** @type {?} */
                const rowId = this.dfs.primaryId(r);
                /** @type {?} */
                const trID = TR_PREFIX + rowId;
                /** @type {?} */
                const leftTrId = trID + '_fixedleft';
                /** @type {?} */
                const rightTrId = trID + '_fixedright';
                if (!this.dg.nowrap || this.dg.autoHeight) {
                    /** @type {?} */
                    const list = this.getTrDomHeight();
                    /** @type {?} */
                    const h = list[i];
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${leftTrId}{ height: ${h}px }`);
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${trID}{ height: ${h}px }`);
                    cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${rightTrId}{ height: ${h}px }`);
                }
                else {
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trID}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${list[i]}px }`);
                    /** @type {?} */
                    const key1 = `${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}`;
                    /** @type {?} */
                    const key2 = `${this.dg.customStyleKey()} .f-datagrid-body #${trID}`;
                    /** @type {?} */
                    const key3 = `${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}`;
                    this.dgs.removeCssRule(key1);
                    this.dgs.removeCssRule(key2);
                    this.dgs.removeCssRule(key3);
                }
            }));
            this.dgs.appendCssRules(cssTextArr);
        }
        else {
            cssTextArr = [];
            /** @type {?} */
            const domSel = '#' + trDomId;
            /** @type {?} */
            const _arr = [];
            if (this.fixedRightEl) {
                /** @type {?} */
                const rtr = this.fixedRightEl.nativeElement.querySelector(domSel);
                if (rtr) {
                    _arr.push(Math.ceil(rtr.offsetHeight));
                }
            }
            if (this.fixedLeftEl) {
                /** @type {?} */
                const ltr = this.fixedLeftEl.nativeElement.querySelector(domSel);
                if (ltr) {
                    _arr.push(Math.ceil(ltr.offsetHeight));
                }
            }
            if (this.mainArea) {
                /** @type {?} */
                const tr = this.mainArea.nativeElement.querySelector(domSel);
                if (tr) {
                    _arr.push(Math.ceil(tr.offsetHeight));
                }
            }
            /** @type {?} */
            const _h = Math.max(..._arr);
            /** @type {?} */
            const leftTrId = trDomId + '_fixedleft';
            /** @type {?} */
            const rightTrId = trDomId + '_fixedright';
            if (!this.dg.nowrap || this.dg.autoHeight) {
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${leftTrId}{ height: ${_h}px;}`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${trDomId}{ height: ${_h}px;}`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body.data-wrap #${rightTrId}{ height: ${_h}px;}`);
            }
            else {
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${_h}px }`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trDomId}{ height: ${_h}px }`);
                cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${_h}px }`);
            }
            this.dgs.appendCssRules(cssTextArr);
        }
        this.updateCanvasHeight();
        // 移除height: auto
        /** @type {?} */
        const trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
        trdoms.forEach((/**
         * @param {?} n
         * @return {?}
         */
        n => n.style.height = ''));
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    }
    /**
     * @private
     * @return {?}
     */
    getBodyStyle() {
        /** @type {?} */
        let h = this.getViewPortHeight();
        if (!this.data.length) {
            if (this.dg.useBlankWhenDataIsEmpty) {
                h = this.dg.emptyDataHeight;
            }
            else {
                if (this.dg.autoHeight) {
                    h = this.dg.emptyDataHeight;
                }
                if (this.dg.footerData && this.dg.showFooter) {
                    /** @type {?} */
                    let fd = this.dg.footerData;
                    if (this.dg.footerData.subscribe) {
                        fd = this.dg.footerData['value'];
                    }
                    if (fd && Array.isArray(fd) && fd.length) {
                        h = h - this.dg.footerHeight;
                        if (this.dg.footerPosition === 'both') {
                            h = h - this.dg.footerHeight;
                        }
                    }
                }
            }
        }
        else {
            if (this.dg.showFooter && this.dg.footerPosition === 'both') {
                h = h - this.dg.footerHeight;
            }
        }
        return {
            height: `${Math.floor(h) + 1}px`
        };
    }
    /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    updateScrollPosition(scrollLeft) {
        this.scrollLeft = scrollLeft;
        this.fixedRightScrollLeft = this.scrollLeft + this.width - this.rightFixedWidth;
        if (this.fixedRightScrollLeft === this.maxScrollLeft || this.fixedRightScrollLeft > this.maxScrollLeft) {
            this.fixedRightScrollLeft = this.maxScrollLeft;
            this.showRightShadow = false;
        }
        else {
            this.showRightShadow = true;
        }
        if (this.fixedLeftEl) {
            this.render.setStyle(this.fixedLeftEl.nativeElement, 'transform', `translate3d(${this.scrollLeft}px, 0px, 0px)`);
        }
        if (this.fixedRightEl) {
            this.render.setStyle(this.fixedRightEl.nativeElement, 'transform', `translate3d(${this.fixedRightScrollLeft}px, 0px, 0px)`);
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onScrollToX($event) {
        /** @type {?} */
        const x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        // this.cd.detectChanges();
        this.dgs.onScrollMove(x, SCROLL_X_ACTION);
        this.dfs.updateProperty('scrollInfo', { y: $event.target.scrollTop, x });
        this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onScrollToY($event) {
        if (this._scrollTimer) {
            clearTimeout(this._scrollTimer);
        }
        this._scrollTimer = setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const y = $event.target.scrollTop;
            if (this.dg.virtualized) {
                this.handleScroll();
            }
            this.scrollTop = y;
            this.dfs.updateProperty('scrollInfo', { y, x: $event.target.scrollLeft });
            this.dg.scrollY.emit(y);
            this.dgs.onScrollMove(y, SCROLL_Y_ACTION);
        }), 100);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPsXReachStart($event) {
        /** @type {?} */
        const x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        this.dgs.onScrollMove(x, SCROLL_X_REACH_START_ACTION);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPsXReachEnd($event) {
        this.showRightShadow = false;
        // const x = $event.target.scrollLeft;
        // this.updateScrollPosition(x);
        // this.cd.detectChanges();
        // // this.dgs.onShowFixedShadow(this.showRightShadow);
        // this.dgs.onScrollMove(x, SCROLL_X_REACH_END_ACTION);
    }
    /**
     * @param {?} rowData
     * @return {?}
     */
    isChecked(rowData) {
        if (rowData) {
            return this.dfs.isRowChecked(rowData[this.dg.idField]);
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} rowData
     * @return {?}
     */
    isSelected(rowData) {
        if (rowData) {
            return this.dfs.isRowSelected(rowData[this.dg.idField]);
        }
        return false;
    }
    /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    toggleGroupRow(row, open = true) {
        row.expanded = open;
        this.ps.update();
    }
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @return {?}
     */
    getViewPortHeight() {
        /** @type {?} */
        let viewPortHeight = this.dg.height;
        if (this.dg.showHeader) {
            viewPortHeight = viewPortHeight - this.dg.realHeaderHeight;
        }
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            viewPortHeight -= this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            viewPortHeight -= this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && this.data.length) {
            viewPortHeight = viewPortHeight - this.dg.footerHeight;
        }
        if (this.dg.pagination) {
            viewPortHeight = viewPortHeight - this.dg.pagerHeight - 2;
        }
        if (this.dg.showBorder) {
            viewPortHeight -= 2;
        }
        this.viewportH = viewPortHeight;
        return viewPortHeight;
    }
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    allRowsHeight() {
        /** @type {?} */
        const rowHeightpatch = 1;
        // this.dg.autoHeight ? 2 : 1;
        /** @type {?} */
        const rowHeight = this.dg.rowHeight + rowHeightpatch;
        /** @type {?} */
        let itemsCount = 0;
        if (this.dg.groupRows) {
            /** @type {?} */
            const data = this.data.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n['__group_visible__'] || n['__group_visible__'] === undefined));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                itemsCount = data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => !n['__group_footer__'])).length;
            }
            else {
                itemsCount = data.length;
            }
        }
        else {
            itemsCount = this.data.length;
        }
        /** @type {?} */
        let h = itemsCount * rowHeight;
        if (this.dg.autoHeight) {
            h += itemsCount;
        }
        else {
            h += 2;
        }
        return h;
    }
    /**
     * @private
     * @return {?}
     */
    getCanvasHeight() {
        /** @type {?} */
        let canvasHeight = 0;
        if (!this.data || !this.data.length) {
            this.canvasHeight = 0;
            return 0;
        }
        if (this.dg.nowrap) {
            if (this.dg.maxHeight && this.mainArea) {
                canvasHeight = Math.floor(this.mainArea.nativeElement.getBoundingClientRect().height);
            }
            else {
                canvasHeight = this.allRowsHeight();
            }
        }
        else {
            canvasHeight = this.getTrDomHeight().reduce((/**
             * @param {?} r
             * @param {?} c
             * @return {?}
             */
            (r, c) => r + c), 0);
        }
        if (!canvasHeight) {
            canvasHeight = this.viewportH;
        }
        canvasHeight = canvasHeight + (this.dg.scrollBarShowMode === 'allways' && (this.ps.instance && this.ps.instance['scrollbarXActive']) ? 18 : 0);
        this.canvasHeight = canvasHeight;
        return canvasHeight;
    }
    /**
     * @return {?}
     */
    updateCanvasHeight() {
        this.canvasHeight = this.getCanvasHeight();
    }
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    getRowFromPosition(y) {
        return Math.floor(y / (this.dg.rowHeight + 1));
    }
    /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    getVisibleRange(viewportTop, viewportLeft) {
        if (viewportTop == null) {
            viewportTop = this.scrollTop;
        }
        if (viewportLeft == null) {
            viewportLeft = this.scrollLeft;
        }
        return {
            top: this.getRowFromPosition(viewportTop),
            bottom: this.getRowFromPosition(viewportTop + this.viewportH) + 1,
            leftPx: viewportLeft,
            rightPx: viewportLeft + this.viewportW
        };
    }
    /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    getRenderedRange(viewportTop, viewportLeft) {
        /** @type {?} */
        const range = this.getVisibleRange(viewportTop, viewportLeft);
        /** @type {?} */
        const buffer = Math.round(this.viewportH / (this.dg.rowHeight + 1));
        /** @type {?} */
        const minBuffer = this.minRowBuffer;
        if (this.vScrollDir == -1) {
            range.top -= buffer;
            range.bottom += minBuffer;
        }
        else if (this.vScrollDir == 1) {
            range.top -= minBuffer;
            range.bottom += buffer;
        }
        else {
            range.top -= minBuffer;
            range.bottom += minBuffer;
        }
        range.top = Math.max(0, range.top);
        range.bottom = Math.min(this.data.length - 1, range.bottom);
        range.leftPx -= this.viewportW;
        range.rightPx += this.viewportW;
        range.leftPx = Math.max(0, range.leftPx);
        range.rightPx = Math.min(this.canvasWidth, range.rightPx);
        return range;
    }
    /**
     * @private
     * @param {?} range
     * @return {?}
     */
    renderRows(range) {
        /** @type {?} */
        const rows = [];
        /** @type {?} */
        let dataLength = this.data.length;
        /** @type {?} */
        let _data = this.data;
        // 启用分组
        if (this.dg.groupRows && this.dg.groupField) {
            _data = _data.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n['__group_visible__'] || n['__group_visible__'] === undefined));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                _data = _data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => !n['__group_footer__']));
            }
            dataLength = _data.length;
            this.rowsCache = {};
        }
        for (let i = range.top; i <= range.bottom; i++) {
            if (this.rowsCache[i] || (i == dataLength)) {
                continue;
            }
            rows.push(i);
            // Create an entry right away so that appendRowHtml() can
            // start populatating it.
            this.rowsCache[i] = {
                rowNode: null,
                // ColSpans of rendered cells (by column idx).
                // Can also be used for checking whether a cell has been rendered.
                cellColSpans: [],
                // Cell nodes (by column idx).  Lazy-populated by ensureCellNodesInRowsCache().
                cellNodesByColumnIdx: [],
                // Column indices of cell nodes that have been rendered, but not yet indexed in
                // cellNodesByColumnIdx.  These are in the same order as cell nodes added at the
                // end of the row.
                cellRenderQueue: []
            };
        }
        for (let i = 0, ii = rows.length; i < ii; i++) {
            this.rowsCache[rows[i]].rowNode = _data[rows[i]];
        }
        return Object.keys(this.rowsCache).map((/**
         * @param {?} n
         * @return {?}
         */
        n => this.rowsCache[n].rowNode)).filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n));
    }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    removeRowFromCache(row) {
        /** @type {?} */
        const cacheEntry = this.rowsCache[row];
        if (!cacheEntry) {
            return;
        }
        delete this.rowsCache[row];
    }
    /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    cleanupRows(rangeToKeep) {
        for (const i in this.rowsCache) {
            if (i < rangeToKeep.top || i > rangeToKeep.bottom) {
                this.removeRowFromCache(i);
            }
        }
    }
    /**
     * @param {?} showYscrollbar
     * @return {?}
     */
    hasYScrollbar(showYscrollbar) {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.updateColumnSize(this.columnsGroup);
            if (this.ps) {
                this.ps.update();
                this.cd.detectChanges();
            }
            this.dgs.scrollbarUpdate.emit({ scrollbarRef: this.ps.instance });
        }), 60);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onClickScrollArrow($event) {
        const { dir, event } = $event;
        if (this.ps && this.ps.instance) {
            const { x, y } = this.ps.instance.reach;
            switch (dir) {
                case 'left':
                    if (x !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft - 40;
                    }
                    break;
                case 'right':
                    if (x !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft + 40;
                    }
                    break;
                case 'top':
                    if (y !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop - 40;
                    }
                    break;
                case 'bottom':
                    if (y !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop + 40;
                    }
                    break;
            }
            this.ps.update();
        }
    }
    /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    renderData(detectchanges = true) {
        this.canvasHeight = this.getCanvasHeight();
        if (!this.dg.virtualized || this.dg.autoHeight) {
            this.rows = this.data;
        }
        else {
            /** @type {?} */
            const visible = this.getVisibleRange();
            /** @type {?} */
            const rendered = this.getRenderedRange();
            // remove rows no longer in the viewport
            this.cleanupRows(rendered);
            // render missing rows
            this.rows = this.renderRows(rendered);
            this.startRowIndex = rendered.top;
            this.lastRenderedScrollTop = this.scrollTop;
            this.lastRenderedScrollLeft = this.scrollLeft;
            this.blankTopHeight = this.startRowIndex * (this.dg.rowHeight + 1);
            this.blankBottomHeight = this.canvasHeight - this.blankTopHeight - (this.rows.length * (this.dg.rowHeight + 1));
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
            if (detectchanges) {
                this.cd.detectChanges();
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    handleScroll() {
        this.scrollTop = this.ps.elementRef.nativeElement.scrollTop;
        this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        return this._handleScroll();
    }
    /**
     * @private
     * @return {?}
     */
    _handleScroll() {
        /** @type {?} */
        const viewportContainer = this.viewScrollContainer.nativeElement;
        /** @type {?} */
        let maxScrollDistanceY = viewportContainer.scrollHeight - viewportContainer.clientHeight;
        /** @type {?} */
        let maxScrollDistanceX = viewportContainer.scrollWidth - viewportContainer.clientWidth;
        // Protect against erroneous clientHeight/Width greater than scrollHeight/Width.
        // Sometimes seen in Chrome.
        maxScrollDistanceY = Math.max(0, maxScrollDistanceY);
        maxScrollDistanceX = Math.max(0, maxScrollDistanceX);
        // Ceiling the max scroll values
        if (this.scrollTop > maxScrollDistanceY) {
            this.scrollTop = maxScrollDistanceY;
        }
        if (this.scrollLeft > maxScrollDistanceX) {
            this.scrollLeft = maxScrollDistanceX;
        }
        /** @type {?} */
        const vScrollDist = Math.abs(this.scrollTop - this.prevScrollTop);
        /** @type {?} */
        const hScrollDist = Math.abs(this.scrollLeft - this.prevScrollLeft);
        if (hScrollDist) {
            this.prevScrollLeft = this.scrollLeft;
            // $viewportScrollContainerX[0].scrollLeft = scrollLeft;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows) {
            //         $viewportTopR[0].scrollLeft = scrollLeft;
            //     }
            // } else {
            //     if (hasFrozenRows) {
            //         $viewportTopL[0].scrollLeft = scrollLeft;
            //     }
            // }
        }
        /** @type {?} */
        const lastScrollTop = this.lastRenderedScrollTop;
        if (vScrollDist) {
            this.vScrollDir = this.prevScrollTop < this.scrollTop ? 1 : -1;
            this.prevScrollTop = this.scrollTop;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows && !options.frozenBottom) {
            //         $viewportBottomL[0].scrollTop = scrollTop;
            //     } else {
            //         $viewportTopL[0].scrollTop = scrollTop;
            //     }
            // }
            // switch virtual pages if needed
            if (vScrollDist < this.viewportH) {
                this._scrollTo(this.scrollTop);
            }
        }
        if (hScrollDist || vScrollDist) {
            /** @type {?} */
            const dx = Math.abs(this.lastRenderedScrollLeft - this.scrollLeft);
            /** @type {?} */
            const dy = Math.abs(lastScrollTop - this.scrollTop);
            if (dx > 20 || dy > 20) {
                // if rendering is forced or scrolling is small enough to be "easy", just render
                if (dy < this.viewportH && dx < this.viewportW) {
                    this.renderData();
                }
                else {
                    this.renderData();
                }
            }
        }
        if (hScrollDist || vScrollDist) {
            return true;
        }
        return false;
    }
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    _scrollTo(y) {
        /** @type {?} */
        const $viewportScrollContainerY = this.viewScrollContainer.nativeElement;
        y = Math.max(y, 0);
        y = Math.min(y, this.canvasHeight - this.viewportH);
        /** @type {?} */
        const newScrollTop = y;
        if (this.prevScrollTop != newScrollTop) {
            this.vScrollDir = (this.prevScrollTop < newScrollTop) ? 1 : -1;
            this.lastRenderedScrollTop = (this.scrollTop = this.prevScrollTop = newScrollTop);
            // if (hasFrozenColumns()) {
            //     $viewportTopL[0].scrollTop = newScrollTop;
            // }
            // if (hasFrozenRows) {
            //     $viewportBottomL[0].scrollTop = $viewportBottomR[0].scrollTop = newScrollTop;
            // }
            // $viewportScrollContainerY.scrollTop = newScrollTop;
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onMouseClick($event) {
        // document.body.click();
        /** @type {?} */
        const target = (/** @type {?} */ ($event.target));
        if (target.nodeName === 'TEXTAREA' || target.nodeName === 'INPUT') {
            return;
        }
        /** @type {?} */
        let td = target;
        if (target.nodeName !== 'TD') {
            td = target.closest('TD');
        }
        if (!this.dg.editable && this.__triggerBodyClickEvent) {
            // 解决超链点击事件，要先执行选中行
            if (td && td.selectCell) {
                $event.stopPropagation();
                td.selectCell($event, td); // 按理说可以删除的，但不敢动哦o(≧口≦)o
            }
            return;
        }
        if (this.dg.editMode === 'row') {
            return;
        }
        if (!td && this.dg.currentCell) {
            td = this.dg.currentCell.cellElement;
            if (td && td.closeEdit) {
                $event.stopPropagation();
                td.closeEdit();
                return;
            }
        }
        if (td) {
            // 行禁用时
            if (this.dg.disableRow && td.gridCellData) {
                const { rowData, rowIndex } = td.gridCellData;
                if (this.dg.disableRow(rowData, rowIndex)) {
                    return;
                }
            }
            $event.stopPropagation();
            if (this.dg.editable && this.dg.editMode === 'cell' && td.edit) {
                td.edit($event);
            }
            else {
                if (td.selectCell) {
                    if (this.dg.selectionMode === 'default' && this.dg.multiSelect) {
                        this.dg.clearCheckeds();
                    }
                    td.selectCell($event, td);
                }
                else {
                    this.dg.endCellEdit();
                }
            }
        }
    }
}
DatagridBodyComponent.decorators = [
    { type: Component, args: [{
                selector: 'datagrid-body',
                template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-06 07:43:07\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-11-26 08:20:46\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n<ng-container  *ngIf=\"(!data || !data.length) && !dg.useBlankWhenDataIsEmpty\">\r\n    <div *ngIf=\"!dg.emptyTemplate\" class=\"d-flex flex-column f-datagrid-norecords\"\r\n        style=\"position:absolute; margin:0;left: 0; z-index: 1;justify-content: center; align-items: center;pointer-events: none;\" \r\n        [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" >\r\n        <div class=\"f-datagrid-norecords-content\" style=\"margin: 0;width: 100%;position: relative; top: 0\">\r\n            {{ 'datagrid.emptyMessage' | locale }}\r\n        </div>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyTemplate\">\r\n        <ng-container #emptyTemplate [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container>\r\n    </div>\r\n</ng-container>\r\n\r\n\r\n\r\n<div  class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" \r\n[farris-context-menus]=\"contextMenuItems\" [disabled]=\"!dg.enableContextMenu\" [activeDomName]=\"'tr'\" [beforeShowContextMenu]=\"onBeforeShowContextMenu\"\r\n[menuClass]=\"'f-datagrid-context-menu'\">\r\n\r\n    <div #viewScrollContainer [scrollbar]=\"psConfig\" #ps=\"ngxScrollbar\"\r\n        class=\"ps f-datagrid-body-wheel-area\" \r\n        style=\"width: 100%;\"\r\n        [ngStyle]=\"bodyStyle\"\r\n        (psXReachEnd)=\"onPsXReachEnd($event)\"\r\n        (psScrollY)=\"onScrollToY($event)\"\r\n        (psScrollX)=\"onScrollToX($event)\" (psXReachStart)=\"onPsXReachStart($event)\"\r\n\r\n        [style.paddingRight.px]=\"scrollbarYWidth\">\r\n       \r\n        <div class=\"f-datagrid-norecords\"  [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"dg.emptyDataHeight || 240\" style=\"height: 100%\" [style.width.px]=\"canvasWidth - 2\"  *ngIf=\"!data || !data.length\">\r\n            <!-- <div *ngIf=\"!dg.emptyTemplate\" class=\"f-datagrid-norecords-content\" style=\"width: 100%\" >{{ 'datagrid.emptyMessage' | locale }}</div>\r\n            <ng-container #emptyTemplate *ngIf=\"dg.emptyTemplate\" [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container> -->\r\n        </div>\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && !fast\"\r\n            class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n            [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n            \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n                \r\n                <div #fixedLeft class=\"f-datagrid-table f-datagrid-body-fixed-left\" style=\"z-index:999\" [class.f-datagrid-fixed-left-shadow]=\"!!scrollLeft && !dg.groupRows\"\r\n                    *ngIf=\"dg.showLineNumber || dg.showCheckbox || (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length)\"  [style.width.px]=\"leftFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ scrollLeft +'px, 0px, 0px)'\">\r\n\r\n                    <fixed-left-rows [columns]=\"columnsGroup?.leftFixed\" [checkedRows]=\"checkedRows\" [selectedRows]=\"selectedRows\" [data]=\"rows\"></fixed-left-rows>\r\n                </div>\r\n\r\n                <div #fixedRight class=\"f-datagrid-table f-datagrid-body-fixed-right\" [style.width.px]=\"rightFixedWidth\" \r\n                    *ngIf=\"columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\"\r\n                    [class.f-datagrid-fixed-right-shadow]=\"showRightShadow\" \r\n                    style=\"border: 0\"\r\n                    [style.transform]=\"'translate3d('+ fixedRightScrollLeft +'px, 0px, 0px)'\">\r\n                    \r\n                    <datagrid-rows #rightRows [fixedRight]=\"true\" [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.rightFixed\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div #main [style.width.px]=\"colsWidth\" style=\"position: relative;\" [style.left.px]=\"leftFixedWidth\" class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.normalColumns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && fast\"\r\n        class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n        [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n        \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n\r\n                <div #main style=\"position: relative;\"  class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows [hasFixedColumns]=\"columnsGroup?.leftFixed && columnsGroup?.leftFixed?.length\"  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.columns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <scrollbar-arrows [scrollbarXActive]=\"ps.instance && ps.instance.scrollbarXActive\" [scrollbarYActive]=\"ps.instance && ps.instance.scrollbarYActive\" \r\n    *ngIf=\"dg.scrollBarShowMode === 'allways' && dg.showScrollArrow\" (hasYScrollbar)=\"hasYScrollbar($event)\" (scrollMoveTo)=\"onClickScrollArrow($event)\"\r\n    [reachX]=\"ps.instance && ps.instance.reach.x\" [reachY]=\"ps.instance && ps.instance.reach.y\"></scrollbar-arrows>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n",
                changeDetection: ChangeDetectionStrategy.OnPush
            }] }
];
/** @nocollapse */
DatagridBodyComponent.ctorParameters = () => [
    { type: Injector },
    { type: ApplicationRef },
    { type: DatagridComponent, decorators: [{ type: Optional }] },
    { type: ChangeDetectorRef },
    { type: ElementRef }
];
DatagridBodyComponent.propDecorators = {
    footerHeight: [{ type: Input }],
    canvasWidth: [{ type: Input }],
    columnsGroup: [{ type: Input }],
    topHideHeight: [{ type: Input }],
    bottomHideHeight: [{ type: Input }],
    startRowIndex: [{ type: Input }],
    data: [{ type: Input }],
    dataChange: [{ type: Output }],
    scrollBarMode: [{ type: Input }],
    contextMenuItems: [{ type: Input }],
    checkedRows: [{ type: Input }],
    fast: [{ type: Input }],
    ps: [{ type: ViewChild, args: ['ps',] }],
    tableRowsCmp: [{ type: ViewChild, args: ['mainRows',] }],
    rightRowsCmp: [{ type: ViewChild, args: ['rightRows',] }],
    fixedLeftEl: [{ type: ViewChild, args: ['fixedLeft',] }],
    fixedRightEl: [{ type: ViewChild, args: ['fixedRight',] }],
    mainArea: [{ type: ViewChild, args: ['main',] }],
    viewScrollContainer: [{ type: ViewChild, args: ['viewScrollContainer',] }]
};
if (false) {
    /** @type {?} */
    DatagridBodyComponent.prototype.psConfig;
    /** @type {?} */
    DatagridBodyComponent.prototype.top;
    /** @type {?} */
    DatagridBodyComponent.prototype.height;
    /** @type {?} */
    DatagridBodyComponent.prototype.width;
    /** @type {?} */
    DatagridBodyComponent.prototype.colsWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.totalWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.leftFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rowHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bodyStyle;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.deltaTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.wheelWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._fixedRightScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.maxScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.showRightShadow;
    /** @type {?} */
    DatagridBodyComponent.prototype.footerHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.columnsGroup;
    /** @type {?} */
    DatagridBodyComponent.prototype.topHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bottomHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.startRowIndex;
    /** @type {?} */
    DatagridBodyComponent.prototype.data;
    /** @type {?} */
    DatagridBodyComponent.prototype.dataChange;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollBarMode;
    /** @type {?} */
    DatagridBodyComponent.prototype.contextMenuItems;
    /** @type {?} */
    DatagridBodyComponent.prototype.checkedRows;
    /**
     * 性能优化版，默认为 false
     * @type {?}
     */
    DatagridBodyComponent.prototype.fast;
    /** @type {?} */
    DatagridBodyComponent.prototype.ps;
    /** @type {?} */
    DatagridBodyComponent.prototype.tableRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedLeftEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedRightEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.mainArea;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewScrollContainer;
    /** @type {?} */
    DatagridBodyComponent.prototype.visibleContextMenus;
    /** @type {?} */
    DatagridBodyComponent.prototype.currentRowId;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._hoverRowIndex;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.gridSizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.columnResizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.onDataSourceChangeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.unselectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearSelectionsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.uncheckRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearCheckedsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.subscriptions;
    /** @type {?} */
    DatagridBodyComponent.prototype.dfs;
    /** @type {?} */
    DatagridBodyComponent.prototype.dgs;
    /** @type {?} */
    DatagridBodyComponent.prototype.ngZone;
    /** @type {?} */
    DatagridBodyComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.viewportH;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewportW;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasHeight;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.minRowBuffer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.vScrollDir;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.rowsCache;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollTop;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.rows;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankBottomHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.cellContentFormatter;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.__triggerBodyClickEvent;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._onMouseClick;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollXTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.resizeObserverTimer;
    /** @type {?} */
    DatagridBodyComponent.prototype.onBeforeShowContextMenu;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.app;
    /** @type {?} */
    DatagridBodyComponent.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtYm9keS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1ib2R5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFvQixLQUFLLEVBQUUsWUFBWSxFQUFPLFNBQVMsRUFBVSxNQUFNLGdCQUFnQixDQUFDO0FBQy9GLE9BQU8sRUFBMEIsRUFBRSxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMzRCxPQUFPLGNBQWMsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7O0FBU3RELE9BQU8sRUFDSCxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQzlDLFVBQVUsRUFBYSxpQkFBaUIsRUFDZCx1QkFBdUIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFzQixRQUFRLEVBQUUsY0FBYyxFQUFnQixNQUFNLEVBQUUsWUFBWSxFQUN4SixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUMvRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUd6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSwyQkFBMkIsRUFBNkIsU0FBUyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDM0ksT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzdELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRS9ELE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQU8xQyxNQUFN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Q2IsNkNBQXlCOzs7OztJQUN6QiwyQ0FBdUI7Ozs7O0lBQ3ZCLDBDQUF1Qjs7Ozs7SUFDdkIsc0RBQWtDOzs7OztJQUNsQyx1REFBbUM7O0lBQ25DLDhDQUFrQjs7SUFDbEIsK0NBQW1COztJQUNuQixxQ0FBVTs7SUFDViwrQ0FBbUI7O0lBQ25CLGtEQUFzQjs7SUFtQnRCLHFEQUFnRDs7Ozs7SUFHaEQsd0RBQXVDOzs7OztJQUN2Qyx5Q0FBaUM7Ozs7O0lBQ2pDLDhDQUE2Qjs7Ozs7SUFDN0IsNkNBQThCOzs7OztJQUM5Qiw4Q0FBK0I7Ozs7O0lBQy9CLG1DQUF5Qzs7Ozs7SUFDekMsb0RBQXFDOztJQXUyQ3JDLHdEQXFCQzs7Ozs7SUExM0NHLHlDQUEwQjs7Ozs7SUFDMUIsb0NBQTJCOztJQUMzQixtQ0FBd0M7Ozs7O0lBQ3hDLG1DQUE2Qjs7Ozs7SUFBRSxtQ0FBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgZmlyc3QsIHN3aXRjaE1hcCwgZGVsYXksIGRlYm91bmNlVGltZSwgdGFwLCB0YWtlVW50aWwsIGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBpbnRlcnZhbCwgb2YsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IFJlc2l6ZU9ic2VydmVyIGZyb20gJ3Jlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbCc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMTIgMDc6NDc6MTJcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMjYgMTA6MjE6MjVcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgUmVuZGVyZXIyLFxyXG4gICAgRWxlbWVudFJlZiwgT25EZXN0cm95LCBDaGFuZ2VEZXRlY3RvclJlZiwgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCxcclxuICAgIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIE5nWm9uZSwgSW5qZWN0b3IsIGZvcndhcmRSZWYsIEluamVjdCwgT3B0aW9uYWwsIEFwcGxpY2F0aW9uUmVmLCBIb3N0TGlzdGVuZXIsIE91dHB1dCwgRXZlbnRFbWl0dGVyXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBEYXRhZ3JpZEZhY2FkZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kYXRhZ3JpZC1mYWNhZGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFNjcm9sbGJhckRpcmVjdGl2ZSB9IGZyb20gJy4uLy4uL3Njcm9sbGJhci9zY3JvbGxiYXIuZGlyZWN0aXZlJztcclxuaW1wb3J0IHsgQ29sdW1uR3JvdXAgfSBmcm9tICcuLi8uLi90eXBlcyc7XHJcbmltcG9ydCB7IFNlbGVjdGVkUm93LCBEYXRhUmVzdWx0LCBST1dfSU5ERVhfRklFTEQsIElTX0dST1VQX1JPV19GSUVMRCwgR1JPVVBfUk9XX0ZJRUxELCBJU19HUk9VUF9GT09URVJfUk9XX0ZJRUxEIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvc3RhdGUnO1xyXG5pbXBvcnQgeyBTQ1JPTExfWF9BQ1RJT04sIFNDUk9MTF9ZX0FDVElPTiwgU0NST0xMX1hfUkVBQ0hfU1RBUlRfQUNUSU9OLCBTQ1JPTExfWF9SRUFDSF9FTkRfQUNUSU9OLCBUUl9QUkVGSVggfSBmcm9tICcuLi8uLi90eXBlcy9jb25zdGFudCc7XHJcbmltcG9ydCB7IERhdGFncmlkU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2RhdGFncmlkLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2RhdGFncmlkLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEZvcm1hdENlbGxEYXRhUGlwZSB9IGZyb20gJy4uLy4uL3V0aWxzL2Zvcm1hdC1jZWxsLWRhdGEucGlwZSc7XHJcbmltcG9ydCB7IENvbHVtbkZvcm1hdFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi9jb2x1bW4nO1xyXG5pbXBvcnQgeyBDb250ZXh0TWVudUl0ZW0gfSBmcm9tICdAZmFycmlzL3VpLWNvbnRleHQtbWVudSc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLWJvZHknLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2JvZHkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFncmlkQm9keUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQge1xyXG4gICAgLy8g6Ieq5Yqo6auY5bqm5pe277yM56aB55So57q15ZCR5rua5Yqo5p2hXHJcbiAgICBwc0NvbmZpZyA9IHsgc3dpcGVFYXNpbmc6IGZhbHNlLCBtaW5TY3JvbGxiYXJMZW5ndGg6IDE1LCBoYW5kbGVyczogWydjbGljay1yYWlsJywgJ2RyYWctdGh1bWInLCAnd2hlZWwnLCAndG91Y2gnXSwgc3VwcHJlc3NTY3JvbGxZOiB0aGlzLmRnLmF1dG9IZWlnaHQgJiYgdGhpcy5kZy5tYXhIZWlnaHQgPyBmYWxzZTogdGhpcy5kZy5hdXRvSGVpZ2h0IH07XHJcblxyXG4gICAgdG9wOiBudW1iZXI7XHJcbiAgICBoZWlnaHQ6IG51bWJlcjtcclxuICAgIHdpZHRoOiBudW1iZXI7XHJcbiAgICBjb2xzV2lkdGg6IG51bWJlcjtcclxuICAgIHRvdGFsV2lkdGg6IG51bWJlcjtcclxuICAgIGxlZnRGaXhlZFdpZHRoOiBudW1iZXI7XHJcbiAgICByaWdodEZpeGVkV2lkdGg6IG51bWJlcjtcclxuICAgIHJvd0hlaWdodDogbnVtYmVyO1xyXG4gICAgYm9keVN0eWxlOiBhbnk7XHJcbiAgICBzY3JvbGxUb3AgPSAwO1xyXG4gICAgc2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBkZWx0YVRvcEhlaWdodCA9IDA7XHJcbiAgICAvLyB3aGVlbEhlaWdodCA9IDA7XHJcbiAgICB3aGVlbFdpZHRoID0gMDtcclxuICAgIHByaXZhdGUgX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gMDtcclxuICAgIGdldCBmaXhlZFJpZ2h0U2Nyb2xsTGVmdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQ7XHJcbiAgICB9XHJcbiAgICBzZXQgZml4ZWRSaWdodFNjcm9sbExlZnQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQgPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgbWF4U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBzaG93UmlnaHRTaGFkb3cgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGZvb3RlckhlaWdodCA9IDA7XHJcbiAgICBASW5wdXQoKSBjYW52YXNXaWR0aDtcclxuICAgIEBJbnB1dCgpIGNvbHVtbnNHcm91cDogQ29sdW1uR3JvdXA7XHJcbiAgICAvLyDomZrmi5/liqDovb1cclxuICAgIEBJbnB1dCgpIHRvcEhpZGVIZWlnaHQgPSAwO1xyXG4gICAgQElucHV0KCkgYm90dG9tSGlkZUhlaWdodCA9IDA7XHJcblxyXG4gICAgQElucHV0KCkgc3RhcnRSb3dJbmRleCA9IDA7XHJcbiAgICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcblxyXG4gICAgQE91dHB1dCgpIGRhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQElucHV0KCkgc2Nyb2xsQmFyTW9kZSA9ICdhdXRvJztcclxuICAgIEBJbnB1dCgpIGNvbnRleHRNZW51SXRlbXM6IENvbnRleHRNZW51SXRlbVtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGNoZWNrZWRSb3dzID0gW107XHJcblxyXG4gICAgLyoqIOaAp+iDveS8mOWMlueJiO+8jOm7mOiupOS4uiBmYWxzZSAqL1xyXG4gICAgQElucHV0KCkgZmFzdCA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICBAVmlld0NoaWxkKCdwcycpIHBzPzogU2Nyb2xsYmFyRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpblJvd3MnKSB0YWJsZVJvd3NDbXA6IGFueTtcclxuICAgIEBWaWV3Q2hpbGQoJ3JpZ2h0Um93cycpIHJpZ2h0Um93c0NtcDogYW55O1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRMZWZ0JykgZml4ZWRMZWZ0RWw6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdmaXhlZFJpZ2h0JykgZml4ZWRSaWdodEVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpbicpIG1haW5BcmVhOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgndmlld1Njcm9sbENvbnRhaW5lcicpIHZpZXdTY3JvbGxDb250YWluZXI6IEVsZW1lbnRSZWY7XHJcblxyXG5cclxuICAgIHZpc2libGVDb250ZXh0TWVudXMgPSBbXTtcclxuXHJcbiAgICBjdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgcHJpdmF0ZSBfaG92ZXJSb3dJbmRleCA9IC0xO1xyXG4gICAgZ2V0IGhvdmVyUm93SW5kZXgoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faG92ZXJSb3dJbmRleDtcclxuICAgIH1cclxuICAgIHNldCBob3ZlclJvd0luZGV4KHJvd0lkeDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5faG92ZXJSb3dJbmRleCA9IHJvd0lkeDtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgc2VsZWN0ZWRSb3dzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRnLnNlbGVjdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBncmlkU2l6ZVN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjb2x1bW5SZXNpemVTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgb25EYXRhU291cmNlQ2hhbmdlU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHNlbGVjdFJvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSB1bnNlbGVjdFJvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RBbGxTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2hlY2tSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb25zU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNoZWNrQWxsU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHVuY2hlY2tSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2xlYXJDaGVja2Vkc1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAgIHByaXZhdGUgc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG5cclxuICAgIHB1YmxpYyBkZnM6IERhdGFncmlkRmFjYWRlU2VydmljZTtcclxuICAgIHB1YmxpYyBkZ3M6IERhdGFncmlkU2VydmljZTtcclxuICAgIHB1YmxpYyBuZ1pvbmU6IE5nWm9uZTtcclxuICAgIHB1YmxpYyByZW5kZXI6IFJlbmRlcmVyMjtcclxuXHJcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIHByaXZhdGUgdmlld3BvcnRIO1xyXG4gICAgdmlld3BvcnRXO1xyXG4gICAgY2FudmFzSGVpZ2h0O1xyXG4gICAgcHJpdmF0ZSBtaW5Sb3dCdWZmZXIgPSAzO1xyXG4gICAgcHJpdmF0ZSB2U2Nyb2xsRGlyID0gMTtcclxuICAgIHByaXZhdGUgcm93c0NhY2hlID0ge307XHJcbiAgICBwcml2YXRlIGxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICBwcml2YXRlIGxhc3RSZW5kZXJlZFNjcm9sbExlZnQgPSAwO1xyXG4gICAgcHJldlNjcm9sbFRvcCA9IDA7XHJcbiAgICBwcmV2U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICByb3dzID0gW107XHJcbiAgICBibGFua1RvcEhlaWdodCA9IDA7XHJcbiAgICBibGFua0JvdHRvbUhlaWdodCA9IDA7XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICBnZXQgc2Nyb2xsYmFyWEhlaWdodCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kZyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaCA9IHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10gPyAyMiA6IDA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJZQWN0aXZlJ10gJiYgaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGggKyAxODsgLy8gKyAodGhpcy5kZy5zaG93U2Nyb2xsQXJyb3cgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWUFjdGl2ZSddID8gMTggOiAwKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgc2Nyb2xsYmFyWVdpZHRoKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRnICYmIHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMuaW5zdGFuY2VbJ3Njcm9sbGJhcllBY3RpdmUnXSAmJiB0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2VsbENvbnRlbnRGb3JtYXR0ZXI6IEZvcm1hdENlbGxEYXRhUGlwZSA9IG51bGw7XHJcblxyXG4gICAgLy8g5b2T5ZCv55So5aSa6YCJ5LiU5YWB6K645aSa6YCJ5Lit77yM5YiX6KGo5LiN6IO957yW6L6R5pe277yM5Y+W6YCJ5Lit5ZCO56aB5q2i6Kem5Y+RYm9keSDnmoRjbGljayDkuovku7ZcclxuICAgIHByaXZhdGUgX190cmlnZ2VyQm9keUNsaWNrRXZlbnQgPSB0cnVlO1xyXG4gICAgcHJpdmF0ZSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIF9vbk1vdXNlQ2xpY2sgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBfc2Nyb2xsVGltZXI6IGFueSA9IDA7XHJcbiAgICBwcml2YXRlIF9zY3JvbGxYVGltZXI6IGFueSA9IDA7XHJcbiAgICBwcml2YXRlIHJvOiBSZXNpemVPYnNlcnZlciB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSByZXNpemVPYnNlcnZlclRpbWVyOiBhbnkgPSAwO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnQsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZWw6IEVsZW1lbnRSZWZcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZGZzID0gdGhpcy5pbmplY3Rvci5nZXQoRGF0YWdyaWRGYWNhZGVTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmRncyA9IHRoaXMuaW5qZWN0b3IuZ2V0KERhdGFncmlkU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1uRm9ybWF0U2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KENvbHVtbkZvcm1hdFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuY2VsbENvbnRlbnRGb3JtYXR0ZXIgPSBuZXcgRm9ybWF0Q2VsbERhdGFQaXBlKGNvbHVtbkZvcm1hdFNlcnZpY2UsIHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RlblN1YmplY3RzKCk7XHJcbiAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZSA9IHRoaXMucHM7XHJcbiAgICAgICAgY29uc3QgczEgPSB0aGlzLmRncy5zaG93R3JpZEhlYWRlci5zdWJzY3JpYmUoaGVhZGVySGVpZ2h0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKGhlYWRlckhlaWdodCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEpO1xyXG5cclxuICAgICAgICBjb25zdCBzMTAgPSB0aGlzLmRncy5mb290ZXJQb3NpdGlvbkNoYW5nZWQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEwKTtcclxuXHJcbiAgICAgICAgY29uc3QgczIgPSB0aGlzLmRncy5yb3dIZWlnaHRDaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMyKTtcclxuXHJcbiAgICAgICAgY29uc3QgczMgPSB0aGlzLmRmcy5jbGllbnRTb3J0JC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmRnLmNvbHVtblNvcnRlZC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczMpO1xyXG4gICAgICAgXHJcbiAgICAgICAgY29uc3QgczUgPSB0aGlzLmRnLmRncy5jb2x1bW5zQ2hhbmdlZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSg1MClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUuc2Nyb2xsVG9MZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxUbygwLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9MZWZ0KDAsIDEwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzNSk7XHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uTW91c2VDbGljayA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub25Nb3VzZUNsaWNrKGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlQ29udGFpbmVyU2l6ZShoZWFkZXJIZWlnaHQ/OiBhbnkpIHtcclxuICAgICAgICBjb25zdCBoaCA9IGhlYWRlckhlaWdodCB8fCB0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcChoaCk7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmRnLmhlaWdodCAtIHRoaXMudG9wO1xyXG4gICAgICAgIHRoaXMuYm9keVN0eWxlID0gdGhpcy5nZXRCb2R5U3R5bGUoKTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMuZGF0YSAmJiAhY2hhbmdlcy5kYXRhLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnNldEN1cnJlbnRQYWdlRGF0YShjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGlzRGlmZnJlbnREYXRhU291cmNlID0gISFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlLmZpbHRlcihuID0+ICFuWydfX2dyb3VwX18nXSkubWFwKG4gPT4gbi5pZCkuZmlsdGVyKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFjaGFuZ2VzLmRhdGEucHJldmlvdXNWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLmZpbmQocCA9PiBwLmlkID09PSBuKVxyXG4gICAgICAgICAgICB9KS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpc1NhbWVMZW5ndGggPSBjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlLmZpbHRlcihuID0+ICFuWydfX2dyb3VwX18nXSkubGVuZ3RoID49IGNoYW5nZXMuZGF0YS5wcmV2aW91c1ZhbHVlLmZpbHRlcihuID0+ICFuWydfX2dyb3VwX18nXSkubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLm9uRGF0YUNoYW5nZWQoaXNTYW1lTGVuZ3RoLCBpc0RpZmZyZW50RGF0YVNvdXJjZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWNoYW5nZXMuZGF0YS5jdXJyZW50VmFsdWUgfHwgIWNoYW5nZXMuZGF0YS5jdXJyZW50VmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2l0aW9uVG9wKHRoaXMuZGcucmVhbEhlYWRlckhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMuZm9vdGVySGVpZ2h0ICE9PSB1bmRlZmluZWQgJiYgIWNoYW5nZXMuZm9vdGVySGVpZ2h0LmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zY3JvbGxCYXJNb2RlICE9PSB1bmRlZmluZWQgJiYgIWNoYW5nZXMuc2Nyb2xsQmFyTW9kZS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlLnNjcm9sbGJhcllBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoICs9IHRoaXMuc2hvd1JpZ2h0U2hhZG93ID8gMTggOiAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnBzLmluc3RhbmNlLnNjcm9sbGJhclhBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmxhbmtCb3R0b21IZWlnaHQgKz0gMjI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLnNob3dTY3JvbGxBcnJvdyAmJiAhY2hhbmdlcy5zaG93U2Nyb2xsQXJyb3cuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMgJiYgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95JC5uZXh0KCk7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95JC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIHRoaXMuY2VsbENvbnRlbnRGb3JtYXR0ZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGcuc2Nyb2xsSW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveVN1YnNjcmlwdGlvbnMoKTtcclxuICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uTW91c2VDbGljayk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJvKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm8udW5vYnNlcnZlKHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5yby5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZU9ic2VydmVyVGltZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgdGhpcy5ybyA9IG5ldyBSZXNpemVPYnNlcnZlcigoZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0UGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5zY3JvbGxiYXJVcGRhdGUuZW1pdCh7IHNjcm9sbGJhclJlZjogdGhpcy5wcy5pbnN0YW5jZSwgcmlnaHRXaWR0aDogdGhpcy5yaWdodEZpeGVkV2lkdGggfSk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucm8ub2JzZXJ2ZSh0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0UG9zaXRpb25Ub3AoaGVhZGVySGVpZ2h0OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnRvcCA9IGhlYWRlckhlaWdodDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoKHRoaXMuZGcuZW5hYmxlRmlsdGVyUm93IHx8IHRoaXMuZGcuZW5hYmxlU21hcnRGaWx0ZXIpICYmIHRoaXMuZGcuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICB0aGlzLnRvcCArPSB0aGlzLmRnLmZpbHRlckJhckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dSb3dHcm91cFBhbmVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9wICs9IHRoaXMuZGcucm93R3JvdXBQYW5lbEhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgKHRoaXMuZGcuZm9vdGVyUG9zaXRpb24gPT09ICd0b3AnIHx8IHRoaXMuZGcuZm9vdGVyUG9zaXRpb24gPT09ICdib3RoJykpIHtcclxuICAgICAgICAgICAgLy8gaGVhZGVySGVpZ2h0IOW3suWMheaLrOi/h+a7pOihjOeahOmrmOW6piB0ZnMgNTQyNDcxXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRhdGEgJiYgdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3AgKz0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1Njcm9sbGJhclBvc2l0aW9uKHRvVG9wID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGcuZGF0YSB8fCAhdGhpcy5kZy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNjcm9sbEJhcjogYW55ID0gdGhpcy5wcy5pbnN0YW5jZTtcclxuICAgICAgICBjb25zdCBzY3JvbGxFbFJlZiA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIC8vIHNjcm9sbEJhci51cGRhdGUoKTtcclxuICAgICAgICBjb25zdCBsYXN0U2Nyb2xsTGVmdCA9IHNjcm9sbEJhciA/IHNjcm9sbEJhci5sYXN0U2Nyb2xsTGVmdCA6IDA7XHJcbiAgICAgICAgY29uc3QgbGFzdFNjcm9sbFRvcCA9IHNjcm9sbEJhciA/IHNjcm9sbEJhci5sYXN0U2Nyb2xsVG9wIDogMDtcclxuXHJcbiAgICAgICAgLy8gY29uc3QgbGFzdFNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgLy8gY29uc3QgbGFzdFNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxFbFJlZi5zY3JvbGxUb3A7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IHNjcm9sbEVsUmVmLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgIGlmICghdG9Ub3ApIHtcclxuICAgICAgICAgICAgaWYgKHNjcm9sbFRvcCAhPSBsYXN0U2Nyb2xsVG9wKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvVG9wKGxhc3RTY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxUb3AsIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvVG9wKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsVG9wLCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gbGFzdFNjcm9sbExlZnQ7XHJcbiAgICAgICAgaWYgKHNjcm9sbExlZnQgIT0gbGFzdFNjcm9sbExlZnQpIHtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1gobGFzdFNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbExlZnQsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbExlZnQsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmlbDmja7lj5HnlJ/lj5jljJbvvIzph43mlrDliqDovb3mlbDmja7ml7bmiafooYxcclxuICAgICAqIOmHjee9rua7muWKqOadoeS9jee9rlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uRGF0YUNoYW5nZWQoaXNTYW1lTGVuZ3RoID0gdHJ1ZSwgaXNEaWZmcmVudERhdGFTb3VyY2UgPSBmYWxzZSkge1xyXG4gICAgICAgIHRoaXMuZGcuc2V0UGFnZXJIZWlnaHQoKTtcclxuICAgICAgICB0aGlzLnZpZXdwb3J0SCA9IHRoaXMuZ2V0Vmlld1BvcnRIZWlnaHQoKTtcclxuICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHVwZGF0ZTpcclxuICAgICAgICAgKiBub2RlX21vZHVsZXNcXHBlcmZlY3Qtc2Nyb2xsYmFyXFx0eXBlc1xccGVyZmVjdC1zY3JvbGxiYXIuZC50c1xyXG4gICAgICAgICAqIGxhc3RTY3JvbGxUb3A6IG51bWJlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgIXRoaXMuZGcuaXNFZGl0aW5nKCkgJiYgIXRoaXMuZGcuY2xpZW50RmlsdGVyQ2hhbmdlZCAmJiAhdGhpcy5kZy5hdXRvSGVpZ2h0ICkge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1RvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvTGVmdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yb3dzQ2FjaGUgPSB7fTtcclxuICAgICAgICBjb25zdCBrZWVwc2Nyb2xsUG9zID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzY3JvbGxJbmZvID0gdGhpcy5kZy5kZnMuZ2V0U3RhdGUoKS5zY3JvbGxJbmZvO1xyXG4gICAgICAgICAgICBpZiAoc2Nyb2xsSW5mbyApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxJbmZvLnkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHNjcm9sbEluZm8ueTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWShzY3JvbGxJbmZvLnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLnksIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8ueCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHNjcm9sbEluZm8ueDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLnNjcm9sbFRvWChzY3JvbGxJbmZvLngpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZGdzLm9uU2Nyb2xsTW92ZShzY3JvbGxJbmZvLngsIFNDUk9MTF9YX0FDVElPTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGlzU2FtZUxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAga2VlcHNjcm9sbFBvcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YShmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgXHJcblxyXG4gICAgICAgIGlmIChpc0RpZmZyZW50RGF0YVNvdXJjZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRnLmluaXRTZWxlY3RPckNoZWNrZWQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRnLnJlZnJlc2hTZWxlY3RlZERhdGEoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZy5jbGllbnRGaWx0ZXJDaGFuZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5kYXRhQ2hhbmdlLmVtaXQodGhpcy5kYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRlc3Ryb3lTdWJzY3JpcHRpb25zKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnMgJiYgdGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaCgoc3ViOiBTdWJzY3JpcHRpb24pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChzdWIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBzdWIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGxpc3RlblN1YmplY3RzKCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveVN1YnNjcmlwdGlvbnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5ncmlkU2l6ZVN1YnNjcmliZSA9IHRoaXMuZGZzLmdyaWRTaXplJC5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICApLnBpcGUoXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSg1MClcclxuICAgICAgICApLnN1YnNjcmliZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZXRQYWdlckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGggPSB0aGlzLmRnLnNldEhlYWRlckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcChoaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBzdGF0ZS5oZWlnaHQgLSB0aGlzLnRvcDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRXaWR0aCA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5mbG9vcihzdGF0ZS53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvd0hlaWdodCA9IHN0YXRlLnJvd0hlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5zaG93Qm9yZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCAtPSAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudmlld3BvcnRXID0gdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlld3BvcnRIID0gdGhpcy5nZXRWaWV3UG9ydEhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSB0aGlzLmdldENhbnZhc0hlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbnNHcm91cCA9IHN0YXRlLmNvbHVtbnNHcm91cDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNldEZpeGVkUmlnaHRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uU2l6ZShzdGF0ZS5jb2x1bW5zR3JvdXApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5zaG93Rml4ZWRTaGFkb3cuZW1pdCh7IHNob3dSaWdodFNoYWRvdzogdGhpcy5zaG93UmlnaHRTaGFkb3csIHg6IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2Nyb2xsWFRpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9zY3JvbGxYVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxYVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsWFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLnNob3dTY3JvbGxBcnJvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UsIHJpZ2h0V2lkdGg6IHRoaXMucmlnaHRGaXhlZFdpZHRoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua2VlcFNjcm9sbGJhclBvc2l0aW9uKG9sZFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuZ3JpZFNpemVTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbHVtblJlc2l6ZVN1YnNjcmliZSA9IHRoaXMuZGZzLmNvbHVtblJlc2l6ZSQuc3Vic2NyaWJlKChjZzogQ29sdW1uR3JvdXApID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5TaXplKGNnKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jb2x1bW5SZXNpemVTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmRncy5zZXRTZWxlY2VkUm93LnN1YnNjcmliZSgocjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyICYmIHIuc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gci5pZDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy5zZWxlY3RSb3ckLnN1YnNjcmliZSgocm93OiBTZWxlY3RlZFJvdykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocm93KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHJvdy5pZDtcclxuICAgICAgICAgICAgICAgIC8vIDIwMjEwODE3IOaWueWQkemUruenu+WKqOWQjuWIt+aWsOinhuWbvueKtuaAgVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnNlbGVjdFJvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMudW5zZWxlY3RSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy51blNlbGVjdFJvdyQuc3Vic2NyaWJlKChwcmV2Um93OiBTZWxlY3RlZFJvdykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocHJldlJvdyAmJiBwcmV2Um93LmlkID09PSB0aGlzLmN1cnJlbnRSb3dJZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLnNlbGVjdGVkUm93ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuZGcubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX190cmlnZ2VyQm9keUNsaWNrRXZlbnQgPSB0aGlzLmRnLnNlbGVjdGlvbk1vZGUgPT09ICdkZWZhdWx0JztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy51bnNlbGVjdFJvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0QWxsU3Vic2NyaWJlID0gdGhpcy5kZnMuc2VsZWN0QWxsJC5zdWJzY3JpYmUoKHJvd3M6IFNlbGVjdGVkUm93W10pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RBbGwuZW1pdChyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5zZWxlY3RBbGxTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNoZWNrUm93U3Vic2NyaWJlID0gdGhpcy5kZnMuY2hlY2tSb3ckLnN1YnNjcmliZSgocm93OiBTZWxlY3RlZFJvdykgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRnLmNoZWNrZWQuZW1pdChyb3cpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNoZWNrUm93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbnNTdWJzY3JpYmUgPSB0aGlzLmRmcy5jbGVhclNlbGVjdGlvbnMkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5jaGVja09uU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZGcudW5TZWxlY3RBbGwuZW1pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY2xlYXJTZWxlY3Rpb25zU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy51bmNoZWNrUm93U3Vic2NyaWJlID0gdGhpcy5kZnMudW5DaGVja1JvdyQuc3Vic2NyaWJlKChwcmV2Um93OiBTZWxlY3RlZFJvdykgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRnLnVuQ2hlY2tlZC5lbWl0KHByZXZSb3cpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnVuY2hlY2tSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNoZWNrQWxsU3Vic2NyaWJlID0gdGhpcy5kZnMuY2hlY2tBbGwkLnN1YnNjcmliZSgocm93czogU2VsZWN0ZWRSb3dbXSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRnLmNoZWNrQWxsLmVtaXQocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY2hlY2tBbGxTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNsZWFyQ2hlY2tlZHNTdWJzY3JpYmUgPSB0aGlzLmRmcy5jbGVhckNoZWNrZWRzJC5zdWJzY3JpYmUoKHJvd3M6IFNlbGVjdGVkUm93W10pID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0T25DaGVjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZy51bkNoZWNrQWxsLmVtaXQocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY2xlYXJDaGVja2Vkc1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuZGdzLnNldFNjcm9sbGJhclBvc2l0aW9uLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tTY3JvbGxiYXJQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHRoaXMuc2Nyb2xsTGVmdCk7XHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICB0aGlzLmRncy5jb2x1bW5SZXNpemVkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlbGF5KDEwMClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5ub3dyYXAgfHxcclxuICAgICAgICAgICAgICAgICh0aGlzLmRnLmN1cnJlbnRDZWxsICYmIHRoaXMuZGcuY3VycmVudENlbGwuaXNFZGl0aW5nICYmIHRoaXMuZGcuY3VycmVudENlbGwuY29sdW1uICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jdXJyZW50Q2VsbC5jb2x1bW4uZWRpdG9yICYmIHRoaXMuZGcuY3VycmVudENlbGwuY29sdW1uLmVkaXRvci50eXBlID09PSAndGV4dGFyZWEnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJkb21zID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mLWRhdGFncmlkLWJvZHktcm93Om5vdCguZi1kYXRhZ3JpZC1mb290ZXItcm93KScpO1xyXG4gICAgICAgICAgICAgICAgdHJkb21zLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUobiwgJ2hlaWdodCcsICdhdXRvJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdHJJRCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dJZCA9IGUuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJJRCA9IFRSX1BSRUZJWCArIHJvd0lkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KHRySUQpO1xyXG4gICAgICAgICAgICAgICAgLy8gdHJkb21zLmZvckVhY2gobiA9PiBuLnN0eWxlLmhlaWdodCA9ICcnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuaGVhZGVyV3JhcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZXRIZWFkZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGZzLmNvbHVtblJlc2l6ZUVuZCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmRncy5jZWxsQ29udGVudFdyYXBDaGFuZ2VkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlbGF5KDEwMClcclxuICAgICAgICApLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmRnLmRmcy5yb3dVcGRhdGUkLnN1YnNjcmliZSgocm93OiB7IGluZGV4OiBudW1iZXIsIGRhdGE6IGFueSB9KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyb3cgJiYgcm93LmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRDdXN0b21DZWxsU3R5bGUocm93KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5ncm91cFJvd3MpIHtcclxuICAgICAgICAgICAgdGhpcy5kZnMuZXhwYW5kR3JvdXBSb3cucGlwZShcclxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB0aGlzLmdyb3VwUm93U3RhdGVDaGFuZ2VkKGUuZGF0YSwgdHJ1ZSkpO1xyXG4gICAgICAgICAgICB0aGlzLmRmcy5jb2xsYXBzZUdyb3VwUm93LnBpcGUoXHJcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4gdGhpcy5ncm91cFJvd1N0YXRlQ2hhbmdlZChlLmRhdGEsIGZhbHNlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3JvdXBSb3dFeHBhbmRVcGRhdGUoZ3JvdXBSb3csIGlzRXhwYW5kKSB7XHJcbiAgICAgICAgaWYgKGdyb3VwUm93LnJvd3MgJiYgZ3JvdXBSb3cucm93cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZ3JvdXBSb3cucm93cy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuaWQgPT09IG4uaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0V4cGFuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFsnX19ncm91cF92aXNpYmxlX18nXSA9IGlzRXhwYW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFsnX19ncm91cF92aXNpYmxlX18nXSA9IGdyb3VwUm93LmV4cGFuZGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5yb3dzICYmIGVsZW1lbnQucm93cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBSb3dFeHBhbmRVcGRhdGUoZWxlbWVudCwgaXNFeHBhbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgZ3JvdXBSb3dTdGF0ZUNoYW5nZWQocm93RGF0YSwgZXhwYW5kOiBib29sZWFuKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcudmlydHVhbGl6ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgZ3IgPSB0aGlzLmRhdGEuZmluZChuID0+IG4uaWQgPT09IHJvd0RhdGEuaWQpO1xyXG4gICAgICAgICAgICB0aGlzLmdyb3VwUm93RXhwYW5kVXBkYXRlKGdyLCBleHBhbmQpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpc1snX3BzVXBkYXRlVGltZXJfJ10pIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNbJ19wc1VwZGF0ZVRpbWVyXyddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXNbJ19wc1VwZGF0ZVRpbWVyXyddID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0sIDEwMClcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm47ICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzY3JvbGxSZWFjaCA9IHRoaXMucHMuaW5zdGFuY2UucmVhY2g7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLndpZHRoIC0gb2xkV2lkdGg7XHJcbiAgICAgICAgbGV0IHNjcm9sbExlZnQgPSB0O1xyXG4gICAgICAgIGlmIChzY3JvbGxSZWFjaC54ID09PSAnc3RhcnQnIHx8ICF0aGlzLnBzLmluc3RhbmNlLmxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHNjcm9sbExlZnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvWCgwKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNjcm9sbFJlYWNoLnggPT09ICdlbmQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9SaWdodCgwKTtcclxuICAgICAgICAgICAgc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2Nyb2xsTGVmdCA9IHRoaXMucHMuaW5zdGFuY2UubGFzdFNjcm9sbExlZnQgLSB0O1xyXG4gICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oc2Nyb2xsTGVmdCk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbHVtblNpemUoY2c6IENvbHVtbkdyb3VwKSB7XHJcbiAgICAgICAgaWYgKGNnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1uc0dyb3VwID0gY2c7XHJcbiAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmxlZnRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMuY29sc1dpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGg7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLm1heFNjcm9sbExlZnQgPSB0aGlzLmNvbHNXaWR0aCArIHRoaXMubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vIGdyaWQg5a655Zmo5a695bqmXHJcbiAgICAgICAgICAgIGNvbnN0IGRnQ29udGFpbmVyV2lkdGggPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIC8vIOaJgOacieWIl+WuveS5i+WSjFxyXG4gICAgICAgICAgICBjb25zdCBhbGxDb2xzV2lkdGggPSBNYXRoLmZsb29yKHRoaXMuY29sdW1uc0dyb3VwLnRvdGFsV2lkdGgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICBpZiAoZGdDb250YWluZXJXaWR0aCA+IGFsbENvbHNXaWR0aCB8fCBkZ0NvbnRhaW5lcldpZHRoID09PSBhbGxDb2xzV2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyDlj7Pkvqflm7rlrprliJfnmoTkvY3nva5cclxuICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLndpZHRoICArIHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWUFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvd1JpZ2h0U2hhZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggKz0gMTg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgLSB0aGlzLnJpZ2h0Rml4ZWRXaWR0aDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FudmFzV2lkdGggPiB0aGlzLnRvdGFsV2lkdGggJiYgdGhpcy5jYW52YXNXaWR0aCAtIHRoaXMudG90YWxXaWR0aCAgPCAxOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSAxODtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudG90YWxXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLnRvdGFsV2lkdGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbEJhck1vZGUgPT09ICdhbGx3YXlzJyAmJiAhdGhpcy5yaWdodFJvd3NDbXAgJiYgIXRoaXMuZGcudXNlQ29udHJvbFBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsV2lkdGggKz0gMTg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBwcml2YXRlIHNldEZpeGVkUmlnaHRQb3NpdGlvbigpIHtcclxuICAgIC8vICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLnJpZ2h0Rml4ZWRXaWR0aDtcclxuICAgIC8vICAgICB0aGlzLmxlZnRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAvLyAgICAgdGhpcy5jb2xzV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5ub3JtYWxXaWR0aDtcclxuXHJcbiAgICAvLyAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgIC8vICAgICB0aGlzLm1heFNjcm9sbExlZnQgPSB0aGlzLmNvbHNXaWR0aCArIHRoaXMubGVmdEZpeGVkV2lkdGg7XHJcbiAgICAvLyAgICAgLy8gZ3JpZCDlrrnlmajlrr3luqZcclxuICAgIC8vICAgICBjb25zdCBkZ0NvbnRhaW5lcldpZHRoID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgLy8gICAgIC8vIOaJgOacieWIl+WuveS5i+WSjFxyXG4gICAgLy8gICAgIGNvbnN0IGFsbENvbHNXaWR0aCA9IE1hdGguZmxvb3IodGhpcy5jb2x1bW5zR3JvdXAudG90YWxXaWR0aCk7XHJcblxyXG5cclxuICAgIC8vICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAvLyAgICAgaWYgKGRnQ29udGFpbmVyV2lkdGggPiBhbGxDb2xzV2lkdGggfHwgZGdDb250YWluZXJXaWR0aCA9PT0gYWxsQ29sc1dpZHRoKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgIC8vICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgLy8gICAgICAgICAvLyDlj7Pkvqflm7rlrprliJfnmoTkvY3nva5cclxuICAgIC8vICAgICAgICAgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IHRoaXMud2lkdGggLSB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArIHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyB9XHJcblxyXG4gICAgcHJpdmF0ZSBidWlsZEN1c3RvbUNlbGxTdHlsZShyb3c6IHsgaW5kZXg6IG51bWJlciwgZGF0YTogYW55IH0pIHtcclxuXHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgcmlnaHRUcnMgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICBsZWZ0VHJzID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC1sZWZ0LXJvdycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdHJzID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmYtZGF0YWdyaWQtYm9keS1yb3cnKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlQ2VsbFN0eWxlID0gKGFyciwgY29sLCBzdHlsZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGQgPSBhcnJbcm93LmluZGV4XS5xdWVyeVNlbGVjdG9yKGBbZmllbGQ9XCIke2NvbC5maWVsZH1cIl1gKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUoc3R5bGUsIHRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuZGcuZmxhdENvbHVtbnMuZm9yRWFjaChjb2wgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY29sLnN0eWxlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3JkID0gcm93LmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBVdGlscy5nZXRWYWx1ZShjb2wuZmllbGQsIF9yZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjcyA9IGNvbC5zdHlsZXIodmFsLCBfcmQsIHJvdy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3MgJiYgT2JqZWN0LmtleXMoY3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdHlsZShsZWZ0VHJzLCBjb2wsIGNzKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDZWxsU3R5bGUocmlnaHRUcnMsIGNvbCwgY3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdHlsZSh0cnMsIGNvbCwgY3MpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja2VkUm93c0NoYW5nZWQoKSB7XHJcbiAgICAgICAgdGhpcy5kZ3Mub25DaGVja2VkUm93c0NvdW50Q2hhbmdlKCk7XHJcbiAgICAgICAgY29uc3QgY2hlY2tlZFJvd3MgPSB0aGlzLmRnLmNoZWNrZWRzO1xyXG4gICAgICAgIHRoaXMuZGcuY2hlY2tWYWx1ZXMgPSBjaGVja2VkUm93cy5tYXAociA9PiByLmlkKTtcclxuICAgICAgICB0aGlzLmRnLmNoZWNrVmFsdWVzQ2hhbmdlLmVtaXQodGhpcy5kZy5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgdGhpcy5kZy5jaGVja2VkQ2hhbmdlLmVtaXQoY2hlY2tlZFJvd3MpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0VHJEb21IZWlnaHQoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdCA9IFtdO1xyXG4gICAgICAgIGxldCByaWdodFRycyA9IFtdO1xyXG4gICAgICAgIGxldCBsZWZ0VHJzID0gW107XHJcbiAgICAgICAgbGV0IHRyZG9tcyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICByaWdodFRycyA9IHRoaXMuZml4ZWRSaWdodEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgIGxlZnRUcnMgPSB0aGlzLmZpeGVkTGVmdEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZpeGVkLWxlZnQtcm93Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5tYWluQXJlYSkge1xyXG4gICAgICAgICAgICB0cmRvbXMgPSB0aGlzLm1haW5BcmVhLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHIuZi1kYXRhZ3JpZC1ib2R5LXJvdycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cmRvbXMuZm9yRWFjaCgodHIsIGkpID0+IHtcclxuICAgICAgICAgICAgbGV0IHQxID0gMDtcclxuICAgICAgICAgICAgY29uc3QgdDIgPSBNYXRoLmNlaWwodHIub2Zmc2V0SGVpZ2h0KTtcclxuICAgICAgICAgICAgbGV0IHQzID0gMDtcclxuICAgICAgICAgICAgaWYgKGxlZnRUcnMgJiYgbGVmdFRycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHQxID0gTWF0aC5jZWlsKGxlZnRUcnNbaV0ub2Zmc2V0SGVpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHJpZ2h0VHJzICYmIHJpZ2h0VHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdDMgPSBNYXRoLmNlaWwocmlnaHRUcnNbaV0ub2Zmc2V0SGVpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgX2ggPSBNYXRoLm1heCh0MSwgdDIsIHQzLCB0aGlzLmRnLnJvd0hlaWdodCk7XHJcbiAgICAgICAgICAgIGxpc3QucHVzaChfaCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICB9XHJcbiAgICAvKiog5YWB6K645pWw5o2u5oqY6KGM5pe277yM6K6h566X6KGM5Y+355qE6KGM6auYICovXHJcbiAgICB1cGRhdGVSb3dIZWlnaHQodHJEb21JZCA9IG51bGwpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZmFzdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRnQm9keSA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZi1kYXRhZ3JpZC1ib2R5Jyk7XHJcbiAgICAgICAgaWYgKGRnQm9keSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoZGdCb2R5LCAnZGF0YS13cmFwJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyhkZ0JvZHksICdkYXRhLXdyYXAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGNzc1RleHRBcnIgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKCF0ckRvbUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93cy5mb3JFYWNoKChyLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dJZCA9IHRoaXMuZGZzLnByaW1hcnlJZChyKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRySUQgPSBUUl9QUkVGSVggKyByb3dJZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlZnRUcklkID0gdHJJRCArICdfZml4ZWRsZWZ0JztcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0VHJJZCA9IHRySUQgKyAnX2ZpeGVkcmlnaHQnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kZy5ub3dyYXAgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMuZ2V0VHJEb21IZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoID0gbGlzdFtpXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7bGVmdFRySWR9eyBoZWlnaHQ6ICR7aH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7dHJJRH17IGhlaWdodDogJHtofXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7aH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7bGVmdFRySWR9eyBoZWlnaHQ6ICR7bGlzdFtpXX1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHt0cklEfXsgaGVpZ2h0OiAke2xpc3RbaV19cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7cmlnaHRUcklkfXsgaGVpZ2h0OiAke2xpc3RbaV19cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleTEgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7bGVmdFRySWR9YDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkyID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3RySUR9YDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkzID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3JpZ2h0VHJJZH1gO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5yZW1vdmVDc3NSdWxlKGtleTEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnJlbW92ZUNzc1J1bGUoa2V5Mik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MucmVtb3ZlQ3NzUnVsZShrZXkzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kZ3MuYXBwZW5kQ3NzUnVsZXMoY3NzVGV4dEFycik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3NzVGV4dEFyciA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBkb21TZWwgPSAnIycgKyB0ckRvbUlkO1xyXG4gICAgICAgICAgICBjb25zdCBfYXJyID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcnRyID0gdGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKGRvbVNlbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocnRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fyci5wdXNoKE1hdGguY2VpbChydHIub2Zmc2V0SGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsdHIgPSB0aGlzLmZpeGVkTGVmdEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcihkb21TZWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGx0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwobHRyLm9mZnNldEhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5tYWluQXJlYSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHIgPSB0aGlzLm1haW5BcmVhLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcihkb21TZWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fyci5wdXNoKE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgX2ggPSBNYXRoLm1heCguLi5fYXJyKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGxlZnRUcklkID0gdHJEb21JZCArICdfZml4ZWRsZWZ0JztcclxuICAgICAgICAgICAgY29uc3QgcmlnaHRUcklkID0gdHJEb21JZCArICdfZml4ZWRyaWdodCc7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5ub3dyYXAgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHtsZWZ0VHJJZH17IGhlaWdodDogJHtfaH1weDt9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHt0ckRvbUlkfXsgaGVpZ2h0OiAke19ofXB4O31gKTtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke3JpZ2h0VHJJZH17IGhlaWdodDogJHtfaH1weDt9YCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke19ofXB4IH1gKTtcclxuICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7dHJEb21JZH17IGhlaWdodDogJHtfaH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3JpZ2h0VHJJZH17IGhlaWdodDogJHtfaH1weCB9YCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGdzLmFwcGVuZENzc1J1bGVzKGNzc1RleHRBcnIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgLy8g56e76ZmkaGVpZ2h0OiBhdXRvXHJcbiAgICAgICAgY29uc3QgdHJkb21zID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mLWRhdGFncmlkLWJvZHktcm93Om5vdChmLWRhdGFncmlkLWZvb3Rlci1yb3cpJyk7XHJcbiAgICAgICAgdHJkb21zLmZvckVhY2gobiA9PiBuLnN0eWxlLmhlaWdodCA9ICcnKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGdldEJvZHlTdHlsZSgpIHtcclxuICAgICAgICBsZXQgaCA9IHRoaXMuZ2V0Vmlld1BvcnRIZWlnaHQoKTtcclxuICAgICAgICBpZiAoIXRoaXMuZGF0YS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnVzZUJsYW5rV2hlbkRhdGFJc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICBoID0gdGhpcy5kZy5lbXB0eURhdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IHRoaXMuZGcuZW1wdHlEYXRhSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmZvb3RlckRhdGEgJiYgdGhpcy5kZy5zaG93Rm9vdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZkID0gdGhpcy5kZy5mb290ZXJEYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmZvb3RlckRhdGEuc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZkID0gdGhpcy5kZy5mb290ZXJEYXRhWyd2YWx1ZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZkICYmIEFycmF5LmlzQXJyYXkoZmQpICYmIGZkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuZm9vdGVyUG9zaXRpb24gPT09ICdib3RoJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGggLSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgdGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ2JvdGgnKSB7XHJcbiAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGhlaWdodDogYCR7TWF0aC5mbG9vcihoKSArIDF9cHhgXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVNjcm9sbFBvc2l0aW9uKHNjcm9sbExlZnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQgKyB0aGlzLndpZHRoIC0gdGhpcy5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPT09IHRoaXMubWF4U2Nyb2xsTGVmdCB8fCB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID4gdGhpcy5tYXhTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKCR7dGhpcy5zY3JvbGxMZWZ0fXB4LCAwcHgsIDBweClgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKCR7dGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdH1weCwgMHB4LCAwcHgpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uU2Nyb2xsVG9YKCRldmVudDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgeCA9ICRldmVudC50YXJnZXQuc2Nyb2xsTGVmdDtcclxuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHgpO1xyXG4gICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh4LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgIHRoaXMuZGZzLnVwZGF0ZVByb3BlcnR5KCdzY3JvbGxJbmZvJywgeyB5OiAkZXZlbnQudGFyZ2V0LnNjcm9sbFRvcCwgeCB9KTtcclxuICAgICAgICB0aGlzLmRncy5zaG93Rml4ZWRTaGFkb3cuZW1pdCh7IHNob3dSaWdodFNoYWRvdzogdGhpcy5zaG93UmlnaHRTaGFkb3csIHg6IHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TY3JvbGxUb1koJGV2ZW50OiBhbnkpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbFRpbWVyKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9zY3JvbGxUaW1lcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zY3JvbGxUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB5ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy52aXJ0dWFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTY3JvbGwoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSB5O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kZnMudXBkYXRlUHJvcGVydHkoJ3Njcm9sbEluZm8nLCB7IHksIHg6ICRldmVudC50YXJnZXQuc2Nyb2xsTGVmdCB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGcuc2Nyb2xsWS5lbWl0KHkpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeSwgU0NST0xMX1lfQUNUSU9OKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUHNYUmVhY2hTdGFydCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfUkVBQ0hfU1RBUlRfQUNUSU9OKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBzWFJlYWNoRW5kKCRldmVudDogYW55KSB7XHJcbiAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSBmYWxzZTtcclxuICAgICAgICAvLyBjb25zdCB4ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIC8vIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oeCk7XHJcbiAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgLy8gLy8gdGhpcy5kZ3Mub25TaG93Rml4ZWRTaGFkb3codGhpcy5zaG93UmlnaHRTaGFkb3cpO1xyXG4gICAgICAgIC8vIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZSh4LCBTQ1JPTExfWF9SRUFDSF9FTkRfQUNUSU9OKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0NoZWNrZWQocm93RGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGZzLmlzUm93Q2hlY2tlZChyb3dEYXRhW3RoaXMuZGcuaWRGaWVsZF0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaXNTZWxlY3RlZChyb3dEYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAocm93RGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZnMuaXNSb3dTZWxlY3RlZChyb3dEYXRhW3RoaXMuZGcuaWRGaWVsZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlR3JvdXBSb3cocm93LCBvcGVuID0gdHJ1ZSkge1xyXG4gICAgICAgIHJvdy5leHBhbmRlZCA9IG9wZW47XHJcbiAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8qKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSDliIYgPT09PT09IOmalCA9PT09PT0g57q/ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcblxyXG4gICAgLyoqIOiOt+WPluWPr+inhuWMuuWfn+mrmOW6piAqL1xyXG4gICAgcHVibGljIGdldFZpZXdQb3J0SGVpZ2h0KCkge1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEhlaWdodCA9IHRoaXMuZGcuaGVpZ2h0O1xyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dIZWFkZXIpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgPSB2aWV3UG9ydEhlaWdodCAtIHRoaXMuZGcucmVhbEhlYWRlckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgodGhpcy5kZy5lbmFibGVGaWx0ZXJSb3cgfHwgdGhpcy5kZy5lbmFibGVTbWFydEZpbHRlcikgJiYgdGhpcy5kZy5zaG93RmlsdGVyQmFyKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0IC09IHRoaXMuZGcuZmlsdGVyQmFySGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd1Jvd0dyb3VwUGFuZWwpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgLT0gdGhpcy5kZy5yb3dHcm91cFBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0Zvb3RlciAmJiB0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnBhZ2luYXRpb24pIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgPSB2aWV3UG9ydEhlaWdodCAtIHRoaXMuZGcucGFnZXJIZWlnaHQgLSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCAtPSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy52aWV3cG9ydEggPSB2aWV3UG9ydEhlaWdodDtcclxuICAgICAgICByZXR1cm4gdmlld1BvcnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5LiN5oqY6KGM5pe277yM5omA5pyJ5pWw5o2u55qE6auY5bqmXHJcbiAgICBwcml2YXRlIGFsbFJvd3NIZWlnaHQoKSB7XHJcbiAgICAgICAgY29uc3Qgcm93SGVpZ2h0cGF0Y2ggPSAxOyAgLy8gdGhpcy5kZy5hdXRvSGVpZ2h0ID8gMiA6IDE7XHJcbiAgICAgICAgY29uc3Qgcm93SGVpZ2h0ID0gdGhpcy5kZy5yb3dIZWlnaHQgKyByb3dIZWlnaHRwYXRjaDtcclxuXHJcbiAgICAgICAgbGV0IGl0ZW1zQ291bnQgPSAwO1xyXG4gICAgICAgIGlmICh0aGlzLmRnLmdyb3VwUm93cykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhLmZpbHRlcihuID0+IG5bJ19fZ3JvdXBfdmlzaWJsZV9fJ10gfHwgblsnX19ncm91cF92aXNpYmxlX18nXT09PXVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmdyb3VwU3VtbWFyeVBvc2l0aW9uID09PSAnaW5Hcm91cFJvdycpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zQ291bnQgPSBkYXRhLmZpbHRlcihuID0+ICFuWydfX2dyb3VwX2Zvb3Rlcl9fJ10pLmxlbmd0aDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zQ291bnQgPSBkYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGl0ZW1zQ291bnQgPSB0aGlzLmRhdGEubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGggPSBpdGVtc0NvdW50ICogcm93SGVpZ2h0O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGggKz0gaXRlbXNDb3VudDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBoICs9IDI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldENhbnZhc0hlaWdodCgpIHtcclxuICAgICAgICBsZXQgY2FudmFzSGVpZ2h0ID0gMDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEgfHwgIXRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLm5vd3JhcCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcubWF4SGVpZ2h0ICYmIHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IE1hdGguZmxvb3IodGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmFsbFJvd3NIZWlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0VHJEb21IZWlnaHQoKS5yZWR1Y2UoKHIsIGMpID0+IHIgKyBjLCAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghY2FudmFzSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMudmlld3BvcnRIO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FudmFzSGVpZ2h0ID0gY2FudmFzSGVpZ2h0ICsgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiAodGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10pID8gMTggOiAwKTtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IGNhbnZhc0hlaWdodDtcclxuICAgICAgICByZXR1cm4gY2FudmFzSGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUNhbnZhc0hlaWdodCgpIHtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2V0Um93RnJvbVBvc2l0aW9uKHkpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih5IC8gKHRoaXMuZGcucm93SGVpZ2h0ICsgMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFZpc2libGVSYW5nZSh2aWV3cG9ydFRvcD86IG51bWJlciwgdmlld3BvcnRMZWZ0PzogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0VG9wID09IG51bGwpIHtcclxuICAgICAgICAgICAgdmlld3BvcnRUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0TGVmdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZpZXdwb3J0TGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRvcDogdGhpcy5nZXRSb3dGcm9tUG9zaXRpb24odmlld3BvcnRUb3ApLFxyXG4gICAgICAgICAgICBib3R0b206IHRoaXMuZ2V0Um93RnJvbVBvc2l0aW9uKHZpZXdwb3J0VG9wICsgdGhpcy52aWV3cG9ydEgpICsgMSxcclxuICAgICAgICAgICAgbGVmdFB4OiB2aWV3cG9ydExlZnQsXHJcbiAgICAgICAgICAgIHJpZ2h0UHg6IHZpZXdwb3J0TGVmdCArIHRoaXMudmlld3BvcnRXXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJlbmRlcmVkUmFuZ2Uodmlld3BvcnRUb3A/OiBudW1iZXIsIHZpZXdwb3J0TGVmdD86IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2Uodmlld3BvcnRUb3AsIHZpZXdwb3J0TGVmdCk7XHJcbiAgICAgICAgY29uc3QgYnVmZmVyID0gTWF0aC5yb3VuZCh0aGlzLnZpZXdwb3J0SCAvICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgICAgICBjb25zdCBtaW5CdWZmZXIgPSB0aGlzLm1pblJvd0J1ZmZlcjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudlNjcm9sbERpciA9PSAtMSkge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gYnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy52U2Nyb2xsRGlyID09IDEpIHtcclxuICAgICAgICAgICAgcmFuZ2UudG9wIC09IG1pbkJ1ZmZlcjtcclxuICAgICAgICAgICAgcmFuZ2UuYm90dG9tICs9IGJ1ZmZlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gbWluQnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmFuZ2UudG9wID0gTWF0aC5tYXgoMCwgcmFuZ2UudG9wKTtcclxuICAgICAgICByYW5nZS5ib3R0b20gPSBNYXRoLm1pbih0aGlzLmRhdGEubGVuZ3RoIC0gMSwgcmFuZ2UuYm90dG9tKTtcclxuXHJcbiAgICAgICAgcmFuZ2UubGVmdFB4IC09IHRoaXMudmlld3BvcnRXO1xyXG4gICAgICAgIHJhbmdlLnJpZ2h0UHggKz0gdGhpcy52aWV3cG9ydFc7XHJcblxyXG4gICAgICAgIHJhbmdlLmxlZnRQeCA9IE1hdGgubWF4KDAsIHJhbmdlLmxlZnRQeCk7XHJcbiAgICAgICAgcmFuZ2UucmlnaHRQeCA9IE1hdGgubWluKHRoaXMuY2FudmFzV2lkdGgsIHJhbmdlLnJpZ2h0UHgpO1xyXG5cclxuICAgICAgICByZXR1cm4gcmFuZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJSb3dzKHJhbmdlKSB7XHJcbiAgICAgICAgY29uc3Qgcm93cyA9IFtdO1xyXG4gICAgICAgIGxldCBkYXRhTGVuZ3RoID0gdGhpcy5kYXRhLmxlbmd0aDtcclxuICAgICAgICBsZXQgX2RhdGEgPSAgdGhpcy5kYXRhO1xyXG5cclxuICAgICAgICAgLy8g5ZCv55So5YiG57uEXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZ3JvdXBSb3dzICYmIHRoaXMuZGcuZ3JvdXBGaWVsZCkge1xyXG4gICAgICAgICAgICBfZGF0YSA9ICBfZGF0YS5maWx0ZXIobiA9PiBuWydfX2dyb3VwX3Zpc2libGVfXyddIHx8IG5bJ19fZ3JvdXBfdmlzaWJsZV9fJ109PT11bmRlZmluZWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZ3JvdXBTdW1tYXJ5UG9zaXRpb24gPT09ICdpbkdyb3VwUm93Jykge1xyXG4gICAgICAgICAgICAgICAgX2RhdGEgPSBfZGF0YS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9mb290ZXJfXyddKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGF0YUxlbmd0aCA9IF9kYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5yb3dzQ2FjaGUgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSByYW5nZS50b3A7IGkgPD0gcmFuZ2UuYm90dG9tOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucm93c0NhY2hlW2ldIHx8IChpID09IGRhdGFMZW5ndGgpICkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJvd3MucHVzaChpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBlbnRyeSByaWdodCBhd2F5IHNvIHRoYXQgYXBwZW5kUm93SHRtbCgpIGNhblxyXG4gICAgICAgICAgICAvLyBzdGFydCBwb3B1bGF0YXRpbmcgaXQuXHJcbiAgICAgICAgICAgIHRoaXMucm93c0NhY2hlW2ldID0ge1xyXG4gICAgICAgICAgICAgICAgcm93Tm9kZTogbnVsbCxcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb2xTcGFucyBvZiByZW5kZXJlZCBjZWxscyAoYnkgY29sdW1uIGlkeCkuXHJcbiAgICAgICAgICAgICAgICAvLyBDYW4gYWxzbyBiZSB1c2VkIGZvciBjaGVja2luZyB3aGV0aGVyIGEgY2VsbCBoYXMgYmVlbiByZW5kZXJlZC5cclxuICAgICAgICAgICAgICAgIGNlbGxDb2xTcGFuczogW10sXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2VsbCBub2RlcyAoYnkgY29sdW1uIGlkeCkuICBMYXp5LXBvcHVsYXRlZCBieSBlbnN1cmVDZWxsTm9kZXNJblJvd3NDYWNoZSgpLlxyXG4gICAgICAgICAgICAgICAgY2VsbE5vZGVzQnlDb2x1bW5JZHg6IFtdLFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENvbHVtbiBpbmRpY2VzIG9mIGNlbGwgbm9kZXMgdGhhdCBoYXZlIGJlZW4gcmVuZGVyZWQsIGJ1dCBub3QgeWV0IGluZGV4ZWQgaW5cclxuICAgICAgICAgICAgICAgIC8vIGNlbGxOb2Rlc0J5Q29sdW1uSWR4LiAgVGhlc2UgYXJlIGluIHRoZSBzYW1lIG9yZGVyIGFzIGNlbGwgbm9kZXMgYWRkZWQgYXQgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBlbmQgb2YgdGhlIHJvdy5cclxuICAgICAgICAgICAgICAgIGNlbGxSZW5kZXJRdWV1ZTogW11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJvd3MubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3NDYWNoZVtyb3dzW2ldXS5yb3dOb2RlID0gX2RhdGFbcm93c1tpXV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5yb3dzQ2FjaGUpLm1hcChuID0+IHRoaXMucm93c0NhY2hlW25dLnJvd05vZGUpLmZpbHRlcihuID0+IG4pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZVJvd0Zyb21DYWNoZShyb3cpIHtcclxuICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gdGhpcy5yb3dzQ2FjaGVbcm93XTtcclxuICAgICAgICBpZiAoIWNhY2hlRW50cnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGVsZXRlIHRoaXMucm93c0NhY2hlW3Jvd107XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhbnVwUm93cyhyYW5nZVRvS2VlcCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnJvd3NDYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAoaSA8IHJhbmdlVG9LZWVwLnRvcCB8fCBpID4gcmFuZ2VUb0tlZXAuYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0Zyb21DYWNoZShpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYXNZU2Nyb2xsYmFyKHNob3dZc2Nyb2xsYmFyOiBib29sZWFuKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uU2l6ZSh0aGlzLmNvbHVtbnNHcm91cCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UgfSk7XHJcbiAgICAgICAgfSwgNjApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xpY2tTY3JvbGxBcnJvdygkZXZlbnQpIHtcclxuICAgICAgICBjb25zdCB7IGRpciwgZXZlbnQgfSA9ICRldmVudDtcclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdGhpcy5wcy5pbnN0YW5jZS5yZWFjaDtcclxuICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2goZGlyKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeCE9PSAnc3RhcnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0IC0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh4IT09ICdlbmQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ICsgNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndG9wJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeSAhPT0gJ3N0YXJ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgLSA0MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5ICE9PSAnZW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgKyA0MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyRGF0YShkZXRlY3RjaGFuZ2VzID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICBpZiAoIXRoaXMuZGcudmlydHVhbGl6ZWQgfHwgdGhpcy5kZy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMuZGF0YTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aXNpYmxlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWQgPSB0aGlzLmdldFJlbmRlcmVkUmFuZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSByb3dzIG5vIGxvbmdlciBpbiB0aGUgdmlld3BvcnRcclxuICAgICAgICAgICAgdGhpcy5jbGVhbnVwUm93cyhyZW5kZXJlZCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW5kZXIgbWlzc2luZyByb3dzXHJcbiAgICAgICAgICAgIHRoaXMucm93cyA9IHRoaXMucmVuZGVyUm93cyhyZW5kZXJlZCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRSb3dJbmRleCA9IHJlbmRlcmVkLnRvcDtcclxuICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG5cclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmJsYW5rVG9wSGVpZ2h0ID0gdGhpcy5zdGFydFJvd0luZGV4ICogKHRoaXMuZGcucm93SGVpZ2h0ICsgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuYmxhbmtCb3R0b21IZWlnaHQgPSB0aGlzLmNhbnZhc0hlaWdodCAtIHRoaXMuYmxhbmtUb3BIZWlnaHQgLSAodGhpcy5yb3dzLmxlbmd0aCAqICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ICs9IDIyO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgaWYgKGRldGVjdGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGFuZGxlU2Nyb2xsKCkge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVNjcm9sbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2hhbmRsZVNjcm9sbCgpIHtcclxuICAgICAgICBjb25zdCB2aWV3cG9ydENvbnRhaW5lciA9IHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIGxldCBtYXhTY3JvbGxEaXN0YW5jZVkgPSB2aWV3cG9ydENvbnRhaW5lci5zY3JvbGxIZWlnaHQgLSB2aWV3cG9ydENvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgbGV0IG1heFNjcm9sbERpc3RhbmNlWCA9IHZpZXdwb3J0Q29udGFpbmVyLnNjcm9sbFdpZHRoIC0gdmlld3BvcnRDb250YWluZXIuY2xpZW50V2lkdGg7XHJcblxyXG4gICAgICAgIC8vIFByb3RlY3QgYWdhaW5zdCBlcnJvbmVvdXMgY2xpZW50SGVpZ2h0L1dpZHRoIGdyZWF0ZXIgdGhhbiBzY3JvbGxIZWlnaHQvV2lkdGguXHJcbiAgICAgICAgLy8gU29tZXRpbWVzIHNlZW4gaW4gQ2hyb21lLlxyXG4gICAgICAgIG1heFNjcm9sbERpc3RhbmNlWSA9IE1hdGgubWF4KDAsIG1heFNjcm9sbERpc3RhbmNlWSk7XHJcbiAgICAgICAgbWF4U2Nyb2xsRGlzdGFuY2VYID0gTWF0aC5tYXgoMCwgbWF4U2Nyb2xsRGlzdGFuY2VYKTtcclxuXHJcbiAgICAgICAgLy8gQ2VpbGluZyB0aGUgbWF4IHNjcm9sbCB2YWx1ZXNcclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxUb3AgPiBtYXhTY3JvbGxEaXN0YW5jZVkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSBtYXhTY3JvbGxEaXN0YW5jZVk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNjcm9sbExlZnQgPiBtYXhTY3JvbGxEaXN0YW5jZVgpIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gbWF4U2Nyb2xsRGlzdGFuY2VYO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdlNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbFRvcCAtIHRoaXMucHJldlNjcm9sbFRvcCk7XHJcbiAgICAgICAgY29uc3QgaFNjcm9sbERpc3QgPSBNYXRoLmFicyh0aGlzLnNjcm9sbExlZnQgLSB0aGlzLnByZXZTY3JvbGxMZWZ0KTtcclxuXHJcbiAgICAgICAgaWYgKGhTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgICAgICAvLyAkdmlld3BvcnRTY3JvbGxDb250YWluZXJYWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcFJbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydFRvcExbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgaWYgKHZTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMudlNjcm9sbERpciA9IHRoaXMucHJldlNjcm9sbFRvcCA8IHRoaXMuc2Nyb2xsVG9wID8gMSA6IC0xO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Db2x1bW5zKCkpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChoYXNGcm96ZW5Sb3dzICYmICFvcHRpb25zLmZyb3plbkJvdHRvbSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICR2aWV3cG9ydEJvdHRvbUxbMF0uc2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BMWzBdLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gc3dpdGNoIHZpcnR1YWwgcGFnZXMgaWYgbmVlZGVkXHJcbiAgICAgICAgICAgIGlmICh2U2Nyb2xsRGlzdCA8IHRoaXMudmlld3BvcnRIKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxUbyh0aGlzLnNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCB8fCB2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICBjb25zdCBkeCA9IE1hdGguYWJzKHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCAtIHRoaXMuc2Nyb2xsTGVmdCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGR5ID0gTWF0aC5hYnMobGFzdFNjcm9sbFRvcCAtIHRoaXMuc2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgaWYgKGR4ID4gMjAgfHwgZHkgPiAyMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgcmVuZGVyaW5nIGlzIGZvcmNlZCBvciBzY3JvbGxpbmcgaXMgc21hbGwgZW5vdWdoIHRvIGJlIFwiZWFzeVwiLCBqdXN0IHJlbmRlclxyXG4gICAgICAgICAgICAgICAgaWYgKGR5IDwgdGhpcy52aWV3cG9ydEggJiYgZHggPCB0aGlzLnZpZXdwb3J0Vykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhTY3JvbGxEaXN0IHx8IHZTY3JvbGxEaXN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfc2Nyb2xsVG8oeSkge1xyXG4gICAgICAgIGNvbnN0ICR2aWV3cG9ydFNjcm9sbENvbnRhaW5lclkgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB5ID0gTWF0aC5tYXgoeSwgMCk7XHJcbiAgICAgICAgeSA9IE1hdGgubWluKHksIHRoaXMuY2FudmFzSGVpZ2h0IC0gdGhpcy52aWV3cG9ydEgpO1xyXG5cclxuICAgICAgICBjb25zdCBuZXdTY3JvbGxUb3AgPSB5O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wcmV2U2Nyb2xsVG9wICE9IG5ld1Njcm9sbFRvcCkge1xyXG4gICAgICAgICAgICB0aGlzLnZTY3JvbGxEaXIgPSAodGhpcy5wcmV2U2Nyb2xsVG9wIDwgbmV3U2Nyb2xsVG9wKSA/IDEgOiAtMTtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSAodGhpcy5zY3JvbGxUb3AgPSB0aGlzLnByZXZTY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3ApO1xyXG5cclxuICAgICAgICAgICAgLy8gaWYgKGhhc0Zyb3plbkNvbHVtbnMoKSkge1xyXG4gICAgICAgICAgICAvLyAgICAgJHZpZXdwb3J0VG9wTFswXS5zY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Sb3dzKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAkdmlld3BvcnRCb3R0b21MWzBdLnNjcm9sbFRvcCA9ICR2aWV3cG9ydEJvdHRvbVJbMF0uc2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAvLyAkdmlld3BvcnRTY3JvbGxDb250YWluZXJZLnNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZUNsaWNrKCRldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgIC8vIGRvY3VtZW50LmJvZHkuY2xpY2soKTtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSAkZXZlbnQudGFyZ2V0IGFzIGFueTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyB8fCB0YXJnZXQubm9kZU5hbWUgPT09ICdJTlBVVCcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsZXQgdGQgPSB0YXJnZXQ7XHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSAhPT0gJ1REJykge1xyXG4gICAgICAgICAgICB0ZCA9IHRhcmdldC5jbG9zZXN0KCdURCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuX190cmlnZ2VyQm9keUNsaWNrRXZlbnQpIHtcclxuICAgICAgICAgICAgLy8g6Kej5Yaz6LaF6ZO+54K55Ye75LqL5Lu277yM6KaB5YWI5omn6KGM6YCJ5Lit6KGMXHJcbiAgICAgICAgICAgIGlmICh0ZCAmJiB0ZC5zZWxlY3RDZWxsICkge1xyXG4gICAgICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGQuc2VsZWN0Q2VsbCgkZXZlbnQsIHRkKTsgIC8vIOaMieeQhuivtOWPr+S7peWIoOmZpOeahO+8jOS9huS4jeaVouWKqOWTpm8o4omn5Y+j4ommKW9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5lZGl0TW9kZSA9PT0gJ3JvdycpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRkICYmIHRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgdGQgPSB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50O1xyXG4gICAgICAgICAgICBpZiAodGQgJiYgdGQuY2xvc2VFZGl0KSB7XHJcbiAgICAgICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5jbG9zZUVkaXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAvLyDooYznpoHnlKjml7ZcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZVJvdyAmJiB0ZC5ncmlkQ2VsbERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcm93RGF0YSwgcm93SW5kZXggfSA9IHRkLmdyaWRDZWxsRGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cocm93RGF0YSwgcm93SW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5kZy5lZGl0TW9kZSA9PT0gJ2NlbGwnICYmIHRkLmVkaXQpIHtcclxuICAgICAgICAgICAgICAgIHRkLmVkaXQoJGV2ZW50KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ZC5zZWxlY3RDZWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnICYmIHRoaXMuZGcubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRkLnNlbGVjdENlbGwoJGV2ZW50LCB0ZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kQ2VsbEVkaXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25CZWZvcmVTaG93Q29udGV4dE1lbnUgPSAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gcm93XzFfZml4ZWRsZWZ0ICByb3dfMSAgcm93XzFfZml4ZWRyaWdodFxyXG4gICAgICAgIGNvbnN0IHsgY29udGV4dE1lbnVEb20sIGV2ZW50IH0gPSBlO1xyXG5cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5kYXRhZ3JpZC1lZGl0b3InKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gb2Yoe3Nob3c6IGZhbHNlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgbGV0IHJvd0lEID0gZXZlbnQudGFyZ2V0LmlkO1xyXG5cclxuICAgICAgICBpZiAoY29udGV4dE1lbnVEb20pIHtcclxuICAgICAgICAgICAgLy8g5o6S6Zmk5YiG57uE6KGM44CB5YiG57uE5ZCI6K6h6KGMXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0TWVudURvbS5jbGFzc05hbWUuaW5kZXhPZignZi1kYXRhZ3JpZC1ncm91cC1yb3cnKSA9PT0gLTEgJiYgY29udGV4dE1lbnVEb20uY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZ3JvdXAtZm9vdGVyJykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByb3dJRCA9IGNvbnRleHRNZW51RG9tLmlkLnJlcGxhY2UoJ3Jvd18nLCAnJykucmVwbGFjZSgnX2ZpeGVkbGVmdCcsICcnKS5yZXBsYWNlKCdfZml4ZWRyaWdodCcsICcnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJvd0RhdGEgPSB0aGlzLmRmcy5maW5kUm93KHJvd0lEKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvY3VzVGFyZ2V0V2lkdGggPSB0aGlzLnZpZXdwb3J0VyA+IHRoaXMudG90YWxXaWR0aCA/IHRoaXMudG90YWxXaWR0aCA6IHRoaXMudmlld3BvcnRXO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9mKHsgc2hvdzogdHJ1ZSwgZGF0YTogeyBkYXRhOiByb3dEYXRhLmRhdGEsIGdyaWQ6IHRoaXMuZGd9LCBmb2N1c1RhcmdldFdpZHRoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvZih7IHNob3c6IGZhbHNlIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==