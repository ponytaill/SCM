/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/smarthelp/smarthelp.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
export class SolutionSmartHelpComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        this.mappingEmitter = new EventEmitter();
        /**
         * 每页记录数
         */
        this.pageSize = 20;
        /**
         * 可用分页记录数列表
         */
        this.pageList = [10, 20, 30, 50, 100];
        this.onBeforeOpen = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const t = (/** @type {?} */ (this.item.value));
            if (t && t.value) {
                /** @type {?} */
                const ids = t.value.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.idField || 'id'])).join(',');
                this.lookup.displayValue = ids;
            }
            return of(true);
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.getSmartHelpBindingInfo();
        this.testId = this.solutionService.getGuid();
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.lookup.textChanged.subscribe((/**
         * @param {?} v
         * @return {?}
         */
        (v) => {
            this.textChangedHandler(v);
        }));
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.getSmartHelpBindingInfo();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            const isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            field => field == this.item.fieldCode));
            if (isChange) {
                this.textValue = ((/** @type {?} */ (this.item.value))).textValue;
            }
        }
    }
    //ITEM：
    //control: SmartHelpContol {uri: "WuLiao.wOrgId", textField: "name", valueField: "code", mapFields: {}, idField: "id"}
    // fieldCode: "wOrgId"
    // fieldName: "所属机构"
    // id: "WuLiao.wOrgId"
    // value: SmartHelpValue {valueField: null, value: null}
    // valueType: 0
    /**
     * @return {?}
     */
    getSmartHelpBindingInfo() {
        /** @type {?} */
        const smartHelpControl = ((/** @type {?} */ (this.item.control)));
        this.uri = smartHelpControl.uri;
        this.textField = smartHelpControl.textField;
        this.idField = smartHelpControl.idField;
        this.valueField = smartHelpControl.valueField;
        this.displayType = smartHelpControl.displayType;
        this.mapFields = smartHelpControl.mapFields;
        this.context = smartHelpControl.context;
        this.preEventCmd = smartHelpControl.preEventCmd;
        this.postEventCmd = smartHelpControl.postEventCmd;
        this.enableFullTree = smartHelpControl.enableFullTree;
        this.loadTreeDataType = smartHelpControl.loadTreeDataType;
        this.singleSelect = smartHelpControl.singleSelect === false ? false : true;
        this.expandLevel = smartHelpControl.expandLevel;
        this.enableCascade = smartHelpControl.enableCascade;
        // 标题
        this.dialogTitle = smartHelpControl.dialogTitle ? smartHelpControl.dialogTitle : '';
        // 宽度
        this.dialogWidth = smartHelpControl.panelWidth;
        // 高度
        this.dialogHeight = smartHelpControl.panelHeight;
        /** @type {?} */
        const smartHelpValue = ((/** @type {?} */ (this.item.value)));
        if (smartHelpValue.textValue == 'help-text-value-null') { //旧数据兼容
            this.textValue = smartHelpValue.getTextValue(this.textField);
        }
        else {
            this.textValue = smartHelpValue.textValue;
        }
        this.nosearch = smartHelpControl.nosearch; //默认false
        this.displayFields = smartHelpControl.displayFields ? smartHelpControl.displayFields : '';
        this.displayTextSeparator = smartHelpControl.displayTextSeparator ? smartHelpControl.displayTextSeparator : '_';
        this.editable = smartHelpControl.editable;
        this.clearFields = smartHelpControl.clearFields;
        if (smartHelpControl.hasOwnProperty('pageSize') && smartHelpControl.pageSize) {
            this.pageSize = smartHelpControl.pageSize;
        }
        if (smartHelpControl.hasOwnProperty('pageList') && smartHelpControl.pageList) {
            this.pageList = smartHelpControl.pageList.split(",").map((/**
             * @param {?} item
             * @return {?}
             */
            item => { return parseInt(item); }));
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    clearData(data) {
        ((/** @type {?} */ (this.item.value))).clearValue();
        if (this.item.control.clear) {
            this.item.control.clear();
        }
        this.conditionChange.emit();
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * selectedItem
     * code: "code02"
     * id: "id02"
     * name: "机构02"
     * version: "2019-10-21T00:00:00"
     * @param {?} data
     * @return {?}
     */
    textChangedHandler(data) {
        if (this.item && this.item.value) {
            /** @type {?} */
            const helpValue = ((/** @type {?} */ (this.item.value)));
            helpValue.value = [data];
            helpValue.textValue = data;
            helpValue.isInputText = true;
            // this.textValue = helpValue.textValue;
            this.conditionChange.emit();
        }
    }
    /**
     * @param {?} selectedItem
     * @return {?}
     */
    selectedDataHandler(selectedItem) {
        //选择时触发
        /** @type {?} */
        const helpValue = ((/** @type {?} */ (this.item.value)));
        helpValue.value = this.singleSelect ? [selectedItem] : selectedItem; //单选返回对象，多选返回数组
        helpValue.valueField = this.valueField;
        helpValue.textValue = this.textValue;
        helpValue.isInputText = false;
        this.conditionChange.emit();
    }
}
SolutionSmartHelpComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-smarthelp',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\" >\r\n    <div class=\"form-group farris-form-group common-group\" [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-lookup-grid #lookup\r\n                id=\"{{testId}}\"                \r\n                [clear-fields]=\"clearFields\"\r\n                [uri]=\"uri\"\r\n                [placeholder]=\"placeholder\"\r\n                [(ngModel)]=\"textValue\"\r\n                [textField]=\"textField\"\r\n                [valueField]=\"valueField\"\r\n                [idField]=\"idField\"\r\n                [mapFields]=\"mapFields\"\r\n                [displayType]=\"displayType\"\r\n                [title]=\"dialogTitle\"\r\n                [dialogWidth]=\"dialogWidth\"\r\n                [dialogHeight]=\"dialogHeight\"\r\n                [context]=\"context\"\r\n                [dictPicking]=\"preEventCmd\"\r\n                [dictPicked]=\"postEventCmd\"\r\n                [enableFullTree]=\"enableFullTree\"\r\n                [loadTreeDataType]=\"loadTreeDataType\"\r\n                [singleSelect]=\"singleSelect\"\r\n                [expandLevel]=\"expandLevel\"\r\n                [enableCascade]=\"enableCascade\"\r\n                [readonly]=\"item.readonly\"\r\n                [nosearch]=\"nosearch\"\r\n                [beforeOpen]=\"onBeforeOpen\"\r\n                [displayFields]=\"displayFields\"\r\n                [displayTextSeparator]=\"displayTextSeparator\"\r\n                [editable]=\"editable\"\r\n                [pageSize]=\"pageSize\"\r\n                [pageList]=\"pageList\"\r\n                [useFavorite]=\"true\"\r\n                (selectedData)=\"selectedDataHandler($event)\"\r\n                (clear)=\"clearData($event)\"\r\n            >\r\n        </farris-lookup-grid>\r\n        <!-- [singleSelect]=\"true\" -->\r\n        </div>\r\n\r\n    </div>\r\n</div>"
            }] }
];
/** @nocollapse */
SolutionSmartHelpComponent.ctorParameters = () => [
    { type: SolutionService }
];
SolutionSmartHelpComponent.propDecorators = {
    item: [{ type: Input }],
    changeFields: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }],
    mappingEmitter: [{ type: Output, args: ['helpMapping',] }],
    lookup: [{ type: ViewChild, args: ['lookup',] }]
};
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.item;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.changeFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.conditionChange;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mappingEmitter;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.lookup;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.uri;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mapFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.idField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.valueField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textValue;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.context;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.preEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.postEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.loadTreeDataType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableFullTree;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.singleSelect;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.expandLevel;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableCascade;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.testId;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.placeholder;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.nosearch;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayTextSeparator;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.editable;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.clearFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogTitle;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogWidth;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogHeight;
    /**
     * 每页记录数
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageSize;
    /**
     * 可用分页记录数列表
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageList;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.onBeforeOpen;
    /**
     * @type {?}
     * @private
     */
    SolutionSmartHelpComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic21hcnRoZWxwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uLyIsInNvdXJjZXMiOlsibGliL2NvbnRyb2xjb21wb25lbnQvc21hcnRoZWxwL3NtYXJ0aGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLFlBQVksRUFBWSxTQUFTLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBTTlILE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNqRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBTzFCLE1BQU0sT0FBTywwQkFBMEI7Ozs7SUFtRG5DLFlBQW9CLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjs7OztRQXpDM0MsaUJBQVksR0FBa0IsRUFBRSxDQUFDO1FBRWYsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRXpDLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7OztRQWlDM0QsYUFBUSxHQUFXLEVBQUUsQ0FBQzs7OztRQUV0QixhQUFRLEdBQWtCLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBd0VoRCxpQkFBWTs7O1FBQUcsR0FBRyxFQUFFOztrQkFDVixDQUFDLEdBQUcsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQWtCO1lBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUU7O3NCQUNSLEdBQUcsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUc7Ozs7Z0JBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsRUFBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7Z0JBQy9ELElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxHQUFHLEdBQUcsQ0FBQzthQUNsQztZQUVELE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BCLENBQUMsRUFBQTtJQTlFdUQsQ0FBQzs7OztJQUV6RCxRQUFRO1FBQ0osSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7UUFDL0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzdDLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFdkcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDcEMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9CLENBQUMsRUFBQyxDQUFBO0lBQ04sQ0FBQzs7Ozs7SUFFRCxXQUFXLENBQUMsT0FBc0I7UUFDOUIsSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7UUFDL0IsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUU7O2tCQUNuRyxRQUFRLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJOzs7O1lBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUM7WUFDakcsSUFBSSxRQUFRLEVBQUU7Z0JBQ1YsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLG1CQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFrQixDQUFDLENBQUMsU0FBUyxDQUFDO2FBQ2xFO1NBQ0o7SUFDTCxDQUFDOzs7Ozs7Ozs7OztJQVNELHVCQUF1Qjs7Y0FDYixnQkFBZ0IsR0FBRyxDQUFDLG1CQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFtQixDQUFDO1FBQy9ELElBQUksQ0FBQyxHQUFHLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxDQUFDO1FBQ2hDLElBQUksQ0FBQyxTQUFTLEdBQUcsZ0JBQWdCLENBQUMsU0FBUyxDQUFDO1FBQzVDLElBQUksQ0FBQyxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxVQUFVLEdBQUcsZ0JBQWdCLENBQUMsVUFBVSxDQUFDO1FBQzlDLElBQUksQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDO1FBQ2hELElBQUksQ0FBQyxTQUFTLEdBQUcsZ0JBQWdCLENBQUMsU0FBUyxDQUFDO1FBQzVDLElBQUksQ0FBQyxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDO1FBQ2hELElBQUksQ0FBQyxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsWUFBWSxDQUFDO1FBQ2xELElBQUksQ0FBQyxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsY0FBYyxDQUFDO1FBQ3RELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQztRQUMxRCxJQUFJLENBQUMsWUFBWSxHQUFHLGdCQUFnQixDQUFDLFlBQVksS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQzNFLElBQUksQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDO1FBQ2hELElBQUksQ0FBQyxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsYUFBYSxDQUFDO1FBQ3BELEtBQUs7UUFDTCxJQUFJLENBQUMsV0FBVyxHQUFHLGdCQUFnQixDQUFDLFdBQVcsQ0FBQSxDQUFDLENBQUEsZ0JBQWdCLENBQUMsV0FBVyxDQUFBLENBQUMsQ0FBQSxFQUFFLENBQUM7UUFDaEYsS0FBSztRQUNMLElBQUksQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLENBQUMsVUFBVSxDQUFDO1FBQy9DLEtBQUs7UUFDTCxJQUFJLENBQUMsWUFBWSxHQUFHLGdCQUFnQixDQUFDLFdBQVcsQ0FBQzs7Y0FDM0MsY0FBYyxHQUFHLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQWtCLENBQUM7UUFDMUQsSUFBSSxjQUFjLENBQUMsU0FBUyxJQUFJLHNCQUFzQixFQUFFLEVBQUMsT0FBTztZQUM1RCxJQUFJLENBQUMsU0FBUyxHQUFHLGNBQWMsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQ2hFO2FBQU07WUFDSCxJQUFJLENBQUMsU0FBUyxHQUFHLGNBQWMsQ0FBQyxTQUFTLENBQUM7U0FDN0M7UUFDRCxJQUFJLENBQUMsUUFBUSxHQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFBLFNBQVM7UUFDbkQsSUFBSSxDQUFDLGFBQWEsR0FBRyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQzFGLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxnQkFBZ0IsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUNoSCxJQUFJLENBQUMsUUFBUSxHQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQztRQUMxQyxJQUFJLENBQUMsV0FBVyxHQUFHLGdCQUFnQixDQUFDLFdBQVcsQ0FBQztRQUNoRCxJQUFJLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUU7WUFDMUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUE7U0FDNUM7UUFDRCxJQUFJLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUU7WUFDMUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUc7Ozs7WUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUE7U0FDL0Y7SUFDTCxDQUFDOzs7OztJQVlELFNBQVMsQ0FBQyxJQUFTO1FBQ2YsQ0FBQyxtQkFBQSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBa0IsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ2pELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFO1lBQ3pCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQzdCO1FBQ0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNoQyxDQUFDOzs7OztJQUVELHFCQUFxQixDQUFDLEtBQXFCO1FBQ3ZDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3RCxDQUFDOzs7Ozs7Ozs7O0lBU0Qsa0JBQWtCLENBQUMsSUFBWTtRQUMzQixJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUU7O2tCQUN4QixTQUFTLEdBQUcsQ0FBQyxtQkFBQSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBa0IsQ0FBQztZQUNyRCxTQUFTLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDekIsU0FBUyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7WUFDM0IsU0FBUyxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDN0Isd0NBQXdDO1lBQ3hDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDL0I7SUFDTCxDQUFDOzs7OztJQUVELG1CQUFtQixDQUFDLFlBQWlCOzs7Y0FDM0IsU0FBUyxHQUFHLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQWtCLENBQUM7UUFDckQsU0FBUyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQSxlQUFlO1FBQ25GLFNBQVMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUN2QyxTQUFTLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDckMsU0FBUyxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDOUIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNoQyxDQUFDOzs7WUE3S0osU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSx3QkFBd0I7Z0JBQ2xDLHNzRUFBeUM7YUFDNUM7Ozs7WUFQUSxlQUFlOzs7bUJBY25CLEtBQUs7MkJBS0wsS0FBSzs4QkFFTCxNQUFNLFNBQUMsaUJBQWlCOzZCQUV4QixNQUFNLFNBQUMsYUFBYTtxQkFFcEIsU0FBUyxTQUFDLFFBQVE7Ozs7Ozs7SUFYbkIsMENBQW1COzs7OztJQUtuQixrREFBMEM7O0lBRTFDLHFEQUFnRTs7SUFFaEUsb0RBQTJEOztJQUUzRCw0Q0FBaUQ7O0lBRWpELHlDQUFZOztJQUNaLCtDQUFrQjs7SUFDbEIsK0NBQWU7O0lBQ2YsNkNBQWE7O0lBQ2IsZ0RBQWdCOztJQUNoQiwrQ0FBZTs7SUFDZixpREFBaUI7O0lBQ2pCLDZDQUFhOztJQUNiLGlEQUFpQjs7SUFDakIsa0RBQWtCOztJQUNsQixzREFBeUI7O0lBQ3pCLG9EQUF3Qjs7SUFDeEIsa0RBQXNCOztJQUN0QixpREFBb0I7O0lBQ3BCLG1EQUF1Qjs7SUFDdkIsNENBQWU7O0lBQ2YsaURBQW9COztJQUNwQiw4Q0FBa0I7O0lBQ2xCLG1EQUFzQjs7SUFDdEIsMERBQTZCOztJQUM3Qiw4Q0FBa0I7O0lBQ2xCLGlEQUFvQjs7SUFFcEIsaURBQW9COztJQUVwQixpREFBb0I7O0lBRXBCLGtEQUFxQjs7Ozs7SUFFckIsOENBQXNCOzs7OztJQUV0Qiw4Q0FBZ0Q7O0lBd0VoRCxrREFRQzs7Ozs7SUE5RVcscURBQXdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBPbkNoYW5nZXMsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3RvciwgVmlld0NoaWxkLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3F1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgQ29udHJvbFR5cGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUnO1xyXG5pbXBvcnQgeyBTbWFydEhlbHBDb250b2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvc21hcnRoZWxwL3NtYXJ0aGVscGNvbnRyb2wnO1xyXG5pbXBvcnQgeyBJQ29udHJvbCB9IGZyb20gJy4uLy4uL2VudGl0eS9jb250cm9sdHlwZS9pY29udHJvbCc7XHJcbmltcG9ydCB7IFNtYXJ0SGVscFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL3NtYXJ0aGVscHZhbHVlJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTG9va3VwR3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktbG9va3VwJztcclxuaW1wb3J0IHsgb2YgfSBmcm9tICdyeGpzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdhcHAtc29sdXRpb24tc21hcnRoZWxwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9zbWFydGhlbHAuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFNvbHV0aW9uU21hcnRIZWxwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUXVlcnlDb25kaXRpb27nsbvlnotcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXRlbTogYW55O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+Q5Liq5a2X5q615Y+R55Sf5YC85Y+Y5YyW5LqL5Lu25pe277yM6ZyA6KaB5ZCM5q2l5riF56m655qE5a2X5q6177yM5Y+v6IO95LiN5piv5b2T5YmN5a2X5q61XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNoYW5nZUZpZWxkczogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG5cclxuICAgIEBPdXRwdXQoJ2NvbmRpdGlvbkNoYW5nZScpIGNvbmRpdGlvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCdoZWxwTWFwcGluZycpIG1hcHBpbmdFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2xvb2t1cCcpIGxvb2t1cDogTG9va3VwR3JpZENvbXBvbmVudDtcclxuXHJcbiAgICB1cmk6IHN0cmluZztcclxuICAgIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgbWFwRmllbGRzOiBhbnk7XHJcbiAgICBpZEZpZWxkOiBhbnk7XHJcbiAgICB2YWx1ZUZpZWxkOiBhbnk7XHJcbiAgICB0ZXh0VmFsdWU6IGFueTtcclxuICAgIGRpc3BsYXlUeXBlOiBhbnk7XHJcbiAgICBjb250ZXh0OiBhbnk7XHJcbiAgICBwcmVFdmVudENtZDogYW55O1xyXG4gICAgcG9zdEV2ZW50Q21kOiBhbnk7XHJcbiAgICBsb2FkVHJlZURhdGFUeXBlOiBzdHJpbmc7XHJcbiAgICBlbmFibGVGdWxsVHJlZTogYm9vbGVhbjtcclxuICAgIHNpbmdsZVNlbGVjdDogYm9vbGVhbjtcclxuICAgIGV4cGFuZExldmVsOiBudW1iZXI7XHJcbiAgICBlbmFibGVDYXNjYWRlOiBib29sZWFuO1xyXG4gICAgdGVzdElkOiBzdHJpbmc7XHJcbiAgICBwbGFjZWhvbGRlcjogc3RyaW5nO1xyXG4gICAgbm9zZWFyY2g6IGJvb2xlYW47XHJcbiAgICBkaXNwbGF5RmllbGRzOiBzdHJpbmc7XHJcbiAgICBkaXNwbGF5VGV4dFNlcGFyYXRvcjogc3RyaW5nO1xyXG4gICAgZWRpdGFibGU6IGJvb2xlYW47XHJcbiAgICBjbGVhckZpZWxkczogc3RyaW5nO1xyXG4gICAgLy8g5qCH6aKYXHJcbiAgICBkaWFsb2dUaXRsZTogc3RyaW5nO1xyXG4gICAgLy8g5a695bqmXHJcbiAgICBkaWFsb2dXaWR0aDogbnVtYmVyO1xyXG4gICAgLy8g6auY5bqmXHJcbiAgICBkaWFsb2dIZWlnaHQ6IG51bWJlcjtcclxuICAgIC8qKiDmr4/pobXorrDlvZXmlbAgKi9cclxuICAgIHBhZ2VTaXplOiBudW1iZXIgPSAyMDtcclxuICAgIC8qKiDlj6/nlKjliIbpobXorrDlvZXmlbDliJfooaggKi9cclxuICAgIHBhZ2VMaXN0OiBBcnJheTxudW1iZXI+ID0gWzEwLCAyMCwgMzAsIDUwLCAxMDBdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOiBTb2x1dGlvblNlcnZpY2UpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0U21hcnRIZWxwQmluZGluZ0luZm8oKTtcclxuICAgICAgICB0aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gKHRoaXMuaXRlbS5wbGFjZUhvbGRlcikgPyAodGhpcy5pdGVtLnBsYWNlSG9sZGVyKSA6ICh0aGlzLml0ZW0uY29udHJvbC5wbGFjZWhvbGRlcik7XHJcblxyXG4gICAgICAgIHRoaXMubG9va3VwLnRleHRDaGFuZ2VkLnN1YnNjcmliZSgodikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRleHRDaGFuZ2VkSGFuZGxlcih2KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmdldFNtYXJ0SGVscEJpbmRpbmdJbmZvKCk7XHJcbiAgICAgICAgaWYgKGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddICYmIGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZSAmJiAhY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uZmlyc3RDaGFuZ2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaXNDaGFuZ2UgPSBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUuc29tZShmaWVsZCA9PiBmaWVsZCA9PSB0aGlzLml0ZW0uZmllbGRDb2RlKTtcclxuICAgICAgICAgICAgaWYgKGlzQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWUpLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0lURU3vvJpcclxuICAgIC8vY29udHJvbDogU21hcnRIZWxwQ29udG9sIHt1cmk6IFwiV3VMaWFvLndPcmdJZFwiLCB0ZXh0RmllbGQ6IFwibmFtZVwiLCB2YWx1ZUZpZWxkOiBcImNvZGVcIiwgbWFwRmllbGRzOiB7fSwgaWRGaWVsZDogXCJpZFwifVxyXG4gICAgLy8gZmllbGRDb2RlOiBcIndPcmdJZFwiXHJcbiAgICAvLyBmaWVsZE5hbWU6IFwi5omA5bGe5py65p6EXCJcclxuICAgIC8vIGlkOiBcIld1TGlhby53T3JnSWRcIlxyXG4gICAgLy8gdmFsdWU6IFNtYXJ0SGVscFZhbHVlIHt2YWx1ZUZpZWxkOiBudWxsLCB2YWx1ZTogbnVsbH1cclxuICAgIC8vIHZhbHVlVHlwZTogMFxyXG4gICAgZ2V0U21hcnRIZWxwQmluZGluZ0luZm8oKSB7XHJcbiAgICAgICAgY29uc3Qgc21hcnRIZWxwQ29udHJvbCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBTbWFydEhlbHBDb250b2wpO1xyXG4gICAgICAgIHRoaXMudXJpID0gc21hcnRIZWxwQ29udHJvbC51cmk7XHJcbiAgICAgICAgdGhpcy50ZXh0RmllbGQgPSBzbWFydEhlbHBDb250cm9sLnRleHRGaWVsZDtcclxuICAgICAgICB0aGlzLmlkRmllbGQgPSBzbWFydEhlbHBDb250cm9sLmlkRmllbGQ7XHJcbiAgICAgICAgdGhpcy52YWx1ZUZpZWxkID0gc21hcnRIZWxwQ29udHJvbC52YWx1ZUZpZWxkO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheVR5cGUgPSBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlUeXBlO1xyXG4gICAgICAgIHRoaXMubWFwRmllbGRzID0gc21hcnRIZWxwQ29udHJvbC5tYXBGaWVsZHM7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gc21hcnRIZWxwQ29udHJvbC5jb250ZXh0O1xyXG4gICAgICAgIHRoaXMucHJlRXZlbnRDbWQgPSBzbWFydEhlbHBDb250cm9sLnByZUV2ZW50Q21kO1xyXG4gICAgICAgIHRoaXMucG9zdEV2ZW50Q21kID0gc21hcnRIZWxwQ29udHJvbC5wb3N0RXZlbnRDbWQ7XHJcbiAgICAgICAgdGhpcy5lbmFibGVGdWxsVHJlZSA9IHNtYXJ0SGVscENvbnRyb2wuZW5hYmxlRnVsbFRyZWU7XHJcbiAgICAgICAgdGhpcy5sb2FkVHJlZURhdGFUeXBlID0gc21hcnRIZWxwQ29udHJvbC5sb2FkVHJlZURhdGFUeXBlO1xyXG4gICAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ID0gc21hcnRIZWxwQ29udHJvbC5zaW5nbGVTZWxlY3QgPT09IGZhbHNlID8gZmFsc2UgOiB0cnVlO1xyXG4gICAgICAgIHRoaXMuZXhwYW5kTGV2ZWwgPSBzbWFydEhlbHBDb250cm9sLmV4cGFuZExldmVsO1xyXG4gICAgICAgIHRoaXMuZW5hYmxlQ2FzY2FkZSA9IHNtYXJ0SGVscENvbnRyb2wuZW5hYmxlQ2FzY2FkZTtcclxuICAgICAgICAvLyDmoIfpophcclxuICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gc21hcnRIZWxwQ29udHJvbC5kaWFsb2dUaXRsZT9zbWFydEhlbHBDb250cm9sLmRpYWxvZ1RpdGxlOicnO1xyXG4gICAgICAgIC8vIOWuveW6plxyXG4gICAgICAgIHRoaXMuZGlhbG9nV2lkdGggPSBzbWFydEhlbHBDb250cm9sLnBhbmVsV2lkdGg7XHJcbiAgICAgICAgLy8g6auY5bqmXHJcbiAgICAgICAgdGhpcy5kaWFsb2dIZWlnaHQgPSBzbWFydEhlbHBDb250cm9sLnBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IHNtYXJ0SGVscFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscFZhbHVlLnRleHRWYWx1ZSA9PSAnaGVscC10ZXh0LXZhbHVlLW51bGwnKSB7Ly/ml6fmlbDmja7lhbzlrrlcclxuICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSBzbWFydEhlbHBWYWx1ZS5nZXRUZXh0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dFZhbHVlID0gc21hcnRIZWxwVmFsdWUudGV4dFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vc2VhcmNoID0gc21hcnRIZWxwQ29udHJvbC5ub3NlYXJjaDsvL+m7mOiupGZhbHNlXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5RmllbGRzID0gc21hcnRIZWxwQ29udHJvbC5kaXNwbGF5RmllbGRzID8gc21hcnRIZWxwQ29udHJvbC5kaXNwbGF5RmllbGRzIDogJyc7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5VGV4dFNlcGFyYXRvciA9IHNtYXJ0SGVscENvbnRyb2wuZGlzcGxheVRleHRTZXBhcmF0b3IgPyBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlUZXh0U2VwYXJhdG9yIDogJ18nO1xyXG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBzbWFydEhlbHBDb250cm9sLmVkaXRhYmxlO1xyXG4gICAgICAgIHRoaXMuY2xlYXJGaWVsZHMgPSBzbWFydEhlbHBDb250cm9sLmNsZWFyRmllbGRzO1xyXG4gICAgICAgIGlmIChzbWFydEhlbHBDb250cm9sLmhhc093blByb3BlcnR5KCdwYWdlU2l6ZScpICYmIHNtYXJ0SGVscENvbnRyb2wucGFnZVNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHNtYXJ0SGVscENvbnRyb2wucGFnZVNpemVcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscENvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3BhZ2VMaXN0JykgJiYgc21hcnRIZWxwQ29udHJvbC5wYWdlTGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VMaXN0ID0gc21hcnRIZWxwQ29udHJvbC5wYWdlTGlzdC5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4geyByZXR1cm4gcGFyc2VJbnQoaXRlbSk7IH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQmVmb3JlT3BlbiA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB0ID0gdGhpcy5pdGVtLnZhbHVlIGFzIFNtYXJ0SGVscFZhbHVlO1xyXG4gICAgICAgIGlmICh0ICYmIHQudmFsdWUpIHtcclxuICAgICAgICAgICAgY29uc3QgaWRzID0gdC52YWx1ZS5tYXAobiA9PiBuW3RoaXMuaWRGaWVsZCB8fCAnaWQnXSkuam9pbignLCcpO1xyXG4gICAgICAgICAgICB0aGlzLmxvb2t1cC5kaXNwbGF5VmFsdWUgPSBpZHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJEYXRhKGRhdGE6IGFueSkge1xyXG4gICAgICAgICh0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWUpLmNsZWFyVmFsdWUoKTtcclxuICAgICAgICBpZiAodGhpcy5pdGVtLmNvbnRyb2wuY2xlYXIpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLmNvbnRyb2wuY2xlYXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDogUXVlcnlDb25kaXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIHNlbGVjdGVkSXRlbVxyXG4gICAgICogY29kZTogXCJjb2RlMDJcIlxyXG4gICAgICAgIGlkOiBcImlkMDJcIlxyXG4gICAgICAgIG5hbWU6IFwi5py65p6EMDJcIlxyXG4gICAgICAgIHZlcnNpb246IFwiMjAxOS0xMC0yMVQwMDowMDowMFwiXHJcbiAgICAqL1xyXG4gICAgdGV4dENoYW5nZWRIYW5kbGVyKGRhdGE6IHN0cmluZykgey8v5omL5bel6L6T5YWl5pe26Kem5Y+RXHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbSAmJiB0aGlzLml0ZW0udmFsdWUpIHtcclxuICAgICAgICAgICAgY29uc3QgaGVscFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgICAgIGhlbHBWYWx1ZS52YWx1ZSA9IFtkYXRhXTtcclxuICAgICAgICAgICAgaGVscFZhbHVlLnRleHRWYWx1ZSA9IGRhdGE7XHJcbiAgICAgICAgICAgIGhlbHBWYWx1ZS5pc0lucHV0VGV4dCA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIHRoaXMudGV4dFZhbHVlID0gaGVscFZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RlZERhdGFIYW5kbGVyKHNlbGVjdGVkSXRlbTogYW55KSB7Ly/pgInmi6nml7bop6blj5FcclxuICAgICAgICBjb25zdCBoZWxwVmFsdWUgPSAodGhpcy5pdGVtLnZhbHVlIGFzIFNtYXJ0SGVscFZhbHVlKTtcclxuICAgICAgICBoZWxwVmFsdWUudmFsdWUgPSB0aGlzLnNpbmdsZVNlbGVjdCA/IFtzZWxlY3RlZEl0ZW1dIDogc2VsZWN0ZWRJdGVtOy8v5Y2V6YCJ6L+U5Zue5a+56LGh77yM5aSa6YCJ6L+U5Zue5pWw57uEXHJcbiAgICAgICAgaGVscFZhbHVlLnZhbHVlRmllbGQgPSB0aGlzLnZhbHVlRmllbGQ7XHJcbiAgICAgICAgaGVscFZhbHVlLnRleHRWYWx1ZSA9IHRoaXMudGV4dFZhbHVlO1xyXG4gICAgICAgIGhlbHBWYWx1ZS5pc0lucHV0VGV4dCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICAgIH1cclxufSJdfQ==