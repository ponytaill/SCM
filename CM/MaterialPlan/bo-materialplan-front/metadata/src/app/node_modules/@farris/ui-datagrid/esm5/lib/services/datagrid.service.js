/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Utils } from './../utils/utils';
import { EventEmitter } from '@angular/core';
import { Subject, BehaviorSubject } from 'rxjs';
import { filter, map, debounceTime } from 'rxjs/operators';
import { IdService } from '@farris/ui-common';
var DatagridService = /** @class */ (function () {
    function DatagridService() {
        this.scorllSubject = new Subject();
        this.scrollX = new BehaviorSubject(0);
        this.rowHoverSubject = new Subject();
        this.rowSelectSubject = new Subject();
        this.dataSourceChangedSubject = new Subject();
        /**
         * 编辑单元格
         */
        this.editCellSubject = new Subject();
        /**
         * 选中单元格
         */
        this.selectCellSubject = new Subject();
        /**
         * 结束单元编辑
         */
        this.endCellEdit = new Subject();
        this.changeCheckedRows = new Subject();
        /**
         * 结束行编辑
         */
        // private endRowEdit = new BehaviorSubject(true);
        this.scorll$ = this.scorllSubject.asObservable();
        this.scrollX$ = this.scorll$.pipe(filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return p.type === 'psScrollX'; })), map((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return t.x; })), debounceTime(50));
        this.scrollY$ = this.scorll$.pipe(filter((/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return p.type === 'psScrollY'; })), map((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return t.x; })), debounceTime(50));
        this.rowHover$ = this.rowHoverSubject.asObservable();
        this.rowClick$ = this.rowSelectSubject.asObservable();
        this.onDataSourceChange = this.dataSourceChangedSubject.asObservable();
        this.cellEdit$ = this.editCellSubject.asObservable();
        this.endCellEdit$ = this.endCellEdit.asObservable();
        this.checkedRowsTotalChanged$ = this.changeCheckedRows.asObservable();
        this.updateEmptyStyle$ = new EventEmitter();
        this.showGridHeader = new EventEmitter();
        // 取消全选
        this.uncheckAll = new EventEmitter();
        // 全部选中
        this.checkAll = new EventEmitter();
        this.columnResized = new EventEmitter();
        this.rowHeightChanged = new EventEmitter();
        this.loadVirtualData = new EventEmitter();
        /**
         * 显示固定列隐影
         */
        this.showFixedShadow = new EventEmitter();
        // public endRowEdit$ = this.endRowEdit.asObservable();
        this.setSelecedRow = new EventEmitter();
        this.setCheckedRows = new EventEmitter();
        this.scrollToCurrentRow = new EventEmitter();
        this.columnsChanged = new EventEmitter();
        this.cellContentWrapChanged = new EventEmitter();
        this.onFilterChanged = new EventEmitter();
        this.clearFilter = new EventEmitter();
        this.filterTextChange = new EventEmitter();
        this.toggleFilterRow = new EventEmitter();
        this.refreshFooterData = new EventEmitter();
        this.disableHeader = new EventEmitter();
        /**
         * 更新全选复选框状态
         */
        this.changeCheckAllStatus = new EventEmitter();
        this.setScrollbarPosition = new EventEmitter();
        this.smartFilterBarExpand = new EventEmitter();
        this.smartFilterDataChange = new EventEmitter();
        this.scrollbarUpdate = new EventEmitter();
        this.footerPositionChanged = new EventEmitter();
        this.styleElement = null;
        this.commonUtils = null;
        this.idService = null;
        // 单元格编辑器创建完成
        this.cellEditorCreated = new EventEmitter();
        // 单元格编辑器销毁
        this.cellEditorDestory = new EventEmitter();
        // 焦点行切换
        this.focusRowChanged = new EventEmitter();
        this.toggleGroupRow$ = new EventEmitter();
        this.toggleAllGroupRows$ = new EventEmitter();
        this.groupBy = (/**
         * @param {?} arr
         * @param {?} fn
         * @return {?}
         */
        function (arr, fn) { return arr.map(typeof fn === 'function' ? fn : (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { return Utils.getValue(fn, val); })).reduce((/**
         * @param {?} acc
         * @param {?} val
         * @param {?} i
         * @return {?}
         */
        function (acc, val, i) {
            acc[val] = (acc[val] || []).concat(arr[i]);
            return acc;
        }), {}); });
    }
    /**
     * @param {?} x
     * @param {?} action
     * @return {?}
     */
    DatagridService.prototype.onScrollMove = /**
     * @param {?} x
     * @param {?} action
     * @return {?}
     */
    function (x, action) {
        this.scorllSubject.next({ x: x, type: action });
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.dataSourceChanged = /**
     * @return {?}
     */
    function () {
        this.dataSourceChangedSubject.next();
    };
    /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @param {?} mouseEnter
     * @return {?}
     */
    DatagridService.prototype.onRowHover = /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @param {?} mouseEnter
     * @return {?}
     */
    function (rowIndex, rowData, mouseEnter) {
        this.rowHoverSubject.next({ index: rowIndex, data: rowData, mouseenter: mouseEnter });
    };
    /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @return {?}
     */
    DatagridService.prototype.onRowClick = /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @return {?}
     */
    function (rowIndex, rowData) {
        this.rowSelectSubject.next({ index: rowIndex, data: rowData });
    };
    /**
     * @param {?} tdElement
     * @return {?}
     */
    DatagridService.prototype.onCellEdit = /**
     * @param {?} tdElement
     * @return {?}
     */
    function (tdElement) {
        this.editCellSubject.next(tdElement);
    };
    /**
     * @param {?} cell
     * @return {?}
     */
    DatagridService.prototype.onEndCellEdit = /**
     * @param {?} cell
     * @return {?}
     */
    function (cell) {
        this.endCellEdit.next(cell);
    };
    /**
     * @param {?} cell
     * @return {?}
     */
    DatagridService.prototype.onSelectCell = /**
     * @param {?} cell
     * @return {?}
     */
    function (cell) {
        this.selectCellSubject.next(cell);
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.onCheckedRowsCountChange = /**
     * @return {?}
     */
    function () {
        this.changeCheckedRows.next();
    };
    /**
     * @param {?} rowHeight
     * @return {?}
     */
    DatagridService.prototype.onRowHeightChange = /**
     * @param {?} rowHeight
     * @return {?}
     */
    function (rowHeight) {
        this.rowHeightChanged.emit(rowHeight);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    DatagridService.prototype.onLoadVirtualData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.loadVirtualData.emit({ data: data });
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.onClearFilter = /**
     * @return {?}
     */
    function () {
        this.clearFilter.emit();
        this.filterTextChange.emit('');
    };
    /**
     * @param {?} txt
     * @return {?}
     */
    DatagridService.prototype.onFilterTextChange = /**
     * @param {?} txt
     * @return {?}
     */
    function (txt) {
        this.filterTextChange.emit(txt);
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.restoreScrollbarPosition = /**
     * @return {?}
     */
    function () {
        this.setScrollbarPosition.emit();
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.updateEmptyStyle = /**
     * @return {?}
     */
    function () {
        this.updateEmptyStyle$.emit();
    };
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    DatagridService.prototype.getMergeCellInfo = /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    function (data, mergeFields) {
        /** @type {?} */
        var result = {};
        /** @type {?} */
        var firstVal = null;
        /** @type {?} */
        var currVal;
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        function (f, i) {
            if (i === 0) {
                data.forEach((/**
                 * @param {?} d
                 * @param {?} j
                 * @return {?}
                 */
                function (d, j) {
                    var _a;
                    /** @type {?} */
                    var item = (_a = {}, _a[f] = { show: true, rowspan: 1 }, _a);
                    if (!result[j]) {
                        result[j] = item;
                    }
                    else {
                        if (!result[j][f]) {
                            result[j] = Object.assign(result[j], item);
                        }
                    }
                    /** @type {?} */
                    var _item = result[j];
                    currVal = d[f];
                    if (firstVal === null || firstVal !== currVal) {
                        firstVal = currVal;
                        _item[f].show = true;
                        _item[f].startIndex = j;
                    }
                    else {
                        /** @type {?} */
                        var strIndex = result[j - 1][f].startIndex;
                        _item[f].startIndex = strIndex;
                        _item[f].show = false;
                        result[strIndex][f].rowspan++;
                    }
                }));
            }
        }));
        return result;
    };
    /**
     * @param {?} data
     * @param {?} field
     * @return {?}
     */
    DatagridService.prototype.getMergeCellInfo0 = /**
     * @param {?} data
     * @param {?} field
     * @return {?}
     */
    function (data, field) {
        /** @type {?} */
        var result = {};
        /** @type {?} */
        var firstVal;
        /** @type {?} */
        var currVal;
        data.forEach((/**
         * @param {?} d
         * @param {?} j
         * @return {?}
         */
        function (d, j) {
            var _a;
            /** @type {?} */
            var item = (_a = {}, _a[field] = { show: true, rowspan: 1, value: '' }, _a);
            if (!result[j]) {
                result[j] = item;
            }
            /** @type {?} */
            var _item = result[j];
            currVal = Utils.getValue(field, d);
            _item[field].value = currVal;
            if (firstVal === undefined || firstVal !== currVal) {
                firstVal = currVal;
                _item[field].show = true;
                _item[field].startIndex = j;
            }
            else {
                /** @type {?} */
                var strIndex = result[j - 1][field].startIndex;
                _item[field].startIndex = strIndex;
                _item[field].show = false;
                result[strIndex][field].rowspan++;
            }
        }));
        return result;
    };
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    DatagridService.prototype.getMergeCellInfo2 = /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    function (data, mergeFields) {
        /** @type {?} */
        var result = {};
        /** @type {?} */
        var firstVal = null;
        result = this.getMergeCellInfo0(data, mergeFields.splice(0, 1)[0]);
        /** @type {?} */
        var groupData = this.groupBy(data, mergeFields[0]);
        /** @type {?} */
        var groupKeys = Object.keys(groupData);
        /** @type {?} */
        var startRowIndex = 0;
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        function (f, i) {
            groupKeys.forEach((/**
             * @param {?} k
             * @param {?} j
             * @return {?}
             */
            function (k, j) {
                /** @type {?} */
                var currVal;
                groupData[k].forEach((/**
                 * @param {?} d
                 * @param {?} n
                 * @return {?}
                 */
                function (d, n) {
                    var _a;
                    if (result[startRowIndex] && !result[startRowIndex][f]) {
                        result[startRowIndex] = Object.assign(result[startRowIndex], (_a = {}, _a[f] = { show: true, rowspan: 1, value: '' }, _a));
                    }
                    /** @type {?} */
                    var _item = result[startRowIndex];
                    currVal = Utils.getValue(f, d);
                    _item[f].value = currVal;
                    if (firstVal === null || firstVal !== currVal) {
                        firstVal = currVal;
                        _item[f].show = true;
                        _item[f].startIndex = startRowIndex;
                    }
                    else {
                        /** @type {?} */
                        var strIndex = result[startRowIndex - 1][f].startIndex;
                        _item[f].startIndex = strIndex;
                        _item[f].show = false;
                        result[strIndex][f].rowspan++;
                    }
                    startRowIndex++;
                }));
            }));
        }));
        return result;
    };
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    DatagridService.prototype.getMergeCellInfo3 = /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    function (data, mergeFields) {
        /** @type {?} */
        var result = {};
        /** @type {?} */
        var firstField = mergeFields.splice(0, 1)[0];
        result = this.getMergeCellInfo0(data, firstField);
        /** @type {?} */
        var prevGroupField = firstField;
        // const groupData = this.groupBy(data, firstField);
        // const groupKeys = Object.keys(groupData);
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        function (f, i) {
            /** @type {?} */
            var startRowIndex = 0;
            /** @type {?} */
            var firstVal;
            /** @type {?} */
            var currVal;
            if (i > 0) {
                prevGroupField = mergeFields[i - 1];
            }
            data.forEach((/**
             * @param {?} d
             * @param {?} n
             * @return {?}
             */
            function (d, n) {
                var _a;
                if (result[startRowIndex] && !result[startRowIndex][f]) {
                    result[startRowIndex] = Object.assign(result[startRowIndex], (_a = {}, _a[f] = { show: true, rowspan: 1, value: '' }, _a));
                }
                /** @type {?} */
                var _item = result[startRowIndex];
                currVal = Utils.getValue(f, d);
                _item[f].value = currVal;
                if (startRowIndex > 0) {
                    /** @type {?} */
                    var prevItem_1 = result[startRowIndex - 1];
                    /** @type {?} */
                    var _c = Object.keys(_item).map((/**
                     * @param {?} c
                     * @return {?}
                     */
                    function (c) { return '' + _item[c].value; })).join(',');
                    /** @type {?} */
                    var _p = Object.keys(prevItem_1).map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    function (p) { return '' + prevItem_1[p].value; })).join(',');
                    if (_c !== _p) {
                        firstVal = undefined;
                    }
                }
                if ((firstVal === undefined || firstVal !== currVal)) {
                    firstVal = currVal;
                    _item[f].show = true;
                    _item[f].startIndex = startRowIndex;
                }
                else {
                    /** @type {?} */
                    var startIndex = result[startRowIndex - 1][f].startIndex;
                    _item[f].startIndex = startIndex;
                    _item[f].show = false;
                    result[startIndex][f].rowspan++;
                }
                if (data.length - 1 > startRowIndex) {
                    startRowIndex++;
                }
            }));
        }));
        return result;
    };
    /**
     * @param {?} rowIndex
     * @param {?} field
     * @param {?} mergeCellInfo
     * @return {?}
     */
    DatagridService.prototype.getMergeInfo = /**
     * @param {?} rowIndex
     * @param {?} field
     * @param {?} mergeCellInfo
     * @return {?}
     */
    function (rowIndex, field, mergeCellInfo) {
        if (field && mergeCellInfo && mergeCellInfo[rowIndex] && mergeCellInfo[rowIndex][field]) {
            return mergeCellInfo[rowIndex][field];
        }
        return null;
    };
    /**
     * @return {?}
     */
    DatagridService.prototype.removeStyleSheet = /**
     * @return {?}
     */
    function () {
        if (this.styleElement) {
            // const styleText: any = document.querySelector('#'+this.styleElement.id+'_styles');
            // if (styleText) {
            //     styleText.remove();
            // }
            this.styleElement.remove();
            this.styleElement = null;
        }
    };
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    DatagridService.prototype.createStyleElement = /**
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        this.styleElement = this._createStyleSheet(styleSheetId);
    };
    // private APPEND_STYLE_ELEMENT_TIMER = null;
    // private APPEND_STYLE_ELEMENT_TIMER = null;
    /**
     * @param {?} rules
     * @return {?}
     */
    DatagridService.prototype.appendCssRules = 
    // private APPEND_STYLE_ELEMENT_TIMER = null;
    /**
     * @param {?} rules
     * @return {?}
     */
    function (rules) {
        if (this.styleElement) {
            this._appendCssRules(rules, this.styleElement.sheet);
            // const CSSTEXT = this._appendCssRules(rules, this.styleElement.sheet);
            // const id = this.styleElement.id;
            // let style = document.querySelector('#' + id + '_styles')
            // if (!style) {
            //     style = document.createElement('style');
            //     style.id = id+'_styles';
            // }
            // style.innerHTML = style.innerHTML.replace(CSSTEXT, '') + CSSTEXT;
            // document.querySelector('head').appendChild(style);
            // if (this.APPEND_STYLE_ELEMENT_TIMER) {
            //     clearTimeout(this.APPEND_STYLE_ELEMENT_TIMER);
            // }
            // this.APPEND_STYLE_ELEMENT_TIMER = setTimeout(() => {
            // }, 100);
        }
    };
    /**
     * @param {?} ruleName
     * @return {?}
     */
    DatagridService.prototype.removeCssRule = /**
     * @param {?} ruleName
     * @return {?}
     */
    function (ruleName) {
        var _this = this;
        if (this.styleElement) {
            if (typeof ruleName === 'string') {
                this._removeCssRule(ruleName, this.styleElement.sheet);
            }
            else {
                if (Array.isArray(ruleName)) {
                    ruleName.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) {
                        _this._removeCssRule(n, _this.styleElement.sheet);
                    }));
                }
            }
        }
    };
    /**
     * @private
     * @param {?} styleSheetId
     * @return {?}
     */
    DatagridService.prototype._createStyleSheet = /**
     * @private
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        /** @type {?} */
        var htmlHead = document.querySelector('head');
        /** @type {?} */
        var styleEleId = styleSheetId;
        /** @type {?} */
        var styleElement = null;
        if (document.querySelector('#' + styleEleId)) {
            styleElement = document.querySelector('#' + styleEleId);
            styleElement.innerText = '';
        }
        else {
            styleElement = document.createElement('style');
            styleElement.id = styleEleId;
            styleElement.type = 'text/css';
            // styleElement.sheet = new CSSStyleSheet();
            htmlHead.appendChild(styleElement);
        }
        return styleElement;
    };
    /**
     * @private
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    DatagridService.prototype._appendCssRules = /**
     * @private
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    function (rules, styleSheet) {
        var e_1, _a;
        /** @type {?} */
        var allCssText = '';
        try {
            for (var rules_1 = tslib_1.__values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                var rule = rules_1_1.value;
                /** @type {?} */
                var ruleName = rule.slice(0, rule.indexOf('{')).trim();
                /** @type {?} */
                var removedCssRule = this._removeCssRule(ruleName, styleSheet);
                /** @type {?} */
                var cssText = '';
                if (removedCssRule) {
                    cssText += removedCssRule.cssText.slice(removedCssRule.cssText.indexOf('{') + 1, removedCssRule.cssText.indexOf('}'));
                }
                cssText += rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
                /** @type {?} */
                var _newRule = ruleName + "{ " + cssText + " }";
                allCssText += _newRule;
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return allCssText;
    };
    /**
     * @private
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    DatagridService.prototype._removeCssRule = /**
     * @private
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    function (ruleName, styleSheet) {
        if (!styleSheet) {
            return;
        }
        /** @type {?} */
        var cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        var ii = 0;
        /** @type {?} */
        var cssRule = false;
        do {
            cssRule = cssRules[ii];
            if (cssRule) {
                if (cssRule.selectorText.toLowerCase() == ruleName.toLowerCase()) {
                    if (styleSheet.cssRules) {
                        styleSheet.deleteRule(ii);
                    }
                    else {
                        styleSheet.removeRule(ii);
                    }
                    return cssRule;
                }
            }
            ii++;
        } while (cssRule);
    };
    /**
     * @param {?} gridID
     * @return {?}
     */
    DatagridService.prototype.createConfigKey = /**
     * @param {?} gridID
     * @return {?}
     */
    function (gridID) {
        var host = location.host, hash = location.hash, href = location.href, pathname = location.pathname;
        /** @type {?} */
        var formCode = '';
        /** @type {?} */
        var menuId = '';
        if (hash) {
            /** @type {?} */
            var _searchArr = hash.split('?');
            formCode = _searchArr[0];
            /** @type {?} */
            var searchObj_1 = {};
            if (_searchArr[1]) {
                _searchArr[1].split('&').map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    searchObj_1[n.split('=')[0]] = n.split('=')[1];
                }));
            }
            /** @type {?} */
            var catchFuncIdKEY = "" + pathname;
            if (searchObj_1 && Object.keys(searchObj_1).length) {
                menuId = searchObj_1.funcId || '';
                if (menuId) {
                    localStorage.setItem(catchFuncIdKEY, menuId);
                }
            }
            if (!menuId) {
                menuId = localStorage.getItem(catchFuncIdKEY);
            }
        }
        /** @type {?} */
        var key = formCode + '_' + menuId + '_' + gridID;
        if (!this.idService) {
            this.idService = new IdService();
        }
        return this.idService.encrypt(key);
    };
    /**
     * @param {?} styler
     * @param {?} args
     * @return {?}
     */
    DatagridService.prototype.getCustomStyle = /**
     * @param {?} styler
     * @param {?} args
     * @return {?}
     */
    function (styler, args) {
        if (typeof styler === 'object') {
            return styler;
        }
        else {
            if (typeof styler === 'function') {
                /** @type {?} */
                var p = args || [];
                return styler.apply(void 0, tslib_1.__spread(p));
            }
        }
    };
    /**
     * @param {?} nextTr
     * @param {?} dir
     * @return {?}
     */
    DatagridService.prototype.findNextTr = /**
     * @param {?} nextTr
     * @param {?} dir
     * @return {?}
     */
    function (nextTr, dir) {
        /** @type {?} */
        var getNextElement = (/**
         * @param {?} target
         * @return {?}
         */
        function (target) {
            if (target && target.className.indexOf('f-datagrid-disable-row') == -1) {
                return target;
            }
            return false;
        });
        /** @type {?} */
        var m = dir === 'down' ? 'nextElementSibling' : 'previousElementSibling';
        /** @type {?} */
        var getEle = (/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            /** @type {?} */
            var n = null;
            /** @type {?} */
            var next = true;
            while (next) {
                n = getNextElement(t);
                if (n) {
                    next = false;
                }
                else {
                    if (t && t[m]) {
                        n = getNextElement(t[m]);
                        if (n) {
                            break;
                        }
                    }
                    else {
                        next = false;
                    }
                }
            }
            return n;
        });
        return getEle(nextTr);
    };
    return DatagridService;
}());
export { DatagridService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.scorllSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.scrollX;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.rowHoverSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.rowSelectSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.dataSourceChangedSubject;
    /**
     * 编辑单元格
     * @type {?}
     * @private
     */
    DatagridService.prototype.editCellSubject;
    /**
     * 选中单元格
     * @type {?}
     * @private
     */
    DatagridService.prototype.selectCellSubject;
    /**
     * 结束单元编辑
     * @type {?}
     * @private
     */
    DatagridService.prototype.endCellEdit;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.changeCheckedRows;
    /**
     * 结束行编辑
     * @type {?}
     */
    DatagridService.prototype.scorll$;
    /** @type {?} */
    DatagridService.prototype.scrollX$;
    /** @type {?} */
    DatagridService.prototype.scrollY$;
    /** @type {?} */
    DatagridService.prototype.rowHover$;
    /** @type {?} */
    DatagridService.prototype.rowClick$;
    /** @type {?} */
    DatagridService.prototype.onDataSourceChange;
    /** @type {?} */
    DatagridService.prototype.cellEdit$;
    /** @type {?} */
    DatagridService.prototype.endCellEdit$;
    /** @type {?} */
    DatagridService.prototype.checkedRowsTotalChanged$;
    /** @type {?} */
    DatagridService.prototype.updateEmptyStyle$;
    /** @type {?} */
    DatagridService.prototype.showGridHeader;
    /** @type {?} */
    DatagridService.prototype.uncheckAll;
    /** @type {?} */
    DatagridService.prototype.checkAll;
    /** @type {?} */
    DatagridService.prototype.columnResized;
    /** @type {?} */
    DatagridService.prototype.rowHeightChanged;
    /** @type {?} */
    DatagridService.prototype.loadVirtualData;
    /**
     * 显示固定列隐影
     * @type {?}
     */
    DatagridService.prototype.showFixedShadow;
    /** @type {?} */
    DatagridService.prototype.setSelecedRow;
    /** @type {?} */
    DatagridService.prototype.setCheckedRows;
    /** @type {?} */
    DatagridService.prototype.scrollToCurrentRow;
    /** @type {?} */
    DatagridService.prototype.columnsChanged;
    /** @type {?} */
    DatagridService.prototype.cellContentWrapChanged;
    /** @type {?} */
    DatagridService.prototype.onFilterChanged;
    /** @type {?} */
    DatagridService.prototype.clearFilter;
    /** @type {?} */
    DatagridService.prototype.filterTextChange;
    /** @type {?} */
    DatagridService.prototype.toggleFilterRow;
    /** @type {?} */
    DatagridService.prototype.refreshFooterData;
    /** @type {?} */
    DatagridService.prototype.disableHeader;
    /**
     * 更新全选复选框状态
     * @type {?}
     */
    DatagridService.prototype.changeCheckAllStatus;
    /** @type {?} */
    DatagridService.prototype.setScrollbarPosition;
    /** @type {?} */
    DatagridService.prototype.smartFilterBarExpand;
    /** @type {?} */
    DatagridService.prototype.smartFilterDataChange;
    /** @type {?} */
    DatagridService.prototype.scrollbarUpdate;
    /** @type {?} */
    DatagridService.prototype.footerPositionChanged;
    /** @type {?} */
    DatagridService.prototype.styleElement;
    /** @type {?} */
    DatagridService.prototype.commonUtils;
    /** @type {?} */
    DatagridService.prototype.idService;
    /** @type {?} */
    DatagridService.prototype.cellEditorCreated;
    /** @type {?} */
    DatagridService.prototype.cellEditorDestory;
    /** @type {?} */
    DatagridService.prototype.focusRowChanged;
    /** @type {?} */
    DatagridService.prototype.toggleGroupRow$;
    /** @type {?} */
    DatagridService.prototype.toggleAllGroupRows$;
    /** @type {?} */
    DatagridService.prototype.groupBy;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvZGF0YWdyaWQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN6QyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBVzdDLE9BQU8sRUFBRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRWhELE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNELE9BQU8sRUFBZSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQWMzRDtJQWlHSTtRQWhHUSxrQkFBYSxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7UUFDOUIsWUFBTyxHQUFHLElBQUksZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWpDLG9CQUFlLEdBQUcsSUFBSSxPQUFPLEVBQXNCLENBQUM7UUFDcEQscUJBQWdCLEdBQUcsSUFBSSxPQUFPLEVBQStCLENBQUM7UUFFOUQsNkJBQXdCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQzs7OztRQUV6QyxvQkFBZSxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7Ozs7UUFFaEMsc0JBQWlCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQzs7OztRQUVsQyxnQkFBVyxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7UUFDNUIsc0JBQWlCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQzs7Ozs7UUFJbkMsWUFBTyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDNUMsYUFBUSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUMvQixNQUFNOzs7O1FBQUMsVUFBQyxDQUFNLElBQUssT0FB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Q0FBNEM7O0lBRzVDLHdDQUEwQzs7SUFDMUMseUNBQTJDOztJQUUzQyw2Q0FBK0M7O0lBRS9DLHlDQUEyQzs7SUFFM0MsaURBQW1EOztJQUVuRCwwQ0FBNEM7O0lBQzVDLHNDQUF3Qzs7SUFDeEMsMkNBQTZDOztJQUM3QywwQ0FBNEM7O0lBRTVDLDRDQUE4Qzs7SUFFOUMsd0NBQTBDOzs7OztJQUUxQywrQ0FBaUQ7O0lBRWpELCtDQUFpRDs7SUFFakQsK0NBQWlEOztJQUNqRCxnREFBa0Q7O0lBRWxELDBDQUE0Qzs7SUFFNUMsZ0RBQTJDOztJQUUzQyx1Q0FBc0M7O0lBQ3RDLHNDQUFnQzs7SUFFaEMsb0NBQTRCOztJQUc1Qiw0Q0FBdUM7O0lBRXZDLDRDQUF1Qzs7SUFFdkMsMENBQXFDOztJQUdyQywwQ0FBaUY7O0lBQ2pGLDhDQUE2RDs7SUE2RDdELGtDQUdNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVXRpbHMgfSBmcm9tICcuLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMDYgMDc6NDM6NTNcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMDkgMjA6NDQ6NTRcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IENlbGxJbmZvIH0gZnJvbSAnLi9zdGF0ZSc7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgU3ViamVjdCwgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFJvd0V2ZW50UGFyYW0sIFJvd0hvdmVyRXZlbnRQYXJhbSB9IGZyb20gJy4uL3R5cGVzL2V2ZW50LXBhcmFtcyc7XHJcbmltcG9ydCB7IGZpbHRlciwgbWFwLCBkZWJvdW5jZVRpbWUgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzLCBJZFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcblxyXG5leHBvcnQgdHlwZSBTY3JvbGxBY3Rpb24gPVxyXG4gICAgfCAncHNTY3JvbGxZJ1xyXG4gICAgfCAncHNTY3JvbGxYJ1xyXG4gICAgfCAncHNTY3JvbGxVcCdcclxuICAgIHwgJ3BzU2Nyb2xsRG93bidcclxuICAgIHwgJ3BzU2Nyb2xsTGVmdCdcclxuICAgIHwgJ3BzU2Nyb2xsUmlnaHQnXHJcbiAgICB8ICdwc1lSZWFjaEVuZCdcclxuICAgIHwgJ3BzWVJlYWNoU3RhcnQnXHJcbiAgICB8ICdwc1hSZWFjaEVuZCdcclxuICAgIHwgJ3BzWFJlYWNoU3RhcnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIERhdGFncmlkU2VydmljZSB7XHJcbiAgICBwcml2YXRlIHNjb3JsbFN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgcHJpdmF0ZSBzY3JvbGxYID0gbmV3IEJlaGF2aW9yU3ViamVjdCgwKTtcclxuXHJcbiAgICBwcml2YXRlIHJvd0hvdmVyU3ViamVjdCA9IG5ldyBTdWJqZWN0PFJvd0hvdmVyRXZlbnRQYXJhbT4oKTtcclxuICAgIHByaXZhdGUgcm93U2VsZWN0U3ViamVjdCA9IG5ldyBTdWJqZWN0PFBhcnRpYWw8Um93SG92ZXJFdmVudFBhcmFtPj4oKTtcclxuXHJcbiAgICBwcml2YXRlIGRhdGFTb3VyY2VDaGFuZ2VkU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAvKiog57yW6L6R5Y2V5YWD5qC8ICovXHJcbiAgICBwcml2YXRlIGVkaXRDZWxsU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAvKiog6YCJ5Lit5Y2V5YWD5qC8ICovXHJcbiAgICBwcml2YXRlIHNlbGVjdENlbGxTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIC8qKiDnu5PmnZ/ljZXlhYPnvJbovpEgKi9cclxuICAgIHByaXZhdGUgZW5kQ2VsbEVkaXQgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgcHJpdmF0ZSBjaGFuZ2VDaGVja2VkUm93cyA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAvKiog57uT5p2f6KGM57yW6L6RICovXHJcbiAgICAvLyBwcml2YXRlIGVuZFJvd0VkaXQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHRydWUpO1xyXG5cclxuICAgIHB1YmxpYyBzY29ybGwkID0gdGhpcy5zY29ybGxTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgcHVibGljIHNjcm9sbFgkID0gdGhpcy5zY29ybGwkLnBpcGUoXHJcbiAgICAgICAgZmlsdGVyKChwOiBhbnkpID0+IHAudHlwZSA9PT0gJ3BzU2Nyb2xsWCcpLFxyXG4gICAgICAgIG1hcCh0ID0+IHQueCksXHJcbiAgICAgICAgZGVib3VuY2VUaW1lKDUwKVxyXG4gICAgKTtcclxuICAgIHB1YmxpYyBzY3JvbGxZJCA9IHRoaXMuc2NvcmxsJC5waXBlKFxyXG4gICAgICAgIGZpbHRlcigocDogYW55KSA9PiBwLnR5cGUgPT09ICdwc1Njcm9sbFknKSxcclxuICAgICAgICBtYXAodCA9PiB0LngpLFxyXG4gICAgICAgIGRlYm91bmNlVGltZSg1MClcclxuICAgICk7XHJcbiAgICBwdWJsaWMgcm93SG92ZXIkID0gdGhpcy5yb3dIb3ZlclN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgcm93Q2xpY2skID0gdGhpcy5yb3dTZWxlY3RTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgcHVibGljIG9uRGF0YVNvdXJjZUNoYW5nZSA9IHRoaXMuZGF0YVNvdXJjZUNoYW5nZWRTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgcHVibGljIGNlbGxFZGl0JCA9IHRoaXMuZWRpdENlbGxTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgcHVibGljIGVuZENlbGxFZGl0JCA9IHRoaXMuZW5kQ2VsbEVkaXQuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgY2hlY2tlZFJvd3NUb3RhbENoYW5nZWQkID0gdGhpcy5jaGFuZ2VDaGVja2VkUm93cy5hc09ic2VydmFibGUoKTtcclxuICAgIHB1YmxpYyB1cGRhdGVFbXB0eVN0eWxlJCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgc2hvd0dyaWRIZWFkZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvLyDlj5bmtojlhajpgIlcclxuICAgIHB1YmxpYyB1bmNoZWNrQWxsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLy8g5YWo6YOo6YCJ5LitXHJcbiAgICBwdWJsaWMgY2hlY2tBbGwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIGNvbHVtblJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIHJvd0hlaWdodENoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIGxvYWRWaXJ0dWFsRGF0YSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDmmL7npLrlm7rlrprliJfpmpDlvbEgKi9cclxuICAgIHB1YmxpYyBzaG93Rml4ZWRTaGFkb3cgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvLyBwdWJsaWMgZW5kUm93RWRpdCQgPSB0aGlzLmVuZFJvd0VkaXQuYXNPYnNlcnZhYmxlKCk7XHJcblxyXG4gICAgcHVibGljIHNldFNlbGVjZWRSb3cgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBwdWJsaWMgc2V0Q2hlY2tlZFJvd3MgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIHNjcm9sbFRvQ3VycmVudFJvdyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgY29sdW1uc0NoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIGNlbGxDb250ZW50V3JhcENoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIG9uRmlsdGVyQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIHB1YmxpYyBjbGVhckZpbHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIHB1YmxpYyBmaWx0ZXJUZXh0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgcHVibGljIHRvZ2dsZUZpbHRlclJvdyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgcmVmcmVzaEZvb3RlckRhdGEgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIGRpc2FibGVIZWFkZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5pu05paw5YWo6YCJ5aSN6YCJ5qGG54q25oCBICovXHJcbiAgICBwdWJsaWMgY2hhbmdlQ2hlY2tBbGxTdGF0dXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIHNldFNjcm9sbGJhclBvc2l0aW9uID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHB1YmxpYyBzbWFydEZpbHRlckJhckV4cGFuZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIHB1YmxpYyBzbWFydEZpbHRlckRhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIHNjcm9sbGJhclVwZGF0ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBmb290ZXJQb3NpdGlvbkNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgc3R5bGVFbGVtZW50OiBIVE1MU3R5bGVFbGVtZW50ID0gbnVsbDtcclxuICAgIGNvbW1vblV0aWxzOiBDb21tb25VdGlscyA9IG51bGw7XHJcblxyXG4gICAgaWRTZXJ2aWNlOiBJZFNlcnZpY2UgPSBudWxsO1xyXG5cclxuICAgIC8vIOWNleWFg+agvOe8lui+keWZqOWIm+W7uuWujOaIkFxyXG4gICAgY2VsbEVkaXRvckNyZWF0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvLyDljZXlhYPmoLznvJbovpHlmajplIDmr4FcclxuICAgIGNlbGxFZGl0b3JEZXN0b3J5ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLy8g54Sm54K56KGM5YiH5o2iXHJcbiAgICBmb2N1c1Jvd0NoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG5cclxuICAgIHRvZ2dsZUdyb3VwUm93JCA9IG5ldyBFdmVudEVtaXR0ZXI8eyBncm91cFJvd0luZGV4OiBudW1iZXIsIGV4cGFuZDogYm9vbGVhbiB9PigpO1xyXG4gICAgdG9nZ2xlQWxsR3JvdXBSb3dzJCA9IG5ldyBFdmVudEVtaXR0ZXI8e2V4cGFuZDogYm9vbGVhbiB9PigpO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gICAgb25TY3JvbGxNb3ZlKHg6IG51bWJlciwgYWN0aW9uOiBTY3JvbGxBY3Rpb24pIHtcclxuICAgICAgICB0aGlzLnNjb3JsbFN1YmplY3QubmV4dCh7IHgsIHR5cGU6IGFjdGlvbiB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkYXRhU291cmNlQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLmRhdGFTb3VyY2VDaGFuZ2VkU3ViamVjdC5uZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Sb3dIb3Zlcihyb3dJbmRleDogbnVtYmVyLCByb3dEYXRhOiBhbnksIG1vdXNlRW50ZXI6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLnJvd0hvdmVyU3ViamVjdC5uZXh0KHsgaW5kZXg6IHJvd0luZGV4LCBkYXRhOiByb3dEYXRhLCBtb3VzZWVudGVyOiBtb3VzZUVudGVyIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUm93Q2xpY2socm93SW5kZXg6IG51bWJlciwgcm93RGF0YTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5yb3dTZWxlY3RTdWJqZWN0Lm5leHQoeyBpbmRleDogcm93SW5kZXgsIGRhdGE6IHJvd0RhdGEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DZWxsRWRpdCh0ZEVsZW1lbnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuZWRpdENlbGxTdWJqZWN0Lm5leHQodGRFbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkVuZENlbGxFZGl0KGNlbGw6IENlbGxJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5lbmRDZWxsRWRpdC5uZXh0KGNlbGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VsZWN0Q2VsbChjZWxsOiBDZWxsSW5mbykge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0Q2VsbFN1YmplY3QubmV4dChjZWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrZWRSb3dzQ291bnRDaGFuZ2UoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VDaGVja2VkUm93cy5uZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Sb3dIZWlnaHRDaGFuZ2Uocm93SGVpZ2h0OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnJvd0hlaWdodENoYW5nZWQuZW1pdChyb3dIZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTG9hZFZpcnR1YWxEYXRhKGRhdGE6IGFueSkge1xyXG4gICAgICAgIHRoaXMubG9hZFZpcnR1YWxEYXRhLmVtaXQoeyBkYXRhIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xlYXJGaWx0ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5jbGVhckZpbHRlci5lbWl0KCk7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJUZXh0Q2hhbmdlLmVtaXQoJycpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRmlsdGVyVGV4dENoYW5nZSh0eHQ6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuZmlsdGVyVGV4dENoYW5nZS5lbWl0KHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdG9yZVNjcm9sbGJhclBvc2l0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U2Nyb2xsYmFyUG9zaXRpb24uZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUVtcHR5U3R5bGUoKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVFbXB0eVN0eWxlJC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ3JvdXBCeSA9IChhcnIsIGZuKSA9PiBhcnIubWFwKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyA/IGZuIDogdmFsID0+IFV0aWxzLmdldFZhbHVlKGZuLCB2YWwpKS5yZWR1Y2UoKGFjYywgdmFsLCBpKSA9PiB7XHJcbiAgICAgICAgYWNjW3ZhbF0gPSAoYWNjW3ZhbF0gfHwgW10pLmNvbmNhdChhcnJbaV0pO1xyXG4gICAgICAgIHJldHVybiBhY2M7XHJcbiAgICB9LCB7fSlcclxuXHJcbiAgICBnZXRNZXJnZUNlbGxJbmZvKGRhdGEsIG1lcmdlRmllbGRzKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XHJcbiAgICAgICAgbGV0IGZpcnN0VmFsID0gbnVsbDtcclxuICAgICAgICBsZXQgY3VyclZhbDtcclxuXHJcbiAgICAgICAgbWVyZ2VGaWVsZHMuZm9yRWFjaCgoZiwgaSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKChkLCBqKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHsgW2ZdOiB7IHNob3c6IHRydWUsIHJvd3NwYW46IDEgfSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0W2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtqXSA9IGl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHRbal1bZl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtqXSA9IE9iamVjdC5hc3NpZ24ocmVzdWx0W2pdLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX2l0ZW0gPSByZXN1bHRbal07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJWYWwgPSBkW2ZdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdFZhbCA9PT0gbnVsbCB8fCBmaXJzdFZhbCAhPT0gY3VyclZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFZhbCA9IGN1cnJWYWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zdGFydEluZGV4ID0gajtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJJbmRleCA9IHJlc3VsdFtqIC0gMV1bZl0uc3RhcnRJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0uc3RhcnRJbmRleCA9IHN0ckluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zaG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtzdHJJbmRleF1bZl0ucm93c3BhbisrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVyZ2VDZWxsSW5mbzAoZGF0YSwgZmllbGQpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB7fTtcclxuICAgICAgICBsZXQgZmlyc3RWYWw7XHJcbiAgICAgICAgbGV0IGN1cnJWYWw7XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKChkLCBqKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB7IFtmaWVsZF06IHsgc2hvdzogdHJ1ZSwgcm93c3BhbjogMSwgdmFsdWU6ICcnIH0gfTtcclxuICAgICAgICAgICAgaWYgKCFyZXN1bHRbal0pIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtqXSA9IGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IF9pdGVtID0gcmVzdWx0W2pdO1xyXG4gICAgICAgICAgICBjdXJyVmFsID0gVXRpbHMuZ2V0VmFsdWUoZmllbGQsIGQpO1xyXG4gICAgICAgICAgICBfaXRlbVtmaWVsZF0udmFsdWUgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICBpZiAoZmlyc3RWYWwgPT09IHVuZGVmaW5lZCB8fCBmaXJzdFZhbCAhPT0gY3VyclZhbCkge1xyXG4gICAgICAgICAgICAgICAgZmlyc3RWYWwgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgX2l0ZW1bZmllbGRdLnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgX2l0ZW1bZmllbGRdLnN0YXJ0SW5kZXggPSBqO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RySW5kZXggPSByZXN1bHRbaiAtIDFdW2ZpZWxkXS5zdGFydEluZGV4O1xyXG4gICAgICAgICAgICAgICAgX2l0ZW1bZmllbGRdLnN0YXJ0SW5kZXggPSBzdHJJbmRleDtcclxuICAgICAgICAgICAgICAgIF9pdGVtW2ZpZWxkXS5zaG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbc3RySW5kZXhdW2ZpZWxkXS5yb3dzcGFuKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1lcmdlQ2VsbEluZm8yKGRhdGEsIG1lcmdlRmllbGRzKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGxldCBmaXJzdFZhbCA9IG51bGw7XHJcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5nZXRNZXJnZUNlbGxJbmZvMChkYXRhLCBtZXJnZUZpZWxkcy5zcGxpY2UoMCwgMSlbMF0pO1xyXG5cclxuICAgICAgICBjb25zdCBncm91cERhdGEgPSB0aGlzLmdyb3VwQnkoZGF0YSwgbWVyZ2VGaWVsZHNbMF0pO1xyXG4gICAgICAgIGNvbnN0IGdyb3VwS2V5cyA9IE9iamVjdC5rZXlzKGdyb3VwRGF0YSk7XHJcbiAgICAgICAgbGV0IHN0YXJ0Um93SW5kZXggPSAwO1xyXG4gICAgICAgIG1lcmdlRmllbGRzLmZvckVhY2goKGYsIGkpID0+IHtcclxuICAgICAgICAgICAgZ3JvdXBLZXlzLmZvckVhY2goKGssIGopID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgZ3JvdXBEYXRhW2tdLmZvckVhY2goKGQsIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0W3N0YXJ0Um93SW5kZXhdICYmICFyZXN1bHRbc3RhcnRSb3dJbmRleF1bZl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3N0YXJ0Um93SW5kZXhdID0gT2JqZWN0LmFzc2lnbihyZXN1bHRbc3RhcnRSb3dJbmRleF0sIHsgW2ZdOiB7IHNob3c6IHRydWUsIHJvd3NwYW46IDEsIHZhbHVlOiAnJyB9IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX2l0ZW0gPSByZXN1bHRbc3RhcnRSb3dJbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgY3VyclZhbCA9IFV0aWxzLmdldFZhbHVlKGYsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnZhbHVlID0gY3VyclZhbDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RWYWwgPT09IG51bGwgfHwgZmlyc3RWYWwgIT09IGN1cnJWYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RWYWwgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zaG93ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0uc3RhcnRJbmRleCA9IHN0YXJ0Um93SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RySW5kZXggPSByZXN1bHRbc3RhcnRSb3dJbmRleCAtIDFdW2ZdLnN0YXJ0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnN0YXJ0SW5kZXggPSBzdHJJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0uc2hvdyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbc3RySW5kZXhdW2ZdLnJvd3NwYW4rKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0Um93SW5kZXgrKztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXRNZXJnZUNlbGxJbmZvMyhkYXRhLCBtZXJnZUZpZWxkcykge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcclxuICAgICAgICBjb25zdCBmaXJzdEZpZWxkID0gbWVyZ2VGaWVsZHMuc3BsaWNlKDAsIDEpWzBdO1xyXG4gICAgICAgIHJlc3VsdCA9IHRoaXMuZ2V0TWVyZ2VDZWxsSW5mbzAoZGF0YSwgZmlyc3RGaWVsZCk7XHJcbiAgICAgICAgbGV0IHByZXZHcm91cEZpZWxkID0gZmlyc3RGaWVsZDtcclxuICAgICAgICAvLyBjb25zdCBncm91cERhdGEgPSB0aGlzLmdyb3VwQnkoZGF0YSwgZmlyc3RGaWVsZCk7XHJcbiAgICAgICAgLy8gY29uc3QgZ3JvdXBLZXlzID0gT2JqZWN0LmtleXMoZ3JvdXBEYXRhKTtcclxuICAgICAgICBtZXJnZUZpZWxkcy5mb3JFYWNoKChmLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzdGFydFJvd0luZGV4ID0gMDtcclxuXHJcbiAgICAgICAgICAgIGxldCBmaXJzdFZhbDtcclxuICAgICAgICAgICAgbGV0IGN1cnJWYWw7XHJcblxyXG4gICAgICAgICAgICBpZiAoaSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHByZXZHcm91cEZpZWxkID0gbWVyZ2VGaWVsZHNbaSAtIDFdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkYXRhLmZvckVhY2goKGQsIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbc3RhcnRSb3dJbmRleF0gJiYgIXJlc3VsdFtzdGFydFJvd0luZGV4XVtmXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtzdGFydFJvd0luZGV4XSA9IE9iamVjdC5hc3NpZ24ocmVzdWx0W3N0YXJ0Um93SW5kZXhdLCB7IFtmXTogeyBzaG93OiB0cnVlLCByb3dzcGFuOiAxLCB2YWx1ZTogJycgfSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBfaXRlbSA9IHJlc3VsdFtzdGFydFJvd0luZGV4XTtcclxuICAgICAgICAgICAgICAgIGN1cnJWYWwgPSBVdGlscy5nZXRWYWx1ZShmLCBkKTtcclxuICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnZhbHVlID0gY3VyclZhbDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRSb3dJbmRleCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2SXRlbSA9IHJlc3VsdFtzdGFydFJvd0luZGV4IC0gMV07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX2MgPSBPYmplY3Qua2V5cyhfaXRlbSkubWFwKGMgPT4gJycgKyBfaXRlbVtjXS52YWx1ZSkuam9pbignLCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IF9wID0gT2JqZWN0LmtleXMocHJldkl0ZW0pLm1hcChwID0+ICcnICsgcHJldkl0ZW1bcF0udmFsdWUpLmpvaW4oJywnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9jICE9PSBfcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFZhbCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKChmaXJzdFZhbCA9PT0gdW5kZWZpbmVkIHx8IGZpcnN0VmFsICE9PSBjdXJyVmFsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0VmFsID0gY3VyclZhbDtcclxuICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zaG93ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zdGFydEluZGV4ID0gc3RhcnRSb3dJbmRleDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHJlc3VsdFtzdGFydFJvd0luZGV4IC0gMV1bZl0uc3RhcnRJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zdGFydEluZGV4ID0gc3RhcnRJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zaG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3N0YXJ0SW5kZXhdW2ZdLnJvd3NwYW4rKztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggLSAxID4gc3RhcnRSb3dJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0Um93SW5kZXgrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0TWVyZ2VJbmZvKHJvd0luZGV4OiBudW1iZXIsIGZpZWxkOiBzdHJpbmcsIG1lcmdlQ2VsbEluZm86IGFueSkge1xyXG4gICAgICAgIGlmIChmaWVsZCAmJiBtZXJnZUNlbGxJbmZvICYmIG1lcmdlQ2VsbEluZm9bcm93SW5kZXhdICYmIG1lcmdlQ2VsbEluZm9bcm93SW5kZXhdW2ZpZWxkXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VDZWxsSW5mb1tyb3dJbmRleF1bZmllbGRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVTdHlsZVNoZWV0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0eWxlRWxlbWVudCkge1xyXG5cclxuICAgICAgICAgICAgLy8gY29uc3Qgc3R5bGVUZXh0OiBhbnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyt0aGlzLnN0eWxlRWxlbWVudC5pZCsnX3N0eWxlcycpO1xyXG4gICAgICAgICAgICAvLyBpZiAoc3R5bGVUZXh0KSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzdHlsZVRleHQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3R5bGVFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZVN0eWxlRWxlbWVudChzdHlsZVNoZWV0SWQ6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuc3R5bGVFbGVtZW50ID0gdGhpcy5fY3JlYXRlU3R5bGVTaGVldChzdHlsZVNoZWV0SWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHByaXZhdGUgQVBQRU5EX1NUWUxFX0VMRU1FTlRfVElNRVIgPSBudWxsO1xyXG4gICAgYXBwZW5kQ3NzUnVsZXMocnVsZXM6IHN0cmluZ1tdKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3R5bGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2FwcGVuZENzc1J1bGVzKHJ1bGVzLCB0aGlzLnN0eWxlRWxlbWVudC5zaGVldCk7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IENTU1RFWFQgPSB0aGlzLl9hcHBlbmRDc3NSdWxlcyhydWxlcywgdGhpcy5zdHlsZUVsZW1lbnQuc2hlZXQpO1xyXG5cclxuICAgICAgICAgICAgLy8gY29uc3QgaWQgPSB0aGlzLnN0eWxlRWxlbWVudC5pZDtcclxuICAgICAgICAgICAgLy8gbGV0IHN0eWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyBpZCArICdfc3R5bGVzJylcclxuICAgICAgICAgICAgLy8gaWYgKCFzdHlsZSkge1xyXG4gICAgICAgICAgICAvLyAgICAgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgICAgICAgICAvLyAgICAgc3R5bGUuaWQgPSBpZCsnX3N0eWxlcyc7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gc3R5bGUuaW5uZXJIVE1MID0gc3R5bGUuaW5uZXJIVE1MLnJlcGxhY2UoQ1NTVEVYVCwgJycpICsgQ1NTVEVYVDtcclxuICAgICAgICAgICAgLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpLmFwcGVuZENoaWxkKHN0eWxlKTtcclxuICAgICAgICAgICAgLy8gaWYgKHRoaXMuQVBQRU5EX1NUWUxFX0VMRU1FTlRfVElNRVIpIHtcclxuICAgICAgICAgICAgLy8gICAgIGNsZWFyVGltZW91dCh0aGlzLkFQUEVORF9TVFlMRV9FTEVNRU5UX1RJTUVSKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyB0aGlzLkFQUEVORF9TVFlMRV9FTEVNRU5UX1RJTUVSID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gfSwgMTAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ3NzUnVsZShydWxlTmFtZTogc3RyaW5nIHwgQXJyYXk8c3RyaW5nPikge1xyXG4gICAgICAgIGlmICh0aGlzLnN0eWxlRWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJ1bGVOYW1lID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ3NzUnVsZShydWxlTmFtZSwgdGhpcy5zdHlsZUVsZW1lbnQuc2hlZXQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocnVsZU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZU5hbWUuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ3NzUnVsZShuLCB0aGlzLnN0eWxlRWxlbWVudC5zaGVldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgX2NyZWF0ZVN0eWxlU2hlZXQoc3R5bGVTaGVldElkOiBzdHJpbmcpOiBIVE1MU3R5bGVFbGVtZW50IHtcclxuICAgICAgICBjb25zdCBodG1sSGVhZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWQnKTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3R5bGVFbGVJZCA9IHN0eWxlU2hlZXRJZDtcclxuICAgICAgICBsZXQgc3R5bGVFbGVtZW50ID0gbnVsbDtcclxuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyBzdHlsZUVsZUlkKSkge1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHN0eWxlRWxlSWQpO1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQuaW5uZXJUZXh0ID0gJyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50LmlkID0gc3R5bGVFbGVJZDtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50LnR5cGUgPSAndGV4dC9jc3MnO1xyXG4gICAgICAgICAgICAvLyBzdHlsZUVsZW1lbnQuc2hlZXQgPSBuZXcgQ1NTU3R5bGVTaGVldCgpO1xyXG4gICAgICAgICAgICBodG1sSGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0eWxlRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9hcHBlbmRDc3NSdWxlcyhydWxlczogc3RyaW5nW10sIHN0eWxlU2hlZXQpIHtcclxuICAgICAgICBsZXQgYWxsQ3NzVGV4dCA9ICcnO1xyXG4gICAgICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5pbmRleE9mKCd7JykpLnRyaW0oKTtcclxuICAgICAgICAgICAgY29uc3QgcmVtb3ZlZENzc1J1bGUgPSB0aGlzLl9yZW1vdmVDc3NSdWxlKHJ1bGVOYW1lLCBzdHlsZVNoZWV0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBjc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmVkQ3NzUnVsZSkge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dCArPSByZW1vdmVkQ3NzUnVsZS5jc3NUZXh0LnNsaWNlKHJlbW92ZWRDc3NSdWxlLmNzc1RleHQuaW5kZXhPZigneycpICsgMSwgcmVtb3ZlZENzc1J1bGUuY3NzVGV4dC5pbmRleE9mKCd9JykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNzc1RleHQgKz0gcnVsZS5zbGljZShydWxlLmluZGV4T2YoJ3snKSArIDEsIHJ1bGUuaW5kZXhPZignfScpKS5yZXBsYWNlKC9cIi9nLCAnJykucmVwbGFjZSgvLC9nLCAnOycpICsgJzsnO1xyXG4gICAgICAgICAgICBjb25zdCBfbmV3UnVsZSA9ICBgJHtydWxlTmFtZX17ICR7Y3NzVGV4dH0gfWA7XHJcbiAgICAgICAgICAgIGFsbENzc1RleHQgKz0gX25ld1J1bGU7XHJcblxyXG4gICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5hZGRSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3R5bGVTaGVldC5pbnNlcnRSdWxlKF9uZXdSdWxlLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ3NzVGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZW1vdmVDc3NSdWxlKHJ1bGVOYW1lOiBzdHJpbmcsIHN0eWxlU2hlZXQpIHtcclxuXHJcbiAgICAgICAgaWYgKCFzdHlsZVNoZWV0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCBpaSA9IDA7XHJcbiAgICAgICAgbGV0IGNzc1J1bGU6IGFueSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGNzc1J1bGUgPSBjc3NSdWxlc1tpaV07XHJcbiAgICAgICAgICAgIGlmIChjc3NSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3NzUnVsZS5zZWxlY3RvclRleHQudG9Mb3dlckNhc2UoKSA9PSBydWxlTmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlU2hlZXQuY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVTaGVldC5kZWxldGVSdWxlKGlpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LnJlbW92ZVJ1bGUoaWkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNzc1J1bGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWkrKztcclxuICAgICAgICB9IHdoaWxlIChjc3NSdWxlKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDb25maWdLZXkoZ3JpZElEOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCB7IGhvc3QsIGhhc2gsIGhyZWYsIHBhdGhuYW1lIH0gPSBsb2NhdGlvbjtcclxuICAgICAgICBsZXQgZm9ybUNvZGUgPSAnJztcclxuICAgICAgICBsZXQgbWVudUlkID0gJyc7XHJcbiAgICAgICAgaWYgKGhhc2gpIHtcclxuICAgICAgICAgICAgY29uc3QgX3NlYXJjaEFyciA9IGhhc2guc3BsaXQoJz8nKTtcclxuICAgICAgICAgICAgZm9ybUNvZGUgPSBfc2VhcmNoQXJyWzBdO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2VhcmNoT2JqOiBhbnkgPSB7fTtcclxuICAgICAgICAgICAgaWYgKF9zZWFyY2hBcnJbMV0pIHtcclxuICAgICAgICAgICAgICAgIF9zZWFyY2hBcnJbMV0uc3BsaXQoJyYnKS5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoT2JqW24uc3BsaXQoJz0nKVswXV0gPSBuLnNwbGl0KCc9JylbMV07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgY2F0Y2hGdW5jSWRLRVkgPSBgJHtwYXRobmFtZX1gO1xyXG4gICAgICAgICAgICBpZiAoc2VhcmNoT2JqICYmIE9iamVjdC5rZXlzKHNlYXJjaE9iaikubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBtZW51SWQgPSBzZWFyY2hPYmouZnVuY0lkIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1lbnVJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGNhdGNoRnVuY0lkS0VZLCBtZW51SWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIW1lbnVJZCkge1xyXG4gICAgICAgICAgICAgICAgbWVudUlkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oY2F0Y2hGdW5jSWRLRVkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGtleSA9IGZvcm1Db2RlICsgJ18nICsgbWVudUlkICsgJ18nICsgZ3JpZElEO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuaWRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRTZXJ2aWNlID0gbmV3IElkU2VydmljZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRTZXJ2aWNlLmVuY3J5cHQoa2V5KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0Q3VzdG9tU3R5bGUoc3R5bGVyOiBhbnksIGFyZ3M6IGFueSk6IHsgY2xzPzogYW55LCBzdHlsZT86IGFueSB9IHtcclxuICAgICAgICBpZiAodHlwZW9mIHN0eWxlciA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0eWxlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0eWxlciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcCA9IGFyZ3MgfHwgW107XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3R5bGVyKC4uLnApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmaW5kTmV4dFRyKG5leHRUciwgZGlyKSB7XHJcbiAgICAgICAgY29uc3QgZ2V0TmV4dEVsZW1lbnQgPSAodGFyZ2V0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKCdmLWRhdGFncmlkLWRpc2FibGUtcm93JykgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IG0gPSBkaXIgPT09ICdkb3duJyA/ICduZXh0RWxlbWVudFNpYmxpbmcnIDogJ3ByZXZpb3VzRWxlbWVudFNpYmxpbmcnO1xyXG5cclxuICAgICAgICBjb25zdCBnZXRFbGUgPSAodCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbiA9IG51bGw7XHJcbiAgICAgICAgICAgIGxldCBuZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgd2hpbGUgKG5leHQpIHtcclxuICAgICAgICAgICAgICAgIG4gPSBnZXROZXh0RWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiB0W21dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBnZXROZXh0RWxlbWVudCh0W21dKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gZ2V0RWxlKG5leHRUcik7XHJcbiAgICB9XHJcbn1cclxuIl19