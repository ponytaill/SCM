/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ViewChild } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
import { NumberRangeComponent, NumberSpinnerComponent } from '@farris/ui-number-spinner';
var PanelFlexibleNumberComponent = /** @class */ (function () {
    function PanelFlexibleNumberComponent(localeService) {
        this.localeService = localeService;
        this.itemChange = new EventEmitter();
        this.searchHandle = new EventEmitter();
        this.submitChange = new EventEmitter();
        this.canNull = true;
    }
    Object.defineProperty(PanelFlexibleNumberComponent.prototype, "item", {
        get: /**
         * @return {?}
         */
        function () {
            return this._item;
        },
        set: /**
         * @param {?} nr
         * @return {?}
         */
        function (nr) {
            this._item = nr;
            if (this._item) {
                if (!this._item.hasOwnProperty('value')) {
                    this._item.value = {
                        startValue: null,
                        endValue: null,
                        value: null,
                        single: true
                    };
                }
                if (!this._item.control.hasOwnProperty('single')) {
                    this._item.control.single = true;
                }
                this.beginPlaceHolder = (this._item.hasOwnProperty('beginPlaceHolder') && this._item.beginPlaceHolder) ? this._item.beginPlaceHolder : this.localeService.getValue('filterPanel.beginPlaceHolder');
                this.endPlaceHolder = (this._item.hasOwnProperty('endPlaceHolder') && this._item.beginPlaceHolder) ? this._item.endPlaceHolder : this.localeService.getValue('filterPanel.endPlaceHolder');
                this.placeholder = (this._item.hasOwnProperty('placeHolder') && this._item.placeHolder) ? this._item.placeHolder : '';
                this.single = this._item.control.single;
            }
            this.precision = nr.control.precision;
            this.bigNumber = nr.control.bigNumber;
            if (!this.bigNumber) {
                this.min = -2147483648;
                this.max = 2147483647;
            }
            this.constructMultiFieldNumberRange(nr.value);
            this.numberSubmitChange();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        this.changeFocus();
    };
    /**
     * @param {?} value
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.constructMultiFieldNumberRange = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.single) {
            this.value = value.value == null ? null : value.value;
        }
        else {
            this.beginValue = value.startValue == null ? null : value.startValue;
            this.endValue = value.endValue == null ? null : value.endValue;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.numberChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this._item.value.value = event;
        if (Object.keys(this._item.value).length === 0) {
            this._item.valueText = '';
        }
        else {
            this._item.valueText = '' + this._item.value.value;
        }
        this.searchHandle.emit();
        this.numberSubmitChange();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.beginValueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this._item.value.startValue = event;
        this.setValueText();
        this.numberSubmitChange();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.endValueChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this._item.value.endValue = event;
        this.setValueText();
        this.numberSubmitChange();
    };
    /**
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.setValueText = /**
     * @return {?}
     */
    function () {
        //console.log(this._item.value.startValue,this._item.value.endValue);
        if (Object.keys(this._item.value).length === 0 || (this._item.value.startValue == null && this._item.value.endValue == null)) {
            this._item.valueText = '';
        }
        else if (this._item.value.startValue == null) {
            this._item.valueText = '~' + this._item.value.endValue;
        }
        else if (this._item.value.endValue == null) {
            this._item.valueText = this._item.value.startValue + '~';
        }
        else {
            this._item.valueText = this._item.value.startValue + '~' + this._item.value.endValue;
        }
    };
    /**
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.numberSubmitChange = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var val = this._item.value;
        if (this.single) {
            if (Object.keys(val).length < 0 || (val.value == null || val.value === '' || val === undefined)) {
                this.submitChange.emit(false);
            }
            else {
                this.submitChange.emit(true);
            }
        }
        else {
            if (Object.keys(val).length === 0 || ((val.startValue === '' || val.startValue == null) && (val.endValue == null || val.endValue === ''))) {
                this.submitChange.emit(false);
            }
            else {
                this.submitChange.emit(true);
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.onChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.single = !event;
        this._item.control.single = this.single;
        this._item.value.single = this.single;
        this.changeFocus();
        this.itemChange.emit(this.item);
        this.numberSubmitChange();
    };
    /**
     * @return {?}
     */
    PanelFlexibleNumberComponent.prototype.changeFocus = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.beginNumberText)
                _this.beginNumberText.input.nativeElement.focus();
            if (_this.numberText)
                _this.numberText.input.nativeElement.focus();
        }), 0);
    };
    PanelFlexibleNumberComponent.decorators = [
        { type: Component, args: [{
                    selector: 'panel-filter-flexiblenumber',
                    template: "<div class=\"f-panel-filter-tip\">\r\n    <span class=\"panel-filter-tip-text\">{{ 'filterPanel.intervalFilter' | locale }}</span>\r\n    <farris-switch size=\"small\" [checked]=\"!single\" (valueChange)=\"onChange($event)\"></farris-switch>\r\n</div>\r\n<div class=\"f-panel-filter-content\">\r\n    <ng-container *ngIf=\"single; else elseTemplate\">\r\n        <farris-number-spinner\r\n            class=\"f-utils-fill-flex-row\"\r\n            [(ngModel)]=\"value\"\r\n            [canNull]=\"canNull\"\r\n            [precision]=\"precision\"\r\n            [bigNumber]=\"bigNumber\"\r\n            [min]=\"min\" \r\n            [max]=\"max\"\r\n            [placeholder]=\"placeholder\"\r\n            (valueChange)=\"numberChange($event)\"\r\n            #numberText\r\n        ></farris-number-spinner>\r\n    </ng-container>\r\n    <ng-template #elseTemplate>\r\n        <div class=\"d-flex panel-flexible-range-wrapper\">\r\n            <farris-number-spinner\r\n                [(ngModel)]=\"beginValue\"\r\n                [canNull]=\"canNull\"\r\n                [precision]=\"precision\"\r\n                [bigNumber]=\"bigNumber\"\r\n                [min]=\"min\" \r\n                [max]=\"endValue?endValue:max\"\r\n                [placeholder]=\"beginPlaceHolder\"\r\n                (valueChange)=\"beginValueChange($event)\"\r\n                #beginNumberText\r\n            ></farris-number-spinner>\r\n            <span class=\"f-icon f-icon-orientation-arrow\"></span>\r\n            <farris-number-spinner\r\n                [(ngModel)]=\"endValue\"\r\n                [canNull]=\"canNull\"\r\n                [precision]=\"precision\"\r\n                [bigNumber]=\"bigNumber\"\r\n                [min]=\"beginValue?beginValue:min\" \r\n                [max]=\"max\"\r\n                [placeholder]=\"endPlaceHolder\"\r\n                (valueChange)=\"endValueChange($event)\"\r\n            ></farris-number-spinner>\r\n        </div>\r\n    </ng-template>\r\n    \r\n</div>"
                }] }
    ];
    /** @nocollapse */
    PanelFlexibleNumberComponent.ctorParameters = function () { return [
        { type: LocaleService }
    ]; };
    PanelFlexibleNumberComponent.propDecorators = {
        itemChange: [{ type: Output }],
        searchHandle: [{ type: Output, args: ['searchHandle',] }],
        submitChange: [{ type: Output, args: ['submitChange',] }],
        item: [{ type: Input }],
        beginNumberText: [{ type: ViewChild, args: ['beginNumberText',] }],
        numberText: [{ type: ViewChild, args: ['numberText',] }]
    };
    return PanelFlexibleNumberComponent;
}());
export { PanelFlexibleNumberComponent };
if (false) {
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.itemChange;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.searchHandle;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.submitChange;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.canNull;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.number;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.value;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.beginValue;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.endValue;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.precision;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.placeholder;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.endPlaceHolder;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.bigNumber;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.max;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.min;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.single;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype._item;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.numberRange;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.beginNumberText;
    /** @type {?} */
    PanelFlexibleNumberComponent.prototype.numberText;
    /**
     * @type {?}
     * @private
     */
    PanelFlexibleNumberComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmxleGlibGVudW1iZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1maWx0ZXItcGFuZWwvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9mbGV4aWJsZW51bWJlcmNvbXBvbmVudC9mbGV4aWJsZW51bWJlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFlBQVksRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFtQixNQUFNLGVBQWUsQ0FBQztBQUMzRyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLHNCQUFzQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFFekY7SUE0REksc0NBQW9CLGFBQTRCO1FBQTVCLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBdER0QyxlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQixpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbEMsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzFELFlBQU8sR0FBVyxJQUFJLENBQUM7SUFtRDJCLENBQUM7SUFsQ25ELHNCQUNJLDhDQUFJOzs7O1FBNEJSO1lBQ0ksT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3RCLENBQUM7Ozs7O1FBL0JELFVBQ1MsRUFBTztZQUNaLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBQ2hCLElBQUcsSUFBSSxDQUFDLEtBQUssRUFBQztnQkFDVixJQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7b0JBQ3BDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHO3dCQUNmLFVBQVUsRUFBRyxJQUFJO3dCQUNqQixRQUFRLEVBQUcsSUFBSTt3QkFDZixLQUFLLEVBQUUsSUFB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SixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLDZCQUE2QjtvQkFDdkMsbytEQUE4QztpQkFDakQ7Ozs7Z0JBTlEsYUFBYTs7OzZCQVNqQixNQUFNOytCQUNOLE1BQU0sU0FBQyxjQUFjOytCQUNyQixNQUFNLFNBQUMsY0FBYzt1QkFrQnJCLEtBQUs7a0NBZ0NMLFNBQVMsU0FBQyxpQkFBaUI7NkJBQzNCLFNBQVMsU0FBQyxZQUFZOztJQTJGM0IsbUNBQUM7Q0FBQSxBQXRKRCxJQXNKQztTQWpKWSw0QkFBNEI7OztJQUNyQyxrREFBMEM7O0lBQzFDLG9EQUEwRDs7SUFDMUQsb0RBQTBEOztJQUMxRCwrQ0FBdUI7O0lBRXZCLDhDQUFjOztJQUNkLDZDQUFXOztJQUNYLGtEQUFnQjs7SUFDaEIsZ0RBQWM7O0lBQ2QsaURBQWtCOztJQUNsQixtREFBb0I7O0lBQ3BCLHdEQUF3Qjs7SUFDeEIsc0RBQXNCOztJQUN0QixpREFBa0I7O0lBQ2xCLDJDQUFXOztJQUNYLDJDQUFXOztJQUNYLDhDQUFlOztJQUVmLDZDQUFXOztJQUNYLG1EQUFvQjs7SUFpQ3BCLHVEQUFtRTs7SUFDbkUsa0RBQTJEOzs7OztJQUMvQyxxREFBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBWaWV3Q2hpbGQsIEFmdGVyQ29udGVudEluaXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBOdW1iZXJSYW5nZUNvbXBvbmVudCwgTnVtYmVyU3Bpbm5lckNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktbnVtYmVyLXNwaW5uZXInO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3BhbmVsLWZpbHRlci1mbGV4aWJsZW51bWJlcicsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZmxleGlibGVudW1iZXIuY29tcG9uZW50Lmh0bWwnXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgUGFuZWxGbGV4aWJsZU51bWJlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdHtcclxuICAgIEBPdXRwdXQoKSBpdGVtQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgnc2VhcmNoSGFuZGxlJykgc2VhcmNoSGFuZGxlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgnc3VibWl0Q2hhbmdlJykgc3VibWl0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgY2FuTnVsbDpib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICBudW1iZXI6c3RyaW5nO1xyXG4gICAgdmFsdWU6IGFueTtcclxuICAgIGJlZ2luVmFsdWU6IGFueTtcclxuICAgIGVuZFZhbHVlOiBhbnk7XHJcbiAgICBwcmVjaXNpb246IG51bWJlcjtcclxuICAgIHBsYWNlaG9sZGVyOiBzdHJpbmc7XHJcbiAgICBiZWdpblBsYWNlSG9sZGVyOnN0cmluZztcclxuICAgIGVuZFBsYWNlSG9sZGVyOnN0cmluZztcclxuICAgIGJpZ051bWJlcjpib29sZWFuO1xyXG4gICAgbWF4Om51bWJlcjtcclxuICAgIG1pbjpudW1iZXI7XHJcbiAgICBzaW5nbGU6Ym9vbGVhbjtcclxuXHJcbiAgICBfaXRlbTogYW55O1xyXG4gICAgbnVtYmVyUmFuZ2U6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIFxyXG4gICAgc2V0IGl0ZW0obnI6IGFueSl7XHJcbiAgICAgICAgdGhpcy5faXRlbSA9IG5yO1xyXG4gICAgICAgIGlmKHRoaXMuX2l0ZW0pe1xyXG4gICAgICAgICAgICBpZighdGhpcy5faXRlbS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydFZhbHVlIDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBlbmRWYWx1ZSA6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgc2luZ2xlOnRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZighdGhpcy5faXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdzaW5nbGUnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbS5jb250cm9sLnNpbmdsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5iZWdpblBsYWNlSG9sZGVyID0gKHRoaXMuX2l0ZW0uaGFzT3duUHJvcGVydHkoJ2JlZ2luUGxhY2VIb2xkZXInKSAmJiB0aGlzLl9pdGVtLmJlZ2luUGxhY2VIb2xkZXIpID8gdGhpcy5faXRlbS5iZWdpblBsYWNlSG9sZGVyOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2ZpbHRlclBhbmVsLmJlZ2luUGxhY2VIb2xkZXInKTtcclxuICAgICAgICAgICAgdGhpcy5lbmRQbGFjZUhvbGRlciA9ICh0aGlzLl9pdGVtLmhhc093blByb3BlcnR5KCdlbmRQbGFjZUhvbGRlcicpICYmIHRoaXMuX2l0ZW0uYmVnaW5QbGFjZUhvbGRlcikgPyB0aGlzLl9pdGVtLmVuZFBsYWNlSG9sZGVyOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2ZpbHRlclBhbmVsLmVuZFBsYWNlSG9sZGVyJyk7XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSAodGhpcy5faXRlbS5oYXNPd25Qcm9wZXJ0eSgncGxhY2VIb2xkZXInKSAmJiB0aGlzLl9pdGVtLnBsYWNlSG9sZGVyKSA/IHRoaXMuX2l0ZW0ucGxhY2VIb2xkZXI6Jyc7XHJcbiAgICAgICAgICAgIHRoaXMuc2luZ2xlID0gdGhpcy5faXRlbS5jb250cm9sLnNpbmdsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wcmVjaXNpb24gPSBuci5jb250cm9sLnByZWNpc2lvbjtcclxuICAgICAgICB0aGlzLmJpZ051bWJlciA9IG5yLmNvbnRyb2wuYmlnTnVtYmVyO1xyXG4gICAgICAgIGlmKCF0aGlzLmJpZ051bWJlcil7XHJcbiAgICAgICAgICAgIHRoaXMubWluID0gLTIxNDc0ODM2NDg7XHJcbiAgICAgICAgICAgIHRoaXMubWF4ID0gMjE0NzQ4MzY0N1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbnN0cnVjdE11bHRpRmllbGROdW1iZXJSYW5nZShuci52YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5udW1iZXJTdWJtaXRDaGFuZ2UoKTtcclxuICAgIH1cclxuICAgIGdldCBpdGVtKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW07XHJcbiAgICB9XHJcbiAgICBAVmlld0NoaWxkKCdiZWdpbk51bWJlclRleHQnKSBiZWdpbk51bWJlclRleHQ6TnVtYmVyUmFuZ2VDb21wb25lbnQ7XHJcbiAgICBAVmlld0NoaWxkKCdudW1iZXJUZXh0JykgbnVtYmVyVGV4dDpOdW1iZXJTcGlubmVyQ29tcG9uZW50O1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlKXt9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7IH1cclxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNoYW5nZUZvY3VzKCk7XHJcbiAgICB9XHJcbiAgICBjb25zdHJ1Y3RNdWx0aUZpZWxkTnVtYmVyUmFuZ2UodmFsdWUpIHtcclxuICAgICAgICBpZih0aGlzLnNpbmdsZSl7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZS52YWx1ZSA9PSBudWxsID8gbnVsbCA6IHZhbHVlLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLmJlZ2luVmFsdWUgPSB2YWx1ZS5zdGFydFZhbHVlID09IG51bGwgPyBudWxsIDogdmFsdWUuc3RhcnRWYWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5lbmRWYWx1ZSA9IHZhbHVlLmVuZFZhbHVlID09IG51bGwgPyBudWxsIDogdmFsdWUuZW5kVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbnVtYmVyQ2hhbmdlKGV2ZW50KXtcclxuICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gZXZlbnQ7XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuX2l0ZW0udmFsdWUpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlVGV4dCA9ICcnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWVUZXh0ID0gJycgKyB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICAgICAgdGhpcy5udW1iZXJTdWJtaXRDaGFuZ2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBiZWdpblZhbHVlQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5faXRlbS52YWx1ZS5zdGFydFZhbHVlID0gZXZlbnQ7XHJcbiAgICAgICAgdGhpcy5zZXRWYWx1ZVRleHQoKTtcclxuICAgICAgICB0aGlzLm51bWJlclN1Ym1pdENoYW5nZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGVuZFZhbHVlQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5faXRlbS52YWx1ZS5lbmRWYWx1ZSA9IGV2ZW50O1xyXG4gICAgICAgIHRoaXMuc2V0VmFsdWVUZXh0KCk7XHJcbiAgICAgICAgdGhpcy5udW1iZXJTdWJtaXRDaGFuZ2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZVRleHQoKXtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2l0ZW0udmFsdWUuc3RhcnRWYWx1ZSx0aGlzLl9pdGVtLnZhbHVlLmVuZFZhbHVlKTtcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5faXRlbS52YWx1ZSkubGVuZ3RoID09PSAwIHx8ICh0aGlzLl9pdGVtLnZhbHVlLnN0YXJ0VmFsdWUgPT0gbnVsbCAmJiB0aGlzLl9pdGVtLnZhbHVlLmVuZFZhbHVlID09IG51bGwpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWVUZXh0ID0gJydcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9pdGVtLnZhbHVlLnN0YXJ0VmFsdWUgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWVUZXh0ID0gJ34nICsgdGhpcy5faXRlbS52YWx1ZS5lbmRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9pdGVtLnZhbHVlLmVuZFZhbHVlID09IG51bGwpe1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlVGV4dCA9IHRoaXMuX2l0ZW0udmFsdWUuc3RhcnRWYWx1ZSArICd+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZVRleHQgPSB0aGlzLl9pdGVtLnZhbHVlLnN0YXJ0VmFsdWUgKyAnficgKyB0aGlzLl9pdGVtLnZhbHVlLmVuZFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBudW1iZXJTdWJtaXRDaGFuZ2UoKXtcclxuICAgICAgICBjb25zdCB2YWwgPSB0aGlzLl9pdGVtLnZhbHVlO1xyXG4gICAgICAgIGlmKHRoaXMuc2luZ2xlKXtcclxuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHZhbCkubGVuZ3RoIDwgMCB8fCAodmFsLnZhbHVlID09IG51bGwgfHwgdmFsLnZhbHVlID09PSAnJyB8fCB2YWwgPT09IHVuZGVmaW5lZCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0Q2hhbmdlLmVtaXQoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdENoYW5nZS5lbWl0KHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCA9PT0gMCB8fCAoKHZhbC5zdGFydFZhbHVlID09PSAnJyB8fCB2YWwuc3RhcnRWYWx1ZSA9PSBudWxsICkmJiAodmFsLmVuZFZhbHVlID09IG51bGwgfHwgdmFsLmVuZFZhbHVlID09PSAnJykpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdENoYW5nZS5lbWl0KGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJtaXRDaGFuZ2UuZW1pdCh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkNoYW5nZShldmVudCl7XHJcbiAgICAgICAgdGhpcy5zaW5nbGUgPSAhZXZlbnQ7XHJcbiAgICAgICAgdGhpcy5faXRlbS5jb250cm9sLnNpbmdsZSA9IHRoaXMuc2luZ2xlO1xyXG4gICAgICAgIHRoaXMuX2l0ZW0udmFsdWUuc2luZ2xlID0gdGhpcy5zaW5nbGU7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VGb2N1cygpO1xyXG4gICAgICAgIHRoaXMuaXRlbUNoYW5nZS5lbWl0KHRoaXMuaXRlbSk7XHJcbiAgICAgICAgdGhpcy5udW1iZXJTdWJtaXRDaGFuZ2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2VGb2N1cygpe1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZih0aGlzLmJlZ2luTnVtYmVyVGV4dCkgdGhpcy5iZWdpbk51bWJlclRleHQuaW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICBpZih0aGlzLm51bWJlclRleHQpIHRoaXMubnVtYmVyVGV4dC5pbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICB9XHJcbn0iXX0=