/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
var PanelfilterCheckboxComponent = /** @class */ (function () {
    function PanelfilterCheckboxComponent() {
        this.checkedAll = false;
        this.boolcheck = false;
        this.searchHandle = new EventEmitter();
        this.submitChange = new EventEmitter();
        this.indeterminate = true;
        this.boolCheckState = 'indeterminate';
        this.checkboxDataSource = new Array();
    }
    Object.defineProperty(PanelfilterCheckboxComponent.prototype, "item", {
        get: /**
         * @return {?}
         */
        function () {
            return this._item;
        },
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            this._item = data;
            this.getDataSource();
            //this.checkValue = this._item.value.getOriginalValue();
            if (!this._item.hasOwnProperty('value'))
                this._item.value = { value: [] };
            if (this._item.hasOwnProperty('value')) {
                this.checkValue = this._item.value.value;
            }
            else {
                this._item.value.value = [];
            }
            if (this.boolcheck) {
                if (this.checkValue.length) {
                    this.boolchecked = this.checkValue[0];
                    if (this.boolchecked)
                        this.boolCheckState = 'checked';
                    else
                        this.boolCheckState = 'unchecked';
                }
                else
                    this.boolCheckState = 'indeterminate';
            }
            if (this._item.value.value.length == 0)
                this.checkedAll = false;
            else if (this._item.control['enumValues'] && this._item.value.value.length == this._item.control['enumValues'].length)
                this.checkedAll = true;
            this.setSubmitChange();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.getDataSource = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.item && this._item.control) {
            /** @type {?} */
            var checkboxList = (this._item.control);
            this.checkboxDataSource = Array();
            if (checkboxList.enumValues && checkboxList.enumValues.length > 0) {
                checkboxList.enumValues.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                function (element) {
                    _this.checkboxDataSource.push(Object.assign({}, element));
                }));
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.onSearch = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var checkboxValue = [];
        if (event) {
            // let checkboxList = event.split(',');
            /** @type {?} */
            var checkboxList = event;
            if (checkboxList && checkboxList.length) {
                checkboxValue = checkboxList;
            }
            this._item.value.value = checkboxValue;
        }
        else {
            this._item.value.value = '';
        }
        if (checkboxValue.length < this._item.control['enumValues'].length)
            this.checkedAll = false;
        else if (checkboxValue.length == this._item.control['enumValues'].length)
            this.checkedAll = true;
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    };
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.getValueText = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var enumValue = (this._item.control).enumValues;
        /** @type {?} */
        var value = (this._item.value).value;
        if (enumValue && enumValue.length && value && value.length) {
            /** @type {?} */
            var texts = [];
            var _loop_1 = function (i) {
                /** @type {?} */
                var enums = enumValue.find((/**
                 * @param {?} val
                 * @return {?}
                 */
                function (val) {
                    return val['value'] == value[i];
                }));
                if (enums) {
                    texts.push(enums['name']);
                }
            };
            for (var i = 0; i <= value.length; i++) {
                _loop_1(i);
            }
            this._item.valueText = texts.join(',');
        }
    };
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.setSubmitChange = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var val = this._item.value;
        if (Object.keys(val).length < 0 || Object.keys(val.value).length === 0) {
            this.submitChange.emit(false);
        }
        else {
            this.submitChange.emit(true);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.handleClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.checkedAll = !this.checkedAll;
        if (this.checkedAll) {
            this.setCheckedAll();
        }
        else {
            this._item.value.value = [];
            this._item.valueText = '';
            this.checkValue = [];
        }
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    };
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.setCheckedAll = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var enumValue = (this._item.control).enumValues;
        if (enumValue && enumValue.length) {
            /** @type {?} */
            var checkboxValue = [];
            //checkboxTexts = [];
            for (var i = 0; i < enumValue.length; i++) {
                checkboxValue.push(enumValue[i]['value']);
                //checkboxTexts.push(enumValue[i]['name'])
            }
            this._item.value.value = checkboxValue;
            this.checkValue = this._item.value.value;
            //this._item.valueText = checkboxTexts.join(',');
        }
    };
    /**
     * @return {?}
     */
    PanelfilterCheckboxComponent.prototype.handleCheckClick = /**
     * @return {?}
     */
    function () {
        if (this.boolCheckState == 'indeterminate') {
            this.boolCheckState = 'checked';
            this.boolchecked = true;
            this._item.value.value = [true];
        }
        else if (this.boolCheckState == 'checked') {
            this.boolCheckState = 'unchecked';
            this.boolchecked = false;
            this._item.value.value = [false];
        }
        else if (this.boolCheckState == 'unchecked') {
            this.boolCheckState = 'indeterminate';
            this.boolchecked = null;
            this._item.value.value = [];
        }
        this.setSubmitChange();
        this.searchHandle.emit();
    };
    PanelfilterCheckboxComponent.decorators = [
        { type: Component, args: [{
                    selector: 'panel-filter-checkbox',
                    template: "<div class=\"custom-control custom-checkbox custom-control-inline filter-panel-checkbox\" *ngIf=\"!boolcheck\">\r\n    <input type=\"checkbox\" class=\"custom-control-input\"  [checked]=\"checkedAll\">\r\n    <label class=\"custom-control-label\" (click)=\"handleClick($event)\">{{'filterPanel.checkall'| locale}}</label>\r\n</div>\r\n<ng-container *ngIf=\"!boolcheck; else elseTemplate\">\r\n    <farris-checkboxgroup [value]=\"checkValue\" [horizontal]=\"false\"\r\n        [data]=\"checkboxDataSource\" [isStringValue]=\"false\" (changeValue)=\"onSearch($event)\">\r\n    </farris-checkboxgroup>\r\n</ng-container>\r\n<ng-template #elseTemplate>\r\n    <div class=\"custom-control custom-checkbox custom-control-inline filter-bool-checkbox\">\r\n        <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"boolchecked\" [indeterminate]=\"boolCheckState == 'indeterminate'\">\r\n        <label class=\"custom-control-label\" (click)=\"handleCheckClick()\">{{item.fieldName || item.name}}</label>\r\n    </div>\r\n</ng-template>\r\n\r\n"
                }] }
    ];
    /** @nocollapse */
    PanelfilterCheckboxComponent.ctorParameters = function () { return []; };
    PanelfilterCheckboxComponent.propDecorators = {
        boolcheck: [{ type: Input }],
        item: [{ type: Input }],
        searchHandle: [{ type: Output, args: ['searchHandle',] }],
        submitChange: [{ type: Output, args: ['submitChange',] }]
    };
    return PanelfilterCheckboxComponent;
}());
export { PanelfilterCheckboxComponent };
if (false) {
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkedAll;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolcheck;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype._item;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.searchHandle;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.submitChange;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkValue;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.indeterminate;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolchecked;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolCheckState;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkboxDataSource;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tib3guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1maWx0ZXItcGFuZWwvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jaGVja2JveGNvbXBvbmVudC9jaGVja2JveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFlBQVksRUFBRSxNQUFNLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFOUU7SUFpREk7UUExQ0EsZUFBVSxHQUFXLEtBQUssQ0FBQztRQUNsQixjQUFTLEdBQVcsS0FBSyxDQUFDO1FBK0JYLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFMUQsa0JBQWEsR0FBVyxJQUFJLENBQUM7UUFFN0IsbUJBQWMsR0FBVSxlQUFlLENBQUM7UUFFeEMsdUJBQWtCLEdBQVksSUFBSSxLQUFLLEVBQU8sQ0FBQztJQUdqQyxDQUFDO0lBdkNmLHNCQUNJLDhDQUFJOzs7O1FBRFI7WUFFSSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDdEIsQ0FBQzs7Ozs7UUFDRCxVQUFTLElBQUk7WUFDVCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUNsQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDckIsd0RBQXdEO1lBQ3hELElBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUM7Z0JBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7WUFDekUsSUFBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBQztnQkFDbEMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFL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QUE0Qjs7O0lBRXJDLGtEQUEyQjs7SUFDM0IsaURBQW1DOztJQUNuQyw2Q0FBVTs7SUE4QlYsb0RBQTBEOztJQUMxRCxvREFBMEQ7O0lBQzFELGtEQUFrQjs7SUFDbEIscURBQTZCOztJQUM3QixtREFBb0I7O0lBQ3BCLHNEQUF3Qzs7SUFFeEMsMERBQStDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBFdmVudEVtaXR0ZXIsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAncGFuZWwtZmlsdGVyLWNoZWNrYm94JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9jaGVja2JveC5jb21wb25lbnQuaHRtbCdcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBQYW5lbGZpbHRlckNoZWNrYm94Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0e1xyXG5cclxuICAgIGNoZWNrZWRBbGw6Ym9vbGVhbiA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgYm9vbGNoZWNrOmJvb2xlYW4gPSBmYWxzZTtcclxuICAgIF9pdGVtOmFueTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgaXRlbSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXRlbTtcclxuICAgIH1cclxuICAgIHNldCBpdGVtKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9pdGVtID0gZGF0YTtcclxuICAgICAgICB0aGlzLmdldERhdGFTb3VyY2UoKTtcclxuICAgICAgICAvL3RoaXMuY2hlY2tWYWx1ZSA9IHRoaXMuX2l0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgICAgIGlmKCF0aGlzLl9pdGVtLmhhc093blByb3BlcnR5KCd2YWx1ZScpKSB0aGlzLl9pdGVtLnZhbHVlID0geyB2YWx1ZTogW10gfTtcclxuICAgICAgICBpZih0aGlzLl9pdGVtLmhhc093blByb3BlcnR5KCd2YWx1ZScpKXtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1ZhbHVlID0gdGhpcy5faXRlbS52YWx1ZS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmJvb2xjaGVjayl7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuY2hlY2tWYWx1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9vbGNoZWNrZWQgPSB0aGlzLmNoZWNrVmFsdWVbMF07XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmJvb2xjaGVja2VkKSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2NoZWNrZWQnO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ3VuY2hlY2tlZCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2luZGV0ZXJtaW5hdGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9pdGVtLnZhbHVlLnZhbHVlLmxlbmd0aCA9PSAwKSB0aGlzLmNoZWNrZWRBbGwgPSBmYWxzZTtcclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2l0ZW0uY29udHJvbFsnZW51bVZhbHVlcyddICYmIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUubGVuZ3RoID09IHRoaXMuX2l0ZW0uY29udHJvbFsnZW51bVZhbHVlcyddLmxlbmd0aCkgdGhpcy5jaGVja2VkQWxsID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNldFN1Ym1pdENoYW5nZSgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBAT3V0cHV0KCdzZWFyY2hIYW5kbGUnKSBzZWFyY2hIYW5kbGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCdzdWJtaXRDaGFuZ2UnKSBzdWJtaXRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBjaGVja1ZhbHVlOiBhbnlbXTtcclxuICAgIGluZGV0ZXJtaW5hdGU6Ym9vbGVhbiA9IHRydWU7XHJcbiAgICBib29sY2hlY2tlZDpib29sZWFuO1xyXG4gICAgYm9vbENoZWNrU3RhdGU6c3RyaW5nID0gJ2luZGV0ZXJtaW5hdGUnO1xyXG5cclxuICAgIGNoZWNrYm94RGF0YVNvdXJjZTpBcnJheTxhbnk+PW5ldyBBcnJheTxhbnk+KCk7XHJcbiAgICBcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcigpe31cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRhU291cmNlKCl7XHJcbiAgICAgICAgaWYodGhpcy5pdGVtICYmIHRoaXMuX2l0ZW0uY29udHJvbCl7XHJcbiAgICAgICAgICAgIGxldCBjaGVja2JveExpc3Q9KHRoaXMuX2l0ZW0uY29udHJvbCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tib3hEYXRhU291cmNlID0gQXJyYXk8YW55PigpO1xyXG4gICAgICAgICAgICBpZihjaGVja2JveExpc3QuZW51bVZhbHVlcyAmJiBjaGVja2JveExpc3QuZW51bVZhbHVlcy5sZW5ndGg+MCl7XHJcbiAgICAgICAgICAgICAgICBjaGVja2JveExpc3QuZW51bVZhbHVlcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tib3hEYXRhU291cmNlLnB1c2goT2JqZWN0LmFzc2lnbih7fSxlbGVtZW50KSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNlYXJjaChldmVudCl7XHJcbiAgICAgICAgbGV0IGNoZWNrYm94VmFsdWUgPSBbXTtcclxuICAgICAgICBpZihldmVudCl7XHJcbiAgICAgICAgICAgIC8vIGxldCBjaGVja2JveExpc3QgPSBldmVudC5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICBsZXQgY2hlY2tib3hMaXN0ID0gZXZlbnQ7XHJcbiAgICAgICAgICAgIGlmKGNoZWNrYm94TGlzdCAmJiBjaGVja2JveExpc3QubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIGNoZWNrYm94VmFsdWUgPSBjaGVja2JveExpc3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IGNoZWNrYm94VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY2hlY2tib3hWYWx1ZS5sZW5ndGggPCB0aGlzLl9pdGVtLmNvbnRyb2xbJ2VudW1WYWx1ZXMnXS5sZW5ndGgpIHRoaXMuY2hlY2tlZEFsbCA9IGZhbHNlO1xyXG4gICAgICAgIGVsc2UgaWYoY2hlY2tib3hWYWx1ZS5sZW5ndGggPT0gdGhpcy5faXRlbS5jb250cm9sWydlbnVtVmFsdWVzJ10ubGVuZ3RoKSB0aGlzLmNoZWNrZWRBbGwgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZ2V0VmFsdWVUZXh0KCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdWJtaXRDaGFuZ2UoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmFsdWVUZXh0KCl7XHJcbiAgICAgICAgY29uc3QgZW51bVZhbHVlID0gKHRoaXMuX2l0ZW0uY29udHJvbCkuZW51bVZhbHVlcztcclxuICAgICAgICBjb25zdCB2YWx1ZSA9ICh0aGlzLl9pdGVtLnZhbHVlKS52YWx1ZTtcclxuICAgICAgICBpZihlbnVtVmFsdWUgJiYgZW51bVZhbHVlLmxlbmd0aCAmJiB2YWx1ZSAmJiB2YWx1ZS5sZW5ndGgpe1xyXG4gICAgICAgICAgICBsZXQgdGV4dHMgPSBbXTtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaTw9dmFsdWUubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBjb25zdCBlbnVtcyA9IGVudW1WYWx1ZS5maW5kKHZhbD0+e1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbFsndmFsdWUnXSA9PSB2YWx1ZVtpXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmKGVudW1zKXtcclxuICAgICAgICAgICAgICAgIHRleHRzLnB1c2goZW51bXNbJ25hbWUnXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlVGV4dCA9IHRleHRzLmpvaW4oJywnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0U3VibWl0Q2hhbmdlKCl7XHJcbiAgICAgICAgY29uc3QgdmFsID0gdGhpcy5faXRlbS52YWx1ZTtcclxuICAgICAgICBpZihPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCA8IDAgfHwgT2JqZWN0LmtleXModmFsLnZhbHVlKS5sZW5ndGggPT09IDApe1xyXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdENoYW5nZS5lbWl0KGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5zdWJtaXRDaGFuZ2UuZW1pdCh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNoZWNrZWRBbGwgPSAhdGhpcy5jaGVja2VkQWxsO1xyXG4gICAgICAgIGlmKHRoaXMuY2hlY2tlZEFsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZEFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWVUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZSA9IFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5nZXRWYWx1ZVRleHQoKTtcclxuICAgICAgICB0aGlzLnNldFN1Ym1pdENoYW5nZSgpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRDaGVja2VkQWxsKCl7XHJcbiAgICAgICAgY29uc3QgZW51bVZhbHVlID0gKHRoaXMuX2l0ZW0uY29udHJvbCkuZW51bVZhbHVlcztcclxuICAgICAgICBpZihlbnVtVmFsdWUgJiYgZW51bVZhbHVlLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIGxldCBjaGVja2JveFZhbHVlID0gW107XHJcbiAgICAgICAgICAgICAgICAvL2NoZWNrYm94VGV4dHMgPSBbXTtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaTxlbnVtVmFsdWUubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgY2hlY2tib3hWYWx1ZS5wdXNoKGVudW1WYWx1ZVtpXVsndmFsdWUnXSk7XHJcbiAgICAgICAgICAgICAgICAvL2NoZWNrYm94VGV4dHMucHVzaChlbnVtVmFsdWVbaV1bJ25hbWUnXSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gY2hlY2tib3hWYWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1ZhbHVlID0gdGhpcy5faXRlbS52YWx1ZS52YWx1ZTtcclxuICAgICAgICAgICAgLy90aGlzLl9pdGVtLnZhbHVlVGV4dCA9IGNoZWNrYm94VGV4dHMuam9pbignLCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVDaGVja0NsaWNrKCkge1xyXG4gICAgICAgIGlmKHRoaXMuYm9vbENoZWNrU3RhdGUgPT0gJ2luZGV0ZXJtaW5hdGUnKXtcclxuICAgICAgICAgICAgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICdjaGVja2VkJztcclxuICAgICAgICAgICAgdGhpcy5ib29sY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSBbdHJ1ZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5ib29sQ2hlY2tTdGF0ZSA9PSAnY2hlY2tlZCcpe1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ3VuY2hlY2tlZCc7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbGNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IFtmYWxzZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5ib29sQ2hlY2tTdGF0ZSA9PSAndW5jaGVja2VkJyl7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbENoZWNrU3RhdGUgPSAnaW5kZXRlcm1pbmF0ZSc7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbGNoZWNrZWQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0U3VibWl0Q2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hIYW5kbGUuZW1pdCgpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==