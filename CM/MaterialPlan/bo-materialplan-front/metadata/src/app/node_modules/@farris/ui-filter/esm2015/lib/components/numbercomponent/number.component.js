/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, EventEmitter, Output, ElementRef } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
// import { NumberRangeValue } from '../../entity/conditionvalue/numberrangevaue';
export class NumberComponent {
    /**
     * @param {?} solutionService
     * @param {?} element
     */
    constructor(solutionService, element) {
        this.solutionService = solutionService;
        this.element = element;
        this.searchHandle = new EventEmitter();
        /**
         * 判断是否是在扩展区域展示
         */
        this.extend = false;
        /**
         * 判断是否显示label
         */
        this.showlabel = true;
        this.canNull = true;
    }
    /**
     * @return {?}
     */
    get isExtend() {
        return !this.extend && this.autoLabel;
    }
    /**
     * @return {?}
     */
    get hidenLabel() {
        return !this.showlabel;
    }
    /**
     * @param {?} nr
     * @return {?}
     */
    set item(nr) {
        this._item = nr;
        this.precision = nr.control.precision;
        this.bigNumber = nr.control.bigNumber;
        if (!this.bigNumber) {
            this.min = -2147483648;
            this.max = 2147483647;
        }
        this.constructMultiFieldNumberRange((/** @type {?} */ (nr.value)));
        if (this._item && this._item.control && this._item.control.hasOwnProperty('isExtend')) {
            this.extend = this._item.control.isExtend;
            if (!this.extend) {
                this.showlabel = this._item.control.showLabel;
            }
        }
    }
    /**
     * @return {?}
     */
    get item() {
        return this._item;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.item) {
            this.beginPlaceHolder = this.item.beginPlaceHolder || '';
            this.endPlaceHolder = this.item.endPlaceHolder || '';
            // const type = Object.prototype.toString.call(this.item.placeHolder);
            // if(type == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.placeholder = this.item.control.placeholder;
            //     }
            // }
            // else{
            //     this.placeholder = this.item.placeHolder;
            // }
            // const beginplac = Object.prototype.toString.call(this.item.beginPlaceHolder);
            // if(beginplac == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.beginPlaceHolder = this.item.control.beginPlaceHolder;
            //     }
            // }
            // else{
            //     this.beginPlaceHolder = this.item.beginPlaceHolder;
            // }
            // const endplac = Object.prototype.toString.call(this.item.beginPlaceHolder);
            // if(endplac == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.endPlaceHolder = this.item.control.endPlaceHolder;
            //     }
            // }
            // else{
            //     this.endPlaceHolder = this.item.endPlaceHolder;
            // }
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // if(!this.extend){
        //     const El = this.element.nativeElement;
        //     const itemWidth = El.clientWidth;
        //     El.querySelector('.list-filter-number-item').style.width = itemWidth + 'px';
        //     El.querySelector('.number-item-btns').style.width = itemWidth + 100 + 'px';
        // }
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    // constructNumberRange(value: NumberRangeValue): string{
    //     return "a~b".replace(/a/,value.startValue?value.startValue.toString().trim():"").replace(/b/,value.endValue?value.endValue.toString().trim():"");
    // }
    /**
     * @param {?} value
     * @return {?}
     */
    constructMultiFieldNumberRange(value) {
        // this.beginValue = value && value.startValue ? value.startValue.toString().trim() : '';
        // this.endValue = value && value.endValue ? value.endValue.toString().trim() : '';
        this.beginValue = value.startValue == null ? null : value.startValue;
        this.endValue = value.endValue == null ? null : value.endValue;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    numberChange(event) {
        if (event) {
            // const dataArray = event.split("~");
            // console.log(dataArray);
            // this._item.value = (new NumberRangeValueConvertor).initFromObject({startValue: dataArray[0], endValue: dataArray[1]});
            /** @type {?} */
            const dataArray = event.split("~");
            this.item.value.startValue = dataArray[0] ? dataArray[0] : null;
            this.item.value.endValue = dataArray[1] ? dataArray[1] : null;
        }
        else {
            this._item.value.startValue = null;
            this._item.value.endValue = null;
        }
        // const dataArray = event.split("~");
        // this._item.value = (new NumberRangeValueConvertor).initFromObject({startValue: dataArray[0], endValue: dataArray[1]});
        if (this.disabled) {
            return;
        }
        this.searchHandle.emit();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    beginValueChange($event) {
        this.beginValue = $event;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    endValueChange($event) {
        this.endValue = $event;
    }
}
NumberComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-filter-number',
                template: "<label class=\"col-form-label\" *ngIf=\"item && showlabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n    <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.required\">*</span>\r\n    <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n</label>\r\n<div class=\"farris-input-wrap d-flex\">\r\n    <farris-number-range class=\"f-utils-fill-flex-row\" [canNull]=\"canNull\" [disabled]=\"disabled\" [beginValue]=\"beginValue\" \r\n    [endValue]=\"endValue\" (beginValueChange)=\"beginValueChange($event)\" (endValueChange)=\"endValueChange($event)\" \r\n    (valueChange)=\"numberChange($event)\" [beginPlaceHolder]=\"beginPlaceHolder\" [endPlaceHolder]=\"endPlaceHolder\" [placeholder]=\"placeholder\" \r\n    [precision]=\"precision\" [bigNumber]=\"bigNumber\" [min]=\"min\" [max]=\"max\"></farris-number-range>\r\n</div>"
            }] }
];
/** @nocollapse */
NumberComponent.ctorParameters = () => [
    { type: SolutionService },
    { type: ElementRef }
];
NumberComponent.propDecorators = {
    autoLabel: [{ type: Input }],
    disabled: [{ type: Input }],
    searchHandle: [{ type: Output, args: ['searchHandle',] }],
    isExtend: [{ type: HostBinding, args: ['class.filter-item-wrap',] }],
    hidenLabel: [{ type: HostBinding, args: ['class.filter-item-hiddenlabel',] }],
    item: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    NumberComponent.prototype.autoLabel;
    /** @type {?} */
    NumberComponent.prototype.disabled;
    /** @type {?} */
    NumberComponent.prototype.searchHandle;
    /**
     * 判断是否是在扩展区域展示
     * @type {?}
     */
    NumberComponent.prototype.extend;
    /**
     * 判断是否显示label
     * @type {?}
     */
    NumberComponent.prototype.showlabel;
    /** @type {?} */
    NumberComponent.prototype.canNull;
    /** @type {?} */
    NumberComponent.prototype.number;
    /** @type {?} */
    NumberComponent.prototype.beginValue;
    /** @type {?} */
    NumberComponent.prototype.endValue;
    /** @type {?} */
    NumberComponent.prototype.precision;
    /** @type {?} */
    NumberComponent.prototype.placeholder;
    /** @type {?} */
    NumberComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    NumberComponent.prototype.endPlaceHolder;
    /** @type {?} */
    NumberComponent.prototype.bigNumber;
    /** @type {?} */
    NumberComponent.prototype.max;
    /** @type {?} */
    NumberComponent.prototype.min;
    /** @type {?} */
    NumberComponent.prototype._item;
    /** @type {?} */
    NumberComponent.prototype.numberRange;
    /**
     * @type {?}
     * @private
     */
    NumberComponent.prototype.solutionService;
    /**
     * @type {?}
     * @private
     */
    NumberComponent.prototype.element;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtYmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZmlsdGVyLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbnVtYmVyY29tcG9uZW50L251bWJlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFpQixVQUFVLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFdEgsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDOztBQVVqRSxNQUFNLE9BQU8sZUFBZTs7Ozs7SUF5RHhCLFlBQW9CLGVBQStCLEVBQWtCLE9BQW1CO1FBQXBFLG9CQUFlLEdBQWYsZUFBZSxDQUFnQjtRQUFrQixZQUFPLEdBQVAsT0FBTyxDQUFZO1FBcERoRSxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7Ozs7UUFHMUQsV0FBTSxHQUFXLEtBQUssQ0FBQzs7OztRQUV2QixjQUFTLEdBQVcsSUFBSSxDQUFDO1FBQ3pCLFlBQU8sR0FBVyxJQUFJLENBQUM7SUE4Q21FLENBQUM7Ozs7SUFqQzNGLElBQ0ksUUFBUTtRQUNSLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDMUMsQ0FBQzs7OztJQUNELElBQ0ksVUFBVTtRQUNWLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQzNCLENBQUM7Ozs7O0lBSUQsSUFDSSxJQUFJLENBQUMsRUFBTztRQUNaLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ2hCLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7UUFDdEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUN0QyxJQUFHLENBQUMsSUFBSSxD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MENBQXVDOzs7OztJQUFDLGtDQUFvQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgSG9zdEJpbmRpbmcsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBBZnRlclZpZXdJbml0LCBFbGVtZW50UmVmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBOdW1iZXJSYW5nZVZhbHVlLCBOdW1iZXJSYW5nZVZhbHVlQ29udmVydG9yIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL251bWJlcnJhbmdldmF1ZSc7XHJcbi8vIGltcG9ydCB7IE51bWJlclJhbmdlVmFsdWUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29uZGl0aW9udmFsdWUvbnVtYmVycmFuZ2V2YXVlJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLWZpbHRlci1udW1iZXInLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL251bWJlci5jb21wb25lbnQuaHRtbCdcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBOdW1iZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsQWZ0ZXJWaWV3SW5pdHtcclxuICAgXHJcbiAgICAvLyBASW5wdXQoKSBpdGVtOmFueTtcclxuICAgIEBJbnB1dCgpIGF1dG9MYWJlbDpib29sZWFuO1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQ6Ym9vbGVhbjtcclxuICAgIEBPdXRwdXQoJ3NlYXJjaEhhbmRsZScpIHNlYXJjaEhhbmRsZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICAvKirliKTmlq3mmK/lkKbmmK/lnKjmianlsZXljLrln5/lsZXnpLogKi9cclxuICAgIGV4dGVuZDpib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKirliKTmlq3mmK/lkKbmmL7npLpsYWJlbCAqL1xyXG4gICAgc2hvd2xhYmVsOmJvb2xlYW4gPSB0cnVlO1xyXG4gICAgY2FuTnVsbDpib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICBudW1iZXI6c3RyaW5nO1xyXG4gICAgYmVnaW5WYWx1ZTogYW55O1xyXG4gICAgZW5kVmFsdWU6IGFueTtcclxuICAgIHByZWNpc2lvbjogbnVtYmVyO1xyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICAgIGJlZ2luUGxhY2VIb2xkZXI6c3RyaW5nO1xyXG4gICAgZW5kUGxhY2VIb2xkZXI6c3RyaW5nO1xyXG4gICAgYmlnTnVtYmVyOmJvb2xlYW47XHJcbiAgICBtYXg6bnVtYmVyO1xyXG4gICAgbWluOm51bWJlcjtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZpbHRlci1pdGVtLXdyYXAnKVxyXG4gICAgZ2V0IGlzRXh0ZW5kKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5leHRlbmQgJiYgdGhpcy5hdXRvTGFiZWw7XHJcbiAgICB9XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZpbHRlci1pdGVtLWhpZGRlbmxhYmVsJylcclxuICAgIGdldCBoaWRlbkxhYmVsKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5zaG93bGFiZWw7XHJcbiAgICB9XHJcblxyXG4gICAgX2l0ZW06IGFueTtcclxuICAgIG51bWJlclJhbmdlOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBcclxuICAgIHNldCBpdGVtKG5yOiBhbnkpe1xyXG4gICAgICAgIHRoaXMuX2l0ZW0gPSBucjtcclxuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IG5yLmNvbnRyb2wucHJlY2lzaW9uO1xyXG4gICAgICAgIHRoaXMuYmlnTnVtYmVyID0gbnIuY29udHJvbC5iaWdOdW1iZXI7XHJcbiAgICAgICAgaWYoIXRoaXMuYmlnTnVtYmVyKXtcclxuICAgICAgICAgICAgdGhpcy5taW4gPSAtMjE0NzQ4MzY0ODtcclxuICAgICAgICAgICAgdGhpcy5tYXggPSAyMTQ3NDgzNjQ3O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbnN0cnVjdE11bHRpRmllbGROdW1iZXJSYW5nZShuci52YWx1ZSBhcyBOdW1iZXJSYW5nZVZhbHVlKTtcclxuICAgICAgICBpZih0aGlzLl9pdGVtICYmIHRoaXMuX2l0ZW0uY29udHJvbCAmJiB0aGlzLl9pdGVtLmNvbnRyb2wuaGFzT3duUHJvcGVydHkoJ2lzRXh0ZW5kJykpe1xyXG4gICAgICAgICAgICB0aGlzLmV4dGVuZCA9IHRoaXMuX2l0ZW0uY29udHJvbC5pc0V4dGVuZDtcclxuICAgICAgICAgICAgaWYoIXRoaXMuZXh0ZW5kKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd2xhYmVsID0gdGhpcy5faXRlbS5jb250cm9sLnNob3dMYWJlbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgaXRlbSgpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pdGVtO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOlNvbHV0aW9uU2VydmljZSxwcml2YXRlIHJlYWRvbmx5IGVsZW1lbnQ6IEVsZW1lbnRSZWYpe31cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBpZih0aGlzLml0ZW0pe1xyXG4gICAgICAgICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlciB8fCAnJztcclxuICAgICAgICAgICAgdGhpcy5lbmRQbGFjZUhvbGRlciA9IHRoaXMuaXRlbS5lbmRQbGFjZUhvbGRlciB8fCAnJztcclxuICAgICAgICAgICAgLy8gY29uc3QgdHlwZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzLml0ZW0ucGxhY2VIb2xkZXIpO1xyXG4gICAgICAgICAgICAvLyBpZih0eXBlID09ICdbb2JqZWN0IFVuZGVmaW5lZF0nKXtcclxuICAgICAgICAgICAgLy8gICAgIGlmKHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdwbGFjZWhvbGRlcicpKXtcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5pdGVtLmNvbnRyb2wucGxhY2Vob2xkZXI7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gZWxzZXtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLml0ZW0ucGxhY2VIb2xkZXI7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gY29uc3QgYmVnaW5wbGFjID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMuaXRlbS5iZWdpblBsYWNlSG9sZGVyKTtcclxuICAgICAgICAgICAgLy8gaWYoYmVnaW5wbGFjID09ICdbb2JqZWN0IFVuZGVmaW5lZF0nKXtcclxuICAgICAgICAgICAgLy8gICAgIGlmKHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdwbGFjZWhvbGRlcicpKXtcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uY29udHJvbC5iZWdpblBsYWNlSG9sZGVyO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2V7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlcjtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyBjb25zdCBlbmRwbGFjID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMuaXRlbS5iZWdpblBsYWNlSG9sZGVyKTtcclxuICAgICAgICAgICAgLy8gaWYoZW5kcGxhYyA9PSAnW29iamVjdCBVbmRlZmluZWRdJyl7XHJcbiAgICAgICAgICAgIC8vICAgICBpZih0aGlzLml0ZW0uY29udHJvbCAmJiB0aGlzLml0ZW0uY29udHJvbC5oYXNPd25Qcm9wZXJ0eSgncGxhY2Vob2xkZXInKSl7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy5lbmRQbGFjZUhvbGRlciA9IHRoaXMuaXRlbS5jb250cm9sLmVuZFBsYWNlSG9sZGVyO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2V7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmVuZFBsYWNlSG9sZGVyID0gdGhpcy5pdGVtLmVuZFBsYWNlSG9sZGVyO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICAvLyBpZighdGhpcy5leHRlbmQpe1xyXG4gICAgICAgIC8vICAgICBjb25zdCBFbCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIC8vICAgICBjb25zdCBpdGVtV2lkdGggPSBFbC5jbGllbnRXaWR0aDtcclxuICAgICAgICAvLyAgICAgRWwucXVlcnlTZWxlY3RvcignLmxpc3QtZmlsdGVyLW51bWJlci1pdGVtJykuc3R5bGUud2lkdGggPSBpdGVtV2lkdGggKyAncHgnO1xyXG4gICAgICAgIC8vICAgICBFbC5xdWVyeVNlbGVjdG9yKCcubnVtYmVyLWl0ZW0tYnRucycpLnN0eWxlLndpZHRoID0gaXRlbVdpZHRoICsgMTAwICsgJ3B4JztcclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkOlF1ZXJ5Q29uZGl0aW9uKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjb25zdHJ1Y3ROdW1iZXJSYW5nZSh2YWx1ZTogTnVtYmVyUmFuZ2VWYWx1ZSk6IHN0cmluZ3tcclxuICAgIC8vICAgICByZXR1cm4gXCJhfmJcIi5yZXBsYWNlKC9hLyx2YWx1ZS5zdGFydFZhbHVlP3ZhbHVlLnN0YXJ0VmFsdWUudG9TdHJpbmcoKS50cmltKCk6XCJcIikucmVwbGFjZSgvYi8sdmFsdWUuZW5kVmFsdWU/dmFsdWUuZW5kVmFsdWUudG9TdHJpbmcoKS50cmltKCk6XCJcIik7XHJcbiAgICAvLyB9XHJcbiAgICBjb25zdHJ1Y3RNdWx0aUZpZWxkTnVtYmVyUmFuZ2UodmFsdWU6IE51bWJlclJhbmdlVmFsdWUpIHtcclxuICAgICAgICAvLyB0aGlzLmJlZ2luVmFsdWUgPSB2YWx1ZSAmJiB2YWx1ZS5zdGFydFZhbHVlID8gdmFsdWUuc3RhcnRWYWx1ZS50b1N0cmluZygpLnRyaW0oKSA6ICcnO1xyXG4gICAgICAgIC8vIHRoaXMuZW5kVmFsdWUgPSB2YWx1ZSAmJiB2YWx1ZS5lbmRWYWx1ZSA/IHZhbHVlLmVuZFZhbHVlLnRvU3RyaW5nKCkudHJpbSgpIDogJyc7XHJcbiAgICAgICAgdGhpcy5iZWdpblZhbHVlID0gdmFsdWUuc3RhcnRWYWx1ZSA9PSBudWxsID8gbnVsbCA6IHZhbHVlLnN0YXJ0VmFsdWU7XHJcbiAgICAgICAgdGhpcy5lbmRWYWx1ZSA9IHZhbHVlLmVuZFZhbHVlID09IG51bGwgPyBudWxsIDogdmFsdWUuZW5kVmFsdWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICBudW1iZXJDaGFuZ2UoZXZlbnQpe1xyXG4gICAgICAgIGlmKGV2ZW50KXtcclxuICAgICAgICAgICAgLy8gY29uc3QgZGF0YUFycmF5ID0gZXZlbnQuc3BsaXQoXCJ+XCIpO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhQXJyYXkpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLl9pdGVtLnZhbHVlID0gKG5ldyBOdW1iZXJSYW5nZVZhbHVlQ29udmVydG9yKS5pbml0RnJvbU9iamVjdCh7c3RhcnRWYWx1ZTogZGF0YUFycmF5WzBdLCBlbmRWYWx1ZTogZGF0YUFycmF5WzFdfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGFBcnJheSA9IGV2ZW50LnNwbGl0KFwiflwiKTtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnN0YXJ0VmFsdWUgPSBkYXRhQXJyYXlbMF0gPyBkYXRhQXJyYXlbMF0gOiBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuZW5kVmFsdWUgPSBkYXRhQXJyYXlbMV0gPyBkYXRhQXJyYXlbMV0gOiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnN0YXJ0VmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLmVuZFZhbHVlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY29uc3QgZGF0YUFycmF5ID0gZXZlbnQuc3BsaXQoXCJ+XCIpO1xyXG4gICAgICAgIC8vIHRoaXMuX2l0ZW0udmFsdWUgPSAobmV3IE51bWJlclJhbmdlVmFsdWVDb252ZXJ0b3IpLmluaXRGcm9tT2JqZWN0KHtzdGFydFZhbHVlOiBkYXRhQXJyYXlbMF0sIGVuZFZhbHVlOiBkYXRhQXJyYXlbMV19KTtcclxuICAgICAgICBpZih0aGlzLmRpc2FibGVkKXtyZXR1cm47fVxyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBiZWdpblZhbHVlQ2hhbmdlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuYmVnaW5WYWx1ZSA9ICRldmVudDtcclxuICAgIH1cclxuXHJcbiAgICBlbmRWYWx1ZUNoYW5nZSgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmVuZFZhbHVlID0gJGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIG9uU2VhcmNoKCl7XHJcbiAgICAvLyAgICAgaWYodGhpcy5kaXNhYmxlZCl7cmV0dXJuO31cclxuICAgIC8vICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICAvLyB9XHJcbn0iXX0=