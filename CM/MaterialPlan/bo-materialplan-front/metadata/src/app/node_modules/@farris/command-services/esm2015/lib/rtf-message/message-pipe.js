import { UID } from '@farris/devkit';
export class MessagePipe {
    constructor(token, rtfService) {
        this.token = token;
        this.rtfService = rtfService;
    }
    /**
     * 向管道发送消息
     * @param message 消息
     */
    sendMessage(message) {
        this.rtfService.subjectNotify(this.token, message);
        return this;
    }
    /**
     * 监听管道消息
     * @param handler 消息处理器
     */
    listen(handler) {
        const observerToken = UID.create();
        this.rtfService.subjectResponse(this.token, handler, observerToken);
        const unListen = () => {
            this.rtfService.responseUnSubscribe(this.token, observerToken);
        };
        return unListen;
    }
    /**
     * 销毁管道
     */
    destory() {
        this.rtfService.subjectRemove(this.token);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS1waXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL3J0Zi1tZXNzYWdlL21lc3NhZ2UtcGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFckMsTUFBTSxPQUFPLFdBQVc7SUFDcEIsWUFBbUIsS0FBYSxFQUFVLFVBQW1DO1FBQTFELFVBQUssR0FBTCxLQUFLLENBQVE7UUFBVSxlQUFVLEdBQVYsVUFBVSxDQUF5QjtJQUFJLENBQUM7SUFDbEY7OztPQUdHO0lBQ0ksV0FBVyxDQUFDLE9BQVk7UUFDM0IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNuRCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBQ0Q7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLE9BQTRCO1FBQ3RDLE1BQU0sYUFBYSxHQUFHLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNuQyxJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQztRQUNwRSxNQUFNLFFBQVEsR0FBRyxHQUFHLEVBQUU7WUFDbEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQ25FLENBQUMsQ0FBQztRQUNGLE9BQU8sUUFBUSxDQUFDO0lBQ3BCLENBQUM7SUFDRDs7T0FFRztJQUNJLE9BQU87UUFDVixJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUMsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUnVudGltZUZyYW1ld29ya1NlcnZpY2UgfSBmcm9tICcuLi9ydGYtc2VydmljZSc7XG5pbXBvcnQgeyBVSUQgfSBmcm9tICdAZmFycmlzL2RldmtpdCc7XG5cbmV4cG9ydCBjbGFzcyBNZXNzYWdlUGlwZSB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHRva2VuOiBzdHJpbmcsIHByaXZhdGUgcnRmU2VydmljZTogUnVudGltZUZyYW1ld29ya1NlcnZpY2UpIHsgfVxuICAgIC8qKlxuICAgICAqIOWQkeeuoemBk+WPkemAgea2iOaBr1xuICAgICAqIEBwYXJhbSBtZXNzYWdlIOa2iOaBr1xuICAgICAqL1xuICAgIHB1YmxpYyBzZW5kTWVzc2FnZShtZXNzYWdlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5ydGZTZXJ2aWNlLnN1YmplY3ROb3RpZnkodGhpcy50b2tlbiwgbWVzc2FnZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiDnm5HlkKznrqHpgZPmtojmga9cbiAgICAgKiBAcGFyYW0gaGFuZGxlciDmtojmga/lpITnkIblmahcbiAgICAgKi9cbiAgICBwdWJsaWMgbGlzdGVuKGhhbmRsZXI6IChkYXRhOiBhbnkpID0+IHZvaWQpOiAoKSA9PiB2b2lkIHtcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXJUb2tlbiA9IFVJRC5jcmVhdGUoKTtcbiAgICAgICAgdGhpcy5ydGZTZXJ2aWNlLnN1YmplY3RSZXNwb25zZSh0aGlzLnRva2VuLCBoYW5kbGVyLCBvYnNlcnZlclRva2VuKTtcbiAgICAgICAgY29uc3QgdW5MaXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJ0ZlNlcnZpY2UucmVzcG9uc2VVblN1YnNjcmliZSh0aGlzLnRva2VuLCBvYnNlcnZlclRva2VuKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHVuTGlzdGVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiDplIDmr4HnrqHpgZNcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdG9yeSgpIHtcbiAgICAgICAgdGhpcy5ydGZTZXJ2aWNlLnN1YmplY3RSZW1vdmUodGhpcy50b2tlbik7XG4gICAgfVxufVxuIl19