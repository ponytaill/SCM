/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, Output, EventEmitter, ViewChild, Injector, Renderer2, Input } from '@angular/core';
import { trigger, style, transition, animate } from '@angular/animations';
import { PersonalConfigService } from './lookup-presonalConfig.service';
var LookupTabsComponent = /** @class */ (function () {
    function LookupTabsComponent(injector) {
        this.injector = injector;
        this.enableFav = false;
        this.enableSelected = false;
        this.selectedTotal = 0;
        this.activeTab = 'datalist';
        this.tabChange = new EventEmitter();
        this.render = null;
        this.el = null;
        this.personalConfigService = this.injector.get(PersonalConfigService, null);
        this.render = this.injector.get(Renderer2);
        this.el = this.injector.get(ElementRef);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    LookupTabsComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.activeTab && !changes.activeTab.isFirstChange()) {
            this.initInkBarPos(changes.activeTab.currentValue);
        }
    };
    /**
     * @return {?}
     */
    LookupTabsComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.initInkBarPos(_this.activeTab);
        }), 300);
    };
    /**
     * @param {?} e
     * @param {?} v
     * @return {?}
     */
    LookupTabsComponent.prototype.navClickHandle = /**
     * @param {?} e
     * @param {?} v
     * @return {?}
     */
    function (e, v) {
        e.stopPropagation();
        this.activeTab = v;
        // this.personalConfigService.personalConfObser$.next({tabIndex: v});
        this.tabChange.emit({ event: e, tabIndex: v });
        this.initInkBarPos(v);
    };
    /**
     * @param {?} which
     * @return {?}
     */
    LookupTabsComponent.prototype.initInkBarPos = /**
     * @param {?} which
     * @return {?}
     */
    function (which) {
        if (!this.enableFav && !this.enableSelected) {
            return;
        }
        /** @type {?} */
        var width = this.dataListNavRef.nativeElement.offsetWidth;
        /** @type {?} */
        var left = 0;
        if (which !== 'datalist') {
            left = this.dataListNavRef.nativeElement.offsetWidth;
        }
        if (which === 'favorite') {
            width = this.favoriteNavRef.nativeElement.offsetWidth;
        }
        else if (which === 'selected') {
            if (this.favoriteNavRef) {
                left += this.favoriteNavRef.nativeElement.offsetWidth;
            }
            if (this.selectedNavRef) {
                width = this.selectedNavRef.nativeElement.offsetWidth;
            }
            else {
                this.activeTab = 'datalist';
            }
        }
        this.inkBarRef.nativeElement.style = "width: " + width + "px; transform: translate3d(" + left + "px, 0px, 0px);";
    };
    /**
     * @return {?}
     */
    LookupTabsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.showWhich = this.personalConfigService.getActiveTabIndex();
    };
    LookupTabsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lookup-tabs',
                    template: "<div class=\"lookup-tabs-nav\" *ngIf=\"enableFav || enableSelected\">\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'datalist'\" (click)=\"navClickHandle($event, 'datalist')\" #dataListNav>{{ 'lookup.datalist' | locale: '\u6570\u636E\u5217\u8868' }}</div>\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'favorite'\" *ngIf=\"enableFav\" (click)=\"navClickHandle($event, 'favorite')\" #favoriteNav>{{ 'lookup.favorites' | locale: '\u6536\u85CF\u5939' }}</div>\r\n    <div class=\"nav-item\" [class.nav-item-selected]=\"activeTab === 'selected'\"  *ngIf=\"enableSelected\" (click)=\"navClickHandle($event, 'selected')\" #selectedNav>{{ 'lookup.selected' | locale: '\u5DF2\u9009\u6570\u636E' }}\r\n        <div class=\"lookup-selected-total\" style=\"background: #0068f3;display: inline-block;\r\n        color: white;border-radius: 10px;padding: 0 5px; text-align: center;\">\r\n        {{ selectedTotal }}\r\n        </div>\r\n    </div>\r\n    <div class=\"tabs-ink-bar tabs-ink-bar-animated\" #inkBar></div>\r\n</div>\r\n<div class=\"lookup-tabs-content\">\r\n    <div class=\"lookup-datalist\" style=\"height:100%\"  @flyInOut *ngIf=\"activeTab === 'datalist'\">\r\n        <div style=\"height: 100%\">\r\n            <ng-content select=\"[datalist]\"></ng-content>\r\n        </div>\r\n    </div>\r\n    <div class=\"lookup-favorites\" style=\"height:100%; padding-top: 5px;\" @flyInOut *ngIf=\"activeTab === 'favorite'\" >\r\n        <div style=\"height: 100%\">\r\n            <ng-content select=\"[favorites]\"></ng-content>\r\n        </div>\r\n    </div>\r\n    <div class=\"lookup-selected\" style=\"height:100%; padding-top: 5px;\" @flyInOut *ngIf=\"activeTab === 'selected'\">\r\n        <div  style=\"height: 100%\">\r\n            <ng-content select=\"[selected]\"></ng-content>\r\n        </div>\r\n    </div>\r\n</div>",
                    animations: [
                        trigger('flyInOut', [
                            transition(':enter', [style({ opacity: 0 }), animate('.3s', style({ opacity: 1 }))]),
                            transition(':leave', [animate('.3s', style({ opacity: 0 }))])
                        ])
                    ],
                    styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}:host .lookup-tabs-nav{position:relative;display:inline-block;box-sizing:border-box;margin:0;padding-left:0;list-style:none;-webkit-transition:-webkit-transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1)}:host .lookup-tabs-nav .nav-item{position:relative;display:inline-block;text-decoration:none;box-sizing:border-box;padding:.625rem .8125rem;color:inherit;cursor:pointer}:host .lookup-tabs-nav .nav-item-selected{color:#1890ff}:host .lookup-tabs-nav .tabs-ink-bar{position:absolute;bottom:1px;left:0;z-index:1;box-sizing:border-box;height:2px;background-color:#1890ff;-webkit-transform-origin:0 0;transform-origin:0 0}:host .lookup-tabs-nav .tabs-ink-bar-animated{-webkit-transition:width .3s cubic-bezier(.645,.045,.355,1),left .3s cubic-bezier(.71,.03,.35,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1);transition:transform .3s cubic-bezier(.645,.045,.355,1),width .3s cubic-bezier(.645,.045,.355,1),left .3s cubic-bezier(.71,.03,.35,1),-webkit-transform .3s cubic-bezier(.645,.045,.355,1)}:host .lookup-tabs-content{-webkit-box-flex:1;flex:1;border-top:1px solid #cecece;position:relative;top:-2px}"]
                }] }
    ];
    /** @nocollapse */
    LookupTabsComponent.ctorParameters = function () { return [
        { type: Injector }
    ]; };
    LookupTabsComponent.propDecorators = {
        enableFav: [{ type: Input }],
        enableSelected: [{ type: Input }],
        selectedTotal: [{ type: Input }],
        activeTab: [{ type: Input }],
        tabChange: [{ type: Output }],
        inkBarRef: [{ type: ViewChild, args: ['inkBar',] }],
        dataListNavRef: [{ type: ViewChild, args: ['dataListNav',] }],
        favoriteNavRef: [{ type: ViewChild, args: ['favoriteNav',] }],
        selectedNavRef: [{ type: ViewChild, args: ['selectedNav',] }]
    };
    return LookupTabsComponent;
}());
export { LookupTabsComponent };
if (false) {
    /** @type {?} */
    LookupTabsComponent.prototype.enableFav;
    /** @type {?} */
    LookupTabsComponent.prototype.enableSelected;
    /** @type {?} */
    LookupTabsComponent.prototype.selectedTotal;
    /** @type {?} */
    LookupTabsComponent.prototype.activeTab;
    /** @type {?} */
    LookupTabsComponent.prototype.tabChange;
    /** @type {?} */
    LookupTabsComponent.prototype.inkBarRef;
    /** @type {?} */
    LookupTabsComponent.prototype.dataListNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.favoriteNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.selectedNavRef;
    /** @type {?} */
    LookupTabsComponent.prototype.personalConfigService;
    /**
     * @type {?}
     * @private
     */
    LookupTabsComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    LookupTabsComponent.prototype.el;
    /** @type {?} */
    LookupTabsComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLXRhYnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1sb29rdXAvIiwic291cmNlcyI6WyJsaWIvbG9va3VwLXRhYnMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFVLFVBQVUsRUFDN0IsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQzlELE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxPQUFPLEVBQVMsS0FBSyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUV4RTtJQTZCSSw2QkFBbUIsUUFBa0I7UUFBbEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQWhCNUIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixtQkFBYyxHQUFHLEtBQUssQ0FBQztRQUN2QixrQkFBYSxHQUFHLENBQUMsQ0FBQztRQUNsQixjQUFTLEdBQUcsVUFBVSxDQUFDO1FBRXRCLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBU3RDLFdBQU0sR0FBYyxJQUFJLENBQUM7UUFDekIsT0FBRSxHQUFlLElBQUksQ0FBQztRQUUxQixJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDNUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzVDLENBQUM7Ozs7O0lBRUQseUNBQVc7Ozs7SUFBWCxVQUFZLE9B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QyxRQUFRO2lDQUNsQixTQUFTLFNBQUMsYUFBYTtpQ0FDdkIsU0FBUyxTQUFDLGFBQWE7aUNBQ3ZCLFNBQVMsU0FBQyxhQUFhOztJQThENUIsMEJBQUM7Q0FBQSxBQXJGRCxJQXFGQztTQTFFWSxtQkFBbUI7OztJQUU1Qix3Q0FBMkI7O0lBQzNCLDZDQUFnQzs7SUFDaEMsNENBQTJCOztJQUMzQix3Q0FBZ0M7O0lBRWhDLHdDQUE4Qzs7SUFFOUMsd0NBQTJDOztJQUMzQyw2Q0FBcUQ7O0lBQ3JELDZDQUFxRDs7SUFDckQsNkNBQXFEOztJQUVyRCxvREFBb0Q7Ozs7O0lBRXBELHFDQUFpQzs7Ozs7SUFDakMsaUNBQThCOztJQUNsQix1Q0FBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcyxcclxuICAgIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBWaWV3Q2hpbGQsIEluamVjdG9yLCBSZW5kZXJlcjIsIElucHV0LCBTaW1wbGVDaGFuZ2VzXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IHRyaWdnZXIsIHN0YXRlLCBzdHlsZSwgdHJhbnNpdGlvbiwgYW5pbWF0ZSB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xyXG5pbXBvcnQgeyBQZXJzb25hbENvbmZpZ1NlcnZpY2UgfSBmcm9tICcuL2xvb2t1cC1wcmVzb25hbENvbmZpZy5zZXJ2aWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsb29rdXAtdGFicycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vbG9va3VwLXRhYnMuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vbG9va3VwLXRhYnMuY29tcG9uZW50LnNjc3MnXSxcclxuICAgIGFuaW1hdGlvbnM6IFtcclxuICAgICAgICB0cmlnZ2VyKCdmbHlJbk91dCcsIFtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbignOmVudGVyJywgW3N0eWxlKHsgb3BhY2l0eTogMCB9KSwgYW5pbWF0ZSgnLjNzJywgc3R5bGUoeyBvcGFjaXR5OiAxIH0pKV0pLFxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCc6bGVhdmUnLCBbYW5pbWF0ZSgnLjNzJywgc3R5bGUoeyBvcGFjaXR5OiAwIH0pKV0pXHJcbiAgICAgICAgXSlcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIExvb2t1cFRhYnNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gICAgQElucHV0KCkgZW5hYmxlRmF2ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBlbmFibGVTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRUb3RhbCA9IDA7XHJcbiAgICBASW5wdXQoKSBhY3RpdmVUYWIgPSAnZGF0YWxpc3QnO1xyXG5cclxuICAgIEBPdXRwdXQoKSB0YWJDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdpbmtCYXInKSBpbmtCYXJSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdkYXRhTGlzdE5hdicpIGRhdGFMaXN0TmF2UmVmOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZmF2b3JpdGVOYXYnKSBmYXZvcml0ZU5hdlJlZjogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3NlbGVjdGVkTmF2Jykgc2VsZWN0ZWROYXZSZWY6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgcHVibGljIHBlcnNvbmFsQ29uZmlnU2VydmljZTogUGVyc29uYWxDb25maWdTZXJ2aWNlO1xyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZiA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzb25hbENvbmZpZ1NlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChQZXJzb25hbENvbmZpZ1NlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuICAgICAgICB0aGlzLmVsID0gdGhpcy5pbmplY3Rvci5nZXQoRWxlbWVudFJlZik7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmFjdGl2ZVRhYiAmJiAhY2hhbmdlcy5hY3RpdmVUYWIuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdElua0JhclBvcyhjaGFuZ2VzLmFjdGl2ZVRhYi5jdXJyZW50VmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdElua0JhclBvcyh0aGlzLmFjdGl2ZVRhYik7XHJcbiAgICAgICAgfSwgMzAwKTtcclxuICAgIH1cclxuXHJcbiAgICBuYXZDbGlja0hhbmRsZShlOiBFdmVudCwgdjogc3RyaW5nKSB7XHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVRhYiA9IHY7XHJcbiAgICAgICAgLy8gdGhpcy5wZXJzb25hbENvbmZpZ1NlcnZpY2UucGVyc29uYWxDb25mT2JzZXIkLm5leHQoe3RhYkluZGV4OiB2fSk7XHJcbiAgICAgICAgdGhpcy50YWJDaGFuZ2UuZW1pdCh7IGV2ZW50OiBlLCB0YWJJbmRleDogdiB9KTtcclxuICAgICAgICB0aGlzLmluaXRJbmtCYXJQb3Modik7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdElua0JhclBvcyh3aGljaDogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZhdiAmJiAhdGhpcy5lbmFibGVTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgd2lkdGggPSB0aGlzLmRhdGFMaXN0TmF2UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgbGV0IGxlZnQgPSAwO1xyXG4gICAgICAgIGlmICh3aGljaCAhPT0gJ2RhdGFsaXN0Jykge1xyXG4gICAgICAgICAgICBsZWZ0ID0gdGhpcy5kYXRhTGlzdE5hdlJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAod2hpY2ggPT09ICdmYXZvcml0ZScpIHtcclxuICAgICAgICAgICAgd2lkdGggPSB0aGlzLmZhdm9yaXRlTmF2UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aGljaCA9PT0gJ3NlbGVjdGVkJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mYXZvcml0ZU5hdlJlZikge1xyXG4gICAgICAgICAgICAgICAgbGVmdCArPSB0aGlzLmZhdm9yaXRlTmF2UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTmF2UmVmKSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMuc2VsZWN0ZWROYXZSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiID0gJ2RhdGFsaXN0JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbmtCYXJSZWYubmF0aXZlRWxlbWVudC5zdHlsZSA9IGB3aWR0aDogJHt3aWR0aH1weDsgdHJhbnNmb3JtOiB0cmFuc2xhdGUzZCgke2xlZnR9cHgsIDBweCwgMHB4KTtgO1xyXG4gICAgfVxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgLy8gdGhpcy5zaG93V2hpY2ggPSB0aGlzLnBlcnNvbmFsQ29uZmlnU2VydmljZS5nZXRBY3RpdmVUYWJJbmRleCgpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=