/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { takeUntil } from 'rxjs/operators';
import { DatagridComponent } from './../../datagrid.component';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 15:01:21
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-09 15:24:45
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ElementRef, Renderer2, ViewChild, Injector, Inject, forwardRef, ChangeDetectorRef } from '@angular/core';
import { DatagridService } from '../../services/datagrid.service';
import { FIXED_LEFT_SHADOW_CLS, FIXED_RIGHT_SHADOW_CLS, SCROLL_X_ACTION, SCROLL_X_REACH_START_ACTION } from '../../types/constant';
import { Subject } from 'rxjs';
export class DatagridFooterComponent {
    /**
     * @param {?} render
     * @param {?} injector
     * @param {?} dg
     */
    constructor(render, injector, dg) {
        this.render = render;
        this.injector = injector;
        this.dg = dg;
        this._footerData = [];
        /**
         * 显示位置，默认为 底部
         */
        this.position = 'bottom';
        /**
         * 是否有左侧固定列
         */
        this.hasFixedColumns = false;
        this.fast = false;
        this.scrollX = 0;
        this.showShadowCls = false;
        this.rightFixedColumnWidth = 0;
        this.cdRef = null;
        this.destroy$ = new Subject();
        this.dg = this.injector.get(DatagridComponent);
        this.dgs = this.injector.get(DatagridService);
        this.cdRef = this.injector.get(ChangeDetectorRef);
    }
    /**
     * @return {?}
     */
    get data() {
        return this._footerData;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set data(val) {
        this._footerData = val;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set fr(val) {
        if (val) {
            this.fixedRight = val;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.scrollEvents();
        this.renderFooterStyle();
        this.setFooterPosition(false);
        this.rightFixedColumnWidth = this.getRightFixedColWidth();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.position) {
            this.setFooterPosition(true);
        }
        if (changes.columnsGroup && !changes.columnsGroup.isFirstChange()) {
            this.rightFixedColumnWidth = this.getRightFixedColWidth();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
        if (this.scrollXSubscription) {
            this.scrollXSubscription.unsubscribe();
            this.scrollXSubscription = null;
        }
    }
    /**
     * @private
     * @return {?}
     */
    scrollEvents() {
        this.dgs.showGridHeader.pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} hh
         * @return {?}
         */
        hh => {
            this.setFooterPosition(false);
        }));
        this.scrollXSubscription = this.dgs.scorll$.pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} d
         * @return {?}
         */
        (d) => {
            this.scrollX = d.x;
            if (this.fast) {
                if (d.type === SCROLL_X_ACTION && this.footerBody2) {
                    this.footerBody2.nativeElement.scrollLeft = d.x;
                }
            }
            else {
                if (d.type === SCROLL_X_ACTION) {
                    if (!this.dg.footerTemplate) {
                        this.render.setStyle(this.footerBody.nativeElement, 'transform', `translate3d(-${d.x}px, 0px, 0px)`);
                        if (this.fixedLeft) {
                            if (d.x) {
                                this.render.addClass(this.fixedLeft.nativeElement, FIXED_LEFT_SHADOW_CLS);
                            }
                            else {
                                this.render.removeClass(this.fixedLeft.nativeElement, FIXED_LEFT_SHADOW_CLS);
                            }
                        }
                    }
                }
                if (d.type === SCROLL_X_REACH_START_ACTION) {
                    if (this.fixedLeft) {
                        this.render.removeClass(this.fixedLeft.nativeElement, FIXED_LEFT_SHADOW_CLS);
                    }
                }
            }
        }));
        if (!this.fast) {
            this.dgs.showFixedShadow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                if (this.fixedRight) {
                    this.setFixedColumnPosition(e.showRightShadow, e.x);
                }
            }));
            this.dgs.scrollbarUpdate.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} ps
             * @return {?}
             */
            (ps) => {
                this.rightFixedColumnWidth = this.getRightFixedColWidth(ps.scrollbarRef);
                if (this.fixedRight) {
                    this.setFixedColumnPosition(this.showShadowCls, 0);
                }
                if (this.cdRef) {
                    this.cdRef.detectChanges();
                }
            }));
        }
    }
    /**
     * @private
     * @param {?=} ps
     * @return {?}
     */
    getRightFixedColWidth(ps = null) {
        if (!this.columnsGroup) {
            return 0;
        }
        /** @type {?} */
        let w = this.columnsGroup.rightFixedWidth;
        if (!ps) {
            ps = this.dg.scrollInstance.instance;
        }
        if (ps && ps.scrollbarYActive && this.dg.scrollBarShowMode === 'allways') {
            // return w += 18;
            return w += this.showShadowCls ? 18 : 0;
        }
        return w;
    }
    /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    setFooterPosition(emit = true) {
        if (this.position === 'bottom') {
            /** @type {?} */
            let positionBottom = 0;
            if (this.dg.pagination) {
                positionBottom = this.dg.pagerHeight || 40;
            }
            this.render.removeStyle(this.footerContainer.nativeElement, 'top');
            this.render.setStyle(this.footerContainer.nativeElement, 'bottom', `${positionBottom}px`);
        }
        if (this.position === 'top') {
            /** @type {?} */
            let positionTop = 0;
            if (this.dg.showHeader) {
                positionTop = this.dg.realHeaderHeight || 35;
            }
            if (this.dg.showRowGroupPanel) {
                positionTop += this.dg.rowGroupPanelHeight;
            }
            if (this.dg.showFilterBar) {
                positionTop += this.dg.filterBarHeight;
            }
            this.render.removeStyle(this.footerContainer.nativeElement, 'bottom');
            this.render.setStyle(this.footerContainer.nativeElement, 'top', `${positionTop}px`);
        }
        if (emit) {
            this.dgs.footerPositionChanged.emit();
        }
    }
    /**
     * @private
     * @return {?}
     */
    renderFooterStyle() {
        if (this.dg.footerStyler) {
            /** @type {?} */
            const trStyleAndCls = this.dgs.getCustomStyle(this.dg.footerStyler, null);
            /** @type {?} */
            const cssRuleID = `${this.dg.customStyleKey()} .f-datagrid-footer`;
            /** @type {?} */
            const cssRuleId2 = `${this.dg.customStyleKey()} .f-datagrid-footer .f-datagrid-body-fixed-left,${this.dg.customStyleKey()} .f-datagrid-footer .f-datagrid-body-fixed-right`;
            /** @type {?} */
            const cssRuleId3 = `${this.dg.customStyleKey()}.f-datagrid-fast .f-datagrid-cell.f-datagrid-fast__fixed-left,${this.dg.customStyleKey()}.f-datagrid-fast .f-datagrid-cell.f-datagrid-fast__fixed-right`;
            if (trStyleAndCls && Object.keys(trStyleAndCls).length) {
                /** @type {?} */
                const cssRule = [];
                if (trStyleAndCls.style) {
                    cssRule.push(`${cssRuleID} ${JSON.stringify(trStyleAndCls.style)}`);
                    cssRule.push(`${cssRuleId2} ${JSON.stringify(trStyleAndCls.style)}`);
                    if (this.fast) {
                        cssRule.push(`${cssRuleId3} ${JSON.stringify(trStyleAndCls.style)}`);
                    }
                }
                this.dgs.appendCssRules(cssRule);
                // this.dg.renderCustomStyle(trStyleAndCls, this.footerContainer.nativeElement, cssRule);
            }
            else {
                this.dgs.removeCssRule([cssRuleID, cssRuleId2]);
            }
        }
    }
    /**
     * @param {?} isShow
     * @param {?} scrollLeft
     * @return {?}
     */
    setFixedColumnPosition(isShow, scrollLeft) {
        this.showShadowCls = isShow;
        /** @type {?} */
        const method = isShow ? 'addClass' : 'removeClass';
        this.render[method](this.fixedRight.nativeElement, FIXED_RIGHT_SHADOW_CLS);
        /** @type {?} */
        const realWidth = this.columnsGroup.leftFixedWidth + this.columnsGroup.normalWidth + this.rightFixedColumnWidth;
        /** @type {?} */
        const gridWidth = this.dg.width;
        /** @type {?} */
        let l = this.dg.width - (this.dg.showBorder ? 2 : 0) - this.rightFixedColumnWidth;
        if (gridWidth > realWidth) {
            l = this.columnsGroup.leftFixedWidth + this.columnsGroup.normalWidth;
        }
        this.render.setStyle(this.fixedRight.nativeElement, 'left', l + 'px');
    }
}
DatagridFooterComponent.decorators = [
    { type: Component, args: [{
                selector: 'datagrid-footer',
                template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-12 15:02:10\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-10-31 14:50:47\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n <ng-template #footer_content_template_fast let-columns let-left=\"fixedLeft\" let-right=\"fixedRight\">\r\n    <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border:0;\" class=\"f-datagrid-rows\" [style.width.px]=\"columnsGroup?.normalWidth\" >\r\n        <colgroup>\r\n            <col width=\"36px\" *ngIf=\"dg.showCheckbox\"/>\r\n            <col [width]=\"dg.lineNumberWidth + 'px'\" *ngIf=\"dg.showLineNumber\"/>\r\n            <col *ngFor=\"let col of columns\" [width]=\"col.width + 'px'\"/>\r\n        </colgroup>\r\n        <tbody>\r\n            <tr #tr class=\"f-datagrid-body-row f-datagrid-footer-row\"\r\n                [attr.id]=\"'footer-'+ (row| rowDataId: right: left)\"\r\n                *ngFor=\"let row of data;let rowIndex = index;trackBy: dg.trackByRows\" \r\n                [attr.index]=\"rowIndex\">\r\n\r\n                <td *ngIf=\"dg.showCheckbox\" class=\"f-datagrid-cell f-datagrid-cell-checkbox\" style=\"text-align: center; left: 0\"\r\n                [class.f-datagrid-fast__fixed-left]=\"dg.fast\" [class.l-shadow-col]=\"!dg.showLineNumber && !hasFixedColumns\"></td>\r\n                <td *ngIf=\"dg.showLineNumber\" class=\"f-datagrid-cell f-datagrid-cell-rownumber\" \r\n                [class.f-datagrid-fast__fixed-left]=\"dg.fast\"  [style.left.px]=\"dg.showCheckbox ? 36: 0\" [class.l-shadow-col]=\"!hasFixedColumns\"></td>\r\n\r\n                <td class=\"f-datagrid-cell {{ 'footer-td-'+ col.field }}\"\r\n                    [style.width.px]=\"col.width\"\r\n                    [attr.colspan]=\"col.footer?.colspan || 1\"\r\n                    [style.display]=\"col.footer?.visible === false ? 'none': ''\"\r\n                    [attr.field]=\"col.field\" [attr.align]=\"col.footer?.align || col.align\"\r\n                    *ngFor=\"let col of columns; let ci = index;\"\r\n                    footer-cell-styler [column]=\"col\" [rowData]=\"row\" [rowIndex]=\"rowIndex\"\r\n                    [class.f-datagrid-fast__fixed-left]=\" col.fixed && col.fixed === 'left'\"\r\n                    [class.f-datagrid-fast__fixed-right]=\" col.fixed && col.fixed === 'right'\"\r\n                    [class.r-shadow-col]=\"col.rightShadowCol\"\r\n                    [class.l-shadow-col]=\"col.leftShadowCol\">\r\n                    <div class=\"f-datagrid-cell-content\" style=\"width: 100%\">\r\n                        <span *ngIf=\"col.footer && col.footer.formatter\" [innerHtml]=\"col | formatCellData: row : false: true | safe: 'html'\"></span>\r\n                        <span *ngIf=\"!col.footer || !col.footer.formatter\">{{ col | formatCellData: row : false: true }}</span>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</ng-template>\r\n<ng-template #footer_content_template let-columns let-left=\"fixedLeft\" let-right=\"fixedRight\">\r\n    <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border:0; width: 100%;height: 100%;\" class=\"f-datagrid-rows\">\r\n        <colgroup>\r\n            <col width=\"36px\" *ngIf=\"dg.showCheckbox && left\"/>\r\n            <col [width]=\"dg.lineNumberWidth + 'px'\" *ngIf=\"dg.showLineNumber && left\"/>\r\n            <col *ngFor=\"let col of columns\" [width]=\"col.width + 'px'\"/>\r\n        </colgroup>\r\n        <tbody>\r\n            <tr #tr class=\"f-datagrid-body-row f-datagrid-footer-row\"\r\n                [attr.id]=\"'footer-'+ (row| rowDataId: right: left)\"\r\n                *ngFor=\"let row of data;let rowIndex = index;trackBy: dg.trackByRows\" \r\n                [attr.index]=\"rowIndex\">\r\n\r\n                <td *ngIf=\"dg.showCheckbox && left\" class=\"f-datagrid-cell f-datagrid-cell-checkbox\" style=\"text-align: center\"></td>\r\n                <td *ngIf=\"dg.showLineNumber  && left\" class=\"f-datagrid-cell f-datagrid-cell-rownumber\" ></td>\r\n\r\n                <td class=\"f-datagrid-cell {{ 'footer-td-'+ col.field }}\"\r\n                    [style.width.px]=\"col.width\"\r\n                    [attr.colspan]=\"col.footer?.colspan || 1\"\r\n                    [style.display]=\"col.footer?.visible === false ? 'none': ''\"\r\n                    [attr.field]=\"col.field\" [attr.align]=\"col.footer?.align || col.align\"\r\n                    *ngFor=\"let col of columns; let ci = index;\"\r\n                    footer-cell-styler [column]=\"col\" [rowData]=\"row\" [rowIndex]=\"rowIndex\">\r\n                    <div class=\"f-datagrid-cell-content\" style=\"width: 100%\">\r\n                        <span *ngIf=\"col.footer && col.footer.formatter\" [innerHtml]=\"col | formatCellData: row : false: true | safe: 'html'\"></span>\r\n                        <span *ngIf=\"!col.footer || !col.footer.formatter\">{{ col | formatCellData: row : false: true }}</span>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</ng-template>\r\n\r\n<div #footerContainer class=\"f-datagrid-footer\" [style.height.px]=\"height\"\r\n    [class.f-datagrid-footer-top]=\"position === 'top'\" [class.f-datagrid-footer-bottom]=\"position === 'bottom'\">\r\n    <ng-container *ngIf=\"!dg.footerTemplate\">\r\n        \r\n        <div #fixedLeft class=\"f-datagrid-body-fixed-left\" \r\n            [style.width.px]=\"columnsGroup?.leftFixedWidth\" style=\"height: 100%;\"\r\n            *ngIf=\"!fast && (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length  || dg?.showLineNumber || dg?.showCheckbox) \">\r\n\r\n            <ng-container *ngTemplateOutlet=\"footer_content_template; context: {$implicit: columnsGroup?.leftFixed, fixedLeft: true}\"></ng-container>\r\n            \r\n        </div>\r\n\r\n        <div #fixedRight class=\"f-datagrid-body-fixed-right\" style=\"position: absolute;border: 0;height: 100%;\"\r\n            [style.width.px]=\"rightFixedColumnWidth\" \r\n            *ngIf=\"!fast && columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\">\r\n\r\n            <ng-container *ngTemplateOutlet=\"footer_content_template; context: {$implicit: columnsGroup?.rightFixed, fixedRight: true}\"></ng-container>\r\n            \r\n        </div>\r\n\r\n        <div #footerBody class=\"f-datagrid-footer-rows\" style=\"position: absolute; height: 100%;\" *ngIf=\"!fast\"\r\n            [style.left.px]=\"columnsGroup?.leftFixedWidth\" [style.width.px]=\"columnsGroup?.normalWidth\" >\r\n            <ng-container *ngTemplateOutlet=\"footer_content_template; context: {$implicit: columnsGroup?.normalColumns}\"></ng-container>\r\n        </div>\r\n\r\n\r\n        <div #footerBody2 class=\"f-datagrid-footer-rows\" style=\"position: absolute;width: 100%\" *ngIf=\"fast\">\r\n            <ng-container *ngTemplateOutlet=\"footer_content_template_fast; context: {$implicit: columnsGroup?.columns}\"></ng-container>\r\n        </div>\r\n\r\n\r\n    </ng-container>\r\n\r\n\r\n    <ng-container *ngIf=\"dg.footerTemplate\" [ngTemplateOutlet]=\"dg.footerTemplate\" [ngTemplateOutletContext]=\"{footerData: data }\" ></ng-container>\r\n    \r\n</div>"
            }] }
];
/** @nocollapse */
DatagridFooterComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: Injector },
    { type: DatagridComponent, decorators: [{ type: Inject, args: [forwardRef((/**
                     * @return {?}
                     */
                    () => DatagridComponent)),] }] }
];
DatagridFooterComponent.propDecorators = {
    data: [{ type: Input }],
    height: [{ type: Input }],
    width: [{ type: Input }],
    columns: [{ type: Input }],
    columnsGroup: [{ type: Input }],
    position: [{ type: Input }],
    hasFixedColumns: [{ type: Input }],
    fast: [{ type: Input }],
    footerContainer: [{ type: ViewChild, args: ['footerContainer',] }],
    footerBody: [{ type: ViewChild, args: ['footerBody',] }],
    footerBody2: [{ type: ViewChild, args: ['footerBody2',] }],
    fixedLeft: [{ type: ViewChild, args: ['fixedLeft',] }],
    fr: [{ type: ViewChild, args: ['fixedRight',] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype._footerData;
    /** @type {?} */
    DatagridFooterComponent.prototype.height;
    /** @type {?} */
    DatagridFooterComponent.prototype.width;
    /** @type {?} */
    DatagridFooterComponent.prototype.columns;
    /** @type {?} */
    DatagridFooterComponent.prototype.columnsGroup;
    /**
     * 显示位置，默认为 底部
     * @type {?}
     */
    DatagridFooterComponent.prototype.position;
    /**
     * 是否有左侧固定列
     * @type {?}
     */
    DatagridFooterComponent.prototype.hasFixedColumns;
    /** @type {?} */
    DatagridFooterComponent.prototype.fast;
    /** @type {?} */
    DatagridFooterComponent.prototype.footerContainer;
    /** @type {?} */
    DatagridFooterComponent.prototype.footerBody;
    /** @type {?} */
    DatagridFooterComponent.prototype.footerBody2;
    /** @type {?} */
    DatagridFooterComponent.prototype.fixedLeft;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.fixedRight;
    /** @type {?} */
    DatagridFooterComponent.prototype.scrollXSubscription;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.dgs;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.scrollX;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.showShadowCls;
    /** @type {?} */
    DatagridFooterComponent.prototype.rightFixedColumnWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.cdRef;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridFooterComponent.prototype.injector;
    /** @type {?} */
    DatagridFooterComponent.prototype.dg;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtZm9vdGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9mb290ZXIvZGF0YWdyaWQtZm9vdGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDOzs7Ozs7Ozs7QUFTL0QsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQWEsUUFBUSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQTRCLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2pMLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNsRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsc0JBQXNCLEVBQUUsZUFBZSxFQUFFLDJCQUEyQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkksT0FBTyxFQUFnQixPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFNN0MsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7O0lBc0NoQyxZQUNZLE1BQWlCLEVBQVUsUUFBa0IsRUFDRCxFQUFxQjtRQURqRSxXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNELE9BQUUsR0FBRixFQUFFLENBQW1CO1FBdkNyRSxnQkFBVyxHQUFHLEVBQUUsQ0FBQzs7OztRQWNoQixhQUFRLEdBQXFCLFFBQVEsQ0FBQzs7OztRQUV0QyxvQkFBZSxHQUFHLEtBQUssQ0FBQztRQUN4QixTQUFJLEdBQUcsS0FBSyxDQUFDO1FBZWQsWUFBTyxHQUFHLENBQUMsQ0FBQztRQUNaLGtCQUFhLEdBQUcsS0FBSyxDQUFDO1FBQzlCLDBCQUFxQixHQUFHLENBQUMs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QUMsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUMxRSxDQUFDOzs7WUE1T0osU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxpQkFBaUI7Z0JBQzNCLDJxT0FBK0M7YUFDbEQ7Ozs7WUFSOEMsU0FBUztZQUF3QixRQUFRO1lBVC9FLGlCQUFpQix1QkEwRGpCLE1BQU0sU0FBQyxVQUFVOzs7b0JBQUMsR0FBRyxFQUFFLENBQUMsaUJBQWlCLEVBQUM7OzttQkF0QzlDLEtBQUs7cUJBT0wsS0FBSztvQkFDTCxLQUFLO3NCQUNMLEtBQUs7MkJBQ0wsS0FBSzt1QkFHTCxLQUFLOzhCQUVMLEtBQUs7bUJBQ0wsS0FBSzs4QkFFTCxTQUFTLFNBQUMsaUJBQWlCO3lCQUMzQixTQUFTLFNBQUMsWUFBWTswQkFDdEIsU0FBUyxTQUFDLGFBQWE7d0JBQ3ZCLFNBQVMsU0FBQyxXQUFXO2lCQUVyQixTQUFTLFNBQUMsWUFBWTs7Ozs7OztJQXhCdkIsOENBQXlCOztJQVF6Qix5Q0FBd0I7O0lBQ3hCLHdDQUF1Qjs7SUFDdkIsMENBQXdCOztJQUN4QiwrQ0FBMkI7Ozs7O0lBRzNCLDJDQUErQzs7Ozs7SUFFL0Msa0RBQWlDOztJQUNqQyx1Q0FBc0I7O0lBRXRCLGtEQUEwRDs7SUFDMUQsNkNBQWdEOztJQUNoRCw4Q0FBa0Q7O0lBQ2xELDRDQUE4Qzs7Ozs7SUFDOUMsNkNBQStCOztJQU0vQixzREFBa0M7Ozs7O0lBRWxDLHNDQUE2Qjs7Ozs7SUFDN0IsMENBQW9COzs7OztJQUNwQixnREFBOEI7O0lBQzlCLHdEQUEwQjs7Ozs7SUFDMUIsd0NBQXdDOzs7OztJQUN4QywyQ0FBaUM7Ozs7O0lBRTdCLHlDQUF5Qjs7Ozs7SUFBRSwyQ0FBMEI7O0lBQ3JELHFDQUF5RSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRha2VVbnRpbCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICcuLy4uLy4uL2RhdGFncmlkLmNvbXBvbmVudCc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMTIgMTU6MDE6MjFcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMDkgMTU6MjQ6NDVcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgRWxlbWVudFJlZiwgUmVuZGVyZXIyLCBWaWV3Q2hpbGQsIE9uRGVzdHJveSwgSW5qZWN0b3IsIEluamVjdCwgZm9yd2FyZFJlZiwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kYXRhZ3JpZC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRklYRURfTEVGVF9TSEFET1dfQ0xTLCBGSVhFRF9SSUdIVF9TSEFET1dfQ0xTLCBTQ1JPTExfWF9BQ1RJT04sIFNDUk9MTF9YX1JFQUNIX1NUQVJUX0FDVElPTiB9IGZyb20gJy4uLy4uL3R5cGVzL2NvbnN0YW50JztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZGF0YWdyaWQtZm9vdGVyJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9kYXRhZ3JpZC1mb290ZXIuY29tcG9uZW50Lmh0bWwnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhZ3JpZEZvb3RlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xyXG4gICAgcHJpdmF0ZSBfZm9vdGVyRGF0YSA9IFtdO1xyXG4gICAgQElucHV0KCkgZ2V0IGRhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvb3RlckRhdGE7XHJcbiAgICB9XHJcbiAgICBzZXQgZGF0YSh2YWw6IGFueVtdKSB7XHJcbiAgICAgICAgdGhpcy5fZm9vdGVyRGF0YSA9IHZhbDtcclxuICAgIH1cclxuXHJcbiAgICBASW5wdXQoKSBoZWlnaHQ6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIHdpZHRoOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zOiBhbnlbXTtcclxuICAgIEBJbnB1dCgpIGNvbHVtbnNHcm91cDogYW55O1xyXG5cclxuICAgIC8qKiDmmL7npLrkvY3nva7vvIzpu5jorqTkuLog5bqV6YOoICovXHJcbiAgICBASW5wdXQoKSBwb3NpdGlvbjogJ3RvcCcgfCAnYm90dG9tJyA9ICdib3R0b20nO1xyXG4gICAgLyoqIOaYr+WQpuacieW3puS+p+WbuuWumuWIlyAqL1xyXG4gICAgQElucHV0KCkgaGFzRml4ZWRDb2x1bW5zID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBmYXN0ID0gZmFsc2U7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnZm9vdGVyQ29udGFpbmVyJykgZm9vdGVyQ29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZm9vdGVyQm9keScpIGZvb3RlckJvZHk6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdmb290ZXJCb2R5MicpIGZvb3RlckJvZHkyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRMZWZ0JykgZml4ZWRMZWZ0OiBFbGVtZW50UmVmO1xyXG4gICAgcHJpdmF0ZSBmaXhlZFJpZ2h0OiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRSaWdodCcpIHNldCBmcih2YWwpIHtcclxuICAgICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodCA9IHZhbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzY3JvbGxYU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgcHJpdmF0ZSBkZ3M6IERhdGFncmlkU2VydmljZTtcclxuICAgIHByaXZhdGUgc2Nyb2xsWCA9IDA7XHJcbiAgICBwcml2YXRlIHNob3dTaGFkb3dDbHMgPSBmYWxzZTtcclxuICAgIHJpZ2h0Rml4ZWRDb2x1bW5XaWR0aCA9IDA7XHJcbiAgICBwcml2YXRlIGNkUmVmOiBDaGFuZ2VEZXRlY3RvclJlZiA9IG51bGw7XHJcbiAgICBwcml2YXRlIGRlc3Ryb3kkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIEBJbmplY3QoZm9yd2FyZFJlZigoKSA9PiBEYXRhZ3JpZENvbXBvbmVudCkpIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnRcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZGcgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZENvbXBvbmVudCk7XHJcbiAgICAgICAgdGhpcy5kZ3MgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuY2RSZWYgPSB0aGlzLmluamVjdG9yLmdldChDaGFuZ2VEZXRlY3RvclJlZik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsRXZlbnRzKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJGb290ZXJTdHlsZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0Rm9vdGVyUG9zaXRpb24oZmFsc2UpO1xyXG5cclxuICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRDb2x1bW5XaWR0aCA9IHRoaXMuZ2V0UmlnaHRGaXhlZENvbFdpZHRoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLnBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9vdGVyUG9zaXRpb24odHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5jb2x1bW5zR3JvdXAgJiYgIWNoYW5nZXMuY29sdW1uc0dyb3VwLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRDb2x1bW5XaWR0aCA9IHRoaXMuZ2V0UmlnaHRGaXhlZENvbFdpZHRoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsWFN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFhTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxYU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzY3JvbGxFdmVudHMoKSB7XHJcbiAgICAgICAgdGhpcy5kZ3Muc2hvd0dyaWRIZWFkZXIucGlwZShcclxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoaGggPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldEZvb3RlclBvc2l0aW9uKGZhbHNlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zY3JvbGxYU3Vic2NyaXB0aW9uID0gdGhpcy5kZ3Muc2NvcmxsJC5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICApLnN1YnNjcmliZSgoZDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsWCA9IGQueDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZhc3QpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkLnR5cGUgPT09IFNDUk9MTF9YX0FDVElPTiAmJiB0aGlzLmZvb3RlckJvZHkyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb290ZXJCb2R5Mi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSBkLng7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICAgICAgaWYgKGQudHlwZSA9PT0gU0NST0xMX1hfQUNUSU9OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLmZvb3RlclRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZm9vdGVyQm9keS5uYXRpdmVFbGVtZW50LCAgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgtJHtkLnh9cHgsIDBweCwgMHB4KWAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZml4ZWRMZWZ0Lm5hdGl2ZUVsZW1lbnQsIEZJWEVEX0xFRlRfU0hBRE9XX0NMUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKHRoaXMuZml4ZWRMZWZ0Lm5hdGl2ZUVsZW1lbnQsIEZJWEVEX0xFRlRfU0hBRE9XX0NMUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGQudHlwZSA9PT0gU0NST0xMX1hfUkVBQ0hfU1RBUlRfQUNUSU9OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKHRoaXMuZml4ZWRMZWZ0Lm5hdGl2ZUVsZW1lbnQsIEZJWEVEX0xFRlRfU0hBRE9XX0NMUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZmFzdCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kZ3Muc2hvd0ZpeGVkU2hhZG93LnBpcGUoXHJcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rml4ZWRDb2x1bW5Qb3NpdGlvbihlLnNob3dSaWdodFNoYWRvdywgZS54KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLnBpcGUoXHJcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICAgICAgKS5zdWJzY3JpYmUoKHBzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZENvbHVtbldpZHRoID0gdGhpcy5nZXRSaWdodEZpeGVkQ29sV2lkdGgocHMuc2Nyb2xsYmFyUmVmKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEZpeGVkQ29sdW1uUG9zaXRpb24odGhpcy5zaG93U2hhZG93Q2xzLCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNkUmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZFJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJpZ2h0Rml4ZWRDb2xXaWR0aChwcyA9IG51bGwpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY29sdW1uc0dyb3VwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHcgPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcblxyXG4gICAgICAgIGlmICghcHMpIHtcclxuICAgICAgICAgICAgcHMgPSB0aGlzLmRnLnNjcm9sbEluc3RhbmNlLmluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHBzICYmIHBzLnNjcm9sbGJhcllBY3RpdmUgJiYgdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnKSB7XHJcbiAgICAgICAgICAgIC8vIHJldHVybiB3ICs9IDE4O1xyXG4gICAgICAgICAgICByZXR1cm4gdyArPSB0aGlzLnNob3dTaGFkb3dDbHMgPyAxOCA6IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB3O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0Rm9vdGVyUG9zaXRpb24oZW1pdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ2JvdHRvbScpIHtcclxuICAgICAgICAgICAgbGV0IHBvc2l0aW9uQm90dG9tID0gMDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcucGFnaW5hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb25Cb3R0b20gPSB0aGlzLmRnLnBhZ2VySGVpZ2h0IHx8IDQwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZVN0eWxlKHRoaXMuZm9vdGVyQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsICd0b3AnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5mb290ZXJDb250YWluZXIubmF0aXZlRWxlbWVudCwgJ2JvdHRvbScsIGAke3Bvc2l0aW9uQm90dG9tfXB4YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uID09PSAndG9wJykge1xyXG4gICAgICAgICAgICBsZXQgcG9zaXRpb25Ub3AgPSAwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zaG93SGVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvblRvcCA9IHRoaXMuZGcucmVhbEhlYWRlckhlaWdodCB8fCAzNTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd1Jvd0dyb3VwUGFuZWwpIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uVG9wICs9IHRoaXMuZGcucm93R3JvdXBQYW5lbEhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb25Ub3AgKz0gdGhpcy5kZy5maWx0ZXJCYXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZVN0eWxlKHRoaXMuZm9vdGVyQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsICdib3R0b20nKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5mb290ZXJDb250YWluZXIubmF0aXZlRWxlbWVudCwgJ3RvcCcsIGAke3Bvc2l0aW9uVG9wfXB4YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLmZvb3RlclBvc2l0aW9uQ2hhbmdlZC5lbWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyRm9vdGVyU3R5bGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZm9vdGVyU3R5bGVyKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0clN0eWxlQW5kQ2xzID0gdGhpcy5kZ3MuZ2V0Q3VzdG9tU3R5bGUodGhpcy5kZy5mb290ZXJTdHlsZXIsIG51bGwpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY3NzUnVsZUlEID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1mb290ZXJgO1xyXG4gICAgICAgICAgICBjb25zdCBjc3NSdWxlSWQyID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1mb290ZXIgLmYtZGF0YWdyaWQtYm9keS1maXhlZC1sZWZ0LCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1mb290ZXIgLmYtZGF0YWdyaWQtYm9keS1maXhlZC1yaWdodGA7XHJcbiAgICAgICAgICAgIGNvbnN0IGNzc1J1bGVJZDMgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9LmYtZGF0YWdyaWQtZmFzdCAuZi1kYXRhZ3JpZC1jZWxsLmYtZGF0YWdyaWQtZmFzdF9fZml4ZWQtbGVmdCwke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0uZi1kYXRhZ3JpZC1mYXN0IC5mLWRhdGFncmlkLWNlbGwuZi1kYXRhZ3JpZC1mYXN0X19maXhlZC1yaWdodGA7XHJcblxyXG4gICAgICAgICAgICBpZiAodHJTdHlsZUFuZENscyAmJiBPYmplY3Qua2V5cyh0clN0eWxlQW5kQ2xzKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNzc1J1bGUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGlmICh0clN0eWxlQW5kQ2xzLnN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzUnVsZS5wdXNoKGAke2Nzc1J1bGVJRH0gJHtKU09OLnN0cmluZ2lmeSh0clN0eWxlQW5kQ2xzLnN0eWxlKX1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjc3NSdWxlLnB1c2goYCR7Y3NzUnVsZUlkMn0gJHtKU09OLnN0cmluZ2lmeSh0clN0eWxlQW5kQ2xzLnN0eWxlKX1gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZmFzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NSdWxlLnB1c2goYCR7Y3NzUnVsZUlkM30gJHtKU09OLnN0cmluZ2lmeSh0clN0eWxlQW5kQ2xzLnN0eWxlKX1gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ3MuYXBwZW5kQ3NzUnVsZXMoY3NzUnVsZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5kZy5yZW5kZXJDdXN0b21TdHlsZSh0clN0eWxlQW5kQ2xzLCB0aGlzLmZvb3RlckNvbnRhaW5lci5uYXRpdmVFbGVtZW50LCBjc3NSdWxlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGdzLnJlbW92ZUNzc1J1bGUoW2Nzc1J1bGVJRCwgY3NzUnVsZUlkMl0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRGaXhlZENvbHVtblBvc2l0aW9uKGlzU2hvdywgc2Nyb2xsTGVmdCkge1xyXG4gICAgICAgIHRoaXMuc2hvd1NoYWRvd0NscyA9IGlzU2hvdztcclxuICAgICAgICBjb25zdCBtZXRob2QgPSBpc1Nob3cgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJztcclxuICAgICAgICB0aGlzLnJlbmRlclttZXRob2RdKHRoaXMuZml4ZWRSaWdodC5uYXRpdmVFbGVtZW50LCBGSVhFRF9SSUdIVF9TSEFET1dfQ0xTKTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVhbFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubGVmdEZpeGVkV2lkdGggKyB0aGlzLmNvbHVtbnNHcm91cC5ub3JtYWxXaWR0aCArIHRoaXMucmlnaHRGaXhlZENvbHVtbldpZHRoO1xyXG4gICAgICAgIGNvbnN0IGdyaWRXaWR0aCA9IHRoaXMuZGcud2lkdGg7XHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmRnLndpZHRoIC0gKHRoaXMuZGcuc2hvd0JvcmRlciA/IDIgOiAwKSAtIHRoaXMucmlnaHRGaXhlZENvbHVtbldpZHRoO1xyXG4gICAgICAgIGlmIChncmlkV2lkdGggPiByZWFsV2lkdGgpIHtcclxuICAgICAgICAgICAgbCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoICsgdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZml4ZWRSaWdodC5uYXRpdmVFbGVtZW50LCAnbGVmdCcsIGwgKyAncHgnKTtcclxuICAgIH1cclxufVxyXG4iXX0=