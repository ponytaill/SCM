/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { delay, debounceTime, takeUntil } from 'rxjs/operators';
import { of, Subject } from 'rxjs';
import ResizeObserver from 'resize-observer-polyfill';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 07:47:12
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-26 10:21:25
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, ChangeDetectorRef, ChangeDetectionStrategy, NgZone, Injector, Optional, ApplicationRef, Output, EventEmitter } from '@angular/core';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { ScrollbarDirective } from '../../scrollbar/scrollbar.directive';
import { SCROLL_X_ACTION, SCROLL_Y_ACTION, SCROLL_X_REACH_START_ACTION, TR_PREFIX } from '../../types/constant';
import { DatagridService } from '../../services/datagrid.service';
import { DatagridComponent } from '../../datagrid.component';
import { FormatCellDataPipe } from '../../utils/format-cell-data.pipe';
import { ColumnFormatService } from '@farris/ui-common/column';
import { Utils } from '../../utils/utils';
var DatagridBodyComponent = /** @class */ (function () {
    function DatagridBodyComponent(injector, app, dg, cd, el) {
        var _this = this;
        this.injector = injector;
        this.app = app;
        this.dg = dg;
        this.cd = cd;
        this.el = el;
        // 自动高度时，禁用纵向滚动条
        this.psConfig = { swipeEasing: false, minScrollbarLength: 15, handlers: ['click-rail', 'drag-thumb', 'wheel', 'touch'], suppressScrollY: this.dg.autoHeight && this.dg.maxHeight ? false : this.dg.autoHeight };
        this.scrollTop = 0;
        this.scrollLeft = 0;
        this.deltaTopHeight = 0;
        // wheelHeight = 0;
        this.wheelWidth = 0;
        this._fixedRightScrollLeft = 0;
        this.maxScrollLeft = 0;
        this.showRightShadow = false;
        this.footerHeight = 0;
        // 虚拟加载
        this.topHideHeight = 0;
        this.bottomHideHeight = 0;
        this.startRowIndex = 0;
        this.dataChange = new EventEmitter();
        this.scrollBarMode = 'auto';
        this.checkedRows = [];
        /**
         * 性能优化版，默认为 false
         */
        this.fast = false;
        this.visibleContextMenus = [];
        this.currentRowId = undefined;
        this._hoverRowIndex = -1;
        this.subscriptions = [];
        this.minRowBuffer = 3;
        this.vScrollDir = 1;
        this.rowsCache = {};
        this.lastRenderedScrollTop = 0;
        this.lastRenderedScrollLeft = 0;
        this.prevScrollTop = 0;
        this.prevScrollLeft = 0;
        this.rows = [];
        this.blankTopHeight = 0;
        this.blankBottomHeight = 0;
        this.cellContentFormatter = null;
        // 当启用多选且允许多选中，列表不能编辑时，取选中后禁止触发body 的click 事件
        this.__triggerBodyClickEvent = true;
        this.destroy$ = new Subject();
        this._onMouseClick = null;
        this._scrollTimer = 0;
        this._scrollXTimer = 0;
        this.ro = null;
        this.resizeObserverTimer = 0;
        this.onBeforeShowContextMenu = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            // row_1_fixedleft  row_1  row_1_fixedright
            var contextMenuDom = e.contextMenuDom, event = e.event;
            if (event.target.closest('.datagrid-editor')) {
                return of({ show: false });
            }
            /** @type {?} */
            var rowID = event.target.id;
            if (contextMenuDom) {
                // 排除分组行、分组合计行
                if (contextMenuDom.className.indexOf('f-datagrid-group-row') === -1 && contextMenuDom.className.indexOf('f-datagrid-group-footer') === -1) {
                    rowID = contextMenuDom.id.replace('row_', '').replace('_fixedleft', '').replace('_fixedright', '');
                    /** @type {?} */
                    var rowData = _this.dfs.findRow(rowID);
                    /** @type {?} */
                    var focusTargetWidth = _this.viewportW > _this.totalWidth ? _this.totalWidth : _this.viewportW;
                    return of({ show: true, data: { data: rowData.data, grid: _this.dg }, focusTargetWidth: focusTargetWidth });
                }
            }
            return of({ show: false });
        });
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        this.ngZone = this.injector.get(NgZone);
        this.render = this.injector.get(Renderer2);
        /** @type {?} */
        var columnFormatService = this.injector.get(ColumnFormatService);
        this.cellContentFormatter = new FormatCellDataPipe(columnFormatService, this.injector);
    }
    Object.defineProperty(DatagridBodyComponent.prototype, "fixedRightScrollLeft", {
        get: /**
         * @return {?}
         */
        function () {
            return this._fixedRightScrollLeft;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._fixedRightScrollLeft = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "hoverRowIndex", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hoverRowIndex;
        },
        set: /**
         * @param {?} rowIdx
         * @return {?}
         */
        function (rowIdx) {
            this._hoverRowIndex = rowIdx;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "selectedRows", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dg.selections;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarXHeight", {
        //////////////////////////////////////////////////////////////////////////
        get: 
        //////////////////////////////////////////////////////////////////////////
        /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                /** @type {?} */
                var h = this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 22 : 0;
                if (this.ps.instance['scrollbarYActive'] && h) {
                    return h + 18; // + (this.dg.showScrollArrow && this.ps.instance['scrollbarYActive'] ? 18 : 0);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarYWidth", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                return this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarYActive'] && this.showRightShadow ? 18 : 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.listenSubjects();
        this.dg.scrollInstance = this.ps;
        /** @type {?} */
        var s1 = this.dgs.showGridHeader.subscribe((/**
         * @param {?} headerHeight
         * @return {?}
         */
        function (headerHeight) {
            _this.updateContainerSize(headerHeight);
        }));
        this.subscriptions.push(s1);
        /** @type {?} */
        var s10 = this.dgs.footerPositionChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.updateContainerSize();
        }));
        this.subscriptions.push(s10);
        /** @type {?} */
        var s2 = this.dgs.rowHeightChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(s2);
        /** @type {?} */
        var s3 = this.dfs.clientSort$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition(true);
            _this.cd.detectChanges();
            // this.dg.columnSorted.emit();
        }));
        this.subscriptions.push(s3);
        /** @type {?} */
        var s5 = this.dg.dgs.columnsChanged.pipe(delay(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e && e.scrollToLeft) {
                _this.ps.elementRef.nativeElement.scrollTo(0, 0);
                _this.ps.scrollToLeft(0, 100);
            }
        }));
        this.subscriptions.push(s5);
        this.viewScrollContainer.nativeElement.addEventListener('click', this._onMouseClick = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.onMouseClick(e);
        }));
    };
    /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateContainerSize = /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        /** @type {?} */
        var hh = headerHeight || this.dg.realHeaderHeight;
        this.setPositionTop(hh);
        this.height = this.dg.height - this.top;
        this.bodyStyle = this.getBodyStyle();
        this.cd.detectChanges();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.data && !changes.data.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
            this.dfs.setCurrentPageData(changes.data.currentValue);
            /** @type {?} */
            var isDiffrentDataSource = !!changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.id; })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return !changes.data.previousValue.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group__']; })).find((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === n; }));
            })).length;
            /** @type {?} */
            var isSameLength = changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).length >= changes.data.previousValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).length;
            this.onDataChanged(isSameLength, isDiffrentDataSource);
            if (!changes.data.currentValue || !changes.data.currentValue.length) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.setPositionTop(_this.dg.realHeaderHeight);
                }));
            }
        }
        if (changes.footerHeight !== undefined && !changes.footerHeight.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
        }
        if (changes.scrollBarMode !== undefined && !changes.scrollBarMode.isFirstChange()) {
            if (this.ps && this.ps.instance && this.scrollBarMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            else {
                this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            }
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
        }
        if (changes.showScrollArrow && !changes.showScrollArrow.isFirstChange()) {
            this.ps && this.ps.update();
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroy$.next();
        this.destroy$.complete();
        this.cellContentFormatter = null;
        this.dg.scrollInstance = null;
        this.destroySubscriptions();
        this.viewScrollContainer.nativeElement.removeEventListener('click', this._onMouseClick);
        if (this.ro) {
            this.ro.unobserve(this.viewScrollContainer.nativeElement);
            this.ro.disconnect();
        }
        if (this.resizeObserverTimer) {
            clearTimeout(this.resizeObserverTimer);
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ro = new ResizeObserver((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (_this.viewScrollContainer.nativeElement.offsetParent) {
                if (_this.resizeObserverTimer) {
                    clearTimeout(_this.resizeObserverTimer);
                }
                _this.resizeObserverTimer = setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.updateCanvasHeight();
                    if (_this.scrollBarMode === 'allways') {
                        _this.ps.update();
                    }
                    _this.cd.detectChanges();
                    _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth });
                }), 100);
            }
        }));
        this.ro.observe(this.viewScrollContainer.nativeElement);
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.setPositionTop = /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        this.top = headerHeight;
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            this.top += this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            this.top += this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && (this.dg.footerPosition === 'top' || this.dg.footerPosition === 'both')) {
            // headerHeight 已包括过滤行的高度 tfs 542471
            if (this.data && this.data.length) {
                this.top += this.dg.footerHeight;
            }
        }
    };
    /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkScrollbarPosition = /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    function (toTop) {
        if (toTop === void 0) { toTop = false; }
        if (!this.dg.data || !this.dg.data.length) {
            return;
        }
        /** @type {?} */
        var scrollBar = this.ps.instance;
        /** @type {?} */
        var scrollElRef = this.ps.elementRef.nativeElement;
        // scrollBar.update();
        /** @type {?} */
        var lastScrollLeft = scrollBar ? scrollBar.lastScrollLeft : 0;
        /** @type {?} */
        var lastScrollTop = scrollBar ? scrollBar.lastScrollTop : 0;
        // const lastScrollLeft = this.scrollLeft;
        // const lastScrollTop = this.scrollTop;
        /** @type {?} */
        var scrollTop = scrollElRef.scrollTop;
        /** @type {?} */
        var scrollLeft = scrollElRef.scrollLeft;
        if (!toTop) {
            if (scrollTop != lastScrollTop) {
                this.ps.scrollToTop(lastScrollTop);
                this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
            }
        }
        else {
            this.ps.scrollToTop();
            this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
        }
        this.scrollLeft = lastScrollLeft;
        if (scrollLeft != lastScrollLeft) {
            this.ps.scrollToX(lastScrollLeft);
            this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
        }
        else {
            if (lastScrollLeft) {
                this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
            }
        }
    };
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     */
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isSameLength
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    DatagridBodyComponent.prototype.onDataChanged = /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isSameLength
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    function (isSameLength, isDiffrentDataSource) {
        var _this = this;
        if (isSameLength === void 0) { isSameLength = true; }
        if (isDiffrentDataSource === void 0) { isDiffrentDataSource = false; }
        this.dg.setPagerHeight();
        this.viewportH = this.getViewPortHeight();
        this.bodyStyle = this.getBodyStyle();
        /**
         * update:
         * node_modules\perfect-scrollbar\types\perfect-scrollbar.d.ts
         * lastScrollTop: number
         */
        if (this.ps && this.ps.instance && !this.dg.isEditing() && !this.dg.clientFilterChanged && !this.dg.autoHeight) {
            this.scrollTop = 0;
            this.lastRenderedScrollTop = 0;
            this.ps.scrollToTop();
            this.scrollLeft = 0;
            this.ps.scrollToLeft();
        }
        this.rowsCache = {};
        /** @type {?} */
        var keepscrollPos = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var scrollInfo = _this.dg.dfs.getState().scrollInfo;
            if (scrollInfo) {
                if (scrollInfo.y) {
                    _this.scrollTop = scrollInfo.y;
                    _this.dg.scrollInstance.scrollToY(scrollInfo.y);
                    _this.dgs.onScrollMove(scrollInfo.y, SCROLL_Y_ACTION);
                }
                if (scrollInfo.x) {
                    _this.scrollLeft = scrollInfo.x;
                    _this.dg.scrollInstance.scrollToX(scrollInfo.x);
                    _this.dg.dgs.onScrollMove(scrollInfo.x, SCROLL_X_ACTION);
                }
            }
        });
        if (!this.dg.nowrap || this.dg.autoHeight) {
            this.renderData(false);
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.updateRowHeight();
            }), 100);
        }
        else {
            if (isSameLength) {
                keepscrollPos();
            }
            this.renderData(false);
            this.ps.update();
        }
        if (isDiffrentDataSource) {
            this.dg.initSelectOrChecked();
        }
        else {
            this.dg.refreshSelectedData();
        }
        this.dg.clientFilterChanged = false;
        this.dataChange.emit(this.data);
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.destroySubscriptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.subscriptions && this.subscriptions.length) {
            this.subscriptions.forEach((/**
             * @param {?} sub
             * @return {?}
             */
            function (sub) {
                if (sub) {
                    sub.unsubscribe();
                    sub = null;
                }
            }));
            this.subscriptions = [];
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.listenSubjects = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.destroySubscriptions();
        this.gridSizeSubscribe = this.dfs.gridSize$.pipe(takeUntil(this.destroy$)).pipe(debounceTime(50)).subscribe((/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            if (state) {
                _this.dg.setPagerHeight();
                /** @type {?} */
                var hh = _this.dg.setHeaderHeight();
                _this.setPositionTop(hh);
                _this.height = state.height - _this.top;
                /** @type {?} */
                var oldWidth_1 = _this.width;
                _this.width = Math.floor(state.width);
                _this.rowHeight = state.rowHeight;
                if (_this.dg.showBorder) {
                    _this.width -= 2;
                }
                _this.viewportW = _this.width;
                _this.viewportH = _this.getViewPortHeight();
                _this.canvasHeight = _this.getCanvasHeight();
                _this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                function () {
                    _this.columnsGroup = state.columnsGroup;
                    _this.checkScrollbarPosition();
                    // this.setFixedRightPosition();
                    _this.updateColumnSize(state.columnsGroup);
                    _this.dgs.showFixedShadow.emit({ showRightShadow: _this.showRightShadow, x: _this.fixedRightScrollLeft });
                    _this.renderData(false);
                    if (_this._scrollXTimer) {
                        clearTimeout(_this._scrollXTimer);
                    }
                    if (!_this.dg.nowrap || _this.dg.autoHeight) {
                        _this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            _this.updateRowHeight();
                            _this.keepScrollbarPosition(oldWidth_1);
                        }), 100);
                    }
                    else {
                        _this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            _this.keepScrollbarPosition(oldWidth_1);
                        }), 100);
                    }
                    // this.ps.update();
                }));
                if (_this.scrollBarMode === 'allways') {
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        if (!_this.dg.showScrollArrow) {
                            _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth });
                        }
                        _this.keepScrollbarPosition(oldWidth_1);
                    }), 100);
                }
            }
        }));
        this.subscriptions.push(this.gridSizeSubscribe);
        this.columnResizeSubscribe = this.dfs.columnResize$.subscribe((/**
         * @param {?} cg
         * @return {?}
         */
        function (cg) {
            _this.updateColumnSize(cg);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.columnResizeSubscribe);
        this.dgs.setSelecedRow.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            if (r && r.selected) {
                _this.currentRowId = r.id;
            }
            else {
                _this.currentRowId = undefined;
            }
        }));
        this.selectRowSubscribe = this.dfs.selectRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row) {
                _this.currentRowId = row.id;
                // 20210817 方向键移动后刷新视图状态
                _this.cd.detectChanges();
            }
        }));
        this.subscriptions.push(this.selectRowSubscribe);
        this.unselectRowSubscribe = this.dfs.unSelectRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            if (prevRow && prevRow.id === _this.currentRowId) {
                _this.currentRowId = undefined;
                _this.dg.selectedRow = null;
            }
            if (!_this.dg.editable && _this.dg.multiSelect) {
                _this.__triggerBodyClickEvent = _this.dg.selectionMode === 'default';
            }
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.unselectRowSubscribe);
        this.selectAllSubscribe = this.dfs.selectAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.selectAll.emit(rows);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.selectAllSubscribe);
        this.checkRowSubscribe = this.dfs.checkRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            _this.dg.checked.emit(row);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkRowSubscribe);
        this.clearSelectionsSubscribe = this.dfs.clearSelections$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.currentRowId = undefined;
            if (_this.dg.checkOnSelect) {
                _this.checkedRowsChanged();
            }
            _this.dg.unSelectAll.emit();
        }));
        this.subscriptions.push(this.clearSelectionsSubscribe);
        this.uncheckRowSubscribe = this.dfs.unCheckRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            _this.dg.unChecked.emit(prevRow);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.uncheckRowSubscribe);
        this.checkAllSubscribe = this.dfs.checkAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.checkAll.emit(rows);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkAllSubscribe);
        this.clearCheckedsSubscribe = this.dfs.clearCheckeds$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            if (_this.dg.selectOnCheck) {
                _this.currentRowId = undefined;
            }
            _this.dg.unCheckAll.emit(rows);
            _this.checkedRowsChanged();
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.clearCheckedsSubscribe);
        this.subscriptions.push(this.dgs.setScrollbarPosition.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition();
            _this.updateScrollPosition(_this.scrollLeft);
        })));
        this.dgs.columnResized.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.dg.nowrap ||
                (_this.dg.currentCell && _this.dg.currentCell.isEditing && _this.dg.currentCell.column &&
                    _this.dg.currentCell.column.editor && _this.dg.currentCell.column.editor.type === 'textarea')) {
                /** @type {?} */
                var trdoms = _this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(.f-datagrid-footer-row)');
                trdoms.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    _this.render.setStyle(n, 'height', 'auto');
                }));
                /** @type {?} */
                var trID = '';
                if (e) {
                    /** @type {?} */
                    var rowId = e.id;
                    trID = TR_PREFIX + rowId;
                }
                _this.updateRowHeight(trID);
                // trdoms.forEach(n => n.style.height = '');
            }
            if (_this.dg.headerWrap) {
                _this.dg.setHeaderHeight();
                _this.dfs.columnResizeEnd();
            }
        }));
        this.dgs.cellContentWrapChanged.pipe(delay(100)).subscribe((/**
         * @return {?}
         */
        function () {
            _this.updateRowHeight();
        }));
        this.dg.dfs.rowUpdate$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row && row.data) {
                _this.buildCustomCellStyle(row);
            }
        }));
        if (this.dg.groupRows) {
            this.dfs.expandGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return _this.groupRowStateChanged(e.data, true); }));
            this.dfs.collapseGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return _this.groupRowStateChanged(e.data, false); }));
        }
    };
    /**
     * @private
     * @param {?} groupRow
     * @param {?} isExpand
     * @return {?}
     */
    DatagridBodyComponent.prototype.groupRowExpandUpdate = /**
     * @private
     * @param {?} groupRow
     * @param {?} isExpand
     * @return {?}
     */
    function (groupRow, isExpand) {
        var _this = this;
        if (groupRow.rows && groupRow.rows.length) {
            groupRow.rows.forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                _this.data.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                function (element) {
                    if (element.id === n.id) {
                        if (!isExpand) {
                            element['__group_visible__'] = isExpand;
                        }
                        else {
                            element['__group_visible__'] = groupRow.expanded;
                        }
                        if (element.rows && element.rows.length) {
                            _this.groupRowExpandUpdate(element, isExpand);
                        }
                    }
                }));
            }));
        }
    };
    /**
     * @private
     * @param {?} rowData
     * @param {?} expand
     * @return {?}
     */
    DatagridBodyComponent.prototype.groupRowStateChanged = /**
     * @private
     * @param {?} rowData
     * @param {?} expand
     * @return {?}
     */
    function (rowData, expand) {
        var _this = this;
        if (this.dg.virtualized) {
            /** @type {?} */
            var gr = this.data.find((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.id === rowData.id; }));
            this.groupRowExpandUpdate(gr, expand);
            this.renderData(false);
        }
        else {
            this.getCanvasHeight();
        }
        if (this['_psUpdateTimer_']) {
            clearTimeout(this['_psUpdateTimer_']);
        }
        this['_psUpdateTimer_'] = setTimeout((/**
         * @return {?}
         */
        function () {
            _this.ps.update();
            _this.cd.detectChanges();
        }), 100);
    };
    /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    DatagridBodyComponent.prototype.keepScrollbarPosition = /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    function (oldWidth) {
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
        this.ps.update();
        if (!this.ps.instance) {
            return;
        }
        /** @type {?} */
        var scrollReach = this.ps.instance.reach;
        /** @type {?} */
        var t = this.width - oldWidth;
        /** @type {?} */
        var scrollLeft = t;
        if (scrollReach.x === 'start' || !this.ps.instance.lastScrollLeft) {
            scrollLeft = 0;
            this.ps.scrollToX(0);
        }
        else if (scrollReach.x === 'end') {
            this.ps.scrollToRight(0);
            scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        }
        else {
            scrollLeft = this.ps.instance.lastScrollLeft - t;
            this.ps.elementRef.nativeElement.scrollLeft = scrollLeft;
        }
        this.updateScrollPosition(scrollLeft);
    };
    /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateColumnSize = /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    function (cg) {
        if (cg) {
            this.columnsGroup = cg;
            this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
            this.colsWidth = this.columnsGroup.normalWidth;
            this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
            this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
            this.fixedRightScrollLeft = this.maxScrollLeft;
            // grid 容器宽度
            /** @type {?} */
            var dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
            // 所有列宽之和
            /** @type {?} */
            var allColsWidth = Math.floor(this.columnsGroup.totalWidth);
            this.bodyStyle = this.getBodyStyle();
            if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
                this.showRightShadow = false;
            }
            else {
                this.showRightShadow = true;
                // 右侧固定列的位置
                this.fixedRightScrollLeft = this.width + this.scrollLeft;
            }
            if (this.ps && this.ps.instance && this.dg.scrollBarShowMode === 'allways' && this.ps.instance.scrollbarYActive) {
                if (this.showRightShadow) {
                    this.rightFixedWidth += 18;
                    this.fixedRightScrollLeft = this.fixedRightScrollLeft - this.rightFixedWidth;
                }
                else {
                    if (this.canvasWidth > this.totalWidth && this.canvasWidth - this.totalWidth < 18) {
                        this.rightFixedWidth += 18;
                    }
                }
            }
            this.totalWidth = this.columnsGroup.totalWidth;
            if (this.scrollBarMode === 'allways' && !this.rightRowsCmp && !this.dg.useControlPanel) {
                this.totalWidth += 18;
            }
        }
    };
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.buildCustomCellStyle = 
    // private setFixedRightPosition() {
    //     this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
    //     this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
    //     this.colsWidth = this.columnsGroup.normalWidth;
    //     this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
    //     this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
    //     // grid 容器宽度
    //     const dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
    //     // 所有列宽之和
    //     const allColsWidth = Math.floor(this.columnsGroup.totalWidth);
    //     this.bodyStyle = this.getBodyStyle();
    //     if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
    //         this.showRightShadow = false;
    //         this.fixedRightScrollLeft = this.maxScrollLeft;
    //     } else {
    //         this.showRightShadow = true;
    //         // 右侧固定列的位置
    //         this.fixedRightScrollLeft = this.width - this.rightFixedWidth + this.scrollLeft;
    //     }
    // }
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        var _this = this;
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        /** @type {?} */
        var trs = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        /** @type {?} */
        var updateCellStyle = (/**
         * @param {?} arr
         * @param {?} col
         * @param {?} style
         * @return {?}
         */
        function (arr, col, style) {
            if (arr.length) {
                /** @type {?} */
                var td = arr[row.index].querySelector("[field=\"" + col.field + "\"]");
                if (td) {
                    _this.dg.renderCustomStyle(style, td);
                }
            }
        });
        this.dg.flatColumns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        function (col) {
            if (col.styler) {
                /** @type {?} */
                var _rd = row.data;
                /** @type {?} */
                var val = Utils.getValue(col.field, _rd);
                /** @type {?} */
                var cs = col.styler(val, _rd, row.index);
                if (cs && Object.keys(cs).length) {
                    updateCellStyle(leftTrs, col, cs);
                    updateCellStyle(rightTrs, col, cs);
                    updateCellStyle(trs, col, cs);
                }
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkedRowsChanged = /**
     * @private
     * @return {?}
     */
    function () {
        this.dgs.onCheckedRowsCountChange();
        /** @type {?} */
        var checkedRows = this.dg.checkeds;
        this.dg.checkValues = checkedRows.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.id; }));
        this.dg.checkValuesChange.emit(this.dg.checkValues);
        this.dg.checkedChange.emit(checkedRows);
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getTrDomHeight = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        /** @type {?} */
        var trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        function (tr, i) {
            /** @type {?} */
            var t1 = 0;
            /** @type {?} */
            var t2 = Math.ceil(tr.offsetHeight);
            /** @type {?} */
            var t3 = 0;
            if (leftTrs && leftTrs.length) {
                t1 = Math.ceil(leftTrs[i].offsetHeight);
            }
            if (rightTrs && rightTrs.length) {
                t3 = Math.ceil(rightTrs[i].offsetHeight);
            }
            /** @type {?} */
            var _h = Math.max(t1, t2, t3, _this.dg.rowHeight);
            list.push(_h);
        }));
        return list;
    };
    /** 允许数据折行时，计算行号的行高 */
    /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateRowHeight = /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    function (trDomId) {
        var _this = this;
        if (trDomId === void 0) { trDomId = null; }
        if (this.fast) {
            return;
        }
        if (!this.mainArea) {
            return;
        }
        /** @type {?} */
        var dgBody = this.el.nativeElement.querySelector('div.f-datagrid-body');
        if (dgBody) {
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(dgBody, 'data-wrap');
            }
            else {
                this.render.removeClass(dgBody, 'data-wrap');
            }
        }
        /** @type {?} */
        var cssTextArr = [];
        if (!trDomId) {
            this.rows.forEach((/**
             * @param {?} r
             * @param {?} i
             * @return {?}
             */
            function (r, i) {
                /** @type {?} */
                var rowId = _this.dfs.primaryId(r);
                /** @type {?} */
                var trID = TR_PREFIX + rowId;
                /** @type {?} */
                var leftTrId = trID + '_fixedleft';
                /** @type {?} */
                var rightTrId = trID + '_fixedright';
                if (!_this.dg.nowrap || _this.dg.autoHeight) {
                    /** @type {?} */
                    var list = _this.getTrDomHeight();
                    /** @type {?} */
                    var h = list[i];
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + leftTrId + "{ height: " + h + "px }");
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + trID + "{ height: " + h + "px }");
                    cssTextArr.push(_this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + rightTrId + "{ height: " + h + "px }");
                }
                else {
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${leftTrId}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${trID}{ height: ${list[i]}px }`);
                    // cssTextArr.push(`${this.dg.customStyleKey()} .f-datagrid-body #${rightTrId}{ height: ${list[i]}px }`);
                    /** @type {?} */
                    var key1 = _this.dg.customStyleKey() + " .f-datagrid-body #" + leftTrId;
                    /** @type {?} */
                    var key2 = _this.dg.customStyleKey() + " .f-datagrid-body #" + trID;
                    /** @type {?} */
                    var key3 = _this.dg.customStyleKey() + " .f-datagrid-body #" + rightTrId;
                    _this.dgs.removeCssRule(key1);
                    _this.dgs.removeCssRule(key2);
                    _this.dgs.removeCssRule(key3);
                }
            }));
            this.dgs.appendCssRules(cssTextArr);
        }
        else {
            cssTextArr = [];
            /** @type {?} */
            var domSel = '#' + trDomId;
            /** @type {?} */
            var _arr = [];
            if (this.fixedRightEl) {
                /** @type {?} */
                var rtr = this.fixedRightEl.nativeElement.querySelector(domSel);
                if (rtr) {
                    _arr.push(Math.ceil(rtr.offsetHeight));
                }
            }
            if (this.fixedLeftEl) {
                /** @type {?} */
                var ltr = this.fixedLeftEl.nativeElement.querySelector(domSel);
                if (ltr) {
                    _arr.push(Math.ceil(ltr.offsetHeight));
                }
            }
            if (this.mainArea) {
                /** @type {?} */
                var tr = this.mainArea.nativeElement.querySelector(domSel);
                if (tr) {
                    _arr.push(Math.ceil(tr.offsetHeight));
                }
            }
            /** @type {?} */
            var _h = Math.max.apply(Math, tslib_1.__spread(_arr));
            /** @type {?} */
            var leftTrId = trDomId + '_fixedleft';
            /** @type {?} */
            var rightTrId = trDomId + '_fixedright';
            if (!this.dg.nowrap || this.dg.autoHeight) {
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + leftTrId + "{ height: " + _h + "px;}");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + trDomId + "{ height: " + _h + "px;}");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body.data-wrap #" + rightTrId + "{ height: " + _h + "px;}");
            }
            else {
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + leftTrId + "{ height: " + _h + "px }");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + trDomId + "{ height: " + _h + "px }");
                cssTextArr.push(this.dg.customStyleKey() + " .f-datagrid-body #" + rightTrId + "{ height: " + _h + "px }");
            }
            this.dgs.appendCssRules(cssTextArr);
        }
        this.updateCanvasHeight();
        // 移除height: auto
        /** @type {?} */
        var trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
        trdoms.forEach((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.style.height = ''; }));
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getBodyStyle = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var h = this.getViewPortHeight();
        if (!this.data.length) {
            if (this.dg.useBlankWhenDataIsEmpty) {
                h = this.dg.emptyDataHeight;
            }
            else {
                if (this.dg.autoHeight) {
                    h = this.dg.emptyDataHeight;
                }
                if (this.dg.footerData && this.dg.showFooter) {
                    /** @type {?} */
                    var fd = this.dg.footerData;
                    if (this.dg.footerData.subscribe) {
                        fd = this.dg.footerData['value'];
                    }
                    if (fd && Array.isArray(fd) && fd.length) {
                        h = h - this.dg.footerHeight;
                        if (this.dg.footerPosition === 'both') {
                            h = h - this.dg.footerHeight;
                        }
                    }
                }
            }
        }
        else {
            if (this.dg.showFooter && this.dg.footerPosition === 'both') {
                h = h - this.dg.footerHeight;
            }
        }
        return {
            height: Math.floor(h) + 1 + "px"
        };
    };
    /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateScrollPosition = /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    function (scrollLeft) {
        this.scrollLeft = scrollLeft;
        this.fixedRightScrollLeft = this.scrollLeft + this.width - this.rightFixedWidth;
        if (this.fixedRightScrollLeft === this.maxScrollLeft || this.fixedRightScrollLeft > this.maxScrollLeft) {
            this.fixedRightScrollLeft = this.maxScrollLeft;
            this.showRightShadow = false;
        }
        else {
            this.showRightShadow = true;
        }
        if (this.fixedLeftEl) {
            this.render.setStyle(this.fixedLeftEl.nativeElement, 'transform', "translate3d(" + this.scrollLeft + "px, 0px, 0px)");
        }
        if (this.fixedRightEl) {
            this.render.setStyle(this.fixedRightEl.nativeElement, 'transform', "translate3d(" + this.fixedRightScrollLeft + "px, 0px, 0px)");
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToX = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        // this.cd.detectChanges();
        this.dgs.onScrollMove(x, SCROLL_X_ACTION);
        this.dfs.updateProperty('scrollInfo', { y: $event.target.scrollTop, x: x });
        this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToY = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if (this._scrollTimer) {
            clearTimeout(this._scrollTimer);
        }
        this._scrollTimer = setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var y = $event.target.scrollTop;
            if (_this.dg.virtualized) {
                _this.handleScroll();
            }
            _this.scrollTop = y;
            _this.dfs.updateProperty('scrollInfo', { y: y, x: $event.target.scrollLeft });
            _this.dg.scrollY.emit(y);
            _this.dgs.onScrollMove(y, SCROLL_Y_ACTION);
        }), 100);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachStart = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        this.dgs.onScrollMove(x, SCROLL_X_REACH_START_ACTION);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachEnd = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.showRightShadow = false;
        // const x = $event.target.scrollLeft;
        // this.updateScrollPosition(x);
        // this.cd.detectChanges();
        // // this.dgs.onShowFixedShadow(this.showRightShadow);
        // this.dgs.onScrollMove(x, SCROLL_X_REACH_END_ACTION);
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isChecked = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowChecked(rowData[this.dg.idField]);
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isSelected = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowSelected(rowData[this.dg.idField]);
        }
        return false;
    };
    /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    DatagridBodyComponent.prototype.toggleGroupRow = /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    function (row, open) {
        if (open === void 0) { open = true; }
        row.expanded = open;
        this.ps.update();
    };
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /** 获取可视区域高度 */
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @return {?}
     */
    DatagridBodyComponent.prototype.getViewPortHeight = /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewPortHeight = this.dg.height;
        if (this.dg.showHeader) {
            viewPortHeight = viewPortHeight - this.dg.realHeaderHeight;
        }
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            viewPortHeight -= this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            viewPortHeight -= this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && this.data.length) {
            viewPortHeight = viewPortHeight - this.dg.footerHeight;
        }
        if (this.dg.pagination) {
            viewPortHeight = viewPortHeight - this.dg.pagerHeight - 2;
        }
        if (this.dg.showBorder) {
            viewPortHeight -= 2;
        }
        this.viewportH = viewPortHeight;
        return viewPortHeight;
    };
    // 不折行时，所有数据的高度
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.allRowsHeight = 
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rowHeightpatch = 1;
        // this.dg.autoHeight ? 2 : 1;
        /** @type {?} */
        var rowHeight = this.dg.rowHeight + rowHeightpatch;
        /** @type {?} */
        var itemsCount = 0;
        if (this.dg.groupRows) {
            /** @type {?} */
            var data = this.data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n['__group_visible__'] || n['__group_visible__'] === undefined; }));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                itemsCount = data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group_footer__']; })).length;
            }
            else {
                itemsCount = data.length;
            }
        }
        else {
            itemsCount = this.data.length;
        }
        /** @type {?} */
        var h = itemsCount * rowHeight;
        if (this.dg.autoHeight) {
            h += itemsCount;
        }
        else {
            h += 2;
        }
        return h;
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getCanvasHeight = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var canvasHeight = 0;
        if (!this.data || !this.data.length) {
            this.canvasHeight = 0;
            return 0;
        }
        if (this.dg.nowrap) {
            if (this.dg.maxHeight && this.mainArea) {
                canvasHeight = Math.floor(this.mainArea.nativeElement.getBoundingClientRect().height);
            }
            else {
                canvasHeight = this.allRowsHeight();
            }
        }
        else {
            canvasHeight = this.getTrDomHeight().reduce((/**
             * @param {?} r
             * @param {?} c
             * @return {?}
             */
            function (r, c) { return r + c; }), 0);
        }
        if (!canvasHeight) {
            canvasHeight = this.viewportH;
        }
        canvasHeight = canvasHeight + (this.dg.scrollBarShowMode === 'allways' && (this.ps.instance && this.ps.instance['scrollbarXActive']) ? 18 : 0);
        this.canvasHeight = canvasHeight;
        return canvasHeight;
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateCanvasHeight = /**
     * @return {?}
     */
    function () {
        this.canvasHeight = this.getCanvasHeight();
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRowFromPosition = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        return Math.floor(y / (this.dg.rowHeight + 1));
    };
    /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getVisibleRange = /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        if (viewportTop == null) {
            viewportTop = this.scrollTop;
        }
        if (viewportLeft == null) {
            viewportLeft = this.scrollLeft;
        }
        return {
            top: this.getRowFromPosition(viewportTop),
            bottom: this.getRowFromPosition(viewportTop + this.viewportH) + 1,
            leftPx: viewportLeft,
            rightPx: viewportLeft + this.viewportW
        };
    };
    /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRenderedRange = /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        /** @type {?} */
        var range = this.getVisibleRange(viewportTop, viewportLeft);
        /** @type {?} */
        var buffer = Math.round(this.viewportH / (this.dg.rowHeight + 1));
        /** @type {?} */
        var minBuffer = this.minRowBuffer;
        if (this.vScrollDir == -1) {
            range.top -= buffer;
            range.bottom += minBuffer;
        }
        else if (this.vScrollDir == 1) {
            range.top -= minBuffer;
            range.bottom += buffer;
        }
        else {
            range.top -= minBuffer;
            range.bottom += minBuffer;
        }
        range.top = Math.max(0, range.top);
        range.bottom = Math.min(this.data.length - 1, range.bottom);
        range.leftPx -= this.viewportW;
        range.rightPx += this.viewportW;
        range.leftPx = Math.max(0, range.leftPx);
        range.rightPx = Math.min(this.canvasWidth, range.rightPx);
        return range;
    };
    /**
     * @private
     * @param {?} range
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderRows = /**
     * @private
     * @param {?} range
     * @return {?}
     */
    function (range) {
        var _this = this;
        /** @type {?} */
        var rows = [];
        /** @type {?} */
        var dataLength = this.data.length;
        /** @type {?} */
        var _data = this.data;
        // 启用分组
        if (this.dg.groupRows && this.dg.groupField) {
            _data = _data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n['__group_visible__'] || n['__group_visible__'] === undefined; }));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                _data = _data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group_footer__']; }));
            }
            dataLength = _data.length;
            this.rowsCache = {};
        }
        for (var i = range.top; i <= range.bottom; i++) {
            if (this.rowsCache[i] || (i == dataLength)) {
                continue;
            }
            rows.push(i);
            // Create an entry right away so that appendRowHtml() can
            // start populatating it.
            this.rowsCache[i] = {
                rowNode: null,
                // ColSpans of rendered cells (by column idx).
                // Can also be used for checking whether a cell has been rendered.
                cellColSpans: [],
                // Cell nodes (by column idx).  Lazy-populated by ensureCellNodesInRowsCache().
                cellNodesByColumnIdx: [],
                // Column indices of cell nodes that have been rendered, but not yet indexed in
                // cellNodesByColumnIdx.  These are in the same order as cell nodes added at the
                // end of the row.
                cellRenderQueue: []
            };
        }
        for (var i = 0, ii = rows.length; i < ii; i++) {
            this.rowsCache[rows[i]].rowNode = _data[rows[i]];
        }
        return Object.keys(this.rowsCache).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return _this.rowsCache[n].rowNode; })).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; }));
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.removeRowFromCache = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        /** @type {?} */
        var cacheEntry = this.rowsCache[row];
        if (!cacheEntry) {
            return;
        }
        delete this.rowsCache[row];
    };
    /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    DatagridBodyComponent.prototype.cleanupRows = /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    function (rangeToKeep) {
        for (var i in this.rowsCache) {
            if (i < rangeToKeep.top || i > rangeToKeep.bottom) {
                this.removeRowFromCache(i);
            }
        }
    };
    /**
     * @param {?} showYscrollbar
     * @return {?}
     */
    DatagridBodyComponent.prototype.hasYScrollbar = /**
     * @param {?} showYscrollbar
     * @return {?}
     */
    function (showYscrollbar) {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.updateColumnSize(_this.columnsGroup);
            if (_this.ps) {
                _this.ps.update();
                _this.cd.detectChanges();
            }
            _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance });
        }), 60);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onClickScrollArrow = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var dir = $event.dir, event = $event.event;
        if (this.ps && this.ps.instance) {
            var _a = this.ps.instance.reach, x = _a.x, y = _a.y;
            switch (dir) {
                case 'left':
                    if (x !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft - 40;
                    }
                    break;
                case 'right':
                    if (x !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft + 40;
                    }
                    break;
                case 'top':
                    if (y !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop - 40;
                    }
                    break;
                case 'bottom':
                    if (y !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop + 40;
                    }
                    break;
            }
            this.ps.update();
        }
    };
    /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderData = /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    function (detectchanges) {
        if (detectchanges === void 0) { detectchanges = true; }
        this.canvasHeight = this.getCanvasHeight();
        if (!this.dg.virtualized || this.dg.autoHeight) {
            this.rows = this.data;
        }
        else {
            /** @type {?} */
            var visible = this.getVisibleRange();
            /** @type {?} */
            var rendered = this.getRenderedRange();
            // remove rows no longer in the viewport
            this.cleanupRows(rendered);
            // render missing rows
            this.rows = this.renderRows(rendered);
            this.startRowIndex = rendered.top;
            this.lastRenderedScrollTop = this.scrollTop;
            this.lastRenderedScrollLeft = this.scrollLeft;
            this.blankTopHeight = this.startRowIndex * (this.dg.rowHeight + 1);
            this.blankBottomHeight = this.canvasHeight - this.blankTopHeight - (this.rows.length * (this.dg.rowHeight + 1));
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
            if (detectchanges) {
                this.cd.detectChanges();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        this.scrollTop = this.ps.elementRef.nativeElement.scrollTop;
        this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        return this._handleScroll();
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype._handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewportContainer = this.viewScrollContainer.nativeElement;
        /** @type {?} */
        var maxScrollDistanceY = viewportContainer.scrollHeight - viewportContainer.clientHeight;
        /** @type {?} */
        var maxScrollDistanceX = viewportContainer.scrollWidth - viewportContainer.clientWidth;
        // Protect against erroneous clientHeight/Width greater than scrollHeight/Width.
        // Sometimes seen in Chrome.
        maxScrollDistanceY = Math.max(0, maxScrollDistanceY);
        maxScrollDistanceX = Math.max(0, maxScrollDistanceX);
        // Ceiling the max scroll values
        if (this.scrollTop > maxScrollDistanceY) {
            this.scrollTop = maxScrollDistanceY;
        }
        if (this.scrollLeft > maxScrollDistanceX) {
            this.scrollLeft = maxScrollDistanceX;
        }
        /** @type {?} */
        var vScrollDist = Math.abs(this.scrollTop - this.prevScrollTop);
        /** @type {?} */
        var hScrollDist = Math.abs(this.scrollLeft - this.prevScrollLeft);
        if (hScrollDist) {
            this.prevScrollLeft = this.scrollLeft;
            // $viewportScrollContainerX[0].scrollLeft = scrollLeft;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows) {
            //         $viewportTopR[0].scrollLeft = scrollLeft;
            //     }
            // } else {
            //     if (hasFrozenRows) {
            //         $viewportTopL[0].scrollLeft = scrollLeft;
            //     }
            // }
        }
        /** @type {?} */
        var lastScrollTop = this.lastRenderedScrollTop;
        if (vScrollDist) {
            this.vScrollDir = this.prevScrollTop < this.scrollTop ? 1 : -1;
            this.prevScrollTop = this.scrollTop;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows && !options.frozenBottom) {
            //         $viewportBottomL[0].scrollTop = scrollTop;
            //     } else {
            //         $viewportTopL[0].scrollTop = scrollTop;
            //     }
            // }
            // switch virtual pages if needed
            if (vScrollDist < this.viewportH) {
                this._scrollTo(this.scrollTop);
            }
        }
        if (hScrollDist || vScrollDist) {
            /** @type {?} */
            var dx = Math.abs(this.lastRenderedScrollLeft - this.scrollLeft);
            /** @type {?} */
            var dy = Math.abs(lastScrollTop - this.scrollTop);
            if (dx > 20 || dy > 20) {
                // if rendering is forced or scrolling is small enough to be "easy", just render
                if (dy < this.viewportH && dx < this.viewportW) {
                    this.renderData();
                }
                else {
                    this.renderData();
                }
            }
        }
        if (hScrollDist || vScrollDist) {
            return true;
        }
        return false;
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype._scrollTo = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        /** @type {?} */
        var $viewportScrollContainerY = this.viewScrollContainer.nativeElement;
        y = Math.max(y, 0);
        y = Math.min(y, this.canvasHeight - this.viewportH);
        /** @type {?} */
        var newScrollTop = y;
        if (this.prevScrollTop != newScrollTop) {
            this.vScrollDir = (this.prevScrollTop < newScrollTop) ? 1 : -1;
            this.lastRenderedScrollTop = (this.scrollTop = this.prevScrollTop = newScrollTop);
            // if (hasFrozenColumns()) {
            //     $viewportTopL[0].scrollTop = newScrollTop;
            // }
            // if (hasFrozenRows) {
            //     $viewportBottomL[0].scrollTop = $viewportBottomR[0].scrollTop = newScrollTop;
            // }
            // $viewportScrollContainerY.scrollTop = newScrollTop;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onMouseClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // document.body.click();
        /** @type {?} */
        var target = (/** @type {?} */ ($event.target));
        if (target.nodeName === 'TEXTAREA' || target.nodeName === 'INPUT') {
            return;
        }
        /** @type {?} */
        var td = target;
        if (target.nodeName !== 'TD') {
            td = target.closest('TD');
        }
        if (!this.dg.editable && this.__triggerBodyClickEvent) {
            // 解决超链点击事件，要先执行选中行
            if (td && td.selectCell) {
                $event.stopPropagation();
                td.selectCell($event, td); // 按理说可以删除的，但不敢动哦o(≧口≦)o
            }
            return;
        }
        if (this.dg.editMode === 'row') {
            return;
        }
        if (!td && this.dg.currentCell) {
            td = this.dg.currentCell.cellElement;
            if (td && td.closeEdit) {
                $event.stopPropagation();
                td.closeEdit();
                return;
            }
        }
        if (td) {
            // 行禁用时
            if (this.dg.disableRow && td.gridCellData) {
                var _a = td.gridCellData, rowData = _a.rowData, rowIndex = _a.rowIndex;
                if (this.dg.disableRow(rowData, rowIndex)) {
                    return;
                }
            }
            $event.stopPropagation();
            if (this.dg.editable && this.dg.editMode === 'cell' && td.edit) {
                td.edit($event);
            }
            else {
                if (td.selectCell) {
                    if (this.dg.selectionMode === 'default' && this.dg.multiSelect) {
                        this.dg.clearCheckeds();
                    }
                    td.selectCell($event, td);
                }
                else {
                    this.dg.endCellEdit();
                }
            }
        }
    };
    DatagridBodyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'datagrid-body',
                    template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-06 07:43:07\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-11-26 08:20:46\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n<ng-container  *ngIf=\"(!data || !data.length) && !dg.useBlankWhenDataIsEmpty\">\r\n    <div *ngIf=\"!dg.emptyTemplate\" class=\"d-flex flex-column f-datagrid-norecords\"\r\n        style=\"position:absolute; margin:0;left: 0; z-index: 1;justify-content: center; align-items: center;pointer-events: none;\" \r\n        [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" >\r\n        <div class=\"f-datagrid-norecords-content\" style=\"margin: 0;width: 100%;position: relative; top: 0\">\r\n            {{ 'datagrid.emptyMessage' | locale }}\r\n        </div>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyTemplate\">\r\n        <ng-container #emptyTemplate [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container>\r\n    </div>\r\n</ng-container>\r\n\r\n\r\n\r\n<div  class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" \r\n[farris-context-menus]=\"contextMenuItems\" [disabled]=\"!dg.enableContextMenu\" [activeDomName]=\"'tr'\" [beforeShowContextMenu]=\"onBeforeShowContextMenu\"\r\n[menuClass]=\"'f-datagrid-context-menu'\">\r\n\r\n    <div #viewScrollContainer [scrollbar]=\"psConfig\" #ps=\"ngxScrollbar\"\r\n        class=\"ps f-datagrid-body-wheel-area\" \r\n        style=\"width: 100%;\"\r\n        [ngStyle]=\"bodyStyle\"\r\n        (psXReachEnd)=\"onPsXReachEnd($event)\"\r\n        (psScrollY)=\"onScrollToY($event)\"\r\n        (psScrollX)=\"onScrollToX($event)\" (psXReachStart)=\"onPsXReachStart($event)\"\r\n\r\n        [style.paddingRight.px]=\"scrollbarYWidth\">\r\n       \r\n        <div class=\"f-datagrid-norecords\"  [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"dg.emptyDataHeight || 240\" style=\"height: 100%\" [style.width.px]=\"canvasWidth - 2\"  *ngIf=\"!data || !data.length\">\r\n            <!-- <div *ngIf=\"!dg.emptyTemplate\" class=\"f-datagrid-norecords-content\" style=\"width: 100%\" >{{ 'datagrid.emptyMessage' | locale }}</div>\r\n            <ng-container #emptyTemplate *ngIf=\"dg.emptyTemplate\" [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container> -->\r\n        </div>\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && !fast\"\r\n            class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n            [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n            \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n                \r\n                <div #fixedLeft class=\"f-datagrid-table f-datagrid-body-fixed-left\" style=\"z-index:999\" [class.f-datagrid-fixed-left-shadow]=\"!!scrollLeft && !dg.groupRows\"\r\n                    *ngIf=\"dg.showLineNumber || dg.showCheckbox || (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length)\"  [style.width.px]=\"leftFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ scrollLeft +'px, 0px, 0px)'\">\r\n\r\n                    <fixed-left-rows [columns]=\"columnsGroup?.leftFixed\" [checkedRows]=\"checkedRows\" [selectedRows]=\"selectedRows\" [data]=\"rows\"></fixed-left-rows>\r\n                </div>\r\n\r\n                <div #fixedRight class=\"f-datagrid-table f-datagrid-body-fixed-right\" [style.width.px]=\"rightFixedWidth\" \r\n                    *ngIf=\"columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\"\r\n                    [class.f-datagrid-fixed-right-shadow]=\"showRightShadow\" \r\n                    style=\"border: 0\"\r\n                    [style.transform]=\"'translate3d('+ fixedRightScrollLeft +'px, 0px, 0px)'\">\r\n                    \r\n                    <datagrid-rows #rightRows [fixedRight]=\"true\" [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.rightFixed\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div #main [style.width.px]=\"colsWidth\" style=\"position: relative;\" [style.left.px]=\"leftFixedWidth\" class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.normalColumns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && fast\"\r\n        class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n        [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n        \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n\r\n                <div #main style=\"position: relative;\"  class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows [hasFixedColumns]=\"columnsGroup?.leftFixed && columnsGroup?.leftFixed?.length\"  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.columns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <scrollbar-arrows [scrollbarXActive]=\"ps.instance && ps.instance.scrollbarXActive\" [scrollbarYActive]=\"ps.instance && ps.instance.scrollbarYActive\" \r\n    *ngIf=\"dg.scrollBarShowMode === 'allways' && dg.showScrollArrow\" (hasYScrollbar)=\"hasYScrollbar($event)\" (scrollMoveTo)=\"onClickScrollArrow($event)\"\r\n    [reachX]=\"ps.instance && ps.instance.reach.x\" [reachY]=\"ps.instance && ps.instance.reach.y\"></scrollbar-arrows>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n",
                    changeDetection: ChangeDetectionStrategy.OnPush
                }] }
    ];
    /** @nocollapse */
    DatagridBodyComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ApplicationRef },
        { type: DatagridComponent, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef },
        { type: ElementRef }
    ]; };
    DatagridBodyComponent.propDecorators = {
        footerHeight: [{ type: Input }],
        canvasWidth: [{ type: Input }],
        columnsGroup: [{ type: Input }],
        topHideHeight: [{ type: Input }],
        bottomHideHeight: [{ type: Input }],
        startRowIndex: [{ type: Input }],
        data: [{ type: Input }],
        dataChange: [{ type: Output }],
        scrollBarMode: [{ type: Input }],
        contextMenuItems: [{ type: Input }],
        checkedRows: [{ type: Input }],
        fast: [{ type: Input }],
        ps: [{ type: ViewChild, args: ['ps',] }],
        tableRowsCmp: [{ type: ViewChild, args: ['mainRows',] }],
        rightRowsCmp: [{ type: ViewChild, args: ['rightRows',] }],
        fixedLeftEl: [{ type: ViewChild, args: ['fixedLeft',] }],
        fixedRightEl: [{ type: ViewChild, args: ['fixedRight',] }],
        mainArea: [{ type: ViewChild, args: ['main',] }],
        viewScrollContainer: [{ type: ViewChild, args: ['viewScrollContainer',] }]
    };
    return DatagridBodyComponent;
}());
export { DatagridBodyComponent };
if (false) {
    /** @type {?} */
    DatagridBodyComponent.prototype.psConfig;
    /** @type {?} */
    DatagridBodyComponent.prototype.top;
    /** @type {?} */
    DatagridBodyComponent.prototype.height;
    /** @type {?} */
    DatagridBodyComponent.prototype.width;
    /** @type {?} */
    DatagridBodyComponent.prototype.colsWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.totalWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.leftFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rowHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bodyStyle;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.deltaTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.wheelWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._fixedRightScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.maxScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.showRightShadow;
    /** @type {?} */
    DatagridBodyComponent.prototype.footerHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.columnsGroup;
    /** @type {?} */
    DatagridBodyComponent.prototype.topHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bottomHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.startRowIndex;
    /** @type {?} */
    DatagridBodyComponent.prototype.data;
    /** @type {?} */
    DatagridBodyComponent.prototype.dataChange;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollBarMode;
    /** @type {?} */
    DatagridBodyComponent.prototype.contextMenuItems;
    /** @type {?} */
    DatagridBodyComponent.prototype.checkedRows;
    /**
     * 性能优化版，默认为 false
     * @type {?}
     */
    DatagridBodyComponent.prototype.fast;
    /** @type {?} */
    DatagridBodyComponent.prototype.ps;
    /** @type {?} */
    DatagridBodyComponent.prototype.tableRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedLeftEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedRightEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.mainArea;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewScrollContainer;
    /** @type {?} */
    DatagridBodyComponent.prototype.visibleContextMenus;
    /** @type {?} */
    DatagridBodyComponent.prototype.currentRowId;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._hoverRowIndex;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.gridSizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.columnResizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.onDataSourceChangeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.unselectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearSelectionsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.uncheckRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearCheckedsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.subscriptions;
    /** @type {?} */
    DatagridBodyComponent.prototype.dfs;
    /** @type {?} */
    DatagridBodyComponent.prototype.dgs;
    /** @type {?} */
    DatagridBodyComponent.prototype.ngZone;
    /** @type {?} */
    DatagridBodyComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.viewportH;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewportW;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasHeight;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.minRowBuffer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.vScrollDir;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.rowsCache;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollTop;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.rows;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankBottomHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.cellContentFormatter;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.__triggerBodyClickEvent;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._onMouseClick;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollXTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.resizeObserverTimer;
    /** @type {?} */
    DatagridBodyComponent.prototype.onBeforeShowContextMenu;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.app;
    /** @type {?} */
    DatagridBodyComponent.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtYm9keS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1ib2R5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBb0IsS0FBSyxFQUFFLFlBQVksRUFBTyxTQUFTLEVBQVUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMvRixPQUFPLEVBQTBCLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDM0QsT0FBTyxjQUFjLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7OztBQVN0RCxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5QyxVQUFVLEVBQWEsaUJBQWlCLEVBQ2QsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBc0IsUUFBUSxFQUFFLGNBQWMsRUFBZ0IsTUFBTSxFQUFFLFlBQVksRUFDeEosTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFHekUsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsMkJBQTJCLEVBQTZCLFNBQVMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzNJLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNsRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN2RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUUvRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFMUM7SUE2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O0lBQ2xCLCtDQUFtQjs7SUFDbkIscUNBQVU7O0lBQ1YsK0NBQW1COztJQUNuQixrREFBc0I7O0lBbUJ0QixxREFBZ0Q7Ozs7O0lBR2hELHdEQUF1Qzs7Ozs7SUFDdkMseUNBQWlDOzs7OztJQUNqQyw4Q0FBNkI7Ozs7O0lBQzdCLDZDQUE4Qjs7Ozs7SUFDOUIsOENBQStCOzs7OztJQUMvQixtQ0FBeUM7Ozs7O0lBQ3pDLG9EQUFxQzs7SUF1MkNyQyx3REFxQkM7Ozs7O0lBMTNDRyx5Q0FBMEI7Ozs7O0lBQzFCLG9DQUEyQjs7SUFDM0IsbUNBQXdDOzs7OztJQUN4QyxtQ0FBNkI7Ozs7O0lBQUUsbUNBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmltcG9ydCB7IGZpcnN0LCBzd2l0Y2hNYXAsIGRlbGF5LCBkZWJvdW5jZVRpbWUsIHRhcCwgdGFrZVVudGlsLCBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgaW50ZXJ2YWwsIG9mLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCBSZXNpemVPYnNlcnZlciBmcm9tICdyZXNpemUtb2JzZXJ2ZXItcG9seWZpbGwnO1xyXG4vKlxyXG4gKiBAQXV0aG9yOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBEYXRlOiAyMDE5LTA4LTEyIDA3OjQ3OjEyXHJcbiAqIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDE5LTExLTI2IDEwOjIxOjI1XHJcbiAqIEBRUTogMTA1NTgxODIzOVxyXG4gKiBAVmVyc2lvbjogdjAuMC4xXHJcbiAqL1xyXG5pbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIFJlbmRlcmVyMixcclxuICAgIEVsZW1lbnRSZWYsIE9uRGVzdHJveSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQsXHJcbiAgICBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBOZ1pvbmUsIEluamVjdG9yLCBmb3J3YXJkUmVmLCBJbmplY3QsIE9wdGlvbmFsLCBBcHBsaWNhdGlvblJlZiwgSG9zdExpc3RlbmVyLCBPdXRwdXQsIEV2ZW50RW1pdHRlclxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgRGF0YWdyaWRGYWNhZGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZGF0YWdyaWQtZmFjYWRlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTY3JvbGxiYXJEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9zY3JvbGxiYXIvc2Nyb2xsYmFyLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IENvbHVtbkdyb3VwIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBTZWxlY3RlZFJvdywgRGF0YVJlc3VsdCwgUk9XX0lOREVYX0ZJRUxELCBJU19HUk9VUF9ST1dfRklFTEQsIEdST1VQX1JPV19GSUVMRCwgSVNfR1JPVVBfRk9PVEVSX1JPV19GSUVMRCB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3N0YXRlJztcclxuaW1wb3J0IHsgU0NST0xMX1hfQUNUSU9OLCBTQ1JPTExfWV9BQ1RJT04sIFNDUk9MTF9YX1JFQUNIX1NUQVJUX0FDVElPTiwgU0NST0xMX1hfUkVBQ0hfRU5EX0FDVElPTiwgVFJfUFJFRklYIH0gZnJvbSAnLi4vLi4vdHlwZXMvY29uc3RhbnQnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kYXRhZ3JpZC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICcuLi8uLi9kYXRhZ3JpZC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBGb3JtYXRDZWxsRGF0YVBpcGUgfSBmcm9tICcuLi8uLi91dGlscy9mb3JtYXQtY2VsbC1kYXRhLnBpcGUnO1xyXG5pbXBvcnQgeyBDb2x1bW5Gb3JtYXRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24vY29sdW1uJztcclxuaW1wb3J0IHsgQ29udGV4dE1lbnVJdGVtIH0gZnJvbSAnQGZhcnJpcy91aS1jb250ZXh0LW1lbnUnO1xyXG5pbXBvcnQgeyBVdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdkYXRhZ3JpZC1ib2R5JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9ib2R5LmNvbXBvbmVudC5odG1sJyxcclxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhZ3JpZEJvZHlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkIHtcclxuICAgIC8vIOiHquWKqOmrmOW6puaXtu+8jOemgeeUqOe6teWQkea7muWKqOadoVxyXG4gICAgcHNDb25maWcgPSB7IHN3aXBlRWFzaW5nOiBmYWxzZSwgbWluU2Nyb2xsYmFyTGVuZ3RoOiAxNSwgaGFuZGxlcnM6IFsnY2xpY2stcmFpbCcsICdkcmFnLXRodW1iJywgJ3doZWVsJywgJ3RvdWNoJ10sIHN1cHByZXNzU2Nyb2xsWTogdGhpcy5kZy5hdXRvSGVpZ2h0ICYmIHRoaXMuZGcubWF4SGVpZ2h0ID8gZmFsc2U6IHRoaXMuZGcuYXV0b0hlaWdodCB9O1xyXG5cclxuICAgIHRvcDogbnVtYmVyO1xyXG4gICAgaGVpZ2h0OiBudW1iZXI7XHJcbiAgICB3aWR0aDogbnVtYmVyO1xyXG4gICAgY29sc1dpZHRoOiBudW1iZXI7XHJcbiAgICB0b3RhbFdpZHRoOiBudW1iZXI7XHJcbiAgICBsZWZ0Rml4ZWRXaWR0aDogbnVtYmVyO1xyXG4gICAgcmlnaHRGaXhlZFdpZHRoOiBudW1iZXI7XHJcbiAgICByb3dIZWlnaHQ6IG51bWJlcjtcclxuICAgIGJvZHlTdHlsZTogYW55O1xyXG4gICAgc2Nyb2xsVG9wID0gMDtcclxuICAgIHNjcm9sbExlZnQgPSAwO1xyXG4gICAgZGVsdGFUb3BIZWlnaHQgPSAwO1xyXG4gICAgLy8gd2hlZWxIZWlnaHQgPSAwO1xyXG4gICAgd2hlZWxXaWR0aCA9IDA7XHJcbiAgICBwcml2YXRlIF9maXhlZFJpZ2h0U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBnZXQgZml4ZWRSaWdodFNjcm9sbExlZnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0O1xyXG4gICAgfVxyXG4gICAgc2V0IGZpeGVkUmlnaHRTY3JvbGxMZWZ0KHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIG1heFNjcm9sbExlZnQgPSAwO1xyXG4gICAgc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBmb290ZXJIZWlnaHQgPSAwO1xyXG4gICAgQElucHV0KCkgY2FudmFzV2lkdGg7XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zR3JvdXA6IENvbHVtbkdyb3VwO1xyXG4gICAgLy8g6Jma5ouf5Yqg6L29XHJcbiAgICBASW5wdXQoKSB0b3BIaWRlSGVpZ2h0ID0gMDtcclxuICAgIEBJbnB1dCgpIGJvdHRvbUhpZGVIZWlnaHQgPSAwO1xyXG5cclxuICAgIEBJbnB1dCgpIHN0YXJ0Um93SW5kZXggPSAwO1xyXG4gICAgQElucHV0KCkgZGF0YTogYW55O1xyXG5cclxuICAgIEBPdXRwdXQoKSBkYXRhQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBJbnB1dCgpIHNjcm9sbEJhck1vZGUgPSAnYXV0byc7XHJcbiAgICBASW5wdXQoKSBjb250ZXh0TWVudUl0ZW1zOiBDb250ZXh0TWVudUl0ZW1bXTtcclxuXHJcbiAgICBASW5wdXQoKSBjaGVja2VkUm93cyA9IFtdO1xyXG5cclxuICAgIC8qKiDmgKfog73kvJjljJbniYjvvIzpu5jorqTkuLogZmFsc2UgKi9cclxuICAgIEBJbnB1dCgpIGZhc3QgPSBmYWxzZTtcclxuXHJcblxyXG4gICAgQFZpZXdDaGlsZCgncHMnKSBwcz86IFNjcm9sbGJhckRpcmVjdGl2ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ21haW5Sb3dzJykgdGFibGVSb3dzQ21wOiBhbnk7XHJcbiAgICBAVmlld0NoaWxkKCdyaWdodFJvd3MnKSByaWdodFJvd3NDbXA6IGFueTtcclxuICAgIEBWaWV3Q2hpbGQoJ2ZpeGVkTGVmdCcpIGZpeGVkTGVmdEVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRSaWdodCcpIGZpeGVkUmlnaHRFbDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ21haW4nKSBtYWluQXJlYTogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3ZpZXdTY3JvbGxDb250YWluZXInKSB2aWV3U2Nyb2xsQ29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG5cclxuXHJcbiAgICB2aXNpYmxlQ29udGV4dE1lbnVzID0gW107XHJcblxyXG4gICAgY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG5cclxuICAgIHByaXZhdGUgX2hvdmVyUm93SW5kZXggPSAtMTtcclxuICAgIGdldCBob3ZlclJvd0luZGV4KCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hvdmVyUm93SW5kZXg7XHJcbiAgICB9XHJcbiAgICBzZXQgaG92ZXJSb3dJbmRleChyb3dJZHg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX2hvdmVyUm93SW5kZXggPSByb3dJZHg7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNlbGVjdGVkUm93cygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZy5zZWxlY3Rpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3JpZFNpemVTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY29sdW1uUmVzaXplU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIG9uRGF0YVNvdXJjZUNoYW5nZVN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgdW5zZWxlY3RSb3dTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgc2VsZWN0QWxsU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNoZWNrUm93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjaGVja0FsbFN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSB1bmNoZWNrUm93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNsZWFyQ2hlY2tlZHNTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbnMgPSBbXTtcclxuXHJcbiAgICBwdWJsaWMgZGZzOiBEYXRhZ3JpZEZhY2FkZVNlcnZpY2U7XHJcbiAgICBwdWJsaWMgZGdzOiBEYXRhZ3JpZFNlcnZpY2U7XHJcbiAgICBwdWJsaWMgbmdab25lOiBOZ1pvbmU7XHJcbiAgICBwdWJsaWMgcmVuZGVyOiBSZW5kZXJlcjI7XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICBwcml2YXRlIHZpZXdwb3J0SDtcclxuICAgIHZpZXdwb3J0VztcclxuICAgIGNhbnZhc0hlaWdodDtcclxuICAgIHByaXZhdGUgbWluUm93QnVmZmVyID0gMztcclxuICAgIHByaXZhdGUgdlNjcm9sbERpciA9IDE7XHJcbiAgICBwcml2YXRlIHJvd3NDYWNoZSA9IHt9O1xyXG4gICAgcHJpdmF0ZSBsYXN0UmVuZGVyZWRTY3JvbGxUb3AgPSAwO1xyXG4gICAgcHJpdmF0ZSBsYXN0UmVuZGVyZWRTY3JvbGxMZWZ0ID0gMDtcclxuICAgIHByZXZTY3JvbGxUb3AgPSAwO1xyXG4gICAgcHJldlNjcm9sbExlZnQgPSAwO1xyXG4gICAgcm93cyA9IFtdO1xyXG4gICAgYmxhbmtUb3BIZWlnaHQgPSAwO1xyXG4gICAgYmxhbmtCb3R0b21IZWlnaHQgPSAwO1xyXG5cclxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgZ2V0IHNjcm9sbGJhclhIZWlnaHQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcgJiYgdGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGggPSB0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWEFjdGl2ZSddID8gMjIgOiAwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWUFjdGl2ZSddICYmIGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoICsgMTg7IC8vICsgKHRoaXMuZGcuc2hvd1Njcm9sbEFycm93ICYmIHRoaXMucHMuaW5zdGFuY2VbJ3Njcm9sbGJhcllBY3RpdmUnXSA/IDE4IDogMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHNjcm9sbGJhcllXaWR0aCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kZyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJZQWN0aXZlJ10gJiYgdGhpcy5zaG93UmlnaHRTaGFkb3cgPyAxOCA6IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNlbGxDb250ZW50Rm9ybWF0dGVyOiBGb3JtYXRDZWxsRGF0YVBpcGUgPSBudWxsO1xyXG5cclxuICAgIC8vIOW9k+WQr+eUqOWkmumAieS4lOWFgeiuuOWkmumAieS4re+8jOWIl+ihqOS4jeiDvee8lui+keaXtu+8jOWPlumAieS4reWQjuemgeatouinpuWPkWJvZHkg55qEY2xpY2sg5LqL5Lu2XHJcbiAgICBwcml2YXRlIF9fdHJpZ2dlckJvZHlDbGlja0V2ZW50ID0gdHJ1ZTtcclxuICAgIHByaXZhdGUgZGVzdHJveSQgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgcHJpdmF0ZSBfb25Nb3VzZUNsaWNrID0gbnVsbDtcclxuICAgIHByaXZhdGUgX3Njcm9sbFRpbWVyOiBhbnkgPSAwO1xyXG4gICAgcHJpdmF0ZSBfc2Nyb2xsWFRpbWVyOiBhbnkgPSAwO1xyXG4gICAgcHJpdmF0ZSBybzogUmVzaXplT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgcmVzaXplT2JzZXJ2ZXJUaW1lcjogYW55ID0gMDtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHBsaWNhdGlvblJlZixcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgZGc6IERhdGFncmlkQ29tcG9uZW50LFxyXG4gICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLCBwcml2YXRlIGVsOiBFbGVtZW50UmVmXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmRmcyA9IHRoaXMuaW5qZWN0b3IuZ2V0KERhdGFncmlkRmFjYWRlU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5kZ3MgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMubmdab25lID0gdGhpcy5pbmplY3Rvci5nZXQoTmdab25lKTtcclxuICAgICAgICB0aGlzLnJlbmRlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KFJlbmRlcmVyMik7XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbHVtbkZvcm1hdFNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChDb2x1bW5Gb3JtYXRTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmNlbGxDb250ZW50Rm9ybWF0dGVyID0gbmV3IEZvcm1hdENlbGxEYXRhUGlwZShjb2x1bW5Gb3JtYXRTZXJ2aWNlLCB0aGlzLmluamVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICAgICAgdGhpcy5saXN0ZW5TdWJqZWN0cygpO1xyXG4gICAgICAgIHRoaXMuZGcuc2Nyb2xsSW5zdGFuY2UgPSB0aGlzLnBzO1xyXG4gICAgICAgIGNvbnN0IHMxID0gdGhpcy5kZ3Muc2hvd0dyaWRIZWFkZXIuc3Vic2NyaWJlKGhlYWRlckhlaWdodCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyU2l6ZShoZWFkZXJIZWlnaHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMxKTtcclxuXHJcbiAgICAgICAgY29uc3QgczEwID0gdGhpcy5kZ3MuZm9vdGVyUG9zaXRpb25DaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyU2l6ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMxMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHMyID0gdGhpcy5kZ3Mucm93SGVpZ2h0Q2hhbmdlZC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzMik7XHJcblxyXG4gICAgICAgIGNvbnN0IHMzID0gdGhpcy5kZnMuY2xpZW50U29ydCQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5kZy5jb2x1bW5Tb3J0ZWQuZW1pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMzKTtcclxuICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHM1ID0gdGhpcy5kZy5kZ3MuY29sdW1uc0NoYW5nZWQucGlwZShcclxuICAgICAgICAgICAgZGVsYXkoNTApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZSAmJiBlLnNjcm9sbFRvTGVmdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvTGVmdCgwLCAxMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczUpO1xyXG4gICAgICAgXHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbk1vdXNlQ2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uTW91c2VDbGljayhlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRhaW5lclNpemUoaGVhZGVySGVpZ2h0PzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaGggPSBoZWFkZXJIZWlnaHQgfHwgdGhpcy5kZy5yZWFsSGVhZGVySGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5kZy5oZWlnaHQgLSB0aGlzLnRvcDtcclxuICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRmcy5zZXRDdXJyZW50UGFnZURhdGEoY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpc0RpZmZyZW50RGF0YVNvdXJjZSA9ICEhY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLm1hcChuID0+IG4uaWQpLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhY2hhbmdlcy5kYXRhLnByZXZpb3VzVmFsdWUuZmlsdGVyKG4gPT4gIW5bJ19fZ3JvdXBfXyddKS5maW5kKHAgPT4gcC5pZCA9PT0gbilcclxuICAgICAgICAgICAgfSkubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaXNTYW1lTGVuZ3RoID0gY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLmxlbmd0aCA+PSBjaGFuZ2VzLmRhdGEucHJldmlvdXNWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5vbkRhdGFDaGFuZ2VkKGlzU2FtZUxlbmd0aCwgaXNEaWZmcmVudERhdGFTb3VyY2UpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlIHx8ICFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcCh0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLmZvb3RlckhlaWdodCAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLmZvb3RlckhlaWdodC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMuc2Nyb2xsQmFyTW9kZSAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLnNjcm9sbEJhck1vZGUuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJZQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSB0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ICs9IDIyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zaG93U2Nyb2xsQXJyb3cgJiYgIWNoYW5nZXMuc2hvd1Njcm9sbEFycm93LmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnBzICYmIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICAgICAgICB0aGlzLmNlbGxDb250ZW50Rm9ybWF0dGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lTdWJzY3JpcHRpb25zKCk7XHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbk1vdXNlQ2xpY2spO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5ybykge1xyXG4gICAgICAgICAgICB0aGlzLnJvLnVub2JzZXJ2ZSh0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMucm8uZGlzY29ubmVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIHRoaXMucm8gPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudmlld1Njcm9sbENvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZU9ic2VydmVyVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlclRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UsIHJpZ2h0V2lkdGg6IHRoaXMucmlnaHRGaXhlZFdpZHRoIH0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnJvLm9ic2VydmUodGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFBvc2l0aW9uVG9wKGhlYWRlckhlaWdodDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy50b3AgPSBoZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCh0aGlzLmRnLmVuYWJsZUZpbHRlclJvdyB8fCB0aGlzLmRnLmVuYWJsZVNtYXJ0RmlsdGVyKSAmJiB0aGlzLmRnLnNob3dGaWx0ZXJCYXIpIHtcclxuICAgICAgICAgICAgdGhpcy50b3AgKz0gdGhpcy5kZy5maWx0ZXJCYXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Um93R3JvdXBQYW5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvcCArPSB0aGlzLmRnLnJvd0dyb3VwUGFuZWxIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Rm9vdGVyICYmICh0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAndG9wJyB8fCB0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpKSB7XHJcbiAgICAgICAgICAgIC8vIGhlYWRlckhlaWdodCDlt7LljIXmi6zov4fmu6TooYznmoTpq5jluqYgdGZzIDU0MjQ3MVxyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9wICs9IHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tTY3JvbGxiYXJQb3NpdGlvbih0b1RvcCA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmRhdGEgfHwgIXRoaXMuZGcuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzY3JvbGxCYXI6IGFueSA9IHRoaXMucHMuaW5zdGFuY2U7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsRWxSZWYgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAvLyBzY3JvbGxCYXIudXBkYXRlKCk7XHJcbiAgICAgICAgY29uc3QgbGFzdFNjcm9sbExlZnQgPSBzY3JvbGxCYXIgPyBzY3JvbGxCYXIubGFzdFNjcm9sbExlZnQgOiAwO1xyXG4gICAgICAgIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSBzY3JvbGxCYXIgPyBzY3JvbGxCYXIubGFzdFNjcm9sbFRvcCA6IDA7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IGxhc3RTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIC8vIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsRWxSZWYuc2Nyb2xsVG9wO1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbExlZnQgPSBzY3JvbGxFbFJlZi5zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICBpZiAoIXRvVG9wKSB7XHJcbiAgICAgICAgICAgIGlmIChzY3JvbGxUb3AgIT0gbGFzdFNjcm9sbFRvcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1RvcChsYXN0U2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsVG9wLCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1RvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbFRvcCwgU0NST0xMX1lfQUNUSU9OKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IGxhc3RTY3JvbGxMZWZ0O1xyXG4gICAgICAgIGlmIChzY3JvbGxMZWZ0ICE9IGxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9YKGxhc3RTY3JvbGxMZWZ0KTtcclxuICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxMZWZ0LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChsYXN0U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxMZWZ0LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pWw5o2u5Y+R55Sf5Y+Y5YyW77yM6YeN5paw5Yqg6L295pWw5o2u5pe25omn6KGMXHJcbiAgICAgKiDph43nva7mu5rliqjmnaHkvY3nva5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbkRhdGFDaGFuZ2VkKGlzU2FtZUxlbmd0aCA9IHRydWUsIGlzRGlmZnJlbnREYXRhU291cmNlID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmRnLnNldFBhZ2VySGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy52aWV3cG9ydEggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB1cGRhdGU6XHJcbiAgICAgICAgICogbm9kZV9tb2R1bGVzXFxwZXJmZWN0LXNjcm9sbGJhclxcdHlwZXNcXHBlcmZlY3Qtc2Nyb2xsYmFyLmQudHNcclxuICAgICAgICAgKiBsYXN0U2Nyb2xsVG9wOiBudW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmICF0aGlzLmRnLmlzRWRpdGluZygpICYmICF0aGlzLmRnLmNsaWVudEZpbHRlckNoYW5nZWQgJiYgIXRoaXMuZGcuYXV0b0hlaWdodCApIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb0xlZnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucm93c0NhY2hlID0ge307XHJcbiAgICAgICAgY29uc3Qga2VlcHNjcm9sbFBvcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsSW5mbyA9IHRoaXMuZGcuZGZzLmdldFN0YXRlKCkuc2Nyb2xsSW5mbztcclxuICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8gKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsSW5mby55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSBzY3JvbGxJbmZvLnk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZS5zY3JvbGxUb1koc2Nyb2xsSW5mby55KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoc2Nyb2xsSW5mby55LCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxJbmZvLngpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBzY3JvbGxJbmZvLng7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZS5zY3JvbGxUb1goc2Nyb2xsSW5mby54KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmRncy5vblNjcm9sbE1vdmUoc2Nyb2xsSW5mby54LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCgpO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChpc1NhbWVMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGtlZXBzY3JvbGxQb3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgIFxyXG5cclxuICAgICAgICBpZiAoaXNEaWZmcmVudERhdGFTb3VyY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5pbml0U2VsZWN0T3JDaGVja2VkKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5yZWZyZXNoU2VsZWN0ZWREYXRhKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGcuY2xpZW50RmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZS5lbWl0KHRoaXMuZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZXN0cm95U3Vic2NyaXB0aW9ucygpIHtcclxuICAgICAgICBpZiAodGhpcy5zdWJzY3JpcHRpb25zICYmIHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goKHN1YjogU3Vic2NyaXB0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ViKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsaXN0ZW5TdWJqZWN0cygpIHtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lTdWJzY3JpcHRpb25zKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZ3JpZFNpemVTdWJzY3JpYmUgPSB0aGlzLmRmcy5ncmlkU2l6ZSQucGlwZShcclxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXHJcbiAgICAgICAgKS5waXBlKFxyXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUoNTApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoc3RhdGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2V0UGFnZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhoID0gdGhpcy5kZy5zZXRIZWFkZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gc3RhdGUuaGVpZ2h0IC0gdGhpcy50b3A7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkV2lkdGggPSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IE1hdGguZmxvb3Ioc3RhdGUud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb3dIZWlnaHQgPSBzdGF0ZS5yb3dIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggLT0gMjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0VyA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdwb3J0SCA9IHRoaXMuZ2V0Vmlld1BvcnRIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zR3JvdXAgPSBzdGF0ZS5jb2x1bW5zR3JvdXA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZXRGaXhlZFJpZ2h0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUoc3RhdGUuY29sdW1uc0dyb3VwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2hvd0ZpeGVkU2hhZG93LmVtaXQoeyBzaG93UmlnaHRTaGFkb3c6IHRoaXMuc2hvd1JpZ2h0U2hhZG93LCB4OiB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Njcm9sbFhUaW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fc2Nyb2xsWFRpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsWFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rZWVwU2Nyb2xsYmFyUG9zaXRpb24ob2xkV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Njcm9sbFhUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rZWVwU2Nyb2xsYmFyUG9zaXRpb24ob2xkV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsQmFyTW9kZSA9PT0gJ2FsbHdheXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kZy5zaG93U2Nyb2xsQXJyb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnNjcm9sbGJhclVwZGF0ZS5lbWl0KHsgc2Nyb2xsYmFyUmVmOiB0aGlzLnBzLmluc3RhbmNlLCByaWdodFdpZHRoOiB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXBTY3JvbGxiYXJQb3NpdGlvbihvbGRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmdyaWRTaXplU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb2x1bW5SZXNpemVTdWJzY3JpYmUgPSB0aGlzLmRmcy5jb2x1bW5SZXNpemUkLnN1YnNjcmliZSgoY2c6IENvbHVtbkdyb3VwKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uU2l6ZShjZyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY29sdW1uUmVzaXplU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3Muc2V0U2VsZWNlZFJvdy5zdWJzY3JpYmUoKHI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHIuaWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0Um93U3Vic2NyaWJlID0gdGhpcy5kZnMuc2VsZWN0Um93JC5zdWJzY3JpYmUoKHJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJvdykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSByb3cuaWQ7XHJcbiAgICAgICAgICAgICAgICAvLyAyMDIxMDgxNyDmlrnlkJHplK7np7vliqjlkI7liLfmlrDop4blm77nirbmgIFcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5zZWxlY3RSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2VsZWN0Um93U3Vic2NyaWJlID0gdGhpcy5kZnMudW5TZWxlY3RSb3ckLnN1YnNjcmliZSgocHJldlJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgaWYgKHByZXZSb3cgJiYgcHJldlJvdy5pZCA9PT0gdGhpcy5jdXJyZW50Um93SWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RlZFJvdyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5lZGl0YWJsZSAmJiB0aGlzLmRnLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9fdHJpZ2dlckJvZHlDbGlja0V2ZW50ID0gdGhpcy5kZy5zZWxlY3Rpb25Nb2RlID09PSAnZGVmYXVsdCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMudW5zZWxlY3RSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdEFsbFN1YnNjcmliZSA9IHRoaXMuZGZzLnNlbGVjdEFsbCQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuc2VsZWN0QWxsLmVtaXQocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuc2VsZWN0QWxsU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja1Jvd1N1YnNjcmliZSA9IHRoaXMuZGZzLmNoZWNrUm93JC5zdWJzY3JpYmUoKHJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy5jaGVja2VkLmVtaXQocm93KTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jaGVja1Jvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb25zU3Vic2NyaWJlID0gdGhpcy5kZnMuY2xlYXJTZWxlY3Rpb25zJC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuY2hlY2tPblNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRnLnVuU2VsZWN0QWxsLmVtaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMudW5jaGVja1Jvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnVuQ2hlY2tSb3ckLnN1YnNjcmliZSgocHJldlJvdzogU2VsZWN0ZWRSb3cpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy51bkNoZWNrZWQuZW1pdChwcmV2Um93KTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy51bmNoZWNrUm93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja0FsbFN1YnNjcmliZSA9IHRoaXMuZGZzLmNoZWNrQWxsJC5zdWJzY3JpYmUoKHJvd3M6IFNlbGVjdGVkUm93W10pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZy5jaGVja0FsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNoZWNrQWxsU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jbGVhckNoZWNrZWRzU3Vic2NyaWJlID0gdGhpcy5kZnMuY2xlYXJDaGVja2VkcyQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNlbGVjdE9uQ2hlY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZGcudW5DaGVja0FsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRSb3dzQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNsZWFyQ2hlY2tlZHNTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmRncy5zZXRTY3JvbGxiYXJQb3NpdGlvbi5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih0aGlzLnNjcm9sbExlZnQpO1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3MuY29sdW1uUmVzaXplZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8XHJcbiAgICAgICAgICAgICAgICAodGhpcy5kZy5jdXJyZW50Q2VsbCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmlzRWRpdGluZyAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY3VycmVudENlbGwuY29sdW1uLmVkaXRvciAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbi5lZGl0b3IudHlwZSA9PT0gJ3RleHRhcmVhJykpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyZG9tcyA9IHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZi1kYXRhZ3JpZC1ib2R5LXJvdzpub3QoLmYtZGF0YWdyaWQtZm9vdGVyLXJvdyknKTtcclxuICAgICAgICAgICAgICAgIHRyZG9tcy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKG4sICdoZWlnaHQnLCAnYXV0bycpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHRySUQgPSAnJztcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93SWQgPSBlLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIHRySUQgPSBUUl9QUkVGSVggKyByb3dJZDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCh0cklEKTtcclxuICAgICAgICAgICAgICAgIC8vIHRyZG9tcy5mb3JFYWNoKG4gPT4gbi5zdHlsZS5oZWlnaHQgPSAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmhlYWRlcldyYXApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2V0SGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRmcy5jb2x1bW5SZXNpemVFbmQoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3MuY2VsbENvbnRlbnRXcmFwQ2hhbmdlZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJvd0hlaWdodCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5kZy5kZnMucm93VXBkYXRlJC5zdWJzY3JpYmUoKHJvdzogeyBpbmRleDogbnVtYmVyLCBkYXRhOiBhbnkgfSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocm93ICYmIHJvdy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkQ3VzdG9tQ2VsbFN0eWxlKHJvdyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZ3JvdXBSb3dzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLmV4cGFuZEdyb3VwUm93LnBpcGUoXHJcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4gdGhpcy5ncm91cFJvd1N0YXRlQ2hhbmdlZChlLmRhdGEsIHRydWUpKTtcclxuICAgICAgICAgICAgdGhpcy5kZnMuY29sbGFwc2VHcm91cFJvdy5waXBlKFxyXG4gICAgICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXHJcbiAgICAgICAgICAgICkuc3Vic2NyaWJlKChlOiBhbnkpID0+IHRoaXMuZ3JvdXBSb3dTdGF0ZUNoYW5nZWQoZS5kYXRhLCBmYWxzZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdyb3VwUm93RXhwYW5kVXBkYXRlKGdyb3VwUm93LCBpc0V4cGFuZCkge1xyXG4gICAgICAgIGlmIChncm91cFJvdy5yb3dzICYmIGdyb3VwUm93LnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGdyb3VwUm93LnJvd3MuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmlkID09PSBuLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNFeHBhbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbJ19fZ3JvdXBfdmlzaWJsZV9fJ10gPSBpc0V4cGFuZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbJ19fZ3JvdXBfdmlzaWJsZV9fJ10gPSBncm91cFJvdy5leHBhbmRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucm93cyAmJiBlbGVtZW50LnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwUm93RXhwYW5kVXBkYXRlKGVsZW1lbnQsIGlzRXhwYW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBwcml2YXRlIGdyb3VwUm93U3RhdGVDaGFuZ2VkKHJvd0RhdGEsIGV4cGFuZDogYm9vbGVhbikge1xyXG4gICAgICAgIGlmICh0aGlzLmRnLnZpcnR1YWxpemVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyID0gdGhpcy5kYXRhLmZpbmQobiA9PiBuLmlkID09PSByb3dEYXRhLmlkKTtcclxuICAgICAgICAgICAgdGhpcy5ncm91cFJvd0V4cGFuZFVwZGF0ZShnciwgZXhwYW5kKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldENhbnZhc0hlaWdodCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXNbJ19wc1VwZGF0ZVRpbWVyXyddKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzWydfcHNVcGRhdGVUaW1lcl8nXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzWydfcHNVcGRhdGVUaW1lcl8nXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9LCAxMDApXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBrZWVwU2Nyb2xsYmFyUG9zaXRpb24ob2xkV2lkdGg6IG51bWJlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuOyAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsUmVhY2ggPSB0aGlzLnBzLmluc3RhbmNlLnJlYWNoO1xyXG4gICAgICAgIGxldCB0ID0gdGhpcy53aWR0aCAtIG9sZFdpZHRoO1xyXG4gICAgICAgIGxldCBzY3JvbGxMZWZ0ID0gdDtcclxuICAgICAgICBpZiAoc2Nyb2xsUmVhY2gueCA9PT0gJ3N0YXJ0JyB8fCAhdGhpcy5wcy5pbnN0YW5jZS5sYXN0U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICBzY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1goMCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzY3JvbGxSZWFjaC54ID09PSAnZW5kJykge1xyXG4gICAgICAgICAgICB0aGlzLnBzLnNjcm9sbFRvUmlnaHQoMCk7XHJcbiAgICAgICAgICAgIHNjcm9sbExlZnQgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNjcm9sbExlZnQgPSB0aGlzLnBzLmluc3RhbmNlLmxhc3RTY3JvbGxMZWZ0IC0gdDtcclxuICAgICAgICAgICAgdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHNjcm9sbExlZnQpO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVDb2x1bW5TaXplKGNnOiBDb2x1bW5Hcm91cCkge1xyXG4gICAgICAgIGlmIChjZykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbHVtbnNHcm91cCA9IGNnO1xyXG4gICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLnJpZ2h0Rml4ZWRXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy5sZWZ0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmNvbHNXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLm5vcm1hbFdpZHRoO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgdGhpcy5tYXhTY3JvbGxMZWZ0ID0gdGhpcy5jb2xzV2lkdGggKyB0aGlzLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyBncmlkIOWuueWZqOWuveW6plxyXG4gICAgICAgICAgICBjb25zdCBkZ0NvbnRhaW5lcldpZHRoID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICAvLyDmiYDmnInliJflrr3kuYvlkoxcclxuICAgICAgICAgICAgY29uc3QgYWxsQ29sc1dpZHRoID0gTWF0aC5mbG9vcih0aGlzLmNvbHVtbnNHcm91cC50b3RhbFdpZHRoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYm9keVN0eWxlID0gdGhpcy5nZXRCb2R5U3R5bGUoKTtcclxuICAgICAgICAgICAgaWYgKGRnQ29udGFpbmVyV2lkdGggPiBhbGxDb2xzV2lkdGggfHwgZGdDb250YWluZXJXaWR0aCA9PT0gYWxsQ29sc1dpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+z5L6n5Zu65a6a5YiX55qE5L2N572uXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy53aWR0aCAgKyB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzLmluc3RhbmNlLnNjcm9sbGJhcllBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3dSaWdodFNoYWRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoICs9IDE4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0IC0gdGhpcy5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhbnZhc1dpZHRoID4gdGhpcy50b3RhbFdpZHRoICYmIHRoaXMuY2FudmFzV2lkdGggLSB0aGlzLnRvdGFsV2lkdGggIDwgMTgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggKz0gMTg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvdGFsV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC50b3RhbFdpZHRoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycgJiYgIXRoaXMucmlnaHRSb3dzQ21wICYmICF0aGlzLmRnLnVzZUNvbnRyb2xQYW5lbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbFdpZHRoICs9IDE4O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gcHJpdmF0ZSBzZXRGaXhlZFJpZ2h0UG9zaXRpb24oKSB7XHJcbiAgICAvLyAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAvLyAgICAgdGhpcy5sZWZ0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgLy8gICAgIHRoaXMuY29sc1dpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGg7XHJcblxyXG4gICAgLy8gICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAvLyAgICAgdGhpcy5tYXhTY3JvbGxMZWZ0ID0gdGhpcy5jb2xzV2lkdGggKyB0aGlzLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgLy8gICAgIC8vIGdyaWQg5a655Zmo5a695bqmXHJcbiAgICAvLyAgICAgY29uc3QgZGdDb250YWluZXJXaWR0aCA9IHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcclxuICAgIC8vICAgICAvLyDmiYDmnInliJflrr3kuYvlkoxcclxuICAgIC8vICAgICBjb25zdCBhbGxDb2xzV2lkdGggPSBNYXRoLmZsb29yKHRoaXMuY29sdW1uc0dyb3VwLnRvdGFsV2lkdGgpO1xyXG5cclxuXHJcbiAgICAvLyAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgLy8gICAgIGlmIChkZ0NvbnRhaW5lcldpZHRoID4gYWxsQ29sc1dpZHRoIHx8IGRnQ29udGFpbmVyV2lkdGggPT09IGFsbENvbHNXaWR0aCkge1xyXG4gICAgLy8gICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgLy8gICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gdHJ1ZTtcclxuICAgIC8vICAgICAgICAgLy8g5Y+z5L6n5Zu65a6a5YiX55qE5L2N572uXHJcbiAgICAvLyAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLndpZHRoIC0gdGhpcy5yaWdodEZpeGVkV2lkdGggKyB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRDdXN0b21DZWxsU3R5bGUocm93OiB7IGluZGV4OiBudW1iZXIsIGRhdGE6IGFueSB9KSB7XHJcblxyXG4gICAgICAgIGxldCByaWdodFRycyA9IFtdO1xyXG4gICAgICAgIGxldCBsZWZ0VHJzID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodEVsKSB7XHJcbiAgICAgICAgICAgIHJpZ2h0VHJzID0gdGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0cicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgbGVmdFRycyA9IHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZml4ZWQtbGVmdC1yb3cnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHRycyA9IHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0ci5mLWRhdGFncmlkLWJvZHktcm93Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHVwZGF0ZUNlbGxTdHlsZSA9IChhcnIsIGNvbCwgc3R5bGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRkID0gYXJyW3Jvdy5pbmRleF0ucXVlcnlTZWxlY3RvcihgW2ZpZWxkPVwiJHtjb2wuZmllbGR9XCJdYCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnJlbmRlckN1c3RvbVN0eWxlKHN0eWxlLCB0ZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmRnLmZsYXRDb2x1bW5zLmZvckVhY2goY29sID0+IHtcclxuICAgICAgICAgICAgaWYgKGNvbC5zdHlsZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9yZCA9IHJvdy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsID0gVXRpbHMuZ2V0VmFsdWUoY29sLmZpZWxkLCBfcmQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3MgPSBjb2wuc3R5bGVyKHZhbCwgX3JkLCByb3cuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNzICYmIE9iamVjdC5rZXlzKGNzKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDZWxsU3R5bGUobGVmdFRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKHJpZ2h0VHJzLCBjb2wsIGNzKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDZWxsU3R5bGUodHJzLCBjb2wsIGNzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tlZFJvd3NDaGFuZ2VkKCkge1xyXG4gICAgICAgIHRoaXMuZGdzLm9uQ2hlY2tlZFJvd3NDb3VudENoYW5nZSgpO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrZWRSb3dzID0gdGhpcy5kZy5jaGVja2VkcztcclxuICAgICAgICB0aGlzLmRnLmNoZWNrVmFsdWVzID0gY2hlY2tlZFJvd3MubWFwKHIgPT4gci5pZCk7XHJcbiAgICAgICAgdGhpcy5kZy5jaGVja1ZhbHVlc0NoYW5nZS5lbWl0KHRoaXMuZGcuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgIHRoaXMuZGcuY2hlY2tlZENoYW5nZS5lbWl0KGNoZWNrZWRSb3dzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFRyRG9tSGVpZ2h0KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3QgPSBbXTtcclxuICAgICAgICBsZXQgcmlnaHRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgbGVmdFRycyA9IFtdO1xyXG4gICAgICAgIGxldCB0cmRvbXMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgcmlnaHRUcnMgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICBsZWZ0VHJzID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC1sZWZ0LXJvdycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgdHJkb21zID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmYtZGF0YWdyaWQtYm9keS1yb3cnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJkb21zLmZvckVhY2goKHRyLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0MSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHQyID0gTWF0aC5jZWlsKHRyLm9mZnNldEhlaWdodCk7XHJcbiAgICAgICAgICAgIGxldCB0MyA9IDA7XHJcbiAgICAgICAgICAgIGlmIChsZWZ0VHJzICYmIGxlZnRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0MSA9IE1hdGguY2VpbChsZWZ0VHJzW2ldLm9mZnNldEhlaWdodCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChyaWdodFRycyAmJiByaWdodFRycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHQzID0gTWF0aC5jZWlsKHJpZ2h0VHJzW2ldLm9mZnNldEhlaWdodCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IF9oID0gTWF0aC5tYXgodDEsIHQyLCB0MywgdGhpcy5kZy5yb3dIZWlnaHQpO1xyXG4gICAgICAgICAgICBsaXN0LnB1c2goX2gpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgfVxyXG4gICAgLyoqIOWFgeiuuOaVsOaNruaKmOihjOaXtu+8jOiuoeeul+ihjOWPt+eahOihjOmrmCAqL1xyXG4gICAgdXBkYXRlUm93SGVpZ2h0KHRyRG9tSWQgPSBudWxsKSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZhc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICghdGhpcy5tYWluQXJlYSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZ0JvZHkgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmYtZGF0YWdyaWQtYm9keScpO1xyXG4gICAgICAgIGlmIChkZ0JvZHkpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKGRnQm9keSwgJ2RhdGEtd3JhcCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlQ2xhc3MoZGdCb2R5LCAnZGF0YS13cmFwJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjc3NUZXh0QXJyID0gW107XHJcblxyXG4gICAgICAgIGlmICghdHJEb21JZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MuZm9yRWFjaCgociwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgcm93SWQgPSB0aGlzLmRmcy5wcmltYXJ5SWQocik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cklEID0gVFJfUFJFRklYICsgcm93SWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0VHJJZCA9IHRySUQgKyAnX2ZpeGVkbGVmdCc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByaWdodFRySWQgPSB0cklEICsgJ19maXhlZHJpZ2h0JztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmdldFRyRG9tSGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaCA9IGxpc3RbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkuZGF0YS13cmFwICMke3RySUR9eyBoZWlnaHQ6ICR7aH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7cmlnaHRUcklkfXsgaGVpZ2h0OiAke2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke2xlZnRUcklkfXsgaGVpZ2h0OiAke2xpc3RbaV19cHggfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNzc1RleHRBcnIucHVzaChgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC5mLWRhdGFncmlkLWJvZHkgIyR7dHJJRH17IGhlaWdodDogJHtsaXN0W2ldfXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3JpZ2h0VHJJZH17IGhlaWdodDogJHtsaXN0W2ldfXB4IH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkxID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke2xlZnRUcklkfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5MiA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHt0cklEfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5MyA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtyaWdodFRySWR9YDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MucmVtb3ZlQ3NzUnVsZShrZXkxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5yZW1vdmVDc3NSdWxlKGtleTIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnJlbW92ZUNzc1J1bGUoa2V5Myk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGdzLmFwcGVuZENzc1J1bGVzKGNzc1RleHRBcnIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNzc1RleHRBcnIgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgZG9tU2VsID0gJyMnICsgdHJEb21JZDtcclxuICAgICAgICAgICAgY29uc3QgX2FyciA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJ0ciA9IHRoaXMuZml4ZWRSaWdodEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcihkb21TZWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwocnRyLm9mZnNldEhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbHRyID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tU2VsKTtcclxuICAgICAgICAgICAgICAgIGlmIChsdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfYXJyLnB1c2goTWF0aC5jZWlsKGx0ci5vZmZzZXRIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tU2VsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwodHIub2Zmc2V0SGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IF9oID0gTWF0aC5tYXgoLi4uX2Fycik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsZWZ0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkbGVmdCc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkcmlnaHQnO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7bGVmdFRySWR9eyBoZWlnaHQ6ICR7X2h9cHg7fWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keS5kYXRhLXdyYXAgIyR7dHJEb21JZH17IGhlaWdodDogJHtfaH1weDt9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5LmRhdGEtd3JhcCAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7X2h9cHg7fWApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtsZWZ0VHJJZH17IGhlaWdodDogJHtfaH1weCB9YCk7XHJcbiAgICAgICAgICAgICAgICBjc3NUZXh0QXJyLnB1c2goYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSAuZi1kYXRhZ3JpZC1ib2R5ICMke3RyRG9tSWR9eyBoZWlnaHQ6ICR7X2h9cHggfWApO1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dEFyci5wdXNoKGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gLmYtZGF0YWdyaWQtYm9keSAjJHtyaWdodFRySWR9eyBoZWlnaHQ6ICR7X2h9cHggfWApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRncy5hcHBlbmRDc3NSdWxlcyhjc3NUZXh0QXJyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlQ2FudmFzSGVpZ2h0KCk7XHJcblxyXG4gICAgICAgIC8vIOenu+mZpGhlaWdodDogYXV0b1xyXG4gICAgICAgIGNvbnN0IHRyZG9tcyA9IHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZi1kYXRhZ3JpZC1ib2R5LXJvdzpub3QoZi1kYXRhZ3JpZC1mb290ZXItcm93KScpO1xyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKG4gPT4gbi5zdHlsZS5oZWlnaHQgPSAnJyk7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5jZFsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBnZXRCb2R5U3R5bGUoKSB7XHJcbiAgICAgICAgbGV0IGggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy51c2VCbGFua1doZW5EYXRhSXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgaCA9IHRoaXMuZGcuZW1wdHlEYXRhSGVpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGggPSB0aGlzLmRnLmVtcHR5RGF0YUhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJEYXRhICYmIHRoaXMuZGcuc2hvd0Zvb3Rlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBmZCA9IHRoaXMuZGcuZm9vdGVyRGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJEYXRhLnN1YnNjcmliZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmZCA9IHRoaXMuZGcuZm9vdGVyRGF0YVsndmFsdWUnXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmZCAmJiBBcnJheS5pc0FycmF5KGZkKSAmJiBmZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGggLSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBoIC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zaG93Rm9vdGVyICYmIHRoaXMuZGcuZm9vdGVyUG9zaXRpb24gPT09ICdib3RoJykge1xyXG4gICAgICAgICAgICAgICAgaCA9IGggLSB0aGlzLmRnLmZvb3RlckhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBoZWlnaHQ6IGAke01hdGguZmxvb3IoaCkgKyAxfXB4YFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVTY3JvbGxQb3NpdGlvbihzY3JvbGxMZWZ0OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy53aWR0aCAtIHRoaXMucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID09PSB0aGlzLm1heFNjcm9sbExlZnQgfHwgdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCA+IHRoaXMubWF4U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuc2Nyb2xsTGVmdH1weCwgMHB4LCAwcHgpYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuZml4ZWRSaWdodFNjcm9sbExlZnR9cHgsIDBweCwgMHB4KWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNjcm9sbFRvWCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICB0aGlzLmRmcy51cGRhdGVQcm9wZXJ0eSgnc2Nyb2xsSW5mbycsIHsgeTogJGV2ZW50LnRhcmdldC5zY3JvbGxUb3AsIHggfSk7XHJcbiAgICAgICAgdGhpcy5kZ3Muc2hvd0ZpeGVkU2hhZG93LmVtaXQoeyBzaG93UmlnaHRTaGFkb3c6IHRoaXMuc2hvd1JpZ2h0U2hhZG93LCB4OiB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2Nyb2xsVG9ZKCRldmVudDogYW55KSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9zY3JvbGxUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fc2Nyb2xsVGltZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgeSA9ICRldmVudC50YXJnZXQuc2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcudmlydHVhbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wID0geTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnVwZGF0ZVByb3BlcnR5KCdzY3JvbGxJbmZvJywgeyB5LCB4OiAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRnLnNjcm9sbFkuZW1pdCh5KTtcclxuICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKHksIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBzWFJlYWNoU3RhcnQoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICBjb25zdCB4ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oeCk7XHJcbiAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKHgsIFNDUk9MTF9YX1JFQUNIX1NUQVJUX0FDVElPTik7XHJcbiAgICB9XHJcblxyXG4gICAgb25Qc1hSZWFjaEVuZCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgLy8gY29uc3QgeCA9ICRldmVudC50YXJnZXQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAvLyB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHgpO1xyXG4gICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIC8vIC8vIHRoaXMuZGdzLm9uU2hvd0ZpeGVkU2hhZG93KHRoaXMuc2hvd1JpZ2h0U2hhZG93KTtcclxuICAgICAgICAvLyB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfUkVBQ0hfRU5EX0FDVElPTik7XHJcbiAgICB9XHJcblxyXG4gICAgaXNDaGVja2VkKHJvd0RhdGE6IGFueSkge1xyXG4gICAgICAgIGlmIChyb3dEYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRmcy5pc1Jvd0NoZWNrZWQocm93RGF0YVt0aGlzLmRnLmlkRmllbGRdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzU2VsZWN0ZWQocm93RGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGZzLmlzUm93U2VsZWN0ZWQocm93RGF0YVt0aGlzLmRnLmlkRmllbGRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUdyb3VwUm93KHJvdywgb3BlbiA9IHRydWUpIHtcclxuICAgICAgICByb3cuZXhwYW5kZWQgPSBvcGVuO1xyXG4gICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICAvKiogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g5YiGID09PT09PSDpmpQgPT09PT09IOe6vyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xyXG5cclxuICAgIC8qKiDojrflj5blj6/op4bljLrln5/pq5jluqYgKi9cclxuICAgIHB1YmxpYyBnZXRWaWV3UG9ydEhlaWdodCgpIHtcclxuICAgICAgICBsZXQgdmlld1BvcnRIZWlnaHQgPSB0aGlzLmRnLmhlaWdodDtcclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93SGVhZGVyKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKHRoaXMuZGcuZW5hYmxlRmlsdGVyUm93IHx8IHRoaXMuZGcuZW5hYmxlU21hcnRGaWx0ZXIpICYmIHRoaXMuZGcuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCAtPSB0aGlzLmRnLmZpbHRlckJhckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dSb3dHcm91cFBhbmVsKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0IC09IHRoaXMuZGcucm93R3JvdXBQYW5lbEhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCA9IHZpZXdQb3J0SGVpZ2h0IC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5wYWdpbmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnBhZ2VySGVpZ2h0IC0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgLT0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudmlld3BvcnRIID0gdmlld1BvcnRIZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdQb3J0SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOS4jeaKmOihjOaXtu+8jOaJgOacieaVsOaNrueahOmrmOW6plxyXG4gICAgcHJpdmF0ZSBhbGxSb3dzSGVpZ2h0KCkge1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodHBhdGNoID0gMTsgIC8vIHRoaXMuZGcuYXV0b0hlaWdodCA/IDIgOiAxO1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodCA9IHRoaXMuZGcucm93SGVpZ2h0ICsgcm93SGVpZ2h0cGF0Y2g7XHJcblxyXG4gICAgICAgIGxldCBpdGVtc0NvdW50ID0gMDtcclxuICAgICAgICBpZiAodGhpcy5kZy5ncm91cFJvd3MpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YS5maWx0ZXIobiA9PiBuWydfX2dyb3VwX3Zpc2libGVfXyddIHx8IG5bJ19fZ3JvdXBfdmlzaWJsZV9fJ109PT11bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5ncm91cFN1bW1hcnlQb3NpdGlvbiA9PT0gJ2luR3JvdXBSb3cnKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtc0NvdW50ID0gZGF0YS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9mb290ZXJfXyddKS5sZW5ndGg7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtc0NvdW50ID0gZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpdGVtc0NvdW50ID0gdGhpcy5kYXRhLmxlbmd0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBoID0gaXRlbXNDb3VudCAqIHJvd0hlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICBoICs9IGl0ZW1zQ291bnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaCArPSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDYW52YXNIZWlnaHQoKSB7XHJcbiAgICAgICAgbGV0IGNhbnZhc0hlaWdodCA9IDA7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5kYXRhIHx8ICF0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gMDtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5ub3dyYXApIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLm1heEhlaWdodCAmJiB0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSBNYXRoLmZsb29yKHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGhpcy5hbGxSb3dzSGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmdldFRyRG9tSGVpZ2h0KCkucmVkdWNlKChyLCBjKSA9PiByICsgYywgMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWNhbnZhc0hlaWdodCkge1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLnZpZXdwb3J0SDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhc0hlaWdodCA9IGNhbnZhc0hlaWdodCArICh0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgKHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWEFjdGl2ZSddKSA/IDE4IDogMCk7XHJcbiAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSBjYW52YXNIZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhc0hlaWdodDtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVDYW52YXNIZWlnaHQoKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXNIZWlnaHQgPSB0aGlzLmdldENhbnZhc0hlaWdodCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGdldFJvd0Zyb21Qb3NpdGlvbih5KSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoeSAvICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRWaXNpYmxlUmFuZ2Uodmlld3BvcnRUb3A/OiBudW1iZXIsIHZpZXdwb3J0TGVmdD86IG51bWJlcikge1xyXG4gICAgICAgIGlmICh2aWV3cG9ydFRvcCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZpZXdwb3J0VG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2aWV3cG9ydExlZnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2aWV3cG9ydExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0b3A6IHRoaXMuZ2V0Um93RnJvbVBvc2l0aW9uKHZpZXdwb3J0VG9wKSxcclxuICAgICAgICAgICAgYm90dG9tOiB0aGlzLmdldFJvd0Zyb21Qb3NpdGlvbih2aWV3cG9ydFRvcCArIHRoaXMudmlld3BvcnRIKSArIDEsXHJcbiAgICAgICAgICAgIGxlZnRQeDogdmlld3BvcnRMZWZ0LFxyXG4gICAgICAgICAgICByaWdodFB4OiB2aWV3cG9ydExlZnQgKyB0aGlzLnZpZXdwb3J0V1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRSZW5kZXJlZFJhbmdlKHZpZXdwb3J0VG9wPzogbnVtYmVyLCB2aWV3cG9ydExlZnQ/OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCByYW5nZSA9IHRoaXMuZ2V0VmlzaWJsZVJhbmdlKHZpZXdwb3J0VG9wLCB2aWV3cG9ydExlZnQpO1xyXG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9IE1hdGgucm91bmQodGhpcy52aWV3cG9ydEggLyAodGhpcy5kZy5yb3dIZWlnaHQgKyAxKSk7XHJcbiAgICAgICAgY29uc3QgbWluQnVmZmVyID0gdGhpcy5taW5Sb3dCdWZmZXI7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnZTY3JvbGxEaXIgPT0gLTEpIHtcclxuICAgICAgICAgICAgcmFuZ2UudG9wIC09IGJ1ZmZlcjtcclxuICAgICAgICAgICAgcmFuZ2UuYm90dG9tICs9IG1pbkJ1ZmZlcjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudlNjcm9sbERpciA9PSAxKSB7XHJcbiAgICAgICAgICAgIHJhbmdlLnRvcCAtPSBtaW5CdWZmZXI7XHJcbiAgICAgICAgICAgIHJhbmdlLmJvdHRvbSArPSBidWZmZXI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmFuZ2UudG9wIC09IG1pbkJ1ZmZlcjtcclxuICAgICAgICAgICAgcmFuZ2UuYm90dG9tICs9IG1pbkJ1ZmZlcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJhbmdlLnRvcCA9IE1hdGgubWF4KDAsIHJhbmdlLnRvcCk7XHJcbiAgICAgICAgcmFuZ2UuYm90dG9tID0gTWF0aC5taW4odGhpcy5kYXRhLmxlbmd0aCAtIDEsIHJhbmdlLmJvdHRvbSk7XHJcblxyXG4gICAgICAgIHJhbmdlLmxlZnRQeCAtPSB0aGlzLnZpZXdwb3J0VztcclxuICAgICAgICByYW5nZS5yaWdodFB4ICs9IHRoaXMudmlld3BvcnRXO1xyXG5cclxuICAgICAgICByYW5nZS5sZWZ0UHggPSBNYXRoLm1heCgwLCByYW5nZS5sZWZ0UHgpO1xyXG4gICAgICAgIHJhbmdlLnJpZ2h0UHggPSBNYXRoLm1pbih0aGlzLmNhbnZhc1dpZHRoLCByYW5nZS5yaWdodFB4KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJhbmdlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyUm93cyhyYW5nZSkge1xyXG4gICAgICAgIGNvbnN0IHJvd3MgPSBbXTtcclxuICAgICAgICBsZXQgZGF0YUxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgbGV0IF9kYXRhID0gIHRoaXMuZGF0YTtcclxuXHJcbiAgICAgICAgIC8vIOWQr+eUqOWIhue7hFxyXG4gICAgICAgIGlmICh0aGlzLmRnLmdyb3VwUm93cyAmJiB0aGlzLmRnLmdyb3VwRmllbGQpIHtcclxuICAgICAgICAgICAgX2RhdGEgPSAgX2RhdGEuZmlsdGVyKG4gPT4gblsnX19ncm91cF92aXNpYmxlX18nXSB8fCBuWydfX2dyb3VwX3Zpc2libGVfXyddPT09dW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmdyb3VwU3VtbWFyeVBvc2l0aW9uID09PSAnaW5Hcm91cFJvdycpIHtcclxuICAgICAgICAgICAgICAgIF9kYXRhID0gX2RhdGEuZmlsdGVyKG4gPT4gIW5bJ19fZ3JvdXBfZm9vdGVyX18nXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRhdGFMZW5ndGggPSBfZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMucm93c0NhY2hlID0ge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gcmFuZ2UudG9wOyBpIDw9IHJhbmdlLmJvdHRvbTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJvd3NDYWNoZVtpXSB8fCAoaSA9PSBkYXRhTGVuZ3RoKSApIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByb3dzLnB1c2goaSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYW4gZW50cnkgcmlnaHQgYXdheSBzbyB0aGF0IGFwcGVuZFJvd0h0bWwoKSBjYW5cclxuICAgICAgICAgICAgLy8gc3RhcnQgcG9wdWxhdGF0aW5nIGl0LlxyXG4gICAgICAgICAgICB0aGlzLnJvd3NDYWNoZVtpXSA9IHtcclxuICAgICAgICAgICAgICAgIHJvd05vZGU6IG51bGwsXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ29sU3BhbnMgb2YgcmVuZGVyZWQgY2VsbHMgKGJ5IGNvbHVtbiBpZHgpLlxyXG4gICAgICAgICAgICAgICAgLy8gQ2FuIGFsc28gYmUgdXNlZCBmb3IgY2hlY2tpbmcgd2hldGhlciBhIGNlbGwgaGFzIGJlZW4gcmVuZGVyZWQuXHJcbiAgICAgICAgICAgICAgICBjZWxsQ29sU3BhbnM6IFtdLFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENlbGwgbm9kZXMgKGJ5IGNvbHVtbiBpZHgpLiAgTGF6eS1wb3B1bGF0ZWQgYnkgZW5zdXJlQ2VsbE5vZGVzSW5Sb3dzQ2FjaGUoKS5cclxuICAgICAgICAgICAgICAgIGNlbGxOb2Rlc0J5Q29sdW1uSWR4OiBbXSxcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb2x1bW4gaW5kaWNlcyBvZiBjZWxsIG5vZGVzIHRoYXQgaGF2ZSBiZWVuIHJlbmRlcmVkLCBidXQgbm90IHlldCBpbmRleGVkIGluXHJcbiAgICAgICAgICAgICAgICAvLyBjZWxsTm9kZXNCeUNvbHVtbklkeC4gIFRoZXNlIGFyZSBpbiB0aGUgc2FtZSBvcmRlciBhcyBjZWxsIG5vZGVzIGFkZGVkIGF0IHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gZW5kIG9mIHRoZSByb3cuXHJcbiAgICAgICAgICAgICAgICBjZWxsUmVuZGVyUXVldWU6IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSByb3dzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5yb3dzQ2FjaGVbcm93c1tpXV0ucm93Tm9kZSA9IF9kYXRhW3Jvd3NbaV1dO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMucm93c0NhY2hlKS5tYXAobiA9PiB0aGlzLnJvd3NDYWNoZVtuXS5yb3dOb2RlKS5maWx0ZXIobiA9PiBuKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSByZW1vdmVSb3dGcm9tQ2FjaGUocm93KSB7XHJcbiAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IHRoaXMucm93c0NhY2hlW3Jvd107XHJcbiAgICAgICAgaWYgKCFjYWNoZUVudHJ5KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnJvd3NDYWNoZVtyb3ddO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xlYW51cFJvd3MocmFuZ2VUb0tlZXApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gdGhpcy5yb3dzQ2FjaGUpIHtcclxuICAgICAgICAgICAgaWYgKGkgPCByYW5nZVRvS2VlcC50b3AgfHwgaSA+IHJhbmdlVG9LZWVwLmJvdHRvbSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dGcm9tQ2FjaGUoaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFzWVNjcm9sbGJhcihzaG93WXNjcm9sbGJhcjogYm9vbGVhbikge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUodGhpcy5jb2x1bW5zR3JvdXApO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLnNjcm9sbGJhclVwZGF0ZS5lbWl0KHsgc2Nyb2xsYmFyUmVmOiB0aGlzLnBzLmluc3RhbmNlIH0pO1xyXG4gICAgICAgIH0sIDYwKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsaWNrU2Nyb2xsQXJyb3coJGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgeyBkaXIsIGV2ZW50IH0gPSAkZXZlbnQ7XHJcbiAgICAgICAgaWYgKHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IHgsIHkgfSA9IHRoaXMucHMuaW5zdGFuY2UucmVhY2g7XHJcbiAgICBcclxuICAgICAgICAgICAgc3dpdGNoKGRpcikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHghPT0gJ3N0YXJ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCAtIDQwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeCE9PSAnZW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCArIDQwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHkgIT09ICdzdGFydCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wIC0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeSAhPT0gJ2VuZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wICsgNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlckRhdGEoZGV0ZWN0Y2hhbmdlcyA9IHRydWUpIHtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLnZpcnR1YWxpemVkIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgdmlzaWJsZSA9IHRoaXMuZ2V0VmlzaWJsZVJhbmdlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkID0gdGhpcy5nZXRSZW5kZXJlZFJhbmdlKCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW1vdmUgcm93cyBubyBsb25nZXIgaW4gdGhlIHZpZXdwb3J0XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cFJvd3MocmVuZGVyZWQpO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVuZGVyIG1pc3Npbmcgcm93c1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLnJlbmRlclJvd3MocmVuZGVyZWQpO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Um93SW5kZXggPSByZW5kZXJlZC50b3A7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuXHJcblxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5ibGFua1RvcEhlaWdodCA9IHRoaXMuc3RhcnRSb3dJbmRleCAqICh0aGlzLmRnLnJvd0hlaWdodCArIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQgLSB0aGlzLmJsYW5rVG9wSGVpZ2h0IC0gKHRoaXMucm93cy5sZW5ndGggKiAodGhpcy5kZy5yb3dIZWlnaHQgKyAxKSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWEFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ibGFua0JvdHRvbUhlaWdodCArPSAyMjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmIChkZXRlY3RjaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGhhbmRsZVNjcm9sbCgpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVTY3JvbGwoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9oYW5kbGVTY3JvbGwoKSB7XHJcbiAgICAgICAgY29uc3Qgdmlld3BvcnRDb250YWluZXIgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudDtcclxuICAgICAgICBsZXQgbWF4U2Nyb2xsRGlzdGFuY2VZID0gdmlld3BvcnRDb250YWluZXIuc2Nyb2xsSGVpZ2h0IC0gdmlld3BvcnRDb250YWluZXIuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIGxldCBtYXhTY3JvbGxEaXN0YW5jZVggPSB2aWV3cG9ydENvbnRhaW5lci5zY3JvbGxXaWR0aCAtIHZpZXdwb3J0Q29udGFpbmVyLmNsaWVudFdpZHRoO1xyXG5cclxuICAgICAgICAvLyBQcm90ZWN0IGFnYWluc3QgZXJyb25lb3VzIGNsaWVudEhlaWdodC9XaWR0aCBncmVhdGVyIHRoYW4gc2Nyb2xsSGVpZ2h0L1dpZHRoLlxyXG4gICAgICAgIC8vIFNvbWV0aW1lcyBzZWVuIGluIENocm9tZS5cclxuICAgICAgICBtYXhTY3JvbGxEaXN0YW5jZVkgPSBNYXRoLm1heCgwLCBtYXhTY3JvbGxEaXN0YW5jZVkpO1xyXG4gICAgICAgIG1heFNjcm9sbERpc3RhbmNlWCA9IE1hdGgubWF4KDAsIG1heFNjcm9sbERpc3RhbmNlWCk7XHJcblxyXG4gICAgICAgIC8vIENlaWxpbmcgdGhlIG1heCBzY3JvbGwgdmFsdWVzXHJcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsVG9wID4gbWF4U2Nyb2xsRGlzdGFuY2VZKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gbWF4U2Nyb2xsRGlzdGFuY2VZO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxMZWZ0ID4gbWF4U2Nyb2xsRGlzdGFuY2VYKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IG1heFNjcm9sbERpc3RhbmNlWDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHZTY3JvbGxEaXN0ID0gTWF0aC5hYnModGhpcy5zY3JvbGxUb3AgLSB0aGlzLnByZXZTY3JvbGxUb3ApO1xyXG4gICAgICAgIGNvbnN0IGhTY3JvbGxEaXN0ID0gTWF0aC5hYnModGhpcy5zY3JvbGxMZWZ0IC0gdGhpcy5wcmV2U2Nyb2xsTGVmdCk7XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICAgICAgLy8gJHZpZXdwb3J0U2Nyb2xsQ29udGFpbmVyWFswXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgLy8gaWYgKGhhc0Zyb3plbkNvbHVtbnMoKSkge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGhhc0Zyb3plblJvd3MpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BSWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGhhc0Zyb3plblJvd3MpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BMWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBsYXN0U2Nyb2xsVG9wID0gdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3A7XHJcblxyXG4gICAgICAgIGlmICh2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnZTY3JvbGxEaXIgPSB0aGlzLnByZXZTY3JvbGxUb3AgPCB0aGlzLnNjcm9sbFRvcCA/IDEgOiAtMTtcclxuICAgICAgICAgICAgdGhpcy5wcmV2U2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cyAmJiAhb3B0aW9ucy5mcm96ZW5Cb3R0b20pIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRCb3R0b21MWzBdLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgJHZpZXdwb3J0VG9wTFswXS5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN3aXRjaCB2aXJ0dWFsIHBhZ2VzIGlmIG5lZWRlZFxyXG4gICAgICAgICAgICBpZiAodlNjcm9sbERpc3QgPCB0aGlzLnZpZXdwb3J0SCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaFNjcm9sbERpc3QgfHwgdlNjcm9sbERpc3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZHggPSBNYXRoLmFicyh0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbExlZnQgLSB0aGlzLnNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICBjb25zdCBkeSA9IE1hdGguYWJzKGxhc3RTY3JvbGxUb3AgLSB0aGlzLnNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgIGlmIChkeCA+IDIwIHx8IGR5ID4gMjApIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHJlbmRlcmluZyBpcyBmb3JjZWQgb3Igc2Nyb2xsaW5nIGlzIHNtYWxsIGVub3VnaCB0byBiZSBcImVhc3lcIiwganVzdCByZW5kZXJcclxuICAgICAgICAgICAgICAgIGlmIChkeSA8IHRoaXMudmlld3BvcnRIICYmIGR4IDwgdGhpcy52aWV3cG9ydFcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCB8fCB2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3Njcm9sbFRvKHkpIHtcclxuICAgICAgICBjb25zdCAkdmlld3BvcnRTY3JvbGxDb250YWluZXJZID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgeSA9IE1hdGgubWF4KHksIDApO1xyXG4gICAgICAgIHkgPSBNYXRoLm1pbih5LCB0aGlzLmNhbnZhc0hlaWdodCAtIHRoaXMudmlld3BvcnRIKTtcclxuXHJcbiAgICAgICAgY29uc3QgbmV3U2Nyb2xsVG9wID0geTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucHJldlNjcm9sbFRvcCAhPSBuZXdTY3JvbGxUb3ApIHtcclxuICAgICAgICAgICAgdGhpcy52U2Nyb2xsRGlyID0gKHRoaXMucHJldlNjcm9sbFRvcCA8IG5ld1Njcm9sbFRvcCkgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gKHRoaXMuc2Nyb2xsVG9wID0gdGhpcy5wcmV2U2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Db2x1bW5zKCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICR2aWV3cG9ydFRvcExbMF0uc2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgJHZpZXdwb3J0Qm90dG9tTFswXS5zY3JvbGxUb3AgPSAkdmlld3BvcnRCb3R0b21SWzBdLnNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gJHZpZXdwb3J0U2Nyb2xsQ29udGFpbmVyWS5zY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3A7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VDbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICAvLyBkb2N1bWVudC5ib2R5LmNsaWNrKCk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gJGV2ZW50LnRhcmdldCBhcyBhbnk7XHJcblxyXG4gICAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgPT09ICdURVhUQVJFQScgfHwgdGFyZ2V0Lm5vZGVOYW1lID09PSAnSU5QVVQnICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgbGV0IHRkID0gdGFyZ2V0O1xyXG4gICAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgIT09ICdURCcpIHtcclxuICAgICAgICAgICAgdGQgPSB0YXJnZXQuY2xvc2VzdCgnVEQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5kZy5lZGl0YWJsZSAmJiB0aGlzLl9fdHJpZ2dlckJvZHlDbGlja0V2ZW50KSB7XHJcbiAgICAgICAgICAgIC8vIOino+WGs+i2hemTvueCueWHu+S6i+S7tu+8jOimgeWFiOaJp+ihjOmAieS4reihjFxyXG4gICAgICAgICAgICBpZiAodGQgJiYgdGQuc2VsZWN0Q2VsbCApIHtcclxuICAgICAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRkLnNlbGVjdENlbGwoJGV2ZW50LCB0ZCk7ICAvLyDmjInnkIbor7Tlj6/ku6XliKDpmaTnmoTvvIzkvYbkuI3mlaLliqjlk6ZvKOKJp+WPo+KJpilvXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZWRpdE1vZGUgPT09ICdyb3cnKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0ZCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsKSB7XHJcbiAgICAgICAgICAgIHRkID0gdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsRWxlbWVudDtcclxuICAgICAgICAgICAgaWYgKHRkICYmIHRkLmNsb3NlRWRpdCkge1xyXG4gICAgICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGQuY2xvc2VFZGl0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAodGQpIHtcclxuICAgICAgICAgICAgLy8g6KGM56aB55So5pe2XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cgJiYgdGQuZ3JpZENlbGxEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHJvd0RhdGEsIHJvd0luZGV4IH0gPSB0ZC5ncmlkQ2VsbERhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5kaXNhYmxlUm93KHJvd0RhdGEsIHJvd0luZGV4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuZGcuZWRpdE1vZGUgPT09ICdjZWxsJyAmJiB0ZC5lZGl0KSB7XHJcbiAgICAgICAgICAgICAgICB0ZC5lZGl0KCRldmVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQuc2VsZWN0Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnNlbGVjdGlvbk1vZGUgPT09ICdkZWZhdWx0JyAmJiB0aGlzLmRnLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ZC5zZWxlY3RDZWxsKCRldmVudCwgdGQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmVuZENlbGxFZGl0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9uQmVmb3JlU2hvd0NvbnRleHRNZW51ID0gKGU6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vIHJvd18xX2ZpeGVkbGVmdCAgcm93XzEgIHJvd18xX2ZpeGVkcmlnaHRcclxuICAgICAgICBjb25zdCB7IGNvbnRleHRNZW51RG9tLCBldmVudCB9ID0gZTtcclxuXHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcuZGF0YWdyaWQtZWRpdG9yJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHtzaG93OiBmYWxzZX0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGxldCByb3dJRCA9IGV2ZW50LnRhcmdldC5pZDtcclxuXHJcbiAgICAgICAgaWYgKGNvbnRleHRNZW51RG9tKSB7XHJcbiAgICAgICAgICAgIC8vIOaOkumZpOWIhue7hOihjOOAgeWIhue7hOWQiOiuoeihjFxyXG4gICAgICAgICAgICBpZiAoY29udGV4dE1lbnVEb20uY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZ3JvdXAtcm93JykgPT09IC0xICYmIGNvbnRleHRNZW51RG9tLmNsYXNzTmFtZS5pbmRleE9mKCdmLWRhdGFncmlkLWdyb3VwLWZvb3RlcicpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgcm93SUQgPSBjb250ZXh0TWVudURvbS5pZC5yZXBsYWNlKCdyb3dfJywgJycpLnJlcGxhY2UoJ19maXhlZGxlZnQnLCAnJykucmVwbGFjZSgnX2ZpeGVkcmlnaHQnLCAnJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dEYXRhID0gdGhpcy5kZnMuZmluZFJvdyhyb3dJRCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb2N1c1RhcmdldFdpZHRoID0gdGhpcy52aWV3cG9ydFcgPiB0aGlzLnRvdGFsV2lkdGggPyB0aGlzLnRvdGFsV2lkdGggOiB0aGlzLnZpZXdwb3J0VztcclxuICAgICAgICAgICAgICAgIHJldHVybiBvZih7IHNob3c6IHRydWUsIGRhdGE6IHsgZGF0YTogcm93RGF0YS5kYXRhLCBncmlkOiB0aGlzLmRnfSwgZm9jdXNUYXJnZXRXaWR0aCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2YoeyBzaG93OiBmYWxzZSB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=