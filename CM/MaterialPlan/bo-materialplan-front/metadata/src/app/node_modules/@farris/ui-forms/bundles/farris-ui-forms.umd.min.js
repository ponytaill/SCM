!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("resize-observer-polyfill"),require("@farris/ui-messager"),require("@angular/platform-browser"),require("@angular/forms"),require("@farris/ui-common"),require("@farris/ui-locale"),require("@angular/core")):"function"==typeof define&&define.amd?define("@farris/ui-forms",["exports","@angular/common","resize-observer-polyfill","@farris/ui-messager","@angular/platform-browser","@angular/forms","@farris/ui-common","@farris/ui-locale","@angular/core"],e):e((t.farris=t.farris||{},t.farris["ui-forms"]={}),t.ng.common,t.ResizeObserver,t.uiMessager,t.ng.platformBrowser,t.ng.forms,t.uiCommon,t.uiLocale,t.ng.core)}(this,function(t,e,l,o,r,n,s,a,p){"use strict";l=l&&l.hasOwnProperty("default")?l["default"]:l;var i=(h.prototype.ngOnInit=function(){this.name=this.idSer.generate().replace(/-/g,"_")},h.prototype.changeModel=function(t){this.model=t,this.modelChange.emit(this.model),this.controlChange(t)},h.prototype.writeValue=function(t){this.model=t,this.changeModel(this.model)},h.prototype.registerOnChange=function(t){this.controlChange=t},h.prototype.registerOnTouched=function(t){this.controlTouch=t},h.decorators=[{type:p.Component,args:[{selector:"farris-radio-group",template:'\n    <div class="farris-radio-group btn-group"\n    [class.farris-input-wrap]="type!==\'button\'"\n    [class.btn-group-toggle]="type===\'button\'"\n    [class.farris-checkradio-hor]="horizontal">\n      <ng-content></ng-content>\n    </div>\n  ',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return h}),multi:!0}],styles:["\n    "]}]}],h.ctorParameters=function(){return[{type:s.IdService}]},h.propDecorators={type:[{type:p.Input}],model:[{type:p.Input}],name:[{type:p.Input}],horizontal:[{type:p.Input}],modelChange:[{type:p.Output}]},h);function h(t){this.idSer=t,this.modelChange=new p.EventEmitter,this.subscriber=[],this.controlChange=function(){},this.controlTouch=function(){}}var u=(Object.defineProperty(c.prototype,"model",{get:function(){return this.hasParent(this.el.nativeElement)?this.radioGroup.model:this.nyModel},set:function(t){this.nyModel=t},enumerable:!0,configurable:!0}),c.prototype.ngOnInit=function(){this.name=this.radioGroup.name},c.prototype.changeModelHandler=function(){if(this.hasParent(this.el.nativeElement))return this.radioGroup.changeModel(this.label);this.model=this.label,this.modelChange.emit(this.model),this.controlChange(this.label)},c.prototype.hasParent=function(t){return t.parentElement.classList.contains("farris-radio-group")},c.prototype.writeValue=function(t){this.model=t},c.prototype.registerOnChange=function(t){this.controlChange=t},c.prototype.registerOnTouched=function(t){this.controlTouch=t},c.decorators=[{type:p.Component,args:[{selector:"farris-radio",template:'<label class="custom-control custom-radio">\r\n    <input class="custom-control-input" [name]="name" [value]="label" \r\n    [ngModel]="model" (ngModelChange)="changeModelHandler()" type="radio" [disabled]="disabled">\r\n    <span class="custom-control-label">\r\n      <ng-content>\r\n      </ng-content>\r\n    </span>\r\n</label>',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return c}),multi:!0}],styles:[".btn-group .btn{margin-left:-1px}"]}]}],c.ctorParameters=function(){return[{type:i,decorators:[{type:p.Optional}]},{type:p.ElementRef}]},c.propDecorators={model:[{type:p.Input}],id:[{type:p.Input}],label:[{type:p.Input}],disabled:[{type:p.Input}],modelChange:[{type:p.Output}],blockClass:[{type:p.HostBinding,args:["class.d-block"]}]},c);function c(t,e){this.radioGroup=t,this.el=e,this.label="",this.name="",this.modelChange=new p.EventEmitter,this.blockClass=!0,this.controlChange=function(){},this.controlTouch=function(){}}var d=(Object.defineProperty(m.prototype,"model",{get:function(){return this.hasParent(this.el.nativeElement)?this.radioGroup.model:this.nyModel},set:function(t){this.nyModel=t},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"farrisRadioButtonClass",{get:function(){return!0},enumerable:!0,configurable:!0}),m.prototype.ngOnInit=function(){this.name=this.hasParent(this.el.nativeElement)?this.radioGroup.name:""},m.prototype.isGroupModel=function(){return this.label===this.radioGroup.model},m.prototype.changeModelHandler=function(){if(this.hasParent(this.el.nativeElement))return this.radioGroup.changeModel(this.label);this.model=this.label,this.modelChange.emit(this.model),this.controlChange(this.label)},m.prototype.hasParent=function(t){return t.parentElement.classList.contains("farris-input-wrap")||t.parentElement.classList.contains("btn-group")},m.prototype.writeValue=function(t){this.model=t},m.prototype.registerOnChange=function(t){this.controlChange=t},m.prototype.registerOnTouched=function(t){this.controlTouch=t},m.decorators=[{type:p.Component,args:[{selector:"farris-radio-button",template:'\n    <label [class]="\'btn btn-\'+type" [class.active]="isGroupModel()" [class.disabled]="disabled">\n        <input class="custom-control-input" [name]="name" [value]="label"\n        [ngModel]="model" (ngModelChange)="changeModelHandler()" type="radio" [disabled]="disabled">\n          <ng-content>\n          </ng-content>\n    </label>\n  ',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return m}),multi:!0}],encapsulation:p.ViewEncapsulation.None,styles:["\n        .farris-radio-button>.btn{\n            margin-left:-1px\n          }\n          .farris-radio-button>.btn.active, .farris-radio-button>.btn:hover{\n            position: relative;\n          }\n      "]}]}],m.ctorParameters=function(){return[{type:i,decorators:[{type:p.Optional}]},{type:p.ElementRef}]},m.propDecorators={type:[{type:p.Input}],model:[{type:p.Input}],id:[{type:p.Input}],label:[{type:p.Input}],disabled:[{type:p.Input}],modelChange:[{type:p.Output}],farrisRadioButtonClass:[{type:p.HostBinding,args:["class.farris-radio-button"]}]},m);function m(t,e){this.radioGroup=t,this.el=e,this.name="",this.type="secondary",this.label="",this.modelChange=new p.EventEmitter,this.controlChange=function(){},this.controlTouch=function(){}}var g=(f.prototype.ngOnInit=function(){this.name=this.idSer.generate().replace(/-/g,"_")},f.prototype.clickHandler=function(t){var e=this._getValue(t);this.value!=e&&(this.value=e,this.controlChange(this.value),this.controlTouch(this.value),this.changeValue.emit(this.value))},f.prototype._getText=function(t){return t?this.commonUtils&&this.commonUtils.getValue?this.commonUtils.getValue(this.textField,t):t[this.textField]:""},f.prototype._getValue=function(t){return t?this.commonUtils&&this.commonUtils.getValue?this.commonUtils.getValue(this.valueField,t):t[this.valueField]:""},f.prototype.writeValue=function(t){this.value=t},f.prototype.registerOnChange=function(t){this.controlChange=t},f.prototype.registerOnTouched=function(t){this.controlTouch=t},f.decorators=[{type:p.Component,args:[{selector:"farris-radiogroup",template:'<div class="farris-input-wrap" [class.farris-checkradio-hor]="horizontal">\r\n    <div class="custom-control custom-radio" *ngFor="let item of data; let i=index">\r\n        <input #input class="custom-control-input" [name]="name" id="{{\'radio_\'+name+i}}" type="radio"\r\n        [value]="_getValue(item)" (click)="clickHandler(item)" [checked]="_getValue(item) == value" \r\n        [disabled]="disabled" tabindex="{{tabIndex}}">\r\n        <label class="custom-control-label" for="{{\'radio_\'+name+i}}">{{_getText(item)}}</label>\r\n    </div>\r\n</div>\r\n\r\n\r\n',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return f}),multi:!0}],exportAs:"FarrisRadioGroupComponent"}]}],f.ctorParameters=function(){return[{type:s.IdService},{type:p.Injector,decorators:[{type:p.Optional}]}]},f.propDecorators={tabIndex:[{type:p.Input,args:["tab-index"]}],data:[{type:p.Input}],type:[{type:p.Input}],name:[{type:p.Input}],horizontal:[{type:p.Input}],disabled:[{type:p.Input}],value:[{type:p.Input}],textField:[{type:p.Input}],valueField:[{type:p.Input}],changeValue:[{type:p.Output}]},f);function f(t,e){this.idSer=t,this.inject=e,this.data=[],this.textField="name",this.valueField="value",this.changeValue=new p.EventEmitter,this.controlChange=function(){},this.controlTouch=function(){},this.inject&&(this.commonUtils=this.inject.get(s.CommonUtils))}var y=(v.prototype.ngOnInit=function(){this.name=this.idSer.generate()},v.prototype.changeModel=function(e){var t=this.model.findIndex(function(t){return t===e});if(-1<t)return this.model.splice(t,1),this.modelChange.emit(this.model);this.model.push(e),this.controlChange(this.model.join()),this.modelChange.emit(this.model)},v.prototype.writeValue=function(t){this.model=t,this.changeModel(this.model)},v.prototype.registerOnChange=function(t){this.controlChange=t},v.prototype.registerOnTouched=function(t){this.controlTouch=t},v.decorators=[{type:p.Component,args:[{selector:"farris-checkbox-group",template:'\n    <div class="farris-input-wrap" [class.farris-checkradio-hor]="horizontal">\n      <ng-content></ng-content>\n    </div>\n  ',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return v}),multi:!0}]}]}],v.ctorParameters=function(){return[{type:s.IdService}]},v.propDecorators={model:[{type:p.Input}],name:[{type:p.Input}],horizontal:[{type:p.Input}],modelChange:[{type:p.Output}]},v);function v(t){this.idSer=t,this.model=[],this.modelChange=new p.EventEmitter,this.controlChange=function(){},this.controlTouch=function(){}}var b=(Object.defineProperty(C.prototype,"name",{get:function(){return this.hasParent(this.el.nativeElement)?this.checkbox.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"model",{get:function(){var e=this;return this.hasParent(this.el.nativeElement)?this.checkbox.model.find(function(t){return t===e.label}):this.nyModel},set:function(t){this.nyModel=t},enumerable:!0,configurable:!0}),C.prototype.ngOnInit=function(){},C.prototype.changeModelHandler=function(){if(this.hasParent(this.el.nativeElement))return this.checkbox.changeModel(this.label);this.model=this.label,this.modelChange.emit(this.model),this.controlChange(this.label)},C.prototype.hasParent=function(t){return t.parentElement.classList.contains("farris-input-wrap")},C.prototype.writeValue=function(t){this.model=t},C.prototype.registerOnChange=function(t){this.controlChange=t},C.prototype.registerOnTouched=function(t){this.controlTouch=t},C.decorators=[{type:p.Component,args:[{selector:"farris-checkbox",template:'<label class="custom-control custom-checkbox">\r\n  <input class="custom-control-input" [name]="name" [value]="label" [ngModel]="model"\r\n    (ngModelChange)="changeModelHandler()" type="checkbox" [disabled]="disabled">\r\n  <span class="custom-control-label">\r\n    <ng-content>\r\n    </ng-content>\r\n  </span>\r\n</label>',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return C}),multi:!0}],styles:["./checkbox.component.css"]}]}],C.ctorParameters=function(){return[{type:y},{type:p.ElementRef}]},C.propDecorators={model:[{type:p.Input}],label:[{type:p.Input}],disabled:[{type:p.Input}],modelChange:[{type:p.Output}]},C);function C(t,e){this.checkbox=t,this.el=e,this.modelChange=new p.EventEmitter,this.controlChange=function(){},this.controlTouch=function(){}}var E=(x.prototype.ngOnInit=function(){var e=this;this.name=this.idSer.generate().replace(/-/g,"_"),this.setCheckboxData.emit(this),this.loadData&&(this.loadDataSubscription=this.loadData().subscribe(function(t){return e.data=t.data}))},x.prototype.ngOnChanges=function(t){},x.prototype.ngOnDestroy=function(){this.loadDataSubscription&&this.loadDataSubscription.unsubscribe()},x.prototype._getText=function(t){return t?this.commonUtils&&this.commonUtils.getValue?this.commonUtils.getValue(this.textField,t):t[this.textField]:""},x.prototype._getValue=function(t){return t?this.commonUtils&&this.commonUtils.getValue?this.commonUtils.getValue(this.valueField,t):t[this.valueField]:""},x.prototype.clickHandler=function(t,e){var n=this.transformToArr(this.value)||[],i=String(this._getValue(t));n&&n.length&&n.some(function(t){return t==i})?n=n.filter(function(t){return t!==i}):n.push(i),this.value=this.transformToStr(n),this.controlChange(this.value),this.controlTouch(this.value),this.changeValue.emit(this.value)},x.prototype.checked=function(t){var e=String(this._getValue(t));return this.transformToArr(this.value).some(function(t){return t==e})},x.prototype.transformToArr=function(t){return t?this.isStringValue?t.split(this.separator):t:[]},x.prototype.transformToStr=function(t){var e=this,n=this.data.map(function(t){return e._getValue(t)}),i=[];return n.forEach(function(e){t.some(function(t){return t==e})&&i.push(e)}),this.isStringValue?i.join(this.separator):i},x.prototype.writeValue=function(t){this.value=t},x.prototype.registerOnChange=function(t){this.controlChange=t},x.prototype.registerOnTouched=function(t){this.controlTouch=t},x.decorators=[{type:p.Component,args:[{selector:"farris-checkboxgroup",template:'<div class="farris-input-wrap" [class.farris-checkradio-hor]="horizontal">\r\n    <div class="custom-control custom-checkbox" *ngFor="let item of data; let i = index">\r\n        <input #input class="custom-control-input" [name]="name" id="{{ \'checkbox_\' + name + i }}"\r\n            type="checkbox" [value]="_getValue(item)" [checked]="checked(item)" [disabled]="disable" (click)="clickHandler(item, i)" \r\n            tabindex="{{ tabIndex + i }}" />\r\n        <label class="custom-control-label" for="{{ \'checkbox_\' + name + i }}" title="{{_getText(item)}}">{{ _getText(item) }}</label>\r\n    </div>\r\n</div>\r\n',providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return x}),multi:!0}],exportAs:"FarrisCheckboxGroupComponent"}]}],x.ctorParameters=function(){return[{type:s.IdService},{type:p.Injector,decorators:[{type:p.Optional}]}]},x.propDecorators={tabIndex:[{type:p.Input,args:["tab-index"]}],data:[{type:p.Input}],type:[{type:p.Input}],name:[{type:p.Input}],horizontal:[{type:p.Input}],separator:[{type:p.Input}],disable:[{type:p.Input}],value:[{type:p.Input}],isStringValue:[{type:p.Input}],textField:[{type:p.Input}],valueField:[{type:p.Input}],loadData:[{type:p.Input}],changeValue:[{type:p.Output}],setCheckboxData:[{type:p.Output}]},x);function x(t,e){this.idSer=t,this.inject=e,this.tabIndex=0,this.data=[],this.separator=",",this.isStringValue=!0,this.textField="name",this.valueField="value",this.changeValue=new p.EventEmitter,this.setCheckboxData=new p.EventEmitter,this.controlChange=function(){},this.controlTouch=function(){},this.inject&&(this.commonUtils=this.inject.get(s.CommonUtils))}var I=(S.prototype.ngOnInit=function(){this.init()},S.prototype.ngOnChanges=function(t){t.enable&&!t.enable.isFirstChange()&&this.sizeToFit()},S.prototype.ngAfterViewInit=function(){this.minHeight=this.textarea.getBoundingClientRect().height},S.prototype.init=function(){var e=this;this.enable&&(this.document=this.textarea.ownerDocument,this.documentElement=this.document.documentElement,this.textarea&&this.textarea.value&&this.sizeToFit(),this.ngControl&&this.ngControl.valueChanges.subscribe(function(t){t!==e.previousValue&&e.sizeToFit()}))},S.prototype.onInput=function(){this.sizeToFit()},S.prototype.onValueChange=function(){this.sizeToFit()},S.prototype.overflowOffset=function(){for(var t=0,e=this.textarea;e!==document.body&&null!==e;)t+=e.offsetTop||0,e=e.offsetParent;var n=t-document.defaultView.pageYOffset;return{top:n,bottom:this.documentElement.clientHeight-(n+this.textarea.offsetHeight)}},S.prototype.sizeToFit=function(){if(this.enable){var t=this.textarea;if(!(this.isUserResized||this.textarea.value===this.previousValue||this.textarea.offsetWidth<=0&&this.textarea.offsetHeight<=0)){var e=getComputedStyle(t),n=Number(e.borderTopWidth.replace(/px/,"")),i=Number(e.borderBottomWidth.replace(/px/,"")),o="border-box"===e.boxSizing?n+i:0;this.maxHeight&&(t.style.maxHeight=this.maxHeight+"px");var r=t.parentElement;if(r instanceof HTMLElement){var s=r.style.height;r.style.height=getComputedStyle(r).height,t.style.height="auto";var a=t.scrollHeight+o;this.minHeight>a&&(a=this.minHeight),t.style.height=a+"px",r.style.height=s}this.previousValue=t.value}}},S.decorators=[{type:p.Directive,args:[{selector:"[auto-size]"}]}],S.ctorParameters=function(){return[{type:p.ElementRef},{type:n.NgControl},{type:p.Injector}]},S.propDecorators={enable:[{type:p.Input,args:["auto-size"]}],maxHeight:[{type:p.Input}],onInput:[{type:p.HostListener,args:["input"]}],onValueChange:[{type:p.HostListener,args:["change"]}]},S);function S(t,e,n){this.el=t,this.ngControl=e,this.injector=n,this.enable=!0,this.previousValue=null,this.isUserResized=!1,this.textarea=this.el.nativeElement}var T=(w.prototype.ngOnInit=function(){this.ngControl=this.injector.get(n.NgControl,null)},w.prototype.ngAfterViewInit=function(){var e=this;this.initWordCount(),this.ngControl&&this.useWordCount&&this.ngControl.control.valueChanges.subscribe(function(t){e.updateWordsCount()})},w.prototype.ngOnChanges=function(t){t.useWordCount&&!t.useWordCount.isFirstChange()&&(this.useWordCount?this.initWordCount():this.destroy())},w.prototype.ngOnDestroy=function(){this.destroy(),this.ro&&(this.ro.disconnect(),this.ro.unobserve(this.el.nativeElement.parentElement))},w.prototype.destroy=function(){this.onInput&&this.onInput(),this.wordCountElement&&this.wordCountElement.remove()},w.prototype.initWordCount=function(){this.useWordCount&&!this.onlyShowInDialog&&this.createWordCountElement()},w.prototype.createWordCountID=function(){var t=this.el.nativeElement.tagName;return this.ngControl?t+"_WORDCOUNT_"+this.ngControl.name:this.el.nativeElement.id?t+"_WORDCOUNT_"+this.el.nativeElement.id:""},w.prototype.createWordCountElement=function(){var i=this,t=this.el.nativeElement.maxLength;if(t&&!(t<0)){var o=this.render.createElement("span");o.className="textarea-wordcount";var e=this.createWordCountID();e&&(o.id=e),this.render.setStyle(o,"position","absolute"),this.render.setStyle(o,"bottom","0px");var n=this.el.nativeElement.getBoundingClientRect(),r=n.width,s=(n.right,this.el.nativeElement.parentElement.getBoundingClientRect().width);s!==r?(this.render.setStyle(o,"right",s-r+10+"px"),this.ro=new l(function(t,e){if(t&&t[0]){var n=t[0].contentRect.width;i.render.setStyle(o,"right",n-r+10+"px")}}),this.ro.observe(this.el.nativeElement.parentElement)):this.render.setStyle(o,"right","10px"),this.render.setStyle(o,"cursor","pointer"),this.el.nativeElement.after(o),this.wordCountElement=o;var a=this.render.createElement("span");o.appendChild(a),(this.currentLengthElement=a).after(" / "+t),this.updateWordsCount(),this.onInput=this.render.listen(this.el.nativeElement,"input",function(){i.updateWordsCount()})}},w.prototype.updateWordsCount=function(){if(this.useWordCount&&this.currentLengthElement){var t=this.el.nativeElement.maxLength,e="surplus"===this.countType?t-this.el.nativeElement.value.length:this.el.nativeElement.value.length,n="messager.prompt.tips."+this.countType;this.currentLengthElement.innerText=e,this.wordCountElement.title=this.localeSer.getValue(n).replace("{0}",e)}},w.decorators=[{type:p.Directive,args:[{selector:"[word-count]",exportAs:"WordCountRef"}]}],w.ctorParameters=function(){return[{type:p.ElementRef},{type:p.Renderer2},{type:p.Injector}]},w.propDecorators={useWordCount:[{type:p.Input,args:["word-count"]}],countType:[{type:p.Input}],onlyShowInDialog:[{type:p.Input}]},w);function w(t,e,n){this.el=t,this.render=e,this.injector=n,this.useWordCount=!0,this.countType="surplus",this.onlyShowInDialog=!1,this.wordCountElement=null,this.currentLengthElement=null,this.onInput=null,this.ro=null,this.eventManager=this.injector.get(r.EventManager),this.localeSer=this.injector.get(a.LocaleService)}var R=(O.prototype.ngOnInit=function(){this.ngControl=this.injector.get(n.NgControl,null)},O.prototype.ngOnChanges=function(t){t.useZoom&&!t.useZoom.isFirstChange()&&(this.useZoom?this.createZoomButton():this.destroy())},O.prototype.ngAfterViewInit=function(){this.useZoom&&this.createZoomButton()},O.prototype.ngOnDestroy=function(){this.destroy()},O.prototype.destroy=function(){this.onMouseEnter&&this.onMouseEnter(),this.onMouseLeave&&this.onMouseLeave(),this.onClick&&this.onClick(),this.altEnterHandler&&this.altEnterHandler(),this.zoomButtonElement&&this.zoomButtonElement.remove()},O.prototype.bindEventHandler=function(){this.altEnterHandler=this.eventManager.addEventListener(this.el.nativeElement,"keydown.alt.enter",function(t){var e=t.target,n=e.value+"\n";return e.value=n,t.preventDefault(),t.stopPropagation(),!1})},O.prototype.createZoombarID=function(){var t=this.el.nativeElement.tagName;return this.ngControl?t+"_ZOOMBAR_"+this.ngControl.name:this.el.nativeElement.id?t+"_ZOOMBAR_"+this.el.nativeElement.id:""},O.prototype.createZoomButton=function(){var t=this,e=this.render.createElement("span");e.className="f-icon modal_maximize textarea-zoom",e.title=this.localeSer.getValue("text.zoom")||"点击后弹出进行编辑";var n=this.createZoombarID();n&&(e.id=n),this.render.setStyle(e,"position","absolute"),this.render.setStyle(e,"top","2px");var i=this.el.nativeElement.getBoundingClientRect().width;this.el.nativeElement.parentElement.getBoundingClientRect().width!==i?this.render.setStyle(e,"left",i-18+"px"):this.render.setStyle(e,"right","2px"),this.render.setStyle(e,"cursor","pointer"),this.el.nativeElement.after(e),this.zoomButtonElement=e,this.onMouseEnter=this.render.listen(e,"mouseenter",function(){t.render.setStyle(e,"fontSize","22px")}),this.onMouseLeave=this.render.listen(e,"mouseleave",function(){t.render.setStyle(e,"fontSize","1rem")}),this.onClick=this.render.listen(e,"click",function(){t.zoomTextarea()})},O.prototype.zoomTextarea=function(){var e=this,t={width:this.dialogWidth||500,height:this.dialogHeight||400,showFontSize:!0,inputType:"textarea",saveSize:!0};if(window.localStorage){var n=this.messagerService.getKeyString(),i=localStorage.getItem(n);if(i){var o=JSON.parse(i);t.fontSize=o.fontSize||18,t.width=o.width||t.width,t.height=o.height||t.height}}var r=this.el.nativeElement.tagName,s=this.el.nativeElement.value;s=this.ngControl?this.ngControl.value:this.el.nativeElement.value,s=this.value||s,"FARRIS-TEXT"===r||this.el.nativeElement.readOnly||this.el.nativeElement.disabled?(t.readonly=!0,t.showOkButton=!1,this.messagerService.prompt2(this.title,s,t).subscribe()):(t.maxLength=this.el.nativeElement.maxLength,t.enableWordCount=!!this.wordCountRef&&this.wordCountRef.useWordCount,t.countType=this.wordCountRef?this.wordCountRef.countType:"length",this.messagerService.prompt2(this.title,s,t).subscribe(function(t){"boolean"==typeof t&&!t||(e.ngControl.control.setValue(t),e.wordCountRef&&e.wordCountRef.updateWordsCount())}))},O.decorators=[{type:p.Directive,args:[{selector:"[textarea-zoom]"}]}],O.ctorParameters=function(){return[{type:p.ElementRef},{type:p.Renderer2},{type:p.Injector},{type:T,decorators:[{type:p.Optional}]}]},O.propDecorators={useZoom:[{type:p.Input,args:["textarea-zoom"]}],dialogWidth:[{type:p.Input}],dialogHeight:[{type:p.Input}],fullscreen:[{type:p.Input}],title:[{type:p.Input}],value:[{type:p.Input}]},O);function O(t,e,n,i){this.el=t,this.render=e,this.injector=n,this.wordCountRef=i,this.useZoom=!0,this.dialogWidth=500,this.dialogHeight=400,this.fullscreen=!1,this.title="",this.value="",this.onMouseEnter=null,this.onMouseLeave=null,this.onClick=null,this.altEnterHandler=null,this.zoomButtonElement=null,this.messagerService=this.injector.get(o.MessagerService),this.eventManager=this.injector.get(r.EventManager),this.localeSer=this.injector.get(a.LocaleService,null)}var k=(Object.defineProperty(M.prototype,"enableAppend",{get:function(){return this._enableAppend},set:function(t){""===t||t?(this._enableAppend=!0,this.appendWrapElement||this.createStruct()):(this._enableAppend=!1,this.appendWrapElement&&this.resetStruct())},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"inputAppendType",{get:function(){return this._appendType},set:function(e){var n=this;e&&(["button","text"].findIndex(function(t){return t==e})<0&&(e="button"),e!=this._appendType&&(this.appendWrapElement&&(this.render.removeClass(this.appendWrapElement,"input-append-"+this._appendType),this.render.addClass(this.appendWrapElement,"input-append-"+e),"button"==this._appendType?this.clickHandler&&(this.clickHandler(),this.clickHandler=null):this.clickHandler=this.render.listen(this.appendWrapElement,"click",function(t){n.inputAppendClickEvent.emit(t)})),this._appendType=e))},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"inputAppendText",{get:function(){return this._inputAppendText},set:function(t){t!=this._inputAppendText&&(this._inputAppendText=t,this.appendWrapElement&&this._enableAppend?(this.render.removeChild(this.appendWrapElement,this.appendTextElement),this.appendTextElement.innerHTML=t,this.render.appendChild(this.appendWrapElement,this.appendTextElement)):this.createStruct())},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"inputAppendDisabled",{get:function(){return this._disabled},set:function(t){t!=this._disabled&&(this._disabled=t,this.appendWrapElement&&(t&&this.render.addClass(this.appendWrapElement,this.disabledCls),t||this.render.removeClass(this.appendWrapElement,this.disabledCls)))},enumerable:!0,configurable:!0}),M.prototype.ngOnInit=function(){},M.prototype.ngAfterViewInit=function(){this.createStruct()},M.prototype.ngOnDestroy=function(){this.clickHandler&&(this.clickHandler(),this.clickHandler=null),this.appendWrapElement&&(this.appendWrapElement.remove(),this.appendWrapElement=null),this.elWrapElement&&(this.elWrapElement.remove(),this.elWrapElement=null)},M.prototype.resetStruct=function(){switch(this.clickHandler&&(this.clickHandler(),this.clickHandler=null),this.inputAppendControlType){case"StaticText":this.render.removeClass(this.el.nativeElement,"f-cmp-static-text-input-append");break;case"TextBox":case"MultiTextBox":if(this.elWrapElement){var t=this.render.parentNode(this.elWrapElement);this.render.appendChild(t,this.el.nativeElement),this.elWrapElement.remove(),this.elWrapElement=null}}this.appendWrapElement&&(this.appendWrapElement.remove(),this.appendWrapElement=null)},M.prototype.createStruct=function(){var e=this;if(this.inputAppendText&&this.enableAppend&&!this.appendWrapElement){var n=this.render.createElement("div");n.className="input-group-append input-append-wrapper",n.className+=" input-append-"+this.inputAppendType,this._disabled&&(n.className+=" "+this.disabledCls);var t=this.render.createElement("div");switch(t.className="input-group-text",t.innerHTML=this.inputAppendText,this.appendTextElement=t,this.appendWrapElement=n,this.render.appendChild(n,t),this.inputAppendControlType){case"StaticText":this.render.addClass(this.el.nativeElement,"f-cmp-static-text-input-append"+(this._disabled?" "+this.disabledCls:"")),this.render.appendChild(this.el.nativeElement,n);break;case"TextBox":case"MultiTextBox":var i=this.render.parentNode(this.el.nativeElement),o=this.render.createElement("div");o.className="f-cmp-text-input-append"+(this._disabled?" "+this.disabledCls:""),-1<this.el.nativeElement.outerHTML.indexOf("textarea")&&(o.className="f-cmp-textarea-input-append"+(this._disabled?" "+this.disabledCls:"")),this.elWrapElement=o,this.render.appendChild(o,this.el.nativeElement),this.render.appendChild(o,n),this.render.appendChild(i,o);break;default:var r=this.el.nativeElement.querySelector(".input-group");r?this.render.appendChild(r,n):this.ngZone&&this.ngZone.runOutsideAngular(function(){setTimeout(function(){var t=e.el.nativeElement.querySelector(".input-group");e.render.appendChild(t,n)})})}"button"==this.inputAppendType&&(this.clickHandler=this.render.listen(this.appendWrapElement,"click",function(t){e.inputAppendClickEvent.emit(t)}))}},M.decorators=[{type:p.Directive,args:[{selector:"[input-append]"}]}],M.ctorParameters=function(){return[{type:p.ViewContainerRef},{type:p.ElementRef},{type:p.Renderer2},{type:p.Injector}]},M.propDecorators={enableAppend:[{type:p.Input,args:["input-append"]}],inputAppendControlType:[{type:p.Input}],inputAppendType:[{type:p.Input}],inputAppendText:[{type:p.Input}],inputAppendDisabled:[{type:p.Input}],inputAppendClickEvent:[{type:p.Output}]},M);function M(t,e,n,i){this.viewRef=t,this.el=e,this.render=n,this.injector=i,this._enableAppend=!0,this.inputAppendControlType="InputGroup",this._appendType="button",this._inputAppendText="",this._disabled=!1,this.inputAppendClickEvent=new p.EventEmitter,this.elWrapElement=null,this.appendWrapElement=null,this.appendTextElement=null,this.clickHandler=null,this.disabledCls="f-state-disabled",this.ngZone=null,this.ngZone=this.injector.get(p.NgZone)}var _=(A.prototype.ngOnInit=function(){},A.prototype.ngAfterViewInit=function(){var e=this;this.eventManager.addEventListener(this.el.nativeElement,"keydown",function(t){t.stopPropagation(),"Tab"===t.key&&e.onTabKeydownHandler(t.target)})},A.prototype.onTabKeydownHandler=function(e){var t=this.el.nativeElement.querySelectorAll("input,textarea"),n=(t=Array.from(t)).findIndex(function(t){return t===e})+1;n>=t.length&&(n=0);var i=t[n];i&&setTimeout(function(){i.focus()})},A.decorators=[{type:p.Directive,args:[{selector:"shortcut-tab"}]}],A.ctorParameters=function(){return[{type:p.ElementRef},{type:p.Injector},{type:r.EventManager}]},A);function A(t,e,n){this.el=t,this.injector=e,this.eventManager=n}var D=new p.InjectionToken("Common comments HTTP service"),P=(H.prototype.onClick=function(t){t.stopPropagation()},H.prototype.ngOnInit=function(){},H.prototype.loadData=function(t){this.data=t,this.cdr.destroyed||this.cdr.detectChanges()},H.prototype.formatData=function(t){return this.formatter(t)},H.prototype.onItemClick=function(t,e){this.itemClick.emit({data:e,evnet:t})},H.prototype.setActiveItem=function(t){this.activeIndex=t,this.cdr.destroyed||this.cdr.detectChanges()},H.decorators=[{type:p.Component,args:[{selector:"single-list",template:'<div class="d-flex flex-column" style="width: 100%;height:100%;padding-top: 5px; " #itemsContainer>\r\n    \x3c!-- <div class="header"></div> --\x3e\r\n    <div class="list f-utils-fill f-datalist" style="overflow: auto;flex:1;  max-height: 250px;">\r\n        <ul class="list-group list-group-flush p-0"  [class.h-100]="!data || !data.length">\r\n            <li class="list-group-item list-group-item-action" style="cursor: pointer;" [class.active]="activeIndex === i" *ngFor="let item of data; index as i" (click)="onItemClick($event, item)">\r\n                <span style="overflow: hidden;text-overflow: ellipsis;" title=" {{item[textField]}}" *ngIf="!formatter">{{ item[textField] }}</span> \r\n                <span style="overflow: hidden;text-overflow: ellipsis;" *ngIf="formatter" [innerHTML]="formatData(item) | safe:\'html\'"></span>\r\n            </li>\r\n\r\n            <li class="norecord p-2" *ngIf="!data || !data.length" style="color: #848c9a;">\r\n                {{ emptyDataMsg }}\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="more d-flex" *ngIf="showButtons" style="height: 36px;border-top: 1px solid #dedede;justify-content: center;align-items: center;">\r\n        <button class="btn btn-link" *ngFor="let btn of buttons" (click)="btn.handler($event)"> \r\n            <span style="font-size: 13px;" class="{{btn.iconCls}}" *ngIf="btn.iconCls"></span>\r\n            {{ btn.text }}\r\n        </button>\r\n    </div>\r\n     \x3c!-- <div class="footer"></div> --\x3e\r\n</div>'}]}],H.ctorParameters=function(){return[{type:p.Injector},{type:p.ChangeDetectorRef}]},H.propDecorators={showButtons:[{type:p.Input}],buttons:[{type:p.Input}],data:[{type:p.Input}],textField:[{type:p.Input}],formatter:[{type:p.Input}],maxItems:[{type:p.Input}],emptyDataMsg:[{type:p.Input}],itemClick:[{type:p.Output}],itemsContainer:[{type:p.ViewChild,args:["itemsContainer"]}],onClick:[{type:p.HostListener,args:["mousedown",["$event"]]}]},H);function H(t,e){this.injector=t,this.cdr=e,this.showButtons=!0,this.buttons=[],this.data=[],this.textField="",this.maxItems=10,this.emptyDataMsg="暂无数据",this.itemClick=new p.EventEmitter,this.activeIndex=-1}var V=(L.prototype.ngOnInit=function(){this.ngControl=this.injector.get(n.NgControl,null)},L.prototype.ngAfterViewInit=function(){this.init(),this.listenAttributesChanged()},L.prototype.ngOnChanges=function(t){t.useComments&&!t.useComments.isFirstChange()&&this.init()},L.prototype.init=function(){var t=this.el.nativeElement.readOnly,e=this.el.nativeElement.disabled;!this.useComments||t||e?this.destroy():this.createCommentsButton()},L.prototype.ngOnDestroy=function(){this.destroy(),this.hideListPanel(),this.observer.disconnect(),this.observer=null},L.prototype.listenAttributesChanged=function(){var p=this,t=this.el.nativeElement;this.observer=new MutationObserver(function(t,e){var n,i;try{for(var o=function a(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(t),r=o.next();!r.done;r=o.next()){var s=r.value;"attributes"!==s.type||"readonly"!==s.attributeName&&"disabled"!==s.attributeName||p.init()}}catch(l){n={error:l}}finally{try{r&&!r.done&&(i=o["return"])&&i.call(o)}finally{if(n)throw n.error}}}),this.observer.observe(t,{attributes:!0})},L.prototype.destroy=function(){this.commentsBtnElement&&this.commentsBtnElement.remove()},L.prototype.createID=function(){var t=this.el.nativeElement.tagName;return this.ngControl?t+"_COMMENTS_"+this.ngControl.name:this.el.nativeElement.id?t+"_COMMENTS_"+this.el.nativeElement.id:""},L.prototype.createCommentsButton=function(){var e=this,t=this.render.createElement("span");t.className="dropdown-toggle",t.title=this.title?this.title:this.localeSer.getValue("text.comments.title")||"常用意见";var n=this.createID();n&&(t.id=n),this.render.setStyle(t,"position","absolute"),this.render.setStyle(t,"left","3px"),this.render.setStyle(t,"bottom","0px"),this.render.setStyle(t,"cursor","pointer");var i=this.render.createElement("span");this.render.appendChild(t,i),i.className="f-icon f-icon-message",this.render.setStyle(i,"position","relative"),this.render.setStyle(i,"top","1px"),this.render.setStyle(i,"font-size","13px"),this.el.nativeElement.after(t),this.commentsBtnElement=t,this.render.listen(t,"click",function(t){t.stopPropagation(),e.listPanelElRef?e.hideListPanel():e.showListPanel()})},L.prototype.showListPanel=function(){var i=this,t=this.render.createElement("div"),e=this.commentsBtnElement.getBoundingClientRect(),n=e.left;e.bottom,this.render.setStyle(t,"width","200px"),this.render.setStyle(t,"max-height",this.maxHeight+"px"),this.render.setStyle(t,"position","absolute"),this.render.setStyle(t,"left",n+"px"),this.render.setStyle(t,"top","0px"),this.render.setStyle(t,"z-index","9999999"),this.render.setStyle(t,"box-shadow","0 2px 8px 0 #dedede"),this.render.setStyle(t,"border-radius","6px"),this.render.setStyle(t,"background","white"),this.render.setStyle(t,"visibility","hidden"),document.body.append(t),this.listPanelElRef=t;var o=this.cfr.resolveComponentFactory(P);this.singListRef=o.create(this.injector),this.singListRef.instance.showButtons=!0,this.singListRef.instance.emptyDataMsg=this.localeSer.getValue("text.comments.empty"),this.singListRef.instance.buttons=[{text:this.mgrText?this.mgrText:this.localeSer.getValue("text.comments.manager"),iconCls:"f-icon f-icon-home-setup",handler:function(){i.commentSer&&(i.hideListPanel(),i.commentSer.showCommentManageDialog({type:"forms"}).subscribe(function(t){console.log(t)}))}}],this.singListRef.instance.textField="message",this.singListRef.instance.maxItems=999999,this.singListRef.instance.itemClick.subscribe(function(t){var e=t.data.message,n=i.el.nativeElement.value||"";n+=e,i.ngControl?i.ngControl.control.patchValue(n):i.el.nativeElement.value=n,i.hideListPanel()}),t.appendChild(this.singListRef.location.nativeElement),this.singListRef.changeDetectorRef.detectChanges(),this.loadData(this.singListRef),this.overlaySer.registerMouseEvent(t,function(t){i.listPanelElRef.contains(t.target)||i.commentsBtnElement===t.target||i.commentsBtnElement.contains(t.target)||i.hideListPanel()})},L.prototype.hideListPanel=function(){this.singListRef&&(this.singListRef.destroy(),this.singListRef=null),this.listPanelElRef&&(this.listPanelElRef.remove(),this.overlaySer.destory(this.listPanelElRef),this.listPanelElRef=null)},L.prototype.loadData=function(e){var n=this;this.commentSer&&this.commentSer.getCommonComments({type:"forms"}).subscribe(function(t){e.instance.loadData(t),setTimeout(function(){n.resetPosition()})})},L.prototype.resetPosition=function(){var t=this.commentsBtnElement.getBoundingClientRect(),e=t.top,n=t.bottom,i=t.left,o=this.listPanelElRef.offsetHeight;if(window.innerHeight-n>this.maxHeight||window.innerHeight-n>o)return this.render.setStyle(this.listPanelElRef,"top",n+"px"),void this.render.removeStyle(this.listPanelElRef,"visibility");e>this.maxHeight||o<e?this.render.setStyle(this.listPanelElRef,"top",e-o+"px"):(this.render.setStyle(this.listPanelElRef,"top","0px"),200<i&&this.render.setStyle(this.listPanelElRef,"left",i-200+"px")),this.render.removeStyle(this.listPanelElRef,"visibility")},L.decorators=[{type:p.Directive,args:[{selector:"[common-comments]"}]}],L.ctorParameters=function(){return[{type:p.Injector},{type:p.ElementRef},{type:p.Renderer2},{type:a.LocaleService},{type:p.ComponentFactoryResolver}]},L.propDecorators={useComments:[{type:p.Input,args:["common-comments"]}],maxHeight:[{type:p.Input}],title:[{type:p.Input}],mgrText:[{type:p.Input}]},L);function L(t,e,n,i,o){this.injector=t,this.el=e,this.render=n,this.localeSer=i,this.cfr=o,this.useComments=!0,this.maxHeight=300,this.title="",this.mgrText="",this.commentsBtnElement=null,this.singListRef=null,this.listPanelElRef=null,this.commentSer=this.injector.get(D,null),this.overlaySer=this.injector.get(s.OverLayHiddenService,null),this.overlaySer||(this.overlaySer=new s.OverLayHiddenService)}var W=(j.decorators=[{type:p.NgModule,args:[{declarations:[u,i,b,y,d,g,E,I,R,_,T,k,V,P],imports:[e.CommonModule,n.FormsModule,o.MessagerModule.forRoot(),s.FarrisCommonModule.forRoot(),a.LocaleModule],exports:[u,i,b,y,d,g,E,I,R,_,T,k,V],entryComponents:[P],providers:[s.IdService]}]}],j);function j(){}t.TextareaAutoSizeDirective=I,t.TextareaZoomDirective=R,t.ShortCutTabKeyDirective=_,t.TextareaWordcountDirective=T,t.InputAppendDirective=k,t.TextareaCommentsDirective=V,t.SingleListComponent=P,t.FarrisFormsModule=W,t.RadioComponent=u,t.RadioGroupComponent=i,t.FarrisRadioGroupComponent=g,t.RadioButtonComponent=d,t.CheckboxGroupComponent=y,t.CheckboxComponent=b,t.FarrisCheckboxGroupComponent=E,t.CommentsHttpToken=D,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-forms.umd.min.js.map