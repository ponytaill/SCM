/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { ColumnFormatService } from '@farris/ui-common/column';
import * as i0 from "@angular/core";
var CommonUtils = /** @class */ (function () {
    function CommonUtils() {
        this.cfs = null;
        if (!this.cfs) {
            this.cfs = new ColumnFormatService(null, null);
        }
    }
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     */
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    CommonUtils.prototype.getValue = /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    function (field, data, safe) {
        if (safe === void 0) { safe = false; }
        if (!data) {
            return '';
        }
        /** @type {?} */
        var resultVal = '';
        if (field.indexOf('.') === -1 && data.hasOwnProperty(field)) {
            resultVal = data[field];
        }
        else {
            resultVal = field.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            function (obj, key) {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), data);
        }
        if (safe) {
            return this.formatterValue(resultVal);
        }
        else {
            return resultVal;
        }
    };
    /**
     * 更新指定对象中某个字段的值
     * @param obj 被更新对象
     * @param field 被更新字段
     * @param val 新值
     * @param nest 是否为嵌套，默认为 true
     */
    /**
     * 更新指定对象中某个字段的值
     * @param {?} obj 被更新对象
     * @param {?} field 被更新字段
     * @param {?} val 新值
     * @param {?=} nest 是否为嵌套，默认为 true
     * @return {?}
     */
    CommonUtils.prototype.setValue = /**
     * 更新指定对象中某个字段的值
     * @param {?} obj 被更新对象
     * @param {?} field 被更新字段
     * @param {?} val 新值
     * @param {?=} nest 是否为嵌套，默认为 true
     * @return {?}
     */
    function (obj, field, val, nest) {
        if (nest === void 0) { nest = true; }
        if (field) {
            if (field.indexOf('.') > -1 && nest) {
                /** @type {?} */
                var lastObj_1 = null;
                /** @type {?} */
                var _fields = field.split('.');
                _fields.reduce((/**
                 * @param {?} c
                 * @param {?} p
                 * @return {?}
                 */
                function (c, p) {
                    lastObj_1 = c;
                    return c[p];
                }), obj);
                if (lastObj_1) {
                    lastObj_1[_fields.pop()] = val;
                }
            }
            else {
                obj[field] = val;
            }
        }
    };
    /**
     * @param {?} value
     * @param {?} enumData
     * @param {?} valueField
     * @return {?}
     */
    CommonUtils.prototype.getEnumItem = /**
     * @param {?} value
     * @param {?} enumData
     * @param {?} valueField
     * @return {?}
     */
    function (value, enumData, valueField) {
        /** @type {?} */
        var item = enumData.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n[valueField] == value; }));
        return item;
    };
    /**
     * @private
     * @param {?} value
     * @param {?} col
     * @return {?}
     */
    CommonUtils.prototype._getEnumTitleFromColumn = /**
     * @private
     * @param {?} value
     * @param {?} col
     * @return {?}
     */
    function (value, col) {
        /** @type {?} */
        var _col = (/** @type {?} */ (col));
        /** @type {?} */
        var formatter = (/** @type {?} */ (_col.formatter));
        if (formatter && typeof formatter === 'object') {
            if (formatter.type === 'enum' && formatter.options) {
                return this.getEnumTitleFromColumnOptions(value, formatter.options);
            }
        }
        return value;
    };
    /**
     * @param {?} col
     * @param {?} data
     * @return {?}
     */
    CommonUtils.prototype.getEnumTitle = /**
     * @param {?} col
     * @param {?} data
     * @return {?}
     */
    function (col, data) {
        /** @type {?} */
        var val = this.getValue(col.field, data);
        return this._getEnumTitleFromColumn(val, col);
    };
    /**
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    CommonUtils.prototype.getEnumTitleFromColumnOptions = /**
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    function (value, opts) {
        var data = opts.data, valueField = opts.valueField, textField = opts.textField;
        /** @type {?} */
        var item = this.getEnumItem(value, data, valueField);
        if (item) {
            return item[textField];
        }
        else {
            return value;
        }
    };
    /**
     * @param {?} str
     * @return {?}
     */
    CommonUtils.prototype.escapeHtml = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str === null || str === undefined) {
            return '';
        }
        return str
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\"/g, '&quot;')
            .replace(/\'/g, '&#39;')
            .replace(/\//g, '&#x2F;');
    };
    /**
     * @param {?} str
     * @return {?}
     */
    CommonUtils.prototype.unescapeHtml = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str === null || str === undefined) {
            return '';
        }
        return str
            .replace(/&amp;/g, '&')
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, '\'')
            .replace(/&#x2F;/g, '/');
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    CommonUtils.prototype.formatterValue = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val === null || val === undefined || val === '') {
            return '';
        }
        if (typeof val === 'string') {
            return this.escapeHtml(val);
        }
        return val;
    };
    /** 获取字符串在页面中的真实宽度 */
    /**
     * 获取字符串在页面中的真实宽度
     * @param {?} txt
     * @param {?} font
     * @return {?}
     */
    CommonUtils.prototype.getTextWidth = /**
     * 获取字符串在页面中的真实宽度
     * @param {?} txt
     * @param {?} font
     * @return {?}
     */
    function (txt, font) {
        // const frag = document.createDocumentFragment();
        /** @type {?} */
        var canvas = document.createElement('canvas');
        /** @type {?} */
        var context = canvas.getContext('2d');
        context.font = font;
        /** @type {?} */
        var metrics = context.measureText(txt);
        return Math.round(metrics.width);
    };
    /**
     * @param {?} id
     * @return {?}
     */
    CommonUtils.prototype.removeStyleSheet = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        /** @type {?} */
        var styleElement = document.querySelector('#' + id);
        if (styleElement) {
            styleElement.remove();
        }
    };
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    CommonUtils.prototype.createStyleSheet = /**
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        /** @type {?} */
        var htmlHead = document.querySelector('head');
        /** @type {?} */
        var styleEleId = styleSheetId;
        /** @type {?} */
        var styleElement = null;
        if (document.querySelector('#' + styleEleId)) {
            styleElement = document.querySelector('#' + styleEleId);
            styleElement.innerText = '';
        }
        else {
            styleElement = document.createElement('style');
            styleElement.id = styleEleId;
            htmlHead.appendChild(styleElement);
        }
        return styleElement;
    };
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    CommonUtils.prototype.getStyleSheet = /**
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        var e_1, _a;
        /** @type {?} */
        var styleSheets = (/** @type {?} */ (document.styleSheets));
        /** @type {?} */
        var styleSheet = null;
        try {
            for (var styleSheets_1 = tslib_1.__values(styleSheets), styleSheets_1_1 = styleSheets_1.next(); !styleSheets_1_1.done; styleSheets_1_1 = styleSheets_1.next()) {
                var stylesheet = styleSheets_1_1.value;
                if ((stylesheet.ownerNode || stylesheet['owningElement']).id === styleSheetId) {
                    styleSheet = stylesheet;
                    break;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (styleSheets_1_1 && !styleSheets_1_1.done && (_a = styleSheets_1.return)) _a.call(styleSheets_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return styleSheet;
    };
    /** 与现有样式合并 */
    /**
     * 与现有样式合并
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.appendCssRules = /**
     * 与现有样式合并
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    function (rules, styleSheet) {
        var e_2, _a;
        try {
            for (var rules_1 = tslib_1.__values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                var rule = rules_1_1.value;
                /** @type {?} */
                var ruleName = rule.slice(0, rule.indexOf('{'));
                /** @type {?} */
                var removedCssRule = this.removeCssRule(ruleName, styleSheet);
                /** @type {?} */
                var cssText = '';
                if (removedCssRule) {
                    cssText += removedCssRule.cssText.slice(removedCssRule.cssText.indexOf('{') + 1, removedCssRule.cssText.indexOf('}'));
                }
                cssText += rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    /** @type {?} */
                    var _newRule = ruleName + "{ " + cssText + " }";
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /** 覆盖现有的样式 */
    /**
     * 覆盖现有的样式
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.appendCssRules2 = /**
     * 覆盖现有的样式
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    function (rules, styleSheet) {
        var e_3, _a;
        try {
            for (var rules_2 = tslib_1.__values(rules), rules_2_1 = rules_2.next(); !rules_2_1.done; rules_2_1 = rules_2.next()) {
                var rule = rules_2_1.value;
                /** @type {?} */
                var ruleName = rule.slice(0, rule.indexOf('{'));
                /** @type {?} */
                var removedCssRule = this.removeCssRule(ruleName, styleSheet);
                /** @type {?} */
                var cssText = rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    /** @type {?} */
                    var _newRule = ruleName + "{ " + cssText + " }";
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (rules_2_1 && !rules_2_1.done && (_a = rules_2.return)) _a.call(rules_2);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.getCssRule = /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    function (ruleName, styleSheet) {
        var e_4, _a;
        /** @type {?} */
        var cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        var r = null;
        try {
            for (var cssRules_1 = tslib_1.__values(cssRules), cssRules_1_1 = cssRules_1.next(); !cssRules_1_1.done; cssRules_1_1 = cssRules_1.next()) {
                var rule = cssRules_1_1.value;
                if (rule.selectorText == ruleName) {
                    r = rule;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (cssRules_1_1 && !cssRules_1_1.done && (_a = cssRules_1.return)) _a.call(cssRules_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return r;
    };
    /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.removeCssRule = /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    function (ruleName, styleSheet) {
        /** @type {?} */
        var cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        var ii = 0;
        /** @type {?} */
        var cssRule = false;
        do {
            cssRule = cssRules[ii];
            if (cssRule) {
                if (cssRule.selectorText.toLowerCase() == ruleName.toLowerCase()) {
                    if (styleSheet.cssRules) {
                        styleSheet.deleteRule(ii);
                    }
                    else {
                        styleSheet.removeRule(ii);
                    }
                    return cssRule;
                }
            }
            ii++;
        } while (cssRule);
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CommonUtils.prototype.isNullOrUndefined = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        return val === null || val === undefined;
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.isIE = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var uA = window.navigator.userAgent;
        return /msie\s|trident\/|edge\//i.test(uA) && !!('uniqueID' in document || 'documentMode' in document || ('ActiveXObject' in window) || 'MSInputMethodContext' in window);
    };
    /**
     * @param {?} sorts
     * @return {?}
     */
    CommonUtils.prototype.buildSortString = /**
     * @param {?} sorts
     * @return {?}
     */
    function (sorts) {
        return this.cfs.buildSortString(sorts);
    };
    /**
     * @param {?} conditions
     * @return {?}
     */
    CommonUtils.prototype.buildSqlWhere = /**
     * @param {?} conditions
     * @return {?}
     */
    function (conditions) {
        return this.cfs.buildSqlWhere(conditions);
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.getBrowserType = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var ua = navigator.userAgent.toLowerCase();
        // 获取用户端信息
        /** @type {?} */
        var info = {
            ie: /msie/.test(ua) && !/opera/.test(ua),
            //  匹配IE浏览器
            op: /opera/.test(ua),
            //  匹配Opera浏览器
            sa: /version.*safari/.test(ua),
            // 匹配Safari浏览器
            ch: /chrome/.test(ua),
            //  匹配Chrome浏览器
            ff: /gecko/.test(ua) && !/webkit/.test(ua) // 匹配Firefox浏览器
        };
        return info;
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.getFFVer = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var ua = navigator.userAgent;
        /** @type {?} */
        var b = ua.indexOf('Firefox/');
        if (b < 0) {
            return 0;
        }
        return parseFloat(ua.substring(b + 8, ua.lastIndexOf('\.')));
    };
    /**
     * @param {?} name
     * @param {?=} locationSearch
     * @return {?}
     */
    CommonUtils.prototype.getQueryString = /**
     * @param {?} name
     * @param {?=} locationSearch
     * @return {?}
     */
    function (name, locationSearch) {
        if (locationSearch === void 0) { locationSearch = ''; }
        /** @type {?} */
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        /** @type {?} */
        var _search = window.location.search;
        if (locationSearch) {
            _search = locationSearch;
        }
        /** @type {?} */
        var r = _search.substring(1).match(reg);
        if (r != null)
            return (r[2]);
        return null;
    };
    /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     */
    /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     * @param {?=} upperLayers
     * @return {?}
     */
    CommonUtils.prototype.getFloatingLayerIndex = /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     * @param {?=} upperLayers
     * @return {?}
     */
    function (upperLayers) {
        if (upperLayers === void 0) { upperLayers = 1; }
        /** @type {?} */
        var overlays = Array.from(document.body.querySelectorAll('body>div, body>farris-dialog>.farris-modal,body>.farris-modal')).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            return parseInt(window.getComputedStyle(n).zIndex, 10);
        })).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; }));
        /** @type {?} */
        var maxZindex = Math.max.apply(Math, tslib_1.__spread(overlays));
        return maxZindex + upperLayers;
    };
    CommonUtils.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    CommonUtils.ctorParameters = function () { return []; };
    /** @nocollapse */ CommonUtils.ngInjectableDef = i0.defineInjectable({ factory: function CommonUtils_Factory() { return new CommonUtils(); }, token: CommonUtils, providedIn: "root" });
    return CommonUtils;
}());
export { CommonUtils };
if (false) {
    /**
     * @type {?}
     * @private
     */
    CommonUtils.prototype.cfs;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jb21tb24vIiwic291cmNlcyI6WyJsaWIvY29tbW9uLnV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQWtELG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7O0FBRS9HO0lBS0k7UUFEUSxRQUFHLEdBQXdCLElBQUksQ0FBQztRQUVwQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUNYLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDbEQ7SUFDTCxDQUFDO0lBRUQ7Ozs7T0FJRzs7Ozs7Ozs7OztJQUNILDhCQUFROzs7Ozs7Ozs7SUFBUixVQUFTLEtBQWEsRUFBRSxJQUFTLEVBQUUsSUFBWTtRQUFaLHFCQUFBLEVBQUEsWUFBWTtRQUMzQyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsT0FBUSxFQUFFLENBQUM7U0FDZDs7WUFDRyxTQUFTLEdBQUcsRUFBRTtRQUNsQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN6RCxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQzNCO2FBQU07WUFDSCxTQUFTLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNOzs7OztZQUFDLFVBQUMsR0FBRyxFQUFFLEdBQUc7Z0JBQ3pDLElBQUksR0FBRyxFQUFFO29CQUNMLE9BQU8sR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2lCQUNuQjtxQkFBTTtvQkFDSCxPQUFPLElBQUksQ0FBQztpQkFDZjtZQUNMLENBQUMsR0FBRSxJQUFJ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QUMzQixRQUFRLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLCtEQUErRCxDQUFDLENBQUMsQ0FBQyxNQUFNOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEVBQUQsQ0FBQyxFQUFDLENBQUMsR0FBRzs7OztRQUFDLFVBQUEsQ0FBQztZQUM3SSxPQUFPLFFBQVEsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzNELENBQUMsRUFBQyxDQUFDLE1BQU07Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsRUFBRCxDQUFDLEVBQUM7O1lBQ1gsU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLE9BQVIsSUFBSSxtQkFBUSxRQUFRLEVBQUM7UUFFdkMsT0FBTyxTQUFTLEdBQUcsV0FBVyxDQUFDO0lBQ25DLENBQUM7O2dCQXRUSixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7OztzQkFMRDtDQTBUQyxBQXZURCxJQXVUQztTQXBUWSxXQUFXOzs7Ozs7SUFDcEIsMEJBQXdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRGF0YUNvbHVtbiwgQ29sdW1uRm9ybWF0dGVyLCBFbnVtRm9ybWF0T3B0aW9ucywgQ29sdW1uRm9ybWF0U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL2NvbHVtbic7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIENvbW1vblV0aWxzIHtcclxuICAgIHByaXZhdGUgY2ZzOiBDb2x1bW5Gb3JtYXRTZXJ2aWNlID0gbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jZnMpIHtcclxuICAgICAgICAgICAgdGhpcy5jZnMgPSBuZXcgQ29sdW1uRm9ybWF0U2VydmljZShudWxsLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blr7nosaHkuK3mjIflrprlrZfmrrXnmoTlgLzjgIIgZmllbGQ6IOWPr+S7peS4uuW4puacieWxgue6p+e7k+aehOeahOi3r+W+hO+8jOWmgu+8miB1c2VyLmZpcnN0TmFtZSB8IG5hbWUg562JXHJcbiAgICAgKiBkYXRhOiDojrflj5blrZfmrrXnmoTmlbDmja7mupDvvIzkuIDoiKzkuLpKU09O5a+56LGhXHJcbiAgICAgKiBzYWZlOiDkuLp0cnVlLCDlsIZodG1s5a2X56ym6L+b6KGM6L2s56CB6L6T5Ye677yM6buY6K6k5Li6IGZhbHNlXHJcbiAgICAgKi9cclxuICAgIGdldFZhbHVlKGZpZWxkOiBzdHJpbmcsIGRhdGE6IGFueSwgc2FmZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAgJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByZXN1bHRWYWwgPSAnJztcclxuICAgICAgICBpZiAoZmllbGQuaW5kZXhPZignLicpID09PSAtMSAmJiBkYXRhLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG4gICAgICAgICAgICByZXN1bHRWYWwgPSBkYXRhW2ZpZWxkXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHRWYWwgPSBmaWVsZC5zcGxpdCgnLicpLnJlZHVjZSgob2JqLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdHRlclZhbHVlKHJlc3VsdFZhbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFZhbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrDmjIflrprlr7nosaHkuK3mn5DkuKrlrZfmrrXnmoTlgLxcclxuICAgICAqIEBwYXJhbSBvYmog6KKr5pu05paw5a+56LGhXHJcbiAgICAgKiBAcGFyYW0gZmllbGQg6KKr5pu05paw5a2X5q61XHJcbiAgICAgKiBAcGFyYW0gdmFsIOaWsOWAvFxyXG4gICAgICogQHBhcmFtIG5lc3Qg5piv5ZCm5Li65bWM5aWX77yM6buY6K6k5Li6IHRydWVcclxuICAgICAqL1xyXG4gICAgc2V0VmFsdWUob2JqOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LCBmaWVsZDogc3RyaW5nLCB2YWw6IGFueSwgbmVzdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAoZmllbGQpIHtcclxuICAgICAgICAgICAgaWYgKGZpZWxkLmluZGV4T2YoJy4nKSA+IC0xICYmIG5lc3QpIHtcclxuICAgICAgICAgICAgICAgIGxldCBsYXN0T2JqID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9maWVsZHMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICAgICAgX2ZpZWxkcy5yZWR1Y2UoIChjLCBwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9iaiA9IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNbcF07XHJcbiAgICAgICAgICAgICAgICB9LCBvYmopO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChsYXN0T2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9ialtfZmllbGRzLnBvcCgpXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9ialtmaWVsZF0gPSB2YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RW51bUl0ZW0odmFsdWU6IGFueSwgZW51bURhdGE6IGFueVtdLCB2YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGVudW1EYXRhLmZpbmQobiA9PiBuW3ZhbHVlRmllbGRdID09IHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRFbnVtVGl0bGVGcm9tQ29sdW1uKHZhbHVlOiBhbnksIGNvbDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgX2NvbCA9IGNvbCBhcyBEYXRhQ29sdW1uO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IF9jb2wuZm9ybWF0dGVyIGFzIENvbHVtbkZvcm1hdHRlcjtcclxuICAgICAgICBpZiAoZm9ybWF0dGVyICYmIHR5cGVvZiBmb3JtYXR0ZXIgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXR0ZXIudHlwZSA9PT0gJ2VudW0nICYmIGZvcm1hdHRlci5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRFbnVtVGl0bGVGcm9tQ29sdW1uT3B0aW9ucyh2YWx1ZSwgZm9ybWF0dGVyLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnVtVGl0bGUoY29sOiBEYXRhQ29sdW1uLCBkYXRhOiBhbnkgKSB7XHJcbiAgICAgICAgY29uc3QgdmFsID0gdGhpcy5nZXRWYWx1ZShjb2wuZmllbGQsIGRhdGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRFbnVtVGl0bGVGcm9tQ29sdW1uKHZhbCwgY29sKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnVtVGl0bGVGcm9tQ29sdW1uT3B0aW9ucyh2YWx1ZTogYW55LCBvcHRzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCB7IGRhdGEsIHZhbHVlRmllbGQsIHRleHRGaWVsZCB9ID0gb3B0cztcclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5nZXRFbnVtSXRlbSh2YWx1ZSwgZGF0YSwgdmFsdWVGaWVsZCk7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGV4dEZpZWxkXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGVzY2FwZUh0bWwoc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyYvZywgJyZhbXA7JylcclxuICAgICAgICAucmVwbGFjZSgvPC9nLCAnJmx0OycpXHJcbiAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXFwiL2csICcmcXVvdDsnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXCcvZywgJyYjMzk7JylcclxuICAgICAgICAucmVwbGFjZSgvXFwvL2csICcmI3gyRjsnKTtcclxuICAgIH1cclxuXHJcbiAgICB1bmVzY2FwZUh0bWwoc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyZhbXA7L2csICcmJylcclxuICAgICAgICAucmVwbGFjZSgvJmx0Oy9nLCAnPCcpXHJcbiAgICAgICAgLnJlcGxhY2UoLyZndDsvZywgJz4nKVxyXG4gICAgICAgIC5yZXBsYWNlKC8mcXVvdDsvZywgJ1wiJylcclxuICAgICAgICAucmVwbGFjZSgvJiMzOTsvZywgJ1xcJycpXHJcbiAgICAgICAgLnJlcGxhY2UoLyYjeDJGOy9nLCAnLycpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGZvcm1hdHRlclZhbHVlKHZhbDogYW55KSB7XHJcbiAgICAgICAgaWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lc2NhcGVIdG1sKHZhbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDojrflj5blrZfnrKbkuLLlnKjpobXpnaLkuK3nmoTnnJ/lrp7lrr3luqYgKi9cclxuICAgIGdldFRleHRXaWR0aCh0eHQ6IHN0cmluZywgZm9udCkge1xyXG4gICAgICAgIC8vIGNvbnN0IGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIGNvbnRleHQuZm9udCA9IGZvbnQ7XHJcbiAgICAgICAgY29uc3QgbWV0cmljcyA9IGNvbnRleHQubWVhc3VyZVRleHQodHh0KTtcclxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChtZXRyaWNzLndpZHRoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVTdHlsZVNoZWV0KGlkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGlkKTtcclxuICAgICAgICBpZiAoc3R5bGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlU3R5bGVTaGVldChzdHlsZVNoZWV0SWQ6IHN0cmluZyk6IEhUTUxTdHlsZUVsZW1lbnQge1xyXG4gICAgICAgIGNvbnN0IGh0bWxIZWFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xyXG5cclxuICAgICAgICBjb25zdCBzdHlsZUVsZUlkID0gc3R5bGVTaGVldElkO1xyXG4gICAgICAgIGxldCBzdHlsZUVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHN0eWxlRWxlSWQpKSB7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgc3R5bGVFbGVJZCk7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudC5pbm5lclRleHQgPSAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQuaWQgPSBzdHlsZUVsZUlkO1xyXG4gICAgICAgICAgICBodG1sSGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0eWxlRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTdHlsZVNoZWV0KHN0eWxlU2hlZXRJZCkge1xyXG4gICAgICAgIGNvbnN0IHN0eWxlU2hlZXRzID0gZG9jdW1lbnQuc3R5bGVTaGVldHMgYXMgYW55O1xyXG4gICAgICAgIGxldCBzdHlsZVNoZWV0ID0gbnVsbDtcclxuICAgICAgICBmb3IgKGNvbnN0IHN0eWxlc2hlZXQgb2Ygc3R5bGVTaGVldHMpIHtcclxuICAgICAgICAgICAgaWYgKChzdHlsZXNoZWV0Lm93bmVyTm9kZSB8fCBzdHlsZXNoZWV0Wydvd25pbmdFbGVtZW50J10pLmlkID09PSBzdHlsZVNoZWV0SWQpIHtcclxuICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQgPSBzdHlsZXNoZWV0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdHlsZVNoZWV0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkuI7njrDmnInmoLflvI/lkIjlubYgKi9cclxuICAgIGFwcGVuZENzc1J1bGVzKHJ1bGVzOiBzdHJpbmdbXSwgc3R5bGVTaGVldCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5pbmRleE9mKCd7JykpO1xyXG4gICAgICAgICAgICBjb25zdCByZW1vdmVkQ3NzUnVsZSA9IHRoaXMucmVtb3ZlQ3NzUnVsZShydWxlTmFtZSwgc3R5bGVTaGVldCk7XHJcbiAgICAgICAgICAgIGxldCBjc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmVkQ3NzUnVsZSkge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dCArPSByZW1vdmVkQ3NzUnVsZS5jc3NUZXh0LnNsaWNlKHJlbW92ZWRDc3NSdWxlLmNzc1RleHQuaW5kZXhPZigneycpICsgMSwgcmVtb3ZlZENzc1J1bGUuY3NzVGV4dC5pbmRleE9mKCd9JykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNzc1RleHQgKz0gcnVsZS5zbGljZShydWxlLmluZGV4T2YoJ3snKSArIDEsIHJ1bGUuaW5kZXhPZignfScpKS5yZXBsYWNlKC9cIi9nLCAnJykucmVwbGFjZSgvLC9nLCAnOycpICsgJzsnO1xyXG4gICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5hZGRSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX25ld1J1bGUgPSBgJHtydWxlTmFtZX17ICR7Y3NzVGV4dH0gfWA7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lmluc2VydFJ1bGUoX25ld1J1bGUsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDopobnm5bnjrDmnInnmoTmoLflvI8gKi9cclxuICAgIGFwcGVuZENzc1J1bGVzMihydWxlczogc3RyaW5nW10sIHN0eWxlU2hlZXQpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgcnVsZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZU5hbWUgPSBydWxlLnNsaWNlKDAsIHJ1bGUuaW5kZXhPZigneycpKTtcclxuICAgICAgICAgICAgY29uc3QgcmVtb3ZlZENzc1J1bGUgPSB0aGlzLnJlbW92ZUNzc1J1bGUocnVsZU5hbWUsIHN0eWxlU2hlZXQpO1xyXG4gICAgICAgICAgICBjb25zdCBjc3NUZXh0ID0gcnVsZS5zbGljZShydWxlLmluZGV4T2YoJ3snKSArIDEsIHJ1bGUuaW5kZXhPZignfScpKS5yZXBsYWNlKC9cIi9nLCAnJykucmVwbGFjZSgvLC9nLCAnOycpICsgJzsnO1xyXG4gICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5hZGRSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX25ld1J1bGUgPSBgJHtydWxlTmFtZX17ICR7Y3NzVGV4dH0gfWA7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lmluc2VydFJ1bGUoX25ld1J1bGUsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldENzc1J1bGUocnVsZU5hbWU6IHN0cmluZywgc3R5bGVTaGVldCkge1xyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCByID0gbnVsbDtcclxuICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgaWYgKHJ1bGUuc2VsZWN0b3JUZXh0ID09IHJ1bGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByID0gcnVsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ3NzUnVsZShydWxlTmFtZTogc3RyaW5nLCBzdHlsZVNoZWV0ICkge1xyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCBpaSA9IDA7XHJcbiAgICAgICAgbGV0IGNzc1J1bGU6IGFueSA9IGZhbHNlO1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgY3NzUnVsZSA9IGNzc1J1bGVzW2lpXTtcclxuICAgICAgICAgICAgaWYgKGNzc1J1bGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjc3NSdWxlLnNlbGVjdG9yVGV4dC50b0xvd2VyQ2FzZSgpID09IHJ1bGVOYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5jc3NSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmRlbGV0ZVJ1bGUoaWkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQucmVtb3ZlUnVsZShpaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3NzUnVsZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpaSsrO1xyXG4gICAgICAgIH0gd2hpbGUgKGNzc1J1bGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTnVsbE9yVW5kZWZpbmVkKHZhbDogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBpc0lFKCkge1xyXG4gICAgICAgIGNvbnN0IHVBID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgcmV0dXJuIC9tc2llXFxzfHRyaWRlbnRcXC98ZWRnZVxcLy9pLnRlc3QodUEpICYmICEhKCd1bmlxdWVJRCcgaW4gZG9jdW1lbnQgfHwgJ2RvY3VtZW50TW9kZScgaW4gZG9jdW1lbnQgfHwgKCdBY3RpdmVYT2JqZWN0JyBpbiB3aW5kb3cpIHx8ICdNU0lucHV0TWV0aG9kQ29udGV4dCcgaW4gd2luZG93KTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNvcnRTdHJpbmcoc29ydHM6IGFueVtdKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jZnMuYnVpbGRTb3J0U3RyaW5nKHNvcnRzKTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNxbFdoZXJlKGNvbmRpdGlvbnM6IGFueVtdKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jZnMuYnVpbGRTcWxXaGVyZShjb25kaXRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRCcm93c2VyVHlwZSgpIHtcclxuICAgICAgICBjb25zdCB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsgIC8vIOiOt+WPlueUqOaIt+err+S/oeaBr1xyXG4gICAgICAgIGNvbnN0IGluZm8gPSB7XHJcbiAgICAgICAgICAgIGllIDogL21zaWUvIC50ZXN0KHVhKSAmJiAhL29wZXJhLyAudGVzdCh1YSksICAvLyAg5Yy56YWNSUXmtY/op4jlmahcclxuICAgICAgICAgICAgb3AgOiAvb3BlcmEvIC50ZXN0KHVhKSwgIC8vICDljLnphY1PcGVyYea1j+iniOWZqFxyXG4gICAgICAgICAgICBzYSA6IC92ZXJzaW9uLipzYWZhcmkvLnRlc3QodWEpLCAgLy8g5Yy56YWNU2FmYXJp5rWP6KeI5ZmoXHJcbiAgICAgICAgICAgIGNoIDogL2Nocm9tZS8udGVzdCh1YSksICAvLyAg5Yy56YWNQ2hyb21l5rWP6KeI5ZmoXHJcbiAgICAgICAgICAgIGZmIDogL2dlY2tvLy50ZXN0KHVhKSAmJiAhL3dlYmtpdC8udGVzdCh1YSkgIC8vIOWMuemFjUZpcmVmb3jmtY/op4jlmahcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0RkZWZXIoKSB7XHJcbiAgICAgICAgY29uc3QgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xyXG4gICAgICAgIGNvbnN0IGIgPSB1YS5pbmRleE9mKCdGaXJlZm94LycpO1xyXG4gICAgICAgIGlmIChiIDwgMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQgKHVhLnN1YnN0cmluZyhiICsgOCwgdWEubGFzdEluZGV4T2YoJ1xcLicpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UXVlcnlTdHJpbmcobmFtZSwgbG9jYXRpb25TZWFyY2ggPSAnJykge1xyXG4gICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKFwiKF58JilcIiArIG5hbWUgKyBcIj0oW14mXSopKCZ8JClcIiwgXCJpXCIpO1xyXG4gICAgICAgIGxldCBfc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICBpZiAobG9jYXRpb25TZWFyY2gpIHtcclxuICAgICAgICAgICAgX3NlYXJjaCA9IGxvY2F0aW9uU2VhcmNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IF9zZWFyY2guc3Vic3RyaW5nKDEpLm1hdGNoKHJlZyk7XHJcbiAgICAgICAgaWYgKHIgIT0gbnVsbCkgcmV0dXJuIChyWzJdKTsgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bpobXpnaLkuK1ib2R55LiL5omA5pyJ5YWD57Sg55qEekluZGV4LCDlubbov5Tlm57kuIvkuKrmta7lsYLnmoTmlrB6aW5kZXhcclxuICAgICAqL1xyXG4gICAgZ2V0RmxvYXRpbmdMYXllckluZGV4KHVwcGVyTGF5ZXJzID0gMSkge1xyXG4gICAgICAgIGNvbnN0IG92ZXJsYXlzID0gQXJyYXkuZnJvbShkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHk+ZGl2LCBib2R5PmZhcnJpcy1kaWFsb2c+LmZhcnJpcy1tb2RhbCxib2R5Pi5mYXJyaXMtbW9kYWwnKSkuZmlsdGVyKG4gPT4gbikubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUobikuekluZGV4LCAxMCk7XHJcbiAgICAgICAgfSkuZmlsdGVyKG4gPT4gbik7XHJcbiAgICAgICAgY29uc3QgbWF4WmluZGV4ID0gTWF0aC5tYXgoLi4ub3ZlcmxheXMpO1xyXG5cclxuICAgICAgICByZXR1cm4gbWF4WmluZGV4ICsgdXBwZXJMYXllcnM7XHJcbiAgICB9XHJcbn1cclxuIl19