/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { forkJoin } from 'rxjs';
import { MessagerService } from '@farris/ui-messager';
export class TaskService {
    /**
     * @param {?} httpSvc
     * @param {?} message
     */
    constructor(httpSvc, message) {
        this.httpSvc = httpSvc;
        this.message = message;
    }
    /**
     * @param {?} ids
     * @return {?}
     */
    getUsersByIds(ids) {
        /** @type {?} */
        var pathUrl = '/api/runtime/sys/v1.0/users';
        return forkJoin(ids.map(id => this.httpSvc.get(pathUrl + `/${id}` + `?mode=0002`)));
    }
    /**
     * 获取工作项操作列表
     * @param {?} workItemId
     * @return {?}
     */
    getWorkItemActions(workItemId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/actions`;
        return this.httpSvc.get(url);
    }
    /**
     * 执行审批操作
     * @param {?} context 执行审批上下文
     * @return {?}
     */
    complete(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/complete`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 执行审批预解析
     * @param {?} context 执行审批上下文
     * @return {?}
     */
    completeSimulate(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/complete-simulation`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 获取跳转活动信息
     * @param {?} workItemId 工作项Id
     * @param {?} action 动作编号
     * @return {?}
     */
    getDestinationScope(workItemId, action) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/nextNodes/${action}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据节点ID获取指定参与者的结果
     * @param {?} workItemId
     * @param {?} nodeId 说明：nodeIds=["node1","node2",···]
     * @return {?} 指派信息的数组 re: FlowNodeInfo[]
     */
    getSimulationAssigneeInfo(workItemId, nodeId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/simulation-assigneeInfo?nodeIds=[${nodeId}]`;
        return this.httpSvc.get(url);
    }
    /**
     * 执行征询、知会
     * @param {?} context 上下文
     * @return {?}
     */
    addSign(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/counterSignAdd`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 已阅
     * @param {?} context 参数
     * @return {?}
     */
    readTask(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/read`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 查询单据信息
     * @param {?} workItemId 工作项Id
     * @return {?}
     */
    getAppInfo(workItemId) {
        /** @type {?} */
        const formParUrl = `/api/runtime/wf/v1.0/workItems/${workItemId}/formInfo`;
        return this.httpSvc.get(formParUrl);
    }
    /**
     * 获取指派信息
     * @param {?} taskId 工作项Id
     * 此接口只返回一个AssignInfo类序列化后的信息，不是多个
     * @return {?}
     */
    getAssigneeInfo(taskId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${taskId}/assigneeInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取加签移交范围设置
     * @param {?} workItemId
     * @param {?} actionCode
     * @return {?}
     */
    getOrganizationScope(workItemId, actionCode) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/organizationScope/${actionCode}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据流程实例ID和任务状态办理任务
     * @param {?} procInstId 流程实例id
     * @param {?} state 任务状态 2或5
     * @return {?}
     */
    getTaskByProcInstId(procInstId, state) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/tasks/processInstanceId?procInstId=${procInstId}&state=${state}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据workitemID获取任务实体
     * @param {?} workItemId
     * @return {?}
     */
    getTaskByWorkItemId(workItemId) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/tasks/sourceId/${workItemId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据工作项ID指派任务
     * @param {?} assigneesPa 指派参数
     * @return {?}
     */
    assignNextUsersByWorkItemId(assigneesPa) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/assignUser`;
        return this.httpSvc.post(url, assigneesPa);
    }
    /**
     * 取回
     * @param {?} context
     * @return {?}
     */
    retrieve(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/retrieve`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 任务移交
     * @param {?} transferContext
     * @return {?}
     */
    transfer(transferContext) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/transfer`;
        return this.httpSvc.post(url, transferContext);
    }
    /**
     * 任务评论
     * @param {?} commentContext
     * @return {?}
     */
    comment(commentContext) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/comment`;
        return this.httpSvc.post(url, commentContext);
    }
    /**
     * 领用任务
     * @param {?} taskId 工作项Id
     * @param {?} comment
     * @return {?}
     */
    claim(taskId, comment) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/claim`;
        /** @type {?} */
        const options = {
            workItemId: taskId,
            comment: comment
        };
        return this.httpSvc.post(url, options);
    }
    /**
     * 取消领用
     * @param {?} taskId 任务Id
     * @param {?} comment
     * @return {?}
     */
    unClaim(taskId, comment) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/unclaim`;
        /** @type {?} */
        const options = {
            workItemId: taskId,
            comment: comment
        };
        return this.httpSvc.post(url, options);
    }
    /**
     * 报错提示
     * @param {?} error
     * @return {?}
     */
    error(error) {
        if (error && error.error && error.error.Message) {
            /** @type {?} */
            var message = error.error.Message;
            this.message.warning(message);
        }
    }
    /**
     * 启动流程接口
     * @param {?} payload API所需的上下文参数
     * @return {?}
     */
    startProcess(payload) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/startProcess`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 启动流程预解析
     * @param {?} payload API所需的上下文参数
     * @return {?}
     */
    startProcessSimulate(payload) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/startProcess-simulation`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 取消提交
     * @param {?} param 参数
     * @return {?}
     */
    cancelSubmit(param) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/cancelSubmit`;
        return this.httpSvc.post(url, param);
    }
    /**
     * @return {?}
     */
    static newId() {
        /** @type {?} */
        const S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    }
    /**
     * @return {?}
     */
    getCommentList() {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/commonComments`;
        return this.httpSvc.get(url);
    }
    /**
     * @return {?}
     */
    addComment() {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/commonComments`;
        return this.httpSvc.post(url, {});
    }
    /**
     * 获取任务中心配置项
     * @param {?} code 配置项的Code
     * @param {?=} ownerType
     * @param {?=} ownerId
     * @return {?}
     */
    getTaskCenterConfigByCode(code, ownerType, ownerId) {
        /** @type {?} */
        let url = `/api/runtime/task/v1.0/task-center-setting/code?code=${code}`;
        ownerType && (url += `&ownerType=${ownerType}`);
        ownerId && (url += `&ownerId=${ownerId}`);
        return this.httpSvc.get(url);
    }
    /**
     * 添加用户级别自定义配置
     * @param {?} code 配置项编号
     * @param {?} currentValue
     * @return {?}
     */
    addTaskCenterConfig(code, currentValue) {
        /** @type {?} */
        let url = `/api/runtime/task/v1.0/task-center-setting/add?configCode=${code}&currentValue=${currentValue}`;
        return this.httpSvc.post(url, null);
    }
    /**
     * 获取全部用户级别配置
     * @return {?}
     */
    getAllUserConfig() {
        /** @type {?} */
        let url = `/api/runtime/task/v1.0/task-center-setting/all`;
        return this.httpSvc.get(url);
    }
    /**
     * 真正上传附件
     * @param {?} files
     * @return {?}
     */
    uploadAttachment(files) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc/commit`;
        return this.httpSvc.put(url, files);
    }
    /**
     * 删除附件
     * @param {?} fileDeleteEntity
     * @return {?}
     */
    deleteAttachment(fileDeleteEntity) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc`;
        return this.httpSvc.delete(url, fileDeleteEntity);
    }
    /**
     * 签名图片，附件相关
     * @param {?} gspDocUploadEntity
     * @return {?}
     */
    uploadSignature(gspDocUploadEntity) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc`;
        /** @type {?} */
        let header = this.httpSvc.setHeader({
            body: gspDocUploadEntity,
            responseType: 'text'
        });
        return this.httpSvc.request('Post', url, header);
    }
    /**
     * 创建内码
     * @return {?}
     */
    createNM() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            /** @type {?} */
            const r = Math.random() * 16 | 0;
            /** @type {?} */
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    /**
     * 获取当前用户信息
     * @return {?}
     */
    getUserInfo() {
        /** @type {?} */
        let url = `/api/runtime/sys/v1.0/userinfos?infoType=user`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取用户所有签名
     * @param {?} userId
     * @return {?}
     */
    getUserSign(userId) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/formdoc/fileinfo/form?formid=${userId}&rootid=taskcentersignature`;
        return this.httpSvc.get(url);
    }
    /**
     * 解析文件类型，给出缩略图
     * @param {?} attachmentInfo
     * @return {?}
     */
    createItem(attachmentInfo) {
        /** @type {?} */
        var pos = attachmentInfo.fileName.lastIndexOf(".");
        /** @type {?} */
        var type = attachmentInfo.fileName.substring(pos + 1);
        type = (type == '' ? 'Default' : type.toLowerCase());
        /** @type {?} */
        var docLib = 'doc-docx-htm-html-js-pdf-ppt-pptx-rar-zip-txt-xls-xlsx';
        /** @type {?} */
        var videoLib = 'wav-aif-aiff-au-mp1-mp2-mp3-ra-rm-ram-mid-rmi';
        /** @type {?} */
        var audioLib = 'avi-rm-rmvb-mpeg-mpg-dat-mov-qt-asf-wm-mp4';
        /** @type {?} */
        var imgLib = 'webp-baibmp-dupcx-tif-gif-jpeg-tga-exif-fpx-svg-psd-cdr-pcd-dxf-ufo-eps-ai-png-hdri-raw-wmf-flic-emf-ico-jpg';
        if (docLib.indexOf(type) >= 0) {
            type = type.toLowerCase();
        }
        else if (videoLib.indexOf(type) >= 0) {
            type = 'video';
        }
        else if (audioLib.indexOf(type) >= 0) {
            type = 'audio';
        }
        else if (imgLib.indexOf(type) >= 0) {
            type = 'picture';
        }
        else {
            type = 'default';
        }
        return type;
    }
    /**
     * 注册主题，并获取当前主题唯一标识token
     * @param {?} subjectCode 主题编码，非唯一标识，token为唯一标识
     * @param {?} token 主题唯一标识。
     * @return {?} 主题的唯一标识。
     */
    subjectRegister(subjectCode, token) {
        return ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.subjectRegister(subjectCode, { funcId: token });
    }
    /**
     * 通过某个token发送消息
     * @param {?} subjectToken 主题唯一的token标识
     * @param {?} message 要发送的消息
     * @return {?}
     */
    subjectNotify(subjectToken, message) {
        ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.notify(subjectToken, message);
    }
    /**
     * 添加观察者，并监听消息
     * @param {?} subjectToken 主题token
     * @param {?} observerToken 当前监听主题的观察者唯一标识token。此处固定
     * @param {?} handler 监听到消息后执行的动作
     * @return {?}
     */
    subjectResponse(subjectToken, observerToken, handler) {
        ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.response(subjectToken, observerToken, handler);
    }
    /**
     * 获取催办模拟结果
     * @param {?} context 参数
     * @return {?}
     */
    urgeHandleSimulate(context) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/getUrgeHandleInfo`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 执行催办
     * @param {?} context 参数
     * @return {?}
     */
    urgeHandle(context) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/urgeHandle`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 批量数字签名
     * @param {?} context 参数
     * @return {?}
     */
    batchVerifySigned(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/batchVerifySigned`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 获取用户帮助前端配置
     * @return {?}
     */
    getWfUserHelpConfig() {
        /** @type {?} */
        const url = `/platform/runtime/wf/web/wf-user-help/config.json?v=` + new Date().getTime();
        return this.httpSvc.get(url);
    }
    /**
     * 获取加签配置
     * @param {?} workItemId
     * @return {?}
     */
    getAdhocConfig(workItemId) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/${workItemId}/adhocConfig/AddSignBehind`;
        return this.httpSvc.get(url);
    }
    /**
     * 加签提交
     * @param {?} payload
     * @return {?}
     */
    adhocAssignee(payload) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/adhocAssignee`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 取消征询
     * @param {?} payload
     * @return {?}
     */
    cancelConsult(payload) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/cancelConsult`;
        return this.httpSvc.post(url, payload);
    }
}
TaskService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
TaskService.ctorParameters = () => [
    { type: HttpService },
    { type: MessagerService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    TaskService.prototype.httpSvc;
    /**
     * @type {?}
     * @private
     */
    TaskService.prototype.message;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi10YXNrLWhhbmRsZXIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZS90YXNrLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBYyxRQUFRLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFJNUMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBU3RELE1BQU0sT0FBTyxXQUFXOzs7OztJQUVwQixZQUNZLE9BQW9CLEVBQ3BCLE9BQXdCO1FBRHhCLFlBQU8sR0FBUCxPQUFPLENBQWE7UUFDcEIsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7SUFDaEMsQ0FBQzs7Ozs7SUFFTCxhQUFhLENBQUMsR0FBYTs7WUFDbkIsT0FBTyxHQUFHLDZCQUE2QjtRQUMzQyxPQUFPLFFBQVEsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxHQUFHLElBQUksRUFBRSxFQUFFLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLENBQUM7Ozs7OztJQUlELGtCQUFrQixDQUFDLFVBQWtCOztjQUMzQixHQUFHLEdBQUcsa0NBQWtDLFVBQVUsVUFBVTtRQUNsRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7Ozs7OztJQU1ELFFBQVEsQ0FBQyxPQUF3Qjs7Y0FDdkIsR0FBRyxHQUFHLHlDQUF5QztRQUNyRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7Ozs7SUFNRCxnQkFBZ0IsQ0FBQyxPQUF3Qjs7Y0FDL0IsR0FBRyxHQUFHLG9EQUFvRDtRQUNoRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7Ozs7O0lBT0QsbUJBQW1CLENBQUMsVUFBa0IsRUFBRSxNQUFjOztjQUM1QyxHQUFHLEdBQUcsa0NBQWtDLFVBQVUsY0FBYyxNQUFNLEVBQUU7UUFDOUUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDOzs7Ozs7O0lBUUQseUJBQXlCLENBQUMsVUFBa0IsRUFBRSxNQUFjOztjQUNsRCxHQUFHLEdBQUcsa0NBQWtDLFVBQVUscUNBQXFDLE1BQU0sR0FBRztRQUN0RyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7Ozs7OztJQU1ELE9BQU8sQ0FBQyxPQUFZOztjQUNWLEdBQUcsR0FBRywrQ0FBK0M7UUFDM0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDM0MsQ0FBQzs7Ozs7O0lBTUQsUUFBUSxDQUFDLE9BQTZCOztjQUM1QixHQUFHLEdBQUcscUNBQXFDO1FBQ2pELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7OztJQU1ELFVBQVUsQ0FBQyxVQUFrQjs7Y0FDbkIsVUFBVSxHQUFHLGtDQUFrQyxVQUFVLFdBQVc7UUFDMUUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4QyxDQUFDOzs7Ozs7O0lBT0QsZUFBZSxDQUFDLE1BQWM7O2NBQ3BCLEdBQUcsR0FBRyxrQ0FBa0MsTUFBTSxlQUFlO1FBQ25FLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7OztJQU9ELG9CQUFvQixDQUFDLFVBQWtCLEVBQUUsVUFBa0I7O2NBQ2pELEdBQUcsR0FBRyxrQ0FBa0MsVUFBVSxzQkFBc0IsVUFBVSxFQUFFO1FBQzFGLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7OztJQU9ELG1CQUFtQixDQUFDLFVBQWtCLEVBQUUsS0FBYTs7Y0FDM0MsR0FBRyxHQUFHLDZEQUE2RCxVQUFVLFVBQVUsS0FBSyxFQUFFO1FBQ3BHLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7O0lBTUQsbUJBQW1CLENBQUMsVUFBa0I7O2NBQzVCLEdBQUcsR0FBRyx5Q0FBeUMsVUFBVSxFQUFFO1FBQ2pFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7O0lBTUQsMkJBQTJCLENBQUMsV0FBNEI7O2NBQzlDLEdBQUcsR0FBRywyQ0FBMkM7UUFDdkQsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDL0MsQ0FBQzs7Ozs7O0lBT0QsUUFBUSxDQUFDLE9BQWlEOztjQUNoRCxHQUFHLEdBQUcseUNBQXlDO1FBQ3JELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7OztJQU9ELFFBQVEsQ0FBQyxlQUFvQjs7Y0FDbkIsR0FBRyxHQUFHLHlDQUF5QztRQUNyRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxlQUFlLENBQUMsQ0FBQztJQUNuRCxDQUFDOzs7Ozs7SUFPRCxPQUFPLENBQUMsY0FBbUI7O2NBQ2pCLEdBQUcsR0FBRyx3Q0FBd0M7UUFDcEQsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDbEQsQ0FBQzs7Ozs7OztJQU1ELEtBQUssQ0FBQyxNQUFjLEVBQUUsT0FBZTs7Y0FDM0IsR0FBRyxHQUFHLHNDQUFzQzs7Y0FDNUMsT0FBTyxHQUFHO1lBQ1osVUFBVSxFQUFFLE1BQU07WUFDbEIsT0FBTyxFQUFFLE9BQU87U0FDbkI7UUFDRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7Ozs7O0lBTUQsT0FBTyxDQUFDLE1BQWMsRUFBRSxPQUFlOztjQUM3QixHQUFHLEdBQUcsd0NBQXdDOztjQUM5QyxPQUFPLEdBQUc7WUFDWixVQUFVLEVBQUUsTUFBTTtZQUNsQixPQUFPLEVBQUUsT0FBTztTQUNuQjtRQUNELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7OztJQU1ELEtBQUssQ0FBQyxLQUFVO1FBQ1osSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRTs7Z0JBQ3pDLE9BQU8sR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU87WUFDakMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDakM7SUFDTCxDQUFDOzs7Ozs7SUFNRCxZQUFZLENBQUMsT0FBNEI7O2NBQy9CLEdBQUcsR0FBRyxvREFBb0Q7UUFDaEUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDM0MsQ0FBQzs7Ozs7O0lBTUQsb0JBQW9CLENBQUMsT0FBNEI7O2NBQ3ZDLEdBQUcsR0FBRywrREFBK0Q7UUFDM0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDM0MsQ0FBQzs7Ozs7O0lBTUQsWUFBWSxDQUFDLEtBQTBCOztjQUM3QixHQUFHLEdBQUcsb0RBQW9EO1FBQ2hFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3pDLENBQUM7Ozs7SUFFRCxNQUFNLENBQUMsS0FBSzs7Y0FDRixFQUFFLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ2hGLE9BQU8sQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsR0FBRyxHQUFHLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMzRixDQUFDOzs7O0lBR0QsY0FBYzs7Y0FDSixHQUFHLEdBQUcscUNBQXFDO1FBQ2pELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7OztJQUVELFVBQVU7O2NBQ0EsR0FBRyxHQUFHLHFDQUFxQztRQUNqRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN0QyxDQUFDOzs7Ozs7OztJQU1ELHlCQUF5QixDQUFDLElBQVksRUFBRSxTQUFrQixFQUFFLE9BQWdCOztZQUNwRSxHQUFHLEdBQUcsd0RBQXdELElBQUksRUFBRTtRQUN4RSxTQUFTLElBQUksQ0FBQyxHQUFHLElBQUksY0FBYyxTQUFTLEVBQUUsQ0FBQyxDQUFDO1FBQ2hELE9BQU8sSUFBSSxDQUFDLEdBQUcsSUFBSSxZQUFZLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDMUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDOzs7Ozs7O0lBTUQsbUJBQW1CLENBQUMsSUFBWSxFQUFFLFlBQW9COztZQUM5QyxHQUFHLEdBQUcsNkRBQTZELElBQUksaUJBQWlCLFlBQVksRUFBRTtRQUMxRyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN4QyxDQUFDOzs7OztJQU1ELGdCQUFnQjs7WUFDUixHQUFHLEdBQUcsZ0RBQWdEO1FBQzFELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7O0lBTUQsZ0JBQWdCLENBQUMsS0FBdUI7O1lBQ2hDLEdBQUcsR0FBRyxrQ0FBa0M7UUFDNUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDeEMsQ0FBQzs7Ozs7O0lBTUQsZ0JBQWdCLENBQUMsZ0JBQWtDOztZQUMzQyxHQUFHLEdBQUcsMkJBQTJCO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDdEQsQ0FBQzs7Ozs7O0lBS0QsZUFBZSxDQUFDLGtCQUFzQzs7WUFDOUMsR0FBRyxHQUFHLDJCQUEyQjs7WUFDakMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDO1lBQ2hDLElBQUksRUFBRSxrQkFBa0I7WUFDeEIsWUFBWSxFQUFFLE1BQU07U0FDdkIsQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNyRCxDQUFDOzs7OztJQUtELFFBQVE7UUFDSixPQUFPLHNDQUFzQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDOztrQkFDaEUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQzs7a0JBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQztZQUNyRSxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDOzs7OztJQUtELFdBQVc7O1lBQ0gsR0FBRyxHQUFHLCtDQUErQztRQUN6RCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7Ozs7OztJQUtELFdBQVcsQ0FBQyxNQUFjOztZQUNsQixHQUFHLEdBQUcsc0RBQXNELE1BQU0sNkJBQTZCO1FBQ25HLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7O0lBT0QsVUFBVSxDQUFDLGNBQW1COztZQUN0QixHQUFHLEdBQUcsY0FBYyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDOztZQUM5QyxJQUFJLEdBQUcsY0FBYyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUNyRCxJQUFJLEdBQUcsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDOztZQUNqRCxNQUFNLEdBQUcsd0RBQXdEOztZQUNqRSxRQUFRLEdBQUcsK0NBQStDOztZQUMxRCxRQUFRLEdBQUcsNENBQTRDOztZQUN2RCxNQUFNLEdBQUcsOEdBQThHO1FBQzNILElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDM0IsSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUM3QjthQUFNLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDcEMsSUFBSSxHQUFHLE9BQU8sQ0FBQztTQUNsQjthQUFNLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDcEMsSUFBSSxHQUFHLE9BQU8sQ0FBQztTQUNsQjthQUFNLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDbEMsSUFBSSxHQUFHLFNBQVMsQ0FBQztTQUNwQjthQUFNO1lBQ0gsSUFBSSxHQUFHLFNBQVMsQ0FBQztTQUNwQjtRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Ozs7Ozs7SUFRRCxlQUFlLENBQUMsV0FBbUIsRUFBRSxLQUFhO1FBQzlDLE9BQU8sQ0FBQyxtQkFBQSxNQUFNLEVBQU8sQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLFdBQVcsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQzdHLENBQUM7Ozs7Ozs7SUFPRCxhQUFhLENBQUMsWUFBb0IsRUFBRSxPQUFZO1FBQzVDLENBQUMsbUJBQUEsTUFBTSxFQUFPLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDcEYsQ0FBQzs7Ozs7Ozs7SUFRRCxlQUFlLENBQUMsWUFBb0IsRUFBRSxhQUFxQixFQUFFLE9BQTZCO1FBQ3RGLENBQUMsbUJBQUEsTUFBTSxFQUFPLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUUsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3JHLENBQUM7Ozs7OztJQU9ELGtCQUFrQixDQUFDLE9BQWtDOztZQUM3QyxHQUFHLEdBQUcseURBQXlEO1FBQ25FLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7OztJQU9ELFVBQVUsQ0FBQyxPQUEwQjs7WUFDN0IsR0FBRyxHQUFHLGtEQUFrRDtRQUM1RCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7Ozs7SUFLRCxpQkFBaUIsQ0FBQyxPQUFpQzs7Y0FDekMsR0FBRyxHQUFHLGtEQUFrRDtRQUM5RCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7OztJQU1ELG1CQUFtQjs7Y0FDVCxHQUFHLEdBQUcsc0RBQXNELEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUU7UUFDekYsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDOzs7Ozs7SUFLRCxjQUFjLENBQUMsVUFBa0I7O1lBQ3pCLEdBQUcsR0FBRyxrQ0FBa0MsVUFBVSw0QkFBNEI7UUFDbEYsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDOzs7Ozs7SUFJRCxhQUFhLENBQUMsT0FBdUI7O1lBQzdCLEdBQUcsR0FBRyw4Q0FBOEM7UUFDeEQsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDM0MsQ0FBQzs7Ozs7O0lBSUQsYUFBYSxDQUFDLE9BQTZCOztZQUNuQyxHQUFHLEdBQUcsOENBQThDO1FBQ3hELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7OztZQTFiSixVQUFVOzs7O1lBYkYsV0FBVztZQUtYLGVBQWU7Ozs7Ozs7SUFZaEIsOEJBQTRCOzs7OztJQUM1Qiw4QkFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIGZvcmtKb2luIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEFzc2lnblBhcmFtZXRlciB9IGZyb20gJy4uL2VudGl0eS9jb21wbGV0ZS1yZXNwb25zZSc7XHJcbmltcG9ydCB7IENvbXBsZXRlQ29udGV4dCB9IGZyb20gJy4uL2VudGl0eS9jb21wbGV0ZS1jb250ZXh0JztcclxuaW1wb3J0IHsgQmF0Y2hWZXJpZnlTaWduZWRDb250ZXh0IH0gZnJvbSAnLi4vZW50aXR5L2JhdGNoVmVyaWZ5c2lnbmVkJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IENhbmNlbFN1Ym1pdFBheWxvYWQsIFN0YXJ0UHJvY2Vzc1BheWxvYWQgfSBmcm9tICcuLi9lbnRpdHkvc3RhcnQtcHJvY2Vzcy1wYXlsb2FkJztcclxuaW1wb3J0IHsgUG9zdE1lc3NhZ2UgfSBmcm9tICcuLi9lbnRpdHkvcG9zdE1lc3NhZ2UnO1xyXG5pbXBvcnQgeyBGaWxlRGVsZXRlRW50aXR5LCBGaWxlVXBsb2FkRW50aXR5LCBHc3BEb2NVcGxvYWRFbnRpdHkgfSBmcm9tICcuLi9lbnRpdHkvYXR0YWNobWVudCc7XHJcbmltcG9ydCB7IFdvcmtJdGVtRXhlY3V0ZVBhcmFtIH0gZnJvbSAnLi4vZW50aXR5L3dvcmtpdGVtLWV4ZWN1dGUtcGFyYW0nO1xyXG5pbXBvcnQgeyBVcmdlSGFuZGxlQ29udGV4dCwgVXJnZUhhbmRsZVNpbXVsYXRlQ29udGV4dCB9IGZyb20gJy4uL2VudGl0eS91cmdlLWhhbmRsZSc7XHJcbmltcG9ydCB7IEFkZFNpZ25QYXlsb2FkIH0gZnJvbSAnLi4vZW50aXR5L2FkZC1zaWduJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFRhc2tTZXJ2aWNlIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGh0dHBTdmM6IEh0dHBTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgKSB7IH1cclxuXHJcbiAgICBnZXRVc2Vyc0J5SWRzKGlkczogc3RyaW5nW10pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIHZhciBwYXRoVXJsID0gJy9hcGkvcnVudGltZS9zeXMvdjEuMC91c2Vycyc7XHJcbiAgICAgICAgcmV0dXJuIGZvcmtKb2luKGlkcy5tYXAoaWQgPT4gdGhpcy5odHRwU3ZjLmdldChwYXRoVXJsICsgYC8ke2lkfWAgKyBgP21vZGU9MDAwMmApKSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW3peS9nOmhueaTjeS9nOWIl+ihqFxyXG4gICAgICovXHJcbiAgICBnZXRXb3JrSXRlbUFjdGlvbnMod29ya0l0ZW1JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zLyR7d29ya0l0ZW1JZH0vYWN0aW9uc2A7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJp+ihjOWuoeaJueaTjeS9nFxyXG4gICAgICogQHBhcmFtIGNvbnRleHQg5omn6KGM5a6h5om55LiK5LiL5paHXHJcbiAgICAgKi9cclxuICAgIGNvbXBsZXRlKGNvbnRleHQ6IENvbXBsZXRlQ29udGV4dCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9jb21wbGV0ZWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiafooYzlrqHmibnpooTop6PmnpBcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IOaJp+ihjOWuoeaJueS4iuS4i+aWh1xyXG4gICAgICovXHJcbiAgICBjb21wbGV0ZVNpbXVsYXRlKGNvbnRleHQ6IENvbXBsZXRlQ29udGV4dCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9jb21wbGV0ZS1zaW11bGF0aW9uYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlui3s+i9rOa0u+WKqOS/oeaBr1xyXG4gICAgICogQHBhcmFtIHdvcmtJdGVtSWQg5bel5L2c6aG5SWRcclxuICAgICAqIEBwYXJhbSBhY3Rpb24g5Yqo5L2c57yW5Y+3XHJcbiAgICAgKi9cclxuICAgIGdldERlc3RpbmF0aW9uU2NvcGUod29ya0l0ZW1JZDogc3RyaW5nLCBhY3Rpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L25leHROb2Rlcy8ke2FjdGlvbn1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7oioLngrlJROiOt+WPluaMh+WumuWPguS4juiAheeahOe7k+aenFxyXG4gICAgICogQHBhcmFtIHdvcmtJdGVtSWRcclxuICAgICAqIEBwYXJhbSBub2RlSWQg6K+05piO77yabm9kZUlkcz1bXCJub2RlMVwiLFwibm9kZTJcIizCt8K3wrddXHJcbiAgICAgKiBAcmV0dXJucyDmjIfmtL7kv6Hmga/nmoTmlbDnu4QgcmU6IEZsb3dOb2RlSW5mb1tdXHJcbiAgICAgKi9cclxuICAgIGdldFNpbXVsYXRpb25Bc3NpZ25lZUluZm8od29ya0l0ZW1JZDogc3RyaW5nLCBub2RlSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L3NpbXVsYXRpb24tYXNzaWduZWVJbmZvP25vZGVJZHM9WyR7bm9kZUlkfV1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiafooYzlvoHor6LjgIHnn6XkvJpcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IOS4iuS4i+aWh1xyXG4gICAgICovXHJcbiAgICBhZGRTaWduKGNvbnRleHQ6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9jb3VudGVyU2lnbkFkZGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlt7LpmIVcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IOWPguaVsFxyXG4gICAgICovXHJcbiAgICByZWFkVGFzayhjb250ZXh0OiBXb3JrSXRlbUV4ZWN1dGVQYXJhbSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9yZWFkYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOafpeivouWNleaNruS/oeaBr1xyXG4gICAgICogQHBhcmFtIHdvcmtJdGVtSWQg5bel5L2c6aG5SWRcclxuICAgICAqL1xyXG4gICAgZ2V0QXBwSW5mbyh3b3JrSXRlbUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IGZvcm1QYXJVcmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zLyR7d29ya0l0ZW1JZH0vZm9ybUluZm9gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KGZvcm1QYXJVcmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5oyH5rS+5L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gdGFza0lkIOW3peS9nOmhuUlkXHJcbiAgICAgKiDmraTmjqXlj6Plj6rov5Tlm57kuIDkuKpBc3NpZ25JbmZv57G75bqP5YiX5YyW5ZCO55qE5L+h5oGv77yM5LiN5piv5aSa5LiqXHJcbiAgICAgKi9cclxuICAgIGdldEFzc2lnbmVlSW5mbyh0YXNrSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3Rhc2tJZH0vYXNzaWduZWVJbmZvYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Yqg562+56e75Lqk6IyD5Zu06K6+572uXHJcbiAgICAgKiBAcGFyYW0gd29ya0l0ZW1JZFxyXG4gICAgICogQHBhcmFtIGFjdGlvbkNvZGVcclxuICAgICAqL1xyXG4gICAgZ2V0T3JnYW5pemF0aW9uU2NvcGUod29ya0l0ZW1JZDogc3RyaW5nLCBhY3Rpb25Db2RlOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvJHt3b3JrSXRlbUlkfS9vcmdhbml6YXRpb25TY29wZS8ke2FjdGlvbkNvZGV9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u5rWB56iL5a6e5L6LSUTlkozku7vliqHnirbmgIHlip7nkIbku7vliqFcclxuICAgICAqIEBwYXJhbSBwcm9jSW5zdElkIOa1geeoi+WunuS+i2lkXHJcbiAgICAgKiBAcGFyYW0gc3RhdGUg5Lu75Yqh54q25oCBIDLmiJY1XHJcbiAgICAgKi9cclxuICAgIGdldFRhc2tCeVByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nLCBzdGF0ZTogbnVtYmVyKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrcy9wcm9jZXNzSW5zdGFuY2VJZD9wcm9jSW5zdElkPSR7cHJvY0luc3RJZH0mc3RhdGU9JHtzdGF0ZX1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja53b3JraXRlbUlE6I635Y+W5Lu75Yqh5a6e5L2TXHJcbiAgICAgKiBAcGFyYW0gd29ya0l0ZW1JZFxyXG4gICAgICovXHJcbiAgICBnZXRUYXNrQnlXb3JrSXRlbUlkKHdvcmtJdGVtSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS90YXNrL3YxLjAvdGFza3Mvc291cmNlSWQvJHt3b3JrSXRlbUlkfWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruW3peS9nOmhuUlE5oyH5rS+5Lu75YqhXHJcbiAgICAgKiBAcGFyYW0gYXNzaWduZWVzUGEg5oyH5rS+5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIGFzc2lnbk5leHRVc2Vyc0J5V29ya0l0ZW1JZChhc3NpZ25lZXNQYTogQXNzaWduUGFyYW1ldGVyKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zL2Fzc2lnblVzZXJgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGFzc2lnbmVlc1BhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPluWbnlxyXG4gICAgICogQHBhcmFtIHdvcmtJdGVtSWQgdGFzayBpZFxyXG4gICAgICogQHBhcmFtIGNvbW1lbnQgY29tbWVudFxyXG4gICAgICovXHJcbiAgICByZXRyaWV2ZShjb250ZXh0OiB7IHdvcmtJdGVtSWQ6IHN0cmluZywgY29tbWVudD86IHN0cmluZyB9KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zL3JldHJpZXZlYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS7u+WKoeenu+S6pFxyXG4gICAgICogQHBhcmFtIHRhc2tJZCDlt6XkvZzpoblJZFxyXG4gICAgICogQHBhcmFtIHRhcmdldFVJZCDnm67moIfnlKjmiLdJZFxyXG4gICAgICovXHJcbiAgICB0cmFuc2Zlcih0cmFuc2ZlckNvbnRleHQ6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy90cmFuc2ZlcmA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgdHJhbnNmZXJDb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS7u+WKoeivhOiuulxyXG4gICAgICogQHBhcmFtIHRhc2tJZCDlt6XkvZzpoblJZFxyXG4gICAgICogQHBhcmFtIHRhcmdldFVJZCDnm67moIfnlKjmiLdJZFxyXG4gICAgICovXHJcbiAgICBjb21tZW50KGNvbW1lbnRDb250ZXh0OiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY29tbWVudGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29tbWVudENvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6aKG55So5Lu75YqhXHJcbiAgICAgKiBAcGFyYW0gdGFza0lkIOW3peS9nOmhuUlkXHJcbiAgICAgKi9cclxuICAgIGNsYWltKHRhc2tJZDogc3RyaW5nLCBjb21tZW50OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY2xhaW1gO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIHdvcmtJdGVtSWQ6IHRhc2tJZCxcclxuICAgICAgICAgICAgY29tbWVudDogY29tbWVudFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojpoobnlKhcclxuICAgICAqIEBwYXJhbSB0YXNrSWQg5Lu75YqhSWRcclxuICAgICAqL1xyXG4gICAgdW5DbGFpbSh0YXNrSWQ6IHN0cmluZywgY29tbWVudDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zL3VuY2xhaW1gO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIHdvcmtJdGVtSWQ6IHRhc2tJZCxcclxuICAgICAgICAgICAgY29tbWVudDogY29tbWVudFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiqXplJnmj5DnpLpcclxuICAgICAqIEBwYXJhbSBlcnJvclxyXG4gICAgICovXHJcbiAgICBlcnJvcihlcnJvcjogYW55KSB7XHJcbiAgICAgICAgaWYgKGVycm9yICYmIGVycm9yLmVycm9yICYmIGVycm9yLmVycm9yLk1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvci5lcnJvci5NZXNzYWdlO1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2Uud2FybmluZyhtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlkK/liqjmtYHnqIvmjqXlj6NcclxuICAgICAqIEBwYXJhbSBwYXlsb2FkIEFQSeaJgOmcgOeahOS4iuS4i+aWh+WPguaVsFxyXG4gICAgICovXHJcbiAgICBzdGFydFByb2Nlc3MocGF5bG9hZDogU3RhcnRQcm9jZXNzUGF5bG9hZCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvc3RhcnRQcm9jZXNzYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBwYXlsb2FkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWQr+WKqOa1geeoi+mihOino+aekFxyXG4gICAgICogQHBhcmFtIHBheWxvYWQgQVBJ5omA6ZyA55qE5LiK5LiL5paH5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIHN0YXJ0UHJvY2Vzc1NpbXVsYXRlKHBheWxvYWQ6IFN0YXJ0UHJvY2Vzc1BheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3N0YXJ0UHJvY2Vzcy1zaW11bGF0aW9uYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBwYXlsb2FkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPlua2iOaPkOS6pFxyXG4gICAgICogQHBhcmFtIHBhcmFtIOWPguaVsFxyXG4gICAgICovXHJcbiAgICBjYW5jZWxTdWJtaXQocGFyYW06IENhbmNlbFN1Ym1pdFBheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL2NhbmNlbFN1Ym1pdGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGFyYW0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBuZXdJZCgpIHtcclxuICAgICAgICBjb25zdCBTNCA9ICgpID0+ICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgICAgICByZXR1cm4gKFM0KCkgKyBTNCgpICsgJy0nICsgUzQoKSArICctJyArIFM0KCkgKyAnLScgKyBTNCgpICsgJy0nICsgUzQoKSArIFM0KCkgKyBTNCgpKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0Q29tbWVudExpc3QoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvY29tbW9uQ29tbWVudHNgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ29tbWVudCgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9jb21tb25Db21tZW50c2A7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwge30pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICAgKiDojrflj5bku7vliqHkuK3lv4PphY3nva7poblcclxuICAgICAgICogQHBhcmFtIGNvZGUg6YWN572u6aG555qEQ29kZVxyXG4gICAgICAgKi9cclxuICAgIGdldFRhc2tDZW50ZXJDb25maWdCeUNvZGUoY29kZTogc3RyaW5nLCBvd25lclR5cGU/OiBzdHJpbmcsIG93bmVySWQ/OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrLWNlbnRlci1zZXR0aW5nL2NvZGU/Y29kZT0ke2NvZGV9YDtcclxuICAgICAgICBvd25lclR5cGUgJiYgKHVybCArPSBgJm93bmVyVHlwZT0ke293bmVyVHlwZX1gKTtcclxuICAgICAgICBvd25lcklkICYmICh1cmwgKz0gYCZvd25lcklkPSR7b3duZXJJZH1gKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg55So5oi357qn5Yir6Ieq5a6a5LmJ6YWN572uXHJcbiAgICAgKiBAcGFyYW0gY29kZSDphY3nva7pobnnvJblj7dcclxuICAgICAqL1xyXG4gICAgYWRkVGFza0NlbnRlckNvbmZpZyhjb2RlOiBzdHJpbmcsIGN1cnJlbnRWYWx1ZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS90YXNrL3YxLjAvdGFzay1jZW50ZXItc2V0dGluZy9hZGQ/Y29uZmlnQ29kZT0ke2NvZGV9JmN1cnJlbnRWYWx1ZT0ke2N1cnJlbnRWYWx1ZX1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5YWo6YOo55So5oi357qn5Yir6YWN572uXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBnZXRBbGxVc2VyQ29uZmlnKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvdGFzay92MS4wL3Rhc2stY2VudGVyLXNldHRpbmcvYWxsYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog55yf5q2j5LiK5Lyg6ZmE5Lu2XHJcbiAgICAgKiBAcGFyYW0gZmlsZXNcclxuICAgICAqL1xyXG4gICAgdXBsb2FkQXR0YWNobWVudChmaWxlczogRmlsZVVwbG9hZEVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jL2NvbW1pdGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wdXQodXJsLCBmaWxlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaTpmYTku7ZcclxuICAgICAqIEBwYXJhbSBmaWxlRGVsZXRlRW50aXR5XHJcbiAgICAgKi9cclxuICAgIGRlbGV0ZUF0dGFjaG1lbnQoZmlsZURlbGV0ZUVudGl0eTogRmlsZURlbGV0ZUVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmRlbGV0ZSh1cmwsIGZpbGVEZWxldGVFbnRpdHkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog562+5ZCN5Zu+54mH77yM6ZmE5Lu255u45YWzXHJcbiAgICAgKi9cclxuICAgIHVwbG9hZFNpZ25hdHVyZShnc3BEb2NVcGxvYWRFbnRpdHk6IEdzcERvY1VwbG9hZEVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jYDtcclxuICAgICAgICBsZXQgaGVhZGVyID0gdGhpcy5odHRwU3ZjLnNldEhlYWRlcih7XHJcbiAgICAgICAgICAgIGJvZHk6IGdzcERvY1VwbG9hZEVudGl0eSxcclxuICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAndGV4dCdcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucmVxdWVzdCgnUG9zdCcsIHVybCwgaGVhZGVyKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIm+W7uuWGheeggVxyXG4gICAgICovXHJcbiAgICBjcmVhdGVOTSgpIHtcclxuICAgICAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICBjb25zdCByID0gTWF0aC5yYW5kb20oKSAqIDE2IHwgMCwgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7XHJcbiAgICAgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW9k+WJjeeUqOaIt+S/oeaBr1xyXG4gICAgICovXHJcbiAgICBnZXRVc2VySW5mbygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3N5cy92MS4wL3VzZXJpbmZvcz9pbmZvVHlwZT11c2VyYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W55So5oi35omA5pyJ562+5ZCNXHJcbiAgICAgKi9cclxuICAgIGdldFVzZXJTaWduKHVzZXJJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2ZpbGVpbmZvL2Zvcm0/Zm9ybWlkPSR7dXNlcklkfSZyb290aWQ9dGFza2NlbnRlcnNpZ25hdHVyZWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDop6PmnpDmlofku7bnsbvlnovvvIznu5nlh7rnvKnnlaXlm75cclxuICAgICAqIEBwYXJhbSBhdHRhY2htZW50SW5mb1xyXG4gICAgICovXHJcbiAgICBjcmVhdGVJdGVtKGF0dGFjaG1lbnRJbmZvOiBhbnkpIHtcclxuICAgICAgICB2YXIgcG9zID0gYXR0YWNobWVudEluZm8uZmlsZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpO1xyXG4gICAgICAgIHZhciB0eXBlID0gYXR0YWNobWVudEluZm8uZmlsZU5hbWUuc3Vic3RyaW5nKHBvcyArIDEpO1xyXG4gICAgICAgIHR5cGUgPSAodHlwZSA9PSAnJyA/ICdEZWZhdWx0JyA6IHR5cGUudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgdmFyIGRvY0xpYiA9ICdkb2MtZG9jeC1odG0taHRtbC1qcy1wZGYtcHB0LXBwdHgtcmFyLXppcC10eHQteGxzLXhsc3gnO1xyXG4gICAgICAgIHZhciB2aWRlb0xpYiA9ICd3YXYtYWlmLWFpZmYtYXUtbXAxLW1wMi1tcDMtcmEtcm0tcmFtLW1pZC1ybWknO1xyXG4gICAgICAgIHZhciBhdWRpb0xpYiA9ICdhdmktcm0tcm12Yi1tcGVnLW1wZy1kYXQtbW92LXF0LWFzZi13bS1tcDQnO1xyXG4gICAgICAgIHZhciBpbWdMaWIgPSAnd2VicC1iYWlibXAtZHVwY3gtdGlmLWdpZi1qcGVnLXRnYS1leGlmLWZweC1zdmctcHNkLWNkci1wY2QtZHhmLXVmby1lcHMtYWktcG5nLWhkcmktcmF3LXdtZi1mbGljLWVtZi1pY28tanBnJztcclxuICAgICAgICBpZiAoZG9jTGliLmluZGV4T2YodHlwZSkgPj0gMCkge1xyXG4gICAgICAgICAgICB0eXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodmlkZW9MaWIuaW5kZXhPZih0eXBlKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAndmlkZW8nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYXVkaW9MaWIuaW5kZXhPZih0eXBlKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnYXVkaW8nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW1nTGliLmluZGV4T2YodHlwZSkgPj0gMCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJ3BpY3R1cmUnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnZGVmYXVsdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5rOo5YaM5Li76aKY77yM5bm26I635Y+W5b2T5YmN5Li76aKY5ZSv5LiA5qCH6K+GdG9rZW5cclxuICAgICAqIEBwYXJhbSBzdWJqZWN0Q29kZSDkuLvpopjnvJbnoIHvvIzpnZ7llK/kuIDmoIfor4bvvIx0b2tlbuS4uuWUr+S4gOagh+ivhlxyXG4gICAgICogQHBhcmFtIHRva2VuIOS4u+mimOWUr+S4gOagh+ivhuOAglxyXG4gICAgICogQHJldHVybnMg5Li76aKY55qE5ZSv5LiA5qCH6K+G44CCXHJcbiAgICAgKi9cclxuICAgIHN1YmplY3RSZWdpc3RlcihzdWJqZWN0Q29kZTogc3RyaW5nLCB0b2tlbjogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuICh3aW5kb3cgYXMgYW55KS5nc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5icm9hZGNhc3Quc3ViamVjdFJlZ2lzdGVyKHN1YmplY3RDb2RlLCB7IGZ1bmNJZDogdG9rZW4gfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpgJrov4fmn5DkuKp0b2tlbuWPkemAgea2iOaBr1xyXG4gICAgICogQHBhcmFtIHN1YmplY3RUb2tlbiDkuLvpopjllK/kuIDnmoR0b2tlbuagh+ivhlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2Ug6KaB5Y+R6YCB55qE5raI5oGvXHJcbiAgICAgKi9cclxuICAgIHN1YmplY3ROb3RpZnkoc3ViamVjdFRva2VuOiBzdHJpbmcsIG1lc3NhZ2U6IGFueSkge1xyXG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5nc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5icm9hZGNhc3Qubm90aWZ5KHN1YmplY3RUb2tlbiwgbWVzc2FnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDop4Llr5/ogIXvvIzlubbnm5HlkKzmtojmga9cclxuICAgICAqIEBwYXJhbSBzdWJqZWN0VG9rZW4g5Li76aKYdG9rZW5cclxuICAgICAqIEBwYXJhbSBvYnNlcnZlclRva2VuIOW9k+WJjeebkeWQrOS4u+mimOeahOinguWvn+iAheWUr+S4gOagh+ivhnRva2Vu44CC5q2k5aSE5Zu65a6aXHJcbiAgICAgKiBAcGFyYW0gaGFuZGxlciDnm5HlkKzliLDmtojmga/lkI7miafooYznmoTliqjkvZxcclxuICAgICAqL1xyXG4gICAgc3ViamVjdFJlc3BvbnNlKHN1YmplY3RUb2tlbjogc3RyaW5nLCBvYnNlcnZlclRva2VuOiBzdHJpbmcsIGhhbmRsZXI6ICh2YWx1ZTogYW55KSA9PiB2b2lkKSB7XHJcbiAgICAgICAgKHdpbmRvdyBhcyBhbnkpLmdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmJyb2FkY2FzdC5yZXNwb25zZShzdWJqZWN0VG9rZW4sIG9ic2VydmVyVG9rZW4sIGhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5YKs5Yqe5qih5ouf57uT5p6cXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDlj4LmlbBcclxuICAgICAqIEByZXR1cm5zXHJcbiAgICAgKi9cclxuICAgIHVyZ2VIYW5kbGVTaW11bGF0ZShjb250ZXh0OiBVcmdlSGFuZGxlU2ltdWxhdGVDb250ZXh0KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvZ2V0VXJnZUhhbmRsZUluZm9gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omn6KGM5YKs5YqeXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDlj4LmlbBcclxuICAgICAqIEByZXR1cm5zXHJcbiAgICAgKi9cclxuICAgIHVyZ2VIYW5kbGUoY29udGV4dDogVXJnZUhhbmRsZUNvbnRleHQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy91cmdlSGFuZGxlYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKirmibnph4/mlbDlrZfnrb7lkI1cclxuICAgICAqIEBwYXJhbSBjb250ZXh0IOWPguaVsFxyXG4gICAgICovXHJcbiAgICBiYXRjaFZlcmlmeVNpZ25lZChjb250ZXh0OiBCYXRjaFZlcmlmeVNpZ25lZENvbnRleHQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvYmF0Y2hWZXJpZnlTaWduZWRgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W55So5oi35biu5Yqp5YmN56uv6YWN572uXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgZ2V0V2ZVc2VySGVscENvbmZpZygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvcGxhdGZvcm0vcnVudGltZS93Zi93ZWIvd2YtdXNlci1oZWxwL2NvbmZpZy5qc29uP3Y9YCArIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bliqDnrb7phY3nva5cclxuICAgICAqL1xyXG4gICAgZ2V0QWRob2NDb25maWcod29ya0l0ZW1JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L2FkaG9jQ29uZmlnL0FkZFNpZ25CZWhpbmRgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWKoOetvuaPkOS6pFxyXG4gICAgICovXHJcbiAgICBhZGhvY0Fzc2lnbmVlKHBheWxvYWQ6IEFkZFNpZ25QYXlsb2FkKSB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvYWRob2NBc3NpZ25lZWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWPlua2iOW+geivolxyXG4gICAgICovXHJcbiAgICBjYW5jZWxDb25zdWx0KHBheWxvYWQ6IFdvcmtJdGVtRXhlY3V0ZVBhcmFtKSB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY2FuY2VsQ29uc3VsdGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcbn1cclxuIl19