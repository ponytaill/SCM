/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef, ComponentFactoryResolver, Injector } from '@angular/core';
import { PerformerUIState } from './performer.uistate';
import { PerformerRepository } from './performer.repository';
import { PerformerViewModel } from './performer.viewmodel';
import { FormBuilder } from '@angular/forms';
import { BsModalService } from '@farris/ui-modal';
import { PerformerEditComponent } from './views/performer-edit/performer-edit.component';
import { MessagerService } from '@farris/ui-messager';
import { PerformerOptionsComponent } from './views/performer-options/performer-options.component';
import { DialogComponent } from '@farris/ui-dialog';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { ExpressionService, InjectedType, ExprEditMode } from '@gsp-svc/expression';
import { PerformerInfo } from './entities/performer-info.entity';
import { DatagridComponent } from '@farris/ui-datagrid';
import { of } from 'rxjs';
import { HttpService } from '@ecp-caf/caf-common';
export class PerformerComponent {
    // 编辑状态，用于区分是新增还是编辑  new | edit
    /**
     * @param {?} viewModel
     * @param {?} uistate
     * @param {?} formBuilder
     * @param {?} resolver
     * @param {?} injector
     * @param {?} modalService
     * @param {?} message
     * @param {?} designerUIState
     * @param {?} expr
     * @param {?} http
     */
    constructor(viewModel, uistate, formBuilder, resolver, injector, modalService, message, designerUIState, expr, http) {
        this.viewModel = viewModel;
        this.uistate = uistate;
        this.formBuilder = formBuilder;
        this.resolver = resolver;
        this.injector = injector;
        this.modalService = modalService;
        this.message = message;
        this.designerUIState = designerUIState;
        this.expr = expr;
        this.http = http;
        this.cls = 'farris-main-area flex-column';
        this.display = true; // 控制矩阵参与者是否显示
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.isClose = true;
        this.modalConfig = {
            title: '参与者',
            width: 800,
            height: 515,
            showButtons: true
        };
        this.columns = [
            {
                field: 'type', width: 50, title: '类型',
                formatter: {
                    type: 'enum',
                    options: { valueField: 'value', textField: 'text', data: this.uistate.typeCollection }
                }
            },
            { field: 'performerName', width: 50, title: '名称' },
            { field: 'description', width: 100, title: '描述', showTips: true },
            {
                field: 'condition', width: 60, title: '启用条件', showTips: true,
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        (e) => {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        (e) => {
                            if (e.rowData.type === 'wf.ComponentParticipant') {
                                /** @type {?} */
                                const i = this.uistate.performerInfo.components.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                item => item.id === e.rowData.id));
                                this.uistate.performerInfo.components[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.ReportingLineParticipant') {
                                /** @type {?} */
                                const i = this.uistate.performerInfo.reportingLines.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                item => item.id === e.rowData.id));
                                this.uistate.performerInfo.reportingLines[i].condition = '';
                            }
                            else if (e.rowData.type === 'wf.MatrixParticipant') {
                                /** @type {?} */
                                const i = this.uistate.performerInfo.matrixParticipants.findIndex((/**
                                 * @param {?} item
                                 * @return {?}
                                 */
                                item => item.id === e.rowData.id));
                                this.uistate.performerInfo.matrixParticipants[i].condition = '';
                            }
                        })
                    }
                }
            }
        ];
        this.editState = 'new'; // 编辑状态，用于区分是新增还是编辑  new | edit
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        (rowIndex, rowData, column) => {
            return of(true);
        });
        this.GetOrganizationType();
    }
    /**
     * @param {?} partInfo
     * @return {?}
     */
    set value(partInfo) {
        if (partInfo.performers && partInfo.performers.length > 0) {
            this.uistate.performerInfo.performers = partInfo.performers;
            this.uistate.performersList = this.uistate.performersList.concat((/** @type {?} */ (partInfo.performers)));
            this.uistate.performersList.map((/**
             * @param {?} performer
             * @return {?}
             */
            performer => performer.description = this.performerDescription((/** @type {?} */ (performer)))));
        }
        if (partInfo.components && partInfo.components.length > 0) {
            this.uistate.performerInfo.components = partInfo.components;
            partInfo.components.forEach((/**
             * @param {?} cmp
             * @return {?}
             */
            cmp => {
                this.uistate.performersList.push({
                    id: cmp.id,
                    type: 'wf.ComponentParticipant',
                    performerName: cmp.name,
                    description: this.componentDescription(cmp),
                    condition: cmp.condition
                });
            }));
        }
        if (partInfo.reportingLines && partInfo.reportingLines.length > 0) {
            this.uistate.performerInfo.reportingLines = partInfo.reportingLines;
            partInfo.reportingLines.forEach((/**
             * @param {?} r
             * @return {?}
             */
            r => {
                this.uistate.performersList.push({
                    id: r.id,
                    type: 'wf.ReportingLineParticipant',
                    performerName: r.reportingLineDefName + '-' + r.dimension,
                    description: this.reportingLineDescription(r),
                    condition: r.condition
                });
            }));
        }
        if (partInfo.matrixParticipants && partInfo.matrixParticipants.length > 0) {
            this.uistate.performerInfo.matrixParticipants = partInfo.matrixParticipants;
            partInfo.matrixParticipants.forEach((/**
             * @param {?} r
             * @return {?}
             */
            r => {
                this.uistate.performersList.push({
                    id: r.id,
                    type: 'wf.MatrixParticipant',
                    performerName: r.matrixDefName + '-' + r.dataFieldAlias,
                    description: this.matrixDescription(r),
                    condition: r.condition
                });
            }));
        }
        if (partInfo.options) {
            this.uistate.performerInfo.options = partInfo.options;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.getMatrixConfig().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        re => {
            if (re && re.currentValue === 'false') {
                this.display = false;
            }
        }));
    }
    /**
     * @return {?}
     */
    add() {
        this.editState = 'new';
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
        this.compRef = compFactory.create(this.injector);
        this.compRef.instance.display = this.display;
        /** @type {?} */
        const modalConfig = {
            title: '参与者选择',
            width: 800,
            height: 515,
            buttons: this.editFooter,
            showButtons: true
        };
        this.editDialog = this.modalService.show(this.compRef, modalConfig);
    }
    /**
     * @return {?}
     */
    edit() {
        this.editState = 'edit';
        if (this.uistate.curPerformer) {
            /** @type {?} */
            const modalConfig = {
                title: '参与者选择',
                width: 800,
                height: 515,
                buttons: this.editFooter,
                showButtons: true
            };
            /** @type {?} */
            const compFactory = this.resolver.resolveComponentFactory(PerformerEditComponent);
            this.compRef = compFactory.create(this.injector);
            switch (this.uistate.curPerformer.type) {
                case 'wf.PositionParticipant':
                    this.compRef.instance.performer = {
                        type: 'wf.PositionParticipant',
                        value: this.uistate.performerInfo.performers.find((/**
                         * @param {?} p
                         * @return {?}
                         */
                        p => p.id === this.uistate.curPerformer.id))
                    };
                    break;
                case 'wf.UserParticipant':
                    this.compRef.instance.performer = {
                        type: 'wf.UserParticipant',
                        value: this.uistate.performerInfo.performers.find((/**
                         * @param {?} p
                         * @return {?}
                         */
                        p => p.id === this.uistate.curPerformer.id))
                    };
                    break;
                case 'wf.ReportingLineParticipant':
                    /** @type {?} */
                    const reportingLine = this.uistate.performerInfo.reportingLines.find((/**
                     * @param {?} r
                     * @return {?}
                     */
                    r => {
                        return r.id === this.uistate.curPerformer.id;
                    }));
                    this.compRef.instance.performer = {
                        type: 'wf.ReportingLineParticipant',
                        value: reportingLine
                    };
                    /** @type {?} */
                    const url = '/api/runtime/wf/v1.0/reportingLineDefinitions/' + reportingLine.reportingLineDefId;
                    this.http.get(url).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    (res) => {
                        if (!res) {
                            this.message.error('该条汇报关系数据的定义已删除，该条数据将删除');
                            this.remove();
                        }
                        else {
                            this.editDialog = this.modalService.show(this.compRef, modalConfig);
                        }
                    }));
                    break;
                case 'wf.MatrixParticipant':
                    /** @type {?} */
                    const matrix = this.uistate.performerInfo.matrixParticipants.find((/**
                     * @param {?} r
                     * @return {?}
                     */
                    r => {
                        return r.id === this.uistate.curPerformer.id;
                    }));
                    this.compRef.instance.performer = {
                        type: 'wf.MatrixParticipant',
                        value: matrix
                    };
                    /** @type {?} */
                    const urlMatrix = '/api/runtime/wf/v1.0/matrixDefinition/' + matrix.matrixDefId;
                    this.http.get(urlMatrix).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    (res) => {
                        if (!res) {
                            this.message.error('该条矩阵数据的定义已删除，该条数据将删除');
                            this.remove();
                        }
                        else {
                            this.editDialog = this.modalService.show(this.compRef, modalConfig);
                        }
                    }));
                    break;
                case 'wf.ComponentParticipant':
                    this.compRef.instance.performer = {
                        type: 'wf.ComponentParticipant',
                        value: this.uistate.performerInfo.components.find((/**
                         * @param {?} c
                         * @return {?}
                         */
                        c => {
                            return c.id === this.uistate.curPerformer.id;
                        }))
                    };
                    break;
            }
            if (this.uistate.curPerformer.type !== 'wf.ReportingLineParticipant' &&
                this.uistate.curPerformer.type !== 'wf.MatrixParticipant') { // 汇报关系和矩阵单独处理
                this.editDialog = this.modalService.show(this.compRef, modalConfig);
            }
        }
    }
    /**
     * @return {?}
     */
    remove() {
        if (this.grid.selectedRow) {
            this.grid.endCellEdit();
            if (this.grid.selectedRow.data.type === 'wf.ComponentParticipant') {
                /** @type {?} */
                const i = this.uistate.performerInfo.components.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === this.grid.selectedRow.data.id));
                this.uistate.performerInfo.components.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.ReportingLineParticipant') {
                /** @type {?} */
                const i = this.uistate.performerInfo.reportingLines.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === this.grid.selectedRow.data.id));
                this.uistate.performerInfo.reportingLines.splice(i, 1);
            }
            else if (this.grid.selectedRow.data.type === 'wf.MatrixParticipant') {
                /** @type {?} */
                const i = this.uistate.performerInfo.matrixParticipants.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === this.grid.selectedRow.data.id));
                this.uistate.performerInfo.matrixParticipants.splice(i, 1);
            }
            else {
                /** @type {?} */
                const i = this.uistate.performerInfo.performers.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === this.grid.selectedRow.data.id));
                this.uistate.performerInfo.performers.splice(i, 1);
            }
            /** @type {?} */
            const index = this.uistate.performersList.findIndex((/**
             * @param {?} p
             * @return {?}
             */
            p => p.id === this.grid.selectedRow.data.id));
            this.uistate.performersList.splice(index, 1);
            this.grid.loadData(this.uistate.performersList);
        }
        else {
            this.message.info('请先选中一条参与者信息！');
        }
    }
    /**
     * @return {?}
     */
    clear() {
        this.uistate.performerInfo.performers = [];
        this.uistate.performerInfo.components = [];
        this.uistate.performerInfo.reportingLines = [];
        this.uistate.performerInfo.matrixParticipants = [];
        this.uistate.performersList = [];
        this.grid.loadData(this.uistate.performersList);
    }
    /**
     * @return {?}
     */
    clickOK() {
        this.grid.endCellEdit();
        /** @type {?} */
        const object = {
            value: this.uistate.performerInfo, parameters: null
        };
        this.submitModal.emit(object);
    }
    /**
     * @return {?}
     */
    clickCancel() {
        this.closeModal.emit();
    }
    /**
     * @return {?}
     */
    editOK() {
        if (this.compRef) {
            /** @type {?} */
            const re = this.compRef.instance.getPerformers();
            if (re.userPerformers && re.userPerformers.length > 0) {
                re.userPerformers.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => {
                    /** @type {?} */
                    const i = this.uistate.performerInfo.performers.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    a => (a.id === p.id || a.performerId === p.performerId)));
                    if (i > -1) {
                        /** @type {?} */
                        const id = this.uistate.performerInfo.performers[i].id;
                        this.uistate.performerInfo.performers[i] = p;
                        /** @type {?} */
                        const index = this.uistate.performersList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        a => a.id === id));
                        this.uistate.performersList[index] = p;
                    }
                    else {
                        if (this.editState === 'edit') {
                            this.remove();
                        }
                        this.uistate.performerInfo.performers.push(p);
                        this.uistate.performersList = this.uistate.performersList.concat([p]);
                    }
                }));
                this.uistate.performersList
                    .filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.type === this.uistate.typeCollection[0].value || p.type === this.uistate.typeCollection[1].value))
                    .map((/**
                 * @param {?} performer
                 * @return {?}
                 */
                performer => performer.description =
                    this.performerDescription((/** @type {?} */ (performer)))));
            }
            if (re.positionPerformers && re.positionPerformers.length > 0) {
                re.positionPerformers.forEach((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => {
                    // (1)id一致，为编辑岗位；（2）performid一致，新增的用户，岗位已存在
                    /** @type {?} */
                    const i = this.uistate.performerInfo.performers.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    a => (a.id === p.id || a.performerId === p.performerId)));
                    if (i > -1) {
                        /** @type {?} */
                        const id = this.uistate.performerInfo.performers[i].id;
                        this.uistate.performerInfo.performers[i] = p;
                        /** @type {?} */
                        const index = this.uistate.performersList.findIndex((/**
                         * @param {?} a
                         * @return {?}
                         */
                        a => a.id === id));
                        this.uistate.performersList[index] = p;
                    }
                    else {
                        this.uistate.performerInfo.performers.push(p);
                        this.uistate.performersList = this.uistate.performersList.concat([p]);
                    }
                }));
                this.uistate.performersList
                    .filter((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.type === this.uistate.typeCollection[0].value || p.type === this.uistate.typeCollection[1].value))
                    .map((/**
                 * @param {?} performer
                 * @return {?}
                 */
                performer => performer.description =
                    this.performerDescription((/** @type {?} */ (performer)))));
            }
            if (re.component && re.component.metadataId && re.component.methodCode) {
                /** @type {?} */
                const i = this.uistate.performerInfo.components.findIndex((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => a.id === re.component.id));
                if (i > -1) {
                    this.uistate.performerInfo.components[i] = re.component;
                    /** @type {?} */
                    const index = this.uistate.performersList.findIndex((/**
                     * @param {?} a
                     * @return {?}
                     */
                    a => a.id === re.component.id));
                    this.uistate.performersList[index] = {
                        id: re.component.id,
                        type: 'wf.ComponentParticipant',
                        performerName: re.component.name,
                        description: this.componentDescription(re.component),
                        condition: re.component.condition
                    };
                }
                else {
                    this.uistate.performerInfo.components.push(re.component);
                    this.uistate.performersList.push({
                        id: re.component.id,
                        type: 'wf.ComponentParticipant',
                        performerName: re.component.name,
                        description: this.componentDescription(re.component),
                        condition: ''
                    });
                }
            }
            if (re.reportingLine && re.reportingLine.reportingLineDefId && re.reportingLine.dimension) {
                if (re.reportingLine.reportingReferObject === 'dept' && !re.reportingLine.refOrgId) {
                    this.isClose = false;
                    this.message.info('“部门”汇报关系类型下，参照人所在部门不能为空');
                }
                else if (re.reportingLine.reportingReferObject !== 'dept' && !re.reportingLine.refUserId && !re.reportingLine.refEmployeeId) { // 用户及其他人员汇报对象类型，参照用户和参照员工不能全部为空
                    this.isClose = false;
                    this.message.info('“用户”汇报关系类型下，参照人不能为空');
                }
                else {
                    this.isClose = true;
                    this.addReportingLineData(re);
                }
            }
            if (re.matrix && re.matrix.matrixDefId) {
                if (!re.matrix.conditionField1 && !re.matrix.conditionField2 && !re.matrix.conditionField3) {
                    this.isClose = false;
                    this.message.info('条件字段至少要存在一个');
                }
                else if (!re.matrix.dataFieldAlias) {
                    this.isClose = false;
                    this.message.info('数据字段不能为空');
                }
                else {
                    this.isClose = true;
                    this.addMatrixData(re);
                }
            }
            this.grid.loadData(this.uistate.performersList);
        }
        if (this.editDialog && this.isClose) {
            this.editDialog.close();
        }
    }
    /**
     * @private
     * @param {?} re
     * @return {?}
     */
    addReportingLineData(re) {
        /** @type {?} */
        const i = this.uistate.performerInfo.reportingLines.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        a => a.id === re.reportingLine.id));
        if (i > -1) {
            this.uistate.performerInfo.reportingLines[i] = re.reportingLine;
            /** @type {?} */
            const index = this.uistate.performersList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            a => a.id === re.reportingLine.id));
            this.uistate.performersList[index] = {
                id: re.reportingLine.id,
                type: 'wf.ReportingLineParticipant',
                performerName: re.reportingLine.reportingLineDefName + '-' + re.reportingLine.dimension,
                description: this.reportingLineDescription(re.reportingLine),
                condition: re.reportingLine.condition
            };
        }
        else {
            for (const reportingLineData of this.uistate.performerInfo.reportingLines) {
                if (reportingLineData.reportingLineDefId === re.reportingLine.definitionId &&
                    reportingLineData.dimension === re.reportingLine.dimension &&
                    reportingLineData.refUserId === re.reportingLine.referUserId &&
                    reportingLineData.refEmployeeId === re.reportingLine.refEmployeeId &&
                    reportingLineData.refOrgId === re.reportingLine.referDeptId) {
                    this.message.error('该汇报关系已经进行过配置');
                    return;
                }
            }
            this.uistate.performerInfo.reportingLines.push(re.reportingLine);
            this.uistate.performersList.push({
                id: re.reportingLine.id,
                type: 'wf.ReportingLineParticipant',
                performerName: re.reportingLine.reportingLineDefName + '-' + re.reportingLine.dimension,
                description: this.reportingLineDescription(re.reportingLine),
                condition: re.reportingLine.condition
            });
        }
    }
    /**
     * @private
     * @param {?} re
     * @return {?}
     */
    addMatrixData(re) {
        /** @type {?} */
        const i = this.uistate.performerInfo.matrixParticipants.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        a => a.id === re.matrix.id));
        if (i > -1) {
            this.uistate.performerInfo.matrixParticipants[i] = re.matrix;
            /** @type {?} */
            const index = this.uistate.performersList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            a => a.id === re.matrix.id));
            this.uistate.performersList[index] = {
                id: re.matrix.id,
                type: 'wf.MatrixParticipant',
                performerName: re.matrix.matrixDefName + '-' + re.matrix.dataFieldAlias,
                description: this.matrixDescription(re.matrix),
                condition: re.matrix.condition
            };
        }
        else {
            for (const matrixData of this.uistate.performerInfo.matrixParticipants) {
                if (matrixData.matrixDefId === re.matrix.matrixDefId &&
                    matrixData.conditionField1 === re.matrix.conditionField1 &&
                    matrixData.conditionField2 === re.matrix.conditionField2 &&
                    matrixData.conditionField3 === re.matrix.conditionField3 &&
                    matrixData.dataFieldAlias === re.matrix.dataFieldAlias) {
                    this.message.error('该矩阵已经进行过配置');
                    return;
                }
            }
            this.uistate.performerInfo.matrixParticipants.push(re.matrix);
            this.uistate.performersList.push({
                id: re.matrix.id,
                type: 'wf.MatrixParticipant',
                performerName: re.matrix.matrixDefName + '-' + re.matrix.dataFieldAlias,
                description: this.matrixDescription(re.matrix),
                condition: re.matrix.condition
            });
        }
    }
    /**
     * @return {?}
     */
    editCancel() {
        if (this.editDialog) {
            this.editDialog.close();
        }
    }
    /**
     * @return {?}
     */
    participantOptionsSet() {
        this.uistate.performerInfo.options = this.options.getPerformerOptions();
        this.optionsDialog.close();
    }
    /**
     * @private
     * @param {?} performer
     * @return {?}
     */
    performerDescription(performer) {
        if (performer.type === 'wf.UserParticipant') {
            if (performer.tag === 'expression') {
                return performer.performerId;
            }
            else {
                if (performer.orgName) {
                    return `部门：${performer.orgName}`;
                }
                else {
                    return '';
                }
            }
        }
        else if (performer.type === 'wf.PositionParticipant') {
            if (((/** @type {?} */ (performer))).positionType === '1') {
                if (performer.orgId) {
                    return `岗位类型：通用岗位，部门：${performer.orgId}`;
                }
                else {
                    return `岗位类型：通用岗位`;
                }
            }
            else if (((/** @type {?} */ (performer))).positionType === '0') {
                return '岗位类型：组织岗位';
            }
        }
    }
    /**
     * @private
     * @param {?} component
     * @return {?}
     */
    componentDescription(component) {
        /** @type {?} */
        let des = `构件：${component.name},参数：{`;
        if (component.actualParameters && component.actualParameters.length > 0) {
            component.actualParameters.forEach((/**
             * @param {?} p
             * @return {?}
             */
            p => {
                des += `${p.code}：${p.value}，`;
            }));
            des = des.substring(0, des.length - 1);
        }
        des += '}';
        return des;
    }
    /**
     * @private
     * @param {?} reportingLine
     * @return {?}
     */
    reportingLineDescription(reportingLine) {
        /** @type {?} */
        let description = '';
        if (reportingLine.refUserId) {
            description += `参照人：${reportingLine.refUserId}`;
        }
        if (reportingLine.refEmployeeId) {
            description += `参照人：${reportingLine.refEmployeeId}`;
        }
        if (reportingLine.refOrgId) {
            if (reportingLine.refUserId) {
                description += `，`;
            }
            if (reportingLine.refEmployeeId) {
                description += `，`;
            }
            description += `参照组织：${reportingLine.refOrgId}`;
        }
        return description;
    }
    /**
     * @private
     * @param {?} matrix
     * @return {?}
     */
    matrixDescription(matrix) {
        /** @type {?} */
        let description = '';
        if (matrix.conditionField1) {
            description += `条件1：${matrix.conditionFieldText1}，`;
        }
        if (matrix.conditionField2) {
            description += `条件2：${matrix.conditionFieldText2}，`;
        }
        if (matrix.conditionField3) {
            description += `条件3：${matrix.conditionFieldText3}，`;
        }
        if (matrix.dataFieldAlias) {
            description += `数据：${matrix.dataFieldAlias}，`;
        }
        return description.slice(0, description.length - 1);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    editConditon(e) {
        if (this.designerUIState.schemas.length > 0) {
            for (const schema of this.designerUIState.schemas) {
                this.expr.addSchema('Schema', schema);
            }
            if (this.designerUIState.schemas[0].entityTypes && this.designerUIState.schemas[0].entityTypes.length > 0) {
                /** @type {?} */
                const entityType = this.designerUIState.schemas[0].entityTypes[0];
                this.expr.addInjectedEntity(entityType.name, 'Schema', entityType.name, InjectedType.EntityType);
            }
        }
        /** @type {?} */
        const context = new Array();
        if (this.designerUIState.procInstContext.length > 0) {
            for (const variable of this.designerUIState.procInstContext) {
                context.push(variable);
            }
        }
        if (this.designerUIState.formalParameterContext.length > 0) {
            for (const variable of this.designerUIState.formalParameterContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (this.designerUIState.participantContext.length > 0) {
            for (const variable of this.designerUIState.participantContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (this.designerUIState.processVariableContext.length > 0) {
            for (const variable of this.designerUIState.processVariableContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (this.designerUIState.activityComponentContext.length > 0) {
            for (const variable of this.designerUIState.activityComponentContext) {
                if (!context.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.key === variable.key))) {
                    context.push(variable);
                }
            }
        }
        if (context.length > 0) {
            for (const v of context) {
                this.expr.addContext(v);
            }
        }
        this.expr.addExpressionText(e.instance.value);
        this.expr.setEditPattern(ExprEditMode.Conditional); // 默认打开简易表达式编辑器
        this.expr.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        (cond) => {
            if (this.grid.selectedRow.data.type === 'wf.ComponentParticipant') {
                this.uistate.performerInfo.components.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.id === this.grid.selectedRow.data.id)).condition = cond;
            }
            else if (this.grid.selectedRow.data.type === 'wf.ReportingLineParticipant') {
                this.uistate.performerInfo.reportingLines.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.id === this.grid.selectedRow.data.id)).condition = cond;
            }
            else if (this.grid.selectedRow.data.type === 'wf.MatrixParticipant') {
                this.uistate.performerInfo.matrixParticipants.find((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.id === this.grid.selectedRow.data.id)).condition = cond;
            }
            else {
                this.uistate.performerInfo.performers.find((/**
                 * @param {?} p
                 * @return {?}
                 */
                p => p.id === this.grid.selectedRow.data.id)).condition = cond;
            }
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
        }));
    }
    /**
     * @param {?} data
     * @return {?}
     */
    selectChanged(data) {
        this.uistate.curPerformer = data.data;
    }
    /**
     * @private
     * @return {?}
     */
    GetOrganizationType() {
        /** @type {?} */
        const url = '/api/runtime/sys/v1.0/authfields/globalauthfields';
        this.http.get(url)
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => this.designerUIState.orgTypeCollection = data.map((/**
         * @param {?} d
         * @return {?}
         */
        d => ({ value: d.id, text: d.name })))));
    }
    /**
     * @private
     * @return {?}
     */
    getMatrixConfig() {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/generalConfig/Is_EnableMatrix`;
        return this.http.get(url);
    }
}
PerformerComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-performer',
                template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 class=\"f-title-text\">\u53C2\u4E0E\u8005\u5217\u8868</h4>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n      <button class=\"btn btn-primary mr-2\" (click)=\"add()\">\u65B0\u589E</button>\r\n      <button class=\"btn btn-secondary mr-2\" [disabled]=\"(!uistate.curPerformer)\"\r\n      (click)=\"edit()\">\u7F16\u8F91</button>\r\n      <button class=\"btn btn-secondary mr-2\" (click)=\"remove()\">\u79FB\u9664</button>\r\n      <button class=\"btn btn-secondary mr-2\" (click)=\"clear()\">\u6E05\u7A7A</button>\r\n      <button class=\"btn btn-secondary\" (click)=\"participantOptions.show()\">\u53C2\u4E0E\u8005\u9009\u9879</button>\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"uistate.performersList\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" [afterEdit]=\"afterEdit\" (selectChanged)=\"selectChanged($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<ng-template #editFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"editOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"editCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<farris-dialog #participantOptions [buttons]=\"buttonRef\" [width]=\"500\" [height]=\"530\" [title]=\"'\u53C2\u4E0E\u8005\u9009\u9879'\">\r\n  <app-performer-options [options]=\"uistate.performerInfo.options\"></app-performer-options>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"participantOptionsSet()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"participantOptions.close()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                providers: [PerformerViewModel, PerformerRepository, PerformerUIState],
                styles: [""]
            }] }
];
/** @nocollapse */
PerformerComponent.ctorParameters = () => [
    { type: PerformerViewModel },
    { type: PerformerUIState },
    { type: FormBuilder },
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: BsModalService },
    { type: MessagerService },
    { type: ProcessDesignerUIState },
    { type: ExpressionService },
    { type: HttpService }
];
PerformerComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
    editFooter: [{ type: ViewChild, args: ['editFooter',] }],
    options: [{ type: ViewChild, args: [PerformerOptionsComponent,] }],
    optionsDialog: [{ type: ViewChild, args: ['participantOptions',] }],
    grid: [{ type: ViewChild, args: [DatagridComponent,] }],
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    editorParams: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    PerformerComponent.prototype.cls;
    /** @type {?} */
    PerformerComponent.prototype.display;
    /** @type {?} */
    PerformerComponent.prototype.modalFooter;
    /** @type {?} */
    PerformerComponent.prototype.editFooter;
    /** @type {?} */
    PerformerComponent.prototype.options;
    /** @type {?} */
    PerformerComponent.prototype.optionsDialog;
    /** @type {?} */
    PerformerComponent.prototype.grid;
    /** @type {?} */
    PerformerComponent.prototype.closeModal;
    /** @type {?} */
    PerformerComponent.prototype.submitModal;
    /** @type {?} */
    PerformerComponent.prototype.editorParams;
    /** @type {?} */
    PerformerComponent.prototype.editDialog;
    /** @type {?} */
    PerformerComponent.prototype.compRef;
    /** @type {?} */
    PerformerComponent.prototype.isClose;
    /** @type {?} */
    PerformerComponent.prototype.modalConfig;
    /** @type {?} */
    PerformerComponent.prototype.columns;
    /** @type {?} */
    PerformerComponent.prototype.curPerformer;
    /** @type {?} */
    PerformerComponent.prototype.editState;
    /** @type {?} */
    PerformerComponent.prototype.afterEdit;
    /** @type {?} */
    PerformerComponent.prototype.viewModel;
    /** @type {?} */
    PerformerComponent.prototype.uistate;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.designerUIState;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.expr;
    /**
     * @type {?}
     * @private
     */
    PerformerComponent.prototype.http;
}
export class PerformerConverter {
    constructor() { }
    /**
     * @param {?} data
     * @return {?}
     */
    convertTo(data) {
        if ((data.performers && data.performers.length > 0)
            || (data.components && data.components.length > 0)
            || (data.reportingLines && data.reportingLines.length > 0)
            || (data.matrixParticipants && data.matrixParticipants.length > 0)) {
            return '（已设置）';
        }
        else {
            return '（未设置）';
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGVyZm9ybWVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3MvcGVyZm9ybWVyL3BlcmZvcm1lci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFnQixNQUFNLGVBQWUsQ0FBQztBQUV0SyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDN0MsT0FBTyxFQUFFLGNBQWMsRUFBYyxNQUFNLGtCQUFrQixDQUFDO0FBQzlELE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLGlEQUFpRCxDQUFDO0FBQ3pGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSx1REFBdUQsQ0FBQztBQUNsRyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFcEQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVwRixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDakUsT0FBTyxFQUFjLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEUs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bkluaXQsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IsIENvbXBvbmVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUeXBlQ29udmVydGVyIH0gZnJvbSAnQGZhcnJpcy91aS1wcm9wZXJ0eS1wYW5lbCc7XHJcbmltcG9ydCB7IFBlcmZvcm1lclVJU3RhdGUgfSBmcm9tICcuL3BlcmZvcm1lci51aXN0YXRlJztcclxuaW1wb3J0IHsgUGVyZm9ybWVyUmVwb3NpdG9yeSB9IGZyb20gJy4vcGVyZm9ybWVyLnJlcG9zaXRvcnknO1xyXG5pbXBvcnQgeyBQZXJmb3JtZXJWaWV3TW9kZWwgfSBmcm9tICcuL3BlcmZvcm1lci52aWV3bW9kZWwnO1xyXG5pbXBvcnQgeyBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UsIEJzTW9kYWxSZWYgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgUGVyZm9ybWVyRWRpdENvbXBvbmVudCB9IGZyb20gJy4vdmlld3MvcGVyZm9ybWVyLWVkaXQvcGVyZm9ybWVyLWVkaXQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFBlcmZvcm1lck9wdGlvbnNDb21wb25lbnQgfSBmcm9tICcuL3ZpZXdzL3BlcmZvcm1lci1vcHRpb25zL3BlcmZvcm1lci1vcHRpb25zLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGlhbG9nJztcclxuaW1wb3J0IHsgUGVyZm9ybWVyRW50aXR5IH0gZnJvbSAnLi9lbnRpdGllcy9wZXJmb3JtZXIuZW50aXR5JztcclxuaW1wb3J0IHsgUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSB9IGZyb20gJy4uLy4uL2FwcC9wcm9jZXNzLWRlc2lnbmVyLnVpc3RhdGUnO1xyXG5pbXBvcnQgeyBFeHByZXNzaW9uU2VydmljZSwgSW5qZWN0ZWRUeXBlLCBFeHByRWRpdE1vZGUgfSBmcm9tICdAZ3NwLXN2Yy9leHByZXNzaW9uJztcclxuaW1wb3J0IHsgUmVwb3J0aW5nTGluZURhdGFFbnRpdHkgfSBmcm9tICcuL3ZpZXdzL3JlcG9ydGluZy1saW5lL3JlcG9ydGluZy1saW5lLWRhdGEuZW50aXR5JztcclxuaW1wb3J0IHsgUGVyZm9ybWVySW5mbyB9IGZyb20gJy4vZW50aXRpZXMvcGVyZm9ybWVyLWluZm8uZW50aXR5JztcclxuaW1wb3J0IHsgRGF0YUNvbHVtbiwgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2Z9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBQb3NpdGlvblBlcmZvcm1lckVudGl0eSB9IGZyb20gJy4vZW50aXRpZXMvcG9zaXRpb24tcGVyZm9ybWVyLmVudGl0eSc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IENvbXBvbmVudFBlcmZvcm1lciB9IGZyb20gJy4vdmlld3MvY29tcG9uZW50LXBlcmZvcm1lci9jb21wb25lbnQtcGVyZm9ybWVyLmVudGl0eSc7XHJcbmltcG9ydCB7TWF0cml4RGF0YUluZm9FbnRpdHl9IGZyb20gJy4vdmlld3MvbWF0cml4LXBlcmZvcm1lci9lbnRpdGlzL21hdHJpeC1kYXRhLWluZm8uZW50aXR5JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLXBlcmZvcm1lcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3BlcmZvcm1lci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcGVyZm9ybWVyLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbUGVyZm9ybWVyVmlld01vZGVsLCBQZXJmb3JtZXJSZXBvc2l0b3J5LCBQZXJmb3JtZXJVSVN0YXRlXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUGVyZm9ybWVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJylcclxuICBjbHMgPSAnZmFycmlzLW1haW4tYXJlYSBmbGV4LWNvbHVtbic7XHJcblxyXG4gIGRpc3BsYXkgPSB0cnVlOyAvLyDmjqfliLbnn6npmLXlj4LkuI7ogIXmmK/lkKbmmL7npLpcclxuXHJcbiAgQFZpZXdDaGlsZCgnaWNvblNlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2VkaXRGb290ZXInKSBlZGl0Rm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoUGVyZm9ybWVyT3B0aW9uc0NvbXBvbmVudCkgb3B0aW9uczogUGVyZm9ybWVyT3B0aW9uc0NvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdwYXJ0aWNpcGFudE9wdGlvbnMnKSBvcHRpb25zRGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZChEYXRhZ3JpZENvbXBvbmVudCkgZ3JpZDogRGF0YWdyaWRDb21wb25lbnQ7XHJcblxyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHZhbHVlKHBhcnRJbmZvOiBQZXJmb3JtZXJJbmZvKSB7XHJcbiAgICBpZiAocGFydEluZm8ucGVyZm9ybWVycyAmJiBwYXJ0SW5mby5wZXJmb3JtZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVycyA9IHBhcnRJbmZvLnBlcmZvcm1lcnM7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdCA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdC5jb25jYXQocGFydEluZm8ucGVyZm9ybWVycyBhcyBhbnlbXSk7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdC5tYXAocGVyZm9ybWVyID0+IHBlcmZvcm1lci5kZXNjcmlwdGlvbiA9IHRoaXMucGVyZm9ybWVyRGVzY3JpcHRpb24ocGVyZm9ybWVyIGFzIGFueSkpO1xyXG4gICAgfVxyXG4gICAgaWYgKHBhcnRJbmZvLmNvbXBvbmVudHMgJiYgcGFydEluZm8uY29tcG9uZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLmNvbXBvbmVudHMgPSBwYXJ0SW5mby5jb21wb25lbnRzO1xyXG4gICAgICBwYXJ0SW5mby5jb21wb25lbnRzLmZvckVhY2goY21wID0+IHtcclxuICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QucHVzaCh7XHJcbiAgICAgICAgICBpZDogY21wLmlkLFxyXG4gICAgICAgICAgdHlwZTogJ3dmLkNvbXBvbmVudFBhcnRpY2lwYW50JyxcclxuICAgICAgICAgIHBlcmZvcm1lck5hbWU6IGNtcC5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuY29tcG9uZW50RGVzY3JpcHRpb24oY21wKSxcclxuICAgICAgICAgIGNvbmRpdGlvbjogY21wLmNvbmRpdGlvblxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGlmIChwYXJ0SW5mby5yZXBvcnRpbmdMaW5lcyAmJiBwYXJ0SW5mby5yZXBvcnRpbmdMaW5lcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzID0gcGFydEluZm8ucmVwb3J0aW5nTGluZXM7XHJcbiAgICAgIHBhcnRJbmZvLnJlcG9ydGluZ0xpbmVzLmZvckVhY2gociA9PiB7XHJcbiAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LnB1c2goe1xyXG4gICAgICAgICAgaWQ6IHIuaWQsXHJcbiAgICAgICAgICB0eXBlOiAnd2YuUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50JyxcclxuICAgICAgICAgIHBlcmZvcm1lck5hbWU6IHIucmVwb3J0aW5nTGluZURlZk5hbWUgKyAnLScgKyByLmRpbWVuc2lvbixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnJlcG9ydGluZ0xpbmVEZXNjcmlwdGlvbihyKSxcclxuICAgICAgICAgIGNvbmRpdGlvbjogci5jb25kaXRpb25cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAocGFydEluZm8ubWF0cml4UGFydGljaXBhbnRzICYmIHBhcnRJbmZvLm1hdHJpeFBhcnRpY2lwYW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm1hdHJpeFBhcnRpY2lwYW50cyA9IHBhcnRJbmZvLm1hdHJpeFBhcnRpY2lwYW50cztcclxuICAgICAgcGFydEluZm8ubWF0cml4UGFydGljaXBhbnRzLmZvckVhY2gociA9PiB7XHJcbiAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LnB1c2goe1xyXG4gICAgICAgICAgaWQ6IHIuaWQsXHJcbiAgICAgICAgICB0eXBlOiAnd2YuTWF0cml4UGFydGljaXBhbnQnLFxyXG4gICAgICAgICAgcGVyZm9ybWVyTmFtZTogci5tYXRyaXhEZWZOYW1lICsgJy0nICsgci5kYXRhRmllbGRBbGlhcyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLm1hdHJpeERlc2NyaXB0aW9uKHIpLFxyXG4gICAgICAgICAgY29uZGl0aW9uOiByLmNvbmRpdGlvblxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGlmIChwYXJ0SW5mby5vcHRpb25zKSB7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm9wdGlvbnMgPSBwYXJ0SW5mby5vcHRpb25zO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgZWRpdG9yUGFyYW1zID0ge307XHJcblxyXG4gIGVkaXREaWFsb2c6IEJzTW9kYWxSZWY7XHJcbiAgY29tcFJlZjogQ29tcG9uZW50UmVmPFBlcmZvcm1lckVkaXRDb21wb25lbnQ+O1xyXG4gIGlzQ2xvc2UgPSB0cnVlO1xyXG5cclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn5Y+C5LiO6ICFJyxcclxuICAgIHdpZHRoOiA4MDAsXHJcbiAgICBoZWlnaHQ6IDUxNSxcclxuICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgfTtcclxuICBjb2x1bW5zID0gW1xyXG4gICAge1xyXG4gICAgICBmaWVsZDogJ3R5cGUnLCB3aWR0aDogNTAsIHRpdGxlOiAn57G75Z6LJyxcclxuICAgICAgZm9ybWF0dGVyOiB7XHJcbiAgICAgICAgdHlwZTogJ2VudW0nLFxyXG4gICAgICAgIG9wdGlvbnM6IHsgdmFsdWVGaWVsZDogJ3ZhbHVlJywgdGV4dEZpZWxkOiAndGV4dCcsIGRhdGE6IHRoaXMudWlzdGF0ZS50eXBlQ29sbGVjdGlvbiB9XHJcbiAgICAgIH1cclxuICAgICB9LFxyXG4gICAgeyBmaWVsZDogJ3BlcmZvcm1lck5hbWUnLCB3aWR0aDogNTAsIHRpdGxlOiAn5ZCN56ewJyB9LFxyXG4gICAgeyBmaWVsZDogJ2Rlc2NyaXB0aW9uJywgd2lkdGg6IDEwMCwgdGl0bGU6ICfmj4/ov7AnLCBzaG93VGlwczogdHJ1ZSB9LFxyXG4gICAge1xyXG4gICAgICBmaWVsZDogJ2NvbmRpdGlvbicsIHdpZHRoOiA2MCwgdGl0bGU6ICflkK/nlKjmnaHku7YnLCBzaG93VGlwczogdHJ1ZSxcclxuICAgICAgZWRpdG9yOiB7XHJcbiAgICAgICAgdHlwZTogJ2lucHV0LWdyb3VwJyxcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBncm91cFRleHQ6ICc8aSBjbGFzcz1cImYtaWNvbiBmLWljb24tbG9va3VwXCI+PC9pPicsXHJcbiAgICAgICAgICBlZGl0YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICBjbGlja0hhbmRsZTogKGUpID0+IHtcclxuICAgICAgICAgICAgZS5mb3JtQ29udHJvbC5zZXRWYWx1ZShlLmluc3RhbmNlLnZhbHVlID8gZS5pbnN0YW5jZS52YWx1ZSA6ICcnKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0Q29uZGl0b24oZSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2xlYXI6IChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnJvd0RhdGEudHlwZSA9PT0gJ3dmLkNvbXBvbmVudFBhcnRpY2lwYW50Jykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5jb21wb25lbnRzLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGUucm93RGF0YS5pZCk7XHJcbiAgICAgICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8uY29tcG9uZW50c1tpXS5jb25kaXRpb24gPSAnJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLnJvd0RhdGEudHlwZSA9PT0gJ3dmLlJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudCcpIHtcclxuICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucmVwb3J0aW5nTGluZXMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gZS5yb3dEYXRhLmlkKTtcclxuICAgICAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5yZXBvcnRpbmdMaW5lc1tpXS5jb25kaXRpb24gPSAnJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLnJvd0RhdGEudHlwZSA9PT0gJ3dmLk1hdHJpeFBhcnRpY2lwYW50Jykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gZS5yb3dEYXRhLmlkKTtcclxuICAgICAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHNbaV0uY29uZGl0aW9uID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBdO1xyXG5cclxuICBjdXJQZXJmb3JtZXI6IGFueTtcclxuICBlZGl0U3RhdGUgPSAnbmV3JzsgLy8g57yW6L6R54q25oCB77yM55So5LqO5Yy65YiG5piv5paw5aKe6L+Y5piv57yW6L6RICBuZXcgfCBlZGl0XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHZpZXdNb2RlbDogUGVyZm9ybWVyVmlld01vZGVsLFxyXG4gICAgcHVibGljIHVpc3RhdGU6IFBlcmZvcm1lclVJU3RhdGUsXHJcbiAgICBwcml2YXRlIGZvcm1CdWlsZGVyOiBGb3JtQnVpbGRlcixcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGRlc2lnbmVyVUlTdGF0ZTogUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSxcclxuICAgIHByaXZhdGUgZXhwcjogRXhwcmVzc2lvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBTZXJ2aWNlLFxyXG4gICkge1xyXG4gICAgdGhpcy5HZXRPcmdhbml6YXRpb25UeXBlKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuZ2V0TWF0cml4Q29uZmlnKCkuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgaWYgKHJlICYmIHJlLmN1cnJlbnRWYWx1ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgIHRoaXMuZGlzcGxheSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgYWRkKCkge1xyXG4gICAgdGhpcy5lZGl0U3RhdGUgPSAnbmV3JztcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShQZXJmb3JtZXJFZGl0Q29tcG9uZW50KTtcclxuICAgIHRoaXMuY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIHRoaXMuY29tcFJlZi5pbnN0YW5jZS5kaXNwbGF5ID0gdGhpcy5kaXNwbGF5O1xyXG5cclxuICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogJ+WPguS4juiAhemAieaLqScsXHJcbiAgICAgIHdpZHRoOiA4MDAsXHJcbiAgICAgIGhlaWdodDogNTE1LFxyXG4gICAgICBidXR0b25zOiB0aGlzLmVkaXRGb290ZXIsXHJcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgICB9O1xyXG4gICAgdGhpcy5lZGl0RGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyh0aGlzLmNvbXBSZWYsIG1vZGFsQ29uZmlnKTtcclxuICB9XHJcbiAgZWRpdCgpIHtcclxuICAgIHRoaXMuZWRpdFN0YXRlID0gJ2VkaXQnXHJcbiAgICBpZiAodGhpcy51aXN0YXRlLmN1clBlcmZvcm1lcikge1xyXG4gICAgICBjb25zdCBtb2RhbENvbmZpZyA9IHtcclxuICAgICAgICB0aXRsZTogJ+WPguS4juiAhemAieaLqScsXHJcbiAgICAgICAgd2lkdGg6IDgwMCxcclxuICAgICAgICBoZWlnaHQ6IDUxNSxcclxuICAgICAgICBidXR0b25zOiB0aGlzLmVkaXRGb290ZXIsXHJcbiAgICAgICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICAgICAgfTtcclxuICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KFBlcmZvcm1lckVkaXRDb21wb25lbnQpO1xyXG4gICAgICB0aGlzLmNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgIHN3aXRjaCAodGhpcy51aXN0YXRlLmN1clBlcmZvcm1lci50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudCc6XHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudCcsXHJcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5wZXJmb3JtZXJzLmZpbmQocCA9PiBwLmlkID09PSB0aGlzLnVpc3RhdGUuY3VyUGVyZm9ybWVyLmlkKVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3dmLlVzZXJQYXJ0aWNpcGFudCc6XHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuVXNlclBhcnRpY2lwYW50JyxcclxuICAgICAgICAgICAgdmFsdWU6IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMudWlzdGF0ZS5jdXJQZXJmb3JtZXIuaWQpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnQnOlxyXG4gICAgICAgICAgY29uc3QgcmVwb3J0aW5nTGluZSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzLmZpbmQociA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByLmlkID09PSB0aGlzLnVpc3RhdGUuY3VyUGVyZm9ybWVyLmlkO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIHRoaXMuY29tcFJlZi5pbnN0YW5jZS5wZXJmb3JtZXIgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnQnLFxyXG4gICAgICAgICAgICB2YWx1ZTogcmVwb3J0aW5nTGluZVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvd2YvdjEuMC9yZXBvcnRpbmdMaW5lRGVmaW5pdGlvbnMvJyArIHJlcG9ydGluZ0xpbmUucmVwb3J0aW5nTGluZURlZklkO1xyXG4gICAgICAgICAgdGhpcy5odHRwLmdldCh1cmwpLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXMpIHtcclxuICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UuZXJyb3IoJ+ivpeadoeaxh+aKpeWFs+ezu+aVsOaNrueahOWumuS5ieW3suWIoOmZpO+8jOivpeadoeaVsOaNruWwhuWIoOmZpCcpXHJcbiAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICB0aGlzLmVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3dmLk1hdHJpeFBhcnRpY2lwYW50JzpcclxuICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm1hdHJpeFBhcnRpY2lwYW50cy5maW5kKHIgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gci5pZCA9PT0gdGhpcy51aXN0YXRlLmN1clBlcmZvcm1lci5pZDtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuTWF0cml4UGFydGljaXBhbnQnLFxyXG4gICAgICAgICAgICB2YWx1ZTogbWF0cml4XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY29uc3QgdXJsTWF0cml4ID0gJy9hcGkvcnVudGltZS93Zi92MS4wL21hdHJpeERlZmluaXRpb24vJyArIG1hdHJpeC5tYXRyaXhEZWZJZDtcclxuICAgICAgICAgIHRoaXMuaHR0cC5nZXQodXJsTWF0cml4KS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKCfor6XmnaHnn6npmLXmlbDmja7nmoTlrprkuYnlt7LliKDpmaTvvIzor6XmnaHmlbDmja7lsIbliKDpmaQnKVxyXG4gICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5lZGl0RGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyh0aGlzLmNvbXBSZWYsIG1vZGFsQ29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd3Zi5Db21wb25lbnRQYXJ0aWNpcGFudCc6XHJcbiAgICAgICAgICB0aGlzLmNvbXBSZWYuaW5zdGFuY2UucGVyZm9ybWVyID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnd2YuQ29tcG9uZW50UGFydGljaXBhbnQnLFxyXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8uY29tcG9uZW50cy5maW5kKGMgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiBjLmlkID09PSB0aGlzLnVpc3RhdGUuY3VyUGVyZm9ybWVyLmlkO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHRoaXMudWlzdGF0ZS5jdXJQZXJmb3JtZXIudHlwZSAhPT0gJ3dmLlJlcG9ydGluZ0xpbmVQYXJ0aWNpcGFudCcgJiZcclxuICAgICAgICB0aGlzLnVpc3RhdGUuY3VyUGVyZm9ybWVyLnR5cGUgIT09ICd3Zi5NYXRyaXhQYXJ0aWNpcGFudCcpeyAvLyDmsYfmiqXlhbPns7vlkoznn6npmLXljZXni6zlpITnkIZcclxuICAgICAgICB0aGlzLmVkaXREaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJlbW92ZSgpIHtcclxuICAgIGlmICh0aGlzLmdyaWQuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgdGhpcy5ncmlkLmVuZENlbGxFZGl0KCk7XHJcbiAgICAgIGlmICh0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS50eXBlID09PSAnd2YuQ29tcG9uZW50UGFydGljaXBhbnQnKSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLmNvbXBvbmVudHMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gdGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLmNvbXBvbmVudHMuc3BsaWNlKGksIDEpO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLnR5cGUgPT09ICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnQnKSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLmlkKTtcclxuICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5yZXBvcnRpbmdMaW5lcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEudHlwZSA9PT0gJ3dmLk1hdHJpeFBhcnRpY2lwYW50Jykge1xyXG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gdGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm1hdHJpeFBhcnRpY2lwYW50cy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gdGhpcy5ncmlkLnNlbGVjdGVkUm93LmRhdGEuaWQpO1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LmZpbmRJbmRleChwID0+IHAuaWQgPT09IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLmlkKTtcclxuICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LnNwbGljZShpbmRleCwgMSk7XHJcblxyXG4gICAgICB0aGlzLmdyaWQubG9hZERhdGEodGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfor7flhYjpgInkuK3kuIDmnaHlj4LkuI7ogIXkv6Hmga/vvIEnKTtcclxuICAgIH1cclxuICB9XHJcbiAgY2xlYXIoKSB7XHJcbiAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5wZXJmb3JtZXJzID0gW107XHJcbiAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5jb21wb25lbnRzID0gW107XHJcbiAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5yZXBvcnRpbmdMaW5lcyA9IFtdO1xyXG4gICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ubWF0cml4UGFydGljaXBhbnRzID0gW107XHJcbiAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QgPSBbXTtcclxuICAgIHRoaXMuZ3JpZC5sb2FkRGF0YSh0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QpO1xyXG4gIH1cclxuICBjbGlja09LKCkge1xyXG4gICAgdGhpcy5ncmlkLmVuZENlbGxFZGl0KCk7XHJcbiAgICBjb25zdCBvYmplY3QgPSB7XHJcbiAgICAgIHZhbHVlOiB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mbywgcGFyYW1ldGVyczogbnVsbFxyXG4gICAgfTtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gIH1cclxuICBjbGlja0NhbmNlbCgpIHtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgfVxyXG4gIGVkaXRPSygpIHtcclxuICAgIGlmICh0aGlzLmNvbXBSZWYpIHtcclxuICAgICAgY29uc3QgcmUgPSB0aGlzLmNvbXBSZWYuaW5zdGFuY2UuZ2V0UGVyZm9ybWVycygpO1xyXG4gICAgICBpZiAocmUudXNlclBlcmZvcm1lcnMgJiYgcmUudXNlclBlcmZvcm1lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJlLnVzZXJQZXJmb3JtZXJzLmZvckVhY2gocCA9PiB7XHJcbiAgICAgICAgICBjb25zdCBpID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVycy5maW5kSW5kZXgoYSA9PiAoYS5pZCA9PT0gcC5pZCB8fCBhLnBlcmZvcm1lcklkID09PSBwLnBlcmZvcm1lcklkKSk7XHJcbiAgICAgICAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVyc1tpXS5pZDtcclxuICAgICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVyc1tpXSA9IHA7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IGlkKTtcclxuICAgICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0W2luZGV4XSA9IHA7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0U3RhdGUgPT09ICdlZGl0Jykge1xyXG4gICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVycy5wdXNoKHApO1xyXG4gICAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QuY29uY2F0KFtwXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0XHJcbiAgICAgICAgICAuZmlsdGVyKHAgPT4gcC50eXBlID09PSB0aGlzLnVpc3RhdGUudHlwZUNvbGxlY3Rpb25bMF0udmFsdWUgfHwgcC50eXBlID09PSB0aGlzLnVpc3RhdGUudHlwZUNvbGxlY3Rpb25bMV0udmFsdWUgKVxyXG4gICAgICAgICAgLm1hcChwZXJmb3JtZXIgPT4gcGVyZm9ybWVyLmRlc2NyaXB0aW9uID1cclxuICAgICAgICAgICAgdGhpcy5wZXJmb3JtZXJEZXNjcmlwdGlvbihwZXJmb3JtZXIgYXMgYW55KSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJlLnBvc2l0aW9uUGVyZm9ybWVycyAmJiByZS5wb3NpdGlvblBlcmZvcm1lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJlLnBvc2l0aW9uUGVyZm9ybWVycy5mb3JFYWNoKHAgPT4ge1xyXG5cclxuICAgICAgICAgIC8vICgxKWlk5LiA6Ie077yM5Li657yW6L6R5bKX5L2N77yb77yIMu+8iXBlcmZvcm1pZOS4gOiHtO+8jOaWsOWinueahOeUqOaIt++8jOWyl+S9jeW3suWtmOWcqFxyXG4gICAgICAgICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnMuZmluZEluZGV4KGEgPT4gKGEuaWQgPT09IHAuaWQgfHwgYS5wZXJmb3JtZXJJZCA9PT0gcC5wZXJmb3JtZXJJZCkpO1xyXG4gICAgICAgICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICAgICAgICBjb25zdCBpZCA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnNbaV0uaWQ7XHJcbiAgICAgICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnNbaV0gPSBwO1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdC5maW5kSW5kZXgoYSA9PiBhLmlkID09PSBpZCk7XHJcbiAgICAgICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdFtpbmRleF0gPSBwO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucGVyZm9ybWVycy5wdXNoKHApO1xyXG4gICAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3QuY29uY2F0KFtwXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0XHJcbiAgICAgICAgICAuZmlsdGVyKHAgPT4gcC50eXBlID09PSB0aGlzLnVpc3RhdGUudHlwZUNvbGxlY3Rpb25bMF0udmFsdWUgfHwgcC50eXBlID09PSB0aGlzLnVpc3RhdGUudHlwZUNvbGxlY3Rpb25bMV0udmFsdWUgKVxyXG4gICAgICAgICAgLm1hcChwZXJmb3JtZXIgPT4gcGVyZm9ybWVyLmRlc2NyaXB0aW9uID1cclxuICAgICAgICAgICAgdGhpcy5wZXJmb3JtZXJEZXNjcmlwdGlvbihwZXJmb3JtZXIgYXMgYW55KSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJlLmNvbXBvbmVudCAmJiByZS5jb21wb25lbnQubWV0YWRhdGFJZCAmJiByZS5jb21wb25lbnQubWV0aG9kQ29kZSkge1xyXG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5jb21wb25lbnRzLmZpbmRJbmRleChhID0+IGEuaWQgPT09IHJlLmNvbXBvbmVudC5pZCk7XHJcbiAgICAgICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8uY29tcG9uZW50c1tpXSA9IHJlLmNvbXBvbmVudDtcclxuICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IHJlLmNvbXBvbmVudC5pZCk7XHJcbiAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3RbaW5kZXhdID0ge1xyXG4gICAgICAgICAgICBpZDogcmUuY29tcG9uZW50LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnd2YuQ29tcG9uZW50UGFydGljaXBhbnQnLFxyXG4gICAgICAgICAgICBwZXJmb3JtZXJOYW1lOiByZS5jb21wb25lbnQubmFtZSxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuY29tcG9uZW50RGVzY3JpcHRpb24ocmUuY29tcG9uZW50KSxcclxuICAgICAgICAgICAgY29uZGl0aW9uOiByZS5jb21wb25lbnQuY29uZGl0aW9uXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5jb21wb25lbnRzLnB1c2gocmUuY29tcG9uZW50KTtcclxuICAgICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdC5wdXNoKHtcclxuICAgICAgICAgICAgaWQ6IHJlLmNvbXBvbmVudC5pZCxcclxuICAgICAgICAgICAgdHlwZTogJ3dmLkNvbXBvbmVudFBhcnRpY2lwYW50JyxcclxuICAgICAgICAgICAgcGVyZm9ybWVyTmFtZTogcmUuY29tcG9uZW50Lm5hbWUsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmNvbXBvbmVudERlc2NyaXB0aW9uKHJlLmNvbXBvbmVudCksXHJcbiAgICAgICAgICAgIGNvbmRpdGlvbjogJydcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAocmUucmVwb3J0aW5nTGluZSAmJiByZS5yZXBvcnRpbmdMaW5lLnJlcG9ydGluZ0xpbmVEZWZJZCAmJiByZS5yZXBvcnRpbmdMaW5lLmRpbWVuc2lvbikge1xyXG4gICAgICAgIGlmKHJlLnJlcG9ydGluZ0xpbmUucmVwb3J0aW5nUmVmZXJPYmplY3QgPT09ICdkZXB0JyAmJiAhcmUucmVwb3J0aW5nTGluZS5yZWZPcmdJZCl7XHJcbiAgICAgICAgICB0aGlzLmlzQ2xvc2UgPSBmYWxzZTtcclxuICAgICAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfigJzpg6jpl6jigJ3msYfmiqXlhbPns7vnsbvlnovkuIvvvIzlj4LnhafkurrmiYDlnKjpg6jpl6jkuI3og73kuLrnqbonKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlLnJlcG9ydGluZ0xpbmUucmVwb3J0aW5nUmVmZXJPYmplY3QgIT09ICdkZXB0JyAmJiAhcmUucmVwb3J0aW5nTGluZS5yZWZVc2VySWQgJiYgIXJlLnJlcG9ydGluZ0xpbmUucmVmRW1wbG95ZWVJZCkgeyAvLyDnlKjmiLflj4rlhbbku5bkurrlkZjmsYfmiqXlr7nosaHnsbvlnovvvIzlj4LnhafnlKjmiLflkozlj4LnhaflkZjlt6XkuI3og73lhajpg6jkuLrnqbpcclxuICAgICAgICAgIHRoaXMuaXNDbG9zZSA9IGZhbHNlO1xyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+KAnOeUqOaIt+KAneaxh+aKpeWFs+ezu+exu+Wei+S4i++8jOWPgueFp+S6uuS4jeiDveS4uuepuicpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmlzQ2xvc2UgPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy5hZGRSZXBvcnRpbmdMaW5lRGF0YShyZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChyZS5tYXRyaXggJiYgcmUubWF0cml4Lm1hdHJpeERlZklkKSB7XHJcbiAgICAgICAgaWYoIXJlLm1hdHJpeC5jb25kaXRpb25GaWVsZDEgJiYgIXJlLm1hdHJpeC5jb25kaXRpb25GaWVsZDIgJiYgIXJlLm1hdHJpeC5jb25kaXRpb25GaWVsZDMpe1xyXG4gICAgICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbygn5p2h5Lu25a2X5q616Iez5bCR6KaB5a2Y5Zyo5LiA5LiqJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmKCFyZS5tYXRyaXguZGF0YUZpZWxkQWxpYXMpe1xyXG4gICAgICAgICAgdGhpcy5pc0Nsb3NlID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2UuaW5mbygn5pWw5o2u5a2X5q615LiN6IO95Li656m6Jyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuaXNDbG9zZSA9IHRydWU7XHJcbiAgICAgICAgICB0aGlzLmFkZE1hdHJpeERhdGEocmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLmdyaWQubG9hZERhdGEodGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmVkaXREaWFsb2cgJiYgdGhpcy5pc0Nsb3NlKSB7XHJcbiAgICAgIHRoaXMuZWRpdERpYWxvZy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIGFkZFJlcG9ydGluZ0xpbmVEYXRhKHJlOiBhbnkpe1xyXG4gICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzLmZpbmRJbmRleChhID0+IGEuaWQgPT09IHJlLnJlcG9ydGluZ0xpbmUuaWQpO1xyXG4gICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5yZXBvcnRpbmdMaW5lc1tpXSA9IHJlLnJlcG9ydGluZ0xpbmU7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IHJlLnJlcG9ydGluZ0xpbmUuaWQpO1xyXG4gICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVyc0xpc3RbaW5kZXhdID0ge1xyXG4gICAgICAgIGlkOiByZS5yZXBvcnRpbmdMaW5lLmlkLFxyXG4gICAgICAgIHR5cGU6ICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnQnLFxyXG4gICAgICAgIHBlcmZvcm1lck5hbWU6IHJlLnJlcG9ydGluZ0xpbmUucmVwb3J0aW5nTGluZURlZk5hbWUgKyAnLScgKyByZS5yZXBvcnRpbmdMaW5lLmRpbWVuc2lvbixcclxuICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5yZXBvcnRpbmdMaW5lRGVzY3JpcHRpb24ocmUucmVwb3J0aW5nTGluZSksXHJcbiAgICAgICAgY29uZGl0aW9uOiByZS5yZXBvcnRpbmdMaW5lLmNvbmRpdGlvblxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZm9yKGNvbnN0IHJlcG9ydGluZ0xpbmVEYXRhIG9mIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzKXtcclxuICAgICAgICBpZihyZXBvcnRpbmdMaW5lRGF0YS5yZXBvcnRpbmdMaW5lRGVmSWQgPT09IHJlLnJlcG9ydGluZ0xpbmUuZGVmaW5pdGlvbklkICYmXHJcbiAgICAgICAgICByZXBvcnRpbmdMaW5lRGF0YS5kaW1lbnNpb24gPT09IHJlLnJlcG9ydGluZ0xpbmUuZGltZW5zaW9uICYmXHJcbiAgICAgICAgICByZXBvcnRpbmdMaW5lRGF0YS5yZWZVc2VySWQgPT09IHJlLnJlcG9ydGluZ0xpbmUucmVmZXJVc2VySWQgJiZcclxuICAgICAgICAgIHJlcG9ydGluZ0xpbmVEYXRhLnJlZkVtcGxveWVlSWQgPT09IHJlLnJlcG9ydGluZ0xpbmUucmVmRW1wbG95ZWVJZCAmJlxyXG4gICAgICAgICAgcmVwb3J0aW5nTGluZURhdGEucmVmT3JnSWQgPT09IHJlLnJlcG9ydGluZ0xpbmUucmVmZXJEZXB0SWRcclxuICAgICAgICApe1xyXG4gICAgICAgICAgdGhpcy5tZXNzYWdlLmVycm9yKCfor6XmsYfmiqXlhbPns7vlt7Lnu4/ov5vooYzov4fphY3nva4nKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lckluZm8ucmVwb3J0aW5nTGluZXMucHVzaChyZS5yZXBvcnRpbmdMaW5lKTtcclxuICAgICAgdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LnB1c2goe1xyXG4gICAgICAgIGlkOiByZS5yZXBvcnRpbmdMaW5lLmlkLFxyXG4gICAgICAgIHR5cGU6ICd3Zi5SZXBvcnRpbmdMaW5lUGFydGljaXBhbnQnLFxyXG4gICAgICAgIHBlcmZvcm1lck5hbWU6IHJlLnJlcG9ydGluZ0xpbmUucmVwb3J0aW5nTGluZURlZk5hbWUgKyAnLScgKyByZS5yZXBvcnRpbmdMaW5lLmRpbWVuc2lvbixcclxuICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5yZXBvcnRpbmdMaW5lRGVzY3JpcHRpb24ocmUucmVwb3J0aW5nTGluZSksXHJcbiAgICAgICAgY29uZGl0aW9uOiByZS5yZXBvcnRpbmdMaW5lLmNvbmRpdGlvblxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJpdmF0ZSBhZGRNYXRyaXhEYXRhKHJlOiBhbnkpe1xyXG4gICAgY29uc3QgaSA9IHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm1hdHJpeFBhcnRpY2lwYW50cy5maW5kSW5kZXgoYSA9PiBhLmlkID09PSByZS5tYXRyaXguaWQpO1xyXG4gICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHNbaV0gPSByZS5tYXRyaXg7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51aXN0YXRlLnBlcmZvcm1lcnNMaXN0LmZpbmRJbmRleChhID0+IGEuaWQgPT09IHJlLm1hdHJpeC5pZCk7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdFtpbmRleF0gPSB7XHJcbiAgICAgICAgaWQ6IHJlLm1hdHJpeC5pZCxcclxuICAgICAgICB0eXBlOiAnd2YuTWF0cml4UGFydGljaXBhbnQnLFxyXG4gICAgICAgIHBlcmZvcm1lck5hbWU6IHJlLm1hdHJpeC5tYXRyaXhEZWZOYW1lICsgJy0nICsgcmUubWF0cml4LmRhdGFGaWVsZEFsaWFzLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLm1hdHJpeERlc2NyaXB0aW9uKHJlLm1hdHJpeCksXHJcbiAgICAgICAgY29uZGl0aW9uOiByZS5tYXRyaXguY29uZGl0aW9uXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmb3IoY29uc3QgbWF0cml4RGF0YSBvZiB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHMpe1xyXG4gICAgICAgIGlmKG1hdHJpeERhdGEubWF0cml4RGVmSWQgPT09IHJlLm1hdHJpeC5tYXRyaXhEZWZJZCAmJlxyXG4gICAgICAgICAgbWF0cml4RGF0YS5jb25kaXRpb25GaWVsZDEgPT09IHJlLm1hdHJpeC5jb25kaXRpb25GaWVsZDEgJiZcclxuICAgICAgICAgIG1hdHJpeERhdGEuY29uZGl0aW9uRmllbGQyID09PSByZS5tYXRyaXguY29uZGl0aW9uRmllbGQyICYmXHJcbiAgICAgICAgICBtYXRyaXhEYXRhLmNvbmRpdGlvbkZpZWxkMyA9PT0gcmUubWF0cml4LmNvbmRpdGlvbkZpZWxkMyAmJlxyXG4gICAgICAgICAgbWF0cml4RGF0YS5kYXRhRmllbGRBbGlhcyA9PT0gcmUubWF0cml4LmRhdGFGaWVsZEFsaWFzXHJcbiAgICAgICAgKXtcclxuICAgICAgICAgIHRoaXMubWVzc2FnZS5lcnJvcign6K+l55+p6Zi15bey57uP6L+b6KGM6L+H6YWN572uJyk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLm1hdHJpeFBhcnRpY2lwYW50cy5wdXNoKHJlLm1hdHJpeCk7XHJcbiAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJzTGlzdC5wdXNoKHtcclxuICAgICAgICBpZDogcmUubWF0cml4LmlkLFxyXG4gICAgICAgIHR5cGU6ICd3Zi5NYXRyaXhQYXJ0aWNpcGFudCcsXHJcbiAgICAgICAgcGVyZm9ybWVyTmFtZTogcmUubWF0cml4Lm1hdHJpeERlZk5hbWUgKyAnLScgKyByZS5tYXRyaXguZGF0YUZpZWxkQWxpYXMsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMubWF0cml4RGVzY3JpcHRpb24ocmUubWF0cml4KSxcclxuICAgICAgICBjb25kaXRpb246IHJlLm1hdHJpeC5jb25kaXRpb25cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGVkaXRDYW5jZWwoKSB7XHJcbiAgICBpZiAodGhpcy5lZGl0RGlhbG9nKSB7XHJcbiAgICAgIHRoaXMuZWRpdERpYWxvZy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBwYXJ0aWNpcGFudE9wdGlvbnNTZXQoKSB7XHJcbiAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5vcHRpb25zID0gdGhpcy5vcHRpb25zLmdldFBlcmZvcm1lck9wdGlvbnMoKTtcclxuICAgIHRoaXMub3B0aW9uc0RpYWxvZy5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwZXJmb3JtZXJEZXNjcmlwdGlvbihwZXJmb3JtZXI6IFBlcmZvcm1lckVudGl0eSkge1xyXG4gICAgaWYgKHBlcmZvcm1lci50eXBlID09PSAnd2YuVXNlclBhcnRpY2lwYW50Jykge1xyXG4gICAgICBpZiAocGVyZm9ybWVyLnRhZyA9PT0gJ2V4cHJlc3Npb24nKSB7XHJcbiAgICAgICAgcmV0dXJuIHBlcmZvcm1lci5wZXJmb3JtZXJJZDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocGVyZm9ybWVyLm9yZ05hbWUpIHtcclxuICAgICAgICAgIHJldHVybiBg6YOo6Zeo77yaJHtwZXJmb3JtZXIub3JnTmFtZX1gO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHBlcmZvcm1lci50eXBlID09PSAnd2YuUG9zaXRpb25QYXJ0aWNpcGFudCcpIHtcclxuICAgICAgaWYgKChwZXJmb3JtZXIgYXMgUG9zaXRpb25QZXJmb3JtZXJFbnRpdHkpLnBvc2l0aW9uVHlwZSA9PT0gJzEnKSB7XHJcbiAgICAgICAgaWYgKHBlcmZvcm1lci5vcmdJZCkge1xyXG4gICAgICAgICAgcmV0dXJuIGDlspfkvY3nsbvlnovvvJrpgJrnlKjlspfkvY3vvIzpg6jpl6jvvJoke3BlcmZvcm1lci5vcmdJZH1gO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gYOWyl+S9jeexu+Wei++8mumAmueUqOWyl+S9jWA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKChwZXJmb3JtZXIgYXMgUG9zaXRpb25QZXJmb3JtZXJFbnRpdHkpLnBvc2l0aW9uVHlwZSA9PT0gJzAnKSB7XHJcbiAgICAgICAgcmV0dXJuICflspfkvY3nsbvlnovvvJrnu4Tnu4flspfkvY0nO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgY29tcG9uZW50RGVzY3JpcHRpb24oY29tcG9uZW50OiBDb21wb25lbnRQZXJmb3JtZXIpIHtcclxuICAgIGxldCBkZXMgPSBg5p6E5Lu277yaJHtjb21wb25lbnQubmFtZX0s5Y+C5pWw77yae2A7XHJcbiAgICBpZiAoY29tcG9uZW50LmFjdHVhbFBhcmFtZXRlcnMgJiYgY29tcG9uZW50LmFjdHVhbFBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb21wb25lbnQuYWN0dWFsUGFyYW1ldGVycy5mb3JFYWNoKHAgPT4ge1xyXG4gICAgICAgIGRlcyArPSBgJHtwLmNvZGV977yaJHtwLnZhbHVlfe+8jGA7XHJcbiAgICAgIH0pO1xyXG4gICAgICBkZXMgPSBkZXMuc3Vic3RyaW5nKDAsIGRlcy5sZW5ndGggLSAxKTtcclxuICAgIH1cclxuICAgIGRlcyArPSAnfSc7XHJcbiAgICByZXR1cm4gZGVzO1xyXG4gIH1cclxuICBwcml2YXRlIHJlcG9ydGluZ0xpbmVEZXNjcmlwdGlvbihyZXBvcnRpbmdMaW5lOiBSZXBvcnRpbmdMaW5lRGF0YUVudGl0eSkge1xyXG4gICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XHJcbiAgICBpZihyZXBvcnRpbmdMaW5lLnJlZlVzZXJJZCl7XHJcbiAgICAgIGRlc2NyaXB0aW9uICs9IGDlj4LnhafkurrvvJoke3JlcG9ydGluZ0xpbmUucmVmVXNlcklkfWA7XHJcbiAgICB9XHJcbiAgICBpZihyZXBvcnRpbmdMaW5lLnJlZkVtcGxveWVlSWQpe1xyXG4gICAgICBkZXNjcmlwdGlvbiArPSBg5Y+C54Wn5Lq677yaJHtyZXBvcnRpbmdMaW5lLnJlZkVtcGxveWVlSWR9YDtcclxuICAgIH1cclxuICAgIGlmKHJlcG9ydGluZ0xpbmUucmVmT3JnSWQpe1xyXG4gICAgICBpZihyZXBvcnRpbmdMaW5lLnJlZlVzZXJJZCl7XHJcbiAgICAgICAgZGVzY3JpcHRpb24gKz0gYO+8jGA7XHJcbiAgICAgIH1cclxuICAgICAgaWYocmVwb3J0aW5nTGluZS5yZWZFbXBsb3llZUlkKXtcclxuICAgICAgICBkZXNjcmlwdGlvbiArPSBg77yMYDtcclxuICAgICAgfVxyXG4gICAgICBkZXNjcmlwdGlvbiArPSBg5Y+C54Wn57uE57uH77yaJHtyZXBvcnRpbmdMaW5lLnJlZk9yZ0lkfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVzY3JpcHRpb247XHJcbiAgfVxyXG4gIHByaXZhdGUgbWF0cml4RGVzY3JpcHRpb24obWF0cml4OiBNYXRyaXhEYXRhSW5mb0VudGl0eSkge1xyXG4gICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XHJcbiAgICBpZihtYXRyaXguY29uZGl0aW9uRmllbGQxKXtcclxuICAgICAgZGVzY3JpcHRpb24gKz0gYOadoeS7tjHvvJoke21hdHJpeC5jb25kaXRpb25GaWVsZFRleHQxfe+8jGA7XHJcbiAgICB9XHJcbiAgICBpZihtYXRyaXguY29uZGl0aW9uRmllbGQyKXtcclxuICAgICAgZGVzY3JpcHRpb24gKz0gYOadoeS7tjLvvJoke21hdHJpeC5jb25kaXRpb25GaWVsZFRleHQyfe+8jGA7XHJcbiAgICB9XHJcbiAgICBpZihtYXRyaXguY29uZGl0aW9uRmllbGQzKXtcclxuICAgICAgZGVzY3JpcHRpb24gKz0gYOadoeS7tjPvvJoke21hdHJpeC5jb25kaXRpb25GaWVsZFRleHQzfe+8jGA7XHJcbiAgICB9XHJcbiAgICBpZihtYXRyaXguZGF0YUZpZWxkQWxpYXMpe1xyXG4gICAgICBkZXNjcmlwdGlvbiArPSBg5pWw5o2u77yaJHttYXRyaXguZGF0YUZpZWxkQWxpYXN977yMYDtcclxuICAgIH1cclxuICAgIHJldHVybiBkZXNjcmlwdGlvbi5zbGljZSgwLCBkZXNjcmlwdGlvbi5sZW5ndGggLSAxKTtcclxuICB9XHJcblxyXG4gIGVkaXRDb25kaXRvbihlOiBhbnkpIHtcclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5zY2hlbWFzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBzY2hlbWEgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hcykge1xyXG4gICAgICAgIHRoaXMuZXhwci5hZGRTY2hlbWEoJ1NjaGVtYScsIHNjaGVtYSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXMgJiYgdGhpcy5kZXNpZ25lclVJU3RhdGUuc2NoZW1hc1swXS5lbnRpdHlUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZGVzaWduZXJVSVN0YXRlLnNjaGVtYXNbMF0uZW50aXR5VHlwZXNbMF07XHJcbiAgICAgICAgdGhpcy5leHByLmFkZEluamVjdGVkRW50aXR5KGVudGl0eVR5cGUubmFtZSwgJ1NjaGVtYScsXHJcbiAgICAgICAgICBlbnRpdHlUeXBlLm5hbWUsIEluamVjdGVkVHlwZS5FbnRpdHlUeXBlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGV4dCA9IG5ldyBBcnJheSgpO1xyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnByb2NJbnN0Q29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUucHJvY0luc3RDb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLmZvcm1hbFBhcmFtZXRlckNvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLmZvcm1hbFBhcmFtZXRlckNvbnRleHQpIHtcclxuICAgICAgICBpZiAoIWNvbnRleHQuc29tZShjID0+IGMua2V5ID09PSB2YXJpYWJsZS5rZXkpKSB7XHJcbiAgICAgICAgICBjb250ZXh0LnB1c2godmFyaWFibGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZGVzaWduZXJVSVN0YXRlLnBhcnRpY2lwYW50Q29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5kZXNpZ25lclVJU3RhdGUucGFydGljaXBhbnRDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wcm9jZXNzVmFyaWFibGVDb250ZXh0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5wcm9jZXNzVmFyaWFibGVDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZXh0LnNvbWUoYyA9PiBjLmtleSA9PT0gdmFyaWFibGUua2V5KSkge1xyXG4gICAgICAgICAgY29udGV4dC5wdXNoKHZhcmlhYmxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0aGlzLmRlc2lnbmVyVUlTdGF0ZS5hY3Rpdml0eUNvbXBvbmVudENvbnRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuZGVzaWduZXJVSVN0YXRlLmFjdGl2aXR5Q29tcG9uZW50Q29udGV4dCkge1xyXG4gICAgICAgIGlmICghY29udGV4dC5zb21lKGMgPT4gYy5rZXkgPT09IHZhcmlhYmxlLmtleSkpIHtcclxuICAgICAgICAgIGNvbnRleHQucHVzaCh2YXJpYWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY29udGV4dC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5leHByLmFkZENvbnRleHQodik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZXhwci5hZGRFeHByZXNzaW9uVGV4dChlLmluc3RhbmNlLnZhbHVlKTtcclxuICAgIHRoaXMuZXhwci5zZXRFZGl0UGF0dGVybihFeHByRWRpdE1vZGUuQ29uZGl0aW9uYWwpOyAvLyDpu5jorqTmiZPlvIDnroDmmJPooajovr7lvI/nvJbovpHlmahcclxuICAgIHRoaXMuZXhwci5idWlsZEV4cHJlc3Npb24oKS50aGVuKChjb25kOiBzdHJpbmcpID0+IHtcclxuICAgICAgaWYgKHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLnR5cGUgPT09ICd3Zi5Db21wb25lbnRQYXJ0aWNpcGFudCcpIHtcclxuICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5jb21wb25lbnRzLmZpbmQoYyA9PiBjLmlkID09PSB0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS5pZCkuY29uZGl0aW9uID0gY29uZDtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS50eXBlID09PSAnd2YuUmVwb3J0aW5nTGluZVBhcnRpY2lwYW50Jykge1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnJlcG9ydGluZ0xpbmVzLmZpbmQoYyA9PiBjLmlkID09PSB0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS5pZCkuY29uZGl0aW9uID0gY29uZDtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmdyaWQuc2VsZWN0ZWRSb3cuZGF0YS50eXBlID09PSAnd2YuTWF0cml4UGFydGljaXBhbnQnKXtcclxuICAgICAgICB0aGlzLnVpc3RhdGUucGVyZm9ybWVySW5mby5tYXRyaXhQYXJ0aWNpcGFudHMuZmluZChjID0+IGMuaWQgPT09IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLmlkKS5jb25kaXRpb24gPSBjb25kO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudWlzdGF0ZS5wZXJmb3JtZXJJbmZvLnBlcmZvcm1lcnMuZmluZChwID0+IHAuaWQgPT09IHRoaXMuZ3JpZC5zZWxlY3RlZFJvdy5kYXRhLmlkKS5jb25kaXRpb24gPSBjb25kO1xyXG4gICAgICB9XHJcbiAgICAgIGUuZm9ybUNvbnRyb2wuc2V0VmFsdWUoY29uZCk7XHJcbiAgICAgIGUuaW5zdGFuY2UuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZnRlckVkaXQgPSAocm93SW5kZXg6IG51bWJlciwgcm93RGF0YTogYW55LCBjb2x1bW4/OiBEYXRhQ29sdW1uKSA9PiB7XHJcbiAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBzZWxlY3RDaGFuZ2VkKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy51aXN0YXRlLmN1clBlcmZvcm1lciA9IGRhdGEuZGF0YTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgR2V0T3JnYW5pemF0aW9uVHlwZSgpIHtcclxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvYXV0aGZpZWxkcy9nbG9iYWxhdXRoZmllbGRzJztcclxuICAgIHRoaXMuaHR0cC5nZXQodXJsKVxyXG4gICAgICAuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHRoaXMuZGVzaWduZXJVSVN0YXRlLm9yZ1R5cGVDb2xsZWN0aW9uID0gZGF0YS5tYXAoZCA9PiAoeyB2YWx1ZTogZC5pZCwgdGV4dDogZC5uYW1lIH0pKSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldE1hdHJpeENvbmZpZygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL2dlbmVyYWxDb25maWcvSXNfRW5hYmxlTWF0cml4YDtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBjbGFzcyBQZXJmb3JtZXJDb252ZXJ0ZXIgaW1wbGVtZW50cyBUeXBlQ29udmVydGVyIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBjb252ZXJ0VG8oZGF0YTogYW55KTogc3RyaW5nIHtcclxuICAgIGlmICgoZGF0YS5wZXJmb3JtZXJzICYmIGRhdGEucGVyZm9ybWVycy5sZW5ndGggPiAwKVxyXG4gICAgICB8fCAoZGF0YS5jb21wb25lbnRzICYmIGRhdGEuY29tcG9uZW50cy5sZW5ndGggPiAwKVxyXG4gICAgICB8fCAoZGF0YS5yZXBvcnRpbmdMaW5lcyAmJiBkYXRhLnJlcG9ydGluZ0xpbmVzLmxlbmd0aCA+IDApXHJcbiAgICAgIHx8IChkYXRhLm1hdHJpeFBhcnRpY2lwYW50cyAmJiBkYXRhLm1hdHJpeFBhcnRpY2lwYW50cy5sZW5ndGggPiAwKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiAn77yI5bey6K6+572u77yJJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiAn77yI5pyq6K6+572u77yJJztcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19