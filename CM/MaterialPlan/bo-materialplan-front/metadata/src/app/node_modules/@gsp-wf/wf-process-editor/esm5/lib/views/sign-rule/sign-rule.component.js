/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Output, EventEmitter, Input, ViewChild, TemplateRef } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { SignRuleEntity } from './entites/sign-rule.entity';
import { DialogComponent } from '@farris/ui-dialog';
import { ExprEditMode, ExpressionService } from '@gsp-svc/expression';
import { MessagerService } from '@farris/ui-messager';
import { ProcessDesignerUIState } from '../../app/process-designer.uistate';
import { DatagridComponent } from '@farris/ui-datagrid';
import { ProcessDeUtil } from '../../domain/process-de-util';
import { EditorTypes } from '@farris/ui-datagrid-editors';
import { of } from 'rxjs';
var SignRuleComponent = /** @class */ (function () {
    function SignRuleComponent(formBuilder, message, exprService, designerUIState) {
        var _this = this;
        this.formBuilder = formBuilder;
        this.message = message;
        this.exprService = exprService;
        this.designerUIState = designerUIState;
        this.cls = 'farris-main-area flex-column';
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: '会签规则',
            width: 800,
            height: 520,
            showButtons: true
        };
        this.data = [];
        this.calculationMethods = [
            { text: '按数量', value: 'byNumber' },
            { text: '按比例(%)', value: 'byProportion' },
            { text: '自定义条件', value: 'null' },
        ];
        this.counterSignVariables = [];
        /**
         * **** 审批项帮助参数 ********************************************************
         */
        this.approvalCols = [{ title: '编号', field: 'value', width: 80 },
            { title: '名称', field: 'text', width: 90 }];
        this.approvalItems = [];
        /**
         * ********************************
         */
        this.columns = [
            { field: 'conclusionName', width: 25, title: '结论名称' },
            { field: 'conclusionValue', width: 25, title: '结论值' },
            { field: 'calculateType', width: 40, title: '计算方式',
                formatter: { type: 'enum', options: { valueField: 'value', textField: 'text', data: this.calculationMethods } },
                editor: { type: EditorTypes.COMBOLIST, options: { valueField: 'value', textField: 'text', data: this.calculationMethods, idField: 'value', panelHeight: 'auto' } }
            },
            { field: 'conditionValue', width: 25, title: '条件值',
                editor: { type: EditorTypes.NUMBERBOX, options: {} },
                formatter: { type: 'number', options: { precision: 0, min: 0 } }
            },
            { field: 'waitAllVotes', width: 35, title: '等待全员办结',
                editor: { type: EditorTypes.SWITCH, options: {} },
                formatter: { type: 'boolean', options: { trueText: '是', falseText: '否' } }
            },
            { field: 'completionCondition', width: 50, title: '自定义条件',
                editor: {
                    type: 'input-group',
                    options: {
                        groupText: '<i class="f-icon f-icon-lookup"></i>',
                        editable: false,
                        clickHandle: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            e.formControl.setValue(e.instance.value ? e.instance.value : '');
                            _this.editConditon(e);
                        }),
                        clear: (/**
                         * @param {?} e
                         * @return {?}
                         */
                        function (e) {
                            console.log('clear', e);
                        })
                    }
                }
            }
        ];
        /**
         * 结束编辑前事件
         */
        this.afterEdit = (/**
         * @param {?} rowIndex
         * @param {?} rowData
         * @param {?=} column
         * @return {?}
         */
        function (rowIndex, rowData, column) {
            _this.preValue = JSON.parse(JSON.stringify(rowData));
            return of(true);
        });
    }
    Object.defineProperty(SignRuleComponent.prototype, "value", {
        set: /**
         * @param {?} rules
         * @return {?}
         */
        function (rules) {
            var e_1, _a;
            if (rules && rules.length > 0) {
                try {
                    for (var rules_1 = tslib_1.__values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                        var rule = rules_1_1.value;
                        /** @type {?} */
                        var val = new SignRuleEntity();
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = rule.ConclusionValue;
                        val.conclusionName = rule.ConclusionName;
                        val.calculateType = rule.CalculateType ? rule.CalculateType : 'null';
                        val.conditionValue = rule.ConditionValue ? rule.ConditionValue : 0;
                        val.waitAllVotes = rule.WaitAllVotes ? rule.WaitAllVotes : false;
                        val.completionCondition = rule.CompletionCondition ? rule.CompletionCondition._value : null;
                        this.data.push(val);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            else { // 如果模型上没有会签规则，自动带入所有的审批选项
                this.deleteRow();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.counterSignVariables = this.designerUIState.counterSignVariables || [];
        this.approvalItems = this.designerUIState.approvalItems || [];
    };
    // 重置动作
    // 重置动作
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.deleteRow = 
    // 重置动作
    /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        this.data = [];
        /** @type {?} */
        var ruleItems = this.designerUIState.approvalItems || [];
        if (ruleItems && ruleItems.length > 0) {
            try {
                for (var ruleItems_1 = tslib_1.__values(ruleItems), ruleItems_1_1 = ruleItems_1.next(); !ruleItems_1_1.done; ruleItems_1_1 = ruleItems_1.next()) {
                    var ruleItem = ruleItems_1_1.value;
                    /** @type {?} */
                    var val = new SignRuleEntity();
                    if (ruleItem.value === 'Pass') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byProportion';
                        val.conditionValue = '100';
                        val.waitAllVotes = true;
                    }
                    else if (ruleItem.value === 'Back') {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'byNumber';
                        val.conditionValue = '1';
                        val.waitAllVotes = true;
                    }
                    else {
                        val.id = ProcessDeUtil.GenerateElementId();
                        val.conclusionValue = ruleItem.value;
                        val.conclusionName = ruleItem.text;
                        val.calculateType = 'null';
                        val.conditionValue = '0';
                        val.waitAllVotes = true;
                    }
                    this.data.push(val);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (ruleItems_1_1 && !ruleItems_1_1.done && (_a = ruleItems_1.return)) _a.call(ruleItems_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
    };
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.clickOK = /**
     * @return {?}
     */
    function () {
        this.grid.endCellEdit();
        if (this.data.length === 0) {
            this.message.warning('完成策略为会签时，会签规则不允许为空，请了解！');
        }
        else {
            /** @type {?} */
            var object = { value: this.data, parameters: null };
            this.submitModal.emit(object);
        }
    };
    /**
     * @return {?}
     */
    SignRuleComponent.prototype.clickCancel = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    /**
     * @param {?} e
     * @return {?}
     */
    SignRuleComponent.prototype.editConditon = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var e_3, _a;
        if (this.counterSignVariables && this.counterSignVariables.length > 0) {
            try {
                for (var _b = tslib_1.__values(this.counterSignVariables), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var variable = _c.value;
                    this.exprService.addContext(variable);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_3) throw e_3.error; }
            }
        }
        this.exprService.setEditPattern(ExprEditMode.Advanced); // 表达式展现模式：默认高级版（会签规则需要上下文变量）
        this.exprService.addExpressionText(e.instance.value);
        this.exprService.buildExpression().then((/**
         * @param {?} cond
         * @return {?}
         */
        function (cond) {
            e.formControl.setValue(cond);
            e.instance.cd.detectChanges();
        }));
    };
    /**
     * 选中审批项
     */
    /**
     * 选中审批项
     * @return {?}
     */
    SignRuleComponent.prototype.approvalSelect = /**
     * 选中审批项
     * @return {?}
     */
    function () {
        var e_4, _a;
        /** @type {?} */
        var selections = this.apvlItemsGrid.checkeds;
        if (selections && selections.length > 0) {
            try {
                for (var selections_1 = tslib_1.__values(selections), selections_1_1 = selections_1.next(); !selections_1_1.done; selections_1_1 = selections_1.next()) {
                    var selection = selections_1_1.value;
                    /** @type {?} */
                    var signRule = new SignRuleEntity();
                    signRule.id = ProcessDeUtil.GenerateElementId();
                    signRule.conclusionValue = selection.data.value;
                    signRule.conclusionName = selection.data.text;
                    this.data.push(signRule);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (selections_1_1 && !selections_1_1.done && (_a = selections_1.return)) _a.call(selections_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
            this.grid.loadData(this.data);
            this.apvlItemDialog.close();
        }
        else {
            this.message.info('请首先选中一条审批项！');
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    SignRuleComponent.prototype.endEdit = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.curValue = e.rowData;
        // 自定义会签规则和预置会签规则互斥
        if (this.preValue.completionCondition !== this.curValue.completionCondition) {
            this.data[e.rowIndex].calculateType = 'null',
                this.data[e.rowIndex].conditionValue = '0';
            this.data[e.rowIndex].waitAllVotes = false;
        }
        else if (this.preValue.calculateType !== this.curValue.calculateType ||
            this.preValue.conditionValue !== this.curValue.conditionValue ||
            this.preValue.waitAllVotes !== this.curValue.waitAllVotes) {
            this.data[e.rowIndex].completionCondition = null;
        }
        if (e.column.field === 'conditionValue' && this.data[e.rowIndex].calculateType === 'byProportion'
            && Number.parseInt(e.value) > 100) {
            this.message.info('条件值最大值是100');
            this.data[e.rowIndex].conditionValue = '100';
        }
        else if (e.column.field === 'conditionValue' && Number.parseInt(e.value) < 0) {
            this.message.info('条件值最小值是0');
            this.data[e.rowIndex].conditionValue = '0';
        }
        else if ((e.column.field === 'calculateType' || e.column.field === 'conditionValue') && (this.data[e.rowIndex].calculateType === 'oneVote' ||
            this.data[e.rowIndex].calculateType === 'fullVote') && Number.parseInt(this.data[e.rowIndex].conditionValue) !== 0) {
            this.message.info('结论执行方式为全票或一票时不需要条件值');
            this.data[e.rowIndex].conditionValue = '0';
        }
        else if (e.column.field === 'calculateType' && this.data[e.rowIndex].calculateType === 'byProportion' &&
            Number.parseInt(this.data[e.rowIndex].conditionValue) > 100) {
            this.message.info('条件值最大值是100');
            this.data[e.rowIndex].conditionValue = '100';
        }
    };
    SignRuleComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-sign-rule',
                    template: "<div class=\"f-page\">\r\n  <div class=\"f-page-header\">\r\n    <nav class=\"f-page-header-base\">\r\n      <div class=\"f-title\">\r\n        <span class=\"f-title-icon f-text-orna-bill\">\r\n          <i class=\"f-icon f-icon-page-title-administer\"></i>\r\n        </span>\r\n        <h4 class=\"f-title-text\">\u89C4\u5219\u5217\u8868</h4>\r\n      </div>\r\n      <div class=\"btn-toolbar btn-group-lg\">\r\n      </div>\r\n    </nav>\r\n  </div>\r\n  <div class=\"f-page-main f-utils-fill-flex-column h-100\">\r\n    <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100\">\r\n      <farris-datagrid #grid [data]=\"data\" [columns]=\"columns\" [idField]=\"'id'\" [fit]=\"true\"\r\n        [fitColumns]=\"true\" [editable]=\"true\" [editMode]=\"'cell'\" [pagination]=\"false\" [showCheckbox]=\"false\"\r\n        [multiSelect]=\"false\" [afterEdit]='afterEdit' (endEdit)=\"endEdit($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOK()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"deleteRow()\">\u91CD\u7F6E</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n\r\n<farris-dialog #approvalItemDialog [buttons]=\"buttonRef\" [width]=\"700\" [height]=\"520\" [title]=\"'\u5BA1\u6279\u9009\u9879'\">\r\n  <div class=\"f-utils-fill-flex-column farris-overflow-y-auto h-100 m-2\">\r\n      <farris-datagrid #approvalTable [columns]=\"approvalCols\" [data]=\"approvalItems\" [idField]=\"'value'\"\r\n        [fit]=\"true\" [fitColumns]=\"true\" [pagination]='false' [multiSelect]=\"true\"\r\n        [showCheckbox]=\"true\" [multiSelect]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\">\r\n      </farris-datagrid>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary px-3 mx-2\" (click)=\"approvalSelect()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"approvalItemDialog.close()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SignRuleComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: MessagerService },
        { type: ExpressionService },
        { type: ProcessDesignerUIState }
    ]; };
    SignRuleComponent.propDecorators = {
        cls: [{ type: HostBinding, args: ['class',] }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        value: [{ type: Input }],
        editorParams: [{ type: Input }],
        modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }],
        apvlItemsGrid: [{ type: ViewChild, args: ['approvalTable',] }],
        apvlItemDialog: [{ type: ViewChild, args: ['approvalItemDialog',] }],
        grid: [{ type: ViewChild, args: ['grid',] }]
    };
    return SignRuleComponent;
}());
export { SignRuleComponent };
if (false) {
    /** @type {?} */
    SignRuleComponent.prototype.cls;
    /** @type {?} */
    SignRuleComponent.prototype.closeModal;
    /** @type {?} */
    SignRuleComponent.prototype.submitModal;
    /** @type {?} */
    SignRuleComponent.prototype.editorParams;
    /** @type {?} */
    SignRuleComponent.prototype.modalFooter;
    /** @type {?} */
    SignRuleComponent.prototype.apvlItemsGrid;
    /** @type {?} */
    SignRuleComponent.prototype.apvlItemDialog;
    /** @type {?} */
    SignRuleComponent.prototype.grid;
    /** @type {?} */
    SignRuleComponent.prototype.modalConfig;
    /** @type {?} */
    SignRuleComponent.prototype.data;
    /** @type {?} */
    SignRuleComponent.prototype.calculationMethods;
    /** @type {?} */
    SignRuleComponent.prototype.counterSignVariables;
    /**
     * **** 审批项帮助参数 ********************************************************
     * @type {?}
     */
    SignRuleComponent.prototype.approvalCols;
    /** @type {?} */
    SignRuleComponent.prototype.approvalItems;
    /**
     * ********************************
     * @type {?}
     */
    SignRuleComponent.prototype.columns;
    /** @type {?} */
    SignRuleComponent.prototype.preValue;
    /** @type {?} */
    SignRuleComponent.prototype.curValue;
    /**
     * 结束编辑前事件
     * @type {?}
     */
    SignRuleComponent.prototype.afterEdit;
    /**
     * @type {?}
     * @private
     */
    SignRuleComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    SignRuleComponent.prototype.message;
    /**
     * @type {?}
     * @private
     */
    SignRuleComponent.prototype.exprService;
    /**
     * @type {?}
     * @private
     */
    SignRuleComponent.prototype.designerUIState;
}
var SignRuleConverter = /** @class */ (function () {
    function SignRuleConverter() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    SignRuleConverter.prototype.convertTo = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length > 0) {
            return '（已设置）';
        }
        else {
            return '（未设置）';
        }
    };
    return SignRuleConverter;
}());
export { SignRuleConverter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lnbi1ydWxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtcHJvY2Vzcy1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvdmlld3Mvc2lnbi1ydWxlL3NpZ24tcnVsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBILE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM3QyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDNUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxZQUFZLEVBQUUsaUJBQWlCLEVBQWEsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDNUUsT0FBTyxFQUFjLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQzdELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRTFCO0lBdUZFLDJCQUNVLFdBQXdCLEVBQ3hCLE9BQXdCLEVBQ3hCLFdBQThCLEVBQzlCLGVBQXVDO1FBSmpELGlCQUtLO1FBSkssZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFDeEIsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7UUFDeEIsZ0JBQVcsR0FBWCxXQUFXLENBQW1CO1FBQzlCLG9CQUFlLEdBQWYsZUFBZSxDQUF3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aEMsd0NBQXNDOzs7OztJQUN0Qyw0Q0FBK0M7O0FBb0luRDtJQUNFO0lBQWdCLENBQUM7Ozs7O0lBRWpCLHFDQUFTOzs7O0lBQVQsVUFBVSxJQUFXO1FBQ25CLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzNCLE9BQU8sT0FBTyxDQUFDO1NBQ2hCO2FBQU07WUFDTCxPQUFPLE9BQU8sQ0FBQztTQUNoQjtJQUNILENBQUM7SUFDSCx3QkFBQztBQUFELENBQUMsQUFWRCxJQVVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEhvc3RCaW5kaW5nLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZUNvbnZlcnRlciB9IGZyb20gJ0BmYXJyaXMvdWktcHJvcGVydHktcGFuZWwnO1xyXG5pbXBvcnQgeyBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgU2lnblJ1bGVFbnRpdHkgfSBmcm9tICcuL2VudGl0ZXMvc2lnbi1ydWxlLmVudGl0eSc7XHJcbmltcG9ydCB7IERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGlhbG9nJztcclxuaW1wb3J0IHsgRXhwckVkaXRNb2RlLCBFeHByZXNzaW9uU2VydmljZSwgVmFyRW50aXR5IH0gZnJvbSAnQGdzcC1zdmMvZXhwcmVzc2lvbic7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBQcm9jZXNzRGVzaWduZXJVSVN0YXRlIH0gZnJvbSAnLi4vLi4vYXBwL3Byb2Nlc3MtZGVzaWduZXIudWlzdGF0ZSc7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4sIERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IFByb2Nlc3NEZVV0aWwgfSBmcm9tICcuLi8uLi9kb21haW4vcHJvY2Vzcy1kZS11dGlsJztcclxuaW1wb3J0IHsgRWRpdG9yVHlwZXMgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkLWVkaXRvcnMnO1xyXG5pbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtc2lnbi1ydWxlJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vc2lnbi1ydWxlLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9zaWduLXJ1bGUuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTaWduUnVsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpXHJcbiAgY2xzID0gJ2ZhcnJpcy1tYWluLWFyZWEgZmxleC1jb2x1bW4nO1xyXG4gIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShydWxlczogYW55W10pIHtcclxuICAgIGlmIChydWxlcyAmJiBydWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICAgIGNvbnN0IHZhbCA9IG5ldyBTaWduUnVsZUVudGl0eSgpO1xyXG4gICAgICAgIHZhbC5pZCA9IFByb2Nlc3NEZVV0aWwuR2VuZXJhdGVFbGVtZW50SWQoKTtcclxuICAgICAgICB2YWwuY29uY2x1c2lvblZhbHVlID0gcnVsZS5Db25jbHVzaW9uVmFsdWU7XHJcbiAgICAgICAgdmFsLmNvbmNsdXNpb25OYW1lID0gcnVsZS5Db25jbHVzaW9uTmFtZTtcclxuICAgICAgICB2YWwuY2FsY3VsYXRlVHlwZSA9IHJ1bGUuQ2FsY3VsYXRlVHlwZSA/IHJ1bGUuQ2FsY3VsYXRlVHlwZSA6ICdudWxsJztcclxuICAgICAgICB2YWwuY29uZGl0aW9uVmFsdWUgPSBydWxlLkNvbmRpdGlvblZhbHVlID8gcnVsZS5Db25kaXRpb25WYWx1ZSA6IDA7XHJcbiAgICAgICAgdmFsLndhaXRBbGxWb3RlcyA9IHJ1bGUuV2FpdEFsbFZvdGVzID8gcnVsZS5XYWl0QWxsVm90ZXMgOiBmYWxzZTtcclxuICAgICAgICB2YWwuY29tcGxldGlvbkNvbmRpdGlvbiA9IHJ1bGUuQ29tcGxldGlvbkNvbmRpdGlvbiA/IHJ1bGUuQ29tcGxldGlvbkNvbmRpdGlvbi5fdmFsdWUgOiBudWxsO1xyXG4gICAgICAgIHRoaXMuZGF0YS5wdXNoKHZhbCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7IC8vIOWmguaenOaooeWei+S4iuayoeacieS8muetvuinhOWIme+8jOiHquWKqOW4puWFpeaJgOacieeahOWuoeaJuemAiemhuVxyXG4gICAgICB0aGlzLmRlbGV0ZVJvdygpO1xyXG4gICAgfVxyXG4gIH1cclxuICBASW5wdXQoKSBlZGl0b3JQYXJhbXM6IGFueSA9IHt9O1xyXG4gIEBWaWV3Q2hpbGQoJ2ljb25TZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdhcHByb3ZhbFRhYmxlJykgYXB2bEl0ZW1zR3JpZDogRGF0YWdyaWRDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYXBwcm92YWxJdGVtRGlhbG9nJykgYXB2bEl0ZW1EaWFsb2c6IERpYWxvZ0NvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdncmlkJykgZ3JpZDogRGF0YWdyaWRDb21wb25lbnQ7XHJcblxyXG4gIG1vZGFsQ29uZmlnID0ge1xyXG4gICAgdGl0bGU6ICfkvJrnrb7op4TliJknLFxyXG4gICAgd2lkdGg6IDgwMCxcclxuICAgIGhlaWdodDogNTIwLFxyXG4gICAgc2hvd0J1dHRvbnM6IHRydWVcclxuICB9O1xyXG4gIGRhdGE6IFNpZ25SdWxlRW50aXR5W10gPSBbXTtcclxuICBjYWxjdWxhdGlvbk1ldGhvZHM6IGFueVtdID0gW1xyXG4gICAgeyB0ZXh0OiAn5oyJ5pWw6YePJywgdmFsdWU6ICdieU51bWJlcicgfSxcclxuICAgIHsgdGV4dDogJ+aMieavlOS+iyglKScsIHZhbHVlOiAnYnlQcm9wb3J0aW9uJyB9LFxyXG4gICAgeyB0ZXh0OiAn6Ieq5a6a5LmJ5p2h5Lu2JywgdmFsdWU6ICdudWxsJyB9LFxyXG4gIF07XHJcbiAgY291bnRlclNpZ25WYXJpYWJsZXM6IFZhckVudGl0eVtdID0gW107XHJcbiAgLyoqKioqKiog5a6h5om56aG55biu5Yqp5Y+C5pWwICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICBhcHByb3ZhbENvbHMgPSBbeyB0aXRsZTogJ+e8luWPtycsIGZpZWxkOiAndmFsdWUnLCB3aWR0aDogODAgfSxcclxuICB7IHRpdGxlOiAn5ZCN56ewJywgZmllbGQ6ICd0ZXh0Jywgd2lkdGg6IDkwIH1dO1xyXG4gIGFwcHJvdmFsSXRlbXM6IGFueVtdID0gW107XHJcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4gIGNvbHVtbnMgPSBbXHJcbiAgICB7IGZpZWxkOiAnY29uY2x1c2lvbk5hbWUnLCB3aWR0aDogMjUsIHRpdGxlOiAn57uT6K665ZCN56ewJyB9LFxyXG4gICAgeyBmaWVsZDogJ2NvbmNsdXNpb25WYWx1ZScsIHdpZHRoOiAyNSwgdGl0bGU6ICfnu5PorrrlgLwnIH0sXHJcbiAgICB7IGZpZWxkOiAnY2FsY3VsYXRlVHlwZScsIHdpZHRoOiA0MCwgdGl0bGU6ICforqHnrpfmlrnlvI8nLFxyXG4gICAgICBmb3JtYXR0ZXI6IHt0eXBlOiAnZW51bScsb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICd0ZXh0JywgZGF0YTogdGhpcy5jYWxjdWxhdGlvbk1ldGhvZHMgfX0sXHJcbiAgICAgIGVkaXRvcjoge3R5cGU6IEVkaXRvclR5cGVzLkNPTUJPTElTVCxvcHRpb25zOiB7IHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ3RleHQnLCBkYXRhOiB0aGlzLmNhbGN1bGF0aW9uTWV0aG9kcywgaWRGaWVsZDogJ3ZhbHVlJywgcGFuZWxIZWlnaHQ6ICdhdXRvJyB9fVxyXG4gICAgfSxcclxuICAgIHsgZmllbGQ6ICdjb25kaXRpb25WYWx1ZScsIHdpZHRoOiAyNSwgdGl0bGU6ICfmnaHku7blgLwnLFxyXG4gICAgICBlZGl0b3I6IHsgdHlwZTogRWRpdG9yVHlwZXMuTlVNQkVSQk9YLCBvcHRpb25zOiB7fSB9LFxyXG4gICAgICBmb3JtYXR0ZXI6e3R5cGU6ICdudW1iZXInLCBvcHRpb25zOiB7IHByZWNpc2lvbjogMCwgbWluOiAwIH0gfVxyXG4gICAgfSxcclxuICAgIHsgZmllbGQ6ICd3YWl0QWxsVm90ZXMnLCB3aWR0aDogMzUsIHRpdGxlOiAn562J5b6F5YWo5ZGY5Yqe57uTJyxcclxuICAgICAgZWRpdG9yOiB7IHR5cGU6IEVkaXRvclR5cGVzLlNXSVRDSCwgb3B0aW9uczoge30gfSxcclxuICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdib29sZWFuJywgb3B0aW9uczogeyB0cnVlVGV4dDogJ+aYrycsIGZhbHNlVGV4dDogJ+WQpicgfX1cclxuICAgIH0sXHJcbiAgICB7IGZpZWxkOiAnY29tcGxldGlvbkNvbmRpdGlvbicsIHdpZHRoOiA1MCwgdGl0bGU6ICfoh6rlrprkuYnmnaHku7YnLFxyXG4gICAgICBlZGl0b3I6IHtcclxuICAgICAgICB0eXBlOiAnaW5wdXQtZ3JvdXAnLFxyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgIGdyb3VwVGV4dDogJzxpIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1sb29rdXBcIj48L2k+JyxcclxuICAgICAgICAgIGVkaXRhYmxlOiBmYWxzZSxcclxuICAgICAgICAgIGNsaWNrSGFuZGxlOiAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLmZvcm1Db250cm9sLnNldFZhbHVlKGUuaW5zdGFuY2UudmFsdWUgPyBlLmluc3RhbmNlLnZhbHVlIDogJycpO1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRDb25kaXRvbihlKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjbGVhcjogKGUpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsZWFyJywgZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGZvcm1CdWlsZGVyOiBGb3JtQnVpbGRlcixcclxuICAgIHByaXZhdGUgbWVzc2FnZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBleHByU2VydmljZTogRXhwcmVzc2lvblNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGRlc2lnbmVyVUlTdGF0ZTogUHJvY2Vzc0Rlc2lnbmVyVUlTdGF0ZSxcclxuICApIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuY291bnRlclNpZ25WYXJpYWJsZXMgPSB0aGlzLmRlc2lnbmVyVUlTdGF0ZS5jb3VudGVyU2lnblZhcmlhYmxlcyB8fCBbXTtcclxuICAgIHRoaXMuYXBwcm92YWxJdGVtcyA9IHRoaXMuZGVzaWduZXJVSVN0YXRlLmFwcHJvdmFsSXRlbXMgfHwgW107XHJcbiAgfVxyXG4gIC8vIOmHjee9ruWKqOS9nFxyXG4gIGRlbGV0ZVJvdygpIHtcclxuICAgIHRoaXMuZGF0YSA9IFtdO1xyXG4gICAgY29uc3QgcnVsZUl0ZW1zID0gdGhpcy5kZXNpZ25lclVJU3RhdGUuYXBwcm92YWxJdGVtcyB8fCBbXTtcclxuICAgIGlmIChydWxlSXRlbXMgJiYgcnVsZUl0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBydWxlSXRlbSBvZiBydWxlSXRlbXMpIHtcclxuICAgICAgICBjb25zdCB2YWwgPSBuZXcgU2lnblJ1bGVFbnRpdHkoKTtcclxuICAgICAgICBpZiAocnVsZUl0ZW0udmFsdWUgPT09ICdQYXNzJykge1xyXG4gICAgICAgICAgdmFsLmlkID0gUHJvY2Vzc0RlVXRpbC5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgICAgICAgdmFsLmNvbmNsdXNpb25WYWx1ZSA9IHJ1bGVJdGVtLnZhbHVlO1xyXG4gICAgICAgICAgdmFsLmNvbmNsdXNpb25OYW1lID0gcnVsZUl0ZW0udGV4dDtcclxuICAgICAgICAgIHZhbC5jYWxjdWxhdGVUeXBlID0gJ2J5UHJvcG9ydGlvbic7XHJcbiAgICAgICAgICB2YWwuY29uZGl0aW9uVmFsdWUgPSAnMTAwJztcclxuICAgICAgICAgIHZhbC53YWl0QWxsVm90ZXMgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocnVsZUl0ZW0udmFsdWUgPT09ICdCYWNrJykge1xyXG4gICAgICAgICAgdmFsLmlkID0gUHJvY2Vzc0RlVXRpbC5HZW5lcmF0ZUVsZW1lbnRJZCgpO1xyXG4gICAgICAgICAgdmFsLmNvbmNsdXNpb25WYWx1ZSA9IHJ1bGVJdGVtLnZhbHVlO1xyXG4gICAgICAgICAgdmFsLmNvbmNsdXNpb25OYW1lID0gcnVsZUl0ZW0udGV4dDtcclxuICAgICAgICAgIHZhbC5jYWxjdWxhdGVUeXBlID0gJ2J5TnVtYmVyJztcclxuICAgICAgICAgIHZhbC5jb25kaXRpb25WYWx1ZSA9ICcxJztcclxuICAgICAgICAgIHZhbC53YWl0QWxsVm90ZXMgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YWwuaWQgPSBQcm9jZXNzRGVVdGlsLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICAgICAgICB2YWwuY29uY2x1c2lvblZhbHVlID0gcnVsZUl0ZW0udmFsdWU7XHJcbiAgICAgICAgICB2YWwuY29uY2x1c2lvbk5hbWUgPSBydWxlSXRlbS50ZXh0O1xyXG4gICAgICAgICAgdmFsLmNhbGN1bGF0ZVR5cGUgPSAnbnVsbCc7XHJcbiAgICAgICAgICB2YWwuY29uZGl0aW9uVmFsdWUgPSAnMCc7XHJcbiAgICAgICAgICB2YWwud2FpdEFsbFZvdGVzID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kYXRhLnB1c2godmFsKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xpY2tPSygpIHtcclxuICAgIHRoaXMuZ3JpZC5lbmRDZWxsRWRpdCgpO1xyXG4gICAgaWYgKHRoaXMuZGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLndhcm5pbmcoJ+WujOaIkOetlueVpeS4uuS8muetvuaXtu+8jOS8muetvuinhOWImeS4jeWFgeiuuOS4uuepuu+8jOivt+S6huino++8gScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3Qgb2JqZWN0ID0geyB2YWx1ZTogdGhpcy5kYXRhLCBwYXJhbWV0ZXJzOiBudWxsIH07XHJcbiAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdChvYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xpY2tDYW5jZWwoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgZWRpdENvbmRpdG9uKGU6IGFueSkge1xyXG4gICAgaWYgKHRoaXMuY291bnRlclNpZ25WYXJpYWJsZXMgJiYgdGhpcy5jb3VudGVyU2lnblZhcmlhYmxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5jb3VudGVyU2lnblZhcmlhYmxlcykge1xyXG4gICAgICAgIHRoaXMuZXhwclNlcnZpY2UuYWRkQ29udGV4dCh2YXJpYWJsZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZXhwclNlcnZpY2Uuc2V0RWRpdFBhdHRlcm4oRXhwckVkaXRNb2RlLkFkdmFuY2VkKTsgLy8g6KGo6L6+5byP5bGV546w5qih5byP77ya6buY6K6k6auY57qn54mI77yI5Lya562+6KeE5YiZ6ZyA6KaB5LiK5LiL5paH5Y+Y6YeP77yJXHJcbiAgICB0aGlzLmV4cHJTZXJ2aWNlLmFkZEV4cHJlc3Npb25UZXh0KGUuaW5zdGFuY2UudmFsdWUpO1xyXG4gICAgdGhpcy5leHByU2VydmljZS5idWlsZEV4cHJlc3Npb24oKS50aGVuKChjb25kOiBzdHJpbmcpID0+IHtcclxuICAgICAgZS5mb3JtQ29udHJvbC5zZXRWYWx1ZShjb25kKTtcclxuICAgICAgZS5pbnN0YW5jZS5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOmAieS4reWuoeaJuemhuVxyXG4gICAqL1xyXG4gIGFwcHJvdmFsU2VsZWN0KCkge1xyXG4gICAgY29uc3Qgc2VsZWN0aW9uczogYW55W10gPSB0aGlzLmFwdmxJdGVtc0dyaWQuY2hlY2tlZHM7XHJcbiAgICBpZiAoc2VsZWN0aW9ucyAmJiBzZWxlY3Rpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChjb25zdCBzZWxlY3Rpb24gb2Ygc2VsZWN0aW9ucykge1xyXG4gICAgICAgIGNvbnN0IHNpZ25SdWxlID0gbmV3IFNpZ25SdWxlRW50aXR5KCk7XHJcbiAgICAgICAgc2lnblJ1bGUuaWQgPSBQcm9jZXNzRGVVdGlsLkdlbmVyYXRlRWxlbWVudElkKCk7XHJcbiAgICAgICAgc2lnblJ1bGUuY29uY2x1c2lvblZhbHVlID0gc2VsZWN0aW9uLmRhdGEudmFsdWU7XHJcbiAgICAgICAgc2lnblJ1bGUuY29uY2x1c2lvbk5hbWUgPSBzZWxlY3Rpb24uZGF0YS50ZXh0O1xyXG4gICAgICAgIHRoaXMuZGF0YS5wdXNoKHNpZ25SdWxlKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmdyaWQubG9hZERhdGEodGhpcy5kYXRhKTtcclxuICAgICAgdGhpcy5hcHZsSXRlbURpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+ivt+mmluWFiOmAieS4reS4gOadoeWuoeaJuemhue+8gScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIHByZVZhbHVlOiBTaWduUnVsZUVudGl0eTtcclxuICBjdXJWYWx1ZTogU2lnblJ1bGVFbnRpdHk7XHJcbi8qKlxyXG4gKiDnu5PmnZ/nvJbovpHliY3kuovku7ZcclxuICovXHJcbiAgYWZ0ZXJFZGl0ID0gKHJvd0luZGV4OiBudW1iZXIsIHJvd0RhdGE6IGFueSwgY29sdW1uPzogRGF0YUNvbHVtbikgPT4ge1xyXG4gICAgdGhpcy5wcmVWYWx1ZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocm93RGF0YSkpO1xyXG4gICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZW5kRWRpdChlOiBhbnkpIHtcclxuICAgIHRoaXMuY3VyVmFsdWUgPSBlLnJvd0RhdGE7XHJcbiAgICAvLyDoh6rlrprkuYnkvJrnrb7op4TliJnlkozpooTnva7kvJrnrb7op4TliJnkupLmlqVcclxuICAgIGlmKHRoaXMucHJlVmFsdWUuY29tcGxldGlvbkNvbmRpdGlvbiAhPT0gdGhpcy5jdXJWYWx1ZS5jb21wbGV0aW9uQ29uZGl0aW9uKSB7XHJcbiAgICAgIHRoaXMuZGF0YVtlLnJvd0luZGV4XS5jYWxjdWxhdGVUeXBlID0gJ251bGwnLFxyXG4gICAgICB0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29uZGl0aW9uVmFsdWUgPSAnMCc7XHJcbiAgICAgIHRoaXMuZGF0YVtlLnJvd0luZGV4XS53YWl0QWxsVm90ZXMgPSBmYWxzZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5wcmVWYWx1ZS5jYWxjdWxhdGVUeXBlICE9PSB0aGlzLmN1clZhbHVlLmNhbGN1bGF0ZVR5cGUgfHxcclxuICAgICAgdGhpcy5wcmVWYWx1ZS5jb25kaXRpb25WYWx1ZSAhPT0gdGhpcy5jdXJWYWx1ZS5jb25kaXRpb25WYWx1ZSB8fFxyXG4gICAgICB0aGlzLnByZVZhbHVlLndhaXRBbGxWb3RlcyAhPT0gdGhpcy5jdXJWYWx1ZS53YWl0QWxsVm90ZXMpIHtcclxuICAgICAgICB0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29tcGxldGlvbkNvbmRpdGlvbiA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoZS5jb2x1bW4uZmllbGQgPT09ICdjb25kaXRpb25WYWx1ZScgJiYgdGhpcy5kYXRhW2Uucm93SW5kZXhdLmNhbGN1bGF0ZVR5cGUgPT09ICdieVByb3BvcnRpb24nXHJcbiAgICAmJiBOdW1iZXIucGFyc2VJbnQoZS52YWx1ZSkgPiAxMDApIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+adoeS7tuWAvOacgOWkp+WAvOaYrzEwMCcpO1xyXG4gICAgICB0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29uZGl0aW9uVmFsdWUgPSAnMTAwJztcclxuICAgIH0gZWxzZSBpZiAoZS5jb2x1bW4uZmllbGQgPT09ICdjb25kaXRpb25WYWx1ZScgJiYgTnVtYmVyLnBhcnNlSW50KGUudmFsdWUpIDwgMCkge1xyXG4gICAgICB0aGlzLm1lc3NhZ2UuaW5mbygn5p2h5Lu25YC85pyA5bCP5YC85pivMCcpO1xyXG4gICAgICB0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29uZGl0aW9uVmFsdWUgPSAnMCc7XHJcbiAgICB9IGVsc2UgaWYgKChlLmNvbHVtbi5maWVsZCA9PT0gJ2NhbGN1bGF0ZVR5cGUnIHx8IGUuY29sdW1uLmZpZWxkID09PSAnY29uZGl0aW9uVmFsdWUnKSAmJiAodGhpcy5kYXRhW2Uucm93SW5kZXhdLmNhbGN1bGF0ZVR5cGUgPT09ICdvbmVWb3RlJyB8fFxyXG4gICAgdGhpcy5kYXRhW2Uucm93SW5kZXhdLmNhbGN1bGF0ZVR5cGUgPT09ICdmdWxsVm90ZScpICYmIE51bWJlci5wYXJzZUludCh0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29uZGl0aW9uVmFsdWUpICE9PSAwKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZS5pbmZvKCfnu5PorrrmiafooYzmlrnlvI/kuLrlhajnpajmiJbkuIDnpajml7bkuI3pnIDopoHmnaHku7blgLwnKTtcclxuICAgICAgdGhpcy5kYXRhW2Uucm93SW5kZXhdLmNvbmRpdGlvblZhbHVlID0gJzAnO1xyXG4gICAgfSBlbHNlIGlmIChlLmNvbHVtbi5maWVsZCA9PT0gJ2NhbGN1bGF0ZVR5cGUnICYmIHRoaXMuZGF0YVtlLnJvd0luZGV4XS5jYWxjdWxhdGVUeXBlID09PSAnYnlQcm9wb3J0aW9uJyAmJlxyXG4gICAgTnVtYmVyLnBhcnNlSW50KHRoaXMuZGF0YVtlLnJvd0luZGV4XS5jb25kaXRpb25WYWx1ZSkgPiAxMDApIHtcclxuICAgICAgdGhpcy5tZXNzYWdlLmluZm8oJ+adoeS7tuWAvOacgOWkp+WAvOaYrzEwMCcpO1xyXG4gICAgICB0aGlzLmRhdGFbZS5yb3dJbmRleF0uY29uZGl0aW9uVmFsdWUgPSAnMTAwJztcclxuICAgICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNpZ25SdWxlQ29udmVydGVyIGltcGxlbWVudHMgVHlwZUNvbnZlcnRlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgY29udmVydFRvKGRhdGE6IGFueVtdKTogc3RyaW5nIHtcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gJ++8iOW3suiuvue9ru+8iSc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gJ++8iOacquiuvue9ru+8iSc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==