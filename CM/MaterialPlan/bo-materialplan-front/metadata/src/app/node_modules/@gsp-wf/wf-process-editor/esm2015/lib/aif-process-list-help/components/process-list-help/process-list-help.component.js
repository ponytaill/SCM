/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, EventEmitter, Inject, LOCALE_ID, Output, Input } from '@angular/core';
import { ProcessListHelpService } from '../../services/process-list-help.service';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from '@farris/ui-modal';
import { FrameworkService } from '@gsp-sys/rtf-common';
import { Router, ActivatedRoute } from '@angular/router';
import { LoadingService } from '@farris/ui-loading';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { BifMetadataType } from '../../entity/BifMetadataType';
import { ProcessFilterConditionArgs } from '../../entity/ProcessFilterConditionArgs';
import { TextValue } from '@edp-bif/common-api';
import { OrderByDirection } from '../../entity/OrderByDirection';
import { DatagridComponent } from '@farris/ui-datagrid';
import { AifLocalePipe } from '../../../aif-ui-common/pipe/aif-ui-common-locale.pipe';
export class ProcessListHelpComponent {
    /**
     * @param {?} procHelpService
     * @param {?} messager
     * @param {?} notify
     * @param {?} modalService
     * @param {?} frameworkService
     * @param {?} router
     * @param {?} activatedRoute
     * @param {?} loading
     * @param {?} localeId
     * @param {?} localePipe
     */
    constructor(procHelpService, messager, notify, modalService, frameworkService, router, activatedRoute, loading, localeId, localePipe) {
        this.procHelpService = procHelpService;
        this.messager = messager;
        this.notify = notify;
        this.modalService = modalService;
        this.frameworkService = frameworkService;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.loading = loading;
        this.localePipe = localePipe;
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.editorParams = {};
        this.modalConfig = {
            title: '生单流程选择',
            width: 1250,
            height: 500,
            showButtons: true
        };
        this.procEmitter = new EventEmitter();
        this.ttIdField = "id";
        this.ttData = [];
        this.ttColumns = [];
        this.cascadeCheck = false;
        this.cascadeDown = false;
        this.cascadeUp = false;
        this.defaultPageSize = 30;
        this.pageList = [this.defaultPageSize, 50, 100, 200, 500];
        /**
         * 列排序前事件
         */
        this.beforeSortColumn = (/**
         * @param {?} field
         * @param {?} order
         * @return {?}
         */
        (field, order) => {
            /** @type {?} */
            let cols = field.split(",");
            /** @type {?} */
            let orders = order.split(",");
            //重置排序条件
            this.queryParam.filterArgs.orderByCode = null;
            this.queryParam.filterArgs.orderByName = null;
            this.queryParam.filterArgs.OrderByLastModifiedTime = null;
            //依次添加排序条件
            for (let i = 0; i < cols.length; i++) {
                /** @type {?} */
                let orderBy = null;
                if (orders[i] == "asc") {
                    orderBy = new TextValue();
                    orderBy.hasValue = true;
                    orderBy.value = OrderByDirection.Asc;
                }
                else if (orders[i] == "desc") {
                    orderBy = new TextValue();
                    orderBy.hasValue = true;
                    orderBy.value = OrderByDirection.Desc;
                }
                if (cols[i] == "code") {
                    this.queryParam.filterArgs.orderByCode = orderBy;
                }
                else if (cols[i] == "name") {
                    this.queryParam.filterArgs.orderByName = orderBy;
                }
                else if (cols[i] == "lastModifiedTime") {
                    this.queryParam.filterArgs.OrderByLastModifiedTime = orderBy;
                }
            }
            return this.loadItems(this.queryParam.filterArgs);
        });
        this.queryParam = this.createDefaultQueryParam();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set value(data) {
        if (data) {
            this.processCode = data;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.configTtColumns();
        if (this.editorParams && this.editorParams.bizTypeId) {
            this.queryParam.filterArgs.bizType = new TextValue();
            this.queryParam.filterArgs.bizType.value = this.editorParams.bizTypeId;
            this.queryParam.filterArgs.bizType.hasValue = true;
        }
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                if (this.ttData && this.ttData.length > 0) {
                    /** @type {?} */
                    const proc = this.processCode != null ? this.ttData.find((/**
                     * @param {?} it
                     * @return {?}
                     */
                    (it) => it.code == this.processCode)) : this.ttData[0];
                    proc && this.tt.selectRow(proc.id);
                }
            }), 300);
        }));
    }
    /**
     * @param {?=} evt
     * @return {?}
     */
    clickOk(evt) {
        if (this.tt.selectedRow == null) {
            this.notify.warning(this.localePipe.transform("pleaseSelectOneItemOnly"));
            return;
        }
        this.procEmitter.emit(this.tt.selectedRow.data);
        /** @type {?} */
        const object = { value: this.tt.selectedRow.data.code, parameters: null };
        this.submitModal.emit(object);
        this.modalRef && this.modalRef.close();
    }
    /**
     * @param {?=} evt
     * @return {?}
     */
    clickCancel(evt) {
        this.procEmitter.complete();
        this.closeModal.emit();
        this.modalRef && this.modalRef.close();
    }
    /**
     * @param {?} param
     * @return {?}
     */
    onSearch(param) {
        this.queryParam = param;
        console.log(this.queryParam);
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            this.tt.clearCheckeds();
            this.tt.clearSelections();
        }));
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    clickNameCell(ctx) {
        this.procHelpService.openBifManagerApp(ctx.rowData);
    }
    /**
     * 列排序后事件
     * @param {?} val
     * @return {?}
     */
    columnSorted(val) {
        console.log(val);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPageSizeChanged($event) {
        console.log('PageSize Changed:', $event);
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds);
            }), 0);
        }));
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPageChanged($event) {
        console.log('PageNumber Changed:', $event);
        /** @type {?} */
        let checkedIds = this.tt.checkeds.map((/**
         * @param {?} r
         * @return {?}
         */
        r => r.data.id));
        this.queryParam.filterArgs.pageIndex = $event.pageIndex - 1;
        this.queryParam.filterArgs.pageSize = $event.pageSize;
        this.loadItems(this.queryParam.filterArgs).subscribe((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.tt.checkRows(checkedIds);
            }), 0);
        }));
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    pageChangeHandler($event) {
        console.log($event);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    pageSizeChangeHandler($event) {
        console.log($event);
    }
    /**
     * @private
     * @param {?} args
     * @return {?}
     */
    loadItems(args) {
        /** @type {?} */
        const loadingComp = this.loading.show({ message: this.localePipe.transform("loading") });
        return this.procHelpService.getDatagridData(args).pipe(switchMap((/**
         * @param {?} listRes
         * @return {?}
         */
        (listRes) => {
            this.ttData = [...listRes.entities];
            //更新分页信息
            this.tt.setPageIndex(listRes.pageIndex + 1);
            this.tt.total = listRes.totalCount;
            this.tt.pageSize = listRes.pageSize;
            // this.page.setCurrentPage(this.paginationId, listRes.pageIndex + 1);
            // this.page.setItemsPerPage(this.paginationId, listRes.pageSize);
            // this.page.setTotalItems(this.paginationId, listRes.totalCount);
            loadingComp.close();
            return of(listRes);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            loadingComp.close();
            setTimeout((/**
             * @return {?}
             */
            () => {
                //todo 确定异常结构, 目前采用兼容取值方式
                this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }), 300);
            throw err;
        })));
    }
    /**
     * @private
     * @return {?}
     */
    configTtColumns() {
        this.ttColumns = [
            // {
            //   field: "isEnabled", title: this.localePipe.transform("enabledState"), width: 100, sortable: false,
            //   formatter: (value: boolean, rowData, rowIndex) => {
            //     if (value == true) {
            //       return this.localePipe.transform("enabled");
            //     } else if (value == false) {
            //       return this.localePipe.transform("disabled");
            //     } else {
            //       return "-";
            //     }
            //   }
            // },
            { field: "code", title: this.localePipe.transform("code"), width: 120, sortable: true },
            {
                field: "name", title: this.localePipe.transform("name"), width: 250, sortable: true,
                template: this.nameCellTemp,
            },
            { field: "upBillVoName", title: this.localePipe.transform("upBill"), width: 120, sortable: true },
            { field: "downBillVoName", title: this.localePipe.transform("downBill"), width: 120, sortable: true },
        ];
    }
    /**
     * @private
     * @return {?}
     */
    createDefaultQueryParam() {
        /** @type {?} */
        const queryParam = {
            filterArgs: new ProcessFilterConditionArgs(),
            filterArgsExt: {}
        };
        queryParam.filterArgs.pageSize = this.defaultPageSize;
        queryParam.filterArgs.pageIndex = 0;
        queryParam.filterArgs.OrderByLastModifiedTime = new TextValue();
        queryParam.filterArgs.OrderByLastModifiedTime.value = OrderByDirection.Desc;
        queryParam.filterArgs.OrderByLastModifiedTime.hasValue = true;
        queryParam.filterArgs.billProcessType = new TextValue();
        queryParam.filterArgs.billProcessType.value = BifMetadataType.BifCreationProcess;
        queryParam.filterArgs.billProcessType.hasValue = true;
        queryParam.filterArgs.isEnabled = new TextValue();
        queryParam.filterArgs.isEnabled.value = "true";
        queryParam.filterArgs.isEnabled.hasValue = true;
        return queryParam;
    }
}
ProcessListHelpComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-process-list-help',
                template: "<div class=\"f-page f-page-is-managelist\" id=\"bif-manager-list\">\r\n  <!-- <app-proc-help-query-solution id=\"query-solution\" #querySolution [(queryParam)]=\"queryParam\"\r\n    (onSearch)=\"onSearch($event)\">\r\n  </app-proc-help-query-solution> -->\r\n\r\n  <div class=\"f-page-main\" id=\"page-main\">\r\n    <div class=\"f-utils-fill-flex-column\">\r\n      <farris-datagrid id=\"tt\" #tt [data]=\"ttData\" [columns]=\"ttColumns\" [idField]=\"ttIdField\" [multiSelect]=\"true\"\r\n        [showCheckbox]=\"false\" [showAllCheckbox]=\"false\" [onlySelectSelf]=\"true\" [keepSelect]=\"true\"\r\n        [selectOnCheck]=\"true\" [checkOnSelect]=\"false\" [showHeader]=\"true\" [fit]=\"true\" [fitColumns]=\"true\"\r\n        [pagination]=\"true\" [showPageList]=\"true\" [pageSize]=\"defaultPageSize\" [pageList]=\"pageList\"\r\n        (pageChanged)=\"onPageChanged($event)\" (pageSizeChanged)=\"onPageSizeChanged($event)\" [remoteSort]=\"true\"\r\n        [multiSort]=\"false\" [beforeSortColumn]=\"beforeSortColumn\" (columnSorted)=\"columnSorted($event)\">\r\n      </farris-datagrid>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #nameCellTemp let-ctx>\r\n  <a href=\"javascript: void(0);\" (click)=\"clickNameCell(ctx)\">{{ctx?.rowData?.name}}</a>\r\n</ng-template>\r\n\r\n<ng-template #iconSelectFooter>\r\n  <button type=\"button\" class=\"btn btn-primary btn-sm px-3 mx-2\" (click)=\"clickOk()\">\u786E\u5B9A</button>\r\n  <button type=\"button\" class=\"btn btn-secondary btn-sm px-3 mx-2\" (click)=\"clickCancel()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                styles: [""]
            }] }
];
/** @nocollapse */
ProcessListHelpComponent.ctorParameters = () => [
    { type: ProcessListHelpService },
    { type: MessagerService },
    { type: NotifyService },
    { type: BsModalService },
    { type: FrameworkService },
    { type: Router },
    { type: ActivatedRoute },
    { type: LoadingService },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
    { type: AifLocalePipe }
];
ProcessListHelpComponent.propDecorators = {
    closeModal: [{ type: Output }],
    submitModal: [{ type: Output }],
    value: [{ type: Input }],
    editorParams: [{ type: Input }],
    tt: [{ type: ViewChild, args: ["tt",] }],
    nameCellTemp: [{ type: ViewChild, args: ['nameCellTemp',] }],
    modalFooter: [{ type: ViewChild, args: ['iconSelectFooter',] }]
};
if (false) {
    /** @type {?} */
    ProcessListHelpComponent.prototype.closeModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.submitModal;
    /** @type {?} */
    ProcessListHelpComponent.prototype.editorParams;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.processCode;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalConfig;
    /** @type {?} */
    ProcessListHelpComponent.prototype.procEmitter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.queryParam;
    /** @type {?} */
    ProcessListHelpComponent.prototype.tt;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttIdField;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttData;
    /** @type {?} */
    ProcessListHelpComponent.prototype.ttColumns;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeCheck;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeDown;
    /** @type {?} */
    ProcessListHelpComponent.prototype.cascadeUp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.nameCellTemp;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalFooter;
    /** @type {?} */
    ProcessListHelpComponent.prototype.modalRef;
    /** @type {?} */
    ProcessListHelpComponent.prototype.defaultPageSize;
    /** @type {?} */
    ProcessListHelpComponent.prototype.pageList;
    /**
     * 列排序前事件
     * @type {?}
     */
    ProcessListHelpComponent.prototype.beforeSortColumn;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.procHelpService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.frameworkService;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    ProcessListHelpComponent.prototype.localePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi1wcm9jZXNzLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi9haWYtcHJvY2Vzcy1saXN0LWhlbHAvY29tcG9uZW50cy9wcm9jZXNzLWxpc3QtaGVscC9wcm9jZXNzLWxpc3QtaGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsU0FBUyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTFILE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLGNBQWMsRUFBYyxNQUFNLGtCQUFrQixDQUFDO0FBQzlELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDL0QsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDckYsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXhELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx1REFBdUQsQ0FBQztBQU90RixNQUFNLE9BQU8sd0JBQXdCOzs7Ozs7Ozs7Ozs7O0lBOENuQyxZQUNVLGVBQXVDLEVBQ3ZDLFFBQXlCLEVBQ3pCLE1BQXFCLEVBQ3JCLFlBQTRCLEVBQzVCLGdCQUFrQyxFQUNsQyxNQUFjLEVBQ2QsY0FBOEIsRUFDOUIsT0FBdUIsRUFDWixRQUFnQixFQUMzQixVQUF5QjtRQVR6QixvQkFBZSxHQUFmLGVBQWUsQ0FBd0I7UUFDdkMsYUFBUSxHQUFSLFFBQVEsQ0FBaUI7UUFDekIsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUNyQixpQkFBWSxHQUFaLFlBQVksQ0FBZ0I7UUFDNUIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUNsQyxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLFlBQU8sR0FBUCxPQUFPLENBQWdCO1FBRXZCLGVBQVUsR0FBVixVQUFVLENBQWU7UUF2RHpCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3JDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQVN2QyxpQkFBWSxHQUVqQixFQUFFLENBQUM7UUFHUCxnQkFBVyxHQUFHO1lBQ1osS0FBSyxFQUFFLFFBQVE7WUFDZixLQUFLLEVBQUUsSUFBSTtZQUNYLE1BQU0sRUFBRSxHQUFHO1lBQ1gsV0FBVyxFQUFFLElBQUk7U0FDbEIsQ0FBQztRQUVGLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUt0QyxjQUFTLEdBQVcsSUFBSSxDQUFDO1FBQ3pCLFdBQU0sR0FBVSxFQUFFLENBQUM7UUFDbkIsY0FBUyxHQUFVLEVBQUUsQ0FBQztRQUN0QixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUNyQixnQkFBVyxHQUFHLEtBQUssQ0FBQztRQUNwQixjQUFTLEdBQUcsS0FBSyxDQUFDO1FBVVQsb0JBQWUsR0FBVyxFQUFFLENBQUM7UUFDdEMsYUFBUSxHQUFHLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQzs7OztRQXFFckQscUJBQWdCOzs7OztRQUFHLENBQUMsS0FBYSxFQUFFLEtBQWEsRUFBRSxFQUFFOztnQkFDOUMsSUFBSSxHQUFhLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDOztnQkFDakMsTUFBTSxHQUFhLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO1lBRXZDLFFBQVE7WUFDUixJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1lBQzlDLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDOUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDO1lBQzFELFVBQVU7WUFDVixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTs7b0JBQ2hDLE9BQU8sR0FBRyxJQUFJO2dCQUNsQixJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLEVBQUU7b0JBQ3RCLE9BQU8sR0FBRyxJQUFJLFNBQVMsRUFBRSxDQUFDO29CQUMxQixPQUFPLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztvQkFDeEIsT0FBTyxDQUFDLEtBQUssR0FBRyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUM7aUJBQ3RDO3FCQUFNLElBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLE1BQU0sRUFBRTtvQkFDOUIsT0FBTyxHQUFHLElBQUksU0FBUyxFQUFFLENBQUM7b0JBQzFCLE9BQU8sQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO29CQUN4QixPQUFPLENBQUMsS0FBSyxHQUFHLGdCQUFnQixDQUFDLElBQUksQ0FBQztpQkFDdkM7Z0JBRUQsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksTUFBTSxFQUFFO29CQUNyQixJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDO2lCQUNsRDtxQkFBTSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxNQUFNLEVBQUU7b0JBQzVCLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUM7aUJBQ2xEO3FCQUFNLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLGtCQUFrQixFQUFFO29CQUN4QyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsR0FBRyxPQUFPLENBQUM7aUJBQzlEO2FBQ0Y7WUFFRCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNwRCxDQUFDLEVBQUM7UUF0RkEsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztJQUNuRCxDQUFDOzs7OztJQXZERCxJQUNJLEtBQUssQ0FBQyxJQUFTO1FBQ2pCLElBQUksSUFBSSxFQUFFO1lBQ1IsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7U0FDekI7SUFDSCxDQUFDOzs7O0lBb0RELFFBQVE7UUFDTixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDdkIsSUFBSSxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFO1lBQ3BELElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxJQUFJLFNBQVMsRUFBRSxDQUFDO1lBQ3JELElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUM7WUFDdkUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FDcEQ7UUFDRCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUzs7O1FBQUMsR0FBRyxFQUFFO1lBQ3hELFVBQVU7OztZQUFDLEdBQUcsRUFBRTtnQkFDZCxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFOzswQkFDbkMsSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUk7Ozs7b0JBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztvQkFDOUcsSUFBSSxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztpQkFDcEM7WUFDSCxDQUFDLEdBQUUsR0FBRyxDQUFDLENBQUM7UUFDVixDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7Ozs7O0lBRUQsT0FBTyxDQUFDLEdBQUk7UUFDVixJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxJQUFJLElBQUksRUFBRTtZQUMvQixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLENBQUM7WUFDMUUsT0FBTztTQUNSO1FBQ0QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7O2NBQzFDLE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUU7UUFDekUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUIsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pDLENBQUM7Ozs7O0lBRUQsV0FBVyxDQUFDLEdBQUk7UUFDZCxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzVCLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pDLENBQUM7Ozs7O0lBRUQsUUFBUSxDQUFDLEtBQVU7UUFDakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDN0IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVM7OztRQUNsRCxHQUFHLEVBQUU7WUFDSCxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDNUIsQ0FBQyxFQUNGLENBQUM7SUFDSixDQUFDOzs7OztJQUVELGFBQWEsQ0FBQyxHQUFHO1FBQ2YsSUFBSSxDQUFDLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdEQsQ0FBQzs7Ozs7O0lBeUNELFlBQVksQ0FBQyxHQUFHO1FBQ2QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNuQixDQUFDOzs7OztJQUVELGlCQUFpQixDQUFDLE1BQStDO1FBQy9ELE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsTUFBTSxDQUFDLENBQUM7O1lBQ3JDLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQztRQUVyRCxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQztRQUN0RCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUzs7O1FBQ2xELEdBQUcsRUFBRTtZQUNILFVBQVU7OztZQUFDLEdBQUcsRUFBRTtnQkFDZCxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNoQyxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUM7UUFDUixDQUFDLEVBQ0YsQ0FBQztJQUNKLENBQUM7Ozs7O0lBRUQsYUFBYSxDQUFDLE1BQStDO1FBQzNELE9BQU8sQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsTUFBTSxDQUFDLENBQUM7O1lBQ3ZDLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQztRQUVyRCxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDNUQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUM7UUFDdEQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVM7OztRQUNsRCxHQUFHLEVBQUU7WUFDSCxVQUFVOzs7WUFBQyxHQUFHLEVBQUU7Z0JBQ2QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDaEMsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ1IsQ0FBQyxFQUNGLENBQUM7SUFDSixDQUFDOzs7OztJQUVELGlCQUFpQixDQUFDLE1BQU07UUFDdEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN0QixDQUFDOzs7OztJQUVELHFCQUFxQixDQUFDLE1BQU07UUFDMUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN0QixDQUFDOzs7Ozs7SUFFTyxTQUFTLENBQUMsSUFBZ0M7O2NBQzFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1FBQ3hGLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUNwRCxTQUFTOzs7O1FBQ1AsQ0FBQyxPQUFnQyxFQUFFLEVBQUU7WUFDbkMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3BDLFFBQVE7WUFDUixJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQzVDLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7WUFDbkMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztZQUNwQyxzRUFBc0U7WUFDdEUsa0VBQWtFO1lBQ2xFLGtFQUFrRTtZQUVsRSxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDcEIsT0FBTyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDckIsQ0FBQyxFQUNGLEVBQ0QsVUFBVTs7OztRQUNSLENBQUMsR0FBRyxFQUFFLEVBQUU7WUFDTixXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDcEIsVUFBVTs7O1lBQUMsR0FBRyxFQUFFO2dCQUNkLHlCQUF5QjtnQkFDekIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDakgsQ0FBQyxHQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQ1IsTUFBTSxHQUFHLENBQUM7UUFDWixDQUFDLEVBQ0YsQ0FDRixDQUFDO0lBQ0osQ0FBQzs7Ozs7SUFFTyxlQUFlO1FBQ3JCLElBQUksQ0FBQyxTQUFTLEdBQUc7WUFDZixJQUFJO1lBQ0osdUdBQXVHO1lBQ3ZHLHdEQUF3RDtZQUN4RCwyQkFBMkI7WUFDM0IscURBQXFEO1lBQ3JELG1DQUFtQztZQUNuQyxzREFBc0Q7WUFDdEQsZUFBZTtZQUNmLG9CQUFvQjtZQUNwQixRQUFRO1lBQ1IsTUFBTTtZQUNOLEtBQUs7WUFDTCxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtZQUN2RjtnQkFDRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxJQUFJO2dCQUNuRixRQUFRLEVBQUUsSUFBSSxDQUFDLFlBQVk7YUFDNUI7WUFDRCxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtZQUNqRyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFO1NBZ0R0RyxDQUFDO0lBQ0osQ0FBQzs7Ozs7SUFFTyx1QkFBdUI7O2NBQ3ZCLFVBQVUsR0FBRztZQUNqQixVQUFVLEVBQUUsSUFBSSwwQkFBMEIsRUFBRTtZQUM1QyxhQUFhLEVBQUUsRUFBRTtTQUNsQjtRQUVELFVBQVUsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDdEQsVUFBVSxDQUFDLFVBQVUsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLFVBQVUsQ0FBQyxVQUFVLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxTQUFTLEVBQUUsQ0FBQztRQUNoRSxVQUFVLENBQUMsVUFBVSxDQUFDLHVCQUF1QixDQUFDLEtBQUssR0FBRyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUM7UUFDNUUsVUFBVSxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQzlELFVBQVUsQ0FBQyxVQUFVLENBQUMsZUFBZSxHQUFHLElBQUksU0FBUyxFQUFFLENBQUM7UUFDeEQsVUFBVSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsS0FBSyxHQUFHLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQztRQUNqRixVQUFVLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ3RELFVBQVUsQ0FBQyxVQUFVLENBQUMsU0FBUyxHQUFHLElBQUksU0FBUyxFQUFFLENBQUM7UUFDbEQsVUFBVSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztRQUMvQyxVQUFVLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBR2hELE9BQU8sVUFBVSxDQUFDO0lBQ3BCLENBQUM7OztZQTdURixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLHVCQUF1QjtnQkFDakMsOGpEQUFpRDs7YUFFbEQ7Ozs7WUF0QlEsc0JBQXNCO1lBQ3RCLGVBQWU7WUFDZixhQUFhO1lBQ2IsY0FBYztZQUNkLGdCQUFnQjtZQUNoQixNQUFNO1lBQUUsY0FBYztZQUN0QixjQUFjO3lDQXdFbEIsTUFBTSxTQUFDLFNBQVM7WUE5RFosYUFBYTs7O3lCQVFuQixNQUFNOzBCQUNOLE1BQU07b0JBRU4sS0FBSzsyQkFPTCxLQUFLO2lCQWVMLFNBQVMsU0FBQyxJQUFJOzJCQVNkLFNBQVMsU0FBQyxjQUFjOzBCQUd4QixTQUFTLFNBQUMsa0JBQWtCOzs7O0lBckM3Qiw4Q0FBK0M7O0lBQy9DLCtDQUFnRDs7SUFTaEQsZ0RBRU87Ozs7O0lBRVAsK0NBQTRCOztJQUM1QiwrQ0FLRTs7SUFFRiwrQ0FBc0M7O0lBQ3RDLDhDQUE4Qjs7SUFFOUIsc0NBQ3NCOztJQUN0Qiw2Q0FBeUI7O0lBQ3pCLDBDQUFtQjs7SUFDbkIsNkNBQXNCOztJQUN0QixnREFBcUI7O0lBQ3JCLCtDQUFvQjs7SUFDcEIsNkNBQWtCOztJQUVsQixnREFDK0I7O0lBRS9CLCtDQUM4Qjs7SUFFOUIsNENBQXFCOztJQUVyQixtREFBc0M7O0lBQ3RDLDRDQUFxRDs7Ozs7SUFxRXJELG9EQStCRTs7Ozs7SUFqR0EsbURBQStDOzs7OztJQUMvQyw0Q0FBaUM7Ozs7O0lBQ2pDLDBDQUE2Qjs7Ozs7SUFDN0IsZ0RBQW9DOzs7OztJQUNwQyxvREFBMEM7Ozs7O0lBQzFDLDBDQUFzQjs7Ozs7SUFDdEIsa0RBQXNDOzs7OztJQUN0QywyQ0FBK0I7Ozs7O0lBRS9CLDhDQUFpQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBFdmVudEVtaXR0ZXIsIEluamVjdCwgTE9DQUxFX0lELCBPdXRwdXQsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZhcnJpc1NlY3Rpb25Db21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXNlY3Rpb24nO1xyXG5pbXBvcnQgeyBQcm9jZXNzTGlzdEhlbHBTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcHJvY2Vzcy1saXN0LWhlbHAuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgQnNNb2RhbFJlZiB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBGcmFtZXdvcmtTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zeXMvcnRmLWNvbW1vbic7XHJcbmltcG9ydCB7IFJvdXRlciwgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSVJ0UHJvY1F1ZXJ5UGFyYW0gfSBmcm9tICcuLi8uLi9lbnRpdHkvSVByb2NRdWVyeVBhcmFtJztcclxuaW1wb3J0IHsgQmlmTWV0YWRhdGFUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L0JpZk1ldGFkYXRhVHlwZSc7XHJcbmltcG9ydCB7IFByb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzIH0gZnJvbSAnLi4vLi4vZW50aXR5L1Byb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzJztcclxuaW1wb3J0IHsgVGV4dFZhbHVlIH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IE9yZGVyQnlEaXJlY3Rpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvT3JkZXJCeURpcmVjdGlvbic7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IFJ0QmlsbFByb2Nlc3NMaXN0UmVzdWx0IH0gZnJvbSAnLi4vLi4vZW50aXR5L1J0QmlsbFByb2Nlc3NMaXN0UmVzdWx0JztcclxuaW1wb3J0IHsgQWlmTG9jYWxlUGlwZSB9IGZyb20gJy4uLy4uLy4uL2FpZi11aS1jb21tb24vcGlwZS9haWYtdWktY29tbW9uLWxvY2FsZS5waXBlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLXByb2Nlc3MtbGlzdC1oZWxwJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcHJvY2Vzcy1saXN0LWhlbHAuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3Byb2Nlc3MtbGlzdC1oZWxwLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUHJvY2Vzc0xpc3RIZWxwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBzdWJtaXRNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB2YWx1ZShkYXRhOiBhbnkpIHtcclxuICAgIGlmIChkYXRhKSB7XHJcbiAgICAgIHRoaXMucHJvY2Vzc0NvZGUgPSBkYXRhO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgZWRpdG9yUGFyYW1zOiB7XHJcbiAgICBiaXpUeXBlSWQ/OiBzdHJpbmdcclxuICB9ID0ge307XHJcblxyXG4gIHByaXZhdGUgcHJvY2Vzc0NvZGU6IHN0cmluZztcclxuICBtb2RhbENvbmZpZyA9IHtcclxuICAgIHRpdGxlOiAn55Sf5Y2V5rWB56iL6YCJ5oupJyxcclxuICAgIHdpZHRoOiAxMjUwLFxyXG4gICAgaGVpZ2h0OiA1MDAsXHJcbiAgICBzaG93QnV0dG9uczogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIHByb2NFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgcXVlcnlQYXJhbTogSVJ0UHJvY1F1ZXJ5UGFyYW07XHJcblxyXG4gIEBWaWV3Q2hpbGQoXCJ0dFwiKVxyXG4gIHR0OiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICB0dElkRmllbGQ6IHN0cmluZyA9IFwiaWRcIjtcclxuICB0dERhdGE6IGFueVtdID0gW107XHJcbiAgdHRDb2x1bW5zOiBhbnlbXSA9IFtdO1xyXG4gIGNhc2NhZGVDaGVjayA9IGZhbHNlO1xyXG4gIGNhc2NhZGVEb3duID0gZmFsc2U7XHJcbiAgY2FzY2FkZVVwID0gZmFsc2U7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ25hbWVDZWxsVGVtcCcpXHJcbiAgbmFtZUNlbGxUZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICBAVmlld0NoaWxkKCdpY29uU2VsZWN0Rm9vdGVyJylcclxuICBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgbW9kYWxSZWY6IEJzTW9kYWxSZWY7XHJcblxyXG4gIHJlYWRvbmx5IGRlZmF1bHRQYWdlU2l6ZTogbnVtYmVyID0gMzA7XHJcbiAgcGFnZUxpc3QgPSBbdGhpcy5kZWZhdWx0UGFnZVNpemUsIDUwLCAxMDAsIDIwMCwgNTAwXTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHByb2NIZWxwU2VydmljZTogUHJvY2Vzc0xpc3RIZWxwU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBmcmFtZXdvcmtTZXJ2aWNlOiBGcmFtZXdvcmtTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcclxuICAgIHByaXZhdGUgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlLFxyXG4gICAgcHJpdmF0ZSBsb2FkaW5nOiBMb2FkaW5nU2VydmljZSxcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgcHJpdmF0ZSBsb2NhbGVQaXBlOiBBaWZMb2NhbGVQaXBlLFxyXG4gICkge1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtID0gdGhpcy5jcmVhdGVEZWZhdWx0UXVlcnlQYXJhbSgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmNvbmZpZ1R0Q29sdW1ucygpO1xyXG4gICAgaWYgKHRoaXMuZWRpdG9yUGFyYW1zICYmIHRoaXMuZWRpdG9yUGFyYW1zLmJpelR5cGVJZCkge1xyXG4gICAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlLnZhbHVlID0gdGhpcy5lZGl0b3JQYXJhbXMuYml6VHlwZUlkO1xyXG4gICAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaXpUeXBlLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy50dERhdGEgJiYgdGhpcy50dERhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgY29uc3QgcHJvYyA9IHRoaXMucHJvY2Vzc0NvZGUgIT0gbnVsbCA/IHRoaXMudHREYXRhLmZpbmQoKGl0KSA9PiBpdC5jb2RlID09IHRoaXMucHJvY2Vzc0NvZGUpIDogdGhpcy50dERhdGFbMF07XHJcbiAgICAgICAgICBwcm9jICYmIHRoaXMudHQuc2VsZWN0Um93KHByb2MuaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMzAwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tPayhldnQ/KSB7XHJcbiAgICBpZiAodGhpcy50dC5zZWxlY3RlZFJvdyA9PSBudWxsKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInBsZWFzZVNlbGVjdE9uZUl0ZW1Pbmx5XCIpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5wcm9jRW1pdHRlci5lbWl0KHRoaXMudHQuc2VsZWN0ZWRSb3cuZGF0YSk7XHJcbiAgICBjb25zdCBvYmplY3QgPSB7IHZhbHVlOiB0aGlzLnR0LnNlbGVjdGVkUm93LmRhdGEuY29kZSwgcGFyYW1ldGVyczogbnVsbCB9O1xyXG4gICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KG9iamVjdCk7XHJcbiAgICB0aGlzLm1vZGFsUmVmICYmIHRoaXMubW9kYWxSZWYuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIGNsaWNrQ2FuY2VsKGV2dD8pIHtcclxuICAgIHRoaXMucHJvY0VtaXR0ZXIuY29tcGxldGUoKTtcclxuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgICB0aGlzLm1vZGFsUmVmICYmIHRoaXMubW9kYWxSZWYuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIG9uU2VhcmNoKHBhcmFtOiBhbnkpIHtcclxuICAgIHRoaXMucXVlcnlQYXJhbSA9IHBhcmFtO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5xdWVyeVBhcmFtKTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICB0aGlzLnR0LmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICB0aGlzLnR0LmNsZWFyU2VsZWN0aW9ucygpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY2xpY2tOYW1lQ2VsbChjdHgpIHtcclxuICAgIHRoaXMucHJvY0hlbHBTZXJ2aWNlLm9wZW5CaWZNYW5hZ2VyQXBwKGN0eC5yb3dEYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiDliJfmjpLluo/liY3kuovku7ZcclxuICovXHJcbiAgYmVmb3JlU29ydENvbHVtbiA9IChmaWVsZDogc3RyaW5nLCBvcmRlcjogc3RyaW5nKSA9PiB7XHJcbiAgICBsZXQgY29sczogc3RyaW5nW10gPSBmaWVsZC5zcGxpdChcIixcIik7XHJcbiAgICBsZXQgb3JkZXJzOiBzdHJpbmdbXSA9IG9yZGVyLnNwbGl0KFwiLFwiKTtcclxuXHJcbiAgICAvL+mHjee9ruaOkuW6j+adoeS7tlxyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3Mub3JkZXJCeUNvZGUgPSBudWxsO1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3Mub3JkZXJCeU5hbWUgPSBudWxsO1xyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MuT3JkZXJCeUxhc3RNb2RpZmllZFRpbWUgPSBudWxsO1xyXG4gICAgLy/kvp3mrKHmt7vliqDmjpLluo/mnaHku7ZcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsZXQgb3JkZXJCeSA9IG51bGw7XHJcbiAgICAgIGlmIChvcmRlcnNbaV0gPT0gXCJhc2NcIikge1xyXG4gICAgICAgIG9yZGVyQnkgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICAgICAgb3JkZXJCeS5oYXNWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgb3JkZXJCeS52YWx1ZSA9IE9yZGVyQnlEaXJlY3Rpb24uQXNjO1xyXG4gICAgICB9IGVsc2UgaWYgKG9yZGVyc1tpXSA9PSBcImRlc2NcIikge1xyXG4gICAgICAgIG9yZGVyQnkgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICAgICAgb3JkZXJCeS5oYXNWYWx1ZSA9IHRydWU7XHJcbiAgICAgICAgb3JkZXJCeS52YWx1ZSA9IE9yZGVyQnlEaXJlY3Rpb24uRGVzYztcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNvbHNbaV0gPT0gXCJjb2RlXCIpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5vcmRlckJ5Q29kZSA9IG9yZGVyQnk7XHJcbiAgICAgIH0gZWxzZSBpZiAoY29sc1tpXSA9PSBcIm5hbWVcIikge1xyXG4gICAgICAgIHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzLm9yZGVyQnlOYW1lID0gb3JkZXJCeTtcclxuICAgICAgfSBlbHNlIGlmIChjb2xzW2ldID09IFwibGFzdE1vZGlmaWVkVGltZVwiKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MuT3JkZXJCeUxhc3RNb2RpZmllZFRpbWUgPSBvcmRlckJ5O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKTtcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiDliJfmjpLluo/lkI7kuovku7ZcclxuICAgKi9cclxuICBjb2x1bW5Tb3J0ZWQodmFsKSB7XHJcbiAgICBjb25zb2xlLmxvZyh2YWwpO1xyXG4gIH1cclxuXHJcbiAgb25QYWdlU2l6ZUNoYW5nZWQoJGV2ZW50OiB7IHBhZ2VJbmRleDogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyIH0pIHtcclxuICAgIGNvbnNvbGUubG9nKCdQYWdlU2l6ZSBDaGFuZ2VkOicsICRldmVudCk7XHJcbiAgICBsZXQgY2hlY2tlZElkcyA9IHRoaXMudHQuY2hlY2tlZHMubWFwKHIgPT4gci5kYXRhLmlkKTtcclxuXHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9ICRldmVudC5wYWdlU2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb25QYWdlQ2hhbmdlZCgkZXZlbnQ6IHsgcGFnZUluZGV4OiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIgfSkge1xyXG4gICAgY29uc29sZS5sb2coJ1BhZ2VOdW1iZXIgQ2hhbmdlZDonLCAkZXZlbnQpO1xyXG4gICAgbGV0IGNoZWNrZWRJZHMgPSB0aGlzLnR0LmNoZWNrZWRzLm1hcChyID0+IHIuZGF0YS5pZCk7XHJcblxyXG4gICAgdGhpcy5xdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZUluZGV4ID0gJGV2ZW50LnBhZ2VJbmRleCAtIDE7XHJcbiAgICB0aGlzLnF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlU2l6ZSA9ICRldmVudC5wYWdlU2l6ZTtcclxuICAgIHRoaXMubG9hZEl0ZW1zKHRoaXMucXVlcnlQYXJhbS5maWx0ZXJBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMudHQuY2hlY2tSb3dzKGNoZWNrZWRJZHMpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcGFnZUNoYW5nZUhhbmRsZXIoJGV2ZW50KSB7XHJcbiAgICBjb25zb2xlLmxvZygkZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgcGFnZVNpemVDaGFuZ2VIYW5kbGVyKCRldmVudCkge1xyXG4gICAgY29uc29sZS5sb2coJGV2ZW50KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgbG9hZEl0ZW1zKGFyZ3M6IFByb2Nlc3NGaWx0ZXJDb25kaXRpb25BcmdzKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGxvYWRpbmdDb21wID0gdGhpcy5sb2FkaW5nLnNob3coeyBtZXNzYWdlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibG9hZGluZ1wiKSB9KTtcclxuICAgIHJldHVybiB0aGlzLnByb2NIZWxwU2VydmljZS5nZXREYXRhZ3JpZERhdGEoYXJncykucGlwZShcclxuICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgIChsaXN0UmVzOiBSdEJpbGxQcm9jZXNzTGlzdFJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy50dERhdGEgPSBbLi4ubGlzdFJlcy5lbnRpdGllc107XHJcbiAgICAgICAgICAvL+abtOaWsOWIhumhteS/oeaBr1xyXG4gICAgICAgICAgdGhpcy50dC5zZXRQYWdlSW5kZXgobGlzdFJlcy5wYWdlSW5kZXggKyAxKTtcclxuICAgICAgICAgIHRoaXMudHQudG90YWwgPSBsaXN0UmVzLnRvdGFsQ291bnQ7XHJcbiAgICAgICAgICB0aGlzLnR0LnBhZ2VTaXplID0gbGlzdFJlcy5wYWdlU2l6ZTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRDdXJyZW50UGFnZSh0aGlzLnBhZ2luYXRpb25JZCwgbGlzdFJlcy5wYWdlSW5kZXggKyAxKTtcclxuICAgICAgICAgIC8vIHRoaXMucGFnZS5zZXRJdGVtc1BlclBhZ2UodGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMucGFnZVNpemUpO1xyXG4gICAgICAgICAgLy8gdGhpcy5wYWdlLnNldFRvdGFsSXRlbXModGhpcy5wYWdpbmF0aW9uSWQsIGxpc3RSZXMudG90YWxDb3VudCk7XHJcblxyXG4gICAgICAgICAgbG9hZGluZ0NvbXAuY2xvc2UoKTtcclxuICAgICAgICAgIHJldHVybiBvZihsaXN0UmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICksXHJcbiAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgbG9hZGluZ0NvbXAuY2xvc2UoKTtcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvL3RvZG8g56Gu5a6a5byC5bi457uT5p6ELCDnm67liY3ph4fnlKjlhbzlrrnlj5blgLzmlrnlvI9cclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29uZmlnVHRDb2x1bW5zKCkge1xyXG4gICAgdGhpcy50dENvbHVtbnMgPSBbXHJcbiAgICAgIC8vIHtcclxuICAgICAgLy8gICBmaWVsZDogXCJpc0VuYWJsZWRcIiwgdGl0bGU6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJlbmFibGVkU3RhdGVcIiksIHdpZHRoOiAxMDAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmICh2YWx1ZSA9PSB0cnVlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW5hYmxlZFwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gZmFsc2UpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJkaXNhYmxlZFwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiBcIi1cIjtcclxuICAgICAgLy8gICAgIH1cclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH0sXHJcbiAgICAgIHsgZmllbGQ6IFwiY29kZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNvZGVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBmaWVsZDogXCJuYW1lXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibmFtZVwiKSwgd2lkdGg6IDI1MCwgc29ydGFibGU6IHRydWUsXHJcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMubmFtZUNlbGxUZW1wLFxyXG4gICAgICB9LFxyXG4gICAgICB7IGZpZWxkOiBcInVwQmlsbFZvTmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInVwQmlsbFwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUgfSxcclxuICAgICAgeyBmaWVsZDogXCJkb3duQmlsbFZvTmFtZVwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImRvd25CaWxsXCIpLCB3aWR0aDogMTIwLCBzb3J0YWJsZTogdHJ1ZSB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwiYmlmTWV0YWRhdGFUeXBlXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc1R5cGVcIiksIHdpZHRoOiAxMjAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogQmlmTWV0YWRhdGFUeXBlLCByb3dEYXRhLCByb3dJbmRleCkgPT4ge1xyXG4gICAgICAvLyAgICAgaWYgKHZhbHVlID09IEJpZk1ldGFkYXRhVHlwZS5CaWZDcmVhdGlvblByb2Nlc3MpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjcmVhdGlvblwiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gQmlmTWV0YWRhdGFUeXBlLkJpZldyaXRlYmFja1Byb2Nlc3MpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ3cml0ZWJhY2tcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgIC8vICAgICB9XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IFwic3lzSW5pdFwiLCB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInN5c0luaXRcIiksIHdpZHRoOiA4MCwgc29ydGFibGU6IGZhbHNlLFxyXG4gICAgICAvLyAgIGZvcm1hdHRlcjogKHZhbHVlOiBib29sZWFuLCByb3dEYXRhLCByb3dJbmRleCkgPT4ge1xyXG4gICAgICAvLyAgICAgaWYgKHZhbHVlID09IHRydWUpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ5ZXNcIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2UgaWYgKHZhbHVlID09IGZhbHNlKSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibm9cIik7XHJcbiAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAvLyAgICAgICByZXR1cm4gXCItXCI7XHJcbiAgICAgIC8vICAgICB9XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6IG51bGwsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiaXNFeHRlbmRQcm9jZXNzXCIpLCB3aWR0aDogODAsIHNvcnRhYmxlOiBmYWxzZSxcclxuICAgICAgLy8gICBmb3JtYXR0ZXI6ICh2YWx1ZTogYm9vbGVhbiwgcm93RGF0YSwgcm93SW5kZXgpID0+IHtcclxuICAgICAgLy8gICAgIGlmIChyb3dEYXRhLnBhcmVudElkID09IG51bGwpIHtcclxuICAgICAgLy8gICAgICAgcmV0dXJuIHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJub1wiKTtcclxuICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwieWVzXCIpO1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAgLy8geyBmaWVsZDogXCJidXNpbmVzc1R5cGVcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiYnVzaW5lc3NUeXBlXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiY3JlYXRvclwiLCB0aXRsZTogdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmluc3RhbnQoXCJjcmVhdG9yXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHsgZmllbGQ6IFwiY3JlYXRlZFRpbWVcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwiY3JlYXRlZFRpbWVcIiksIHdpZHRoOiAxMjAgfSxcclxuICAgICAgLy8geyBmaWVsZDogXCJsYXN0TW9kaWZpZXJcIiwgdGl0bGU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KFwibGFzdE1vZGlmaWVyXCIpLCB3aWR0aDogMTIwIH0sXHJcbiAgICAgIC8vIHtcclxuICAgICAgLy8gICBmaWVsZDogXCJsYXN0TW9kaWZpZWRUaW1lXCIsIHRpdGxlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibGFzdE1vZGlmaWVkVGltZVwiKSwgd2lkdGg6IDEyMCwgc29ydGFibGU6IHRydWUsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiB7XHJcbiAgICAgIC8vICAgICB0eXBlOiAnZGF0ZXRpbWUnLFxyXG4gICAgICAvLyAgICAgb3B0aW9uczoge1xyXG4gICAgICAvLyAgICAgICBmb3JtYXQ6ICdZWVlZLU1NLUREIEhIOm1tOnNzJ1xyXG4gICAgICAvLyAgICAgfVxyXG4gICAgICAvLyAgIH0sXHJcbiAgICAgIC8vIH0sXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVEZWZhdWx0UXVlcnlQYXJhbSgpIHtcclxuICAgIGNvbnN0IHF1ZXJ5UGFyYW0gPSB7XHJcbiAgICAgIGZpbHRlckFyZ3M6IG5ldyBQcm9jZXNzRmlsdGVyQ29uZGl0aW9uQXJncygpLFxyXG4gICAgICBmaWx0ZXJBcmdzRXh0OiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MucGFnZVNpemUgPSB0aGlzLmRlZmF1bHRQYWdlU2l6ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5wYWdlSW5kZXggPSAwO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lID0gbmV3IFRleHRWYWx1ZSgpO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lLnZhbHVlID0gT3JkZXJCeURpcmVjdGlvbi5EZXNjO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLk9yZGVyQnlMYXN0TW9kaWZpZWRUaW1lLmhhc1ZhbHVlID0gdHJ1ZTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaWxsUHJvY2Vzc1R5cGUgPSBuZXcgVGV4dFZhbHVlKCk7XHJcbiAgICBxdWVyeVBhcmFtLmZpbHRlckFyZ3MuYmlsbFByb2Nlc3NUeXBlLnZhbHVlID0gQmlmTWV0YWRhdGFUeXBlLkJpZkNyZWF0aW9uUHJvY2VzcztcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5iaWxsUHJvY2Vzc1R5cGUuaGFzVmFsdWUgPSB0cnVlO1xyXG4gICAgcXVlcnlQYXJhbS5maWx0ZXJBcmdzLmlzRW5hYmxlZCA9IG5ldyBUZXh0VmFsdWUoKTtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQudmFsdWUgPSBcInRydWVcIjtcclxuICAgIHF1ZXJ5UGFyYW0uZmlsdGVyQXJncy5pc0VuYWJsZWQuaGFzVmFsdWUgPSB0cnVlO1xyXG5cclxuXHJcbiAgICByZXR1cm4gcXVlcnlQYXJhbTtcclxuICB9XHJcbn1cclxuIl19